<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>LAN Turtle 107 - Man in the Middle DNSSpoof | Coder Coacher - Coaching Coders</title><meta content="LAN Turtle 107 - Man in the Middle DNSSpoof - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>LAN Turtle 107 - Man in the Middle DNSSpoof</b></h2><h5 class="post__date">2017-10-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/4yNG12O2ynE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I'm Darrin kitchen this is land turtle
basics and today we're going to continue
our man-in-the-middle by doing a little
DNS spoofing and so what does that mean
well consider that because we are
physically in this case for our virtual
machine that the land turtle is plugged
into between the network we are
physically the man in the middle and we
have remote access to manage this over
SSH we can also use some of the other
utilities that are built into the land
turtle namely DNS mask and DNS spoof and
both of these allow us to set
essentially static routes and what that
means is when the computer that the that
the LAN turtle is connected to providing
internet access when it looks for a
webpage or any other resource on the
Internet
it many many times oftentimes has to
query a DNS servers to find out what is
the IP address of the domain name that
I'm looking for so it's looking for
example.com it'll ask the the closest
DNS server and then that if that DNS
server doesn't know it'll ask the next
one and then that one last the next one
until finally I can find an answer and
provide the computer with the
appropriate answer well in this case
rather than looking up to the next
server we're going to say if it's in our
spoof host if it's in our list of
predefined domains we can go ahead and
instead of giving it a correct DNS IP
address we'll go ahead and give it
whatever IP address of our choosing
which is really fantastic for a number
of reasons so let's go ahead and get
started with that similar to our
previous examples we have our Windows
machine here on the left that had just
been browsing hacked five org and we
were doing some URL snarfing I am logged
in to my virtual private server in the
cloud and I'm managing it over SSH so
let's go ahead and set up our DNS spoof
so I'm going to SSH back into the land
turtle by doing SSH root at localhost
tack p2 2 to 2
so connecting back to it through that
SSH tunnel and now I'll go to modules
and in this example I'm going to use DNS
mask spoof so DNS mask is
fantastic utility it's what's providing
DHCP it's providing the DHCP to the
client that it's connected to the land
turtle or in this case the host the the
computer well in addition to safe just
IP addresses that were used to DHCP
pushing it can DHCP could do a lot of
things DHCP can push TFTP information
for PXE booting and it can also push DNS
information which is really great
because we're now going to make some
static changes to our DNS by going over
to configure and we already have an
example in here let's add a new one and
let's add our IP so in this case I'm
going to use the IP address of this
virtual private server in the cloud that
we're managing the land turtle through
and I'm going to go ahead and add some
additional domains and I guess let's do
an turtlecom @ww LAN turtlecom and
example net and WWE example net sure
that'll work and I hit OK and I could go
ahead and restart the service by hitting
stop and it will restart DNS mask spoof
and there we go
so now on the client side here's the
interesting thing that's going to happen
if I go ahead and now make a open up you
know Internet Explorer Firefox whatever
have you my web browser and I now ask it
to provide me with LAN turtlecom or
example net it's going to ask the
nearest DNS server and then in this case
since it's me I'm going to tell it that
static IP address well you might be
wondering what's over there right now
there's nothing so let's go ahead and
put something there so I'm going to go
ahead and quit out of the land turtle
and back to my server and I'm still in
the home directory of the turtle I think
what we'll do is I'm going to use nano
to make it a little index.html file and
it's going to say HTML body BG color
equals black
text equals white center h1 I like
turtles
and we'll save that file and now using a
little bit of Python we'll start a
simple HTTP server on port 80 now if I
head back over to my client and pull up
for example example dotnet I get I like
turtles
and we can even see the pool and the get
requests over here and isn't that
fantastic DNS spoofing can be very
useful in a number of circumstances and
some other things to consider in fact
with this is we've got it poised in a
very men in the middle it's physically
the link between the network in this
case for this client to this computer
here but in many other instances just by
having the land turtle with this DNS
spoof setup plugged into the computer it
still uses DHCP to push these DNS
settings so even though it may not be
the one providing the internet
connection by just having plugged into
the machines a lot of times it can be
successful in pushing over other DNS
entries and so use this as you will let
me know it hit us up feedback in the
comments and you can find more videos
like these and of course myself over at
Lanter ttle com</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>