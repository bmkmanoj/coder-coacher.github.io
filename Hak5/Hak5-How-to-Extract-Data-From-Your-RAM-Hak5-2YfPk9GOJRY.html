<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hak5 - How to Extract Data From Your RAM? - Hak5 | Coder Coacher - Coaching Coders</title><meta content="Hak5 - How to Extract Data From Your RAM? - Hak5 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hak5 - How to Extract Data From Your RAM? - Hak5</b></h2><h5 class="post__date">2009-07-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2YfPk9GOJRY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this time on the show physical memory
extraction and analysis all that and
more on this episode of hack 5
this episode of pack five is brought to
you by go daddy
Squarespace Gamefly and viewers like you
hello and welcome to hack five my name
is Darren kitchen and I'm Rob Ford also
known as musics yeah and we have an
awesome episode for you guys today we're
following up with some of the stuff that
we talked about last week with the cold
boot attack and how we do some more fun
forensics so we're down here in CW right
Colonial Williamsburg for the non-locals
and I wanted to come here and see how
we're we're Harrison had done his little
hacking and stuff like that reference
season 1 for that exactly
so speaking of hacking I want I saw the
episode about forensics and I wanted to
come down and tell you about penetration
testers use of forensics well I mean I
understand forensics in the viewpoint of
you know I'm contracted to find some
stuff on some machine or there was some
malicious stuff on like you know malware
analysis and whatnot how does that
change from the viewpoint of a hacker so
a hacker can dump memory just like you
guys used there right well what's in
memory passwords of course and that's
the whole beauty of a esq plan which
we'll get to later right so you're
saying taking it from the level of oh
okay I have access to a box and going
ahead and taking advantage of this
beautiful forensics tools for like a
fundus exactly I love it so you want to
sit down and let's pop a squat and get
some stuff going on oh it does awesome
worth mentioning that Matt will be back
next week you're looking forward to him
getting back from Ohio I wonder if
there's any employers networks around
probably with Squarespace you can build
beautiful-looking blogs or websites in a
fraction of the time it would take with
a traditional content management system
they're intuitive drag-and-drop
interfaces as snappy and powerful as a
desktop publishing app but best of all
there's no software to install no
databases to configure no patches to
apply and no code to fiddle with find
out for yourself how simple and powerful
it can be with a two week free trial at
squarespace.com and use promo code hak5
to support the show and save 10% off the
life of your service at squarespace.com
Rob thanks so much for coming down I
think before we get too much into it
though we should recap what we were
talking about last week for those may
have missed not following along that
we're talking at the cold boot attack
and using my favorite thing in the world
a standard little inconspicuous innocent
little USB Drive I do the same thing
using PXE if you want to really set up a
th CD for that DHCP and TFTP D or you
could do like you know flash and bios
like a coreboot bios and set up a
specially crafted motherboard to go
ahead and you know freeze Ram take it
out of a machine image it or just boot
off to the USB image Ram that's what
we're gonna be talking about is you know
acquiring physical memory so that we can
do some really fun stuff with it I do
need to mention that for the people that
were confused about compiling it you do
need to add into the C plugs or the make
files no sack protector and if you're
really lazy I've gone ahead and just
posted the bin on my blog so just be be
it right over to your thumb drive and
should be good to go Ben compiled under
right we'll check actually I cheated and
just compiled it with GCC before 4.1 so
they don't have to use the F no sack
protector but I mean okay point being
one we're gonna be talking about
gathering physical memory and then some
stuff that we can do with it
and I thought it would be important to
other than the cold boot attack talk
about ways that you would apply a
physical memory jump from a computer now
we know that Microsoft does it when
there's like a crash right right does a
crash dump but there are other ways too
and let's just talk about like your
standard windows xp box for our examples
here
to get the physical memory for it I like
tool called well I like DD on Linux
right right but for Windows like windy
it's basically a port that allows you to
do the nifty stuff that DD on you know
Linux would allow you to do that is
grabbing the stuff from your physical
memory and popping it like into a bin
file or whatever you want to call it
what about you
so I don't like win32 DD I like man text
em
deedy which it's real simple all you do
is I mean there's absolutely zero
options you run with attack oh and say
here's your output that's about it
I mean I don't have any problems with
that program it sounds cool I just
wanted to note that when 32 GD is both
open source and it has two different
methods of going about dumping the
physical memory you can just it'll just
copy what's in back / / / physical
memory on Windows or use a kernel API
and what's important to note here is
that on versions of Windows prior to
Windows Server 2003 Service Pack 1 so
I'm sorry I'm version since then so like
your vistas and your windows sevens and
stuff alright don't allow user mode
access to physical memory right and so
what yeah you have to kind of go you
know basically win32 DD is all kernel
mode to do all this stuff and I thought
that that brought up something that we
never really talked about on the show
here and I figured it'd be important to
note that the difference between such so
like kernel mode is having like weird
ring 0 yeah it's like bare metal address
to the hardware you can do whatever you
want to it you know that's that's you
know that's sort of talking about that
right there is his kernel mode but but
then like or like you know if I wanted
some muffins and I just stole them up
and you know there there you go or you
know user mode you got to ask for the
muffins you get asked for permission
right and you don't know what muffin
you're gonna get right okay the one that
you know the grand jury decides to give
you something threatening you know user
mode Windows 32 we're talking about you
can't touch the bare metal you have to
go through api's and stuff so and if
you're interested in that kind of stuff
about the like NT ABS you know hardware
abstraction layer and IO manager is an
old bunch of stuff all off links in the
show notes some really nitty gritty
stuff okay suffice it to say Windows
memory dumping utilities made prior to
Windows Server 2003 Service Pack 1 may
not function correctly on versions since
then
so you know just something to look out
for well as long as you're an
administrator or running the the tool as
an administrator you have you sort of
have access to ring zero right and you
know getting the administrator access on
Windows is like making cupcakes so oh
yeah there is yep well you know it's
it's funny that okay so we've been
talking about conduit and we've been
excited about this conduit stuff but
there is actually a another justice
simple method not as easy to build the
device but another device type method
for bypassing windows login anyway
that's kind of similar that I thought
would be worth mentioning here because
it also ties into dumping physical
memory and that is firewire devices by
just the nature of the spec a FireWire
device has access to the physical memory
so what that means is a for example a
you know firewire iPod with Linux could
be specially grata crafted with some
cool software to plug into you know
generic Windows box and access that
physical memory right read to it read
from it and write to it and then once
you can do that you know where I'm going
with you see it's the plug-in pone it's
the you know bypass by plants all sorts
of windows restrictions just because you
can make a spiral yeah I know it's
written in spec and it's even it's just
as inconspicuous as a USB Drive so I
mean right I don't mean the t's it's
probably a topic for more in-depth
discussion and some lab stuff later on
but you know is it something to note
there so let's go ahead and dump some
physical memory and then throw it
through some of our toys and see what we
can come up with definitely and I wanted
to say that if you do throw it through
some toys like we're going to use them
all just like I said with the the I mean
use all of your tools because sometimes
you get other results in like we're
gonna show anyways yeah make the boys
count all the tools yeah definitely but
let's think one of our awesome sponsors
keep your personal information away from
spammers hackers and your crazy
ex-roommate private domain registration
from go daddy.com protects your privacy
by keeping
address phone number and more out of the
public database check out revision
three.com slash go daddy for all of our
Go Daddy codes and offers so we've gone
ahead and taken our physical memory
dumps and I've loaded them up here in my
Linux side of my machine and I've gone
ahead and grabbed one from my computer
using win 3-2 DD I grabbed mine from MDD
excellent and we got to both of them
what's what's the first tool that we
throw them through that you like
volatility of course it's Python so it's
cross-platform it runs on Windows Linux
lemak know that really if you consider
it a platform all right so what you can
do with volatility that I like is you
can dump the running processes at the
time you can do l's
connection sockets registries registry
keys I think it's really cool that we
could like when I did this online and I
can go ahead and actually see hey
TrueCrypt exe is one of the processes of
that is running what's close me into oh
hey maybe I should start you know and
we'll talk about the other paths that we
can take there but further from that
you're explaining to me that we can
actually take executables that are
running and extract those how does how
does that work what's the benefit there
ok so you can actually so whenever you
run a process it gets loaded into memory
nice on Windows XP if I were to load up
QBasic if I wanted to get my 20 go to 10
on QBasic dot exe would be resident in
memory correct and you can with
volatility just pull it right down where
that helps out is with malware analysis
so bad guys like to pack and encrypt and
put executables so that AV can't detect
them right going across the wire however
if but in memory it has to be running
right it has to be actually functioning
it can't be encrypted or compressed so
dumping it out of memory bypasses the
whole Packer issue exactly yeah and
that's what the AV guys probably have
you know the special network set up just
to monitor that sort of thing right so
some of the more deep malware analysis
guys have something called a dark net or
a or box that sits directly connected to
the network to the internet has maybe a
Linksys in
of it just to make it look like it's a
home box and it has a special piece of
hardware or software that the OS is is
unaware of and will dump everything to
admit another hard drive memory
connections and any hard hard drive
changes so when it reboots though it
will we're back and now you have a fresh
darkman again so this is like oh I love
that that has got like the the
steady-state type thing exactly and and
since it's external hardware that is
doing this monitoring its unbeknownst to
the botnet or the zombie processes that
right going on so I can't say detect
VMware right so I'm not gonna running
this for example this is basically a
honey pot for botnets
right I love it that's awesome and you
can leave it going as long as you want
to which is nice yeah now going back to
volatility it's important to note that
if you want to get playing with this
they do actually provide some example
data so you can go ahead and start using
some of their images and some techniques
there to you know pull some stuff out
and play with it and learn with it
you're telling me that we can actually
extend upon the program oh definitely so
since Python or since it's written in
Python there are been tons of forensics
guys that have done scripts for it one
of my favorites of all is dumping
passwords so you can you can dump the
Sam file because Sam files in memory
mm-hmm you dump the Sam file and we're
going to show you how to do that yes
sure yes and like we said you know it's
like like Windows and passwords it's
cupcakes so awesome stuff there but so
right so we've gone ahead we've run it
through this program and we have an idea
of what the processes are running what
connections
now you say connections it's made now
that's not to say like the cache that is
stored from your like Firefox or your
chrome internet cache we're talking
about the connections like the Sox
connections and stuff that are you know
I'm saying because because we mentioned
that we can list running processes but
open network connections when you write
not that you're okay yeah so when it
shows connections it's not just what
it's connected right now it's since it's
the
buuut of the system so we go to a web
page it that that connection to that IP
address stays in memory for a while nice
at least until reboot so what I find is
that when we go through here and we say
Oh TrueCrypt that exe is running oh
we've got these cool IP addresses oh you
know the clues start going off and you
start oh I really want to dig deep into
this and see you know what's really
going on with this and and of course
dumping the Sam to get that password
because why not well speaking of
passwords last week we talked about a
EES key finder no one is sure mention
that you know with volatility if you see
something like TrueCrypt or some of the
other encryption products out there
running in memory you might want to run
this because they've got an aes key
finder and a it's can't remember off the
top of my head what the other one is the
other encryption RSA RSA key finder
right so it's just you know dot slash
AES key find and then you tell it where
your memory dump is and there we go we
actually start seeing he's coming out of
here right which is awesome then you
have been you if you have the hard drive
as well you unencrypted it and you're
good way to go because the memory can't
be encrypted and the other thing to say
is that right so we start with the
memory because that was what we could
get but then once you've got the hard
drive all the other fun stuff that you
can then throw through other tools
foremost and I think that's that's a
that I think the the hard drive stuff is
a topic for another show but but let's
touch on foremost here because I
mentioned it just briefly last week and
I think it's it worth reiterating how
cool this tool is so basically foremost
is a tool for forensics analysis for
recovering stuff from from memory files
and files based on the headers of files
the footer of files and and signatures
within a file so oh hey this certain
structure looks like a JPEG let's just
extract everything in between here and
there and say it's a JPEG and put it in
a folder and that's what does it for you
yeah and my favorite option by far with
it is TAC T all because it's got all
these different profiles
understands JPEGs and gifts and board
documents so you do all against your
memory dump and any file that was open
that it understands it just throws it
into a folder called output and it is so
much fun to dig through so we've got
this for most also has the ability some
people who have been working on other
plugins for it so you can download those
as well and with and like where the
volatility for most also provides
digital forensics tools like test images
that you can go ahead and download and
play with so we encourage you guys to go
ahead and download some of these test
images play with these tools and let us
know what you think there's nothing
better than doing it on your own image I
mean all you have to do is download the
tool and and you have your image of your
own memory so you can kind of write so
on your windows VM go ahead and run
win32 DD yeah it's cooler than this tool
I want to let everybody know that
Gamefly is an amazing service they are
the largest online video game rental
service and offer a choice of over 6,000
new and classic titles across all
consoles and handhelds with plans
starting a 1595 month Gamefly members
can rent one to four games at a time and
keep them for as long as they like you
can also purchase a game if you fall in
love with it they'll send you the box
and the manual for a nominal fee head on
over to gamefly.com slash hack 5 to get
2 week free trial membership gamefly.com
slash that's just about wraps up this
episode of hack 5 but we want to let you
know a couple of things first of all we
do have the August 15th meetup yes
August 15th we are having an awesome
hacks I've meet up over at Busch Gardens
in Williamsburg Virginia you can join us
on August 15th and you can go over to
hex 5 meetup squarespace.com for all the
details
right and you can con your parents into
doing it by telling them you're gonna
take them down to 20 Williamsburg and
see all they like the story stuff and
then just join us at the German beer
house that's in Busch Gardens yes best
house noon it's going to be awesome I
also wanted to let you know that you can
send us feedback at feedback at hack 5
org or use the contact form at the top
of the page I hiked 5 org and we'd love
to hear what you guys think about the
show what tools you guys use so you know
let us know yeah and we also want to
tell you about our
very sweet brand-new show on revision 3
HD nation revision threes newest show HD
nation is your guide to the best in HD
content and the best in home theater
gear no matter what your budget is HD TV
expert Robert Haran and movie fanatic
Patrick Norton we'll bring you the
inside scoop on the movies TV shows and
downloads that will make your HD TV
shine along with the best bargains in HD
from satellite to blu-ray sales every
Tuesday at revision3.com watch HD nation
also we can't forget to tell you about
podcaster meetup you guys remember it if
you need medicine coupon or many of the
other hacker cons with this metal bat
move this is a great job organizing it
and they will be at Def Con this year so
if you're going Saturday is the night
get all the details over at podcasters
meetup.com anyway that's pretty much it
for this week we do want to let you know
Matt we'll be back next week and really
be back in studio alright well until
then if we're reminding you trust you're
attacking us hello and welcome to hack 5
my name is Darren kitchen and I'm
totally ripping gem cutters very first
episode sorry well go ahead and kill it
because that thing's over had
which it isn't supposed to be the
restricted airspace the the road of like
ID a pro and disassembling and fun stuff
like that and we're specifically talking
about cup how about this is Emily okay
no problem</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>