<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hak5 - Automate Interactive Processes in Linux without TCL/Expect, Hak5 1107.1 | Coder Coacher - Coaching Coders</title><meta content="Hak5 - Automate Interactive Processes in Linux without TCL/Expect, Hak5 1107.1 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hak5 - Automate Interactive Processes in Linux without TCL/Expect, Hak5 1107.1</b></h2><h5 class="post__date">2012-04-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/8BkGuKj__8M" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this time on the show automating
interactive tests in Linux preventing
your browser sessions from being tracked
graphical command-line disk usage
utilities and pushing hex over TCP with
echo all that and more this time on hack
5 this segment of hack 5 is brought to
you by domain.com hello my name is
darren kitchen I'm Shannon Morse
delicious delicious hacking goodness and
I'm so excited about this week I missed
you guys last week
oh yeah the Southwest stuff you know
response from that it was fun to mix it
up yeah you know I actually watched last
week's episode and I've really enjoyed
it and it was very like down-to-earth
and chill it kind of remember reminded
me of like the first season of hack 5
yeah you know just kind of like
underground sitting on the couch hanging
out so it's totally cool I really enjoy
I know you mentioned that we're actually
making some changes to the season like
we tried to do on the mark of every
season but you know it's always like
within a couple of said right so what
kind of well we're adding a second set
we're doing more whiteboarding stuff
here real soon we're gonna get into
topical stuff and then try to hit lots
of aspects of them and then okay yeah
it's gonna be fun sounds a little bit
more like a learning experience well
it's gonna be of course you know as it
always is a learning experience of those
I don't know I just feel like it's gonna
be fun we're gonna do experiment and try
it but we got some cool stuff coming up
like we're gonna talk about tour and
proxies and GPG and you know disk
encryption big tackling big stuff and
Massa covering hopefully like you know
giving so that you can walk away with it
more than just like cuz sometimes it
feels like we're just like hey whatever
we did this week that was awesome it's
cool yeah they are very very interesting
and in-depth and I really enjoy that
today is not that kind of episode though
cuz we are like covering just weird
stuff that has just shown up in our life
just kind of way yeah interesting things
but
important things to know but first off I
did remind want to remind everybody
about the party that we are having on
May 3rd it's still on and I know what
how many what age group has to go we're
gonna check out that 18 up I think we'll
talk to the restaurant because no I
think it's 18 up or actually no I guess
it's all ages yeah I think it's all ages
all restaurant but it's also a pub so we
have to check on that we're having it at
Baltic pub and you can go to hack 5 org
slash one-one-one-one to find the
Facebook event we have a special hot
toddy there with some crazy German
licorice stuff it's it's good yeah it's
good it sounds delicious
yeah and I'm excited for that workshop
this Friday so I hope we'll have some
last Friday yeah last Friday that's
right I hope we have some footage from
that for next I'm taking Paul when we go
in two days that's the last Friday oh
yeah cool all right it's gonna be a lot
of fun yeah did we get any gifts from
fans
well yeah we did so it's really big so I
just decided to grab a couple of things
out of the box so I'll go ahead and grab
these for you all right
I'll read off the letter this is from
Dale and he said enjoy watching both of
you on hak5 to get your tetanus going I
am sent you a this Coleco adam Rico
alibi computer 1981 so this is from when
I was before I was born
I personally was on the Commodore vic-20
Commodore 64 in the Intel 8088 personal
computer route but adopted this atom
from a friend in the late 1990s after
seeing you and unpack various
memorabilia from other viewers I felt
hak5 would be the perfect home for this
blast from the past that other viewers
might enjoy seeing that is why it's huge
we could take some pictures yeah and
also are included two bucks computer
viruses a hi-tech disease
an assembly language primer for the IBM
PC and XT okay 5.20 that's my first
computer the XT yeah so now that could
break out that his computer and oh dude
look at this my dad had the Commodore
the IBM when I was a baby
I cannot read assembly I should laughs
yeah
inside the ROM ooh that's messing with
the BIOS and 8088 instructions yes okay
that's cool
this is going on the new set yeah sure
some of it may not all fit well get this
we're talking about a couple of things
that have run into recently as I've been
doing some other crazy work stuff and
discovered an awesome way to do
automation of Linux tasks that are
interactive I talked about it previously
using a tool called expect which uses
TCL is a dependency this is an awesome
new tool that not new new it's new to me
that allows you to do just that just be
able to interactively automate stuff
with processes and it's pretty cool for
look at any linux guy needs to know this
and especially when dealing with
embedded systems where you don't have
the kind of like you know you've got
like very small overhead and yeah you
know so that's yeah yeah so that's what
how I came about that and also I got a
great nibble I think it's actually more
than it's like the whole I wish i could
get into the entire process of it
because um it was a lot bigger of an
experience but the one thing that it
took away from that and that is hacking
into a friend's home automation system
and breaking into their house was um was
just the this really cool you'll see
it's we reverse engineered my first
protocol oh really cool yes thank you
okay well this week I am checking out a
privacy protection oh that's super super
easy to set up so I'll check that out
next I got something to add to that too
but we'll talk about that in the c-block
all right come on till then let's talk
about
empty I know it's an empty segment well
we what are we empty that side of the
right I'm out of here all right cool
well like as I said empties is a tool
that you can use instead of expect and
from empties SourceForge page they
describe it at SF or empty SF net is a
utility that provides an interactive
provides an interface to execute and
interact with the process under what
they call pseudo terminal sessions so
this is pretty cool because you know you
can use this program to to script a
shell to create shell scripts which
communicate with interactive processes
like telnet or FTP or SSH and while you
know I said TCL expect can do pretty
much the same thing empty is maybe a
better choice because it can be invoked
directly from the shell it doesn't
require TCL or Perl or Python or any
other language it's super small simple
and clean and it's already been ported
to most flavors of Unix so installation
really simple you know you just go to
the download site SF or what is it empty
SF net download the tarball on Taarabt
make all install clean whatever or you
could just grab it from your repo and in
this case like an Ubuntu it's a matter
of sudo apt-get install empty - expect
is the name of the package
alright so the cool thing about the way
that it works is that everything is
based on files so I'm gonna go ahead and
show you by starting an interactive
process and we'll take a look at the
files within so for that we're gonna
need a new script so I'll do a cat yo f
and then send that to a file that we're
gonna call
I don't know empty Sh we'll begin that
with a shebang slash bin slash bash and
now we can go ahead and create our empty
script so the first thing we need to do
is start the process with empty tack F
and then we need to say specify an input
file in an output file so Takei and
we're going to call this input dot FIFO
and then tack over our output file and
we'll call it output dot FIFO and then
we can also specify a pet or a process
ID into a file in case we want to be
able to like you know have like multiple
ones of these going and kind of keep
track of everything a little bit easier
you don't have to specify this if you
don't it's just gonna create its own
head but this is just a nice way to keep
track of stuff so I'm gonna call that
empty bid and then attack a capital L is
where we can put a log file and this is
great for debugging and and all sorts of
good stuff because the beauty of all of
this is that now I can use you know our
great friends like said and awk and grep
and all of those others to deal with
these interactive processes and because
everything is an input file or an output
file it makes it really easy to process
so tack L for our log will call empty
dot log and then our command and in this
case it's going to be SSH Darren at
localhost we'll just do that as a
interactive example so our next line is
going to kind of give you an idea of how
we can wait for different events to
happen and then respond to them so in
this case the first thing that we've
done is we spawned a session that does
an SSH to the localhost with the
username Darren and the first thing that
we might see is actually a prompt if we
want to continue if say that host isn't
in our known hosts so for that what
we'll do is empty and then in this case
since it's already created with tack F
we are doing Tech W to watch for and
this is where it's all going to make
sense
Takei the input file in this case is
actually the output file from the
previous command
so our Takei will be output dot FIFO the
our input will be input there will be
our output will be input dot FIFO and
then what we do here is we specify what
we're looking for and our response so in
this case we know we're gonna see the
word continue because it's going to
prompt us hey do you want to continue
connecting to the toast and what we're
going to say is in single quotes yes and
then to do a carriage return or an enter
or a new line or a line feed or whatever
you want to call it we do a backslash N
and end our quote all right
so at that point it should be asking us
for a password so we'll just do just
like before empty tack W tack I the
output file tack o the input file and
then in this case we're not sure if it's
going to have V a capital P or a
lowercase P for their password so why
don't we just use ass word yeah I just
said ass word and then in this case our
password in this case I've set it to
lame password and then we want to hit
enter so another backslash N and and
leave that there now okay
before you send me a ton of email yes I
know
SSH key pairs RSA DSA all the good stuff
we will be talking about that very
shortly here I know that we have in the
past sometimes I get lazy this is not
secure take it as that but this is a
good interactive example so we're just
gonna go ahead and continue with that so
anyway at this point now we're going to
be logged into in this case just
localhost and now we can go ahead and
run something on what would be you know
our server somewhere so empty again Tech
W tak I output dot FIFO or our output
will be input dot FIFO because what
we're doing is we're checking the output
of this session and when we see what we
want we put it into the input so these
two files are acting as like standard
input and output just like you would
with piping and Bosch which is so cool
so our output is input dot FIFO and then
in this case we're going to see I don't
know the word Daren at because you know
or just Daren because we know that
that's who we're logged in as and we'll
run top because that's a fun thing to
run so just top backslash n there we go
I'm gonna do an EO f to save this file
and if I chmod that with plus X for
execute now we've got our empty script
file and it's all set to be executed so
if I just do dot slash empty and I'm
gonna open a new window here come back
here okay so I'm running empty and you
see that this process is now running I
didn't put an ampersand at the end of it
so it's not in the background if I come
over to my new tab an LS empty star
you'll see there's my empty Sh there's
my empty log and if I cat empty log you
can see that just like I expected it
says that it didn't have localhost in
there here's the fingerprint are you
sure you want to connect it hit Y and
hit enter and it did not get a response
why is that well look at this we can see
that our next two empty strings said
that the data stream is empty the key
phrase which is what we're looking for
in this case the word continue the word
ass word the word Aaron wasn't found so
it times out and there's actually a way
to specify the time out the reason that
this failed was because I did not
account for the fact that in this
distribution you have to type ye s and
not just Y it changes on a distribution
of basis I'm just going to go ahead and
pop into actually will pop into Nano
give me an O some love and using vayan
vim tool it much lately our file empty
here SH and if you've been following
along you already know all they have to
do is come in here and change this Y -
yes save that file all right and now
let's run it again
well we'll even go ahead and delete this
log file del what am I in DOS RM emptied
log
and if I run my empty script now you can
see it's doing its thing it finished and
now if I cat empty log there is my top
command because it went ahead and typed
ye s this time logged right in I know
it's not the best for security in that
sense but you can imagine how with other
interactive processes this can be a
total lifesaver and I like it just
because I don't have the overhead and
dependencies of haven't used TCL it's
its own small script that I can then go
ahead and use regular text processors
which I'm already used to working with
like sad and awk and all those other fun
ones now stay tuned because in just a
bit chen is gonna be checking out this
awesome tool or basically protecting
your privacy online but first we're
gonna take a quick break it doesn't
matter whether you're in the shower or
hanging out with friends or showering
with your friends when a killer idea
hits you you need to snag your domain
fast and with domain.com simple search
and check-out process you're gonna have
that domain in like no time plus when
you're ready to take the next step
domain calm has rock-solid hosting
infrastructure to create a perfect
foundation for your project and get this
the guise of your domain calm they're
huge hak5 fans they want to hook you up
so they've got a coupon code just for us
it's a CH a k5 a checkout get you 15%
off so when you think domains think
domain.com
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>