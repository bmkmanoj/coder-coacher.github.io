<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>[[ PAYLOAD ]] - Best Payload Practices - Hak5 2318 (RE-UPLOAD) | Coder Coacher - Coaching Coders</title><meta content="[[ PAYLOAD ]] - Best Payload Practices - Hak5 2318 (RE-UPLOAD) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>[[ PAYLOAD ]] - Best Payload Practices - Hak5 2318 (RE-UPLOAD)</b></h2><h5 class="post__date">2018-01-24</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ArjspdbNDbo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome ak5 my name is darren
kitchen it's a weekly dose of Technol us
and i'm gonna build on last week where i
proof of concept it'd i'd say that is if
it's a verb I popped anyway I made an
nmap payload which scans the vicinity
and saves stuff to your packet squirrel
to say hey here's your neighbors and of
course it's just a quick and dirty
payload it's not fault-tolerant it's not
using best practices it's just something
I whip up like I typically tend to whip
up which is great for me but not really
it's something I want to share so I
figured this would be great opportunity
to get into building on that and talking
about ways to make it better
so I would say that the like if I can
pick a top-five it would be first and
foremost to comment like comment the out
of your payload and not just like
comment the actual payload itself but
write a decent readme MD file because
when you submit it it's gonna be
something where everybody wants to be
able to say like oh hey what's what does
this do right and what are the lights
mean so comment second would be make it
tweakable as tweakable as possible
meaning like if you have some command
line arguments or or you know other
features of the payload that you can
turn into variables go ahead and do that
the the nicest payloads are the ones
that are well commented at the top and
then right underneath it's just a bunch
of variables that then the user can
tweak and nothing is hard-coded so I did
that a little bit last week where I well
at least here I make the you know cider
and the IP and the options into
variables and you know you can go ahead
and then you know you can really get
extensive with this but it just
basically don't hard-code everything
third would be add a little bit of error
handling so sometimes you may have a
payload which requires an external
dependency that's not normally available
so check to see if that's available and
if it's not gracefully fail you know
other things would be like checking if
there's external storage if you need
external storage and if there's not well
fail right which brings us to the fourth
which would be to you know kind of use
the standard led patterns to
scribe the states so for instance if
you're setting it up use LED setup and
if you're in the middle of the attack to
use LED attack or you led stage one so
that anybody can glance at a payload and
say okay it's blinking yellow it's in
the first stage it's blinking twice
yellow it's in the second stage and then
that brings us up the last which was
number five to use multi if you're going
to have multiple conditions fail
gracefully use multiple like fail 1 fail
2 LEDs States and and also you know echo
out a log that's super helpful for
debugging because if you know you're
gonna share a payload somebody comes
into it and they're like never use your
payload they're not the author of it and
something's gonna fail it's always nice
if there's like a little error log so
with all of that said you know and in
traditional programming fashion I'm
gonna give you I'd say best practice 0
which is before you go making your
extensive nmap payload check the hack 5
forums check the github make sure hasn't
been done because while I was about to
go into like prettying up this payload
from last time which you know I could
use some work right I mean at the very
least check for the existence of USB
storage for your packet squirrel before
you start attempting to log files there
because otherwise it's just not gonna go
anywhere I should have that very lease
used this little snippet here which
basically says hey if this no mount file
doesn't exist which will exist if
there's no USB drive mounted then you
can go ahead and save files there and if
not well then LED fail right and then
you know like hey it's not doing
anything because you don't have a flash
drive plugged in so while perusing the
hack 5 github I came across this
particular payload it's called an map
dump it is from info 'scrimish which is
actually a pretty cool web site info
scrimmage says the society is only as
free as their ability to freely share
ideas I totally agree and this is a
great example of a payload
that matches all of that criteria that I
just mentioned and I've got it pulled up
over here and let's take a look so it
starts off with a lot of great
information here in the comments and it
tells you what the LEDs do and then
everything is defined in these variables
and then next to each variable is you
know some examples of what happens here
so for instance you know the net sleep
is the seconds to sleep while waiting
for net meeting like waiting for net to
get an IP address right the mode
transparent and then next to it it says
you can you know use transparent or
bridge or not or VPN or none and then
what none actually means as well as you
know what you want to do at the end of
this you can either you know reboot or
halt or do nothing at the end of the
payload as well as where to save the
files and the file naming scheme so I
would say like very well documented very
tweakable because all those options are
at the top and when we go through and
actually look at this payload it has
those graceful errors so for instance
down here this is actually a function
you know what this pretty cool thing
here in notepad plus plus I can actually
just reduce that whole function and Boop
and that's the finished function which
it does a little bit of cleanup work
here's the run function and then so
really the payload starts here which is
first to check if we have USB storage C
simply commented there and if it is
ready to go then we can go ahead and LED
attack and go ahead and run the run
function otherwise we LED failed because
there's no external storage so just I
had mentioned before so what does that
run payload actually do well here's the
thing wow I thought mine was like quick
and dirty this is this is a very complex
way to go about doing all of these
things but it's pretty cool I got to
give the author a lot of credi
their preference of which net mode to
use it will log the output of if config
to a log file for debugging just like I
had mentioned another great best
practice it does a led W very fast so
that's that's not really a standard led
value it would be like LED stage 1 or
LED attack would be a standard one but
white very
hey I mean as long as it spelled out
clearly in the documentation who cares
right so at this point what it does is
uses IP to figure out what the link is
and then it goes through a huge section
here to figure out you know the best IP
address to use and you know as opposed
to mine which just hard codes to eth1
the rest of it is actually doing a
little bit of checking and has IP six
support which is great and then finally
we actually get down to the point where
we do the scanning now of course all of
these n map options could have as well
been variables at the top and there's a
couple other nuances here that I might
have done a little differently like the
subnet section here automatically
assumes it's going to be a slash 24
whereas I think my example there just
went ahead and used whatever I was
actually getting from the IP command I
think that might be a better way to do
it but still this is the beauty of this
also being a open source payload anybody
can get in here and make a modification
and commit it to our github so that's
good stuff so I just wanted to point out
those best practices and this payload
from info 'scrimish you can actually
check out info scrimmage comm this is
the author and I've gone ahead and
contacted the author to let them know
like hey thanks for contributing and I'm
gonna send a hockshop comm gift
certificate and one of the difficulties
with that is there's no good way to get
contact info out of people that commit
on github so I've gone ahead and set a
pack five go to exhaust payload so if
you want to have your payload featured
then you can go ahead and link it there
and then it'll be in the queue and I'll
be able to take a look at it and beat
your it I'll send you an awesome gift
certificate as well and then I don't
have to go and hunt down everybody's
stuff through github the api's and melty
going you so with all that said I'm
Darrin kitchen I will see you guys next
week until then trust your techno west
if you've got a great idea bring it to
the web boy we do and head over to
domain.com
I can't tell you how many times their
domain discovery system has helped me
find the perfect name and they're quick
and easy checkout process means it's
online in no time flat and get this the
guys over at domain.com have been
supporting hack 5 for years and they
want to hook you up get 20% off at
checkout at domain.com with the coupon
code hak5 and send your thanks over on
twitter at domain.com so when you think
domain names think domain.com</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>