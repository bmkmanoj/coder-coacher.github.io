<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Basic MSF Console Commands - Metasploit Minute | Coder Coacher - Coaching Coders</title><meta content="Basic MSF Console Commands - Metasploit Minute - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Basic MSF Console Commands - Metasploit Minute</b></h2><h5 class="post__date">2014-03-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/gWKyFYMY_Pk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">basic commands this time on Metasploit
minute this Metasploit minute is brought
to you by hack 5 and viewers like you
support us directly at HHH all calm
welcome to Metasploit minute the
breakdown on breaking in I'm your host
Rob fuller but you can call the movers
today we're going to be going over the
basic commands from MSF console first
and foremost we are definitely going to
have to show you how to get the car so
here we go so all you have to do is type
banner sit and just keep going until you
get that cow because that's the only way
anything is ever going to work or you
can exit we have a session so let's see
let's just get the banner might take a
second that we good so now once we have
the banner that the cows a banner the
one that we actually want to use we have
to then look at what other commands that
we can use so unlike what I said in the
last segment to get to show the commands
in an MSF console you can do a question
mark a lot like a Cisco router so if you
go up you can see there's a ton of
commands but the one you're going to use
the most is use so use and then you
start using the things that you have so
we're going to type banner one one more
time and you can see that there are
exploits auxilary modules post modules
payloads encoders and knobs so the cool
thing about this is is is is based on a
directory structure so if you look at
we're going to be using the PS exec
module so if you look in here you have
the MSF or Metasploit directory then in
modules exploits windows SMB and then
there's the PS exec that we're going to
be using so use Windows or sorry
exploits windows SMB PS exec that's it
now we're in the PS xxxx module now I've
gone ahead and set a few shows show
options to show what's already set and
what options are available now I've set
a few options here already
like the IP address of my target the
password the username that I'm going to
PS exec against and then the payload now
I really don't like reverse TCP because
it's a straight TCP connection and will
rarely get out of most organizations so
we're going to actually change the
payload to something else we're going to
say set or yet set payload now you can
use these options as lowercase options
but I would recommend sticking with the
uppercase option just simply because
there are other things that inside the
Metasploit can go wrong if you don't use
all upper cases so set payload or use
the the case-sensitive version of
whatever options you're using payload to
Windows interpreter reverse HTTP so
we're going to switch that now you can
see that our options are similar l host
and L port so we're just going to change
the L port to 443 then so we've set
different things now what we need to do
is exploit exploit has options as I said
anything with - you can do - H and you
find different things with it so I'm
going to exploit - J now what that does
is sets it as a job and we'll see what a
job means in a second so well it's going
I can actually run other things while
that's going and hopefully in a second
get a payload out of this yeah maybe not
well that didn't work
but up there it is cop just had to wait
a second so now that we have a session
we can do sessions and see our different
sessions so in auxilary modules what you
want to do is use run so you have
exploit in exploit modules and all the
auxiliary modules you want to do run and
then in payload modules you actually
have another command you can say
generate so now let's take a look at
another command one of the things that
you'll get intimately familiar with once
you start once we once we start actually
making mate
payloads is IRB and edit so IRB if
you've used Ruby before is the
interpreter for Ruby and the great thing
about IRB is inside of Metasploit is
it's in the context of wherever you are
so if you're in a session so we're going
to do sessions - I and let's do a help
real quick to show you what those are if
you do sessions that I which says
interact with it and we say one we want
to interact with session 1 which is
right here we can do IRB and that puts
us in the context of our interpreter
session so now we can basically run any
Ruby code that we want a loop an if
statement anything that we want straight
in in Ruby on the host it is now it's
not executing the Ruby on the host but
it's executing in the context of
interpreter so if you want to upload a
file or download a file or do a bunch of
other things and we'll be talking about
that when we actually make modules you
can do that straight from here so let's
do a quick one client dot and that's
specifying the client dot railgun and
we'll be talking about what we all gun
is dot user 32 that's the DLL that we're
going to be talking to
I think it's loc workstation if we were
on that system what we actually did
right there is lock that workstation so
it went to its login screen so that's
cool stuff that we can do with railgun
we'll talk about that later but what if
we wanted to edit a file so let's do an
LS real quick oh that's in system 32
which is not a good idea so let's go to
C colon directory see there's dialed
back let's edit dial that what that I'll
do is get us straight into a into a
editor of our choice and as soon as we
exit out of it it will first download it
so that we've netted it and then uh pre
upload whatever options that we have so
cool way to edit a file directly on the
target host if we go back if we go
background into this if we type edit
here we're actually editing the MA
jool inside of Metasploit so if we make
changes it will automatically get
reloaded so if say we wanted to change
just for instance we wanted to say this
isn't Microsoft oops
I kidding how do you yeah yeah yeah
there we go this is Bob and then stupid
vai right quit so now it's changed so if
we do info on it you have to reload so
reload and then info please scroll up we
now have Bob's windows authenticated
code execution cool stuff so when we
start making more modules and writing
things we'll we'll be using this a lot
so that we can we don't have to jump out
of our stuff before another fun one is
load now load actually loads plug-ins
for Metasploit and there's a bunch of
little different plugins if you just tab
complete it you can see some of them if
you're in the directory structure you
can do plugins and list them there these
are there's a lot of cool plugins one of
our favorites one of my favorites is the
sound plug-in written by oh this guy
named digi ninja you might know him as
Robin wood let's see if he'll make a
sound okay so it's not making a sound
for some reason but if you had your VM
directly connected to your your output
and it wasn't muted it would actually
make sounds it actually makes sounds
even every time you make a connection to
a session so next up that so that's load
and in the context of mature processions
- i1 load incognito it actually loads
extensions onto meterpreter so different
context means different things and it's
kind of a little bit confusing but
there's only really two contexts inside
of a module or inside of a matter
procession the next one that's fun is
save
now save say I want to do a lot of demos
and I want to make it so that I can get
back into that demo really quickly well
save saves your configuration the the
current settings your your variables at
a global scale your variables at a
module scale into a file the slash
config now real quick let's look at
what's in that file now you'll see that
the file changes are the file things are
the the configuration of things that are
in here are the module I was in the
different options that were set and some
of these you didn't see just because
they're Advanced Options and that's
pretty much it and it shows you what
active module I am so if I exit out of
this and say yes I don't want to I don't
care that I had sessions and I go back
into MSF console what we should be is in
that module with all of those settings
alright so we're back in show options
and for some reason none of those
settings are there awesome that's weird
oh it didn't even save the SMB client
okay so that's a bug and we'll submit
that as a bug later so what if that
happens though what if there are things
that don't don't save correctly so let's
set SMB user and this is the next
command we're going to talk about so
let's save let's let's show you a
different thing so let's set SMB user to
administrator set SMB pass to that so
options that show options see if
everything's set correctly exploit logon
type not granted weird okay but it
created a session for some reason
whatever it worked all right
if we type save it's going to do that
same thing if we look back into you know
it did save that SMB user and pass the
but let's say it didn't we can do a make
RC and when we talk about resource files
in another segment but what this does is
takes all of the commands that you've
typed since you started every single
step of the way using bunch of different
modules bunch of different steps and
creates a resource script and you can
load these resource scripts in a bunch
of cool ways so we're going to say make
RC exploit example dot RC added all of
those nine commands we go into our
Metasploit directory because that's
where we are
exploit example and there it is those
are all the commands that we typed from
start to finish and what we want to
definitely do is remove make our save in
our maa RC all right so those are some
of the commands and we've exploited our
first box we created sessions how about
searching for other modules now what we
could do is simply go in the modules
directory and find or grep or anything
else we wanted to do it's quick easy
command line anyone who knows UNIX can
do that kind of stuff but there is also
a search inside of Metasploit that you
can search for things so if we wanted to
search PS exec and find it all of the PS
exec modules now we can see that there
is a bunch of different modules that do
PS exec and they're in different
directories so there's an auxiliary
module that does PS exec and exploit
module the local exploit that does P
exec so that might help us find things a
little easier than what we might have
done with with the modules directory so
sessions we've already kind of gone over
but there's a bunch of things you can do
with sessions including terminating
sessions detaching interactive sessions
listening sessions quiet mode all these
other cool fun things and then finally
jobs now there aren't any jobs right now
because we haven't set up anything to
run in the background we did with our PS
exact real quick second ago so that we
could show it but let's say as an
attacker what I don't like doing is is
setting up a handler every single time I
do
an exploit what I want to have is a
handler just listening and taking in all
of those exploits all of those
connections back by themselves so what I
will do is use exploit multi handler so
this multi handler will will take all
those payload connections in we set our
payload in here Windows interpreter
reverse T HTTP it's going to take a
second to load it set our options so l
host so what is my IP address if you do
if so 128 some two one six eight one six
one oh two dot 128 set L port 2 4 4 3
set exit on session so this is the
important part
set exit on session to false that way
we're actually not going to close the
handler after it's done and then exploit
- J makes its job now anytime we get a
session in it's going to go to this
handler that way we can get a ton of
sessions in really quickly and never
have to deal with it so jobs - V and
there it is when we go into a lot more
of each one of these commands and I want
you to just have something to play with
initially so let me know what you think
hit me up at MSF at hack 5 org stay
tuned the Metasploit minute comm for
more shows like these thank you again
for supporting the show if you have if
you want to support us even more you can
go to hack shop calm a JK shop calm and
enter the code move X to get some free
Metasploit minute stickers until next
time on muack sand I'll be hacking til
the cows come home
Oh</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>