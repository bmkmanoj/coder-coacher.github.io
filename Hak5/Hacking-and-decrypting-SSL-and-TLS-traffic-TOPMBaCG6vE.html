<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hacking and decrypting SSL and TLS traffic | Coder Coacher - Coaching Coders</title><meta content="Hacking and decrypting SSL and TLS traffic - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hacking and decrypting SSL and TLS traffic</b></h2><h5 class="post__date">2008-07-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/TOPMBaCG6vE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so Darren last month we demonstrated a
man-in-the-middle attack using Cain and
Abel and other real yeah but like we
else have said you can always secure
yourself by using something like Gmail
which uses SSL be exactly right so this
month we're going to take it a step
further by doing a direct attack on the
SSL protocol and show you how to decrypt
SSL v3 and TLS traffic that sounds like
a lot of fun but I can't hack on an
empty stomach let's go get a bite to eat
and then you can show us how it's done
okay
all right we're back from lunch
Harrison thanks for coming back on the
show how are we gonna perform this tap
like what's involved okay well first of
all we're gonna be using WAP --ax I use
WAP exertion 2.7 and that's just like
Knoppix it's a Linux live distro it's
based on it's based on Knoppix the
author of the program basically he was
he's a security auditor and he was doing
it audit for a company and they said he
had to use their computers and he
couldn't install anything so I mean how
you gonna get anything done right so he
said all right well now I'll play by the
rules and put all of my tools on to this
one la topic CD and all my exploits
basically boot off the CD and I got a
you know a portable hack toolkit now
that's not the only portable hack
toolkit there's a Knoppix STD yeah
auditor flak flak
what does flak stand for thank us Wes
thank you okay
so there are a bunch of different
toolkits all right so we're booted into
optics what's the first thing we need to
do okay well the first thing we're gonna
do is run a program called frag router
and this is gonna route the IP traffic
so that once we perform a
man-in-the-middle attack it's
everything's flowing in the right
direction great okay so once we've got
that done I just assume we start the arm
yeah exactly we're gonna use as opposed
to Cain and Abel we're gonna use our
booth okay this is a command-line tool
and we just enter the target address who
were going to ARP and the Gateway and
that will position ourselves in between
it all right now that's not all that's
involved in your attack those no man
line exactly since we're not yet came in
Abel does that automatically but since
we're using a variety of tools the next
thing we have to do is DNS spoof and
that will complete the attack and it
runs silently okay so once we've got DNS
spoof we're pretty much sit between them
we can see everything that's going on
exactly we need to get the SSL attack go
here well this is the heart of the
attack what we want to do is use a tool
called web mi TM which stands for man in
the middle to create a spoof certificate
and it's going to sit on the network and
just listen and as soon as it the the
user tries to attend our attempts to go
onto a secure site
that certificate is going to come to us
and it's going to stop go no further
instead the user is going to be getting
on our fake certificate
big stuff it exactly and then what we do
is just pull up other real sit on the
network and sniff up all the traffic and
as soon as the user you know enters
accepts the certificate and this is
password we're gonna see web MIT M it's
gonna start getting a lot of activity as
soon as that happens the next step is
just stop the other wheel we can stop
saving it don't finally we don't need
okay so so we've sniffed up the traffic
we've seen that they've gone to an SSL
site like Gmail right now what are we
gonna do we've we've got encrypted
packets right well here's here's that
here's the key we can save that at the
real traffic and then use a tool called
SSL dump now what that does is uses a
combination of the encrypted SSL traffic
that we sniffed up plus the key pair
because we created this activity we
created the certificate so it's an
encrypted key pair between us and the
user so we have all the information that
we need to decrypt it
so SSL dump we'll just do that all for
create it all in and dump file then it's
a simply a matter of grepping alright so
what would we grep you can grab only you
can grab a combination of things till
you find the right the right you know
passphrase or basically we're gonna look
for like passwd or PA SS or email
password all the things that might and
now it would be there in plain tech it
would be in plain text and not only
that's going to show us the string of
the string of traffic that actually
contains that you like the e-mail log on
and the past or logon is another one to
search for but all right okay so we've
got what said they were going to the
username the password yep then you know
you've completely owned the box
now there's one problem with your attack
here and that is when you go to when
you're the victim of this attack you're
gonna get their fake certificate and
that's gonna pop up and say hey you're
trying to go to gmail but this
certificate just isn't signed it's not
correct you know what do you want to do
and if you click yes well then you've
accepted the fake certificate actly so
you're relying on users it's kind of
like a phishing attack it kind of is and
if you examine the certificate and show
the details it'll say it's not a trusted
certificate and you can look at where
it's from so there's nothing that's how
you protect yourself don't accept it was
even sources but hopefully next month i
can one-up you oh no you're not gonna
want that again just remember embedded
objects are your friends
sounds like fun alright so if you'd like
any more information
about any of the stuff we talked about
here go ahead and head over to the
shownotes hak5 org</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>