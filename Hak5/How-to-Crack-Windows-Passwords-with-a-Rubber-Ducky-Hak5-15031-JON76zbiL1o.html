<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to Crack Windows Passwords with a  Rubber Ducky, Hak5 1503.1 | Coder Coacher - Coaching Coders</title><meta content="How to Crack Windows Passwords with a  Rubber Ducky, Hak5 1503.1 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to Crack Windows Passwords with a  Rubber Ducky, Hak5 1503.1</b></h2><h5 class="post__date">2013-09-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/JON76zbiL1o" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this segment of hak5 is brought to you
by domain.com
hello multipack v my name is Gerren
kitchenette and this is your weekly dose
of Technol estan very exciting community
antastic episode for you guys Shannon's
going to be joining us to talk about
ways that we can own our own cloud
that's right
just talk about own cloud and then I'm
gonna be talking about ways where you
can recover your windows Password just
in case you forgot it very quickly USB
rubber ducky payload gets Windows
passwords 15 seconds no need to even
crack anything it's just it's stupid
easy I I I need a drink I'm gonna I'm
going to the Baltic for a brew but you
guys should come with me cuz we're gonna
crack windows pastors feels like that's
what we've been doing for less eight
years crack and windows bastards
whatever you got to do one of those yeah
it is so what we're going to do today is
recover a Windows password no cracking
necessary and about 15 seconds for the
USB rubber ducky honestly the ducky is
not necessary for all of this stuff I
just love the whole concept of
automation and I thought that this would
be the perfect example of setting the
duck in a twin mode where we can
actually mount it as both mass storage
and as a human interface to device to do
our little typey typey attack so to
preface all of this basically the
concept is to recover passwords and
there's a couple of different tools to
do that I know in the past historically
we've talked about things like PW dump
and tools of that those nature's where
basically we get like the Windows Sam
file and then we run that through a
cracker and you know either using like
rainbow tables or other or sorts of
tables or you know just brute force John
the Ripper style we can end up getting
you know brute forcing to either that LM
or ntlm hash and then recover the
password and that's all really fun
except there's an easier way it turns
out using something like the windows
credential editor or mimic hats and that
these tools basically allow you to pull
the password right out of memory
so that's really fun let me show you an
example here pulling up a command prompt
bypass UAC and go to my dev folder and
WCE or windows credential editor is a
tool that will allow you to very simply
by do WCE tak w we will go ahead and
show my password there we go my user is
DK the name of the computer is DK z3 and
my password is of course lame password
so what I'd like to do now is basically
write a ducky script that will automate
all of this and save that back to the
microSD card on the duck see I know that
just a few weeks ago we talked about
doing exfiltration with the duck which
is a lot of fun and this is the perfect
example of the kind of exfiltration
techniques that you might want to use on
target system during your pen test
because you're able to very quickly like
15 seconds get that password and save it
onto the disk so then later when you're
on the network you can connect to it and
you know backup all that fun data so
like I and I want to give props over to
red meat UK here for being the first one
to kind of bring this up in the USB
rubber ducky forms and I wanted to
expand on his technique here and
actually show how to do this using some
of the alternative firmware so see this
is one of the most beautiful things
about the USB rubber ducky project is
that you know we can actually use
alternative firmware it's an open-source
project and and it's really come a long
way so props to midnight snake props to
D n ucn a I don't know how to pronounce
that as well as over F if you head over
to ducky decode its code
google.com/chrome is ducky decode you
can see here this isn't another version
of the ducky both firmware and encoder
the firmware adds things like
multilingual or sorry the
things like multilingual support for you
know the US Great Britain Germany you
know French and all of that and that's
really cool and firmware wise there's a
lot of awesome options in here so for
example we can you know support multiple
you know support heads on Windows Mac or
Linux we can also do mass storage which
we're going to do today we can do
multiple payloads which is cool there's
a version of the firmware where based on
if you have caps lock enabled or scroll
lock or num lock enabled you can have
different payloads execute or
concurrently so that's a really cool
feature I like and then we can do
composite stuff but oh another awesome
one I guess we'll get into when I just
dive in but vid and kid changing which
is really cool every USB device has a
vendor ID and a product ID and if you
change those you're less likely to you
know say discover that it's a duck I
mean every duck has the same vendor ID
and Product ID it's kind of like the MAC
address for physical access right so you
can spoof your vendor and product just
like you would spoof your MAC address to
say look like a different kind of device
which is really cool so I've gone ahead
and flashed this duck
with the firmware for this version for
twin duck version 2.1 okay and this is
going to allow my device to show up as
both both mass storage and as a human
interface device and it's going to type
my payload so a little bit of a caveat
here is that your payload is going to be
is going to need to be under 2000
keystrokes which actually thus far has
not become an issue with any of the
payloads that i've seen even with you
know the reverse shell kind of stuff
it's not that much of an issue the
limitation there is that it reserves
your payload and actually the first four
kilobytes of memory on the duck before
it switches over so it's really cool
stuff and props to everybody involved in
the source code there to make that
happen
midnight sneaking and it's really just a
fantastic example of what can be done
with you know controllers hacking
devices and things that
nature the other caveat here is that the
right speed on this device is about 150
kilobytes a second which is not huge but
for text files for what we're trying to
do here it's going to be fine so let's
go ahead and dive into this payload so
this is based on code from red-meat UK
and shut in and die Fuuka and basically
this is my twist on it which allows you
to use the twin duck from wear that I
mentioned to run mimic cats and save it
to the SD card as the computer name
passwords txt which is great because
that limitation of 150k a second isn't
really that big of a deal for just a
text file of my password so same as last
week we're going to quickly bypass UAC
using this bit here it's just you know
pulling up run and hitting that and then
alt Y and Bob's your uncle from here I'm
going to go into my dev folder and the
rest of it is this quick loop here which
basically does just like last week it
finds the string ducky in a wmic volume
get and so that's going to figure out
the drive letter of the SD card since
it's actually going to mount as both
mass storage and show up as a human
interface device now I set that using a
set duck equals so now the day so duck
becomes a system variable and we can use
that here in the last part where we
basically execute mimic cats so off
percent duck percent which on my system
is sometimes h : backslash but on your
system it's going to be I don't know D
or F or e we're going to run mimic cats
alpha X 64 so when you download mimic
cats you'll notice that there are
basically four different versions
whether it's for NT 5 or NT 6 and
whether it's for 32-bit or 64-bit so
mimic cats is really wonderful because
it will target a you know just a huge
wide swath of machines you got anything
from Windows XP all the way to Windows 8
both 32 and 64 so it's pretty awesome
and I'm going to use a little Walker
here to send the output of that over to
again percent duck percent so and you
know our Drive and then percent computer
name present which is you know in my
case decays III or whatever in the name
of your computer is - passwords txt
delay for just 100 milliseconds and
we'll run these commands let me show you
in here follow along and go to the alpha
and x64 and the thing about mimic ATS is
it's really awesome this all of the
props for this go to gentle Kiwi so hit
him up on Twitter some love because this
is a really sweet tool he's French it's
in French so deal with some French
commands it's all good
so within mimic hats what we want to
enter is privilege : - : debug and then
we'll enter in a secure LSA : : logon
passwords full and real quick you saw a
bunch of stuff go by if I scroll up you
can see there it is lame password I know
it's a horrible password don't use it
but for illustration purposes there we
go we now have my user my machine the
domain the LM hash and until I mash if I
were trying to like pass - or something
like that but there we go that's min the
cats and then we exit so when we do all
of that piping to a file as we're doing
right here will now have on the SD card
just a quick little text file of that
and this is beautiful because it's using
the % computer name % variable we can
now just go ahead and plug this into all
of the different machines and back up
all of their passwords real quick and
easy so with all of that we pretty much
just GTFO and do two exits one to get
out of mimic cats and one to get out of
our command prompt and then we leave
nothing on the desktop for the user when
they come back from the washroom and
they find out that they should really
learn Windows key l before they walk
away from their desk but you know that's
that so let's go ahead and try this out
I'm going to go ahead and insert my duck
and you'll see that this happens just
extremely quickly in fact let me open up
my computer so you'll see
the the drive shows up becomes available
you'll see that it's labeled ducky
so you'll notice the LED is slightly
different and that's because we're using
the twin duck firmware so you get a
little green and red action here we now
have our ducky drive show up and since
I'm using my vendor ID and Product ID
changer the vid pit bin which you put on
the route and show you that in a minute
will it will actually go ahead and
install the drivers because this is
literally the first time I've plugged it
into this machine so with that said I
could either unplug it and plug it back
in now the drivers are set or I could
just press the button to redo the
payload so I'll go ahead and press the
button and there goes my payload
bypassing UAC and this is going to
happen real quick found it's a colon in
this case and we're done and so if I go
into my ducky drive II here I mean at
this point I can just walk away we're
done we can go back to our machine and
do the rest of the work but I'll just
show you on this machine here on the EE
Drive you can see now I have a DK z3 the
name my computer - passwords txt I go in
there and there's my password it's that
simple
I feel really bad because this is just
too easy
so the vid pinch whopper is a nice
little utility that will allow you to
quickly create both your vendor ID and
Product ID randomly so that they're
different every time you use them which
is really great you look at the text
file here you'll kind of figure out how
its laid out but let's go ahead and copy
these guys to my route this is the route
of my ducky drive right paste that in
there
because it takes a second because it
does transfer pretty slowly has mainly
to do with licensing issues with the
duck and if being hella expensive to do
really fast stuff and honestly for our
uses is going to be fine but basically
all we have to do is run the Pitts
whopper and we now have a bit and Pitt
dot min and we could delete this and run
it again and we'll get a different one
it's pretty fantastic it's kind of like
mac changer I love it all right so now
whenever will use this duck we're always
going out you know we're going to use
that vendor Product ID which is a really
cool feature of the twin duck so yeah
there's my text file and now we're able
to you know extract passwords from
windows machines in just seconds here's
the thing if you haven't figured this
out already both windows credential
editor and Emma cats are going to get
picked up by antivirus uh uh so when we
get back we're going to do this again
and not flag antivirus cuz that's way
more fun budding entrepreneurs startups
and innovators are all turning their
ideas into realities online backed by
the strength of a dotnet domain that's
right
Nets they are globally known it is one
of the most popular domain extensions a
dotnet domain injects your business with
instant credibility and entrepreneurs
and startups are immediately discovering
the advantages of building the web
presence on a dotnet domain and if you
already have a dot-com well you can
purchase the dotnet to protect your
online brand or if the dot-com you want
is already taken you don't want to
register a.com neh and that's like 25
characters long don't worry the dotnet
is the perfect alternative you can find
a new dotnet domain over at domain.com
I love the domain comm folks because
it's affordable dotnet are only $8.99 a
year they're totally reliable easy to
use plus they're huge on social media
you can tweet them at domain.com and
twitter they have great customer support
it really just makes it a fun place to
do business and get this the guys over
at domain calm they want to hook you
guys up because a huge fans of hack 5
they want to give you 15% off their
already affordable domain names and web
hosting when
use the coupon code hak5 at domain coms
check out that's 15 percent off and
big-time savings so don't forget to use
the coupon code hak5 when you think
domain names think domain.com last
week's trivia question was Ronald Rivest
authored what cryptographic hash
functions and the answer that I was
looking for is MD 2 or 5 in MD 6 now
this week's question is the Merkle tree
that's an awesome name was named after
wet security researcher and developer
you can answer that at hack 5 dot org
slash trivia if you're a chance to win
some awesome hack 5 goodies good luck</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>