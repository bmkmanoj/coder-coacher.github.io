<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Introducing Interceptor: The network tap and rogue wirele... | Coder Coacher - Coaching Coders</title><meta content="Introducing Interceptor: The network tap and rogue wirele... - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Introducing Interceptor: The network tap and rogue wirele...</b></h2><h5 class="post__date">2009-03-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/zno4lkg-Sfw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this episode of pack 5 is brought to you
by godaddy netflix and Squarespace
Moneypenny take mmm mr. Wright once
again my name is Becky right whatever
let's begin to whom it may concern I the
fabulous mr wright recently purchased a
bottle of old jews and about an hour
after the taking the supplement i happen
to develop a rather humongous scratch
that a rather large alone second dr.
schiessen gabar yes I took the ointment
no it's not working it just gets bigger
and bigger and my boys I got flower
delivery for a becky stewart excellent
secret admirer oh my god how exciting
yeah is that little guy oh right I
almost forgot this is the admirer monkey
it goes with the flowers what's with
this hands it plugs into your computer's
internet and when you go to the profile
page of her your secret admirer on like
Facebook he lights up and plays a song
for you oh my god was sling for my nuts
does he work on my face uh yeah I think
so does he work on viva and nobody uses
bebo oh yeah thank you Oh sing it I
can't what I'm will be like a god damn
penguin over here okay i will stop
yelling at you when you actually
prescribe me something that works not
makes my balls
yes yes dr. schiessen gave her I'll make
sure she finds it Moneypenny have you
seen my ball cream you know the one for
my extra large balls
this once LAN party is insurgency modern
infantry combat we're playing over at
insurgency hak5 org on March 28 at three
p.m. eastern and if you're not too into
the whole insurgency thing you can go
over to hack five land squarespace.com
and vote for your favorite land game and
I have to thank our wonderful sponsor
Squarespace Squarespace is a publishing
system for anyone looking to build a
blog portfolio or any kind of website
they power large businesses to blogs and
Squarespace gives the opportunity to
build pages that are just as powerful
and flexible as those of the big dogs
and you can go over to squarespace com
right now for a two week free trial
membership and you can also use code
hak5 that's hak5 for ten percent off the
life of your service interceptor is the
network tap that mirrors a wired
connection over a rogue wireless access
point well we may have become
significantly paranoid about pineapples
owning our wireless traffic too often we
take for granted the security of our
wired networks whether a homework or
abroad the prospect of a
man-in-the-middle attack poses a
significant threat especially when
dealing with unencrypted communications
hackers and pen testers for years have
exploited the nature of the network by
becoming the man in the middle using
techniques such as ARP cache poisoning
and network administrators have used
sniffing tools like Wireshark in
conjunction with network taps to
troubleshoot congestion but these tools
and techniques require a level of access
and presence that isn't always viable so
what if there were a device that could
sit in line on a wired network passively
monitoring the packets and what if this
device came with a rogue wireless access
point that an attacker could access and
they she ate a private tunnel and tap
into that traffic this device would be
small with the ability to sit behind a
network wall plate or inside a cute
plushy with the ability to social
engineer secretaries or maybe it could
attach to the back of the pc with a
phony telephone company logo and all the
while the attacker could connect
wirelessly from the convenience of a
black van parked outside the corporate
office and peer past the fire
without notice unobstructed to latency
or time to live with the same wireless
security built to keep the black cats
out this little device can stay in
stealth mode from nine to five then at
the drop of a hat go from passive to
active strolling the network from the
inside out the device I speak of is none
other than Robin woods interceptor and
today we'll be building one bad little
monkey in the middle so let's get
started first we'll need a wireless
router with two or more Ethernet ports
capable of running our favorite embedded
OS open wrt for this will be using the
Oso hackable phan + these little guys
were designed and manufactured by act on
and come flash with custom font firmware
the basic idea is that they let you
share your internets with fellow Fionn
arrows and in turn borrow a cup of
packets from other fin arrows while on
the go it's a noble idea and a great
community and we're happy to see these
little creatures in the wild but as
always we've got plans for this little
router using the power of fair use and
the ancient art of ninja hacking skills
will unlock this little fanara install
interceptor stuff it inside a plush
monkey and weaponized a little guy but
first a quick look under the hood fun
plus runs on a lockdown version of open
wrt it requires seven and a half volts
of power and runs on a 183 megahertz
MIPS processor has 16 megs of ram 8
Meg's of flash dual 10 100 megabit
Ethernet ports and speaks 802 11 B and G
he also sports a serial port which is
great for unbreaking an omnidirectional
1.5 dbi antenna and a standard rp-sma
connector for more powerful antennas now
let's get hacking first we'll need a
computer a virgin Venera some Ethernet
cables ends with special software will
be doing this in Linux however you can
do the same in Windows or Mac as long as
you have pearl SSH SCP openvpn tftp D
and TCP dump or Wireshark all of the
packages and software used in this are
available at digi ninja org or in the
hak5 wiki before we begin we'll need a
copy of open wrt 8.09
theros vmlinux de lzma and root squash
FS in tftp d typically found in / tftp
boot now we'll begin by bringing up the
ethernet interface on our pc as 192 168
1 254 connect an ethernet cable between
the pc and fawn pluses land port and run
red boot PL 192 168 11 once we're
connected to red boot via telnet will
want to flash the firmware so issue fist
in it then load the kernel from tftp
with load tack our tech be percent free
memo open wrt atheros vmlinux lzma and
write the image with fist create tacky 0
x 800 41,000 tack r0x 840 1000 vmlinux
been l7 this takes a while so why not
take a break and have a banana they're
good for you next we'll load the file
system from tftp with load tack our TAC
be percent free memo open wrt tech
atheros tech root squash FS and write
the image with fists create tech l0 x 6
f 0 0 0 0 rootfs this part takes a long
while consider banana smoothie in a
blender mix bananas ice milk and your
favorite yogurt alright once our file
system is written will need to configure
red boot issue f config and answer true
to the first question then enter the
following boot script fist load tech l
vmlinux dl7 exec 1 a 2 second boot
script timeout no boot pig network
configuration no gateway IP address a
local IP of 192 168 1 dot 1 a network
mask of 255 255 255 does 0 the default
server IP set to 192 168 that one that
250 for a console baud rate of 9600 and
the gdb port at 9000 tell red boot not
to force console for special debug
messages not to debug network at boot
and finally go ahead
update the nonvolatile configuration
issue reset and the connection will
close from our pc will go ahead and ping
192 168 1 dot 1 we should receive
replies shortly telnet to 192 168 1 dot
1 and will be greeted by open wrt
kamikazes she'll issue passwd and type
monkey business twice now exit from our
pc will go ahead and ssh over to root at
192 168 1 dot one after accepting the
certificate well once again be greeted
by open wrt shell now we'll open another
terminal on our pc and navigate to the
directory containing interceptors
required packages will be SC peeing
these files over to the fon plus in /t
MP but you could also pull these
packages from a local HTTP server using
W get SCP start out ipk to 192 168 1 dot
1 and / TMP now back over on the fon
plus we'll use opkg to install all of
the packages in / TMP finish off your
banana smoothie will K mod ton lib lzo
lib openssl z lib openvpn lib pcap and
lib Dina are installed and configured
you may also want to include the Nano
packages and any other goodies like nmap
next we'll edit the wireless
configuration the important part here is
to set disabled 20 give the Wi-Fi
interface an SSID and set it to use wpa
psk two will also want to edit the
network interface here we set the land
to static bridge with an IP of 192 168
11 and an interface name of f 0.0 the
when will be called f 0.1 now remove all
entries from etsy / rcd pertaining to
httpd or DNS mask back on our pc will
want to grab the latest version of
interceptor from digi ninja org unpack
the tar and SCP the Interceptor mips
package to the fon plus in / TMP switch
back to the fun plus and install
interceptor with opkg now we can start
interceptor by issuing / etsy /a knit d
/ interceptor
start from our PC will need to create
openvpn keys if you're not familiar with
openvpn and key generation you can find
more details on our forms we start by
copying the easy RSA files to our
working directory and editing vars tweak
the sample configuration and we'll be
all set to build the keys issue VARs
clean all and build CA next issue build
key server server then build key client
1 and build eh at this point you should
have a bunch of Pama cert and key files
will need to SCP client one desert
client one key and cea cert 2 192 168
dot one dot one in / interceptor /
openvpn / client now create a directory
called certs where your interceptor
startup script is located and copied eh
1024 p.m. server cert server key and see
a desert there finally we're ready to
test interceptor plug the way and port
of irfan era into the switch and the
land port into a spare computer set it
to run a constant ping or any other sort
of traffic this is the target that will
be eavesdropping on shortly now back to
our pc will need to connect the fawn
over wireless so let's create a wpa
supplicant config file with interceptor
as our SSID and monkey business as our
password once that's complete issue wpa
supplicant tack DW EXT on tack I at 0
taxi my configuration file now that
we're associated we need to manually set
our IP address to 10 255 255 250 10 dot
255 255 255 for when interceptor is
ready to start demon logger now in a new
terminal run ifconfig and verify that
tap 0 is up tell TCP dump to listen to
tap 0 or fire up wireshark you should
now see all of the traffic between your
target computer and the switch that's it
you're ready to toss it in
oki weaponized little primate and start
pirating some packets monkeys e on land
monkeys say on wireless and when you're
done with your passive attack go ahead
and scan the network assign an IP
address and start hacking from the
inside out or send your monkey over to
the hak5 forms for more information
about phan + mods interceptor extensions
or other platforms that interceptor
supports this week's trivia question is
what two monkeys had the pleasure of
being shot into space atop an am 18
missile in 1959 submit your answer to
hack 50 org slash trivia and enter to
win this week's giveaway and I have to
thank our sponsor Go Daddy think you're
smarter than the rest prove it and you
could win big if smart space from
godaddy.com has changed the way you use
the internet the way you blog the way
you do business the way you live your
life create a blog or video story that
shows how you might just win 25 thousand
dollars in cash prizes and free smart
space for life so head over to
godaddy.com /s s contest and enter now
don't have smart space see what it's all
about and save an additional fifteen
percent off through april fifteenth 2009
make sure you use code space 15 so today
we have the pleasure of having our
friend Robin wood on Robin last time we
saw you it was at an aircraft carrier
when we're talking about Yas Agha what's
been up since I fingered with bench
foote cone up and play with a lot of
phones yeah that's your forte it seems
this particular hack that we're talking
about today interceptor is based on a
fond plus I was hoping maybe you could
explain to us some of the features of
interceptor and kind of how it came to
be right well then scepter as far as i
can remember came about from the last
talk on where we had all the fun plus
two wired network cards and a wireless
and we said well want to be a good idea
to use that as a network tap so since
then we do a lot of playing with it and
we'll come up with is a wireless wired
network top the idea is get the phone in
drop it in line or any bit of network
all the data that's going to cross the
two wired Nick's get spat out through
the wireless and can then be sniffed on
some other laptop or desktop somewhere
else now I think the idea of having that
rogue access point that's just sitting
in line is absolutely beautiful maybe
you could tell me some of the software
that that's involved the packages that
actually make it all come together well
initially the idea was just to use IP
tables and clone all traffic that was
going to cross the bridge on the phone
obviously we install it up and worked on
it not using the standard firmware I had
a lot of playing with iptables couldn't
get anything working so so looking
around some alternatives asked a lot of
people and the best thing we come up
with was package called demon logger
which is from Marty road shopping sirna
mitigators it's not and what that does
is you point at an interface and you say
clonal the traffic on this so started
off just cloning all the traffic off the
bridge onto at zero I'm trying to send
it out onto the Airways a lot of
problems with that couldn't get it
working again lots of asking round and
with some help from Marty and the guy on
the snort mailing list heater classmen I
think his name was we finally came up
with the idea of tunneling the data over
a VPN if you want to know why all this
is needed I'm going to put it all on the
website but for now unless anybody can
call it with some better way of doing it
this is the best that I can come up with
an eye on us a lot of other thief so
basically traffic goes across the wired
interface is cloned onto a openvpn space
sent through that across wireless and
off the VPN server on either end since
that ah puts it out onto an interface
that you can then watch weird sees feed
them or wake up now tell me a little bit
about the hardware of course your forte
hacking some funds we're doing with
one plus it's a beautiful piece of
hardware because it will run open wrt we
got that nice atheros chipset but is
that is that all necessaries is this
something that you could actually put
together on another piece of hardware
I'm well unlike yesica there are no
patches to any of the tribes or anything
like that so theoretically this should
work on any device with least two wired
interfaces and the wireless that will
run open to RC I'm gonna that's trial at
the moment but it's all just standard
package so I can't see why it wouldn't
work so Robyn since we have 200 megabit
Ethernet and a 54 megabit wireless
what's going to happen there when
there's a lot of traffic I something we
haven't fully tested yet but so the will
be limitations on this obviously up to
100 make traffic across the wired a
maximum of fifty four out of the
wireless you've then got to put on top
of that the openvpn which is going to
slow things down a bit I've got to do
some testing yet we're not sure whether
it's just going to drop packets or
whether everything is going to get back
clogged and things are going to start
dying on the farm obviously the fonz not
got much memory so it's only gonna be
able to catch a certain amount of data
I'm hoping what will happen is that the
the form will just start dropping
packets when it can't keep up and they
won't start delaying the net that
traffic across the bridge right it does
that then it's going to start getting
noticeable by users yeah I think it is
really this is a good thing to put in
place in between your target and the
switch and not necessarily in between
the switch and the router you might also
find it more easily depending on your
network closet or data center or whatnot
so I got to ask what are where's the
website where can we get the code play
with it and saw it on our own stuff and
discuss it they all kind of things going
to be going to fall digit inch to org
slash interceptor and if you want to get
hold me
d ninja at gmail com great and we've set
up the Interceptor forms that are right
there next to the yeas ago forms and
invite you guys to come out and you know
share your experiences playing with the
code and kind of come up with some ideas
for some new features because keep in
mind you know say like you you put this
in place on on your target and their
office is only open from nine to five
afterwards you can law again and while
you're on the network right yeah okay so
fond 2 point 0 beta any any ideas for
that we've got a hold of the hardware
it's just like the fon plus but we have
a USB port yeah I'd like to try an get a
portable video conferencing device
working so USB hope put a video out a
sound out or a USB headset and webcam so
you can drop it anywhere you've got
instant some video conferencing other
ideas just a storage device that you can
put on the network's turn up plug it in
you've got the wireless and the wired so
you put a big hard drive into it and any
other ideas that the viewers can come up
with we're open to ideas if you can
suggest something good to do with two
wired wireless and USB ports let us know
definitely yeah I mean some things that
come to mind RFID Bluetooth stuff like
that so we want to hear your suggestions
so you know hit up did you ninja hit up
feedback and let us know Robin thanks so
much for coming on we got to have you on
again in the future because we need to
talk about ear trumpet and all those
other fun tools that you've got going on
over there yeah definitely whatever guys
alright thanks so much for coming on
take care guys thanks I'd like to take a
moment to thank one of our wonderful
sponsors that keeps us on the air
Netflix with Netflix you can rent over
90,000 titles online including lots of
blu-ray with free shipping both ways to
your home and back they now have over 40
shipping centers so almost all
deliveries happen in just one business
day Netflix plans start at 499
and as a new member you can get a notice
two week free trial membership check it
out at www.kik.com /s 5 and please don't
forget the www are you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>