<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>A Ducky Script to Dump Windows Memory For Password Cracking, Hak5 1503.3 | Coder Coacher - Coaching Coders</title><meta content="A Ducky Script to Dump Windows Memory For Password Cracking, Hak5 1503.3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>A Ducky Script to Dump Windows Memory For Password Cracking, Hak5 1503.3</b></h2><h5 class="post__date">2013-09-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/HZY13jOcars" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">the segment of hak5 is brought to you by
the Ben Heck show so welcome back in the
previous segment we talked about
basically using WCE or mimic hats to
pull a Windows password right out of
memory see that plain text goodness not
having to use John or other tools to
crack out in T L M or L M hashes which
is really a lot of fun however it has a
downfall and that is it's easily picked
up by antivirus when I talk to some pen
testers they you know kind of run
through various iterations of versions
of it that have been packed in different
ways so you know that's going to work
for you that's great and that's awesome
too because this payload will run in
like 15 seconds or less so that's the
way to go however it turns out we can
actually do something very similar using
I love this a Microsoft tool in fact I'm
actually borrowing a page out of our
good friend Rob fuller mu vixx's book
from room 362 did an awesome article
here on using a Microsoft tool to go
ahead and get the clear text password
using mimic hats and this is so great
because it's actually using proc dump
yes that's right I think we've actually
talked about proc dump and some of the
other sysinternals tools way back in
2006 before sysinternals mark mark
something I can't pronounce his last
name join Microsoft and they became
Microsoft tools but essentially proc
dumped here latest version 6o is going
to allow you to dump the memory from any
process so let's go ahead and walk
through this because what I'm trying to
explain here is that we're not using
mimic ads on our target machine
nothing's going to show up on an SD card
that's going to you know bring up any
red flags and we're going to be able to
go home with on our SD card the
equivalent of the plaintext password in
a text file so here we go I'm going to
go ahead
and guess I'll go to my II drive because
that's my ducky drive and run proc dumb
else a CXC actually we have to do attack
a except eula tuk ma is going to allow
us to do a memory dump and in this case
we're interested in SAS SDXC and then we
just give it where we want to save it to
I'm going to say C colon backslash temp
or C colon backslash backslash else a
CMP
all right and so let's go back over to
my dev drive and we'll see there's my
dump so we're going to move this to my
mimic cats folder in the Alpha directory
x64 because that's my machine delete any
previous dump file that I have there
oops and move that dump file here okay
so if I dir will see that I have
mimicked cats as well as else ask dump
and then just as move expose this here
it's real simple we can actually use the
secure mini dump and then the dump file
to actually pick up our dump file right
here in nimma cats so the concept is use
your ducky to use a Microsoft tool to
create a dump file on the disk then take
that home with you and then back at your
hacker machine plug it in and then load
that dump file into memory and have
mimic ATS pull the extract the plain
text password from it so in that case we
run mimic ATS again and we'll do a
secure LS a colon colon mini dump and
then the name of our file which in this
case is else a CMP
all right we've switched to mini dump
and then a secure LS a colon colon logon
passwords full let's try that again
se que URL s
one calling logon passwords full and
there we go just as before I was able to
get my lame password out of memory
except it wasn't live on the machine
using mimic ATS is just my dump file so
let's put this all together I'm going to
exit out of this and we'll create good
add of and my duct encoder I'm using
duct encoder version 2.6 this is a
version of the community duct encoder
and you can go ahead and get that over a
ducky decode that that google project
that i mentioned earlier and the nice
thing about this is we're actually able
to we're actually able to encode for
multiple different languages here and
since I still have if idea are equal and
backslash I still have my ducky mounted
as mass storage so we're just going to
go ahead and write that inject stop in
right onto the SD card on the duck
without having to use like a USB two
micro adapter so this right here is very
similar to the previous payload that we
looked at we're again going to bypass
UAC we're going to define percent duck
as the ducky volume and then we're going
to execute proc dumped out exe with
those parameters that I mentioned we're
going to save that process dump in the
duct drive as computer name underscore
else a CMP and then we're just going to
exit that's it
you know once we've once we have that
dump file we can again just as I just
showed you take that SD card over to our
Eric machine run that into mini cat mini
cats and these are the commands as I
just showed you to go ahead and extract
that so to get this onto our duct let me
go ahead and do go ahead and encode it
straight on if I my dir ecoan backslash
start out then you'll notice here I only
have the vid Pitt bin so I need to put
the inject up in on here let's encode it
directly from the duct encoder so Java
attack jar encode jar attack I in fact
let me just do this you can see you know
tech eyes for the input file technology
for the output file tech L is for the
language and these are defined in this
directory here in resources so if I dir
resources you'll see we have you know
these different properties files for
these different keyboard layouts and the
difference here is because like you know
on cell like some UK keyboards semicolon
will be like a pound symbol or things of
that nature and so some of those things
change based on language and so this
kind of takes care of that which is
awesome it also if I run that again you
have some additional keys that you can
use for example alt shift and then any
other key so for like alt shift enter
you can use repeat which is really cool
so you can say if you wanted to have it
press down a hundred times your ducky
script may say down arrow and then the
next line would be repeat 100 there you
go
rather than just having a really long
text file I love that this is the cool
kind of stuff
this is why it's open source and I'm
stoked to be able to show you a prime
example of using this here so let's go
ahead and get our encoding on so Java
TAC jar duct encoder our input file is
else ass dumped exe that's their payload
that we just did attack o will be e
colon backslash inject bin tak l4
language us
buzzer phobia oops
attack I there we go all right so that's
all complete and if we go to e : they
are we can see there it is so we have
everything set up let's go ahead and do
the demo I'll open up my computer so you
can see as I remove the ducky the drive
goes away and now if I just plug this
back in again this is really beautiful
because this is going to not throw flags
on antivirus because we're just using a
Microsoft hood notice again since I did
change my vid and pit takes it a moment
because it just registered the device
again and the drive now shows up here we
go it's ready to use and it will start
executing our ducky script very good
there a little UAC guy pass on and head
over to our ducky drive and except you
load and dumping the else ass over to
the duck we'll see and so here's
something interesting that you'll notice
it says writing 42 megabyte writing 42
megabytes
I think I mentioned at the top of this
that it's actually a how big is it it's
a 150 kilobytes per second is transfer
speed so if you do the math this is
actually going to take five minutes
that's a trade off
it doesn't flag antivirus it does take
five minutes now there's a whole lot of
ways that we could make this cake we way
less time if we use the network or a
couple other fun ways to get around that
first of all if we wanted to we could
SFTP this or FTP a tour email that are
several other methods using the duck to
get this file back to home base so that
we can actually run it through our
cracking tools so I just wanted to kind
of like point that out and I wanted to
talk about going further with this
because this is one of these where I'm
really excited and interested in what
kind of ways that you guys have thought
of of what
to kind of trim this down I'm not
necessarily sure exactly how much of the
else asked memory dump that mimic hats
is actually going to need so if there's
a way on Windows to kind of graph out
the good bits we could technically bring
this home much quicker the other obvious
thing that we could do is using a second
USB Drive just as we did in the previous
episode with you know backing up large
amounts of data and this is why I like
to use a larger Drive a larger secondary
USB Drive because you can take advantage
of you know fast write speeds of like
say USB 3.0 you know there's that so we
could always use that method as well
there's one other method that I wanted
to talk about and I wanted to give props
over to boost frac because boost frac
has written and it's up here on his
github a ducky else asks dumb that goes
ahead and uses the network and sets in
his code here it's a ruby script it sets
up the listeners it sets up everything
you need so if you've got a box back
home waiting for this you can just right
over the network real fast
I love all of these off options there's
lots of really cool opportunity here to
finesse this so I'm excited to hear what
you guys think about ways that we could
make this payload even better and
regardless of if you have a dog this
should be really hopefully useful just
in case you forget your windows Password
need to recover it well with that I'm
almost out so I'm gonna head back to the
studio we'll wrap this up
join modding wizard Ben Heck and friends
that they modify and build a host of
amazing community inspired creations and
be sure to watch new episodes of Ben
Heck show each week right here at
revision three.com slash t VHS in the
latest episode of the Ben Heck show Ben
works on a quadrocopter
so don't forget to go to element14.com
slash T VHS and find out how you can
enter to win the latest builds from
Ben's show well that just about wraps up
this episode of high five before we get
going I wanted to thank everybody for
supporting this awesome USB rubber ducky
project as you guys know we released a
little over a year ago and it has been
so cool to see how far this community
has grown I've been having so much fun
writing payloads and through iterations
of the generations of the hardware and
economies of scale and all those things
we've actually been able to drop it for
like way less than even half the price
it used to be if you're in the UK and
you've seen the last couple episodes and
you're like oh my god I want to be or in
Europe might want to take another look
we found a way where we could get
shipping down to like 6 bucks which is
crazy so anyway I just wanted to kind of
mention that we've been having a lot of
fun with that we're going to continue
having more fun with that because it's
really
Oh expression of you know physical
access and all the fun that you can have
with it so yet feedback I have five org
let me know what your thoughts are on
kind of minimizing that attack I would
love to see it get even faster even
smaller another kind of crazy
expectation stuff I haven't even thought
of yet so anyway with all of that I just
wanted to sa i'm darren kitchen and for
shannon morse we're reminding you trust
your tactical us gonna get another pint
whatever here you got doing this you
know babies all right that is oh it's
good that I know right I need a beer</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>