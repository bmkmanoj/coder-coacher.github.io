<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hak5 - Hacking wireless networks with Man in the Middle attacks | Coder Coacher - Coaching Coders</title><meta content="Hak5 - Hacking wireless networks with Man in the Middle attacks - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hak5 - Hacking wireless networks with Man in the Middle attacks</b></h2><h5 class="post__date">2008-06-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/N86xJpna9Js" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">joining us here today is Harrison to
demonstrate a man-in-the-middle attack
Harrison thank you for coming what is a
man-in-the-middle attack alright well
for the second being technical I'm gonna
refer to this as an ARP cache poisoning
attack now an ARP is an address
resolution protocol now each device on a
network uses this to build a table of
all the other devices on the network now
in the table
it contains each devices MAC address and
its corresponding IP address now they do
this by sending out a series of art /
quests and ARP responses the problem
with this is it's susceptible to attack
we can exploit this vulnerability
between two computers a and B or two
devices by telling each one that were
the other so this will allow us to kind
of intercept the traffic the eavesdrop
yeah all we're doing is position ourself
in between two devices for example your
computer and the firewall and that we
can pick up all the network traffic in
between sounds great so what do we need
to get this done well we're going to use
a couple of tools the first thing I like
to do is get a little bit of do a little
bit of enumeration on the network with
the security scanner in this case I'm
going to use in map because the tool
that we'll use to do the ARP attack
actually has a built-in scanner but it's
not quite as detailed and it doesn't
allow us to do port scans well n maps
also open source and hey you know it's
cool because in the mail I send the
matrix oh yeah there was a real attack
in the matrix matrix too so I'm going to
use in map and since I'm already on the
network I know the subnet so I can
simply scan and find out what all the
other devices are
okay now I can tell by the names of the
computers that since you are using the
Solomon extreme international your IP
address is 192.168.1.1 o2 it's an
extreme interface man
and obviously the router is 192.168.1.1
so I'm going to do a port scan on you
that way I can get an idea of what kind
of apps you're running and what ports
you have open and while that's running
I'm going to go ahead and start up Cain
and Abel which is a totally script Kitty
tool I know but I'm assuming that all of
our viewers or most of them are running
Windows and it works as long as it gets
the job done right exactly if you are
using UNIX though which I do mainly I
would definitely suggest you check out a
tool called header cap which does the
job you know just swell it's not better
than Kane so we're going to go ahead and
start our sniffer and Kane and scan the
MAC addresses as you can see it builds a
pretty good list of all the devices on
the network so we'll switch tabs here
select the firewall and Aaron's computer
go ahead and press this button with the
button which will start the attack so
now we're poisoning and so the firewall
thinks I'm Darren's computer and
Darren's computer things on the firewall
so I'm going to pull up either real and
as you can see our nmap scan is finished
so let's make sure that you when you're
running out the rail you choose the
right the right network device I'm
actually plugged into the network so I'm
going to use my wired Ethernet ethernet
device and now I am scanning the network
so why don't you go ahead and send West
an instant message you know what a West
signed off but I will talk to John or
anyone else online right now now as you
probably can see I can type in AI M
which is the name of the protocol in
other real hit enter and it will filter
out so that we will filter all the
traffic so we only see the aim traffic
now I can I can look through the traffic
and I noticed that you're talking to
somebody about the wine cork yep that's
one of our viewers and the message you
just sent him says you there with a
question mark right
I just notice an incoming transmission
this is hey mm-hmm
and another outgoing that said we're
doing a segment right now so there you
go as you can see we're picking up all
the traffic and the other thing I want
to point out is using cam and Mabel we
can also sniff up passwords an HTTP
password unless of course using SSL and
that's one of the countermeasures and
we'll get into that another time with
how to protect yourself from this attack
which I would highly recommend using
Gmail if you don't have it or hey
because that does this out there SSL
all right Harrison that looks pretty
neat let's see if you can get my FTP
password for hack 5 TV which is where we
keep the episode files which are then
logging into FTP now with a test account
I got it right here
let's see username is test at hack 5 TV
in the password is lame password that's
exactly right
poster nasal and password all right well
now that we have demonstrated it on our
network you want to go try it out on
somebody else's okay you go ahead hit up
the campus with a coffee shop sounds
good to me
alright let's go let's go
you
you
coffee shop okay and he is skinny
everything yes sorry about the volume we
don't have a wireless mics yet buy
t-shirts make them can afford it the guy
using his little eye both g4 and he
looks like a total sucker in college
students beseech okay alright so here we
are we're connected to the links as
wireless network here at the coffee shop
okay damn
alright we've got traffic what do we
have here oh we got a right as he
disconnected from his IMAP server Oh
yahoo messenger ymsg so yms great we get
there's a bull riding on two different
to our two computers who are being at
two degrees at the same time mr. Trivedi
and if we head over to other real and
check out here is yahoo instant
messenger traffic as well as IMAP
traffic for email and scroll down we
just add some more so you just go down
this list and there's tons of traffic to
go through but we could save this and
Cain will save any of the passwords that
are going through this list so there we
go missing successful</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>