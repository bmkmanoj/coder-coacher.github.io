<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>The Bash Bunny 1990's Prank - Hak5 2226 | Coder Coacher - Coaching Coders</title><meta content="The Bash Bunny 1990's Prank - Hak5 2226 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>The Bash Bunny 1990's Prank - Hak5 2226</b></h2><h5 class="post__date">2017-09-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Ei6YhehET3Y" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">using 2017 technology to bring this
computer back to the 1990s all that and
more this time on hack 5 hello and
welcome to hack 5 my name is darren
kitchen hello everybody my name is
shannon moory through weekly dose
Technol us welcome to this episode I
love doing this show with you I'm also
taking the curly purple hair so this is
called I'm lazy I woke up at 4 a.m. I
flew from Portland this morning and I
saw the Eclipse yesterday so I washed
all the dust out of my hair because we
were on like private farmland watch out
oh really
top of a hill which was really scary to
get up to in a two-wheel drive car but
we made it whoo yeah oh lordy that was
what was that like it was great no the
Eclipse was absolutely amazing it was
kind of emotional just because like you
could feel the energy coming off of
everybody like everybody was just
screaming and hollering and like yeah
totality yeah oh man it was I'm just
glad it came back cuz I don't know what
you guys I'm a little partial to it you
know I mean I've got solar panels on the
roof of my van and I and they like the
Sun you know they actually tested that
in California and they found that it had
no negative effects on the electricity
of the state or anything like that like
because there's so many solar plants
here so it was a big test to see if it
would negatively affect solar panels and
stuff and it didn't maybe it's just a
big conspiracy and solar panels just
produce energy on their own inherently
and that don't even need the Sun and
they're just programmed to turn off at
night there you go
see ha ha see there's their probably a
podcast for that sorry so anyway today
I'm gonna write a script you are I'm
gonna turn this machine into one that
would play mist from 1990 what was that
for 95 I don't remember yeah you're
gonna be rockin like Wolfenstein 3d a a
la 1990 Morgan trail 3 I'm ready yes
yeah - ok here's how we're gonna do the
other game that I really like to play um
hold on I'm thinking oh crap I don't
remember it's okay it'll come back
I played it when I was a kid cool okay
well whoa well you think about your
favorite 90s videogames and you comment
below about your favorite 90s videogames
goosebumps escape for like Borderlands
like the the little books that you get
the books out man yeah Nancy Drew and
all the rest we are taking a bash bunny
and weaponizing it with the best prank
ever and you're gonna love this one I
love it except I'm not doing it I'm just
gonna hand you my best bunny thanks bye
okay so if you watched egg come back you
got a do show if you watched last week's
episode you know that the first part of
writing a payload is putting it into
switch which one was it this one other
one that's closest to the USB plug there
you go that's that's our main mode so
you put in arming mode you stick it in
your machine yep and then it pulls up
like a flash drive wood okay so I opened
up my file directory and if I scroll
down here I see the bash Bunny right
here and this bash bunny has already
been upgraded so we have a bunch of
payloads in there as cetera cetera okay
so cool but we're gonna write our own
and to get you started off i've left a
blank payload over in switch position 1
it's a good switch position so head over
to there alright so here is switch
position 1 and i've already left the
power shell in there for you but we're
gonna have to fill out the rest so oddly
i know right you're giving me homework
yep so what we're gonna do is fill out
this here little payload txt file that
you can open up with notepad Novac plus
plus nano by whatever you like vim and
in this case you'll notice that it's
already starting out with the c bang a
pound
i'm taking point slash bin slash bash
and perfect I'm glad that you're
commenting because actually that's you
know what there was one thing that I
learned from my time like one year in
college code doing like JavaScript
coding of all things is you need to
comment out your code you do you an
accident know what you're doing funnily
enough I was gonna say that's the most
important first thing to do and in this
case what we typically to be doing is
saying hey this is the name of the
payload here's oh yeah I guess I should
know here's
what it does here's what you can expect
it helps this is a really short and
sweet and simple one so you could
probably figure it out just by reading
it but let's make it easy for everyone
what did you come up with prank your
friends awesome love it okay cool so now
we're gonna call it the 1990s
regeneration cool okay so then the next
thing we need to do most payloads follow
a very simple structure you have your
set up phase you have your attack phase
which can make can be multiple stages
right yep and then you have maybe a
cleanup phase and then it finished okay
it's really important that you're able
to look at any payload and say like okay
based on the color of the LED in the
pattern of the the blinks and such
you're able to say like oh I have a good
idea of what this payload is doing right
because if we do that with the LEDs on
the batch money yes so there's an LED
command and you can make any arbitrary
pattern and color you wish but there's a
standardized set of states that you can
use and we highly encourage everybody to
use these they're in the documentation
and on the wiki and I'll go more into
the LED command in another episode but
what we'll start out here is one of the
basic ones which is LED setup so start
with that so that's gonna be a magenta a
solid magenta that we're gonna say oh
okay well I know that it's getting its
attack ready to go right and in between
this and our actual attack we need to
get a few things ready okay first thing
is we need to know in what position is
the switch and the linux box can
actually query its GPIO you don't need
to know about all the back end stuff so
it will run this piece of bash that'll
actually find out where is its switch
and put that in a variable so that we
can use it later okay so for that it's
get so there's this command called get
so it's all cat to get okay and what you
do is you specify what you would like to
get and in this case you can ask for
switch underscore position all caps
alright so what that's actually doing is
it's creating a new variable called
dollar sign switch underscore position
and in that very holing it it's calling
the variable got it yeah well it creates
that variable
with whatever the result is in this case
it's going to be one yeah and we're
gonna be able to use that later in our
script to actually say like hey grab
some resources from that switch position
right from that folder and on their bash
money that's easy enough next one and
this is a really common one this is kind
of like one of the most important ones
is attack mode
Oh attack my own yes so all caps cruise
control for cool and it's all one word
as well ah one word good to know
so attack mode is basically going to
specify what kind of device or
combination of devices you want to
emulate right so there's a number of
these and the list will continue to grow
as we build out the tool but from the
get-go we've got attack mode storage and
that would just show up as a flash drive
oh I see you could do attack mode
ro underscore storage and you get a
flash drive that's right a read-only so
you can't actually write anything back
to the disk that's kind of cool that's
cool you've got our NDIS Ethernet and
CDC Ethernet and those are just to look
up look like Ethernet adapters right
exactly and they look like the Ethernet
adapters that have drivers already built
into modern operating systems be it a
Windows that just automatically
recognizes it yeah and there's cool
stuff that we do with those yeah to make
them look really high-speed and do a
bunch of trickery we're not gonna get
into the Ethernet attacks in this one
we're just gonna focus on some of the
easier ones cereal is another one you
can do an attack mode where it will show
up as a serial interface where you can
actually drop to the shell and you can
do hid very much like the USB rubber
ducky
just like the ducky okay in fact it'll
accept ducky scripts so we're gonna use
a little bit of ducky script in this
episode and what we're gonna do is use a
combination of both storage so it shows
up a thumb drive and hid so it shows up
as a keyboard do you do that so that the
computer doesn't recognize it as
something else it just sees it as
storage or do you do that so that you
can store stuff on the bunny as well oh
that's you know what that's a really
good point
the reason that I'm using it as storage
and keyboard is because I don't want to
have to type in my entire payload yeah
it's actually really long there's a
little bit of PowerShell that we're
going to use in our
well it's gonna reference a much bigger
powershell file in fact if you take a
look at that file that's in that folder
there right and that's which position 1
that was a great question so right click
on that our file right there and oh I
don't know go to open it
open it with notepad plus plus ok that
way there you scroll through it is a
bunch of powershell and it's what we're
all tamiya doing is running this now
here's the thing to be able to type all
of that in in keystroke and forever and
I would probably screw up several of
those lines so you know what we're doing
we're actually making a stage 2 payload
nice so what it's going to do is it'll
run as a head so it'll type in
everything for us but it's also using
the storage on the bash money to call
back to that powershell that you already
wrote yep cool so that PowerShell is the
second stage and what we're gonna be
writing is the first stage that launches
it and so while this is actually a prank
payload the technique can be applied to
running any second stage that happens to
be PowerShell right so think about it
that way you can just swap out this r
dot ps1 or whatever that file was yeah
with anything ok and there you go now
it's not a prank it's something that
installs Windows updates or you
configures an air-gap to machine to some
security policy right because you can't
push it over the network at every apt
yeah so I'm taking a educated guess here
and I'm going to type in attack mode hid
storage is that right that's pretty much
it yeah it's you just keep specifying
them hid storage whatever you want but
when you're just gonna do ponies that's
a new attack mode will it'll ask what
will make it work we'll make that one
work yeah for sure the next thing that
we're going to want to do is what we've
finished our setup yeah not a very
complex payload some payloads need to
spin up servers and services and and
create directories and enumerate things
yeah so they'll be in the setup phase
for a lot longer this one's set up phase
is gonna be like a second okay so now to
indicate to the user that the setup is
done and now we're ready to attack you
LED color there you go wait okay so in
this case LED attack we're gonna do LED
attack all right cool okay so let's just
proof of concept this make sure this
works by doing a hello world okay right
so that's all we're gonna do is
we want to type in hello world into the
the windows run line you want to use
quack yeah so let's talk about that why
don't you go ahead and hold down on the
switch to your computer hold down the
windows key and hit our windows gr great
awesome look at that there you go pulls
up the run line it's a great keyboard
combo yeah so we're gonna ask our bash
bunny to hit those keyboard combos using
ducky script and - and you can pass any
ducky script with the quack command
nice cute right of course so quack quack
and if you're familiar with ducky script
it's basically just the keys that you
want it to do so if you typed quack
space enter it would hit enter there you
go if you wanted it to hold down the
windows key which is called GUI GUI for
graphical user interface and while
holding down GUI pressed the R key on
the keyboard it'd be GUI space are there
you go gonna be a capital R mu lowercase
R it doesn't matter okay great so then
the next line would be quack and we're
actually gonna do a delay here we're
gonna make it last for I don't know 100
milliseconds so 100 s 100 idea and
that's just because it there's actually
like when you go to pull up the wrong
line it's like it it takes a moment it
takes a moment yeah you don't want it to
start typing into the run if the if the
run program is not there yet yeah so
yeah you're taking a moment to deal with
that interaction time or whatever you
want to call it yep so the mean computer
speaking to another computer they don't
you see those pauses the way that we do
so yeah you kinda have to change your
mindset a little bit there we are delay
100 and then we can start typing so this
would be another quack line yep and we
use the command string to type yes and
then whatever you want so let's say I
really like cat so I'll do a call out to
my cat
my oh my
yeah she might get jealous okay okay so
after we did that let's call it a day
let's say oh you know what let's now let
me do it finish that's a great idea
let's let the user know that we have
finished the attack and it's and it's
safe to unplug the drive okay so LEDs
finish that's it all right finish cool
are we done we're done you just wrote
your first payload so I can just control
us this yeah save it
eject it all right that should be saved
thank you computer
and I think we should hack your machine
all right I mean I guess it's only fair
cuz we did I did your machine last week
so what exactly switch this payload I
load position one okay and then I'm just
gonna go ahead and plug that here into
my computer Boop
yes I do have a black wallpaper because
because you're a creeper yeah it's like
it's not just the t-shirts folks
all right so taking a look at the LED
color I can see that is now oh there
goes and you just typed in and it went
green cool so it's green where you know
that's done and it typed in Starbucks is
the best cat maybe maybe okay cool
let's make it better okay because really
the payload writing process is a matter
of lather rinse repeat
yeah typically what you do is after
you've already targeted you know figure
it out like you do your recon you figure
out what kind of machines to run in then
you find a similar machine whether it's
virtual or real and you go ahead and
pull off your attack with your own hands
right with whatever you need to get that
done making notes of what you're doing
kind of like you know following creating
a recipe here then you adapt it into a
bunny payload and you just kind of like
run back through what you did to get
your job done and then you test it on
that machine and you make sure it works
and then once you've got it working you
can then optimize it and then up the
skate it to make it even sneakier and
then go and deploy it so we're at the
phase where hey we know it works this
payload that talks about Shannon's cat
let's optimize it yeah let's do that so
I totally forgot to switch it from the
payload
you own yourself yeah I was like da okay
so I got the Bosch bunny back up so I'll
go into my payloads and it was switch
one that we are running all righty so we
know this works so one of the things
that I noticed in a lot of payloads that
we do over and over is this this attack
right here led attack right after led
attack pulling up the GUI on the run
dialog and typing stuff in that's a
common thing that we do a lot yeah and
so there's two ways to shorten this the
first way is just using an alias which
is super simple yeah go ahead and
replace quack with the letter Q okay
well that's easy right so this saves a
few characters you can see where that's
going anytime that you type quack you
could also have just typed Q okay great
we love QQ is wonderful but we can also
make this a little easier by just
replacing that whole Q GU er QD 100 and
Q string with run Oh
and so the run is an extension and I'm
going to get more into extensions later
but essentially run you can tell it an
operating system and then you can give
it anything you wouldn't to run and
that'll be for if it's Windows Mac Linux
you can say hey depending on your
operating system we want you to run this
and it'll do that most effectively for
that operating system so you really
don't have to like think about the
mechanics of it like oh I have to pull
up the run in line and then I have to
wait a hundred milliseconds and then I
have to inject some stuff so does run
have a millisecond delay already worked
into it all of those things already
built-in and it also takes advantage of
the fact that we can specify different
operating systems so they can be
intelligence built into these things
that could say down the line quarry the
operating scored the computer okay do OS
fingerprinting like we did last week
remember with end map and they could
figure out if your machine is a Windows
or a Linux box yeah so you can see where
that's going it's a lot more intelligent
than just giving it some some ducky
script okay but go ahead so what I can
do is just erase these you've run
Starbucks's starbuck is the best can
maybe except do you to tell run what
operating system oh so we're talking
Windows so it's when and because it's
bash you need to put all of that after a
win in quotation max
because if I didn't it would try to run
each thing like run win starbuck run win
is is a nickname
yeah it's just like working in the Linux
terminal in fact go and check out
Shannon series on hack tip on those
things because you're covering a lot of
the same stuff as variables yay all
right so we're all characters of meta
characters all right I know that we're
running a little long here you guys
should be getting the gist of it by now
so basically and let's now make it run
the stager okay right so or this is the
stage where let's make it run the stage
okay and for that there's also there's
already a little bit of PowerShell and a
file on your desktop yes yes guy right
here so I'm just gonna copy this over
and stick it in my payload and instead
of run wind Starbucks is the best cat
maybe mm-hmm
you can just get rid of all of that and
run instead this PowerShell there we go
okay now what that PowerShell is going
to do is it's gonna it's gonna pass to
Windows hey PowerShell and actually
remember it has to be in quotes so get
that first quote there and that last
quotes already there for you yep it's
gonna say hey PowerShell use GMI to Cory
Wynne 3200 square volume looking for
with the tech F anything that's got the
label bash money so it's finding the
drive letter yeah all of that is just to
find out D colon backslash okay and then
it's going to append so that plus right
there it's going to append to the D
colon backslash the payloads directory
backslash and we have to escape this
variable so that's why there's two
backslashes the dollar sign there for
switch underscore position which brings
us back to the switch position get
switch to piss-all gave us dollar signs
switch underscore position that sounds
in our payload okay and then that give
it and at the end of that we just do
backslash our ps1 and that is final
PowerShell yeah that's that file that's
sitting there in D colon backslash
payloads backslash switch one backslash
ps1 cool there you go and then we just
close it out with more double quotes
actually we're gonna do one more thing
to make it more awesome okay and that is
right after where it says PowerShell on
your yep we're gonna give it one more
parameter okay
TAC exec with the capital e space bypass
with the capital B that's it like that
yep save it already
okay that's saved all right so in this
case save it
eject it and let's go ahead and deploy
it and I want you to do it against your
machine because you're not gonna notice
my machine with my black wallpaper and
such I will and also Shannon's got cool
wallpaper as always yeah I have a very
cool wallpaper thank you very much all
right so that's safely ejected okay so
we put it into payload position one
switch one and I guess I'll attack my
computer you know I actually don't know
how this HDMI and our studio is gonna
react to your windows resolution
changing recording so maybe we just I
don't know as long I can see it and I'm
gonna use this USB over here because
actually here let's pull up a window as
well okay so like you get the full
effect okay I'm gonna make this window
cuz you're running at 1080p right now
there we yeah yeah
well actually it's 2560 by 1440 but I
have everything like displayed bigger
because I have old people as and I can't
see things mmm plug into this book for
kids plays okay it's USB you get it home
try there it goes
yeah this is what happens when you have
to wake up at 4 a.m. for flight you're
not quite here all right so magenta this
is a great one to use on your co-workers
by the way it's even better than the
wallpaper prank I feel like I kinda
can't wait to use this on Keith Oh
mister snubs HUD's and i can say that
that's amazing oh my god yeah that
live that's so funny you click on that
resolution look at the gigantic bezel on
the side now amazing
that's so funny what resolution is this
that's 640 by 480 and I needed a Visa
card to be able to play Duke Nukem 3d in
that yeah that's bad thanks that's like
who this by the way this this PowerShell
script will go all the way down to like
I think 320 by 200
and the screen it's amazing
the original mess game oh I'm pretty
sure it ran in that resolution or
something very close to it I'm so glad
they revised that game it's way better
now mm-hmm hey let's uh tangent on a
game review let's change it on the back
that uh the 1990s so nice if you didn't
read the books by the way you're missing
out they're really good
cool hey I will next week be back from
Burning Man because I'm there right now
I'm traveling right now which is part of
Burning Man and I'll be heading to
Disneyland in like two weeks from a
friend really yes so excited Oh in two
weeks we should may have a coordinators
I want to get down good Nuland anyway I
want to thank everybody for supporting
awesome hak5 stuff and making all of
this possible and happen and encourage
you guys if you want to get into the
bash money stuff bash money comm check
out last week's episode if you're if
you're new to this and find all the
awesome hack 5 gear at a check a shop
comm and also we have tons of super
super fun stuff happening at hack 5
along with all of our other shows so if
you're really interested in checking out
all the different things that we do you
can go over to hak5 org and that is
where you can find all of our social
networks so you can see all the
interesting things that we are up to and
events that we're going to in
conventions by the way if you want to
see my eclipses pictures because I did a
little DIY filter which was super fun I
talked about a non tech thing you can
check those out on my Instagram which is
Instagram calm slash snobs and I had so
much fun they do all the manual focus
for everything me and my friend Russell
were like bantering back and forth
during the Eclipse and I was like dude
what's your settings on and then he'd be
like hey what are your settings right
now so we would just change it
throughout the Eclipse such nerds nerds
photography nerds me love it great time
oh all right well with all of that
that that pretty much wraps it up until
next week wait
we have Chen we're running so long on
this up but we have a gift from the fear
okay wolf what's just one is a kitty
it's a kid is it Yuki so this is from
Katie and she says hi all hope things
have been going well over at hak5
headquarters I recently got a bunch of
these stickers so I figured I would
share I hope they help you remember to
take care of your computers before the
y2k bug hits so and then she said I see
we'll see you all at DEFCON and she sent
us all these babies so we have more I
thought we just had one of them but we
have a ton and they say remember turn
your computer off before midnight on
12/31
99 so great so I think we should like
hand those out to you this is amazing
the rest of our co-workers because
they're so cute thank you so much Katie
and if anybody wants to send over
stickers for the set you can do those
that over at AK 5 org slash address and
I'm gonna go to take a nap that is you
know how appropriate is well I know my
news mode episode yeah shout out Katie
thank you all right we'll see you guys
in 2038 for the next Eclipse of UNIX
epoch time I'm here in kitchen got a
great idea
bring it to the web the way Darren and I
do and head over to domain.com they got
a slick domain discovery system and an
easy checkout process so your site will
be up and online in no time and
everybody over at domain.com have been
supporting hack 5 for years and they
want to celebrate with this awesome
promo code it is hak5 at checkout and
you get an extra 20% off
that's right 20% off and while you are
at it make sure to send them a tweet
there at domain.com on twitter and just
tell them thank you for supporting hack
5 for several several years we really
appreciate it and we hope you do too
remember when you think domain names
think domain.com I know right
we be Kitty happy kid</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>