<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Alternative Payloads - Metasploit Minute | Coder Coacher - Coaching Coders</title><meta content="Alternative Payloads - Metasploit Minute - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Alternative Payloads - Metasploit Minute</b></h2><h5 class="post__date">2015-01-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/SP_wDXTFKxM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alternative payloads this time on
Metasploit minute Metasploit minute is
brought to you by viewers like you
if you get value from the show it can
spare even a dollar to support this show
please consider contributing at
Metasploit minute calm
welcome to Metasploit minute the
breakdown on breaking in I'm rob fuller
but you can call me mix today we're
gonna be going over alternative payloads
a lot of people say that interpreter
interpret interpret every time is
automatically associated with with
Metasploit and that's not the only
payloads that are in there there's
actually what 342 different types of
payloads so I encourage you to go into
and try out some of the payloads that
are in there in this episode we're just
gonna be going over five and and just
touching the surface on what's out there
to kind of get you a feel for what what
the mindset behind some of those are and
and the fun that you can actually have
with them so the first one we're going
over is an actually an OSX one and it is
the and you can see the rest that we're
going to be going over is the SE payload
and all this does is we say use paste it
in and the only options in here is the
text that it's going to say
so this payloads there for accessibility
reasons and we're going to be using it
to make funny noises on on remote
systems but in this case it's going to
be my own so we can set the text to
pretty much anything we want so we're
going to set text to you know hello
world just to make it say hello world
and then inside of every payload module
you can use the command generate with
the - date shows you what options that
are and we can just generate - T and
then in for the OS X versions we're
gonna get it out in Mach o format or the
format that binaries in OS X are stored
and we're going to
set the file for it to go to - root
desktop evil dot bin that's it - they
use that payload that's all you have to
do is to generate the binary now I have
a bin that I can then push over to you
know an exploited host or somewhere or
just copy it over on a USB stick when
someone forgets to lock the screen and
set it up to automatically run when they
unlock their screen so we're going to
run this over on my system we got the
evil dot bin sittin in the mess wait a
minute directory and we're going to do
eat chmod it + X evil that bin evil dot
bin and you can't see this very well but
hopefully with the would you like to
play a game of chess and you can make it
say whatever you want right so obviously
my computer's not doing what I told it
to it's not saying hello world but
someone's playing tricks on me so we
have that payload and you can make it
say pretty much anything you want and
this one was really fast because of my
settings on my system do go really fast
on other systems it's going to kind of
slow down a little bit and and the
text-to-speech is great and you can make
it do all kinds of hilarious things so
the next one we're gonna go into is the
message box and this is really standard
it's a lot like to say except for it's
just popping up a message box so the
default is that it has an icon of no the
text is hello from MSF and the title is
message box and you can configure this
however you want the cool things are
that you can make it a different icon
like a question mark or whatever so in
the in CCDC
we actually had a wonderful auto message
box payload that was asking the user
would do like turtles
yes or no
and we did this very similar to how
Metasploit spay load is so it set the
icon to question set the text to do you
like turtles set the title to important
question so all capital because we're
all yelling at everything generate T exe
this is going to generate an executable
format we're gonna store it on our
desktop root desktop evil dot exe so if
you ever find an evil dot exe on your
system it's probably me I'm sorry you
can blame me copy we're going to go over
to our Windows box and for some reason
paste isn't working so in this instance
we're gonna stop for a second we're
gonna go and get a shell and then once
we have a shell we're gonna upload that
way since VMware fusion is being mean to
me alright so we're back and we're gonna
upload the message box one to show you
guys how this works so get into our
sessions our directory MSF minute we're
going to upload our temp or root desktop
evil dot exe there forgot to tell it
where to go go over here double click
are you able dot exe has a question box
it is the only an ok message box you can
modify the shell code if you want for
that but it says important question and
you okay and that's it that's all the
payload does so now we're going to go
back and we're going to use our next
payload down the line its add user now
this is an important one because this
add user is a just like the message box
you see that there's no other other
slashes in it because there it says
Windows and then message box and no
other underscores or slashes that means
it's a single and we talked about
staging and singles before
and particularly the windows adduser I
believe we've already covered a little
bit but to add a user in Windows you do
have to be an administrator so I'll show
you how this is going to work when we do
this Soyuz payload add user and the
great thing about this payload is since
it's all cupped in one this can execute
on a system even without network
connectivity so that's why some of these
payloads are good to know
especially when you have instances where
you either have low latency or zero
connectivity at all and you want to have
this this payload execute still so we're
going to set our user to two Bob set our
password to our infamous Mach set wmic
to true so this is the true false saying
will it resolve the ministrations group
or not this is important because how you
spell administrators on other systems
other languages is not always the same
so this this payload actually it has
inside of it a way to resolve which one
the administrators group it is and add
your user to that group so options make
sure our options are great now this
payload does not bypass just so you know
this payload does not bypass any any
complexity requirements that that user
needs to have so if if they have a
requirement that there has to be 12
characters in the complexity it's not
going to have allow this or or has to
have a special character this payload is
gonna still work but it's just not going
to add a user so it won't really work
file route desktop evil - dot exe
we're getting creative now we're gonna
copy this so we're gonna upload it
sessions - I won and we're going to
upload root desktop evil - dot exe -
there
and you can see that on this side it
executes but we probably don't have we
do have a bob user because i have it
adding the reason they added a bob users
because it was running as administrator
and I don't have UAC and abled on this
thing so that's why it worked I wasn't
expecting to but you can see that Bob is
now there it is an administrator and
it's all done so if you wanted to add
this as a persistence method so if you
wanted it so that even if they deleted
the the deleted the user Bob and then
maybe had it so that every time they
turned on the user it riad Edyta that's
a way you can use this payload so even
if you're not connected to it you still
have a way in its I'd sort of like
adding your own back door and then the
next one next one is meterpreter but
it's java meterpreter and the thing
about java meterpreter is that you can
run it on anything write anything that
has java you can use this payload on so
if you don't know the OS of the target
system let's say your fishing is a
corporation but the corporation
unbeknownst to you has all Macs but they
all have Java installed them X you can
use this payload and then not have to
worry about what kind of back-end system
or OS it is so we're going to do the
same thing set our L host to one seven
two that one six don't 102 I think
that's our host what 102 137 37 cannot
type today set our out port if you want
but we're not going to generate now when
selecting the - T it's the type of
payload that it's going to output in now
you could select a lot of these
different ones and it doesn't really
pull you down to a specific type but in
this case my Java payload you normally
want to go with the type war and that
war file is
jar file it's the same thing so what
we're gonna do is a type war and file
route desktop evil dot jar and then the
issue here is that we don't have a
handler setup we have nothing to receive
it so we go back around our back use
payload or exploit multi handler set our
payload to the same payload we had
before and we can just push up to get
that and just without the payload type
show options it's already set up for us
boy - J oh I did use instead of use
payload handler set payload to that show
options I'll host 1 7 2 1 6 102 137 now
exploit - J so now we have the pay load
handler setup now if we execute this war
jar file here let's let's just execute
it on top of our cally box just to test
out to make sure that it works and once
it doesn't invalid or corrupt jar I may
have lied to you so I lied a little bit
to you the - war file type is not the
one where we should be using it's
actually the raw type so the raw format
is the raw format for whatever payload
you're selecting it happens to be that
raw for the Java interpreter is in jar
format already so I did generate desti
raw - f and put it back in the jar I
then just did Java - jar evil jar and it
worked so we can see in the sessions we
actually got our session such route
attack now what we're gonna do is see if
one of our other other systems has Java
on it and if it doesn't we're just gonna
keep you know no Java and my mac os/x
doesn't have Java either so you can see
that we have that session alright so
we're gonna continue on to the last and
final payload the coolest payload I
think because this is a Firefox payload
now why would a Firefox payload be
interesting I'll tell you because you
can't talk back to me so there have been
recent Firefox exploits and they've all
been patched so don't worry that didn't
quite allow remote code execution
or dropping to a shell because of some
of the sandboxing that that firefox does
I believe so they created some of these
payloads that are actually pretty cool
so the first payload and I'm gonna talk
about is the Firefox exact payload and
this basically runs a command and it'll
operate just like just sort of like the
Java payloads where they're their system
agnostic the the Firefox payloads are
simply inside a Firefox so no matter
what Firefox you're running this on if
it's vulnerable to this version this the
this exploit that was there you have
this running the cool thing about this
is let's say that you are on a system
already but you want some kind of
persistence you can actually make this
payload part of the cache or extensions
portion and it's just JavaScript that
then does these things so you can
actually have some sort of persistence
inside a Firefox every time they boot up
Firefox so what we're going to do is
leave this touch command as a dot txt
and we're going to generate
RAW format I'm gonna see it and if we go
through this and be careful when you do
raw without actually pushing it to a
file depending on the different payload
type you you might have some options in
your terminal it might screw things up
so you can see that this is pretty
straightforward it's just saying you
know here are the things that are gonna
be set and here's the command it's going
to run if it's in Windows does it this
way if it's not it does it this way in
bin Sh
so really straightforward payload but
the cool thing is you can like I said
incorporate this in and what we're gonna
do is actually we're just going to leave
this like this for now I implore you to
explore all of the options are available
for this this payload as well as the
other payloads that we've gone over and
for you to look through the three
hundred and some-odd payloads that are
there so what do you think
tell us more at MSF at hack five or hak5
org and stay tuned to Metasploit minute
comm for more shows like these and a
really huge thanks to everyone who
supported the show so far you can find
ways to donate and get awesome
Metasploit minute merchandise or swag at
Metasploit minute comm every dollar goes
towards making this show just for you
and for that I am deeply grateful so
until next time Rubik's and you'll be
hacking and I'll be hacking til the cows
come home
hack the planet hey there ya you thanks
for watching all the way and I really
appreciate all the awesome feedback and
support we've received from viewers
exactly like you well not as cool but
you get the gist if we haven't already
checked it out you could really help if
you go over to our patreon and support
the show directly if you can't that's
cool simple like or subscribe goes a
long way too
either way thanks for watching and we'll
talk later man take it easy</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>