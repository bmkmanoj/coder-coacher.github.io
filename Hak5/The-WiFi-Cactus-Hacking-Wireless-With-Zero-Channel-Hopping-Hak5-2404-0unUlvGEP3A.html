<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>The WiFi Cactus - Hacking Wireless With Zero Channel Hopping! - Hak5 2404 | Coder Coacher - Coaching Coders</title><meta content="The WiFi Cactus - Hacking Wireless With Zero Channel Hopping! - Hak5 2404 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>The WiFi Cactus - Hacking Wireless With Zero Channel Hopping! - Hak5 2404</b></h2><h5 class="post__date">2018-04-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0unUlvGEP3A" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome to hack 5 my name is
Darren kitchen it's your weekly dose of
Technol us and today I have a special
guest who is afraid of channel hopping
it's dark matter dark matter dude
these are having me absolutely thanks
for coming down to the new studio why
are you so terrified of channel hopping
you just can't have enough wireless
cards you gotta be on every single
channel at the exact same time that's
the only way hmm things are getting too
busy now there's too much information
that's just floating around in the
airwaves we got to watch all of it at
the same time yeah at the same time so I
feel like I feel like there's something
between us
dark matter well Luke on right yeah it
was a schmuck on with the whole idea of
what would it look like if we listen to
every channel at the same time well you
know Shannon and I tried this years and
years ago with a tour 2011 bee orgy or
something on 2.4 gigahertz we stuffed a
bunch of alphas in a Hello Kitty
backpack and crashed the USB bus but
said hey that was fun you took a little
further a little bit thanks to your help
of course so what exactly is in this rig
and what is it called so this is of
course hashtag Wi-Fi cactus of course
it's 25 pineapple tetras yours truly 25
of these guys and that each of them has
two radios so it's 50 total channels and
they're all communicating back through
switches over Ethernet to a Intel nook
so it's basically taking all the data
listening on all those channels
simultaneously and then pushing that
information storing it into single pcap
files on the nook for later analysis
okay so now we're gonna dial it back and
kind of like explain it like we're five
essentially what is the issue with
traditional like Wi-Fi sniffing with one
radio so right now the most wireless
setups that you see you have multiple
access points as you walk around and
that means that there's tons of
different channels and if you have one
you're only going to be able to hear
that one channel but guess what there's
a ton more
devices around you how are we gonna
listen to those so traditionally use a
method called channel hopping so it
switches from channel to channel so it
goes channel 1 channel 6 channel 11 but
people get creative and put things on
different channels like 2 for one who's
crazy enough to put something on channel
1 or 52 right so just in the realms of
just to simplify just in the realms of
2.4 gigahertz land yet there's 14
channels if you had Japan yeah and so in
the US 12 right and so if you were to
only listen to if you were trying to
listen to all of them you could only
ever get one fourteenth of the
conversation at any given time so you
could like listen for one second here
and then one second there on one second
here but for the one second that you're
listening here you can't hear what's
happening over there right and what
happens is the data becomes fragmented
you lose that piece of information so
how do you solve that
I mean clearly with brute force or I
mean you could just have one radio on
one channel and just ignore everything
else but what's the foot of that and
what is the fun in that well it sounds
like you're having a lot of fun but walk
me through on an individual level what
is each pineapple doing here okay so
each individual unit is running thanks
to kismet huge shout-out to kiss met the
kids met project dude thanks buddy it's
running in the kismet remote client and
what the remote client does is it
communicates to the wireless adapters
the two of them and it takes that
information and packages it into
Ethernet and pushes it back to the Nook
but it doesn't push it just back so that
like I have to manage it or do something
inside of the Linux system on there it's
running a bun too but it actually pushes
it back to a kismet session and so then
we get that data in a new like GUI like
html5 like gorgeous like layout we can
look through tables and see data in real
time so we're watching all that data
streamed to us all in real time so
that's what's happening on each of those
individual units right whereas you know
if you were to just be like oh well I
can see the airwaves with something like
you know aircrack sweet the Ehrmann yep
plug-in you know 50 radios it's that's
not an experience like this let's switch
over to this because this is sexy I mean
this so this is the new kismet and
yeah that's a beautiful HTML le html5
kind of and it has you know search
abilities so we can look for you know
different things in the environment just
in the search box so we can type in like
I wonder what is 0 0 1 3 3 7 MAC
addresses that would be in a MAC address
that hi-5 has procured today yeah we
want that one I don't know anything
about this but you know just that quick
I'm searching through data and this has
been on for a minute and we can actually
go quickly and just see you know how
much data that we've run screen that
we've started to see and we're up to
about 800 Meg's of RAM right now of just
devices in our proximity with a total
count of approximately or excuse me 800
devices with approximately 400 Meg's of
RAM being used to see that to keep track
of that data so this becomes like a big
data issue so there's two aspects here I
want to ask you about first of all you
know on the hardware side and then a
second of all on the software side
because ultimately you can end up with
what multiple pcaps or how does that
even work but walk me through the
hardware first because now that I
understand that there's kismet running
on each pineapple and they're all
communicating back over Ethernet to the
Nook man that's got to be one powerful
nook what's good what's in there well
and I wanted to kind of get the best of
both worlds what is the most amount of
power that you can get in the smallest
form factor you can get and so I've
dealt with some Intel projects in the
past I had some previous projects with
them and then also I've looked at some
arm stuff but honestly the nuke just
made the most amount of sense because a
it's got nvme so you've got crazy fast
hard drive right speeds so can we pause
on that one for a second because that
was the one where I'm like trying to do
the math I'm like wait a second hang on
if every channel in fact the switch back
to here look at the across the bottom
that every channel were saturated
simultaneously and you're looking at 50
different channels across the bottom
there and you can kind of see them move
in real time is different you know the
traffic is happening on different places
here
I heard to me like hey theoretically you
could you could like saturate the bus
you could saturate your right speed like
if this was just like a spinny disc the
thing would fall over if it was just
like a regular SATA Drive
right you're gonna be a bandwidth
restricted there because you've only got
you know 150 megabytes per second
transfer so this is a Samsung nvme and
that thing is like blazing it like 1.5
gigabytes per second on sequential read
writes so you don't even need an ass
yeah know-it-all and that was my whole
idea what this is like how can I pack as
much power into you know small spaces
and and vme technology was you know new
within like the last year or two and
it's more and more affordable so it's
like yeah of course I'm gonna throw it
in here plus the nukes running an i-5 so
I'm getting dual core with four threads
so I'm getting plenty there and it's got
I believe it's 16 gigs of ram is what
I've got in there right now so I've got
enough RAM cuz as you see I'm already
chewing up eight hundred Meg's just on
devices and that's the data inside of
here so explain to me that brings up the
software so words that's just in the RAM
and so that's being held in kismet just
ephemerally so you can pull up this
duffle you just did it like it looked
like a you know I'm assuming a sequel
Cori on the backend for you to be able
to pull that of the yeah a so Dre garden
he's done a great job with this and he's
basically created a temporary database
and he's done a bunch of custom coding
to it to where you can actually even run
your own API into it or your own request
with Python and be able to pull all
sorts of queries and different
information that you want directly out
of the system so yeah it's awesome he's
do an amazing work like and it's open
source like it doesn't get any better
than that like right it's fantastic so
it's really neat to see but basically we
can go through here we can do a quick
analysis of devices like I just picked
one at random so I don't know who it is
so we might have to blur and it just
tells us where it saw it on the free on
the spectrum how much data packets that
it's off there's LLC packets they're
management frames rather and we just get
a really good meta analysis of what's
going on with that device so if you're
troubleshooting or you're having issues
and you want to look at specific devices
it's super quick to be able to pull this
up plus I mean we get the advantage of
seeing both the APs and the clients we
get to see their different types of
information they're sending out whether
they're you know doing beacons looking
for ApS
or just whatever they're doing we're
able to see it in the full conversation
yeah people are using encryption we
won't be able to see past that
sure right but we can use everything up
to that point but you're showing the
with something as simple as an i5 nuke
with just a couple of hundred Meg's of
RAM you can see the live data of what's
actually going through the air and
that's huge what I'm really curious
about then is you know you were saying
you know you take this to conferences
you wear this on your back which is kind
of ridiculous come to that in a sec but
you're capturing all of that data for
further analysis later how do you get
that data out of all of these so right
now my number one strategy is I write
tea shark scripts so tea shark is just
as the command line version of Wireshark
essentially use the exact same syntax so
I'll go through and I'll write something
custom up that I'm looking for maybe
specific SS IDs or some sort of query
that I want to do and I'll do it that
way and then I've usually been pushing
it to a CSV file because databases can
deal with CSV is easy enough right right
then I'll push that into sequel server
and then I start doing all the
gymnastics and sequel server so that
sounds like a lot of work and is crazy
and where do you actually get all of
that data out of because you've got 50
different interfaces that are all being
networked as virtual interfaces you
should be it's really cute it's like
tetra 1w LAN or where was that again
yeah right here I've gone through and
named all the individuals 24 wlan0 yeah
that's you know that's pretty insane so
does that mean that you end up with like
50 different peak apps that you then
need to like multiplex back together
into one single database well thankfully
the way that Dreghorn is set this up and
it all goes to one pcap file it does
segment after a certain size because it
gets unruly if you start dealing with
hundreds of Meg's of peak apps like it's
completely unruly you don't want to be
dealing with that it completely brings
all of your querying to a crawl so you
can set up an increment based on how
many packets that you capture so I
usually get to like sub a gig is what I
usually go for but I've in learning that
lesson I've done as big as 40 gig
packets so tell me about this how big is
this driving here then
me drive so I had a 512 gigabyte in it
when I took it to DEFCON but I didn't
fill it so I mean I needed to DEFCON
there's like so much in the air going on
there in fact I'm wondering how long
until the whole thing is just full like
how much can you capture it's it really
just depends on you know the the
busyness of the environment because you
know if you don't have a lot of people
clot that communicating then you're not
going to see a lot of data but then the
other big thing is you know
are you actually capturing the data and
then recording it because we had some
issues where we had software crashes we
would have you know some issues with
tetras we've been going through you know
just trying to make sure that all the
equipment's working like giving one
thing to work is easy right and then
forgetting it yeah scale it to 25 and
then you start running into all sorts of
weird issues you power issues you know
your your rig physically is pushing a
reset button on something you know what
I mean you don't realize it right
because you've got you know all these
constraints that you're adding into this
situation right yeah it's actually
custom machine these parts right and it
was never meant to be in this sort of
this does you look like something you're
gonna just pull off Thingiverse maybe
we'll have to see who will open the
design so to be continued no joke that's
well it's so exciting to see like where
the rubber meets the road on this thing
but you were saying you don't actually
fill the drive at DEFCON so well and I
think part of that is I mean we saw a
crap ton of devices like there was 40
gigs 40 or 50 gigs of data is what I
ended up capturing there and that was
only during my demo labs and I only did
demo labs well and the times I was
walking around so my battery life when I
was walking around on battery was about
an hour to two hours I think
and then my demo labs I did to demo labs
for four hours so it wasn't like I had
it on 24/7 so if you were to actually
like install this on a premises and
actually try to record every day worth
of traffic you you would really be
feeling NASA's full of discs right well
and that gets us to the next thing you
know we got a we got to overcome some of
the other bottlenecks like right now I'm
using 10 100 switches yeah so
like I need to I need to upgrade that
and then tell me when you've got all of
that data because you're storing
everything not just the management
frames or not just you know the frames
but without the actual payload you're
you've got the whole Datagram everything
you could reconstruct and replay the
Wi-Fi as if you were just like enjoying
DEFCON again except with less booze
right yeah you absolutely could and I've
actually thought about that like to
troll people what if I just started
replaying you know so wirelessly
I don't know so look for that in the
future oh my god you could record the
CTF right and then replay the CTF oh
yeah yeah anyway so what so uh before we
wrap up the most interesting what I want
to know is what's the most interesting
thing that you found combing through the
data after you even pulled it into
sequel probably the most interesting
thing is like what people are doing on
networks and like probably the most
surprising was that how many people are
actually using encryption now so as far
as act conferences and in different
places the numbers are a lot higher than
you would expect so you go through the
data you start coming through you start
looking through Wireshark and it's like
boom so much encryption and now and
that's great that's awesome that's what
we want to see the the where we want the
industry to go right but at the same
time another thing is like I also look
and there's a lot that's not encrypted
and you go to other places like I went
to conferences in Romania called deaf
camp and like there was a lack of
encryption whoa so and they're like I've
gone to a bunch of airports and I've
gone to a bunch of different laces and
there is a lack of everywhere this at an
airport I haven't worn it at an airport
but it's definitely been through
airports okay that's right and you do
actually have a younger brother of this
yes so I've got a the tactless mmm-hmm
yeah
tactical version so yeah how many
pineapples is that for okay so the
suitcase size yeah backpacks oh okay
yeah it's pretty cool yeah so that way
it gets pretty hot though keeping all of
these in a little backpack so no joke
man dark matter I'm always amazed at
what you're doing yeah if you guys are
not following Dark Matter on Twitter you
need to
be at dark matter in leet-speak of
course except for the e yeah and and
then where's your blog where are you
hosting all of the other data on this
pals hack org I mean pal Shack org
awesome
okay cool is there any other big thing
projects you're working on that you
wanted to talk about or I've just got a
whole bunch of ideas like percolating
right now looking at a series is Atiya
AC cuz a project I did two years ago I
did some 802 11 AC stuff and I want to
revisit that obviously because that's
the next stage and yeah there's just a
lot of things in the wireless right now
that I want to get after so and I've got
more free time to work on them so I'm
pretty excited so awesome well thanks
again for coming on yeah you would like
to well I find all of the show notes
with links to all of the resources and
things we talked about today hack 5 org
is the place to go that's where you'll
also find all of the rest of the shows
the new season a Metasploit minute is
out Shannon is killing it with tech
thing and threat wires so be sure to
check that out as well as the link to
our little store if you want to get
yourself a pineapple or 2 or 25 as well
but seriously this is just insane mainly
mad props to dark matter do you know
what we say at the end of the show I
don't have you've seen perhaps yeah ok
well it with the said I'm Darren kitchen
I'm Mike Spicer you say first domain.com
has all your website needs from command
dotnet domains to intuitive website
builders so you can take that first step
in creating an online identity let me
tell you there's no domain extension
like a.com or.net or if you want to
brand yourself domain.com has over 300
domain extensions like dock club and dot
space these guys are huge fans of hack 5
they're affordable reliable we've been
using them for years they've got all the
tools you need to share your ideas with
the world and because they're such big
fans they are hooking you up with 15%
off their already affordable prices so
get domain names and web hosting and
email and just be sure to use that
coupon code hak5 so when you think
domain names think domain.com</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>