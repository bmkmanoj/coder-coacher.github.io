<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building a Home Lab Virtual Server Quick and Dirty - Hak5 1819 | Coder Coacher - Coaching Coders</title><meta content="Building a Home Lab Virtual Server Quick and Dirty - Hak5 1819 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building a Home Lab Virtual Server Quick and Dirty - Hak5 1819</b></h2><h5 class="post__date">2015-06-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/9SpQ1fRQAto" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">building a home lab virtual server in a
nook quick and dirty all that a more
this time on hack five this episode of
hack five is brought to you by
domain.com
so no hacker lab would be complete
without a virtualization system without
a hockey puck without a hockey puck in
we're gonna turn this single hockey puck
into probably about 16 hockey pucks
so 1600 so we're gonna build a cluster
hockey puck you know a bit wolf cluster
like hockey pucks
today on hack 5 that's the idea is
essentially this Intel nook is a
fantastic little inexpensive piece of
hardware we went over the ins and outs
last week and today we're going to be
setting it up with some open-source
virtualization so that we can run
multiple machines on that instead when
you have a different physical box for
every little thing we want to do and you
chose the XenServer I did there are a
lot of virtualization options out there
a lot of people have mentioned like ones
that I didn't realize existed I've
talked a little bit about in the past
openvz or KVM which are two of my other
favorites the reason we're going with
then is because of the versatility I can
run any operating system not just Linux
and as we're developing labs for pen
test with hack 5 yeah we're going to
need a mixed variety of Windows servers
and Linux servers and who knows what
else so it makes sense especially for us
to just run send server open source
right and so the concept today is what
we're going to be doing is building this
is this I can walk you through
essentially what I do when I set up my
little lab in my office right this is
not the one that we're going to be using
for the the hack 5 labs this is just
kind of like to show you a taste of like
how you can take any piece of hardware
not even Intel no piece of hardware and
just toss this open-source software on
it and immediately have yourself a
hypervisor set up that you can start
running lots of different machines on
and very standalone no I do have a spare
computer in the garage that I can
totally put a server on well there you
go now that I'm gonna know how to put
one on there I then run multiple servers
right that's really important it's
especially in Pentos with ak5 we're
going to be doing lots of different you
know things for exploiting different
Windows boxes we're going to need to
create a virtue
environment we're going to need to
create lots of different machines for us
to audit so we're gonna run that and so
don't do that
so we stuck it on a USB yes because
there's no cd-rom in there no what is it
also because you put everything on it
shut up and because you put everything
on flash drives these days yeah so it's
just a little Zen server I so that we
burned on grab the XenServer I so burn
it burn it to your USB using which tool
did you use um the one with pendrive
Linux I think it's gone okay cool the
one with the Linux top there's also
unetbootin and a few others but yeah
it's bringing a USB these days yeah
pretty much simple just a matter of
booting off this guy so let's come over
to our nook and I'll give it the old
three fingers loop control too late
hooray
beds go into the BIOS there or the euphy
oh is it you fee mm-hm and we want to go
ahead and choose to boot off of our USB
which in this case is somewhere whoa
boot boot configuration Oh Priory ah
here we go
so there's our USB I want to move it up
so is it page up is it okay this would
be easier with the mouse bio says of
seven load deep no 72 plus mice here we
go yeah I knew that
there there okay all right fantastic and
the hardest part of the entire install
you know just witnessed this would be
easier with a mouse oh it would also be
easier if I weren't using a das keyboard
oh but that's you know where all the
keys are I'm just like wait am I sure
that's f8 anyway
yes we want to save so this will boot
off our USB Drive and it's very similar
installed to most other Linux operating
systems here we are such as end server
and we're going to go ahead and let it
do its standard install ok so you can
say it actually extracting the
filesystem and all the other good stuff
it is it's based on Linux so what I
really love about this is there's a lot
of other virtualization options out
there we were talking about KBM no pvz a
couple months back and the trouble with
those is that you have to go through the
effort and not that there's anything
wrong with this but you have to go
through a lot of steps to configure like
cent OS or Ubuntu or Debian or whatever
the base operating system is and then
install the hypervisor on top of that
yeah which that's fantastic what I'm
loving about this is this is the quick
and dirty like I'm gonna have VMS and
less than an so can you explain what a
hypervisor is yeah basically it's it's
an abstraction layer of sorts basically
what it's doing is that this is one
physical piece of hardware and typically
we would take this and put one operating
system on it and then one user would use
it yeah right but that's kind of a waste
when 99% of the time it's sitting there
idle so what we'll do is install a
hypervisor which will essentially divvy
up that hardware among the virtual
machines so the virtual machines are
different from the hypervisor hypervisor
is here talking to the hardware and then
it's allowing us to create all of these
little buckets a virtual machine like a
little man in the middle is it kind of
if not is it yeah um I'm sure there's a
better explanation out there we're gonna
go into us keyboard ok and we're gonna
go ahead and we erase everything on
there to disk accept the EULA and at
this point where you go ahead and choose
where we
to save our virtual machines and we're
going to go ahead and use the SATA drive
the SSD actually which is in this case
SD a whereas SD b is the seven gigabyte
or I guess a keg the year slash drive
that we're installing off of and that's
an important thing to note here we could
actually install our entire operating
system onto the USB drive and then use
say network attached storage to save our
virtual machines in this case we're
going to put both the hypervisor and the
virtual machines on the same disk
because this is going to be a one-off
server and what is this enable thing
provisioning thing oh we're definitely
gonna want to do that what is it well
first of all it speeds up when we create
a disk so okay I'm gonna go ahead and
create a new virtual machine I want to
run a Windows 8 box because I'm testing
out some different exploits and stuff
and say I need to give it I don't know
like a 40 gig hard drive yeah well it's
going to be able to allocate all of that
40 gigs much quicker if it doesn't have
to actually go ahead and I don't know
how to describe this other than to say
like steal 40 gigs from the desk right
it's because the Windows installation
itself is only gonna use like 8 gigs and
then slowly as we install service packs
another software it will expand when we
use all for me yeah right so what I'm
saying is I was like ok you can have
this much disk space but I don't have to
worry about provisioning this much as
you need it and then that means that I
can have more essentially you can have
more virtual machines on your disk
yeah then like I could have say it's a
500 gig hard drive yeah
instead of having 500 gig partitions I
could have 2,100 gig because they're not
all gonna be full oh that's cool I like
dealing with debt and China it's like
it's not at all it's pretending you have
a bunch of storage yes
basically at this point we have to go
ahead and choose a source where we would
like to do the installation and it's
going to be to local media like I said
we could even install this over the
network it's kind of crazy
HTTP why not why not and then we're not
going to install any supplemental tax at
this time if we need to install service
packs we can do that through the done
manager
I'll show you the embed and we're going
to go ahead and skip the verification
because we are pretty sure that the USB
Drive is good going to come up with a
very fancy and secure password mm-hmm
password is password yes that one one
two three um normally we would want to
go ahead and give it a static IP address
let's go ahead and do with that anyway
um Paul let's see what we can see on our
network somewhere right this is just a
test one I'm gonna use I'm gonna guess
152 and say there's nothing already out
there on 152 I probably should have done
like a little nap of the network first
do you want me to map your net happy
nuts for you I'm actually pinging it
right now to make sure it okay doesn't
seem to be anything over there that's
good enough for me
we'll continue on it's a 255 255 255 0
for the subnet mask here at the hack
Club warehouse on our lab network and
that's our gateway okay and then we get
to choose the name of it
Zen Silva - I don't know that'll work or
- test cuz we're gonna blow this thing
out of the water here in a few anyway oh
no
give it some DNS servers I like to use
Google's and that one and can I remember
another one off the top my head yep
can't - is good enough and then where
are we
we're in Africa we're in Africa okay and
where are we in Africa we are in Los
Angeles I want to say yes that's
obviously in Africa just need to that
for the time zone well it's going to
tell to use NTP for time and at this
point we actually have to choose our NTP
servers or Network Time Protocol we're
gonna use the US government because they
are epic aren't they time da nist.gov
time time time thank you and I think
it's also time nasa.gov ah no it's NTP
dot NASA doc you can't spell thank you I
can't spell okay
it's the Das Keyboard yeah sure and then
finally we say yes let's go ahead and
install the server
hurry test bars and that's it quick and
painless
boom all we have to do now is reboot
unplug our USB drive and we're good to
go
okay we now have his end server haha
what was that you see what I'm talking
about I really like it for just being
able to quickly spool up some new
goodness it's gonna reboot off of the
mSATA now so now what are we gonna do
there we go and can we play things oh
here here take a look at the boot
there's there's not much to it you get
the pretty splash screen yeah and then
you'll see here and there we go
that's it yay not much to it in fact
here we can pretty much just see the
status and what's going on with its
network and we can see the virtual
sessions basically just where you can
figure it whoa this is supposed to be
like headless right it is supposed to be
headless so we actually for the most
part don't even need to touch this yeah
you'll see if they even go into virtual
machines I can see all of the VM running
on this host and there aren't any you'll
notice I don't get the option to create
a virtual machine from in here you know
I can change a few technical settings
yeah but mainly this is the beautiful
thing I don't actually need to get to
this all of the administration is
actually done through piece of software
called Zen Center um we're gonna touch
on later some open source alternatives
some other ways to do this it's not open
through open source well no it is but
the problem is it's Windows centric oh
gosh so if you're running the Linux and
you don't want to have to chicken to the
egg you need a Windows VM to run this
but you can't create a VM without the
windows no no there's some alternatives
we'll talk about okay at another time
when we start really getting into the
cluster II goodness and setting up
NASA's and things of that nature but
just for the real quick getting yourself
set up we now have a Zen server yay
which means we now want to put virtual
machines on it all the virtual machine
and we'll do
that after the break you've watch act 5
for a while you know how much we love
domain.com we always use them whenever
we're registering new domains and the
other day I was thinking about all the
fantastic projects we have going on here
at hack 5 in the summer I mean including
this here is n server we're building
today and also some of the epic stuff
we're going to be doing with drone
racing
that's right Nano quads if you're into
the hundred and twenty millimeter series
you're going to want to get in on this
and that's why I was so excited when
domain.com told me about the new dot
clubs because I mean it's Universal
right I mean I've got so many crazy
ideas of awesome stuff that you can do
with these dot clubs and I think it's
just a perfect top-level domain you see
a dot Club it's universally understood
it's not just here in the United States
either so if you're building a new
business if you think about the you know
what's that perfect name for my startup
you couldn't find one better because
it's so social I mean the Internet is
all about community and collaboration
what we're doing here so why not use a
dot Club and so this summer I just want
you to get ramped up for hak5 and dot
Club and in the meantime when you're
thinking about hosting your website
consider yourself a dot Club you can get
them over at domain.com for $9.99 a year
and there are still tons of awesome
options still available and get this
when you're over at domain.com you'll
want to use the coupon code hak5 that'll
save you 15% and let the domain.com
folks know that we sent you
matter of fact get this if you want to
tweet me at hack five Darrin the dot
Club domain that you registered we're
going to go ahead and give you guys some
mad props in some traffic your way so
when you think domain names think
domain.com we're back now with our home
lab virtual server we're about ready to
install some all sorts of Awesomeness
virtual machines but first we have to go
jump in a pool because that's what you
do in the summertime is you get in the
pool with all the kids and I just
recently found out the reason why your
eyes get scratchy when you're in a pool
is not because of the chlorine is
because of pee okay so Shannon we're
actually not going to be peeing in pool
but the pool as it relates to virtual
machines has more to do with allowing us
to share resources
think of it like okay so we could toss
like 16 people in the pool right and
then we'd have a pool party and there
could be like all of these different
beach balls that they could all share
and then we could share the beach balls
among the people in the pool this is a
really terrible analogy so what is a
pool it's called a resource pool
essentially what this is one of the
really cool things about XenServer and
it's not applicable to this particular
instance where we're just showing attics
pull up real quickly like your little a
single node yeah just you know lab
environment like play in your office
kind of server but we'll come back to
this later as we build this out
essentially as enter allows you to have
multiple servers we could create a whole
stack of these nooks right and they
would all become part of the same pool
and then they could share the resources
among each other
oh that's clean we could actually just
totally like when you work at a
restaurant you have to pull your tips
yes everybody it's exactly like that
except not at all so let's just go ahead
and create our first pool we actually
have to first create our first server
which is what did we say 1070 331 we
made it 152 and we'll go ahead and get
that login going and hooray
no tests has been added and at this
point we can create a new pool we can
call it pool party we can create choose
who's going to be the master of this
pool party and it's going to be the
XenServer test and then we can add
additional servers just as we had done
before and then create the pool and then
they can share resources among this so
each of those are going to be the
different knucks yeah in the future when
we actually create a whole stack of
these guys get but just for now quick
and dirty to get things going we're just
going to you know just use standalone so
this is the only piece of hardware a
single node it'll be real simple at this
point we do need to create some storage
so let's go ahead and do that it's add
some storage and we're going to need to
create ourselves a little ISO library
now we already defined where it's a
storage wise our virtual machines are
going to live yeah and that's just gonna
be on this on this machine but how do we
get the disk images so from another
computer well yeah basically um well you
just burned at the ISO for XenServer
onto this USB drive I guess we could
just
a USB Drive full of ISOs on this machine
yeah but it would be better especially
as we look towards the future having a
whole library of ISOs those you know to
actually add on to it through network
yeah okay yeah so in this case since we
actually have a what is it a Synology
here and it allows us to do very simple
CIFS shares we're gonna choose to go
ahead and create our libraries that way
so so you've already created a folder on
the NASS right all of our ISOs right if
I go to for instance here I've got nice
as folder that look at that I got Callie
and friend akane boon to in Windows are
that good stuff okay so I'll go ahead
and say yes and I'll give it the server
name in this case what did I say it was
there I'll just copy that alt D gets you
to there copy that and paste it there
and we'll have to log in as Zen server
so you know whatever your permissions
are in this case I've already created
that on our little Synology guy over
here okay just good stuff yay
all right and so now we can actually
create a virtual machine off of that
accursed BM very simply click new VM you
choose what's it gonna be well oh that's
awesome let's install a Ubuntu trusty
tar 1404 because I'm a TLS fan and we'll
name it tar tar is hard and then we
choose check this out boom there's their
CFS library okay cool and we can go
ahead and choose Ubuntu 1404 point 2
let's need so it pretty much has like a
built in installation thing for ISO
basically and this is great because it
knows what it's what operating system
I'm choosing to install and it can make
all of the best practices as far as
setting up the VM so that it will run
most best Lee then we choose where we're
going to go ahead and install - since
this is the only node in our environment
we will choose to install it to the
XenServer test
okay we're gonna choose how much how
many processors we're gonna go with one
processor it's fine how much memory it
already chooses a gig we've got 16 gigs
of ram in here we can afford to give it
you know many more it's gonna be a
server let's give it 2048 I don't know
that sounds good and then where what
what's storage and we're going to go
ahead and choose the local storage on
the XenServer okay and we're going to go
ahead and let it stay eight gigs that's
fine we can add more later if we need
and in just a moment
oh there goes test bar yep provision
using the CD drive creating disks
reticulating splines and starting we can
go over here and you know change our
memory and check out our storage and all
the network e stuff but essentially we
go to the console booyah
press ENTER to log in okay I'm sorry
let's the console of this particular
machine of a guitar over here on the
left so on the left you'll see these are
where all your servers are we call it
Reptar yeah
and I can go to server and check this
out cool she was English oh wow yeah
they're gonna do some funky stuff here
and there set it to scale and we can go
ahead and actually proceed with our
Ubuntu installation hey how cool is that
help surprisingly easy yes we can even
like unlock this and now I've got it in
totally separate window hooray that's
awesome yeah I know it's it's all it's I
mean I just wanted to show you the like
real quick and simple with just one nook
yeah where we dive into because now it's
gonna make so much more sense now you're
familiar with it now I encourage you to
go and try this and build your own in
fact you don't even need a nook
there is an entire HCl XenServer org
this is the hardware compatibility this
where you can see all of the different
you know storage devices that are
supported all the different network
interfaces cards that are supported and
things of that nature and you can go
ahead you can build your own yeah nice
you probably have some scraps in your
closet now so there's no excuse not to
build his own server Oh plenty of scraps
potato chips potato chips here we are
gonna go get our potato chips but before
we do that we would like to thank you
once again for joining us here on hack 5
we've got a lot going on right
now between pentest without ya we do
look for Descon crazy which is going to
be our ten-year anniversary which is
kind of crazy we should probably get
like a meetup going or something you
guys let us know tweet us I'm at hack 5
Darren I'm at snubz and let us know if
you guys want to do a meet-up at Def Con
it should be a lot of fun I would be fun
10 years yeah bring gifts appropriate
for that can we just have a Stubbs we'll
be there yeah I like My Little Ponies ok
um cuz we're gonna have a booth so
should we just have like a meet-up at
the booth no we can do better than that
but we'll definitely be at Def Con and
having all just take over a Brasserie
could take over yeah yeah that's it just
look out Vegas we're coming for you fine
ship hackers to slowly swarm this
restaurant and all the way you know what
if we actually did slowly like a whole
bunch of zombies can we dress the
zombies I like that even better slow
zombies okay yeah we're going on a huge
tangent here alright
feedback I act I've got Oracle seek
where you can let us know what you guys
think of course in the comments below
you can tell us why this is a terrible
hypervisor and we should actually be
going with something based on Gen 2
I hear you with all of that you can also
find our social networks in the places
where we hang out at your act 5 dot org
slash follow you can also like and
subscribe and all of those good things
and find out you know hack 5 generally
there's tons of good shows we've got
move X to a Metasploit minute Shannon
and Patrick and I are doing threat wire
3 times a week which is epic I'm so
excited about that I know you're doing
some amazing things over on texting like
Patrick Norton
yeah and I'm probably forgetting half
the other shows so with all of that oh
man we're crazy yeah an H a cake shop
calm for all of the good stuff that's
keeping this going we really appreciate
it we've got some fun new toys and
yes thank you for showing me how to
install that that was super fun yes
so now let's blow it out of the water
and do it again right okay look at it
now it's time to get the pool party
going alright alright until then i'm
darren kitchen I'm Shannon Morse
trust your techno last trust your tech
first you can't do that they have to
they give them the opportunity ha ha ha
that's just mean of you that's gotta be
some competition you know
oh my bad what is this a stool
processing you guys are only doing it in
360p now no where's my hat in this man
huh</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>