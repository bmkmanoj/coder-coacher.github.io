<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>LAN Turtle 104 - Persistent Shell Access with AutoSSH | Coder Coacher - Coaching Coders</title><meta content="LAN Turtle 104 - Persistent Shell Access with AutoSSH - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>LAN Turtle 104 - Persistent Shell Access with AutoSSH</b></h2><h5 class="post__date">2017-10-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/uIdvvrDrRj0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I'm Darrin kitchen this is land turtle
basics and today we are talking about
SSH and how to maintain a shell on our
land turtle so you should be familiar
with SSH by now it's what you've been
using to maintain your land turtles thus
far but for this for all of these
examples so far we have been directly
connected to our land turtle over USB
and thus over Ethernet and having
connection and as you can see here from
our previous examples I have a little
Windows virtual machine and a little
Linux virtual machine and I'm using
putty to go ahead and SSH into that and
that's fantastic but I want to be able
to have access to my land turtle and
thus all of the other nodes that it's
able to see no matter where it is
deployed so that's the idea behind this
is what we're going to do is we're going
to set up our auto SSH to connect back
to a server that we have in the cloud so
that no matter where I am I always have
access to the land turtle and of course
every asset that's connected to that
land alright so let's go ahead and get
started under modules I'll want to go
ahead and start up Auto SSH
so Auto SSH what this is going to do is
allow us to configure a little bit of
remote and local port forwarding and
what this is going to make happen is
that the local port 22 the port 22 that
is on the land turtle will be accessible
from port 2 2 2 2 on our remote machine
through a tunnel which is pretty cool
the auto and auto SSH is just a
front-end to SSH that maintains that
connection it keeps it persistent it
does a little keepalive and if anything
goes down it auto restarts it because
the last thing we want to do is deploy
something somewhere and then not have
access to it later on just because there
was a little network hiccup so let's go
ahead and get started for this I have a
little virtual private server in the
cloud I'm gonna go ahead and copy this
IP address and let's SSH into that
server there in the cloud
I'm gonna go ahead and create a new user
on this this little virtual private
server that I have here by doing add
user I'm gonna call it turtle I'm going
to go ahead and give it a password and
give it a name and all of that stuff and
say yes this information is correct
great now my turtle has a user so I can
go ahead and start setting up keys so
the auto SSH module is going to rely on
public private key pairs being exchanged
and what that means is there's no way to
once you've deployed this interact with
your land turtle to have it type in the
password that I had just set up on my
epic little server here happy Bunny
spider monkey kill kill kill and to do
that without having to type the password
in we're going to go ahead and set up
private private public our SIDS a key
pairs if you've been doing SSH for a
while you should be very familiar with
it otherwise we've made it very simple
in the land turtle so let's go ahead and
generate those and copy them over and
you'll see how that works so I will
actually exit the auto SSH configuration
and come back to it once I've set up my
keys to manage my SSH keys is actually
another module called
key manager now like some modules that
only have a configuration this can't be
started or enabled or stopped or
disabled it's not going to do anything
but you can configure it which will
bring you with the option to go ahead
and generate an SSH key pair so let's go
ahead and do that and we already have an
SSH key pair on here but let's go ahead
for the fun of it go ahead and create a
new one it does take a minute or so
there's not a whole lot of entropy on
this tiny little device but in just a
moment we'll have a brand new key great
so we have our new key and the next part
is to go ahead and copy that key to a
remote host so I'll go ahead and choose
copy key now we're going to need a host
now in this case it's us what was that
IP address it was 104 for my little VPS
in the cloud here two three six one four
three two one nine port is 22 that's the
default and then the user in this case
is going to be
turtle go ahead and submit that says
that it can't find it in the known host
so it will go ahead and add it as an own
host and there we go and I can see here
in fact I can actually check this
against the server and make sure that
that looks correct so that's been added
and then next it's going to copy the key
and it needs the password to the turtle
account that I had just created over
here I'll go ahead and give it that and
there we go we can actually now review
and see that I have my ssh RSA keys set
up great so at this point i can go ahead
and choose back and back and go back
over to auto ssh so from auto ssh i can
configure and set it up for the user at
the host in this case the user is
curdled at and again one of four two
three six one four three two one nine
and i want to leave these default of
course there is help like there's many
others go ahead and submit that and you
can see there's plenty of examples here
of how this works
so with that submitted let's go ahead
and start this now you'll see that
connection has been established I can go
ahead and hit OK to continue and go back
and I will notice that I have a check
mark right there next to Auto SSH well
what does that mean over here well I am
now route at happy bunny spider monkey
kill kill kill if I now SSH as route
because remember the land turtle runs
his route at localhost tak P for port
number two two two two what I'm actually
doing is I'm not sshe
my virtual private server back into
itself normally on port 22 where I have
my ssh server listening but a rather i'm
going through that tunnel through that
port two two two two so it maps to two
two two on this end and it maps 22 on
that end so once i've gone through the
tunnel where will I end up well I should
end up at my land turtle on port 22 with
my ssh server welcoming me go ahead and
issue this and for the first time ever
it's saying hey well you know this is a
new key finger
doesn't match yes it does I'll accept
that and now I'm asked for the password
I'm gonna enter in my land turtle
password and look at that over SSH I can
now go ahead and edit my modules I can
go ahead and configure things to my
liking and go back I can exit I am now
through the cloud through my SSH session
I now have access to this land and
what's really great about this is it's
not just having access to the turtle
shell and have the ability to configure
my modules but it's also that I am now
poised in a position where I have the
visibility onto that land the same as
the land turtle and I can access this
from wherever I am so if I now go off
with my android phone and pull up an ssh
like connect bot and i ssh into my
little virtual private server and from
there ssh into local host on port 2 2 2
2 I can go ahead and log in as root to
my land turtle and have access to the
land that it's been deployed on from
wherever which is really cool and
building on the other concepts that
we've talked about in the last session
we can set this up to be a enabled
module which will mean that it this will
happen every time it starts and of
course there's much more amazing
gymnastics that can be done with SSH as
far as setting it up with the ability to
say for instance just SSH into my relay
on port 2 2 2 2 and have it bounced
through there's amazing capabilities but
suffice it to say now I have my land
turtle all configured I can go ahead and
deploy this in fact it doesn't even have
to be plugged into a machine so actually
let's go ahead and do that so I will
exit the session back to my virtual
private server I'm going to go back into
my auto SSH and I will go ahead and
enable it so now it's enabled on boat
and at this point as before I can go
ahead and do the proper shutdown
procedure which is to just unplug it and
in this case I'm not going to plug it
back into the computer I'll just use any
old battery pack in this case I'm using
a pineapple juice and I will go ahead
and plug that guy in there and this will
boot up and in just a moment I should be
able to SSH back in just as I had done
before and have
access to my land turtle and just like
before ssh to read at localhost port two
two two two connection reset by pierre
it hasn't made its connection yet we'll
wait just a moment try it again and in
this case i'm asked for my password and
now i have access to the turtle shell
and if you've been following along you
might imagine that i could do the
inverse here and copy my keys over from
the server to my land turtle so that I
wouldn't be prompted for the password
when I want to go ahead and log into it
and manage it all sorts of amazing
possibilities with SSH and we're going
to go ahead and continue building on
these with the future segments here that
you can find over at Lanter ttle comm</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>