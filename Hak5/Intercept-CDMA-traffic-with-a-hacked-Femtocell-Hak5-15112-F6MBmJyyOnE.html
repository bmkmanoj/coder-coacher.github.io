<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Intercept CDMA traffic with a hacked Femtocell, Hak5 1511.2 | Coder Coacher - Coaching Coders</title><meta content="Intercept CDMA traffic with a hacked Femtocell, Hak5 1511.2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Intercept CDMA traffic with a hacked Femtocell, Hak5 1511.2</b></h2><h5 class="post__date">2013-10-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/F6MBmJyyOnE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this segment of hak5 is brought to you
by goto assist whatever the emergency
vehicles have these in them as well uh I
would if I were a corporate or
government entity
running or maintaining a large fleet of
vehicles I totally put these in in every
crown back in every crown gear or
whatever limo right now
I guess I don't know don't be by
American yeah now are the American and
are the European they're like okay so
you mentioned that there's a 32-bit
number okay so it's not really a MAC
address but is it the equivalent of like
a know you why where you can tell the
manufacturer like oh that's an Audi or
that's Ford there doesn't seem to be it
seems to be much more dependent upon the
company that makes the tire pressure
monitor itself so for instance Ford and
Honda and all these different companies
they don't all make their own tire
pressure monitors they usually buy them
from another company Schrader is the
first one that comes to mind they're
famous for the Schrader valve okay so it
seems like they have their own package
structure their own particular setup I
haven't spent a lot of time mining but
there isn't like a standard this is how
you speak oh yeah you're even talking
about the frequency difference and the
modulation difference but when you get
down to it they all have like a kind of
a core identifier yeah and it the ID I
think is unique for every particular
manufacturer of TPMS but they never
really got together apparently and
agreed on a single package structure or
some sort of a central authority for
assigning identifiers
okay so you were saying that you're
riding around and you're trying to
figure out like which tires which how do
you go about doing that well and I went
for a ride around with a friend of mine
and as we drove I would record the tire
pressure monitor transmissions and then
we would stop somewhere and we would let
air out of one of the tires and then we
drive a little bit more and then let air
out of another tire and eventually we
collected enough data I was able to
graph it and you could see a drop off
one tire at the time where the pressure
went from 33 pounds or psi to 30 and you
can say conclusively well that had to be
the right front that'd have to be the
left front etc etc does this mean you
could go around an entire parking lot
and just start identifying all of the
vehicles in it not quite these tire
pressure monitors because they're
installed potentially for years within a
tire you don't want to have to you don't
want it I'm sorry no no no I just
realized where you're going I just
remembered that actually right before
coming to this con my 2008 r32 just had
to have it replaced and I think they
even said the battery died yeah how that
now that I'm thinking about that that
was a really expensive battery through
place yeah they probably replace the
entire unit I think they're sealed but
I've never actually held one in my hand
all the research I've done today has
been online or with other people's parks
the hats off um yeah I'm what can I say
I'm like I'm a GP I'm driving a 14 year
15 year
to the parking lot we're not going to
identify anything right because these
these devices are installed long-term in
your tire they have to last for several
years at least as long as your tires
last so they usually do not operate
while the cars is parked they've got
some sort of an accelerometer or some
sort of a mechanical switch that detects
rotation at which point they turn on and
continue to operate until the motion
stops for a certain amount of time and
the data that you get out of them it's
just temperature and just do we get the
actual acceleration in if they have an
accelerometer I haven't looked at a lot
of different makes and models yet but so
far I've only seen temperature and
pressure and then some flag fields that
indicate apparently the state of the
sense of one of the bits I imagine
indicates the battery status but I
haven't concluded that yet again because
I don't have any tire pressure monitors
of my own to experiment with that's why
it's time to get some in because I can
only imagine that there's a debug mode
or a programming mode or a pairing mode
kindly compare your Wemo to your wii or
something like that well that's another
thing to explore is apparently some
devices can be activated using an LF
signal 125 kilohertz that puts them into
some sort of a programming we're back to
reload that allows you to do some untold
things so there's some experimentation
to be done there still there's a
potential denier denial of tire pressure
attack possibly there all right yeah you
could go and reprogram assuming that
these devices are reprogrammable they're
their ids or reprogrammed or via this
mechanism you could go and re ID
everyone's tire pressure monitors and
suddenly they wouldn't be getting any
reports at all but I think the scarier
thing is just the whole idea that we're
sitting here with your laptop and that
$20 dongle or this could be you know say
I'm mesh network pineapples and dongles
or whatever have you on street corners
do they transmit enough that we could
actually pick up everybody's signal
devices typically transmit every minute
assuming that there's not an issue
apparently they transmit more often when
there is the
the catch is that every car has four
tires which means that on average you're
going to get a transmission every 15
seconds and that's often enough
especially in slower traffic like here
that as people roll up to a stop sign
you're almost certain to get at least
one of their tire pressure monitor IDs
received so definitely at a stoplight
what about the range like what would you
know you were saying that the
manufacturers are like oh but it's so
weak of a signal you could never get it
from afar what was your test environment
like well most of my work was done
sitting at home I live on a fairly busy
street and there's two lanes of traffic
going by usually a very strong rush-hour
and I'm sitting at my kitchen table with
windows out looking on the street maybe
30 to 40 feet away and I receive a lot
of tire pressure monitors as they go by
and this is with just that tiny little
antenna not even like a high gain yagi
or something right yeah and I dream of
building up a yogi for for this
application but my Kaufmann and I were
talking a while a few days ago about
grabbing some coat hangers from the
hotel and soldering something up but we
didn't quite me I was too busy finishing
up my presentation as I should as a
beautiful speaker and tell me about the
code because what is it so you go into
Jersey you know the frequent say you
know the frequency and the rates and all
of those things now you need to somehow
process it so that it's someone useful
is that what your code does right
exactly yeah so first proust process is
to capture raw data so you use new radio
with rtl-sdr or maybe a hack RF block
and pull in the raw data I like to just
save it out to a file for later
processing I've got a separate Python
program which again relies on radio that
identifies significant signal energy
over periods of time and just pulls
those pieces out into separate files
that I can process it throws away 99.9
percent of the giant capture file that I
wanted a building when I'm holding down
the raw of spectrum so now I've got a
much smaller set of data to work with
again I have new radio blocks and Python
scripts that will go through the
individual first attempt to demodulate
the raw bits and then decode them
typically their Manchester encoded and
identify for the people that aren't
familiar with Manchester encoding that's
just what error recovery stuff
Manchester encoding is more about
modulating an RF signal to be more
suitable for radio transmission it
guarantees that there are sufficient bit
transitions from 0 to 100 or 1 to 0 so
that you can recover the bit clock and
figure out where the bit boundaries are
so that you can get a valid packet bit
stream so you have a real packet or way
but that's what your code does is it
figures all that stuff out and what is
it spit out so it just gives you the
actual packets on the other end well my
tools are more they're not quite about
solving or decoding for a particular
vehicle so much as providing a set of
tools for people to go and take new
captures from from new and different
vehicles that I've never worked with
before and identify this the
characteristics and kind of peel the
onion if you will and get deeper and
deeper and closer and closer to the
final packet and the final field values
and IDs be able to graph them and see
well this looks like it must be
temperature this must be pressure and
this must be the CRC and this is how the
CRC is calculating so it's basically a
tool set for figuring these packets out
when you observe new and different
packets so what do you see in the future
do you imagine you know with enough
community development and people
interested in this stuff that there
would eventually be I don't know it like
a standardized way to like to get it
pour it in a Wireshark or something or
what's what's your dream here I think we
could get to that the
industry comments about there being 147
different protocols
rings true to some extent because the
the sort of group horse weight to handle
that is to build 147 different duty
radio receivers unfortunately that's
computationally a little excessive and
wouldn't perform very well on anything
that the previous laptops so I'm hoping
to create something that's a little bit
more intelligent examines purse and uses
techniques like Fourier transforms to
extract spectrum details that can be
used to infer bit rates and frequency
shift keying deviations and things like
that statistical analysis is the
analyses that will figure out well maybe
this is an 8-bit checksum and this is
how its computed and and kind of figure
all that stuff out for you or at least
help you along the way this is so
exciting because it's kind of like just
discovering like a new I don't know just
covering it totally new protocols so
what do people need to get the code and
start using it and then where can they
find you know the future development of
this stuff well all of my work thus far
is posted on github so github.com /j
boon
jay-bez and Jared boon is in Daniel
Boone slash TPMS tire pressure
monitoring system I posted all my code
there and I'm going to continue refining
it I'm going to try doing these sort of
automated characteristic detection
techniques and try to evolve it to a
point where I can pretty much analyze
any of these packets and get a nice
built up piece of code that'll do all
that work and all you have to do is go
out and get like an RTL SDR dongle a
hack RF and antenna that kind of stuff
and run it on your laptop I am thrilled
this is so cool thank you not sharing
this Jerry back rich it in everything
else that you do they can find you over
at sure brain comm my little single
person open hardware it's really cool
you guys should check it out you just
fun things with box seriously I know how
it is working in IT it means constantly
jumping from one problem to the next and
everything of course needs to be solved
past every minute counts I mean you
can't waste your time juggling different
tools and duplicating data entry that's
why I use go to assist let's copy and
paste it's from Citrix Thor the leader
in remote support and get this you'll
have all the tools you need in one nice
little integrated cloud-based platform
so you can work faster and more
efficiently let's see go to assist
includes three different support tools
customized to your needs well there's
the service desk so you can log
incidents and track the resolution
there's go to assist monitoring to
proactively identify issues before they
become your boss calling you in huge
headache and of course remote support to
provide live and unattended support to
any PC Mac or mobile device from
anywhere to resolve issues quickly I've
been using them for years it is saved my
bacon on more than one occasion so you
can assist anyone sign up for your
special 30-day free trial today visit go
to assist com click on the try it free
button and use the promo code hak5 let's
go to assist com promo code hak5 and
it's time for the technology of the week
this week we have a couple of cats
because I love my cats and they're full
of techno less now samuels cat Kaiser
Wilhelm is hanging out and so is Wayne
owes little black kitty perfect for
Halloween you can send your photos over
to feedback at hak5 org with the subject
line techno les
we're here at torque on 2013 with your
dog and you are you guys doing doing
great so tell me about this talk people
are like really buzzing about this you
guys are doing some CDMA hacking what's
that all of that yep so what we did is
we took any of em toe cell from a CDMA
carrier and we acted basically so it
allowed us to intercept phone calls text
messages picture messages as well as
data connections so how does this differ
from some of the other attacks that
we've seen recently would say you SRP is
doing head up you know open BTS with
only GSM well so we basically took a
commercial device and kind of used it
against itself in a way it's a
femtocells there's many cell towers and
but they're also Linux promises and so
we just go win it through the console
game overturn it and so will you go
about getting a thumb toe cell and then
you know who makes these and what are
they used for outside of you know fun
packing sniffing purposes so you can buy
these read at the Verizon store they're
to attend $50 walk into my one they're
manufactured by Samsung these are just
completely trusted endpoints on the Sun
that work
great service yeah maybe you say
completely trusted endpoint is is that
one of the things that might say
differentiate it from us are he trying
to screw the GSM network or or what
because you're saying that's specific to
this carrier Verizon yeah this is
already trusted by Verizon so that means
that this just act that than any other
of Verizon Tower when your phone sneer
at your phone those are just another
Tower
so if I set one of these up in my house
not only is my verizon phone gonna
connect to it but my neighbors as well
potentially eventually the range is
anywhere between you know it says you
have to be about 15 feet away within 15
feet or to get your phone to associate
to it and then after that depends on the
signal of the towers within your general
area but 4050 M every week you know it's
all it really depends on the environment
and it's also worth saying that there's
a ton of carriers all over the world
that have these - they're you know
they're in Europe every almost every
major area the US has one as well AT&amp;amp;T
Sprint as well as Verizon so the idea
here is that it doesn't just relay a
cellular signal because obviously the
only reason that you would have one of
these is because the cellular signal is
so weak right these actually connect to
what the subscribers actual home
internet connection
yep that's right so basically it just it
looks like a Wi-Fi router and it's got
an even import on it you connect that to
your home internet connection and it
broadcasts CDMA wireless instead of
Wi-Fi
so in that case why don't you just snip
off the internet and you know your day
is done because it's encrypted they
didn't they do create a new set tunnel
back to the carrier's network so it's
all internal and so there's no like
downgrade attacks against that or
anything nothing that we looked into to
be honest it was just kind of easier to
connect to the console for that was
built in and you know get brewed on the
device and kind of take
yeah we kind of had a console port built
in that's kind of beautiful sit
Thank You Samsung well what is it really
the first step for you guys into you
know getting into the core of the device
and being able to see what's going
through it before that VPN well so we
have to create a custom begin driver
that's some kernel driver that's added
there so grab packets because they're
VPN implementation was happening in the
kernels you can just write some code to
actually but it's actually just an
embedded Linux device as everything is
nowadays yep yep that's right it runs a
Bonavista Linux and as well as custom
binder is that allowed to act like cells
are and so what kind of stuff are you
able to see or is the VPN only one layer
of encryption like if I'm you know doing
text messaging over this is there
another layer of encryption over top of
that that's gonna for you from being
able to see you need talking to my
girlfriend about my cat back home oh no
it's uh there's no more encryption after
because we were able to get the packets
before they were encrypted and then
after they were to craft a so we just
didn't we created a kernel module we
inserted it such that the priority was
before the packets got decrypted by
their criminal and before they were
encrypted by their kernel module and so
that what were able to do is just see on
the plate there's no more encryption
after that the text messages are coming
in a little funky but you know just a
very simple script to decode and Rose
how all of the carriers implement this
but this is kind of like a common the
femtocell is a common thing amongst
carriers worldwide correct yes there's I
mean last we knew is something like
30-something carriers worldwide that
that pentacel some kind so there are
small embedded devices I can only assume
that they are similar but we really
don't know we didn't and so when you had
that Eureka moment of like oh there are
my package what was the first thing you
do we did with
send a text message maybe I'll call
trying to play it back looks like all
the data admitted HTTP request and saw I
actually get request of yahoo.com and
that they were yes so our first our
first custom code was basically a packet
dumping software piece of software that
you know just develop packets and of
course phone call is just a bunch of
tiny UDP packets and so that was a
little overwhelming and that that was a
bit of a challenge to reassemble that
into a voice ball but it was very easy
to just showed up from our shark and the
text messages again took us a little bit
to be able to decode those properly and
find out which packets held the actual
text from the message so that was a
little difficult but not not too bad and
then picture messaging was kind of cool
too because we just take the picture
message you send it to someone as long
as that force associated femtocell the
packets go through the pepto so and we
pull them out and grease under the
picture that's just like a JPEG or HTTP
or something yeah so it sounds like
actually the phone calls the the most
difficult of all of them yeah that hat
is beating our heads against Walker for
quite some time it's we've got some very
talented guys at and I second so we kind
of farmed it out to one of them who you
know was able to pull that phone call
out in much less time than we ever would
of the hospital which didn't make us
feel too good about ourselves at the
time but has this changed like your
habits of the I mean have you switched
to another carrier or what are you doing
on your own personal problems now that
you've done that pulled off this attack
well we did create a an app for Android
called femto Kettering this is the
Google Play Store right now
and basically what it you can it will it
detects when you're connected to a pen
go so and it's got an optional
he's a functionality where it will once
it detects that it's connected to a
chemical cell will automatically go near
blank oh oh that's kind of really I love
that cool so if you let me just find out
on the App Store what about your
research with the you know the packet
sniffing goodness on the actual device
well we didn't really sir we're not
going to release any of our code but our
slides from blackhat as well as some
demo videos are up on our website on
Isaac Rutgers calm fantastic well thank
you guys so much Andrew
pleasure thank you Cheers so once again
thank you guys for supporting hak5 thank
you sir for supporting hak5 i'm
repeating myself that wasn't expected
you can fight otherwise follow us hi-5
dot org slash follow big huge shout out
and thanks to Tim and Akari and geo and
everybody that was having us out at
torque on we had too much fun all of the
awesome speakers we're gonna have
another episode next week with some even
more fun stuff really mind-blowing cool
stuff coming out of torque on I love
that con it's one of my favorites if you
want to support the show directly hack
shop comm is where you can find crazy
people with pineapples and bananas on
their heads that'll ship you out awesome
stuff including our new pineapple that
we're super proud of and with all of
that said I'm daring kitchen and I'll
see you on the Internet Oh trust your
technical then that thing goes supposed
to at least
supposed to at least yeah hey we're
getting rid of the gym so one less Jimmy
Jim Jimmy jib jib all right I don't work</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>