<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Setting Up For Encrypted Messages On A Air Gapped System, Hak5 1504.3 | Coder Coacher - Coaching Coders</title><meta content="Setting Up For Encrypted Messages On A Air Gapped System, Hak5 1504.3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Setting Up For Encrypted Messages On A Air Gapped System, Hak5 1504.3</b></h2><h5 class="post__date">2013-09-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/D_xrlAGzQfs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Strahm cryptosystems with a netbook and
an air-gap this segment of hak5
this segment of hak5 is brought to you
by goto assist so the PGP implementation
that we're going to be talking about
today is using something that's known as
an air gap and that is just as such
there's literally a gap of air between
these two machines and that's really all
it comes down to is that this machine I
can consider secure because and this is
beautiful it's not on the network okay I
just picked up the cheapest netbook that
I could find that small and light and
and also what an awesome bumper sticker
on it but otherwise the idea here is
this is now my machine where I can do
you know secure PGP messages and I know
that it is one never touched the network
and two never will touch the network so
if I just do an if config here I can see
the only interface that I have is low
and so it actually has what I like about
this is the only way to put uther net on
this particular machine is to plug in
this dongle which I just won't do and
then there's a physical switch for the
Wi-Fi I'm actually going to dig into the
Machine and just pull out the Express
card that has the Wi-Fi chip in it
anyway so going to feel good about that
now I've also set this up with my
favorite distribution of Linux and I've
set it up with Lux full disk encryption
so again taking advantage of everything
at our disposal and what we're going to
do here is I'm going to show you how oh
yeah we're bringing it back old-school
we're going to use sneakernet
to our advantage here so that we can
pass our messages back and forth between
our internet-connected computer and our
PGP offline machine so let's begin by
creating a new key and we're going to do
it the right way and create ourselves a
strong key with 4096 bits so we've
talked about you know male Volokh but
now we're going to talk about doing it
all in the command line in Linux using
GnuPG that's
you know gnu's not Unix Sonne PGP
implementation of the the open PGP spec
and this is good stuff so if we do GPG
tak tak gen - key we can go ahead and
generate our key and we're going to
choose an RSA our default key the number
1 and we're going to choose 4096 bits ok
and we're also going to say hey you know
what this is going to expire in one year
so the idea here is if you if I were to
you know lose this machine and the full
disk encryption were compromised and
well at that point the private key even
if it's an ASCII and there on my plane
taxi even though I would consider my
private key like no good I want to
revoke that key pair so it would do a
revoke a ssin certificate I'd put it up
on the key servers and send it to all
the people that I'm using to communicate
with this yada-yada-yada point being
this key is only good for a year so that
kind of means that next year I have to
generate new key and yes it's a lot of
hassle but again we're talking about
security here it's not necessarily
convenient in fact you could actually
make that like two weeks if you really
really wanted to so we're going to say
yes that sounds good
no that's actually not good because the
date is incorrect so let me set the date
we're not going to party like it's 2009
no we need to set the date and the
reason for this is like I said this
machine has never been online so it
hasn't had the opportunity to talk to a
network time server and actually set
itself so in that case all we have to do
is date tak-tek set equals quote and in
this case it is nine Sept 2013 and then
we'll give it a time I think it's 22 no
it is
15:54 lock-on 0-0 close enough
and I need to do that with root so sudo
bang bang and there we go now if I in
turn date we can see that it's September
9th okay so now let's generate that key
again again RSA 4096 good for a year
yeah that looks good okay and in this
case I'm going to say my name is Bob and
that my hmm
Bob ah Burson to be at least five
characters okay and the email address is
Bob at hack five org no comment
sounds good okay and we enter in a
really good passphrase a really really
good passphrase I can't stress enough
how good that passphrase must be okay
and at this point now it actually
generates the key and it needs a lot of
entropy aka random data for this I'm
going to open up G edit to kind of help
think I have G edit on the system why
not
hex editor okay
and I'm just going to start randomly
typing this helps it generate entropy I
can also move the mouse around here this
little machine is funky it's it's so
tiny it only has one of those little
nubbins which is one of the reasons why
I like it because it will fit my back
pocket kind of it's only a pound and a
half so if I do have to have a separate
machine just to read email might as well
be tiny trade-off here is it's got an
Atom processor for those remember
netbooks
I loved netbooks I miss my EPC all right
way more data needed
and there we have it now of course it
takes a little while here on this little
atom netbook but the point is we have
just created our 4096 bit key and now we
can start exchanging messages as long as
I keep my privacy K secure I should be
in good shape I just need to now get my
public key to all of my friends mind you
this is not a network connected machine
so it's not as simple as just going and
pasting this into a key server now we're
going to actually have to get the
information off of this and the most
convenient way I can think of is simply
using a USB Drive so for that let's go
ahead and export our public key onto USB
and for that we're going to enter in GPG
tak
armour
tack export and then I'll call it Ellis
I'm sorry not Alice Bob is my name here
Bob Bob Orson
and we're going to save that as a file
called Bob underscore public key
you
and of ALS oops I did not
redirect the output into the file so you
know greater than Bob public key LS and
there's Bob's public keys now it's
simply a matter of copying it to the USB
Drive
two of my USB disk and now I can take
this out and do the reverse over on my
other machine so for this demonstration
I have this machine set up with Alice's
public key so I'm going to go ahead and
put that on this as well as ingest this
and write a message for us so let's take
just a quick moment alright so we've
copied over the messages and other
public keys and whatnot over to USB from
our actual networked machine and we're
going to tap that air and come over to
our secure machine look in that USB guy
and mind you this is one of the vectors
of attack we are using USB so make sure
you trust whatever USB drive you are
using that said it's simply a matter of
importing keys and then we can take a
look at messages so what I'll do here is
a GPG tak tak import and then slash I
think it's a media DK USB disk and we're
going to import Alice's key so I have
Alice underscore public key here and
I've gone ahead and imported her key and
if I actually LS that media you'll see
that hey look there's a message for Bob
txt a SC now if I cat that message
you're going to see this is just a PGP
email or well just PGP message but the
idea here is I've used you know whatever
my mail client maybe even if it's
webmail I just copy and paste this into
a text file okay and that's fine for me
to put that text file on a USB Drive I
mean this is already you know passed
through in plain text over the internet
anyway and it's as secure as the private
keys on both end so I'm not really too
worried about that what I've done here
though is I've taken out of the machine
where there are many attack vectors and
put it on to this machine where I can
now as you've seen with me just
importing that key and I've got the the
private one on the other end I can
actually go ahead and read this so in
that case it's simply a matter of doing
a GPG - - decrypt and then touch media
/d k and then the message and i'll enter
in my very good passphrase
and there it is I can see here that a
free man
is he that is not hindered to do what he
hath the will to do so if I'd actually
like to write a reply to this let's go
ahead and set that up it's pretty much
as easy as doing a well we're going to
create a new file here I'm going to use
Nano because I feel like our actual just
echo it in echo
that's a great quote into a file called
message one right and at this point I
would like to go ahead and encrypt this
with my friends public key that I
already just imported and that for that
what I will do is GPG tak tak armour tak
tak encrypt and then in this case the
the name of the file is message one
right so go ahead and do that it's going
to ask who the recipients are in this
case it is Alice and it will say okay
hey you have this key here from Alice do
you trust it we're going to get into key
signing here in just a bit but suffice
it to say in this instance I do trust
this key so I'm going to say yes and
that's it I could add additional users
if I'd like to but I'm done so hit enter
and notice now if I LS I have an
additional file here I have message 1
and message 1 a SC so if I catch one
you'll see there's the plain text of it
but if I cat message 1 ASC that is what
I need to copy and paste or copy and
paste into my email thread with Alice
back on my networked machine okay so for
that and we'll go ahead and copy message
1 ASC over to my USB Drive and there we
have it so at this point I can go ahead
and you know nothing in plain text has
ever touched this USB Drive I can you
know just download you know copy and
paste this from my notepad or whatever
have you into my email client and
actually continue having correspondence
between Alice and Bob without anyone
ever being the wiser I will point out a
couple of things here that at this point
it would be a very wise thing for me to
go ahead and shred the document over
here shred is a command in Linux shred
tak f tak you tags e file does a fair
job at basically zeroing out over and
over and over randomly you know changing
around those bytes it's you know to DoD
spec it's good stuff basically you know
erase that file so the forensics
investigators could never recover it
which is awesome
and that coupled with the full disk
encryption on here and I'm starting to
feel a little bit more comfortable now
I'm not saying that this system is
perfect by any sort of the imagination
as you can see it is actually fairly
inconvenient and I should point out that
this machine right here is not a good
machine
oops to cross borders with so especially
if you're going into the UK they've got
all sorts of fun stuff on the books but
you know you don't want to be compelled
to have to give that up or anything of
that such maybe you might consider doing
something similar with a micro SD card
with an encrypted bootable operating
system that you put inside of a locket
or some other sort of trinket but
obviously what we've done here is we've
narrowed down the attack vectors
considerably this networked machine I
have to worry about so many different
things I have to worry about keeping the
operating system up to date I have say
like is there a zero-day on this
software that software you know what are
the what are you know where are my
vulnerabilities and with this it really
changes it to just physical security so
am I going to leave this in the hotel
room while I galavant around Europe know
I'd be a bad move this is why it's such
a light machine so yes there are a lot
of trade-offs and this is just to
illustrate that you know the more secure
you get the less convenient it gets but
I find this to be a interesting solution
and I would love to hear how you guys
think it could be improved you know
obviously there are steps that we could
take as far as transferring the
plaintext better and you know I am still
relying on you know an operating system
that may have its own vulnerabilities in
the full disk encryption things of that
nature but for the most part I think
this is I just a numerous amounts of
steps far and beyond
you know you melville oh poor any of the
other solutions on a networked machine
I'd love to hear your feedback so of
course feedback at hak5 org and as
always you can find my public-key hak5
org slash key slash Darren
or on the MIT key servers and with that
we're going to take a quick break but I
can't wait to hear from you guys
NIT issues can pop up at any moment
there are unexpected user problems and
boy are there there's Network and server
complications viruses you guys know
staying on top of it all is totally
challenging a lot of times stressful but
it's why I am excited about go to assist
by Citrix because they take all of the
services you need and integrate it into
one simple cloud-based solution so you
can take control of your unpredictable
IT world
they've got goat wisss monitoring which
helps you quickly and instantly identify
potential issues before they become big
one your boss to call you nobody likes
that you can customize the dashboard to
display the performance of all you of
your networks and servers and desktops
and get proactive alerts so you're the
first one to know about any potential
issues and with go to assist remote
support you can provide live and
unattended support to any PC Mac or
mobile device from anywhere and you can
easily keep track of all of this with a
go to assess service desk I highly
recommend go to assist I've been using
it for years and you can sign up for a
special 30-day free trial today visit go
to assist com click on the try it free
button and use the promo code hak5 let's
go to assist com promo code hak5 well
that's just about wraps up this week's
episode of hack 5 but as always want to
remind you guys that we totally value
your feedback so feel free to email
feedback a hack 5 org let us know what
you think why don't you would like us to
cover uh and make sure to check out the
hack shop HEK shop calm sarah does an
awesome job packing up everybody's
orders for you guys you guys I'm out
every day what happened a somebody asked
in the notes field if she would send a
photo of a dinosaur oh so you did the
philosoraptor no no no we didn't ask e
dinosaur and I I oughta raft in but
trust your tech noasaurus yeah we have
too much fun with ya thank you for the
support yes we really appreciate it and
check out the new plane that we have in
there
see if they episode two weeks ago where
I threw one it actually survived and we
used it the other day at a barbecue oh
yeah you were at the barbecue the Labor
Day barbecue when we only lost one and a
half planes where did it end up that's
the other half time worried about well
actually no long story involves
neighbors and yeah I saw you on the
porch
yeah that was good times anyway you can
also follow us hack five org slash
follow for links to everything that
we're doing all the social networks and
whatnot over there and I think we might
have a like a pretty or something and
whatnot oh yes there's some good stuff
happening early October stay tuned
I've had that org / follow and with
all of that I'm Darrin kitchen I'm
Shannon Morse
we're reminding you to trust your Tecna
less
blosser Raptor</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>