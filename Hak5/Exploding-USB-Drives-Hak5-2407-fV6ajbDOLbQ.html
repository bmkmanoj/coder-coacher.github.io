<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Exploding USB Drives - Hak5 2407 | Coder Coacher - Coaching Coders</title><meta content="Exploding USB Drives - Hak5 2407 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Exploding USB Drives - Hak5 2407</b></h2><h5 class="post__date">2018-05-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/fV6ajbDOLbQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">exploding flash drives today on hack
five
today we have the great pleasure of
being joined by an awesome guest that
you may know from the InfoSec Twitter
universe for the amazing antics be it
you know jackin packages from Amazon
door locks or exploding thumb drives
which we're talking about today
oMG dude thanks for coming on my speaker
it feels like it's been the longest time
coming yeah yeah we're getting there
it's gonna be fun time right so so mg
lol if you're not aware is one of my
favorite InfoSec rock stars on twitter
at underscore mg underscore and you've
just been doing basically the the the
hacker ethos fun the I really want to
know how much of this is like doing it
for the lulz or whatever but what we're
gonna be talking about today is one of
your projects that has you know captured
a lot of imagination and that is
exploding some drives yes and I want to
hear the story behind it because I feel
like when we were talking about this in
pre-show it really paints the picture of
your traditional hack which is like I
got an idea what do I need to learn to
get that to work so you know rather than
let me learn all the ins and outs of
whatever this esoteric thing is be it
Linux systems administration or hardware
engineering and then applying it to
something you you had this idea of let's
make drives explode
tell me about that yeah definitely so I
was on Twitter I saw it was
non-functional it's just an empty shell
of a USB Drive and in it somebody had
put a firecracker and maybe some sort of
igniter that would immediately blow up
as you plugged it in in theory I don't
know if it ever worked but that with
myself and many people who saw it you
immediately get this visceral response
to it you're like oh that's horrible but
it's also awesome you're kind of stuck
in my head for a little bit yeah and
then I got the idea that hey what if I
could combine that with USB rubber ducky
cuz then you know would be actually you
know dangerous on the the computer side
and then would also blow up you could
have some fun and just look interesting
and that's that's kind of how I started
about this that I mean in very inventive
ways my like inner 13 year old is
reminded of downloading the aircrews
cookbook or the Jolly Roger cookbook on
text files and making those you remember
those three and a half inch floppies
really simple concept you would open up
a floppy you would douse it with your
sister's nail polish and then you would
take match-head strike-anywhere match
heads and you would just litter the
thing with it so that when you plug it
into the drive and it's been around next
thing you know you're a drive is on fire
exactly the the tennis ball with that
kind of stuff so so it very much is in
the realm of the hacker hijinks and I
love that and you're right I think that
is also the you know hits on another
core theme which is like hey that's cool
I can do it better which is like well
okay there's inherent flaws if the idea
is you plug in the thumb drive and
immediately goes boom like I don't know
about you your hands I like my thumb
yeah that's true
so at least having to delay there but so
you said they next concept then was like
oh I wouldn't do that with the duck
tell me best so I mean naturally the
very first thing I did was see if I
could do this with an actual hack five
duck umm I got the idea that maybe I
could use the led that's on there is a
trigger I kind of got a little bit of
control over it but I quickly realized
it was gonna be a lot harder than I
thought initially and there's also the
space limitation to the ducky takes up
most of the contents of a thumb drive so
you need room for activities if you're
gonna put things that made me blow up
inside right in fact this actually isn't
a duck here but if we take a look at
your traditional thumb drive it kind of
looks like that and and a duck looks
very similar just with an SD card reader
in it so you know you're right there's I
mean outside of maybe a little bit of
room right here but what you're trying
to do is a much bigger boom so you need
a lot of this and so this is one of the
reasons why I was led to to talk about
this with you on the program because you
know over the years I I never would have
imagined you know almost a decade ago
coming up with keystroke injection
attacks and and turning what was a you
know a teensy or nerd we know like dev
thing into you know the the household
name that is the USB rubber ducky that
that and ducky script would become a de
facto standard you know and there's been
you know so many you know knockoffs and
stuff that I'd like me to
defecated me too but and it was like
okay well that's cool but you know I
want to see something way cooler and out
there and this is definitely way cooler
and out there because I never would have
imagined and then this is definitely not
something that like like standard
warnings apply here D bad you know rules
applied but otherwise you know this
could definitely do what the duckie does
in you know in a lot of professional
settings you know talking to a lot of
pen testers you know it's good in like
dropping ducks everywhere and having
them you know get a pail get a shell on
a machine right but it's also really
good at just demoing yes you know you
plug it in in front of you know the
seaso and then suddenly their eyes open
then they're like oh we need to do
something about our endpoint security
right so if you plug it in and it
explodes awareness training yeah there
you go we're gonna straining so what was
the journey though because looking at
the final product here you you clearly
have engineering background clearly know
I've done light electrical electronics
work in the past you know modifications
and things like that of computer
components but I had never made a PCB
before I had never put a lot of these
components together before I haven't
done chip programming before all of
these were required to get from hey an
exploding ducky is a really cool idea to
where I started so yeah that's that's
the summation of the journey but let's
dive into it oh yes so clearly you know
you start with a prototype you know I
did the same thing with the duck it was
like hey let me find it you know a
teensy was my prototype that was 10
years ago where did you start to
prototype yes exactly I kind of went
back to the TT and below actually so the
TT I believe uses an 18 mega chip
similar to the the ducky I believe is
that correct 80 mega sort of it's an
esoteric cello so now it's a weird chip
oh so yeah at mill makes the 80 mega
that's a common chip people are using
for these types of things but there's
something called the 80 tiny which is as
the name would imply tinier but you
it's it's reduced processing power
memory etc but just enough to get basic
ducky functionality out and so I started
looking around for ways of sourcing this
and you know getting rolls of chips from
China it's a really slow process it's
expensive is anybody Bullock so I
started looking for products that
already have most of the component
components that I would need and I kind
of settled on a digi duck or in this
case a dizzy duck clone because they
were relatively few so it's actually a
clone of a clone so this right here is
your kind of did you spark yes fungi and
so you're just like what sourcing the
components off of there instead of
trying to actually buy the components
themselves exactly most of the board
that I ended up with except for about
two components I harvest from this it's
also convenient cuz it's in ready to
program form it's got a bootloader on
there so that you know the speeds things
up as well but at the same time having
that also creates issues down the line
as we'll talk about right and then of
course you know like many of these
knockoff knock-offs you just kind of
might like 10 of them and hope a couple
of them work and yes so about two out of
three of these tend to fail on me if not
immediately within the next two or three
right cycles so it's a little
frustrating and makes it very hard to
turn these into a mass scale project as
was eventually asked of me later hmm so
let's let's go ahead and then get into
the demo and see how this guy would then
become that guy yes all right so we've
got the digi spark right over here you
can program that over the USB interface
which is nice and convenient appear on
my screen I have the very basic close to
hello world code that we're gonna push
down on to it it's a pretty easy process
hearings so you just compile that it
compiles and then it's just waiting for
it yes so we got about 60 seconds plug
that in and then works it goes detected
and it's actually gonna launch oh so it
actually runs hey hakstol
that's Dan Tendler vis thank you way to
go this
I love this is a beautiful demo by the
way for getting axed so as Windows 93
net just putting that out there
awesome well that's that's fun as far as
getting that on there but that now means
that there is going to be a five-second
delay yes between when you plug it in
and when it actually executes
every single time because it needs to be
able to be programmed yes that's how
that's how it you to program it as there
is a five-second delay upon insertion if
you catch it during that time you can
program it after that it executes
whatever you have programmed it with so
for me as an endpoint device security
company I'd just be like oh if you see
anything that's an animal that wants to
be programmed within five seconds just
kill that baby anyway that neither here
nor there well that's awesome though so
how do we get rid of that because
clearly that's not what we're going to
want a couple ways to do this SPI
programmer you would clip to the top of
this chip and it allows you to modify
the bootloader to do the boot later
bootloader change you need a 12 volt
programmer you know we can we can buy
one of those they're like 80 bucks or
you kind of make one if you want yeah
but a chip lobotomize they're exactly
the the problem is that's not as much
fun as another tool that's out there
that allows you to introduce an OP slide
which is really fun I would love to dive
more into that but from what I
understand from this chip it only being
8k yes right so a portion of that at the
bootloader and then a portion of that is
whatever your code is and in this case
instant Arduino code that's that's
basically injecting keystrokes yo to
modify that first UK yes you just flash
on basically an Arduino script that what
tells it to tell us it to nullify the
bootloader
yeah so in the knobs I had the situation
you don't need the 12 volt programmer
you can do this just clip down to the
chip and it effectively it's it's kind
of like knowing the entire memory space
of the actual bootloader and it causes
the the pointer that's trying to find
where the bootloader is to slide all the
way down into the user addressable space
where there's a temporary bootloader
that boots up Reif flashes the chip and
its own and then
puts an additional bootloader into the
actual bootloader space so it's a very
happy way you get a new bootloader on
there that removes the delay and then
how do you program it again if you don't
have that delay yes so you're gonna
always at that point have to use the SPI
clip to push new code onto your chip
from the user addressable space so
whether or not you put that replacement
bootloader on it with the knob slide or
use the 12 volt SPI programmer you're
still gonna need a 12 volt SPI
programmer an SPI programmer not
necessarily 12 volt 12 volt is only for
swapping out the bootloader ah okay cool
done by an extra piece of equipment if
you just do it in software yes that's
pretty cool and this so one of the cool
things about this chip is that it's 5
volts but of course the data lines need
to be 3.6 and this does it in a very
hockey way what exactly is on this chip
that's doing that yeah so right about
here you've got two different Zener
diodes they're like a diode that
performs slightly differently than a
normal diode basically you feed it
backwards and it acts like a voltage
splitter so Zener diodes will be rated
at different voltages these are three
point six volt Zener diodes and
effectively since this whole circuit is
5 volts the Zener diode shoves off
anything over three point six volts to
ground luckily if so does it just get
hot I mean or that's the the byproduct
that doesn't sound okay we're just gonna
toss some voltage away like yes fine
luckily with the data lines there's very
little power running through them so
yeah if we were running these on the
data are the main power lines these
things would just instantly smoke there
there would be smoke everywhere they
would not work and I actually
accidentally did that to a few yeah you
can't get the smoke back in the chip
once it's come out yaddam from my
experience at least luckily I had you
know 2/3 of these digits parks that were
junk anyway so Hart harvest does to feel
Zener diodes a fantastic zactly but yes
I had a happy way to get three point six
volts on to the data lines with kind of
low-tech and you low-cost that's pretty
cool so I'm looking at this here though
and and the
thing that's that's standing out to me
is you know I can see how you're like
okay great know me now attach a
firecracker whatever happened to this
and put it in a USB Drive but that was
my initial thought yeah yeah I'm seeing
I'm seeing a physical problem hair it's
that's that's no fitty yeah and actually
I had a couple different approaches the
first thing I did was yeah
put this I tried to trim down the sides
of it didn't really work quite as well
as it was just not happening so
ultimately I had to design my own
stripped-down circuit that removes a
decent amount of the components on that
board I think I only took six components
off of the digi spark and left the rest
there okay so you've relayed it out is
that where this comes in what is this
yeah yeah so it's the remains of the I
think SMT pads is the brand but it's a
it's a proto board all right
these are little let's see if we can get
that on the camera basically it's a grid
of copper squares I think they're 50
mils each tiny but they line up with the
legs of of the the actual IC so yeah so
basically you harvested the IC off of
this and stuck it on that and then just
really ate it out with well it's it's
almost like in a way kind of like your
traditional what is it called like a
breadboard yeah except without all the
little legs you've got these pads but
then you'll have to then what create
your in traces how do you create your
injury yes so it's just bridging them
exactly so I mean I was sourcing most of
this off of Amazon and you know I looked
at this as it was like oh those are
really short runs I think the gaps
between them were about 10 mils really
tiny
Oh surely I could just bridge it with
solder it was not working not not in a
reliable way that made it for a clean
product anyway so I got some copper tape
I had for other projects started slicing
little tiny and 40 mil runs of that and
making the actual copper traces where
they needed to be and that's kind of
what led to the initial final product oh
my god this project this is brilliant
though because what I love about this is
this is an example
how like okay look I don't need to know
all of these things because what I'm
trying to do is get this result so let
me learn the few things that is possible
that I need to actually put these pieces
down I know that this circuit needs to
talk to that circuit through this trace
and it needs to be smaller so you know
here you go and some tape and then you
end up with something that's actually
quite elegant this guy walk me through
this yes so here's kind of the initial
final product here on the taped up proto
bird I'm going to take this out just to
show off a little more so we've got the
primary eighty tiny on the top we've got
a MOSFET here that was good that was my
addition to it the MOSFET is effectively
a higher amperage switch the legs on
these you can program to turn on and off
but they can't drive much so this so
what do you have those tied into because
yes you know so you're sending voltage
to the MOSFET the MOSFET is doing what
yes so that's that's the the payload the
5 volt payload so the code there's
additional code that I uploaded there if
you if we look back to that it's turning
pins on and off this ties into one of
the pins on the body of the eighty tiny
oh okay so instead of using the GPIO
you're using like what the LED or
something exactly so that that was the
LED of there's two LEDs on the digits
mark okay there is a green one for the
power and a blue one that is user
programmable and that's basically what
I'm hooking into there okay so it thinks
it's turning on an LED but really it's
feeding voltage to a MOSFET that's then
well we'll get to that okay so as far as
putting this relaying out this and
getting that package onto a smaller
board what all are all the components
here to make that work so there's a few
resistors in here and that's for general
USB compatibility the USB spec is
actually not super universal it's kind
of chaotic they help compatibility with
in other machines some people can
actually manage to run without this if
your machine is highly tolerant I wanted
compatibility and then of course there's
the two Zener diodes there to put three
volt three point six volts on to the
data lines
flip this back over see some tape that
actually goes around the outside you you
can't actually do that with UCB so
there's more things so instead of
drilling a hole or face you actually
just was around the perimeter without
having to go through the board's so then
on the other side there's the eighty
tiny brains of it then we've got a the
MOSFET and a little resistor to help the
MOSFET do its thing
so the MOSFET is feeding the voltage
though through you know this wire here
but there's something exposed here what
is this yes up here that's basically a
resistance wire there's there's many
things you can do this specific payload
is set up to make something blow up or
do the cool smoke effects that you saw
they need heat to start this provides
the heat okay so essentially this is
like what the same kind of stuff you'd
find in like a look at look at the
vaporizer yes cigarette lighters
vaporizers it'll glow when you provide
enough amperage to it right and then so
then you just shove it inside of the
plastic case with a firecracker and call
it a day as long as you're not in the
state of California yes let's go ahead
and demonstrate mr. self-destruct plug
into a USB extension here to this your
Mac and I love that your payload just
opens up hakstol ole thank you this oh
whoa you can see it like glow red and
then there was like even a little bit of
smoke that's the heat you need to make
fun things happen okay no fracking out
um that was fantastic I mean I think if
you plug this into your computer and you
know there's a is that pop-tart goat if
there's a pop-tart goat dancing around
on your screen that says Lowell hacks
and your thumb drive has exploded you
might have been hacked what happened Oh
at least you have convinced upper
management to give you guys some money
for some endpoint device security I
don't know I don't know either way it
sounds like a lot of fun man this has
been a blast and I know that there is so
much more to this I would love to have
you on again to dive into some of the
other stuff because I know you've done
absolutely custom PCBs and it's this
beautiful story of like I want to act
something
quick start shoving things in until
something comes out beautiful do it
alright
oMG where can people find like you know
build tips and any of the other stuff
related to this project yeah definitely
I've got a website mg lol also up on
Twitter underscore mg underscore both of
those places I post a lot of stuff and
those would be good places to find me
awesome dude I appreciate you coming
down this has been a lot of fun
especially like you know tweaking with
it behind the scenes and I learned a lot
and I'm excited for what can come so
with all that said you can find the show
notes over at AK 5 org as well as all
the other shows and mg of course on
twitter @ underscore mg underscore with
that i'm darren kitchen mg you know how
we end this coaster trust your criminal
instincts and this is exactly why
domain.com has all your website needs
from command dotnet domains to intuitive
website builders so you can take that
first step in creating an online
identity let me tell you there's no
domain extension like a.com or.net or if
you want to brand yourself domain comm
has over 300 domain extensions like doc
club and dot space these guys are huge
fans of hack 5 they're affordable
reliable we've been using them for years
they've got all the tools you need to
share your ideas with the world and
because they're such big fans they are
hooking you up with 15% off their
already affordable prices so get domain
names and web hosting and email and just
be sure to use that coupon code hak5 so
when you think domain names think
domain.com</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>