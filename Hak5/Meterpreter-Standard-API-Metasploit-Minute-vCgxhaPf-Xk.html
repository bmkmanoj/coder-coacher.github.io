<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Meterpreter Standard API - Metasploit Minute | Coder Coacher - Coaching Coders</title><meta content="Meterpreter Standard API - Metasploit Minute - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Meterpreter Standard API - Metasploit Minute</b></h2><h5 class="post__date">2014-12-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/vCgxhaPf-Xk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">meterpreter standard api or STD api this
time on Metasploit minute this
Metasploit minute is brought to you by
hack five and viewers like you
support us directly at h a k shop calm
welcome to Metasploit minute the
breakdown on breaking in i'm rob fuller
but you can call me mu vixx
today we're going to be going over the
extension standard API so we've already
gone over the core commands for
meterpreter we're not gonna get into the
extensions now most people don't think
of standard api as an extension but it
is it's good it gets loaded every single
time Metasploit does so it doesn't
really seem that there's a difference
but standard api is is an extension so
the first set of commands that standard
api has our file system commands so the
first couple is cat CDE download those a
lot of people have already used or no
cat actually cats the file to a screen
so if you do that what it's doing is
actually pulling the file from the
remote system over and then displaying
it on the screen
not not GUI supported this is like
normal cat for linux so then CD change
directory download now download and
upload both of these and I'll go into
upload once we get further down but both
of these actually support UNC path so if
you're actually doing a share you you
can download from whack-whack IP or
computer name as long as whatever
process that meterpreter session is
running on can access that share so
that's one of the cool things that
little known nuggets that not very many
people know about the download stuff but
you can download local files as well so
if you try and download the sand file or
whatever you can try it with that so
edit is another interesting one you can
actually edit files what it does is
pulls the file down to you opens it up
in VI or nano whichever you have set up
as your local editor yeah as soon as you
finish editing the file it actually
pushes it back so it sort of
concatenates the
the commands of download then edited in
your editor and then re uploading to the
same directory so you don't have to do
that
get LD w R del W D is your local working
address that's your local system where
your Metasploit is running this get
working directory for a remote host LCD
l PWD that's a lot same thing like local
CD local PWD LS list of files
m'kay derp make directory these are all
really straightforward stuff PWD RM RM
der now search is a little different
search actually has two interesting
features so search allows you to search
on the remote system wherever the
meterpreter session is there for
interesting files but if the Search
Indexing is turned on like in Windows
seven and above this will actually go
really fast it'll search all of this
stuff in the index first and then
continue on from there so you have the
ability to do windows searching directly
from meterpreter then we get into the
networking commands so ARP get proxy ARP
will actually show the hosts ARP cache
so whereas the ARP scan does a bunch of
art / quests to find out the local
broadcast you can actually look at the
ARP cache right off the bat by typing
ARP get proxy shows you the proxy
settings for whatever user your
interpreter session is is running as on
that box so if you're running a system
most likely to get proxy is going to
show you nothing but if you're running
as a user you might have actual proxy
settings if config IP config same thing
netstat really useful command if you
don't run that Statens on meterpreter
sessions you should shows you where all
the connections are going and coming
from what's realistic and then port
forward we've talked a bit about port
forward in the in some of the pivoting
stuff basically it's allowing you to
forward a local port over the other
meterpreter session into the remote
network so if you wanted to RDP to
server one and you're on victim one you
could port forward 3389 on your Linux
host over to
I pee whatever server one is on 33 nine
then RDP to yourself and you get RDP to
the remote host route we've already
talked about routing for inside of
Metasploit where everything inside of
Metasploit is routed through whatever
route you set up so if you set up 0 dot
0 dot 0 so that everything goes through
meterpreter session 1 that's how it'll
go then we have system commands clear
evie you can clear all of the event logs
which is a good command if you want to
kind of clean up after yourself drop
token
we're linked just as any impersonation
that you have same with Rev to self
actually works execute we've talked
about executing pest get env this shows
you the environmental variables this can
actually be really useful especially if
you're looking at path if you're looking
to privilege escalate get env can show
you the path variable and sometimes that
path ferial has information at the very
beginning of it where you can do DLL
injection of the other escalation
methods with that so get paid current
process get pretty this is a list of the
windows permissions that you have get
UID what user are you kill PS this is
pretty straightforward stuff reboot this
is a fun one reboots the system right
off the bat reg does registry changes or
queries so you can actually query a
bunch of different registry things or
set values which is great it does have
some limitations especially if you're
running reg in a 32 process on a 64-bit
architecture so if you're not seeing
registry keys that might be why and it
also doesn't have the ability in the
interface for MSF counselor or my
interpreter interface to do some
specific different types of registry
keys so if you're not doing a straight
string you do have a little less
flexibility than you would with a script
so then we have revved itself reverting
back to whatever your current real user
ideas or token is shell drops to shell
shutdown shutdown system steal token so
with this you're actually stealing the
token of a target process so without
loading the incognito extension which
we'll talk about later and are in our
next episode with extensions you can
actually steal just one of the tokens
right out of that without having to load
anything else
so suspend you can suspend or resume a
process or a list of processes which is
great and then systems your information
that just basically tells you the system
information for your meterpreter session
as well as the system you're on user
interface stuff so getting into even
more fun stuff in oome desktops any new
desktops is interesting because windows
actually has more than one desktop that
you see it's not actual your where your
icons are in a sense your desktops are
are that window manager desktop the
thing that you see all of it instead of
just your icon area so it actually has
more than one desktop at all times so
the session zero or desktop zero is
usually the system processes where
everything's running in system and then
you have concurrent different IDs for
different desktops and if you noon
desktops you can actually find out what
other virtual desktops or fake desktops
there are out there
then get desktop tells you which desktop
your meterpreter sessions on idle time
tells you the current idle time of the
user that your process is owned by so if
if you do an idle time and you're
running a system most likely that isle
time is going to be pretty long because
system normally doesn't do any Mouse
movements but if you're in explorer dot
exe you'll get the good idle time for
that current user key scan dumps start
and stop this is actually the the
in-memory key logger that meterpreter
has in the standard API again all of
this is built into the extension that
gets loaded every single time so you can
actually do key key scan start just let
it run and then later on do key scan
dump it'll pull all the stuff out then
finally key scan stop
now word of warning couple things
first key scan start/stop and dump they
don't actually give you anything unless
you ask so you have to dump the results
so if you lose that meterpreter session
and you didn't key scan dump kind of out
out of luck
screenshot obviously gives you the
screenshot set desktop you can actually
switch desktops for whatever session you
have just like your enum desktop and get
desktop allows you to show what you have
and where you're going and then UI
control this is a fun one you actually
get to control if the keyboard or mouse
work for whatever user your process is
in so if you're an explorer exe for
daring kitchen and you turn UI control
keyboard stop and and Mouse stop his
mouse and keyboard no longer work he
can't do anything he actually has to
reboot the machine until this thing
comes back or figure out a way to log
off then we have finally the web cam
commands now you want to do web cam list
every single time just to see if your
motor procession is in a Windows box
that has a web cam but you can do a lot
of fun stuff you can do snap which gets
you a snap you can also use stream which
actually sets up a a web web mic I don't
say web 2.0 but it's a I forget the
commit name but it's basically a web RTC
streaming webcam shot of the user so you
you get the full HD video of whatever
user going in now you do have some very
specific things to get set up there like
up to date version of whatever browser
like has to be Chrome or Firefox that
has to be on the remote host but that
can work really well it's a really fun
then they even a webcam chat where you
can actually chat with the your victim
and have two-way streaming video and
then record Mike obviously lets you
record the microphone on the windows box
for however long you want and that
really is it for all of the standard API
commands that you get just by loading up
meterpreter you get all this function I
they're at your fingertips without
having any other extensions loaded so
what do you think hit me up at MSF at
hack 5 org and stay tuned in Metasploit
minute comm for more shows like these
thanks again for supporting the show and
if you want to support us even more you
can go to hae shop comm enter coupon
code rubik's and get free Metasploit
minute stickers until next time I'll mix
and I'll be hacking til the cows come
home</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>