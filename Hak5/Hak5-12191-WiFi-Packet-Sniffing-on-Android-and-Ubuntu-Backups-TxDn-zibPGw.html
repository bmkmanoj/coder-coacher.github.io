<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hak5 1219.1, WiFi Packet Sniffing on Android and Ubuntu Backups | Coder Coacher - Coaching Coders</title><meta content="Hak5 1219.1, WiFi Packet Sniffing on Android and Ubuntu Backups - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hak5 1219.1, WiFi Packet Sniffing on Android and Ubuntu Backups</b></h2><h5 class="post__date">2012-12-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/TxDn-zibPGw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this time on the show packet captures on
Android Mike Kershaw aka drag horn joins
us to talk about his rootless android
peak app app then backing up Ubuntu the
easy way plus apps tips pseudo aliases
and the return of black this segment is
brought to you by CrashPlan hello
welcome to hack 5 my name is darren
kitchen I'm Shannon Morse and we hope
you had a wonderful holiday hey they're
all done that's cool as long as the
world didn't end
hello you are seeing this next you're
watching this the Internet is still here
yay Majora's Mask was wrong mask yeah
did you see the thing that I tweeted
last week it was really cool it was like
the end of the world as we know it thing
ok like eerie background noise you ever
played that game Majora's Mask yeah ok
that's good stuff yes so what are we up
to today well we are going to take one
of these and one of these
that's the Nexus 7 because you can't
tell they all look the same and we're
gonna make them all do the thing oh
really
yeah well drag horn you know him from
kismet and we ran into him at shmoocon
and then again at tour camp and he's
been working on porting all of the
kismet goodness over to android and yeah
he's finally got this sweet little app
out there it's for you know packet
capturing on android and so basically
he's written support or ported support
for like an alpha radio run the real
tech 81 87 he'll over to Android so that
action do like monitor mode or
promiscuous mode and you know using that
you can go ahead and generate a packet
capture files and put those into your
Wireshark and gzip you don't to cloud
your and close that nature it should be
really fun
coolest thing is totally rootless packet
sniffing without route I love it that's
awesome so why don't we just go ahead
and get right into that I see you on the
other side
you guys know we love Wi-Fi on hack five
and if there's two gold standards about
Wi-Fi it's one of these and kismet what
if you've got one of these
that's where drag horn comes in how are
you dragging on wow that is so good to
see you virtually here in studio you've
survived sandy and and through it done a
little bit of coding let's talk about
Android meeting meeting kismet the love
story if you will yeah so uh since
pretty much since Android came out
people have been asking when will kismet
run on it
unfortunately answers not quite yet but
we're really close to it and what we
have is a sort of a precursor that is
pcap capture on android so you can do
raw monitor mode with a USB card I
actually saw you demoing kind of a hack
job of kismet running at on an Android
device at was at shmoocon
earlier this year how is that what was
the inspiration behind that and how is
the clothed from that to what you have
now so yeah that was that was a complete
hack job I still have that code and it
will it's what eventually evolved into
the Android pcap project and then now
that we have reliable peek app on
Android we'll be able to turn that into
piping it into kismet again so so so
with Android pcap what were your kind of
goals with that project we'll just set
out to accomplish it sounds a lot easier
to palate than the full-blown kismet
suite yeah the idea was just be able to
capture pcap data from from a handheld
you know tablet or phone and be able to
save it as a standard pcap file and then
use it with Wireshark or IPA or cloud
shark or any of the other pcap tools or
you could feed it back into kismet
itself on a PC was this your first you
know attempt at porting software that's
typically found on x86 over to the
Android platform and how was that
experience so so kismet the original
kismet port last winter which which
didn't work very well what was
definitely my original attempt to port
stuff to Android since then it's gotten
refined a lot what
had to happen is since Android if you're
not route which it's not good to
encourage users to to have to be to
write any of your tools so if you're not
root you can't really access the
built-in Nick and you can't do custom
drivers but what you can do with newer
versions of Android is access USB from
user space so it's sort of the
equivalent of Lib usb on a PC so does
this tool the Android pcap tool actually
require route on Android here no with no
extra privileges other than USB access
and it lets you talk directly to the
card over USB in userspace with the
Android API support of the kernel 81 87
drivers to run inside Java user space on
Android okay so you talk about the
eighty one eighty seven drivers in fact
that's what we have here it's an alpha
aw us zero three six H kind of the gold
standard and all sorts of Wi-Fi fun is
as well at least in the 2.4 gigahertz
spectrum I've just plugged this into a
off-the-shelf
you know Nexus 7 and everything is good
to go it sees the the realtek and I can
start channel hopping and logging why
the 81 87 and what other chips are you
looking at and you know what were the
fun details there the 81 87 pretty much
because it's in the alphas and everybody
loves the alphas how can you not if
you're going to pick something to start
supporting start supporting that one
another big factor in it was it doesn't
have any external firmware files mm-hmm
you pretty much just plug it in and it
goes so I didn't have to figure out how
to port all of the firmer uploading code
what do you mean by that
well you're saying that there was like
an existing kernel module you're able an
implementer or what do you mean right
well so the code is is derived from the
the Linux kernel module for the driver
but a lot of the the Wi-Fi cards need an
extra firmware file that you need to
download that on Linux goes in like Lib
hot plug like that's uploaded
automatically so that's a whole other
piece of code that has to has to upload
the firmware to the to the USB card and
then let it reinitialize and then it's a
Wi-Fi card so picking one that's popular
and doesn't have that
problem was that important well this one
is quite popular and you know it just
pops up it says RTL ad 187 BV B and then
I get a v + V 1 plus RTL 82 25 is that
like another chip said leather work with
it well inside the ad 187 or a couple of
different control chips there's a
different EEPROM ship for different
models and whatnot so that's this sort
of that's sort of an example of more
information than you probably needed
coming out of the program it was part of
part of the debugging process as well as
plugging in you know it's many different
80 187th I could find and seeing which
ones actually worked yeah well hey
that's kismet for you you know more
information than you require I love it
what about actually plugging it into
your to Android device what what do you
have to have as well as as far as cables
are concerned I've got like a OTG
adapter here but what else works for all
of them you'd either need an OTG adapter
or you need one of the few tablets that
are out there to have a full sized USB
host port I believe Samsung makes one
and I think Asus makes one words it's an
Android system but it has a full sized
port like laptop would have and with
those you can plug right in otherwise
you need the OTG cable which tells the
the microUSB port to go into host mode
nice and so you're able to what let's
talk about modes you know obviously
you've got RF Mon down or else you
wouldn't be able to monitor traffic and
capture that that packet capture what
about other things like you know are you
able to inject can you do host mode and
master mode and an ad hoc and all of
those others and and anythign if you can
what of those are actually pertinent to
this application yeah so monitor mode is
obviously the most pertinent there so
that was the first goal inject mode
should be possible I just haven't
written the code yet it's really just a
matter of porting you know I think it's
three or four functions from the kernel
driver and getting it getting it running
and getting it tested I just haven't
done it yet so once that's done
hopefully we'll be able to integrate
things like air crack and whatnot as
well as far as master mode and ad hoc
and whatnot because we can't use the
Android networking stack so we can't we
can't use tcp/ip on the Android we can't
make it look like in that
interface because we're not route we're
just we're just yelling at a USB device
and we happen to get back packets that
are useful to us so theoretically it
would be possible you'd have to pretty
much write your own tcp/ip stack and
then have a whole bunch of other it
would be ugly so I can just imagine
having to write all of this and it's all
running in user space - is it what's the
performance like I haven't seen any
performance problems mainly because
configuring the channel and booting up
the card takes a lot of a lot of
operations and a lot of a lot of work
but once you're running it's just you
know give me a packet and it you know
gives you two thousand bytes and you go
with it it's pretty you know he's an
even under high load on Wi-Fi cuz it's
only the 11g capable you're still
getting you know not very high load for
USB once we tack on eleven end chipset
it'll be interesting to see what happens
there the Android stack might start
falling down at that point oh do you
have plans for other hardware support in
the future yeah yeah I'd like to support
as many chipsets as possible um it is
open source so if anybody wants to work
on a driver you know contact me looking
at the the Carll net 9172
97 12 one of them some combination of
numbers like that it's a really common
the theros based USB a/b GN oh there you
go all right what about the like what
are the use cases here because you know
this being just like the packet capture
kind of functionality of the broader
tool that is kismet what do you see the
use case being how do you envision
people to go ahead and load this on
their devices and start putting it to
use well a lot of times if you're trying
to debug a problem with Wi-Fi ah you
know you have a user in your office or
whatever or you know what are your
friends your family whatever could go
you know I keep getting disconnected
well there's no way to find out why
you're getting disconnected from most
hardware you know you can't go into a
net gear management page on their access
point and figure out why you're getting
disconnected usually but if you can get
a packet capture you know for five
minutes just plug it in here your phone
that you have with you then you can
hopefully figure out what's going on
then and so the idea is you take this
packet capture and now okay so I've got
a peak app on my Android device what do
I do with that
um well the main model would be you
could upload it with Dropbox or whatever
and look at it on your PC with Wireshark
or key shark or loaded into kismet there
there's also cloud shark who have a
public web page that you can upload to
and it's basically Wireshark in a web
browser and there's a secondary little
tool that I wrote for Android that'll
let you directly send a file to that and
launcher a web page it's gonna say do
deep packet completely on the ant right
then right and so this cloud shark
program their web service you can you
said you've got an uploader specifically
for that is that in the Play Store right
yeah that's in the that's in the Play
Store as well and it just it just grabs
the Android send file event and so you
know from inside the peak app capture or
inside astro or any of the file managers
you can you can just do send pcap file
and pick clout shark and it'll handle
doing the HTTP upload to their service
in the background and cloud sure works
out pretty well on like Chrome for
Android yeah yeah it works really well
on the phone it's a bit cramped on like
the Nexus 7 it's perfectly usable it on
the antennas you know effectively a
laptop all right so I have to know if I
plug this guy here into my my tablet and
kind of do a little backpack guy this is
like a half watt radio I'm gonna
definitely lose some battery performance
out of this aren't I oh absolutely
you're kind of right now unless you have
an external battery pack for it you
you'll want to just run it for a couple
minutes on a Galaxy Nexus phone I've
watched to kill the phone in about 20
minutes
oh wow but if you do have a USB powered
hub then that'll that'll bypass the
power problems there you can also try to
use like a Y cable from a hard drive
although I find that a lot of times it
uses more phone power than I prefer
still what it what about aren't there
dangers in using like a YK belen that
sense because wouldn't you be applying
voltage back into the I mean anyway well
the kind of problems would you have I'm
no II I'm just saying I've seen some
issues
ya know it's it's it's real quirky the
safest option if you're going to do it
yourself with pieces would be to get a
powered USB hub and power that off a
battery pack and you've been working on
just such a device right right I've been
working on basically a little board that
provides a hub and power and allows you
to completely split the power from the
phone and a battery pack nice
so actually have one of the little PCBs
here oh that looks so great okay so it's
like two two micros and a and a female a
right so you'd plug you plug your
battery pack into one your phone into
the other using one of your your OTG
cable that's micro to micro and then it
provides a hub functionality and
there'll be a little switch that lets
you pick if you're going to power from
the phone or if you're going to play
games or you back feed power into the
phone which some actually need you to do
so that's a really exciting device makes
a lot of sense for this and I can
already think of a ton of other
different use cases what is next on your
radar as far as Android and kismet are
concerned uh next on the radar is
probably actually getting kismet to run
on it again I did get the whole kismet
engine poured it over before but it was
really clunky the goal is to make it so
that I don't really have to modify the
kismet code because I'd hate to have to
maintain two versions and apply all the
changes to both so I'll be making a few
changes to kismet itself to help it run
better on Android that that would be
invisible to it running on a PC and then
hopefully I'll be able to just link it
into the packet capture stream we
already have right and I assume that
with like the daemon running you know
with the kismet server running you could
you know have like a totally different
Android interface so it make more sense
on touch than say n curses right yeah
that's definitely one of the main things
as well I wouldn't I wouldn't try to
inflict inflict end curses on someone on
on an Android all right cool so where
can people get involved with this and
say they want to start poking around
with a source code and you know just get
it on their Android devices so it's in
the Android Market under Android
cap it's also on the kismet website
kismet Wireless net / Android - pcap and
that'll have links to the git repository
and all the commentation not my cursor
always a pleasure having you on thank
you so much and they can see you on
Twitter at drag horn right
oh it's actually Atlas Wang kismet
Wireless there we go all right good to
see you again take care good to see you
four hundred and sixty four gigabytes
that's on average how much a u.s.
household stores digitally increasingly
our lives and our livelihoods are tied
to digital storage like photos books
movies TV shows music financial and
legal documents and while most of us
have developed really good analog habits
you know like changing the oil on our
cars
to getting flu shots good digital habits
are really something like backing up our
hard drives that we need to learn and be
proactive about and CrashPlan them code
42 software is an online backup software
that is rocketing to the top of nearly
every review and ranking because it's
intelligent design its ultra simple it's
super easy to set up it's transparent
essentially cache plan lets anyone set
up us to get this a super secure private
cloud in just a few seconds from Windows
Mac and Linux I love that and Linux
machines backups are continuous so your
most recent documents are securely
backed up off-site on code 42s CrashPlan
cloud in just seconds and access to
those files within minutes from your
phone or from your tablet for free and
CrashPlan it gives you the ability to
basically backup to also an external
hard drive or securely share your extra
hard drive space with a friend or to
back up your home computer to your
office computer all for free I plan is
truly unlimited storage in anywhere
access to your entire hard drive or from
the mobile apps for $5.99 a month we get
this Lou and I do save yourself a bunch
get it for a year for 59.99 we encourage
you to try it go ahead and check it out
for free for 30-days first visit
CrashPlan comm slash hack 5 that's the
place you're going to want to go to get
that 30 days free and start protecting
digital life with the easiest most
secure backup solution available I've
been using it for years I love it</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>