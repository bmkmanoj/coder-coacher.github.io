<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Tutorial: Hijacking DNS on the WiFi Pineapple - Pineapple University | Coder Coacher - Coaching Coders</title><meta content="Tutorial: Hijacking DNS on the WiFi Pineapple - Pineapple University - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Tutorial: Hijacking DNS on the WiFi Pineapple - Pineapple University</b></h2><h5 class="post__date">2014-07-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/nggQan4XZ1E" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey there it's Darren kitchen on this
Penelope University we're going to go
into DNS spoof now as you guys are
probably familiar with DNS is an awesome
system that allows you to translate
domain names into IP addresses you'll
probably notice that if you ever pull up
a terminal and say ping
I don't know zombocom and of course then
you get the IP address 60 9.16 231 17
but what's also really nice about the
Wi-Fi pineapple and being that man in
the middle is you're actually able to
say use a tool like DNS spoof to modify
what those requests and what those
responses are going to be so that if the
clients a asks for client a Wi-Fi con
client connected to the Wi-Fi pineapple
asks for zombocom you don't necessarily
have to give them the response 60 9.16
dot 231 17 you can tell them whatever
you want and the browser isn't going to
know the difference and it's going to
pull up whatever web server you say
pointed at on but and it will be
unbeknownst to them that they're not at
the proper website which is a pretty
fantastic tool and it can be used for
more than just redirecting websites but
we're going to do a quick example today
because some interesting stuff has
happened in the news where I just feel
like there's a pretty good practical
example here so let's go ahead and login
to our pineapple and DNS spoof is
located under the configuration tile and
you'll see here this is my kali linux
virtual machine that is directly
connected to my pineapple over ethernet
and and what we can do is see over here
I've got a Windows client that's
connected over Wi-Fi actually to this
Wi-Fi pineapple so it is a client of it
and so what we'll do is take a look
under configuration here and see there
is a tab called DNS boof and this is
where you can set up the IP address and
domains in your what you would call
spoof host and that is essentially
basically a table of it's kind of like
your host file table where you would
just specify the IP address and what
host name and whenever a client makes a
request it's going to check this list
before it gives it the actual response
from its upstream DNS provider so in the
example that comes with by default you
would see example comm gets redirected
to 1 7 2 . 16 to 40 to 1 so if I were
say to turn on DNS poof and then go to
example comm from one of the clients I
would actually get the web server
running on the pineapple rather than the
true example com
we knew the same thing here with
zombocom awesome website will do star
dot zombocom you can use wildcards in
this just like you would with most other
Linux type commands where say for
example start of zombocom means I would
get wwm bow and mail Zombo and whatever
have you
same thing would work in Reverse you
know we could do start out Zombo dot
star so i gazonga calm and Zomba DET net
and Zombo dot oregon all of those so
we're just going to leave it as calm for
now and update my spoof host and I'm
also I'm going to SSH into Y Wi-Fi
pineapple and I'm going to move to /ww
this is the web server this is where the
files for the regular web server that is
listening on port 80 resides separate
from the slash pineapple directory which
is where the web server on port 1471
resides which is the web management
console that you would access now I've
already gone ahead and made an
index.html file here all it says is
hello world so we'll be able to know if
we're on the pineapple if we pull up the
web page that says hello world so with
that all set I pretty much just need to
go over here and where it says DNS move
and it's currently disabled we'll just
click start and now it's enabled so now
on my client machine if I just open up
my browser and go to zombocom you'll
notice that I get hello world this is
pretty fantastic as opposed to say on my
machine right here if I go to zombocom
that's that's some good stuff I mean I
encourage you all to check out zom-bone
um it's a fantastic place you can do
anything there I bring this up because
Greg Faust did a fantastic piece right
here on basically illustrating one of
the weaknesses in this new concept from
Xfinity who decided to turn a lot of
their customers cable modems into public
wireless access points well public in
the sense that if you have a Xfinity
account you can use them to log in
otherwise they want to charge you or
stuff like that a lot of people got it
up in arms most people probably didn't
even notice but regardless I think he's
actually gone ahead and put together up
on github and he's actually showing
using a Wi-Fi pineapple as an example of
setting this up and so that's what we'll
do here today but I believe he's hosting
this on github there we go xfinity
pineapple and its 404 done github right
now that's weird
okay well I'm sure there's a cache
somewhere we're going to go ahead and
set that up so that whatever website we
want we'll forward to that so in order
to do that let me go ahead and stop DNS
spoof on the pineapple I'm going to go
to configuration and DNS spoof and
rather than doing start of zombocom I'm
just going to do star dot star and so
that what that means is no matter what
website you try to reach whatever DNS
entry you give it it's always going to
give you well in this case the IP
address of the pineapple so we'll update
our spoof host I'm going to close this
and we're going to come over to our
command prompt again and I've already
set it up I'm going to SCP all of these
files over so however you'd like to copy
them I'm going to copy seq tech are
everything to slash to root ads to 1642
one in /ww all right so this file files
are there now by LS wahoo okay and let
me make sure that's the right index.html
yes it is fantastic okay so this is a
really simple
phishing page basically and so what it
would look like if I come over here and
actually go to one seven two sixteen
42.1 without the colon 1471 I'm going to
this is the page that the the user is
going to get okay and if I come back
over here and I'm going to tail this
file auth dot log so oops tail tak f2
follow it auth dot log okay so now we're
watching whatever gets written to off
download you'll see here in a moment
basically he's got a user login PHP that
dumps the credentials into this so let's
just turn on DNS spoof now and come back
over to our client and I don't know
we'll pick another website example dot
KOAT UK and we get our nice little
Xfinity login and if I pull up that
terminal at the same time you'll not
that terminal this terminal at the same
time it will give it beefcakes
at whatever dot whatever and we give it
lame password and click Sign In no we
don't want to remember that password
pretty horrible password okay and we'll
see right here a we have a login attempt
password is lame password here's the
time date stamp and it's from this
account and and it literally just says
username password and to do not match
and what do most people do when their
password isn't correct well then they
just start typing every password they've
ever possibly used and it doesn't matter
what website you go to we could I could
just jam on the keyboard and I will
always no matter what I enter a lot of
numbers this time I will get there no
matter what more numbers dot-com and we
will always always always get there so
we're completely stuck this is actually
one of the ways that random role works
to make sure that whatever website you
go to you end up to like a thing where
Rick Astley is singing at you and stuff
and you know it's it's a totally good
time
this is a fantastic tool in any Arsenal
for any pen test job where you are
trying to gather credentials this is a
lot less sophisticated than a captive
portal that does eventually let the user
through after gathering some sort of
credentials or notifying them of a
network usage policy say one that says
you're being monitored or anything like
that but I just figured that this would
be a good example to show you guys how
you can couple wildcards and and all
sorts of good stuff into your Wi-Fi
pineapple to do some DNS spoofing action
of course if you have questions leave
them in the comments and I will see you
guys on the forums and as always thank
you so much - for supporting us directly
HHA shop comm and thanks I will see you
on the intertubes</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>