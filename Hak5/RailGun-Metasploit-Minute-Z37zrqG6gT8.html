<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>RailGun - Metasploit Minute | Coder Coacher - Coaching Coders</title><meta content="RailGun - Metasploit Minute - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>RailGun - Metasploit Minute</b></h2><h5 class="post__date">2015-02-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Z37zrqG6gT8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">railgun this time on Metasploit minute
Metasploit minute is brought to you by
viewers like you
if you get value from the show and even
can spare just some change like a dollar
so please consider contributing at
Metasploit minute calm
welcome to Metasploit minute the
breakdown on breaking in I'm your host
Rob fuller but you can call me movies
today we're gonna be going over railgun
railgun is awesome and it was initially
provided to the Metasploit developers
who I don't even know it's like 2009 or
so and the great thing about this thing
is it's an extension onto matter / that
allows you to directly interface with
the windows API I think we've gone and
touched about a little bit about railgun
in the past but in this episode we're
gonna dive a little deeper so first off
you have to have an interpreter session
really can't do windows API connectivity
or accessing without being on a box on
it so sessions - I and now we are in
meterpreter and we've already talked
about IRB so we're gonna just drop to an
RB okay so an IRB we can have all these
fun things and we know about client we
know about that object and then it's
just railgun real gun if I can type
quickly so after that we have all the
methods and functionality of railguns so
the next thing that comes in line to
this and and sometimes it's kind of
confusing to figure out what object has
what objects attached to it and so but
this is it's literally all of the
windows you dll's so I'm gonna look at
that I want if I want to do LOC
workstation and that's the function I
want to use I'm gonna look at the LOC
workstation function via the MSDN from
Microsoft and it says LOC workstation no
there's no variables to add to it so
it's void but it's in the user 32 dll so
we're gonna go back ups and go back to
our attack box entire user 32
and we don't have to do the dot DLL the
next part is important it is case
sensitive so lock work station let's go
back to it make sure we have the case
sensitivity correctly lock workstation
is correct and our quotes and if you
could hear that it obviously locked so
we go back over and there's the system
that's locked awesome so I type in my
password unlock it if I remember my
password and we're back now it's very
funny when you go like this again and it
locks again and if you have a shell on a
friend's box or or legally on a friend's
box and you create a payload that all it
does is is run railgun lock workstation
it can be loads of fun but we want to do
other things so let's go let's just
peruse the other things that we can do
inside of MSDN so when you're in MSDN
it's if you've ever program and see this
is is dumb straight up forward to you
but if you haven't and you want to go
through remnants dan you can find all of
the different libraries and functions
that are available to you so in this
we're in the system administration in
system shutdown functions so we can hit
exit windows this logs off the
interactive user we see that it needs a
D word and DES reserved and you an it of
reserved so neither of these are valid
we just make them zeros like it says so
if we want to log this person off we'd
type in IRB and go back to our function
exit windows client dot railgun dot user
thirty-two let's just make sure that
we're in 32 it doesn't say on this one
I'm going to assume it's it's 32 sure
dot exit window
sure and it says that there's no exit
windows so we can look up here in this
error and see what what functions are
put into railgun so while while railgun
is the functionality that goes to the
windows API not all of them are defined
inside of railgun so if you find one
that isn't it defined in the real gun
it's relatively easy to put in there
so let's look real quick and see if
there's a exit windows on here e X so
it's excellent windows e X is the only
option we have so let's see if we have
that e^x option go to the X cool it says
we need an integer for flags and a
reason so what we're gonna do is we're
gonna say reboot so it needs a 2 for
reboot and we want it to reboot and then
our reason is a D word so we can say
force let's see what other values flags
and then reason the parameter must be a
system shutdown reason we click on the
codes we can see all of these different
codes let's say major power outage
60,000 all right so let's go back and go
back to exit windows exit windows IX and
what was our first one a two for reboot
and our reason is the 60,000 we hit
let's go back over here to make sure we
can see it ok go over there
oh the privilege is not held by the
client so as me as a user I as a
standard user actually cuting here it
seems that I don't have the approach to
do that and the nice thing about railgun
and this is actually a recent feature is
that it gives you the entire error
message so you don't previously you had
to look up each error code and find out
what it was it now includes all of those
error codes in there for you so I
encourage you to really play with this
look at all the functions that are
available I mean we have user 32 if you
type in kernel 32 and then put
blah it'll error out saying there is no
blah but then it gives you all the
available two options to you you can
copy and paste these into a search
really easy find out what they are
you know do the options are endless for
this thing it's it's really amazing
ability let's try and get system time
let's just do one last one really quick
just as if I'm showing you this so get
system time functionality all right so
it requires an out parameter so it
doesn't really require anything so we're
gonna go back get system time
tu-tu-tu-tu-tu-tu and it says one
argument needed so nil and powershell
stopped working that means my
meterpreter session crashed so that is
one of the bad things about having
direct access to the windows api if you
call something incorrectly it's gonna
kill your session so i don't know if
i've said this on the show before but
the number one rule of having sessions
is two is one one is none so if you have
one session it's gonna go away you're
gonna do something that you're it's
gonna break so always have to always
kick yourself a second one especially
when you're doing demos on a TV show so
if you want to find where people have
actually used railgun in the past in
different post modules you just grep for
a railgun inside of the post modules
directory and you can see all kinds of
railgun usage and how they used it very
easily so open those files up and and
take it how how they did it and you'll
get tons of examples on the best way to
use it without droppin a shell like I
did that's it for railgun and and tell
us what you think email at MSF at hack 5
org stay tuned to Metasploit minute comm
for more shows like these and a huge
thanks to everyone who supported the
show so far and and will continue to
support the show we really appreciate it
you can find ways to donate and get
awesome Metasploit minute swag at men
wait minute calm every dollar goes to
making this show just for you and I am
deeply grateful for that so until next
time I'm new excel be hacking to the
cows come home
button-pushing welcome to Metasploit
rinic but remit rin it it's a minute
hey there yeah you thanks for watching
all the way and i really appreciate all
the awesome feedback and support we've
received from viewers exactly like you
not as cool but you know you get the
gist if we haven't already checked it
out you could really help if you go over
to our patreon and support the show
directly if you can't that's cool simple
like or subscribe goes a long way to
either way thanks for watching and we'll
talk later man take it easy</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>