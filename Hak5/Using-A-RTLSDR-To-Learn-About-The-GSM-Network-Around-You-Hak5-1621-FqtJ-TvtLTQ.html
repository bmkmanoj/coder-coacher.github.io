<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Using A RTL-SDR To Learn About The GSM Network Around You, Hak5 1621 | Coder Coacher - Coaching Coders</title><meta content="Using A RTL-SDR To Learn About The GSM Network Around You, Hak5 1621 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Using A RTL-SDR To Learn About The GSM Network Around You, Hak5 1621</b></h2><h5 class="post__date">2014-07-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FqtJ-TvtLTQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this episode of hack 5 is brought to you
by domain.com hello welcome to hack 5 my
name is darren kitchen I'm Shannon Morse
it's your weekly dose of technology very
excited for this week's show
I am too wait why are we so excited well
I'm actually not here right now I'm at
tour camp so I hope you guys are joining
me in the Abbaye Washington my passports
with sparked the vampires and hackers
and camping it just goes so well
together I'm excited that you're gone at
the moment so you're just gonna dad yeah
so you're just gonna berate this avatar
that is that exactly perf it works it's
so much more fun in the office when
Darren is not here haha I heard that you
went digging you went digging past the
application-layer digging past the
presentation layer digging at the
session layer you did you would pass
transport layer in the network layer you
went down town to layer two all these
layers I didn't even know all these
layers existed I just thought it was
like code and gooey mmm turns out
there's a lot of little interconnection
between it makes the whole thing work so
let's take a look at some of how these
things work that we what's did I take
for granted and this is the beauty of
software-defined radio is it not guys
typically if say I wanted to as a hacker
would want to debug or analyze some
network traffic say yeah traffic right
yeah I would just start my Ethernet
interface and promiscuous mode and fire
up my Wireshark or whatever t shark
whatever TCP dump
what however you want to sniff your
packets and then I just go to town right
yeah it's it makes it super super easy
you have a nice graphical interface so
you don't have to worry about anything
on the back end it just works yeah it's
like a barrier to entry in that regard
is like so low that everyone can hack
the ethernet world because it's super
simple
and actually same way with Wi-Fi I mean
you know what we change here's without
fantastic dongles that we even have in
the shop that are like less than 20
bucks that allow you to you know and get
your Wi-Fi hacking on right get some
Wireshark in is it yeah well you know
air crack aircraft is a fantastic I
actually just had the great opportunity
to meet one of the developers Thomas on
that and very cool
brilliant person
and again it's all about bringing the
barrier to entry down and you know Wi-Fi
got much stronger when the tools became
available and when the hackers actually
had the opportunity to say take an
inexpensive chip off the shelf and
actually put it into a way where you can
see what's going through the air and
then you're like ah that's an
interesting way that this handshake
works that's an interesting way that
this authentication mechanism works
that's interesting the way that those
management frames work and probe
responses work and all those fun things
and then we get pineapples yay um so I
hear though that the barrier to entry
when it comes to that thing that we all
take for granted the shiny screen in our
pocket that connects us with the world
oh you mean my cell phone you're a cell
phone the barrier to entry there is a
little different because if I wanted to
start hacking with the underlying
technologies of say you know your smart
phone on a GSM network right like a
t-mobile or an 18 T or just about all of
them throughout Europe um I would what
would I do I I can't just buy a chip
from Qualcomm they're not gonna know
like yeah cuz yeah they don't really
sell to you know just self self business
ins they don't sell to consumers onesie
they don't even sell to small businesses
yeah and actually a lot of the big
businesses that do buy these to create
phones which operate on huge awesome
networks because you know there's not
that much difference really between a
cell phone network and a Wi-Fi network
video watch how it works they don't
necessarily get all of the documentation
they get a chip like here's a chip and
here's an API to speak with it and don't
ask about the rest you know here's how
to electrically understand don't have
too much fun hmm hmm I hear though that
you're you're having too much fun oh I
want to say too much fun okay maybe a
little legal disclaimer that we're not
going to have too much fun on today's
show no but we will take a look at some
of the stuff going on in the air with
GSM because Shannon yeah you got your
you got your probe going on in the air
oh god that's so bad
trying you and probes I don't know man
you're talking about this stuff all day
yeah
but no air probe another fantastic
program yes that is going to allow you
to get your little GSM sniffing on huh
yeah exactly so I'm really really
looking forward to checking this out but
before we do I guess we should explain
what air probe is or maybe what GSM is
that's it that's started before you were
born
Jesus yeah 1981 and GSM original suit
for group special mobile Reich not
managed a french-speaking person it now
stands for global system for mobile
communications which is a backronym for
something that means something a little
bit more than a bunch of awesome hackers
getting together in Paris and being like
hey let's see radio stuff interesting
yeah all kind of comes back around huh
around around well I'm just saying get
some hackers together and technology
happens pretty cool and it's the
underlying technology behind your iPhone
or my Android or whatever whatever
you're running hey Android thank you
very okay but I'm just saying it's it's
like I switched like we care yeah I
learned down at the bottom that's true
yeah so let's sniff some packets and
find out how GSM works huh yeah let's do
it
so that's exactly what air probe is it's
open-source GSM protocol decoder which
it uses software-defined radio it will
de modulae and decode GSM layer one
you're talking about the physical link
layer yeah we're talking about the
actual attenuation of this antenna and
actually being able to see the frequency
modulated or you know and it provides
the second part it does is it actually
provides layer 2 mac blocks to analyze
so in Wireshark so similar to what I
would actually see if I went into
monitor mode with my Wi-Fi sagging and I
can actually take a look at the frames
that are going through and then the
packets that are within those frames yes
exactly and then the nice thing about
air probe is it comes with a whole suite
of different products built into it
these include GSM SP there's GSM GSM T
void I haven't checked that one out GSM
receiver which is the best receiver in
this week there's other ones were
actually other previous I guess you
would say alpha incarnations of GSM
receivers and there's a GSM decode and
guess unstack as well well it is a
network stack and so this so it is a
suite that allows you to both receive
that GSM traffic but also did decode it
into a way that's actually human
readable yeah I love these things super
super fun now of course we aren't going
to be decoding like encrypted phone
calls or anything like that no beat that
would be wrong well you know there's
there's is em there's the Wild West for
the Cowboys on the 2.4 gigahertz and the
900 megahertz and some other you know
fun frequencies like that where it's
unlicensed but we're actually going to
be looking at some stuff that would be
considered licensed and so with that we
should probably preface that maybe look
but don't touch
I don't know I don't know what the I
would love to hear I would love to start
a discussion with you guys about what
the the legal aspect is on that I know
that it shouldn't be a problem
whatsoever just taking a look at our
phones it's saying yeah exactly and
that's what we're doing right and it's
we're using open-source products that
are available widely on the internet and
everybody uses them in fact what's
beautiful about this is by understanding
the network architecture of GSM one
could thus create not just a GSM decoder
as the awesome people with air probe app
but actually create a base station
similar to the base station for your
Wi-Fi access point which then cell
phones could connect to in fact I know
that this is prosperous because two
years ago at tor camp shady tell was
they're doing just this and so I'm
hoping that shady tail will be there
again this year and that it can report
back with even more good stuff as far as
the manipulation the legal manipulation
of GSM for your own purposes because you
know networks are fun let's build more
networks guys so so cool now should we
get into like how many bytes yeah now
let's take a look at some of the packets
now and we can actually understand okay
what those bytes are and how they work
okay so yes break and then go back to it
we're going to take a quick break but
when we get back it's time to start
sniffing GSM traffic
it matters not if you prefer a packet or
a frame or if a packet hits a pocket on
a socket on a port if you have the
desire to enter the wonderful world of
the internet you need a domain name and
web hosting and you can get that very
quickly over at domain.com because these
guys they have a fantastic domain
discovery system that will show you what
your heart desires quickly and easily
checkout process the breeze gonna have
website up from running in no time and
listen the guys over at domain comm huge
fans at hak5
there's so much fun to do business with
because they're affordable liable the
easy to use and they're awesome on
social media you can tweet them at
domain.com and see what i'm talking
about those guys are crazy pants and you
can get some crazy pants savings just by
using the coupon code hak5 at checkout
that's right go over to domain comm
check out with hak5 and get 15% off so
when you think domain names think
domain.com
I am so so so ready to have some fun
with Kelly Linux again oh yeah
Kelly is fantastic we love the guys over
there for taking all of the awesome
tools and rolling it into one distro yes
everything just kind of works so
basically what we're doing today is we
are taking the little rtl-sdr dongle
which is like less than 20 bucks it's
available everywhere as well as the heck
shop and we are using this to get GSM
packets we're gonna analyze some GSM
packets in Wireshark using a couple of
things called GNU radio companion as
well as air probe right and so if you've
been following our software-defined
radio series we've been talking about a
lot of these things in the past we've
used the realtek dongle a lot hey you
know we've also been using a new radio
companion fantastic open-source suite to
allow you to build the software-defined
radio programs so let's get started all
right so first off of course I'm using
Windows 8 computer I'm going to use
Windows 8 the entire time except I'm
also using VMware Player to boot into
Kali Linux on this machine since it
didn't want to do this in bare metal I
have a Kali box like right over there
okay we're gonna do this anyway this is
easier for editing one computer go for
it so I just plugged it in and I pulled
up SDR sharp like I usually do basically
the only thing I'm using SDR sharp for
in nfm the radio version nfm I've got it
plugged into my RTL SDR USB I hit play
I'm going to be looking for GSM signals
that are transferring in my area so
these may change depending on your
location but generally they're between
850 to 900 megahertz the one I found
specifically and it looks like it's
dropped a little bit so I could always
switch over to this one right next to it
this one's also a good one I'm going to
write this down because I'll need it it
at a later time it's eight six nine
point two to four megahertz so if I pull
up the volume
it sounds like crap well tune to
something in the blue kind of next to it
to give a comparison we're okay so that
sounds like static like I'm used to like
static that sounds like digital static I
don't know how to describe this or those
two it still has that digital noise to
it so what you're looking for is that
kind of noise that kind of waterfall
where it's a straight waterfall path you
don't see any kind of breaks or anything
like that the stronger you get the
better signals you're going to be able
to analyze whenever you get into Kali
Linux right and we're not even getting
into the whole GSM signaling thing which
in of itself is an amazing awesome thing
we should touch on this again next week
or something because we're when I get
back from tour con because it's really
cool the way that it manages the
channels and there's so many of them and
and we can then to have a discussion
about the different hardware and it's
better aspects of this yes because this
is a $20 dongle that's not going to
necessarily get us every packet but it's
gonna be cool nonetheless you will run
into a few areas once you get this
running but hey it works for the for the
point of this so first off this whole
segment the tutorial is also available
over at rtl-sdr comm think are really
really nice write-up about it but there
are a couple of bits that I had to
figure out myself when I was going
through this so I'm gonna walk you
through those as well
first off you do need a couple of
programs you'll need Kali Linux the
VMware image which offensive security
has awesomely provided already so you
don't have to compile it yourself or
running on bare metal or run it on bare
metal too you can do that so just
download the image it's very very big
it's like 2.5 gigs so it'll take forever
to download don't worry though it's
there and then you'll also need VMware
Player so you're going to end up running
that Kali Linux image we should probably
explain that we're using VMware in this
case because normally I'm a fan of
VirtualBox right because it's Oracle's
VirtualBox open source it's fantastic
however it's kind of not the best when
it comes to USB throughput when it
virtualizes that USB interface it kind
of drops packets all over the floor and
that is not what we're going to want in
this case so again another reason to run
it on pair of metal is that you wouldn't
have to worry about using a
idea advertising but regardless we're
going to be using VMware because it
works so just extract that 7-zip
whenever you download Kali Linux and
then you just want to open up your new
virtual machine in VMware Player the
password again this is Kali Linux so
it's a username root password tor
interesting am I not at a conference
called tor Oh
lulz okay after joke - the one there so
first off a couple of things to mention
Kali Linux 1.0 0.6 64-bit that's the
version that I'm using 1.0 0.6 in
particular this one has gnu radio
companion built into the program so this
is going to make RTL the rtl-sdr dongle
work in kali linux on vmware player also
you want to make sure that your version
of gnu radio companion is three point
six point whatever it's not the newest
version which is three point seven which
is included compatible with air probe
which is actually included with the
version of the latest version of kali
linux so if you just go to colleen grab
it right now as as we record this as
what 107 i thought so yeah so we know
point seven so 1.0 point six has the
older version there's actually a patch
to fix all of this
but it's kind of I'm hoping that in 1.0
0.8 everything is all just fixed but for
the moment basically everything should
be compatible with air probe and then
the program that we're using air probe
that's going to decode those GSM the
signals the data that we're going to get
arrest so just a check that you do have
the right GNU radio companion version
we're going to type in G a new radio do
companion tactic version I totally
mentioned the same thing in my heck tip
recently so I have three point six point
five point one so I'm good to go that's
going to be just fine with air probe yay
now if you do have the newest of course
download the patch it's over at rtl-sdr
comm now also you want to make sure that
you have the most updated version of
apt-get so i'm going to run that well
you just want to update your
depository so that you can get all the
dependencies you're going to need yay so
I'll update all that stuff and then we
can actually get into installing
everything so there are before we can
tell anything it's always let's get the
dependencies tendencies of course so
I'll wait for that to finish and then my
dependency so for this what are we gonna
need so we're gonna need to install a
bunch of stuff what do you need here yes
you don't have to get and then the first
one is install get worse to need get -
core get yeah get - core and then Auto
con you also need auto make auto make
and then we will need Lib tool mm-hmm G
+ + Python dev dev &amp;amp; swig better spell
that right tech dev swig I don't know
what swig is but it sounds really cool I
want a swig Happ look at 0.8 text dev
and before you hit enter on that there's
new space between get and tack or oh
thank you you're welcome
also you don't need pseudo cuz you're
already writing as root but whatever
it'll work anyway too bad
alright okay so once you get all that
installed you need like you already - so
if you so you've already gone through
this I have so if you have Kali Linux
one point 0.5 or higher you will need
some more dependencies those include GNU
radio GNU radio - dev C make get Lib
boost - all - dev live USB - 1.0 - OH
Libby USB 1.0 - OH - dev Lib ff4 the win
fftw fftw a swig and Python numpy okay
so with all the dependencies let's get
to just installing this guy so let's
let's clone the git repo and start
compiling okay so git clone and this is
going to be git clone what's it called
and gits
good it's over us Osmo comm org which by
the way you should just go to osmocon
org because there's a lot of awesome
information there about GSM and SDR and
stuff okay so once you get that you'll
get that get so yeah and then you can CD
into that specific folder so that's
called lip Lib Osmo core so go in there
and then you want to auto recon takei
Auto recon tech tech I lowercase I let
that run and then finally we can
configure make and install configure
make install yay so that's dot slash
configure then you want to hit make wait
for that sudo make install yay
and then sudo LD config I've already
done it on mine so I'm not gonna run
through all of that now are you ready
for the next part
I am woohoo so now we're going to do air
probe get compiling yay so this is
another git clone good clone you might
want a CD o to go back a directory yeah
you're right there you go
alright so get to clone and this is
going to be good get dot G and you monks
dot org slash air probe dot get hit
enter and go ahead and let that clown
over there and once it's done we want to
install to the two most important parts
of air probe yes so these are going to
your GSM decode and the GSM receiver
those two are the important ones so
first off to get GSM decode you want to
CD into air probe slash GSM decode hit
enter and then we want to dot slash
bootstrap proper burn dot slash
configure
turning Internet and then make bump it
up above
do you like my music yes I do hey I kind
of want a terminal now that does that
whenever you run make although I kind of
also want it to like be like tied in
with make and if it doesn't compile
correctly because Denton enter now I'm
going to when you make your own distro
it needs to do that by the way your
probe isn't CD into GSM receiver and
once I get in here I'm gonna do the same
thing the dot slash bootstrap hurry up
there is dot slash configure and then
make make it so many things look at it
look at it go and then make its like
better than scroll bars make it so
mm-hmm command prompts watch him scroll
watch cool them all this makes this
makes for grace yeah yeah
racing scroll bars so now that we have
this we went to CD again into a
different folder this is the SRC folder
slashed Python hit enter now we're going
to test air probe to make sure that
everything downloaded correctly and we
have everything that we need so to do
this there's an example C file available
on the Internet's from the rtl-sdr calm
so somebody has already captured that
traffic with their software-defined
radio and now we can take those and send
it into the receiver to see if it all
the codes properly before we get to
sniffing our own and I believe you
called this a capture file whatever have
you it's a dot C file what's for me
right so to find this file its W get and
to get it you're going to put HTTP slash
slash and the website is SV and the end
dot Berlin dot C CC dot they say say pep
bet one Berlin CCC de / projects and
props to say base huh air probe / roll
at
catchment these folks just need bake up
freakin bitly or something / d / wiki /
d mod modulation / capture so this is
the actual file capture underscore 9 for
1.8
underscore one one tube dot c file and
then hit enter you'll download that file
to your Python folder so I'm gonna go
ahead and hit ctrl C cuz I already have
this file on here now we want to get to
the fun time so we can open up wireshark
with another terminal window so I'm
gonna hit hold up to cute little
terminal I just do what alt f2 uh I
don't want to but I like my difference
don't have to waste a terminal well
listen up I like my different windows
okay
Wireshark damn well you could have at
least put an ampersand at the end of it
be quiet
all right so we have Wireshark running
now it's already installed in Kali Linux
just in case you were wondering how in
the world I got it err probe dumps - UDP
port so you want to set Wireshark to
this thing called low so this is
loopback right so every Linux machine
you're probably used to wlan0 for your
wireless or eth0 for your Ethernet
there's always low which is your local
and so it's going to just spew those out
as UDP packets on local and then we can
filter for them and everything will be
awesome yay fun times and then you hit
start so I'll hit start that'll bring me
into the actual interface and up here
under filter I want to type GSM tap to
see anything that's coming through air
probe so specifically this is going to
give me all the GSM data I won't see
anything else so grace on tap hit enter
so that is all set up and it's going now
I can actually run that C file so I'll
go back over here and I'll type in this
is dot slash go Tess H and that should
already be there
capture underscore nine for one point
- no see file number hit enter bunch of
pack yeah they're your awesome racing
packets bunch of packets going on over
here
classic yeah yeah so we have things I
nice stuff so what are we looking at
here this is GSM data
hey paging requests weird Lum and I cool
this is so cool of course everything is
gonna look for like the source and
destination our local host right of
course but system information to type -
yeah well it lets me know that
everything has already been downloaded
correctly so I don't need to go back and
read download a recompile everything oh
this one right here system information
type for this is a beacon and we can
actually win to be good I'll be good and
just like with anything else in
Wireshark we can actually come in here
and see like where you know where source
and destination are going to we can
actually see any of the IP for data
which it doesn't have but this is the
fun stuff down at the bottom yeah since
we've got GSM tap we can actually see
the GSM header stuff and we can even go
into to this frame a little bit more and
see what other flags are set so this is
so tiny put this in a big screen
everyone hmm this is pretty cool yeah
this is awesome so we know that it's
working and this is good and he's back
here sorry I'm just like amazed this is
so much fun look mobile country code you
can taste set - German Federal Republic
of so the country code is 2 6 - and then
here's this 101 for t-mobile Deutschland
GmbH hahaha or whatever that is so
awesome so of course we're not seeing
calls and stuff like that we're you well
know I mean we should probably explain
that you're not don't expect to just run
this through Wireshark and then type it
into like a sound program and hear phone
calls it's not the way it works it's
kind of encrypted a I told my husband
that we were doing this and he was just
like are you sure you can do that and I
was like yeah that's fine whatever yeah
it's so cool so why don't we do it live
because I'm in a mode right now and I
want to see my Association packets when
I can't anymore so I'm gonna get back
into here I'm going to minimize
Wireshark for now and minimize this
screen okay so I'm coming back over here
that C file has already gone through now
we are ready for the live
channel decoding basically in Wireshark
isn't alive in the sense that oh it is
live it is because you can actually
capture it - because we tried it two
different ways there's a way where you
can first capture it into a temporary
file and then run that file through a
new radio program that will then turn it
into a file that you can read into
Wireshark so that would be the store and
analyze later yeah exactly
you've actually got it set up so that
you can see it real time I did so this
is kind of weird yesterday I tried to do
the same exact thing all the same
different same commands and it didn't
work when I tried to do look the live
decoding and Wireshark so let's see if
it works okay so let's see if it works
this time so the first thing you need to
type in is this Python command which is
dot slash GSM underscore receive
underscore our TL py sweet so they've
already created a script specifically
for this dongle I love that yes they did
and it makes it so much easier than ever
talking about accessibility I mean when
you've got a twenty dollar SDR that
makes all of this stuff anybody can go
and now play around thank God all right
so it's GSM receive our TL py spaced AK
s space 1e6 hit enter and I got a
failure because oh oh I know why I got a
failure one why because my RTL dongle is
not connected to my frickin LS USB yeah
let's hear his play is it even connected
it's not no okay oh nvm where again
remember we're saying we were using
VMware because it's USB stack actually
works uh think is in the top right
corner yes right here
so I right-click on it and click connect
so it's disconnected from the host hmm
and then if you run Ellis USB again Hey
look I see a real tech where is it there
it is right at the top RT okay so I turn
that command again and hit enter now a
new window is going to pop up yeah we
have a new window but you see that it
doesn't really show anything interesting
quite yet well I mean I see little fuzzy
lines
yeah fuzzy lines ba so the talk window
is the one that you want to pay
attention to you this is the wideband
spectrum currently it's connected to
this frequency nine to
4.2 megahertz but we want to change this
so this is where you're going to change
it to the GSM one that you found earlier
so it was eight six nine point two M hit
enter and you should see it change oh
yeah totally in fact a move that window
I'm seeing stuff in the background yeah
we're getting some errors here and then
some of them actually I've seen de
coatings we are hmm yeah pretty cool
right that is very cool so you do see a
little bit of packet drop but not too
bad and I do have my you know nice
little dongle running here of course if
you get a bigger antenna you're gonna
get a lot more information your dongles
are better bigger dongles are better
so as she say that is in fact so we
would now how do we get this into
Wireshark I want to analyze the data and
see all that stuff happened oh this is
cool
alright so after a few minutes you
should actually start seeing GSM data in
Wireshark live that's all you have to do
on this end so let's go into Wireshark
and let's scroll down to the bottom okay
so we're still seeing the information
from the file that we tried earlier um
once it does actually pick up this new
request this new information it'll start
pulling it up here it may take a few
minutes for mine it did take a few
minutes once I actually try hey if we
start and recent in Ubud that's a so
we've got a new file and we're just
looking for GSM tap yeah okay so now
we'll know when new packets come in oh
my gosh my Wireshark just blew up seemed
to take me a few minutes to actually get
anything on this channel I changed it
over to eight 69.6 em because that's the
one that worked previously for me so I
just figured out let's try it again
she's so um so I'm getting a bunch of
these er Archon decode twelve decode
eleven well it's a mean look at the
antenna you see why I mean we're talking
about a twenty dollar dongle with an
antenna that's not even tuned to the
proper frequency so the fact that you're
getting any frames at all is fantastic
yeah I'm getting something so let's see
what we have paging request let's
see I can go in here oh and you've got
system information type 1 so we're
seeing beacons and then we're seeing
basically a talking to the tower that's
pretty cool devices and stuff yeah uh
this is I have a feeling that this is
quite the rabbit hole oh it totally is
dude I could spend all day in here and
Wireshark oh my gosh I could Google all
of this stuff would be like what does it
mean well you can actually find out that
stuff because a lot of this is but is in
you know the specifications are out
there where you can actually learn hey
what do these frames mean and then once
you are able to sniff the traffic and
have a good understanding of the way
that the you know whole system works you
can find the inherent weaknesses and
actually make it the system better
because trust me this is not the same
network like protocol running today that
was dreamed up in 86 this is has there's
been several iterations of GSM
especially in regards to encryption and
things of that nature so yeah we can
talk about that at another time but if I
for the way whoa okay so we know it's
working yes which is awesome but what if
what if I wanted to run the same thing
but I want to analyze it later I don't
have time to sit here and look through
every single packet while it's doing it
live whoa this Python right dude
I want these on every pineapple and I
want them in every street corner
recording to SD card and then analyze
the oh man I mentioned rabbit right so
you can capture all this information to
a file - cool
so to do that we want to go ahead and
stop this capture so I'm going to go
ahead and close this out and I'm going
to cancel that so it automatically
cancels over in the terminal and I'm
going to go ahead and stop this capture
as well oh look at that
just to GSM tap filter again because now
you're seeing TCP yeah I want that JSON
attack that was the purpose of having
that filter okay so next thing we're
going to do in a separate window so I'll
open up this window over here
so now I can capture into another window
capture into a file so for this I went
to type in rtl-sdr space slash and I'm
gonna put it in my temp folder okay I'm
gonna call it Archie
underscore you've already created one so
cut it call that capture to been since
you've already done this okay well do
capture to dot bin okay so this is going
to create a new file a dot bin file / s
1.0 e six and then what frequency are
using and then frequency is are you
gonna use this 869 whoa between yeah I'm
gonna use the eight six nine one because
I was working the best eight six nine
point six six four megahertz a six and
then we want to put in the gain that's
tech G tech G and then forty four point
five that's just the default but you can
set it to whatever gain you want to
whatever works best for your antenna and
then you hit enter oops wait that work
last time
do I didn't have to do dot slash no no
it's right there hang on type rtl - and
then hit tab s type s its underscore
yes yeah oh so go up and change that to
an underscore oops
well bit tall good no control leg gets
back to the beginning there we go okay
so right now what's happening in the
background is I'm creating this bin
folder based off of the what the dongle
is picking up from that specific
frequency with that game and you're just
using the rtl-sdr
program that's built into the rtl-sdr
suite which again like I said it's on
the pineapple super super easy is that
so let it run for a few seconds and then
whenever you decide that you want to get
done just hit ctrl C yeah and then I'll
say it's exiting now we've just got a
cue data we don't have like what we're
gonna need to roll it into Wireshark so
how do we convert it you can't really do
much with a bin so now what I want to do
and I'm gonna exit out of VMware Player
real quick I'm gonna go back into here
okay so over at Osmo comm SDR dot org
over on this website there's a C file
dot GRC that you want to grab okay so
GRC file is a new radio companion file
and like we've talked about before and
we've shown how to do this it's really
cool because you can take these building
blocks and kind of put them together so
you can have a source and an FFT and all
of these different elements of a
software-defined radio and you can just
link them together and then it does all
the heavy lifting Python stuff in the
background so this is already done for
us which we love yeah super super love
so I'm going to scroll all the way down
to the bottom of this website and I'm
going to copy the address to that
original format there we go and I'm
going to go back into VMware Player and
I'll go into my original window right
here and I'm gonna copy that I'm gonna W
get it control shift V there we go
Ozma comm C file GRC that looks right to
me so hit enter and that will download
that file for you so this is the gnu
radio companion folder file that's going
to give you that nice little overlay
which remember that episode if you don't
go back and check it out because we
walked through gnu radio companion for
you guys now we can open gnu radio
companion from the terminal to do that
gnu
radio - companion enter again with you
in the ampersands shut up alright so
here we have it oh you have it open from
last time I do I have it opened up from
last time so this is our TL 2832 C file
GRC the only things you want to change
is the source file input in the source
file output over at the other end so
source file input so it's pretty small
but under here file yeah hit the dot dot
dot next to it yeah so you want to
change that to the capture - bin so
that's the new file that I created hit
open and you want to change repeat right
here to know if it's set to yes and then
hit OK and then the old or the output
you want to change the file so that it's
in your Python folder that you have been
chilling in all day in the terminal and
we're going to change this to capture
dot C file or capture - dot C file yeah
we can do - dot C file capture - dot C
file see just keeping them together you
know yeah hit OK and then let's run it
so then you hit this and it's going to
execute that and you can let it run for
a few seconds it finishes up really
really quick once it's done you just hit
the red except you have to stop it
manually so just to make sure that this
is still running and it's not like still
right into your file you could LS that
file continuously until it stops getting
bigger or however you like to do that
but yes good stuff cool so now that
we've done that we've converted it into
a C file how can we play this back into
Wireshark so we can analyze all the good
stuff yeah there's a Python for that too
of course there is let's do it
cool ok so I'm going to hit ctrl C to go
ahead and exit out of there because we
don't need it anymore this is dot slash
GSM receive this is still in the Python
folder that I've been chilling in all
day dot py and then we're going to use
tack capital I and put in the new file
so it's called capture blue dot C file
and
d and this makes in love or hit enter
hey look at all that good stuff so we go
over to Wireshark now nose Wireshark
we'll see you that we have new packets
maybe why aren't they coming through I
don't know well we're supposed to who
are you suppose what that is the that is
the beautiful idea of this and it does
work if you go back over there in fact
you'll see these are all 23 23 bit bytes
of these these frames and you see where
says to be you see all of those two bees
they're padding so if the frame actually
isn't 23 bits long it's gonna end up
padding the rest of it with these two
bees or not to bees if there aren't I'm
gonna try running less than my other one
I'm gonna try okay not see files see if
that one runs oh it has a gun over there
what why you're sure we're shark scaring
me love me Wireshark Oh hit start
oh that's hit the shark the green shark
okay now I'm slow it's cool okay - dusty
file and enter yeah it's and they're
going through pretty quickly to that
fantastic I'm not gonna feed you
requests
lots and lots this is fantastic cool
co-sister this is a lot to digest but I
think this up what'swhat's type-4 do for
spam is good stuff done I Arctic OLG bit
globally unique address oh you know we
can actually tell is this is the one
that you just captured the latest one
yeah we can see resources we're looking
at Cingular Wireless United States of
America oh so you Euler so you're on
Cingular Wireless is Channel whoa yes
you remember singular well I think they
got bought by ATT I know did they yeah
well there you go so we're looking at 18
teams maybe they just left the packing
maybe they just like didn't change the
base station or what is broadcasting
there's a lot of fun GSM hacks too cuz
it's kind of ridiculous the protocol
I implore you all to take a look at this
that's so cool hooray
cute look I can already start imagining
all sorts of fun stuff but you know what
we want to hear what fun stuff is on
your mind and what experience you guys
have had with this as we just begin to
get our feet wet with GSM so where can
the email its Shannon feedback at hak5
org Darrin that is in fact my favorite
email address again I believe we have a
trivia question that's right we do we'll
be right back with trivia we're back and
it's now time for the trivia question of
the week last week's trivia question was
Windows 95 or originally was set to be
released in what year and the answer was
1993 this week's trivia question is what
was Windows 95 originally named before
it was called Windows 95 you can answer
that over at hack 5 dark slash trivia
for your chance to win some awesome swag
eesh wig you're not talking about the
Windy City are you Shh real okay I'm
just not sure if you're talking up the
code name or
yeah oh well in that case oops um we
thank you so much for continuing to put
up with us and we value as we said your
feedback on not just the GSM segments
but anything in general you'd like to
see us cover feedback act five that work
is the place we also have a place where
you can find dongles in fact your Dunga
lead bungle dongle bits over a hat where
is Jay H a cake shop dot is it calm yeah
come on the store link on the on the
hak5 website you're watching on youtube
google it or something I don't know
thank you though because that keeps us
going and we are very excited to
continue going at Def Con yes on Def Con
is coming up from and we are going to be
celebrating nine years of hack five
party like it's 1995 here you go with
Lola where my flannel wait I know man
with all of that said though follow us
on the social stuff for the socially
social tech five better work slash
follow am I missing anything I think
you're gay
okay and my name is Shannon Morse I'm
Darren kitchen until next time
trust your tech no less
and your geocentric packets whole do
they smell good ya know</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>