<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Meterpreter Extensions - Metasploit Minute | Coder Coacher - Coaching Coders</title><meta content="Meterpreter Extensions - Metasploit Minute - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Meterpreter Extensions - Metasploit Minute</b></h2><h5 class="post__date">2014-12-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/iil45wPgu44" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">meterpreter extensions this time on
Metasploit minute this Metasploit minute
is brought to you by hack five and
viewers like you
support us directly at a JK shop.com
welcome to my display minute the
breakdown on breaking in i'm rob fuller
but you can call me move X so this today
we're gonna be going over some of the
other extensions we covered the core
libraries we also covered the standard
API extension now we're going to be
covering sort of just an overreach of
all of the other extensions so first off
is obviously the privet extension this
gets loaded anytime you are in a
privileged mode or the module says that
it's a privileged mode so Prive you have
elevate commands you also have data
password database commands and time
stamps so the first one is get system
everyone knows get system it does a
number of different ways to actually get
the system level process or elevate to
system hash dump again pretty much
everyone knows that one and then time
stomp not very many people actually use
types up but it's great when you're
trying to be a little bit more stealthy
you can do a the entire may strip
tribute so I'm going to do time stomp
just to show you all of the options that
are available to you
there are a ton you can actually just
clone kernel32.dll or other things it
has some specific things for incase as
well so if you do use and hit tab or
load and hit tab I'm just a custom to
use you can use the load which is the
right way of doing things you can see
all of the other extensions that are
available to you sepia extended API and
kognito Kiril an attack screaming cats
and sniffer
so the sniffer module is actually
allowing you to sniff on the remote host
so if I do use sniffer
it should say success and now when I
could do a question mark I have all of
this differ stuff so I can start stop
released interfaces all of this stuff
and then just loaded right so I do
let me let me do it the right way use
now I have the rest the things that
aren't loaded yet and the cool thing
about this is once you have it loaded
even if you migrate to different
processes which blows my mind even if
you look - two different processes you
still have all of these extensions
loaded that you use so mini cats really
we've already kind of dealt with in the
past where you just dump hashes and
stuff or dump clear text passwords and
stuff like that it sepia is sort of an
older one it's I don't think it's really
used that much anymore but it has the
screen grab but you can do the screen
shot so let's do load again let's do it
extended API do a question mark and you
can see that these every one that you
load just adds its ik added sits options
to the bottom of the list of question
mark based commands so we go up there's
sepia screen grab and then we have
extended API and this is all thanks to
oj one of the contributors to Metasploit
extended api you have windows enum cool
thing about windows in them we talked
about desktops in the previous episode
with the standard api windows in them
isn't like a windows enumeration thing
for its actual windows like microsoft
windows it's actually the windows on the
on the system or on the desktop so if
you want to know if KeePass is running
or you want to see what window or where
it is you can actually do windows you
know them and then grep out the key pass
name then kill key pass then start the
key logger then wait for someone to put
in the master password and then and then
you're all set and you can do all this
in the background with a script or our
post module so then service come in so
if you want to start or stop a service
if you want any numerous service or all
the services and service query this
actually gives you the permissions in
dacow format for the service so if you
want to parse the dackel you can
actually find out if you have
permissions to edit the services or
privileges escalate so you can actually
right
a programs escalation module to look
through all the decals for all the
services and and very easily find out if
you can escalate using a badly
configured service now the clipboard
management commands as you might have
I'll throw this back to a hack five
episode way way long ago where we
actually made a clipboard key logger
meterpreter now has one you can do
clipboard monitor and the cool thing
about this one is instead of just
getting text that gets clipboard you get
images you get anything anything that
someone puts into a clipboard you can
actually pull so if they copy and paste
a file dangerous I know if depending on
the size of the file but you can
actually dump all of the files that
someone copies and pastes throughout the
entire time of your meterpreter session
which is awesome
so if you see Cape KeePass running again
we're going back to keep s if you see
keep s running why not just start the
kill cord key logger and see if they
copy any of their passwords in the
clipboard and now you have it set so
windows and um + clipboard key log and
you're good and if you want to play
pranks or you want to be funny you can
do clipboard set text where it sets the
text of whatever the clipboard is so if
you want to constantly set text who
hacked or hahaha and freak the victim
one user out then you can it's really
fun so then we have the adsr commands
this is active directory management
commands where you can say give me all
the computers inside of the domain a lot
like the post module does and I'm pretty
sure that post module has been updated
by meatballs to do it this way instead
of the old way then you have domain
querying gets all domain information
back user and um and stuff like that
then if that wasn't enough you have W my
query at your fingertips so anything W
my can do now you can do inside of
interpreter and great thing is again all
of this is in the API for it to be
extended up to interpreters UI so you
can code to your heart's consent content
to get this doing whatever you want
using any of these things
all right so I'll go back to load okay
so all we have is incognito Kiwi land
attacks and mimic cats so load memory
cats just to show you well I'm in a x86
process and I'm supposed to be in a
64-bit but you can see the commands that
I get Kerberos MSV and we've gone over
this so the cool things about Kiwi or
load Kiwi again it tells you that I'm in
the wrong wrong your architecture
process is I have a creds all the cool
thing about creds all is it does all of
the different cred modules so I don't
actually have to type W digest MSV SSP
TK package stuff like I don't get all of
them the secret sauce that you really
want to go this is gonna air after
DEFCON so you want to go back and watch
the videos from DEFCON is the golden
ticket stuff
if you create a golden ticket in Windows
which a golden ticket is basically a
Kerberos tickets it's just golden
because it lasts for 10 years and we'll
talk about that in a later episode
guaranteed
so Kerberos ticket list you can list all
the Kerberos tickets purged to use LSA
dump again it's dumping LSA stuff and
then Wi-Fi list cool thing about Wi-Fi
list is you don't have to do the Webley
land W land profile stuff it just listed
out it does this using the api's instead
of running commands on disk much more
stealthy alright so let's do load we
only have landed text and incognito less
left so let's incognito we already know
about these ad group user ad local user
ID user these all automatically
impersonate any tokens that it can see
on disk and tries to add those or groups
or users impersonate tokens just like
steal token lists token star token or
Snarf's ashes again all this stuff we
kind of already knew about in incognito
and use line attacks I believe oh this
is actually working again so it was kind
of broken for a while but looks like
it's working again so we have DHCP
command so we can actually log any DHCP
server
activity so this this can be really
helpful when we find out that the DHCP
server has a TFT P or P X pixie boot
stuff we can actually start our own DHCP
server on the meterpreter session we can
do TFTP based stuff so we can actually
pixie boot from our interpreter session
and go go watch I don't I don't exactly
remember the name of the person who put
this together so I apologize for that
but go watch and I'll have this in the
show notes or somewhere that people can
get to it go watch their talk on on the
land attacks with meterpreter you'll
find it very easy with google and you
can find how you can pixie boot a remote
host using my super session and load or
download hashes and upload add users and
all kinds of fun stuff so go check out
their video online on that and that's it
that's all of our extensions if we type
load and tab there's nothing else so
what do you think email me msf at hack 5
org and stay tuned to Metasploit minute
comm for more shows like these thanks
again for supporting the show and if you
want to support us even more you can go
to h8 key shop comm and enter code mu
--ax and get free Metasploit Manette's
stickers until next time i'll be hacking
til the cows come home</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>