<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Packet Squirrel Remote Access and OpenVPN Client Tunneling! - Hak5 2308 | Coder Coacher - Coaching Coders</title><meta content="Packet Squirrel Remote Access and OpenVPN Client Tunneling! - Hak5 2308 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Packet Squirrel Remote Access and OpenVPN Client Tunneling! - Hak5 2308</b></h2><h5 class="post__date">2017-11-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/OlKztGlt8VA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">remote access and client tunneling with
Open VPN and the packet squirrel this
time on hack five hello woke the hack
five my name is Gerren kitchen my name
is Shannon Morse get your weekly dose of
techno lots and this little guy is Bryan
Bryan his name is Bryan not like George
the dinosaur no no this is our new
member of the animal kingdom there's a
penguin back here mm-hmm there's George
the dinosaur and then they've been
watching Bryan the packet squirrel evil
servers around here somewhere too I want
to get a slew of stuffed animal
squirrels and just pile them onto this
table so that I have like a whole
beautiful harem of squirrels - what -
keep your clear back there company yeah
well yeah that would work I could put
him with the bear okay if you would like
to see a harem of squirrels on act 5 let
us know um I'm really excited because
today it's not just the stuffed squirrel
we're having fun with it's the package
squirrel and if you missed last week's
episode this is it basically it's a
Ethernet man-in-the-middle multi-tool
guy so you know packets going in packets
go out what happens in between up to you
easy-peasy so yeah and then last week we
also covered all the basics of the hack
5 gear the packet swirl which is brand
new so Darrin actually showed us how
easy it is to capture packets and do a
little bit of a DNS spoofing attack but
I have a question what if I want to
remote access into like my home network
for example or if I'm on a client
network from a remote remotely wanting
to get into a client network as a
freelance pen tester or as a freelance
Sisson man is there a way to do that yes
yes yes because it has pit loads built
in I'm really excited can't tell you how
excited I am that we've got like
built-in payloads you excited I really
am because it's cool that we've been
able to make awesome platforms with like
payload repositories or module
repositories and people contribute to it
but like the fact that it's like out of
the box you never have to do anything
that's kind of cool yeah it's a
basically plug in play basically so let
me show you this first sorry so we've
covered the
to last week and let me show you the
OpenVPN one so basically all we have to
do is click configure this one file it
really couldn't be easier so the first
thing you do is you switching into
arming mode to do I'm gonna break this
by flipping the switch all the way to
the right and then you just SSH in okay
so I'll go ahead and do that here and
I'll SSH to route at 176 teen 32.1 whoo
get cute little ASCII and you'll notice
you can see to you over to payloads and
you see that there's a switch 1 2 &amp;amp; 3
hey hey figure out what those do right
so I switch CD to switch 3 you'll see
that I've got a payload SH that's the
actual payload okay and that config a
VPN so that's it you just you fill in
the blanks your sin so what's running on
the packet squirrel currently it's it's
just a client though right and we would
actually technically we would need a
server right yeah yeah so that's the
idea is rather than running an Open VPN
server on here and then you deploy it on
the land and then you have to like open
up ports on the firewall and stuff so
that you can get in that's never gonna
happen especially if you're on a pen
test right so rather it's a client that
will dial out to your VPN server up in
the cloud so if you're the client and
you you get to our friend our squirrel
friend in the cloud yes totally that's
what you've come to expect a hack 5
expect no less
and I anywhere in the world say I like
to get you say I head over to Bali
yeah and then you yeah if I can get over
the Internet to our squirrel in the
cloud yeah then I can communicate with
your network yeah so it's just so much
easier to to punch out than it is to
punch in
so what do you do we do a new server ah
ok yeah I actually spun up one right
before the show I use digitalocean
because they've got these you know
spiffy easy droplets but you could use
whatever I'm not endorsing that
particular VPN provider I just bps
provider but I do like them for quick
and easy servers so it doesn't really
matter which one you use but I know in
the past we used Open VPN a/s that's
called the access server
that's the one with the really pretty
web interface and it's free for up to
two clients I believe is this yeah yeah
it's it's good stuff okay it's clicky
boon to you as it were yes you know to
be honest buoy friendly it is you know
I've actually moved on though I've gotta
say it's nice but I've started just
using the vanilla OpenVPN because there
was a setup script that makes it stupid
simple like stupid simple watch this
here I'm just gonna SSH over to my
server and in like two minutes we're
gonna have a VPN server setup really
yeah so I've got this window over here
this is another machine let me just go
ahead and ss8 you over to this server
that I just setup and this is just
running the latest boon to TLS and
literally all you do is double you get
okay HTTP colon slash slash get a o
slash VPN tak capital o to save it as a
file - I don't know Open VPN Sh or
whatever you want and then ampersand
ampersand says hey when that
successfully completes go ahead and run
in this case bash space Open VPN Sh
literally one line of code that's that's
it and I just went and downloaded that
file off the internet and ran it and now
it's asking me a couple of questions and
literally all you do you keep pressing
enter that's really it that's it like
watch this I'm just okay so first one IP
address already got it figured out yeah
that's the public IP address of it cool
enter protocol already recommends UDP
sounds good enter port sounds good
current DNS yeah sure current DNS should
be fine what should we call the client I
mean I guess I could write the word
packet squirrel in there or I could just
leave it named client and didn't have
one client anyway so fine client okay
that's all I needed
hit enter oh you know what I lied you
have to hit enter six times oh no I
didn't lie it says press any key to
continue all right there you go
so technically do you see the any key
that's shift okay
wait no control oh function no alt no
caps that's not the any key print screen
no that's not the antiquey pause break
oh man he doesn't have any key ha insert
works
Sirk's I'm sorry I'm actually just
trolling it says press any key but it
means any key that's not a modifier key
right right of course yes okay so I
actually used to think openvpn AAS was
easier than this
this is stupid simple because at this
point you literally just sit here and
wait and it says hey we're generating
all the dhrd Elmen parameters 2048-bit
long safe primed okay yes this is going
to take a long time actually and there
we go it's done and it says ha finished
your client configuration is now
available cool here's my file and if i
LS if I lowercase LS there it is client
- Oh VPN and really if you want to add
more users you just you know you just
bash a VPN VP and SH you just try that
again and it'll guide you through the
same set of process to add more user
accounts that's so easy ok so now you
have this open VPN server up and running
and a new user profile which is great
you just copy it over to the packet
scroll right that's it
that's basically the sense that you
would do with your phone I think so easy
I think the most secure way for me to do
this is just to SCP it from the packet
squirrel yet server so the file gets
over there so get this so now from the
perspective of my packet squirrel I will
just SCP that file so it'll be SCP root
is the user I know I know at and what's
the IP address of this guy again yeah if
config I'm really loving that name oh my
VPS host name mhm yeah you know me all
right
SCP that : and so this is going to say
okay from the perspective of this user's
home directory which as we know if i LS
tilde
it's right there so : client VPN so that
file and where do we want to put it you
know I'm just gonna put it here so dot
which says right here where I am that's
easy I have to just type in the password
and now aha it's there we are I have
client VPN okay literally all I need to
do is now let me remove config data VPN
and rename client doe VPN to configure a
VPN there we go and if I cap that file
now haha you can see this is beautifully
set up for me it's the entire
configuration with all the keys and
everything you can see all of the it's a
client can use all these things but it's
it's all done for you
like there's nothing ok so we got it all
set up up and running now what do we
need to do to use this actual payload ok
well now that I'm doing all the hard
parts get this you have to unplug the
power from the packet scroll you gotta
flip you don't have to press the button
first or anything oh no no you guys just
gotta flip the switch over to from the
fourth position to the third position ok
I'm scared that's the switch 3 payload
and then you plug the power back in
that's it yeah I know cuz it doesn't
work if you don't do that alright you
just reboot it yeah come on so it's one
way to say it is have you tried turning
it off and upside down again that's
ridiculous
yeah basically and so now you just plug
it in line I've got it plugged in line
on my computer but this could be a
printer or an IP camera or network
attached squirrels corrupt animal it
could be should have network attached
stuffed animal squirrels I agree
IOT with little lights that blink so
anyway so it's done booting up and you
can see that it's LED oh yes it's yellow
here I'll see if I can get that on my
cam yeah you see it's blinking sweet
know that it's running ok boom we're
done that's it so if I go back to my
computer you'll see that this machine
which is connected to the internet
through the packet squirrel if I like
say ping 8888 or whatever it's online
through the packet squirrel ok and it's
traffic is uninterrupted so I'm actually
still on the same
I was before it's not actually gonna
mess with any of the stuff so if you
like to drop it on the printer or
whatever have you yes no worries there
okay yeah very cool so at this point I
can actually now get a back door in
because what this does is it remotes out
to that VPN server ok so now from the
perspective of my VPN server remember
when I here we go I'll run that if
config again I'll ssh back in actually
and when i run if config you'll see on
the VPN server I have this tun 0
interface and it gets an IP of 10 0.1 by
default and baicao is that the packet
squirrel know that see IP address of the
VPN server the VPN server ok packet
squirrel gets an IP address from the VPN
server it just doles them out from DHCP
and it's usually just the next one up I
can literally just guess I could have
while I was in that control file set a
static IP but literally every time I do
this I just increment it by one and it's
always been that way it works yeah so
like if I from the perspective of my SSH
or my VPN server here in the cloud fire
nuts if I do SSH root at 10.8 ODOT - hey
there you go yes my packets URLs
password and now I'm on this packet
squirrel how cool now if you were trying
to be like super thorough though is
there a way that you could double check
that yeah I mean like I said I could put
it static in the config file or I guess
I could like enumerate the network from
that machine or I'll go check out the
DHCP leases from that I remember where
they're stored on a open VPN server cuz
I'm I don't want to say I'm lazy but I
always just good they are these works
you know you can't say that you're lazy
because you're literally making these
products so you go so that it can be
more like years of work to make these
things work and then it makes you but it
gives you the ability to be lazy yes
because that is the ethos of this event
anything that can be done can be
scripted and anything that can be
scripted gives you more time to play
counter-strike
so tangent aside what about the
computer's network traffic isn't that
going to go through the VPN as well or
no no so in this case actually in this
default state now you know my computer
here is still connected to the lands
through the packet squirrel but it
doesn't actually change any of my track
my traffic from this computer isn't
going through the VPN it's just
providing a backdoor for me the pen
tester when I go up to ya beach or
whatever and I can pull it up on my
phone but what if I want to do it the
opposite way where where the traffic
from the computer is actually going
through the VPN okay for that yeah yeah
we're gonna have to do that thing again
oh no unplug it flip the switch back to
arming mode and plug it in again okay I
know it's tough it's tough right but I
want to make this thing work me too
actually hey you know what while that
reboots I can show you a tip because
this thing had its internet connection
through the packet squirrel which I just
rebooted so if I take a look at my SSH
session you notice it has just
completely frozen I'm hitting it or
nothing is happening
hit tilde period oh and it releases it
oh she's the greatest thing because
sometimes you just like what the how do
I it's cool I'm stuck I have to open a
new terminal like I used to be and then
I learned tilted period it's the best
thing ever all right so it's green so
it's green so it's booted up let me ssh
back in and show you how to set it up so
that the client this machine will tunnel
its internet traffic really VPN okay so
from my machine i'll just ssh back into
the packet squirrel come on buddy
wake up there we go just took it a
second for its ssh server to wake up and
i'm gonna head over to payloads and it's
in switch 3 and we're just like before
but now i have to edit a file payload sh
right here I know I know right here on
line number 5 it says for clients equals
0 set to 1 to allow clients to use the
VPN oh saying read the line above it
yeah that's it I tend to RTFM well if
that takes all the fun out no it doesn't
that's why you comment your code no
that's why you get on the forums and you
both do best
code you didn't read no that's literally
it you just save it and now the hard
part again unplugging unplug it change
to the VPN plug it back in
plug it back and we're really fast
learner here I know oh man so now you
actually have that like hardware VPN
router so if I stuck this on the back of
my mom's computer for example she would
be able to plug straight into it and
automatically be on a VPN yeah kind of
you just like you know siphon off some
USB power from and plug it into the
Ethernet check it though make sure okay
okay so one fun way that I like to find
out is to just check my IP so remember
our virtual private server here our fire
nuts server that we set up is one 65.2
27.53 dot two three seven so the idea
here is now that the packet squirrel
which has just turned purple to let me
know it's setting up the VPN in just a
moment when it's done which is bound on
it right right magenta you're such a
torque that's established that that VPN
tunnel yeah everything going from this
machine onwards is going to be through
that VPN right so if I just pull up
Firefox whatever
now Firefox they set this one up for a
demo if I pull up Chrome and I for
instance Google what is my IP Hey look
at that
it is 160 5.2 27.53 237 match my server
yes it does so that was pretty much it
great that's way easier than like asking
my mom to put a profile on her computer
on her daughter smartphone and then
having her load up a new app and all
that just plug that thing in yeah do you
see the matching port you know if you're
gene Porter says she's gonna mess it up
she's gonna plug her computer into this
side and then network into that side and
we don't
negotiate that no I know I know so I
could also take this to Japan with me
yes I'm travelling to Japan this month
actually PS I'll probably do a meet-up
so keep an eye on my social media for
that but that would be great to have one
of those available at whatever air B&amp;amp;B
or hotel that I'm staying at I did
something very similar not with this
particular payload but he used Wi-Fi
pineapple when I went to Indonesia oh no
way and you know think about it you can
pretty much just port this exact payload
over to the Wi-Fi pineapple I guess you
could with a little bit of modification
that would work great and then that
would just relay a Wi-Fi signal instead
of even doing it over Ethernet I like it
so cool I'm really excited yeah I'm
excited about this too all right so now
I know we've just covered the basics of
the three well I guess I could say four
built-in payloads of the packet squirrel
but I'm sure that we're gonna see plenty
more just like the bash bunny just like
that so if you are thinking about
writing one totally check out the let's
code livestream that Sebastian and
Darrin did I know you all got into the
nuts and bolts of the scripting language
I see what you did there yeah I know
right
right yeah that is happening before this
is aired but I'm assuming it was awesome
and so it's a lot of fun yeah so it
should be on youtube.com slash hack 5
and we'll put a link in the show notes
to that so you can directly find it as
well as if I'm really feeling like
getting into the groove of things on
YouTube you'll see a card right here
that will pop up and you can go directly
to the video right there right over
there also we have a contest going on
yeah I was actually gonna say if you're
watching this video from 2007 on YouTube
you can comment over here that's amazing
you can comment over there not down here
that's funny that's very true alright so
we have a contest going on as well you
can go over to hak5 org slash contest we
are giving away $100 gift cards for hack
5 gear now through November 20th I've
already seen some really really good
ones too so I mean
right so props to everybody who has been
participating in that so far later in
the holidays we'll do a whole roundup of
all the winners - because these are so
so funny I just love these submissions
yes they don't have to be funny either
you can do really intriguing Willie I
want to see the stuff planted in the
place that you can't tell me about
anyway you know of course but yeah I'm
really excited about all of that yeah I
just use hashtag hack five gear okay
cool well with that man there's so much
other cool stuff coming on I mean I know
that that hack $5.00 we've got like a
you know beautiful makeover shop
beautiful makeover there's you're going
to go into Japan
yeah logging like crazy they have like
I'm actually doing this thing called my
30 day security challenge of November
it's gonna be over on youtube.com slash
tech thing it's a 30 day street of short
format videos a series to get you
started in security just for your
personal life so this is much more
mainstream for consumers more than it is
for InfoSec professionals so if you
watch that and you're like why are you
telling people to download a VPN app as
opposed to creating your own VPN
that's why y'all already know how to do
that this is for everyone else so this
is something you can share with your
family and friends who are just getting
started into security and then it will
get them started as far as being private
and secure online for themselves get the
basics down yeah exactly get your basics
down then you can grow on top of those
once you get the Nitti or once you
understand the theory behind things so
that'll be on youtube.com slash tech
thing security in a nutshell yeah you
know what to break down on breaking in
is on its way back November mo bik's is
coming down to shoot another season of
Metasploit minute we're really excited
to have him so stay tuned to that if
you're not already subscribed and you'll
find it over at youtube.com/scishow
so excited I think that's it okay that's
it well until next time i'm darren
kitchen
Brian the packets girl I'm Shannon Morse
trust your technology you've got a great
idea you should do what Shannon and I do
and head over to domain.com and register
your domain bring it over to the
Internet using this super awesome
discovery system that brings domains
from your mind onto the web over at
domain.com they've got a quick and easy
checkout process and they've been
supporting hack 5 for years you can also
tweet Adam at domain.com and say hey
thanks for hooking up the guys and
they've got a special treat just for you
you get to save 20% off at checkout over
at domain.com using the super secret
coupon code it's 5 it spells hack 5 and
it's just between you and I all right
I'm tell anyone ok when you think domain
names think domain.com remote access and
client tunneling with let's reverse that
really and three - I actually need this
ah sorry you killed him yes weird oh
sorry I need this no my poor Brian CPR
working it's not working Jim he's dead
Jim he's dead no this thing's happen</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>