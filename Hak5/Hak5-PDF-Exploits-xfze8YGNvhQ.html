<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hak5 - PDF Exploits | Coder Coacher - Coaching Coders</title><meta content="Hak5 - PDF Exploits - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hak5 - PDF Exploits</b></h2><h5 class="post__date">2010-06-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/xfze8YGNvhQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this time on the show Darrin and I take
your questions at the hak5 Springfield
meetup pdf/x laced with 80 of dual-core
and more I'm Shannon Morse
and you are watching hack 5
this episode of hack 5 is brought to you
by domain.com got a great idea it all
starts with a great domain domain.com go
to assist Express and Netflix got a WWF
flexkom / hack 5 for your free trial
membership hello welcome to act 5 my
name is Darren kitchen
this is your weekly dose of Technol us
and this is awesome the beer check it
out oh yeah where's Frank field Missouri
last time we checked in this was week
three of the hack across America tour
this is week or no yeah this is week
anyway it's week that old hack across
America last time we were in Detroit
since then we've been to Cincinnati to
see 80 from dual core and a Humboldt
Tennessee where there is cows they have
those and now we are in the epicenter of
all things Missouri it's yes it's
Springfield Missouri where there are
signs that say Jesus well that's all it
says I love this place and we're at the
Springfield brewery tonight drinking
beers playing some pool and having a
good time with our fans what's up guys
where's the free beer guys now we just
figured to start this off since it's
been so long since we've got done a
proper episode in studio at least until
until the 25th let's go ahead and do a
little bit of QA so we bugged the
Twitter and the the IRC and we came up
with maybe one or two questions that
might seem legitimate you want to start
us off yeah let me just pull that right
out ya know the first one mm-hmm sorry
no go ahead all right first one is from
Nate lappy and he said who is the man
behind the mask that would be prone
elbows oh yes techniques or technics
says did Darren really marry a monkey
and Thielen oh I know
in Thailand Thailand no Singapore next
kkona kkona says why do you choose to
hide hardware and strange objects extras
such as monkeys and pineapples because
it sounds way better than the wireless
device the tricks you laptop into
thinking it's actually your home network
but it's not really it's a lot more cute
and although you do have to remember
when you take it through security take
the router out of the pineapple so it
doesn't look like a grenade yes tell you
look like a grenade on the x-ray as for
the monkey who doesn't like monkeys and
it's the monkey in the middle only we
can find that act on em r32 oh to be hit
me up if you know a source and then
techniques or technics also had a
question will there be a hacker across
Europe ah yes you should be there there
will be there will be I just need to
find the the right flight and the right
motorcycle and if you have leads on
either of those let me know I'd love to
start in Munich Hamburg no my truck all
right fine gonna ask what are each of
your favorite operating system /
districts what do we really get the u.s.
question yes I like the right one for
the job mint is where it's at I built
some little micro Skype boxes they had
everything built-in right out of the box
mint I've got to give him props for
doing an easy Linux other than that
played with the SD Mac's there okay and
for the most part I edit and premiere so
on Windows but that could change who
knows how durable apps
yes portable apps are the win can we get
some Final Cut Pro portable app now
there we go we have one more question
yes from Jar mo8 is it legitimate
because come on really it is a
legitimate question alright he emailed
us he says I've been watching your show
it's great I have some ideas for your
show after realizing how easy it
passwords I realize that it might not be
safe to have eight letters in my gmail
password good point I saw that Darrin
has over 40 letters do you know what
those letters are dry mouth if you do
email them to actually know if you do
and just log into my email and know he
has 40 letters in his password so I
thought that you can give some tips on
how to create and remember safe
passwords okay here we go
Darrin's real basic tip to creating some
awesome passwords and you systems
administrators are totally going to know
what I'm talking about
actually my gmail password is 42
characters and if you're one of the guys
that sends me one of those weekly
password resets thanks f off here's what
I do okay so if you've worked in a
server farm area IT anything you know
that there are a ton of passwords that
you have to remember and it's so weird
that that password as obscure as it is c
7 j qo f ju you remember it I'm gonna
have to replace that one now yeah and
you remember as that was the domain
controller that's the exchange server
that's the sharepoint server the CIA s
server okay cool combine them okay
when I go to log into Gmail and I change
it on a monthly basis all I have to
remember is log in to exchange primary
domain controller secondary domain
controller you know what I'm saying I
just keep going down the list and that
way it's a bunch of secure passwords
that are for some reason engraved into
my skull strong together and my choice
is to always do something in like a
different language and then change
around whatever letters to numbers and
then make it kind of leak speak ish and
then add something at the end for each
website that I go to via whether it's
like facebook or myspace Gmail whatever
you have you pack five right I would add
in like a couple of letters at the very
end like the last two letters in the.com
name or the first to you or something
like that to help me remember exactly
what it is every time so I don't have
the same password on each website but
it's the same can
raishin so I can figure it out another
good tip is to use what's called a
passphrase not necessarily a word word
but an entire sentence it's not like I'm
saying mary had a little lamb is a good
sentence but something that you're not
going through yet especially if you can
leet speak fi it and that is to say
replace the numbers with letters etc
good way to go the one other and this
isn't a permanent tip but I will share
this with you have you ever done a who
is on a domain yeah okay so you see like
the the record where you see like Google
yeah yeah you see the address the the
primary contact the technical contact
their phone numbers right there is
unique information in that Whois
database and if you would like to have a
different password for every website you
log into there you go there is some
unique information that applies to that
domain that's not just the domain name
that you can work into some sort of
offset maybe it's on a QWERTY keyboard
you offset by two characters to the left
as long as it's not a and then you would
wrap around and set a hit and caps lock
you know I'm saying that's Oh although
we would love to hear what kind of crazy
stuff you get into so if you would like
to go ahead a male feedback at hak5 org
with your gmail password and we'll let
you know how secure it is we'll try it
for you excellent now in just a bit
Shannon's gonna be bringing you guys
this week's trivia but I am excited to
announce that this here machine this
beautiful piece of hardware the nokia
booklet 3G with this twelve hours
battery life and always on 3G Wi-Fi
Bluetooth running Windows seven this
piece of machinery is sick and it can be
yours you know all about the contest
last week let's go ahead kick it over
and find out our winner
this week's trivia question is released
by Adobe Systems in 1993 this file
format became an ISO open standard in
July of 2008 enter for your chance to
win some killer new hack 5 stickers and
we'll be right back after a brief word
with our sponsor if you're looking for a
rock-solid domain registrar and web host
you next brilliant idea look no further
than domain.com and forget lengthy
setups they've got one click install is
a popular open source programs like
wordpress joomla drupal and more with
com starting at just 995 a year and web
hosting for under six bucks a month
it's no wonder domain.com is the fastest
growing domain registrar and web hosting
company on the internet but it gets even
better for you to the tech savvy hack 5
fan we've got a coupon that'll knock off
15% on your next order checkout with
code hak5 and experience blistering fast
DNS and rock-solid infrastructure
without breaking the bank support the
show and get 15% off at domain.com we
check out with coupon code hak5 it's got
a great idea it all starts with a great
domain domain.com so here we are week 3
of hack across America and I have the
pleasure of being in Cincinnati staying
at my buddy baby from dual cores place
he's downstairs doing a little about
hacking I figure let's go down and check
it out come on
Edie what's up man hey how's it going
Romeo lose money but thank you guys you
can make it so uh what you playing with
a little reverse engineering what's
going on
yeah today I'd like to show you guys
some stuff about a PDF malware and
malicious PDF analysis is it really that
bad when it comes to the PDF exploits
and stuff unfortunately it is to Adobe's
credibility and and other reader
creators you know they have been working
to remediate the problem but it is
actually becoming a pretty big big deal
and it has been for a couple years
really what it comes down to in my
opinion is users just aren't aware you
know if you think of where you work
someone in your or cart that's above you
will probably open a PDF file without
any concerns or any worries which is
which opens you up to a lot of problems
but we typically don't think about you
know PDF file we like as far as you know
malicious code think about executables
columns that's nice SCR quick screen
saver files yeah why is it that the PDF
is targeted or why is it that it's you
know capable of being malicious there
are actually two separate issues at play
here the first problem is there are
vulnerabilities in Adobe Reader and
Adobe Reader being the most popular PDF
for years is obviously going to draw the
most fire so the the first issue being
with the vulnerabilities is that they're
just memory corruption vulnerabilities
that exist either in the reader codebase
or in the libraries that Adobe uses the
second issue is a problem that's built
into the PDF standard where you can use
an action in in the PDF document the
launch action to run a separate program
or open a separate document so like open
another PDF file right and that's I
think that was probably the intended use
but under the hood it's actually using
shell execute function which is of win32
2030 QAPI function
and you can change parameters into that
so you could run calculator notepad
solitaire yep you could run any of those
binaries any binary that's not a system
you could run and in with you with you
being able to supply parameters like
command line arguments so you could run
CMD yep dot exe and just a slash C and
you're off to the races wow that's some
scary stuff so how do you what about me
what do we do is just is it just a
matter of having your antivirus
up-to-date with latest signatures to
detect these or what that's part of it I
think there are a number of approaches
here that could be considered AV vendors
are working to detect malicious PDFs and
there is you know some success I gave a
talk at not a con in April about this
stuff and somebody actually had an AV
installed that caught the PDFs on the on
the thumb drives that I handed out and
like in quarantine them so I mean they
are working towards it but there are
also a number of ways to tamper with PDF
file such that they don't get detected
by the AV would still work with just a
matter of encoding differently or what
yeah there are a couple different things
you can do and I'm working with a couple
different people I know at different
firms we're just kind of doing some
independent research but another part of
that I think as much as I hate to say it
is a user education you know just like
we went through you know over a decade
ago with educating people that Word
documents can be bad and you know omnis
documents can be bad and so I mean you
generally think of a PDF is being read
only and so you know it's just it's
going to be pretty safe and you know as
far as a common perception so when so to
craft a PDF to actually shell execute do
not get any sort of warning like hey
this is about to run this app or
something they're actually do provide a
warning dialog now i thinkfox said it
first did not and I think Adobe Reader
has all along but you can also tamper
with the contents of the warning message
if you've ever received an encrypted PDF
document there's a dialog that pops up
to decrypt it and it's the exact same
dialog that that you get when you
when you have with this she'll execute
about to run so you can tamper with the
message in there and just replace it
with the message saying you're about to
decrypt an encrypted document no problem
and you know you can totally convince
the user to run it
what would is it just like overflowing
the the space for the message what's the
yeah that it's actually and you can see
it to like there there will be a
scrollbar bar on the side and what's
immediately displayed to the user is
your custom message that you've tampered
that says you know something to the
effect of it's safe to open the document
but if you scroll all the way up you'll
see the actual payload that you're gonna
run CMD dot exe so it's /c and then you
know all the more less of it you pass it
in but nobody's bothering to scroll up
right okay so how do you when you see
the PDF what clues you off that this is
potentially malicious and furthermore
how do you tell from there like what
it's actually going to do without just
you know running it and sniffing well
first stop have an indication
unfortunately there's no real like
spider sense but if you're really lucky
somebody will bring the PDF to you and
say like hey I got this PDF that you
know like I received from somebody I
have no idea who it is
so has that ever happened in the history
of the world it happened to my last job
we had people send us PDFs that they
said you know hey I got this PDF in an
email with the subject of an event that
I just went to last week but I have no
idea who the person is that sent me the
PDF this looks kind of weird and then
you know we pulled the PD up apart and
say like oh yeah that's definitely not
good well I like your users yeah I need
some more of those so once you you know
you have that PDF how do you tell like
you know what's gonna clue you in that
there's some suspicious material um
there's actually a tool from a guy named
Didier Stevens it's a Python script
called PDF ID dot py and it can kind of
give you a breakdown on the composition
of the PDF so in that first class that
we were talking about of that people are
targeting with the vulnerabilities of
what they're doing is a writing exploits
to exploit the memory corruption
vulnerabilities and reader those are
coated in JavaScript and so while
commonly coded in JavaScript so one
really good indicator or potential
indicator
is to run PDF ID get the breakdown or
the composition of the of the PDF and
then take a look at if there's any
JavaScript present if there's not at
least you know like that part's gonna be
clear there might be something else in
there still but it just kind of its kind
of like a litmus test almost if you will
not not a not a get-out-of-jail-free
card or anything like that but just kind
of something to get you started so when
you open this up you just see the
JavaScript in plain day now there are a
ton of encoding methods available for
PDF files so there are tons of ways to
encode JavaScript and there there's also
a script from DDA Stevens called a PDF
parser there's also a separate app
called PDF TK and both of those have
pretty good success about pulling the
JavaScript out such that you can analyze
it and break it down okay so once you
pulled that out where you you know what
do you do with with it from there like
how do you actually unencoded so you can
take a look and break it down well there
are a couple different scenarios you
might run into with pulling the
JavaScript out you might be really lucky
and get just a completely clean looking
piece of JavaScript which is always
really nice but unfortunately fairly
rare other times you'll get just
JavaScript and then you just kind of
need to clean it up so you kind of you
know just think of like when you're a
developer and you inherit a project from
a from another coder who you know hates
white space or something like that
hates tabbing kind of the same deal
they're just not much white space and so
you just need to tab things out and
rename some variables but then other
times you'll get JavaScript that's still
got encoding from adobe reader in it and
so getting that all cleaned up like you
can look at it and see like you might
see the word function in there but in
between like the U and the N might be a
dollar sign or a pound sign or something
like that it can be pretty dirty looking
so I you said personally to go ahead and
just do a bunch of finding places and
clean things up but really any fun and
replace tool would work nice so once
you've got that you're taking a look at
the code I mean where do you go from
there as far as your you know research
reconnaissance whatever is concerned
I guess it kind of depends on what your
goals are going to be in my last job our
our big focuses were network based
indicators and host based indicators we
wanted to know when something was
calling out from inside the network or
something was coming down into the
network and then also to scan hosts and
look for bad things so what we would do
in this case is take out the shell code
that's in in the JavaScript and dump
that into like a hex editor and take a
look at like what it's actually doing so
from there you can usually grab certain
strings like you might see a URI in
there you could you know put that URI is
a network based indicator so if you ever
see a machine cloth that URI that's bad
you need to investigate that machine
additionally you can follow through on
that download you know whatever binary
comes down from calling out that URI
there's your host base indicator you
could reverse that binary see what it
does you know grab more host base and
more Network based indicators from there
and kind of follow that chain which kind
of gets outside the scope of this
particular issue this is very cool I had
no idea I think that's some really neat
stuff so woody woody tell the users get
off the computer get off my line I
really um I think you know just letting
people know like it's good to come with
us
come to us for suspicious things you
know like that's you know we try not to
like scold anybody for for crying wolf
because we'd much rather you know get a
totally benevolent PDF that's not
malicious in any way then have the user
be worried about like contacting us and
being worried and just running the PDF
and getting an infection and then having
that spread through the network nice so
what do you use personally that's that's
most important what would you use a
hacker it's like reading PDFs is
concerned I use well there are a couple
of good options I use I use have been to
which I don't think the document reader
and event - I don't think how you're
saying that the win32 shell execute is
not going to work on that right that's
you in the launch action but also I mean
like I don't think it I don't even know
that the vacuum that viewer in the v2
uses JavaScript but also if you use like
Foxit for example I think that the
vulnerabilities that are targeted in
in the exploits don't really show up or
they don't hit against Fox it it and I
guess I haven't checked there's one
vulnerability that I that hit reader
pretty hard which was against live
Tiff's and it was some hunger ability
from 2006 and if you look up the live
tip on her ability the CVE fort is 2006
initially but then there's also one for
that same vulnerability and Adobe Reader
from 2010 Wow which is kind of rough
well I so I don't know if Fox it's also
using that old version of live tip if
they are you know that's that's a
separate issue but cool man take so much
man anything else uh dual core dual poor
that's what's up yeah that's right the
new albums out go check it out right
yeah next level iTunes Amazon dual core
music calm
we're everything dual core music online
Twitter dual core music very go for
music youtube dual core music Facebook
dual core music right you don't just rap
about hacking or but did a legit man
yourself thanks so much thank you
take care Netflix delivers movies
directly to your home saving you time
money and hassle as a Netflix unlimited
member you get DVDs by mail in about one
business day plus you can instantly
watch thousands of TV episodes and
movies stream directly to your PC Mac or
right to your TV via Netflix ready
device like the Xbox 360 ps3 and the
Nintendo Wii console watch as many
movies as you like shipping is free and
there are never any late fees or no due
dates to keep the movies as long as you
like DVDs by mail Plus instantly write
to your TV get unlimited movies two ways
for over eight nine
but as a new member in a hack by viewer
you can get a free trial membership go
to WWF flexkom slash high five and sign
up now be sure to use this URL so that
they know we sent you
whether you're collaborating on a
website development project with a small
team and you need to share images of the
site with annotations and arrows and
things like that or maybe you're making
your own website and you need to see
what the exact amount of pixels are for
an image or a video to actually fit on
your layout or maybe you're watching
your favorite podcast and you want to
take a screen capture to share something
in the image 20 your friends each of
these problems can be solved with a very
simple very cool program called fast
stone capture fast own capture comes as
a portable application and you all know
how I feel about portable applications I
absolutely love them version 5.3 is the
last one that you can actually get for
free and then it turned into a shareware
version which is $20 for a lifetime
license both versions are lightweight
and they don't slow down your computer
now let's get into these features
because there are tons of them and I
wanted to list off some of my personal
favorites the global hotkeys that you
can use for this program make it very
quick and accessible you can choose
which range you want to capture whether
that be an object the full screen like
regular print screen a certain object a
region even a freehand area so you can
just draw a little circle about around
whatever you want you can specify the
output destination and you can draw
annotations arrows text and even do a
watermark on top of your image you can
send your image directly to email FTP
server which is very cool Word or
PowerPoint presentations a clipboard you
can even just save it as and you can
save it as JPEG GIF bitmap all sorts of
different kinds of files you can record
your screen output and two of my
favorites are the color picker say if
you run across a website and you like
the color on the background you can
choose the color picking picker and find
out what the hex
and you can use a screen ruler to find
out exactly how many pixels that images
that you're looking at right now all
right
I'm gonna go into the hack 5 cloud lab
using go to assist Express to actually
do a demo at this tool you can do a full
screen capture by hitting print screen'
an active window by pressing shift print
screen or a selected window or object by
hitting alt printscreen
you can also draw a rectangle by hitting
controls print screen or draw around
something by hitting shift control print
screen and it can also capture a
scrolling win window into an image by
clicking ctrl alt and print screen now I
chose to output to the editor but you
can also output to the clipboard to a
file you can auto save you can print and
you can email if you want to auto save
it'll prompt you to choose or create an
output folder so I just chose my desktop
as a JPEG and then I saved those
settings there's also a really cool
color picker so if you need to find out
what the hex code is for a certain color
on a website that you like you can just
easily use this program so I'm gonna
choose the color picker and I like the
color of the cartoon snub shirt I click
on that and fast own capture shows me
the color info I need very cool the
ruler is handy to show exactly how many
pixels an image is but it's only
available in the shareware version
choose the ruler icon drag the ruler to
the image you want to measure and mouse
over from left to right or up to down
you can also choose a select area of the
ruler say half the image and then find
out how many pixels that is also
available in the shareware version is
publishing to FTP which is great for any
of you website owners that just want to
send a file really quick simply choose
your FTP server type in your password
and then now you can link people
directly to your website to see the
image and last but not least you can
also open an image in the editor and you
can add add a caption like Hawk 5 ohms
and you can also draw on the image
itself kind of like in regular paint
I'm sure you've all used it so I'm gonna
add a red arrow and then I can add some
text that says something like here we go
Darren and Jen Rock
yeah that sounds good right of course
all the drawings are customizable I
could change the font in the color and
blah blah blah you know all that good
stuff but I'm just gonna leave it
regular like it is and then I save and
I'm done so I love this program its
quick it's simple it doesn't kill your
computer with memory and it's very
useful what do you guys think do you
have anything that I can use instead of
this email me at feedback AK feedback at
hax 5 org and I would also like to thank
go to assist Express for this this
week's Memphis report the best way to
provide technical support is to do it
online with go to assist Express you can
help friends learn how to use new
software and fix family computer
problems without being there in person
go to assist Express lets you easily
view and control any other computer
online so you can quickly resolve
technical issues whether you're in
customer support technical consulting or
management or just a computer guru go to
assist Express will help you increase
revenue reduce travel and support time
and service more clients try go to
assist Express free for 30-days for this
special offer you must visit go to
assist comm slash high five let's go to
assist comm / hack 5 for a free trial
find more great tips like these a
revision 3.com / go to assist Express if
you've got the tech no less like Evan
with 13 hack 5 logos in this picture can
you find all 13 I know I tried and I
couldn't find
anyway remember to show you pry it over
at feedback at HEC five org also we have
some brand-new hack packs coming out at
hack 5 org slash store and you can
support the show free and simply by
subscribing to iTunes and YouTube until
next time I'm Shannon Morse remember to
trust your techno list
this is the part where you guys cheer
support your show but my I'm putting my
own mom to sleep thanks mom thanks for
your support
fine American</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>