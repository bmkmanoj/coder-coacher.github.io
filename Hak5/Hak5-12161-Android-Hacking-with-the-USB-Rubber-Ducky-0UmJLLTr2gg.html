<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hak5 1216.1, Android Hacking with the USB Rubber Ducky | Coder Coacher - Coaching Coders</title><meta content="Hak5 1216.1, Android Hacking with the USB Rubber Ducky - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hak5 1216.1, Android Hacking with the USB Rubber Ducky</b></h2><h5 class="post__date">2012-12-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0UmJLLTr2gg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this segment of hak5 is brought to you
by goto assist hello welcome to hak5 my
name is darren kitchen I'm Shannon Morse
it's your weekly dose of Technol us and
we have lots in store for you this week
yeah we really do and I'm really excited
we have like Christmas colors going on
up here what's going are you talking
about though you're right I hadn't
thought about it like that we've got red
white yeah black the og and green when
we started USB rubber ducky project one
of the biggest barriers to entry was
cost in that since we had redeveloped
what we had originally designed on the
teensy platform yeah and had our first
kind of bit of fun learning custom
hardware manufacturing we were doing
really small runs and anyway basically
the long short of it is economies of
scale yeah when we launched the ducky a
little over a year ago is like $80 we
just hit our latest run we went from
black to red the white and latest ones
are in green best in the hallways I
guess and and yeah we were able to you
know get it down to $40 that's awesome
and so hopefully we can just go ahead
and continue doing that as we do larger
runs and then make these so that you can
litter yeah and I'm excited to see what
you're talking about today with the USB
rubber ducky a little a little Android
phone hacking with a rubber ducky and
I've got some fun stuff in the forums so
I guess that's that's it for that yeah
yeah so why don't we just go ahead and
check it out and we'll see you on the
other side awesome so it's been a little
while since we've talked about the USB
rubber ducky and I figured we'd do a
little uh little what's up with that
duct segment so if you guys don't
remember the USB rubber ducky the
concept with that is it's all about
exploiting human interface devices
exploiting the inherent trust that the
machine has with the human because of
course we're the master and all that fun
stuff and the idea being if you could
only get access to a machine for just a
few seconds what could you do with it if
you could sit down at the computer and
type as fast a Superman and so that's
the whole idea behind that and we
started this project a couple years ago
with a development platform called
the USB teensy which is a kind of like
an Arduino clone and told iron geek at
shmoocon 2010 and then he later went
ahead and demoed that a month later at
outer zone and then since then you know
the attack scenes have been referred to
as a ducky attack or a TNC attack again
the teensy just being like inexpensive
like $20 Arduino clone the thing about
that is it's programmed to see it's
compiled you have to flash the device
and then brew using that as a
development platform we were able to
come up with what I think is kind of the
best option for this kind of pen testing
and so we introduced it in September of
2011 and it's been a year so let's kind
of go over what the goals of the project
were where we are now what the future is
and all that fun stuff so the goal was
simple all about making the USB rubber
ducky as simple as humanly possible
didn't one have to write any code didn't
want to have to compile anything didn't
want to have to do any C script or
anything like that so I'd say the ducky
script that we came out with was a
complete success it's all like I mean if
you've ever programmed basic this makes
it look difficult in fact we put the
entire ducky script on the back of the
card I mean it's it's that small and
simple so I think that was a huge win
the other thing was we really wanted it
to be you know easy to swap out payloads
and there's a lot of different options
as far as like you know there's some
stuff with the teens where you can do
like dip switches and I feel like really
with the inexpensive nature of like
micro SD cards I barely even see that on
camera Paula can you see that over here
I mean that's like yeah there we go so
as long as you can carry a couple of
those around you should be all good and
so I think that was a huge success with
the project we wanted it to be
cross-platform and we really fell flat
there but we have fixed that I'll get to
that in a second and we wanted it to be
in a generic case so that it looks
pretty innocuous here's actually the
teensy and you can see this is a regular
teensy here with the with the adapter
that you would need to make it a regular
male a and then this is a
these are the Ducks and this is the duck
in white and this is a duck inside of
the case and it's that same generic case
that you've seen time and time again you
don't have to put the decals on it just
makes it a little bit more elite but you
know you can be pretty covert with this
not I feel like which it's a huge
success it looks and feels just like a
regular flash drive and so you know no
one's really the wiser if you're using
it in a kind of social engineering
context to do a little exploiting so
right off the bat this was a this is the
first time we really ever got into like
custom developed hardware and so we had
some pretty big ambitions as far as
making it user friendly and pretty
innocuous and covert but as such we
learned a lot when it comes to
manufacturing and so the first problem
off the bat right off was that it was
expensive
$80 a unit at launch a year ago like I
said we we also had some problems where
was us keyboard only
that was another foresight where it's
like I had no idea like I know it's such
an ignorant American thing to say but no
idea that there are actually different
key codes for different keyboards in
different languages and at the time was
actually Windows only now thankfully a
lot of this has been solved and also
because of the community and that's what
I love about an open-source project like
this so the firmware has been updated
and I have to give right off the bat
huge props to midnight snake in hack
five forms for his contributions because
now we have in addition to Windows there
is Linux and OS 10 support we've had
that for a while and I think that that's
sweet and I'm about to show you some
other fun tools we can do with it now so
and also as far as languages US UK
German Danish French and Norwegian and
there's another one that I don't
particularly remember was it Portuguese
anyway at Swedish Dennis a Swedish
Portuguese yeah those so we have a
couple of languages we're still working
on that and what I'm most excited about
in addition to some of the web stuff
that we're doing is that it is finally I
feel like inexpensive it's close to
where I want it to be in fact I've got
them all laid out here this is the the
original dev platform the teensy with a
an adapter on it and then you can see
the the lineage of the original duck
that was like $80 and then you know as
we ramp up manufacturing and we keep
changing the color so we can tell the
red duck and then the white duck until
finally the latest version the green
duck and we finally got it down to half
the price of the original unit down to
$40 my goal with this project is to make
it simple enough that anyone can
implement a payload which I'll get to
the online stuff because I feel like
we're getting there with that an
inexpensive enough to any penetration
test or any hacker anywhere can get a
ton of these and deploy them just as as
as easily as you would just a bunch of
USB drives because nobody's doing
autoplay anymore that's that's old hat
that's been thwarted but what's
beautiful about a hit attack is nobody
protecting against keyboard as a vector
because you kind of need them to use a
computer and again it violates an
inherent trust that is so deep within
the system it goes back to like the very
first computers the very first personal
computers with keyboards as the input
and monitors is the output or even
teletype I don't know I've never tried
to plug this thing into a like a COBOL
machine or whatever but maybe maybe with
an 80 adapter I'm not really sure but
anything with USB and that is pretty
ubiquitous so I'm really excited about
that so as far as addressing some of
those things to really spur some more
development into this I got really into
developing kind of like a wizard like I
said the duckie scripting language
already per diem something I mean this
is this is the whole thing that's that's
the duck in a nutshell and and I think
that's great
for anybody that once to get started
scripting but if you just want to deploy
some of the awesome payloads that have
already been done
while the forms are a great resource
while the wiki is a great resource I'm
really excited about this so this is USB
rubber ducky comm and one of my favorite
payloads is from move X is just this
PowerShell W get and execute and all
this does is when you create this
payload it goes ahead and and downloads
whatever executable off the web you want
and then just execute it's very simple
in fact it's three four four lines of
code but it's so nice to be able to come
over here and I can just type in WWE
ample comm /bobby XE and go down here
and say Bobby XE for the local file name
and click generate payload and on the
server side it goes ahead and creates
this and I actually see the ducky script
for it as well as you know I can change
this if I want but it's done and I can
click download payload and now I get a
inject up bin file so if you can drag
and drop the file that you downloaded
over the web to one of these little
micro SD cards then boom Bob's your
uncle so I've gone ahead and added some
of my favorite payloads to this in
addition to the PowerShell W get in
execute we also have the Wi-Fi backdoor
for Windows this is a really cool one
that creates a software access point
with the name of a P that you want and
then a very secure password and then it
even lowers the firewall so that you
know you can help those people out
there's also a reverse shell this is a
very basic beautiful reverse shell where
you just give it the port number will
say 8080 and the host I don't know I'll
say eight eight eight eight I don't know
now suddenly I'm Google anyway generate
payload and you can see there's the
entire payload I can even come down here
and see where we start injecting binary
but what's beautiful is right at the
very end that's pretty much the gist of
it this is where it changes it actually
changes the the host important number
that I specified so there are a bunch of
other awesome payloads that I'm putting
into this because a lot of them can
really easily be tweaked to just some
very basic variables so I think that's
really cool and I want to start adding
some more of those so I've been getting
into the forms and if you have some I
know that a lot of people at conferences
have come up to me and say do Darin love
the dock using it in all these
engagements and I'm always like dude
give me your payloads you know because
it only makes the community better and
everything better for everyone so I
encourage you to check out USB rubber
ducky for that but what I'm super super
super stoked about now is android
hacking okay
get this I got totally inspired when
cause was here and we were talking about
the the cause cable cache I wish I had a
cause cable nearby anyway it's the idea
with that was that you could take a
throw me that Paul you're wonderful and
the idea with this was that you could
take you know your phone on the red end
and then the black phone the the black
end goes into the victim phone and then
you can do some really cool android
hacking over ADB now as cos explained
ADB needs to be enabled on your victim
phone in order to go ahead and execute
that attack which got me thinking what's
the quickest way to get a DB enabled so
let's take a look at that and I have a
payload here and just to kind of show an
example I've got an Android phone set up
this is a Galaxy Nexus running the very
latest version of the Android operating
system I'll show you here it's got the
sushi whoo and so that's 4.2.1 and I
have a keyboard here
so what I'll just do to kind of set this
up is plug my keyboard right into the
Android phone and this is this is what I
love is I have to do this because it's
the it's the most basic like haha remote
shell or whatever or not
I didn't remote shell I mean I've got
physical access the device has already
been owned but if I just hold down the
windows key and hit a their calculator
and then escape is the back key so you
can plug a USB keyboard into an Android
phone as long as you have a G adapter
all day long and start throwing key
codes at it and find really cool stuff
I've already found like Windows M opens
up maps windows G opens up gu g mail
which is cool because then you could
like send an email from the device with
all sorts of nefarious stuff like
attachments like attach the latest photo
in the gallery or something I don't know
could be fun so let's talk about setting
up ADB with with what is it called with
developer options in Android now I added
first actually demoed this at Derby con
a couple months back when when cause was
showing off
research and since then have actually
had to update this because I guess
somewhere along the line google got
savvy to this or the Android team have
figured that not everybody needs access
to developer options so way to go cause
anyway but they're not completely gone
I've already done it on this phone so I
can't have it show how to do it again
without having to format the phone but
if you've got a newly updated phone on
four point or a four point two and above
go to settings and then scroll to the
bottom and you'll see the developer
options isn't actually there but if you
go into a bout phone scroll down to the
bottom and you'll see the kernel version
tap three times on kernel version and
hit back and now developer options are
there again so it's like okay cool
something I can do programmatically so
let's just go ahead and do that here is
this one's a white one not the the
latest gen green ones they're still the
same firmware but let's go ahead and
plug a duck in and see what happens go
the first thing it does is go to the
home screen of course it's already there
goes to about phone enables that even if
it is enabled doesn't matter we enable
USB debugging or developer options now
enable USB debugging and go back home
and so all of that takes about 10
seconds which is pretty freakin cool I
have another one here that I would
figured would show would be really neat
to show off because if you couple it
with like a Wi-Fi pineapple you can do
some pretty neat stuff and of course
again the sky is the limit when it comes
to this stuff because again physical
physical access all bets are off and the
faster you can do it with physical
access the better okay so this one's
another one another payload I've set up
and this one's really fun to do with
Wi-Fi pineapple plug this in here it's
again going to go to the home screen so
if I had an app app open it'll just
cancel that out coming to Wi-Fi options
go down to the end and type in I've been
owned and added as an access point and
now my phone is going to be looking for
an access point called I've been owned
which of the Wi-Fi pineapples going to
say om must be friends I'm really
excited about the kind of development
that's been happening with the USB
rubber ducky as of late
I wanted to show off a couple other
things for example there's been some
improvements to the Sam payload so I
encourage everybody to go over the forms
and check this out the idea with this
payload is if you're familiar with we
talked about this months and years ago
but you know being able to crack a
Windows password by getting the Sam file
the the system you know file and go
ahead and running that through like John
the Ripper or any of your other more
advanced cracking programs that's
totally awesome and I encourage
everybody to check that out again mad
props to midnight snake who's been
working on the firmware and you can find
his Google code page linked from USB
rubber ducky comm where again like I
said the languages have been added
he's got a reverse of the pit of the
duct encoder so you can take inject that
bin files and turn him back into ASCII
even has things for you know mass
storage and multiple payloads was just
added so mad props again because this is
really cool he's got a mode where by
plugging in the duct and hitting the
button in combination with caps lock or
scroll lock you can include multiple
inject bins so you don't have to carry
around multiple SD cards personally I
like the SD card approach because
they're super cheap but but either way
I'm really excited about all of the fun
stuff that's happening with the USB
rubber ducky and just in general with
hacking on the on the hid kind of the
hid attack vector there's a lot of cool
stuff that you can do with the social
engineering toolkit with this and we're
working to port those payloads because
it's the same kind of stuff we're doing
here into USB rubber ducky comm so you
can go ahead and generate those like the
meterpreter like you could Jack's just
take a meterpreter and and use it in
conjunction with my favorite script the
three liner the PowerShell W get in
execute thank you move X so with all of
that said I'm really excited about
what's quacking head over to USB rubber
ducky comm hit up feedback hack five org
I will see you guys in the forum's and
with all of that let's take a quick
break and we get back Shannon's going to
be checking out some some fun ways to
optimize boon too and I guess it would
just work on any other
just run and we're gonna wrap this up so
I will see you guys on the other side do
work in IT I know I did and let me tell
you it is constantly jumping through
hoops setting fires putting out fires
making sure those fires don't start in
the first place and all of the while
you're trying to juggle these different
tools and you're trying to get things
done quickly and not having to duplicate
data entry so let me tell you go to
assist from Citrix they're the leader in
remote support and they've got this new
tool that integrates everything into one
easy to use platform so you can work
faster and more efficiently go to assist
includes three essential tools that let
you customize your needs they've got go
to assist service desk which allows you
to log incidents and track the
resolution they've got to go to assist
monitoring which proactively identifies
those fires and lets you know so you can
put them out before they become huge
deal and then they also have the remote
support which allows you to do live or
unattended support to any platform like
a PC the Mac even mobile devices from
anywhere to resolve those issues quickly
I know I was using at least just the
remote support stuff way back when I was
doing IT and DC and let me tell you it
saved my bacon so get this sign up for a
special 30-day free trial visit go to
assist com click on the try it free
button and use the promo code hak5 let's
go to assist comm from Oh code hak5
you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>