<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>HakTip - WiFi 101: Frame Analyzing | Coder Coacher - Coaching Coders</title><meta content="HakTip - WiFi 101: Frame Analyzing - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>HakTip - WiFi 101: Frame Analyzing</b></h2><h5 class="post__date">2011-08-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/xP7335PAJ70" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this hack tip is brought to you by
midphase welcome to hack tip the show we
break down the concepts tools and
techniques for hackers gurus and IT
ninjas
I'm your host Aaron kitchen and today
we're dissecting wireless management
frames and as you guys know we've
covered the three types of wireless
frames management control and data and
last week we went over one of the four
types of management frames the beacon
today we're going to be setting up an
environment which will allow us to
easily dissect a beacon frame as well as
the other types of management frames
probes authentication and Association so
to recap our demo from last week let's
go ahead and begin by bringing up our
network interface if config wlan0 up and
let's go ahead and also start in monitor
mode with airmon-ng start wlan0 and
we'll put on channel 11 and then using
the tool MDK 3 we can create beacon
frames indicating our SSA ID of choice
so MDK 3 and we're gonna use mon0 we
just created on channel we're with the
beacon mode well on channel 11 and we're
just gonna call it tact if that's our
beacon of choice and there we go
you know transmitting a bunch of beacons
here on various BSS IDs and if we bring
up an additional interface here and I'm
gonna go ahead and do that now in a new
tab if config W Land v up we can go
ahead and scan for nearby access points
with iw list W lam v scan and we're
gonna go ahead and grap pipe that to
graph and look for ESS ID and we can go
ahead and see there are plenty of
beacons and of course since we have
random BSS IDs here hack tip shows up
multiple times now this week we're going
to be using air base ng and Wireshark to
put together a nice little wireless
packet sniffing environment so that we
can use it to better understand the
management frames it's going to come
back over here and stop MDK 3 all right
now air base ng is a script that comes
bundled with the air
engi suite of tools and like many of the
aircraft tools it serves multiple
purposes
this versatile little tool is mainly
aimed at wireless clients or stations
rather than the access point or base
stations and it can be used to do a wide
array of wireless phishing attacks
allowing one to say obtain WPA
handshakes or WEP keys it can also do
all sorts of mayhem to access points and
clients nearby so I'm just gonna go
ahead and put it out there use with
caution now in today's example we're
going to be using the most simple
function and that is just mimicking a
wireless access point you can find the
full syntax of the tool by running and
when we clear this by issuing air base
ng tak tak help and you know the only
parameters that we're going to need to
specify today though are going to be our
Channel and the SSID so let's go ahead
and start that up with air base ng and
then taxi for the channel and we're
gonna put that on 11 tak e for the e
SSID and we're gonna call it hack tip
again and then our interface Mon zero
and there we go now the first thing that
you're going to see when you're using
air base ng in this mode is that it's
going to report created tap interface
eighty zero see every time air base ng
has started at app interface is created
and you know it isn't brought up by
default but we can actually come over
into our other tab and do if config 80
zero up and then if config 80 0 to go
ahead and see all of the two parameters
and you know there we go we've got we've
got our eighty zero interface now the
neat part about this interface is that
even with WEP encryption enabled the tap
interface will always show incoming
packets after decryption and you can
also use this to send packets to this
interface and they'll go out and cryptid
say if the tak W option is set now the
next thing that's listed over here is
that says act trying to set up MTU with
1500 and that's basically saying the
maximum transmission unit or basically
the biggest an IP packet can get before
it splits it up into multiple packets
and you know for Ethernet version to the
highest that you're gonna see possible
is 1500 though you may see em to use all
the way up to 9000
with jumbo frames on Gigabit LAN anyway
finally air base ng reports that an
access point has been created and it has
the bssid of our NIC now we can actually
specify a different bssid with the tach
a option or just simply use mac changer
beforehand I know a lot of you guys are
like oh you give me back address that
begs alright
so now with the access point up we're
going to go ahead and fire up wireshark
then start sniffing and analyze
broadcast packets and then we'll wrap
this all up with this week's giveaway
but first let's take a quick break
mid phase is offering hack tip viewers
web hosting with unlimited disk in
bandwidth 24/7 support free web builders
simple CMS installs in a hundred dollars
worth of search engine credits from
yahoo and google get six months of free
hosting at midphase com slash hack five
all right we have our fake AP up with
the SSID of hack tip so let's go ahead
and copy the bssid into our clipboard
and that's right here select that and
control insert to copy that guy okay now
we're going to go ahead and start up
wireshark so in another tab here in a
run and Wireshark with an ampersand so
that that just runs in the background
there alright and we're going to go
ahead and select the mon0 interface so
capture and then interfaces and I see
Mon zero here we've got some package so
let's go ahead and start alright we've
already captured a few packets so let's
stop I only need it just a second of
this right so let's go ahead and apply a
couple of filters to make this a little
bit easier to look at now to add filters
just come up here to the filter area in
the top left and go ahead and enter your
expression now in this case I only want
to see frames to or from our bssid
our hack point access point so or a hack
tip access point anyway for that what
we're going to do is say W LAN
dot addr equals and then shift insert to
paste my bssid there okay right now I'm
also only interested in beacon frames so
let's go ahead and add a little bit here
to the well put two ampersands to say
and
regular expression here and we're just
gonna say w LAN FC type underscore
subtype it already completes that for me
it's bit tab accidently sub type and
then we want that to be zero X zero
eight and I'm coming to play here in
just a second alright it filtered not a
whole lot different but basically the
only thing we're looking at now our
beacon frames from that bssid so if we
open up the first one here we can see
let's see open this guy up let's just
make him a little bit bigger so we can
get all into this alright we have
everything expanded so let's bring this
down just a bit alright so we can see
right off the top top that it is subtype
zero X zero eight or otherwise known as
a beacon frame and that it is set to the
destination address of broadcast or FF :
FF : f of corn etc right that's meaning
that's being sent out for everyone to
hear and you know we have our source
address we have our sequence number yr
shotgun also knows that it's a wireless
management frame it could filter it by
that so we can see under here wireless
management frame through this guy and
expand that we can see we have our fixed
parameters and tagged parameters and
within here we will find a whole bunch
of capability information so for example
under the fixed parameters we can see
capability information and I don't know
for example we say it doesn't support
WEP we don't have the TAC W option set
so no WEP there it also doesn't support
OFDM to remember from previous hack tips
on this subject now let's go ahead and
go into our tag parameter we can see the
SSID is set it is set to hack tip we see
supported data rates of one to five and
a half 11 as well as extended ones
including 6 9 12 18 24 36 48 and 54 yes
those are in fact your lucky lotto
numbers indicating that this is in fact
an a2 2 dot 11g wireless network of
course down here at the bottom current
channel is 11 so these are the kinds of
things that you would find inside of a
beacon frame it's necessary for an
access point to advertise itself to the
world and say hey
come connect to me now in next week
we're gonna go even further into this
and break down the process by which
stations connect using this same kind of
setup but now it's time for the giveaway
last time I asked what movie does the
tool MDK 3 get its name from and the
answer is demolition man with murder
death kill and this week what I'd like
to know was what was Wireshark known as
before May of 2006 go ahead and answer
in the comments to be randomly selected
to go ahead and win the radio that I use
here on active right now as always of
course we value your feedback and we
love your suggestions so if you have a
tip to share to me or if you just like
to let us know what you'd like to see
here on the show next email tips at hack
5 dorg or just leave a little love in
the comments and be sure to check out
our sister show hack 5 for more great
stuff just like this I'll be there
reminding you trust your techno list
Armel wireless access point no.1 the
words access port armor wireless or to
explore no wider search is porn</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>