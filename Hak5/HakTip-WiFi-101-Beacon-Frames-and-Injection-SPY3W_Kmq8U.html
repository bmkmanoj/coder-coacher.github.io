<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>HakTip - WiFi 101: Beacon Frames and Injection | Coder Coacher - Coaching Coders</title><meta content="HakTip - WiFi 101: Beacon Frames and Injection - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>HakTip - WiFi 101: Beacon Frames and Injection</b></h2><h5 class="post__date">2011-07-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/SPY3W_Kmq8U" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this hack tip is brought to you by
Squarespace
welcome to act chip the show where we
break down the concepts tools and
techniques for hackers gurus in IT
ninjas I'm your host Aaron kitchen and
today we're following up on our
discussion of 802 11 frames with an
investigation of beacons and a practical
example of using backtrack linux and a
technique known as raw frame injection
as you recall from last time the beacon
frame is just one of the four types of
management frames the other three being
association authentication and probes
and we're going to be getting into those
more shortly but now the beacon frame is
kind of a special kind of management
frame in that it contains information
about the network which brings us to the
terms beacon frames or simply beacons
are transmitted periodically by base
stations or access points to announce
the presence of wireless networks and
the beacon frame is made up of several
parts including whether or not the
station is an ad hoc or infrastructure
mode which we also know to be known as
managed mode the SSID name and will
going to be getting into service sets of
802 dot 11 networks more but for right
now SSID is a 32 character definitely
human readable string that uniquely
identifies the network it also contains
the time stamp which is quite simply a
unit of time by which all of the
associated stations will go ahead and
synchronize - it's kind of like the
scene in the movie while the spies
synchronize their watches except that it
happens in hex wink of an eye anyway it
also contains capability information
such as the channel that the access
point is operating on as well as the
supported data rates of its 1154
whatever that may be as well as uh you
know typically these access points they
they broadcast their beacons usually
every 10 seconds which kind of add quite
a bit of overhead so to improve network
performance on networks where there's
not a whole lot of clients connecting
and disconnecting - like a home network
often this setting is changed to be much
higher value now in just a bit we're
going to be putting together a practical
example in backtrack Linux but first
let's take
a quick break Squarespace is the fats is
an easiest way to create a high quality
website they offer 24/7 support over 60
professionally designed templates and a
sweet iOS app check out Squarespace comm
for a two week free trial and get 10%
off when you sign up in July with coupon
code hak5 7 MDK 3 it's a tool that
exploits weaknesses in 802 11 protocols
and it's created by ASP J with the help
of the aircrack-ng team and their
libraries now MDK 3 can be found at page
roller eggs home page and it's also
built into the latest version of
backtrack from backtrack Linux org now
today we're using MDK 3 in our practical
example of transmitting and analyzing
beacon frames so to achieve this we'll
first need a card capable of raw frame
injection in order to test our card
whether it has those capabilities we're
going to use airplay which is part of
the aircrack-ng suite first I'm using my
trusty real tech 81 87 here now airplay
ng is a tool for injecting wireless
frames and can accomplish 10 basic Wi-Fi
attacks including D authentication fake
authentication fragmentation and so much
more and while we'll be getting more in
depth with that tool a little later on
right now we're just going to be
focusing on mode number 9 also known as
test mode of course before we can use
either airplay ng or MD k3 we're going
to need to bring up our interface here
in monitor mode and if you recall from a
previous episode the easiest way to do
that is to go ahead and issue the
command airmon-ng start and then our
interface name so airmon-ng start wlan0
is and there we go now our card has been
set to monitor mode and we actually have
the interface mon0 so we can proceed to
test our NIC issuing airplay ng tach 9
or TAC TAC test and our wireless
interface and in this case going to be
Monsey row we can test to see whether or
not our radio can handle raw frame
injections so airplay tach and G tach 9
Mon 0 and it's going ahead and trying
and there we go it says injection is
working our test is complete so now we
can actually go ahead and use
the MDK 3 tool which is capable of
performing many modes of tax issuing MDK
3 at command prompt is going to go ahead
and display a brief description of all
of them Scaramella to that again with
some more oh hey check that out
wonderful we could also do MBK 3 TAC TAC
full help to get a complete list of all
of the modes and all the details within
those modes that it supports but today
we're focusing on the beacon float
beacon flood mode so for more
information on any mode would type MDK 3
tactic help and then the letter
associated with that mode so for this
case it's going to be B there we go we
see all of the options here so now
finally we can craft our beacon flood
and we can see here that the options
tach F will read SSI GS from a text file
taxi will show that they're using the
802 dot 11g protocol at 54 megabits per
second Tech a will show them as having
WPA
enabled with the AES encryption and taxi
will specify the channel thankfully I
already have a text file full of SSID is
handy because I was just on tekzilla so
let's go ahead an issue nd k3 mon0 b tak
f SSID list and then tack g tack a and
we're going to put it on Jan 11 so taxi
11 now as you can see MDK 3 is
transmitting hundreds of beacons on
channel 1140 access points that I've
specified now we could verify that these
are actually wireless interfaces by
going ahead and scanning our nearby
networks with our other wireless
interface I'm going to go over here
because I have if config double and 0
have another wireless interface here to
use I'm going to do i w list W land 0
scan and pipe that to grow up and look
for ESS ID and there we go I have plenty
now similar to fuzzing this sort of
attack can sometimes break Wi-Fi
scanners or network interface devices
and with a specifically crafted SSID
list I'm sure you can come up with your
own sorts of fun or mischief now mind
you that all of these BSS IDs and MAC
addresses are kind of
randomly-generated so there's no chance
of anybody actually associating with
these base stations at least not now now
we're going to take another look at this
tool when we start to have fun with
something known as evil twins but for
now suffice it to say we've successfully
transmitted our own beacons now next
time we're going to catch one of these
bad boys and analyze the frame with
another fun tool but until then it's
time for the giveaway last week I asked
what numbered flag in airplay ng will
send a D authentication frame the answer
is tax zero or simply tack tack D off
this week what I'd like to know is from
what movie does the tool MDK 3 get its
name bonus we attended with the name is
anyway answer in the comments be
randomly selected to receive the radio
that I use here on hack tip and as
always we value your feedback and your
suggestions if you have a tip to share
with me go ahead an email tip to hak5
org and be sure to check out our sister
show hack 5 for more great stuff just
like this I'll be there reminding you to
trust your techno lest one of my duck</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>