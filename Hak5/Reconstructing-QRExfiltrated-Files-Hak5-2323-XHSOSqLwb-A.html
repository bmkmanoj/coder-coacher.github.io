<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Reconstructing QR-Exfiltrated Files - Hak5 2323 | Coder Coacher - Coaching Coders</title><meta content="Reconstructing QR-Exfiltrated Files - Hak5 2323 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Reconstructing QR-Exfiltrated Files - Hak5 2323</b></h2><h5 class="post__date">2018-02-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/XHSOSqLwb-A" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">we can optically exfiltrate or steal
files off of a computer with nothing
more than a cell phone and a camera but
how do we reassemble all that finding
out today
hello and welcome to hack 5 my name is
Gerren kitchen into your weekly dose of
Technol us I'm very excited because
today we are continuing a series that
started with this crazy idea of can we
exit rate files can we steal files off
of a computer without using storage or
network or Bluetooth or anything like
that just literally recording the screen
with our cell phone and we've so far
proven with the help of bgw a one of the
community members and hak5 that this is
indeed possible and what we're gonna do
now is take it to the next step and find
out ok well if we have a video file
containing a bunch of moving QR codes
how do we systematically decode those
and this is the beautiful thing about
these ideas in the collaboration with
you guys is because it is parati code
who has stepped up with an awesome
script here that i want to show off that
is going to automate this entire process
by the way if you were wondering why
we're doing this
this is hacking we're doing this because
we can so you can find that the QR data
Reconstructor over at product codes
github and it's really simple to install
basically get cloned this repository
i've already done that and all of the
setup is in a setup script file to make
things super simple for you to getting
those dependencies it's all python-based
so i have a copy of a right here if we
take a look i've got in queue our data
Reconstructor and if you just cat this
set up that sh you'll see all this is
really gonna do is a bunch of pseudo pip
install whatever those dependencies are
i do want to note one thing that i found
odd about my installation I'm using Kali
20 18.1 and I had to apt-get install
libs ebar dev in order to get the Z
baller pip install going otherwise
everything was really straightforward
and you can figure that the the usage
here is pretty simple basically we're
going to build on what we did last week
which if you don't remember is we're
gonna take say this file right here this
is our target file that we're gonna
exfiltrate and liberate off of our
target machine and we're going to turn
it into a bunch of QR codes using BG TAC
lwas awesome exfiltration tool here
which is all in JavaScript and then you
just choose your file and it create
all of those codes and then you go ahead
and hit play back and then boom you just
record that with your cell phone so now
we're gonna take all of this moving QR
codes and get them back into a file
after we've you know gone back to our
hacker lair or wherever you are so as
you can see here I've got my video it's
in an mp4 which is what you're going to
need and it looks pretty good if you do
pause it at like a certain moment you
will see that you'll get like kind of a
half QR code there you go between one
and the other and this is what I was
really worried about thankfully the rate
at which this is going there's enough
clear moments and the Python script
that's going to decode these is gonna be
able to handle and say like that's not a
valid QR code the one thing I will note
on the video however was that at least
personally on my experience with my
pixel to phone I had to boost the
contrast and the brightness in order to
get good results out of this tool so you
can see this is what it was originally
and this is it after basically just
punched up the game so now let's take
those 61 images and in that video file
we'll go ahead and reconstruct them so
all you have to do is Python and then
the decoder py which I have in the same
directory here with my video you say
your video file in my case is test dude
to mp4 and then whatever your output is
will say output dot txt now this is
going to take a while so well this is
crunching let's actually take a look at
what this script is doing so if I open
the decoder in G edit obviously we start
out with crazy cool ASCII graphics
because you should and otherwise
basically what this does is in this
while loop it loops over every single
frame in the video creating it into a
JPEG file here that jpg file is we've
got to figure out if it is a QR code and
if it is we go ahead and append it and
then we get a little bit here to make
sure that we do duplicate so if we see
the exact same QR code as before we're
gonna go ahead and throw it out no there
could I guess be an instance where I
mean this is just base 64 data over and
over and over in QR codes there could be
a collision where you end up with two QR
codes back-to-back and then one would
get thrown out wouldn't say it's perfect
but
I think it'd kind of be rare that that
would happen otherwise it just finishes
up by doing a little cleanup here I have
to take the rattling toy away from peach
right now she's being noisy also if
you're wondering why the lighting is a
little different in this episode it's
because peach here decided that she was
going to destroy that lamp over there so
now I need a new studio light what what
oh there we go there we go
obligatory puppy all right so our file
is done nope nope don't step on the
keyboard okay you're as bad as a cat so
it's done processing the video let's go
ahead and check out the output bye
I don't know more output dot txt you'll
see we've got base64 encoded goodness
and it should be the exact same basic C
for if I were to just base64 peach JPEG
now I could diff this you will notice
that it does have the header that we
need to go ahead and view this as a JPEG
and actually what's really nice is yeah
I get it it's still base64 but what's
beautiful about this is it builds on
like the data schema that we were
talking about weeks past which means if
I just open this txt file here you'll
see that it begins with data : image
JPEG base64 encoding which means I can
now just copy all of that come back over
to Firefox and just in the URL bar you
can just paste that in and I have the
file that is just so cool so I have to
give mad props to be GWA and Peres code
because this is just so cool to see the
community come together creating this
proof-of-concept even better and better
and better so both of those guys get
$200 hak5 gift cards and if you have a
payload of your own to submit it's hak5
org slash payload also we should be
moving into our new studio here real
soon so I can't wait to get out of my
living room it should be exciting all
right with that I'm Darren kitchen and
for peach were reminding you trust your
techno lust no right no we'll make it
your Linux box
domain.com has all your website needs
from command dotnet domains to intuitive
website builders so you can take that
first step in creating an online
identity let me tell you there's no
domain extension like a.com or.net or if
you want to brand yourself domain com
has over 300 domain extensions like Doc
Club and dot space these guys are huge
fans of hack 5 they're affordable
reliable we've been using them for years
they've got all the tools you need to
share your ideas with the world and
because they're such big fans they are
hooking you up with 15% off they're
already affordable prices so get domain
names and web hosting and email and just
be sure to use that coupon code hak5 so
when you think domain names think
domain.com</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>