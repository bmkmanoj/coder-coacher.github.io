<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hak5 - Extreme Android and Google Auth Hacking with Kos, 1205.2 | Coder Coacher - Coaching Coders</title><meta content="Hak5 - Extreme Android and Google Auth Hacking with Kos, 1205.2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hak5 - Extreme Android and Google Auth Hacking with Kos, 1205.2</b></h2><h5 class="post__date">2012-09-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/OmDwl50usZg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this segment of hak5 is brought to you
by ting I don't know about you guys but
I feel pretty secure knowing that I have
a one-time password with my Google
Account that was at least until cause
entered the studio cause what's up man
hey all right so now we've got our
eight-hour p2p abb that we can use to
connect our our Android phone to another
Android phone or tablet we've talked
about stealing you know databases now
it's time to get to the good stuff and
actually steal the Google authentication
yeah how does that work so when you have
the Nikkei on your phone to Google a
request is sent out to the Android
service on Google comm so it passes your
username and password that act service
actually passes back a just a token it
just passes back some token very long
you can't really brute force it or
anything it's just that token is
basically a representation of your
password kind of like a Windows machine
would have on an Active Directory
network exactly so we've got that but
the thing is when you're root that token
is easily accessible and good thing for
us is that we know what P to be a DB
it's very easy to script this into the
application for me to just go in and
automatically grab it and then generate
pull down that token and then with that
token there's another request that's
made to create a single sign-on larger
token that'll automatically sign-on you
on and if they can't authenticate you to
Google without prompting you so is this
kind of a synonymous with like a cookie
in that if I steal this file in slash
data / whatever secret you know
permission place it is on the phone
which we have access to with brie right
and I just put that on my phone is that
what you're saying like clone the phone
that way or you can go around and doing
that it's actually more powerful than
just a cookie because it is basically
your password you can use it to reify
taint reoffended over and over again it
doesn't go bad and tell you change your
password or if it's application specific
password it doesn't go bad until you
revoke that token and it works out
pretty well so even if you're using a
the Google's two-factor authentication
mechanism and you are able to pull that
token off my phone you've got access to
my Google account without needing to
know my password so or to have my Google
Authenticator app yes actually that's so
because you're using an
application-specific password when you
use Google's two-factor you're not
actually prompted with ever hitting in
your two-factor right you you could
authenticate once you do your two-factor
you go and you create an application
specific path so which is like 16 byte
long password that they generate for you
you put that into your phone and you
never have to re-authenticate you're
right I can't I can't remember the last
time I had to log into my Google account
on my Android phone because it's my kid
this is my Google exactly my Google
exactly and in fact it's the other way
around I use my Android phone to
authenticate my computer to the two
other Google services with the the
two-factor either the Google auth app so
in a sense this is the trusted device
exactly so you can actually test this
out on your device if you open up your
web browser on your device alright you
go to google.com or gmail.com rather
sure I'll do that so I'm gonna head over
in Chrome right yeah Gmail come on stop
trying to load the page in the
background Gmail calm
there we go yeah and what do we get
so right now either it'll be logged in
already or it's gonna prompt you there
you go okay so it's logged in already
I've been already so if you log out real
quick and you get back to the account
login page there's going to be a
drop-down that says you want to log in
with this account and if you hit sign in
you basically bypass having to put your
username and password into that into
that that area because it has the token
already it can't handle everything on in
the framework above Chrome so it passes
that token to Google Google passes back
a single sign-on URL your browser goes
to that single sign-in URL and you just
bypassed up indication so you're saying
that there's a single URL that is my
Google token there's a token that you
submit to a URL and yeah passes back
another token and that's your single
sign-on yes yes it is single sign-on so
as soon as you use it it's invalidated
as soon as a new one is generated the
old one is invalid so if you steal my
phone and steal my token you run over to
your computer all I have to do is change
my password right so the fun thing is
that with that token you can actually
change their password before they get a
chance really yes and if you're using an
applicator if you're using two-factor
means you have application-specific
passwords I can just add a new password
and you know I'll make it something
generic all they like like clone would
phone Chrome or Google TV if you look at
my application specific passwords it
just says chrome chrome chrome chrome
chrome chrome by the like chrome team
you want to start using two-factor
that'd be great so actually we have it
right here so you see the okay actually
do you want to sign on so it says how
well you can get that Paul but but there
you can kind of see there's the the
regular login page yellow bar right
there yeah and if we hit sign on a sign
in it just bypasses it and drops you in
- all in this case it's going to be my
dashboard right here there you go and it
logged me in without prompting me this
is because the token is already on the
phone right it's the
no reason to well it's also you know
let's not inconvenience some users here
because then they might consider going
to the other brand of smartphone right
and then everything uses that token your
Gmail account gchat when you your
browser hooks into it you can't really
get around not having that token or
requiring a second means of all data
cable so let's see what it looks like on
the computer alright so right here I
have a adb or a p2p adb running just the
regular stuff check it through grab data
so if you check his route I am running
his route so the good one right here is
stealing Google accounts so if I go and
hit number five it's going to prompt me
system accounts sixty eight bytes you
want to grab it yes all right it's
stored it under this folder so I haven't
jacked that all right nobody I love it I
love it jacked it man so I have another
shell script it's not completely
integrated into eight PDP adb because it
I don't think it really makes sense to
so generate Google off and all that does
is just a little shell script sends it
to curl request to this folder or I'm
sorry to this to this URL mm-hmm so if
we go ahead and run SH generate off
jacked it's gonna automatically unpack
it and that URL right there that is a
very sensitive you are okay so we can
see here we're in let's let's go back to
that browser does so we're at the Google
Apps login page we're not signed in as
anything nope but we've got this token
from your phone we've generated that URL
from it right I'm going to demonstrate
real quick alright it's going to prompt
me to login it's going to prompt me to
put in my two-factor off so we'll go
ahead and delete all data real quick
there so I'm logged out but I have this
token right here I'm going to go ahead
and paste that in the URL hit enter and
it's automatically locked man there you
go dude I love it
so this it's like it's even better than
cookie jacking its oaken Jack I'm so
fantastic so the nice thing about this
is all as a plus for a user to get this
easily you have to be rooted and have a
DVI have to be able to grab that file
which is protected by the root user
however an alternative to getting this
token is going through the Google
browser or the browser like we just did
and doing the sign-on that's sending
just an HTTP POST request through the
browser now if you decide that somehow
you want to intercept that with maybe a
man-in-the-middle or an HTTP proxy with
your own CA certificate installed you
can still grab that token without having
your phone routed how would you get the
proxy or the VPN and your CA certificate
on the phone I mean I mean with the p2p
80 days if I have a PDP ADB and I have
ADB maybe I'll just expand anti guard a
little bit to automatically configure so
you're talking about future oh yeah
add-ons there the ability to proxy
everybody through thing and then just do
a mini little even right now if for
whatever reason you happen to come
across a device and you so say this is
your device and you're gone for a few
hours I can play with it maybe you have
it unlocked maybe you have this if it's
not rooted if it doesn't have ADB if I
have access to it I can still go through
and still take your token off the device
when you regularly cannot do that
there's no interface to go in and take
the token it's protected by root but by
installing your own CA certificate and
then man in the middling the
communication between the device and
Google servers you actually get the
exact token pulled from the sequel like
database being pulled sent to the
servers so without root you can still
get access to that token and once you've
got that as you've shown right here so
you're logged in now what is this slide
because I you know say like I've got
some suspicion that I've been owned I'm
gonna go and change my Google account
password immediately okay so in this
instance this is this now a race you
know victim versus how it can be and
there's no reason that you can't
automate this either on my side of
things
I love automation right since I'm right
here you've got access to my regular
stuff so we can go over to security so
there are a few things I want to step
into right here the first one is my
favorite 2-step verification and
authorized applications and sites edit
Oh see it kicks me out after a while but
I can just go ahead and generate a new
token and you're back in security
authorized sites there we go so there is
some time out there but by generating a
new token andrea fennek ating it allows
you to react cess it that's wicked so
here you have my connected apps and
sites set etcetera scroll down as a lot
by the way Wow yeah yeah so now you have
all of my all your Google TV's Google TV
Google then you know these are just ones
that I have forgotten to revoke because
I mess around with this so much Galaxy
Nexus the Nexus 7 wallet because every
when you sign up with Google you have or
a Google Wallet you have to re and put
an application-specific password to get
the wallet working ninja telephone GSM
Galaxy Nexus so I have a ton there
obviously well I can just go ahead and
add another and we'll you know call it
something benign printer yeah cloud
print cool and nobody would want to lose
their Google Cloud Print now you this is
as good as a password yeah that right
there this this is a password to my
account right now this all you have to
do is take that you hear that folks
log in my goodness causes account using
that all you want to revoke that yes all
you got to do is take that token and
then you'll just I don't actually have
the packet capture set up to do it but
all you have to do is regenerate a new
token and you can basically just
continually run the command but generate
off and just use that constantly what
about changing their password so it's
changing their password when you revoke
real quick yeah you don't want to forget
to revoke the cloud password so so in
changing their password so if you go to
password change it's going to ask you
for your current password and that's
something I don't know the password
you're right I know that's the whole
point is we got the token I don't know
their password current password or what
was the name of your first teacher Oh
miss Flynn oh this is my account so
that's not going to work but but that's
the option I can give my current
password or my security question Oh
but you don't know okay well then that's
just another discussion about social
engineering using things like melty good
coal networks I also have access to the
account Recovery Options which it kicked
me out again
temporarily regenerate so regenerate go
to security account Recovery Options BAM
okay and so what are these these are oh
just in case your account gets
completely locked out here's how we send
you a token yeah so this is specifically
the part that I like talks there's the
name of your first teacher um a password
your write your own question yep
have you been owned that right your yes
question yep so yes that your account
information has been updated oh my gosh
and so now all we do is go to change
your password have you been owned yeah
yes new password new use yeah so oh
there was a problem service is
temporarily unavailable which could be
an issue by Drew generating oh by by
changing the password yes I a off bad
authentication I can no longer use that
token because I've changed the password
oops yep so we'll try to login hopefully
I can remember what I just put or we
know that we've changed the secret
question true so let's try you don't
know my password oh because I have it
set up through the Google Apps stuff
there are some other security measures
there because I have an administrator
for the domain cause that I oh it's oh
so you're using Google Google Apps for
your own domain rather than using it at
gmail account right okay I should have
done that with the Gmail account but the
the idea is solid that will work against
other Gmail accounts it'll allow you to
change it and reopen a key so I mean at
this point though as soon as you get
that token it's just a race between the
user realizing they've been owned and
you you know automating these ownage and
in reality I don't really want to change
the user's password it just it just lets
them know if I get your phone and you
don't realize you don't know that I have
your token there's really no reason for
you to freak out and change your
password but if you change if you notice
your password has changed you're gonna
go in and then you're gonna start going
through stuff and start changing
everything and that's kind of what I
want to avoid yeah I mean what you
ultimately want is another password into
their account exactly and that's why the
application specific password is so
powerful because I can just drink
generate more passwords and more tokens
I can maybe trick you you get no
notification that's like it's like
creating another administrator user
account on exactly the love that is no
notification that a new application
specific password has been created so
I'll just create something hope you
don't notice
okay deployment scenarios right I know
that you've got some crazy ideas of how
you might be able to actually Jack some
phones quickly I'm using p2p adb you
brought some toys what are we talking
about here yeah so right here let's see
so the first idea is to just take a cell
phone yeah so just take a regular cell
phone and toss it into maybe some bigger
case or camouflage it that's something
that you know you would trick someone to
plug into or maybe you just want to go
like hey let's transfer some files it's
really fast over USB but that's not very
convincing so you take a cell phone you
stick it in like a project box and this
little black box stick an energizer
stamp over it or something and make it
look like a charger throw one of these
in there and plug that all up and then
suddenly you have a little charge pack
that's going to own your phone
plug it in but these are kind of big so
kind of the Galaxy Nexus is a little big
a little expensive yeah and a little
expensive for something like that so
we've got something a little smaller
this is the HTC One V this is actually
the ninja telephone that was at DEFCON
do for your shady tell sim and the ninja
telephone yes
actually I have it in there still so it
is a bit smaller and it works and there
are smaller phones but I want to
actually go much smaller so this is the
Android NK 802 this is a full-fledged
Android device a lot of buzz right now
in fact I think we just got in the hack
shop it's got a gig of ram in there it's
got four gigs of memory it's got SD card
slot it's got a host USB mode natively
on there so you don't even need an OTG
cable just that USB port right there
I'll do it runs over it can be powered
over USB so it can be powered over one
of these little things right here
pineapple juice
oh yeah and if you notice it's it's not
much taller yeah it's about as thick so
maybe you find something that's a little
bit bigger than this and you you rip out
maybe one of the cells that and make it
fit and you're set so yeah the beautiful
thing about this is that it is so small
it'll fit in anywhere you can put it
into a battery pack and similarly oh hey
you need to charge your phone go and
plug it in you know what I love and this
gets me thinking especially these
embedded devices yeah you know we love
open wrt kind of embedded devices and
kind of playing with ADB on that have
you ever been to the Oakland Airport
I know specifically the Oakland Airport
has this or there's these really big
comfy couches yeah reading the waiting
area and in the arms they have to AC
Jack's and two USB Jack's right and it's
in a wall panel that has it's a metal
wall panel with the two USB Jack's and
two flathead screws okay you've got the
belt you've got the overalls you got the
whatever you just unscrew that and you
know it's just there's just an AC with a
with one of those little yeah it's it's
like one of these behind ya right and
you just put your guy in line or
whatever you use this to power your own
device that will thus power their phone
and own it right so juice jacking was
developed by a friend named lei he does
a lot of work with Riverside they do the
wall of sheep over at Def Con
and if you've been to Def Con in the
past two years or to work on last year
they actually brought their little box
that's dressed up like a charging
station where you can plug your phone
into it and they had some pretty benign
stuff you plug your phone in and they
would just pull off the hardware ID and
display it on a screen there just mess
with you yeah so I thought this
complemented that really well I just
thought oh wow like that's cool idea and
then I have this portable idea well why
don't we just mix them all together yeah
and now we have a complete weed you know
on your device via a charging station
you know what I really love is I was
actually just at cincy Tech and the
airport in Washington and they have
those charging stations we put a couple
of dollars in and charger you could be
paying to get owned that okay so where
can people if they're brainstorming at
home coming up with these brilliant
ideas they want to collaborate they want
to start working on the p2p ABB
framework adding some modules and things
like that
what can they go to get started so my
website is cause I oh so that's kos dot
IO okay I have my email there's a blog
that's linked from there I there's links
to github up there that you can find all
my work at you can reach me anywhere I'm
on I'm on the Twitter's as at the cause
th e kos just hit me up nice dude this
is so exciting I can't wait to check in
on the project and few months see how
it's doing really appreciate you come
down to the studio alright now I'm gonna
go encrypt my phone no no that's yes
probably
I disabled a TV oh yeah oh hey look
I've been going off lately about how
much I loved hang and for very good
reason this is actually my own personal
set up with ting I love the 3G modems
they use them with Wi-Fi pineapple it's
so much fun
it has rocked it's been solid
performance and I'm really happy because
a lot of you guys have already checked
out their awesome customer first
approach to the cell market they are on
godsend and
if you haven't already heard about ting
check this out it's new service that
brings clarity usability and big savings
to mobile phone users see ting offers
one very simple plan honest pricing
megabytes minutes text messages each of
those billed separately so you don't
have to think about if you're going to
go over and pay ridiculous fees you just
pay for what you use no BS check it out
at ting calm slash hack five and they've
got an online savings calculator there
so go ahead and get started if you're
going to as a hack 5 viewer you'll get
$75 off your first month of service just
for being awesome act 5 viewer so just
head over to ting comm slash hack 5 the
coupon will be activated right away it's
just that simple with ting</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>