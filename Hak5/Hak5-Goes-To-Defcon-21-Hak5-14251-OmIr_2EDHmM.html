<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hak5 Goes To Defcon 21, Hak5 1425.1 | Coder Coacher - Coaching Coders</title><meta content="Hak5 Goes To Defcon 21, Hak5 1425.1 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hak5 Goes To Defcon 21, Hak5 1425.1</b></h2><h5 class="post__date">2013-08-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/OmIr_2EDHmM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this time at a very special hat fun
defcon 21 this segment of pack 5 is
brought to you by domain.com coming to
you from defcon 21 i'm darren kitchen
here with Sean Malone Sean how are you
I'm doing great it's another great year
here so you're here with Fusion X
talking about hivemind walk me thru high
of mine what's the general overview so
the problem that we're trying to solve
is sometimes you have sensitive data
that you want to store you need a way to
store it reliably but you need to make
sure it doesn't fall into the wrong
hands and that sensitive data you might
say well let's just encrypt it but as
we've seen from various cases in the
news a court order or a five dollar
wrench can be enough to force you to
decrypt that data so what we want to do
is store it in a way such that if your
servers sees the data is simply not
there and so how do you get the data on
the server you just put it on another
server right i mean data has to live
somewhere right it definitely has to
live somewhere so at first you might say
well let's just write on somebody else's
system and the problem is it usually
that's illegal it's nice to be able to
do this in a way that's at least mostly
legal so we do that through the use of a
JavaScript botnet so this is a botnet
where the nodes in the botnet are
actually web browsers so you take
control of a browser through the use of
javascript via any number of different
techniques such as anonymous proxy
servers that modify the traffic as it
passes through sites that you control
persistent cross-site scripting any of
these ways will let us actually take
control of a node and add it to the
botnet and then we use that to build a
distributed file system on top of that
JavaScript botnet okay so it's not your
traditional botnet where it's like I
just pwned your machine i'm going to do
a command and control over IRC or
something it's you just visited my
website and since you're running a
modern browser that supports html5 and
java and all javascript and all of those
things you're not even pushing like like
a payload to them it's just some natural
behavior that's absolutely right that's
the real beauty of this setup is that
we're exploiting features not bugs
there's nothing here to patch this is
all part of like you mentioned the H
five features we take advantage of
particularly web storage for storing the
data and web sockets in order to
establish that persistent command and
control channel and these features there
are many legitimate uses but they could
have been written for botnets that's how
applicable they are to exactly what we
need to do for command and control and
data storage so because these are
features and not bugs there's nothing to
patch and removing these features would
break a lot of legitimate web
applications so give me an idea of how
this feature is used in legitimate web
applications so for it for web storage
you may have preferences that an
anonymous user so you don't have a
back-end where they've logged in with
the username and password so you're not
storing anything on the back end but you
still want the user to be able to set
some preferences when they set those
preferences the configuration based on
those preferences would likely be stored
in local storage on the browser so when
the user then goes back to the site the
data is the configuration preferences
it's pulled out of local storage and use
to configure the site on the fly there
so that would be a legitimate use for
the local storage that is very different
than you know before the the new web
before html5 and all of that everybody
just used cookies right right right I
local storage is sort of cookies on
steroids more data some interesting
features I is basically a standard key
value data store now but the
specification says that users may want
to store where applications may want to
store up to megabytes of user data
megabytes right megabytes and I look at
that and I say if the browser is willing
to store megabytes of application data
why not I use that to put megabytes of
my own data in there through this
JavaScript botnet so what you're saying
is so give me an idea of the megabytes
of different browsers modern browsers
will store for you so it's usually five
megabytes on most browsers so your your
storage per node is going to be limited
to roughly five megabytes but imagine
putting a hidden iframe in a popular
site via a persistent cross-site
scripting attack for example all of a
sudden you've got a million different
nodes that are all connecting to the
site I and each each node then has five
megabytes that's a very large amount of
data storage there so walk me through
this if
a I have a quarter million people unique
a month going to hack five orga site I
already control how do i set this up and
what kind of what kind of storage
capabilities would that give me so the
key feature here is that it's not so
much total per month but total online at
any given time because this is an
extremely transient botnet so it really
has to be concurrent connection right it
needs to be concurrent because as soon
as the user navigates away from the site
you lose that command and control
channel and you can no longer retrieve
that data what why is it so the five
megs that they're holding is only only
for me you know I can only communicate
with them while they're on their website
what about when they leave and come back
later so they may come back online they
may present that data as still there but
you may not want that you may want to
have a piece of JavaScript so that right
when they're leaving the site it
actually wipes that just for additional
security but because of that very
transient nature hivemind does have the
capability and it's sort of one of the
key features there to do a constant
heartbeat on all of the nodes and so
when a node drops off line that contains
a particular file block it quickly
replicates that to new nodes so when you
and first do that initial upload you may
distribute across ten different nodes
and that heartbeat says when it drops
down below five nodes containing the
same block then you replicate across in
New 10 so as long as you have enough
people who are visiting the site even
when those people go offline the data
continues to persist since it's very
quickly being replicated to the active
nodes so if I was trying to securely
hide 100 megabytes of stuff i would need
at least 10 people on my website at any
or 20 people on my website and any given
time and oh really i would want more
because they need to be able to
replicate and they can only replicate
they can't replicate with each other
right correct it all has to go through
the server so the server is going to be
your single point of failure there which
is something that you absolutely want in
this case so the reason that you want
that is if and when that server is ever
seized then the nodes can no longer talk
to the server and the block replication
fails those blocks become unrecoverable
and you can no longer rebuild the file
from the blocks and be able to download
it so there's very little data that
actually persists on the server you
think of the server as a phone book for
the data but it doesn't actually have
the file data itself that's all out on
the news that's amazing the data is just
out at sea you seize the server and
suddenly the data no longer exists so at
for any forensics investigator how okay
now okay let's play white hat here I'm a
forensics investigator I'm targeting you
because you're using this cool hivemind
stuff and I don't know maybe there's
something interesting in there I want to
see can I just go to your website 20
times and get it so there would be three
different ways that this could be I've
defeated the first is like you mentioned
putting your own nodes in the botnet I
if you hit a certain critical mass a
certain critical percentage and log all
of those blocks you are going to be able
to rebuild that file later so we do have
an encryption layer as well so you'd
have to get all of the blocks and get
that key as I mentioned earlier there's
some limits to how useful encryption can
be in certain cases but it's there is an
extra step the other two ways first
would be if you actually compromised the
server itself so compromised the server
while its online log that block data as
it goes through or logged the file after
it's been compiled and decrypted but
before it's downloaded so you could
intercept the file there but it requires
compromising the server wallets online
and the final method would be to simply
go out and sees all of the nodes based
on isp logs but you're talking about
seizing thousands or millions of private
computers at that point and you've
increased the complexity by at least an
order of magnitude good luck man i love
this in the game of cat and mouse this
is a really interesting mouse or cat
depends on the way you look at it right
right and the data recovery is always
going to be theoretically possible the
idea here is to make it as difficult as
possible it's obfuscation but it's
really interesting because it's
ephemeral and it's never on your machine
uh it's only on machine temporarily it
has to go through the central server
initially since that is the single point
but that's is one block at a time right
right it's usually one block at a time
I'm the only exception is when you
initially store the file and then when
you pull it back down that is so great
so you could potentially lose your data
so I'm trying to think of a use case
here for this but I'm sure people can
come up with something in true
sing is there any way to allow say the
clients that are nodes on this this
network this botnet of storage to also
have access to that file with or that I
guess they all have to go through the
central storage so it's not like not
like you use this for file sharing
Network so you could use this for a
file-sharing Network and the way that
would work is you instead of allowing
the nodes only access to store and send
blocks back to the server you also allow
them to access more of that management
ur face where they can upload their own
file and so at that point you can you
can look at this as a cooperative
distributed file system where I add my
browser you add your browser and when I
upload a file or you upload a file it's
broken into blocks and it's stored
across both of our browsers so we all
keep different pieces and so long as
this replication occurs that data is
going to be accessible but if any one of
our systems get seized the data is not
actually going to be there on that
system which is what you want right and
it's not going to be on the server
either so you can seize my system you
can seize the server that you see I'm
connected to but you actually have to
seize a certain critical mass of all of
these other nodes as well since it's
very distributed if only there were a
system that men in the middle attacked
every note on the internet and stored it
in Utah haha so and we actually use on
one of the we use a version of that in
order to build the botnet we use an open
anonymous proxy server stand it up out
there on the internet we don't even need
to advertise it it gets hit the last
metric that I saw when I logged in there
was that unsolicited it's getting hit
with 20,000 unique IPS in 10 minutes and
so what we do is simply modify the
traffic that goes through there and say
replace the ending body tag with a
hidden i frame and then the body tag and
that iframe adds that node to the botnet
so it's like oh you're looking for
facebook well here's facebook and a
little something extra just for you
absolutely and it's it's interesting
from a legal perspective as well because
since it was completely unsolicited
we're not asking you to connect to the
server we're not promising anything
about what we're going to provide here
you're choosing to send data through
this proxy server and we're providing
whatever we want it happens to look
similar to the data that you
requesting from my private server but
it's my private server and I can provide
whatever I want in addition to that oh
man I want to put this on the pineapple
okay so the so speaking of the
interesting legal thing is considering
this is just a feature of html5 it
doesn't even prompt you and say this
website wants to add 5 megabytes your
hard drive would you like that it only
prompts see if you go below or sorry if
you go above that initial limit so long
as you stay below the default limit
there's no prompt at all it's entirely
in the background does this and I'm not
sure if this has been patched but last
year there was a lot of talk about at
what was it fill my hard drive calm had
set up a bunch of subdomains it was like
one fill my hard drive calm to fill my
harddrive calm you'd go to that and it
would give you five megabytes five
megabytes five megabytes until it's blue
in the face and your disk is no longer
spinning could you use that kind of to
your advantage to increase the space you
can absolutely use that sort of attack
or any other bug that's identified in
the future that allows you to use
multiple domains or even on that so that
one was multiple subdomains you could do
the same thing here with multiple
domains because that that's a feature at
that point where you want each domain to
have their own partition that's not
dependent on how full other sites
storages so if you register 100 domains
and you're using all those domains for
this botnet all of a sudden you've
increased that per per node storage from
five megabytes to 500 megabytes okay so
how do I start using this on like say
hak5 or what do I need to download what
do I need to run to I don't know start
putting out the darknet stuff on there
so i am going to be releasing the source
code for hivemind it is basically a ruby
on rails application with a combination
my sequel and Redis back end it's got
the main application there as well as
the the socket that accepts that the
incoming websockets so it's very easy to
spin up on your own server i use ubuntu
server but you could run this on
anything that supports Ruby on Rails the
code is going to be released on github
the easiest way to find it is simply
through my personal website where i'll
be linking to the code and i'll have the
slides from my presentation that i'm
giving tomorrow up there as well and
that personal site is ww shanti malone
com that's Sen
mal o n e.com Sean debt is fascinating i
love this stuff thank you so much for
spending some time with us here on hak5
really appreciate it and best of luck to
you and your distributed distributed pot
net file system that's fantastic all
right thank you very much I want to take
a quick moment to tell you guys about
the dotnet this thing is globally known
it's one of the most popular top-level
domains and it instantly injects
credibility into whatever your project
may be so if you already have a dot-com
go ahead and protect your brand by
getting that dotnet to go along with it
we did that for hack across America did
that on Darren kitchen and listen if you
want to register a domain and you don't
want to have to get some insanely long
calm because which one's already taking
that dot net is a great alternative and
get this they're just 89 a year over at
domain.com but get this we had the
special hook up because domain com are
huge hak5 fans they're fans of you guys
so they're getting you fifteen percent
off their already affordable domain
names and web hosting all you have to do
is use the coupon code hak5 at domain
coms check out that's fifteen percent
off and big savings 20 don't forget to
use that coupon code hak5 when you think
domain names think domain.com</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>