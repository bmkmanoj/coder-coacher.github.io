<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Peeking In On The Whole Internets VNC Servers, Hak5 1512.2 | Coder Coacher - Coaching Coders</title><meta content="Peeking In On The Whole Internets VNC Servers, Hak5 1512.2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Peeking In On The Whole Internets VNC Servers, Hak5 1512.2</b></h2><h5 class="post__date">2013-11-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/KoCukHmaD1w" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this segment of hak5 is brought to you
by go to assist is if your hope at this
point be able to like push it over an
apk and executed or what are you trying
to achieve at that point so originally
we were looking for local privileges so
there have been a number of local
privilege escalation acts like a memo
dipper and a bunch of absurd rush a
bunch of exploits for android get rooms
originally yeah we were trying to push
over these binaries to execute them on
machine that's where i was having the
issue in Syria where every once in a
while it would just be like nope I don't
want to take any more bites from you
like I don't like your bikes they're not
good here so I spent a lot of time to
shine if you're out of school by like
four kilobytes of data maybe for like a
serial person that's a lot of data would
be that's like you could be could face
64th and I see that I need one I had the
hardest time with that so eventually I
got like that's when I started just ella
saying / thin and I started going
through every single command that was
specific to Android I found a really
neat command which lets you interact
with the content you arriving within
Android the content URI basically hosts
a bunch of resources that in some cases
you can access some across applications
they reveal a google they reveal more
than just simple like databases i think
they have other resources like images to
other thinking of you but in this
instance we were attacked we wanted to
be able to figure out how to reenable a
needy or you get a shell of homes or
something so it turns out that there is
a shell user you still have permission
to modify the see the light database for
the settings settings manager
Angela which includes me so even though
he is disabled and you don't have a
college account you can still enable BB
that enable a DB by pushing the settings
update yeah so basically I mean it's
almost literally sequel you kind of run
just run content URI content settings
global I forget exactly what it says
basically update value stream one where
value or what name equals Inc you
enabled and once you do that a TV
actually enables itself you can unplug
the serial port which in my experience
has been very lackluster for a lot of
things and when you plug in your regular
USB port and then you have a easy access
and you get to do a lot of fun stuff wow
that is an awesome like butta butta
there's that channel available I mean
obviously the manufacturers know that
this channel is available because they
probably use it for well said it's a
debug come to always replugging how does
the manufacturer go about doing this
because they're obviously not soldering
together a little red board what what is
it that you know is there commonality
among Spencer offenders and what kind of
test equipment to these there is a huge
commonality among lenders but we know
some vendors that have some kind of us
with tessa chance that they use like
this one the samsung anyway here it is
one example and so this is a device that
that's used either either by samsung
itself or by people who are joining
provisioning samsung devices from these
these kinds with their services and and
this actually has a whole bunch of
different options to as a little dip
switches droves and
lets you plug in for this long cable to
the USB port of the target device or
insert whatever connector that target
device as if it's you know it supports
all kinds of different phones and
tablets kind of things from the longer
war they started putting USB connectors
on phones right so you can get all kinds
of different interfaces for it and it
it's relatively easy to find on line 5
one of these things and it gives you a
lot of ways to control the amount of
flex functions and interact with these
boot loaders and you are that's
fantastic so this is commercially
available I'm assuming the red bored you
could make something very similar with a
regular TTL and resistor right
absolutely and this is I mean this
little bored here is just a couple of
breakout boards soldered together with
three pieces of wire and one resistor
how much would that be how much was that
easy I'm sure you had it in a bunch of
spare kids yeah exactly like the boss
bear pipe spare parts play around in my
lab but this like buying as new and
soldering it up I think the component
that these bits would cost something
like twenty five dollars and that's
actually like the more expensive way to
do it I mean they're the parts that are
on you break up words or even cheer now
lots of breakout boards themselves make
it really easy to assemble so you've got
the expensive tester you've got your
your homebrew hack solution what's
obvious next step here then well we want
to have a our own board that actually
does allows you to do you know more than
just with this one doesn't fix resistor
more like what that thing goes that's
highly configurable but we want to
complete software
and here in universe
different all the different target
devices we might need users to do matter
what manufacturer their mom or what kind
of port they have your physical Jack
that we're trying to plug into we want
to have kind of a universal tool that
can do automated probing for these types
of multiplexed interfaces and I have a
board in progress that I'm going to
showed a little bit last night but it's
not working in so that's a work in
progress and what is that board it's
called toad but totally over engineered
adapters left detector which is I just
want an excuse to call something toad we
could join codes are cool gosh something
ninja but uh and it it is the lead over
engineered like it was supposed to be
this little like a one-off square inch
thing and turned out to be something
with like over 300 components on it like
it's a it's about the size and
complexity of this guy which is not what
I was originally going for but if that's
what it takes to get to make it a to
universal as we want this is the ideas
it wouldn't be specific here in this
case to Samsung right exactly yeah we
want talking to region use to program in
any work on any or John goodbye maybe
you started playing with say the iphone
I haven't you I have a plan on horse on
the ago I mean I I know I hearsay is
that at least on the old iphone the
30-pin connector that there were a lot
of ports there that were actually used
for debugging a poor and you know and
iterative use of your iphones supposedly
there are magical cables that only
exists in apple's hands that you can
plug in and you can get more detailed
information or you can go this stuff so
theoretically i mean there could be
contest up there and we just we just
don't know how to access it yet I was
awesome this is all very exciting it's
really cool to see how like
there's multiple channels within each
layer it could pay according knology was
very good because that's what we're used
to online where can people find more
about what you're doing Mike in my
closet Great Scott Ganges calm down my
home base everything i'm working on
pretty much is there or week to come
there yeah goober two Toads haha rabbit
yeah only above and in particular
actually the toad project is based on a
very good fit and so that the schematic
and everything is actually really good
fostoria that's awesome alright and
cause what's in that beautiful san diego
i'm doing something right so where do we
love you i'm at a cause I 00 sdio or the
Kos thank you I know how it is working
in IT it means constantly jumping from
one problem to the next and everything
of course needs to be solved asked every
minute counts I mean you can't waste
your time juggling different tools and
duplicating data entry that's why I use
go to assist less copy and paste it's
from Citrix for the leader in remote
support and get this you'll have all the
tools you need in one nice little
integrated cloud-based platform so you
can work faster and more efficiently see
go to assist includes three different
support tools customized to your needs
well there's the service desk so you can
log incidents and track the resolution
there's go to assist monitoring to
proactively identify issues before they
become your boss calling you in a huge
headache and of course remote support to
provide live and unattended support to
any PC Mac or mobile device from
anywhere to resolve issues quickly I've
been using them for years it is saved my
bacon on more than one occasion so you
can assist anyone sign up for your
special 30-day free trial today visit go
to assist com click on the try free
button and use the promo code hak5 let's
go to assist calm promo code hak5
and it's time for my favorite part of
the show the techno of the week this one
comes from Matt he says love the hak5
show so happy to see the release of the
new Wi-Fi pineapple 5 a little while
after the mark 4 was released he
purchased one and it's he was inspired
by her wall mounted server so he went
about creating his own and he also
attached his pineapple to it this is
such a cool picture I love it he built
this a little while ago and he just
hasn't gotten around to sending us some
pictures so I finally did and here it is
for you guys thank you so much Matt we
really appreciate you setting in your
photo and you guys can send your photos
over to feedback at hak5 org just put
the subject line as technol us so we can
find it sorry hey guys day 2 of torque
on and I totally don't have a hangover
but you know what I do have I am
appalled what's up all hi so you almost
the entire Internet accidentally yeah
yeah I was scanning and welcome it was
the whole internet my cloud okay so
let's take a step back because i have
i've seen like talks where people are
talking about like oh you know I spent
the last six months you know DNS zone
transferring the internet or checking
banners on every port 22 and 23 and 25
and what exactly did you do now so I
built a distributed system and did have
my top the demo actually worked for once
and in just a little less than 20
minutes not only did reports again the
whole internet for port 5900 but we also
took a screenshot of everything that was
listening on 5900 unauthenticated ok so
at 5900 for you know the system is the
crowd you obviously know we're talking
about VNC here how on earth is too cool
about unauthenticated lead connecting to
all of this service well the protocol
you connect and say which pro you know
how would you like to authenticate one
of those off
is no authentication so we scanned for
that and then just ran a simple via
simple snapshot programs the interesting
thing was how many how many there really
were out there you know in any given
subnet there were several hundred at
least and so these are the machines that
necessarily don't ask for a password is
it just that they also accept you saying
no I don't wanna give you a password can
I just have it anyway well then they're
actually both um there's a vulnerability
and an older version of real VNC where
it says send me a password but if you
say I'm not sending you a password it's
like cool I didn't exploit that
vulnerability but I could see which
machines were vulnerable to it okay so
you didn't you didn't hack anything not
in the sense of like breaking any
security out potentially be violating
the laws you just hey these doors are
open I'm gonna walk in and see what's
going on yeah toto just taking a look at
what's there you know on the servers
that explicitly say you can connect to
this and the beginning like go in and
start clicking around and now know we
had it set up so that it didn't interact
with the system at all the only thing it
did was connect it wasn't moving moving
Mouse's or anything we got a lot of
screen savers you know someone else
could write a program that would move
the mouse a little bit you'd see a lot
more but we were they de- yeah nice you
you yeah done something okay um so what
on earth did you see out there because
well first of all there's a couple of
billion hosts song Internet yeah a
second of all of those billion how many
run V&amp;amp;C and of those how many don't ask
for a password so I think so there's
four billion posts on the Internet I
think about 2.2 million or running open
VNC port um of those i think it was
about one in ten that let me log in
without a password take a look and see
what is there that's an alarming hood
yeah it is I looking through the results
I think there are two main reasons that
this is happening one of which is real
VNC as a it's a commercial product when
the license expires they all that to
having
security wow that's a really that's even
better than it just stops working yeah I
mean you would think maybe just stopped
working as a better default behavior the
other thing is it looks like the free
version of teamviewer has the same
behavior it just doesn't include a
password thank you okay so what kind of
stuff did you see of those you know
maybe one in ten that you scanned in
town that were open yeah so there were a
whole lot of login desktops of a lot of
Windows desktops with you know press
ctrl alt oe to log in but we found some
other interesting things too there's a
couple car washes we found I think blue
let's say we found a couple car washes
we found a whole lot of generators and
gas plants and stuff that really
shouldn't be on the internet social like
status systems like a very specialized
industrial control stuff yeah we found
found a system that was running a PLC
controller um I think I think my
favorite thing now is we found pharmacy
sitting there at the prompt you could
modify send prescriptions re private
patient data did you get yourself some
vicodin no no touching yeah but I we're
going to make sure that one's not on the
internet anymore until what you do like
what you're responsible disclosure here
do you just say like I'm time p is p and
say oh no dude i mean it's it's hard
because for one thing if you scan now
you have to do something with results
and if you find something in the results
now you're all we going to tell someone
about it the process is you start by
talking to the us-cert the computer
emergency response teams um they're not
always the best way to deal with
something so oftentimes it's trying to
figure out who the customer is and give
them a call on the phone and say hey can
I talk to your IT person but you're
talking about thousands of posts here
yeah only the ones that have something
that's seriously wrong or ones that need
that you know I mean there are a whole
lot of desktops people doing their math
work people of mining Bitcoin yeah
people mining Bitcoin not not touching
that not stealing anyone's been coming
all it but you have pretty much a slice
of the Internet doing what the internet
does so it's the doors to how long does
it take to scanning internet for all 59
years well so it takes it normally takes
a while with the distributed system that
I set up it took us 16 and a half
minutes to do the whole internet minutes
minutes yeah what are you using like a
thousand VPS if you have a botnet
somewhere what's going on well it turns
out this kind of traffic actually breaks
VBSS you knock over the networking sack
on the host so these are dedicated boxes
they cost about a hundred bucks a month
apiece and I think we have six of them
some of them are some of them I paid for
some of them the hosting provider
donated so saying do you have to make
sure to be fine like the host that's not
going to mind that you're like not
spamming but that you're just like you
know spray and pray for 16 days yeah
that's that's probably the biggest
challenge is finding someone who's
policy says yeah this is okay and then
you know you contact them and work with
them first and make sure that they're
okay with what you're doing so they
don't just shut you off we're gonna see
what isp you've had good experiences so
it's light but no I'd rather not okay
because yeah yeah totally understand but
yeah so make sure that they're okay with
you having accidentally the whole
internet yeah yeah it will generate
abuse complaints depending on who your
ISP is they may just ignore the abuse
complaints if you're not actively
causing trouble or they or they may
forward them all to you which means
you'll wake up every morning to with
four billion four billion abuse
complaints well not quite that many but
it's on the order of 15 or 20 a day that
TL DR so um what how on earth you do it
that quickly what programs are using on
the back of net well so I'm using a
program called mask and it's the reason
I use it is because it has a option for
sharding so you can split your job up
into a bunch of little pieces and the
advantage of the way it
that is that you don't overload anyone
host on the internet that gives us time
you know if you send all your traffic to
each host in order you knock us off the
internet we will be very unhappy but if
you send traffic over the course of 16
minutes they don't bother they don't
mind so much in addition to mass again
I'm using a program called pasa which is
a distributed task queue and it uses
Redis on the back end to handle the
traffic when the system was running it
pulls full speed redis was handling
several hundred thousand requests per
second wow it's like more dialing
thousands of pounds i absolutely love it
tell me i wanted you to take in
pre-production before you even hit the
button to go and you know launch v who's
out there well the hardest part was
actually finding hosts that we're okay
with it um so it wasn't it wasn't the
code or any of that the code well I
submitted the talk and then I went to
find the hosts and that took a long time
and then I wrote most of the code last
night or yeah the night before last
awesome so like all of that and then the
payoff is so let's watch the graph
through a few minutes sit yeah well
three and a half million packets per
second is quite a few we pushed it up
before later in the evening so that's
quite a lot of packets it wants Wow
awesome so MV published the code that
you post the talk with you find more
yeah the code and the talk my sides all
10 of them are up on the github I the
video isn't up but feel free to contact
me on Twitter or whatever I'm happy to
help people get it working Oh what's
your clutter after falling down Oh
budget thank you so much thank you
Cheers yeah I just about wraps up this
episode of hak5 like to do it straight
as we say goodbye to our gym that we do
wear pants on this show yes I hope so it
keeps going so that's it that's all we
have for it this week see you next time
act 5 / following we should talk about
them we should probably tell them a
little bit more about this but this is
our mark 5 pineapple he's got two chips
at the same time it has two chips yes I
we have what are they the realtek and
the atheros chip sets yes in this guy so
you don't have to use as almost wireless
adapter with yes all right jibon we're
okay we've obviously had too much beer
and techno lyst so hak5 Deaderick /
follow and um was there anything else we
needs it hack shop hockshop calm thank
you for your continued to support and we
will see you down down here that and
here we will see you next week until
then i'm darren kitchen I'm Shannon
Morse we're reminding you to track your
quest
no and what's up here it's back there
did you find it what are you doing down
there</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>