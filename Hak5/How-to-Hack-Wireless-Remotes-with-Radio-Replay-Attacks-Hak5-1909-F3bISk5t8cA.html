<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to Hack Wireless Remotes with Radio Replay Attacks - Hak5 1909 | Coder Coacher - Coaching Coders</title><meta content="How to Hack Wireless Remotes with Radio Replay Attacks - Hak5 1909 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to Hack Wireless Remotes with Radio Replay Attacks - Hak5 1909</b></h2><h5 class="post__date">2015-10-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/F3bISk5t8cA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hacking Wireless remotes with radio
replay attacks all that today on hack
five
this episode of hack 5 is brought to you
by domain.com hello and welcome to hack
5 I'm Darrin kitchen I'm Shannon Morse
and today on the show we are going to be
using the yardstick one to hack Wireless
remotes with replay attacks briefly
attack yes this is so exciting so today
we are hacking Wireless remotes using RF
replay attacks and the yardstick 1 if
you guys haven't already checked out
last week's episode on Mike Osmonds new
hacker you know of hacker of Fame the
new dongle for the RF goodness check it
out follow along yeah it's super super
fun so basically hacking wireless
systems you already know that it's
really easy and it's actually really fun
once you get the hang of it and best of
all there are tons and tons of
potentially vulnerable devices out there
to audit so in this new world of
Internet of Things it's seriously like
it's kind of like Wi-Fi auditing back in
2001 all over it oh man so much and you
know here's the thing armed with just a
little bit of knowledge some
experimentation we can pull off some
pretty simple but very effective attacks
against a ton of devices without having
to get to nitty gritty into radio theory
which is awesome by the way if you do
want to go the full software defined
radio route hacker F is great for that
but the beauty of the yardstick one is
that it's not an SDR in the traditional
sense rather it's a transceiver that
speaks the modulation on the frequencies
that are used by so many consumer
electronics devices mmm so in this
episode we're going to go over first off
how to gather intel on the device that
you want to hack how to sniff its
wireless signals we're going to figure
out which modulation technique it uses
and then we'll decode this signal and
finally finally we'll use RF cat which
you probably remember from last week to
show you how to program a replay attack
with a compatible dongle like the
yardstick one for example so first off
we're going to gather Intel right so the
first thing we need to do is actually
figure out as much as we possibly can
about our device and you know thankfully
the u.s. in here we we've made it so
easy because of the FCC
you know in our demo we're going to be
using this it's a power outlet remote
let me show you it here I've got a plug
in this is essentially I have this thing
yes it just plugs into the power and you
can turn on and it turns on the timer
you can turn off it's it's really stupid
simple yeah you get this on Amazon for
like ten bucks and what's so great about
this is that you know with just a simple
Google search or search of the database
we find out how does it work you know
and we're going to do just that so let
me pull up a browser here because if you
look at the device right here let me see
so usually on the back of it you'll get
some kind of FCC ID number right okay
and in this case our FCC ID should it is
P a GTR uh-huh - zero zero nine okay - -
one B is in boy all right or that baby
Rob Oh Bravo yes so when you type that
into Google and the very first link in
fact is two FCC's database or we could
just search the FCC database directly
and we get all of the cool stuff like
the photos and the test lab report and
what we're most interested in is the
test report so from here we'll just go
ahead and get a nice little PDF we can
see like oh this is actually you know
made by the vert on tool ektron exten
gong co limited out of China and if we
come down here see compliance all the
good stuff there we go we can actually
see that the frequency it speaks at is
315 megahertz the modulation is a SK or
amplitude shift keying let me make that
a little bigger for you and basically
it's you know it speaks eighty kilohertz
wide it uses an integrated antenna and a
12 volt battery and in fact it even
shows like under the modulation we could
even see a pretty little picture
waveforms that we're going to be
reproducing here real soon so now we
know where to look for the signal which
is at 314.993.0963
it's and that it's amplitude shift key
or ASX modulation so using one of my
favorite tools which is the rtl-sdr the
real tech SDR dongle yeah we can now
sniff that signal up for analysis so to
do this I'm using a program called GQ rx
which is on my kali linux 2.0 laptop so
here it's simply a matter of tuning the
rtl-sdr dongle to about 315 megahertz
you can just change the frequency by
pressing up and down on the numbers like
that in GQ rx change the frequency which
isn't technically an unlicensed is M
band by the way through hell no this is
actually kind of interesting the FCC has
a part 15 for ya the short-range devices
so if you're in Europe you're going to
find more devices that are in the four
33 megahertz band but here 959 15 or 315
a lot yeah about 315 so with 315
megahertz selected G qrx we're going to
change the modulation over to a.m. so
that would be over under mode you can
change it to a bunch of om I just choose
a.m. and then we hit power at all and we
see a little waterfall start at the
bottom we see our frequencies up at the
top and by the way there's a nice little
F of T plot up at the top which has
nothing to do with Final Fantasy Tactics
just FYI yeah I think it's math or
something yeah so at this point we can
actually capture that signal and so I
will be Vanna White here and click the
button if you want to pull that guy up
because yeah there we are
oh oh you see that yes so it shows up
right there and if I press it again now
it's already on but I'm holding down the
on key and you can yeah look at that
sending it over and over and over and
you have a similarly I can press off and
so we can see we're right about in that
range what we'll want to do next is
fine-tune our radio to Center that
signal and then we'll select it with as
much bandwidth as we can and go ahead
and record the signal to a way a file so
Darren if you want to go ahead and click
record again yeah in fact why don't you
go ahead and record that because I have
a copy of the wav file pulled up here on
on my computer that we have previously
recorded and so this is kind of awesome
now that we've actually recorded this we
can go ahead and identify the signal and
you know
the thing since we're actually dealing
with radio signals the actual waveforms
rather than like digital packets and
frames or whatever you're used to with
Wi-Fi we don't have the luxury of using
like an analyzer that we only love in
our hearts like Wireshark rather in this
case I'm actually just going to go ahead
and open this up in an audio editor I
love audacity it's free and open source
and so here's your ears this is so great
check this out so if i zoom in you can
see this is just the noise but then
we've got this pattern over and over so
let's go ahead and zoom in on this
pattern control one to zoom in and let's
see oh okay you see the same pattern
over and over right and so the longer I
hold down that button the more that I
see this pattern and what we're actually
seeing are these pulses so basically
these pulses are what's known as on-off
keying
and it is probably the simplest form of
amplitude shift keying modulation and in
this case the pulses are going to
represent a binary one and then the
absence of a pulse is actually going to
represent a binary 0 it's sort of like
CW or Morse code and this is so great
because on-off keying is pretty simple
and effective it is susceptible to a
little bit of noise which is probably
why if I scrub through this file check
this out if I like zoom out a little bit
you'll see it like plays there's the
byte sequence there's the sequence
there's a sequence and it's doing this
over and over again and you know the
longer that we actually hold down the
button on the remote which makes sense
because you know interference but
whatever just send it a few more times
if you're interested I do have links to
further reading on this kind of stuff in
the show notes but from here we're going
to be able to determine now that we know
the modulation type we can actually now
de code it yeah it is going to be rather
fun so here we go what I'm going to do
is zoom right into one of these doesn't
matter which one they're all the same
should I get a notepad open go ahead
grab your notepad grab your pencil and
paper and we're going to just scrub
through this now this is the entire
sequence oops if I can scroll a little
bit to the left maybe I'll zoom out one
more this is the entire sequence which
it repeats it's got a little
a gap in between when it repeats and
we'll see the first one the first
sequence we're just going to assume
that's a one okay
okay the next one is the absence but
you'll notice it's twice or maybe even
three times as wide so we're going to
say that's three times as wide and we're
going to say that's three zeros so
already we've got a nibble which is four
bits we've got one zero zero zero the
next is going to be in this case 1 1 1 0
then 1 1 1 0 then 1 0 0 0 1 1 1 0 1 0 0
0 1 0 0 0
you kind of get where this is going and
so on and so forth so on and so forth
and so if we do all of this we get a
64-bit length of binary which is kind of
awesome so here's here's a cool thing
the next thing that we're going to need
to do and this will have to do with our
injection later is we need to convert
these binary bits into hex which will
allow us to go ahead and send them off
through the air with RF cat so I'm going
to pull up a terminal here and make that
a little bit bigger for you guys this is
a fun little bash one-liner if you do a
print F and you say in a single tick % X
and then like I'm going to give it a
back slash end for a carriage return and
then you put in quotes with a dollar
sign to parens to pound now just put
your binary and in this case it was 1 0
0 0 1 1 1 0 as the first byte or 8 bits
2 parens and quote I'm going to go ahead
and get 8 e you're a little cut off
there what did you get I got 8 E that
should be hopefully visible enough for
everybody on the intertubes
but yeah that's a fun little bash
one-liner you know how I do it I Google
a binary to hex converter because I'm
cool like that and kind of lazy look at
you with your Google foo
okay and then I just copy and paste it
mm-hmm so now in just a bit we're going
to go ahead and use the yardstick one an
RF cat to replay these hex values but
first we're going to take a quick break
domain.com and doc club came to hack
five with a great idea build a club all
about learning stuff making things and
having fun so we've been hosting open
houses at the hack 5 warehouse through
hack House Club and with the help of
domain.com and dot club we've taken it
to the next level with a quadcopter
arena of doom from LAN parties drone
racing and battle arenas to 3d printing
software-defined radios and let's not
forget barbecue hacking is just plain
better when it's social club gets it and
they are the perfect social domain
whether it's IRC or clubs in RL it's all
about coming together and having fun so
what better domain to do it than a dark
Club it's perfect because a Dok club is
universally and globally understood so
if you're looking for the ultimate
social domain consider a dark Club so
join us this summer in the San Francisco
Bay Area and bring your mini quadcopter
to the arena for drone battle club we're
setting up the leaderboard so show us
what you've got
and what's your dock club let us know
and we'll share it with the hak5
audience it helps spread the word get
yours over at domain.com slash club
they're only $9.99 a year and there are
thousands of great domains available and
be sure to use the coupon code hak5 to
get 15% off and let them know we sent
you so when you think domain names think
domain.com ok since we already figured
out the frequency the modulation and
binary or hex equivalent of our device
which is the remote control power switch
yay the last bit that we need to know is
the data rate or how fast each chirp is
in the on-off keying that is transmitted
so to do that we'll just need to select
one of the 1 or 0 bits in our Audio
Editor audacity and by the way we were
able to record it with a little red
button at the bottom of GQ Rx just
mentioning that in case you were
wondering so I've actually got one
pulled up here and basically you want to
just essentially figure out how long
that is yeah so you can determine how
long in seconds each bit lasts so in our
case it's going to be about the
speed of 0.0005 five seconds which is
550 microseconds yay Google does math
for me so this ends up being about 1800
bits per second so not really great that
would be like over an hour for a Meg
which is pretty bad we're not trying to
make a Meg with us it's good enough for
a light switch though I would you Isis
fight for a little remote control so now
if you've been following along from last
week you know that we can use this
interactive Python environment called RF
cat which is great for doing all sorts
of different kinds of testing especially
for this kind of stuff
right so I'm going to go ahead and pull
up pseudo dot slash RF cat TAC are and
it doesn't find my dongle because they
don't have a plugged in so as soon as
I'm holding my RF cat my my yardstick
one there it is I now have the greatest
thing since frequency hopping I have my
interactive Python terminal here with RF
cat and so the first thing that we're
going to need to do first off we're
going to go ahead and set our frequency
using D dot set freak and then we're
going to go ahead and we're going to use
the same frequency that we found on G
qrx
I mentioned this because while the FCC
documentation said it was a three
fourteen point blah blah blahs actually
yeah you might have to move it around a
little bit because each one might be a
little bit off a few megahertz or a few
decimals and megahertz so we set that d
set freak to three one five zero six
zero zero zero zero oh there we go
so set it to three fifteen point oh six
megahertz with a de set Freck the next
thing that you need to do is actually
specify that we're going to use on-off
keying as our amplitude as our
modulation type so D set M DM modulation
to mod ASX OOP there we go and then the
finally the data rate which we've
figured out to be about 550 microseconds
so for that we're going to go ahead and
set we're going to do a d dot set MD MD
rate and in this case it's going to be
an int which is one over zero point zero
zero zero five five zero print print
close that out and there we go Saturday
range why
we can actually go ahead and inject the
hex values which we've converted so in
this case it's just a little bit of d
dot RF x mid which is actually our
transmit command here and in this case
I'm going to go ahead and in Quin double
quotes put backslash X for each hex
character we figured that the first one
was 8e and so do our FX Mela to transmit
these hex values using the parameters
that we've set above and I've gone ahead
and added three null bytes to the end
since we do want to have that kind of
gap in between those signals we also
since we know that the receiver may not
pick up the very first chirp we want to
go ahead and send this a few times and
that's why I put asterisk for T to send
that binary data 40 times over so if I
just go ahead and press Enter right here
and is the okay so the clock is off and
you have the remote so just are at yep s
so to go ahead I'll just I'll sit the
remote right there on the clock and I
just press Enter yes all right
oh yeah there you go so I can like turn
it off with the remote press up and
press Enter
is so satisfying great and even if we
look in GQ rx like yeah you can see it
going so I'll send this again and yeah
here it goes yeah look at that that is
nice a strong frequency that's on them
so cool now going forward you can see
that if we wanted to transmit the off
command it would just be a matter of
sniffing up the signal decoding the
binary and then injecting it again on
this frequency it's the same process
that can be used against like doorbells
and garage door remotes and keyless
entry systems whatever else you can
annoy your friends with so some things
you might want to watch out for though
which we figured out in our testing we
assume that on-off keying was using
signals single and double bits right so
things and then 0 0 and 0 0 0 like if I
come over here to audacity you can see
we basically made the assumption that
this was a 1 and this was 1 1 yeah and
as it turns out this is actually 1 1 1
which is why so we ended our 46 bits
instead of 64 so obviously when we went
to Train
the data that didn't work wait are you
sure to measure out every single one of
in your audio editor so you know exactly
how many bits it's supposed to be
another thing that might get you is that
the frequency stated isn't always 100%
accurate like Darren mentioned so in our
case the signal was off by about 100
kilohertz or so and finally when
figuring out how fast the data is being
transmitted it's sometimes easier to
just try common baud rates like 1200 or
4800 first also don't be surprised if
some codes look super super similar like
it took us a really long time to figure
out the difference between the on and
off signal on the stupid remote light
switch it was only two bits in two
different places and we were sitting
there like why is it this working it's
like playing Where's Waldo you're like
which of these two things is different
so it's very beneficial to like write it
out or line the waveforms up in audacity
which was totally my idea so it ended up
working out just fine
get some graph paper out get your
markers out have a lot of fun with this
this is so much fun and then basically
that's it for our yardstick 1 hack right
if if you have any questions obviously
leave them in the comments or you can
hit up us up directly feedback at hak5
org yay and of course if you want to
support what we're doing and get
yourself some awesome radio equipment
like the yardstick one or the RTL SDR
that I've got plugged in from our show
today or from any other episodes head on
over to our store which is a cheeky shop
calm thank you so much that sports it
directly and if you love this you can
like it you can subscribe and share with
your friends let everybody know about
hack 5 and you know while you're at it
head over to hack 5 org or youtube.com
slash at 5 and that's where we find all
of our other episodes and all the other
fun shows we do with that I'm Darren
kitchen I'm Shannon Morse trust your
techno list
I want to hack my things yeah right this
is so addictive ooh the light switch
further and the remote doorbell is
esperan welcome no that's not automated
quintal system we should hack that later
in an episode where we go back to 1998</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>