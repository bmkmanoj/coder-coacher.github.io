<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hak5 1224.1, SShuttle and Linux Talk | Coder Coacher - Coaching Coders</title><meta content="Hak5 1224.1, SShuttle and Linux Talk - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hak5 1224.1, SShuttle and Linux Talk</b></h2><h5 class="post__date">2013-01-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/E01s-0vBypQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this time on the show can an SSH proxy
become a VPN we're bridging networks
with a wicked python script it's what
happens when a transparent proxy gets
together with a VPN and ssh that's like
a networking threesome plus secure chat
in Linux all that and more this time on
hak5 this segment is brought to you by
untangle hello and welcome hak5 my name
is darren kitchen I'm Shannon Morse it's
a weekly dose of technol s mad about I
had a cold last week so I wasn't on the
show mmm but I'm still sniffily you can
probably hear it in my voice yeah I got
to see us blow too yeah it's going
around mad oh they're gonna eat lots of
oranges mmhmm yeah it's in the kernel
run antivirus because that will work
colonel oh gosh if I you will you go to
kernel panic quick panic sorry um we are
back in studio it feels like it's been
forever since we've been well it's been
like two three weeks I think yes and I I
guess I'm not gonna get too much into
the ongoings of last week other than to
say thank you for all of the emails
everybody and continue to feel free to
email me and just good stuff so um yeah
great job I can be set aside an awesome
not really but but well thanks thank you
it was good that somebody said something
well it's not even gonna start I just
feel like it's one of those things that
you can't just pretend doesn't happen
yeah because that doesn't make it not
exist cuz things like that do happen so
yeah damn you can't go trust me I've
been there yeah Gordon alright anyway so
getting into the tech this week no um I
am kind of starting okay so you know how
we did that series on ssh foo and we
kind of like went exhaustively like to
the point where like viewers were not
the white falling asleep viewers but you
know it was quite about the white boy on
the whiteboard with the SSH well that's
pretty crazy I'm starting a new series
here and what I want to try to tackle
with this is I kind of almost got a
little dawn
hit with the the coming VPN series the
gpg series that all of these different
technologies which in their own right we
could really spend a season on each of
those however in the interest of keeping
things moving keeping things fresh yeah
what I want to do is start a series on
the ultimate like personal computer
security road warrior this is what you
need to do if you're in a hostile
environment if you're traveling if
you're just a sane hacker that wants to
make sure that they're following these
kinds of best practices so rather than
go into like an exhaustive gpg series or
an exhaustive VPN series I kind of just
want to talk about like look if you're
about to you know hit the road and go
some places where you might have your
things looked at here are some ways in
which you could you know all of you kind
of just mix it up keep it moving so cool
in the spirit of that the first thing
that I want to talk about is not ssh
tunneling oh really and it's not VPNs
either what is it a little bit of both
oh it's like that's dirty this is really
cool program called s shuttle that is
kind of like marriage tell you so ease
and or I guess s 8 SSH uttle I'm gonna
call it s shuttle yeah it's a shuttle
shit shit shit shit shit shuttle shuttle
this episode is brought to you by fisher
bottle and uh we're going to be using
this to create a transparent proxy call
so that all of the applications on our
linux machine are going to go through
this it's very much like a VPN but it's
building on the same concepts and this
is kind of brilliant here in that it is
this is the segue segment because it's
taking us from the concept of us to say
it which we have exhaustively gotten
into yeah I'm bringing us into the
concepts of VPNs cool this is like what
I'm looking forward to checking this out
no this is one of those fun hacky ones
and then you're getting into like secure
commute secure am I make using a little
bit of openssh foo to have us talk to
each other on the same localhost it's
gonna be good times I love this all
right well I'm gonna get into my sister
shuttling sweet and i guess i will talk
to you soon I'll talk to you soon or you
can you can
right me all right well where was I so s
shuttle or shuttle it bills itself as
quote we're transparent proxy meets VPN
meets ssh and it's not exactly a VPN nor
is it port forwarding it's like a VPN in
that it forwards every port on the
network and so not just the port so you
specify with like ssh tongs i know that
we exhaustively got into tak d and all
of the different letters for all the
different forwarding techniques well
this is nice because you don't have to
remember which port is matt to which
service if i did like 80 80 and that
goes to this IRC server over here and 80
81 goes to that thing over there it's
nothing like that which i really like
that said it's sort of like port
forwarding because it's a stateful
connection whereas a VPN traditionally
forwards you pack it one packet at a
time and so to explain that the S
shuttle author kind of says that it's
similar to an old program by the name of
slurp which was a user space tcp/ip
implementation that operated on a packet
by packet basis and it would encapsulate
the packets its sent in to the server on
the other side one at a time now the
problem with that is that TCP inherently
needs packet loss and it's kind of a
weird thing to think but yes your
connection requires packet loss to
function properly it's how ecp knows
when to slow down when each individual
TCP packet is encapsulated in a second
TCP packet well then the only the
outside layer will know to adjust for
packet loss and anything inside is just
going to get you know the connection
errors are going to be unbeknownst to
the first packet so what s shuttle does
is it does a stateful assembly into
packets into a logical TCP stream on
your computer before sending them over
to the remote host the server on the
other side over an ssh connection and
for those that are into useless trivia
there is plenty of awesome tech Laurent
the projects github page well suffice it
to say though if you're running linux
freebsd or a mac then you you know and
you have ssh access on a remote machine
in the cloud you know whether or not you
have
access on it and you know you want to
make an easy VPN like tunnel without
getting into all the port forwarding foo
we've extensively gotten into s shuttle
is probably for you so to get started
all you need are one root privileges on
your client machine you're also going to
need Python and iptables which are
installed by default on most
distribution so i'm using Ubuntu here
and it's I don't have to think about it
now the server side on the other hand
you don't know need any of these it
doesn't need root you don't need
iptables it doesn't need Python but
really any plain jane VPS is going to do
so to get started all we really have to
do is clone the github so in order to do
that I'm going to get clone and then the
it's get colon slash slash github.com /
AP noir / shuttle s shuttle and it's
cloning the object by LS I see there it
is come into here and there's a bunch of
goody files and it's all set up and easy
to do and so really from here all I
would really have to do is evoke sudo
dot slash SSH now remember you do have
to be root as the client to do this so
sudo dot slash SSH or s shuttle and I'm
going to get all of the information that
I need on how to actually use this so
there's a couple of options that I like
to do so first of all i'm going to add
here let me clear this and i'm down here
and show you i like to use tak tak dns
that's important because it keeps my dns
queries from leaking out and you know
that's kind of an issue also with other
proxying technologies like tor you
really want to make sure whenever you're
finding out you know what the IP address
of the domain name is you're doing that
through this tunnel that you're trying
to use to keep yourself secure otherwise
you're kind of screaming out to the
world here's what I'm looking at even
though you don't see it here's where I'm
you know what I'm interested in okay the
other ones that I use our
tak tak I'm sorry tak v vr so V V for
very verbose and r is for remote and
this is where you do user at host now in
this case and I must stress do not do
this I'm a trained professional yep and
I literally using like a test server
here I haven't gotten everything set up
the way that I need it to be so do not
do this however for the purposes of
illustration i am using root at a spare
host that will probably be gone by the
time you see this that said oops 173 214
160 155 ok you don't want to normally
ask the sages route i'm totally doing
this even though i said last season not
to all right and then the last thing you
want in entering here is 0 / 0 release
in this case and that is a shortcut or 0
0 0 at 0 / 0 or all connections now if
you want to you know you only have some
traffic go through this SSH tunnel VPN
thingy you can actually provide cider
notation right here that's it it's you
know it's as easy as that but by doing 0
/ 0 I'm telling my computer if I'm
trying to hit anything on the IP for
internet go through this tunnel so let
me go ahead and run this and you can see
it's binding locally and you can
actually see it executing the ssh over 2
root at this IP and I'm prompted for the
password on the remote host and there we
go
it's running and the very verbose part
means that i'm going to see all of this
jazz well if i come over here to firefox
and open a new window and go to our
favorite IP chicken you're going to see
that well one a lot of stuff is
happening in the window over here
because i'm actually making this
connection right here but you'll also
notice that the IP address that i'm
given is the same as what i typed in for
my ssh it's the 173 to 14 16 to 155 if i
were to close this connection but just
doing a control see you're going to see
right here is just using iptables it's
changing my routing and if i were to
refresh this and pull do a good job of
blurring out the studio IP but you're
going to see it ends in 129 just like it
does down here as well you can see we're
on comcast but yeah there you go it's
it's the old you know refresh IP
checking to show that I'm tunneling all
of my traffic which is really cool you
know because I didn't have to set up any
special in settings in my browser I
didn't have to you know run some special
instance of like SSH tak capital D and
this is really cool you don't need to
install ssh on the remote server either
you saw that i didn't even log into my
room while I guess I did when I has to
say to you over to it but you know the
beautiful thing is s shuttle invokes
itself remotely on the server for you
and get this you can get as advanced as
you like with it since it's using
iptables on the backend for example you
can exclude certain TCP traffic using
tac-x option and that that is to say
like you know if you had a you know I
could say my land here I could say what
is it we're on a 1073 so anything
beginning it I could do 10 273 30 10 /
24 and then anything bound for my local
network won't go through the S shuttle
smart right the other thing that you
could do is you could tunnel only
certain IP traffic whatsoever so if you
wanted to you could do you know s
shuttle attack VR and then the server
and then just enter in the site or net
address of what you want to actually
connect to and you you could also have
it do kind of all of this automatically
for you kind of like a VPN back to the
office by using a couple of flags here
there's a tack n which is a flag which
will tell s shuttle to figure out the IP
address and the subnets to forward all
on its own so you can say hey look I
just want to get access to this network
here's attack n and then I love this
anybody that's done like pptp over
windows and things of that nature will
remember tack H this is just such a cool
one this flag scans the remote for host
names within the remote subnet and then
it will store them temporarily in your /
etsy / hosts file so you don't even have
to think about it if you're used to
going to you know backslash backslash in
this computer name it'll just show up
how wonderful is that all right well I'm
really looking forward to hearing what
you guys think about s shuttle and what
are the kind of fun hacks you do with
ssh as we kind of meander our way
through all the fun ways that you can
keep your packets hidden we're not
hidden but encapsulated properly but not
one at a time because TCP over TCP is
bad all right well we're gonna take a
quick break but when we get back Shannon
is going to talk with park d
are you thinking about replacing your
outdated firewall your gateway your MTU
well if you're wondering how untangled
stacks up you might be really surprised
i love untangled and it is the most
complete solution out there right out of
the box you can skip the multiple
appliances the hidden costs the add-ons
most of all the annoying sales reps
whether you're looking for a hardware
software will get this I love this a
virtualized solution oh yeah untangled
gets the job done for so much less cash
and if you want to you can run untangled
on your network for free with no
commitment whatsoever all you have to do
is install it on commodity PC hard way
we've done just that here on hak5
previously and if you need like the
minimum protection run the light package
it's open-source it's always free of
charge wherever you're like me and you
want the full-featured solution I love
this they've got advanced web filtering
technologies they've got application
control policy management bandwidth
control that's kind of huge you're gonna
want the premium package which includes
every single app untangled makes so hak5
viewers you get this you get something
really special because I untangled loves
us they want to hook you up with 14-day
free trial of their entire untangled
premium package of apps and you can save
twenty percent off the list price all
you have to do is use the promo code
hak5 and they've set up a certain site
just for you guys so please do this head
over to untangle calm / hak5</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>