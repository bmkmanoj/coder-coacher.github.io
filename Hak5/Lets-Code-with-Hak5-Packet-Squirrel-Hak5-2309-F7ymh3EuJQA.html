<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Let's Code with Hak5 - Packet Squirrel - Hak5 2309 | Coder Coacher - Coaching Coders</title><meta content="Let's Code with Hak5 - Packet Squirrel - Hak5 2309 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Let's Code with Hak5 - Packet Squirrel - Hak5 2309</b></h2><h5 class="post__date">2017-11-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/F7ymh3EuJQA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome to hack 5 at your
weekly dose of technolon Sam Darrin
kitchen and I'm Celeste you kidding hey
man it's so good to see you
good to see you too damn it's nice to be
able to do a to do one of these you know
over the pond right it's been too long
since we've done a let's code I'm glad
that we can do this do it as the main
event cuz I'm really excited I sent you
a text and you know how much I love and
grep I used it on the Wi-Fi pineapple
mark 3 oh it's kind of like roped you
into this whole mess you can see the
regret in subs eyes yes M grep if
everybody that isn't familiar is just
like the grep command for Linux except
with the N standing for network which
means that you can do all sorts of cool
conditions based on what you see online
so what we're gonna do today is build a
payload for this here packet squirrel
that's gonna use n grep to save
interesting traffic but we could also do
so much other cool stuff with it based
on whatever conditions we see that's
kind of the the power of its kind of
brilliant what do you say we just dive
right in
Seb I'm excited I've got my packet
squirrel here plugged in in arming mode
you can tell it's blinking blue and I've
got two plugged in with a nice little
USB Drive so I can store some logs and
just so that we establish the geometry I
have it connected to both my computer
here as well as my victim machine here
this is just a laptop that'll play the
victim on the land for the demo which
will allow me to just go ahead in this
the way that I love to do it every time
it's the proof of concept at first make
sure it works before you even start
writing a payload right sub yeah
absolutely
just before how are you connecting
everything together just so yeah ok so
this is a fun little thing about the the
packet squirrel is so this dark line
right here is going to the rest of the
network and then this lighter cable here
is not it is would typically be going
just to the target computer but in this
case since I want to screen share with
you and I want to you know use this
computer to build the attack and then
this computer to demo the main
in the middle I actually haven't going
to both and you can do that just like
you would with any other Network I mean
it's it's just a network right so that
uh it's a switch no I know it's a tiny
little buckets which I'll show you that
if the size of a credit card by putting
my credit card on top of it and then
showing you but that's probably a bad
idea okay shall we get into it yeah so I
am already SSH into my packet squirrel
you can see here on my computer and I've
already cleared out this payload because
we're going to be doing that here in a
moment but we're already established
that we have the internet traffic for
these two computers flowing heat through
here so if I were to just run and grep
with nothing whoa okay I'm gonna stop
that already because I already received
as you can see a ton of packets so well
it's really cool that you can literally
see everything I'm not interested in in
and everything I'm only interested in
certain things and what's really cool
about n grep is it very similar to for
instance TCP dump has filtering
capabilities and one really cool
filtering capability is that you can use
regular expressions so just to let you
know there's like just like grep it has
a lot of possibilities for how granular
you can filter in so in this particular
demo I'm gonna say I'm only interested
in we're gonna choose FTP you know why
I'm choosing FTP sub cuz you've been on
that land I'm sure you have you know the
company has the policy where it's like
you know the times that you see
unencrypted traffic in a neural network
is astonishing I mean internal doesn't
mean safe right yeah well I mean such an
emphasis is put on like oh well we
obviously wouldn't use FTP between our
two branch offices because that would
transit the Internet and that's unsafe
but internally right you've gotta expose
internally but then you know VPN to the
to the other network to get to your FTP
there which is again I mean it's better
than nothing but it still means on the
land there's also its problem since not
even just FTP I've seen this with
telnet being used medical equipment I've
used I've seen this in like I don't even
want to mention the kind of stuff that
we saw at the banks in Lebanon but
there's all sorts of crazy things right
Engineers
yeah we have a lot of fun with purchase
control systems stuff like yeah it's
good fun yeah I it's the same reason why
the end sub you know this because you
segmented the hak5 Network here at the
warehouse for this very reason we're
beholding to certain pieces of equipment
that we must use as part of you know our
fulfillment process and such and there's
kind of no two ways about it so you do
the best you can by segmenting those and
at least only having the nodes that you
have but if you can be one of those
nodes in the middle all bets are off so
we're gonna show you how where you can
just quickly demo like what's possible
with n grabs so let me switch back over
here to my SSH session and I'm just
gonna run and grep with - WI QL which
says the W is for it allows me to pass
the words that I want to filter
basically instead of using regular
expression I is for case insensitive are
certain are you want to be sure I don't
want our I want Q or quiet and L for
line feed and what we're gonna use what
we're gonna look for is gonna be in here
we're going to look for the word user or
the word pass and then where are we
gonna look for that well anything only
on port 21 I mean similarly you could
also do port was it 110 was it I'm at or
was that pop3 and god I don't remember
sorry numbers but yeah so we're going to
only look for those and so we can see
that that's looking right there so while
that's going on this machine here I'm
just gonna go ahead and FTP over to an
internal resource and login and type in
my password and you can see in real time
the user was passed and the password was
passed in plaintext and at that point I
can go ahead and close that FTP session
and I would say that right there is the
gist
of just prototyping it the last thing I
would do is actually just output it to
vlog file right and we just run that
again and do it again
Darren is the username laying password
as the password as always and then I can
hit ctrl C Pat that log file and see
there you go so we know that we can just
redirect the standard output from this
into a log file which makes us now
assume like hey okay we could probably
just turn this into a packet school
payload which does basically that and
then saves the logs over to the USB
Drive so we can plant this on the land
at the beginning of our engagement then
later on down the road as the pen tester
we can come by and say hey what kind of
loot did we get right right absolutely
how do you wanna get started well now
that we've proof of concept did that I
think we should establish that you could
literally just put those two you know
mines or that one-liner into a file I
mean like literally I could say nano
payload sah do a shebang such bin slash
bash run that and grep command that WI
QL you know user or pass on port 21 and
pipe that to will do Wacka Wacka so you
can run it multiple times and append to
a file on MT which is the USB flash
drive limit which is typically where we
save stuff and then I don't know port 21
stuff Scott txt right and that would
literally be a payload we could pretend
that with well we would need to give it
an attack matura it sorry not the time
you don't have to give it a net mode
otherwise there's no networking setup at
all so if the first thing you do is net
mode and then this kind of lends itself
very well to using net mode transparent
because there's no need for the squirrel
to have a an IP address from either the
host or given IP address out to the
client it can just sit as the
transparent which is kind of nice
because it means that as opposed to
doing that mode not where the packets go
will get an IP address from the network
and then give its client an IP address
from itself in the 172 16 32 range
this way if I do transparent it is
literally transparent best practices
typically is to do a LED setup now let
it do that we found out in in this
particular payload it might help to give
it a few seconds to sleep before it goes
and does anything else just so that
everybody on the land kind of gets their
IPS from the HTM know the network stack
is supposed to settle so that we don't
start you know listening on an interface
that's being brought up and down and
grep doesn't really like that yeah and
then then the next bit would just be to
do LED attack oops
et ACK and then I'd put an ampersand at
the end of this so that it kind of runs
in the background but that's pretty much
it that's is that not a payload sad yeah
I think we can we can do a bit better
because there's no you're not checking
it for USB just even exists right so
that's that's a problem you're also
running it with LEDs going and yeah
there's a couple of improvements that
you there's no way to tell if we've been
successful or have you know received a
chopper output and and so on so there's
a couple of things that we can do they
should also make sure that depending on
which file system use on the USB disk
that you're we're constantly sinking or
sinking every few seconds the drive and
that can be unnecessarily can be
unnecessary but we found that it does
help if the device crashes because the
powers been cut or similar which might
as well happen in some network closets
okay so what you're saying is this would
work but it's not robust right it's our
bus then it's it's hard-coded so we
should we should definitely write
something something a bit more flexible
and more like a payload so I'm assuming
at this point you're going to now open G
at it no I'm gonna do is I'm just going
to go back into my sublime because
that's my editor of choice here and the
first thing that we want to start off
with is to check if we've got if we've
got USB storage right if we've got that
mounted the way that we do that we can
just check mount for the file for this
file that file exists and if that file
um what am I saying
if that file exists we actually wanna
say if a file doesn't exist right so if
that file doesn't exist we know that we
have something mounted to or /mnt path
that means we now want to do something
like we want to create the new directory
right that loot directory might not
exist so we want to set up the net-net
mode and then we want to run the in grep
command all right we might also want to
to sink in between so so let's let's
just have this as comments now next
thing I'll do quickly is just to report
if there's a if no mount is available
right if we don't have anything mount it
don't want to do lead fail you just
finish the payload this pie is no point
in how are you going right so I think
the first thing we should do is we
should define so that's a less about to
say that's kind of a lot of things that
we're gonna be doing there so yes we
don't want to we don't we don't clutter
everything all right so there's no no no
reason to clutter everything we can draw
this out a little nicer so first I'm
gonna do is we're gonna have a set up
function and the setup function is oh
we've already established you just like
set the LED to set up and then set the
networking mode right and then give it a
few seconds to kind of chill out right
correct yes
so so first thing here mesh mode
transparent right and then we put asleep
let's f5 in there but something else
that we want to do is now we were when
we were talking about this earlier we
said we wanted to make this payload kind
of more covert right because something
that's constantly blinking LEDs maybe
not the best thing to have set up right
so instead what we're gonna do is then
turn off the LED first so we're just
gonna start this let's set up with so it
makes it just a little bit more covering
yeah right so let's do lead off I'll
just turn the LED off and then that mode
transparent and we sleep five so instead
of doing like this here we'll just now
we can just run and up set up all right
Oh what does it say successful it'll go
to the next yeah exactly but but we
should we should still consider that we
don't have a loot directory yet right
now we need a creative sync function so
the same function should be relatively
simple so here all we do is we have a
while true do sync so the syncing
command it's synchronized as the
filesystem and maybe I'll speak to why
that's important and you can correct me
err but essentially when we when we
decided to when we decided to develop
this we had a kind of a large problem to
overcome in that the the typical USB
drives that you'll find off-the-shelf
come pre formatted with a really ancient
file system fat32 which has a lot of
inherent problems when it comes to using
them with little Linux boxes and we want
to make it at the same time
user-friendly for anybody working with
it on the linux or uh sorry on the
windows platform so it's why we've
decided to focus on two file systems one
is ext4
and that's your typical Linux file
system and that works great with Linux
obviously was one would expect but the
other is NTFS why did we choose NTFS sub
so the reason why we chose NTFS / or
fat32 is that well the file size
limitation 1 so we can't store a file
larger than 4 gigs also it's an archaic
system so anyway we could have used
something like X fat but there's driver
issues there and so we just decided to
use NTFS which doesn't have those
limitations and x4 so those are the two
supporting systems that we allow you to
use on a USB disk and if you don't if
you want to use x4 but you can't or
you're not sure how to format it best
then you can just use reformat
underscore USB on your packet squirrel
just type that command and confirm and
it'll automatically what if your stick
and foreign it correctly yeah that's
good stuff yeah alright so now that we
there you don't so you would just
why on this and it's just going to take
a few seconds and then it will ha ha and
now I have a flash drive that's
formatted ext4 easy enough yeah exactly
so back to the payload though we we have
established the we have established the
the you know the fact so first of all
we're gonna create this set up now in
the setup function we could actually do
though is also create the loop folder so
oh yeah that makes sense
so let's don't make something so
typically we have different payloads
storing things in a loot folder on the
USB Drive so /mnt
slash loot slash in this case I guess
would be n grep right so so what I would
actually do at the very top here just so
that we you know have this a bit cleaner
let's have something like this or log
dear reached here maybe yeah and our
loot dear supposed to be mmt luke and
then I just found good edge here and
then or because we want to have a log
where we're actually storing that loot
right so so that the log will be the
loot so that's gonna be log file is and
that would just be the loot dear sorry
dear slash or they call it end rep - and
now this is kind of a wouldn't you just
make me and grab dot log well I could do
anger if that log but the problem is
that when the packet scroll starts up
right it'll overwrite those files and we
don't want that and we can't use
reliable use the timestamp because the
packets well obviously doesn't have a
real time clock so it'll just reset the
time to whatever it knows it's the
closest it does up by analyzing file
like the last right updated time of a
file yeah or a clip from NTP but it's
not gonna do that mode transparent so
exactly yeah so so for that reason what
we're gonna do is we're just gonna gonna
have this right here so ngrep random
dialogue this means it doesn't get a
timestamp it just gets a random number
but this will help the file it and it's
not getting overwritten so you could do
something else you could name this you
could put a time step in here whatever
you want to do what you think of it what
so anyway so we've got the loot here we
have the log file so we know we could
just do make do - P luge spear and then
our loot gear is created - so just just
making sure that that's all set up okay
so so we can do this set up then we want
to sync it we want to make sure the file
system is being synced every five
seconds background that by I mean the
ampersand the end so now that we've done
that it's it's time to - then we can
actually Google that all the running
yeah right yeah so now we can run the in
group command and that's as simple as
doing what was it's what were the others
- WI QL and then in single tick user
pipe pass single tick port 21 like this
yeah now that's just one though so I've
actually used a number of these and grep
commands over the years there's some
fantastic ones for pulling out like
Social Security numbers credit card
numbers all sorts of you know sensitive
information which on a pen test would be
you know a really great thing to have in
your final report so we shouldn't hard
code this as just the I don't want to
have to have like ten different end grep
payloads for all the different little
things that you can pull out of the wire
I totally agree so we're gonna do is
we're gonna have this end grip options
here and we're just gonna put an array
here and in it we're just gonna give a
user pass and then porch
21 we'll do that down what that's gonna
do is by having this as an array
actually an I didn't do this right we
also need W like uly4 early - WI QL so
we want to have all these these options
set so once we have these options
the way that we can call them instead of
doing all this mess we could just add
these the double quotes and then we'll
do and grab options it was even totally
array yeah so all of the LD right yeah
so this part basically just splits it
out into these uh into the individual
arguments and we're adding these quotes
around it so that when we have something
here that's got a space in it for
example if you want you to do this it's
gonna pass that as a single argument
especially useful for this part here
Sonya that's why we that's what we have
quoted and now that gets piped out to
the log file now just to be safe because
when we were playing around with us to
ampersand greater than one to ampersand
or two major than ampersand oh yeah yeah
so we just wanna make sure letters out
and error know what we're doing is we're
eating standard error and to standard
out and then we're just redirecting that
into the log file and background and we
want to run that in a background
absolutely yeah we can do that with E
just the ampersand again so the the
thing here is now we may want to kill n
grep so let's be let's be the masters
and I along land crap right now we
actually want to grab it spit and we do
that by by running this or by just
calling this and bash it's just um Dell
or Sonic page mark and I'll get the
Peter the last execute command so now
okay for whereas if we were to run kill
and grep it would kill every instance of
been grep that we're running correct
yeah so so now that we've done that so
there we go I mean we now have a
portable version of this payload right
we have it I mean well you put the run
function you know you're down there and
call it a day
yeah yeah so so theoretically this this
is this will already run right so we
have a setup which is taking care of the
setup we have
syncing happening
there's no way we're not getting any
feedback yet right so right now we're
just logging into a file a random file
every time we're not killing angriff at
any time so so we want to do something
right sort of how do we want to be
informed that a payload is or that we
have loops do you wanna yeah so I figure
you know the the use case here would be
that as the pentester I'm gonna go ahead
and like plant this at the client site
on Monday and then you know come Tuesday
or Wednesday I'm gonna come by and
you're right I don't want to have to
like unplug it put it through net couple
you know or pull the flash drive check
to see if I've got any Slough in the
file and then put it back in and set it
all up again it would be nice if I could
just glance at it but again we want to
maintain that stealth because you did
the led off at the beginning so that
it's not blinking anything so it's part
of me would want to say hey if it finds
loot turn green and if it hasn't gotten
the loot yet stay off or turn red but
that doesn't make much sense no because
then you go to court so so button button
right so that's good because that
introduces the button command right and
so the button command works this way we
can call button and the button command
will just hold the system sorry I now
that we're showing the screen so the
button command is just going to wait and
not execute anything is just gonna stay
like this until the button is pressed
right but it will link a certain LED
pattern so what we do instead is we
didn't know that equals true in front of
it which is just an environment variable
to the button and this means that the
button will not interfere with the LED
pattern so won't turn on LED will just
wait silently cool so it's just gonna
sit there until we press the button do
we let's add some logic to that though
yeah so so while we don't have to
necessarily do this ampersand ampersand
I'm gonna do it anyway just because it
looks neater this way so when the button
is pressed this part of the code will
bond all right right and I am successful
right and we actually want to do this we
want to take this code and we want to
put it into this while
and the reason why I want to do that is
because if you press this button right
we want to keep allowing you to press
this button and people all right so the
way we'll do that is just keep in this
in this while loop so this will be
unlimited and now if the button is
pressed we want to check if if the log
contains passwords right yeah I mean
that's what we're looking for is user
and pass and as you saw when I did the
the proof of concept it was well it was
all caps user right so instead what we
can do is we can create a check log
function once we run one for now oh
great so that's the button it'll just
check the log and base what of that give
us the led will use green and red right
so what we can do here is we can call
this check log function and then just
inside here say it's put it put anything
we want right so so when the log when we
find what we have in our log what do you
want to do I want to blink an LED maybe
yeah so LED finishes an awesome LED
pattern that blinks green it's very
exciting it lets you know hey something
good is happening and at that point we
were pretty much done with our pen test
because we've made off with loot so
let's go write a nice report and get
paid right right so so how about this
though to make sure that everything is
safe and that we can you know that we
don't lose any data all right let's
clean up because when we're when you hit
that button and it's collected payloads
we for now anyway we don't want to let
it keep running right yeah that would be
bad you know I mean I guess I can see a
use case where you would want to you
know just like hey get some more loot
but we can we had a variable we can add
a variable there that would allow us to
choose that as an option but for now
let's say we want to finish right so
we're just gonna we're just gonna
well let's kill off me for three seconds
okay yeah yeah absolutely but let's
let's wait for the LED finish command
because it blinks a certain pattern we
only for about three seconds to happen
so now what we're gonna do is
just gonna run kill and then and Pig
which is the pig that we got from n
grips oh we can just fly and grip and
then we're pretty much done so we want
to do led we can just go ahead and uh
yeah because otherwise it's gonna stay
green and then that halt command down
there that's a fun one that actually is
basically powering off yeah well yeah
right this is embedded device there's no
way to actually power it off but what we
can do is we can halt the entire
operating system and so the Hulk command
will do just that but the reason why we
do they lead off and begin before that
is because otherwise it will actually
still be blinking something else and
it'll keep that led powered on because
there's no operating system to tell it
to power on/off right because it's just
the electrical component being turned on
at that moment so if you've you
basically got a payload here where if
you press the button it's gonna turn
green if it has loot and if you and if
it doesn't have loot it's not gonna do
anything correct yeah but so we kind of
want to tell you that there's no loot
because otherwise you might think that
the device is broken and no powers going
to it alright so we can just do lead
fail here and and then sleep for a
second and then turn it back off because
we do want it to go back to its covert
you know LED off mode yeah okay so now
so now we've got this right we've got
LED finish sleep for three seconds to
let ops you know they give the user
enough time to actually see the LED and
we kill and grep we turn the LED off and
we halt the system and as all tariffs
stuff that happens we could probably
just put all of that into a single
function called run so we won't update
that it's a little cleaner well yeah I
mean in the end all of this here is part
of the one function alright so we could
absolutely just call a function run and
then just move this into including the
Ngram of move all of that into this run
function yeah then what happens when you
start this up is it does set up sync run
yeah
right so setup sink run so far as we're
doing an N grep payload here your check
log function basically all it needs to
do is grep the word user or the word
pass out of the log file right there's a
couple of ways to do this and again
we've discussed this before but the the
I think the best way to test is is
twofold
right so the first one is we can do
checking based on certain output if it's
predictable output you know pass for
example or we can check by has the log
actually been you know because the log
already grips only relevant things from
the network right so technically if
there's anything in the log where it
shouldn't look as we they should be loot
right so we can do both we do a hybrid
of both so for that what I would do is
we would first have something like a
like a condition up here condition and
this condition would be let's leave that
blank for now and then let's check in
our check log function so that's gonna
say if it exists yeah
so if if this is a if it's a set or well
if it's not empty anyway if it's not
yeah it's not 0 then we want to run the
grep code otherwise we want to run a
different tough code we're just gonna
leave return 1 here because returning
one just is the error condition we
didn't find anything so the first one's
kind of obvious we just grep it for
whatever in this case that condition
variable and I see what you did there
we're gonna say I don't know user or
pass in that condition and for our case
that will work fine but for somebody
else if they want to change the end grep
options they might be looking for a
different condition right exactly and I
just did Q because we don't need you
knows to me run quiet we don't need that
and then the eye is just for case
insensitivity just in case you want to
hide your condition the case insensitive
if you don't want done you'd have to
take out this eye and we can get into
making that switchable later
anyway so this will hold it for now and
what we can do here is we can just do
return 0 and then we know that you know
the log content is 2 found it condition
yeah
all right and at the same time here what
we can do is we can do a different check
and that would be word count - L put
file just so they don't have to do any
awk
so we just pipe and just standard in and
we do log file so you have this so we
know that from when we ran this as a
proof of concept that that it had a
couple of lines saying like hey I'm
running against port 21 yada yada yada
the filter and the match right yeah so
so what we're doing now is we're
basically just just running sorry you
were saying children to match yeah so
the first so what I'm saying is when we
ran it as a proof of concept just to see
if this works basically you could see
that it well it told you what it's doing
you know so like the first two lines in
fact the first three lines if I switch
back over to oh yeah is you know it says
hey the interface is at zero and your
filters you're looking for this and you
know here's your matching so we know
it's going to be that WC means word
count and tak L says lines so one two
three lines already so we know that
that's going to exist right exactly
so so that's a really good point though
so we just covered that with our filter
it's three lines long now there is a
possibility that when you change these
things it's this number could be
different so let's actually do something
like like to find this variable and we
should always add comments but word
count num equals three and make sure to
get this dollar sign there we go
yeah so now our domains we're checking
that the word count is greater than or
minimum number so this will we know that
something has bad
we said that the three by default only
this condition energy because while we
could check for what is a pass or
something it would be passed but you
know what let's just let's go with this
I like this if it's longer than three
lines you know because we know that our
match and filter and interface are going
to be three lines yeah and so then then
again here we're just gonna return zero
because it's greater than the number and
and we just return zero and otherwise be
true and one so that's that's all when
you can do here I think that that pretty
much covers the majority of the payload
unless you want to get fancier with with
any of this logic or want to keep it
running on a variable and so on but this
is your basic Angra payload I would say
is hot I I think that's uh I think at
this point I've gone ahead and if you
save that I'll copy it over to my packet
squirrel let me just send you that and
basically let's just go ahead and fire
this guy up and take a look so it's in
arming mode a the payload is now
assigned to switch position one and plug
in the power and then we wait that's
that's pretty much it so at this point I
would like plant it with a little bit of
double-sided sticky tape maybe stick on
a little label with it HVAC company logo
or whatever have you on your pen test
you know what I keep saying now is
people saying naming or devices humidity
sensors so like a land turtle or a cat
squirrel labeled humidity sensor and
then just start to the side of something
like do not unplug humidity sensor and
it looks great and it honestly passes a
humidity sensor for people that don't
realize what it is yeah I saw one of
these photos on Twitter and I I'd be
buying it yeah yeah and I'm not gonna be
you know I'm not gonna be that jackass
the unplugs we all know there
and I imagine imagine you know a data
center right and your temperature levels
are like it gets too hot or too humid or
to what not right imagine the amount of
trouble you'd get in for unplugging one
by accident so and there we go it's gone
asleep right if you can see that yes so
at this point I should just be able to
press the button and say hey I don't
have any loot right no loot SAS looks
good okay well let me but now we know
let me make sure we get some loot by FTP
again okay I've logged in to the FTP so
now if we press the button aha there we
go right at this point I could just
unplug it and run off with all the loot
you know what seven just occurred to me
we should leave it running we should add
another condition where I can just pull
the USB Drive plug another one in start
storing even more loot now go back to my
laptop and check it out analyze to what
I got huh yeah maybe next time maybe
that song what do we what do we do now
that we have a payload that's where aged
adults it would probably be best to
contribute this to the greater package
squirrel community right absolutely and
the best way to do that is by submitting
it to or packet squirrel payloads
repository on github maybe you can walk
us through quickly how to how to do that
to how to send a floral quest all right
well I have my payload got Sh here I
should probably also create a readme MV
but should just say I don't know and
grep a load and then we'll say like
description does packet sniffing stuff
you know I should probably make this a
little bit prettier later with all of
the different options yeah which were
you know what like WC what was it W
count all of the different variables and
such but I'll go ahead and pretty that
up later but we'll say okay cool
got a readme MV and here's a fun one I'm
actually in Windows right now and if I
dir instead of LS you can see I've got
this and if I do a start dot that opens
up Explorer for me which you can't see
right now but believe me it's there and
at that point I have a folder that
contains the two files that are
necessary my payload SH and my readme MD
and I have already cloned the packet
squirrel repository over to my own
personal github account which is great I
forked it I forked it over to my account
which means I can now go ahead and
commit this to my repository and then
send a pull request to act 5 so that
everyone within the packet school
community can benefit from this and it's
literally drag and drop so I'll just go
ahead and share this Chrome browser
window that I've got open and can do
this from and what I can do is go into
this is my version o that you can see
it's a hack five Dara and slash packet
squirrel there I'll go over to payloads
and library and where we gonna put this
I'll put this under sniffing so right
here sniffing and I'm just gonna drag
and drop my folder there we are there
are the files we're gonna call this
first version let's see added and grep
payload package sniffing with and grep
and commit changes there we go
and aha I'm ready to go ahead and commit
this overwrite yeah looks like ok so
everything's able to merge everything's
done for me just click create pull
request that looks good
create blow request and there we are and
now I just wait for someone to come
along and say hey that looks awesome we
could all benefit from that sweet
payload and now other contributors can
come in and make it better like yeah
absolutely I was talking about about
unplugging reap lugging a USB Drive and
getting even more packets yeah so not
only is this something that's that's
is a way for you to contribute to us but
we can also give you direct feedback in
the pull request and ask for a couple of
changes or improvements or someone else
can chime in and do the same thing and
then we can converge all about when it's
ready that's really exciting you know I
love the way that this is blossoming and
a building on so many of the lessons
learned not only just from like you know
the hardware of say there most are more
recent device the Bosch bunny in terms
of the way that we store payloads and
run payloads and assigns you know switch
positions and LEDs and such but also in
the amazing community that has blossomed
around that and I'm so excited to be
contributing another payload to that
repository so we hope that you will as
well and if you're a packet squirrel
user now you know you can go and nab all
sorts of new payloads over at our ya git
repository which currently is at github
calm slash hack five slash packets girl
- payloads yep sub where can people
badger you online the best place is
usually forums hak5 org that's the the
place to go for for pretty much any of
your questions but if there's something
specific to develop and you can always
email developer at hack 5 org awesome
directly to me and we'll be able to take
care of anything and of course you can
tweet those sweet packets coral another
hack 5 gear tweets with the hashtag hack
5 gear all through now through November
20th I believe there's still contests
going on at hack 5 dogs such contests
hack 5 org is the place to find all of
the other shows including Metasploit
minute and threat wire and tech thing
and hack tip and and more of this I hope
that we continue sab doing some more
let's codes this was a lot of fun it
worked really well across the phone so
yeah ok this is one where I'm really
keen on your feedback as well so
feedback at hack 5 org or just comment
below and we'll be there so until next
week i'm darren kitchen i'm sebastian
kiddo
trust your technology you've got a great
idea you should do what Shannon and I do
and head over to domain.com and register
your domain bring it over to the
internet using this super awesome
discovery system that brings domains
from your mind onto the web over at
domain.com they've got a quick and easy
checkout process and they've been
supporting hack 5 for years you can also
tweet Adam at domain.com and say hey
thanks for hooking up the guys and
they've got a special treat just for you
you get to save 20% off at checkout over
at domain.com using the super secret
coupon code it's 5 it spells hack 5 and
it's just between you and I all right
I'm tell anyone ok you can tell people
when you think domain names think
domain.com don't you to get to me okay</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>