<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hak5 - Capture &amp; Analyze Bluetooth Packets with Kismet, Wireshark&amp; Ubertooth One in BackTrack 5 | Coder Coacher - Coaching Coders</title><meta content="Hak5 - Capture &amp; Analyze Bluetooth Packets with Kismet, Wireshark&amp; Ubertooth One in BackTrack 5 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hak5 - Capture &amp; Analyze Bluetooth Packets with Kismet, Wireshark&amp; Ubertooth One in BackTrack 5</b></h2><h5 class="post__date">2011-07-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/tk_wC434ft4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this time on the show capturing and
analyzing Bluetooth packets with the
uber tooth one kismet and Wireshark
booting VirtualBox beams from physical
USB drives bypassing geoip location
restrictions and tons more this time on
hack 5 this segment is brought to you by
the Ben Heck show howdy partner and
welcome to hack 5 your weekly dose of
Technol us
I'm your rootin'-tootin host Darren
kitchen hey y'all I'm Shannon Morse
and we have plenty of cool stuff coming
up for you this episode since when did
you go country I don't know it's just
well I'm playing Red Dead Redemption and
I'm like crazy about like hog-tying
spores you know what else is good that
you mean our giraffe yes our giraffe
we've this is kind of like an inside
hak5 joke where we've been saying since
season one you know I will make it when
we've got a jib it we got a jib we made
it yeah can you move the gym I want to
see it move yeah okay now everybody's
throwing up alright anyway um I'm just
really stoked because Paul back there is
managing our Cobra crane which makes him
the Cobra Commander that great yeah that
was good I know yeah now would we get in
the mail because I know that we love to
get all sorts of fun stuff from you guys
well you can hold this whoo and this
comes from Craig C in Wisconsin he says
Darren kitchen at hack five I love the
show watch it all the time on my Roku
box awesome choice by the way I wanted
to send this to you to add to your
collection
an old AMD k-6 processor with a
Microsoft Windows logo printed on it
great John we're gonna have to get
there's really a Microsoft yeah I will
have to get a close-up of this just look
at that oh my gosh it's not even an
old-school one it's not even a k-6 -
this thing is a proper k-6 Wow oh the
Pens Bend good yeah no all the other
crazy thing is not BGP there are actual
pins here instead of little balls yes
whoo cool I know I love old tech
Tech is so good it's so craziness mmm it
should be it should be like up on the
wall we'll do that we need to upgrade
the set yeah yeah we'll probably have
that done by beginning season 10 hope
you know oh and then we've got details
about the season 10 party at the end of
the show so stick around
of course because that's going to be
lots of fun I'm gonna season 10 party do
you need another excuse for a party well
not really okay well we're gonna have a
season 10 party then all right cool but
amazing stuff coming up I've got follow
up with last week's uber tooth one setup
guide we're going to be capturing
packets with kismet we're going to be
analyzing them with Wireshark it's gonna
be a lot of fun and you've got some
VirtualBox stuff I have VirtualBox
creating a VM decays out of USB switch
actually I need to go finish that so why
don't you know do your thing all right
I'll be back y'all so again guys if
you're not familiar with the uber tooth
one it is a open-source bluetooth
testing tool it's made by my Cosman and
it's really a response to just the lack
of really good Bluetooth testing devices
and basically a ridiculously high-priced
commercial stuff for monitoring that's
like ten thousand dollars so anyway this
guy basically does kind of the same
thing as we've been doing on hack tip
recently which is a lot of like
fun-packed sniffing with Wi-Fi it allows
us to basically go into monitor mode for
Bluetooth and that's going to let us
take say a Bluetooth device and start
sniffing and doing for some fun analysis
and we'll get to some practical stuff on
that in a little bit here
of course the segment isn't only just
applying to to the uber tooth as some of
the setup stuff really is uh it's just
kind of the fundamentals of Linux stuff
and we'll be getting into some fun cool
said stuff and whatnot so stick around
I'm sure you guys will enjoy and of
course big props over to harvest Gardner
over at the BACtrack Linux forms for
putting together a lot of this you see
as most of the uber tooth development
was actually done on Mac OS 10 getting
it to work in Linux well it actually
isn't too difficult thankfully alright
so here we go I'm going to go ahead plug
my uber tooth in and let's get right to
it the first thing we are going to need
is actually the source code to kismet
kismet being our favorite I guess you
would call it like an auditing tool like
a anyway it's what we use to find all
wireless access points around and
whatnot so first thing we need to do is
just go ahead and W get that guy and he
is over at issue colon slash slash WWE
kismet analyst and with that downloaded
it's really just a matter of going ahead
and extracting and what we're going to
need to do to actually compile the
plugin for the uber tooth to work with
kismet is that we're going to need to
move the source that we've just
downloaded from the kismet wireless net
over to slash s RC / s re / user /
source / kismet because that's where
it's expecting to be so we're just going
to move what we just downloaded to slash
user slash SRC and it wants to be in
kismet there we go and if i LS user SRC
kismet i can see there we go we've got
all the files everything's where it
needs to be so if we just head back over
there we can just go ahead and configure
it so CD two slash user source kismet
and do dot slash configure all right now
without that all set up we can actually
go ahead and actually install the kismet
plugin for the uber tooth so that is
back in our home directory here under
the uber tooth tools so over tooth the
latest release and it's in host and
kismet and we just want to go into
plug-in tack uber tooth and it's a you
know as simple as doing make and then
make install so in this case I'm going
to do make and then you know typically
hit enter way type make install this
time what I want to do is actually use
two ampersands and what that says is if
make completes without any errors go
ahead and run this next command I could
alternatively do two pipes and say if
make fails and then it would do whatever
I tell it to so we want to say if make
completes correctly we're going to go
ahead and do make install and just let
that compile just a bit so it's gone
ahead and filed its installed now we
just need to go ahead
and an ad remember that library from
last week we need to add pcap bt BB to
the kismet configuration files so that
understands how to do those log files so
let's just head over to where that guy
lives he's in slash user local Etsy and
it's his MIT calm yes
okay so if we grep we're just going to
look for what is it called log types in
kismet comm we're going to see here that
by default the log types are pcap dump
GPS XML net XML net text and alert and
what we need to do is just go ahead and
add pcap BT BB to the end of that now
typically I just use I scroll down find
it at it and that's a lot of fun but I
figure why don't we just go ahead and
use the opportunity to have a little
action a little little set action right
so basically what this is going to allow
us to do is find where it says P calf ,
GPS like all of these different apps
options and add our own option to the
end of it in one command which is you
know if we wanted to automate this say
make an installer shell script we could
just use this to go ahead and do that
without having to you know say append it
to the end of the file and then we'd
have to log types equals you know that's
no good we don't want that so first
let's just go ahead and test this
command out so I'm going to run said and
what we're going to do here is use a
regular expression so that's why I'm
putting this in single quotes and the
s-class slash is going to go ahead and
search and what we're searching for is
going to be and I'm going to put this it
within parentheses to group it and that
will come into play later here of course
the parentheses need to be escaped and
that's why we have a backslash in front
of it
so what we're looking for here is pcap
dump
what GPS XML net XML net text and alert
okay so those are the things that we're
looking for so I'm going to close that
parentheses and what we're going to
replace it
with some slash anything I type here is
what we're going to replace it with now
since I've grouped them within those
escaped parentheses I can now reuse that
as backslash one so I don't have to type
all that again if I had another thing in
parentheses well then that would be
backslash two and so on and so on
so that just saves me a lot of typing
and that's fun kind of there so now I
can just go ahead and you know I put
backslash 1 so it's going to place all
of the stuff that I just put in
parentheses there and now I can just
append it to it comma and this time it's
going to be pcap BTB be there we go
and I will want to do that globally so
there will be a / /g for global and then
I can and exit that and we're going to
do it on the file kismet Kampf okay
now if I do this it's just going to make
the change and spew out the entire
output of this file now let's just
scroll through and figure out if it got
it well rather than that I'm just going
to go ahead and pipe that into grep and
I'm going to look for log types so I run
that said command and I've piped it to
grep I'm looking for log types and I see
that I've actually added that right
there without even having to go over and
use V or anything like that this is
great if you wanted to say automate a
script to do an installer or something
like that now of course I haven't
actually modified this file see if I run
that grep again I'm going to say that no
I don't have comma pcap BTB be on there
what I need to do here is come back over
to said hit ctrl a to just go right back
to the beginning of the command and put
in tack I and this way it's actually
going to touch the file again grep it
and haha there we go
so we are ready to finally fire up
kismet our favorite plug-in or favorite
program for doing all sorts of fun
auditing and actually start packet
capturing some data off some Bluetooth
devices going to be a lot of fun so
kismet right from here actually and yes
it's yeah I know I'm running through and
yes we want to start the server go ahead
and I'm going to close this I'm actually
going to quit here because I started it
from the wrong location okay I want to
go back to home so CD is just going to
bring me back home PWD
and I'm in slash route all right this
way my five my log files are going to
end up where I want them so I'm going to
run kismet and yes again we're running
his route I get it well let's start the
server with the default options
let's close the window here and in just
a moment it's going to start complaining
that we don't have a source there it is
and yes what we need to do is define the
source so it yes and the source is going
to be Eber tooth all lowercase the name
is uber tooth and there are no options
so we'll hit add now using Groff I'm
going to pull up the kismet menu and I'm
going to go them over to plugins and
I'll see that I can select my plugins
and I have already done this before I've
already set up the uber tooth UI to
automatically load if this is your first
time coming in here you would come in
here and you would hit enter on this and
set it to yes and then you would come
over to close and then it would go ahead
and start working alright so now that I
have that plug-in installed and ready to
go if I come over to say my cell phone
and actually turn on Bluetooth I can see
here immediately I have a starting to
capture plenty of packets here I see the
MAC address this one that ends in 9 e 8b
33 that's that's my phone and if there
were other Bluetooth devices in the
vicinity like a lot of times
Paul's Mac Pro over there he's Mac Pro's
keyboard which could interface Bluetooth
with Android I would see those as well
but really what I want to do is analyze
these and that's what brings us to
Wireshark I mean you guys know I love
Wireshark it's kind of the gold standard
for all sorts of you know fun IP based
analysis and this is no different it
just happens to be bluetooth so all we
need to do to actually start playing
with these packets is to an install a
plugin for Wireshark that'll actually
allow us to see those packets the the
same thing the BT BB the Bluetooth
baseband and that's what's going to let
us do that so I'm going to quit kismet
here now
we're going to kill that and what I want
to do we're going to make a temporary
directory and I want to go ahead and
download the plug-in already compiled
and ready to go for Wireshark kind of
speed this up it's a very similar
process to install from source as we did
with kismet but for the sake of things
since we're already running the 32-bit
version and harvest gardener over the
BACtrack forms has already done this
week just download that and put it in
the right place and we all set
I've already mirrored this at my own web
server so I'm going to double you get
and unzip that and what we need to do is
move these files over to basically the
plugins folder for Wireshark and we're
all set to go so that's kind of nice so
I'm just going to MV star over to slash
user local Lib Wireshark and it's in
plugins and 1.4.6 is my version and
there we go they're moved over we are
off to the races we're ready to actually
start analyzing these so if I take a
look at the files that I've captured
here the kismet 1 so LS thar kismet I
can see that I have a dot pcap BT BB
that's the one that I'm interested in so
fire up Wireshark and point it to kismet
dot pcap b TB b and it's going to
complain that i'm running as root as
well yes I know okay and there we go
check that out I've got all of the
information here on on the source of the
different Bluetooth packets that we've
actually obtained seems that there are
quite a few MAC addresses in the area of
stuff that we've seen and the
destination in this case there's a lot
of broadcasting going on and we can
actually drill down here and take a look
at the frames and and all of the fun
stuff and actually start doing a little
bit of debugging so give you a practical
example and why you might want to do
something like this say you've got on a
Playstation or any kind of Bluetooth
device PlayStation is a good example
you've got the controller with the X
and the triangles and squares and all
that fun stuff maybe you wanted to write
a program for your computer that could
interface with the console the same way
that the controller doesn't know if only
you knew what the packet sequence was
that it was sending over Bluetooth to
that device hmm I know sniffing analysis
it's really fun reverse engineering
stuff and I'm really looking forward to
hearing what you guys think about these
kinds of segments of course if you're
interested in grabbing the uber tooth
you can find that over at Haan does a
great job getting those out to everybody
and stay tuned because in just a bit
Shane is actually going to be creating a
VMDK out of a bootable USB key but first
let's take a quick break and then we'll
check in with Kirby for the meow of the
week in this episode of the Ben Heck
show Ben addresses the lazy gamers out
there and he builds a dis changer for
the Xbox 360 so that you can select
between games from the comfort of your
couch stay tuned at element14.com /tph s
to find out how you can enter to win the
Xbox dis changer that he builds in this
episode remember to subscribe to youtube
comment hex show to check out episodes
and unique content</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>