<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Bash Bunny Phishing Attack With Hamsters - Hak5 2306 | Coder Coacher - Coaching Coders</title><meta content="Bash Bunny Phishing Attack With Hamsters - Hak5 2306 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Bash Bunny Phishing Attack With Hamsters - Hak5 2306</b></h2><h5 class="post__date">2017-10-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/TYR2a2XoK3A" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">phishing attacks with bash bunnies
base64 and hamsters all day and more
this time on hack five hello welcome to
hack five my name is darren kitchen my
name is shannon snubz Morris
it's your weekly dose of Technol us I
don't have a handle yeah yeah well not
the one that I say out loud don't even
get zero cool it's it's ultra laser the
master doom master of do ultra laser
you're so weird
making hackers references hey can I tell
them about the thing that I'm doing yes
please yeah as you point guard Li
off-screen I'm I'm doing a giveaway
she's own video games I am so if you all
aren't familiar
I do another channel it's called tech
thing it's Tek thing youtube.com slash
tech thing and I'm doing a giveaway on
that channel so all you have to do is
subscribe so you hear when I announce
the winner and comment on our most
recent episode of tech thing which came
out up five six days ago or whatever
that might have been
you could win in NES classic which I
just so happened to get my hands on and
instead of scalping it I decided to give
it away that's awesome you could play DK
yes you long see I have a handle my
windows login name we have another
announcement to Kirby's Adventure but
that's with an i yeah yeah our Kirby's
better our Kirby was Kerberos the the
authentication protocol obviously now we
have a big announcement to all right yes
dude just a quick reminder we are having
a big hack 5 gear launch event on Friday
the 20th so just in a few days here in
San Francisco it's gonna be at 7 p.m.
and get this you need to RSVP and bring
your ticket to enter the first hundred
guests are going to get a special hack 5
gear gift I mean like no spoilers or
anything Shannon but we are dropping 3
new devices so anyway we hope to see you
all there uh Shannon I'm going nuts I
can't wait I'm going nuts
ah anyway I hope to see you all there
and for everybody who can't make it you
tune in to snubz's live vloggity block
apparently I'm gonna do a live stream so
as long as the LTE is
over there I'm totally gonna get on
YouTube and do a livestream so you'll be
able to kind of feel like you're in the
action oh man
I'm ready for some action because we've
got an epic show this week so I feel
like I should set this up by twos a
little bit about some of the most recent
memes that we have so we have dramatic
chipmunk you know we have Doge and we
have grumpy the cat and Pepe the Frog
and then there was hamster dance way way
back in the day before them all they
they should be paying tribute they
should be paying their dues paying
tribute to hey mr. dance I agree so I
have a funny story about hamster ants
actually my dad worked in a hospital he
was a nurse and he worked with a whole
bunch other nurses and whenever he went
on his lunch break he would pull up
hamster dance back in the 90s and he
would turn up the audio on his computer
for all the kids I don't know boom I
actually have the gift on my system
that's me one of the many hamsters that
dance I can sing it for you but I don't
think we can play it and longer than
like five seconds without getting a take
count oh yeah he would he would turn up
the audio is super loud on his computer
in his office and then he would lock his
door and go to his lunch break for an
hour so everybody else in that office
space would have to listen to hamster
dance for an hour before he got back and
when he got back everybody would be
super ticked off but he was just like oh
what's wrong I love this song he like
ultimate trol Wow your dad is og troll
oh man it was so funny and then he would
do it at home and luckily he couldn't
lock the office door so I would just go
in there and turn it off oh this is
enough so in honor of the hamster gif or
Jif depending on who you are I know the
originator had a certain way of saying
it I don't remember which one he used
but it just won't die no really it's got
to go on that mainstays of the Internet
I know darren has been working on a
Bosch bunny fishing payload or would you
call it a prank payload or was that
before you that you said before we
started recording what it was it was how
you
neutral said ya mean basic you're gonna
troll is that that is the whole route
that's that's the purpose of this
episode but it looks great though
because you know the programmer from the
pineapple and the bash bunny and packet
squirrel and everything else doesn't
actually watch the so so I think I'm
safe
oh yeah nobody is going to tell so this
is our secret no I was reading the
comments last week on YouTube on the
episode and B Diddy said do most of
these payloads require administrative
privileges and so here's the thing no
the answer is no we have mainly been
focusing a little bit recently on kind
of your window specific hid attacks and
I mean it's just so easy it's low
picking you know low hanging fruit to
hack windows right but there's there's
plenty of other really cool
cross-platform attacks that actually
don't require any privileges it up at
all and today I'm actually looking at
one of them and you're mean yeah let's
cut to hamsters
okay whoo so what we look at hamsters
I'm gonna tell you a story when we
launched the bash bunny one of the
original payloads was one that subbro
and it was called captive portal in it
and it did just that yeah yeah yeah
captive portals so those are the
websites that pop up typically when you
connect to an open Wi-Fi network at like
a cafe or a hotel or your favorite
retail business that just so happens to
look like a bull's-eye or even in like
an airliner yeah I do too I really hate
that they yeah well we love those though
because you know they're cross-platform
inherently they're the web so it's
Windows Mac Linux iOS Android they just
they pop up automatically these days and
without any user intervention and it's
just a website no I think we know we
hate them we love them we hate them
because as you pointed out in hack
across the planet at hotels in Australia
and probably like everywhere else they
use them to upsell you expensive
Internet packages which then they bill
to your room and then they verify you by
asking for your last name and your room
number over unencrypted HTTP connection
yeah I was actually just in Portland mad
and and this exact thing happened again
like every hotel captive portal I've
seen has the same exact problem
unencrypted and I love
on a smartphone you can't actually see
the URL of the captive portal that
you're at at least on Android zero so
with this guy kind of crazy because it's
just like fishing tastic so it's it's
really a great attack vector and yeah
like I was even talking to like the
person at the hotel and they were being
discreet not saying my hotel room number
I'm staying in it right loud as they
shouldn't yeah and I was like oh
protocol when you've majored in
restaurant and hospitality administered
by you majored in podcasting I did stay
in school kids major in something it
doesn't matter anyway we're gonna be
having a lot of fun so yeah I'm on the
white hat side of things you know we do
hate them for their many problems but on
the black hat sort of thing side of the
coin we love it because you know getting
the job done it colors yeah I can't find
it
have you seen my cowboy hat anywhere
anything APB on it but if it were here
and be a little dusty because all right
so what does subs payload do okay so got
to go into army mode and plug this guy
in so I can actually show you that's
such a strange little laptop quit using
quick cut the gif of a hamster if we
pull up my bash Bunny and head over to
the payloads and over in the library
you'll find it under fishing and it's
just called captive portal and I think
I've already gone ahead and copied this
payload over to my switch one yes I have
okay and so if we so if we just take a
look at the payload txt you'll see here
you know this is captive portal by sab
1.2 and what you do is you give it some
inputs in this case its username and
password are the default and then you
set the ethernet mode so the attack mode
on this payload is actually only
Ethernet it's not keyboard storage
read-only storage serial any of those
things which is nice and then basically
you decide if you're on the windows
leave it as R&amp;amp;D is the Ethernet and if
you're on Mac or Linux set it as ECM the
Ethernet I'm gonna leave it as the
defaults the rest of it you don't really
get anything below that line but you can
see what it does is there's two
functions one of them is to set up the
networking
sets up forwarding and then it goes
ahead and it basically intercepts all of
the DNS and everything else sends it to
itself so that it can start the captive
portal the functions start the captive
portal here sets executable this file
and then runs the file with those inputs
and that file if I go back over here is
well it's written and go and it
basically is a little tiny web server
that saves whatever those variables are
out to to a loop file okay right and
then out of the box it just pops up a
captive portal that just asks for your
username and password it's not super
pretty but hey it gets the job done
right get creative so that's the simple
and easy tactic but you could plug this
into a machine and it would pop up
asking for your credentials and then if
you make it look as legit enough which
you totally could you can make this look
like a phishing campaign page that's a
knockoff of the real thing chances are
they're going to type in their password
right I mean that's that's the whole
concept right and you can edit the
portal dot HTML as you see fit in fact
here's the thing though right send left
out an important feature in the code I
feel right if we actually inspect the
readme MD here on line 14 it says the
portal dot HTML file can be modified as
seen fit but changes must remain in the
file no external images CSS or
JavaScript what does that mean
well what that means is you know
typically you're used to you know doing
some HTML I know that you're familiar
with us because you've done like geo
cities back in the past and you would do
like a if you wanted to embed an image
you'd do image IMG SRC equals quote
whatever the file is quote so how are
you supposed to put the hamster jiff
that I'm hoping that we're going to use
into this captive portal if this is
happening oh wait I get it this is why
you send me that URI link is exactly why
I sent you that do it starting the
things read data schemas or schemas or
schemas or whatever gained lightly con
ounces yeah it's basically it's a way to
your data URI schemas is a way to embed
images whatever other external resources
inside
of a page as if it were just like an
externally linked file it's supported on
all modern browsers and you know in fact
if I just take a look at this portal de
HTML I'll give you an example but just
edit that guy like let's see I don't
know right at the top here above the
heading I'll do like image' SRC equals
file gif right and that would be
typically yeah that's my thing except
and I know that I used to Geocities the
crap out of those right so instead of
that what you say is your SRC would be
data : image slash and then you can do
gif or PNG or Gipp whatever right so I'm
gonna do gif semicolon and then you just
give it the base64 contents of your gif
file and now you've got a gif
embed it in your website so it's an
image it's in base64 not binary I take
it okay so how do you get the base64 out
of that Jif or gif right okay so
basically there's a pretty cool
powershell one-liner that i want to show
you that i've been using and i think
it's pretty cool if you're on linux
there's a million ways to do this as
well but this is pretty cool get this
base64 convert there's a convert
function be built into PowerShell so if
I just do convert to base64 string and I
tell that to get the content of this
file here which is my hamster gift right
then what I can do is pass that to pass
that of a thing called encoding type
encoding is well right now it's buy it
okay and go ahead and close that and
boom you can see there's the file except
in base64 Wow so that's very similar to
cutting a file right there it is
literally just like cutting a file if I
do a cat hamster but you'll notice the
difference is now I get all this and
that's that's not the base64 that is
going to be able to go into the ASCII
file that is my portal that HTML
there you go right so there and so with
this I'll be able to update the page
okay so isn't this the same type of
technique that you used to get
executables onto a box by typing them
like really click quickly into a bash
money or a USB rubber ducky into the
command line just in Reverse this is
just the reverse of that got it I love
this technique big 64 is nice because
you can I say read it you know it can go
in your ASCII file yeah and it can be
turned into binary and similarly we can
just do the reverse of that so you see
where this is going the last part that
I'm going to do here actually is I now
need to get this into our poor old HTML
files so I'll run that again but I'm
gonna go ahead and pipe the output of it
to clip which in PowerShell haha you're
like wait where did that go it's
actually now in my clipboard so right
here I just hit paste and boom I now
have a lot but it's actually not too bad
I mean it's this is only a fist
yeah there's only 15k file so I just
saved this and I'll just be ready to
eject my bash Bunny as per usual can we
do a demo yeah sure okay I get that on
switch position one okay and now just go
ahead and plug it into my computer and
you'll see what happens here
so I'll just minimize everything to the
desktop you can see I had nothing open
mm-hmm just plugged it in watching the
LEDs and there we go it worked
yay and there we go that's so cute one
part that I forgot to mention is you
need you need after the semicolon it to
say base64 comma and then your basics t4
but yes you guys get the idea through
the magic of editing we now understand
that our captive portal has become super
cute that's awesome so that was all done
with URI then yes and here's the coolest
part about that about the ability to
embed stuff with the data URI feature is
that it isn't just in the web page yeah
you can actually just put this in the
URL bar now it has to be less than scary
whatever the URL bar can fit which is
quite a few characters really and it's
not even just images though so it's
anything that can be converted into
base64 is one example well it could even
be text you do even do like plain text
right so you could actually do the HTML
of a page that's got its all in images
embedded in everything this entire way
base64 the whole thing yeah and then put
that in as just in the browser you just
that's freaky potentially do phishing
attacks with the address bar at the top
yeah I mean look at this I've got in my
address bar data colon text slash
instead of basic support I've done plane
and it's like hello hello world write
whatever you want that's know if you
wanted you could just make an entire
webpage with this right and then I mean
it doesn't except you know you couldn't
be like Hello
there we go that's that's not gonna
yield the results that you're expecting
yeah course if you write out the HTML
and then you convert that for days 64
and then you plug that into the address
bar there you go all right so now that
we've tested some stuff full machines I
can say that it officially works I'm
free I'm excited because it means that
you can bring dancing hamsters to
friends that you dearly care about oh I
love used to own hamsters and they are
amazing pets I will tell you that and or
use browsers that automatically pop up
on boxes to do beef hooks it's
ridiculous which works even if you're
vegan all right so we announce the event
we have done our awesome segment I
talked about my giveaway on tech thing
what else do we got oh we have a sticker
we have stickers bring in the sticker
yes so this is just a very small packet
of stickers but this is from one of our
viewers and he says hello hack five team
here are some sweet stickers from meta
pipe comm for your laptops and well meta
pipe makes setting up cloud workstations
running Linux super easy for everyone
especially artists enjoy from Erin Thank
You Erin thanks Erin with Darren this is
pretty cool so so again that was it it
helps with setting up cloud workstations
running Linux servers so that's useful
I was lucky out and I'll put it right
there under snort and
naked and then we got extras one for me
and one for you thank you really
appreciate it if you'd like to send
stickers you can find out the address to
send that to over act v dot org slash
address that's kind of like a pointer so
that if you're watching this in the
future and we move it'll always be
consistent that's right kind of like a
substitute to the h-drive
which that's another topic for another
day hey listen why do you have a
keyboard on so it's the Microsoft Apple
keyboard right I've actually been using
from my home office I've been using this
on the surface just because I like the
clicky clicky of it yeah and I thought I
would get the same keyboard for the
office and so I just got to the office
here today to record this here episode
and this came in from the online big-box
shop that I ordered it from and I just
wanted to unbox this here with you and
show you something that I noticed
immediately when I opened up the box
okay brand new oh why
what is that why is there a piece of
beep on your keyboard not just I need is
there any way that we could like what in
the world the focus I will zoom and yeah
you can totally see they wrote on it
yeah what is it
rape WRA 175 4-0 it's a password that's
somebody's yeah so this was a return or
something and they didn't check the
bottom of it and somebody left their
password somebody literally on the
bottom of the keyboard don't put the
password on the bottom of your keyboard
everybody knows that you put it inside
the cd-rom drive because he was using
those any wooden object stop but at
least it wasn't like a post-it note I
mean there's so much failure use it fill
number one somebody returned it somebody
did this in the first place fill number
two Microsoft didn't check it
yeah well oh the plating go back to
Microsoft probably went back to
measurements yes
and then somebody looked at and said yep
doesn't look disgusting to me
Wow yeah no that's great though cuz it
really makes me wonder like how many
other pieces of electronics have been
like returned with surreptitious things
not just stickers on oh yeah that's a
topic for another time but we don't
condone anything weird oh my gosh Wow ok
hockshop calm to find all of our awesome
hack 5
gear including the new things that we
might will be announcing yes for 20th
exciting Oh who's gonna do this on every
episode
if you already have it's not like we
made it
pink and purple or anything it's not
like you got your own active gear as an
homage to your squirrel eNOS anyway that
right there should have been a anyway
I'm Darrington
no I'm gonna be snubz I need a pink wig
for the UH for the geologic actually
with that all said I'm gonna say trust
your technology when you got a brilliant
idea like bringing hamsters to the
internet in a dancing fashion you should
do it the way that Shannon and I do
which is to head over to domain.com
because they have a very serious domain
discovery system which will help you
find the best hamster related URL for
yourself and when you go over there use
the coupon code hak5 it's a special
coupon code set up just for hack 5
that's why it is a check a 5 which does
this very here show Shannon and I use it
all the time
they've got an easy checkout process
makes your site pop and online in no
time flat and get this the guys over at
domain.com they've been supporting hack
5 for years and you can show them your
support with a little tweet over at
domain.com and say hey thanks for
supporting show all these years and also
don't forget here's that coupon code
hak5 it saves a 20% of check out at
domain.com so when you think domain
names very seriously think domain.com
I'm trust your tech not lust seriously
though like curious about this keyboard
words don't work I know right you know
there's a whole program at the NSA like
intercepts devices in transit and then
they embed electronics in there so I'm
like I wonder if the NSA like this was
like their thing like oh yeah Darren's
got a new keyboard make sure to plug a
ducky into that you might want to check
Duquette</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>