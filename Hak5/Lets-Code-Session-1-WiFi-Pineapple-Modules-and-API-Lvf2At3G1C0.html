<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Let's Code: Session 1 - WiFi Pineapple Modules and API | Coder Coacher - Coaching Coders</title><meta content="Let's Code: Session 1 - WiFi Pineapple Modules and API - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Let's Code: Session 1 - WiFi Pineapple Modules and API</b></h2><h5 class="post__date">2016-01-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Lvf2At3G1C0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome to the very first ever
let's code I'm one of your hosts Darren
kitchen and I'm Sebastian Kydd oh yeah
I'm coming to you guys from 720p land
where as subs got the HD stuff going
this is going to be a lot of fun yes so
we have the ability to switch around to
our desktops and show you guys some fun
stuff that we've been working on and we
figured that this would be a great
opportunity to dive into the the Wi-Fi
pineapple module system and the api's
I'm going to be helping to moderate this
stream so please leave your questions on
IRC to hack 5 org and pound pineapple
you can also match the directly to me on
hack 5 Darren and chat as well as on the
YouTube chat and you can also tweet at
act 5 Darren on IRC as well yeah very
exciting to get this going sab we've
been talking about this for quite a
while yeah we have God yeah a year or so
that we wanted to start these and uh I
guess now we are here we are what better
way to start off with that um you know
developing modules for the new Wi-Fi
pineapples right so this is for the the
latest Wi-Fi pineapple sixth-generation
system that is both on the nano and the
tetra and so we're very excited to show
you kind of like how the backend how to
make these modules how to manage them
how they work some of the API stuff and
we're going to go ahead and get right
into that so let's uh let's get some
rollin jenkees going yeah music always
yeah and evolving right totally
so walk me through it sub I'm going to
play noob here and I'm going to need a
little explanation of basically what is
a module on the Wi-Fi pineapple right so
so modules on the Wi-Fi pineapple the
the ones the most common ones are
so-called GUI modules and modules that
you can see on the web interface here so
if I just quickly pull this all up all
of these are modules and all these are
system modules but if we go up here and
we say get module smartphone or comm
we're going to get a list of modules
that are currently available and you'll
see that all of these are right now
they're Gy modules but the way we have
one more type which you won't see here
right now because it's not released yet
but there's CLI modules and CLI modules
base your command line only UI modules
can also have a CLI component but I
think today we're just going to be
covering GUI modules nice yeah so it
looks totally different than it did
before sab but why is that well we
redesign the entire system we we're
using bootstrap for example for you know
making it look prettier and having to
spend time on developing which helps
other people also create their modules
in a you know more rapid way not having
to worry style guides and so on so you
just we just use bootstrap for
everything
stalling modules is now super simple
it's all for the front end we use
angularjs for the back end we rewrote
the PHP API to have this single input
single output type of model and yeah
and so these modules are these things
that we do or these things that anybody
can do who can write modules anyone so
anyone is aptly able to write them the
the modules get submitted to us and we
will review the module and then we're
gonna make it public if you know we
obviously check because it needs to work
one and two it don't have any bad code
in it so we don't allow you to ship
binaries or something like that
only if we compile them host them
ourselves yeah that kind of brings us to
like how they're hosted and stuff
because I know that installation and the
whole management of it is pretty simple
you want to walk us through how a user
would manage modules right so if in
terms of just it what do you mean in
terms of sorry well I mean if you're
talking about like the repository I
don't have to like download @rg zap jeez
I didn't like SCP it over to the
pineapple no no let's watch it I just
did this a moment ago so if you look at
if you look at the modules right now
I've got one installed right I'm gonna
install another one how about cabinet is
really so install to sta card and
downloads the module installs the model
and will be available right away so see
it on the sidebar it popped up I click
on it and this is a manager basically a
file manager newbie run so this is nice
because it looks very consistent with
the rest of the right exactly bootstrap
makes got really easy so what we're
going to be doing here in a minute is
we're actually going to start developing
yeah I'm excited to do that do you mind
turning off your redshift it's a it's a
little bit orange
awesome okay no worries man I mean
redshift is a novel you know helps the
eyes yeah it's shout-out to those guys I
mean that's an awesome program for
anyway our salute one of those as you
are coding late into the night so I
guess let's go ahead and get started I
want to follow along I want to build my
first module more than just hello world
let's build something useful here that
we can uh I don't know just get stuff in
and out of the pineapple maybe some
simple like you know get some uptime out
and send some past some parameters to it
things of that nature
sure yeah let's uh let's create a I
guess we need to understand a little bit
of the structure then exact how a module
is so so let's talk about how a basic
modules organized the first thing I'm
going to do is I'm gonna in a empty
folder right here I'm gonna create a new
folder we call it sample just gonna call
it sample right now to you know how to
create any modules could be any module
name but this should be consistent with
the module name you choose and also
notice that I use the uppercase s that's
because for the API the class needs to
match the folder name in terms of
spelling in classes should normally be
spelled with a capital S so what does
that mean about does that change
anything when it comes to spaces for
instance or is this actually just the
directory that it's going to reside so
this is the directory that the module is
going to reside and obviously never use
spaces in a directory name or file name
that's a Windows thing we don't do that
but so yeah so so the first thing is
that we need to create a few a few
different folds so the first file we are
sorry full file structure right so the
first thing we need in our module to
make it a module is a module dot info
file after a module title file we want
to create a directory because we're
sorry we want to its GOI component so we
want to create a HTML file this is where
basically or UI is going to live I'm
going to create a JavaScript folder and
then
Touch module s create Java or JA where
we hold our JavaScript obviously you
could import that somewhere else but and
then we're going to create an API folder
and in there were also going to touch
API page alright so those are or or
first this is our basic structure this
is what we need to make a Gy module so
I'm just going to open this in my
favorite editor everyone's is a
different way so you're not opening this
is the Wi-Fi pineapple nano though you
would develop it on the nano using nano
right I mean that just makes sense right
no because I prefer not to develop
modules on the pineapple itself although
it's totally possible what normally
happens is if you're called Darren you
reflash your pineapple with unreleased
modules on it and they just wiped out
all your progress
oops yeah yeah that's never happened no
cows none so I'm gonna just open this in
sublime text because that's the editor I
choose to use I'm gonna do the uploading
from the terminal just to you know make
it a bit easier for for people to follow
along what I'm doing exactly so yeah
definitely is like install your SSH keys
because you're just going to be SC
peeing the folder right so if I actually
so I've done that already if I ask this
AJ and I exchange keys already but so
that's just to make it easier so what
we're going to do now is we're just
going to quickly upload this folder edge
we're gonna go on folder out and we're
going to upload this folder to the
pineapple and we're going to do that by
putting it on time into pineapple slash
modules
right there so I'm just copying the the
sample folder in I'm just doing it this
way it you can do it many other ways you
could copy the files using a GI program
if you're not comfortable to CLI or you
can do it through the bond text which is
what I would normally do because it's
easier I can do on a file by file basis
but just for the sake of this I'm going
to oh you know what I did this yesterday
for oh you're trying to login it through
what's up with that boy I uploaded all
these files and right now if I if i
refresh this you're not gonna you know
oh hey a similar sample yeah but the the
sample itself doesn't but they're empty
you've just touched the file exactly so
it set this module to HTML
sorry module dot dot info we first want
to define or or module basically what
some information on we do that using
JSON so the first thing we want to give
it is a title the title is going to be a
sample module or yeah we want to give it
a version moving it 1.0 for now and we
want to give it an author it's going to
be you just save that and you'll notice
that if I if I upload this now and i
refresh this this page up here you'll
see that actually say sample module
stuff nice so the title differs from
your actual module and the same goes
JSON or so this is just a JSON array
that where we're putting into a file
yeah now for the module um the the HTML
contents because we use bootstrap I can
I could just create a quick div just
incredibly well now but just to show
this off
obviously you know repeat this process
of uploading and refreshing and it says
hello so this is all very very simple
stuff there's nothing you know special
about this yet but so we use bootstrap
so you can make the whole thing a bit
prettier so the first thing I'm gonna
it's a panel fault so all of this is
something you can look up at the
bootstrap documentation or if you you
know do it if I'm not a web developer
normally but you know this is uh well
let's see can you will actually increase
that font size just a little bit thanks
appreciate it so we got our so we have
our token HelloWorld at least yeah so we
have our hello world let me uh yeah
let's make it pretty it's me yeah so
that's uh let's make this a bit more
pretty oh god why is it doing that so
all of these are just the presets that
are in the bootstrap CSS yeah so all of
this is is this so I'm just under so you
know showing making this a little bit
prettier that we've got something a bit
nicer
and if you want to know if you want to
learn HTML the best person asked is Fox
Trot correct yeah yeah Fox shot over on
IRC the high fived org absolutely love
CSS especially CSS right but he will
whenever I see has questions I go to him
right absolutely okay so we made it look
a little bit prettier but obviously this
isn't really um you know what we want to
do is the fall it ever so that's module
ever uh you know we'll see if anybody
they say the president said font choose
Yakko rank says I'm perfect so let's go
with that font size cool so you know we
have hello world but this in itself is
is not very interesting now we have a
static module which we don't while we
don't need a dapi so we could have
actually not made this HP API part here
so we're first going to start you know
with a couple of JavaScript things
because we use angularjs and that might
not everyone might be a familiar with
angularjs so to make it a bit easier we
created a few wrappers we created a few
functions that make the interaction with
the API dead simple so the first thing
we need to do we want to create a
controller this controller is basically
going to be what what we're gonna talk
to here where this is the template and
then in the controller we're going to
talk to the API and relay that to the
template so the first thing I do is
register controller do it that way and
we're going to name that and it's these
or modules called sample I'm gonna name
this as a sample
roller mind you this needs to be a
unique name or should be a unique name
so it's always good to prefix this with
your modules like is it why would we run
into problems have two modules used just
the same controller yeah will happen is
controls get overwritten and you know
because they're lazy loaded in you
should not do that they'll be conflict
so so the best practice is just prefix
it with a module name now nice um so so
now what we need to do is we do
something called dependency injection
and we created a service called API and
then there's another service called go
which is important and then we're gonna
actually write the controller in here so
everything what resides inside of this
controller if we want to enter it in to
interact with that module data HTML as
well so we don't need just well we can
have multiple controllers and I'm going
to show
to link the controller to the HTML and
second okay but for now we create this
controller and to register this on the
HTML side we actually have to go up here
and we have to say ng and you see how
there's lots of different things oh yeah
angular for for meta types and also why
you should be running sublime well other
editors will do is - but I'm not a very
needy
um so ng-controller and we hold the
sample controller so what this will
allow us to do is allows us to to put
variables in here so for example say
hello string right so this is our hello
string find out reload or if I upload
these files and I reload this you're
gonna see we get no output there's
nothing here if I go into our module dot
us into the control that we just define
I can do scope scope basically hooks the
the scope of the so this is the scope
and we can hook into that so what we do
is on the scope I named it hello string
so strength equals hello world and if I
and that's what that it'll automatically
get oh no rub it on low string capital s
lower when that happens
that's something out didn't I what did
you leave out I know I made a mistake no
you never do that no I do
oh there you've got a bracket in front
of API our API right there on line one
that's the yes that's meant to be there
oh that's meant oh what I forgot to do
so though so this is this is something I
should have mentioned um well this all
that crazy one-liner is yeah where you
have to so we have to define generally
the way I in scope but we also have to
consume that so API scope so we do that
and we upload that and yeah hello world
sorry about that
no worries ah yeah but it's so that's
that's kind of like I don't know I've
seen that before and things like liquid
yeah right so this is basically just a
certain template in the templating
system that angular uses right so we're
able to to define whole strings like
that you can also do you know you could
do math in here so you could do 6 times
6 um and that should give us 36 there we
go you know you can do that stuff but
just a math live on the air yep
absolutely that that means more to
Darren and I but so let's put that but
this is JavaScript too so if we wanted
we could like write all sorts of crazy
JavaScript snowflake keys yeah please
don't do that the terrible practice but
um ok so so let's do something more
interesting there's a couple of things
in angularjs that we can use and that we
will use in a second just to show some
more input now port right so say I
wanted to create a table and in the we
want to display a list of items but we
don't want to write all these items that
we don't hard-code them so how do we do
that in angularjs so what we do because
we just do that one in the right yes we
could but let me make this prettier
first
actually what we're doing this we should
do this right way right yes and do it in
the night frame I'm sorry I'm just here
to troll see what okay so because we all
love tables right because that's the way
you totally need to do stuff well for
tables for tables tables make sense for
anything else they don't you just call
stuff so I'm gonna make a table of stuff
and this will look so we have to call it
something yeah so just do you know make
sure that looks make sure everything's
good so we've got a table entry and you
know stuff is one of the items yes yep
looks good so now that we've gotten this
and actually I you reversed those but
that's okay yeah I I can't now this is
this is what happens when you do things
live and forget things out looks right
there yeah so so obviously this is
relative Amish so what we're going to do
is we're as you can repeat this TR and
that we do that with an NG repeat this
and repeat will allow us to take a
variable so for example thing uh yeah
thing and things let's be very thing in
things yeah because it's going to come
back yeah so well so yeah the this is
basically gonna it's basically for loop
and we're going to loop over but we
obviously need to find things somewhere
so we can do is inside here we can do
just like we defined cuts here we can do
slope things and then we can pass it we
can
and shoes
sure so if we then load that we should
get tailor for things okay so I'm just
giving a very brief rundown of some of
the functions of angularjs it's a it's
something that you might be making use
of that line I'm probably really yeah so
this line so now the thing is this isn't
too interesting yet right we are you
talking about this is the best module
ever Sabbat to get a million download
well this is very static content right
so if you want some dynamic content we
and we want to write our own dynamic
content we'll need to go into our module
up a tree we need to write our own API
component and that's gotten a lot easier
to do than before okay now now we're in
my happy place your happy place yes sure
that I saw the PHP open Brad right so so
I'm taking it this is where I can do all
sorts of terrible things like doing is
sets that gets and all sorts of other
bad stuff right no so what we're gonna
be doing here is we're going to write a
relatively clean module so the first
thing that you're gonna notice is we are
always going to be in the namespace
pineapple I'm just putting up here
people can yell at me for style in there
but you know this keeps it out of the
way and everyone needs to do this for
the modules anyway we we create the
class sample notice how sample and the
sample here both of the they need to
match so if you do an uppercase s you
need to do an uppercase s here too the
only function that you need to have for
this module to even load is the the
route function
and that looks like that so all we do
here is create one function of one we
need to we have to have we have to
implement this function otherwise the
module of the reason why we do this is
because when you're passing a request to
or API we handle the routing for you and
in the end we call your route function
and then it's up to you to route certain
requests to certain functions of your
module obviously you wouldn't have to
use just so fast so that's the basic in
and out of all modules so basically so
so the way it works is there's a couple
things are exposed in a module for you
the main ones you need to know about is
this request that's one of them then we
have this response and we have this
error so those are the three so it's
like standard in standard out in
standard error yeah pretty much
and the way it works is this these are
all objects that hold the request and up
hold the response of the error so for
example if I wanted to set a response in
this wave function I'm going to do right
now excuse them this response equals and
then I could say for routing sure let's
do this so so what we're doing here is
we're doing a really simple response
where we could oh we're not responding
to anything we're just semi right now
we're just we're just sending response
whenever the round function is called
you could also do something like like
this right so you can specify an array
that gets sent back and what happens is
the reason why you set a response and
why you've never do something like echo
battle you won't do this because we have
the single input single output model
where you break the response doing this
and you'd because what happens is
angularjs expects you to pass JSON back
at least with our implementation so we
will automatically take that response we
will JSON file we'll send it over and
extract again passed to the right places
so what we do here so we obviously
arrange it right so Roger function let's
just let's just try to get the string
back from the API okay because this
we're sending this response whenever
this module is loaded you don't have to
create a what is it responding to it
what I'm saying it's on a kit right now
does not respond to anything we're not
making a request yet okay so let's ask
it right so in our module what we need
to do is we have this you notice I
previously you know I basically imported
this API service and the way that you
make an API request is by typing dollar
API request equals sorry like that and
this this function takes two parameters
the first one is an object which is the
request object the second one is a
function which is the callback function
what happens when it completes and it
takes a response so if you don't care
what the response is you don't actually
have to get the response back but we
want to get the response so we're gonna
put response here so what do we have to
send to it to get that response yeah let
me get there um so the first now we need
to do is we just specify a module and
the way we specify a module the way we
specify a module by typing in module and
then we say well or modules called
sample and again this will coincide with
whatever you called it right here and
your folder name so sample and then we
want to well we don't need to pass
anything else because we have done it
and so right now what happens is that
this request will automatically hit the
API and it's going to call this route
function and because we're not doing
anything we're not taking any requests
in we're not treating anything we don't
actually need to pass anything we're
just immediately setting the response to
routing function so what we'll do now
here in this response we probably want
to check for errors but we'll handle
that in a couple of steps later the
first thing we do is just going to take
response
actually when they say soap dot text
equals response so we're doing that
every time this is called so this when
this controller initializes we make this
request and then we're going to set the
scope text and to response and so let's
define that to an empty string and put
that somewhere here so I'm going to get
rid of or tape or actually and we just
replace the hello string right why not
right so let me upload that and what
you'll notice is right now again so
module J's text is undefined if I reload
this page it says routing function right
because what happens is for a second it
stays blank and when the request
completes we get routing function put in
there and so it just replaces whether
well we it really doesn't replace the
text what it does well it replaces the
variable right so it so if we wanted of
this variable to whatever the response
is answering so just because it works
just to show this off we can do that and
as you respond with an array and when I
do this you can see that it'll handle
this for us so nice you wouldn't want
this you would actually specify
something you can also pass named arrays
but we'll get to that a bit later um or
associative arrays I mean okay so this
is the simple way to make a request
right the thing is this isn't not useful
we won't often want to make a request
when something is clicked or when
something happens so what we want you to
do is we want to define a function on
the scope and women call this function
what you want to call this function what
do you want to actually do let's the I
um let's get the uptime from the system
right so
so the way we define a function here is
we just this I'll type in your shoes
today so we define a function what we
can do is we can just grab this and for
all of that in here okay so what we do
now is is whenever we execute this gal
per time function we're gonna execute
this API request and it's going to talk
to the module sample the thing is this
alone isn't going to give us anything
but a routing function right it won't
give us anything but whatever we put in
here so let's clean up this code a
little bit let's actually make this
useful so the first thing I'm going to
do is I'm going to create a function
every time why is this one that private
function where is the other one is
public because of keeping functions away
from other people oh no it's basically
there's no point in this function to be
to be nothing else will call this
function so we don't need to expose it
there's no good point so we make it
private okay does the rat one need to be
public the right one has to be public if
it's not public it can't get called by
the API so why one has to be public and
everything else can be private or
protected if you want to override it
later on so you can build whatever you
want to build okay but so in this getup
time function we need to set the
response but before that let's actually
start routing because that's what this
function is all about routing right and
I like to do routing this is the way
that I prefer doing you could of course
do if something else if something else
like this and then you could check this
this request I don't know get up time
and then you could you know load the up
time and you know you could do something
here right so you would then execute the
get up time function but this is not the
way that I would prefer doing this so
because it gets messy really quickly and
you get constant check if something is
set so the easier way or what I like to
do is I like to define a variable called
actions which I'll always pass here but
we'll get to that in a second but so all
I do is I switch over that so let's
create the switch statement and roll
this request actually and what this
allows to do is allows it to specify an
action in a request and then just take a
case and to return whatever we want to
for that action so it keeps the code a
little bit neater and easier to manage
so the first thing is we said get up
time so up time is what I do here and
inside this code this catch up so when
you do so we can put like all of your
basically everything that you would all
you of your requests just in this switch
case yeah so so obviously depends on how
big your module is but for for most
things yes absolutely so all you do is
you add another case and another you
know get a date or something like that
no call another function cool
right and then we also defined it down
here but so that's that's the way that I
would do it this is a way to keep it
clean that's you know at least a sing
simple way to do that so let's let's
actually return something so again
spawns we need to set the response and
I'm going to do this in a bit of a dirty
way I'm just gonna do an X Act which you
know is fine because we're on the
pineapple and there's the easiest way to
interact with this I'm going to do is
I'm going to execute the uptime command
I'm going to set whatever comes back
here as the response I could also do
something to show off a little bit more
let's actually do an array and let's set
the uptime to that so this is just an
associative array that I'm defining here
in in PHP and I can write so this is
what's passed back so what happens is
the you're gonna we're going to create a
request to the module sample we're now
going to pass it an action because this
is the variable so anything we pass
inside this request object is what's
going to get passed here to this request
object so if you create an action an
item action then we've got it here too
so what we can say here is just get up
time and we're gonna do some yeah let's
do that
no stopped let's do it right so we
talked a little bit already I said that
you should probably be doing error
handling because what you could do if
there is an issue if you're if you're
executing some some more data you
probably want to if there's an error you
want to set error to something so again
you could set it to you know an array
you could set to a simple string that
depends on what you want to do but you
might want to check that no error occurs
if you're you know possible if then what
it's send out an error if there's going
to be an error if there's either a PHP
error there would be an error if you as
the module developer basically throw an
error so you'd set that error variable
then we pull that error back so anytime
you want you can specify this error this
is up to the developer there's a couple
of errors that we send if no responses
were turned or there's there's a few
reasons or a few few scenarios when we
will send an error but normally it's
something that the user will set
themselves so to quickly check that
there is no error though if it responds
dot sorry dot err Wow
so if the response is undefined what
we're going to do is we're going to set
the witness s so got something to
response start up time and we're gonna
call that time suddenly are rid of this
stuff because we don't really need it
cuts up time right so we've done now is
we've created a function which when
executed is going to send request to the
module sample with the action get up
time in the module we're going to check
it up time is power called then actually
call the function and the functions
going to set a response so this is a
really simple i/o example but that's all
we'll do and obviously now if I if I
upload this code and so how does that
response end up equaling a scope of time
give me a second here so what can you
repeat your question well it's just
wondering if you go back to the module
j/s yeah so how does the response end up
equaling scope that uptime oh I see
scope dot up tainan line number 10 yes
goes on stat up time so it's always so
it's always response dot whatever we
define well it's in this case I passed
an array back so because it's array and
this is an associative array the uptime
is set to whatever this exit comes so on
here the response is you know the the
whole array and then uptime is is that
particular particle which equals exact
uptime yep
so so right now as you can see nothing
happens this there is a string here if I
set this to you know for example not
loaded for example you'll see obviously
nothing is happening here so let's let's
quickly add a button because we well
couldn't we just in the actual module
just have it immediately call that
function we could have it we could
inside the modular yes we could just
call the function obviously don't get
time that you're gonna see we get the up
time after our place shorts it so let's
let's do something more interesting with
this though let's let's have it be user
input so pretty hello yecchh okay so
that alone obviously isn't enough just
because it says get up time here
nothing's going to happen one press this
so there's another ng on the is another
angular T - yeah whatever is another
angular directive you so ng and it's
click and on a click what we're going to
do is one of X could get up time
function again because we can do this
because it's defined on the scope so
this is why it says scope gap time aha
so far proven so the HTML when you click
the button on HTML then that sends it
send that execute the JavaScript
function which then asks for it from the
module PHP the module PHP executed on
the system gets that and throws it back
as an array to the module J's which
populates the two squiggly brackets up
time yeah exactly so so if I hit this
button you're gonna notice that it
actually increments this number here so
you know IH nine ten cool so it'll just
call the function every time so that's
that's really simple you know getting
something from the API and again this
could be anything as complex or as
simple as something like this right so
the next step is something that you're
probably going to be doing a module is
taking input somehow there's a couple of
interesting ways you can do that but the
easiest way to do it so something I
should have said in the very beginning
though the way we handle the API the API
is post only so we always post or
requests to the API we don't use get
just because it makes management easier
it makes the handling of the theme the
routing of the easier right now that's
actually some of the nice stuff is
that's what I don't want to do is all of
that ugly you know using gets and saying
if it's set and what to send back and
managing all this so all of this is
managed for you by those request
responses and errors right so that's
done for for a few reasons one of them
being security another one just making
it really easy for module developers and
just you know keeping it nice and clean
and organized and easy to develop I also
nal visitors due to relatively rapid
development as you've seen we're taking
a really slow but it's it's you know
we're getting there so let's take some
input on the first thing to to talk
about and the first important thing is
let's modify this to sound just a
gorilla's ng-click for now to specify an
input I'm not going to get pretty so we
just have some text in here now and send
text obviously it's not linked up to
anything so it's not gonna do anything
so what we can do now is angular has
this actually called ng and I always
want type buying but it's ng model and
we're going to set a module that's a
model that's on the scope so we're going
to call this input text for example so
it's going to be okay
so what this does is allows us to use
this variable on the scope or let's
define out of here
again we don't need this
I'm doing a search nothing right now so
no more up come now enough for now so if
i refresh this you see there's no
content in here and syntax again does
nothing cuz we have talked any better
but if I change this to world for
example and upload that again refresh
you'll see that this allows a hello
world so this is really useful because
what happens is you are going to be able
to call create this API request
basically which can pre-populate inputs
for you and if you then hit save or you
want to do anything this is actually
live updating so if I update this the
variables being updated live to quickly
demonstrate that well we can do that we
could couldn't we just use those curly
brackets again and just like paste it
back right so I'm just going to make the
text of the button which is a bit
accurate now what I'm going to do is I'm
just going to upload this and you're
going to see that the button else is
hello world but if I remove something
nice so that's a kind of a neat little
function of angular which allows you to
you know
that's why I always want to save mine
but it allows you to bind models so data
models to an input and you can do this
with anything with with you can do this
with anything for example with
checkboxes or radio buttons or forms or
text fields or you know anything like
that gonna be able to do that with but
so let's actually make this make this
more useful let's get rid of that and
what do you say we actually do something
with the values that you input into that
yeah we could like write that to a file
how about Stella we how about we send
this to the API first let's get the
front end done and then we can modify
the server-side so this is kind of like
the complete reverse of what we just
done with uptime kind of no let's let's
let's let's go through this one by one
so so the first thing we're going to do
is we're going to want to create an
ng-click again am i going to want to
make it save text and this don't need
that so we're going to do here we can
take the same function basically same
function signature so we go to scope dot
send text
fede and we had an API request in here a
diesel truck outside is going against
net okay so again we make the API
request to our module sample and the
action because we like actions is going
to be okay so if we want to make this an
input only if you wanted to make this an
input only
action right and we didn't want to care
about the response we get rid of this
and we couldn't look at we you know send
a response back and just say success
like hey I received your text so what
we're going to do here is we're going to
create another variable I'm going to
call that some message and no message is
set right now and in this function what
we're going to do is we're just gonna do
a little bit of error checking error
which is darker then we want to again
we're not we don't need to some response
at up time if we're just gonna respond
with a strain that we can just do this
straight away and obviously if you want
to do error handling you could do
something like this
all right so then you set the message to
whatever you're sending as your okay so
the this is the basics here but let's
because we now introduce this message we
probably want to include it somewhere in
here so I don't it is I'm threatened you
did
that and we're going to just put message
into there you'll see that when I reload
this we have this empty well up here
which doesn't really look very pretty
you don't want to keep that there
because the message currently said -
nothing right because that's just where
our error will go where I guess our
success message so you know it'll look
like this once there's there's content
popular in the book because there isn't
right now kind of spat so what we're
gonna do so we go to our module HT on
this is again another angular attribute
which it's great to use ng-show and we
only want to show if there's content so
we just have a message so it'll show it
when message isn't it contains values
basically or returns is true so if I
reload this now you'll see it's gone and
if I were to set it to something it will
little you know pop back up so
we can do that let me get this and then
if I go to module dot PHP here we can
leave the getup time just to make it you
know a bit more realistic at another
case we call it save text write or send
text sentence send so if we sent the
send text action which we're doing right
here mm-hm
then we're going to be able way we call
this function break afterwards and we'll
just create a new function and so this
is where we will actually do something
with that text right correct
so the first thing that we want to do is
there the first thing we want to do is
we want to know how do we actually get
this this input so the exact same way
that we got this request action right we
can get this request and then whatever
we send but you'll notice that right now
the action is that aesthetics we're not
sending any data right so how do we tie
that into the input field so the way we
tie this into the well no not tied into
the input field how do we get the scope
input text to be sent well that's as
easy as doing the action so all we do
here is we send text and then we say
scope dot input text so that's all it
takes and now what we do is we send
whatever is in the scope so currently
hello world but if we modify this it'll
you know
update the the input text variable on
the scope and then whatever is currently
set when we hit some text is going to be
sent over so this function is going to
be called whenever and so what about on
the PHP side do I have to say well how
will I receive that do I have to specify
that same name that you said there in
the JavaScript so exact can you do this
so you you go here and you look so
what's the action that I'm sending will
the action send text and the text is
going to be input text so I need to put
in here so it'll just be text yeah so we
say text so this is this is the soul
here
oh I see we're sending what we're
getting the request from text from send
text
No so what's happening is is again we're
we're sending the action is sent text
right so we're looking up here in which
way is that acting right there the
action is sentence we're calling the
sent text function in the sent X
function again everything in your module
has this order this request object
available to it so inside the request
object we have just set a text variable
Crichton so now we're different a
station whatever this is we're not
requesting that we're reading that from
there ah it's ready it's already been
sent got it so we're accessing this text
and whatever is set to it so it's just a
key value pair basically so we're
accessing whatever is sent in here which
will right now be hello world asd asd
asd right but so hello world and now we
want to do something with its text well
the first thing we do is we could return
this test right so what we could do is
you could just you know return the text
that we're currently getting passed as a
response just to make sure that we got
everything right that you know all
everything links up nicely
reload this page hello world and I hit
Send we get back hello world all right
Darren
we're going to get this sent back from
the API right so this is kind of you
know we're we're again going on a loop
so let's actually do something like this
this request text what do we want to do
with well I don't know we're in PHP
we've got text we could we want to do a
file contents yeah so what we can do is
we can do a simple call to file contents
and let's put engine into TMP and I and
we're just going to write out this
request text and to make sure that we
can append multiple values we're going
to add a new line and we're going to do
file up and like that obviously this
looks terrible on my terminal right now
because it's so small oh my oh my
sublime but yeah so what we're doing
right here I mean this is simple PHP
we're just putting the contents of this
request we're just throwing that into
the sample file and we're setting the
mode to file a pen so that we don't
overwrite the file of you try and do
this we probably want to check
we want to check that you know if we
want to do this do that and then
obviously here we set this response and
file save okay so don't forget that and
upload this again now we should be able
to say some text since this file saved
hello world away Darren I swear I can't
uh grenier so let's go kappa file so so
let me just say pineapple here i'm have
temp sample file and you're going to see
it says hello world and hello Darrin I
hope this isn't too small but either way
it's their relief nice um
so well you know what's really cool
about this is you were showing me in
part of the API earlier say I wanted to
actually make something that requires
configuration I wouldn't have to say
file put contents that and say slash
Etsy such config in a config file I
could actually use UCI for that and
things of that nature right so we
actually have have V this is the module
that you're extending since the class
that you extend in our modular page
there you get a few things that are
available for example executing
something in the background it all it
does this bit makes it easier for you
right but you know you can install the
opkg dependencies here you can check if
the SD card is available check if a
dependency is installed check of
processes running and what you were
talking about you can get you CI values
you can you can set you set value so
this is really useful because now let me
see this is what I'm talking about
because when I was writing OpenVPN which
I lost because I was doing the wrong
thing by writing it on the pineapple not
locally all right backups are fun but it
was just too so much overhead of having
to like do the UCI calls and such to
like write to file contents to the
config file and all of that stuff so
there was a lot of like I don't know
this kind of standardized is it right it
don't seriously yeah I write the UCI
system now to to do that you're gonna
have to familiarize yourself a little
bit with you size system so you're gonna
need to use these type of paths when
you're so the setting string but this is
something you learn really quickly and
you can pick up pretty quickly so right
but no longer do I have to do things
like you know PS aux and grep for things
to check if something is running correct
yeah
and again the same goes for that and
we've got download file which we'll
discuss later you get the free current
firmware version so if you you know if
you want to make sure that your module
only ones in a certain firmer because
you're not supporting everything then
that's that's an easy way to do awesome
so what else shall we cover is there
anything you would like to cover do we
have questions we have questions and it
was figuring you know this is we're
about what 50 something minutes into it
so I want to go to much on this very
first one I think this is a good example
of just introducing the basics of the
input and output and how that works I
mean there's a lot already you can do
once you start tinkering with this I
think though it's very I think you
should point out module maker before we
get to the questions because a lot of
the stuff that you did just to get this
started could be done for you right well
I wouldn't say a lot of the stuff but I
do agree foster has made this module
called module maker so if I'm going to
install that it's going to make him so
happy that we're doing this so so got
module maker module maker even tells you
a little bit about the different files
so module HTML you know it tells you I
think I found error
Fox Trot I want to fix that but yeah so
so you know it does describe it does
describe the values but what you can do
is you can create a module test module
and give it a scripture as you forgot to
include a description so inside your
module ID info we would do something
like and that's something that could be
like extended over time you could have
for instance a help URL exact there so
weird I think in one of the next
upcoming updates we're going to do
something like how URL put your forums
link or whatever something like that
well we'll come up with something nice
we also want to add change logs and so
on to
for uses but let me finish this so if I
generate that you're going to see it
actually you know created the what you
call it sample module yeah there you go
they got it yeah no tests no test module
so I have to refresh my page for this
but if I go to modules in the test
module it'll actually you know put some
some HTML all right and show you that
this is loaded through angular and so on
so um this is messy but yeah so there's
there's ways to make it easier there's
ways to make it to generate these
initial files but once you've done it a
couple of times then it becomes really
easy I mean creating these these one two
three four files and these two folders
is a matter of you know just getting it
set up awesome okay well do you want to
get into some of the questions that
we've received absolutely all right well
the first one here comes from Auto Bowl
I'm sorry
audible blink and he says I'd like to
create an angular service I noticed that
there is a function called register
controller I'd normally create a service
with app dot factory which takes both
name and function and app being a global
variable he says is there something
similar to this for services oh sorry I
was meted um yeah so there there is the
problem services is that you'll have to
lazy load them like controllers and
that's something that I can get into I
would rather get into later because it's
kind of a longer thing to go through and
very specific but I can definitely write
something up on that on how to easily do
that mmm cool all right well you know I
think that we should definitely add that
to the list of future episodes I'd love
to tell you that's why I like where
we're gonna go see what the feedback is
yeah everybody's going to come back and
say like I hate your keyboard but you
know it's okay
you're not rocking to Das Keyboard what
are you doing right now
yeah Rodan he wanted to know he says
this he just wanted to comment about the
bracketing system he says this bracket
syntax is needed putting dollar scope
and other services into the parameter
lists for the function is where
angularjs depends dependency injection
actually happens the bracket syntax is
to preserve variable names during
minification yeah I I know that but
that's why I'm putting it there because
you may minify we might minify on the
fly and so on so um that's yeah yeah
well I mean it looks good to me I like
it because my eyes snap to it I'm like
oh I know what I'm looking at there
right so but that's a style thing well
yeah no sure but but that's a benefit
and guess you don't have to use the
square brackets there you could just
pull your function directly and you
don't have to define the controller
there you could also just do you know
finding there's angle directive to find
the pineapple app and then attach that
which is by the way how you would help
the service and if you're still
listening audible link but you uh we do
it because it's the best practice so
nice all right I also received another
question here from koh rang who just
wants to know that there if there's any
good online resources you can recommend
for angularjs angularjs is home page has
some really really great tutorials if
you can stand there they're you know
30-second intro video music thing that
they put on on everything but it is
actually there's good good stuff on the
summer is more out data but you're going
to find so many resources on YouTube and
the official ones by
by angular jets are really good at
angular Tahoes also very good awesome
OS 1 R is 25 let me see if that's in
liters
Oh Cirrus yes it is Oh Cirrus rights
yeah I'm wondering if I bring this into
a location and I get success of what I'm
trying to do how easy is it then a is
talking about bringing the pineapple to
a client site I'm assuming it says then
how easy can I export the data from my
actions and not have to take screenshots
and so on so it's not particular to this
coding session but more generally
speaking with the pineapple right well
there's a couple of things that you can
do on the pineapple we I mean we just
added for example the ability to in the
end PI ap - yeah good stuff from the log
yeah so you can actually download the
pineapple the pineapple yes ID pool here
you can go to your log and you can
actually download your log so you're
able to do all of this stuff now there
are functions if you're a module
developer there are functions that you
can use to expose the downs I mentioned
that for for a second there the the
inside the inside the leave yet but yeah
inside the API a function which you can
use to download a file and and Boggan is
that I think the next the next video
we'll talk more about that yeah that's a
great point and actually I want to say
that that's one of the modules that I
want to be building in fact with you is
putting together you know in module that
does analysis because there's so much
interesting information that you can
glean from the pine ap log and I think
would be really fun to to build that out
as we go
received another question here from
Matthew who says would it be possible to
set up an NTP module to change the time
of the target computer to unvalidated I
SSL Certificates right well so there is
actually a module on the mark-5 called
delorean and it's a CLI module so it's
something that
I'm hoping we'll get ported anytime soon
if not then I'm sure there's lots of
people that would just you know quickly
report it
sorry porch it over but it's just a CLI
pythons trip right now so absolutely
something that will get added now the
effectiveness of it is um is in yeah the
effectiveness of it is is different so
it depends on the Machine depends on if
it's vulnerable I'm not going to get
into the whole SSL strip and SSL split
and as your aces HSTs thang here because
it's it's a very long thing which ends
up with people it's very confusing of
which websites are still vulnerable
which systems are vulnerable to which
downgrade attacks fair share and so on
yeah that's fine
yet you down with that yeah sure so Ken
wants to know if we can take a look at
some of the authentication and anti CSRF
stuff in the firmware real quick yeah
absolutely
so I mean isn't that it's that's a lot
of the emphasis and yeah so uh so I can
pull up this for example so what we do
to give you a really quick rundown
because you know love you Ken
so uh so what we do is we we quickly we
just call our API and we initialize the
magic method and this actually takes
care of the the security so we call this
function we do this only thing that that
that is the only get request here which
is the handle downloads which does this
where we actually stream a file down but
we get into that later and then we check
if you're authenticated and that way
what if you are authenticated we're out
and authentication is done a couple of
ways the first one is that we set we're
using angularjs is built in a way to
pass cross out requests for your tokens
we do that by sending a basic header but
then again authenticated we check if
you're logged in but the actual
authentication is done in here
and again so we have API tokens which
again we'll get into some time later
you're logging in verifying your
password so on authentication is checked
yeah you'd have to be more specific with
what exactly you want to see okay's well
it's a it's a pretty low latency stream
so yes that's why back if you applies
then log and and well he does I've got a
question here from dem sec who wants to
know if there's currently any support
for asynchronous calls he says it would
be pretty cool to have an automatic
notification when you get a new client
connected and I guess that's just an
example and you know what maybe you pull
up the what is it the f12 tools called
and second let me switch over to you for
a sec there we go so so if you if you
watch this right up in the corner here
if I am a very bottom of the window yeah
if I hit oh you know I just hit up enter
a bunch too sure very good and so what
happens is that we actually have these
notifications we have a notification
system built in that's something we
probably should have you know gotten
into maybe but we'll do it next time so
we have notifications that you can send
so you're absolutely able to execute a
script on the backend and then have it
send notifications be able to hook into
certain services with that PHP itself
obviously runs for how long you send off
the script and quickly things like
forking to the background but it's um
it's asynchronous in the nature that we
have eight threads start listing
constantly so you can make calls at the
same time but it's it's not a
synchronous I think in the way that
you're thinking for they get things like
no
cool I just wanna quickly want one nice
yeah yeah I got what - about what Ken
asked about the security the the big
thing here is that the the big thing
here is that we haven't just a single
input and a single output apart from
this download so there's there's very
little vectors that are attackable here
which allows us to if there is ever an
issue to you know fix it relatively
quickly and get through that without
having to do and branch out into many
things there yeah it's good stuff I
think that it's really important to
standardize this and you know by
providing that API it means that you
know no more hacky stuff because I'll be
the first to admit like man my PHP is
hacky at best so thank you for all
pushing for pushing us all to use this
whether it be PHP node.js and all of
that that brings me to the next question
from Jason C who wants to know why don't
you just use node
yes hub how come you're not using node
um so so notice heavy and I despise node
and that's personal I guess but I you
know I I don't like node they it's got
lots of hubs ah it's got lots of
benefits I don't get me wrong but it's
something that's just too heavy to run
on the final
right okay cool well we're going to wrap
it up and here in just sec we do have
three more questions real quick Renton
wants to know if we're going to host any
of these files that we made today to
make them available for everybody
watching at home to take a look and play
with themselves yeah I can to play with
the files themselves not with themselves
you sure we were doing you know a a some
more tests earlier I just gave you I'd
stop it said doing a professional
podcast right um no but so uh so
absolutely you can make these files
available I'll clean them up a bit and
include all the different files I and
the code I removed so that there's
examples of everything just kind of
clean it up and I'll post that later yes
and you should join us
forms to hack five or you'll find the
the Wi-Fi pineapple boards there and
you'll find all the links from Wi-Fi
pineapple comm as well it's been really
active lately it's been awesome as well
as right down there irc2 a quadric pound
pineapple we've been you know having a
lot of fun in there so join us
so Retton we'll get those samples and
two last questions before we wrap up I
would like to keep this an hour if
possible Audio blink Wow says what's the
location of module PHP file with the
helper methods just for the front of it
and find Oliver API in slash pineapple
slash API and you'll find the module
page being there along with everything
else
cool yeah you'll see all those nifty
functions that you can send stuff in and
get stuff out and everybody's happy
right that's how it works right sup and
then you know it actually just J Tech
wanted to know how we do our livestream
and I will just point to a lad a video
in the description on my personal
YouTube channel where we kind of show
the craziness that is this and I want to
hear your feedback about it too because
we could have easily
I say easily we could have done this in
a Google+ hangout and done hangouts on
air but we lose the ability to do proper
screen sharing at least in Linux where
it will stretch three monitors across as
one gigantic screen you can't see
anything it's a mess or you have to
share on an application by application
basis and you can't switch from say
sublime to your terminal to your browser
directly you have to go back to your
webcam and back again every time you
switch applications it's terrible
so I just want to know
you know let us know in the comments
your feedback if this was cool if it was
terrible what you think just generally
speaking as well not just the the setup
here because this is something that
Sebastian and I would like to continue
doing so if you have more ideas for
topics that you'd like us to cover go
ahead and let us know just leave those
in the feedback yeah cool
whether that's that's it that's it first
ones in the can I think we're done cool
alright so with that we will see you
guys next time we're not sure exactly
what the release schedule for this will
be it really depends on the feedback I
don't mean in the next I thought the
next one launches in an hour there oh
right so we're gonna go prepare for that
know we'll see we'll see I mean we did
build a lot of infrastructure for this
so we'll be doing this again here soon
but definitely send your questions if
you have questions for us to cover next
time it will help guide the show with
that I'm Garen kitchen and I'm Celeste
you're gonna thank you very much yep see
you guys on the Internet Cheers</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>