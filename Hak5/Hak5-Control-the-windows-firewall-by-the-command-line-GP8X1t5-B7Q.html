<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hak5 - Control the windows firewall by the command line | Coder Coacher - Coaching Coders</title><meta content="Hak5 - Control the windows firewall by the command line - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hak5 - Control the windows firewall by the command line</b></h2><h5 class="post__date">2008-06-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/GP8X1t5-B7Q" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so here's the problem I've got 50 pcs on
a network all running windows xp service
pack 2 using the Windows Firewall and
I'm rolling out an application which
requires a couple of ports to be open on
the firewalls now what makes matters
worse is it's not a domain network so I
can't use group policies this means I
need to go to each machine individually
and change the firewall settings
normally this means going through a
bunch of gooey but I don't want to do
that what we're going to do today is
show you how to automate that process
with a couple of batch scripts so we're
here in our command prompt and let's
take a look at some of these commands
that are going to make life a lot easier
first is net Sh firewall show config and
this is basically going to show us the
configuration of the firewall whether
it's enabled what ports are up in what
programs are using and what we want to
do is create a couple of batch files the
first one is going to disable the
Windows Firewall so let's run copy con
disable dot bat and enter in the command
net SH firewall set up mode disabled
press control Z and enter to save the
file now if we run disable dot bat it
disables the firewall now we need to
create a batch trip to enable the
firewall again so again copy con enable
not bad and this time it's net sh
firewall set up mode enable now when we
enter in enable the firewall turns on so
now let's get a little bit more advanced
what we're going to do is create two
batch files which are going to open the
port's that we normally use on our
computer or close those ports and this
is great because it allows us to change
profiles depending on where we are like
if we're sitting at a coffee shop on the
Wi-Fi so in order to do this let's go
ahead and create another batch file and
this time we'll name it open ports
so for this example we're going to show
you how to open closed two ports and in
this case it's going to be 80 and 21 as
if you were running a web server or an
FTP server so we've gone ahead and
opened up our open ports batch and we're
going to run that Sh firewall ad port
opening TCP for the protocol 80 for the
port and we're going to call this web
server and we'll do the same again but
this time change it to the port 21 and
call it FTP server now we'll run that
batch file and it's going to open both
those ports now I'll create a batch file
close those two ports so a copy con
close ports not bad and net Sh firewall
delete port opening TCP 80 and the same
goes for port 21
now who run closed ports there they go
now we're going to automate the process
a little bit more by creating an autorun
de INF file for that copy con
autorun.inf the first line is going to
be bracket autorun bracket the second
line is going to be action equals config
firewall but it can be anything and the
next line is going to be shell execute
and in this case we want it to be equal
to open ports bat save the file and
basically what this is going to do is
when we pop in a CD with these files on
it it's going to look for this auto run
to INF and if it finds it it's going to
see the second line which is shell
execute equals open ports up bat and
it's gonna run that batch file now it
gets a little bit trickier with thumb
drives or flash drives or whatever you
want to call them and that's where the
action equals config firewall comes in
when you use a removable drive like a
thumb drive flash drive whatever and you
plug it into a Windows XP machine
service pack 2 it's going to pop up a
little dialog you've probably seen it
before asking you what action you want
to take it won't automatically run the
autorun to INF however at the very top
of the list will be config firewall all
we need to do after that is press enter
and it will run our batch script so now
we're going to take all the files that
we've created and put them on a CD so we
can take them from computer to computer
I'm going to run start thought to open
this folder and Explorer fire up a copy
of Nero create a new data disc drag and
drop this files over to the CD and we're
going to call it firewall config
and let's go ahead and burn it so if
you're like me and you've got a lot of
commands that you need to run on
multiple pcs that aren't on a domain
network you can use the same process
with the autorun to INF to call a batch
file and run anything you want so now
that our burn is complete let's go ahead
and finish this check CD pop it right
back in and it should go ahead and open
those ports on the firewall there it go
two supports are open now one last thing
we can do to make life a little bit
easier if you're on the road between
hotel networks and wireless networks is
to create shortcuts on the desktop -
these open ports and close ports patch
files and this kind of allows us to have
profiles depending on where we are we'd
also like to stress that nothing beats a
hardware firewall and you should not
only rely on the Windows XP built-in
firewall</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>