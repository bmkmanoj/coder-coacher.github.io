<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>USB Micro Controller hacking with Richard Harmon at Shmoocon 2014, Hak5 1525.1 | Coder Coacher - Coaching Coders</title><meta content="USB Micro Controller hacking with Richard Harmon at Shmoocon 2014, Hak5 1525.1 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>USB Micro Controller hacking with Richard Harmon at Shmoocon 2014, Hak5 1525.1</b></h2><h5 class="post__date">2014-02-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/9JqFp31ARkE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this segment of hak5 is brought to you
by domain.com hello welcome to hak5 my
name is Gerren kitchen
I'm Shannon Morse its weekly desert
pickles and we are so excited yes we
were told that we need to banter more in
fact I know so funny so what's new with
you um wedding planning
cats and I see our radios there we go
bring it back we got an awesome response
from this STR series that you've kind of
embarked on here oh good I haven't read
any of the feedback a journey of the
rift oh you have to eat everything I'm
sorry Kylie cuz I'm really hungry I'm
really hungry show meatball sub I just
introduced a new show called coding 101
and I've been busy with that nice ah
that's about it and then SDR nice oh and
then you're doing active yes so oh yeah
that's right yep
yay so excited to bring that back I spin
fellas so fun doing that cat on hack tip
so that's pretty exciting I've never
learned how you've got other cool Bashi
stuff coming up soon too so that's all
good how I do I guess so
oh all right surprise yeah okay
we've got a great show for you guys this
week we're actually talking to Richard
Harmon he is an awesome security
researcher from the DC area cuz I'm back
from check on all sorts of fun goodies
from there such as so until you USB
controllers and snow yes there was no
that sounds fun yeah it turns out USB
controllers a lot more interesting than
I don't know it's like suddenly that's
what I see with the hardware hacking the
last several years it's really like
taking off yeah it's like everything has
a bootloader everything's got a micro
controller that could be buzzed in some
weird way to do some stuff so why not
that's exciting I have to see all the
fun things that happen out of this well
I am doing my little bit more about SDR
but this time I'm delving into watching
planes
ooh I love plane watching in fact I have
a giant book at home for all of the
outlines of different planes it's fun to
be able to really yeah it's fun to kind
of be like is that a 7-3 or is that an
a330 well let's see it's got a longer
little tail thing airbus has got big
but your son is gonna say that's true
well that's cool yeah well what do you
say we get right into the first segment
cool well let's throw to a and by the
way thank you guys for all understanding
that when we do conference a coverage it
may look like we put people up against
the wall and that's because we do we try
not to get Splash Damage of like
recording people in the background
because that's no good we really respect
everybody's privacy at hacker cons and
so if it seems a little weird because it
is but it's because we respect your
privacy and so let's cut over to Richard
Harmon with a little glass video about
fuzzing USB so Richard tell me what got
you interested in exploiting USB
controllers so I heard all of the
stories about bad BIOS and I wanted to
actually understand what was possible
and what was plausible and I wanted to
figure out just how possible it was for
there actually to be some sort of virus
that would transmit across his feed
drives and if that wasn't possible what
actually was within the realm of
possibility so I mean typically when you
talk about viruses transmitting over USB
drives people think about you know
autorun exploits or something like the
ducky that would do a keyboard injection
attack but you're not talking about
anything on that kind of user level
you're talking about something a little
lower level can you kind of go into that
so I haven't actually depth into that
dived into the low level assembly stuff
I'm actually primarily focusing on how
you can repurpose these thumb drives to
do more interesting things I have I do
have a couple of friends they're going
to help me learn the assembly language
that is used in the controllers so maybe
I can actually write some viruses that
will exploit machines so what have you
found out about the actual controllers
what's the landscape looked like so it's
basically an off-the-shelf Intel 8051
microcontroller and then they just bolt
on some things on top of it to do the
flash memory storage or the USB
controller of five and
additional RAM and other things some
mask ROM for boot code and stuff like
that but it's basically a full-fledged
microcontroller that speaks USB and then
has additional storage bolted onto it so
the possibilities are out there for bad
things to happen and I just want to
figure out how possible it is so what
tools and techniques are you currently
looking at so I've got a hardware
sniffer and a software sniffer that I'm
using I'm trying to figure out how I can
reverse engineer the firmware that comes
with the software that reprograms these
controllers to see how I can leverage
that and run my own code on them so they
can actually be reprogrammed straight
from the bus absolutely almost all of
these USB flash drives have insert
programming over USB you don't need
something complex like a JTAG programmer
or an IC ISP programmer to just like pop
a chip on you can do it straight over
USB and it was just going kind of like a
loader mode where you can push code to
it or something
it's basically an undocumented vendor
command over the scuzzy protocol over
the USB mass-storage commands the
controller goes into a programming mode
and then you just dump executable code
at it and the actual process for
reprogramming the controllers first
sends a burner file and then actually
sends the firmware for the controller
I haven't found what the distinction is
between the two just yet but I'm working
on it so when you first started looking
into this what we're kind of your
initial findings when you you know of
course go around the block and see what
others have done um I had seen other
people using u3 drives and those are
highly specialized for you know the
cd-rom auto run stuff but I hadn't seen
someone who had actually documented and
kind of told the world in a public
setting almost all of the drives that
are out on the consumer market support
these features so I wanted to make sure
that people understood that there are
things that could be you know bad for
people like forensic analysts like how
can I trust what I've recovered off of
this drive is valid data for like a
court case or how can I keep my data
secret and make it surreptitious to
someone so that I don't that my data is
safe and so how are you able to actually
manipulate the drives using the
proprietary vendor software that has
been leaked on various websites through
russian websites or chinese websites
there's probably something like fifteen
or thirty different manufacturers of
these controller chips and almost all of
them have had their software in some
version recent versions or a couple
versions old that amid leaked to the
public websites and people are writing
how to's is just not quite as public
knowledge as I had expected and once
again a reaction that you got here at
Xiuquan I think it blew a lot of
people's minds that they probably
already have hardware that can do all
this and how shocking it is that these
things are chock-full of features that
aren't mentioned on the consumer
packaging and it just opens up more
possibilities for people to do cool
things so are you releasing proof of
concept code or documentation and how
can other people find your research and
kind of get involved and snooping around
the USB bus so I'm going to release the
1000 word document shoot smoke on
proceedings online the slide deck will
be online as well and I'm going to have
a blog post on my github account so
that's where all that github I oh and
I'll have all of the how-tos on how I
learned how to do things because a lot
of it was trial and error and there was
a lot of flash drives that I bricked in
the process of doing this a lot of
buzzing yes yes a lot of clicking on
boxes I weren't sure what was going on
with all like Chinese software a lot of
it is ink is in English not all of it is
all Chinese there's usually some radio
boxes between like Chinese and Korean
and English what was the moment when you
downloaded the Chinese executable and
you're like sure I'll click on that I
totally have a dedicated laptop that
boots off of the network with I scuzzy
so I can revert any changes if anything
bad actually happened but I am running
antivirus and so far nothing is flagged
anything well hey thanks for sharing
your research and hope people can get
involved with your github and follow you
on twitter where my twitter name is
xavier XA b EA n thanks so much it
Cheers thank you
you guys know it doesn't matter if
you're a Navy SB transponder or a teak
ass receiver when you have that killer
idea need to snag yourself a domain name
and web hosting fast and with domain
coms quick domain discovery system and
they're easy checkout process you can
have your website up in no time I mean I
love domain.com because they're
affordable they're reliable they're easy
to use and they're huge on social media
you can tweet them at domain.com and see
what I mean and the guys over at
domain.com they're huge fans of hak5
they want to hook us up so get this if
you use the coupon code hak5 when you
check out you're going to get an extra
15% off when you think domain names
think domain.com and now it is time for
the trivia question of the week last
week's trivia question was and this was
really easy I know the USB and USB cable
stands for what and the answer is
Universal Serial bus surprise surprise
surprise this week's question is the
first female computer programmers were
called what what was their nickname you
can answer that at hak5 org slash trivia
for your chance to win some awesome hack
5 goodies
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>