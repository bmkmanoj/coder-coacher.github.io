<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>HakTip - DEFCON 19: Wireless Security Assessment | Coder Coacher - Coaching Coders</title><meta content="HakTip - DEFCON 19: Wireless Security Assessment - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>HakTip - DEFCON 19: Wireless Security Assessment</b></h2><h5 class="post__date">2011-08-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/tpcrjkR-OrY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this active is brought to you by busted
tees here at DEFCON 2011 they tell you
don't use the Wi-Fi and mark warrior
from immunity Incorporated is the exact
reason why that is the case mark thank
you so much for taking some time to talk
to us here about this nifty software
here what is the name of this what does
it do its name is silica its immunity
inks wireless penetration testing
utility it's basically meant to take all
of the complicated things about a
wireless penetration test and put it all
into one easy-to-use GUI so does this
replace a lot of the traditional tools
that I would be using on a wireless
penthouse like you know your kismet sand
and your Metasploit sand all of that
stuff exactly this this tries to be the
one solution for all that and there are
some great tools out there but this
tries to make it as easy as
right-clicking in order to to get what
you need well you're a developer your
wireless pen tester what what are the
whys why is this come about I mean
you've used air crack you've used you
know all of those other tools why what
is it that this fills that those where
do you feel that there's left off well
most of those tools are focused on
actually getting on into the network
like actually cracking the key the
silica takes that a lot much further and
answers the question what can you do
after you have the key
yeah sure it'll crack the key it'll
crack the web correct the WPA but it
goes so much further beyond that and
actually exploit ating the hosts that
are on the network or you know exporting
vulnerabilities that I can find in the
wireless clients themselves and the
networking devices that are on the
network grates okay with let's get an
overview of the software now how does
this software come when you when you get
this what does it come with how is it
packaged and then let's dive into the
interface of that this is actually
packaged as a virtual machine right now
you see the virtual machine running
in my Mac it runs on Windows and also on
Linux I prefer it on my Mac it's a smoke
this does Mac Mini it's a small form
factor but the idea is well we also give
you this USB card as well - you pick the
sr-71 we give you the virtual machine we
give you the card it comes with two
antennas $2,500 for the for the first
years of updates and everything and
$2,000 to rhenium after that all right
so you've got software all set up and
running I'm seeing network list cookie
view or fake AP what am I seeing here
what you're seeing is all the access
points that are within my range and all
the clients that are connected to them
you're also seeing the Bellagio as two
clients connected to it right we've got
two clients here it's telling us also
the vendor information over here it's a
Cisco there's two clients that are
connected to it of this type this comes
in handy if you know any proprietary
algorithms maybe that they use for
creating the WPA key or the WEP key you
know the default key is that some of
these devices have maybe you can see the
in the vendor information just we tried
to dump as much information in here that
you would use for the reconnaissance
phase of your wireless pen tests but the
idea is that you can also right-click
and interact with all of these these
networks in different ways okay so
what's a network problem and we're probe
does a reconnaissance on the network
it'll it'll look for network nodes that
maybe the operating system type even
even trying to basically go out on the
network and say what operating system
are you are you vulnerable to a
particular remote exploit that we have
we don't in this particular mode we
don't exploit anything we're just going
out and gathering information to see if
it's possible that we could exploit a
host and then another attack and then in
the middle we've got an attack here that
will allow you to do it'll it'll take
the network probe a little bit further
and once it finds a host that's actually
vulnerable to some exploit it will
exploit it it sends a remote exploit and
compromised the host then you have post
exploitation actions that you can take
to actually compromise the knowdon't
stay further maybe whether it's to
install a trojan or something maintain
persistence on the actual device all of
that is automated for you grabbing
password hashes off of the machine even
grabbing Wi-Fi keys off of the off of
the machine itself it's like a
machine it's going to just score those
hashes better read members for all their
all the keys for the wireless knows
exactly and silico actually one of the
post exploitation job available to you
is to download those keys it'll it'll
pull it out of the in the encrypted
store and yeah he just pulled it out his
plaintext so look at downloads a text
file so if they've connected to ten
different networks with with WEP or WPA
keys they'll all be in plain text for
you to use to actually connect to these
networks man-in-the-middle attack will
do an ARP spoof get all the the clients
to client-side injection man and middle
client-side man in the middle the forces
all the clients to come to this machine
and once it sees that you're making
requests out to some web resource it'll
actually inject a client-side exploit
into the browser out like diaphragm or
something it'll put a little iframe
little frame into the browser that
points to a client site exploitation
framework called client D which will
pick the right exploit to send to the
browser so for example if an Android
phone connects to his browsing the web
will and if they're vulnerable we only
send exploits if they're vulnerable
it'll it'll it'll send the right one so
if it says oh you're running Internet
Explorer sex here's this mole and if
you're running you know this version of
Firefox here's this vulnerable right
exactly so it's only gonna pick there's
a there's some reconnaissance that goes
on inside the browser that tells silica
which what it's vulnerable to and then
we pick we pick the exploit from there
okay and then the session hijacking them
assuming that's similar to like fire
sheep it is similar to fire sheep it'll
grab hooky cookies out of the browser
and allow you to replay them but it
takes you a little bit further than a
fire sheep has a has a predefined list
it is customizable but and in our
approach we we give you all the cookies
so this comes in handy when you're doing
a wireless penetration testing in a
network like a private network and
Internet maybe a client intranet will
you'll be able to replay replay those
cookies as well the other added benefit
is that you also if they have if they're
using WPA on their network and you have
that key if you rather used to look at a
crack it or you have it just because
it's it's a public network or
you have the key of some some in some
way it'll actually decrypt the traffic
for each of those clients so if it's
open if it's encrypted with WEP if it's
encrypted with WPA it's it doesn't
matter silica will will create a
decryption routine for all of the
different clients that are on the
network pull everything out in plaintext
and give you the option to replay the
cookie and break into the sessions could
you give us a demo here of doing that
kind of session hijacking with this sure
in fact it doesn't matter if you're into
video games movies science fiction or
just wrapping your torso with something
weird busted tees literally has you
covered you may have seen a busted tear
to pop up on movies and TV shows and now
you can grab one for yourself head over
to busted tees comm and find the shirt
of your dreams your bizarre hilarious
dreams and to promo code hak5 and save
an additional 20% off your order
in fact I can give you a what I'll do is
I can start an access point here and
we'll just pull the cookies right out
right okay so if akp so we're gonna
create you know what were you just gonna
pose as another access point yeah what
we can do is I mean I don't have a
network set up so we could if if we were
connected to one of these networks then
I could set up that and steal the
cookies but would you come back here and
like like D off the clients and then
send them you know beacons from your
access point posing as the other one or
if we wanted to actually kick off the
clients we do have that option but when
we become in this particular mode when
we when we choose passive session
hijacking it's all its passive in the
fake ap it does that exactly in this
mode it just listens for everybody
that's connected currently okay and
we'll put still the cookies out of those
of those clients traffic with the fake
AP I'm gonna be showing you the passive
session hijacking I guess just yeah
that's let's go do more what the it's
got a this would be a controlled network
that we
that we can pull cookies out of so we've
just become that Network we've just
become this network it's called mine 123
and Wireshark pops up here
Wireshark pops up automatically so that
all of the data because I'm gonna I'm
about to become this access point name
and actually looks like my phone already
connected to so that our IP address
their IP address Wireshark pops up so
that we can record all traffic that
happens on that network so we would get
like binaries out of there or anything
like that no it makes a user so we
already have a key Cap'n right exactly
so once I start browsing around on the
internet you'll see Wireshark populated
with all of the data so if I'm browsing
around here on Facebook for example then
you'll see my my Facebook traffic but so
this is just oh and this is and since
your laptop is connected to the DEF CON
wireless network here you're just
sharing out that internet that you're
acting as a router right they connect to
me and because in this this is powerful
because I am their network now I am
their DNS server I am their gateway I'm
everything so if they if they say where
is my where's my printer I can say I'm
the printer
they say where's my web server that I
want to want that ticket - well I'm that
web server that you want to authenticate
yeah that's the beauty of bringing the
clients to yourself that's you know what
we do with the Wi-Fi pineapple the idea
that you know don't even bother
like being on the outside trying to poke
in get them to connect to you because
then it's game over yeah they come to
you and that's all you need
so I so posted so now that they're
connected to us we can see the cookies
yeah so as we're browsing around here
I'm clicking around on links to to
Facebook okay and you see it populated
in here and all I need to do is
right-click on this and say send this
request and what's going to happen is
it's going to take all that information
and do take all the the cookies and
everything imported into the browser and
then now these requests I have anything
specific to this app of this network
which is Facebook Wow even the fact that
you know you're on the mobile page the
it actually looks just like it would
except with the with the word wrapped
not as as tight on that phone but yeah
yeah exactly we emulate everything about
the clients so the the refer field the
the user agent everything about it is I
to the requests so Facebook doesn't know
that you've been that the client that a
session hijacking attack is going on
exactly they have no idea because
everything about this is the same even
the high P address since we're behind
this in the same network we're behind
the same net which means the IP address
externally is going to be the same so
everything about this is identical even
on Facebook that's nice I don't know how
you would detect that at this point
you've covered all the bases yeah and
all of the all of the web application
protections that they have in place
there's a there's a long side and the
use of SSL this bypasses all of them if
they're doing any checks on IP we've not
but this bypasses that by default if
they're doing any checks on the referrer
field that this bypasses that might even
so can we do like a client-side attack
now we've got you know them connected to
the network we've got the client
browsing the Internet
we're like pop and iframe and see about
owning the phone here or you know what
would happen if you were to do that so
what I could do is in this mode here I
had the option to become a network and
or I have an option to become the
network with client side injections so
I'll go ahead and restart this with
client side injection what's going to
happen is the same thing as before
Wireshark is going to pop up I'll also
parse out cookies you know to get into
web application sessions but the added
twist is that now there's going to be if
I'm browsing around to some website
let's say for example I go to cnn.com
I'll go to cnn.com and silica is going
to try to inject a frame as you can see
here there's a little line right there
that we add in and that's actually us
and this is us sending an exploit to the
phone and what's going to happen is any
of the post exploitation actions that
you have set up for the device this
automatically determines that it's a
that it's an android device if it
actually exploits it it can set up
you've got multiple options available to
you but execute commands on the phone
use a local privilege escalation bug for
example to escalate to root once your
root then you can install a package on
there this is fantastic is this open
source this is it's written in Python
it's there is a license but it's all
open so if you want to add it add in
your own things after the fact and then
you may awesome then where can people go
to find out more on you know getting
into this immunity kink.com is our
company website there's a there's a link
for silica specifically we also have a
well we had a booth at blackhat but so
yeah immunity ENCOM you can also write
admin at immunity income to get more
information as well
cool dude mark thank you so much this is
fascinating thank you for making Wi-Fi
ever more fun here welcome thanks for
having</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>