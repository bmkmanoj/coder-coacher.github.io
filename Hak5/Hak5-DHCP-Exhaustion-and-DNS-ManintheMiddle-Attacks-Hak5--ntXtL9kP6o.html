<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hak5 - DHCP Exhaustion and DNS Man-in-the-Middle Attacks - Hak5 | Coder Coacher - Coaching Coders</title><meta content="Hak5 - DHCP Exhaustion and DNS Man-in-the-Middle Attacks - Hak5 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hak5 - DHCP Exhaustion and DNS Man-in-the-Middle Attacks - Hak5</b></h2><h5 class="post__date">2010-02-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/-ntXtL9kP6o" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this time on the show DHCP exhaustion
and DNS man-in-the-middle attacks the
Azuga
interceptor and a lot more this episode
of hack 5 is brought to you by Netflix
go to assist Express and domain comm got
a great idea
it all starts with a great domain hello
welcome to act 5 my name is darren
kitchen and we've done excellent show
for you guys this week
Robin wood is back in studio and we're
talking to him about DNS exhaustion and
a man-in-the-middle attacks and it's fun
stuff as well as some of the community
stuff that's going on with Gaza gah and
the Interceptor so you know stick around
for that I am of course well no I'm not
in the States right now I'm actually in
Dublin on the River Liffey and having a
good time it's been this is coming up on
the second last day here travelling
around the UK and Ireland having a great
time enjoying the like 1 degree Celsius
weather and motorbiking a lot like that
guy and and anyway I can have a proper
episode about this trip later so this
one is kind of a short one as I'm out
here just kind of like trying to be
nimble and anyway let's say I get right
into it I'll see you on the other side
if you're looking for an easy and
affordable way to get your website
online and check out domain coms hosting
plans their deluxe hosting plan offers
unlimited traffic and free website
builders with unlimited pages for just
875 a month already have a domain
somewhere else
support hack 5 enter sponsor by
transferring your domain to domain comm
it's only $6.99 a year to transfer your
domain plus you get an entire extra year
with domain calm you get registration
without the BS no totally unrelated
upsells and no deceptive renewal pricing
just blistering fast DNS
hosting the lowest prices on the web and
the highest quality thanks to hack five
fans domain.com is one of the fastest
growing domain and hosting companies in
the world don't forget to use coupon
code 8 JK 5 a checkout to get 15% off
you order got a great idea it all starts
with a great domain domain calm our next
LAN party is this weekend Saturday the
27th we're playing at game 2 hack 5 org
and yes it's Team Fortress 2 brought to
you by the varsity sports league Oh
check them out at the vessel calm that's
where you can find out a but there are
awesome game servers just follow them on
Twitter it's at the underscore vessel
tow Thank You vessel for your game
server support and we will see you
in-game
this weekend
that one's ethnic was that really a
busload of Vikings good alipio to world
war ii bug okay so continuing on with
the theme of man-in-the-middle attacks
Robin you've got this really interesting
Metasploit module or what is this DNS
and these UK exhaustion what does that
mean well basically what the attack does
it's much like module and it is $2.00
service attack on an existing DHCP
server so how does that it's a DHCP
server that not typically your gateway
that's giving out IP addresses to the
new clients on the network why do you
want to denial of service attack it well
usually they can give out a limited
number of I panes 5800 whatever right I
know on the hack house network we give
out IP addresses between tender tender
owed 100 through tender tender ODOT 254
yeah something like that 253 maybe yeah
yeah so a very basic level if you can
exhaust that supply of IP addresses and
all the clients can connect to the
network so you're not doing denial
service attack like a syn packet flood
or something like that you're actually
requesting IP addresses over yeah it's
it basically does Chris fake MAC address
and send out requests the router says oh
a new client on their network sure yeah
here's an IP and I say yes thank you
very much I'll accept the IP and that
gets tagged against that MAC address all
right and of course you've got a lease
on that IP address
yeah like 36 thousand seconds or
whatever it may be so now nobody else
can have that IP address until you're
done it's released
yeah okay so I keep doing that till
they're all exhausted it happens have
you've done this to DCP servers see what
happened yeah the this under Linux one
it basically just keeps giving that IP
still accounts and then he stopped so it
just it doesn't do anything it just
doesn't reply it just shuts up yeah I've
got nothing for you I was looking to get
your new beau another network you're
like hey can I get an IP address and
it's like nope why don't you say no it
doesn't say no so how
is that how does that make things easy
for how does the man-in-the-middle
attack and the DNS work into that now
okay so said the basic level is just
deny any clients meaning on the next
step up from that is okay North clients
can get on through that DHCP server so
why not fire up our own our own DHCP
server we can then give out DNS server
gateway information ntp information all
the basics of the use if you give so
you've become the DHCP server on the
network yeah typically you can't have
more than one DHCP server on the network
because they'll fight I know because
I've been to LAN parties back in the
early 2000s where kids would leave
internet connection sharing on and drag
people crazy but but like again with
having two of the same MAC address they
fight but in this case you've shut up
the first one yeah nobody notices the
wiser
no so you're now giving out your own DNS
your own gateway puts you straight to
the middle and so quite well what's the
one what's the special sauce there with
giving out that DNS server well once you
control DNS by default it's just
transparent so you say I want Google
Calm it gives you the IP for google.com
and we just put look up a sniff throw
but what you've got built into the DNS
server is the equipment of a host file
where you can say actually for
google.com don't give it
Google's IP address give it my IP
address at that point anybody trying to
get to Google will come to me Google
yeah you can annoy them a little bit all
right there bank and that says you know
you've become the man in the middle and
without ever sending one ARP packet you
know now using any special hardware
that's excellent so and I guess you
could even couple that with something
like airdrop ng which we just saw it
move on or some other d authentication
tool so to say like their Wireless
clients on that network you know D off
them so they have to get back on and
then renew their IP address yeah that
they will come back on they will say hey
DHCP server my IP address
whatever in past can I have it back
please and obviously the original one
won't reply yours come reclines there
yeah you can have that telling all the
IP addresses from the first dhcp
plethora of them to to provide to
everyone yeah excellent that's an
awesome way to do man-in-the-middle and
this is all built into Metasploit so
where can people get the module and
start playing with it but at the moment
the modules just on my site so it's
available at videojug and go into the
projects and then into networking you
can download it from there the current
version doesn't work or the version I've
got doesn't work the conversion exploit
I will be fixing that up in the next
week or so is that released and this
isn't the first the first bit of
Metasploit code you have although you've
got this new one you want to show us
yeah I've just create another module
there there's another package called
core impact which similar to best Floyd
is commercial package there's always a
big thing in the industry about when
when it or when your hacks and they
through it you get a message it says out
to you agent deployed and I figured well
if core can do it why cut mess wise so I
hacked together really quick and dirty
thing that whenever this new session was
creating the exploit it would tell you
that it had been created like how did I
tell you I it says here and nice little
robot voice this is what you get when
the module is loaded then in a similar
voice when new sessions are created it
will tell you new meterpreter session
created or shell session and if you want
to go even further on some of the boast
mode it will give you the IP address and
port number of the client connecting
this is excellent it's much like you
know if you're watching an intrusion
detection system maybe you got your feet
up and you're just waiting for the
alarms to go off that somebody's broken
in this is a complete opposite of that
you've got you know maybe you've got
karma and airdrop and all this other
stuff running you got your feet kicked
up just waiting for you know a little
nibble on the fishing rod there I love
how this for the complete opposite
instead say exterminate I did a quick
and dirty plugin for it add-on for the
sound HT more I looked at it within a
few hours of me sending it to him send
it to the community
he'd rewritten it into a complete module
system that all you need to do is create
your own set of wire files put him in
the directory when you load the module
you say use these modules or these web
files and you can add whatever you want
so so I could get a Dalek theme pack
yeah you can flame it up completely
excellent does your ninja of course with
mischief as always loving it working
people get a lot of you websites did you
need you to org or Twitter just did you
ninja thanks so much I will be back here
in just a bit this week's trivia is
manufactured by Bally Midway in 1982
this arcade video game released the same
year as the motion picture it was based
on of course you can submit your answer
at hak5 org slash trivia to be entered
to win a copy of proto bozos awesome
album zero equals one equals everything
and now we're just going to go ahead and
think one of the beautiful people that
keep AK 5 on the air
ever since I get go to assist expressed
by Citrix I'm supporting a lot more
clients and getting tons of work done at
the same time rush a rush a I have the
bomb thank you for holding miss Freeman
to make a folder show up under favorites
in Windows 7 just drag it to the
favorites icon in an explorer window now
it'll show up at the top of the list in
any safe menu go to assist Express lets
me support multiple clients at once its
128-bit secure end-to-end it's great for
a geek like me I'm big on security and
multitasking sniper at double doors mr.
Quatermain
to launch an application as
administrator hold down ctrl + Shift +
click on the application shortcut I'm
still getting a handle on it but suffice
it to say go to assist Express is the
easiest way to control someone's
computer online and all my clients are
amazed at how quickly I can fix their
computer problems even when they're out
to lunch
no don't go no and now that I'm saving
so much time and money without having to
travel I'm able to get those really
important things done in my life try go
to insist Express for free for 30 days I
go to assist Express calm / hak5 view
more great windows 7 tips at
revision3.com / go to assist Express
every now and then we'd like to do a
little segment called community
spotlight where we feature some of the
interesting stuff we see here in the
forms and big men we had the pleasure of
seeing this actually in RL at shmoocon
she's showing off the Costigan
Interceptor and while I would love for
him to be here in studio to tell us all
about it we have the developer of both
Robin what what is what is the ahsoka
interceptor well basically he's taken
standard yoga and I said mostly with an
in scepter the setup is you've got
Jaeger access point delivering Wireless
to the to the masses one of the wired
network points can connect it into your
router or to wherever is giving you
internet access and then the other wired
connection is then going into your
laptop and you can then monitor all the
traffic so how are we
yeah cigar flying an interceptor or we
intercept we're flying a yoga how did
this come about
I think we're intercepting a cigar okay
and and we're still using them demon
lager do we have to open VPN tunnel into
it or it's still using demon lager the
the actual setup is Jessica runs and
just standard internet connection
sharing it's one port and then daemon
logger is tapping the bridge those
connecting the wire and the wireless and
then copying the Gator out right ideally
it should be running VPN Open VPN like
the Interceptor does but unfortunately
for some reason whenever the Open VPN
and the wireless have put together the
whole thing set false so at the moment
it's not doing yeah but you got to
figure that
Abell in order to do that you're still
over the wired connection the y8 site
it's not physically in your position
yeah yeah well you were telling me that
this is actually poses an interesting
upside down relationship as far as the
packet loss is concerned as opposed to
the traditional interceptor yeah on the
traditional we're tapping the wired
connection and putting the data over
wireless which means you've got a
hundred Meg connection yes then spitting
today so out of a maximum 54 Meg
Wireless okay in this setup you've got a
maximum 54 Meg Wireless coming out but
you're then tapping on to a hundred net
connection so theoretically shouldn't be
getting any packet loss over that's
excellent I love the idea of this and
this is just some of the cool stuff that
comes out of these forms was originally
actually posted as a question here by by
death ray and now you've got it sticky
at the top of the hak5 org slash forums
hit up the assi Ghat boards or head over
to beekman's web site here over at
frontier net dotnet where he's got an
awesome walkthrough that basically shows
you how to get it going yeah he's doing
a very good ride upon it there's a lot
of support in the forums for at the
moment
sweet so for more about that head over
to the forums and if you have some
community stuff that you would like to
share with us of course feedback at hak5
dot always place to share that with us
you know highlight some of the cool
stuff that happens right within our own
little backyard so here's to you big men
Netflix delivers movies directly to your
home saving you time money and hassle as
the Netflix unlimited member you get
DVDs by mail and about one business day
plus you can instantly watch thousands
of TV episodes and movies stream
directly to your PC Mac or write to your
TV via a Netflix ready device like the
Xbox 360 ps3 and soon
Nintendo Wii console watch as many
movies as you want shipping is free and
there are no late fees or due dates keep
the movies as long as you like DVDs by
mail plus instantly write to your TV get
unlimited movies two ways for only $8.99
a month as a new member Anna hak5 viewer
you can get a two week free trial
membership go to WWF flexkom hak5 and
sign up now be sure to use this URL so
that they know we sent you now if you've
got hak5 pride remember you can show
your support by subscribing on iTunes on
YouTube you can become a friend on
Facebook or Twitter or you can you know
get something from the hack shop or
simply just email feedback at hak5 org
with what you like what you don't like
what you want to see what you don't want
to see you know it all makes it into the
show and it's really your show so go
ahead and hit us up there and also
before I get out of the British Isles I
do need to thank everybody that made
this possible for putting me up and for
coming out to the meetups and
specifically Joe bell and and David and
Robin wood and Rob and Ava and spider
and just everybody that came out to the
meetups we've been having a great time I
don't think I've had two points of the
same beer I'm gonna have to get back to
you because there's way too many of them
so until next week back in the studio
hopefully regular said trust your
Technol us
every now and then we do the back words
what are the training and it's a pretty
college no team
there all the time this time on the show
DNS exhaustion to the death this time on
the show DHCP exhaustion and DNS Wow
yeah words this time on the show DHCP
exhaustion and DNS man-in-the-middle vex
I've got that the first time why can't I
say it again hello welcome to hack five
my name is darren kitchen and yeah</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>