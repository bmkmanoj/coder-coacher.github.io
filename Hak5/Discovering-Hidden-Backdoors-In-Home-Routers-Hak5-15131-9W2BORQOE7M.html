<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Discovering Hidden Backdoors In Home Routers, Hak5 1513.1 | Coder Coacher - Coaching Coders</title><meta content="Discovering Hidden Backdoors In Home Routers, Hak5 1513.1 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Discovering Hidden Backdoors In Home Routers, Hak5 1513.1</b></h2><h5 class="post__date">2013-11-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/9W2BORQOE7M" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this segment of hak5 is brought to you
by domain.com hey everybody and welcome
to this episode of hak5 I'm Shannon
Morse and this is your weekly dose of
techno Leste now obviously I'm kind of
here all by myself
Darrin ran away to Disneyland for like a
week I have no clue when he's going to
come back so I'm pretty much holding me
on the fort myself hope you guys enjoy
it we have plenty of content so let's
get right into it right now you guys
know how we feel about wireless routers
here we love them we love them almost as
much as we love vulnerabilities and here
to marry the both of them the one and
only Craig Hafner Craig how are you man
you been oh not bad not bad it's so good
to see you last time we talked it was at
shmoocon two years ago talking about
Reaver Pro and breaking into you know
WPS enabled routers I hear you're doing
it again what's the what's the
vulnerability that's been getting that
all the headlines lately so yeah I was
actually surprised everyone was so
surprised to hear what I had to talk
about because we find this kind of stuff
all the time but basically a group of
d-link routers had a vendor-supplied
backdoor in them which basically allowed
you to bypass all authentication and
become admin you make it sound like this
is not like a you know an uncommon thing
to happen is is this just something you
stumble upon all of the time and how'd
you end up stumbling upon this one on
the d-link so it does actually happen
quite a bit a lot more than you might
think you know vendors will leave some
backdoor in either for development or
manufacturing they'll forget about it or
something like that um in this case I
would just kind of board and pull down
some old dealing firmware and was just
kind of going through looking at at what
it had in it I thought gee that looks
weird what is that doing and it turned
out to be a back door so I just kind of
stumbled upon this one okay and so I
what routers are affected and how
exactly does the backdoor go about
working so the ones that I've identified
are the dir one 100 the dir 120 the DI
six 24s the DI
6:04 s the DI 604 you pee the di 524 you
pee the DI 604 plus and the TMG 5240
there's also a couple of plan X routers
that apparently use the same firmware as
d-link the BR l0 for our the BR l l0 for
you our and the zero for CW ok and so
what does this allow an attacker to do
what's the vulnerability here so
basically all of the firmwares for these
have an administrative interface
implemented as a web server which most
embedded devices do what the backdoor is
is it looks for a specific user agent
string and if you have this very
specific user agent string set it says
oh well I don't need to check your
credentials you're just authenticated
your admin go ahead so you can just go
into your browser and set that string as
your user agent and then just browse any
of these routers and they let you right
into the admin interface and what
exactly is the string that you use um
it's actually the blog post it's it's
basically if you have to read it
backwards it states the name of the
developer which is Joel and then it's a
four digit number may be an employee
number and then it has the word backdoor
backwards in it as well um but it's a
nice long string but if you but if you
put that backward string in as your user
agent yeah you little let you write in
now you mentioned in the blog post that
the only other place that you saw this
particular string on the internet was on
like some Russian forum you want to
speculate on that or you have any
insight there so they it looked like on
the Russian forum and I'm just going
based on Google Translate because I
can't read Russian based on what Google
Translate told me they were they were
looking to take some ISP provided d-link
routers and I think specifically was the
di 524 u P and route them because there
there is B hadn't given them credentials
to the the routers um and so they were
looking for some telnet credentials
because telnet was enabled on the device
and so they so one of the posts said hey
I found this weird string in the web
server maybe we should try that as the
telnet login basically and then that was
it the forum stopped so I don't know if
they figured it out and kept
to themselves or if they and have been
using it for years or if if they just
never put put it together that that
should be a user agent string okay so
given that it's simply a user agent
string that you pass you know to the web
interface that all automatically you
know you're already assuming now that
we're on the network so how big is this
footprint really as far as the attack
vector is concerned and what are some of
the other ways like considering this
allows you know could potentially even
allow you'd mentioned arbitrary code
execution on the blog what does that
kind of mean to consumers so I mean the
best way to protect yourself is to not
have remote admin enabled because then
you do have to have either land or
wireless access in order to exploit it
um but there are a lot of these devices
thousands of them out there that have
remote admin enabled so those are know
can be hacked by anyone who can change a
user agent string in their browser
settings um and and there is a remote
code execution vulnerability that is
accessible thanks to the backdoor um
normally you would need admin
credentials to get to that piece of code
that's vulnerable but of course we don't
need that we have a user agent string
and so what that means is that I can run
any code I want and load any programs I
want onto your router which incidentally
controls all of your network traffic so
I can put say TCP dump and start
capturing all of your your network
traffic yeah there'd be a lot of fun
couple it with a you know open VPN
tunnel and then just mirror all the
traffic out somewhere else just the
first thing that comes to mind wouldn't
the vendor say when when this came out
so d-link is supposed to be actually
releasing patches for these firmwares by
tomorrow which is the 31st ok and as we
know everybody is you know constantly
refreshing their vendors website to see
if there's a new firmware to install
those I know yes it's kind of the
problem is you know there was there's
kind of big news in a very small set of
circles about this most people have no
idea that it's there they have no idea
what firmware is and they're probably
not going to update their firmware on
most of these routers are older some of
them have been end-of-life for a couple
of years actually on
and to dealings credit they are claiming
that they've got to update the firmware
even for those end-of-life models um but
we'll see how many people actually apply
the patches on these so that would be
the best way to mitigate this
vulnerability you would say is to apply
the new firmware yes I mean assuming
that they they fix it and don't mess
something else up but you know um well
again we'll see we'll see what happens
okay so what it was hackers do I mean
what router do you run at home yeah I
get asked that question a lot because I
do a lot of router exploitation um I am
thanks to my ISP unfortunately tied to
the router my eyes he gave me for
technical reasons so I don't look at
that firmware I don't want to know
ignorance is bliss but if you if you
have the technical knowledge putting
something like open word on your router
is definitely suggested awesome and so I
would love to know like given the fact
that you have like done a lot of router
hacking if you can make actually one
change in the consumer electronics space
as far as routers or concern and home
networking gear what would it be I think
that there just needs to be a lot more
quality assurance and oversight in terms
of security I mean a lot of the
vulnerabilities you see are things like
this they leave a backdoor in the system
and they don't think anything up they
don't even consider security it's just
an afterthought so I think just more of
an emphasis on security more of a
security mindset when just building
these devices and designing them would
go a long way to fixing a lot of these
stupid simple vulnerabilities that you
find sweet well Craig is awesome to hear
from you I know that you guys over at
TNS are doing some fantastic stuff
you've got the the latest Weaver Pro out
and whatnot where can people continue to
find out your research and what's new
with TNS um you can go to our website at
tak net Saul comm as well as my blog on
dev ttyS zero down all right Craig it's
awesome to see you as always thank you
so much thank you Darren
no I'm gonna have to call you back
actually hang on just second you know it
really doesn't matter if you're a monkey
in the middle or a hacker working for
bananas you've got that killer idea when
it hits you need to snag that domain
name and the web hosting fast with
domain coms quick domain discovery
system it's easy to check out and have
your website up and running no time I
mean I love domain up comm they're
affordable reliable they're easy to use
and they're on social media at
domain.com on twitter it makes it a
really fun place to do business because
there are huge fans of hak5
so they've got to hook up get this 15%
off they're already affordable domain
names and web hosting I have to do so
use the coupon code hak5 at checkout
that's right they've got the hook-up
hak5 so when you think domain names
think domain.com yeah you know 40 tons
of bananas welcome back and now it's
time for the trivia question of the week
last week's trivia question was what
unit of measurement denotes half of a
byte and the answer was a nibble mmm
delicious now this week's trivia
question is who invented the
walkie-talkie
you can answer that at hak5 org slash
trivia for your chance to win some
awesome the hack five goodies
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>