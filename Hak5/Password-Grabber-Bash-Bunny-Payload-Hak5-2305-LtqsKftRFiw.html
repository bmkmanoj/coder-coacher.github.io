<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Password Grabber Bash Bunny Payload - Hak5 2305 | Coder Coacher - Coaching Coders</title><meta content="Password Grabber Bash Bunny Payload - Hak5 2305 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Password Grabber Bash Bunny Payload - Hak5 2305</b></h2><h5 class="post__date">2017-10-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/LtqsKftRFiw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in honor of our beloved kirby we are
dissecting the ultimate password
grabbing script kitty payload no
seriously you just plug it in and it
dumps plaintext passwords that's
literally all there is to it
all that and more this time on hack five
hello and welcome to hack five my name
is darren kitchen hello everybody
welcome to the show my name is Shannon
Morse your weekly dose of technology and
I have yeah a bunny face I love the
bunny face I have a bunny face okay you
can I tell you something yes please the
other day I tweeted and I was like look
at these bunnies and somebody was like
are you pregnant
so apparently bunnies mean you're gonna
see and whatever you do on the internet
people are like oh you're just like what
l obviously what else could it be
no that's called a beer gut this is what
you turned in for by the way I'm not
gonna lie you guys I'm still feeling a
little blue about our lost kitten bang -
that's why I'm cracking jokes yeah
that's how I help scope mm-hmm right it
does so thank you for all the kind words
we really appreciate it yeah yeah this
weekend I went to Hawaii and it kind of
gave me a chance to just get away and
enjoy nature I went on a couple of hikes
and it was really good for me to just be
able to do that that's a great grieving
process hack you just get out to nature
actually it was really good you know
what I would say and that's actually not
what we're talking about on the show
today but if as far as like hacking your
happiness is concerned getting out and
nature's probably like even you know I
like the number one thing you can do is
like the Sun like I don't know but
there's something human about it right
vitamins it really does work good and I
find that the times in my life when I've
been like to look you know I should
really like go out in nature and like
then don't feel better about everything
and then I'm like no I don't want to get
off the couch
oh I don't just kind of have to like I
just want to sit around and watch
Netflix all day and then I'm like and
then you're all over watch YouTube news
on so that's how yeah I just have to
like go with it and just like jump out
there and and I am NOT a hiker
whatsoever but I went on two hikes this
weekend and if I can do it anybody can
cuz that I like I killed myself on that
Wow my legs just Oh
is just one step at a time though
getting out to the gym like nobody like
when you think about like the big it and
I think this applies to everything but
like this just as an example going on
the Hyatt going out to the gym whatever
you think they're like the big picture
like oh that sounds exhausting
you forget this especially when I can
just like sit on the couch and not yeah
and you're like oh all I actually need
to do is is put my gym clothes on I can
do that yeah clothes on is easy so you
just do that and you're like oh now I
just need to go downstairs I've done
that a million times I can go downstairs
yeah you do and you're like oh no I just
need to like walk on this treadmill big
deal I've walked and then like 30
seconds into it you're like oh I'm doing
the thing yeah oh now I'm in it you know
what those are little wins those are
easy wins yes anybody can accomplish hey
let's get some easy wins okay well
sometimes you just need an easy win and
nothing could be easier than today's
batch money payload it's really easy
it's true it's called the password
grabber and as the name implies it grabs
passwords from unsuspecting unlocked
machines so it is written in such a way
that it builds on Darren's USB
exfiltration payload to invisibly
execute less Agni or lasagna I don't
know how it's pronounced it as lasagna
sure let's call is Anya which itself
builds on key thief mini cats and cred
dub
so it's building on a thing that builds
on a thing that builds on you together
right so the payload itself is specific
to Windows but the tool it runs which is
lasagna is cross-platform so it could be
adapted as well for Mac or Linux or
whatever device that you're trying to
run it on so Darren I say WTF what is
this thing this thing is called I'm busy
doing logistics getting the launch party
for the new thing going and I needed
easy win I'm gonna just choose an easy
one because this is a crowd pleaser
who's in love plaintext passwords
I love plaintext passwords so I just
figured like hey let's take a look at
this awesome tool here because this
payload employs it and it's a really
ridiculously sweet tool that you should
have in your arsenal and it's called
lasagna okay fine we're calling me right
and basically it's an open source
application to retrieve lots of
passwords
that's it so I've got this um this
Windows box set up here and we're gonna
test it out on this I literally I think
that's a Dell XPS 15 that we're gonna
review on texting
oh is this a review unit protect okay
cuz I just went over to Patrick Norton
and I was like hey you got a Windows box
I can like test and he was like sure
here you go yeah okay well anyway we
wiped all of them anyway afterwards okay
you're not like sending it back to Dell
and Dell send it to another because we
might just be putting like viruses up on
this like I don't even know just saying
I wasn't going to test this on my
machine and I didn't I couldn't be f to
spin up a VM I literally brought broke
out my EP so let's do by the way this is
like the cutest and coolest PC ever it's
called an EPC is from 2007 and it runs
oh it died Windows XP I love this thing
it's a seller on nine hundred mega Blok
to six hundred okay so anyway anyway the
point is we'll get to why I'm not I
would otherwise be doing this in a VM
but essentially this tool retrieves loss
and password by using you know standing
on a building on the shoulders of giants
it uses parts of key thief and mini cats
and crud dumps so what you end up
getting is basically plaintext passwords
for all of these different programs you
know be it browsers like Chrome and
Firefox and ie or you know chat programs
like Skype and sysadmin tools like
FileZilla which I love and winscp which
is great for windows and all of that
jazz and you can see how it works
basically you run it with like all and
then you Noatak oh and for the output
format for a normal txt and you get an
output of all the stuff and you get it
into a text file that's this is this
screenshot is literally what you're
gonna get you just you hit that and then
boom like here's a username here's a
password there's a URL like it's it's
that stupid simple and sometimes like
right now where I am right now I just
want stupid simple I want easy I want I
have a have a stripper friend who's got
this amazing quote which is sometimes
what she's a stripper and she's a friend
she's got this amazing quote and she's
like sometimes I just want boys to drive
me around and buy me drinks
and I get that who doesn't want that
yeah I want boys to drive me around and
get me drinks close beverages preferable
right okay so anyway suburbs along so
how do we actually get this um okay so
that's why I bring up the fact that I'm
using some you know spare machine or
would otherwise be testing this in a VM
yeah because I again with the whole I
think laziness might be the the theme of
the episode can't be left to compile
this from source and if you go over to
github you will find here the beautiful
source for this wonderful executable
that you just need to run and get
passwords or you can grab standalone
releases from right here Oh beautiful
and you can just download a zip file and
it's right and then man I haven't used H
ever I don't think I've ever used this
browser weird anyway you do that are you
using is that edge because it's what
came with the box I just this is a brand
new machine in lieu of using a VM
because otherwise I don't know who
compiled this I mean I've obviously this
was uploaded by alesandro's Zee who is
probably a fantastic person I'm sure
this isn't like nefarious malware other
than the nefarious malware that it
already is which is a password dumping
tool I don't think it's gonna like you
know upload my creds to some person but
in case that's what it does I would want
to not run this on my production box so
I'm just being lazy and actually doing
it in bare metal which makes it easier
to demo anyway okay so we all know how
to install exe and all that good stuff
yeah yeah so has this been adapted to
the bash money because I'm assuming
that's why we're talking about that's
that's kind of like the vague ploy in
which we have been talking about these
sorts of tools it's the thin guys but
let's take a look so essentially we have
a payload here from razorblade who
adapted some of my code from his razor
blade what's up right and and hey creds
work residue that's awesome building on
the the shoulders of giants although
that's that's what we all do it's
fantastic and basically this leverages
lasagne and it's a stupid simple payload
copy paste and away you go
it goes green when the
when the attack is complete as it were
but essentially you use it the same
techniques that I've done in the past
with the usb exfiltrated payload which
invisibly in the background runs a
little bit of PowerShell which does an X
copy to nab documents from your My
Documents folder okay
and save them back to the USB disk on
the bash bunny okay so this takes
advantage of that by instead of doing an
X copy you can see what does the payload
dot txt is stupid small and simple it's
literally the scroll is inverted on this
led attack right and then it sets the
attack mode to hidden storage and then
runs for Windows just bit of PowerShell
all this PowerShell does is find the
bash money and run in the switch
position DCM so nice and he used the
switch position very long variable yeah
yeah and that's done for you when you
when you do the run win so that's nice
and then it does an LED finish so really
that the finish LED doesn't actually
tell you that the payload completed it
just tells you that I got to the next
line interesting then the next thing it
does is it runs that d dot CMD here
which if you take a look is just a
little bit of PowerShell that uses a C
script I died VBS to invisibly run ecmt
and we've covered them this in the past
but essentially what's gonna happen is
Eid uh CMD runs in the background
without a window popping up oh right
beautifully invisibly Bob's your uncle
yeah and what does that do to him do you
do you might ask well this is literally
my exact payload except the parts that X
copy right here that that copy or
documents have been rubbed out and
instead we've got some nice additions I
here at the top which is literally to
execute lasagna oh and then it does it
such that does lasagna all and then
outputs with a single Waka to a loot
directory which has got the computer's
name and date and time and such with
underscore passwords dot txt so that's
the name of the file that it's creating
that's it wow that's so easy stupid
simple but hey it gets the job done
right okay well in that case I think we
see it in action okay so what do the
thing I make it do the thing indeed I've
already copied the payload literally
this is a copypasta kind of episode so
just put it in switch position one
I'll just minimize everything the
desktop there I'll plug it in you can
see here that's blinking green go back
to your computer screen and the attack
just started get blinking yellow mm-hmm
or amber and there we go pulls up the
run line a little bit PowerShell and
it's gone okay cool
so now let's imagine I've unplugged it
because the light turned green it's a
hack machine and I'm gonna go to my
hacker box here and plug it in and check
out the loot okay okay so we're gonna
pretend this my hacker machine and I'll
just pull up explorer and head over to
the bash Bunny and under the loop folder
we have you can see I've run this
numerous times the passwords folder
although interestingly it actually
creates a USBs filtration folder with
another folder for the desktop for the
computer's name and the timestamp but it
doesn't actually save it in there save
them all
yeahthere's it needs a fixer too but
yeah and see what you and and that's
what you end up that's cool
yeah now there's there's Jack all on
this machine I mean of course if there
were Wi-Fi creds and saved passwords in
the browser you pick up all that stuff
and save it for you it's gonna get
whatever lasagna is gonna get out right
but it just automates the process and
this isn't while you're like creating
new accounts and typing them in it's
whatever's being stored locally on that
computer correct yeah got it that's the
idea that's so cool that's literally
like agent proof if you'd like to say
anybody could use this yeah just copy
and paste there you go you could give it
to your CSR I figured I was like we
could either do a net cat segment as an
amaz yeah Kirby or we could do a script
kiddie segment and she was introduced on
the show on season 1 episode 1 or 2 hey
this gets the job done but I'm assuming
that it probably doesn't have it
probably has some kind of flaws so what
would you say as far as making it better
than the obvious which is sticking the
password file inside of the password
directory yeah instead of the folder
because you know these guys should be
just one in there yeah I guess I mean
the text files are named with the name
of the you know the name of the computer
and the timestamp so I guess they don't
need to be in their own individual
folders and actually that brings up a
good point
I wouldn't create a new folder for each
and and this is actually kind of the
meat and potatoes of this episode I
really wanted to or the tempeh and
potatoes if you're vegan I wanted to
talk about like ways to take this from
cool script Kitty payload that just kind
of works - what would it be that would
actually make this a really robust
payload okay it's something that would
be fault-tolerant okay so one of the
things that I thought about and I'm just
really spitballing ideas here I haven't
actually implemented these but and when
it encouraged some implementation
because we can reward that and then make
the whole repository better for
everybody watching at home you have some
ideas or can pick up on some of these
let's see some git commits the idea here
would be that right now when you run
this it just changes the LED to Amber
when blinking when it's attacking and
then green when it finishes the attack
but it actually doesn't know that the
attack completed successfully if you
think about doing one just goes to the
next line yeah one of the payloads that
I demonstrated when we very first
launched this guy here if I go into the
library is a recon payload called RDP
checker and one of the things about this
payload is that it gives you a fail
status if well if it failed to get dis
appendices it gives you a failed status
if RDP was not enabled and a green
success if the RDP is and it actually
knows by doing a little bit of checking
here and you know it runs this against
the target and then it actually checks
the thing so it says if and then it
greps for the word granted out of that
file and so if the word granted was
there does an LED green success and if
it wasn't then it doesn't LED fail oh I
feel like this is the perfect payload
that can take advantage of that where to
make it actually agent proof where
you're like hey give it to somebody that
doesn't have hacker skills but has
social engineering skill
has the ability to get into a place and
plug in a thing that's cool and then
they know oh cool the light turned green
right I'm good to leave the facility or
light was red I'll try another machine
yeah right that's a good idea
so you could probably do that pretty
easily by doing a little bit of
intelligence of saying doing in LS or
what there's numerous ways to check this
but I would check the loop folder from
the perspective of the Bosch money right
after this runs and then check for a new
file and if there's a new file and it
contains the I don't have passwords or
if it's what you're expecting then you
can have a pretty good confidence oh hey
a log file was created Green hey it's
been a while and no log files red or
just a red until there's a log file so
then you could just be like oh well wait
until tears that you could do depending
on what exactly you're looking for with
this yeah that's that's kind of again
the idea is I want to encourage that
kind of further development on this
absolutely in fact one of the things
that I found was on this particular
Windows box which is just a like a fresh
windows 10 box yeah
is it still there let's see if I go into
it so this is run on this machine and it
created that the Aleut but if I go back
to the switch 1 you'll notice it's gone
that lasagna exe I actually have a copy
of it here what right here yes so why
did it disappear Windows Defender right
so I'll just really yeah I'll just place
it back in its place right and actually
we'll just go ahead and execute this and
go to I don't know what is it the D
Drive under payloads and it's in switch
1 and there it is ok and I go ahead and
run that and it's gonna you know give me
the output and all of those things
alright it's thing I'll do it's little
thing actually it's like hey couldn't
execute that and I would now it's gone
what yeah so so Windows Defender
actually works in this case it did
however it did run the first time and
then actually look my copy of it is
still there so funny one of the things
that I would do is I would either use
read-only storage and then exfiltrate
the data through another means like SMB
attacks
or spinning up an SMB server on here you
could just copy the file that way and
I've already demonstrated that you can
copy and paste the code out of the SMB
exfiltration go ahead and then by using
and this is a storage there's actually a
attack mode we haven't discussed in the
past it's ro underscore storage excuse
me sweet only storage exactly okay see
idea is like it wouldn't actually be
able to delete the file yeah right right
would be almost like a cd-rom yeah of
course yeah om read only memory so yeah
I think that that would be one way or
you could just have a check and then if
it gets deleted literally the bash money
could self heal it by keeping a copy on
its Linux side on it's like you know
slash of route or wherever you want to
store it and then check to see if the
payee of the you know evil malware
executable is there and if it's suddenly
not anymore you just make another copy
that's hilarious yeah such a troll
yeah so I need to do things so we're
gonna hook them up with we're gonna
absolutely razorblade yeah I want to say
reasonably razor blade is like zero
cools best friend actually zero cool is
a really cool guy zero cool which is the
craziest thing zero cools off very cool
is awesome so yes razor blade we're
gonna hook him up with a hundred dollar
gift certificate to get some hack 5 gear
whatever you'd like yeah and thank you
to everybody who has been developing
payloads for the bash bunny we've been
having so much community development so
it's really awesome to see everybody
working together on that yeah I know the
forums are buzzing it's good stuff it's
great I love it I think that about wraps
up this episode right yeah yeah this is
just kind of like a riff in one cuz we
got to get to we got to get to San
Francisco and lock down this venue yes
we did I wish that we had the detail
we'll have to do an insert so if you do
have details on the meetup they would be
right now this is the part of the show
where I want to invite you all out on
October 20th to come to our big all hak5
gear event we are launching three new
cool devices and I'd love to see you
there it's going to be in San Francisco
at 7 p.m. at chaos and you can find all
the details on how to RSVP over at a
convenient URL attack 5 org slash RSVP
I'll see you there Chanin go wide
That's not me throwing you a football
that's actually like technical direction
I seriously go why I'm just gonna hold
it why are you doing that Shannon trying
to make a joke in here just gonna hold
it you just yeah I'm just gonna leave it
there such a party pooper I know you
know you can do these key buttons no
work I turned them off haha okay see
brilliant beautiful I love that great
job you guys are the best
yeah so if you want to find out more of
course you can go over to hak5 dot org
that is where we will have the event
details and you can also find all of our
different shows that we do over there as
well including tech thing hat top pack
table top computer that's true it is
hack tip threat wire snubs report
Metasploit minute we're good at this
here's all the things yes ready okay
it's not a Friday it's a Wednesday don't
why oh we've got to do this for two more
days don't hit the button okay and the
motivation to carry on thank you again
to everybody who sent well wishes over
the socials really appreciate it and you
know we're coping and we're strong and
will continue and Kerby lives on in our
hearts and on Wi-Fi pineapples and on
Wi-Fi pineapples forever well maybe
we'll make some payloads that change
people's wallpapers to really good idea
rubber ducky
find some way to use a land turtle in a
packet squirrel - what's Kirby Kirby
packets I don't know I say we just keep
it going I think that's a great idea
yeah if you want to support us directly
you can do that over at a cheese shop
comm that's where you can find all of
our Wi-Fi pineapples and bash bunnies
and land turtles and our entire farm of
amazing animals cute little animals
very cute animals and fruit okay with
that
I'm Darrin kitchen I'm Shannon Morse
dresser technology you've got a great
idea you should do what Shannon and I do
and head over to domain.com and register
your domain bring it over to the
internet using this super awesome
discovery system that brings domains
from your mind
onto the web over at domain.com they've
got a quick and easy checkout process
and they've been supporting hack five
for years you can also tweet Adam at
domain.com and say hey thanks for
hooking up the guys and they've got a
special treat just for you you get to
save 20% off at checkout over at
domain.com using the super secret coupon
code it's five it spells hack five and
it's just between you and I all right
I'm tell anyone okay when you think
domain names think domain.com hello and
welcome to hack five man well Ben that's
what we're supposed to do okay let me
switch to your camera
Oh what am I gonna do with you just feed
me before midnight right and you'll be
just fine</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>