<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>LAN Turtle 106 - Man in the Middle with URLSnarf | Coder Coacher - Coaching Coders</title><meta content="LAN Turtle 106 - Man in the Middle with URLSnarf - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>LAN Turtle 106 - Man in the Middle with URLSnarf</b></h2><h5 class="post__date">2017-10-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Ika2uEIWlYc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this land turtle basics i'm darren
kitchen and today we're going to do a
little bit of man-in-the-middle sniffing
of traffic using a very basic tool
called URL snarf
so first a little bit about the
deployment scenario in this case very
similar to how we have before I have two
machines set up I've got on the left a
Windows machine and then I have this
Linux machine and I'm SSH into a server
up in the cloud on this Linux machine
now what I actually have done physically
here is that the Windows machine is
connected to the Internet through the
land turtle so this is plugged into the
USB on the virtual machine and this is
plugged into the land and so now the
Windows machine has internet access
through the land turtle as it normally
would and I can demonstrate that by
going ahead and opening up this is a
very fresh Windows install Internet
Explorer and it can go to example.com
and hooray I've pulled up a website well
what's really interesting about this is
remember we've deployed this now on a
machine and it is physically in this
case the man in the middle now building
on the previous lessons now we can
continue to manage this over SSH and we
also have an SSH file system to our
virtual private server so let's go ahead
and build on top of that let's go over
to our server in the cloud and SSH into
root at local host on port 2 2 2 2 so I
will be accessing it over that SSH
tunnel and what I'd like to do now is
come down to modules and at the very
bottom of the list I should find URL
snarf so I'm going to go ahead and open
URL snarf it's a very basic module and
the only options are really where to
save the log file but we also get this
option to test so I'm going to go ahead
and test this so with this running and
now the user mind you this is at an
off-site location this user is now going
to go browse the web for I don't know
we'll head over to Google and we
immediately see that get requests for
Google
and we're gonna look for zombocom and we
find the search result for zombocom and
we're gonna go ahead and click into
zombocom which is amazing in there we go
I see us going to Zombo and no we don't
want to do that right now otherwise we
would get the amazingness that is
zombocom so let's go ahead and
understand that we are now as we are
physically poised as the man in the
middle we can see the HTTP traffic that
is flowing through this computer which
is really interesting because we can do
a lot of analysis just by the urls that
are going through this machine so let's
take it a step further and build on that
sshfs part let's head back over to the
management interface I'm gonna exit this
test and I'm going to go back and
configure the module and what I want to
do is instead of not saving the lag log
file and instead of saving it to the
/tmp which is a temporary directory on
the land turtle which does which is not
persistent after reboots I will choose
to save the s it to the sshfs directory
if it is available so we'll go ahead and
submit that and I'm going to go ahead
and start that great so URL star F has
started with this pid' well what does
that mean well let's go ahead and quit
out of this I'm going to exit the turtle
shell completely and I'm going to exit
my SSH session into the turtle so now
I'm back here on my virtual private
server and if I go over to slash what is
it home slash turtle the home directory
of the turtle and ILS the file that I
now have in addition to my hello.txt
that we created in the previous lesson
is this URL snarf file so let's tail
that file tail tech F will follow that
file and as you can see it's date
stamped and well there's nothing in it
yet but if I go over here to hack 5 org
pretty cool website I start getting all
of the traffic and I can watch this in
real time as the user browses the web
which is really cool this is a just very
simple example of what is capable when
you are physically the man in the middle
and when you've got that remote access
over SSH so
I can continue watching this log file
grow and grow and I'm looking forward to
hearing your feedback of course let me
know and you can find me and more videos
like these over at land turtle comm</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>