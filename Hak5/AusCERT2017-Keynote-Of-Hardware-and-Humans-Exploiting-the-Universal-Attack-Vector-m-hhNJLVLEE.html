<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>AusCERT2017 Keynote: Of Hardware and Humans: Exploiting the Universal Attack Vector | Coder Coacher - Coaching Coders</title><meta content="AusCERT2017 Keynote: Of Hardware and Humans: Exploiting the Universal Attack Vector - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>AusCERT2017 Keynote: Of Hardware and Humans: Exploiting the Universal Attack Vector</b></h2><h5 class="post__date">2017-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/m-hhNJLVLEE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">well good morning ladies gentlemen
welcome to all set as you see there on
your screen the 16th annual cyber
security conference my name's Adam
Spencer really excited to be your emcee
again for this wonderful celebration of
all things that cyber security got a
couple of amazing days lined up for you
I want to start by acknowledging the
traditional owners of the land upon
which we make today the comma marry
people and thank them for their
custodianship of this land I'm really
excited to be here not the first time
I've done also got six seven eight nine
some integer n where n is less than 16
time that I've hello tough crowd move on
that I've been Hannah I really I love
this this celebration this community in
this great sense of friendship that's in
the room I do know that many of you here
would be here with a couple of partners
a couple of associates there's a pretty
good chance that if you know anyone in
the room quite well you're probably
sitting next to that person at the same
time with all of you there'll be a group
of people in the room who have
absolutely no idea who they are so what
we're going to do right now is going to
get ever understand up and one's going
to stand up right now to everyone just
stand up for a second I'm about to count
the three when I hit the number three
you're going to spin around 360 degrees
and the first person you lock eyes with
and think I've got no bloody idea who
you are you're going to extend the odds
that hand of friendship shake hands and
then introduce yourself explain who you
are and how you fit into this magic
couple of days Montessori spin around
find someone you don't know
shake hands oh aya how do you fit in
fantastic okay there you go now run back
at me looking back at me now
everyone back to me excellent stuff let
me run through a couple of items of
housekeeping before we kick off our
speakers for the morning in the unlikely
event of an emergency of the resort
there'll be a public address
announcement in conjunction with an
evacuation tone just follow the
instructions of the well-trained staff
and we move to acacia Avenue just on the
southern side of the hotel if we do have
to evacuate bathrooms exit the room left
and left again you'll see the signs on
the walls phones obviously we're all
connected rather digital please have
them on silent out of respect for our
speakers of course it's a non-smoking
venue here in the hall this Hall is our
non-smoking just outside in the
registration area and the display er is
non-smoking downstairs in the foyer and
the our restaurant area that's
non-smoking immediately outside the
hotel resort there is non-smoking as is
around the pool that's also a
non-smoking area the street just out the
front of the resort here is a
non-smoking look if you want to have a
cigarette the best thing to do is get up
from your chair walk out through that
door at the back turn left left again
get to the stairs go down the stairs
walk through the foyer of the hotel
immediately at the front of the hotel go
across onto the Main Street there
turning to the left
hail a cab get in the cab go to the Gold
Coast Airport go to the international
section of the airport buy yourself a
ticket to Bali and once you get to
Denpasar Airport go absolutely crazy
okay that's the best way to have a
cigarette over the next couple of days
you've got that I presume everyone has
the mobile app you should have the
mobile app it's officer 2017 if you
don't I'm sure you're all connected
already but there's a few of you who
aren't get onto that app right now it's
the best way to ask questions of the
presenters rate the presentations
checking at the booths using the
passport to win prizes and the like the
merchandise stand is open during the
catering breaks at the conference that's
where you go to get your very stylish
also t-shirt and conference bag the
lock-picking village if this is your
first also does one of the highlights of
also the lock-picking and Lego booths
are both down the end of the corridor
that way in the interactive zone pick up
your lock-picking kit and practice lock
and USB the hashtag for all your
different social media is oz cert 2017
so use that on Twitter on Instagram
snapchat tinder whatever you're into get
officer 2017 out there and spread the
message the garlic dinner tonight which
absolutely
is off each year as absolutely booked
out as always so if you have realized
now you can't go to the gala dinner and
you have booked in please go to the
registration desk and unbook yourself
because there is a wait list of people
if you'd still like to go government to
know the registration desk if we will
squeeze you in at all we will do that
now to our first speakers to welcome
it's officially on behalf of all so look
if there's one thing that we've learned
I think around the world in the last 18
months or so is executive power can be
quite a fickle mistress elusive to
obtain and then once obtained even more
difficult to keep I look at the United
Kingdom for example where our David
Cameron was wiped out in the brexit vote
and had to resign the prime ministership
in Australia Malcolm Turnbull of course
bet it all on a double disillusion
election scrapped back in by the skin of
his preferences and in the u.s. they
were given the choice between a
megalomaniacal billionaire narcissist
and Donald Trump and we all saw what
happened there so how are we how happy
are we here it also to know that amid
the turmoil that engulfs us worldwide we
can go to sleep at night safe and calm
in the warm reassuring bosom of this
dynamic leadership duo strong stable
just a little bit sexy please welcome
David Stockdale and Mike home from also
to the stage I'd give them a big round
of applause
thank you very much Adam I don't think
I've ever ever had an introduction quite
that good but hello hello to everybody
okay so as understands my name is David
Stockdale and I'm the deputy director at
the University of Queensland with
responsibility for all cert so for mods
Earth I'm from the University of
Queensland I'd like to say welcome to
each and every one of you to offset 2017
or 16 conference so I'm relatively new
to where to cybersecurity and there are
two lessons that I've learned really
really quickly over the last six months
firstly as we move to a more digitally
connected world we we need to increase
everyone's cyber awareness server
service security awareness this is
everyone's problem and possibly one of
the greatest threats that we'll face
secondly the only way that we're going
to battle the bad guys that have any
success is by working together which of
course is borne out in the theme of the
conference which is united with stand so
I'm not going to any big presentations I
know that you're all here because you've
got an interest in this field so I hope
you get a lot of value from the next few
days if you'd like to know more about
all set command visitors at the booth
and I look forward to meeting of many as
many of you as possible during the
conference have a great time and let me
hand over to Mike thank
all right well thank you everyone for
coming along and welcome it's really
really good to see you all here we've
actually got about 700 which is I
believe close to the capacity of the
venue's so that's that's wonderful
there's people from nine different
countries and we've got about 360 of you
are actually awesome members so that's
wonderful and we've got as David said
we've got some really exciting speakers
too so I'm really looking forward to the
talks I'm going to speak very very
briefly because I know you're just
itching to see our keynote and David
mentioned very briefly why we chose
united we stand for our theme and it
really comes back to the operational
focus that we have at offset in the
operations team one of our main things
this year is information sharing as
David said the only way we can get there
is together so there's been a lot of
excitement in the team about that we've
got some really good technology that
we're piloting at the moment with with
some of our members when the time is
right we'll we'll explain that to all of
you and I think you'll be really excited
by what we've done the events team had
also sort of picked up on on that
excitement and they sort of wanted to
share the cyber love so with information
sharing and everyone working together in
the community we just decided united we
stand was was the best way to articulate
that so here we are and one thing that I
would definitely encourage you to do is
come and put some faces to two names
many of you interact with the operations
team at offset through our our member
chat good old-fashioned IRC some of you
prefer email telephone but either way
it's it's just at the end of the day
it's just text so please come and put a
visual to to the the names that you know
so well very very easy to spot we all
have these wonderful blue Smurf shirts
so who come come and come and find us at
the standout stands just over here in
the exhibition hall and speaking of the
exhibition hall while you're out there
please chat to some colleagues visit our
wonderful sponsor overlords who make
this brilliant events possible
make some new cyber friends maybe join
an industry initiative we have out here
in the exhibition hall we have a set
represented you'll find our branch
chapter for Brisbane Mandy Turner
out at the at the stand so I'd encourage
you to support ASA now we've had also
we've also supported said Australia as
the National cert for a number of years
now and their responsibilities of course
with critical infrastructure but this
year we're actually really excited to
have the ACAC represented here with the
Iraq program and the far end of the hall
and as you've already heard there's some
of your old favorites here as well we've
got the career cafe and the Lego pin so
I think we have a wonderful event ahead
of you and I think the best thing for me
to do is to hand over to the people that
really know how to entertain and one of
them being Adam so thank you very much
and welcome thank you very much Mike
thanks guys okay let's move now to our
opening keynote one of our speakers will
be familiar to if you were also last
year and as your tutorial a couple of
days ago I could do the whole bio
mentioned the whole phone freak scene
founder of hack 5 and all that all I
need to say is the defending champion of
the prestigious sort speed debate
extravaganza which will be on again
tomorrow afternoon to round out the
conference and he's brought a special
friend with him a podcasting legend and
a hak5 guru Shannon Morse joined by
Darren kitchen please get down and
channel a big round of applause the air
to talk about exploiting the universal
attack vector that's me I'm recording
for my own vlogs while I'm doing this so
first up I wanted to ask who out here
went to the whiskey tasting last night
oh I see a lot of hands Wow I'm
surprised you're awake I'm assuming it
was a good time though yes good very
good
so first off I want to say thank you so
much to offer 2017 for having us down
here this is amazing
it's also my first time down in
Australia so I just want to say it's
great to be in down under am I doing
this right that's how you do it right so
today we decided that we wanted to have
some fun we decided that we wanted to
perform an attack that takes advantage
of the root of security which of course
is trust and everybody loves trust
another thing that we all love and we
wanted to take advantage of is
convenience because everyone loves
convenience we also wanted to do an
attack that takes advantage of that
fundamental nature of the humans
relationship with technology so of
course given that this is the first
keynote of the day we wanted to have
some fun
we aren't dropping any zero-days but
what we are dropping are lots and lots
of USB flash drive I've never gotten to
do that before it was awesome so much
fun
so we're also going to be dropping a
takeaway as well for everybody who is
here and everybody that will see this
online as well that hopefully you can
use for your future security engagement
and also will hopefully bring in some
money for the IT field from your CEOs
but in traditional ax5 fashion I will
say that what we're going to be doing
here you know yeah it's kind testing
it's InfoSec but us we're hackers in the
old-school sense so we got into a little
bit of mischief a little little hijinks
we're keeping it fun but hopefully is
something that you can take away and use
to not only just teach some unsuspecting
targets why plugging in random USB
drives isn't the best idea but also so
you can take this takeaway back to your
organization and use it for your own
security awareness training and like
Shannon said maybe get some funding
along the way yeah you funny I mean I
have to say though if you sold that you
will not pick that up right right
exactly
you will not let somebody else plug that
into your computer right
all right quick quick question just you
know to kind of gauge the audience you
know I remember you guys from last year
but I kind of you know I'm once Shannon
to know that she's among friends just
from your own personal experience what
can you tell me about about how long
does it typically take you to walk in
and rob a bank I know I used to work in
a bank I won't mention that huh I
recently went to Beirut Lebanon with
Jason Street to find out and I'll show
you that right here this is courtesy of
national Geographics breakthrough
documentary that just air
I can't help the laugh so good alright
so if you guessed about what 15 seconds
to just walk into a bank so bad with a
USB Drive find an unlocked machine and
plug it in how is that possible right
we're going to get into the attack and
all of that but it helps me to introduce
the world's most lethal cyber villain if
you're here last year may be familiar in
fact with the world's most lethal cyber
villain yes I'm talking about grandma
she is awesome she bakes amazing cookies
Jerell she's wondering why you're not
calling more often and she is my
stand-in for the industry's need for
user friendly she was also elite hacks
or and she may be potentially
responsible for Stuxnet the world's
first known cyber weapon right used USB
for its propagation against Iranian
centrifuges which enrich uranium you
know the stuff that goes boom and don't
get me wrong I'm not saying that
grandmas nefarious but in the 90s the PC
boom when all of these standards were
taking place that we all take for
granted now everything needed to be
user-friendly and as such to be
convenient a lot of hard coded trusts
were put in and those same trusts get
passed on to the user and it could turn
an unsuspecting target into a victim
when plug-and-play turns into plug and
pwned ah that sound Kofi Annan no you
don't honestly you would sound cool if
you said it right its own alright it's
not pwned well it's all about the
man-machine trust relationship you know
it's a relationship that can so easily
be exploited through well the ubiquity
of not just USB ports but really the
whole physical attack surface right it's
all literally built IO is built on that
trust relationship and if you're crafty
if you're sneaky
if you get physical access to one of
these ports for just 10 seconds you can
go from plug to cone and know you have a
successful attack but something is easy
as a green LED well it could also be a
purple LED too
I mean it's easy enough but seriously
though not us
we are information security
professionals we are influencers in this
industry so of course we would not fall
for these kind of attacks
I mean sure of course we laugh and we
cry whenever our colleagues get totally
owned by these kind of things and again
it's owned I mean we would seriously
facepalm if these kind of things happen
to our colleagues but again and I love
Star Trek I mean how could you not TMZ
man but but seriously we are not going
to be the ones that fall for these right
right well in this talk we're going to
be talking about this important
vulnerability as it were that just so
this attack factor that happens to be
the de-facto way that humans interface
with computers and technology and see
how effective it really is see what
other researchers have found and do a
little experiment of our own and take a
look at some of the mitigation
techniques out there like I said leave
you guys a little gift the payload you
can use on your own internal security
awareness engagements mm-hmm but first
off we should probably introduce what we
do usually we say I'm Garen kitchen and
I'm Shannon Morse and this is your
weekly dose of techno less welcome to
this episode of hack 5 at least that's
what we usually say on our weekly
podcast called hack 5 it's been
influencing the security industry with
really fun technological tutorials that
have been bringing people into their
careers since 16 17 years ago so we've
been going for a little while I think
one of my personal best things one of my
favorite things is when everybody out
here or several of you have come up and
told me personally that you have really
enjoyed the show since you were kids and
now you have a profession a career in
the security industry and that means so
much to us and in addition to making fun
podcasts we've also been developing an
arsenal of penetration testing
men with funny names like pineapple and
duck and turtle and bunny also cute is
very important you know I started as a
phone safe in the 90s where we didn't
have too little pineapples and ducks and
turtles we had different colored boxes
we had beige boxes and blue boxes and
red boxes also that we could take
advantage of inherent trust that were
built into the phone system and give
some free long distance you know dial is
really good BBS's and I feel like it's
really important as an industry that we
maintain the hacker culture and keep it
cute there seriously nothing better than
when you're on the phone with that high
level official from the government
that's trying to buy a bunch of USB
rubber duckies and they're literally on
the phone like there's no way I'm
getting just Pio approved you guys did
ask you number is something I can use
and I'm like yep rubber - duckie all
right but enough about us we should
probably talk about the dangers of
ubiquity specifically USB flash drives
everybody loves them they're stable
they're reliable they're really
inexpensive they're easy to use and
they're readily available seriously you
can find them everywhere as we have seen
for the past several years pricing has
exponentially decreased as storage space
has gone up I'm sure you remember how
128 gigs flash drives back in 2013 were
twice the price of what they are now so
price has gone down quite a bit in fact
according to the Global Industry
Analysts Inc we should expect to have
556 point 2 million units of USB flash
drives shipped worldwide annually by
2020 annually a lot of flash drives and
of course that's because of things like
speed and cost and reliability
everything everything that consumers
love computers love them too as you can
see they're simply just plug and play
and they're cross-compatible you can use
them with Linux and Mac and Windows and
they're fast enough for a consumer to be
relatively happy even with this new
thing called hash tag dongle life I'm
sure you
all familiar with dongle life I know I
am personal devices have become even
this example right here it's small and
thin it's portable it's light and
there's barely any ports on it your feed
rest they still work you can find them
at trade shows event convention I wonder
if anybody was handing out flashers at
this convention be careful open them
just make sure to check you can see my
checkout lines at convenience stores and
even as a handy little add-on item
whenever you're checking out online
whenever you're shopping for your family
and friends during the holidays they're
available all over the wit all over the
world because of something that we all
love which is consumption oh yes so they
still have a cultural significance and
because of that we can also theorized
that there's still a problem as well at
least that's what I think
yes Department Institute about USB Drive
security you'll quickly find you know
the top 10 USB Drive security best
practices I'm not going to go through
them I'm just going to say interestingly
enough sponsored by Kingston all about
educating users about encrypting drive
send not losing drives and you know
providing employees with approved high
quality USB drives for the workspace I
did mention it is sponsored by Kingston
right but the major takeaways you know
suffice it to say most of the education
in that is all about you know limiting
what USB flash drives you use and how
they're allowed to be used in setting
policies for encryption and things of
that nature to minimize data breaches
but not necessarily preventing any sort
of other physical access attacks right
so we posit a couple of questions do we
have security professionals actually
practice what we preach do we trust
random USB flash drives hmm so cue a USB
drop and of course everybody knows what
a USB drop is it's where a penetration
tester takes some sort of amounts of USB
flash drives
and sits them out at a target location
drops them in various different places
to try to gain access through some sort
of pivot point to a network through a
company perhaps so in our case we
decided to use the USB rubber ducky and
of course what's the duct that's what we
have to ask well I'm going to just let a
few TV shows answer that question for us
because I've explained it way too many
times that convention
hey this is a rubber deck all else fails
you find an FBI laptop anyone or they
usually Panasonic Toughbook
blood this game wait 15 seconds then
yank it okay
next to a tool call made me cats it'll
pull all cash passwords and domain info
in and save them on this won't give us
everything but it might help you
somewhere just a back-up plan let's uh
try again hello we're the team rubber
duckies so Vegas a couple of everyday up
here if you want to using no you had to
do Rory setup so it's like yeah those
are set up to I don't remember what
Taylor's they're running now okay I will
definitely use my computer okay just
what is the worst that could happen
it sounds like it if it starts doing
anything really nefarious yeah oh it's
just hello world I like that
basically the rubber ducky is the
keyboard I can't type you know thirty
five thousand words a second this can so
it when it plugs in it goes and says I'm
a keyboard and I'm typing it can
literally open up notepad
instead of saying hello world right the
program the Trojan or the malware right
it save it execute it and then go all
done in humanly fast because it's
already pre-recorded on the chip well
you alright let's turn everything this
one's my favorite everything's wrong so
I did as you ordered and isolated all
the malicious code or remnants of it
buried deep in our operating system
first that was confused our finding that
was answer session I realize only way we
could have been breached was through
social engineering or physical
access a rubber belt alike keystroke
injection attack platform disguise and I
would bypass all standard
countermeasures by emulating a plug-in
keyboard reprogramming our host computer
as if the hacker was manually typing in
the code so the culprit would have to
plug in the thumb drive yes someone had
to do an FBI employee with level 4
clearance I spent the last 18 hours
collating models of the first appearance
of the malicious code in order to figure
out who got pumped so we could interview
the employee and Mail that hacker and it
review oh ok no spoilers no seriously I
loved that it was basically like reading
the website it was freaking earthquake a
pediatric I have to say though bragging
rights I mean that's so cool the USB
rubber ducky was on TV that's awesome so
anyway let's get into it
that was the USB rubber ducky we're
taking advantage of first that machine
to human trust and there's many
different trust factors this first one
machine to human so this is where you
get that violation of trust that
machines have in humans whenever we use
devices called eggs which are human
interface devices and in this case the
USB rubber ducky is taking advantage of
a USB keyboard now there is in computers
this super hard coded trust in any kind
of keyboard input computers
automatically think oh it must be a
human that's fine really
yeah they're not going to like rise up
or anything no of course not because
humans are good humans are good people
yeah please don't kill it okay please
don't kill with computers so computers
respect that relationship they accept
any kind of unauthenticated keystrokes
that come their way without question
because they automatically think it's a
human humans can't do any bad we're also
going to violate that human human trust
you know what hackers like to call
social engineering right I just like to
call it manipulating and lying to get
what you want but either way you know
it's it's that skill that we learned as
kids you know to manipulate our parents
you know it's like a hard-coded human
attack I don't know about you guys but
when I was growing up
was they would first go and ask dad
right that way if he said no he could
just move quick run over and that mom as
long as you got to them before they had
a chance to sync up you're golden
yeah which in InfoSec is also known as a
race condition and then the third one
that we have is human to machine trust
the ducky looks like a keyboard so the
computer doesn't ask is that really a
keyboard or is it a rubber ducky it
doesn't know the difference it just
accept it no matter what because it
wants to give consumers that convenient
and convenient means that the consumer
or the computer obviously is going to
know that's right well we humans are
going to trust them those machines we
don't necessarily want to ask or give
the time to ask there's not going to be
a program on the USB rubber ducky or the
flash drive in this case or a keyboard
that runs and once I tell it to so it's
we accept it we trust those machines we
also aren't going to ask you know the
computer doesn't know human interface
device from a USB rubber ducky
it's going to automatically assume that
everything is okay so we trust the
computer but that doesn't mean that
humans are stupid not at all we are not
saying that humans are stupid I'm saying
that humans are conditioned to think
that way over the course of time that we
have had with this technology and what
we are saying is that we need to change
the way that we think we need to start
policing our own trust in that
technology and it's changed a lot that
trust that we have in machines as the
rise of smartphones and those lockdown
operating systems that run on the phones
and tablets you know in addition to
those voice assistant Butler's right you
know they do a really good job of
preventing us from hosing our systems
unlike a general-purpose PC and it's in
stark contrast to that right you know
your series and Alexa's and okay
Google's of the world are kind of like I
took oats a frank thinking so you don't
have to we've just got
so used to the computer knowing what's
best and these attack vectors they exist
because of convenience and that problem
isn't going to go away anytime soon
because as a society we expect
convenience
Anil asked if yes Carolyn Schmidt she's
the program manager for IT security
awareness training over educationist
which is the national institute for
standards of technology
she says that removable media are
portable convenient and easy to use to
exchange information and prohibiting the
use of all removable media is just not
reasonable moreover using removable
media safely depends very heavily on the
user's own judgment awareness and
diligence which means that the
responsibility you know the onus ends up
on the user and we as users we as a
society we expect to have technology
that just works but as developers as
systems administrators were tasked with
making things that just work which means
that typically we need to put in hard
coded trusts and then as hackers and as
penetration testers when it comes to
breaking those hard coded trusts it's
oftentimes a matter of just telling the
right simple lie something that we have
all learned to do from childhood
exactly so we decided to do our own USB
drop and ask that question again do we
as an industry practice what we preach
we are so good at giving really sound
really good advice but do we actually
follow our own guidelines we always
think that's not going to happen to me
I'm an expert I know what I'm doing I
don't need to run antivirus for example
we did this hole there it is an informal
poll 40% of InfoSec professionals don't
even run antivirus for various reasons
of course but it's not just antivirus
it's also public Wireless it's not using
a VPN it's trusting USB flash drives
it's leaving your PC unattended when you
go to the restroom at a coffee shop
everybody does it
well also I'm an expert you know I'm an
info tech X right
know what I'm doing and that's just
going to slow down you know my friends
per second and counterstrikes so come on
I mean I've done it too I sometimes I
don't use a VPN because I want to watch
Netflix I mean it happens so even for
this example artsy I tweeted let's play
a game bought the unlocked laptops which
are owned by forensics and penetration
students which of course the reply would
have to be do you have a rubber ducky
yes USB drops against an InfoSec crowd
that's what we actually decided to do to
see how we fared as an industry against
this very very popular form of attack
and we're not the first to do this the
Google anti fraud and abuse research
team to just such an attack against the
University campus and presented their
findings at blackhat in 2016 and they
identified these key factors to making a
successful USB drop attack and they
actually found that a USB HID spoofing
or keystroke injection attack or lying
and singer and showing up as a keyboard
instead of a thumb drive it's actually a
really nice sweet spot between you know
the cost and complexity complexity the
reliability of the stealth factor you
cross-platform all of those things are
important to having a good attack as
stacked up against social engineering
for instance pretty low cost right
pretty easy to just walk into a bank
right ah
not nearly as stealth and not
necessarily as reliable zero days on the
other hand those are great those are you
know can be highly reliable they can be
highly stealthy but they are
tremendously costly not just in dollars
in time and they're not really just like
littering the streets I think it could
be with your thumb drives right so Eli
Bernstein of Google's anti abuse
research team identified some unique
challenges basically cross-platform this
binary list persistence and creating
realistic keys as their unique
challenges for a USB drop against this
university alright so how do we go about
solving these different kind of
challenges well first off we had to
identify our objective obviously the
Google anti-fraud and
youth research team they wanted to do
reverse shells but the difference is
they are Google and we are hack 5 we
don't have a slew of lawyers to back us
up if we decided to get a reverse shell
and then find some kind of trade secrets
or hack the Gibson we just didn't want
to let that happen so we decided to make
it quite easy and help should be
security minded people with a little bit
of security awareness we didn't want to
have any kind of malicious intent
because well that would be bad and then
we would have to get lawyers involved so
we didn't want to go that way our
primary objective here was not to use
reverse shells for any kind of nefarious
fun later on down the road we just
wanted to educate people with a simple
pop-up of a webpage and show them that
there are actual risks of plugging in
USB drives so on those key factors
cross-platform is typically just OS
fingerprinting figuring out hey is it's
a Mac is this of Windows is this Linux
and then injecting different set of
keystrokes dependent on your target the
binary lists persistence well thankfully
we didn't even need to worry about that
but that's obviously you know setting up
a reverse shell with some sort of
intelligence and persistence to maintain
that connection to get that reconnection
and then obviously not use you know
stupid simple protocols not use
meterpreter on port 4 4 4 4 and get
noticed you know add a little stealth to
that we didn't have to do any of that
since we just wanted to pop up a webpage
so instead we just put together a very
simple ducky script even better make
sure that - if you want to text editor
ever and this ducky script it's really
simple it's cross-platform without
having to identify the operating system
because we're just sending the
keystrokes that will work against well
let's say we just identified the three
major operating systems we were
concerned about so windows everything
since windows 98 I guess it would have
to be se to have USB support OS 10 as
well as well if you're running Linux we
just said unity so all f2 for unity
command space for mac and windows key
are
or windows and then we just type a URL
and hit enter
and of course for convenience is just
going to pop up the default browser and
take into a web page so of course we had
to set up a web page so we threw
together a little bit of PHP that just
very simply grabs the browser
information and a little IP information
you know nothing nefarious just to
determine the operating system and just
to sort get an idea of the geolocation
right and then the rest of it is just a
bunch of meta stuff and JavaScript to do
a forwarder to take them on to some good
advice where you guys find good advice I
don't know sir oh so we took them to the
US sir which has a nice Security
Bulletin tip on USB Drive security which
states don't plug a man just don't do it
if you find one take it to the proper
authorities take them to your Systems
Administrator so that covers binary list
persistence and cross-platform we also
needed to make sure it was realistic yes
because it's important that your
hardware is realistic you know it's very
unlikely that somebody just pick one of
these up off the street and then plug it
into their computers right for one of
these that's trustworthy yeah that's in
a plastic case right and obviously you
can't 3d print a plastic case yeah yeah
so realistic-looking drive yeah we did
that already
USB automation tool that you created way
back in the day in 2006 it was called
the USB switchblade that one was based
off off-the-shelf flash drives that
looked exactly like this one a SanDisk
it looked like a drive because well I
want it was one so then after that
Darren created the USB rubber ducky a
few years later which was the next level
of keystroke injection tools and this
one was supposed to be a turnkey
solution for penetration testers
something that you could easily bring
anywhere because it looks so generic I
mean no hacker device that looks like a
USB rubber ducky is going to draw
suspicion generally but of course if it
looks like a thumb drive and it smells
like a thumb drive and it tastes like a
thumb drive
put that in your mouth then it must be a
thumb drive right yeah so we also had to
consider some additional factors when we
did this drop first off where would we
put these drops where would we choose to
drop the USB flash drives of course
that's a very important factor second
off we have social engineering we're
going into this target-rich environment
so what do we do when we're there we
decided to go against everybody with
distracting and redirecting their
attention while we drop the USB flash
drive and third is complexity of the
payload which Daren already mentioned he
wanted to keep it short and sweet just
launching a URL that's it and of course
number four would be make sure that it's
reliable so we had to make sure that we
had less graphical user interface
elements changing throughout time and
conservative delays to account for any
kind of slower machines because not
everybody has a quick machine made in
2017 for example also on the front of
reliability we needed to spoof an apple
aluminum keyboard because OS 10 is going
to complain if you're not using Apple's
own products and that's well spoofing
that's just as easy to spoofing a
keyboard there's a V ID and a PID
associated with every USB device a
vendor ID and Product ID and those are
just eight characters that you send down
the bus and there will be that inherent
trust just as there is inherent trust to
those unauthentic keystrokes and the
result is a payload that's highly
reliable that will work against most
computers and it will happen in an
instant faster than you have a chance
reasonably to unplug it and prevent it
from doing its bidding so we should
discuss the attack or maybe we should
show them let's do that
I have so much fun doing that it was so
enjoyable so obviously as you can tell
that was our si 2017 which takes place
in San Francisco in February of every
year this conference has about 43,000
professionals that attend with 550
different brand name companies that have
booths on the show floor there's tons of
different people that attend and all of
them are information security
professionals they might be chief
officers from different brands they
might be analysts press and PR but all
of them are working in some kind of
InfoSec shanwa in one way or another so
all of them have an idea of how to
secure themselves so we took 100 Ducky's
to the RSA Conference and we decided to
kind of figure out how many would be
picked up and plugged in that's pretty
much all we wanted to know now we cannot
determine who and where they picked them
up and we could track how many were
picked up when and where they ended up
wherever that might be in the world so
then we had to consider some drop
locations that was one of my favorites
so we did swag bowls of course that was
an excellent place to put different USB
rubber duckies candy bowls were very
popular at the convention we found one
that had little chip clips that you put
on your on your bags of chips and I put
two or three drives in there check back
later just walked by they were all gone
somebody picked up the flash drive booth
great if I did see a USB Drive swag bowl
of course I put some in there because
everybody uses the same kind of USB
flash drives they all look the same so
it's perfect attendee bags just like
this one we're great because they give
those away at the front of the
convention for t-shirts and business
cards and flyers whatever else they can
find so that was a perfect place because
you just drop it in and walk away
and of course charging in lounge areas
there were plenty of those and I thought
easy pickins just leave it right there
and assume that somebody accidentally
left it but we did have some caveats
that we had to consider so the first
caveat was
bathrooms as you saw we're a great place
to leave them but if you leave one all
by itself with nothing around it
people will tweet about it including
this person so I have a tip for this a
pro tip like I did in the video leave
one on top of a booth flyer it looks a
lot less suspicious I love that the
majority of the replies are plug it in
what could go wrong what could go wrong
no oh yeah number two was don't go in as
a recognizable security figure
especially if you have purple hair yeah
I noticed pretty quickly I'll get notice
also if you're going to do this kind of
thing on a more general audience than
your own internal organization put an
email address within the code because
you will inevitably get emails from
other security researchers saying thanks
for dropping by our booth ended up being
that they were big fans of the USB
rubber duck suit or like hey thanks for
the hardware where else did you leave
them so let's take a quick look at the
analysis because we did drop a hundred
drives and this is what we found we
ended up with a hundred and sixty two
unique executions from 62 different
unique IP addresses that ended up in
about five different nations over the
course of 65 days right so I love that
even up until like you know April these
are still being plugged in why and you
know as you might imagine majority
windows some Mac majority chrome very
little msie so you know yay do that so
if we did a similar drop test to this
one we decided that there would be a few
things that we would have to consider
and a few things that we would probably
do a lot better since the USB rubber
ducky payload was exactly the same on
every single device and we had 100
devices there was no way for us to
determine which device was being used so
we couldn't tell which location was best
so we think that a unique URL for each
one would be a lot better we shut off a
block bot I'm talking to the guy with
the curl script that decided to hammer
on the the page but that's okay yeah
yeah throughout the bogus data we could
also add some kind of legend
looking URL to the front of them it's
very very easy in these days to screen
print on the front of those with laser
branding so you can put a legitimate
looking logo on your USB rubber ducky
flash drive and so I would say overall
this is pretty successful security
awareness engagement considering 62
unique executions out of a hundred
drives dropped so bad it's so awesome I
don't have a ticket you know it sickle
something so you're probably run
wondering how our industry has actually
responded to this kind of attack Shannon
they have absolutely embraced this kind
of attack it is yeah the USB you know
attack platform has been you know it's
been weaponized by nation states on
numerous high-profile attacks remember
last year I talked about Stuxnet the
business cyber weapons oh that's
offensive
get with USB propagation okay have a
cottonmouth from the NSA since the
Snowden leaks and we got the ant catalog
we could tell you that thing is used for
infiltration exfiltration cool over
cobra wireless channels that's also
often give a covert wireless channel and
it's great but it's often okay well
they're also charging a million dollars
for a few of them so we're not we're not
charging enough for this tank apparent
okay how about the recent volt seven
drops on WikiLeaks I'm quoting the CIA
here the USB rubber ducky is
well-crafted but through its software
and hardware the software has a nice
interface for users and comes with a
good amount of documentation an example
of online yay so apparently the CIA is
now doing our free advertisement so
that's great so state espionage has
obviously decided to use this as a great
attack vector but how has information
security gone about supporting these
kind of attacks well seriously not the
best I would say that it's really cool
we've seen some some unique enthusiast
hardware this is the USG it's a USB
firewall and I think it's really cool it
has some caveats unfortunately it only
supports USB 1.1 unfortunately it only
does mass storage and mouse and keyboard
so but it still it's an open hardware
open-source project I don't see it
becoming huge adoption but it's kind of
cool to see a response to this kind of
threat right on the software side I've
seen a new just so many of these suites
out there too
helped whitelist USB drives but as I
talked about about spoofing the Apple
aluminum keyboard it's just a matter of
sending a spoofed vendor ID and Product
ID few other things to mimic a
legitimate Drive and again that's just
telling the right lie so we're going to
go ahead and give you guys a this
payload so you can use it on your own
internal security awareness engagements
as well as this website we set up and
the slides and the tile actually don't
use our website but you know hosting
yourself obviously it's just PHP so
that'll be a hack five dot org slash USB
drop app to this talk I'm going to make
sure it's actually there after the talk
I'm the one that manages this guy so if
you think this is scary
consider something else we just have
been talking about the human interface
device potential of the USB attack
vector using a USB rubber ducky but
think about the bash bunny that's our
newest product out here and of course
we're not standing up here just to
advertise this but to make you think
about the possibilities in the future
the bash money doesn't just emulate a
keyboard but also a serial it emulates
storage and a driverless network adapter
so if you're thinking I'm safe because I
have an air-gapped Windows 7 or XP box
it's totally safe from one a cry just
imagine if you have a USB stick like the
bash money that the victim computer is
inherently going to trust as an
authoritative network obtain an IP
address expose its SMB protocol yeah
you're owned that's all you have to do
so we give you some takeaway thoughts
first off if we as information security
professionals cannot be trusted to
follow flashdrive security best
practices and protocols how are we going
to expect our own users to follow this
as well I mean look at RSA Conference 62
unique IP but that wouldn't happen here
at all sir of course we know are the
safeguards that we are implementing to
protect our organizations are they best
on technology or policy or both and are
we giving humans too much credit and
responsibility when it
to the security of our system consider
those when you really get down to it you
know securing systems is about ensuring
trust and exploiting systems is about
breaking trust and in the case of these
USB flash drives is USB Drock example
we're taking advantage of the trade-off
between convenience and security and
we're putting that trust into humans the
responsibility is on the human to
identify the hardware and make sure what
they're plugging in isn't lying and
actually being a keyboard
I mean hacking after all is all about
trust and as in life Trust takes time to
build and to rebuild and Trust can
easily be washed away in an instant so
we as an industry need to think about
where we're putting our trust in our
security systems we've gotten really
good at building very secure
machine-to-machine mechanisms right but
it's those endpoints where the machines
meet the humans that we need to start
asking the questions where are we
putting our trust well I can tell you
where I'm putting my trust I'm trusting
my Technol left thank you so much
thank you both very much Darren and
Shannon I'm gonna present you with the
speakers gift for also 2017 take that
there oh thank you for not one for you
down it is a absurd certified united we
stand chopping board the kitchen is
absolutely unhackable it has no USB
ports or UK is absolutely impregnable
you wouldn't believe it
having just said it that was Shannon's
first-ever keynote at a conference give
a round of applause so this is wonderful
guys wonderful wonderful son and we'll
see Darren again defending his title in
the screen debate extravaganza tomorrow
afternoon so thank you so much guys give
them one more round of applause from
high-five</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>