<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hak5 - Man in the Middle Hacking Fun with SSL Strip | Coder Coacher - Coaching Coders</title><meta content="Hak5 - Man in the Middle Hacking Fun with SSL Strip - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Hak5/">Hak5</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hak5 - Man in the Middle Hacking Fun with SSL Strip</b></h2><h5 class="post__date">2009-10-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/PmtkJKHFX5Q" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I'm here at William and Mary the
nation's second oldest college having a
little fun with the wireless network
which is surprisingly secure and on
today's episode of hack five in this
following series we're going to be
exploiting this network and its users or
should I say a similar test network my
name is Darren kitchen you're watching
hack five
this episode of high five is brought to
you by the United States Air Force
Gamefly and domain.com got a great idea
it all starts with a great domain hello
welcome to hak5 my name is darren
kitchen I'm Shannon Morse and I met
Lester and this is your kitten and puppy
review show tonight we have a fabulous
kitten that we will be reviewing in that
right it is indeed it's a turtle shell
she's very very loud and yet why don't
you bring our first subject up yeah this
is the cat that we will be modding today
with not only lasers but but I think
we're actually going to give her a flux
capacitor what do you say she's uh she's
seriously gonna sound too happy about
the flux capacitor idea but I think if
we just you know kind of surgically
attached it to her ass you know she can
time-travel through we try to tether a
camera to her once it didn't work out I
think it's cuz she's a tabby calico mix
maybe yeah which makes her quite
ferocious
she's a month now this show is about
hacking and IT and gaming and all fun
stuff like that so of course we have fun
hacking stuff for you guys this week
we're going to be taking over the
William and Mary Network except then our
lawyers told me that that would be a bad
idea so we're going to simulate it and
all of that we have lawyers which means
when you see Darren on the Wi-Fi down in
CW not doing anything bad yeah if you're
on your family vacation and you happen
to be at a coffee shop at Darren's just
chilling outside probably best to run
the other way you know I think it's
awesome that the the whole Williamsburg
the colonial is rigged like symbol is
the pineapple because it's the
International sign for welcome I Drive
by that sign like all the time and I'm
like what's what the Virginia is for
lovers thing Virginia is for packet
lovers
it's the truth so yeah we're doing that
and we got to thank Eddie you guys see
it yes very nice but why why you yeah
because I'm the strongest to pick up the
hak5 logo hello look at look at these
guns and hacky sack
you're not that coordinated I am so
coordinated with hacky sack have you
ever seen me juggle an APC you fell uh
yeah that'll happen
and what else is going on um I kind of
haha a wall for like a month and a half
yeah we all kind of have yeah although
no dairy no mer there's been holding um
fork off on his little adventures and
I'm sure he's going on another one where
he'll film way too much and yeah well it
won't work either
well he'll delete them in North Carolina
or he'll delete the footage of a
particular segment
oh crap yeah I need to I need to totally
like pour my drink on the head because I
totally messed up and last episode we
did a segment with was with Jason
Applebaum and we totally modded a 17 19
inch LCD made it a touch screen and we
filmed the whole thing the segment came
out great
and I had all of this support material
that was going to use to supplement the
segment and I did not have it because we
got this new camera and I pop the SD
card in it and I forgot there was
footage on there and a totally formatted
so I yeah I'm to blame because I'm an
idiot
and I'm sorry that the last segment
didn't have the b-roll that we showed a
crosscut to this is burning my eyes so
they're gonna finish her song and Abby
over here yeah there's some ramen your
eyes checked in but I'll recommend
um so you had that sink so you have a
broken Acer yeah hey Jim yes I opened it
up one day and I was like what's this
there's a little line in my Acer what
happened and you know and I don't like
leave it in the middle of our flip and
set or anything I don't leave it on the
floor and wait for somebody to walk on
top of it and like throw a camera down
on it or anything
like that so I was like what's the worst
I could lose I'm going to send it into a
sir it's still under warranty I'm going
to pay you shipping so I sent it in and
this lady called me and said it was
going to cost me 90 bucks because it was
a customer issue now let me say I
wouldn't have a problem with it if I
knew how it happened right if I knew
that it was my fault I'd be like okay
you know I'll go ahead and pay the 90
bucks
Darren's right Darren's a Donna just
kind of buy one for like 50 bucks off of
ebay and yeah try to replace it myself
hopefully not break it if I do oh well
we'll show you guys how to actually
replace a screen I'm looking to do the
same thing in a t 60 from IBM that I
have it's just it's a 10 by 7 and I need
a bigger res so it'll look to upgrade
nub
there's panel differences and stuff like
that you got to be concerned about but
you're installing a touchscreen maybe
yeah
well Jason up Obama's able to do it with
b-roll that we didn't have I'll get
Jason to install there you go oh and
then look at the people again
problem solved see how that comes full
circle we're all good I'm messy cleanup
a vicious cycle enjoy the show
I'll clean it up
hell are you doing it's a free stop diet
that's ridiculous no no it's a real
thing I did watch a research so it turns
out you can lose a lot of weight on this
you can eat anything you want as long as
it's a freeze pop you're guaranteed to
lose weight so I kind of figured out how
to edit Wikipedia it's a stupidest thing
I've ever heard actually it's the best
idea ever and I'm gonna share with the
world my registering freeze pop diet
calm no I'm gonna race some free stop
diet come first and put a picture of a
go cuz you're moron too late I just got
it how I'm use domain.com it's domain
registration without all the BS cool
rooftop pool with coms for less than 10
bucks without pushy upselling reseller
dedicated servers with cPanel and killer
VPS hosting with root access
domain.com is the place to go next time
you're looking to start a website or
build your new massively multi skilled
side business best of all they're
offering hack 5 fans sweet deals on
domain names private registration and
web hosting just go to domain.com and
use coupon code hak5 that's hak5 at
checkout to get 15% off your order
got a great idea it all starts with a
great domain domain com
lately we've been talking a lot about
Virtual Private Networks or VPNs we've
talked about setting up PPTP servers on
windows and linux we've even talked
about setting up SSL VPN servers on both
platforms and that led me to the
realization that we have not talked
about SSL strip here on the show and I
could have sworn we have because it is
such a cool tool and I think it really
ties in with the VPN series in the sense
that it's important to emphasize what it
is that we are protecting ourselves from
when we tunnel our traffic encrypted
traffic what have you it's important to
you know know what the blackhat side of
this is and this is actually a tool that
came out of blackhat this year by a
hacker by the name of Moxie Marlinspike
and I would love to demo it for you guys
today I think it is so very cool and it
is just one of these tools that you need
to have in your arsenal whenever you're
doing a man-in-the-middle attack and
we've talked about doing men in the
middle attacks with like pineapples and
Anna monkey great fun tools we're
actually going to be using some software
here today to do all of this so you know
if you've just got a PC on the network
just you know load up your favorite you
know distro with all your fun hack tools
i'm actually using backtrack 4 here and
and that should get you going so
basically what this is going to allow us
to do is once we have men in the middle
with our notebook here in between our
target laptop and you know the router on
the network is you know typically when
we do this we start sniffing up and we
try to get all the you know fun
passwords that we can but what happens
when somebody goes to an SSL site and
we've said this time and time again it's
a great way to protect yourself but this
is actually going to allow us to strip
out the SSL on our victims side so that
we can see their password when they try
to log into for example a banking site
and this is again why you would want to
rather than rely on the on the ssl
connection of your you know your webmail
your back
site whatever go ahead and encrypt
everything and just tunnel it through
instead so let's go ahead and take a
look at what we are going to need to get
this set up so as I said I am here in
backtrack and I believe I have gone
ahead and set myself up here on the
network so real quick I'm just going to
do a little nmap scan and see who my
neighbors are so we found our fresh
little target here and it's 10 1001 59 a
beautiful little laptop named and less
stock know where that could be it's
going to be perfect for our
demonstration here we're going to
initiate a man-in-the-middle we're going
to run SSL strip but what else are we
going to need to get all that set up
first of all we're going to need to
modify our IP tables we are going to
need a little ARP spoofing ash going on
and we're going to need some Python so
go ahead and make sure you have all that
and when we get back in just a sec we'll
go ahead and put it all together but
first let's thank the United States Air
Force
so let's go ahead and flip our PC into
forwarding mode so to do so let's just
take a look at this file here in /proc
net sis I'm sorry that's backwards sis
net ipv4 and it's IP underscore forward
okay we can see it's set to zero I
actually want to go ahead and change
that to one I could you know nano it or
VY or whatever but I'll just go ahead
and use a single Wako rather than double
wakka to go ahead and replace that with
one in /proc sis net ipv4 IP forward
alright so if I take a look at that
again it is set to one so we are going
ahead and forwarding IP the next thing
we need to do is have a little bit of
fun with IP tables so let's go ahead and
issue IP tables tak to you for the table
we want and we want to adjust our NAT
table and then we're a dress translation
tak a to go ahead and append or add a
rule here and this is going to be for
pre routing and tack P for the protocol
it's going to be TCP and we need to add
a destination for so tack tack
destination tack port and that's going
to be a t for all of our HTTP traffic
tech J for jump and it is basically
saying that when we match this pattern
this is the target that you want to do
this thing to so we're going to say
redirect and redirect is essentially
saying go ahead and take that and give
it to the local host and on in this case
we want to do it on a local OS that
around some port with port 8080 that's
always a fun one
so TAC TAC two TAC port 8080 alright
so we've set up our IP tables now we are
ready to start our ARP spoof and we've
talked about our Vikash poisoning in the
past and I think it might be time for a
refresher I don't think I think it's
still outside of the scope of this
segment
but if
something you guys want to hear more of
go ahead and email feedback but right
now I'll just go ahead and say reference
season 1 episode 4 for the second being
technical I'm gonna refer to this as an
ARP cache poisoning attack now an ARP is
an address resolution protocol now each
device on a network uses this to build a
table of all the other devices on a
network now in the table it contains
each devices MAC address and its
corresponding IP address now they do
this by sending out a series of our
quests and ARP responses the problem
with this is it's susceptible to attack
we can exploit this vulnerability
between two computers a and B or two
devices by telling each one that were
the other so this will allow us to kind
of intercept the traffic eavesdrop yeah
all we're doing is position ourselves in
between two devices for example your
computer and the firewall and now we can
pick up all the network traffic and we
don't have links in the show notes it's
good stuff seriously let's go ahead and
get our ARP cache going on or ARP spoof
so ARP spoof and just tack I for our
interface and we are cheating today and
using wired / interface because it just
makes things easier there are a little
demo Network here so that would be at 0
but of course if we were using the Alpha
here it'd be like Wi-Fi zero or
something like that so and then we need
to do tak T for our target and like I
said our target is Matt's little laptop
here I say little but you know I'm
holding an EPC this thing's like a
monster
latitude II 6500 so tech T 1010 Oh dot
159 and the host so 1010 Oh dot 1 and
that is the router that he's connected
to I go ahead and hit enter here and
what happens is essentially we are
convincing the router that we are him
and him that we are the router and then
we are everything in between imagine
that how cool is that so now that we are
essentially the man in the middle of the
monkey in the middle however you want to
put it we can see everything flowing
between which is great and we've used
this before so many times sniff up
instant message conversations all that
other fun stuff but then there was
always the were thwarted by when they go
to you know an HTTP site if only we
could strip all of that out so let's go
ahead and do exactly that with SSL strip
so I'm going to create a new terminal
here let's go ahead and initiate SSL
strip so SSL strip py and we're going to
do TAC L for listen and we said port
8080 so there we go we have SSL strip
running now I'm going to come over here
to the client and we are going to I
don't know go to let's see Capital One
comm I think that's a fun banking site
what happens is when you go to Capital
One comm you're greeted with this
wonderful user friendly page where
you're you know you can log in to your
credit cards here or you know your
banking or your auto loan or all these
other fun things that we would just love
to know what's going on here so we're
going to click login for credit cards
and I'm prompted for my username and
password so let's go ahead and enter Bob
for our username and one two three four
five for our password just as an example
now I want you to notice something here
on this page and that is we're on HTTP
go ahead and try this on your computer
at home I bet you if you go to Capital
One comm and click login you're going to
be greeted by an HTTP site what happened
here well let's take a look I'm going to
go ahead and click login and obviously
it's a bogus login or if it wasn't then
I am just the luckiest password guesser
in the world and Bob needs to know okay
so yeah so what's happened here is our
man in the middle has noticed that we
are actually trying to initiate a
connection over to to a SSL site so what
happens is we go to Capital One calm
right totally an HTTP site it's got that
link where we click log into the SSL and
you can try this on most
bank sites totally going to be the same
thing PayPal whatever you're on an HTTP
site and then you go to login you're on
HTTPS and what this does is it notices
that and it well it removes it and
replaces with HTTP but not just that
because that's not going to work if you
try this on your home computer without
even using SSL sniff and try to go to
those Bank sites and just take the s out
it's not going to work the server is
going to say listen we need it to be an
HTTPS site because it needs to be secure
and if it's SSL its secure yeah well
thankfully our man in the middle here
has gone ahead and connected securely to
that HTTPS site on your behalf how
friendly of it and go ahead and
forwarded that over to you the victim
over at TTP because then we didn't even
need to spoof any HD air and it when you
need to break SSL at all and users are
dumb enough that they're not going to
notice cool thing about SSL spoof
there's there's a bunch of different
options here but we can even tell it to
give it a fav icon when those little you
know up in your tool bar that looks like
a lock I mean well I don't need to tell
you guys about noobs you already know
you work with them you go to school with
them you might be related to them I'm
sorry but you know that noobs are out
there and that this is totally going to
work on 99.9% of those cases so let's
take a look at what we actually captured
and create a new terminal here and let's
take a look at our SSL strip log and hey
would you look at that it's login
Capital One com user equals Bob and
password equals one two three four five
mind-blowing and another reason why you
shouldn't just trust HTTPS you should go
ahead and use an SSL tunnel a SSH tunnel
a VPN I know that you guys have been
having a lot of fun with the adido stuff
the Open VPN ALS if you will that we
talked about a few weeks ago so keep
sending your feedback about that VPN
stuff in it and just keep this in mind
when you're like oh I don't need to
tunnel my stuff I use HTTPS sure you do
okay
look you know just just keep that in
mind well you know if even if you're not
you know just take a look at what's in
your url bar in your browser because if
it doesn't have that s there then you're
not and and even that well we could have
a field day with this
ah I think this is something that you
guys are going to enjoy more of so we're
going to have some more fun with the
black hat stuff here soon so if there's
any other stuff on this side of the
fence that you want to see go ahead and
email me feedback at hak5 org to find
Moxie's awesome tool ssl sniff head over
to thoughtcrime org and for the show
notes of anything that we've talked
about here on this show that of course
is our wonderful little home hack v dot
org i want to let everybody know that
gain fly is an amazing service they are
the largest online video game rental
service and offer a choice of over 6,000
new and classic titles across all
consoles and handhelds with plans
starting at fifteen ninety-five a month
Gamefly members can rent one to four
games at a time and keep them for as
long as they like you can also purchase
a game if you fall in love with it
they'll send you the box and the manual
for a nominal fee head on over to
gamefly.com slash hack 5 to get two week
free trial membership gamefly.com slash
hack
alright guys so that just about wraps up
this week's episode of hack 5 I'm sure
Darren will be back with more SSL
attacks even though we did highlight one
you remember yeah hamster and whatever
they are fairy yes good stuff I think
I'm actually doing enter cap next week
but you know it really all depends
honestly I think people we can't
emphasize enough how much the feedback
at hack 5 really just changes what we do
on the show as well as what we do in our
daily lives because it's just our fun
hobby that we do just for you
yeah coming up I've got a segment based
on a star oh ooh I don't know how to say
it but basically it kind of takes the
whole routing web security SSL
site-to-site VPN ting rapsa all have
been won they've recently updated their
licensing model so you can protect more
IP so we're gonna do that I can run as
virtual appliance nice yeah up to 50
million yeah um you've got a bunch
embedded Linux devices on its way
oh yeah that's right yeah believe it or
not that device of the cable that just
came in for there's actually a Windows
CE II device the the game console yeah
believe it or not what a game console we
have coming um you know the Dreamcast oh
it looks excellent 10 year old
Awesomeness
I have a Dreamcast which was missing a
cable and now we're going to play with
it so now I get how that homebrew yeah
yeah before we leave though we want to
let you guys know about the hack 5 store
a lot of people have been asking Darin
where we can where you guys can get the
shirts that have the hacksaw logo on
them you can head on over to hack five
dot org slash lightweight store
switchblade hacksaw chainsaw all stuff
that you just kind of did and we're like
us nice nuke there you go there you go
what's this all about um so I got an
email
unfit that I was apparently wrong of
course you are
I'm never wrong Nelson sometimes wrong
but never actually never wrong every
once in a while he's
right so uh he's like Google I was
incorrect in saying that or being it's
like a wide release vmware player three
is in release candidate mmm and vmware
three allows you to create virtual
machines inside player okay okay that's
a subtle distinction to be honest it's
available you had to go to a different
website to search for it but the dude
was livid news oh yeah little bit never
heard of such thing so I had to go and
defend my honor and and say this is the
case go search out the I know I need a
bandolier but uh search out the VMware
Player three release candidate you can
actually create virtual machines however
there's another point that I wanted to
make mm-hmm which is the VirtualBox owns
VirtualBox owns do me favor before you
start playing with VirtualBox if you've
got an installation that is currently
running and I'm not going to say that
VirtualBox is the most piece of
software because that's exactly what
he's trying you remember pair polymer
prepare no we're not doing this yes but
you remember it for those of you that
don't know pair was the first power PC
emulator and that was horseshit this if
you've got enough if you've got a
version that's working don't screw with
it there I I don't even know how many
I've seen looking in the VirtualBox
forums of people having issues going up
X point X point one version bridge is
not working video not working hangs
yadda yadda yadda it's working for you
you run three point zero seven I've
owned 3.0 sometimes on that island don't
screw with it I've had problems but I'm
on it that's because I'm awesome yes and
because I know that open-source loves me
and as long as Linus and Richard
Stallman are around this happy world I
mean whatever you know choose to that I
shouldn't be on the show right now
absolutely not so I want to let you guys
know that TRS has come out with a new
website new show format new graphics
openings all that kind of jazz well when
can we
totally read show oh yeah every Tuesday
for a new episode of Totally Rad show at
revision3.com /tr
and just reminding you real quick
facebook.com slash tech no less and what
else we have twitter comm slash hack 5 I
mean you can find out all of ours right
marry myspace anymore um we do have in
my space I no clue what it is and I'm
not an ad stuff I can't really post
anything other than Newbridge so yeah
you can find that too and join it I like
the Facebook one because um it's awesome
and I update it once you get around to
it which is never basics Chiefs just
still join it that's probably though
shut your Tecna list
I'll PPTP connections and I oh my head
is on we've talked about Kiki yeah well
we were first me feeling to modify the
words lately we've been discussing
point-to-point today I am NOT going to
get a sentence out today I'm on alright
didn't realize we were back a little
hungry during that commercial there and
all I've had is freeze pops literally
that's not what I was trying to say oh
it's been so long since I've shot a
segment you felt it out honestly tell
you can count</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>