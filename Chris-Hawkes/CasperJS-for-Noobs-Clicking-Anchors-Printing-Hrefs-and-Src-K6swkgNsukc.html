<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CasperJS for Noob's - Clicking Anchors Printing Href's and Src | Coder Coacher - Coaching Coders</title><meta content="CasperJS for Noob's - Clicking Anchors Printing Href's and Src - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Chris-Hawkes/">Chris Hawkes</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>CasperJS for Noob's - Clicking Anchors Printing Href's and Src</b></h2><h5 class="post__date">2013-12-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/K6swkgNsukc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys what's up and this next example
with Casper JavaScript I want to go
ahead and show you just just a view of a
website here that somebody actually
asked me a question on as far as how to
click on a link with Casper so what
we're gonna do is we're just gonna visit
this one test site here and I just want
to be able to click on this Nike Kobe
eight system button here so what I'm
gonna do I mean first things first
anytime we want to take a try to scrape
something like this is um just take a
look at what we're trying to go after
here whether or not it's a span an
anchor whatever it is with Casper we
should be able to click on anything
inside that anchor element and it should
work so we could probably use an XPath
and find the span and click on that or
even just click on the anchor itself and
either way that should work because the
span is sitting inside of its parent
which is the anchor tag so let's go
ahead and get our script started here so
that we can try to resolve this now
first things first I'm gonna go ahead
and copy and paste some regular code
that you guys should already have based
on the previous tutorials but if you
don't you could probably just copy off
of the screen this is the typical firing
up Casper stuff that we need to do all
right so now I'm gonna go ahead and add
in a few more things here so this is
just using a user agent so that looks
like we're a regular browser now let's
go ahead and do our Casper start method
Casper that starts and then here is what
we're gonna go ahead and feed it the URL
of the page that we're going to request
that's here so I'm just gonna copy that
paste this in here now I do want to add
a viewport and the reason why is that
Casper well it uses phantom JavaScript
and phantom JavaScript they grab a very
small viewport by default so sometimes
like if you go to my movie website new
movies calm and you shrink it down on a
smaller browser you'll see that this
website is responsive so what
see on a cell phone is not necessarily
what you're gonna see on a desktop and
sometimes when you're scraping you're
like well why can't it click on that why
can't I find this why can't find that
one thing you may want to check is just
when you shrink that browser down does
the elements you're looking for are they
no longer there I mean just see what
sort of craziness is going on there but
either way just I like to set the
viewport big so that way we are getting
what we're looking at on a desktop all
right so it's good and now that we're
requesting the page I wanna do a Casper
wait method to make sure that our
elements and our page have enough time
to low at three thousand will be three
seconds and I will start the function
here a lot of times when you're not
being able to find something it's
because you didn't give it enough time
to actually load the page properly so a
lot of times what I like to do is I'll
just say test one we'll take a Casper
capture there so it'll take a screenshot
of what we see so if for some reason it
fails we can at least look and see test
one image and see what it is that our
Casper script had actually seen when it
failed so that gives you an idea if you
see like half loaded stuff that the page
obviously didn't have enough time to
load all right so now that we're ready
to actually try to get what we want to
do is click on the anchor first so let's
go ahead and pull this page back up and
I'm gonna look here so there's a few
options that you have as far as trying
to click on this element itself if you
inspect element using Chrome and you
just go down here and copy the XPath
something like that would actually work
if you're just simply trying to click on
the element so Casper got you click and
then we're gonna say X or X back and
then we'll just copy our XPath right in
there so we'll let that do its magic and
let's go to wait another three seconds
real quick
it's a Casper dock capture test 2.jpg
sorry I can't side tonight I'm too tired
all right so um do that what else need
to do our tasks for got run method so
they'll actually run when we start this
thing let's go ahead and pull up a
command prompt here I'm gonna do this I
would call it it's a phantom in
JavaScript
I'm gonna say example dot
and I will just let it wait for a few
seconds here so I can finish what it's
doing all right so now that I've
finished that let's go ahead and take a
look at the output and see what we found
here
okay so I Drive my folder here you can
see our script is right there test one
you can see the page loaded fine test
two you can see that it actually clicked
on the element that we were looking for
now say you don't want to go because
this is a ugly XPath here this is
obviously you know Google generated a
lot of times when you have a very deep
XPath that goes on for like a mile and
you'll find that it just kind of trips
over itself and it doesn't really seem
to find it it's better to drill down to
a more solid XPath what I like to do is
if we know that like in this particular
case we want to click on the link that
says Kobe eight then we know the Kobe is
in the span that we're looking for here
which is probably the only time it's
mentioned on here well possibly but
anyway so what I would do to go about
that is I'm gonna go ahead and put a
star here which matches any element on
the page and then inside these square
brackets we're going to search by class
because you can see that the div class I
want to drill down and find this
specific class right here so this
spotlight thumb so that's what we're
gonna do here we're going to add equals
spot like thumb and close off our square
bracket now then we want to look for the
a element inside of that div which is
right here and then we want to find the
span element inside of that now if for
some reason there's multiple classes
which there's always a good chance that
this class name can be used multiple
times throughout the page we want to
make sure that it finds the right
occurrence so we know that the span tag
contains the word Kobe for the Kobe
eight shoe so what we can do is add a
contains to our scan here within another
square bracket so we're going to say
contains and then we'll save text open
and close parentheses comma and then
inside here and the double quotes we're
going to search for the word Kobe
because we know that that is inside the
span tag so let's go ahead and close off
our little square thing here
and now let's go ahead and test this out
and see if we get the same results and
just so you guys know so we don't have
any any surprises here I'm gonna delete
these two images so that we know whether
or not this thing works and let's see if
we can accomplish the same thing by
drilling down and being a little bit
more precise with our X path well maybe
not the word really isn't precise it's
more like better efficiency maybe
because like I said I mean you can do
the right-click copy X path but there's
a lot a lot of occurrences when you have
divs inside of 15 gives in this
mile-long X path that it just doesn't
work so it's usually best to just try to
drill down and find it yourself based on
text and things that you know are not
gonna fail so anyway that's just my my
experience with it all right so let's go
and run this thing again all right so
this thing has finished you can see the
first test passed just like last time
second test is passed so that X path was
able to find what we were looking for
and it clicked it now we didn't have to
invoke any sort of JavaScript or inject
any jQuery or anything in there Kasper
just works with the Casper click on the
X path so you really don't need to pass
jQuery and to be able to accomplish this
but I do plan on touching base on on how
we can inject JavaScript to be able to
interact with the page as well now if
you wanted to get like say you're just
printing something back from Casper and
you just want to get like the H ref so
then you know what the link is for this
copy thing we can do that as well we can
actually create a variable and we'll
just call it anchor because we're
getting the anchor text and we'll say
equals x
actually you know what we're not going
to it's gonna say equals Casper dot get
element and attributes and then here is
where we're gonna put our X so it's just
copy the same X path because we know it
found the spam but in this particular
case the span isn't gonna have the href
right because the span isn't an anchor
so to get that we want to do a forward
slash on this and we're gonna say parent
and then colon colon a so get it says
get its first parent which is an a so
really it's gonna find this and then
take one step back and get the a and
then in here we want to go ahead and put
a comma so this is the X path and then
we want to put in single quotes what it
is that we're looking for so we were
looking for an image source we could
find the image source by saying source
SRC or in this case we're looking for
the link
so we're saying href because it's going
to be the link now we want to go ahead
and print that out to the screen some of
the sake ask for a dot echo and we'll
say anchor so if everything goes well it
should print out to the command line
the href for this COBE page
and there it is so that is one way to
click on elements using XPath and then
another video like I said I'll get into
how we can inject JavaScript to interact
with the page typically if I don't need
to do that then I try to avoid that most
of the time like if you're just testing
a program or something or you're testing
out a website I mean it's you know
supposed to be what these programs are
used for so if I were like working on
Foot Locker and testing out their
website and doing some sort of
automation or something you know I would
basically run a script like this and
then I would use Python to read the
output of the Kasper script so then you
know I would be able to determine
whether or not it's finding the right
elements and that the page is working
message as as expected anyway thank you
for watching and please subscribe I
appreciate all the complements and
everything online and thank you have a
good night</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>