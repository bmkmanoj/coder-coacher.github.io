<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building a Django Website 4 - Building the band app | Coder Coacher - Coaching Coders</title><meta content="Building a Django Website 4 - Building the band app - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Chris-Hawkes/">Chris Hawkes</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building a Django Website 4 - Building the band app</b></h2><h5 class="post__date">2014-06-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Om85iIHoxCE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys welcome back all right so in
this next video I want to go ahead in
and talk about enabling something to our
installed apps and what that is is we
want to install south so Django South
database migrations can be a real
problem basically when you create an app
we're going to be building like a
database schema that says like name
genre you know stars things like that I
mean when you update a database all the
pre-existing ish entries into that
database are all screwed up if you add
new database records so that you have to
do a database migration and Django
doesn't handle database migrations all
that well so Django's south is like a
godsend in that regard however they are
working on the newest version of Django
1.7 which is going to include Django
include database migrations in the
meantime though you need to have South
installed Majengo south you can use like
pip install probably easy install I
already have it on my server but just
its Django SRU th and here you can see
that you can read about you can download
it I think it's just like pip install
wood would be able to install it fine
but let's go to the settings file and we
want to make sure that that is added
because it's probably one of the single
most important things you could possibly
have in your application so we'll just
add south and update our settings file
and run sync TB again now that South is
installed now we're going to go and
create our first project or our first
module it's not really module it's an
app that's the word for a nap and to do
that we need to go to our command prompt
where we have access to python manage
and we'll type python manage py will say
start app we're going to create a band
app okay so we've done that and now
inside our my project file we should I
have a folder now for band and you can
see it there so when we go to the server
I'm going to go ahead and refresh this
go into my project and you can see now
that we have band inside of there so
let's download my project locally and
I'll refresh my IDE so now that we have
access to band and you'll notice on this
new app that we have has its own I knit
file has its own models file my tests
and views you want to worry too much
about that let's go ahead and create a
URLs file for that
okay so the first things first
let's go ahead and just right click here
we'll add a new item i call this URL is
that py and similar to the other URLs
file that comes with our main
application we're going to import from
Django dot config dot URLs defaults
import star this needs to say defaults
and in here we're going to create
something called URL patterns equals
patterns and this is a tuple which is
like a Python list but it takes up less
memory
there's going to be a carrot time and
we're adding a look ahead assertion
regular expression I believe is what
it's called and we're going to call this
band ID and this means just a number so
band the band idea is essentially just a
number that's it but we're going to use
that number to query our database to get
the right band that is associated with
that number so this is going to be
called band
and we're specifying that is going to be
in the band views file since this is a
tuple you want to make sure you have a
comma after that it would also be
helpful if you spelled patterns
correctly as well
alright let's go into our views file and
we're going to go ahead and create the
main band page so we'll say define band
the first argument is always request the
request object and then it's going to be
banned ID this is the regular expression
we're going to be passing to it and
we're simply going to say band equals
when you say band equals band objects
dot get p k equals band ID so the
primary key is the band ID that they
passed into the URL and then all we're
going to do down here is render to
response and we're going to band
directory and then we'll just say band
HTML all right now let's go ahead and
put a dictionary object in here and the
first thing that you do and the
dictionary is the key is whatever you
want it to show up in the template ass
so we're going to call it a band to keep
things as clear as possible and then
that band object is going to be the band
object we just query from the database
and then the final thing that we pass
back is the request context
request object alright so that is our
first view for our app now in order for
this thing to work we do have to
actually import the right things that
we're using which is these two arguments
right here so just pause d just pause
the video and in kot and then write that
in there from Django shortcuts and put
render to response this should be an all
the views that you're dealing with
alright so let's go back to our main
URLs file not the URLs for our band app
but our main URLs and we want to include
the URLs for the new app that we just
created which is banned so in order to
do that we're just going to do an open
parenthesis are and then it will do
caret sign and we'll type band forward
slash
and then close it off and into a comma
and we'll say include band URLs another
close parentheses and then a comma make
sure that comma is in there and what
this does it basically says if you
request new music com forward slash band
it's going to refer to ban dot URLs for
anything after this forward slash here
which is just going to be a number
because what our band object is going to
be expecting when we go to the URLs is
just simply a number an integer that
could be one digit or more and it says
basically take that value and assign it
this band ID name and then it says with
that value go to band views band which
is located here and it says pass in that
band ID that they had passed the near
also if it's one they pass that in and
then we simply say okay create a
variable object from the database that
is the primary key so it says get the
band object that's primary key is the
band ID that got passed into that URL
and then render to render your response
as the band at HTML and then and within
that template that is being passed back
it says create this band object and your
template and make sure that its value is
this band object that we just created
from the database and then it just
returns it back so to move along in that
direction we need to go to our templates
and we need to create a folder since we
have this band object here we need to
create that now so we'll say band and
then inside the band we're going to
create and inside this band folder we
need to create our HTML file which is
called band
and since we have a band object being
passed back we can just say band dot
name all right now none of this stuff
actually exists inside the database
right now so we need to think i'm
getting tired i'm sorry so in order for
this to actually exist inside the
database that's where the models file
comes in because this is where you
create your database schema and we need
to go ahead and define what that's going
to be and it's difficult to say exactly
when you're building a big application
exactly how to lay out your database
because um yeah it's just very hard to
predict where your your app is going to
be and how much it's going to change
over time and stuff like that but the
gist of creating a model file is that
you have to create a class that inherits
from models that model and the class
name is going to be named the the app
name so in this case it's banned but we
want to we want to go ahead and uh let's
let's import something that we are going
to need which is date time because I'm
going to have a date slot for this band
and let's create the model Fowler so
we're going to say name equals models
dot caffeine and we want to give it a
max length they don't you don't want
like a paragraph in there for a band's
name and really 250 characters is way
too much probably I think probably 100
characters as much as all allow anybody
that has a band larger than that can
just go f themselves i guess and null
equals true blank equals true unique
equals true so we want the band name
itself to be unique some bands have the
same name but they probably shouldn't
and if they
do then they should probably be
differentiated possibly by maybe there's
on row of music or something like that
but let's going and we'll do that for
right now in fact you really don't want
the band name to be you don't want to be
blank at all so definitely take those
out if we have those in there that means
that that means that you could have a
band that has no name and that would be
a pain to deal with now we're going to
add date added equals models dot
date-time field and we'll say default
equals datetime datetime dot now and
that's where importing the date time
comes into effect so that way you don't
actually have to actually specify the
data will automatically be pre-populated
at the time that the object is in the
process of being created it'll just have
their current time now that is on the
server I'm going to say image models now
character-filled max length
equals now I'm going to have a 1,000
character in there that might be
overkill we can always adjust that later
on but the reason why I have that is
that sometimes you have these URIs that
images are embedded into HTML and sybil
yeah so if you're pointing to one of
those you are is it could be a lot of
text there and might even be more than a
thousand so I'm not sure how effective
that's going to be but we'll just do
that for right now so I don't want to go
too much into how we're going to design
the database right now because we
haven't really given it a ton of thought
but just for right now we have a band
object that has a name the date added
image and while we're at it I want to go
ahead and I want to give them a date
founded
and instead of defaulting the daytime
daytime that now it's just going to
simply be blank but we'll be able to say
no equals true and blank equals true so
that way they don't have to actually put
a date in there but that'll be the date
when the band was actually created all
right so we're pretty good to go here on
a lot of our stuff now one final thing
that we do want to add is we want to add
an admin file so that this object will
be added to the admin and that will make
more sense here in just a moment so
let's create an admin py file and we're
going to say from band dot models import
band which is the name of the class of
the model object that we just built and
we'll say from Django dot contraband now
from here we're going to create a class
and it's going to be called band admin
and it's going to instantiate from or
inherit from admin dot model admin okay
and now from here we're going to be able
to say how is the object in the database
going to be displayed so we're going to
display it by name and since this is a
tuple need to have that comma in there
and then we're also going to give the
admin the ability to search and the name
so you can give it a bunch of things to
search by but we're just going to search
by title and then finally at the bottom
here we're going to say admin site dot
register i'm going to say band band
admin so now we have all this stuff in
here let's go ahead and refresh what we
got upload the entire my project upload
the templates
there's things going slow all right so
that should be uploaded now and let's go
back into our shell and we want to since
South is now installed we're going to
use south and south um it's important
that we go in and we say Python manage
that pyr we're going to say schema this
is what you do the first time you use
south on a nap so we're going to use
screen schema migration if I can spell
so schema migration one word and then
we're going to give it the name of the
of the app which is banned and then
we're going to say we'll say initial so
it's two hyphens and then initial now
this isn't going to work because we
didn't add it to our settings file yet
so it says that there's no enabled
application matching band and the reason
why is because we did not go to our
settings file and add band to our
installed app so we're simply just going
to say band with a comma let's update
the settings file and that we can run
this again so it says that since South
is installed it created a database
migration I apologize if this is hard to
read the ad man i can't really blow it
up anymore I don't think but it says it
created a 0001 initial py and it says
you can go ahead and migrate that now so
the next thing that we want to do is
take out all this schema migration so it
says just Python space managed up you
why we're going to say my great band
you
and that didn't work I should have
worked let me try to do it a sink TB all
right so I want to make sure that South
is making ya see what was missing there
is that we needed to do sink TB first
because South did not it needs to make a
entry into the database for it's a any
sort of schemas schema migrations that
are done so when the migrate happens
south is going to make a entry into its
south migration history table of band so
let's go ahead and just some you don't
to do the scheme of migration again but
just say my great band and you can see
that it did migrate 2001 and what's
going on behind the scenes here is that
South has basically when we did a schema
migration we created this initial file
here so I kept track of all the the
database schema so that way when it
changes it will handle the migrations
for us but right now we're on migration
0001 and then when we did the that's
what got creatively did schema migration
and then when we said migrate south went
into the database and when we refresh
this here you can see that we go to
South migration history it created a an
entry here and it said hey band has been
migrated and it's on 0001 so in the
future when we update the the model file
and we add new entries here we're just
going to go ahead and migrate and South
will keep track of the differences and
then do the database migrations for us
so we'll be on version 0002 and on and
on alright so I want to go ahead and try
to wrap up this video as quickly as
possible let's go into our admin and i
want to show you that because we created
the admin that people i filed bands now
shows up in the admin
and we can click on that and now you
have this search box we're missing an
image that I'll try to fix that later
but it would be a little magnifying
glass and we have the option of
searching we don't have anything in
there right now but we can go ahead and
add a band and since base I got me into
programming let's go ahead and add them
now and where we said the date added is
default date time now you can see it's
already prefilled this is not prefilled
because we didn't specify but we can
leave that here and then image let's
just for right now just for the sake of
just for the sake of example we're going
to copy this image URL and will just
paste it inside here and now when we go
back to our database you can see that we
have band inside here now we have our
first band bayside and you have this
image and the data was added and all
that stuff so when we go to our
application we can now go to band and
didn't do one and let me see global name
band is not defined in the views I think
I know what we did wrong there this is
not a big deal anytime you're developing
you're always going to have bugs and
what we got here is that actually ban
should be lower case but what we have is
we have no we need to import the actual
band model objects so we need to say
from models dot no it's from band models
import uppercase band which is the class
name of the model file that we created
so we're importing this object so that
the view knows how to handle it so let's
go ahead and update that real quick
go back in here and now it's finding it
but we have a whole new issue so let me
see yeah what this error means is on
this means that I'm really tired and I
need to go to bed but i'll go ahead and
do that after this video but the reason
why that is is you always have to return
something here and i'm not returning
jack crap so you gotta return render to
response that is what the issue is
alright so we'll do that now and you can
see now that the template is being
rendered and we got the name bayside and
once again just to kind of recap what's
going on behind the scenes there is that
inside of band at HTML that is a dynamic
value that's coming from a database and
if we wanted to we could even say image
source equals band dot what we call it
image alt and then you can just
dynamically say like band name image
that we have a proper alt tag on your
image to be on HTML compliant and we go
over here we can upload our template so
it has the changes so there you can see
that we're now getting some dynamic
values and the video coming up here
we're going to go ahead and build the
master page so that we have a basic
structure of HTML structure that every
page is going to inherit from to prevent
code duplication we're going to ahead
and also build our like our main.css
file get jquery involved so this thing
can start looking like a real website
ultimately we're going to end up moving
towards having some pretty complicated
object relations because the band is
going to end up having a bunch of
different there's gonna be a bunch of
different apps for basically different
database components of this application
at least that's what I have in my mind
and we'll see how that goes in
they're coming videos here alright guys
thanks for watching and have a good
night bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>