<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Unit Testing With Mocha For Beginners | Coder Coacher - Coaching Coders</title><meta content="Unit Testing With Mocha For Beginners - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Chris-Hawkes/">Chris Hawkes</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Unit Testing With Mocha For Beginners</b></h2><h5 class="post__date">2017-02-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/sPyb6QlgBaU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys what is up what is up alright
so one of you guys had asked me about
actually several people that's about
this mocha tutorial the whole JavaScript
test kind of thing unfortunately I never
got around to doing it because I was
working on an es6 tutorial I think it
was react maybe I don't remember what it
was but I was going to get into actually
using mocha and trying to give people an
understanding of really what a unit test
is and why it's important and this video
is strictly going to focus on literally
just mocha and how to get up and running
for essential beginner and I think in
the process it will give you a basic
understanding of you know why unit tests
are written and and really you'll see
how they can quickly inform you of
problems should you change your code if
you have unit tests written around the
existing code that you've already
written so let's go ahead and get
started I'm going to actually put this
project inside of a my tutorials folder
called start mocha tutorial so that
means I need to open up a command line
to where the folder is located I'm going
to run NPM and MIT which is short for
initialization and this is going to set
up the project on this initially test
mocha that's the name of it and then
just enter through all this stuff that's
all I need now one of the things I
wanted to say that we're going to be
using two dependencies one of them is
mocha and another one is chai and chai a
CH a I like a chai latte and chai is
just an assertion library the actual
term assertion is very difficult for a
lot of newbies even though you might
understand what that word means like
just you know it's basic geek
terminology for making sure that one
equals one and things like that
so you could say it's like an equality
library maybe but they call them
assertion libraries and it's not just in
JavaScript it's alike that with you know
other languages and frameworks and
everything so let's go ahead and install
those two dependencies that we need to
work as an p.m. install save dev since
this is a development only feature and
we're going to say chai and mantra make
sure there's a space between chai and
mocha cos are two separate projects and
by saying saved as ry
we add it to our package config file I'm
going to open up the folder where I have
my project located which I think it's
here alright so here's a the
package.json you can see that chai and
mocha have been added as dependencies so
that's good alright one of the things we
want to do is we want to replace all
this stuff that's in test and we just
wanted to say mocha and that way npm
when we run using NPM is actually going
to find our local mocha installation now
one of the interesting things I think
this is the part that kind of confuses a
lot of people is that mocha by default
looks for a test directory in order to
actually run tests located within that
test directory so let's go ahead and
create a directory called test so just
simply test it's all it needs to be
called don't change it to something else
otherwise mocha won't know where it is
and let's go ahead and add our first
test there's going to be a bad we're
going to call it first test is now first
test is it needs code to test you're
probably like well where is the code
that we're testing well we haven't
written any of that so let's go ahead
and inside of our you know we can just
simply say from inside of our main main
folder here I think my cat is making a
bunch of noise over by the door all
right so inside the this folder here
we're going to have not inside test but
out make sure you outside of test dammit
we're going to say first I guess so
that's going to be our first file this
is going to be what we end up testing so
in order to test in order to even bring
this first aijs code into first test we
actually need to make sure that we're
using node modules so that we can export
it and be able to import it into our
tests so in order to do that we're going
to say module dot exports equals and
then we're just going to simply have one
function that we're exporting for is a
function
and the function itself is just going to
simply return hello world that's it all
right so here is the Nicol for a lot of
you guys have asked to see my cat that's
the culprit
all right so without further
interruptions hopefully we have first in
this refers tester this is Oni so now
inside test what you wanted to do you
want it to model your actual your actual
project structure so you can see like
since first digest is on our main root
folder of our application we don't have
to put inside of our test directory not
to create another directory inside of
that now if we did have a directory that
first sat in say like test directory
then you would probably want to have
inside of your test directory okay let
me give you a different example re so if
I had a folder that I said example right
this is an example folder and if I had a
test inside of it and we'll say test1 or
we'll just take codes 1s then inside of
your test folder you would probably want
to have the same structure where you
would have a folder inside of that where
it's an example and then inside of the
example you would have code 1 test is
does that make sense hopefully that
makes sense to you guys but basically
you want to you want to follow a
predictable structure within your test
directory so that you know that if I
have code 1 over here I should be able
to go in and find an example folder and
find the code 1 test so I can try to
reason about my code a bit more a bit
easier so that's really the whole thing
I'm trying to drill home here as far as
a that example I'm going to delete those
files because we don't need them but
it's just it's something that you will
see in a production environment where
you want to make sure you have structure
to the way that you're writing your
tests and you're organizing those tests
and everything all right so let's go
ahead and actually do our first test so
inside of first test yes we need to
import some stuff so now we're going to
use our chai libraries we're going to
a bar I start we're just going to give
it a certain dirty name and we're going
to say require and then we're going to
bring in chai dot skirt so we're
bringing in a certain portion of chai
now we need to also import the actual
code that we're testing so we're going
to say var first equals require and then
here we're going to go you know just
simply I think it's just going to find
it that way we'll know real quick if
that doesn't find it that should find it
so that's going to import first so all
the code in here which is really just
one function is going to be exported and
assigned to the first valve all right
variable so now we need to go ahead and
define or I'm sorry describe our test
block and the thing is the reason why
you do this is because it makes it
easier to understand what it is you're
testing so in here we're going to say
described first and that's simply the
name of the module that we're testing so
that's probably a good name to be honest
with you and then inside of here we're
actually going to say a function that
way we can capture all of our tests
inside of this describe block and the
first test that we're actually going to
have on this is going to be an itch
statement and it the first argument it
takes in a string where you just say
what it is that you think is going to
happen and we're going to say source
should should return hello world so
that's exactly what you're expecting
this thing to do if everything goes well
with your code when you execute first
it's going to return hello world so that
is where we're also going to then use
assert so that we can which is part of
the chili Brer e to actually make sure
that first returns us we're going to say
assert and then say equal which is a
part of a choice library and the first
argument you pass in is what it is that
you're executing so we're going to
execute first which is remember this is
just a function so we look over here
it's just just one simple function
that's being exported that returns hello
world so when we execute it the comma
between this is the first argument and
the second argument should be the actual
expected
push so we're going to say so it should
return and it has to return exactly the
way we spell the two still lowercase all
lowercase hello world otherwise it would
fail so let's go ahead and do that here
all right so now in order to be able to
run this test make sure you change the
package.json the tests so that it
executes smoko when we run that and when
we pull up a command prompt we're inside
this folder here I should be able to run
npm run test and this is going to use
mocha mocha is going to find the default
test directory and it's going to execute
all code that is inside of that test
directory so you can see first and
that's the reason why we gave a
descriptive title on our on our describe
block because we say hey all these tests
that follow are related to this first
module and you should
will we have a typo there but it's the
first should return HelloWorld so that
was the exact expected result now if we
were to now change this to capitalize
the H and we run this and more
importantly you know what the more
realistic thing instead of people
actually changing the test if we go into
first and somebody's day they go in here
and they start monkeying around with the
code and they change this now it's got
different capitalization or it says
something ompletely different either way
it's going to fail when we run this test
so if somebody were to check this code
in and these tests automatically get run
every time a code changed happens then
this would notify you hold a second we
have tests written that is asserting
that this code should do something and
it doesn't do what it was expected to do
that's a problem so that's really the
main reason why we have tests so let's
go ahead and change this back so it
actually passes some number it's all
lowercase and we run this now and we go
back to green and we passed it to you
can actually set up your server your
build server to wherever whenever you
check something in it automatically
builds all of the tests and make sure
that the expected outcome is occurring
so that's our that's our first test now
let's look at something a little bit
more I would say a little bit more
real-world but at the same time very
very simplistic so we're
going to add another folder or a file
I'm sorry oh just another file we're
just going to call this a DJ s so it's a
little bit a little bit more complicated
it's going to do the same kind of thing
as far as far as where we say export
modules equals it's just simply going to
be one function but this function is
going to take in a value
I'm so stupid this is backwards module
dot exports I've been using a babel in
the es6 way of exporting modules these
days but anyway here we go so now we
have that this going to take any value
and we're just simply going to return
value plus five so whatever the value is
that gets passed in we're going to
return obviously a number plus five so
we're going to expect that you know
value is a number otherwise we're going
to end up contaminating a number and a
string which probably isn't what we want
but we're going to worry about that at
the moment so let's go ahead and create
a test for our address file so we're
just going to do add and then test Jas
so once again it follows the same
structure root directory root directory
as a test inside of here we have to do
the same thing where we say you know
that we have to to actually require the
the the test the assert library I'm
trying to reservoir assert equals
require try third and then now we're
also going to end up importing our add
statement so we're going to save our and
equals require and then give us a path
to where this can be found all right so
now we have that and now we need to
describe our test blocks when I
subscribe and we'll just call this add
function and give our first edge
statement and we'll say should add five
to
should add 5 and return 10 I have to
basically you need to have tend to start
with if you're going to add 5 and return
10 so we're going to do a function
alright so here we need to go and say
add and we're going to you know I can
even save area bar we can even actually
execute to go a code and say expect it
we should you know and we could say bar
result is a good name so barb result
equals add and then we get we passed in
5 so we know this is going to return the
value of 10 so that's what result is now
we're going to go ahead and assert and
we're going to say a forgot equal and
then we go ahead and say results and
then tastin the value 10 alright so now
that we have this is the actual result
that we're passing in and we expect the
value to be 10 so let's go ahead and now
run this test all right now you can see
the reason why we add descriptive titles
because you can see okay add and this is
the first test for add and now we have
first and you can see this is the first
test for for first you should see should
add 5 and return 10 so we know that our
code is working good because if we go
back to add you can clearly see it's
just taking the value pass in and adding
five to it so if we want our add test to
be a little bit more descriptive what we
can do is we can go ahead and add
another testing statement where we
should say should return type number
that way we know that we're getting the
right types because javascript is a type
based programming language or really
scripting languages we want to be
completely anal about it but now what we
want to do is we have to actually
explicitly declare our result against or
in favor result add 5 I am we're going
to say result dot result and then we
should say so the value the value should
be a number all right so now let's go
ahead and take a look at our test all
right so now we have three passing tests
you can see we have two now under add
because the add module now has two tests
associated with it and said should
return type number so if I were to
instead string this would clearly fail
and just in case you guys want to
actually see that happening sometimes
I'm surprised when it test passes the
first time around because I almost
expect it to fail especially as code
gets more complex but you can see
turning into a string makes the code
fail now how can we make this a little
bit better we can use javascript
closures in order to to actually declare
our value for result at the top so you
can see these two tests that has this
you know this some duplicate to code
right here of result and technically I
could describe or declare result at the
top here by saying result equals and but
even by declaring it I could in then end
up saying you know result and a result
that save some space there especially if
I wanted you know two different values
to test different values that were
occurring but you should only need like
really one test surrounding like this
basic logic if you're if you're saying
hey the thing should add five only write
one test you don't have to literally
write a test for five plus five equals
ten and and ten plus five equals fifteen
that would be very very ridiculous to do
but you should have at least one test
saying that hey you know my logic is is
sound there but this is still very
duplicate --iv even especially since you
know I have the same value in both so
early it would be much more ideal than
to just simply assign the value at the
top here and through a JavaScript
closure meaning that internal functions
can gain access to two values declared
in their outer scope or their parents
you know three used for closure I can
just simply use result that gets
declared one time and now my tests are
much much more concise so if I run this
 I have a typo all right so now if I
run this it's going to go ahead and pass
the code is I think much more concise
and we should be good to go so hopefully
you know for a beginner level
introduction into really mocha and chai
and while you do that they sure give you
an understanding because once again
somebody starts monkeying around with
the code if you have tests written
around saying hey this should act this
way then those things should be caught
and you don't end up running into a
production problem that that could cost
your company millions of dollars trying
to figure out what the problem is or
millions of dollars in lost customers
because you know something unexpected
occurred you know and way down the line
so unit tests can be very very difficult
though because this is a very basic
understanding or basic introduction to
all this but it gets much much more
difficult when you start dealing with
having to stub out Ajax calls and and
other things that you know code and
really really you know complex modules
that could be brought in so it's it's
not really something that is difficult
it's actually going to be one of the
more difficult things you do but
eventually you get better at it with
time I would say I'm certainly not an
expert at all in any of this but it's
you know definitely what I've gleaned
over over the years and testing and not
just in c-sharp but also in JavaScript
so make sure you guys get started out
there using mocha and chai whenever you
can because I'm assuming you can get
into the production world that you're
definitely going to see it there and it
would definitely help you guys be able
to find a way to get your foot in the
door especially if you're like you know
what man I got a github project and I
got mocha tests on there and I'm using
shy and I know more than you know half
your 120 thousand dollar-a-year
developers so that should be the
attitude you guys have make sure you're
doing what it's required of you in the
production world all right thanks for
watching guys you guys take care of make
sure you subscribe and have a good
by hey guys so a lot of you asked me how
do I get my foot in the door to become a
programmer and I just want to take a
moment to mention dev Mountain coding
boot camp is a 12-week intensive course
that focuses on the technologies of the
here and now for web development some of
the things that they're actually
teaching in the Suevi course is geared
to get you into the industry by focusing
on things like jQuery nodejs
react angular how to use github so a lot
of the things that you're going to need
to do as a developer as soon as you
start they're going to be teaching you
in this and this coding boot camp and
the entire goal is to be able to get you
into the industry within 12 weeks so if
you guys are interested in learning more
information about Deb mountain coding
boot camp just check out the link in the
description tab of this video thank you
for watching and have a good day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>