<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Python Requests - 2.  Using Python Requests to Log Into a Website | Coder Coacher - Coaching Coders</title><meta content="Python Requests - 2.  Using Python Requests to Log Into a Website - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Chris-Hawkes/">Chris Hawkes</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Python Requests - 2.  Using Python Requests to Log Into a Website</b></h2><h5 class="post__date">2014-05-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/eRSJSKG4mDA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys what's up welcome to the Python
request for noobs tutorial and what
Python request is it's a good way of
doing some basic screen scraping trying
to get some data for data mining maybe
even website automation to an extent so
it's really good it's a lot easier than
using traditional methods in Python if
you've ever used beautifulsoup
for like screen scraping and stuff like
that this is a bit more modern very
modern approach to requesting webpages
so we're going to go ahead and jump
right into how we install Python
requests all right so if you're on
Windows I'm using Windows 8 it really
doesn't matter if you're using 7 or 8 or
maybe even XP if if you're going back
that long but go ahead and pull up a
command prompt and you just want to go
to pip install and then request and I
already have this installed so I have
this message that it's already there you
can also just run Python to make sure it
is installed and just say import
requests and if you didn't get any
errors it means it's installed and
working fine all right now I'm assuming
um you guys have some sort of an IDE
which stands for integrated development
environment to do development with I'm
using Visual Studio it's a little bit on
unorthodox I would say for Python
development but it is a great
development tool I think and I use it
for c-sharp so I'm just kind of
acquainted to it I used the Python for
word now as well but let's go ahead and
in a folder here I'm going to go ahead
and just create I have a scripts folder
and I want to create a folder inside my
scripts which I'm just going to call
requests so I'll add a new folder and
once again this is specifically for my
IDE just use whatever method you want
but this is just so that we can store
the actual scripts that we're going to
be running and I'm going to call this
request
right so let's go ahead and create our
first Python file so however you
normally make a Python file just go
ahead and do that I'm gonna say since
I'm using Visual Studio I just
right-click add a new item it's actually
probably not even let me do what I want
to do that's fine I'll just make it a
text file here's a text file and I'll
just name it dot py for Python so let's
call this first we should probably
capitalize that first request dot py and
here's my Python file and first things
first we're gonna say import requests
okay you're going to definitely need
that anytime now let's go back to our
command prompt and I want to go ahead
and go into where I have my folder where
we're going to be storing our our Python
files yeah I just move right into that
directory right now let me see if I can
make this a little bit bigger all right
so I don't really know how to make it
bigger so anyway let's get back to what
we were doing and the first goal that
we're going to deal with with Python
request is actually logging in to a
website and i have a website pulled up
here new movies and we ever created a
user account just for testing purposes
and i want to go ahead and show you
something if you're using chrome you can
go ahead and right-click on your page
and do inspect element under your
network panel i'm go ahead and open that
up and hit this little little circle
it's really--it's to clear out all the
entries that are there mine doesn't have
any but just in case you have entries in
there go ahead and clear that out so
there is no confusion and when you log
into a website it doesn't have to be
this one it could be any website of your
choosing you need to pay attention to
the post parameters that are sent when
you actually log in so in this case it's
go ahead and log in under my test user
which is named test underscore user and
then my passwords test one two three I'm
going to log in
and then we're going to see that it just
sent a login post parameter so let's go
ahead and click on that and inside here
you can see if you scroll down that
there's form data and the form data that
got passed there is a CSRF middleware
token which is a built in django
security feature to prevent cross-site
forgery
so basically other websites can't post
parameters to your site without actually
visiting your site first so make sure
that the post parameters are coming from
your actual site and not some cross-site
and then you can see the username
password and then the next next should
be optional but it wouldn't hurt to
supply that value that just means where
is it going after it logs in and you can
see that this is the root directory so
it logged into the root directory of new
movies com all right let me go back into
my editor here I wanted to just point
out that I did change the structure just
a little bit to make it a little bit
easier to see I zoomed in on the text so
we have this simple first request pie
file that we just created and the only
thing we did was we imported the request
framework so let's go ahead and it's
going to try to log in based on like
standard logging that should work it's
it's a demonstration given by the
request website all right so basic login
example let's go ahead and start by
saying with request dot session make
sure it's capitalized as see we're going
to go ahead and define some parameters
here
all right so for starters let's go ahead
and give it the URL of the page that
we're going to be scraping we're not
scraping by logging into
we're actually passing at that next
parameter that should be optional but
we're going to go ahead and pass that in
anyway so that way it just directs it to
the right page after it logs in let's
create our username variable and this is
test user and then we're going to create
a password variable it was test one two
three okay now with our requests object
we're going to state and we're going to
go ahead and say see get
all right and now let's go ahead and
give some let's build some login
parameters so we'll say login data and
we're creating a Python dictionary so
it's going to do that now the parameters
are we're going to be passing in is
simply whatever it's asking for so we it
was asking for username and password so
username is going to be equal to the
username variable we just created
password is going to be the password
variable we just created and I'm going
to go ahead and pass in next just in
case the actual URL I requested does not
work so I'm passing the next parameter
and finally we're going to do C dot post
so we can actually post these parameters
the first argument to post is the URL
that you're actually posting to so it's
been passed that and the next thing is
going to be our data is a named argument
for the request post method so the named
argument for data is the dictionary we
just created login data and if we want
we can add headers which is probably a
good idea some of these websites will
immediately reject something that
doesn't actually have a header so I can
say refer and my refer is going to be
the website that I visited to even get
to the login screen so it'll be new
movies com I'll just say admin it
doesn't like so I can just say new
boobies comm it doesn't matter let's
close that off all right and then
finally we're going to say
we'll say see and I get I'll just give
it a new URL to grab after we login
in fact I'm just going to grab the main
page so after we post the parameters we
should be logged in and then we're going
to get the main page and we'll take a
look at what happens
I apologize one thing that we do need to
fix is we actually need to assign the
git because this is a request object
this C is so we can't just simply use
that object to print the contents of the
page of the screen so let's go ahead and
assign that get to an actual variable
and I'll just call that page and then
we'll print page without content are
something to go ahead and run this
this text is kind of small let's see if
I can actually blow this up all right
I'm not 100% sure how to make that
bigger one of the things I need to do
though is the content the content we run
this program I'll run it from this
command prompt it just looks a little
bit bigger it's about as big as I can
make it when we run this
there's too much text being displayed
the thing I was trying to show you is
that the login failed and I was going to
show you the reason why but the thing i
can't show you evidence of that failure
because there's too much text being
displayed on this page so i'm going to
go ahead and pull up the actual profile
page for this user
okay and we'll actually do the get on
that page
all right so there's definitely less
data that we have to look through here
and one of the things you're going to
notice is that there is actually an
anchor for login and register currently
showing so those should not actually
show up because if we had logged in
successfully then that would not be
there would actually be a welcome
message and unfortunately there's not a
whole lot of evidence as to why
something like that would fail but the
reason why is because of that CSRF token
that I was telling you about before when
we had logged in we need to grab that
CSRF token and actually pass that in as
a post parameter so in order to get that
we have to request a web page first
while we're in the request session
method that we're working within it's
actually why did I see that get here
because um we're going to go to this URL
before we try to log in and we want to
grab the cookie for that CSRF token
while maintaining one session we'll grab
this cookie and then we'll store it and
we do it by doing that so we'll create a
CSRF token variable say C cookies and
then this is just a list item okay and
that will store the CSRF token cookie
from the browser session and put it
inside this variable and then we just
want to go ahead and add it to our login
data our argument
and the name of the parameter is CSR of
Middleware token and then we'll just
assign that to our variable
alright let's go ahead and try this
again okay
there's a lot of stuff here and it looks
like I'll have to run it from the other
interpreter
all right so it is a little bit harder
to explain than what I had initially
intention had initially thought if you
want to try to login to another site it
might be a little bit easier to see the
direct results but the reason why we
know that this is successful is that the
page now has the test user profile name
under this header so if we look at that
page after we're logged in you can see
that header is right here and this only
displays after you're actually logged in
as test user so the login was successful
the first time around it was not
successful because of that CSRF token
which is definitely required so the
whole point behind this is that whenever
you're dealing with different sites and
you're trying to login you need to
verify what post parameters are being
sent when you log in by using the
network panel within Google Chrome so
you can match those parameters when you
make these requests all right in the
next videos we're going to get into some
more programmatic use of requests all
right guys thank you bye
the</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>