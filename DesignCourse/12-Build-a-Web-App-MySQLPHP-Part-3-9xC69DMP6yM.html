<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>12. Build a Web App - MySQL/PHP Part 3 | Coder Coacher - Coaching Coders</title><meta content="12. Build a Web App - MySQL/PHP Part 3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/DesignCourse/">DesignCourse</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>12. Build a Web App - MySQL/PHP Part 3</b></h2><h5 class="post__date">2014-03-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/9xC69DMP6yM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello Gary Simon here of design course
calm today we're going to continue on by
doing a little bit more work in MySQL
and PHP we're going to insert and
separate the data of for the I once and
the I offers session variables we're
also going to create a function for
logging in alright so basically if you
need access to the project files they're
available in description here in YouTube
in a design course comm and if you
haven't yet subscribe here on YouTube
alright so get started alright so
basically where we left off is right
over here I yeah so basically we have
all this information the user data the
email password city state and the data
is all saved in the MySQL table but the
one thing that we didn't save yet is the
two session variables from the home page
that I need and that I can offer this so
that's what we're gonna focus on now so
basically you know it's really trying to
think about what's the best way to kind
of save this data so you know down here
we suggest that people basically split
their needs or want with a comma and
then initially I thought okay well what
we do is just take that comma and we
would run the variable through it's
something called PHP explode and that's
a function that will take a string and
basically create an array and separate
each one of these I so that we could
place it into the database so the
problem with that is as I said let's say
for example someone needs lawn mowing so
they need their lawn mowed okay whatever
whatever so let's say for example
someone's gonna offer that except they
put mowing lawn well then we kind of
have an issue if you're trying to match
those two up so what I decided to do
instead of separating by comma I'm just
gonna separate them by a space so each
word
we'll get entered into its own row in
the MySQL table so I'm going to create
that table real quickly and that's over
here so I'm just going to create two
different tables the first one is going
to be once number of fields will be 4
and the first one is going to be ID it's
gonna be an integer I 11 characters long
and then just change this stuff real
quick Auto increment and then we're
gonna have the user ID that as well will
be the integer and integer this is gonna
be the actual output image to make it
want the actual want we'll go here I'll
make that varchar' and really this is
just gonna be single word I'm gonna put
50 just to be I don't know if any 50
long character words but whatever and
then date added and that will be a
date/time all right save and then to
save ourselves some time so we could
take this up here just copy that go to
SQL tab paste that in we're gonna change
the name of the tables to offers and
this to offer and I think that is all we
have to change and hit go all right so
we now have two new tables offers and
once alright so now what we want to do
is come back to our code and there it is
and basically I think you could do it
anywhere inside this section I'm just
going to put it right after this insert
and I'm going to make a comment insert
once and offers and that will go there
so basically what we want to do is put
in once ARR has in array equals explode
and then this is where basically we
specify whatever it is that we want to
separate this the actual string so is
going to be a simple space and then I'm
going to put in
session I want I think that was the name
of it I'll make sure here in a second
and then copy this the same thing for
the offers as well I offer and then what
we'll do is run through those so the way
you do that is do a for each once a ere
are as once and that means this will
basically loop the I however many you
know if they entered three different
words it'll go through this three
different times and put in the actual
insert query insert into once and that
will be the user ID want and date added
values and then we also need to get
their user ID and the user ID is
generated from the ID field which we
didn't put in here it's automatically
generated I so I have to make a couple
changes to this real quick just to get
that whatever that insert ID up here was
so basically that would be I don't know
why I didn't do this I forgot to add
this the last time so all I have to do
is put result equals there and input I
NS ID for insert ID equals DB insert ID
and then result so it's getting the
insert ID from this result right here
and this again comes from that class
that I use alright so now we have that
and so right here for the user ID is
where we put that variable right here
all right so that tells us which users
are associated with whatever wants and
offers all right and then we can put the
actual once variable right here and that
comes from this and that will just
basically be a single word and then
the actual date added which is just now
like that and then result equals DB
query and the query variable alright so
we'll take that and then just paste that
in all right and changes to offers
change this to offers and this to offer
and is to offer us there we go so it's
basically it's just a duplicate thing
alright so I basically let me come down
here get rid of us on the space that
should be all it takes right here to
insert the individual once and offers
basically so I'm going to save that and
I'm going to go ahead and upload this
and so I'm going to add this here and
I'm also going to change one thing real
quick in the verify imos I saw an error
last time I or is that at yeah there
needs to be a semicolon at the end and
also this main I don't think that's
working right now so I don't think we
added that as a rewrite so we'll do that
real quick change this to main and then
this to main dot PHP all right so let's
save those two files upload those all
right so let's go back here I need and
I'm also going to illustrate one issue
as well while I'll do this I'll just put
section kandi I think I heard that from
a song or something and then I can offer
and I don't know exercise equipment
whatever I'm just using that as an
example find matches let's put in an
email address I let me think of one that
I'm using
I'll just put G's Simon Warren Alabama
whatever all right so let's see if this
worked so let's click on browse oh no
that didn't work what about the offers I
bet that didn't work either
wow that worked I think I mean it just
screwed up a variable name so as you can
see for the offers at least I offered
exercise equipment okay so each one of
these now have this user ID here as the
date added has its own unique ID I let
me go see why once didn't work so let me
go back here real quick and that's
because it the the variable wasn't I
wanted it's I need there we go so I need
we can leave this the same just as long
as that was changed up it should work
correctly now and so let me just go back
here let me see if I can just refresh
this and see if anything else gets
changed here all right there we go all
right so the issue being obviously is
it's saving it doesn't matter what type
of word it is I so generic words like
and and even generic words like
equipment that should not happen I we
shouldn't really save those generic
words because otherwise two people might
put and in there their need and then
another person I put and in there want
and then it's going to give them a match
but it's not gonna be relevant so you
would definitely want to run these
through something like an STR replace
which is a function with PHP which will
replace words so you can basically
sanitize that string before you go ahead
and split it up using explode and
inserting you the database I'm not gonna
mess around with that just because it's
the tutorial and it's on it you know
there's probably thousands I could do
differently but anyhow yeah it works
just for our immediate purposes
so now what basically happens is let me
load up my email and here's the email
from that second time I refreshed it and
by the way when a person refreshes the
burro so you obviously should check to
see if that email exists already so it
doesn't add two rows but I'd be yeah
this is basically where it takes us when
after a person's confirmed their email
I and that comes from again where is
that redirect just to show you real
quick just you know everybody
understands that comes from this line
right here so header location it means
just going to redirect a browser from
the verify email that PHP over to main
all right but before it really I should
direct a person over to main to this
main area where it will eventually show
the real matches I they need it needs to
basically log them in so it's not doing
that yet and I so I have a function
basically a login function that we're
going to add to our session Inc PHP file
that will make logging people in pretty
easy so let me get that out real quick
let's go to include session Inc all we
have is just a session start here and so
real quickly before I paste that in and
kind of describe it real quickly I'm
going to make a slight change to this
over here instead of just counting the
row and then checking to see if that
actually equals 1 or not we're gonna do
select all from users where verify code
gets that and also changed the result to
fetch row so that basically means it's
going to take every single row that's
associated with the verify code that
equals that if it does find one and then
put them into basically a variable that
we can access and you'll see why that's
important here so what we need to do is
change exists from exists here and we
could put in I think just email doesn't
equal blank so if it if the I email
isn't blank then that means I've found
an actual match for the verify code
and then we can keep this the same right
here this right here and then what we'll
do is just underneath this we're going
to put in user login and this is where
we're gonna put the exists username
sorry not user name we're not using user
names here just the email and then also
exists password alright and that's all
we have to do for there will save this
real quick and then come back to session
Inc and we need to include our I files
here real quick let me go to index and
copy those two lines alright so
basically inside of here is where we're
going to put the add the actual function
and this is going to be user login which
is what we referenced in the verify
email file and then we're going to put
in the variables here I could just make
this email and then the second one will
be password and then inside of here is
where we're going to add a couple things
Global DB and then put in our variables
here for the email so I'm just going to
put in new email equals add slashes I
email right here and then new PW equals
I'm just going to put password here for
now and then a query select all from
users where email equals new email and
password equals new PW oops
and then I limit line just a limit
debris the results to one and then if
I'm going to make the variable a RN min
equals DB fetch row query equals false
then we want to return false that
basically says if this is not found that
the user is not found basically then
it's not going to work it's gonna return
a false and then otherwise down here is
where we can actually set up our session
variables where we'll check to see if
the users actually logged in through the
various pages that require a login and I
I don't want to use client ID I'll use
user ID equals or equals I a are our
admin ID which is the ID field
associated with a person's
row in the users table actually I don't
feel like typing this all out again just
gonna do this over here and I'll just
put you know sometimes it's worth saving
some session variables to quickly access
like a basic user data like email and
their ID so I'm just going to limit to
those two session variables and down
here at then just put return true and
that is it go ahead and save this and
then let's see over here alright so
basically let me get out main PHP so on
main type PHP we want to add our
includes as well so let me go over here
just take these three at the top
come over here at main and we'll go
ahead and also check for the client
session variable so basically I if is
that session user ID
and then we just read them direct them
back basically back to the home page all
right
and so if the sessions not there
redirect them back otherwise it'll load
up this page which obviously the
information down here isn't yet dynamic
all right so I'm gonna say this stuff
and hope it works what you probably
won't know okay let me go ahead and go
to include and upload that as well and
we'll see if this works
and fortunately it does I didn't want to
embarrass myself again so I paused and
ran through it so you know just to show
you real quick that it does work let's
do that check the email click on it and
it automatically directs us back here to
Maine dot PHP and just to make sure that
this is all working correctly what we
can do I mean it definitely is but one
thing you can do just to check real
quickly is to on main type PHP
temporarily put echo session user ID
just up to top you upload that real
quick and that's in main and then we
could refresh this page and it shows
that client user ID so we are logged in
all right so I'm going to end it there
for today and when we create the actual
login page we know which is over oh as
you can see it's not showing it because
we're logged in I don't have a logout so
anyhow there's usually just login button
here we'll make a quick login page and
that will use that function from the the
session dot PHP that we made and then
all the obviously as well we have this
stuff to worry about as well all right
so yeah check out design course comm and
subscribe here on youtube if you have
any
all right goodbye
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>