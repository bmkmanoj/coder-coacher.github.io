<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP OOP Game Framework (Part 3) | Coder Coacher - Coaching Coders</title><meta content="PHP OOP Game Framework (Part 3) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JREAM/">JREAM</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP OOP Game Framework (Part 3)</b></h2><h5 class="post__date">2011-01-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/rGvfqM75trU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Hey
hey guys welcome back to the game
framework tutorial part 3 if you reload
your page you'll probably see something
like this and it's saying undefined and
that's because our session has expired
and that was just a temporary solution
so I can cut this little comment here
paste it up here and I'd have to move
the bot also under the creating thing
before we register it so if you wanted
to do that to have it working again a
refreshing there's our stuff but for now
what I'm going to do is first create a
form to log us into the game as a player
so I'm going to first rename my index
file and I will call this play okay so
let's play and I'll make a new file and
this one I'm going to call index
and we need to make a little form to log
us in as a player so I'll say form
action method equals post I'm not sure
where I want this form to go so I'm
leaving this blank I'll just put a bunch
of pound signs in there and I'll do an
input type equals text name will be name
why don't we pop a label here and say
name and a submit button I can put type
equals submit I suppose I'll do a line
break as well so on the index page
refresh we have this here doesn't do
anything yet and we're going to make a
database to save our character and and
this is built right into NetBeans
so I can go up here to services and I'm
going to click the little plus bi
databases and I'm going to right click
database and do a new connection and my
host well first I got to change the
driver to MySQL my host is localhost my
username is root ok connection already
exists okay well create that I guess I
have mine right here I didn't see that
and connect okay
expand here we go and let's see execute
command I want to create a new database
so I'll do create database and I'll call
this game and I'll press execute
oh that's run main project Oh bummer
where is the SQL thing
I guess I'll just right-click the file
and do run statement okay and over here
I'll hit f5 or right-click and hit
refresh I guess it doesn't have a f5 key
and here's our game database and inside
of here I want to create a table we
don't have any yet
so let's go ahead and create a table and
I'll call this players and add a column
for the first one I'm just going to do
it for a name and I'll set this is a VAR
character if you're not familiar with
MySQL I have a bunch of tutorials on
this you can check out and the sides I'm
just going to say 20 and this will be a
primary key okay and I'm also going to
make one more and call this one data and
this one I'll do text okay okay and we
have a player's table now with name and
data and inside of here I want to insert
some data so if we go back to our game
and let's go to play dot PHP we have the
serialized thing that we'd like I'm just
going to copy this whole thing
and I'm going to say insert into players
name and data values and I'll call him
Ted and then the big ol string I'm going
to do use game just to make sure I have
this right and let me execute run
statement no database connect all right
there okay I'll just do game dot players
run statement okay and right click
refresh and let's see view data and we
get this little box down here so oops I
want to view data on the players there
we go so we have Ted and his data in
there cool and what we're going to need
is a MySQL connector and what I'm going
to use is something I've already made at
my site dream.com you can use any
library you like but I've made this so
that it's easy just to use a simple
thing and under a lab and open source
I'm going to grab the my sqli class and
I'll just select all this copy
control n for new make a PHP file and
I'll just call this DB finish select all
and paste that in there now I'll go back
to projects tab and we have a bunch of
files here so it's about time to
organize so I'm going to right click the
source files make a folder and I'm going
to call this libs as in libraries and
let's see I'm going to put everything in
there except for index and play and if
you open this it's still not
satisfactory so what I'm going to do is
with gain what we have our children
class is to go into that and keep this
organized and logically easy to read
I'll make a new folder and call it game
and the children of game will go in here
abstract character player and by ok and
you're going to know that these are not
going to change and they play that PHP
file we have to change their paths so
libs game
those ones our libs game and this one is
libs and this one is libs
so to make sure I have no errors I'll
refresh looks good and I'm also going to
want to include the DB Lib / DB PHP
since DB and session are kind of like
not part of the game so much but just
usable classes I'm going to put those at
the top and save that let me open DB one
more time and see what I did okay class
DB that's what I called it and we're
just going to copy the notes I put up
here okay close DB up and index file
I'll just paste it up here in this PHP
and let's see I'm connecting to
localhost with the user root and the
table I want what's called game if you
remember over here we made game and this
will give us our new database object
here pretty easy to use and I'll do
select all from players I'll give this a
variable
I'll Coast players equals this and I'll
print our players to make sure it's
working and we're I'll just refresh play
make sure that's working and I go to the
index file class DB not found we forgot
to include that up here so include Lib /
DB PHP refresh okay and we have select
all from players players equals DB well
sorry about that I have a different way
effects from the data I do DB get and
I'll call this players equals DB get and
refresh and there we have it this is
giving us an enumerated array and an
associative array so we have two copies
of that I'll just check back real quick
if I made a way to fetch ok fetch mode
and I'm going to set the fetch mode
so in DB set fetch mode and what were
the types
I had case one in case two I'll just put
in two so that we only get the
associative array on the echo three out
real quick and refresh this and now we
don't have two copies let me show you
once again if I comment this out this
selects the enumerated values here and
the associative but I just want the
associative because I think it'll be
better to work with so now that that
works this is going to go to the index
page index dot PHP which is the page
were on and we're going to do a login
and up here let's say if
request login and go all the way down
here and we can tab these over this is a
quick way of doing it by the way I would
probably make this a little different if
we had a lot of time to go into that but
no big deal so the request of login and
we're going to post the form and we're
going to post name so we'll do post name
and to make sure this works refresh this
and let's see test test
the post name did not work so request
login
and host name
that's odd
died
oh well I have to do is set is set
request logon that's embarrassing
so is okay that works and I will get
this little piece of data and I'll just
make a note here that says connection
and let's see DV equals new DVD set
fetch mode and check the user so we're
going to check a user so select star
from players wear pose that ID equals um
whatever his ideas I'm going to change
these to double quotes little bummer
okay so we're ID equals the post value
so name players DB gets from our players
okay
refresh problem with SQL select star
from players wear ID
let's see Services players sorry it's
called name not ID just refresh that
okay so good good
and we had one name Ted that we put in
there and we'll get Ted here beautiful
okay and I can get rid of this echo
whoops free stuff here
echo DB cat I believe I have a DB count
in here no matter so count players I
want to see what the count is let's see
refresh zero Ted one okay so I guess
I'll just base it on count of players
and I'll say if
count players is greater than zero then
we're going to log them in else echo
this player does not exist so let's try
that
this player does not exist Ted and that
would log us in and we're going to
create a session using our session class
to carry over our logged in user so
let's take a look let's close DB first
so we don't get all confused close game
and I'll close play as well let's see
what we did in the session class we have
a construct register get show
well I suppose what I'll do is I'll just
store the session guy in there and I
will do a new session class and say
slash equals new session now you could
use a regular session here I might
suggest doing that because yeah you know
but we already made the class so we can
expand on so let's do a public function
add name value
and then we'll do session name equals
value okay and this gap function here I
want this to be the generic returning of
the session value so I'll do public
function get name and we will do return
session name I'm going to close this
output box kind of annoying me okay and
since we have a conflict here with the
get I'm going to rename this to get
registered okay and let's see that is in
the game object so open game once again
and oops that's in the end of the play
file sorry where do we do that register
here it is get we want to get registered
there so now there shouldn't be a
conflict there and what we are doing
right now is refactoring while we code
little by little just so you know that's
kind of what we're doing here okay so
session equals new session and let's do
um session add and we're going to give a
name for the user I guess I'll just call
it name and this will be players
of zero name I believe session ad name
players okay and I'll also do I get I'll
do session get name echo so we make sure
we know we have it so let's see Ted
oops we forgot to include session
include libs session ok refresh include
libs session dot PHP did I type sessions
ok
refresh chef session started and we have
Ted there cool so I can get rid of this
and I'm going to do a header and do
header location to play play that PHP
and also do an exit just so that nothing
else tries to execute in case something
got bonkers so session add and I'll also
add one called
logged
I'll just call it logged and I'll set
that to true whoops
sure
all right and let's see test that out
Ted and it brings us to the play page
and on the Play page we're going to
check these sessions so we have this
session included up here we start the
session here and let's say if sesh get
logged remember we created the logged in
part here and we want to make sure
that's true equals true
well let's do false so we only have to
make one line so if they're not logged
in will do header location index.php and
exit all right
refresh good and what I'm going to do is
open up my temporary files so mine's an
F Drive lamp and TMP and these are the
sessions I'm just going to delete all of
these and this page I'll hit refresh and
it takes us to index so if we're not
logged in play dot PHP it keeps bringing
us back here however if we are logged in
we submit and we're allowed to go here
and additionally you could run into the
problem where if you're on the play and
for some reason you want to index it
doesn't take you in here we want to
check to make sure they're logged in so
on the index page I can go ahead and put
this session instantiation at the top
I'm just going to put these at the top a
matter of fact like this
so I'll do session get logged and I'll
say if session get logged equals true
we'll do a header location play dot I
keep talking player play dot php' and
exit so it's kind of like a back and
forth thing we got going on here one
thing that might be a problem is if we
try to get logged and there's nothing
there
so back in session I will say get so if
is set session name then we will return
the session name you don't have to do an
else here because when you return
something it will end the function but
we'll just do else anyways return false
that way we shouldn't run into conflicts
so on the index page refresh and it
takes us to play now if we are logged in
we can't go back to the index page ok
and now we have a decent way of logging
in if I go back to the play page which
we can work on a little bit ok so make
sure they're logged in the game play and
we don't need to create the player Ted
we would import him from the data
and I'm going to get rid of the boss for
now and I'm going to get rid of some of
this stuff and this alright so do we
have DB included yep we have our DB file
here and I could copy all this to
recapture our data because I don't want
to post the actual data of the player in
a session and it's a bad place to put it
cut this okay so this time what we're
going to do is select the user of the
existing session and the name is equal
to session get name and the name is Ted
so let's make sure this works I'll
comment this out I'll do print R of
layers
refresh okay cool that gives us the
little guy there one thing you do
obviously recognize is that we're
repeating data here so I'm going to make
a file in the source files and call this
config and inside of config I'm going to
include session and DB because these are
just basic objects we'll be reusing all
the time and I'm also going to
initialize inside of here or not the
game the DB XR that will go and the
database here okay so connection session
config that looks good make this more
readable however you think looks good
start the session object to connection
and then we'll have a reusable DB object
variable
okay and that looks good now we just
have to include our config.php file so
I'll do include config that PHP I'll
copy that
and all this stuff here we can get rid
of this junk and that should be the
first item and we can get rid of these
things so to make sure it's working let
me delete my sessions for refresh player
doesn't exist and Ted submit game
started all right cool
well this videos gotten kind of long and
we've got some things out of the way
it's a little no nothing too fantastic
at the moment what we are going to do is
make a proxy pattern which a guy slyer
suggested I thought that was a very good
idea and we're almost doing one but
we'll do that in the next tutorial when
we create a player and a bot alright
thanks for watching guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>