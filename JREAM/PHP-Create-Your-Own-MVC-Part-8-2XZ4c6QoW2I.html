<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP: Create Your Own MVC (Part 8) | Coder Coacher - Coaching Coders</title><meta content="PHP: Create Your Own MVC (Part 8) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JREAM/">JREAM</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP: Create Your Own MVC (Part 8)</b></h2><h5 class="post__date">2012-05-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2XZ4c6QoW2I" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey what's up youtubers welcome to part
eight of the model-view-controller
series and if you need to catch up you
can download this copy MVC tutorial part
7 to leave off right where I'm leaving
off and the URL is right there so I'll
close that dial we're relaxed last left
off was the forum posting and let me
give you a breakdown of how this happens
and how we can improve on handling forms
and posting data because that's a lot of
what we're going to do in any
application so I'll open up my forum
library and I'm just going to make a
comment block so let's do a couple of
steps the first step is we have someone
fill out a form okay and I'm going to
have that over just so that we can tell
we're going into it when someone fills
out a form with on post to PHP then we
usually want to sanitize and validate
data and then we want to return the data
and oftentimes we want to write to
database okay so there's a break down
now if we do this without a form class
it's kind of a little bit of work to
sanitize and validate over and over
again so what we want to do is automate
this as much as possible and make it
usable so we left off with our post
function and basically what this does so
far it sets the internal private array
of post data whatever the post field is
right here so what we're going to do is
open up our test folder well I'm not
sure if you'll have one or not
if you don't have a test folder I'll
just go ahead and delete this make a
test folder and I'll just create a new
PHP file and I'll call this form and the
first thing we have to do is require the
form library so require libs form that
PHP okay
and I'll say warm equals new form and to
make sure it's there I'm just going to
do a print R or form well we'll know
ther if it if it doesn't throw an error
so I'll go to MVC slash test form PHP
and require lips form I have to do a dot
dot slash here sorry
and there we have it um so what we're
going to do is Val let's put a comma
here this is to validate and for post
this is to run post on okay so in my
form here's how I want it to happen I
want to be able to instantiate a new
form like so and I want to say form post
let's pretend a field name is name and I
want to say let me tab this one over
post age post gender basically I want to
chain them and in order to chain up my
commands I have to return this
so in heroes they return this and
returning this returns to the forum
object and we'll place that down in
valve save save so what I'm going to do
is I'm going to wrap these guys up in a
request so I'll say if is set request
run and we'll only run it if it's wrong
and now we can create a form so it's a
form method equals post action equals
run and I'll say input type equals text
name equals name and name will line up
with name there we got to create one for
age and gender gender is usually male or
female so I suppose I could say select
name equals gender I'll say option
male and female and okay I'll just put a
value on these guys too for EM okay so
I'm going to try this out
so I'll refresh the page looks like I
forgot my submit button okay and I guess
I'll say name age gender okay not
worried about how pretty it looks at all
so I'll hit submit and there it is okay
so you can see that inside this private
array the post data form I have an array
and what we want since this is private
is a method to fetch it and I'm actually
just going to call that fetch they'll
say public function fetch and I'll say
return this post data this is basically
a getter and a setter now you could call
this get if you'd like however if you
want to use this using the get variable
in the future for some reason you might
want to change that but it might not
matter because usually forms don't pass
get variables usually you just post it
off that's my case anyways so I'll just
call this fetch and we're going to
return this post data and that is not a
function
and what I'm also going to do is put in
an argument so I'll say um the field
name so I'll say if field name overturn
that so the field names sat I want to
return the field name and I'm going to
set this to false so if they pass in a
field name they're going to return that
and and is set well how about this let's
just keep it simple
and this guy will say fetch return the
posted data and he's a while he's mixed
and we're returning a stringer in a
right okay so yeah well I guess since
we're here I might as well make it work
nicely
so if field name we want to check if it
is set because it's going to have an
error if it's not set so let's say if is
set that guy will return them else
return false okay so let's try that out
instead of printing our of the form we
can say form fetch all and form fetch
age so I'll do a equals that and B
equals that I'll say print R of 8 and
echo B so a should give us all and B
should just give us age I'll go ahead
and refresh continue and here it is all
of them let's fill these out test 23
submit and here's 23 on the outside of
the array and here's the entire array so
that did work good okay so we have a
fetch we also want to be able to chain
on the Val like so and validate things
in the field and if something doesn't
pass validation will handle errors so
first we have to create our validation
there's many ways you could go about
this they say you shouldn't APSA late
what varies so I'll create a new folder
called form the reason I do this is
because inside this form class I want it
to be evident that I'm having a subclass
to it so I'll create a new PHP file I'll
call it Val
you could call it whatever you like but
I'm just keeping mine short and sweet so
I'll say oops class Val public function
and strut I guess that's just a habit
and inside of here we're going to make
rules so let's think about how we're
going to do this first if I go to my
forum class let me move this guy over
okay so here's my Val class when I call
Val I want to pass in a type of
validation so type of validator okay and
what I'm doing is I'm going to use the
currently posted field so I need to keep
record of what I have currently as you
can see we returned the current object
but what's the current item in the post
queue and I guess that's always saying
so let me just fire this up bar or a
post data it just bugs me if I don't
have this even if I'm not going to write
something about it right now stores the
post and data okay so we'll create
another guy here and we'll say private
current item equals null and this will
be can't type today
current item the immediately posted item
like that might have my comments have a
capital letter here so you can kind of
tell that it's different from the
variable the constructor that's not very
helpful it just feels wrong if some of
these have comments and others don't /
am strain field the HTML field name to
post i don't normally write my code this
way like its kind of obvious and sloppy
in some ways because i want it to be
very easy to understand what we're doing
okay
so now that we set our current item here
we are going to say this current item
equals field and this is just going to
store the field so if we're posting name
it's going to say the current item is
name in a form you can't have duplicates
of one item so you can't have two things
with the name of gender or two with the
name of name it just doesn't work so we
have our current item and to fat or
sorry to Val we're going to say new Val
and I will say Val and then the type of
validator
and I believe we have to put these in
little squigglies and typo validator
okay and the post item okay so the first
thing is we don't want to keep
instantiating Val so to save this time
I'm just going to put this in the
constructor whenever the forum is
instantiated we'll just have it
available let's do this
Val and we should throw a private up
here Val
okay and that just means we have one
copy going so so I'll go back down to
Val and what we need to do is get this
current item this current item okay and
we are going to grab remember this might
be something like name and I want to
grab the pulse data of it so this field
name so instead of this I'll put in a
current item inside a field name like
this and I'm going to actually take this
guy and now put them into here so this
is passing in the value of the field
we're posting it might look a little
little intimidating I know so when we
call this from the outside this might be
a little tricky to visualize I believe I
can split these windows let's see
configure Windows I don't think I'll
mess with that actually well I could
just drag it now and I believe there
it's going to be hard to see so let's
open form here and go down to validator
so post name we would call Val right
here the type of validator let's say
length I was putting this word length
and what this is actually going to call
is Val length like this and it's going
to pass in the field name of name so
it's going to pass in name but it's
actually going to pass in the value so
from the HTML field if you typed in
Jesse or dog let's say dog it's actually
going to pass in dog right
so what we also want to do is be able to
specify a minimum length and maximum
length so I'll say how about one called
min length so that would call min length
it would automatically pass in dog
because we have this guy here and I also
want some arguments I'll just put in one
here called R and right past here I'll
say argh
and so I have to say min length is two
okay so we have all that kind of
behaving so I'll delete this and we need
a function called min length so public
function min length and remember we're
passing in the data and the arg4
arguments and this is just a simple
little thing so I'll say if string
length of data is less than our return
you have how about this your string can
only be
that okay so that'll be an error and
I'll assign an error to this well how
should I do that it's returning an error
we could do a throw an exception but do
I want to have to wrap this in every
exception if I use that outside of the
form class I don't so I'll call this
result and I'll say if result basically
if it returns something it means there's
an error otherwise it's not just gonna
do anything and we're going to store
this in an error object I'm going to
move this back up to the top so all the
way back at the top I'll just duplicate
this guy and this will be an internal
error array and I think NetBeans just
froze up for a second okay say error and
boom cool so I'll go back down to here
and this error and we're going to store
the errors just like we would the post
values what I mean is how there's a post
data and only one field name so I'll say
this error and I want the current item
this current item I believe this current
item equals result I suppose I could
call this error but I guess we will
because it just seems like it makes a
little more sense okay
so if there's an error it's going to
store in the error object so if we go to
our validate class we'll to make one
more just kind of duplicate this and
we'll call it max length if it's greater
than argument it's kind of the same
thing
we could do one and call it int the
juror I don't know if that's going to
allow us to do that and we don't need an
argument for this one so C type alpha
wait no alpha numeric digit it's C type
digit of data because that will parse a
string he told us that there's only
digits in the string your string must be
a digit okay so we have integer and what
I'm going to do right now so you don't
get thrown off I'm just going to open
this and refresh the page to see if
integer has a problem with the name
class eval not found where there there's
a problem so let's go to index and you
see we're Auto loading the libs in the
class we have a folder here and this
might call for an auto loader at some
point I'm just going to manually do it
for now and I'll go to libs dot form
slash val dot PHP and let's make sure
that works class fell not found
oops I better require that before the
form is called
see if that works nope libs form Val PHP
I wonder what libs is live slash that's
interesting so since the forum is always
going to require it we could require in
devout the form class I don't usually do
this because it has do with directories
now you shouldn't really require files
on construct I don't think so I'll say I
just got a require form slash val dot
PHP and refresh undefined variable val
form line 79 so let's go down to 79 and
right here val this has to be this val
okay because remember we instantiate
this val all the way up here
this val so refresh missing argument two
for Val min length okay so what we have
to do is we're going to have some
differences with the argument we pass in
for the validator so this guy he can be
false
secondly in this big scary looking thing
I got to put dollar Arg
okay I guess one thing to note is we
actually don't want to do this fall so I
want to do this null because false could
be an actual argument and I think I'm
going to call my methods differently so
I'll say if R equals null
else error equals this valve type of
validator post data and only this guy
will have argh it's probably a better
way to do it but again this is not the
all-in-all walkthrough it's just to give
you some ideas to outline your own
framework so I guess I could a lot of
people suggest not doing this but it's
up to you if you don't like your
brackets a certain way okay so now we
have this going on
let's try passing in an actual argument
so in the form test page min length of
two if I put a min length of one I'm
going to get rid of these guys I'm going
to print our of the form remember has an
error array so I'll refresh and let's
see little hard to read post data so
there are no errors looks like it didn't
succeed so check me out we are going to
I'm going to echo out the error see if
that's working refresh submit okay so
your string can only be one long that is
correct so the error is getting passed
through so this error
do I have error set this error it's
right there okay and right after this
I'm going to try print R of this error
refresh and here's the array so this
error oh there goes he's in there cool
so back to our form I'll also say age
must be a whoops Val digit okay so I'll
go ahead and fill out this again I'll
say name is two and ages Dean
so undefined method Val digit what I do
wrong there I call the integer I'll call
it digit instead refresh and name age
and let's try that again
DD submit hmm DD submit it's almost like
the the validators is being a little
stubborn so print are of this air
I'm also hoping I'd go out a Freitag so
I can actually see the array refresh
okay so submit your strength can only be
one long submit so name is or extremist
be a digit a it should be adding both of
these errors that's what's interesting a
name so name passes I remember what I
did in the past I actually do a submit
method so that when the forms done we
submit it to collect all the errors so
let's do a public function submit and
I'll say if empty this error else oops
so if there's no errors we'll just
return true else throw new exception and
in this exception I guess I'll just
throw out the errors this air that's
going to look bad because it's an array
so refresh your string can only be one
long name age I'm going to pause the
video and try to figure out what I did
wrong a second okay some debugging time
I will go to the post and I'll say echo
this current item I know what item we're
on so post on name and then to the end
it it shouldn't end it name name age
okay so that name and then that age but
for some reason wonder what it's doing
their entire form I'm going to I'll
leave him there so within the form we
are doing the right thing which is
strange when there's an error the
current item seems not to be being set
so I'm going to echo this current item
I'm going to go some dashes above it so
I can see it
refresh so name age okay then this one
should be turning to age this current
item equals error that's why it's
sometimes nice to have someone sitting
behind you because they'll point out
something obvious I'm still a little
perplexed about this also what we can do
inside the valve test I'll do a public
function call and it looks good and if
we call a method that doesn't exist I'm
going to throw new exception and I'll
say name does not exist inside of class
and so we can try to run a validator
let's say Val fish oops and we should
get an exception cool fish does not
exist inside a bow so generally you
might want to say try
catch and if the validator has a problem
we will do something so refresh and then
fish that's not exist inside of Val that
way our whole script won't die so delete
fish are back to form echo disk current
item this error if empty this error so
we're going to run our submit so form
submit and since this is throwing an
exception if there's an error it will go
down to this guy and otherwise form pass
and we can print our form a little
better do data equals form fetch and
I'll say print are of data
okay so if the forum throws an exception
none of this stuff will happen cool
let's try it
submit and run parameter for exception
106 throw new except it's an array
that's why shoot I guess I could just
explode it I'll say explode of or that
would be employed when it implode of
comma space and this air I'll just say e
so I'll just turn this array into a
string so try again refresh enter and
gender your name can only be one long
oops that's not right your string can
only do one long one thing is when I'm
imploding it I don't get the key values
so I think I'm going to do a 42 or Oh
what for each this error as key value
and I'll build up a string here
string dot equals key dot value dot /n
for a new line will throw string so
let's see how that works
submit name your string can only be one
lawn
okay so I'm going to get rid of the
little comments I got chillin up here so
we know the current item is getting set
that's checked off when I print R of
this error I'm curious why I keep this
current item I had that typed right
the current item is only set when we
callin in post so I do post these are
little bullets so I can see what I'm
doing so sometimes I type all ones
refresh name age gender your name can
only be one long maybe it's just not I'm
going to echo out the error so there's
some ones here and refresh your string
can only be one long I wonder how come
we're getting that error
maybe our validator is broken I didn't
even think of that so age oh yeah age
isn't even checking a line so hmm so let
me try 2 min length on H Val min length
of 2 refresh ok so name and age that is
correct
something's wrong with my digit valve of
digit so digit data if C type digit data
equals true it has equal false oh that
is so embarrassing all all that wasted
time ok so that looks good so I'll try
again and I'll say name is a no but
two letters your string must be a digit
cool string must be a digit and what was
named in length up name was one okay let
me put that into some name age sweet
okay so what I'll do is I'll clean up
some of the garbage inside of the form
class get rid of that and did I have
this guy here okay so let's try again to
submit and then it will be too long age
your string must be a digit now if you
don't want to use an exception I
strongly recommend you do you don't have
to but breaking this guy apart into an
array would be a lot easier with a
custom exception class where you can
throw your own array exception oh that
doesn't sound too foreign on type of
validator
okay and submit we should say annals the
foreman throws an exception upon an
error it returns boolean that's true it
throws an exception that's true
so that's it so what you could do is
work on a couple of validators and make
your life easier this isn't a rock-solid
thing so for example what I would do is
what we're doing here it looks kind of
sloppy
you could always improve on this there's
a lot to a lot of possibilities to do in
here so if we get past the form
validation let's finally get there the
form passes so I'll say test 20 2 3 4
the form passed and now we have this
data so with this data we could
conveniently enter that into a database
just out of curiosity let me see where
we have with our insert statement so we
have a nice little insert there so what
I could say is well where is it the
testing so I could say
we create a new database instance say
libs database and I believe we connected
to this through our stuff up here the
reason I'm doing it in this page is
because I don't want to create a view of
controller a model but maybe I should
show you how to implement that later on
it's pretty much the same thing we've
been doing in the MVC so we got a
database let's go to our models
no is it indexed I don't recall where we
instantiate it maybe it was right in
here okay cool so I'll copy the database
constructor there paste them here and
since these are using constants I'll
just require the config file all this
file here is just a test so I will
require config dot PHP and I'll say DB
insert those two that get that guy DB
usually I get a pop-up there we don't
database there we go insert into table
and data so let me open a high D SQL one
moment and this video we'll wrap up
shortly and we have MVC data so we have
a data thing to insert into ID and text
I'll just make a new table create new
table and where we're posting here name
age gender call this person call this
name age gender this guy's of our that's
an INT
that's of our one most people aren't
over 999 their night never a negative
age I'll just call this one person ID
and he'll be an integer we've already
created databases I'm just whipping one
up real quick just a table
okay make him the primary boom and name
age gender okay
so inside the person table person we're
going to insert the data which is from
the form fetch and let's see if we can
get that to work so I'll say Jesse
twenty-four mail and open up PI D SQL
and where is the data and there's a guy
there
I should set person ID to auto increment
also okay so we got Jesse how about Joe
22 boom Kenny
submit so you'd get a database error if
you put in four digits because remember
I made the database field of age only
step three so in your form validator
you'd want to cap off the maximum length
in that scenario so let's look at the
data refresh and I got all those people
so there's a start to a nice little form
class and this video is getting way too
long that's a lot for watching guys bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>