<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Learn Node By Example - Part 11 - Preparing User Creating with BCrypt and Validator | Coder Coacher - Coaching Coders</title><meta content="Learn Node By Example - Part 11 - Preparing User Creating with BCrypt and Validator - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JREAM/">JREAM</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Learn Node By Example - Part 11 - Preparing User Creating with BCrypt and Validator</b></h2><h5 class="post__date">2017-02-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/PWP9pGl0YM8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright so this video we're going to
install bcrypt jf there is also the
library bcrypt which is a little more
popular but it uses I forgot the name of
it anyways I had some problems with the
version compatibility no chip so I'm
just going to use a bcrypt jf so we'll
say let me clear this npm install the
crit crit je s dash save ok and there's
also another one called validator it's
pretty good all lowercase and look at
almost 80 k downloads in a day that's
crazy ok see it will check emails it
check you keys on the client side to
which is pretty cool it has so much
stuff to check it's really neat so we'll
also want to install the validator so
I'll say elevator if I could spell any
more that'd be ideal losing my spelling
skills so with those installs what we
want to do is just close out these guys
and go to users jas I'll just reload
mine and I'm going to pop up use strict
at the top in fact I want that
everywhere let me just make sure that
doesn't break something ok
okay i had mentioned that in the super
long video okay okay and models okay you
just pop that in makes you feel kind of
cool too and the app has used trick ok
so here what we're going to do is VAR
validator equals require validator ok
and VAR b crypt equals require and i'm
just going to copy this because hard to
say bcrypt j/s ok so I'm going to NPM
start see if there's any problems with
those included ok and I have to check
the bcrypt j/s because i was using
decrypt and not knowing if it was fully
work and I did get errors but let me
just to be crypt here it's compact a
comparative comparable to the other one
so i just want to see if it has ok as a
hash thing to hash your password ok
okay we're passing on the salt so it
will have a different salt for each user
you know there's some talk about rainbow
tables and stuff and there are some
clever ways around it but for now
something I'm not really going to worry
about it not going to worry about ok so
there's bcrypt and then throw the salt
and then hash think ok I'm going to go
down to the register here our hash will
be whatever the heck this is just make
sure I have that right store the hash ok
that's just a weird looking password so
password and salt so the hash is what
we're going to say for the password and
um we're going to use our validator too
now we need to use our model so we see
what I did previously with the old
decrypt
alright so we'll save our user equals
new user email will be email password
will be hash okay and that just creates
the instance and we want to save it so
we'll say user dot save function and
then see if there's an error and if
error we'll just do response top three
let's redirect register and i'll put a
to do flash message okay there's no
error will do request that redirect to
register pending and i had mentioned
this before that we might have to put
user here but I also kind of want to
change user to like a count or something
so I'll just go ahead and say console
dot log these are saved okay so i'm just
going to attempt to run that make sure
nothing broke okay so user safe now what
we want to also try it's a validator
which it seemed I had a bug with
validator that is email email I'm just
going to try that and just run it ok no
problems yet so I'll say if it is false
then we'll say the same thing here
obviously it'll be a different message
so let's try that alright that works
good and then for the login of the user
let's go back up login
ok so I'm going to just say our email
equals requests per am female and then
password and then VAR find x equals
email email and the password i'm just
going to put some dots there for now and
we'll say user dot find one find x and
will return the ID in the email i guess
and function air and user so i have to
go down just to see how to decrypt load
hash from your password DB oh this is
synchronous I kind of wanted to do
asynchronous
okay so compare think of this to the
hash and where the password was I was
just saying bar hash equals bcrypt
compare sink of password I shoot I
didn't think this out I need to hash
from the database
I guess I have to get the hash first all
right let's kind of a bummer I find my
email ID email I guess I'll have to
compare the hash down here I don't
really like that so since this is
shorter I can just get rid of this and
put it there okay so and I want the
password um er are I'll say fail will be
if error request that redirect login and
to do flash message and here will say if
user dot deleted at redirect to just the
home page and we'll have this because
they can reactivate but when they log
and it's not going to reactivate them I
want to see you too confusing so we have
the password and then the password they
typed and then the user dot password
which is the hash which could be renamed
they renamed password to hash that way
we could say user dot ashen and compare
the password ok and then console dot log
user just to see everything we get and
I'm just going to say sesh send dot
request that session logged in equals 1
I remember our middleware when we made
that that's what we want to match up
with right here but will probably change
it up at some point before I want us to
do flash message like a welcome request
that redirect to dashboard now what
we'll try to do let me just check the
registration we have no limitations on
them is up we have no limitations on the
email right now so i will try this
hopefully it works ok so back here I
want to register my email will be Donell
Jessia Jesse com simple little password
and it redirected us to users register
and it said not found so
why'd I say not found so when I register
we post those who / register I wonder if
it doesn't know to do it's kind of hard
without the flash messages
okay I guess we'll go refresh user /
register huh register so here's a little
cheap dirty way to do it is happening at
before from a redirect I'm just going to
do a three this is like the most hackish
way to do it too I know it's wrong I
don't even have my form fields name
correctly zero budgets for fun I'll go
ahead and reload this and go back and
register and go back up and wow I didn't
get any console log that's weird so to
our views of users register HPS input
type equals email this just needs a name
equals email name equals password and
copy that and this one is was a password
confirm confirmed yeah right there
password confirm that should be the
issue i believe so go back register
maybe i need to refresh it
Susan mr. Jesse at Jesse com simple
little password all right and a problem
EES lib router is actually harder to
read than the terminal index node
modules learn those by example router
live Express huh fjs 88 I think that's a
include file oh I'm 88 error not found
okay what's not found so we're going to
need our flash messages for sure and I
think that'll be something to do next
because it's hard to tell what's
happening here I suppose the login form
could be done to it's only the name
equals email this will need a name
equals password might as well fill in a
few of these password forgot name email
password reset
password password confirm profile
register register confirm account delete
login okay that looks fine to me alright
so we'll use the flash messages next</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>