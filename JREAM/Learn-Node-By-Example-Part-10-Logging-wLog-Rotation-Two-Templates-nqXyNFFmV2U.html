<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Learn Node By Example - Part 10 - Logging w/Log Rotation &amp; Two Templates | Coder Coacher - Coaching Coders</title><meta content="Learn Node By Example - Part 10 - Logging w/Log Rotation &amp; Two Templates - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JREAM/">JREAM</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Learn Node By Example - Part 10 - Logging w/Log Rotation &amp; Two Templates</b></h2><h5 class="post__date">2017-02-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/nqXyNFFmV2U" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright in this video we'll try to keep
it pretty simple we're going to install
a form logger which will log like server
errors access log stuff so we'll say NPM
install I mean we can already do that
but what we want to install is called a
rotating file stream - - safe I'm gonna
copy this okay so we're going to install
that and then our app J s I'm just gonna
paste off here and just looking we we
installed Express session in the
previous video okay we'll just do that
for this video to keep it short I'll go
ahead and look at my previous code I
wrote and what we have is VAR f S stands
for file system and just require FS
that's built into nodejs it used to not
VAR RFS just shorthand for the guy here
cut that well we know mongos is for
require and
and we'll go ahead and go down to the
logging so first we have to pick a log
directory and we'll say path dot join
underscore underscore dur name the
current one and we'll just say logs
since that's that's already in the get
ignore so it'll never be pushed to get
which is good because your logs can get
really big
now the reason to rotate logs is because
you don't want to have to end up writing
to a 10 gigabyte file if your
application was running forever you'd
want to like maybe I have a cron tab
that deletes logs every so often or
something like that so first we're gonna
check file system dot exists sync it
auto-completed for me and we'll say log
directory or file system make their
synchronous and we're gonna we don't
worry about the mode here log directory
and then we're gonna do our access log
stream so VAR access log stream equals
RF s which we put at the top RF s is for
a rotating file stream and we'll just
say access stop log and we'll pass in an
interval of you just say one day or two
days I'll put two days about three days
but that looks like three D so I'll put
two days path will be log directory and
then we just need to tie it into the app
so app dot use logger and remember this
is Morgan so Morgan's the logger so
we're using the file system to create a
folder actually this shouldn't be here
right now okay
and then we're creating a stream so that
it will create new access logs every two
days instead of a big convoluted one and
we'll say combined and we'll say stream
is access log stream okay
so that should be good for logging if we
just do NP woops NPM start it creates a
log folder with an access log and it's
empty that's okay but at least we got it
started the other thing I want to do was
in the views users we didn't make files
for the account delete and account
whatever so I will just copy the
register file make a new file and I'm
gonna save this as account delete dot
HBS and here I'll say h2 are you sure
you want to delete okay and our form
will look a little different probably
but we're gonna say users slash delete
and we're going to have a input type
equals hidden name equals confirm value
equals one why because in the previous
video if you don't recall I'll go to the
bottom the parameter confirm has to go
through otherwise right now it's going
to not do anything
what to do if confirm not checked it's
hidden so it's always checked that's
just a note for me okay and then we're
gonna have a radio so we're gonna say
div class equals radio we'll close the
div and input type equals radio name
equals soft delete value equals one
checked equals check that's to encourage
people from just wanting to maybe add a
label around here from people maybe
wanting to temporary delete yes
temporarily delete how about we could
yeah we'll just call a temporary delete
deactivate maybe and so we have one
radio button and we need another one
this soft delete will be zero and it
will delete them harshly take off the
checked here and this will be yes
permanently delete
and we'll have a form group
this will just be I can get rid of this
crap we have a submit button down here
there we go alright and instead of why
is that a button alright whatever this
says register this says delete this will
say go back
aah ref equals I don't know dashboard
because this is for logged in users
which I should actually take note of in
the users JS file so rotor dot get
that will require delete will require a
user session and posting delete will to
reactivate does not
okay so button default I want to make
this a button warning and this will be
success to encourage them not to delete
anything and then we just have a
reactivate form so I'll just make a new
guy here and save him as account
reactivate HBS that's if they soft
delete their account and they decided to
come back enter your email to reactivate
your account I'm not worried about all
the typography stuff okay mmm actually
let me just check something in users dot
J s we have reactivate okay and then
there's one with a code good
okay so reactivate and just gonna double
check once more all we're getting is an
email okay so we don't need this hidden
value and nor the radio classes so I'm
go ahead and get rid of these it looks
like we double up on a form group let me
just check the account delete there so
I'll just open up register and here's a
form group of well let's grab this guy
and we'll just paste in an email here
I guess we do want a input type equals
hidden value equals one name equals
confirmed just so that they're posted on
this form and we're gonna do CSRF two so
users j s so if they post confirm or do
we do it
very good all right so when they post to
reactivate this obviously has to be set
okay if it's not then it's not gonna do
anything because then they're just
tampering with stuff
somebody is okay and Tad this over and
so reactivate will be
reactivate account and this will be a
button success
I type is email we need name equals
email to will worry about all that stuff
later at a later point and just make
sure our stuff can still run npm start
and refresh should be able go to user
reactivate users it's plural okay
yeah it looks ugly we're not worried
about that right now and then user
delete isn't locked down yet but uh wow
that looks terrible so i got a quick
little HTML error
delete where is it yes temporarily is
permanently delete button button oh this
needs to be an anchor okay they're kind
of reload this HTML are now oh cool so
there's delete go back look at that
delete what a wussy is that warning
let's do danger and button excel i think
is to make it extra large no button LG
there we go
I like big buttons and I cannot lie I
think those buttons should be swapped
around
and they should say now go back okay and
that'll be it for this video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>