<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP OOP Game Framework (Part 2) | Coder Coacher - Coaching Coders</title><meta content="PHP OOP Game Framework (Part 2) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JREAM/">JREAM</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP OOP Game Framework (Part 2)</b></h2><h5 class="post__date">2011-01-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/EtoEaPMuMZs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys welcome to part 2 of our game
framework and what we're gonna do is
make a way for the player to attack the
bot or vice versa and when we think
about this there's two ways off the top
of my head we could do it we could say
game battle and what we could do is put
in the player that's attacking and the
player that's defending okay so that's
one way to do it or we could do it like
this game player Ted and we could do
battle of and then the person's let's
say the bot okay and when you look at
this a battle happens only between two
people so I don't think the battle
should be placed in the game area I
think it should be placed in the
character area and my thinking is kind
of this game mainly revolves around
players and BOTS and the more you
develop it you might refactor it move
things around but you know this isn't
the perfect design decision and we have
to start somewhere so we can always
correct our mistakes later so I'm gonna
go it this way there's a battle method
inside of the player so what I'm gonna
do is comment this out save
and let me open my window where my
little game is okay and we have this
that you're familiar with I'm going to
go ahead and erase this bot thing here
and let's open our abstract character
and what we're going to do is create a
battle method so public function battles
and inside of here we're going to accept
an object of either the player or the
bot and so we can't cast it to player or
cast it to bot because it could be
either or so I'm just going to say the
defender so the character that calls
this method is going to be the attacker
and the defender is going to be the
person who is getting attacked and what
I'll do is typecast the defender object
to object defender
and I'm going to just echo out defender
just so we can make sure everything's in
place
so I'll uncomment this so the player ted
is going to battle the bot boss and
refresh and it gives us the output
remember the two string parameter in the
abstract class of the bot boss so that's
working now we can actually do something
with this this is maybe where you want
to create a formula and I'm not going to
get into creating a formula what I'm
gonna do is just create a way to
subtract the damage from the HP so the
first thing we need to do is find a way
to get the HP of the character now we
have set HP set damage show the overall
thing but we don't have a way to get it
so we're gonna create some getters just
like those and I'm gonna put show at the
bottom right above to stern because that
one's not as important of a function so
I'll do public function get dmg and I
will return this dmg and remember these
are protected so we have to have a
getter and I will also do a get HP
public function get HP
return this HP and to make sure that
works will do defender get HP defender
get dmg let's echo these out make sure
everything looks good so five hundred
and one hundred that looks good okay so
we need to subtract the date the damage
from the HP and I'll echo this out echo
defender is at
we're gonna have to change the HP so
defender set HP and HP is going to be HP
- damage so I'll call this HP and this
dmg and also tracked it here set HP will
be HP - dmg and I'm skipping a lot of
stuff because this will take forever to
make a tutorial to explain and make sure
you know this doesn't go into negative
and all that stuff and so we battle we
get the object we get the HP and the
damage will calculate the new HP that
the defender will be at and we will say
defender is at the defender get HP
because this changes the defenders value
now let's see if that works
defender is at 400 okay the problem is
that the damage is coming from the
defender and we want the damage to come
from the player Ted and to do this we
will instead of defender get damaged I
will do this get damage for the player
and this might trip you up so we
probably want to name our variables a
little cleaner or make a note I'll
probably make a note above it so I'll
say first get the defender stats
and then down here now get the attackers
stats and you might want to say notice
this very important to make notes in
your programming guys and you probably
know that by now
so this looks decent so we have a player
attacking him and let's see what happens
if we do that twice defenders at 300
defenders at 100 so that works next I'm
going to create a session class and this
is going to go through several changes
probably but we'll start with this for
now so I'll make a PHP file and call
this session and class session and we'll
start with a public function construct I
like to start things simple so that we
can see what we're doing early on
so we start a session here again and
what I will do is I need to include the
session so this copy this and rename
this to session and I'm going to put a
comment here that says in it and that
just stands for initialize and I'll say
s ESS equals new session and then I'll
put a comment here that says game play
okay and it makes things easier to read
so let's make sure this works session
started games started good and what I
want to do is have a way to keep the
object state meaning you see how i
refresh this and it's always 300 100 i
want it so that when i refresh it that
it'll keep adding on to each other and
I'm not gonna do this with the session
but I'm gonna just build a session for
the heck of it so that we can use it
later and we would probably want to use
a database to remember the character's
state that they're in and we'll we'll
look at that a little bit with
serialization so we have a session get
some basics in here and let's do public
function show and I will do print our
session what we want to look at all our
session variables and I'm also going to
echo a pre in here
and also end the pari okay and this
isn't going to be just the regular
session for right now it's going to be
to register an object into a session
that sounds kind of confusing I know I
know this session could go in the game
object but I'm not going to do that for
now because various reasons I suppose
that are in my head that I can't seem to
explain right now so let's do session
print our and we want to register an
object and to register an object let's a
public function register and we're going
to set a session name equals serialized
of object and we need to pass this end
so name and object
okay serialized I'll cast this to an
object
okay so back in index after I create the
player Ted
I'll go game or sorry session register
Ted and game player Ted and at the
bottom I will I'll put my session and
say session get Ted did I make a get
yeah I have to make a get saw the public
function get name and this will return
the uncie realized copy of the object
session name okay and it'll probably
make sense in a moment session get Ted
and I'm also going to do a session shell
so we can see what we have let's see a
refresh call to undefined function sorry
I misspelled that on serial lies okay
refresh and here's our beautiful
serialized object Ted and this will
preserve the object over you know the
page timing so I want to get this object
back so I should probably do get Ted
and I'll say a equals get Ted and I'll
print R of Ted Ted I better rename this
variable okay print R Ted and refresh
and we have a player object looks good
so this is just a very rough example and
what we want to do is be able to hold
this
you know preserve the object his current
state like if he's missing HP and
transfer into the game as a working
object so I'm going to create an import
function inside the game and up here
let's go - we have a crate and we'll
have a public function import and we're
going to import the name and the object
so let's do it
echo pari I like that because it's
easier to read and let's I guess I'll
just do echo name and echo object make
sure this works
so I'm going to erase this over in index
and we're getting Ted and we want to
import Ted into the game as a object so
there is our session right now you have
to imagine that we're not going to
create the game and then just start
using it like this normally what's going
to happen is there's going to be an
existing player and they're going to get
the serialized object from the database
its current state so it's usually
probably going to only have to be
registered once in a database object and
then we'll always get it and manipulate
that data from there but we're using a
session now because it makes things a
bit easier okay so we'll do game import
and let's say Ted and want to import
this here
okay and make sure this is working okay
so that imports that good it's just
doing the two string method so back in
game name that's a string and we're
going to create an object you see how
this how we have a our player that's an
array that holds the players what we
want to do is make this object available
in this array so I will do let's see
this object and this object is a player
or a bot guy we might actually not have
to do the name now that I think about it
I'll show you this object object and get
name so we'll make a a getter for the
name right here so I'll also do public
function get name return this
name and you might be sitting here
watching thinking man you really are
slow and pause a lot yeah I know
but it's good to think about what you're
doing while you're doing it and federal
ways to do it
you know can't just program like a
machine gotta think things through what
did I just do
Oh get name and then I'll change this
function so that we just can import just
the object and I'll get rid of this here
and the object can be a bot or a player
like I said but just for paranoia
reasons I'll just cast this to an object
just to be safe and the object is the
actual this Ted guy here which is the
game player Ted okay and we can use all
those functions that he has so we'll say
object get name object get HP object get
dmg and what we're going to do is just
recreate this bad boy it's pretty cool
okay so I'll just call this name equals
object HP I'm going to use tabs so this
is easier to read
okay maybe put in a little comment these
are just little stats to build the
object this object okay so we're going
to want to make sure that the object is
the we know what it is so I'll say type
equals get class of object and let me
echo out type refresh and it's a player
so we can use this to create our class
what I mean is we can go new type and if
we did that it would create new player
and so far so good so we're going to
assign this to a variable either the bot
or the player and I could say this I'll
just put X here because I'm not sure
what I'm doing yet this X X X equals
name mm-hmm
equals new name or new type and this
and name you say what on earth are you
doing
remember won't create a guy over here or
doing create player Ted and just like
down here we're creating the player and
Ted and if it's a player remember it
creates the player object and with the
player rules we have to pass in the game
object so we're just following the rules
of the create parameters so this and the
get class and you see the clap the
variables in the game are lowercase so
we'll have our type just leave it as
that
and I'll do a var name equal string to
lower of title because whoops
these are lowercase and I'll probably
improve on this at some point so I'll
say var name actually I'll call this um
player or bot
okay so this player or bot and then its
name for example Ted remember when we
create it down here equals new and then
the type
it's either player or bot and then we
pass in the game variable this whole
thing because it's required and then the
name which would be Ted to create the
object and then we can create set up our
object I'll say this player or I'll just
copy this a couple of times and we're
just recreating the way we normally do
it and we will do set HP and set dmg
I'll say HP and damage okay that looks
okay make sure I don't have any terrible
errors player dead was created pretty
cool so let's get rid of this where we
create Ted source how do i comment this
out i forgot it was a shift see i guess
not I'll just comment this out
so we we have this registered already in
our session okay it's all refresh call -
undefined function battle function
battle non object on line 28 player Ted
we need to import this into the game
object see if this works
refresh player Ted was created good
let's see if we have this available game
player Ted suit whoops
see if we can echo this out and refresh
undefined index Ted so this did not go
through session get Ted object object
tight I'll do echo this player or bot
name and see what we get
let's see it looks like Ted exists the
problem is this is supposed to be
dynamic we're actually setting a
physical variable to that and I messed
up once again let me put the little
squiggly brackets around here
that should do it
there we go and basically what I did was
I was saying this and I was creating a
new thing up here called player or bot
but I wanted player bot to either be
whatever the type was so this will
translate into bot Ted or player Ted
whatever so I can get rid of this and
this video is getting a little long so I
will also register on the bot make sure
that works and I'll just call him boss
and boss okay refresh
hopefully that registers okay there's
the boss player whoops he's a bot Oh
mess that up there we go there's all the
boss's stuff and since he's in the
session now I can delete all this stuff
well I'll come in and out because if we
lose our session we'll lose all that
stuff and I will do import session boss
refresh and you see this is good because
we have this is the database object and
you see you'd only have to fetch a
serialized object and then import it
into your game object and you'll be able
to play with them sorry for the long
tutorial and I hope this was clear I
know this is kind of a confusing thing
we'll probably do the database part next
and we'll probably organize some of
these folders and everything thanks for
watching guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>