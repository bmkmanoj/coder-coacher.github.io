<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>YQL Tutorial &amp; Wrapper | Coder Coacher - Coaching Coders</title><meta content="YQL Tutorial &amp; Wrapper - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JREAM/">JREAM</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>YQL Tutorial &amp; Wrapper</b></h2><h5 class="post__date">2011-10-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ycgGIoAibA8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey what's up youtubers today we're
gonna do a tutorial on YQL and YQL means
Yahoo query language and you can access
a lot of their data using that so to get
started what I would do is go to the YQL
console look it up on google and they
have a a quite a bit of things you can
access so I'm just gonna collapse that
and right here let me collapse this
these are a couple of things that you
can access through YQL and it's a bit of
stuff so what we're gonna do is first
make it useful something that we can
reuse so they provide a good example on
their website and I'm gonna kind of go
off that code but I'm gonna type it out
so that you can see how it works so to
start out we have an endpoint and this
is kind of like a rest representational
state transfer it's I don't know if it's
exactly that or not I think it is by
what we're going to get so let's say the
endpoint will gotta set that and that
would be query dot Yahoo api's comm
slash version 1 / / YQL okay and we're
gonna be using curl I have a couple
tutorials on that that just accesses
other websites and this is the main
place we're gonna be calling to build
our query and what we have to have is a
query okay
and we'll get to that shortly and what
we're gonna do is create a curl handler
so I'll just say CH equals curl in it
and I'll close curl so curl close CH and
in between we're just gonna set one
option they only require one option
which is kind of cool
so curl set out of curl Handler and curl
opt return transfer sure okay and I also
want to get the result so I'll say
result equals curl execute that and then
I can do print our result let me echo a
pre in here so that we'll do blow read
it okay so if I go to my YQL page and
hit refresh there's nothing there it's
because we haven't built our query yet
so to do this what we're gonna do is
just a sample query in here how about
show tables so I'll copy that and paste
this into there and what we have to do
is send it the whole URL it's gonna be
like the endpoint and the query so here
I'll put an end point dot query now the
problem is is right now it's gonna show
up like show tables and in URLs up here
when there's a space usually does % 20
or plus symbol so we're gonna want a URL
encode our query
URL in code so that we don't have any
problems
next we pass a parameter called question
Q so really let me get rid of this it's
gonna end up looking like question Q
equals show plus tables okay not
terribly difficult so right here I'll
say question Q equals query so let me
try that out refresh and I got a lot of
stuff so I know it's working we might
want to put in a safety net let's say if
curl were to fail so I'd say if curl air
whoops
CH and I'll just die and say curl air of
CH just a lousy little safety net
the query okay so we got that what's
cool about this is for a lot of these
you don't even need an API key so one
that might be useful would be weather so
I'll go ahead and say weather and
weather dot forecast and this makes it
ridiculously easy I mean look at this we
can just select this and copy it and in
our query here I will paste it there now
for things that are strings you might
have to quote those we'll do that in a
minute but let me type in my zip three
to seven to five and I'll go ahead and
refresh and what we have is all our data
put out here let me view source okay we
have all this stuff big ol XML file now
I prefer JSON format and to do that we
could just add on a dot I think format
is it format equals jason so refresh
once more and now I had this in Jason
it's just easier to work with in my
opinion so and to work with this I've
gone over this a couple times we'd have
to JSON decode it so if I go down here a
little ways I'll say result equals JSON
decode result
okay refresh and now we have our
standard class object and we'll build to
go through that and I'll actually go
through this with you real quick
so that you know how to do it just in
case so the way to do this is we have
our query and we have all these nested
things what we're doing is kind of
travelling down an object and to do that
let me hit enter to move down what we
can do is let me comment that out so I
could say result and result represents
just this object here okay we're gonna
go to query and query is an STD class
object so I would do another pointer and
I want the results here so I'd go
results which is another STD class
object then I will go to Channel and
inside of channel let's see what we have
we have a title a description and
location and forecast it looks like it
only gave us the date for October 2011
so quickly
I don't know the actual query code to
get more days but you could always stick
that up we'll just work with this for
now so sorry this is hard to read oh
we're on one there I want to get the
forecast so I would go up to looks like
they gave us a HTML code here in the
description that looks like it might be
doable so I could go back up here where
were we
inside of channel here one more level
over and I want to go to item and
pointer and I want to go down to
description okay I'll just echo that out
it looks really long and refresh and I
have this I could get rid of that pre
tag so it's more readable and I'm not
sure in the agreement if you have to
display this or not I'm guessing you
probably do you could make it a lot
smaller and less obvious though one
thing I want to bring up is if you get
let's say weather for a couple of days
I'm not sure on this example but say
item item might actually be an array
okay and if that were the case you would
do a for each that has let's just say a
then you can do echo a description
they'd be an example of looping through
multiple items but it would have to
obviously say array there
so what we're gonna do is a different
query and we're our Yahoo Answers that's
a popular one so get by question oh boy
I don't know the IDS there how about I
get by category I don't know what ID
means good enough so I'll copy all that
and just simply paste it in there
refresh and we have a problem because
this is different now this code here
I'll just say this is for weather and
I'll just died right there so that I
don't see anything else refresh and we
have a beautiful long thing here we'd
have to JSON decode this as well so I
think you already saw how I did that
the way I kind of traverse through this
and JSON decode it so it's not totally
necessary so for fun what we're going to
do is make a little class that we could
reuse and to do that I'm just gonna copy
a lot of this now a wrappers not totally
necessary because this isn't a lot of
code but for fun we'll make one so PHP
class would be YQL and I'll start with a
public function construct
okay and what I don't know what I'm
doing just shadow I just pace it all in
there and I'll go ahead and save this as
YQL dot class not PHP okay and I better
tab this over boom boom okay
so some things that are going to be
fixed number one is the endpoint so we
could actually put the endpoint up here
and this is going to be a private
variable okay and then we'll want to
change the endpoint here to this
endpoint I want to have private query
and I can delete some of this stuff and
this will change to this query and we're
actually going to create a function for
actually running it and I'm gonna call
that submit so I'll say public function
submit and then we're going to pop curls
into the submit area so I'll just grab
all that and paste this in here okay and
what we're kind of doing is making a
friendlier usable class and I'll provide
this to download in the download area of
my site just read the description my boy
so what we want to do is be able to set
the query and to do that I'm just gonna
make a function called query public
function clear
and this is YQL coat and we shall say
this query and remember this is a
private property up here equals URL
encode YQL go so I could actually delete
that and I could delete this and delete
this our construct isn't totally
necessary we could also do a function
for format so public function format and
we could say this format equals format
and make that a private variable up here
and we could get rid of our construct
but sometimes I don't know if I'm ever
gonna use it or not so sometimes I just
leave it there
I suppose in this case I'll just delete
it okay and for the format we're going
to pop it in right here so format equals
dot this format okay
and I don't like slash flash comments
I'll document code this a little bit
does a document code I mean documented
with comments
so after what's happening here is we're
executing but we need a way to get the
results sometimes you could just do a
return here return our result but I
prefer having a dedicated method to get
it so I'll say public function yet
and I will return this result and I
don't want to forget to change this
result okay and it looks okay so far
colonel clothes get and what we're going
to do is a couple of little checks okay
I call them flags so we have to make
sure that end point is set that's always
going to be set because that's concrete
right up here query someone could call
the submit function without calling the
query or the format for example I'll
just go ahead and delete I will say
require YQL dot PHP and I'll say YQL
equals new YQL and I could say YQL
submit and I'll refresh this page failed
to open YQL sorry
I mean YQL class and refresh and we
don't have anything in here new page
source looks like nothing good happened
it queried but didn't return the results
so what we want to do is set a flag so
that if unless they set the query it
won't run so I'll say this flag
we could make this an array may be
private flag equals all right so what
I'll do is an array push this flag and
I'll say query actually you see this
name matches this I could just say
function okay and I'm gonna put that
under here and right here okay
so this is gonna push into an array I'll
show you what it does so print are of
this flag and refresh and it's an array
so if I were to call um YQL query I'll
refresh and oops I'll just put in test
refresh and you see it adds it into an
array so that we know what's been called
and what I'm gonna do is make sure
they're in an array so if in array this
format weird
and I can just duplicate that line and
type in format so I'll just put these
both on the same line here so if we're
in format are not in the array we're
gonna have a problem I think better yet
we should just default the format to say
XML so I'll just go up here and say XML
and I could get rid of that get rid of
that so maybe it's a little overkill for
now but it's good to plan ahead and I
guess I'll just throw new exception and
I'll say you must set I just realized
this has to be flag okay and we're gonna
say you must set the query before
submitting and refresh except for a more
- to be an array Oh
let me flip these around and refresh
okay so we did call query yet we got
nothing if I don't call it just comment
it out we should get an exception good
so what I'm gonna do is just pop in the
code I previously had right here okay
and let me refresh okay so we got
nothing yet we have to get the data so
we'll call get so I'll say YQL get and
I'll assign this a variable called data
equals like you I'll get and I'll print
our data refresh and we have all this
data in XML
by default remember we can change the
format if we want and we could say like
ul format will be JC own refresh and now
it's in Jason but what we want to do is
if if it's Jason I want it to be there
so that we can edit it and what we're
gonna do is automatically do that with
our get so what I'll do is a switch of
this format
I'll say case xml and break in case of
json break and this will determine a
different return value so for jason
we're going to do JC on the cody on
decode is a json okay so let me refresh
that oops
misspelled jason decode and now we have
our STD class object so that we can
traverse through it like I showed you
kind of in the beginning now for XML we
want to do a simple XML element so let
me go back and change us to XML make
sure okay and you can't see the XML tags
unless you view the page source so the
format you want to get that's really
going to be up to you and we can do this
easily with simple XML load strength and
I shall refresh my boy and now we have a
simple XML object that we can traverse
through as well
now this could maybe have some
improvements and everything I know it's
not perfect but it's a good start for
something reusable and you could
obviously name things how you want them
so this will be available at dream comm
slash lab slash open - source if you
would like to use that and play around
with it play around with some queries
and you could get some data mash it up
and have some fun
thanks a lot for watching guys and if
you have questions you could always sign
up if dream.com slash forum and ask all
the questions you'd like
alright guys popular</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>