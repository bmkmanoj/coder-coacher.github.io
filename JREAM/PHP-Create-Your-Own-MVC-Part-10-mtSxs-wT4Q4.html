<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP: Create Your Own MVC (Part 10) | Coder Coacher - Coaching Coders</title><meta content="PHP: Create Your Own MVC (Part 10) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JREAM/">JREAM</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP: Create Your Own MVC (Part 10)</b></h2><h5 class="post__date">2012-11-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/mtSxs-wT4Q4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey what's up youtubers this will be MVC
part 10 and I've gotten a lot of
messages about the routes and a bunch of
different stuff so I'll cover some of
that and we'll do some improvements on
the reason for my lack of videos is
because this expensive microphone the
plug for its being kind of funny but uh
I really don't want to get rid of it so
I have it upside down right now anyways
I'm gonna get started where we left off
I know it's been a while the first thing
is you notice that my site was kind of
plain and blank first thing I will check
is the config file when you have a site
like this and if you have a 500 error
that's an Apache error then you know you
have something wrong with probably your
mod rewrite if it's just like this and
it looks like the URLs aren't working or
sorry these Styles aren't working right
you see my URL for it it looks right but
it's not because I'm actually on port 80
to right here most of you would probably
be under something like localhost MVC
but I'm on port 80 to now because I have
Jango and flask installed for Python and
the dotnet framework will chooses some
other port and I just want to avoid a
conflict so what I do is I would make my
absolute URL just include this pore and
that's what I'm going to do for this
here so our URL here will be port 80 -
I'll refresh go to help and it looks
like that read redirected correctly one
thing to note is if you are working in a
subfolder like this oftentimes you need
to monkey with your htaccess and say
rewrite base and then the subfolder it's
in so if this project was at the root of
your website you could just have rewrite
base just be slash and that's where it
starts rewriting from but I want to do
it for MVC
which is the folder we're chillin in
right here and let's see looks like it
works pretty good cool now let's do some
stuff what I'm going to do is look
through the base of this application so
I'll go to my lips folder my bootstrap
and these days actually change my tabs
to spaces the reason is because it's
it'll look good on any system if every
tag was four spaces and you just use
shift tab to untap so in here formatting
looks like I had that on I don't have
much space over here so look how big
these tabs are I haven't been used to
this for a couple months regardless so
our bootstrap is kind of dirty and you
know it's not perfect or anything but it
does work what I would probably do is
clean this up a bit so I guess what I
like to do when I think of out get born
in programming is break things up into
segments so you don't sometimes you want
you don't want to get too granular or
else your class will get confusing but
it's good to make one function have one
purpose in a class so what we're doing
is getting our URL parameters so I'll
just say public function oops this will
be a private function
because it won't be accessed anywhere
except in this class get URL and I'm
actually going to convert all these tabs
to space as soldiers highlight a tab
here control H I might have to use
notepad plus plus to do this quickly so
check me out real quick I'll go to my
MVC folder I'll just open up some
controllers and all this stuff that's a
big font and I'm just going to take all
this crap right then I'm going to find
and replace and with the extend it so
you do backslash t for tab and I'll
replace that for spaces so replacing all
open documents that's a lot of
replacements save close close okay so
now it's four spaces per tab that's how
I like it so we want our code to look
nice and clean so I'll take this chunk
of stuff k and since this is going to be
in a different method I first want to
declare its value within the class wide
settings also a private URL equals no
okay I'll cut this and I'll go down here
and paste it
and now it will be this URL equals the
final result of that URL however you
want to do it is going to be your choice
by the way I prefer camel case I switch
between them at work and a home it
doesn't matter to me however you guys
want to do it's just important to stay
consistent but with your private and
protected methods you should always put
an underscore before it okay so now when
we call the constructor we want to get
the URL so I'll say this get URL I'll
just put a comment here sets the
protected URL and instead of the URLs
here we're actually going to use this
URL so any place you see these before I
go and do all that let me just examine
this code and walk through with you so
we get the URL we're going to check if
the URL is empty or not if it's empty we
load the default controller and we get
out of the rest of the bootstrap
function otherwise if it's not empty
we're going to check if the file exists
then we include it if it does if it
doesn't we're going to throw an error
okay
and we also have a model loader it looks
like we have an automatic model loader
here all this crap I'm not sure how I
feel about that nevertheless let's clean
this up so what do we want to do if the
controller is not set we just want to
load a default controller so this load
default controller if you want to get
really picky the.net framework says
always put your adjectives before your
nouns so like or your action I actually
do it the other way sometimes but if
you're writing a large system it'd be a
good idea like get item get message or
you could flip it the other way and say
message get okay I'm getting off on a
ramp so load default controller we're
going to want to method for this private
function load oops
load default controller okay and this
should also be private the error because
it's only going to be called from the
bootstrap so the error
looks like I'm just going to find and
replace this error with this error okay
so the load default controller that was
this code here now how you want to do
this I mean I could really just put this
here if empty URL but if I want my code
to look really clean I could put this
whole chunk inside the load default
controller the only thing is you got to
figure well what what's the easiest to
read if I read this load default
controller it looks like it's always
going to load it so I think I'm going to
I'm going to make it easy for the user
to read so I'll take this guy and pop
them in here and then I put this down
here okay so this is just where we
require the index file load the index
and call the index okay
so load the default controller if no URL
is set okay I don't like how unclean
this looks but sometimes it comes down
to readability and it's a toss up
sometimes you know I'm doing this on the
spot to to try and get it going the next
thing is this would be this load
existing controller you don't have to
call it that and I will so if file
exists is just looking for all this
stuff
I don't like how we load the model to be
honest but what Evers so private
function load existing controller now
what we're doing here is called a
refactoring and when you refactor
usually what you want to do is change
one little thing at a time and check it
and I haven't been doing that because I
try to keep these videos shorter if
possible because I don't think you guys
want to sit through an hour of me
talking I don't know if I could do it
that long either
okay so if I go to load existing
controller again it requires a file
other words it returns an error and it
looks like we instantiate it also so
I'll cut this out and put this here
okay and it calls the error returns
false I want to return false if there's
an error because I don't want to load
the controller heck I could just say
like require file and throw it in there
okay there's that the next thing is we
have calling methods on the controller
so I'll make a new one called this call
controller method that's if one is
called so I'll copy this guy and that's
going to be this code I believe so I'll
say private function call controller
method and I'll take this stuff here cut
it out and paste it in here I know this
is kind of scary-looking okay and we're
going to know we're going to clean this
up still so hold your horses
so whoops and what you want to do with
all classes is document it there's the
PHP comment now I don't know what this
is going to return it's a boolean right
here otherwise it's going to return like
a string probably a string of HTML
this is yeah this is clean I guess
usually you want to just be like hey
what's this do it fetches the get from
URL usually you might have some
parameters in here but in our case we
don't really need them because this is a
very simple MVC loads if there's no get
parameter passed otherwise we'll load
okay
this returns boolean or probably a
string or something and then call a
controller method okay so I did not
forget that we need to fix our URLs here
so I'm just going to skim through it
what I like in NetBeans is you know you
double-click in it highlights them and
what I'm looking for is something that
might mess up my find/replace so URL 1
I'm just looking for the word URL is
that the only place that we have because
we have to change those into this URL so
where was that here so just I'm going to
do this manually just because I want to
think about while I do it
that seems like it'd be right ok
and I'm going to look for URL whoops I
still got more
who
I could have done a fine replace to save
time but I like to look at these while I
do them so I'll search have those there
which is just whatever I don't need to
change those because I set it here okay
so just make sure okay so now I'll test
it I'm thinking it's going to break
undefined variable controller so let's
see it looks like we need to set a
private controller okay so let's see
where we set the controller variable
I'll say this controller this controller
and here in here and this is so that we
can access the controller and all the
functions again I could do a fine
replace but I like to look at what I'm
doing so looks like I have a couple more
here okay just a couple more boom whoops
what'd I just do want to add it there
there and there okay
so let's refresh and I know it might be
hard to follow along with that because I
went pretty fast
have mercy I'll provide this code for
you
this just
okay so now we have more of what we
would call a class so we construct it
sets the URL for the class if the URL is
empty we're just going to load the
default page so if they went to okay so
if you don't provide a controller in the
URL it'll just load the default one
okay and if it does load that we don't
want anything to happen so we just
return false here otherwise if this is
not empty it means you know we have a
controller set so hop over to the load
existing controller and by the way you
can middle mouse click to just hop to
things and netbeans and our controllers
this URL 0 dot PHP because it does exist
well we assume it does and we check if
it exists we require it we instantiate
it and we load a model that matches it I
suppose we'll just leave this here
because some people might like it and I
don't want to do a bunch of breaking
changes okay so Wow look at this ugly
crap passing methods so let's see what's
happening here I think we can clean this
up a lot so we're seeing if the second
parameter is set call a controller
method that looks like it's passing a
parameter so let's break this down
what's really happening here let me
write it in some comments because I
really want you guys to understand why
we're doing this and all that stuff so
URLs 0 equals I'll put it in brackets
the controller name URL 1 equals the
method URL to equals parameter and so if
you look at this localhost / controller
method parameter in thesese because
they're optional right now we're only
accepting one parameter here we could
put a couple in there we need to adjust
this list here so that we can accept a
couple so you know we could do it like
three parameters if you need more in a
get request you should probably do a
post if that makes sense if not don't
worry about it so I guess what I'll say
is if it's at URL - okay so I guess the
first thing we want to find out is how
many parameters will have passing so
three four so I'm going to count the
length length equals count this URL okay
so if the length I guess we got to go
backwards
so if length equals five
now stop here for a minute notice we
start at zero and this is four so really
this is one two three four five k so
this fifth one set we're passing all
three of these parameters the method and
the control okay we could do a switch
statement too if we want it seems more
practical so I'll say switch lengths
don't say case five break and I'll just
number these four three two one and so
for the fifth one so here's what's
happening we're saying this let me write
it out like pretend it's a user is the
controller controller method
Braham one gram to ram through gate
that's what we're doing and we're just
abstracting it in this way so that it's
we can use it so if we have five
parameters what we want to do is load
the controller and the controller is URL
zero but we set that in the class
remember up top the controller so we can
just skip this guy here for our mental
reference and this URL one is the method
and we're just going to pass in the
parameters and they'll go on order is
two three four so it'll be like two
three four so we have two here three
and four okay so that would pretty much
call that okay
so I'll copy this and we'll just get rid
of a parameter and this would pass it as
with one less parameter now you can pass
um
this as an array these guys if you
wanted to just do like make a separate
arrays URL of the parameters the reason
I want to do that is because every time
you fetch the parameters in your
controller if I was over in controllers
and I had like an argument here you'd
have to be like array or sorry
so func get args and then you'd have an
array and it's not as convenient to work
with that as it is to work with multiple
arguments just typed in there that match
your URL that's why I'm doing it this
way if you know a better way do holler
so I'll copy this guy here and then we
can just get rid of him okay
and then here so there's only two in
length in the URL which would be let's
see one two or just calling the method
like that and there should be no other
cases but default if for some reason who
knows why we'll throw an error and the
error I'll say is I'm just going to do a
die here we could use the error handler
let's see this error I like to this is
more like a system error I feel like
something how would I say that default
would be the please check your bootstrap
something went haywire with the
parameters how about that and then I'd
probably say
so if you ever get this aerial just say
all right I'm going to uncomment this
and see what happens and hopefully we
can get rid of some of this so here's
the to look at rid of that so if it's at
this URL one where are you checking with
that this is checking if it all exists I
really don't give a crap but we should
we should really care I just don't want
to add it if method exists to every one
of these I suppose it's really the only
intelligent way to do it if method
exists we load it I don't want to double
up on typing though otherwise we load
the error
I just I just don't like putting all
this stuff in my code well I don't have
to okay
I'll just put it at the top of it so
I'll say if method exists let me cut
this up and put it on top so I'll put it
right here okay
okay make sure the method we're calling
exists and this will only happen if URL
is set so I'll just say if length is
greater than zero
meaning we have a method being passed
then we'll do this check and this will
cover our butts for all of them okay so
if methods is this controller this URL
one all I want to do is throw an error
the method does not exist like that
and this determine what to load okay
okay that looks decent well so let's see
what happens refresh line eighty-five
guys I know this is a lot of code so you
might want to download if I went through
too fast but hopefully it makes sense
why we did it I want to find offset one
on line 85 okay so I have to check well
if length is greater than zero
all is greater than one because a zero
one could just be dense even though it
has a key of zero this could be one and
this would be two so refresh please
check your bootstraps something went
haywire I'm kind of glad that happened
so I'll print R of this stuff refresh
and or a zero is indexed so there's
index so if I go to help help is the
controller so oh it doesn't load the
default controller from here
don't I have that happening already if
empty this URL zero so let's see if this
is happening I let go one there so no
that's not happening
load exist in controller
Oh
we'll call your file this URL zero it's
what we call the method so when's this
happen oh I see so we load the
controller and then we load it here and
then after we load it we call the method
on it right here so I should actually
move this just going to bother me
okay
there we go so if if it's zero I don't
know why fingered this default would
just be no method I don't think I don't
think this is even a bug there so I'll
refresh the page of the help I guess I
got a call the index I believe this
controller up index so refresh okay
there we go
okay so I'll login we got that we got it
we got it so we got this Ajax loading
stuff let me just take a look we spent a
lot of time on this bootstrap but I
think it's better to have a class that
makes more sense
one thing also you could set parameters
to change your settings since this is a
very simple MVC I'm I don't think I'll
mess with this right now
like I when you instantiate it for
example if I were my index file you can
say app bootstrap or sorry app a set
controller folder and you know you could
change this to blah if you wanted to do
that and if you did want to do that you
would need a method to run the bootstrap
so I think we'll go ahead and do that
because I think it's a good idea to have
a method to run it so I'll say public
function init and sted all throw all
this stuff in here
and this just starts the bootstrap okay
so now in this we'd actually have to say
I'm going to rename this to bootstrap
and bootstrap in it okay
and since I'm feeling a little wild and
crazy we can actually get rid of the
whole construct okay if you want to set
a couple parameters let's say public
function set controller path and
set error file I suppose let's see if
we're loading the models from here looks
like it's coming from the controller guy
there we'll also do a models path so
I'll say public function set model path
and this will be this model path equals
path this makes our bootstrap a bit more
flexible and makes people happy so they
don't have to go jerry-rigged the class
and
okay so the controller path model path
in an error file so private controller
path model path and error file suite and
up here we probably put a copyright or
some stuff like that you can guys can do
whatever you want I'm going to leave it
empty for now so we got our pass for
this and what we want to do is probably
set defaults so that if these are not
called they'll be defaults so I'm going
to say controller path equals controller
model path equals model oops looks like
I made it plural some models and
controllers and an error file equal zero
dot PHP okay and what we want to do is
like if someone is going to set this
stuff so I'll say let me close that
bootstrap
set controller path if they say
controllers like this with slashes and
it messes up the system we want to clean
that up so I'm going to trim all slashes
if they set it so I'll say path will be
a trim
from path of the slashes okay it'll
prevent a lot of annoying stuff okay and
let's see how we're setting this
controller /index I want to manually put
a slash at the end of it personally so
I'm going to be dot slash okay okay
and in here you would put a I'm going to
put this optional set a custom path to
controllers this will be a strength
models
error file okay
and this doesn't need it because this is
just should just be a filename since
this one could be a little confusing use
the file name only of your floor eg here
dot PHP always good provide examples so
the reason is if I said this bootstrap
set error file you see I have this
parameters string path use the file name
only of your controller example would be
error dot PHP so if you want a little
problem dot PHP it's easy to understand
this will be models and now we just got
to change some parameters around so we
have a called controller path model path
this controller path dot this error file
okay
and let's see what else we got I know we
load it somewhere else here with Oh
boom and boom default controller let's
set one for that and this will be called
set default file
indexed on PHP so the default file at
the top would have to be
default and go down a ways so if they
want to set a default file dot this
default file okay and we'll set that as
index dot PHP sorry okay and then when
we load a model we have that model
loader we want to pass in the path to
the models so if we decide to change
those where did we call that load model
a load model here it is
so let's I'm just going to right click
that load model and I'll just put an
argument in here called path and the
this is a string the name of the model
and string location of the models okay
now if we call load model from a
controller we want this path to be set
so this could make things interesting
I could make ace constant in the
bootstrap but you can't use a get a
setter for a constant so that's a tricky
one for now off the top of my head I
think I'll just put in this model path
okay and we will do past that name and
Pass lissa you changes the model path so
we don't conflict with the word path
okay
so refresh undefined bootstraps
set on oops so without those that should
work just fine how we always had it well
what I do boots draw move strap okay
controllers error it looks like our
little slash guy didn't want to behave
so back up here I want to include the
slash here let's say always include
trailing slash okay refresh okay so that
works what I want to do now is I just
want to try something I want to try all
these setters to make sure it works so
I'll say bootstrap set controller
default path I'll just call it see
bootstrap set model path to M let's
first see if that works so if I change
my models to an poops M and my
controllers to see this should work and
it looks like it did okay cool so we
know those to work so those are optional
I'll just get rid of those and I'll
change those back controllers models
okay and then I want to try out the
bootstrap set default file will be a
Crump PHP and then about set error file
will be e dot PHP okay so for my error
I'll change it to e and for my index
I'll change it to Crump let's see what
happens I'll go to MVC and it's loading
crunked if I change this back to index
it can't find crunk cool that works
perfectly refresh and the error will
just change that back to error okay so
we have all these options set default
file so that controller path would be C
model path so I'll just comment all this
stuff out
okay
so now we have some optional path
settings if they want to set them before
the bootstrap initiates and that's a
pretty dope pretty cool man
I think I'll make this more readable so
if you made an application someone was
to download it you could let them
download this and they'll be like hey I
can change that pretty easily cool okay
the other thing I was griping about was
this models path here and the reason was
because if I'm let's say my user
controller
let's see am I doing a load model and
these let me look load model nope but if
I was I'd say this load model and you
know I type in the name of the model
like let's say the user model but then I
have to provide the path every time
that's really annoying so that's one
thing I don't like about that thing I
implemented so for the model path um let
me think about it a second model path
old model this model path okay I can't
think of something quick enough so it
this is kind of one of those things I
like to sit on the porch and ponder for
a long periods of time but for now I'm
just going to say models so that'll be
the default you may not need that and
I'm just going to make sure all this
stuff runs it looks pretty good
behaving well to me it feels a little
slow I haven't been on the this computer
very much I've been on my really slow
laptop so just enjoying Windows 8 here's
that beauty
so I'll zip this guy up and that's a
refactoring so far for this if you guys
are having any path issues again
remember the mod rewrite remember
setting the rewrite base in HT access
and your config file to include your
absolute path thanks a lot for watching
guys sorry for the long video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>