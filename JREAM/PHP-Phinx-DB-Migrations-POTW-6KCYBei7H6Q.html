<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP: Phinx (DB Migrations) - POTW | Coder Coacher - Coaching Coders</title><meta content="PHP: Phinx (DB Migrations) - POTW - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/JREAM/">JREAM</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP: Phinx (DB Migrations) - POTW</b></h2><h5 class="post__date">2015-12-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6KCYBei7H6Q" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey what's up developers i'm gonna talk
about thanks Phin X which is a database
migration library you might be thinking
well I use laravel I know everything or
I use Falcon already has it and maybe
even Symphony or what's that thing
called doctrine that terribly huge
system that I hate the difference
between Fink's is that it doesn't need
models it doesn't really need much you
just type out what you want and it'll
migrate for you it's very flexible with
any framework you want and it's
extremely easy to use so thanks Matt
fabu and Dan Sackett for getting me all
interested in this silly shenanigans two
blokes I work with they're actually
above me I'm not on top I know just
because I have a YouTube channel for
some reason people think I'm a big deal
but I'm really not even my boss tells
other employees about it it's really
embarrassing cuz I just want talk about
code so with the package that we let's
install something called Fink's with
that said let me just point out that
what you see on my screen this is um bun
2 version 15 and I'm running gnome GUI
because I don't like unity and I just
really like this so and I just have a
terminal and I just like to open a full
screen so let's clear that all right so
package of the week let's remove
composer Jason all right clear clear
what we're going to do is first composer
search for things
okay and it's the one that says Rob
Morgan on it now you could also do a
composer and knit and then search for
your package after defining your
composer but who really cares so we'll
do a composer or choir sorry it's Rob
Morgan thinks and that should install
the latest which at this time is oh five
oh right there
and it's pretty lightweight so let's
list that's clear first so it's readable
and LS and now we have some good stuff
Terron thinks it's pretty easy it's just
dot slash notes PHP vendor bin things
right now I don't want to type this
every time so I'm gonna write a quick
little bash script to make my life
easier so I'm just gonna vem thanks
inside the lowest level directory and
I'm just going to type shebang slash bin
bash PHP vendor bin Fink's and dollar
one dollar two dollar three because I
think there's only three main arguments
possibly usually used to but there might
be three I don't know all the commands
okay and then I'll just write that to a
file and change mode to executable um
thanks and there it is it's green so I
should be able to type dot slash things
okay so there she is
so let's first get started by
configuring Fink's it's insanely easy
we'll just say in it okay so it creates
a yml file
make another terminal here and I'll vim
into Fink's yell and I'm gonna use my
mouse to highlight you probably won't be
able to see it good that's why I'm gonna
highlight you have different databases
which is cool that you can use we're
just going to use one and try to keep
this video shorter and since it's
already set to development that's the
one I want to focus on see it says
default database development fine by me
so I already have PHP installed locally
you should too my sequel localhost the
name of my database is going to be
called fake my users root my password is
nothing so if you want to hack my
localhost go ahead don't really care so
I will escape and one other thing to
notice is this the path so the things
config directory just imagine that like
the path warned right now which in this
case over here is for me it's projects
flat slash package of the week so I
would need to make a directory called DB
seeds DB migrations of course you can
rename that and you don't even have to
use seeds if you don't want so the
difference between a migration is a
migration is your database schema when
you hear the word schema think of a
structure not the data that goes in it
okay a schema is like your table names
and your columns and all the little
parameters DB seeds is a feature that
thinks at it so that you could add like
a bunch of fake data to it I'm just
going to talk about the migrations
though so let's just do down here in the
bottom left
where all those DS are that's where I'm
going to type in some commands so I'm
going to do a make there - P of D B C's
and I'll do one of migrations okay so
now we have a DB folder there so if I
did LS dB
I have two folders there and they're
both empty all right so I will just save
that file out and what we're going to do
is create our first migration so where
I'm due Fink's create and that's this
command up here create a new migration
and let's just call it in it now you
need to do camel case because it follows
PS are standards so in it and if I go
here to the screen to the side I'll go
into CD DB migrations and we have a
crazy-looking thing what this is is this
is just a time stamp so every time you
create a new migration it will be time
stamped and it'll execute in that order
which is just perfect so I'm just gonna
vim this file you could sublime text it
if you wanted to however you'd like to
do things here and if I go down oh I
don't want to do that so there's a few
methods one is a change which is the
most convenient because there's up
there's down and then in the middle is
change so when you do migration if you
change something it's gonna change to
that if you roll back it's gonna undo
that change rather than having defined
rather than having to define what you do
when it goes up and then say oh I wanted
to delete it when it goes down change is
really convenient so to add this we're
gonna make a new table we're just gonna
call it users so you just make a
variable I'll just say table equals
this table users something like that and
actually let's call this users okay
users and we'll do add column we'll do
an email that will be a string and then
we have a array of type of parameters in
my sequel so this email is the column
name the second parameter is the type
and the fourth array you can pass in
more parameters and all of this stuff is
available in the Finks Docs one thing to
notice that I left it here it says
Fink's automatically creates an auto
incremented primary key column called ID
for every table so you don't need to
specify that which is pretty sweet so a
string we could do something like limit
of 75 right and then we're gonna add a
few more columns let's do add column
password string and we'll do a limit of
I can't even remember the line let's
just do 128 okay and we'll do something
like add column created at and he was
throwing a date/time there okay and the
last thing you need to do is a save okay
and that's it so if I got that right
let's also add in a field called active
add column active and this will be a
integer and the limit limit will be 1
and the we were going to make it signed
- true I believe so that there's no
negative integers you know it's usually
0 or 1 now we can set a default to 0
meaning they're not active obviously we
could probably make this more readable
something like this whoops ok now I
chained all these together you don't
have to but it's pretty easy let's all
say this and I'm just gonna go down to I
have a database open now let me delete
this drop that so my database name is
fake and just cat the fence yeah no file
remember the default database is
development and the name of it is fake
make sure you have the right credentials
so I'll just do think's migrate alright
so it migrated something let's go down
to our database whatever database guy
you use I'll refresh and we have users
so here's the ID that was Auto created
the email VAR car
there's the length there here's active
and unsigned did not work how I wanted
so I want signed to be false
and then that red it's just an extra
whitespace okay so I'm gonna do Fink's
and I'm going to type roll back all
right so if I go down to my little
precious thing here refresh users still
kept the ID there whatever selects me
migrate I'll press up in migrate all
right and there it is and there's my
little unsigned guy there default of 0
cool
let's make another migration just for
practice
thanks let's create what would we create
products that has to be capital C if we
do a lowercase it's gonna give an error
and it says please use camel case format
so products alright and we look in here
I have a new one called products so then
star underscore
I didn't work I can't fuzzy that look at
sex I don't like that
I don't like that all right
Oh - OH - I'm just gonna copy it
all right so we'll edit that and we'll
just make a table called products so
products equals this table products and
we'll say products add column name it'll
be a string say array there and then
we'll add column created at and date
time and never forget to save okay
Hey look it says remember to call the
create or update and not save when
working with the table class how did I
miss that
maybe that's why I didn't get deleted
hey I'm not perfect but maybe you're
learning something I hope so let's do a
create alright so create and for these
parameters will just say lengths of 100
all right save that guy and we'll do a
phynx down here on the bottom left
migrate all right
and we'll go down down and open up our
little guy here refresh this okay so now
we have products here pretty cool we
have named and created at and let's try
to roll back okay
and I'm gonna go down to Heidi okay so
the create will delete it so use create
not safe I don't know what I'm doing
so the init one you'd wanted to create
instead of saved and then let's also
just do like let's say we wanted it to
do great products change
no underscores
alright so copy this them whoops
them like that and there's a lot more
you can do with this than what I am
doing we can do exists equals this has
table products okay and we can say if
exist if you wanted to do this for some
reason will say products equals this
table products and then products
I think it's alter alter column well
let's do a few things actually it might
be kind of fun products to have a type
of here add column
I forgot uh guys their column price and
will do it's either a float or a decimal
I know I'm gonna get it wrong I'm gonna
guess with decimal you know what I don't
want to mess with that right now it's in
the docks all right and it probably has
a second options parameter where you
define how many decimal places all that
stuff so I'm just gonna do an integer
it's pretend list like a hundred bucks
so from here we'll just say after and
let's put it after the name so that it
doesn't go to the bottom all right
and then we'll do save there's also
things you can do like alter column and
there's also other ones that I would not
recommend such as which I learned the
hard way and mr. dr. D dr. D dannion
stack it corrected me on this if you do
this which is possible there's this
execute and there's also this query
where you can basically dump in insert
into or you can do create table now
execute wouldn't be so bad or query if
you are just inserting data but like
real data because if you're inserting
fake data you could use composer faker
or you could use the cedar this comes
with so that's probably what those are
better for the reason not to use these
is because once you roll back and if you
created a table with like this execute
it's not going to undo it and then
you're then when you try to migrate you
know every execute you would have to
check does this table exist and all that
like this because this right here this
line on thirty this isn't even necessary
for a this like this is cool right okay
so to end this video if we got it right
I know these tabs are out of place we're
going to do one more migration and after
so it's not at the end if I didn't
mention that
so bottom left I'm gonna do things
migrate and let's go see our results
refresh there's products and there is
name and it is right there in the nurse
price if you didn't put after it would
just put it at the bottom
that's Fink's pretty cool huh thanks for
watching guys
god bless you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>