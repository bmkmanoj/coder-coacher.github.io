<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hibernate Tutorial 31 - Projections and Query By Example | Coder Coacher - Coaching Coders</title><meta content="Hibernate Tutorial 31 - Projections and Query By Example - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Java-Brains/">Java Brains</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hibernate Tutorial 31 - Projections and Query By Example</b></h2><h5 class="post__date">2011-06-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2DXjdl8gzOo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this tutorial I'm going to talk about
a couple of other criteria API features
the first one I'm going to talk about is
projections and the second one is query
by example there are a lot of things you
can do with projections I'm just going
to cover some of the basics and if time
permits I'm going to create a few more
videos that explain projections in a bit
more detail but at a very high level one
of the uses of projections is to is to
implement any aggregation functions or
any grouping functions so for example I
want to return the maximum user ID in my
user table one way to do this is by
using projections so here's how it's
going to work now I have a create
criteria of user details so I know that
I'm pulling up data from my user details
table but now I need to tell hibernate
to pull up the top ID the maximum ID
from the table so in a hql are probably
in even in sequel the way i would do
that is I would say a select max off the
user ID but how would I do that in
criteria API so the way I do this in
criteria a peer is by using o dot
projection again note that we have a
session dot create criteria dot and so
on so that's how it goes we are we are
able to chain these different methods so
it works for projection also so I do a
set projection okay now here what I can
do is I can set projection for whatever
data that I need actually it's also
handy if you want to pull up just one
field it's not even about aggregate so
let's say I want to pull up just the
user ID so what I can do is I can do our
projections dot property and here I can
give user ID or I can give user name so
what happens is instead of pulling up
the entire object it's going to give me
the property that I am asking it to give
so this is this handy actually you can
you can pull up only one property or
only the properties that you want and
not the entire object so I will have to
import projections so this is going to
return me just the user ID so this is
one way we can use projections but the
other way is to return any aggregation
or any functions so for example I want
to get the the maximum user ID I was
telling you about so what I do is I do a
projection start again if we do a
control space you get all these
different functions here you have the
count you have the max min so let me
pick max so again it just takes the
property so I will pass the user ID it's
going to return me max off the user ID
so it count would return me the count so
here again these are the different
options that you have if you want to
return all the values of a particular
column alone and not the whole object
you would be this projection stored
property if you need other aggregation
functions or something like that you
would use the function itself you get an
access it using the projections dot okay
so this is one this is one topic that I
want to talk about the other thing that
I want to talk about is the order you
can actually sort all these output
results and I do that by using the again
I am chaining this here I'm not opening
a new one under the chain dot there is
this add order now add order takes a
parameter which is again an order object
so I will have to do a order dot and now
which order I want whether I wanted as
ascending or descending so let's say I
want this inning order off the user ID
so here I could mention
property these two don't go together let
me remove this if I just enter one ID
would not be able to see that so let's
let's run this now okay I'll show you
okay so here it's returning the list of
users in descending order okay so now
what happens if I add this one here if I
change the store property
moodle's so what happens if you use any
of these set projections what's going to
happen is the return type that you get
is no longer going to be a list of user
details here we have assumed that the
list is going to be a list of user
details but if you set any projection
whether it set it at a property so that
only the user IDs come up or you set any
aggregation function like a count or a
max no matter what you do here with the
projections the end result list is not
going to be a list of user details
anymore so I'm not going to run this
because I will have to change change all
these things so in the interest of time
I'll just leave this as it is you can
probably try this out and see what kind
of list you get but essentially what
happens is in this case since I'm
getting one the--the user ids it's going
to be a list of user ids it's not going
to be a list of user details okay so
this is this projections at a high level
again if this is how you can control the
type of data that you're getting first
of all you can choose the columns the
second thing is you can you can run any
aggregate functions okay now that is
this other thing that i want to show you
which is clearing by example querying by
example is a handy way if you have too
many properties and too many criteria
values to satisfy so let's say I have an
object which has ten fields and you have
values for five fields let's say I want
to pull up all the records
but with ID 1 with age trainee and with
pink or someone 0:02 something like that
so I have specific values for half of
the property see now creating a criteria
object for all of them is going to be a
pain I need to do a you know dot a dot
add and I need to create all these
restrictions so a handy way to do this
is by using this query by example so the
way to do this is by creating an example
object and hand it over to hibernate and
say hey give me all objects which look
like this in essence so let me just
create a user details object example
user of course here I don't have a lot
of a lot of property so you know you
this the true value of this is when you
have a lot of properties it's going to
save you a lot of restrictions to be
created I'll say new user details and I
will say example user dot set user ID as
five now I can add as many restrictions
as I want here by setting the values for
this example user so whatever value I
want in my result set I said all of them
over here now the user name this is user
five now why am i setting both of them
it's not required it's optional but I'll
show you how you can make it optional
but if you're not doing anything else
you're just passing the example object
it will compare all the fields so yeah
so this is my example object I have five
as the ID and this is the name now what
I will do is I'll create an example of
hibernate example criteria that
hibernate can use and I do that by using
exam
equals example dot create now in my
example dot create I pass this example
user object so this will tell hibernate
that I am interested in creating an
example out of this object and I will
pass this to the you know the criteria
so that it pulls up all the objects that
look like this so this so here I create
the criteria and then I do a dot add and
here I pass my example okay so now if I
run this it returns me user fight okay
but now you might be wondering what's
the fun in this I am passing I'm setting
both the values of this of this example
object now take for example I skip this
say I do not enter the username now
what's gonna happen is it's gonna return
me everything the reason for that is
there is nothing in the user name notice
what happens when I uncomment this line
and comment this one out it returns me
use a fie even though there is nothing
in the ID so the the concept here is
that hibernate ignores two things when
it comes to taking an example the first
thing is if any of the properties has a
value of null then it's not going to
consider that and the second thing is if
a property happens to be a primary key
then it's not going to consider that so
apart from null properties and primary
key properties if you have said any
value in any of the properties then that
is what happen it considers then it's
pulling up data so this is a this
actually handy because again as I told
you if you have
whole lot of properties that you need to
set in your query you don't have to do
that you can just create an object which
has all those properties set and you can
you can get the values now say for
example I have 10 properties in my
object and I know that some property is
going to have a value or it might have a
value and I don't want happening to
consider that property in that case what
I can do is I can ask hibernate to
ignore values of any of those property
so when I'm creating my example here and
inflating the example from my object to
what I can do is I can do a dot exclude
property and in my exclude property I
can give the name of the property that I
do not want how you need to consider
when it is taking this as an example so
say I have five properties and then one
of them has a value that I don't want to
be considered for my result list then I
can say dot exclude property of that
property name and of course I can change
this as well I can do as many dot
exclude properties as I want and of
course if you exclude all the properties
you are just left with the primary key
which is not considered and it's going
to return all the records so this is a
high-level view of query by example
there are other uses of query by example
you can use like as well so let's say
for example I remove this I have just
set the user name as user let's say one
now let's say I want to pull up all the
user names which start with user 1 so in
that case I will have to put a
percentage here okay now what I do is
when I'm creating the example here I
change this other command enable like so
when I run this 200 and me use a 1 and
use a 10 because it's in a builder like
operation so these are a few ways in
which you can use query by example hope
this was helpful
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>