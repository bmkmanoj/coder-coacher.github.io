<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hibernate Tutorial 04 - hbm2ddl Configuration and Name Annotations | Coder Coacher - Coaching Coders</title><meta content="Hibernate Tutorial 04 - hbm2ddl Configuration and Name Annotations - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Java-Brains/">Java Brains</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hibernate Tutorial 04 - hbm2ddl Configuration and Name Annotations</b></h2><h5 class="post__date">2011-05-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/iaSd_yK9xaw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay here's what we did in our previous
tutorial
he wrote a hibernate dot cf0 XML and we
configured our database related
information over here and we gave the
dialect which is again related to our
database depending on what database we
using we enter the dialect for that
database and then finally we had a
mapping class in place where we entered
the details of our DTU then we created
the DTO object here and we had a couple
of properties we added getters and
setters for that and then we added a
couple of annotations the first one was
entity and this was on top of the class
declaration and has denoted that this
class is an entity class and then we had
an ID annotation which was on top of the
user ID property field and this denoted
that this user ID is the primary key
then we wrote a class with the main
method where we instantiated the user
object with some default values we gave
the user ID and the user name with
default hard-coded values and then we
used hibernate to save the object by
using a session factory by you know
opening the configuration and then
building a session factory now from the
session factory we opened a new session
we began a transaction we save this user
object and then we committed the
transaction so this was what we did
and then what hibernate did was it
created the table and then it saved this
object that we had created so here's the
Postgres query to where I can run
queries here I'll do a select star from
user details and this will give me the
record that was inserted earlier which
is user ID one and the user name which
is all fine now let's do one thing let's
let's go back to this program and I will
try to insert a second user here I'll
say to user ID two and then I'll call
this user as second user that's the user
name save and let's run this now what
happens if we run this
okay it's inserted the record into the
user details now interestingly if we
query this run here you see two second
user know what happened to user one
first user has been deleted for some
reason and the reason why that's
happening this this configuration here
in the XML coiled hm h PM 2 DD eldorado
is set to create what does this mean
this means that as it says in the
comment here hibernate is going to drop
and recreate the database schema when it
runs for the first time so when you are
starting up here when you're saying and
you're building a new session factory
out of new configuration then what
hibernate does is it creates the entire
schema and how does it recreate the
schema it's by reading into all these
model objects and looking up the class
name and then creating a table out of it
looking up the ID of the properties and
creating a primary key out of it and the
other property is looking at the name
and creating table column names out of
it so this is happening every time you
start now again if I run this it's going
to drop all this do you know the schema
and then recreate the entire schema the
rail helps us say for example you have
you're developing your code and then you
want to change a lot of things here in
the model and then you're you want the
schema to get created every time you run
it then this is very helpful you can
have a create but what if I want to
retain my data I want the data that was
saved in the previous run to be
available when I run again so the way to
do that is to change this from create to
update now if I have this hpm to
detailed or auto property set to update
then what happen it does is it only
makes a change if it finds a change in
the model if it does not find a change
it's not going to create everything from
the scratch it's going to add on to it
just to test that we will add use
number three and I will call this user
as third user now if I run this the
previous user should be still there so
let's run this okay now it's inserted
let's have a look at the user details
table there you go
second user is available now third user
is added so this update make sure that
your existing schema is still there it
does not recreate the schema and if you
do want to recreate the schema you use
create here okay now after that there is
one more configuration here that we can
understand right away which is this one
the property name is show underscore SQL
and the value set to true so this is
what is doing this here
you know it's printing out the sequel
query and if you send true this will
print it out to a CD out which is our
console here and it's printing this
value here and if you set it to files
it's not going to display that we can
leave it as true all the way because
again it's helpful when do you know to
see what query hibernate comes up with
when we are making changes here okay
now this leaves a few other
configuration settings here you're going
to know we're not going to bother about
that as of now they learn about those
configuration settings as we go so now
let me make a couple of changes to this
user details dot java we saw in a
previous tutorial that there were a few
defaults that hibernate was sticking you
know in making the table design and in
also in inserting values into the table
the first default was that it was taking
this user details name as the tape the
name it was inserting this into the
stable it had created and the way it
created was by looking at the class name
and defaulting to the table name so this
presents a problem now instead of user
details what if I had the class name as
user what would happen is hibernate
would try to use the same name
in order to create the table and then we
need to do a create table with the name
of user the database would not allow
because user is actually a restricted
keyword in most of the databases however
you can have a class name called user so
this you know this is a common problem
you might face yeah something might not
be restricted as far as a class name is
concerned but it might be restricted as
far as the table name is concerned same
thing goes for the field names you can
have some words here which are allowed
as far as field names are concerned but
you cannot have them as column names
because the database enforces that
limitation how do you deal with that the
way to deal with that is to use some
configurations of these annotations so
we'll have a look at some of these
configurations in this tutorial first of
all for entity now entity has a property
called name I just did a control space
and name is the only property that is
there for entity so that just came up
instead of showing me a drop-down now
what does name do now let me change the
name here to make it user underscore
details what's happening here is if you
pass this name property then hibernate
will not take this class name into
consideration when it's creating a table
it will create the table out of this
name so let's save this and run this one
more time there you go you see this now
it's inserted into user details this is
the new table name that it has created
it did not pick up the class name this
time because I have given an entity name
and the entity name is what gets picked
up by hibernate as the table name itself
we can of course validate that by
looking up at the schema and then doing
a refresh they go user details is here
now note that it does not remove the
earlier one because
we have set the configuration here to
update ok this highlights one other
consequence of having an update if we
had a create here then what it would
have done is it would have dropped the
earlier schema so this table would have
gone and only this would have to mean
but now since it's an update it does not
modify the existing one it just creates
whatever is new so that makes sure that
this table gets created but this one is
left out as it is so let's drop this we
don't need this now ok so now we have
the user details
now the same thing whatever we saw for
entity name applies to these column
names as well now say I want to override
a column name instead of this user name
I want to have user underscore name in
that case what I would do is and go to
the top of this field and I would say
that at column now right away it care
comes up with the import let me import
this again I'm importing from Java X or
persistence
now add column has a few properties
again I do a control space now it has
something called as a name now let me
set the name here equals user underscore
name save this now what I'm doing is I'm
saying that I'm telling hibernate don't
use this name instead use this name so
it's just no right of the default
behavior it's optional if you don't
specify this it picks up the field name
itself I can change the user ID also a
user ID field already has an ID
annotation but I can add an additional
annotation for column so I can say
column name equals
user ID so so this is a there's a couple
of annotations which are operating on
this user ID property now the first
annotation tells that this user ID is a
primary key and the second annotation
does what the column name should be so I
can have multiple annotations on the
same field so let me save this I'm going
to change this to create and I would
like it to be
I like the schema to be dropped every
time because it's helpful veneers are
making such major changes to the to the
database it might end up in errors in
some cases otherwise so now let me run
this again tchau application ok now see
it is inserted into the user details
table the user name as the you name
which we have entered here and the user
ID again it's taken the name of the
column as the name that we have entered
here the column annotation okay before
we wind up this tutorial one other handy
trick is regarding the position of the
annotations here we have positioned our
annotations on top of the field itself
here we have put it on top of this
private end here we have put the
annotation on top of private string so
we have put it on top of the field
declaration another alternative is to
put it put the annotations on top of the
Gator itself so let's say I remove this
user ID annotation and then I place the
annotation on top of the Gator and let's
say I take this username annotation and
place it on top of the Gator of username
oops I think I put it the other way
round via this here and then I this here
okay
now what I lose I'll I'll change the
username Gator to a different
just as a marker to know that the value
is coming up from the Gator now what
happens if I run this it's going to
insert fine but what is the value that's
inserted the from Gator is the value
that's inserted which means that it
means that hi brain
picks up the value from the Gator insert
off the field value so even though the
value of the field is just third user
it's actually taking the value from the
Gator which is the actual value plus the
from Gator string and then it's
inserting that into the table so you can
have you can have both of these options
you can either enter the annotation on
top of the field in which case it picks
up the value of the field or you can
have the annotation on top of the Gator
in which case it picks up the value from
the Gator</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>