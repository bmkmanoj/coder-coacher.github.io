<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hibernate Tutorial 10 - Saving Collections | Coder Coacher - Coaching Coders</title><meta content="Hibernate Tutorial 10 - Saving Collections - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Java-Brains/">Java Brains</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hibernate Tutorial 10 - Saving Collections</b></h2><h5 class="post__date">2011-05-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hofWx5_ZN9c" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey everyone welcome to this tutorial on
hibernate if you've seen the previous
two tutorials you must now be knowing
how to embed an object into an entity
class and how to possess that embedded
object into the same table as the entity
class so as I told you in the earlier
tutorial this is one of the several
cases in which you can have an object
inside another object in this tutorial
we're going to look at we're going to go
one step further we're going to look at
a slightly more complicated scenario and
this case I have okay in the previous in
the previous tutorial we had an address
object right so this this was the object
that we had and we had embedded this
object into my user entity class here
I've actually removed it because I'm
going to do something else in this
tutorial but in an earlier tutorial we
had an instance of the address object in
our user details class so what we did
was we marked the address object as
embeddable and we had marked embedded
and then we had to find the address
object so that the fields of this
address object get embedded into the
user details table that was created out
of this object so basically we are just
taking this object and we are literally
embedding it inside this object so that
the even the columns get embedded into
the corresponding table now in this
tutorial we're going to look at a we are
going to take it a step further now what
if instead of a single object or you
know a fixed set of objects we also
tried the adding two objects in the
previous tutorial we had two instances
of the address so that's fine but what
if I need what if I need a collection
what if I do not know how many address
objects I need and I want a collection
to be a member variable of this user
details class how to handle that the use
case that I have is I want to keep track
of all the addresses that this
particular user has lived in over the
years so I might have
a list of addresses and I don't know how
many addresses they're going to be so I
cannot instantiate them statically now
we can't have collections and hibernate
does provide support for that but let's
take a minute to think how this would
work if it's a fixed number of objects
well it makes sense we can have a fixed
number of columns for those objects say
for example you know in the previous
tutorial we had a home address and an
office address so we had separate
columns for the home address and
separate columns for the office address
in our table and you know once that's
created that would do we can store the
home address and the office address for
each user but now when I have when I do
not know how many address objects I'll
be having I could have one I could have
zero I could have a hundred now how do I
handle that well obviously how would you
handle it when you were when you design
the table you would probably create a
different table for the address data and
you would probably--he reference the
user say for example I have user ID one
and have five addresses for that user
then I would insert fire records into a
separate table called the address table
and each of those fire records would
have the user ID one associated with it
as a foreign key so that we know that
user 1 as these five addresses
associated so that's what we're going to
do this tutorial if you're going to
create a collection of addresses inside
the user details entity class you're
going to instantiate it and we'll see
how hibernate deals with this so first
let me create a collection I'm going to
start with a set okay that you there are
a few collection objects at hibernate
supports one of them is a set so we'll
start with that and let's see how
hibernate handles it and then we're
going to take a tour we're going to look
at the other details so let me create a
simple set here I will have the address
set
call it list of addresses because that's
what it is we have we having a list of
all the addresses that this user has has
lived at or has been and so okay when
import this I'll create a new set so
when I am creating I will have to set it
actually you know I you know it's a it's
not an implementation I have to give an
implementation of the set when I'm
saying new so I'm going to use a hash
set such it should look fine for now
again I'm going to import hash set I
cannot use a hash set here I have to use
a set I cannot use an implementation
when I am declaring this but I can
define it as a hash set we're going to
look at why this is the case but note
that this is just we not going to look
at an implementation and we are not
going to instantiate an implementation
of the set when we are defining this
list of MNAR declaring this list of
addresses okay so now I have this list
of addresses here then we generate the
getters and setters okay that's done
save now all I have to do is feed in
those values in my cabinet test and see
what happens so I have this first user
no other details here now I just create
a few addresses okay I have these to
address objects here I spared you the
pain of watching me type all this so
I've just initialize a few values here
and I will be having hash set that will
store these two at this objects now so
the hash set I have already defined over
here that I've defined it as a new hash
it's all I need to do
I need to get the list of addresses and
I need to add these two addresses so I
will say user dot get list of addresses
dot add the Stix address so I'll pass at
just one and of course I just do as well
okay so now we have the addresses added
to this list of addresses set and we are
ready to save this now save is already
happening I have this session factory
session everything code is as it was
before I'm saving this user object now
there is this annotation that I need to
make for a hibernate to know that this
is actually to be treated as a list and
I want this list to be saved and the
annotation that needs to be used as add
element collection and of course I'll
have to import this from Java extra
positions again now add element
collection as all I have to do to mark
this this entire collection object to be
persisted by hibernate so I'll just save
this and anyway this is marked as an
embeddable so it knows that this is this
is the address that's over here another
market is an element collection so that
hibernate knows that it has to be
treated as a collection and it should
not actually be embedded as a table but
as a separate table which has a list of
all these addresses so let's let's just
run this and see what happens
okay now look at the insert statements
first it's inserted the user data into
the user details table now the user
details is what we have configured for
this this entity class over here it's
inserted fine and it has inserted only
the values user name and user ID note
here it has not done anything about the
collection here okay so that was the
first insert this next two inserts are
into a table called user details
underscore list of addresses so what is
this table name it's a it's the name of
this entity underscore name of this
collection in member variable so it has
auto-generated this name in order to
save all the members of this collection
and now inside this it has generated a
primary key which is the user am sorry
it's a foreign key which is the user
details underscore user ID and this is
actually a reference to this you know
primary key of the user table which is
this one and then it has inserted all
the other values let's have a look at
the database table so it's clearer okay
now use the details straight forward
just this it does not worry about the
address it's a collection and the
collection has to be taken care of
elsewhere so this is the actual table
now let's see what this has
hmm this is art okay I've made a mistake
here this should be address too so copy
paste edit say then let's run this again
there you go
so both the records are inserted into
this user details underscore list of
addresses stable so to summarize I have
a user details entity class and that
entity class has a collection the
collection happens to be a set here and
I have annotated that as element
collection and I have also defined the
collection class here they actually
class which is immuno member of that
collection which is the address now the
idea is that I can have multiple
addresses a collection of addresses for
every user entity now how does hibernate
deal with it hibernate takes this the
first the actual entity object and it
creates a record for that entity object
in the entity table and then it looks at
how many addresses are there for this
user class so whatever is the size of
the whatever is the size of this
collection say I have n number of
objects in this collection so what it
does is first of all it creates a sub
table for this collection so that it can
store all those all those elements and
then depending on how many of your
members are there in this collection
what it does is it creates so many
records and then since its first Cree
saved the the user object it knows
what's the user ID now it adds that user
ID for all the sub elements that it
saves so if my user object has five
addresses there will be fire records
here for each of those addresses
I mean Phi records for the five
addresses and then the user ID for
each of them will be the user ID that
was saved when you write save the user
details which is society so it saves
society for all of those all of those
addresses so that's how that's how
hibernate makes the link between all the
addresses and the main entity so this is
this is one of the ways in which
hibernate can save collections so we're
going to look at some of the
implications of this collection in the
next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>