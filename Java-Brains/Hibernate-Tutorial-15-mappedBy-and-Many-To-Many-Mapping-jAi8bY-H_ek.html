<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hibernate Tutorial 15 - mappedBy and Many To Many Mapping | Coder Coacher - Coaching Coders</title><meta content="Hibernate Tutorial 15 - mappedBy and Many To Many Mapping - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Java-Brains/">Java Brains</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hibernate Tutorial 15 - mappedBy and Many To Many Mapping</b></h2><h5 class="post__date">2011-05-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/jAi8bY-H_ek" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi and welcome to this tutorial in this
tutorial we're going to look at the last
one that's left out the many-to-many
relationship before we start
many-to-many this one thing that I would
like to show you but the you know
one-to-many are the many to one
relationship this is something we did in
our previous tutorial we had a one to
many relationship between the user
object and the vehicle object and we had
we just that we decided the add one to
many and what hibernated was by default
it created a separate mapping table and
it inserted the IDS of both the user as
well as the vehicle into that mapping
table and of course it had the separate
table for the user and a separate table
for the vehicle there's one other way to
represent a one-to-many many-to-one
relationship and that is that the the
object on the mini side of the
relationship has a reference to the
other object so now my user table cannot
have a column for the vehicle ID because
one user can have multiple vehicles but
the vehicle table can have a user ID
column because any vehicle will have
only one user it's a it's a many-to-one
as far as the vehicle side of the
relationship is concerned so I can as
we'll have a user ID column in my
vehicle table and I can do the mapping
there itself without having to have a
separate table which has the mapping of
the user and the vehicle ID so in this
tutorial we're going to have a quick
look at that before we move on to the
many-to-many so what I need to do for
that is first let me remove this
configuration okay so I have a
one-to-many mapping for this one which
is a vehicle collection inside the user
object and now I have a many to one
mapping on this side which is the wake
of the user instance in the wake of
object now what I need to do is I need
to say that this needs to have the
mapping of that relationship so what
do as I go here and in my one-to-many I
have this property called map by and
what map by does is it says where you
want the mapping to happen I want the
mapping to happen over here this has to
do the mapping I don't want a separate
table so I say map by equals user okay
once this is done what I'll do is I'll
go to the vehicle class and here under
the mini to one annotation I will
specify what is the join column so I'll
say add trying column and name equals I
will give this a name user ID so I'm
naming the join column that I'm creating
inside the vehicle table itself so once
we put this annotation hibernate knows
that the mapping is for this user and
the join column is in this vehicle table
so instead of creating a new table what
it'll do is it'll just create a column
inside the vehicle table and it'll have
the ID of the user saved here so I will
save both these classes and let's run
the test again okay so here you can see
it's inserted the user details table
user name and user ID but if you look at
the vehicle table it has three columns
one is user ID liquor name and the
vehicle ID these two were already there
now what we have done is instead of
mapping the user ID with the vehicle ID
in a separate table we have done this
mapping in the vehicle table itself so
this will this will have the
relationship inside the vehicle table
itself okay so now with this done we'll
have a look at many to many mapping now
many to many is is again there's only
one way we can represent the many to
many it has to have a mapping table
because assume a scenario where you know
one this is kind of a rental vehicle and
then a user can rent multiple vehicles
when the vehicle can be rented by Y to
the users so in that case one
user might be having multiple vehicles
allocated to that user and then a
vehicle will have multiple users so you
cannot have the mapping either in the
user table or in the vehicle table it
has to be a separate table so I will
remove these annotations here we will
continue to try you know have this
bi-directional relationship in this
example as well so let's remove these
annotations so here just like I have up
vehicle collection inside the user
object I need to have a user collection
inside a vehicle object so I will see
collection of user details let the name
be okay I'll call this user list equals
new array list so I have defined this
new collection here now let me clear out
the Gators in the setters so that I can
create new kitten setters to finish the
import and then generate getters and
setters okay so now there is a
bi-directional relationship and it is a
many-to-many on both sides so again in
order to configure it and hibernate it
is as simple as writing a annotation
many to many
of course the same thing applies here so
there is a many-to-many relationship on
both ends now what we need to do is we
need to change our test class see right
now it's a it's a set user so this
changes now so this will probably be a
get user list dot okay it's an ADD user
the same way get the user list and then
add the user
okay now let's save and run this let's
see what happens okay
so now what's happening here we have a
user details table which has the user
name and the user ID now the vehicle
paper has the vehicle name and the
vehicle ID now look at what's happening
over here it has created two
relationship tables it there is one
called user details underscore vehicle
and vehicle and this code user details
so what it's doing this it's having the
same relationship it's mapping the user
ID to the vehicle ID in both here it's
mapping the vehicle ID to the user ID
now hibernate does not know that it
needs to just do one mapping so it's
actually doing two mappings it's looking
at user details and when it is saving
user details it creates a mapping and it
looks at vehicle and when it saves the
vehicle it creates a mapping so we
to tell hibernate not to do this we need
to tell hibernate to map for only one
table let's have a look at the data so
that we get a clearer picture let's take
the user details table okay one user
fine now wake up to vehicles which is
also fine now if you query user details
underscore vehicle see it's mapping one
two two and one two three now if you
query vehicle in the score user details
again you can see two is mapped to 1 and
3 is mapped to one so this is a
redundant mapping we don't need to have
two different mappings so what do we do
to make only one mapping happen so what
we do is we just pick one of these
classes let's pick the user details
class and you know will tell hibernate
that this class will have the mapping
which is its mapping user detail and
make a let's be user detail to way
though so user ID forms the first column
and the vehicle ID forms the second
column so once that happens what we do
is we go to the vehicle class and we
tell vehicle same as what we did earlier
we say map by equals and this is mapped
by vehicle so I will say don't worry
about mapping I'm already being mapped
by the vehicle of this thing here which
is the user list so what it does is it
just looks up the vehicle mapping now
save this I know
now let's run this anyway let's uh let's
see what happens if we run this run as
java application there you go the user
details vehicle is the only table that
is created because here this
many-to-many is doing the mapping and
this many-to-many is not doing the
mapping because we have we have told
hibernate that it's being mapped by the
other class already so you don't have to
do the mapping so this helps us to have
only one table mapping so hibernate
knows that okay the mapping has to be
done over here and then it tries to look
at the vehicle class it does not do a
mapping again it does it you know it
knows that the mapping is already being
done in the other class which is the
user details underscore vehicle so you
know it works fine now if you want you
know vehicle and the score user details
you know it's just a change in the or
you know order of the columns which
really doesn't matter but in that case
what you would do is you change and
change it in the user details class you
would say map by user of this object so
in that case this annotation this made
mini annotation would take care of the
configuration now again have the same
configuration which we did earlier
applies now you can go to this user
details annotation here you can define
what is the join table name the join
column name it's as simple as saying at
join column inside I'd join table now
you would also have to do the same thing
that we did earlier and you would have
to have a join column and an inverse
joined column so you're naming both the
user ID column as well as the vehicle ID
column but note that since you have
mentioned here that you know it's mapped
by vehicle of the other class your join
table join column configurations have to
be inside this class which is user
details class because this mini tamiya
is the one that's creating the staple
here so that's how you you know create a
many-to-many relationship between two
objects
now we have looked at all the possible
combinations we have looked at one to
one one to many and many to one and many
to many
now there are a few concepts here that
are common across all these three
mapping or you know combinations and
we'll have a look at what those concepts
are in the next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>