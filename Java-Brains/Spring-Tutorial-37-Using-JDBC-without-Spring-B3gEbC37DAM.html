<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Spring Tutorial 37 - Using JDBC without Spring | Coder Coacher - Coaching Coders</title><meta content="Spring Tutorial 37 - Using JDBC without Spring - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Java-Brains/">Java Brains</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Spring Tutorial 37 - Using JDBC without Spring</b></h2><h5 class="post__date">2011-10-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/B3gEbC37DAM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">as a Java developer we work with data
all the time and 99% of the applications
that we would develop would interface
with some sort of a database
mostly it's relational but generally as
an application it would need to talk to
a database in order to get the data and
the data is so-called life of the
application the typical way to connect a
java application to a database would be
through JDBC JDBC is some set of api's
which allow us to connect to any
database provided we have the drivers
and execute sequel queries and run
you know insert statements update
deletes and even fetches JDBC has been
used for many years now and it's a good
enough set of api's it serves the
purpose any any interaction that you
want to do with the database can be done
using JDBC but if you ask a Java
developer about their opinions on coding
in JDBC you're probably not going to get
a very good answer it's generally
considered a pain to write code to get
JDBC to work well it's not so much the
code that you need to interact with the
database itself
it is what we call as boilerplate code
we need to write code just to get things
working we need to write a whole lot of
code just to open a connection we need
to write code to handle the data and
there are a lot of stuff which we need
to do for every application when we
still need to do it because that's
required in order for JDBC to work so in
this tutorial you're going to look at a
very simple class which connects to our
capacitor B database that we installed
an earlier tutorial all we will do is we
will run a query a select query and
we'll retrieve records and we'll look at
the code that's required in order to
just run a simple select and then print
out the records so in essence this
tutorial will be a very quick refresher
of JDBC and if not anything else it will
help remind us just how pain
coding in JDBC is so let's get started
here is an instance of Apache Derby
running in network server mode so we
have this running and in the previous
tutorial we created a circle table which
had two columns one was an ID and one
was a name and we also inserted one
record for ID one we called it first
circle so this should suffice as far as
proprietary pairing the data is
concerned now I will write a program
that accesses the stator so I'll create
a new Java project well call this JDBC
demo to finish so the first thing that
we need to do whenever you write code
that accesses databases make sure that
the drivers for the database that you're
trying to connect to is available in the
project which means for Apache Derby we
need to include all the drivers so that
our project here can connect to the
database so I go to the properties and
in the libraries I say add external jars
and then navigate to the derby folder go
to the Lib and here you have derby and
the big line just add them both and
press ok so now we have the reference
library having the W drivers so the next
step will be to create a model class
since we've created a circle table I'll
create circle model class I'll call
package
water and the name of the class sucker
so listen there's nothing special this
will just be a simple model class which
has two member variables which is the ID
and the name I already have the code
here so just paste it so it has the ID
in the name member variables and the
getters and setters for the ID and the
name one other thing which I've added
here is a constructor the Dickson and ID
and name and it has sets those two
values for the member variables the
reason I'm doing this is this like
actually a common operation when you
working with JDBC you would want to
initialize an object and add all the
member variables and assign them to the
initialized object and since we'll be
doing this very often it's handy to have
the constructor that does this in one go
you have a new object and you also have
all the member variables initialized so
in your model class depending on how
many member variables you have make sure
you have you know a constructor that
takes in all those member we lose as
parameter so this completes the model
class now I will create a class with the
main method senior class
well this June BBC demo a main method
okay so in this main method I will
initialize or Diego and then I'll call a
method of the D which will fetch me the
data so I will write a da one now this
would be in the dot d you package call
this JDBC I'm here orange ABC Dao MPO
click finish
so this class is responsible for talking
to the database and getting the value
I plan to implement one method here
which takes in an ID and returns the
object itself so I pass in a circle ID
and then I get a fully initialized
circle object in order to do that I will
write the method gets oka that takes in
in circle ID parameter and then it
returns a fully initialized sucker I
will have to import circle from the
model package and then I have to write
my JDBC code over here and when I do
that in my main I can initialize the
Dero I can say circle equals new JDBC dy
MP r dot to import this and I have to
import circle so I create a new JDBC do
I am here and then I do a get so go I
pass the value 1 and then it returns me
ahsoka and then I do a this out
so good God get me that's it so it's
fairly simple so far isn't it there's
actually nothing to it I'm just calling
a method to a deal
and then the dao has a method that
returns me the object it's as simple as
that
but the complexity lies in the JDBC code
that goes over here to actually talk to
the database so we'll have a look at
that now now the first thing we need to
do is have a connection object
connection equals now let me let me
assign it as null for now of the
connection is from the java sequel
package now after this what I need to do
is I need to initialize the client
driver I need to know the specific
string that denote what the client
driver is and I need to initialize that
I've just copy paste the code over here
which does that so here you see I have a
driver string that has the value as the
client driver for the Derby database and
then I need to create a new instance now
as soon as I write this code it you know
highlights an error and the error is
that there are unhandled exceptions I
need to surround it with a try-catch so
let's do that in just a while now but
let's finish the code over here so now I
have a driver and I initialize it and
now what I do is I create a connection
so the way I do this is this line so I
say connection this driver manager dot
gate connection and I pass the
connection string over here
so driver manager needs to be imported
from Java sequel and then after this I
create a prepared statement and then I
set the value so that I can use that
over here prepared statement PS equals
new prepared statement where you pass
the query
start from circle where the ID is
question mark and then I said the idea
over here using a set int of course I'll
have to import prepared statement as
well make sure importing it from Java
routes equal okay so now that I have
created a prepared statement I need to
actually execute it so I use a record
set and then I execute this prepared
statement I also initialize a circle
object so that I can assign the results
to this circle object over here now the
result set is again another thing that I
need to import okay
so now at the end of this I have a
result set that is the result of
executing this prepared statement that
I've created over here with the actual
query now that I have the result set I
need to get the actual object from this
result set which is these lines of code
now if RS dot next if there is a record
then I'm going to assign that to a
circle I'm doing a new circle this is
the constructor that I told you earlier
and I'm passing both the ID as well as
the name I'm getting the name from RS
dot get string I need to know what the
data type is and I need to use the write
method so that I can get the proper
value and the name being the name of the
column in the table so once this is done
I close the record set and the prepared
statement since these two have been
opened close them both okay
and then I return a sucker so the circle
is the value that we have initialized
over here I'm going to return that so
just to quickly summarize again we have
a driver that we initialize we have a
connection that we initialize by passing
the connection string then we have a
prepared statement that we use based on
the connection we use a connection dot
prepared statement and the prepaid
statement will have the query that you
want to execute I substitute the
parameter
and then I initialize a result set based
on the prepared statement I execute the
query of the prepared statement I get a
result set and then using the result set
I loop through and then I get the object
you know if it's a multi list with lot
of records they'll have to look through
and initialize a list of objects but in
this case I'm passing an ID so I just
have one object I get the object I close
the record set I close the prepared
statement and then I return the circle
all this just to get an object from the
database so you can understand how
painful this is and believe me we still
haven't covered all the painful points
yet look at all these errors over here
every line is having an error marker
thrown by eclipse and all of them say
that these have to be surrounded by a
try-catch the reason for that is all
these through sequel exception there are
a couple more exceptions but sequel
exception is a common one that's thrown
you know what happens if the connection
is not got what happens if there is an
error in creating the preparedstatement
what happens if there is an error in
executing the query so all these throw
sequel exception even our s dot next
throws an exception so we need to make
sure that all these are inside a
try-catch block so let's put them inside
a try-catch block here I'll open a try
and I'll close the sure and catch now
what is the exception that I need to
catch here there are a whole lot of them
and you have lot of production code
where you have you there are lots of
exceptions that required and there's
really nothing you can do about these
exceptions say there's a problem in
connecting to the database it's not in
the scope of the application itself it's
in the connectivity to the database and
there's really nothing you can do except
for handling an error condition then
exiting so most of the times what
developers end up doing out of
frustration is catching a broad
exception which is not really a good
practice in coding but then you end up
doing it because there is only one thing
you can do for all the problems that you
face over here so
I will throw the new runtime exception I
don't want to deal with it now I lead
with this later
so I throw a new runtime exception
irrespective of whatever is the cause
because no matter what the error is no
matter where in this code data actually
happened it has to do with connectivity
with the database and is really nothing
else we can do - and the execution okay
so if you notice I have not closed one
object here called connection so you see
here connection I'm just getting the
connection and then I've closed the
require you know the record set enough
closed the prepared statement but I have
not closed the connection the reason I
haven't done that is I have to make sure
the connection is closed in all the
execution paths even if there is an
error I need to make sure that the
connection is closed not closing the
connection has very big impact on the
program if it's a production system and
then you have some place where the
connection is not closed it will result
in leakage and it's gonna affect the
program and the performance adversely so
that's reason why I will add a finally
block here and I will close the
connection in the finally block finally
and connection dot close
now here's another problem connection
that close also throws a sequel
exception so even though I put this
inside finally I cannot just leave it as
it is I need to include the connection
dot closed inside a try-catch block
another big pain point so I will use a
try here and close this and I'll have a
catch inside this cache I can use a
sequel exception because there's only
one line and connection door closed
through a sequel exception choil
sequel exception and again there's
nothing we can do about it
and then the clothes over here I'll
import sequel exception from Java Atsuko
and then finally I close the method
closing brace so you can see how much of
a pain this actually is there is a whole
lot of hoops that you have to jump
through just to get a record from the
database so however this is done you're
finally done and now I will just run
this code to make sure I'm getting the
circle object over here I'm just passing
a value of 1 which is the primary key of
the record that we just inserted in the
previous tutorial I should get the
circle here by running this method and
then I'm printing out the circle that
kid named it should be I think the first
circle or something that's the name that
I gave in the previous tutorial so let's
run this there you go first let's print
it so having seen the trouble that JDBC
puts us through in order to get
something running we'll have a look in
the next tutorial at how we can use
spring and spring data support to remove
you know pain points one after the other
and you know we'll see how we end up
with a slightly more elegant code by
using spring JDBC support</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>