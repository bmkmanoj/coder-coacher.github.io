<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Database Design 29 - Foreign Key Constraints | Coder Coacher - Coaching Coders</title><meta content="Database Design 29 - Foreign Key Constraints - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/CalebTheVideoMaker2/">CalebTheVideoMaker2</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Database Design 29 - Foreign Key Constraints</b></h2><h5 class="post__date">2014-07-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/rOyZtFo4qaU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey I got a bunch of writing on the
board but don't look at it yet because I
just want to talk to you guys for a
minute I just wrote it so you want to
have to watch me write like 50 hundred
words had to be boring so instead I'm
just gonna talk instead so much better
right anyways last video throughout the
series we've talked about foreign keys
and as we know they keep connections
between tables in a database so table 1
table 2 boom foreign key connect from
this foreign key references the primary
key of this table over here that's kind
of how foreign keys work they protect
the integrity of our database they keep
everything consistent think about if
there was no foreign key constraints
which keeps keeps it updated and
everything then we would have to
manually update all connections between
tables and that'd be a big waste of time
and it'd just be easier just to store
everything in one giant table which both
solutions either manually doing it or
storing everything in one giant table is
not going to work so we need foreign key
constraints to protect the integrity of
our database threat it's called
referential referential integrity it's
big words I all right so now this
concept these words might be rule of
specific to a certain relational
database management system so these are
from MySQL but if you're using a
different relational database management
system yours might be a little bit
different but in general the concepts
are pretty similar so you're not wasting
your time if you don't use MySQL because
you need to understand how foreign key
constraints work all right cool so first
of all foreign key constraints make sure
that if you update the parent the
children are going to update or cause an
error or something like that it's up to
you you can make the decision and it's
also going to prevent you from creating
children when there's not a parent that
are that with that primary key for
example if we have five users with the
users ID to
four six eight and ten and then I make a
comments table and I add a row that's
like from the user 745 well that person
doesn't even exist so that's not going
to work so that's why foreign key
constraints are important because they
once again protect our database and make
it pretty much self-managed rather than
us having to manually update everything
so let's begin all right let me get a
piece of chalk this one looks nice again
pretty low this is the biggest piece of
chalk I have left all right so we when
we create an SQL statement we can add
these two key keyword phrases here on
delete and on update this refers to the
foreign key constraint so when we but
it's talking about the parent so when we
update the parent we want the forward
can we super fly all right when we
update the parent we want the children
to do something when we delete the
parent we want the children to do
something that is what these key words
mean so these key words it's talking
about the foreign key constraint and it
refers to the pair
all right so let's just draw some basic
tables this kind of keep things I'm not
going to give any specific examples yet
I'll just kind of draw things out so
let's say we have a parent here and as
you learned in previous videos the
parent is the primary key right and then
let's reference this primary key with a
child okay let's not draw this line yet
and then we have a foreign key this this
primary key is a column within the
parent and every single row has a unique
value the foreign key is a column within
the parent and it references the primary
key so the saintly value 400 in a row
could reference the value 400 in this
row and a row of this table you get it
I've explained it enough now let's just
make another child table so these are
both foreign keys that reference the
same primary key but they're two
separate tables so yeah we could have a
user table and then we could have a a
comments table and an orders table for
example they both are bought or
commented by a user
so these foreign keys reference primary
keys so every single value within the
table of the children within the foreign
key column needs to be a value that
referent that is present in the parent
column now these these values right here
these options refer to the parent so
when we delete the parent or when we
update the parent we want the same thing
to happen to the child or whatever the
options are and we'll talk about the
options in a second so that's kind of
how these work now just to kind of clear
things up I'm going to erase these words
here just because it's getting a little
crowded you know I want it to be
peaceful hi
okay so this is kind of how it's working
foreign keys point back to the primary
key these options refer to that what
what happens to the pan now these these
options right here these refer what
happens to refer to what happens to the
child okay now it's getting real
confusing there's arrows everywhere like
graphs and diagrams and poof but you'll
get it don't restrict you might also
hear as no action is always for my SQL
in different database management systems
these might be different but anyways
restrict is going to throw an error so
if we try to like we can give we can
give one of these for each option so on
delete we can either give restrict
cascade or set and all or no on to on
delete we could have it restrict cascade
or said no just to add more errors you
know but let's say we're working with
delete right now and we wanted to we
want to use restrict so within our SQL
statement we could say on delete
restrict so on delete restrict and that
is going to give us an error whenever
the parent is deleted so if I tried to
delete the user with the ID I don't know
I'm writing all that out let's just say
the ID of 504 and then this child has a
row that has 504 within the foreign key
column well then it's going to throw an
error it's not going to happen and the
parent will not be deleted and not going
to happen
so that's how cascade on delete works
I'm sorry we're strict on delete now
we're strict on update if we updated
that parent and change their primary key
so let's say we changed 504 and these
children both reference 504 with the
foreign key and then we change this to
508 and it's not going to work and it
will go back to what it was originally
because we have it restrict we're not
going to let that happen you see all
right what about the next option cascade
cascade we'll do whatever we do to the
parent to
child clear yourself of is confusing me
i smear and chop all around you know
totally helping all right so now if we
cascade on delete that means if we
delete the parent we're going to delete
the child as well so we delete 504 and
bowl children are deleted full child
deleted so now 504 doesn't exist at all
so like for example if this was a
comments table and we had a comment from
the user with the user ID of 752 and we
deleted 752 the user well then obviously
all of his comments by him should be
deleted too because we'd have a comment
by a user that doesn't exist which does
not which isn't supposed to happen
so cascade on delete we'll do that on
update is if for some reason we updated
the primary key which obviously
shouldn't happen because primary key
should be never changing but you still
want that protection on your database on
update if we have cascade if we change
like 504 let's say these people existing
in skating races cuz I so these people
exist again 500 for 500 for these
references 504 and if we update this to
508 well that means all of the children
rep will update as well so now it
connects within within different tables
finally we have set in old and what that
will do is it will basically just set
the children as null for that specific
value so if we deleted the parent this
is just going to get rid of the value
the row should still exist but the
actual foreign key reference it no
longer references anything it's empty so
there's no it's not referencing anything
so the column for that row so like the
let's say we have a comment and it's a
comment from Billy Bob with the ID of
504 if we delete that we're now we're
going to have a comment with no poster
or no commenter at all it is
no value as I said no will do if we use
on delete an update same thing if we
change the ID of the parent changed it
from 504 to 508 well all of the children
are going to be set to no value as well
all right now there's one important
thing when you with setting all the
children have to have that they can't
have I should say the not null
characteristic we talked about that in
previous videos I'm just going to put NN
for short if this is not null and we
update if we have on update set null and
we update 504 to 508 can you even I've
I've been cutting this off this whole
time all right we set 504 and 508 I
think you can see that one yeah you can
we change 504 and 508 and this is not
null it's going to be like parents we
can't do it because we can't set it to
null because it has the not null
characteristic which means every single
row has to have a value for that
attribute for that column so give an
error and I'll go back to how it was so
that's an introduction to foreign key
constraints sorry if I talk fast
but yeah cool stuff it's important stuff
so learn it study and learn it for your
specific relational database management
system obviously I'm trying to keep the
series pretty broad so any relational
database can benefit abase ER that's
even a word can benefit from it all
right so see you guys the next video be
sure to subscribe</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>