<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Oracle SQL Tutorial 20 - How to Create Composite Primary Keys | Coder Coacher - Coaching Coders</title><meta content="Oracle SQL Tutorial 20 - How to Create Composite Primary Keys - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/CalebTheVideoMaker2/">CalebTheVideoMaker2</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Oracle SQL Tutorial 20 - How to Create Composite Primary Keys</b></h2><h5 class="post__date">2016-12-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/5yifu5JwYxE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone welcome back to your
oracle SQL tutorial series this is Caleb
from Caleb the video maker 2 we are
going to be continuing our little
project that we're working on so far we
have two tables created we have a user's
table and a projects table this is great
and all but it's very limiting that's
because you can only create projects but
you can't add anybody to these projects
how useful is that not at all so if you
go back a couple of videos you'll find a
video where we talked about the design
for this project and we were going to
have a project users table so
essentially it's a table that says what
users are a part of what projects so if
you're thinking of the workflow for our
project a person would create a project
invite all their friends and then those
friends or whatever could join the
project and be a part of it or they
could be assigned to it so since I have
all of these other tables I'm just going
to comment those out by going to I don't
even remember source toggle line
comments now let's focus on creating
that other table so let's say create
table and we'll name it project users
and what columns are going to be in this
table it's literally only going to be
two foreign keys so the first one is
going to be the user ID and then the
second one is going to be the project ID
now in the previous videos I talked
about naming the constraints but we're
actually going to put a giant primary
key on top of both of these combined so
I'm gonna be a sinner for a moment and
I'm not gonna name these but don't tell
anyone
it's a secret so to do that we're just
going to say references and it's going
to reference the users table and the
column it's going to reference is the
user ID column beautiful we'll do the
same for the project ID but it's going
to reference the project's table and the
project ID and I should probably learn
how to spell references I thought I got
an A in spelling one time but then I
realized that a is actually an F which
makes sense why I got that great
okay sorry that was a that was really
really lame
so here we have our extremely
unprofessional unnamed foreign keys but
now we're going to add a primary key on
top of these but we're going to do that
at the table level so that way we can
you know make up for our unprofessional
'ti so to do this we need to use the
constraint keyword and now we're just
going to name it the convention we've
been using the table name followed by an
underscore followed by PK so it'll be
project underscore users underscore PK
we need to say that it's a primary key
and then we need to say what column that
primary key is on now this is one of the
benefits of using table level
constraints because you can actually
pass in multiple columns here so the
first one it can be user ID and then the
second one can be project ID and what
that is saying is that the combination
of these have to be unique so multiple
rows can repeat the user ID for example
and multiple rows can repeat the project
ID but the combination has to be unique
this is also going to index the
combination of these columns so we're
getting like two great things in one
line Wow so let's run this command see
if it works okay there's something
broken and I forgot to add a comma right
here so always remember when you add the
constraint at the table level you need
to throw it in there as if it's another
column and add a comma to the previous
columns let's give this another try okay
you can see down here that the table was
created so we got this table created
it's nice it's beautiful but the thing
is if we ever try to delete a user or a
project Oracle is just going to bark at
us and tell us not any happening man
that's because by default when you try
to delete a parent that is being
referenced by a foreign key it's going
to throw an error and what that means is
we need to add the on delete keyword so
to do that we need to go over here and
say on delete and I think I'm going to
use cascade and while I'm at it I'm also
going to add the constraint not null
that's because there should always be a
value for this column same for the
project ID and on delete we'll make this
one cascade to essentially what that
means is if a you
user gets deleted it's going to delete
all of the rows in this table that
reference that user and the same for
projects if a projects deleted it'll
delete all the projects in this table
that reference that project and you can
see how this gets pretty dangerous when
you're always cascading things because
it is just delete everything as I
mentioned in the previous video so
please be careful with this so before we
can rerun this command we're going to
have to drop the table so we'll say drop
table project users add a semicolon and
we can just run it all right so you can
see the table was created now real quick
let's insert some data and see what
happens when we delete things I'm gonna
write out the SQL and you can copy it if
you want that's because I don't really
want to distract from the purpose of
this video so first off I was messing
around with this and to clear out the
tables I run these commands but we're
not going to need those for now so I'm
just going to get rid of those the first
thing we're going to insert two people
into the users table we're going to
insert a project and then we're going to
insert a project user so we'll start
with the first one and we'll just run
these one at a time so we got that row
inserted got that row inserted all right
so this one calls them there what's up
oh yeah that's because we reference the
user name not the ID so I need to pass
in the user name here as Caleb query
there we go we got that one and finally
let's create a project user okay we also
got an issue here let's see what this is
about
well that's because I put the columns
and user ID project ID I'm going to flip
those just to make things a little bit
more clear it makes more sense to have
project user since the tables project
users will need to drop that table and
then recreate it so let's try this again
finally we got that working now if you
want to actually see that data you can
run these select statements and I'll
extend this so you can see everything so
here's the first table the user table
the project table and then the project
users table and now the moment we've all
been waiting for let's delete a project
and see what happens done jeong-ja
there's an error okay that the project
underscore there totally didn't make
that mistake done done
no errors but now if we go back to this
project users table let's run this
command and you can see there is no rows
to return so we just deleted it doesn't
even care so overall we have a pretty
good structure for our database the only
thing we should consider is adding some
indexes and that's what we will be
discussing in the upcoming videos please
keep at it click like subscribe and I
will see you in the next video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>