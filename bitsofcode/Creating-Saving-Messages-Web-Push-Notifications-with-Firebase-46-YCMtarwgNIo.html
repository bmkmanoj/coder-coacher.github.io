<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Creating &amp; Saving Messages | Web Push Notifications with Firebase (4/6) | Coder Coacher - Coaching Coders</title><meta content="Creating &amp; Saving Messages | Web Push Notifications with Firebase (4/6) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/bitsofcode/">bitsofcode</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Creating &amp; Saving Messages | Web Push Notifications with Firebase (4/6)</b></h2><h5 class="post__date">2017-09-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/YCMtarwgNIo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so now we can get into the real reason
we're here at the fun stuff so we can
actually start adding notifications that
we want to be sent and then after this
we'll actually go and do the firebase
functions part where we send the
notification so really quick I'm just
going to create a very simple form here
so where the user can input what it is
that they want to actually send us a
notification I'm just gonna give it an
ID of send then I'm gonna add a label
that will be for the notification
message and I'm gonna add this game
reader only class because I don't
actually want it to be displayed and
that's something I have in my CSS an
invitation message then add a text area
all of this stuff for now vacation
message what would you like to see and
I'm gonna set maximum to 40 characters
because that's the amount of characters
that will show comfortably on a
notification which we will see later
that's any button which is government
let's just add the type submit' so we're
being really clear about it one I am
doing and then let's actually add a
label using area label like this because
I'm actually just gonna use an image for
the button texts actually we need to add
a div around this and this is just
because of the way I built my CSS we
need like a container around both of
these things so hopefully this should
work let's just check okay cool so this
is kind of
what we wanted here so let me just take
this and we just want to check to see
when this form is submitted
so as we've done before then you wanna
check to see when it's submitted that
takes a notification so now let's go and
create this form or this function rather
send notification so in this second
notification form what we want to do is
get the text that the user has in pizza
that they want to send us the
notification then what we want to do is
send it to our firebase database under
like a different node will call it
notifications and then with our function
it will check to see whenever something
has been added to that and then salmon
education
so for right now all we're doing is
sending the notification I'm just gonna
start by preventing the form being
actually submitted then I'm gonna get
the notification message I think it was
called that let's just make sure yeah
application message cool and I'm just
the value of that so if we go up to
where we were saving something else
let's look at this can basically just
copy this format here so oops so instead
of two notifications we I'm two tokens
rather we want to send to something
called notifications and instead of
pushing this we want to push two
different things so first of all we want
the user so the user's name and we can
get this by cool just copying and
pasting things really here so firebase
off the current user and there's
actually a value let's just go here and
see what it is it's called display
yeah so we just want to get the users
display name then we want the actual
message that they're sending which is
this notification message that we have
here and a third thing that we want to
pass is the user's profile picture
because that's what we want to show on
the notification because as you probably
know notifications have like a small
icon there so you want to put the user's
profile picture you can actually get
that here I think there's something
called yapple to URL so let's call this
user profile image and then let's just
copy this part and that's that so maybe
after that let's just clear the current
notification so let's just copy this and
just say value equals to nothing just so
there's some sort of feedback that
something has happened so let's go back
and test this out let's refresh the page
and say hello they're very imaginative
I know let's do that the page refreshed
which makes me think my prevent default
thing didn't work well let's just go and
check to see if it's there
so it's not let's quickly check to see
what has happened oh I didn't actually
add an advanced they're just really
really smart of me okay so let's go back
refresh the page and there's a toast and
let's end this and this appear time
worked because that cleared so let's go
and check and yeah we have notifications
so now we can see here couldn't see the
message I sense it's being sent from
this user and then we have the profile
image here so we're pretty much done
with the client side of this application
we've created a user and we've allowed
users to create the notifications so
what we're going to just do now is just
deploy the application so we can see
it's live and we can also have like
user to be testing with and then we can
get to the really really fun part which
is the firebase functions so to deploy
the application I'm just gonna create a
separate terminal window here what we
have to do is type in firebase deploy if
we want to deploy like absolutely
everything and as we know we have like
the database and then we also have the
functions and the hosting but all we've
really done now is with hosting so I'm
just gonna deploy only that part so I'm
gonna press firebase deploy - - only and
then I can just specify what I want to
deploy it so let's just do that
oh I've just deployed my application and
it says like we do posted 3167 files and
that's because IANA gleich that to do
one thing which is if you go to your
firebase JSON actually specify things
that we want to ignore since our public
directory is the root directory pretty
much everything here is being uploaded
and we don't actually want that so what
we can do is just specify an array of
files that we don't want to be included
in the upload for the hosting so I'm
just gonna quickly and we don't want our
database don't knows Jason we also don't
want the functions folder which is what
is really causing the issue here because
we also have a node modules folder in
there and we definitely don't want that
to be uploaded as part of our hosting
and we can also say we don't want the
firebase that JSON file itself to be
uploaded so I'm just gonna try and do
that again just to make sure we're not
deploying everything in this entire
directory so this time I went much more
quickly and we only uploaded 72 files so
I can't figure out exactly what those 73
files are but at least it's not like
3,000 miles okay so now we have the URL
for our application here and I'm just
gonna copy this and I'm gonna go in a
completely different browser go to our
application you can see it's there
so one more thing I forgot to do was to
actually hide this form unless the user
is signed in and I'll just leave that
for you to do so let's click sign in so
now I can click subscribe allow
notifications thank you then I'm going
to say hello world which is very
imaginative and that appeared to have
worked so let's go back to our database
and we can see here that we have a
second token which is awesome so it's
like different from the other one
so I'm using a different browser a
different user and you can see that I
also added a different notification so
we can have that right here even though
they're both the same name for both me</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>