<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Logging - Why and How - JS Roundabout - April 2018 | Coder Coacher - Coaching Coders</title><meta content="Logging - Why and How - JS Roundabout - April 2018 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Pusher/">Pusher</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Logging - Why and How - JS Roundabout - April 2018</b></h2><h5 class="post__date">2018-04-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/q2sys329fuU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so I'm gonna be talking about logging
obviously so but first a couple of
apologies
the first apology is to the guy with the
camera I'm gonna be moving around a lot
and the second apology is to you guys
because I was expecting to be I was
expecting to be doing this talk
preparing the talk over the last bank
holiday weekend you know finishing it up
I ended up going sailing instead on the
Norfolk Broads so I spent the whole time
in a boat in the ring which you'll hear
about in a second so I'm gonna switch
the first slide so that the camera can
sync up and this is kind of an
interactive first session put your hands
up if you talk about logging in your
code style guides at work okay in verse
put your hand up if you do it sorry if
you don't if you don't okay fine yeah so
people don't tend to talk about logging
very much which is weird considering
it's like one of the oldest things that
we do in software back when we log two
pieces of paper before us born probably
so we don't talk about logging in our
style guides has anybody ever been
taught logging best practices okay put
your hand up if you have not been taught
logging best practices no put your hand
up if you've ever thought about logging
best practices okay cool this is awesome
few people has anybody ever tested their
logs put you hand up tested your logs
nice tested JavaScript logs okay so my
name's Joseph proof I am at Joe Reeve
zero on Twitter at Joe on the slack
group for this for this kind of
community if you want my details you can
go to Joe contact me today I and the
slides should you want to find them at
that link take a picture now if you want
this title also be at the end so log
books this is kind of coming into the
sailing thing log books are really
really cool because we've been doing
this for
ages right people on boats have been
sitting down every hour when they're out
of see it's say this is our heading when
I'm writing this look this is what the
wind is like you know standard stuff
about boats and that kind of gets locked
in a box which hopefully should the ship
sink somebody else and come along and
find it the floating box that's kind of
summer on the sea they know what the
ship is they know where they were when
it all went wrong they know what the
conditions were and potentially you know
they can actually diagnose the exact
reason this ship sunk in the middle of
the night somewhere yeah and they also
know what's on it so is it worth going
and looking for it and finding all the
hidden treasure on at the bottom of the
sea but also is it worth sending out a
rescue party was it just one person and
you know this logbook is being found 20
years later so when I went sailing the
guys at the boatyard where I rented the
boat they know me I've been there for
awhile they said since you've had loss
had this boat these are the things we've
changed the bilge washers so the bilge
is the the bit of water kind of
underneath the floor so there's a little
kind of it's called the bilge a little
bit of air that water can go into and if
that gets too full water starts coming
up through the floor and you start to
sink basically but generally boats are
always slowly sinking and we have little
pumps that take the water out of the
boat they also change the countertops
lovely we've got these nice granite
looking countertops now which is
brilliant they changed the water heater
which is cool because now we get hot
water and they change the engine they
also changed a bunch of batteries and
stuff so they said to me seeing as we
know you and seeing is all this stuff
new when you're the first hire of the
year which at the time I thought was
great now I know it's not seeing as
you're the first part of the year the
first one to use all of this cool new
stuff could you keep a log of the bilge
pump how long do you hold the bilge pump
for so the whole whole day went really
really well I got back on Monday evening
except the countertop fell off and broke
four bottles of beer the beer from the
bottles then went into the bilge
the water heater used up all of our
water when it shouldn't have and put all
the excess water into the bilge the
engine died which was fun in the middle
of nowhere and then it rained on stop
and does anyone know where the rain goes
in a boat say it out loud
into the bilge exactly into the bilge so
this was me in the rain with a cup of
coffee it's kind of ok so now let's talk
about JavaScript logging because that's
why we're all here right well that's why
I'm here at least JavaScript logging is
cool because it's kind of not done very
much but there's loads of kind of prior
art so ask JavaScript developers and
lots of developers have a really really
nasty habit we tend to reinvent the
wheel over and over again has anyone
heard of web workers all right that's
threading accidentally reinvented badly
or worklets which is reinventing the the
actor model but without having the name
so you can't Google what it is but kind
of the time when I had the red pill you
know I mean matrix tile I started to
actually think about logging was when I
was talking to a friend of mine Julian
who's at the back on his phone so he's
doing a lot of work in analytics and
logging software a lot of Android stuff
and non JavaScript stuff but I went over
and I had a chat with him and we talked
about logging for 3-4 hours and this is
the first one would actually talk to
someone about logging because surely
like console dot log it worked
you know console dot log debug hello so
I talked to him about about this and it
wasn't boring which was the first thing
that surprised me talking about logging
wasn't boring and then I went to work
the next morning and saw this log this
this statement this bit of code and I
was like what get blame launch missiles
kill them
who on earth did this which obviously if
any of you have ever done a get blade on
a piece of code that looks rubbish don't
because always you that wrote it so I
was looking at this code now thinking
this is bad this console dot log state
is bad and I have no idea why it's bad
right just no idea I just I know because
I've had this long conversation but I
don't know why it's bad right so I
started looking for other things console
that log error error message right why
is that bad come to it consoles of error
fascism that is has anyone here ever
work with a Hungarian yeah a Hungarian
programmer yeah put that into Google
Translate the polite translation is oh
 and then constant that log finish
that date dot now does anyone know what
date dot now outputs a bunch of numbers
right not human readable so I was like
these are all bad all of these hundreds
of log statements in this code base that
I'm responsible for are bad you know I
can't look at the the logs and know
what's going on know if the systems even
okay let alone if the users are okay and
these are systems running you know the a
couple of layers down people are trading
half a million pounds on a day or are
deciding whether or not to run trains
like these are dangerous systems if
things go wrong luckily this isn't
directly it but this is kind of a couple
of layers away so I kind of thought
about it for a while and I thought there
are four dimensions for things that you
can kind of focus on you can think about
specifically that make a log good or bad
so you've got context what's going on in
the app what's the data what's the time
what's yeah we'll come back what's the
purpose is it for debugging and I'm
going to I think I'm going to delete it
before I commit it is it for auditing
you know we did have this many users log
in and the product owner knows it and
they went to these sites and they did
this and this and this is it important
is someone about to die is someone about
to lose half a million pounds or was
there a garbage collection of it and the
format is it human readable is it grep
herbal you know grep unix grep yeah can
I just grab my logs and see every time
this dog user logged in or can I get my
logs
see every time there's an error every
time something went wrong the purpose so
we might be doing analytics which is a
kind of logging I promise you you can
ask me about it later
the purpose is it for debugging or is it
for analytics improving the user
experience did someone die did someone
as log in was there a garbage collection
event you know is it scannable
is it possible which is really really
important if you're using something like
log stash single had a log stash it's at
all you know elastic search guys for
dealing with logs
so that's contact purpose importance and
format they're all things that are
important when we're writing logs so
none of this stuff is new you can see
examples of all this stuff in log4j
which is a Java logging library which is
kind of industry standard for Java stuff
the syslog standard which is kind of has
bits of bits of stuff just look it up on
online countly which there are some
stickers around somewhere they had a
chat with the CEO and he sent me some
stickers which say open source rocks
which is cool so they're over there
somewhere
and that's just a tool for you know
logging events logging errors logging
different things to a remote location
from the client or from other languages
log stash and good old console dot you
know we've got console dot log error
warn info different kind of levels
importances and then we've got things
like timing and profiler loads of really
cool stuff just open dev tools like
console dot and look at the intellisense
really cool stuff so this is an example
of a bad format of logs has anybody seen
this in their log files where's your
hands have you seen something like this
in your log files yeah someone should
log down some array and you just got
object object object object takes up
hundreds of lines of logs and yeah you
know you kind of lose the context so
this is this breaks any context you've
got a good format is showing the user
that logged in wrapping things in square
brackets makes things really possible
they're surprising I mean I'm going to
say regular expressions right but if you
need to do something quickly regular
expressions are really handy or wrapping
the thing
using variable equations logging errors
instead of doing console.log blah era
dot message just log the actual error
not appended to a string and they'll
actually display the whole stack trace
which is lovely and this is this is an
example of showing context this is IP
addresses so we're showing context of
where this stuff happened from which is
important when we come to this kind of
thing right user logged in user logged
in user logged in error got data pretty
rubbish because we don't know what's
going on this means a lot different
right so we've got the same user logged
in five times within one second either
we've got a bug or we've got a bot right
both of these things are important and
if you've got your IP address you can
start looking at the IP address is it a
real user is it some kind of bought
scraper we've had that a lot
stealing lots of valuable data they pay
for one user in there they've got their
BOTS going off and downloading huge
amount of data so it all depends on the
goal the logs that you actually use the
logging statements the logging context
the data I can't just come up here and
say log the IP addresses all of the
users or whatever you know I can't say
log this log that because it depends so
much on your individual context on your
application on your users and on what
you're expected to provide for your
customers so it depends on the goal has
anyone read the goal by you like Oh Grob
know what okay first thing you do when
you get home go on Amazon all of the
goal it's about Kanban management or
something but it's really really good at
helping you understand where in an
organization developers you know
developers fit and how they can help
with why organization so there's this
thing I made up this morning called the
logging type table and basically this is
talking about the different types of
logging the different reasons you might
use a log statement so we've got some
things it's a bit small different
different types of logging so there's
there's something called tracings anyone
heard the term tracing before yeah okay
so tracing is often used for debugging
it's kind of logging function in
stations or individual variables and
just for really when when there's some
bug that you're looking at so the
question it answers is what happened you
know how do we get here
what happened what did the user do to
get to this point or what data came in
to get to this point and we usually lock
the state changes and function in
vacations and it's targeted at
developers so there's anyone heard of
event logging fairly common term event
logging it's analytics it's
understanding what's going on inside the
app is that a user doing specific things
or is it the application doing specific
things so what's happening actions and
exceptions and it's useful for
administrators product owners and kind
of us as developers we know which bits
of code to specifically improve progress
logging which is something that probably
we don't think much about this can
actually feedback to users of
applications has anyone ever used DD
units tall DD for jams
that was your DD what has anyone ever
moved an image file not a dot IMG onto a
an SD card for like a raspberry pie or
something Wow okay so DD is an example
of bad logging because you press DD and
it starts copying this three gigabyte
file onto an SD card and it just sorry
the command did it yeah the UNIX utility
yeah so DD you type DD this big file
onto this SD card which I haven't used
in three years maybe it'll work and it
just sits there staring at you blank
right no logging no explanation of
what's going on it just kind of sits
there and then come back in half an hour
and hopefully it's worked right so
that's that's kind of induces a lot of
anxiety in its users so the question Oh
so progress logging is all about
answering the question are you okay are
you still working have you crashed is
there anything I can do to help
basically so we kind of log percentage
of progress what errors have happened
what's going on
targeted it users because this can
bubble up to some application if I click
a button in on some website and it
starts churning away chugging away and
doesn't load in five seconds I'm gonna
hit refresh right but if some pop-up
comes up and says this is going to take
a while we're loading the page for you
we're aggregating the data then you're
more likely to kind of wait for it right
so then there's audit which is kind of
something that we really really don't
think think about much which is kind of
very verifying that the behavior of the
application is correct you know did when
my bank sent money do they log saying we
transferred this much money from this
account to this account and this
accounts you know amount of money
decreased by the same amount and this
account increased alright this is kind
of double entry bookkeeping what
constants do is they just look at the
data from different angles and they just
make sure everything lines up and this
is something that your compliance
departments my needs the government
might want my GD P R type stuff and the
rest of the business might want because
they want to know how many uses of work
you know using the tool is the number of
subscribers going down every month which
is obviously a bad thing yeah so that's
the the logging type table so purple
slides again we're nearly at the end
don't worry I'm just going to wrap up
the sailing stuff so oh no I'm not I'm
going to do this instead
so the log and golden rules the three
things to consider when you're writing
logs and then I'm gonna wrap up the
sailing stuff
remember the reader so this is who's
reading the data is it going to be
passed are they going to be unable to
understand what's going on do they know
the context no personal data no
passwords I've seen that a lot no
passwords no usernames no email
addresses depends on the context
obviously and then answer the question
think about what question are you trying
to answer with these locks are you
trying to answer how do we get here are
you trying to answer are you functioning
correctly are you trying to answer
answer this random question that the
marketing guy said hey I'd really love
to know how many users log in every
three seconds or every three days right
if there's some specific thing that
that's kind of the question and you need
to make sure that that's understandable
in the logs itself okay sailing now
we're on sailing so this was my log that
I kept in a book with paper and pen
I mean hardcore stuff right so there are
a few things that we can we can kind of
keep take note of that we can actually
learn so this is event logging this is
me saying I did this and it happened for
this long so this is when I picked the
boat up yeah you can see that oh well
the day I picked the boat up and the
first time I ran the test and it ran for
kind of three seconds then you can see
something went wrong because suddenly my
bilge pump the thing that's supposed to
stop me from sinking takes 12 seconds to
do its job and then some engineer came
in the middle of the day you'll see by
the arrest of the logs that it's kind of
a weird time in the middle of the day he
came and he fixed something and then ran
it for ten seconds so this is an
abnormal log alright so something
different happened and then you can see
something went wrong it's not
immediately obvious but if you're kind
of displaying this in a graph it's quite
helpful that I actually missed the
morning here I missed the morning on the
2nd of the 4th and that's because ah we
have more issues with our wart eater and
suddenly worrying about actually being
able to drink water was more important
than than measuring
how long our build comment ran for so
that's something else went wrong and
then that's when I ran that just before
I dropped the boat off so another
interesting thing is after the the tests
are after the guy fixed it these tests
are all very similar even though the
amount of rain changes right so the
actual test runs change so don't change
much sorry which means there's probably
a lot of overhead in the pump from
spinning up right but there's a lot of
overhead and you can tell because the
values are similar not because they're
different
so similarities in locks is still really
really handy ok that's it
you can drink more beer eat more pizza
cool
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>