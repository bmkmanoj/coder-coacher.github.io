<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to hook Pusher up to realtime Smoothie JavaScript charts | Coder Coacher - Coaching Coders</title><meta content="How to hook Pusher up to realtime Smoothie JavaScript charts - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Pusher/">Pusher</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to hook Pusher up to realtime Smoothie JavaScript charts</b></h2><h5 class="post__date">2011-12-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/VLTsT30TZYw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">from the previous screencast you'll see
that we've got this information which is
just serialized civilized object in the
UI what we're gonna do now is we're
going to update the UI so that we've got
a chart that displays the information
it's not yet being consuming information
from pusher but it's obviously we get
the UI working and all the code working
then we can see that's being pushed in
so the first thing we want to do is
shift this because because the AC ones
get a bit cluttered now we'll shift this
into this JavaScript section over here
which is quite a handy and we'll also
put it in a kind of an onload block or
on content ready so you'll see on the
right-hand side that this is updating so
every time you're making a get jsbin
updates the current view so that we can
see what the result code looks like okay
so that's everything still working we
can go over here we can send the event
you'll see the event appear over here on
the right-hand side so the next thing we
want to do is we want to start using a
smoothie chart so over here we got
smoothie charts there is here's the Java
Script floret so we'll include that
okay so that's included we also need a
canvas element so let's take this canvas
element we'll call it Twin Cities so now
we've got a canvas element we've got the
smoothie charts JavaScript library and
then the page can now create a smoothie
object and we want to add it at the UI
for the the chart to the page we'll get
the actual element rather than the
jQuery object for the time series okay
so now we can see the UI we got the
scrolling background to give it the time
effect the next thing we want to do is
actually plot some information so we'll
get out to this event handler
more quiet function specifically for
that so we know from the JSON that there
are multiple devices you can see in here
there are multiple devices within the
payload of Jason so what we'll do to
start off with it we'll just take the
first advice and then we'll create time
series for that and the way it works it
is you append data to the time series so
the first parameter is some time now and
the data is obviously the actual usage
so a device switch and then final thing
we want to do is we need to obviously
add it to their smoothie chart so we've
got the code there but how do we test
that it works so we can obviously go
here send an event another event
jump back here we've got a value but
there is no danger ring
okay so what I think the problem is here
is that there is a line at it but it's
white and it's right at the top which we
obviously can't see because the border
of the smoothie choice want so what
we'll do here is we'll add some fill
color to the series so I've got a
predefined function here which I can use
which gives us an RGB value for the
stroke and an RGBA for the fill colors
and then here i can i can add a stroke
style style about 14 warnings which
isn't a good sign okay
so yeah so we get our you right back
and if we know sent a test event
you still didn't any colors
okay we also need alignment okay so
they're the two different events you've
Center so I click twice I've got two
events said the problem we've got there
is the weekend we've obviously got two
time series appearing the other thing is
that it's now I said a little bit tricky
to be jumping across to the event
ammeter in pusher and push your
dashboard so while doing that is I'll
actually add a function here that helps
us to test that so the solid blue peter
is something created earlier so this
sends a test event on the channel so
this this channel that we have defined
here it emits a and usage updated event
with this event data the other thing we
should do is let's have some UI to
trigger that to just make it a bit
easier to use
I'm also I accept under FOIA
okay so now we've got this test button
up here and we should be able to click
there and we'll see that because we're
actually adding new time series every
time rather than depending to them that
we're getting natural new series
appearing on the chart so we don't want
that what we want is we want a way of
finding time series for each of the
devices and then just appending to them
so what we'll do is we'll strip this
piece of code out will create get a time
series function and we'll pass in device
dot name you want to keep the append
part okay so we want
series name so if we have a look up this
will be of name to time series object
first we try and get the time series
object from this look up my name and if
we can't find one for it then you want
to create one so we create any time
series object we add it to the smoothie
chart and we also need to add it to the
lock up so that when we try and find it
next time it
it is present ok so some taxi
nomadic or depend because we need to
return time social object okay this time
so now every time we send on these test
events you can see that the time series
times they updates okay so the next
thing and final thing to do is we are
only plotting one time series for the
multiple multiple devices so in the pot
usage series what we need to do is lets
us create a new function specifically to
plot the information for just a single
device
we factored that slightly it still works
now instead of taking this first one we
want to loop through all the devices
so we just need to follow
instead of getting their first element
in the array or get the one within the
lid so this time we should be plotting
in here we've got three devices so every
time we get an update we should be
plotting I should be adding new data for
each of the time series so for the three
times series for the three devices so
you can see now we've got three lines
three - the time series for each of the
devices so if we let that go for a
moment and then I go over to the
dashboard he is introduced rate I go
there and send an event sent through
you'll see
by the way that it's curved up his end I
was from pusher with a percent okay
that's that screencast complete so in
the screencast we showed how to update
the UI that was just showing some JSON
to use smoothie charts to start off
where there was no data we then added a
single time series which represented a
usage from one device we then updated
the code so that we updated a time
series rather than adding a new one for
each event we then made a change so that
multiple time series were created for
each device and the usage of each device
and then we showed how to trigger events
in code and then through the event
creator with in pusher the next thing
would obviously be to show how to
trigger events from a service or a
server may be something that's hooked up
to some real real electronic components
that are using electricity or you know
electricity monitor itself my name is
Phil Leggett ah I'm a developer
evangelist at pusher</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>