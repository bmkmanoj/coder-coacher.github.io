<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Vienna.JS, Make your Google Apps talk to each other, April 2018 | Coder Coacher - Coaching Coders</title><meta content="Vienna.JS, Make your Google Apps talk to each other, April 2018 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Pusher/">Pusher</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Vienna.JS, Make your Google Apps talk to each other, April 2018</b></h2><h5 class="post__date">2018-04-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/HOZIRh1q3d4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone I'm very excited to be
here today because this is my very first
talk so please don't throw this Russia
left on me if you don't like the talk
but anyways I hope you will I'm here
today to talk about how to make the
google apps talk to each other I studied
computer science at the toe and I'm also
a Google developer group organizer in
this instance Lakia and that's how I
basically got to make this talk because
I had to face some problems I'm going to
talk about them later and I also work at
we're developers and I support the
program team so what's the story behind
as a GDG organizer in eastern slovakia I
run some meetups and also we organize
conferences and while I was doing that
I'm the only women in the team so who
would else do a communication with
partners and speakers it was me and I
had to ride like a million of email
sending reminders scheduling the talks
asking for configuration then again
sending reminders and waiting for
confirmation and there was something
that just dream has driven me crazy and
that was me I looked exactly like that I
hated to do this and I was questioning
myself okay well we are GDG we are a
nonprofit organization we can't really
afford to have some speakers management
tool and I told my colleagues hey guys I
really can't work like that we I have
million other tasks to do which are more
important than this and this is just
like very very time-consuming and my
colleague was like what if I told you
you can do it yourself how can I develop
a speaker management tool in one week we
need it urgently and he looks me like
that
well you never heard of Google Apps
scripts so Google Apps Script is a
technology I would like to talk about
today and these Google Apps app scripts
are based on a JavaScript concrete with
JavaScript 6 and they have some features
of JavaScript 7 and JavaScript 8 as well
so first I would like to ask you how
many of you are using g-suit apps or
google apps racer ends up everyone
very cool how many of you have heard of
Google Apps scripts yes ok
if you feel like everything and things
talking about something which is not
true just step in or you know feel free
to do to step in okay so first I would
like to invite you to follow this link
or scan this code in order to make this
session more interactive because I would
like to make a roleplay with you that
you're gonna be the speakers applying
for my conference and I'm the organizer
who checks the top proposals and decide
what talk is going to be accepted and
which not so this is very short just you
don't have to think of like a real title
of the talks of course just put themself
but there's some random string or just
like talk your health before or you know
just just so you you really get the
feeling about this technology and also
please in email address I would like to
ask you to feel everything in lowercase
because otherwise it's not gonna work I
found out like half an hour before they
started because I was always putting
inside like the rights and also the last
field is your mother tongue please fill
this in because there is gonna be very
cool feature regarding the this this
this language I'll give you a couple of
seconds a couple of minutes to to fill
this in okay so I will start now so from
this Google Form we are getting all the
information to this Google sheet and
this is going to be our database and we
are going to execute the Correll
operations over it so first of all I
would like to go through the agenda so I
will show you how to set up the
environment I will show you how to code
your own menus your customized menus and
also I will show you how to set the
triggers which are executed which are
then like calling the the functions you
have there I'll also show you how to
send the emails from Google spreadsheet
how to connect it with for the document
how to translate the content then I will
show you a little bit of advanced HTML
service and in the end we will send the
calendar invitation for your talk so the
first thing I would like to show you
so how do you think this Google
spreadsheet is going to be stored in
JavaScript no not in this case this in
into the array to that diamond jewellery
so how do you set your environment we
have two choices you go to
script.google.com where you have other
projects you create a new script in my
case it's already this one or you go to
tools here you have the script editor
and in this case this script editor will
have a special relationship to your to
your to your spreadsheet and in this
case you have to think of two of one
thing and that's when you want to create
a special menu here you see that's my
menu I created this this manual show the
cotan this must be the bounce a version
of the script so it has to be created
from the toe and script editor or not as
a standalone so that's the only thing
here then the other thing is that there
are these triggers there are four types
of triggers it's on open on edit
do get and do post this function for
example is called whenever the script
whenever the spreadsheet is opened so
basically I open the spreadsheet and in
a little case there should be this
manage speakers automatically in this
open app open I'm creating a new menu
which is called manage speakers at item
which is reject and it calls this
function reject speakers about this here
I will talk a little bit later or I can
talk about it now so basically there is
a nice work around when you want to call
some functions from the from the
spreadsheet from its menu which is
basically written in the in the bound
script editor in the bound script and
that you basically saved
the standalone script as a wait I'll
show you like you go to project
properties and here you have the project
key you'll send save this project key
and set it as a library of your bound
script which is here you only add the
the key here and that's hidden you're
allowed to call the functions like this
from some other script so finally I got
my talks Wow quite a lot amazing and now
I would like to let you know that I got
your talks I really appreciate your time
you put into the filling this form and I
will send you an email to do so so I saw
the function
I say confirm proposal received
who got an email raise your hand up it
works so great now we see here that the
flag is set to us in our function we
have yes so here is the function country
proposal I'm building the string the
message I would like to send you
I just iterate through with the first
light for life through the dock through
the dock I take every row and here I
save my cell where I have the
information if the if the email is
already sent so this confirmation is
sent cell is this variable here and in
case this confirmation is sent already
then just continue do not send email
again so I'm getting the recipient
recipient first name message greeting
and here I just added like the Google
developer group team and now comes the
most important part I use mail app which
enables me to send the email and forget
I only need recipient this is the
subject and is the message so that easy
it is and at the end when everything is
fine I will just set the flag to yes so
I don't bother people with the same
email like 50 times and the super thing
here is which I forgot about to say is
the triggers you can have two types of
triggers so this one was in my other in
my bound script so on open so
immediately when this sheet is opened
you will also call this on open function
and the second way how to set the
triggers is to go to edit other triggers
add new triggers and come for proposal
received for example so you you choose
here which function would you like to
trigger with this this thing you can say
okay this should be time driven and you
can also choose like how
often should this function be cold so I
say I would like to have it every minute
now because I think that probably my
some thoughts might come so I'll just
save it I'm not gonna send it again I
think do you want me to send it to see
how it works probably I'll just do it
some of you and then one minute you will
get the email again so I don't spend
spam all of you so this was the first
use case sending confirmation email now
I have the Google spreadsheet and I have
the top descriptions here and in usual
case you get the top descriptions long
around 600 words so it's not very usable
to read it here and to decide about
talks here so what can we do does anyone
have an idea how can we take this
information and put it to some Google
document and also we don't want to have
the first name and last name of the
speaker because we want to be really
objective when we choose the talks there
is now a nice way how to do this and I
will first show you how it works so I
have the empty evaluation doc here which
is in my drive now I will call the
function feel evaluation doc I run it
running running running and here we go
we have it all filled we have around 21
speakers here and now we can read
through it and decide who is the best
one so let me decide let's say that I
will first reject everyone okay I
rejected you and now I will say sorry
guys like there is a very high
competition we couldn't take all of you
we couldn't accept all of you
so reject
did anyone get an email because I got
okay
okay so now I have a problem let's fix
it so translation between the given
language is not currently supported okay
that means that some of you didn't
fulfil the criteria great now it should
work so let's try again
I'm not sure but it's not language guys
it's okay I'll have to think of another
way how to make people feel this okay
let's try again
you know like first or question to go
everything well you know like I'll just
keep it
sorry
you received yeah all these people
before you received but here then there
is apparently some problem and email
can't be sent and this English I think
that the email is kind of not it's your
email hmm okay
and did you did the rest of you get the
email is sorry I'll just make it German
well okay for now it doesn't work it's
interesting because it's always worked
so far so what is written in the email
you got the rejection yes it's exactly
this what I need yeah
and then there is a special line can you
please read it aloud and is it in
English okay because you did anyone else
has the mother tongue something else
except for English yeah exactly
so what happens I rejected the speaker I
again went through the world doc I got
my problem but the most important thing
here is this single single line here I
use the language app which enables me to
translate something to from from English
or my source language to the target
language with language which is your
mother tongue which is set in the Google
Doc isn't powerful when you want to
reject a speaker he will be very upset
and at least you can like you know make
him feel better with some very
personalized message and again then you
will just set this decision is yes so
you don't bother again well now I would
like to accept all of you let's try it
out this is gonna be No
and yeah let's try it
accept speakers let's check the flag
okay
okay so some of you again didn't get the
email interesting yeah I think that the
problem here is because I just got an
email that this email here is not so
let's try it like this probably that's
the problem
okay so who got the email okay can you
please read what's inside okay so there
is like dear someone you're accepted and
there is a link inside if I click on
this link I will get a webpage which say
we are happy to have you at GD GD fest
gosh it's a 2018 please sign this
memorandum of cooperation by signing the
document you agree with the terms and
conditions and you also confirm your
attendance here by you agree to have the
talk this talk and now when I come back
to my seat I see that you already
clicked on it so you got four exact I
can show it for the people who don't
have it so status is now signed and also
in my document the talks and the people
already confirmed that they're coming
and they agree with the all the
conditions and and they will really
count for sure and how did I do that is
it doesn't differ very much from the
previous emails there is only one line
which says generate URL i parse here the
the idea of the speaker so basically his
number in the in the sheet also his
first name and email and with this
function i create this URL i'm sending
you in the email so i say i call script
app i'll get the service and get the URL
of my web app which is published here by
deploy as web app I have here the the
URL I sent you and I just append the the
name email and number of the speaker
here by you are enabled to click on the
link and this gallery direct you to my
web app here is how it looks like so
here is the do get trigger I was talking
about in the beginning so as soon as you
click on this link this doget function
will be executed I'm getting all the
parameters I'm getting the
and the number of the speaker here I
will need this cash for later on so I
will just keep it for now and here I
just check if name is if expected name
so from this from this parameter is not
the name as the name in the sheet then
just throw some problem could not load
the data sorry in case in my sheet this
memorandum is already signed then say
thank you very much the memorandum is
already signed so the ones who got the
email you can click on it again and you
will get this page so I just see here
sign a memorandum refresh thank you the
memorandum is already signed ok so the
next step is what happens if the
memorandum is not signed yet I'll just
create a new object speaker push it to
my array and then templating team
fighting is very cool Fink which enables
you to have your your HTML file for
example demo confirm attendance
connected to your web app with HTML
service service where you use the method
create template from file and then just
set an object to your template and then
it is important to say that this to get
method it must return and HTML output
this is what I have here is not an HTML
output but with this method evaluate he
is going to return the HTML output and
what happens in my in my HTML file is
that I have basic HTML page but here on
click I'm calling this clients servers
this function which calls them the own
open signed which is the the server
function here and is executed exactly
here so this function
is responsible for updating the value in
my spreadsheet and I said when you click
on this link you are giving the
parameter but this parameter is needed
in order to update the spreadsheet so
therefore I have my cache here where I
just saved the number from here and then
I'll just just get it from from cache
and can use it again so after all of
these things are done
I can finally send the calendar
invitation to my speakers which I do in
the following send invite to accepted
speakers just click and you guys should
now get the calendar invitation for for
the talk so let's see yes because there
is a constraint that everything must be
yes we're and I want to call the
function
so I can show you what I get here so I
got this email staged a seven everything
you need to know when you're developing
Java Web Apps Tomcat ables SF spring
security and is exactly on the timeslot
I chose so this is how it should look
like and how do you do this is this
special calendar up here where you get a
default calendar and you just create an
event and you give it the parameters
with the title the date the the the date
of the end of the talk you also add the
guests which is the recipient or the
speaker who applied for your conference
and also you can choose if you want to
send these invites or not so this is my
boolean variable here sent now I have it
too yes and location and description of
the talk and at the end if everything
went good you'll just set the value to
yes again so that's all from my side
thank you very much for attention sorry
and didn't work properly I I swear it
worked before</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>