<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Share those Dependencies - JS Monthly - April 2018 | Coder Coacher - Coaching Coders</title><meta content="Share those Dependencies - JS Monthly - April 2018 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Pusher/">Pusher</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Share those Dependencies - JS Monthly - April 2018</b></h2><h5 class="post__date">2018-05-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/T_KYJ4jElF8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">a little bit like me I have two sons I'm
quite young I have a beautiful wife I
used to play poker online for full time
which was quite a fun experience we can
chat about this as well and I've been
from business to software engineering so
I used to run family business to go with
my brother
I've learned a lot about how to think
from a business perspective but I found
myself to be more passionate about
building things and especially building
software so what have I talked about
I'll talk about three things one is mono
repo or micro services like these two
things have been floating around for for
ages I don't think this has been solved
yet but like there are good good rules
to like follow like good practices then
I'll chat a little more about my
experience with dependency sharing and
finally tooling that at is around that's
built around sharing dependencies and
much basically maybe micro services that
helps with micro services so mono repo
and micro services I defined one rupee
mono repo as multiple related projects
hosted in a singular repository that's
like most of the things will be built
around this definition you can like find
different versions of that online so
don't care about them this is how people
usually think about mono repos and bio
is my son so like this is how people
approach monitors and that like vrv
smaller lifts which is like a bad thing
and there's like plenty of stuff and
then everything's tangled Alston reality
doesn't need to be the case so download
from Microsoft did a way better job of
explaining the benefits of money repos
man then I could ever do so I just like
shamelessly copied his ideas so
simplified organization dependencies and
cross projects changes are three main
things so especially if like cross
project changes is something that we've
experienced at nested a lot in terms of
organization like things living in one
place and you don't have to get clone
and like go to other places and figure
out there did I there do I have to like
open this and who do I have to notify
like this helps a lot as well and
finally dependencies you don't need to
duplicate from like everything's living
in one place and you just like use those
same dependencies there ever need them
so that that helps that definitely helps
out a lot some big names using
using mana repo so Twitter Google and
Facebook are famously the biggest ones
nested is among the big names just like
put it in their micro-services so I
define micro-services that as projects
that that each have their own repo so
like repo per project or project repo
how they like it
so Martin Fowler who here has heard
about Martin Fowler raise your hand
yeah good bunch of you so like if you
haven't heard about this guy definitely
subscribe to his blog and anything that
he writes is usually really good he's a
chief scientist at Fort works
and again I've shamelessly stolen a
bunch of his ideas he's like I didn't
want to focus on the money repo versus
micro services like much more smarter
people have talked about this a lot I
don't want to just like fool myself that
I know more than them so Martin Fowler
like my main benefits of micro services
is but they have strong module
boundaries so it's not like left mono
repo it's very easy to like couple code
and like import stuff from there you
shouldn't import things if that micro
service is like you have to make Network
calls like
depend on them somehow like import
packages and that's our stuff so it's
not that easy to like complex things
independent so that's not a very good
feeling so like if mon repos you have to
deploy everything you don't have to do
this but like that's usually how it goes
you just deploy this one big things like
multiple services in one go there's like
50 micro services you can like get
individual deployments and there's a
whole load of benefits that come come
with this flexibility of being able to
deploy every single thing individually
and like technology diversity is a big
one so like if micro services it very
easy to mix and match different
technologies and like pick the right
tool for the job so if you have some
like data data work that he needs to do
you probably choose Python for for very
like extensive libraries and and good
calculation this there's like for for
front-end you obviously want to want to
have JavaScript and like for for
back-end depends on what back and you
have like you want to be able to mix and
match those technologies without having
to worry about like Oh
will this fit and a single repo so
different technology choices are usually
the things that lead to micro-services
so big names b-behind microservices
Amazon eBay and Spotify are like 5
biggest ones for most Feldman's nested
is also like that big name that's using
micro services like yeah and I'll chat
about users with Morris too like why did
I put myself like myself and nested in
both mono repo and micro services so
that's like a fling but I'll talk about
so which architecture to use and this is
like ma this is how I looked and I've
asked this question so good thing is
that Martin Fowler has talked about this
and gave Gabe like really good general
guidelines as to how the approach phase
and first fingers start with mono repo I
usually had some natural way to progress
you just like build things as they come
up and you don't really have clearly
defined project boundaries don't really
know how do you want to split them
unless you are using totally different
technologies like usually your choice
should be just like put everything in
one bucket get it out as soon as
possible and test that's bad idea if
your startup there may be circumstances
when you then you don't want to do this
but like these are very specific and
usually if you add those start
circumstances you know about them so I
don't want to give an escape hatch to
people to say oh yeah but my
circumstance is different so mono repo
is usually a good tag good choice to
begin with and while using this mono
repo you'll figure out project
boundaries so you'll learn more about
like what each of these services do and
like how do they differ from each other
if they do or not it'll be much easier
to like move things around lots of stuff
and finally then you know okay this is
like completely different thing it has
you feel the pain point of having them
on the repo and like you actually have a
problem that this thing says together
with other things this is when you want
to like split it out and like peel it
off and like nicely packaged into a
different service and like branch off to
like have a mono repo in like a single
service and like maybe more services as
you go
a good reason like an actual way from
Munnar you pose like a good reason to
start with Minori poses but
microservices
incur a service premium again another
thing that Martin Fowler talked about
and basically just by doing micro
services and having different projects
and that you have to manage you incur
micro service premium which means that
you have to manage like there's more
operation complexity and managing
different projects and having to like
deploy them separately but that is a
benefit but that also is a cost that you
have to like deal and account for and
like the time mon repos become more of a
pain so this is like their micro
services come in and this is like the
whole premise of micro services is but
you have these isolated projects that
can like live independently and become
easier to like reason about and and deal
with and work on so my experience that's
like so like this was the conclusion of
like how how would you go about your
argument like my III support Martin
Fowler and but start with a mono repo
once you know exactly what you want to
branch off and how do these projects
differ peel them off and like start
doing micro services so this is my
expressive dependency sharing at Nesta
specifically so I'll talk about two
things I'll talk about micro services
which right now is like two websites but
you have on the two different domains
and mon repos like forever nest which is
an internal internal tools up and
back-end services which 11 amore mono
repo right now so then I've started this
I was like quite young and I really
didn't know what's the better better way
to go so I've just picked up a cool
thing which micro services at the time
was like the cool thing to do and
everybody did them so like oh yeah we
have to split those things so I just
Stanford micro services and like I've
decided we need to split this NASSCOM
and other than I started calm because
like we've talked about in the future we
still be like two different things so
one will be an a static site
and the other will be a more user
focused user portal it's like we've
created two different free posts and
like we've started bashing code and like
writing besides so as soon as like we've
started doing that problems started
happening so a bunch of code needs to be
shared between these two so like all of
them major building blocks like buttons
menu different like stars for for having
all of that needed to be shared that's
cool that's not the problem I can like
publish an NPN package for that so
that's what we did and now we have like
an NPM package to manage and like update
versions they're okay but we can build
that then we've like we've built a nice
library for ourselves so like I deal
with CMS calls like it's not not even
though I would like a a couple of lines
of code but help you wrap your
components in a high order component
that fetches data from our headless CMS
so now that had to be reused between
these two apps and like oh yeah
so now I need an another and game
package to like share these two things
because like AB dot Nestle's come you've
never realized that feel need by CMS but
turns out that for some pages like a
thank-you page or like a your valuation
report we want to share B styles so we
want to share the CMS calls we want to
share content and turns out but a lot of
things we want to share between these
two projects although in the beginning
we before that fist to it will be like
completely separate and we already
showed us that that was not the case so
even now we have these like me
harvesting projects we have two extra
NPM packages that we have to like
maintain and every time you want to
update them like we have to update the
package and like Boompa versions there's
like a fifth sort of really repo was
born out of that which was basically an
archetype using a builder tool which
I'll talk about a little bit later which
basically was an attempt to simplify all
of the tooling but his behind this like
alpha testing frameworks like like just
babble configuration CSM configurations
we wanted to like share that so now
there's like the this fifth package that
we have to like maintain to like have a
common tooling across all these like
projects
then when you think about it this could
have been a single repo with just like
to build paths like that the main reason
like when I think about this like the
main reason was that why we had these
two different websites on the different
domains was like I didn't really know
how to build an app that would be served
on two different domains from like a
single repo and like oh yeah let's do
micro sources so that's not a good
reason like this is an example of a bad
reason so don't do that this is the nest
this is where internal tools up so this
started as again as a separate project
however in this case this was like a
good reason to separate this out because
the boundaries very clearly defined the
nested website and that the whole flow
was totally different from my internal
tools app like this was built for a
different purpose this is used by 50 or
60 people internally so like we have a
very short small user base and we can
like the requirements are completely
different you don't need to support all
of the browsers just like have one
browser and support file browser and
that's it the stalls needs a bit
different because like the purpose of
this whole platform is different so like
there's very little things if if any bad
matt is shirt apart from maybe tooling
so I think this was a good choice to
separate this out and this is a good
reason why you want to like start by
branching these projects off because
like they have a completely different
requirements another good use case when
you want to like branch out early is
like if you're in an agency if you'd
like port for two different companies
you don't want to like obviously keep
their projects in a single repo as for
stuff so by having this like single
project we've learned from our lessons
and the next thing which is like the
nest which is another internal tool
however it's focused more on like
selling properties so the first one is
focused on like getting the leads and
actually helping the leads to progress
with us and evaluating their property
and giving a good good valuation of
their of their home the second one is
focused on like selling the properties
that the sign so basically we want to
like track the people that are coming
through to us that want to see
properties and we want to help them out
so we're this one is sharing
of things with the other tool like
styles and alpha common tooling badge
built around this like communication
with our back-end services so we made a
decision to like keep this as a mono
repo and even though that these two
projects are different sort of they
still live in the same repo and share a
lot of things and as like we'll have
time to figure out that the boundaries
between these two projects and there
does one stop and everyone start once we
have a much more clear ideas like how do
they interact if ever we have this like
then we can like make a decision to like
split these projects off and this is
another one so this is an umbrella so
this is our back-end services and like
you can see a lot of different apps
living in the same umbrella app and all
of them like could be considered as
different projects but it's much more
easy for us like kief Emmet and a single
repo and like consonantal I have noticed
even today when I made the screenshot is
that we've moved things around in this
one or a bush it's very easy to actually
like move things across projects even
like those projects are different and
serve different purposes we can move
things around very easily in monetary
post without like having to worry about
oh how does this affect all these other
services I'm doing like rolling updates
or something like that to just like make
things not break things so that's really
useful and beneficial and you can like
you can see this quite often in practice
like the as we grow as we scale and I
still learn more about the approach that
we build we want to like shake them and
having a mono repo and everything in one
place allows that allows us like new
things around more freely without
constraining ourselves with and like
arbitrarily set boundaries so that was
like my experience I think money Reapers
is like I can like researching on the
first point it's really good to start
them on the repos and like figure out
the boundaries and move on from there so
tooling I've talked about five tools
I'll briefly cover man the first two I
wholeheartedly recommend the other three
are
a bit later now I'll share my
experiences so imagex
think of images as your single source of
true for images so basically you just
upload all of your images in a bucket
and a folder wherever you usually store
them and you use links to refer to those
images so your logo is always the same
your icons are shared between different
projects you you don't have to like have
image processing in your build pipeline
or anything like that it gives you a lot
of power with being able to modify
images with carry params so if you
haven't used the matrix or like an
alternative tool I I definitely
recommend you for you to try it out and
yeah I couldn't imagine my life about it
nowadays the bender board is another
great one so depending on but what it
does is like similar to greenkeeper if
anyone knows greenkeeper but effectively
we keep your dependencies up today by
opening a pull request for you for for
every dependency that gets updated so
like they support a wide regional of
languages in our particular use case we
needed elixir and JavaScript so like it
supports those and what it does it like
updates the opens pull requests and
another feature that I like particularly
liked about it is that it can
automatically merge dependency updates
so if you have good test coverage which
we we do as nested in and some cases and
not about good in the other cases but
like the good test covers you can
actually not not worry about dependency
updates at all so you can like select I
want to like automatically merge minor
or patch updates and maybe like test
more major versions but like if major
version breaks something I your test
suit should should be able to catch bad
editing in Java so how are you come and
dependable like it saves me a ton of
time to not have to like care my
dependencies are up to date and like
opening pretty fast for your suppers one
and like being able to revert from there
nicely like it it it's a time saver and
by the way it's also made but made by
london-based guys like you can bang on
their door
something's not working and like they're
really good guys actually so it may help
out a lot we've had an issue that on
each pushed very positive like when
something changed but depending but with
rebase every single thing and initially
you'd get like fifteen pull requests
that need to like be merged if your
defenses are out of date so effectively
like you'd get fifteen new builds in
your CI Python which would clog the see
I really heavily like I've opened an
issue and in that same day we've shipped
that change but prevented that allowed
you to disable the auto rebasing office
office tool so it's really it's really
useful builder so this is what I've used
to like create an archetype to share
tools between different projects so
effectively the first problem that I was
trying to solve by introducing this was
keeping the dependency up-to-date we
weren't using the Panda but ban and
effectively this is just like a separate
NPM package but it has all the
dependencies in one place so if you need
to update a lot of dependencies you
update all of them in this one package
and you'd like just bump that version of
a package in different projects so this
is one thing that it did quite well
they'll depend about it kind of becomes
redundant because like with good test
coverage you don't even need to care
about like depend updating those
dependencies because like you have PRS
and you can do that do that manually and
usually that's like a very smooth
process so the other thing that builder
gives you is like some common strips on
your NPM so effectively you can like do
I don't know NPM run lint NPM run build
what else tests like these are the main
things that you used it for like free
scrubs
it seems cool at the time now it's more
of an overhead than kind of thing that I
do so like builder solves most of the
problems and like hard coding free
scripts and you know package that Jason
is not that hard especially if you have
like four projects if you have more than
it makes sense like the idea behind it
was that for me double lives there are
an agency so they build a lot of
projects so we sort of want to have a
good baseline for all these projects and
it makes sense for them because like
ship a lot of projects for for a startup
or for a company that doesn't have that
many projects it doesn't really make
that much sense and there's another
argument that could be made against like
having this single tooling is you don't
always need it so like different
projects move at different paces and it
depends at each project space has like
what tools does a project need to
introduce updating like me doing major
updates can be a headache and you don't
necessarily always want to do it all at
the same time it's like the result of
arguments for just like going with plain
old Jason package the Jason and not not
having this this extra thing in there
so that's builders like I have mixed
experiences about it and definitely
check it out if while you work with
micro services it may be helpful for you
I in depending on your circumstances
lerna is another thing I I haven't used
Lerner I learned about it while I was
looking to like solve that problem of
like managing dependencies and shipping
things more easily the main purpose of
learning was to help with open source
projects which have a lot of small
projects in them so thing Babel the fall
of Babel plugins or like just before
adjust plugins it makes it easier for
them to like make cross project changes
and the thing that we have to do is like
publish pieces separate NPM packages
because everything's plug-and-play
so in these sort of cases it makes sense
to have something like learn about helps
out to that I don't know how much help
it would be with like having two two
different projects that don't really
become packages and I'll just like
regularly deployed so if somebody used
learning and more more production
production anyway have a chat with me
I'd be interested to learn more about it
and finally as is something that I've
learned while prepping for this talk
it's the summer thing that promises you
to like not have to worry about
microservices and mono repos and you can
just like have micro services but work
with them as as if you had a mono repo
seems like a too good to be true
scenario to me so if somebody worked
with it or is looking to like enhance
their micro services and just like check
this out it may be helpful
so yeah I love you mother beep or
microservices starting from on the repo
and separate and you need my experience
have really good reason to start with
micro services like a really good reason
chat with other people don't make that
decision alone just like you have as
many people as you can and usually
you'll get a much better decision but if
then you make it fit more people then
then had you made it alone because like
in a lot of cases especially for me I
just want to try new cool things and
that doesn't always mean good decisions
and tooling using metrics and dependable
like usually check it out like if
there's one thing you gonna take out
from stock use these to fit these two
tools and check out builder learner and
meta if you're working with micro
services extensively and you want to
like get get more health if like those
things so there will be other sources at
the end of the slides and I'll share of
slides as well so yep so all of a
sources you can check them out later and
off as well as like links to them as
well thank you all thank you for
listening and please give me feedback</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>