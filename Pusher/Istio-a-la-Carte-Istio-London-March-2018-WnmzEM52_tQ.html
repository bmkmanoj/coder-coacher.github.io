<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Istio a la Carte - Istio London - March 2018 | Coder Coacher - Coaching Coders</title><meta content="Istio a la Carte - Istio London - March 2018 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Pusher/">Pusher</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Istio a la Carte - Istio London - March 2018</b></h2><h5 class="post__date">2018-03-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/WnmzEM52_tQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so I've been a product manager at Google
for about five years and I've spent that
entire time working with the team that
builds our API and service serving
infrastructure and someone asked me
recently is that get is that a little
boring you're ready to move on and
Google people do tend to move around
work on different projects that
certainly can't stay on one and I said
actually you know it's kind of funny
because in the five years I've been
there everything about it has changed
and not only as Google really started
focusing externally and you know Google
focusing on cloud but all of the
technology has changed entirely so I've
been doing this now for five years I'm
finally starting to understand it even
as the technology changes out from
underneath so I can answer you know hang
out and can answer general questions
about about sto at the end and by the
way this team that built that that is
the API and service build infrastructure
team at Google they built all the stuff
that serves all the api's you know all
the internal services you know it serves
the Maps API as it serves all the cloud
API is Drive YouTube Gmail all those
they then about two or three years ago
we started focusing on external products
and after the first open source project
we did with GRP see how many people know
what G RPC is how many people using G
RPC oh it surprises me yeah that's great
we have a commercial product called
Google Cloud endpoints we bought a
little company called apogee about a
year and a half ago and and then the
latest about a year ago announced eesti
oh so I want to start with where we are
with this deal any moment now we're
gonna waft the the smell of freshly
compiled software is gonna wash over us
and and if steal zero point seven is
gonna be pushed so we announced we
started working with IBM and lyft a year
ago December and we announced last May
each do we announced the project
publicly it was in github the whole time
it was always you know started from from
line zero in github and we announced in
in May we announced version 0.1
took us about a quarter to get to 0.2
and I think after 0.3 we decided we
should move to more frequent releases so
if you get functionality out faster get
get people using it and and really get
the project in better shape so since 0.3
we've been doing releases every month so
we're up to 0.7 and about four weeks
from now we should see 0.8 and we're
gonna call that a long-term support
release which means we will we will back
port bug fixes and we will do a 0.8.1
point 2 etc we do have people using it
in production IBM over the weather
company which is you know I think they
they announced some numbers I think
they're doing four hundred thousand
requests a second so it's serving some
some pretty serious volume so that's
that's where we are Descartes Labs is in
production namely Mattie Mattie Mattie
tables his is from namely right he they
went into production we have another not
a customer again but but some people we
know in San Francisco who were very very
close so we have a few companies that
are that are using in production the
question that you asked was is it
production ready you know I mean we're
not calling it 1.0 yet and when we get
to 1.0 we will we want some stability in
the api's that's very important and we
do want it to be certain features that
we that we are you know we're adopting
the kubernetes you know there's there's
alpha features there's beta features and
they're stable features so we want a set
of core features stable we want a set of
test cases that we're running
reproducibly and we want to be able to
tell you you can expect to be able to
handle you know this many requests a
second and you can expect this much CPU
consumption in it and here's the things
that we've tested so we will declare it
production ready at that point however
it's certainly production ready for
certain use cases right now as evidenced
by the people who are using an in
production and I think that's where I
wanted to go with where we are right now
so by the way we're gonna release 0.8 we
also expect to get to 1.0 in the next
three or four months so not too many
monthly releases after that before we
think we're we're ready to get there
you're done breaking all the api's right
and we'll see so what I wanted to talk
to you is about three or four months ago
we went on the the sto world tour Louie
Ryan who is the the technical lead at
Google and one of the one of the
technical leads on the project Varun who
was a product manager on sto and has
left to start some mysterious Steel
related startup he and I the the two of
us went around to a bunch of cities
around we call it world tour although it
was mostly confined to United States in
northern Europe as you can see but we
talked to lots and lots of customers we
talked at meetups we went to the ISTE of
the kubernetes production user council
in London we went to you know we went to
small meetups and big meetups we went
and met panels of customers panels of
open-source users not Google customers
really tried to talk to lots and lots of
hidden potential users this was after we
had announced it so you know some people
had played with it some people were
being introduced to it but it was it was
really a chance for us to go talk to
people and and and figure out you know
what what's resonating you know it's
kind of out there people are starting to
play with it do they like it do they
need it what do they need what's wrong
what are we missing and it was a really
a chance to learn about how people were
thinking they were gonna use this and
how they were reacting the feature set
and as a product manager that's always
great because as a product manager you
want to figure out what people need and
and I like to ship software I like to
ship software as soon as possible and do
we have any other product managers here
good as a product manager the best way
to ship faster as to what what yeah not
to do something is to reduce scope right
and that that's exactly it fine you're
minimal define minimal as low as you can
and and and go for that so so when we
talk whenever I talk about is Tiye when
I give kind of the intro talk to what is
Sto which I didn't do tonight cuz I
figured you guys have all seen that
before I always talk about there's
really three things the food three main
you propositions of this to1 is
observability and this idea that we're
gathering metrics and a standard set of
metrics for all your services that were
gathering logs that were gathering you
know telemetry and tracing some people
you know that like that's one of the big
things that that it does and the second
thing is is control and that's control
the ability to route a request where it
needs to go whether that's load
balancing across a pod whether it's load
balancing to a different cluster whether
it's you're running a canary test right
now you want certain header to go to
test instances that ability to control
where request goes is a really big deal
and some people really like that and
then the final one is security just the
ability to say hey we have MPLS and we
can put an authorization policy so
strong authentication and authorization
so one of the things we did on that
world tour was kind of talk to people
about this to try and suss out like you
know do you need all these things is
that is it you know is that what you
need turns out not everybody needs
everything and as a product manager
that's a great thing to learn right if
there's things there's something that
people don't need you can cut that and
you say you know what we'll get to 1.0
faster so that was good to know the the
frustrating thing was that in our
feature set there was not a silver
bullet and even of those three if you
just break it down to just you know
those three features there wasn't one
that everybody said that's the one we
need if you have that I'll start using
it what was interesting was that nearly
every customer we talked to potential
customer potential user said that's the
one I want and they had one that they
wanted and and that was kind of a really
frustrating thing to learn was that for
some people observability was key right
that's all they wanted give them that
and they'll they'll walk away it's done
they've got it for other people it's
it's the security in finance how many
anybody here work in financial services
your thing about em TLS right and if
you're not you probably aren't you know
that's just it's just the way it is and
for some people it's the traffic control
so so that was the the big takeaway when
I came back from that and it had been
weeks of travel and people said so what
did you learn on that trip if I was
gonna give him 30 seconds if I was gonna
get
three seconds it is there's no silver
bullet and in fact there's not just
three features in this do there's a lot
of features in this tio I just stole
this from someone else's deck it's a
partial list but there's a lot of stuff
that sto does right there are a ton of
things that it does and in effect you've
got a menu of features in sto right
there's a lot of things that it offers
and and maybe to some people if you look
at it right there's too many maybe this
thing is kind of a Swiss Army knife
right it's it's it's got the you know
you want to you want to open a bottle
it's got the corkscrew you want to open
the other kind of bottle it's kind of
bottle opener you know you need to file
your nails it's got that it's got blades
it's got scissors and that's great
there's sometimes it's great but
sometimes you can be thinking about a
Swiss Army knife and what you actually
end up looking at is you see something
like this you think what the hell this
thing is so complicated can it really by
the way this is real it's like four
hundred quid and it's two and a half
inches deep but but that's that's the
risk right is that that you think oh I
don't need all of those things I just
don't mean I would never buy that
because I don't need all of those things
right and when we went to coop con or
cube con depending on who you ask
last year there was already a steal had
been around long enough to have pushback
and have people say I don't know why
everyone's talking about ServiceMaster
no one's even use it in production I'm
like well of course no one's using it in
production it's not ready for that yet
right and and then the other thing
people was saying well it's it's too
complicated there's just too much right
and and so the question that we started
asking ourselves is is sto table d'hote
sidenote when you when you go to
California
everybody can can pronounce words in
Spanish we can say tortilla and we can
say you know Zeebo there was a thief
yeah but but ask us to say anything in
French ask us to even approximating
anything in French we can't get close
but you know we all know what what a
tough deduct menu is right it's where
you walk in and the menu is fixed and
you don't have options it's a bunch of
stuff and you're getting all those
things right that's what the table
d'hote is and the question is is is do
table d'hote and and while you might not
realize that the answer is no we've got
a lot of components that can be used for
a lot of different things however this
is not a table d'hÃ´te menu is that good
why wouldn't you want to use it has all
those features I had that list that long
it could have made it that long why
wouldn't you want to use all those
features well the biggest thing is you
don't want to bite off more than you can
chew right when you're when you're
taking on an implementation of a new
project it's it's a bad thing if you're
gonna do something that's gonna add
months to your implementation no one
wants that I don't want that to happen
to your project I want it to be as as
simple as possible and especially if you
don't need MPLS for example I don't want
you fighting with our RCA right it just
doesn't make any sense
it's really good when you're when you're
laying out a project to lay out good
steps steps where you're making progress
even if they're baby steps where you can
show progress along the way of a project
so maybe you intend to eventually start
using everything that is geo has to
offer but it's okay to start off with
small and go step by step along the way
because you can have victories and you
can show progress and you can tell your
boss hey you know that thing it's
working we can do canary rollouts now
hooray
you know next quarter we're gonna think
about turning on MT LS but you can show
victories and that's really you know for
those of you who work any place a lot
larger than you know 10 or 15 people
it's kind of really important to be able
to do is hey yeah we did that project
and we succeeded and now we're gonna go
on to the next step
so what I'm here to talk to you about
tonight is the fact that sto is an ala
carte menu
and we've got that list of features you
don't need to implement them all at the
same time you can turn it on for just
the ones you need and you can implement
them over time and so what I wanted to
do and I'm not going to talk for an hour
either liam is tell you about a few use
cases we're in this weird situation that
we're an open source project but some of
the people who are who are in
implementations or customers of ours so
I don't actually use names for most of
these other than when people have spoken
publicly about what they're doing but
everything I'm gonna tell you here is
based on something that somebody is
doing right now after they looked at the
feature set of Sto so I wanted to talk
to you about about these different use
cases and the different features so I
talked about those three main features
but there's a there's a bunch of
different components right we talked a
lot about envoy pilot and mixer but we
do have a certificate authority we
talked about the initializer earlier
because what do you do when it's down
and then of course we have the in the
ingress functionality ingress proxy and
these are actually modular and you can
actually choose which one of them's
which ones of them you will use now I
will argue that everyone has to use
pilot and in fact that's really the
definition of if you're using is do or
not if you're using pilot you're using
it's do but you can't you cannot use
anything else you want to which is kind
of crazy lots of people don't think
about that way so put the menu up on up
on a chart and you can see all the
different pieces in fact there's more
pieces than I even listed there because
mixer has plugins right and we're
shipping a bunch of plugins out of the
box which should be an authorization
plugin something to do quota integration
with our own it's a couple of
integration with our own products that I
don't know if we're really an
open-source at some point obviously the
Prometheus integration what's that they
are great yeah so um
he wrote stackdriver it's there so so
you know it's funny because there's like
40 engineers at Google working on it at
hto or maybe 35 it's a lot but it seems
like Zack wrote all of it
yeah that's l5 vision right there so so
it's is pretty component I mean I'm
going to show you so this is this is
what this diagram take a mental snapshot
of this everybody you can use your phone
and take a snapshot if you want to
because I'm going to refer back to this
later in some different use cases so the
first one is actually the one we
anticipated which is not everyone's
gonna want or need em TLS why not a
couple of reasons one is you do have to
run a certificate authority it's another
thing to make sure it's running and to
think about what happens if it's not up
and stuff starts not working
second encrypting takes CPU cycles and
depending on your workload and depending
on your wallet and depending on your
sensitivity to latency all of those
things might say I don't want to I don't
want to do that I don't to pay that cost
I want to pay for that CPU I don't to
pay for those microseconds and I don't
want to pay for the hassle of running
that surface so this one we actually
thought of in and those of you who have
installed SEO from the site will know
that we have basically two installation
scripts that you can run one anyone
installs auth and one does not so if you
don't install off it simplifies the
picture a little bit right you you're
not installing that component at all you
lose all those nice little lock icons
everywhere but for a lot of people
everything here is is behind a you know
it's it's it's easy on your KU Nettie's
clusters is behind the firewall
nothing outside can reach it and you
don't need it and that's okay um we will
tell you at Google our best practice
that we talk about is always secure
everything right we run a flat network
internally every single call from every
single service to another service is
strongly authenticated and authorized
right that's a best practice you don't
have to implement that most people don't
implement that you're not doing that on
all of your other stuff that you're
running right now you don't need to
start doing that just because of this do
over time you might decide to do that
there's very compelling reasons to do
that but you still doesn't have to be
the event that makes you start doing it
so if it's easier it's okay you're still
using it you don't feel bad it's alright
um another thing Descartes Labs is a my
can say out loud as I said they were the
first company to go into production
version 0.2
and that should tell you how desperate
they were for and I don't mean that like
that wasn't a joke like really that
should tell you how desperate they were
for observability so they they have
pretty cool technology they take
satellite images they run machine
learning algorithms to draw really
interesting conclusions like you know
crop yields and stuff like that and then
they sell access to that data they have
some pretty high volume clients do I
keep stepping on that I'm sorry
and so they had moved to kubernetes and
they were really happy with the
scalability they were really happy with
repeatable deployments a lot of things
they really liked when their app ran
slowed they didn't know why and it was
driving I'm crazy
and so for them to get a good dependency
graph and to be able to understand how
much traffic on a particular service was
coming from another one of their
services that was super super critical
for them because then they could make
sure they were scaling that one
appropriately and otherwise they didn't
know how to and sometimes they could
tune how much one of them was calling so
for them it was worth going zero point
two which I can tell you was not
production ready for many use cases but
if you turned off everything and you you
know only use the mixer plug-in that was
doing up that was doing observability
you could get your dependency graph and
you can get those metrics in a graph on
a dashboard we sometimes use this quote
there's an actual quote from from Tim
Kelton yeah everybody got fired up about
kubernetes and micro services and then
they were like oh what's going on
and that that's that's how they felt so
it's do let them find the trouble spots
so this is what they had to install now
you'll notice they're still running
pilot they're still running the Envoy
proxy they're just using standard
kubernetes ingress and the only plugins
that they need are Prometheus and stack
driver so they're they're mixer
deployment ISM is much simpler and in
therefore it's you know it's taking less
resource it cetera but they went they
went to production on this last I don't
know what it was like September or
something perfectly valid ordered all
the card off the menu next one we have
another customer who's very cannot a
customer this is not a customer but
another company who I hope they start
talking publicly because I think it's
cool when people do that
they're just need ingress they need
better
ingress control on their kubernetes
cluster they have about 2,000 unique
services running on their cluster now
they don't have service to service
traffic because in fact it's
multi-tenant and they have every one of
their customers has it has a service
running essentially and so they're not
so concerned about that they don't have
traffic between their micro services
everything is from ingress to to an
individual service but there are about
2,000 of them all they wanted was the
was the sto ingress I guess I should
have had some lines here because they
are they are monitoring that of course
and they're pushing the config through
pilot but they didn't go with sidecars
now over time they probably will add
sidecars but as you can see this
significantly eases their adoption
throwing a sidecar I dependent if you've
done it before then you think it's just
another thing to do and it's fine you're
kind of used to the idea if you haven't
done it before you can see that it's a
scary step to take especially if you're
running 2,000 of those things right so
the ability to say you know what we're
not going to use the sidecar now if you
have services service traffic you're
really missing out on the observability
you're gonna want it but if you don't
it's okay to do that they're using
ingress and and that's all
so again perfectly valid they order all
the cart
they started now they as I said they are
gonna go to sidecar it's they want more
of these features but they decided to
pick something small ish get to know the
system get to get used to running it in
production and and that's what they did
we have another customer who is heavy
heavy this is a customer and I'm sure
that they will let us talk publicly soon
they're heavy gr PC users they have in
there and they are where they've been
developing in micro services for a long
time so they have about a hundred gr PC
services in their kubernetes cluster and
they're all gr PC there's a problem with
gr PC and load balancing which is load
balancers most load balancers out there
don't know what to do with gr PC they're
not very good at balancing what to them
just looks like TCP traffic right and so
this company has to stand up a l3 l4
load balancer in front of their
service because the service scales they
need to just do plain ol l3
load-balancing right there running a
hundred of these services and they run a
test and a prod and a staging or maybe
it's a dev and a staging in a prod of
each one so they're running 300 load
balancer another Google customer so
they're paying us for those 300 load
balancers but they're running 300 load
balancers it's like $60,000 a year or
something they're paying for a load
balancing it's kind of a drop in the
bucket and their bill but they don't
like spending that 300 I mean that extra
$60,000 if they could get the load
balancing the client-side load balancing
of odd voi they can turn those down it's
gonna be like that and they install this
open source project and they're gonna
just turn all those off so for them
they're using mixer but they're not
using authentication they're not our
authorization they're not using quota
they're not using I am all they want
really they'll take the the monitoring
of course but all they wanted really is
that is the client-side load balancing
so for them they are gonna use ingress
and and they are going with the the side
cars but but just the ingress in the
side cars and then there's what what we
get in finance frequently and that's you
know what I have so many APM tools
already and I have engineered the crap
out of every single binary that we have
I don't need any more monitoring I don't
understand what canary rollout means so
I don't know what you're talking about
when you say that we're deploying
monoliths anyway I can understand that
but if I don't get authentication and
authorization on every call soon I'm
gonna I'm gonna freak or actually
there's another really interesting case
for this which is right now most people
use IP addresses for security and when I
say use IP addresses for security you
use IP addresses within your network
with your corporate networks very common
you have a segment and partition right
and you can stay within this zone you
can call services but you can't call out
to this one and in this zone they can
call out so we went to a bank that
spends we went to a bank that has more
developers than we do yeah think about
that right yeah they're their IT budget
is something like twelve billion dollars
a year which is probably more than all
of our IT budgets together right their
data centers are partitioned for
security but the
woman is it's very difficult for them to
change those partitions and they have
some partitions that are completely
oversubscribed that have more workloads
running in the year that they can't run
them all and they have others that are
running at 50% capacity but they cannot
take workloads from over here and run
them in here because there's no network
connectivity right they want to turn off
internal partitioning and in order to do
that they need something else to protect
their services because you don't want to
do that and lose your security you want
to make sure only the right things can
call can call your you know can call
each service at Google as I think I said
this before we run a flat network
internally we don't have any internal
partitioning it's much much better you
don't have that problem of you know
you've got unused capacity over there
but you can't take care of it so all
they want is is the control is is
authorization and authentication now to
do this they are going to have to
install all the components but they can
have a simplified mixer install they
don't need to have that Prometheus
adapter in there they don't need to have
quota adapters in there they don't need
to you know send data to stackdriver
all they're gonna do is authorization
checks maybe they'll use our I am maybe
they'll use their own but all they will
do is authorization checks is a service
when a call comes in when this when this
thing goes to call this thing first of
all you know it's it's MPLS so we'll
know definitively where that call is
coming from and it will check to say
with the auth policy oh saying now I
know definitively who is making this
call and once you know that you can make
an informed decision do we allow this
call through
as an aside as I said at Google we're on
a flat network any any any place on the
network can call anywhere else on the
network but every single call is
authorized and services can only call
services that they have been explicitly
authorized to call it vastly vastly
simplifies our network topology it means
we don't have to spend as much time and
effort administering our network as you
guys do which is ironic since we have a
much more secure network than probably
anyone here it's it's kind of crazy but
by by by ensuring that every single
service on the on the network is secure
it means you don't have to use
partitioning for security anymore and
it's really really freeing
I don't imagine that the people in this
room are gonna be able to go convince
their network people hey great news you
don't have to do this anymore but over
time that is gonna happen over time I
really think that's going to start
happening and people won't do that
anymore but the banks are starting to do
it now so when they look at it CEO ala
carte there's one thing they want and
it's and it's authentic Asian and
authorization which is two things let me
sum up how I meant to put a big Sigma on
here do you mind if I finish my slides
real quick no there is no time let me
speak it's not table d'hote and we want
to do some things to to make this easier
I would love to I don't know put this up
on the website so people know it we'd
like that it would be really good if we
really get some time and maybe some of
our dev rail friends could help us with
some more install scripts say oh if all
you want is off here's the install
script you want you know if all you want
is monitoring here's the install script
well we'll probably get there eventually
or maybe other people will you know you
guys you know PR is welcome but we want
to make it easy through our
documentation and and through the
scripts to make it clear you don't have
to turn this on it's it's not that
daunting as a system there's seven
running components but to some people
it's a big deal and especially if you
can you know if you if you don't need a
mixer that's gonna be a high-volume
service so if you don't need a mixer
don't run a mixer it'll make it easier
you turn it on later
right but it'll it'll make it so you can
adopt easier you can adopt faster you
can show that success show your boss hey
this project is is you know showing
returns and making progress it's a good
deal and tell people about this please
right tell people just remind them you
don't need all the components if you
don't want them hey thanks for listening
yeah I think that's all I have to say so
I have a Twitter handle and I tweet
there it's not very good
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>