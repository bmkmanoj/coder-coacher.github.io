<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building Conversational Apps Using React Native and AWS Lex - JS Monthly - January 18 | Coder Coacher - Coaching Coders</title><meta content="Building Conversational Apps Using React Native and AWS Lex - JS Monthly - January 18 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Pusher/">Pusher</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building Conversational Apps Using React Native and AWS Lex - JS Monthly - January 18</b></h2><h5 class="post__date">2018-03-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/JMQzMi5F7so" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">yeah I flew all the way down from
Seattle to give a talk on conversational
chatbots using a react native I'm
Karthik Venkatesh I'm the CTO of
trinomial
of course from Seattle and I come here
monthly to be with my team at Renault me
you can follow me on tea base that I
miss Karthik and today we're gonna be
talking about react native apps and
building a conversational UI using AWS
at Lex let me briefly go over react
native actually before I start as who
all have used react native or used react
native date today all right cool in my
opinion it's an excellent platform for
building native applications using
javascript and react right it you get
all the tooling you get the familiar
data familiar developer experience as
you build out these native apps right so
then you can really take all your react
skills and apply them and build really
build truly native apps and not just
html5 web apps etc right react native
ships with a powerful component library
that pretty much gives you 80% of what
you need unless you really need to go
deep into let's say getting a nice sound
recorder going low level into the actual
OS and platform component level aspects
to get the power of it right or if you
want to do multi-threading and different
aspects then you can choose to go and
build your own react component native
components and bridge them over to react
or actually just utilize libraries out
there and react native comes with a
maturing but good tool chain right for
example today I probably spent two hours
trying to fix my simulator and react
native integration because it just kind
of worked then I tried to test three
apps at once it just kind of like just
screwed me over for almost couple hours
as I try to fix it but it's all in all a
very good framework platform and great
support from Facebook and the rest of
the community out there best of all like
I just said you can
is the power off the platform when you
need to and then you know you have
access to and you can build components
in Objective C Swift Kotlin Java
whatever you want right
it supports redux move X relay and
others and it ships out a box with
battle just and flow in fact with the
tool chain you can initialize your
project it bootstraps it it's pretty
opinionated about what comes with it and
you can get going I can't take credit
for this architecture diagram but it's a
great article I posted it there and I'll
post it on the Twitter page that goes
into depth of react native architecture
and actually how the runtime
architecture works but just as a brief
overview you essentially get a native
application that hosts a JavaScript
runtime and a bridge layer that allows
bi-directional communication between
your native components and the
JavaScript layer so then you can in fact
a lot of the outer box components and a
lot of the Val known libraries most of
their code is most of their work is in
the native layer and then they do a lot
of platform level switching and things
and you get a pretty seamless experience
across the board in summary I love react
native I'm probably biased right just
like I would but you can really build
good cross-platform native apps with our
most beloved JavaScript right that's
good
alright let's dive in we'll look at AWS
Lex and then we'll I'll show you demo
and then I'll go through walkthrough of
the code and how everything is
structured essentially the main concepts
is you're trying to guess or you're
trying to really figure out the users
intent whether they want to actually
book a trip order flowers you know
whatever you want actually from a intent
perspective then it it pretty much Maps
intents to utterances and again with any
apps that are really built with AI and
machine learning you really need good
feedback loops from data right if you
don't have good feedback loops from data
you're not really doing it for service
and you might miss a lot of actual users
who want to get something out of
but you might you might be missing their
intent and I can't serve that purpose in
20 minutes but in a real world situation
you would want to actually get good
feedback loops and AWS and other
services like IBM Watson stuff have
those feedback loop options built-in the
good thing is also it allows you to hook
into lambda so you can actually trigger
lambda calls at that point and actually
build out a service application that
then fulfills your requests etc through
it so I've already created a black spot
and let's go and look at it I'm just
using their example what we're going to
say is we're gonna be listening to book
a car reserve a car make a car
reservation to map to the book car
intent or we're going to look at the
book a hotel these you know just when
you want to actually book a hotel to the
book Hotel intent and then once the
intense mapped what happens is it walks
you you know then you have to engage
with your user to get the appropriate
data elements back to be able to fulfill
the request right so then you're gonna
prompt the user and then ask the user is
prompt you get the feet you get the
particular data elements and do it now
Amazon has a good number of pre-built
types which already have gone through
their machine learning and AI aspects
and gotten pretty good recognition but
then if you make your own slot types
again you got a feed back into it and
make it better over time
all right let's actually demo it this
simulator has been sitting here for a
while so let's just refresh alright so I
just created a simple chat block let's
do a with the text chat and an audio
chat let's do the test text at first and
then we'll go into the audio chat and
then I'll go into the code aspects to
see the differences between the two
you prompt the user and then of course
the user is like alright I want to book
hotel then you know what city there and
I'm actually connected today WS Us East
instance right now a table axis only
available in Ireland and u.s. East
yeah my school's broken
there yes of course and then alright and
then of course I just put a and thank
you but then at that point you have an
option to either trigger an AWS lambda
function or you get all the data back
and then you can act on that let me go
back here and start an audio chat next
let's see if it actually recognizes me
with the car reserve a car sorry what
can I help you with okay booked a car in
what city do you need to rent a car San
Francisco what day do you want to start
your rental next Friday what day do you
want to return the car let's try this in
two weeks from now how old is the driver
for this rental 36 how old is the driver
for this rental 36 sorry I am NOT able
to assist at this time I love it see
potential of this technology that's fine
all right great
anyway you can see that it's pretty raw
but if you feed enough loot backs into
it
utter incest and even here it can you
can talk about the different types of
sentences that you hear back so in a
real world example any misses you would
you would grab that sentence feed that
back as an acceptance and then you could
get that automatic loop back in there
caching usually by defaults 15 minutes
so let's say you change the voice you
it'll probably take about 15 to 20
minutes to get that propagation out to
your active sessions so at this point
let's actually look at the code I'll
also talk go through the react ask
soft it react native aspects of it and
then go from there all right the AK
native is a lot like react it's pretty
straightforward
it'll be very familiar to any reactive
we're using react native and I'm using
react native app navigation to do a I'm
pretty much starting a single screen app
I am my Redux tour and I'm essentially
passing the store and provider into the
route components and then from there
essentially booting up the app and going
going on so actually let me actually
start with the Lex API and then go on
from there so in the services
essentially AWS as a JavaScript SDK and
within the JavaScript SDK it has a react
native SDK and I should probably never
store your secrets the way I'm doing it
but that's alright for the demo
you have your AWS configuration you set
up your credentials you set up a region
and then you start the rack
Lex runtime and then you pretty much so
Lex allows you to publish different
versions of your BOTS with different
voices with different settings etc and
then you can pretty much choose which
you know bot and publish bot to connect
to here this is the actual I'm passing
text so what I'm doing is react native
doesn't have any built-in way to pass
the audio in the accepted formats
currently so either I build a native
application or I use react native voice
and I'm able to do speech to text and
then I take that text and pass it on to
AWS and then I accept the response in
audio MPEG and then you know you can
pass in session attributes other things
which then your lambda functions can
actually hook on to and then go on to
the next pods right pretty much doing
Lex runtime post content I always use
the promise API and then I return the
audio stream now
you'll see in here that I'm actually
going to base in 64 encode the audience
stream and then decode it because of
some limitations again that the outer
box libraries that react native app if I
wanted to spend time I could build my
own reacting native component and then
to allow to playback better and then I
have another function which I probably
didn't need to you know split it out
it's essentially the same the text API
is essentially the same except for the
fact that you're posting text instead of
posting content that's literally the
same thing you'd probably I'd probably
have the same function do both things
but then of course I my actions and what
I'm doing right here I'm getting the
audio stream back from Lex
and then I'm base64 encoding it I'm
pushing it out to my state and then in
my chat component I actually love the
decorator syntax I hope they finally
accept that and goes past stage two
anyway
here what I'm gonna do this actually to
get and any error I'm gonna put in the
console warned and then essentially get
the base64 audio and once I have the
base64 audio most of the react native
sound playback or audio playback
components have a hard time you have to
pretty much hack it to get to play audio
streams that you have in memory like if
you have a buffer of an audio stream and
playing that back it's really good if
you have a service or URL that you link
it to or you bundle a audio file with it
you can hack around that maybe save it
into a temporary cache location and
stuff like that but actually web views
for this way work much more efficient or
you just build a actual wrap iOS and
Android audio SDKs and you can build
your own component at that point so I
I'm using the HTML audio html5 audio
player and essentially what it allows me
to do is I create a simple
HTML page which I embed into a webview
and year I using the post message I send
a basic c4 buffer I decode it and
essentially create an object URL which
you can do and then you can just
essentially convert it to a blob create
an object URL of that blob and then
audio display and that's how I actually
implemented the audio playback there
again if you you know this is actually
why I love react nativists and react in
general is that allows you to
iteratively build product and push it
out and then if you then in next stages
kind of build the deeper parts of it
thank you guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>