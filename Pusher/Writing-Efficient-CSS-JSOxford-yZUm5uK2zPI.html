<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Writing Efficient CSS - JSOxford | Coder Coacher - Coaching Coders</title><meta content="Writing Efficient CSS - JSOxford - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Pusher/">Pusher</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Writing Efficient CSS - JSOxford</b></h2><h5 class="post__date">2016-05-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/yZUm5uK2zPI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I'm Joe Joe reef nice to meet you all
and I just kind of shameless
self-advertising I helped run a meet-up
called Marlow dev in Marlow which is
halfway between here and London so
that's where I live and work but if any
of you want to speak or attend just let
me know and we can organise something
because we're looking for first peek
isn't the actual content is about CSS so
this is mostly about how we treat the
browsers selector engine
so rather than we've got stuff moving
around it's going crazy this is more
about how do we how do we make it easy
for the browser to figure out what we're
talking about so the selectors we're
talking about themselves so I'm going to
give a brief history which kind of may
end up being a little bit of an
overstatement because it's kind of stuff
that I found from Google this is really
small so has anyone ever written a line
of CSS that looks like this and then sat
back and being like I am so good at CSS
like I am I am amazing at CSS all the
other guys in the office they're not as
good as me because I wrote that line of
CSS like this is bad you should
definitely not write code like that
because because it's bad we'll get to
that so when I kind of had this talk
accepted we're gonna talk about CSS I
figured I may as well start from the
basics I've kind of refresh my memory of
what is CSS so I used the defined
keyword on Google I said what is CSS the
answer I got was a cascading style sheet
is a webpage derived from multiple
sources with a defined order of
precedence all that stuff so basically
from this really rubbish description all
I learned was that you should never
trust online sources so I'm assuming you
guys know what CSS is right yeah yeah no
you don't anyone say yes no yeah you
know what CSS to get there are three
levels of CSS so first of all if you're
next to a w3 guy WC go and you say three
versions of CSS they'll slap around the
face three levels of CSS
so level one I was originally made in
1996 or original expect out in 1906 and
then it was updated in 1999 level 2 was
actually started before they'd finalized
level 1 which is a bit weird and then
that was kind of finalized in 2003 css3
was finalized in 2006 that's not kind of
when it went into browsers that was when
the specs were standardized this is kind
of a little graph and you can see where
chrome 1 was released and chrome 49 so
in a tiny space of time we've got like
is it 50 now well we've got like 50 50
versions of Chrome which is kind of
insane considering we had like the dark
ages back then like before us born so so
getting on the performance which is kind
of what I was supposed to be talking
about basically the specs have nothing
to do with it so it's always fun to bash
the guys who write the specs because
it's kind of always a bit annoying when
we realize that they've made a mistake
or they're updating something and now
we've got to relearn stuff but
unfortunately the CSS specification has
nothing to do with how fast or slow the
CSS is to do with the guys who write
selector engines and the kind of
rendering engines in this case is
selector engines so what I'm going to
say is slightly different in loads of
different browsers and you can't kind of
it's not one rule fits all but a lot of
it is kind of applicable to most people
because you've got something like WebKit
everybody's gonna look at WebKit for how
the open-source guys are doing it
because hopefully they can copy and
paste code so like I say ie is slow no
matter what you do but then you've got
Chrome which kind of can limp along even
if you if you do some really horrible
stuff okay so there are four different
types of I've really should connect the
internet really for different types of
rules so you've got ID rules everyone
those wanting ideas what an idea rule is
I presume you've got class rules tag
rules and universal rules but the thing
is we've got this thing called a key
selector so a key selector is just kind
of a bit of jargon that we've assigned
to the last part of a selector
so in a IMG its IMG in div P its P and
yeah it's pretty easy so when I use the
word key selector that's what I'm
talking about
so with ID rules for example we've got
kind of a key selection back button the
whole thing in this case is like the the
key selector so that's that's an ID key
Specter and then at the end we've got
our myself active key Slater class rules
class rules kind of the same we're
getting there
tag rules tags right and then Universal
rules of things like stars anything
without proper selective right so this
this is a key selector attack a
universal key selector so the things
that are historically historically we're
going to talk about history now this is
where the history doesn't part comes in
so the way the selector engines work is
they start at the end and then they work
left so they find everything that
matches div end child 1 all throughout
your entire page all of your HTML
everything in your and your DOM and then
they say well now filter based on stuff
that's within a tab or a dot tabs and
then kind of keep going and keep going
and keep going so you can kind of see
now why I said that was so bad earlier
because you've put in so many jumps
through it's brilliant if you want to
have as little Dom as possible but if
you want to kind of make it easy for the
browser as possible then I mean that's
just super slow you've got how many
jumps when you could have had just one
if you're just given a class so if you
use Universal rules how many of you have
or do use Universal rules whew he I
won't ask you to leave because
so the first kind of tip I have is don't
qualify your ID rules with tag names or
classes and that's just kind of adding
extra layers for the browser to jump
through so that's kind of the same in
most cases don't add extra layers don't
qualify class rules the tag names kind
of the same thing but this kind of thing
is I didn't even realize tree celled was
a thing before I made this talk what is
it does anyone know what it is no
apparently it's genuinely in the spec so
don't do that
and then so yeah kind of generally used
in my specific form so instead of doing
something like this you just give it a
class because it's so much faster for
the browser to find it just searches for
everything that has that in it oh and
it's easier for you as a developer to
figure out what's affecting what which
kind of is is helped by using something
like VMware you kind of actually
namespace your classes and then appoint
avoid the descent descendant selector so
that's just like the space I don't know
if anyone does that but less compiler
does that so you you know less the
preprocessor every time you nest your
tests that's how it comes out the top
line it comes out like this so less it
makes it super easy to write bad CSS
because you're not writing CSS you're
writing an abstraction which compiles to
really really icky slow kind of for the
selector engine tag category rules
should never contain a child selector so
this although it's easier it is faster
than having a space it's still pretty
slow when you could just give it a class
so kind of this like a theme here give
things classes because it does help
which does kind of lead you on to having
some issues of having too many classes
getting confused by what they will do
but that's why you adopt kind of a
namespacing system so another tip is to
roll on inheritance instead of kind of
explicitly saying to the thing that's
contained by this guy just set it to the
top guy if it doesn't matter so much
like it's not going to affect how it
because it just kind of follows through
and that's that's so much easier for the
browser to figure out than doing that to
two-step jump I pressed it once so
basically be specific give things
classes and just reference those rather
than giving it some huge long kind of
chain to walk down so that would kind of
historical what about now like obviously
we're supporting some old browsers which
like have some really really bad issues
with those kinds of things but now we've
got like super fast phones in our
pockets that can handle all of this
stuff so kind of is it still important
and this guy yeah come on we've already
had like four people on the stage okay
so this is what anti said he said my
view is that authors should not need to
worry about optimizing their selectors
and to me that's kind of dangerous like
well if I don't have to worry about
what's going on underneath the hood that
means like when someone with an older
browser doesn't have a bunch of kind of
isn't fast or when you're running on
some XP machine in the middle of Kenya
your website's not going to work very
well but he does kind of have a point
it's not your job as a developer to
write stuff that's fast
it's a compilers job or the interpreter
or whatever it is the system's job to
figure out what you're trying to say
which is kind of like are we programmers
or are we just translated if it's a
translation then we need to be really
really careful if we're programmers
we're telling the computer what we want
at the end then surely we should just be
able to say whatever we want and it
figures out the best way to do it so
this anti-gay see this makes me really
cool I'm better than Adam because I
meant nodding no don't do that
because I mentioned a WebKit core
contributor in my talk so therefore I
must know what I'm talking about right
and I quoted him so these are the things
you've done for WebKit style sharing
rule hashes ancestor filters false paths
and these other things that go on for
like miles down there he's done loads
and loads and loads of tiny tiny
optimizations and some bigger ones like
the ones that are actually written there
that make browser selector
engines work so much better so the first
one is style sharing now this one kind
of seems a bit weird like how can you
give this guy credit for doing something
sensible this is just caching right he
just says well instead of figuring out
what the first one should look like and
then figuring out what the second one
should look like figure out what both of
those should look like at the same time
kind of but it's basically just caching
it remembers what the path is and says
well you're the same so I'll give you
the same thing raw hash is it's slightly
more interesting it's just another form
of caching and what it does is it gets
all the key selectors and then kind of
creates this table this hash of them and
it says well now every time I look at
something that's got P legal I'm going
to compare it and see if it's any of
these things which for a big page with
loads and loads of selectors makes
things so much faster especially if
you've got lots of long selectors it
kind of covers your back on that because
if you've got the same selector the same
long selector a few times or you've got
lots of elements that are matched by one
long selector then it kind of solves
that problem for you so then it turns
into one jump instead of five or six
jumps so this is kind of I forget who
said that I'm pretty sure it's an T as
well so used in moderation pretty much
everything will perform just fine from
the star matching perspective which is
kind of a bummer for me because I'm up
here on stage talking to you guys and
trying to tell you that you should write
good CSS but like I said this is only
for WebKit and like a few of the other
browsers that are kind of starting to do
similar things which is getting to be
quite a few which is good for us and
good for the consumers but at the same
time we have to remember the poor
starving children in Africa who have an
XP machine that they get to turn on
three times a day when they're three
times a year
and kind of can browse internet and if
we're slowing that down for them then
that's that's a huge kind of bummer to
them and to our users so I'm kind of
here saying you can do some really
horrible stuff to the browser but please
don't please make your browser make your
browser job easy because that's your job
so I haven't really said much because in
that case you can just go home and keep
doing what you're doing because you guys
are developers and you use Chrome
obviously because he would use edge and
yes so there's nothing kind of that you
can go home with and say right now I
know that I'm going to do stuff
differently so I thought I'd kind of I
thought I'd bring in some some some
other kind of projects that you guys can
use to actually help your CSS now since
I stopped Benjamin Ben Ben say hello Ben
it's pretty cool it draws lots of pretty
lines over over images so you type in
google.com and then it shows you all of
the searches they use which is quite a
few actually and then it draws lines to
all the elements that use those
selectors which is really cool because
then you can see well actually maybe I
can just get rid of these couple of
classes and squish them together and
then make my classes more composable
like functional sister who is at render
render comp because there was a talk
about that talked about that kind of
thing
making your classes composable which is
more structure than kind of optimizing
but that means that you can reduce the
number of selectors which reduces the
kind of the kind of memory load and
select your engines kind of issues then
we've got stuff like frameworks for
blank frameworks CSS in capulet
encapsulation so this is surprisingly
helpful because it makes things super
explicit because it can grab grab the
class name that you're using and then
say well instead of worrying about
polluting a global namespace and putting
everything everywhere I'm just going to
make really really super specific
classes and ID's for all of your
elements in your Dom so this can can
really really help and sometimes they do
a lot of optimizations for you the web
pack CSS loader is really really awesome
and then you've got things like write to
Jos react and write and things with
components in them like that let you
define components you
usually give them some styles and
they'll kind of figure out and kind of
namespace it for you
make sure you use it CSS is super
repetitive in case anybody hadn't
noticed that like lots of kind of
similar characters and similar words so
gzip it on the server side is kind of
super important it means that when you
download it a lot quicker you download a
lot quicker and then it's easier to
cache as well so just kind of be careful
that you don't end up sending huge
things with loads and those with similar
selectors and in kind of key words when
you could just compress it to nothing so
CSS just ester this is kind of fun even
if it's only just so you can click the
button and watch your page shake around
like crazy what it does is it it sets
tweaks loads and loads of different
global things like changes where your
scroll is what the zoom is really really
quickly multiple times in a second and
then tries to work out how fast your
thing's rendering and it's just a
bookmarklet then it gives you this huge
report about everything you could
improve this is something you should run
on every page you ever work on ever it's
just super super useful and it takes
like 30 seconds to run and it's a
bookmarklet so you can go off and check
your email will do whatever it is you're
doing whilst looking at this pretty
thing shaking around everywhere
CSS shrink now this image was going to
be the most helpful so CSS shrink is
incredibly smart in that it'll say what
right so you've got something here that
says color like cache f00 and something
here that says ff0000
and then you've got something here that
says red so we'll just turn everything
into color red and so it turns longer
version so even if you're only saving a
character
well maybe loads of hex codes which can
just be using a browser read word or you
know browser color word that kind of
thing it makes things so much kind of so
much shorter I really wish I had the
image it explains it for me okay so
bibliography writing for efficient CSS
so the story behind this talk was I read
this thing
and then I went on to the Jess Oxford
github thing and created a new issue
saying I want to talk about this thing
because this is amazing what I've learnt
from reading that is incredible and then
I get an email saying hey Joe it'd be
great can you do this talk soon and then
I say yeah sure so I go back to this
page and I see at the top there's like
this yellow banner saying by the way
this was written like 10 years ago
could you go go read this thing which is
kind of talking about all the good
things that have happened which is anti
so kind of this this talk and that
taught me a lot so I'd recommend you
read that even if it's just a historical
kind of understanding what you kind of
either used to use to do wrong or now
can avoid further older browsers this is
the new one that it kind of warned me
about so this was even in 2011 and this
is when some of the really awesome stuff
started happening being even more
amazing things happen since so they're
about kind of 300 places that have tiny
tiny tiny chunks of information about
history CSS you'd think that going to
the guys who write the specs they'd have
all the information about when it was
kind of when the specs were written
there is some of that but it's really
kind of spread out everywhere so I've
got loads and loads of kind of bookmarks
so if anybody's actually genuinely
interested in that I can that I can
compile kind of a list so so yeah if
anyone has any questions about either
structuring CSS like as in BM or
functional CSS that kind of thing come
grab me cuz that's stuff I've been doing
a lot of work which kind of inspired me
to look at more about this kind of thing
and for the record lots and lots of
classes that do one thing really well is
actually quite as fast because it's just
like a really shallow kind of lookup
then just come grab me or ask me any
questions
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>