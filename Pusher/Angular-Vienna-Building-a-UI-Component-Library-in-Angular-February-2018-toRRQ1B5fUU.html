<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Angular Vienna, Building a UI Component Library in Angular, February 2018 | Coder Coacher - Coaching Coders</title><meta content="Angular Vienna, Building a UI Component Library in Angular, February 2018 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Pusher/">Pusher</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Angular Vienna, Building a UI Component Library in Angular, February 2018</b></h2><h5 class="post__date">2018-02-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/toRRQ1B5fUU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Michael I work for app IT the
gent --ax Department who and we deal
with content management systems as I
mentioned before I'm leading the UI team
where we use an angular to build user
interfaces for these content management
systems so we built our own UI component
library which is called the gentle - I
core and we use that in our own products
and it's now used in I think four or
five of our products it's also open
source it's available on github and in
this talk I just want to share a few
lessons and some hopefully some insights
from what we've learned over the year
two years we've been building this so
well let's start with the basics so what
is a UI component library you probably
all know this but I'll go over it
quickly it's just a set of ready-made UI
components which allow you to more
easily more quickly build a website or
an application so it looks something
like this so it just you know it's a set
of the most commonly used things form
controls navigation buttons alerts and
so on so you've probably heard of one of
these type of frameworks is anyone used
one of these before yeah yeah exactly
everyone's used tinnitus before so yeah
so we know the concept of component
framework our component library so why
are these important or why are they
useful why there's so many of them
widely been around so long why does
everyone know bootstrap so the main
thing you'll be aware of when you've
used it is it speeds up development so
not only do you not have to actually
implement all these different components
yourself like a lot of them are simple
like inputs and buttons are not too
difficult some of more complex date
pickers and so on so it saves you having
the time it saves you the time of having
to implement stuff like that also and
maybe even more importantly it saves you
the time having to think about how
you're going to implement it like what's
the best way to
implement a date picker you don't want
to have to think about that every time
you start an app so these kind of
frameworks are libraries solve that
problem you don't have to think about
this stuff
you can just start dealing with the the
important logic that's really part of
your app and they solve problems once so
you know you don't know how if you have
a shared library amongst all your
applications you don't have to then deal
with the same problems every time it
becomes tedious it's just a waste of
time if you've if you've solved it well
once you should then be able to share
that and knowing that no one has to
solve that problem ever again ideally
and part of that is that they offer
tried and tested solutions this is
really important because it's it's
pretty easy to write components but it's
hard to write robust you know well
tested components that cover all the
different edge cases that come up in
real use so a library that's used by a
lot of apps come some way towards
reaching that goal of being actually
reliable so it takes some use to get to
that stage and lastly they enforce a
consistent style a consistent look a
consistent user experience across all
the applications in which you use it so
this is often a problem especially in
larger companies where you have lots of
different teams working on their own
applications and what can happen is that
they can work in kind of their own
little bubble or their own little silo
and they build their apps and they have
a certain look and feel and each
individual that might be great and it
might look okay but taken as a whole
that can be very inconsistent because
they're not sharing common patterns and
common solutions amongst themselves so
for the end user if it's for example a
suite of applications it can be very
confusing for an end user if one
application handles notifications in
this way and another application in this
suite handles them in a totally
different way the user will be lost and
the user you know as far as the user is
concerned this is one company why do the
user interfaces work differently it
doesn't make sense
so this solves that problem and this is
it kind of gets into the the area of
user experience design and style guides
and this kind of thing so it serves a
kind of a dual purpose there as well so
a bit of background some of you might be
wondering why any sane person would go
to the trouble of building their own
component library when there's already
stuff out there bootstraps already there
why do you need to reinvent bootstrap so
I'm gonna explain using timeline this is
the past Oh laser this is the past and
this is the present okay so we'll start
at the beginning so according to many
theories it started with a very large
explosion and then there was these guys
we're going to fast forward a little bit
now February 2016
in February 2006 2016 we started working
on these UI apps I don't know if it's
easy to see there on the screen but we
have here what's that first commit yeah
that's right angular 2 it's called
angular 2 back then room it wasn't just
angular its angular 2 angular 2 beta 2
so yeah it was in beta it was very early
but we'd made the decision to use
angular for our UI apps and we actually
started a ground-up rewrite of the whole
user interface of main CMS so angular
anyway continued to evolve you know
there was a new router at some point
remember that time when you had to
refactor for engine modules another
router I know you all feel the pain and
about two years went by and then in the
actually in the last few months maybe
two or three months we've seen major
stable releases of things like bootstrap
for angular and angular material so as
you can see way back then near the
Jurassic times there was nothing out
there so this is why we decided to build
our own
so the first thing we realized was that
it's pretty hard to build UI components
it's harder than you think let's take
for example a select farm control so
what do you need to think about to build
one of these well of course you've got
the basic functionality it's a list of
items you can select one it will change
the value so this is what you would
initially think about oh I need to build
a select well I need a list of items
select it change the value how hard can
it be when you actually get into it you
realize there's a bit more to it you got
to think about things like you know this
drop-down might not always be visible
maybe it's too close to the bottom of
the screen what do we do with it it
would make it go up or maybe it's inside
a div with overflow set to hidden then
what do you do with it it's going to get
cut off so you need to deal with stuff
like that maybe it needs to be
scrollable if there's lots of options
you need to have scroll support it's got
a handle focus it's got to be accessible
it's got to admit the right event it
needs to implement it's disabled State
it needs to be able to have the required
support it needs to support multi-select
needs to support option groups if you've
ever heard of those needs to have
keyboard control and that's doesn't mean
just that the up and down Keys work the
space key the home end Keys escape key
when you press a letter it's going to
jump to you know that option that begins
with that letter and so on and scroll
through them and it's also got a look
okay so you can kind of get a flavor
that there's quite a lot to it that's
just one component so we need we needed
at the time to start shipping pretty
quickly we actually made our first
commit to the CMS UI about one month
after we started this library and so so
we needed some way we couldn't we
couldn't build everything from scratch
so we cheated a bit and we took an
existing framework with all the styles
and the JavaScript JavaScript and just
wrapped it the one we chose with
materialized it's an implementation of
material design and it uses this like
SAS CSS and jQuery
so the way that we started off was like
this we would just take the materialized
component and we would just wrap it in
an angular component like this and like
hide all the jQuery stuff inside there
and it normally looked something like
this in the ng on in it we would just
use jQuery and just you know initialize
the plug-in like you normally do with
jQuery and kind of hide it away I tried
to hide it away like that and this
worked kind of worked but it involves
lots of hacks and it was pretty buggy as
well so once we had a little bit of time
we were able to return to these
components one by one and rewrite them
just using the native angular api's this
I wish it was so easy and eventually we
were able to drop the materialized
JavaScript and the jQuery dependency
altogether so here's a real commit so
for the most complex components like
select for example it was about nine
months before we actually reached that
stage of getting rid of all the old
cruft and and doing it the proper way
but at last we were able to break free
of jQuery so a few notes on that whole
process it's a pragmatic way to start it
worked it got the job done
so there is value in this you know in
real life software development you
cannot always do the right way you know
all the time and you have to take into
consideration deadlines and so on so in
this case it worked out quite well
however it did make everything less
testable and more error-prone and the
basic problem we ran into was this that
these like all there are jquery based
frameworks are not designed with the
single single page application use case
in mind so for example with one of our
apps one of our customers would have
they'll have the the
you eye open all day and the page never
refreshes all day so plugins that were
that we use in with materialized would
register register event handlers and
maybe they wouldn't clean them up and
they would be taking control of the
Darmon moving things around and angular
wouldn't know about it and then there
would be changed detection errors
because it changed them done without
angular knowing about it so it led to
all that this series of hacks where we
had to kind of go in do some manual
change detection triggers and so on like
this so it gets difficult and my advice
then is to pay your technical debt as
early as you can because it's worth it
it's worth just spending the time say
right that's it we're gonna clear all
this stuff out and it makes the rest of
the rest of the development much easier
in fact I would go as far as to say just
avoid jQuery altogether in an angular
app do I have agreement with that I mean
I think maybe there is a use case where
you really need it and if you really do
need it I would say don't do things like
using remove and append to change the
Dom around because angular will hate you
if you do that angular has a bunch of
API is for doing stuff like that it's
view container F component factory
resolver and so on so if you do have
jQuery in there just try and leave the
dumb alone as much as you can and let
angular do its thing
okay another early problem we had to
solve was how to develop our components
in isolation and what I mean by that is
that if you're developing a select
component you don't want to have to use
the Select in a real app and then import
it and load the real app just to see
what it looks like you want to be able
to just test it on its own
so and this ties into the fact that like
because as developers we benefit from
having very tight feedback loops being
able to get feedback with as little
overhead as possible so the solution we
came up with was we built a very simple
demo app which had one page for each
component and
we were just you know we would just open
up one page and we would just be able to
then develop that one thing refresh that
one page and see the results and it also
serves as documentation which I'll show
a little bit later so another option
this probably wasn't available at the
time but is now is something like
storybook does anyone use that before
I'll see it as anyone seen it before
it's really yeah some some people it's
really it's kind of bigger in the react
world but it's now you can use it with
angular and it's like a it's an
automatically generated living style
guide which allows you to just exercise
one particular component in isolation
and change the inputs and test the
events and so on so it saves you having
to build a whole application to test it
so check it out if you ever if you ever
need to build a library yourself all
right
documentation documentation is really
really important for a library when you
have people who aren't you using it
especially now we have a couple of other
teams within our company who use the
gentle Qi call and they really need the
documentation and myself and Leon who
wrote the library we also need it I mean
I think I use the documentation every
single time I have to do something with
it so it's really hard to keep Doc's up
to date that's always the problem with
documentation every time you add a new
input to a component or have a new a new
event you need to update the docs
otherwise they become useless if the
Doc's are unreliable you'll never trust
them and they as good as useless so the
good thing is with typescript it
actually provides a lot of the
information that we need that the
important information for documentation
in the the type annotations that we've
put into our code so we decided to try
and use that information in order to
generate our documentation and I'll show
you a little bit what it looks like this
is absolutely useless
I should have use a light theme anyway
on here is the component code for the
select and it has a
a documentation block at the top with
some like an explanation and some code
in a markdown code block and that gets
translated over here into the actual
documentation and this part you see here
is pulled directly out of the source
file and likewise another black square
and another black square here these are
the inputs for the component and again
we pull the information directly out of
the source code and make a table like
this which shows the tights the default
values in the comments so in this way
you you you don't have to think about
the documentation so much you just write
comments as you would in as a regular
course of development and the docs will
be generated and they will be correct
how do you do this well there's a number
of different ways that I know of to
generate documentation from the source
so for example angular io the
documentation you see on there is
generated by a tool called geni which
members of the angular team built and
this is a general-purpose documentation
tool they use it for angular wan docs as
well and it's not just the typescript
and i had to look through the the repo
that they used to generate and it and it
looks pretty complicated to setup but it
produces very good results another
option is to use a tool like type doc
which uses the typescript language
service to pass all the code and pull
out all the stuff and automatically
generate these docs this is a good way
to do it because you can trust the
typescript compiler essentially to give
you the right information the one
criticism I have of that kind of
approach often with is in general
auto-generated Doc's is they can end up
like really verbose and sometimes you
think I might as well just read the
source
anyway it's a good option another option
is to use regular expressions so so this
is a great approach if you have the idea
that the the problem is much simpler
than it actually is this is the idea
that I had when I was building these
docs
so we current
use this method to extract all this
metadata and if you also feel like you
would like to go down this path I've
saved some trouble and here is the
regular expression we use to pass a
component so the slides will be
available on a meet-up site so you can
copy and paste that yeah
very long t-shirt all right so
publishing so when you when you've built
your your library you got to think about
publishing it so it can actually be used
in a real application so there's a
there's a few different aspects which
are interesting to know about and to
consider when you come to publish any
any library really so how are you gonna
handle the styles you could transpile
the chat we we use sass to to write our
Styles you could convert it into CSS and
just export the CSS or you could leave
it as sass we decided to leave it as
sass and just you know the the consuming
library just has to assume it's sass the
advantage of that is it makes theming
easier because for those who know sass
they have the concept of default
variables and you can override them in
your app and it makes it quite nice to
theme things and change kind of certain
aspects
another thing is should you use global
styles or encapsulated Styles we use
global styles so we use view encapsulate
view encapsulation strategy nan and as
far as I can tell that's the only sane
way to do it for a library like this and
I checked with the angular material
library they do the same so it must be
right
the next consideration is how do you
explore the Java Script you know you can
export as commonjs modules now it's more
common - oh it's becoming more common to
exporters es modules using the
import/export syntax and the way that I
know the angular team recommend doing it
is using this thing
old flat ACMA script modules which is
kind of using exports and everything as
a necklace Egmore script module but
putting it all in one file that has
benefits for tree-shaking it makes it
means that can eliminate their code more
easily I think at the moment we don't
use that we're using a less
sophisticated method of export
JavaScript
another thing you have to do if you're
making a component library with angular
is you have to inline the templates you
can't use template URLs when an app when
an app consumes that component it won't
be able to find a template you attempt a
template referenced in a template URL so
you have to inline them all the tool
there are tools to automatically do this
we were using a gulp based build system
so we're using one called gulp inline ng
to template catchy name angular material
have a custom script which will just
kind of replace the template URL with
the actual text and of course if you
want to support ahead of time
compilation things get a whole lot more
complicated and you do need to support
this um has anyone got experienced
building a library that supports ahead
of time compilation yeah it's difficult
isn't it it's difficult there's a couple
of main things you need to think about
your library needs to produce these
metadata files which are produced by the
angular compiler ng C if you don't have
those no application will be able to use
your library in an alt context which is
pretty much useless because every
production app ships with alt support
now also you've got to make sure you
you're not using things like private
fields in the templates and all these
little kind of gotchas that you have
when you try to do a OT ok so a few
concluding thoughts
if you're gonna start a project now
there are lots of solid choices for UI
frameworks you don't need to write your
own but maintaining your own UI lib does
have benefits for example we might be
working on one of our UI apps and we
find a bug well then we can just jump
into the gen 6 UI core repo fix the bug
publish a new version to NPM and then
carry on with our day now if you are
using for example angular material I
think it would be hard to get all that
done in the same afternoon so the other
advantage is you have a very deep
understanding of the component library
it's not like a black box as it can be
when you're using someone else's code if
you do find you that you need to write
your own library then there is such
thing as the angular material component
dev kit has anyone heard of that ok yeah
a few of you so the basic idea is that
the angular material team they're
produced in a library which is extremely
high quality and they what they did is
they took some of the the kind of the
core parts and they extracted it out
into a development kit which you can use
to build any kind of UI library so it
handles things like making overlays
projecting content in the DOM scrolling
accessibility these kind of things that
you don't initially think of as imported
but actually become the most important
thing and the most buggy parts if you
try and do them yourself so the
component dev kit handles all those
things for you apparently I've never
used it but that's the idea if we were
to start again now and we had to write
our own I would probably seriously
consider using that and the last
interesting development in this area is
angular elements have you heard of that
ok it's a kind of experimental
technology that they've got going at the
moment and the basic idea is it it's a
way to allow you to export an angular
component as a web component a
self-contained web component so for
example you could build a select
component a fancy select component
just export it as a web component which
can then be used in any website in just
plain plain hosting my website in a
react app in a view app or whatever is
completely agnostic so this is under
development at the moment but I've read
some kind of hints from the angular team
recently that it will be something
available like prototypes are in
experimental in version 6 and possibly
released in version 7 so it's not too
far four maybe six months or so away and
this will be like a really huge thing if
you have a component like we do because
then it means that it becomes a
completely Universal front-end library
so if we have other teams in our company
who use in just not angular using any
kind of framework or no framework they
can use the same library so you can
build one UI library and angular and the
whole company can then use it in any
context so it's it's really exciting and
I think that could open up some like
massive possibilities okay so thank you
that's all I have V we're hiring I got
some comics sounds in there so yeah
that's it if you got any questions asked</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>