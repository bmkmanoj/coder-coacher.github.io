<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Vue.js, Authentication with Vue.js and Laravel, January 2018 | Coder Coacher - Coaching Coders</title><meta content="Vue.js, Authentication with Vue.js and Laravel, January 2018 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Pusher/">Pusher</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Vue.js, Authentication with Vue.js and Laravel, January 2018</b></h2><h5 class="post__date">2018-04-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/nZbtNGdVDi4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Philip I'm a CTO of bite
heroes we are the creators of the first
cryptocurrency of Austria which is
called hero coin with the ticker symbol
play and I have the honor to give a
little talk today about a topic which we
faced in the last few weeks it is about
authentication with laravel passport and
you chess what will I talk about I will
talk about first of all the backhand a
little bit about letter of Passport
what it is why using it how to use it
but I will not go in to great detail
because this is a beauteous Meetup and
let's have details about VG s and not
laravel of PHP here and then we are
looking at the front end at the
beauteous front and how to get the
access token from laravel passport how
to store it and how to use it first of
all what is laravel Passport it's an
OAuth 2 implementation over to is the
region ruler of authentication currently
Facebook Twitter Linkedin and all of the
services you use over to but the
implementation is quite complex and
difficult if you build it up from
scratch so passport is a full order to
server implementation and it uses the
league order to implementation as basis
and provides easy to learn and easy to
implement some drugs so you can import
you can use the aerial passport and have
a complete over to server implementation
into in your product in your project
I will not go until here just a short
explanation of what - what is it about
you
the application you have a resource
owner and first of all you need to
request to the resource owner which gets
back with a naturalization grant and
then the altar is a the application can
ask the authorization server with the
grant for an token and if everything is
correct the application gets a token
back and can access the the resource on
the server with this access token that's
the basic fundamental thing of order two
in detail it's much more complex so why
and when do you use lateral Passport
think about you want to separate your
back-end and front-end because this is
what we are currently doing or what we
have done the last few weeks and months
it makes sense to do this because you
can reuse your back-end with mobile
applications for Android iOS and your
web application your weapon front your
web from that so you do not have to
maintain multiple backends and this is
the sense of separating back-end from
front end and it's also currently best
practice so you should do it but if you
disconnect the backend from front end
normally you do not have sessions
anymore right you do not have a web
session where you can store your user in
because the backend is somewhere else
and therefore your you are implementing
an API and the API typically uses tokens
to authenticate users so every time when
you access the API you need to send API
token with it an access token so that
the back-end knows which user wants to
request the resource right so if you
have to need for a secure API or give
others a secure way to consume your API
then you need access to
once and then it's it makes sense to use
the word to implementation of lateral
passport so what are you doing if you
want to use lateral passport for first
of all you need to set up a lateral
project I will not go into into that but
if you have the laravel project you just
install laravel passport with composer
composes the package manager of laravel
and you just say composer require a
level passport and then this package is
included into your project as simple as
that
afterwards lateral passport needs some
data infrastructure so it needs tables
in your database and you simply need to
call the mic rate you need to execute
PHP artisan migrate and then all the
tables you need are in your database so
easy setup for this for this as well
afterwards we need some some encryption
keys and seeds the database with basic
data and therefore you would call PHP
artisan passport in stock and then we
have a look on the user model because
the user is the one which gets
authenticated so you need to extend your
user model with a trade which also comes
from a package and the trade is called
has API tokens and it enhances the
functionality of your user model so you
can call some functions like getting the
token or getting the user by the token
and something like that well needs
routes because you talk to routes okay
and to register this route you need to
call passport routes in the boot method
of your out service provider it's a
simple service provider of laravel which
is always there it's
only the one called you copy in there
and then all the routes are set up for
you all the routes you will need and at
the end and then you're finished with
setup and installing passport at the end
you need to say or to tell you or your
application that it should use API
tokens it just use passport when it
comes to authentication for your API so
you just go into the config file which
is called out dot pitch beam and set the
driver option at the API authentication
guard - Passport that's it that's the
simple setup for for a literal Passport
there's one problem we faced right at
the beginning because we made this setup
and we try to connect the front end with
the back end and I guess some of you
already know this access control allow
origin era it's the famous course
problem and what's missing here is that
we did not set the correct education had
us and that's also simple to do in
laravel I just wanted to show it to you
because we had to research for it a few
minutes maybe an hour to find it but
it's quite simple as I told you within
the auto service provider you just
copied the coop a spot routes to
register your routes and you can wrap it
into a route group with the middle
workhorse yeah your own you're telling
laravel that before going into the
routes of Passport go through the
middleware and within the middle where
you just define headers yeah so in a
pants headers to your request and then
you're good to go and the course problem
goes away right so think of that if you
have the course problem you just need a
middle way out to append the headers
which are needed
I want to show you I think it kind of
stopped the presentation somehow there
Robert does not work with this cape I
just want to show you this is this game
yeah thank you
oh sorry it's a problem for me because I
do not have the postman call here on
this laptop so yeah unfortunately I
can't show it to you I doesn't matter I
can't explain it I just need to start
the presentation again please I do not
work with LibreOffice does anyone here
okay so I'm not the only okay what I
wanted to show you was that I want to
want it to open postman I think most of
you know it it's just a simple
application where you can make calls to
an API get to post anything like that
and what I wanted to show you is that we
can post now if we have set up their own
passport we can post to the route Oh al
token it's automatically integrated
because you called already the passport
route command in the out service
provider and if you have setup granted
correctly then you will get the secret
correctly then you will get back an
access token and this is what I wanted
to show you that you can access the
resource user with the access token but
we will see it in the in the
presentation afterwards with you so
let's go on with you Jess so the back
end is finished now we have passbook
passport setup we have the course
middleware setup
so it's good to go now what we want to
do in the front end we want to use the
world pass password grant client it's
one grant client of the world
implementation and it's the one where
you send a username and a password and
get back an access token this is what we
want there are also other other grant
clients for machine to machine
communication for example but this is
the interesting one for normal logins we
use X yes how many of you know X yes
yeah so most of you it's a simple
package for creating calls to an API for
example or a web service and I think
it's a great one so I can recommend to
you using that and if we post to OAuth
token which I wanted to show you we need
to send some data with it we need to
send the grant type which is the
passport grant type we need to send the
client I did what is the client ID as I
told you before you have database tables
and if you call the command passport
install which we did then passport seeds
the stables and it seeds the clients so
after this comment you have two clients
in your database and one of this client
is the password grant client and
normally it has the ID too so we send in
grants type password and client ID - and
then this client has a client secret in
the database and you have just to copy
it and paste it here in in the front end
and then you are allowed to send data to
passport and passport checks your
username and
password you sent with it so this are
two data fields you additionally need if
this is correct passport checks if this
is correct in your database if it's
correct then you will get back the
access token and the access token is
needed for further requests how does it
look in code just simplify it if you
have a look there we have the login
function see the mouse know yeah after
login function with a user and some
passport which is a simple string input
and the users just a user object because
we are using typescript to to wrap the
data and then we make the call the post
call to our API endpoint this is simply
variable in our environment it's
localhost something yeah
plus the OAuth / token so what we are
doing now we're trying to get it open
and in this part here you can see that
we need to send the data which I talked
before we need to grant up client ID
client secret which is stored in
environment files and then we are
sending the user email and the password
which was the input of the user simple
as that
and now the question is what are we
doing with this access token because now
we are getting the access token but we
need the access token for further
requests also so what are we doing and I
think it's best practice currently is to
store this access token into the local
browser storage and this is what I
wanted to show you it's quite simple
with beauty s because you can just call
the button you can see it a set made out
and you can just call local storage set
item then you give the key and then the
token and we will see later in a short
video that the token is then stored in
the local storage and you can access it
whenever you want and it's also
persistent at the at the browser so a
very cool thing additionally of course
you can get it
it's got function above just with local
storage get item and the same key again
simple as that yeah here you can see the
complete function so we doing the login
we try to get an access token and in the
promise after that we save the access
token to the local storage
in addition here in this example we also
save if the user locked in with email
and password or with a social login like
Facebook something like that I will also
show that you would also get additional
data like the expiry date like the token
type which is normally birra birra token
and the Refresh token if you ask
yourself what is the Refresh token now
we don't we do not use it because if the
access token is expired then we force
the user to login again it's simply a
security feature for us but in the road
to implementation you have the
possibility if the token expires you can
generate a new token with the Refresh
token it's just a token which lasts a
little bit longer than the normal access
token and if your access token expires
you can get a new access token with the
Refresh token and you additionally
additionally also get a new refresh
token so in fact you can create a loop
where you can stay logged in but we do
not want this
so just for security reasons good this
is the use of the stored access token so
we have an interceptor here it's quite
cool in in Axios you can intercept your
exes calls and add something to the
calls before they are set to to the
internet and what we are doing here
every time when an access token is is
called exist XS call is made sorry then
we append the access token which we have
in the local storage to this call so
it's just a single point where you tell
your application always when you call
the API just add the access token ok
this is a short video please have a look
we try to log in now with email and
password it's a simple mock-up and you
will see then in the local storage and
the local storage afterwards we have the
access token in the local storage there
ok
it's called yeah it's called Texas token
the key is access token and you can see
the token in there ok we also store the
login type as I said the user locked in
with password and we store the token tab
it is piera
why do we do this because there are some
other token types but you need to add
this to your API call
the thing is passport wants you to add
the access token to the call and the
data property is named access token but
it expects you to write birra
then a white space and then the token ok
so for every one of you who never used
the or tokens just keep that in mind
cuz it's a point of failure and I came
across this because first I tried it
without fear and then I was wondering
why it was not working but a simple as
that at beer a wide space and then it's
working ok ok so we have covered normal
login if you know how to do it you can
setup this within maybe an hour so login
is quite simple but lately we faced a
little bit harder problem we wanted to
implement a social login we wanted to
implement a facebook login and there are
packages just for example this package
laravel socialite which is really great
and makes the Facebook looking quite
simple but they implemented it for the
use of applications where you do not
separate the back end from the front end
and where you have sessions this is the
core thing here so out-of-the-box
socialite works great but only if you
have sessions if you have an API you
have to do additional work and I just
want to briefly mention what we did but
also do not go into details
just to clarify social ad is also a
package which you can install our
composer and it helps you to alter it
authenticate with other world providers
supports Facebook Twitter Linkedin
Google github and so on so great but in
the end how do we get an access token
from social ads this was the question
for us and for normal log in with social
ad if you have no API you just place the
credentials and the config services for
example here github we are again in the
back hand by the way and then you have
to create some routing only to routes
you have to create the route for
redirect to use a to Facebook for
example and then the route which handles
the callback from Facebook again in a
controller for the routes you see the
two functions redirect to provider and
handle provide a callback it's as simple
as that
socialite does everything for you it
creates for you the route to the
provider to Facebook for example in the
first method and it gets for you the
user so it parses automatically the
callback from Facebook into a user
object really great so if you look at
the small picture here you have the
application triggers to log in gets the
redirect to Facebook then you have the
other indication process there they use
I have to accept the application and if
it is successful you get a Facebook code
back to your application social add
passes this code gets the user object
and you can for example register or
login this user into your application
that's the simple thing but if you have
an API it's a little bit more complex
you still can use socialite and it makes
sense but you have to do a little bit of
additional work because the front-end
triggers the login so the user clicks on
the Facebook button but then you have to
go back to your back-end to create this
redirect URL so you go to the API to
this socialite route get back the target
will redirect URL and the front-end
makes a redirect to Facebook after that
you have the authentication process
again but the code goes back to the
front end because the front end called
fail
spoke yeah not the API called Facebook
front head called Facebook because we
want the user to be redirected within
the front end yeah and then the front
end gets back the code the Facebook code
and you have to send again the Facebook
code to the API and the API now can
parse the code can create the user or
create an access token for a user and
sends back the X is token to the front
and the front then stores it again in
the local storage okay I hope you see
the difference here because of using of
an API it's simple when you know how to
do it but we needed to think about it
and there's not a lot of source on the
internet about this just again a short
video on how it's looking like currently
at our login page there you have the
Facebook button then this communication
with the API then you come back or you
come to Facebook authenticate yourself
come back to the front and from then
makes the call back to the API the API
creates the access token sends it back
to the front end and you soiled and in
the video at the top we have again this
access token in the local storage so we
are all 10 Takeda ghin good this was a
little presentation about authentication
I think there are some details would you
have to look up but if you know the
basics if you know the basics about a
world passport and Axios it's quite
simple to set it up in view chairs and
by the way in my opinion which is one of
the greatest JavaScript frameworks I
have ever used
so I'm really happy to talk here about
this and all my employees are also
really happy even those which programmed
react and angular before so just a side
note and another addition to
the viewers at the broadcast we are
currently hiring so if you're interested
we have a great team great place to work
please contact me I feel the contact
information are written down there
something so somewhere so please contact
me good that's it for me
from me so thank you and if you have any
questions please ask them afterwards</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>