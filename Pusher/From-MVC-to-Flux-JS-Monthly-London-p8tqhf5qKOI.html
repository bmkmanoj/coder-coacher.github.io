<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>From MVC to Flux - JS Monthly London | Coder Coacher - Coaching Coders</title><meta content="From MVC to Flux - JS Monthly London - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Pusher/">Pusher</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>From MVC to Flux - JS Monthly London</b></h2><h5 class="post__date">2016-08-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/p8tqhf5qKOI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Dinah sure I manage the
Meetup and I'm also going to give you a
talk about why and how we moved for
Memphis it flux because I don't know how
many of you are using sucks or redux
and how many of you watched the Facebook
presentation that explains why they
disliked NBC but if you have you may
have noticed that there's a couple of
gaps in how Facebook explained
everything which I'll try to feel we are
going to talk about a little about the
embassy background about the pattern
itself we're going to talk about the
problem with NBC and then I'll give an
introduction to flux and redux I wanted
to have few more code examples but I
don't think I have the time so we'll
have to keep that too a different talk
so let's get let's get started so
everyone what I've seen this before
right MVC is something that I assume
everyone's familiar with we have a three
component we have the model we have the
view we have the controller this
specific an example is from Wikipedia
which is a fairly reputable web source
and what happens is that the user
interacts with the view of the
controller which are takes the model
which updates the view and we've kind of
got used to seeing this except that if
you actually try to Google for MVC in
google images you'll see quite a few
other diagrams like this one
this is forms the staff website again
cellular putable arm you'll see that we
have a new data binding here that didn't
quite exist which means that the view
actually updates the model directly
which introduced exists in the previous
example which is a little strange
consuming that we're talking about the
same pattern but then of course you can
continue to look at other diagrams but
let's start from the very beginning I
got this comics today and I just I had
to share it because it fit quite well to
the UM
the day so the MVC pattern was first
created in 1979 nineteen and I was
trying to think about example on how
polka mean looked back then but of
course the Nintendo only came out about
four or five years later the first
website came up I think in 1990s
so about more than ten years later and
and you can only imagine the fact that
computer software back then was very
different and needed to handle different
challenges than what we see today but
but it's more than that it's the fact
that when MVC thought was first created
it wasn't technically called MVC it was
called mve because the controller was
actually an edit all um that you start
to realize that things have changed over
the years
MVC was designed with a very bored
definition in mind which is a little
vague so I'll take an example that
hopefully everyone knows how many of you
have used scrum before at your hands
most everyone I think scrum yeah um how
many of you have used planning poker
when using from which is the like to
shake poker cards that help you um point
up stories so post cards that most
people use in from isn't really part of
scrum it was never defined as part of
scrum it's just the best practice that
kind of seeped in and most people are
using it and since most of our seven
actually sit down to read about scrum we
kind of make an assumption that planning
poker is part of scrum and emphasis is
is quite similar so a lot of the
practices that we've seen used by
different frameworks aren't necessarily
part of MVC but have kind of crept in
because this is how we learn to use MVC
it doesn't also help the fact that
there's quite a few variant of MVC
online our mvvm which is the most
popular version for website which is
model view viewmodel but you also have
MVP which is Model View presenter and
which is presented model and they all
kind of talk about the same thing so we
are going to focus on the main thing
that is interesting for us and this is
that MDC was basically created to ensure
that there's a separation of concern
between the three core mechanics of the
app that the view layer the data layer
and the controller which does the
thinking which brings us nicely to the
problem that Facebook has raised when
they said they're moving from MVC to
flux um so this was showed by a guy
named Timothy no I'm doing the pink 2014
on Facebook f8 and they basically said
that MVC becomes more complicated and
less predictable the bigger the
application becomes and to put their
points they show this now the biggest
problem with with this diagram is that a
talks about a very very specific
implementation of MVC which isn't
necessarily correct or at least not part
of the core definition of MVC but it
does highlight one specific problematic
issue that NBC presents while MVC is
very good with a single component or
several components that work
independently as soon as you start to
have interconnected components you start
to create a cascading effect where a
single change in a single component may
affect multiple other components MC and
since every component managed itself you
have multiple handles arm which makes
basically two things that that are
highlighted the first thing is it's
really hard to debug if a single action
generates 1014 actions and you need to
debug what caused the bug under 14 jump
going back to the original action is
really impossible it's generally bigger
than the actual step that most browsers
will actually keep but but the bigger
problem
is the fact that the number of
components will affect the size of the
change chain so the more components you
add you don't just make your app more
complicated but by that component size
you make it more complicated by the
actual chain that's added to that
component the way Facebook decided to
solve this problem is by introducing a
fairly new way of managing data which is
called the flux architecture now the
flux architecture doesn't look that
different from the original MVC example
diagram that I've shown you from
Wikipedia but it does introduce a few
key changes arm that we're going to talk
about the first change sorry I can't see
my speaker notes which is like a more
challenging the first thing that the new
face labs architecture introduced is a
new dispatcher which doesn't really
exist in the MVC framework so the
dispatcher itself is a single gun arm
it's a basic pub/sub event aggregator
that manages the data flow between the
data between the view layer and the data
layer it receives actions from the view
or an AJAX call and the statute to the
store
and then it also the PM manages the
dependency between stores now there's a
little star there because flags can be
implemented in multiple ways and not all
of them have multiple stores but we'll
talk about that in a couple of minutes
the second concept which looks a lot
closer to MVC is what unsub call stores
so if MVC has a model layer flux has a
store layer and it sounds really similar
except that with flux you have
Singleton's s stores which means that
you don't instantiate one
so a one-component but instead have a
single component that covers a single
store that cover generally an entire
domain so the sidebar is a store not
every line in your table the second
change and that's a big change which
solves a lot of the problems with MVC
according to Facebook is the fact that
the solve themselves are in charge of
modifying data and not each individual
component that means that the view layer
introduces a change and ask the store to
update the data and the store seeds and
calculate what this change we mean to
the entire set of data for the entire
application and only when that entire
change is done we tell the view we're
okay you can pull the new variation of
the of the view the last part really is
the actions and the actions are very
simple javascript objects they have the
delta the change of the data that you
want to implement so if i want to change
the name of the field I'll just pass in
a field name and the string and it also
have the name of the action so the way
the stores know what to do is based on
the name of the action the type of
action that you've committed it's
generally created by either views or
adjective causal or anything else really
generally a synchronous and it has no
logic so it's just a plain object that
you pass to the store so views aren't
really defined properly by flux arm but
what you've seen implemented generally
with react is something called a
controller view which means that the
view also encompasses the code the basic
logic that requires to operate the
controller but this again can be
implemented in quite a few different
ways so slugs can be used with angular
can be used with backbone to various
degrees and the views listens to the
store change
so whenever store
is updated the entire data have been
updated um the views will know that an
updated update has occurred and we cool
the entire store data again and we do
not pull the Delta of the change we pull
the entire data in this ensures that we
always armed start from scratch
basically the entire component gets
rear-ended and again this is why we had
solved this problem by making the
comparison but this means that you don't
need to actually handle specific deltas
with interviews you just need to know
that your view will actually know how to
react to a complete new set of data
the views are also in charge of the
meeting actions to the dispatcher
so whenever a user makes an action you
don't actually change data directly
within a view you just make a request to
the dispatcher so let's talk about a
couple of the flat core concepts before
we move to redux so one way data so is
one of the main concepts that sucks
tries to introduce one-way data flow
isn't new to MVC but it is implemented
slightly differently here in the way
that the individual components don't
actually access the data or change the
data directly they have to always
request the source to do the update
floods prevents event chaining so if
doing an update in the store you try to
up to trigger another dispatch another
change request the dispatcher will brake
and tell you that you've committed an
error because one of the main things
that Facebook has tried to prevent using
flux is these chained action again the
entire state of the application is
resolved in eNOS stores before you fire
an update and the data manipulation only
happens in a single place versus having
multiple components each one determining
how data is manipulate
now the way Facebook decided to launch
flux is a little funny
so first Facebook released react which
was originally created to accommodate a
new framework called flux but they
totally sucked a little while later
without I think such initially had two
pages of documentation and no source
code and they slowly added its very
small library and okay I think a talk
and a half before abandoning sucks all
together so you have an official
Facebook flat library it's really nice
to play with it to understand core
principles of flux but it's also
completely unusable in life application
so I'll avoid it if I were you
I'm simply because it requires a lot of
boilerplate
there's allowing twenty other
implementations that people have created
over the years um quite a few of them
out nice I think the one that's been
dominating the market for the past year
plus is Redux which has a slightly
different take on the original flux
architecture and we're going to go over
the basic components are using Redux
simply because it's probably the best
way for you to UM start experimenting
with Lux
so this is the reducti adapter which is
kind of similar to flux but also has a
few changes so if you look the view and
actions are exactly the same as flux and
but we can see that the dispatcher has
been attached to the sol-gel and that
the store has something called the do
selves that have not been part of the
original flux implementation and let's
go over these new components and see how
we'll create them and what they do so
the three main changes again so zdenka
manipulation moves outside from the
stores and into something called the do
so this makes your abs mum it mode
easily maintainable and makes the store
a very simple object that only stores
data the other thing that we
does is moving the dispatcher within the
store seems to because they only have a
single store that's a single done and
the dispatch was a fairly thin component
to begin with and then the viewer action
remains the same we start by looking at
the redux store so as I said there's a
single store you have one of humongous
JavaScript object that holds all the
data for the application it looks a
little scary when you think about
initially but since most of the data
there is referenced and is kept between
changes it performs quite well it
encompasses the dispatcher and it has
three main functions so you have the
create store we accept the reduce of the
functions that actually manipulate the
data and can optionally also accept
initial data which is data you get
generally from the server so if you load
the users details in advance you can
pre-populate your stores with whatever
settings the user to JoVE but again this
is a an optional variable we have the
store subscribe which the actual which
actually informs the view layer when
they need to a lender so multiple views
will subscribe through that and you have
the store dispatch which basically
allows the views to update the store or
request the store to update itself the
reducers is where the actual logic of
the entire app resides
so if the store is a very simple
JavaScript object with a little bit of
event handling our interview is is
something that you kind of control
however you want cuz Lux all the dots
don't really care but usual is where you
actually take the changes and make an
implement the logic now reduces of
something that's called pure functions
which comes from functional programming
which is if you haven't tell the
sniffing about JavaScript and we all
need to use it until about a week from
now when when the new best thing will
come out and we forget about functional
programming altogether but for now the
idea is that functions don't mutate
State so instead of using object classes
or objects prototypes and manipulating
the data within an object you have
functions that receive a state and
return a new state without actually
making any changes to the data but more
importantly they have also no external
dependencies the best example I always
use is data time if your function relies
on time which changes between every call
your function is in pew because it will
give different results based on the time
of day we actually made the call and so
you want the function that we already
done the same data when it receives a
set of fixed data if you want to look at
a simple example of a reducer this is I
think from the Redux website and we can
see how we get to simple actions and the
default I'll highlight a few important
things so you always need to have a
default state um you can see that in the
function to do state equals an empty
array so this is an atmosphere mutation
that allows you to pre-populate I'm
giving a default of value to variable if
you don't want to use it you can have an
if state is undefined
and you can populate it there to switch
in something that people don't really
like but it existed within flux before
we does so this entire thing used to
exist within the sub store and will
simply pull out and place within a
separate function called a reducer um
and as you can see it basically matches
the state the action with the types of
action that you support and then
triggers whatever computation you want
to do and returns a new state and this
is important you do not want to modify
the existing state that you got with the
with the reducer you want to return a
new one and I see a lot of people make
this mistake because a lot of the
JavaScript arm methods that you could
you get with arrays like array dot push
actually manipulates the original set of
data and doesn't actually return a new
set of a new set of arrays in that case
to avoid that there is an excellent
website I didn't at the link that tells
you how to replace all of these
functions with your own solutions that
are non-destructive um you can also use
something like loader show underscore
that does it quite well it's also worth
noting that even if you modify the data
and return the existing store flag there
Redux
isn't really going to break they don't
enforce it but it helps performance
quite severely especially if you're
using react and there might be some
oddish side effects because Redux
and react have a more difficult time to
detect that the change happen when you
change a object versus we turn a new one
finally um you always need to have a
default stay in action because if
someone forgot to actually implement
this new action that you're sending you
don't want the app to break you just
want to ignore it and return the same um
the same object we generally have a
console log or an arrow in reported here
just so we know that those are problem
so having good users is is really
amazing because you took the DD logic
out of the source and you can now have a
much more modular application but having
all the logic inside a single humongous
seducer isn't really a great idea and
the way that Redux allows you to solve
this is by using something something
they call a combined with yourself which
basically creates a new reducer that
knows how to send actions to
different to a object of different
producers that you've created based on
their keys so if you have data
manipulation on something called to do
like the previous one it'll know how to
do the matching and will automatically
pass actions that are relevant to that
type of to that reducer automatically it
makes the app much more manageable and
you don't actually need to do anything
to use this combined with users it kind
of comes automatically with redux um
yeah so to show how this all work
together again I've stolen this because
it was just so nice um so as you can see
a user clicks on a view which creates an
action which comes to the dispatcher
that the statute passes both the action
and a new copy of the state to the user
and that creates a new state happy-ish
so let's talk about a few other things
and then wrap it up
so the creator of redux has created 30
amazing videos that explains how to
practically use redux and this is
probably the best source of tutorials
you can find online I know quite a few
people avoid videos because they take
longer but if you have the hour also it
takes go through most of them I highly
recommend it and it also goes goes
through how each one of the components
within redux have been created that
comes with a built-in react integration
I didn't really cover it because it's
not really it's been used much more
broadly than just with react and I
didn't think that's the best way to
introduce the framework um and while you
can use Redux without at school there's
nothing that prevents it everyone can
use
a help of mayhem library called redux
thunk this kind of makes making a
synchronous calls with redux much
simpler</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>