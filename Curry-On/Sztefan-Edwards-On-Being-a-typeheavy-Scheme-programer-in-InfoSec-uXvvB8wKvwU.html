<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Sztefan Edwards - On Being a type-heavy Scheme programer in InfoSec | Coder Coacher - Coaching Coders</title><meta content="Sztefan Edwards - On Being a type-heavy Scheme programer in InfoSec - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Curry-On/">Curry On!</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Sztefan Edwards - On Being a type-heavy Scheme programer in InfoSec</b></h2><h5 class="post__date">2017-06-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/uXvvB8wKvwU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">well they very much everyone my name is
Stefan Edwards I'll be talking about
basically the direction unwilling as a
programmer who works in info suck and
what I do is obviously very different
from what most other folks do at this
conference so it might be interesting
may not be but basically this is how I
hate everything that I do except for
type systems because you know they'll
make my life a little bit easier um but
as I said my name is Stefan Edwards I
work for a great company called
enthusiam I'm saying that because they
paid me to be here so I have to say that
but you can basically find me as logical
on github Twitter lobster etc but in
this game is great because we do app
sack we break applications we find flaws
we're also really big Scala shop so one
of the things that I liked when I came
over was that Jack our CEO was a big
Scala head so we could actually talk I
actually didn't really know Scala up
until I wrote this talk so and we'll get
into why but basically you know
investing is a is a scholar company and
it's one of the directions that we're
going in InfoSec both from a defensive
side as well as an offensive side just a
warning
I'm actually hard of hearing so if I ask
you to repeat your question like 17
times it has nothing to do with you it's
it's me I lost my hearing as a child so
I have that problem and also I'm from
New York so very often if I'm talking
really fast that it might get really
awkward because you know I'm thinking
about something else but you know you
may not actually understand what I'm
saying so if I'm talking too fast or if
my accent is too thick just flagged me
down but basically the too long didn't
watch with this talk is that I want to
model violence I want to model what I do
as an attacker instead of instead of
going through the things that we and
InfoSec normally do when we come up with
these really hacky really terrible
approaches to breaking software I wanted
to come up with something a little bit
more formalized but the thing is is that
in InfoSec especially with what I do
we have more than one week to do what I
have to do so if a customer asks me to
come in and do something I really have a
week from 9 a.m. on Monday until 1700 on
Friday to break that doesn't matter what
it is right so I have to figure out what
I'm doing that and I work with teams of
very smart folks and we work really hard
on these sorts of things but we have a
week now the week is important because I
actually pressed myself to learn and
write this entire talk and scallop in a
week so starting on Sunday a week ago I
picked up actually working in Scala and
now I'm here so we'll see how far we can
get into it and the reason why I want to
talk about this is because I write a ton
of tools most of my job is actually
writing tools for myself my own
consumption so for example last week I
was actually on site at a client and I
was writing protocol fuzzers they had a
bespoke wire protocol written in C and
we were on site to see if we could fuzz
that and break anything in it see how
far we could get right these are the
sorts of projects that I end up doing
I've written static analysis tools
whilst on site client asked me to find
logic problems right what's the easiest
way to do that is to scan all the code
so I scan all the code for date because
they had issues with dates with a
developer leaving at a very specific
date and making that very well-known so
we've written those sorts of tools and
the last thing I constantly write is
documentation generators and I write
pipes of things to off to grep to set to
rewrite it into markdown to spit into
our risk management system so these
sorts of things are run constantly
writing and I write them in the most
terrible way most of the time and I
really owe trip
the developer left that particular they
made this moment he said like I hired
you notice I'm leaving on July the fall
yes literally so the the client had
actually asked us to look at a it was
something like 2.5 million lines of
Python to actually look at that with the
focus of so-and-so is leaving on this
date and this person is core to our
development team and this is an
existential threat to us as a business
so figure out what this was and that was
a team of eight people looking at this
Python code so which that had a long
cacophonous symphony of failure as well
but basically what I what I do is is
adversarial testing right so if we
wanted to take an adversarial testing as
an example we can use this one client
called website to do a malicious code
review I come on site and I walked out
with two point three gigs of source code
from them I walked that with their red
team manual I walked out with all of
their banking information all their FTP
credentials all of their internal
database credentials all their internal
hosts and I started locking in patient
from the person I was working with so
these are the sorts of things that I I
do right now the the problem is is that
I have to then explain to them how I got
what I did right so for that example
when the application booted it hit a
specific server to do something I didn't
know what it was doing and actually what
it was hitting with CBS if you remember
CBS as was a predecessor to SVM is it a
source code repository right and
basically from from access to just
booting up the application I was able to
grab all of their source code and they
had no network monitoring that would
stop me so that's the sort of thing that
I do I do these sorts of assessments now
where can't adversarial is I don't
necessarily know anything about the
client I may know a client name and then
have to go find out all the rest of the
information that I do so for example we
may have a client that comes in and says
you know our domain is
you know such and such XYZ find out
everything that you can about us and
then find out a bunch of stuff we run a
bunch of tools part of which all of this
played today and I deliver that
information back to the client so this
is my basic workflow right I recon
anything that I can see in assets
those can be languages so for example a
really great thing that I like to do is
what your developer postings are so if I
see if you don't want to tell me what
languages you use internally I'll
actually look at who you're hiring for
and see that you're hiring for Scala
developers who happen to have a
background in spring and then I will
focus my exploits against that for
example so my recon purposes can be
anything from all of your hiring
practices all the way through to what
your network looks like and what your
applications look like what source code
I can find from you and then basically I
take that and feed it into the rest of
the process now what I want to do and
what I've been trying and what Jack and
I and others at in dision have been
working on is to actually machine this
entire workflow so this is this 801 15
if you're familiar with the NIST series
this is the actual workflow that you're
supposed to do for technical assessments
so this is the direction that I'm going
in this scene we have a slightly
different one but I come from that semi
government background and when I'm doing
oh sure
so it actually depends on what we're
doing for that assessment so if we are
doing a like a small network assessment
it might actually just be a few hours
because we still again only have a
week's worth of time maybe two weeks
worth of time so you know when a good
friend of mine who we work together
David Corsi he and I were on an
assessment and client had been hacked
right our reconnaissance flow was an
hour before we figured out the general
direction that you could take to get
into their network now that was because
it was painfully obvious right but you
know we may only have a handful of hours
now we do have longer assessments where
we have months to do that sort of thing
but that's very rare and generally that
generates huge amounts of data so when
I'm writing tools I'm generally on the
unit command line right these are tiny
tools that I pipe into other tools and I
keep piping and building things out and
they're generally around 100 lines of
code let's say right this is to you know
rip apart and maps can rip apart some
SAS rip apart something from their
application so this week I decided and
what I was was shooting for was to see
if I could write some of the similar
tools that I do for myself in like
Python C Ruby shell etc and come up with
the same things in Scala
letting really know Scala so I thought
would be an interesting challenge so
this week I wrote a DNS enumerator a
port scanner a full HTTP stack CSRF cruz
with concept generator so CSRF is a
vulnerability that we'll discuss later
on and a web spider these are these are
terrible the quality is not something
that I would ever want to push out like
I wouldn't want other people using these
but the point was to see if I can get
the same density of code and the same
style from something that I put a
modicum of effort into so let's talk
enumeration right very often people put
things out on the internet that they
should have that's the entire point
right so when when we're doing these
sorts of assessments we're looking to
see what other information accidentally
put out there so one of the ones that I
love to find is test dub dub dub origin
dub dub dub
so they'll have something like Akamai or
cloud fair in front of what they their
application and then they will have
accidentally exposed externally their
origin server which does not have the
same protections right so I can do an
end run around there off and start to
attack that application so when we're
doing DNS enumeration we're actually
forcing all of the DNS names that we can
find so we will try to have depth of 0
the one that the New York other sorts of
things and we generally write tools to
do this we have question Oh anyone just
means go around to avoid it in a waffle
web application firewall so it's a
firewall that actually sits at layer 7
on the OSI model right so basically it
sits and reads HTTP traffic and says yes
this traffic is good no that traffic's
bad so unlike a regular firewall which
sits you know down at TCP or below this
will actually be up right at the top and
will block those sorts or block those
sorts of attacks so so when we can n
runaround them from DNS it means that we
can just literally bypass them and have
raw application access which we should
does that answer your question
yes so I write tools like this this is
actually from an assessment it's a
Python program that reads in a list of
prefixes that have been lunged together
from things I extracted from a client
right so I extracted some of their names
I mixed in some common DNS names and
then put them together into this Python
script this Python script generates a
shell script the shell script generates
another file that file is then read by C
and stuck into sequel light so that the
rest of my processes can work with this
which is awful right it's a tired of the
process it's super broken but it works I
was able to find
number of hosts this client had been
hiding out there in DNS just by this
this is the sort of stuff that we do to
break your applications to break your
systems there's nothing actually
interesting it's just a bunch of shell
commands string together but that's the
attack surface that we have so as I said
we generate that shell script and stick
it out and end up with a full report on
that client on everything that we were
able to enumerate just from those so a
bunch of terrible Python and shell
expressions together gives us access to
things that we shouldn't have access to
now there's a couple problems with this
its vulnerability focused instead of
security focused and I make that
distinction because security is actually
a correctness problem it's not a problem
of finding or playing whack-a-mole with
us so red team should be should be
finding issues absolutely but blue team
should be designing things they should
not be just patching the vulnerabilities
that we find and sit you so very often
when you are coming up with issues when
we come up with issues and we provide
them back to blue team they run out and
patch those issues but then we run into
situations where we give them an example
expression let's say and then they
literally take that example expression
and block that in the application not
the root cause of the problem so we give
them script alert one from JavaScript
and they go into their application and
block script alert on so we end up with
these tiny collections occurred that
have no documentation I mean God forbid
I have to explain what I did six months
ago to actually break into something if
I haven't documented that I'm out of
luck I usually end up just recreating it
honestly the tools are like a hundred
lines there's no typing information so
very often like I have a colleague Brian
he very often does a lot of my my peer
reviews and he'll come up and he'll say
hey this looks great
but you absolutely put the host name one
column over and I'll be laughing back oh
yeah that's right for that tool I have
to actually put it into this other
format there's a said script I'm missing
it's terrible and coming up in the
actual execution path that we have to
have here is atrocious it's really
painful it's basically me scribbling
down in notes outside of the system to
see what else we can come up with so
it's how many companies take the
vulnerabilities versus those that all we
have security issues yes it is 100% take
the patch vulnerability it's a foe okay
99.9 repeating take the patch approach
versus actual design design cost money
all of us are very expensive people in
this room doesn't matter what position
you do right in order to actually get
like a real blue team focus with design
and all the PLT nerds and stuff that you
want that costs money right that's those
are costs inks right security is very
often viewed as a cost sink right so
it's easier to just tell your system in
to put a wofe in front of something that
I found versus to have you know a bunch
of actual smart people fix that issue
from the design going forward we not
only have repeated contracts but will
very often just deliver the same report
it will be no different I mean it's
funny right the first time is like haha
the third time you just want to drink I
mean there's really there's really
nothing that you want to do
I tell you that all this company that we
service was I know yeah sure so the
question is like you know how much how
much sure this is is us not relying that
into relating that information properly
to them and how yeah so I work with a
really great company I can't say their
name obviously but I you know we chat on
Twitter often really great guy and he
and I have talked about this because
we've all seen this right security
security very often goes to management
and has to say hey we have this issue
right now his management is very
accepting of that so he gets he gets
very far with that but when I go to
other clients and I go to other
customers they very often can look at
something and say weeks up that risk and
it's it's understandable right I may
come up with something that is for me a
problem right hey look I can XSS anyone
and I did this path to to do so right I
can do XY and Z and end up with some
information that I shouldn't have but at
the end of the day I can only say what I
saw in the application I can't take it a
business sensitive contextualized output
and actually render render what the
problem is in light of their expenses
these are businesses right so they may
have vulnerabilities that are there but
that it's not it's not worth it for them
to fix at this time or they may be they
may have something that they want to fix
you know six months from now they're
doing a new release they you know they
don't want to fix it now so it can be
very difficult to get into
absolutely
so openness is the case that you tell a
company that they're using another
version of some audio in their web
application but they say now that what
we want update and then you do again a
report in two years and say okay this
exercise women are businesses oh oh oh
it's yet super frequent and we have
customers that are but everyone familiar
with struts yes so we actually have
customers that are still running ancient
versions of struts one so not even like
late versions of struts one ancient sure
also struts is a is a Java app is a Java
library for basically wiring up models
to views and things like that
and it has a number of flaws especially
in struts one and you know my last my
previous company this company we have
clients that will stick to struts one
because they're not going to update that
application so yes frequently all the
time so basically when I'm talking with
customers very often I talk about types
and shapes and models and correctness
and all those sorts of things so I
thought why don't I start to apply that
to my side rather than to just their
side and this is the reason why so does
everyone know what the e-tag header is
so etag is a header on HTTP responses
that tells you that the content is of a
specific size and you basically when you
issue an HTTP request you can include
this etag header to say hey have I seen
this piece of content before yes or no
and the server can read that e tag back
and say yes you have and then not
actually deliver the rest of the content
right so the problem is that eat acts
can be used for all sorts of things such
as enumerated the number of hosts and a
cluster that's what I usually use it for
it and I have a toolkit Levitz
which basically reads in output from
other tools and spits out a report for
me and this is what I ended up doing for
a client to find all the servers that I
could that had
Tagg vulnerabilities so that I could
enumerate all the hosts that they had in
their entire cluster was this it's
terrible if you didn't know what this
was like if I try to hand this off to
one of my colleagues they would throw
their hands up and trying to pass it out
now would be problematic as well so I'm
trying to get away from this so
functional programming is very well
known for designs very well known for
like for thinking coming up with very
small impactful changes right but I
wanted to see if I could get the same
code density as I'm getting with Python
with C with shell etc NFP with types
that are better than being strongly
typed like I do right now right so I was
trying to see if in a week without
really thinking about it if I could come
up with types and methods and functions
that would work so I gave myself about a
week I started on Sunday of last week
and I learned Scala
I have a background in Oh camel and
scheme and F sharp and things like that
so it wasn't a huge stretch for me but I
just really wanted to see how far into
it we could actually get right so I you
know I did it roughly I was pretty happy
with it there were a few pain points
along the way but it was mostly me like
mashing at the keyboard to come up with
things but basically I wrote about seven
hundred lines of Scala in this week to
do my workflow with documentation and to
actually go from DNS all the way through
to web exploitation in the types of
terrible like I I was working on it last
night a little bit and I realized that
there were several reef actors I could
do but the nice thing about it is I can
refactor without having to like pull my
hair out the entire time whilst trying
to figure out why this thing is over
here now all of a sudden so I want to go
from these hacky processes these unclean
very very you know very difficult
processes that I have been doing and in
hand your head towards an actual like
modeled under
chain of attacks that I can demo to a
client and this is what I'm going for
right we have some sort of process that
we have like mist 800 115 mist 861 is
for incidence responders right and it's
mist 860 is also in that process for the
overwatch top 10 anyone familiar with
what a wasp is okay we have a few hands
that's that's a little more common than
the other things I've been talking about
basically the top 10 is a list of
vulnerabilities that a wasp feels should
be you know displayed there's some
political commentary that I won't get
into but basically I want to have simple
processes that I can pipe into one
another and come up with typed issues
and typed results that I can then
provide to a client afterwards instead
of a bunch of strings and a bunch of
data output and a bunch of terribleness
I can then provide them actual typed
examples and acts that can extract
information from these and sure I cannot
hear you whatsoever one side up there
the pipe some lime tree that looks like
Oh camel yeah
so I originally was going to do the
talking Oh camel I was like no I'll do
this in Scala that will be more fun but
but basically I wanted to see if I could
and that's also why there's a pipe angle
bracket there as well
I missed that a lot this week whilst
programming in Scala
but basically you know I want to get
down to this level where I could I could
have similar processes to what we have
but I can also come up with you know I
could come up with something that is
better than what I did
sure so what you're doing is basically
the old unique self uh blonde
composition
actually talked to Robin lovest
sub-strings example yeah correct exactly
and this is not an interesting talk I
mean like there's no interesting data
that's coming out of this like I did not
I didn't even have to use monads for
most of what I was doing like you know I
don't have to explain semigroups to my
co-workers I don't have to do anything I
can I can literally just give them a
list of type definitions and a bunch of
functions and it works and that's what I
was aiming for right we could all go to
a really theoretical place with this we
could come up with some like really
awesome model for security and I could
relay all that information to be really
awesome but it wouldn't be necessarily
useful for like providing out into the
wider scheme for us as InfoSec yes so we
use SCADA heavily internally we actually
have a we're working on a view platform
that's based off of Scala but internally
actually our pipeline we have a bunch of
Python folks we have a bunch of go folks
we have Scylla we have Ruby including
one very vocal rubyist but we we
basically have a bunch of languages that
we use I write stuff in whatever I feel
like my co-workers hate me but you know
I provide weather that I can so yes
I only heard the first part your
question so so the question is that
gives Scala and those types of things
inherently slower is that about right in
terms of development cycle yes
absolutely so I wrote about seven
hundred lines of Scala this week with
types that flowed basically from you
could flow from DNS to network scans to
HTTP exploits so from my perspective I
didn't find the I didn't find it that
much slower in fact I caught bugs in my
own logic that I normally would have to
like catch afterwards when I'm reporting
and Brian yells at me or Dave Corsi
yells at night because my reports are
messed up so I actually can it was
actually kind of neat to catch that
stuff ahead of time because this is like
the you know epiphany moment that I try
to saw on customers too so that's that
was whatever what I was aiming for to
see if it was slower and whatnot and I
don't really think it was now I come
from an FP background right I've been
programming in scheme since I was
fifteen so what is that 17 years right I
have my own scheme system I've delivered
scheme to clients right
so you know I have that background
obviously so ramp up there would be
interesting but I don't think it would
be any worse than say picking up rust or
picking up any other like heavily typed
language that we're heading towards in
InfoSec anyway so I'm sorry yeah
I can't hear it all right can you hear
me yes following up changes so you have
something already built um say it in
shell you're in your terminal you run it
you need to make a change you just do it
like hack it and run it what else caller
you need to compile things right well
that that was more the original question
yeah so in
I'm trying like I was trying to make
sure that the types make me be better to
make me pipeline things the way that I
expected them to and if I could be
pipeline them the way that I was
expecting them to I change them so that
cycle of feedback was much nicer for me
whereas in shell if you're familiar with
shell all very often be like being 512
to rerun that command again or load up
the previous command with carrot rewrite
can't rewrite something else I don't
know how much UNIX people actually want
to use here but you know basically I end
up rewriting a bunch of shell commands
very terribly or you're going to my my
output directory and they'll be like
fuzz 0 fuzz 1 new fuzz like you know you
just hack it and get it done was I was
trying to avoid those sorts of
situations here I was only using my
business so I kept funny that you asked
that I wanted to implement it in pure
Scala so there is a pure Scala TCP
connect scanning engine in here there is
a pure Scala HTTP client all that jazz
but the interesting thing that I was
thinking about is that there would be no
difference between shelling out or you
know if you actually implemented the
types properly and implemented the
processes properly there would be no
difference between those two because you
could extract the same information from
both and type them and then provide the
same pipeline afterwards which is what I
was aiming for so as I said I wrote
these things where we have roughly it's
not ten minutes so let's actually just
skip so this is this is part of what I
was writing and in fact your question
comes up right here I was thinking about
this as well because I wanted to know I
very often use dig it's a UNIX
command-line tool for for creating DNS
servers so for example I might be on
site I see something has a DNS server
and I thought oh that's interesting what
information do you hold for me so you
having dig there would be very
interesting but I also wanted to have
total one that I didn't have to rely on
dig itself as well so the neat thing
that I saw coming out of this was that I
could come up with the same processes
for both and not have to do any other
separate processing there and still have
the type system enforce me so that I
know that my pipeline is working as I
expected it to so this is basically my
entire process for it obviously
implementation is left undefined but you
can basically come in and read and
understand what I'm attempting to do
here I'm attempting to generate a bunch
of names and then query them that's it
nothing complicated right and what I
thought was really interesting about
this was that my attach can then start
to equal my models or be congruent to my
models mod some sort of harm right so
for example very often clients will say
to me but what HTTP request was the one
that actually caused that issue I look
at them and say I have no idea here's a
bunch of them
try these it's one of these guys I know
it so what I can do now is I can
actually start to collect those sort of
processes together and instead of giving
them a bunch of Python scripts or
instead of giving them requests that we
think work we can actually give them an
entire tight flow and extract that and
again we can come up with one set of
documentation tools one set of
processing tools that are simple and
composable that we can actually spit out
and receive that same information
now I'm rushing a bit because I actually
wanted to play a game with yous so has
anyone heard of a capture the flag
before right so capture the flag is
basically someone has designed an
intentionally vulnerable service right
so there's one running on our logical
comm so the point here is to do some
service discovery figure out where
that's running if you want to play you
shouldn't watch the rest of the talk if
you've got that service discovery and
and then parlay the other
vulnerabilities here to actually steal a
cookie so there is same site request
forgery
on that app so same site request forgery
basically means that you can trick the
app into issuing a post request or any
request really but post in this case a
post request to the server itself right
but you can't do cross-site so you can't
spin up your own site have a victim view
that and then have a request go there
there's self XSS which means that you
can actually exercise yourself but you
cannot actually XSS anyone else and then
there's a cookie without a session
cookie without you should pee on me sit
on it does anyone know what HTTP only is
okay HTTP only means that a browser does
not expose that cookie to JavaScript so
basically an attacker has to do other
things to to capture that cookie so
there's a game here if you want to fly
it you can try see if you can come up
with a model for how to exploit this
right what I did was this I queried
found a bunch of hosts ran the internal
port scanner against it since I didn't
want to run and mat against it found
that the service was running on port
8080 right so there was a bunch of other
hosts that we scan or punch out of
course that we scan that weren't open
and so I'm curious as to what 8080 is
because that's always fun right nothing
nothing unfund ever runs on 8080 and I
generated this now obviously I did a
bunch of like oh you know HTTP get my
target robot right and go through and
expose what those are but the basic
proof of concept here is this I came up
with these these are my my targets out
of that list of scans and these are the
T requests that I needed to do to
basically test where I was so as you can
see I had a responsive 303's the other
it's it's telling me go login so here is
the actual exploit I did not put the
payload in here though so if you're
actually curious don't read the github
repository which I will open after this
but this is this is my model now what's
actually
first thing about this is barring
cookies if I provided this to a client I
could also extract the HTTP requests out
of this so not only do I have the
information that I provided that the
this was the order in which things were
done I also have the the actual HTTP
requests themselves I don't have to then
look through any part of history or
anything of this way
I can start to extract models of what
the type flow was of what the attack
flow was and to actually come up with it
now as to whether or not this was slower
or not a lot of these sums afterwards I
was like oh clearly I should have just
used something else because I can you
know this is really annoying to have to
say some for all of these but I could
also extract those methods I could make
things higher-level or I could just come
up with a different model but it works
pretty well for me I found it pretty
interesting oh it did actually I did put
the payload in your ha Y so this was the
actual payload that I had come up with
this is the SS RF itself you cause the
the you put in a form that causes the
search system to actually XSS you after
you interact with the search system
itself or interact with the survey
system itself and this is the actual
resulting payload so we went from DNS
trying to find service to scanning this
to looking for this and coming up with
these two these are the actual things
that are problematic now normally me as
an a as a red teamer this is what I
provide this is what I would tell you
I'd be like I did that form and it did
this thing and now you're broke and
that's it but what I'm looking for is to
actually be able to provide them more
useful information where they can start
to see the flow they can start to see
the pipes they can start to see that you
know those sorts of attacks as they went
through the application itself so future
directions I'd really like to do
architecture this way so I do a lot of
what are called security architecture
reviews so client comes in is like hey
this is my AWS system what do you think
it'll be like it's broken and but I'd
really love to be able to point
out in parts like let's say you know
parse some of their definitions right
parse vagrant parse anything that they
have there come up with a model and they
compare it to what they're actually
doing in their architecture diagram so
that code then becomes your ard or your
architecture diagram and that we can
actually start to assign types to data
flows so for example if you have a
background connection that is a database
connection you're not using TLS on that
we can actually flag that itself and
then in busy M as I had mentioned we
ourselves are moving towards an actual
service pipeline where are moving
towards hybrid testing so rather than a
lot of the manual things that we
necessarily do a lot of these things
will absolutely run in a service and we
use Scala and akka and all sorts of cool
stuff to do that so that you have a sort
of like expert system remember expert
systems ok so we have a sort of like
knowledge base that continuously feeds
back into what you're doing there as
well as what the system itself
understands and knows about oh no did I
not I didn't even expect to make you
this far so I didn't have a questions in
thank you slide but so thank you very
much everyone
does anyone have any closing questions
or anything before we go can you get a
mic no second year I apologize it's just
that I want you to repeat yourself seven
times and then I'll still look around
the room yeah thank you for this is
really yeah it's a lot of information I
understand that I'd like spraying you
all with the firehose here but so do you
do any work with government agencies
huddle I used to I no longer working
overhead I read listen about how they
tend to focus a lot more on attacking
rather than designing for security
government Yeah right so I would
honestly say that the here's the thing
government is is they have very heavy
design processes they have a lot of
these safety procedures in place so you
can come up against one of the best
design system
but you can also come up against one of
the best design flaws as well if that
makes sense so there's a lot they don't
focus on attacking per se unless you
work in eyes intelligence community
types of stuff they thought they do do a
lot of design but it's it's it can be
some of the most amazing design and it
can also be like oh here is 17 million
lines of rational roads
you remember rational rows right right
no I was five when rational roads came
out
I don't know rational rows but okay so
but I'm sorry you know yeah I just want
to hear your thoughts on what kind of
process I mean government has some of
the best attackers out there absolutely
they also pay a lot of money for
exploits so if anyone has an exploit you
can sell it to you know any of those
great shadowy brokers but you know they
also do focused quite a bit on design
it's just if that design is effective or
not
so which in my case I have largely seen
it be effective there would be layers of
controls so for example it took me like
three days to be able to plug into the
network to test something to have no
vulnerabilities and I had two weeks to
do that so it was like two weeks of
throwing everything I can think about
this application where by the way in
order to get to this application you
have to bypass all the dudes with guns
outside and then get into the building
which has like you know cards and then
once you get past those things then you
can also plug in maybe to the network
maybe so
yeah yes its layers of design all right
thanks a little crush of course
I think there's one in back and we'll
get you high what is really up and when
they stop you walking inside a building
what should happen yeah what usually
happen as you don't belong there usually
it's not the security guard like if I'm
doing a physical test or something yeah
so honestly usually physical tests for
me or because I made it into a physical
test because you made me came on site so
why not so it's usually been
exposing myself to the to the actual
security point of contact and being like
hey by the way this is a selfie of me
with your servers or or calling and
being like hey by the way that closet
that includes all that classified
telecommunications equipment that's
actually unlocked and I'm standing in it
right now so it's usually that it's
usually self-exposure
I've been caught a few times it's
usually by like secretaries someone who
is like wait a minute I've never seen
him here before what are you doing here
it's like I just walked in you know
envision ourselves we mostly do most of
our physical stuff is outsourced to a
company called lares which a good friend
of mine works there Dan Ahmadiyya and
it's a it's super interesting they
always here is his discussion is because
he's actually paid to do this I just
make my job cuz I'm that guy but it's
super interesting to hear what he's
talking about when he gets into those
sorts of things did you have one
question as well okay chuckle let's use
the girl thing right but</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>