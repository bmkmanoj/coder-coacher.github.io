<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Configuring an IPSec VPN for secure file transfers | Coder Coacher - Coaching Coders</title><meta content="Configuring an IPSec VPN for secure file transfers - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/RealToughCandy/">RealToughCandy</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Configuring an IPSec VPN for secure file transfers</b></h2><h5 class="post__date">2017-03-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/LNaRb-1zGoc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey everybody real tough candy from real
tough candy calm back in the saddle with
you today we are configuring a VPN
client for secure file transfers now
yesterday's tutorial walkthrough we did
the same thing we're going to be doing
today only it was on a linux server
today it's going to be on a windows
client now this is the cool thing about
VPNs is that you don't have to match
operating systems or server to server it
can be a diverse array of mismatched
technologies and operating systems and
so on so that's one cool thing about VPN
technology and again we're doing a if
sec VPN today there's different
varieties of VPN some of you most of you
may know vax you know ssl pptp l2 DP do
they get that one night point being
there's various flavors if you want to
call them that of VPN what is the word
I'm going for with that protocols
there's various protocols we can use
when talking about VPNs but today is
going to be in sec now I just want to
give a little more background and then
we're going to get right into it because
there are a lot of steps today don't
want to cut corners but I don't want to
make this a two-hour video everyone's
time is very valuable so let me start
out by saying there are three mmm just
the three types well three major types
of VPN connections so there's the tunnel
VPN which is the most common which
encrypts and sends the content using a
secure path or a tunnel you hear that
word a lot with the PN's tunnels and
tunneling mode encrypt everything the
works including the headers and the
payload the whole data packet is very
it's holistic with the transport VPN
type we're dealing with the data payload
nor bats encrypted but the header
information which includes the IP
address that's unencrypted so that's
used more when both any points are known
like when you're using a remote desktop
or terminal and
later something like that and then
finally there is a pass through VPN used
mostly by small businesses and home
offices which actually enables VPN
traffic to pass through the router there
are routers that have VPN capabilities
but when you hear pass through that just
means the device is passing through you
know the information in that tunnel and
the traffic on the past year VPN is not
interpreted decoded or any code any way
again pass through is the functional
word there so we're going to be dealing
with today for our setup we're doing a
tunnel VPN so everything is going to be
encrypted including the header the
header is rather and the payload and
let's see if there's anything else I
need to add basically let me let's go
over what we hope to learn by the end of
this lab hopefully recognize and explore
the differences between secure and
non-secure file transfers very big deals
we're going to determine the password
and content of non secure file transfers
configure windows server 2008 VPN client
to work with a linux debian openswan VPN
i'll include the link for the first part
somewhere in this video if I haven't
already for that configuring that linux
box we're going able to describe the
differences between non tunnels and
tamil connections discuss the roles and
functions of encryption authentication
different elements of the IPSec protocol
like ESP and 8h and finally explain it's
the different phases and modes of
operating inside the insect protocol so
it's following along at home or you're
just curious on what kind of tools and
software we're working with today we're
going to be using openswan VPN which is
what i use yesterday as well for the
linux box we're going to be using putty
windows server this is a virtual machine
right here and then is going to be doing
some protocol analysis unfortunately are
not going to be doing some live
capturing the documentation here does
not indicate that they pre capture these
files so we can look over VPN or
encrypted files versus unencrypted and
non-secure files and so on so that's
going to be the second part going over
Wireshark
without further ado let's get to part
one configuring a windows VPN client to
work there's a Linux VPN server and for
this lab we're just going to assume that
your situation you have the Linux VPN
server setup again i did a video on this
if you're interested definitely check
that out so what do we want to add in
this part of the lab we're going to be
using an ipsec configuration file to can
say you're a VPN tunnel between this and
the linux debian openswan VPN server and
normally it's considered best practice
to document the configuration of VPN
connections firewalls etc you can easily
you can use a configuration spreadsheet
a checklist some other form of
documentation please don't use like
dirty piece and napkins probably not a
best practice in those parts of the
world I don't know cultures vary but
generally not good practice to be right
and what I'm dirty napkins and so on you
thought means you know that's that's
accessible and professional looking if
you are going to be doing some
documentation which is highly
recommended so for this lab we're going
to be working with some documentation of
course we're going to be using an it set
configuration file called it sex conf
which is right down here we'll get to
that in a minute and so when I'm going
ahead and get right in it let's go ahead
and right click now notice this is a dot
conf file to configuration file that
might look a little scary I know it does
for me when I see these blank things
like oh god what program do i pick I
don't trust the computer to pick for me
and my boss is out on a smoke break but
fortunately our documentation is looking
good we're going to go ahead and select
open in the context menu we are going to
select a program from a list of
installed programs we're just going to
go ahead and select word pad but you can
use any text editor for dot conf files
configurations also let's just open up
get it a little bigger a little bigger
okay actually you know what we're going
to get real big I wanted to split oh no
don't do this snake this virtual server
does not play nice with me
but we got that okay the whole thing is
showing now right long okay well it will
work with it oh there we go everything
is showing we leave so this is
well-educated not sure I like I said
we'll work with it this is our
configuration file and what we're going
to be referring to to set this up so now
we are going to go to the network icon
oh no flip it over here for now and
we're going to be opening the network
and sharing Center it's this thing
please work with me go ahead and click
the network thank you actually no we're
going to cook the network and sharing
center link beneath the menu bar at the
top of the window okay guys let's start
over I am super discombobulated by this
freaking virtual workstation that really
loves to jam nice pretty Layton's a lot
of latency go issues going on right now
so let's start over we got this open
cool we're going to double click on the
more twerk holy crap I'm getting
verklempt I'm self for cleansing so we
don't run an ad and double click let's
just give this workstation assessing to
stretch out for us so no I'll give it
its intention to see right it's a
computer he's going to go ahead and
click the network and sharing center
link right here there we go and now
we're going to click set up a new
connection or network link at the bottom
of this window yes now we're going to
double click to next to a workplace
double click ok and then we're going to
click leave use my internet connection
VPN we it's already highlighted go ahead
and click that and then your this is for
me now obviously your IP is going to
vary but this one I'm typing right here
before I type it in is the ipv4 address
of the VPN server
that sexified in the fifth set debian
VPN configuration file the reason I know
this IP address is for a few reasons
number one it's in my documentation
number two yesterday I was really
working with this IP trying to
troubleshoot some stuff in the command
line inner earth under the linux
terminal and trying to figures out how
soon is linux command line or is linux
terminal what is the proper term for
that somebody I not somebody watching
these things so anyways so if you're
trying to find out what the IP is going
to be it's going to be it's going to be
listed somewhere in your documentation
all right sort and e173 doc 30 not if
you know 100 you want to know what just
your profit measures of stuff so
important just verify the thought is it
left that is the remote machine or the
Linux machine we are good to go go ahead
and in the destination name we're going
to type it instead of VPN connections
that's a little vague we're just going
to go with debian yeah blah the onions /
VPN just to give it a little more
specifications on what beats what are
they talking about what the VPN is that
a lot of organizations have more than
one again so we're going to go ahead and
select don't connect now just set it up
so I can connect later go ahead and
click here and now this is going to vary
by organization but I'm a CD patten show
characters and this is my password don't
worry it's not like actual passwords
just a lab password so no issues there
and then optional domain we're going to
let a skip and then we're simply going
to create the connection is ready TV but
we don't want connect right now so we're
going to fool mess with that in a little
bit so we're going to go ahead and close
and this is going to return us to the
network and sharing Center and now at
the top left of the network and sharing
Center
we are going to take a look at the WM
VPN connection icon and that is going to
be under change after seven and filthier
is the Debian VPN that is what we named
it it's just connect to them it's
showing up and a little drastic there so
see okay so you're going to double click
and this is the connectivity and VPN
dialog box we're going to go ahead and
click properties now we're going to go
ahead and click the networking tab and
double-click ipv4 to open this up now I
pv6 the ipv4 we're going to go to
advance to open the advanced tcp IP
settings and now we're going to click
use default gateway on remote system or
remote network remote system okay hold
on let's rewind here put the use default
gateway on remote system check box to
remove ah we want to really loosen up
and let's just look at our documentation
here okay yep so we're on the right
track again whoever did this
documentation my theoretical system
administrator kudos to you you're making
my job as a beginner as an intermediate
beginner a lot easier so this was
clicked and we're not going to use
default gateways on the boat Network so
here is the logic behind that the W VPN
connection will not use the Gateway on
the destination machine or the network
the nat traversal yes statement in the
configuration file indicates that the
VPN connection will not traverse a
network address translation gateway
though not detail the VPN configuration
diagram and figures to confirm this lack
of these latest requirements well you
know maybe I was giving kudos to my
network admin a little too soon because
I don't even bother to okay mm-hmm okay
so if you watch the
yesterday you're familiar with this
little graphic here is this internet
sleep ominous cloud nothing movie
nothing goes out pretty scary stuff so
let's go back to it we're making pretty
decent headway so we're again we're not
using the Gateway because this is how he
knows number one documentation always
always a good thing to have but also in
this configuration file there is a note
saying that wpn will not reverse max the
network address translation gateway I'll
be darned if I can see it in these notes
but I think it's probably a good idea to
see this i think i might be getting some
conflicting info okay i'm not getting
conflicting information because here it
is snapped reversal okay it's going to
traverse and network address translation
gateways got it okay make sense that is
there it is traversing affirmative the
batter's like this I'm checked so that
is done we followed it to that point our
little notes here a consideration file
your hands in mine for 10 sec okay we're
going to click the tcp/ip EV for
properties box and we're going to go to
the Security tab here for the W and VPN
and we're going to go ahead and crisp
advance okay what so what we're working
with inside these events is so in the
exact configuration file here the
statement also equals l2tp let's just
bring that up that's fine oh so this
statement right here notice we're not
actually going line by line this
documentation is having a traverse if
you will some of this stuff terrible
jokes but right now
we're doing this also equals l2tp dash
PSA no nap so in this indicates that the
connection uses the layer two tunneling
protocol which is cell to layer 20 PP
not toilet paper but someone protocols
with pre-shared key CSK and no snaps
okay makes sense right somehow this is
all starting to come together little by
little so we're going to go we're going
to go back to the LCC piece and we're
going to use the pre-shared key for
identification so so those of you who
don't know a pre-shared CU psk it's a
pass phrase that is shared with systems
admin or anybody authorized to use the
beast man and if you're setting up a VPN
your authorized theoretically to use it
so get that psk um you know and make
sure it's not scribbled again on a
napkin or something because it can be a
really complex series of numbers and
symbols and whatnot so it's best to in
that set assess to copy and paste it
just so you're not like okay I think
this is a P maybe I don't know possibly
made copy and pasting probably best
practice is that so this is a pretty
weak pre-shared key I don't know and
then have a word of my admin because my
password is this is the life I don't
know dies that's pretty damn week but
it's what we got to work with so this is
a psk with pre-shared key for disc VPN
so we're going to go ahead and click ok
this is a lot of famous and then we're
going to go ahead and close the abort
properties box before we do that though
don't want to go back to this file here
because it also indicates there's a PFS
statement here for no so PFF stands for
perfect forward secrecy perfect forward
secrecy
and it's not required by the encryption
methodology the encryption methodology
in this case will be negotiated at the
time of the connection and so it does
not need to be specified okay so that
kind of makes our life easier one less
thing to do right so we're going to go
ahead click oh gee dokie now we are at
these actually you know what you have to
go back to security let's select the
properties so not the security we're not
quite done so we need to see we're going
to go to optional encryption connect
even if you'll encryption from the data
encryption drop-down menu so here's the
data encryption options and we're going
to go to optional encryption let I'm a
specification let's check that out again
there's two ways that I'm verifying this
right now I'm going to the documentation
and then the actual configuration file
so if I have questions if this was a
real life situation after this I will go
get a supervisor or co-worker who knows
more than me ideally the person who
wrote this stuff and a supervisor just
to cya but you know we're flying solo
here so we can only work with what we
have so we're trying to find optional
encryption and not seeing it on here
nothing anything about an option
optional encryption could that possibly
be rotating earth but that's just off so
I don't think so so I don't see it but
again we're going to stick with our
documentation we're going to go ahead
and select optional connects even if
your encryption and then we're going to
click to close this properties dialog
box now we're going to click connect to
open this limitation
so making progress here notice I didn't
put any credentials in there and it
still connected me so the weird thing
maybe the inconvenience saying
especially for newbies like me is that
the confirmation that the VPN has been
established is that the window
disappears it's a little
counterintuitive so it's a VPN if the WM
VPN window disappears whatever you know
connection you're using whatever you're
connecting to that window disappears the
connection is fully establish we're
going to check our documentation yep we
saw that box and now it's gone and what
goes to go now we're going to go ahead
and in this network connections we're
going to double-click the icon here to
check out the status and we're sending
and receiving pockets sir boss awesome
these are connected we've been connected
for a full 53 seconds and counting and
the documentation was just to make a
screen capture why the hell not right
all right it's tough we're going to go
ahead and close that so as you see this
is awesome guys verified we have
connected to the linux server through a
VPN ipsec connection it's sexy fan very
cool so now we're going to go ahead and
in event mindset and let's go to our
favorite just man I've had so many
issues with putty just threw my own
doing my own on learning experiences
here but we're going to go ahead and
connect to putty I think I'd like it
more if I actually masteress that's as
always the trick isn't it the IP address
ok so again this one seventeen up 30 dot
0 dot 100 that is the host name and then
if you add tea dress of the linux debian
openswan VPN server always want to make
sure we're connecting with ssh any for
my circumstance in my organization and
then we're going to go ahead and open
now we're gonna login
or we are on and I think if this is the
same as yesterday we're going to go up
your super user so we be so su wu when
the boingo when you're going go and then
we are super using baby box and fill up
so now we are going to do it sex verify
command make sure everything is working
in that department it sucked some of
that it sent verify go ahead and click
enter we're getting all okays we got a
warning here not a disabled that was
like that yesterday we got not ups not
applicable not okay because we're not
doing any failures and you know it's
mostly okay so this is actually a good
thing again counterintuitive okay means
good ok so this potty connection was
made across the VPN and a command we
made if they verify which you know
resulted in this output here has been X
executed and verified on the Debian
openswan VPN server is how freaking cool
is that it's official we're VPN anywhere
Boston you feel good about yourself
because I freaking do we are going to go
ahead you know what what's your rebels
looks like now we're back to your
student role an organ or ha Virgil bull
so now we're going to go back to the
network connections window let's see our
status from the dead and again the
Debian VPN as you see it's received of
some bikes here you see some action in
the last couple minutes and that was a
result of the stuff I was doing during
the putty connection so that if sex arif
I so that went through and so we're just
like trying to see you know we're just
usually confirming that you know we have
that connection and you be did go ahead
and close
don't go ahead and close and go offense
and oh sweet okay guys if you want to
stick around for part two I would be
happy to have you it's going to be a
great time in wireshark otherwise that
part of configuring a windows you see on
clients to work with a linux VPN server
it's over this mission freaking
accomplished again i know i sent it a
few times but this is only for the
windows VPN clients you you're only
doing this portion right now you still
have to set up the server in this case
is the linux box linux VPN servers gotta
do it which actually comparing it to the
linux lose Oh significantly more
difficult for me and took a lot more
time okay so in this part of the lab
this part 2 we're going to use wireshark
to review a few file transfers beginning
with non secure file transfer is using
SCP and then later on we're going to
review some ssh secure file transfers
using ssh and like i said before
unfortunately we're not gonna be doing
any live capturing but we have some pre
capture files here to make sure that the
frame number is and content match the
lab content this will make a little more
sense what we start once i start getting
into it so let's go ahead fire a flare
sharks unfortunately this wireshark
conversion is a little older the
functionality is pretty much identical
the functionality is identical but you
know some of this stuff when we sittin
looks like a pop-up my current version
on my local machine there okay so this
is my home screen as you can see but
let's not just let's stick to the desk
point being this is an older version of
where sharks are fully functional it's
one point 10.1 with what we are working
with so we're going to go ahead and go
file open going to open up some old
stuff giggles yet this little desktop
and we're going to find ftp tap sure to
tap and you g
well you see spi believable good old
port 21 and i write a mucky learning
something FCP go ahead click okay let's
work with a bigger screen here and I'll
fill this up okay so now we have
detailed as let's go ahead is pop it one
click the slip so we selectively packet
one or frame one rather which is
displayed right in the middle here so we
can you know what we call this stuff I
don't want this to be a very short
tutorial but there are a lot of things
that you can explore and this is just as
one framed one modest random random it
looks how much stuff is in there it's so
cool maybe just keep clicking and
clicking with the sledges information
there's information on information on
information how meta is that so these up
here are all the packets and they are
miss fitting order and they provide a
summary of the contents of the package
in a format well to English standard
query like we all know what that means
we don't know what it means you can at
least read it and kind of harsh together
in our brains what they're talking about
and then so here is this mill came here
is where the packet structure and
contents of fields within the packet
will display and artists winning now
frame details is what is popularly known
as and then down fear is the display of
the flight data and it's displayed in
hexadecimal on the left and in
characters when is possible on the right
and guys if you come across frames that
are unencrypted and how much passwords
and stuff they're going to be here and
it's pretty awesome to see if I wanted
scary it's not something that you know
keeps me up at night but it's pretty
cool we'll put it that way so now we're
going to type up here in the switcher
box you want to see all this FCP stuff
because even me as an advanced beginner
I know ftp
watch of course in it and it's one
of those canyons words and really he you
can really manipulate it another
manipulation is the right word but ftp
is always seemingly a treasure trove so
we're going to just filter out the ltp
actually we could have typed it does it
have it down here also well I don't
think you need to build it no we're not
going to build a filter actually yes we
are we're going to go to the expression
here if you're going to go sinuses put f
sweet so if you click it and then put
the letter you're looking for the first
letter of the word or for a call look of
the field you're looking for info check
back so we're going to you it's getting
closer mayor's ftp and then we want to
put in present in the relation box and
then we're going to click ok so you all
it did here is basically so here's my
version seq then hit enter but you can
also look at the expression use the
expression box but just typing in so
easy okay and as you see ooh ftp
treasure trove of people so ftp the
information here is going to include
file content usernames and passwords
right it's sent in clear text want you
to say anything more why are we even
going through this this is man i love
look at this now I mean it's going to I
know this isn't best practice so please
do not attempt this if you're at an
actual job right now I'm flipping the
script but I want to direct your
attention to this because this lab is
going to have a show through frame by
frame but I can really just tell you ftp
is in unsecured maybe it's insecure i
don't know if you have insecurity issues
ftp bullock it down here in the plain
text it shows my you
student because it's out here chief
here's a request for a password oh my
god there it is I ss316 security use
your name a password you guys want a DNA
swab to not you guys white assurances
wireshark want a DNA swab they would
they would show me a DNA swab results
down here guys I don't know I think and
you just contain myself because this is
exciting FCP is a treasure trove so
let's put on the frame 13 they're doing
some good stuff here too so friends 13
indicates that 17 feet up 3802 is
attempting to log on as an anonymous
user does that mean I'm going to
remember not this one strand 15
indicates the user was passed and some
kind of message that a password is
required for anonymous feed on your
password required for anonymous okay but
there's also something missing because
in frame 16 it doesn't indicate whether
or not the user receives a message or
that the message was delivered directly
so we're still missing a lot of the
picture here but if you're diligent and
tenacious and you really want to do some
black padding I'm assuming some seeking
some white heading if you have the
permission obviously this is a really
good place to start so frame 16 this was
the password attempted-user at sign
frame 17 shows us some English rejected
login correct and you can just kind of
read this stuff over here at the top
here and a CD info like okay user
students password required password I
was a series of six security loving the
correct and then these are shooting task
required for students password is s UN
Security users student login ways it
create starts building this narrative as
you go further into the sequence of
these frames so one last word on this
and
then we are going to change it up a bit
I don't need to go through all of these
you guys get the gist of it it's
freaking insecure it's unsecured are two
sentences here it's on six church so
let's wrap this one up and then we'll
look at some SSH frames and then we'll
call it quits we got the most important
part of this lab done now this is just
really so Moses have to say the first so
the lab is noting that it's a very
common practice to allow outbound file
transfers for large files without a
password via anonymous FTP so don't
panic if you see anonymous spla I'm
getting a check to buy and none of me
usually and probably not the case don't
bet on it for certain hundred percent
certainty but you know there's a good
possibility that um your admin is along
I'll bond file transfers for large files
a lot of password via anonymous FTP okay
for example it is less common though but
still not rare to allow inbound
anonymous FTP for like Stevie using FTP
to send papers to an instructor but it
is more common to have folders for each
user and a password to sure some kind of
integrity and tracking and most FTP
servers have log files to track senders
and receivers and their data it is
possible to track individual
contributions if anonymous FTP but much
simpler individual oh ok so what they're
saying here in the documentation is you
know don't spaz out but don't if you see
in an ottoman on FCP but I mean don't
completely dismiss it you want to find a
muffin if you can see a method for the
madness you're good to go but if not
researcher make sure nothing's going
going south so we saw all these things
in FCP I really don't need to go over
that anymore i think the point was
pretty much proven so let's go mmm you
still want to mess around with these
time
frame 63 is FCC okay this is a retrieval
was for that except configuration file
we did earlier and then frame 67 is
response frame 263 this one here or
frame 63 brother this one Oh 53 goes to
67 my bed and indicates that a binary
mode data connection has been opened
something I just feel honored where are
the awesome features only gonna go off
CP okay okay so we can't filter anything
more with this so that would make sense
this is an example of me not looking at
the bigger picture and just totally
relying on documentation now that is
absolutely important absolutely
necessary but I could have saved myself
a few seconds a few minutes by noticing
that this is an ftp packet capture file
oh I think we'll go look for some macho
say well you can't look for ssh if it's
just FCC in there so we're to go ahead
and go to desktop and then we're going
to go to whether the inspecting here let
me be mrs. H there's my ssh capture I
mean we're going to go ahead and open it
so obviously we're not able to find any
ftp is an ssh capture so this is
actually an important note here that ssh
protocol replaces telnet for keyboard
mode or as it is sometimes without
command line interface sometimes still
calls I hear it's called that all the
time for the interaction between systems
like the configuration of servers
routers and switches telnet it's still
used and indeed sighs if you're not
subscribe to the hak5 Channel please do
yourself a favor I'm telling you they're
not paying me but they should just give
them undying support which is like 10
without donating to their channel which
not that I think that I'm kind of
feeling guilty not learned so much on
their channel it's hak5 and it's Shannon
mores and dear intentional and they are
animals they are very talented and a lot
of the stuff I learned from them so
check out their channel there is always
something to learn they're always
updating stuff and they talk about
telling us that's right if use in many
cases even though even though it has a
lot of the shortcomings as ftp for
example it operates in clear-text it's
easy to hack but conversely SSH is used
to shirley's transfer five so this file
transfers uses ssh v2 rather than FCP
okay what are they trying at all what
size and traumatize okay the frame
summary I ok once that if you got 13 0 0
dot to live a small indie ok so you see
here the protocol as SSH version 2
rather than FCP is also between 1722
3802 which is this one and 172 dot 30
got zero got 100 which is this month ok
so all the things about the environments
are the same so we're going to explore
the frame details and by data for each
step that follows to see how this
exchange differs from the FTP File
Transfer so we'll go ahead and go to ssh
UV to hear on frame number 12 you see
that's three and 12 sometimes you're
just starting out all these numbers can
look the same it's pretty overwhelming
but you know even if you're not actually
knowing what you're looking for in this
thing it's good to get your eyes used to
the interface and just feel like okay I
might not know what such and such
function is or what this means but I
know one offended if someone says it and
eventually you will have to use it and
it'll make your job a lot easier so just
getting familiar with it sometimes is
half the battle you see my experience
just getting your eyes used to it so
we're going to go ahead and click from
12 in making this different gear
indicates the file transfer the file
transfer the destination machine at can
I start over frame 12 indicates this
file transfer the destination which who
the hell wrote this
oh that's right my system administrator
man he or she needs to stop getting
raises and stop smoking bowls on their
time off this is just ridiculous so the
destination machine is 17 2013 on-q
which is a Debian implementation of ssh
you see I really don't know what they're
trying to convey with satin message
other than we see the server here
openssh Debian which is probably the
machine we've been using for configuring
our server for opens 12 in yesterday's
lab so frame 15 and 18 this one here
it's hard to see this highlighted in
this one here so these are the key
exchange initial initialization between
the two systems so if we look at the
detail at frame 50 Minnesota 15 so we're
going to see that the server 17 to 23 @
0 dot 100 proposes use of 80s 128 flash
CTR which is a stream cipher utilizing
an underlying block mode algorithm as
the encryption method which with HMS mg5
as the authentication mechanisms and no
compression initialization strings are
also proposed so less gray lock down
shall we number one you can see that the
key exchange initialization here in the
information section and then we're going
to sort of the frame detail here let's
click this we're going to get this stuff
here ok guys here is the biggest thing I
wanted to illustrate you know honestly a
lot of this stuff is redundant and you
can you don't need me to go through this
yes this is critical to see exactly how
SSH compares against ftp but to be
honest there
a lot of the things you can do in wiring
short to do comparisons and you know if
this were a real world situation I would
tell my boss that a lot of the stuff was
just redundant and I made a junior
executive decision to have the people
who are learning with me to learn on
their own time if they need additional
training or come back to me if they
didn't understand something you need
this portion or just happy tell them out
so it's not a cop out but rather trying
to save people's time without cutting
corners so there's all this stuff guys
they want to try and find this hmf md5
we really nice things at Macy's there is
a lot to do so hey what's here somewhere
it has to be SSH perhaps there we go so
underneath that ssh protocol go ahead
and close up you see the encryption is
aes-128 snatch pcr so that's a stream
cipher utilizing an underlying block
mode algorithm perfect and then H max
md5 which is the authentication
mechanism and no compression thankfully
but you see this so you see how on the
ftp down here you could see our password
you see all the stuff in clear text now
none of this stuff is going to be of any
use to the overwhelming majority of
anybody's what's one of the main rules
of malicious cracking black hat hacking
those are the low ones boots this is
neither low-lying is northridge this is
a bunch of mumbo jumbo and you know what
I Chuck with the vault 7 I wonder I
wonder if the CIA could could make
something of this the Helmand gippy
group which we learned about a little
bit yesterday in the server tutorial all
right guys and then it goes on just some
through the
and then he wants to do the IPPS that
capture just for good measure we will
open it up you know just the same we
completed it again if you need to go
through the more details in this age
frames let me know actually don't let me
know download a copy of Wireshark and at
the state's your Hardaway so we're going
to go ahead and open good sex talk sure
TCAP ng file and so frames when it's
look through this really quick frames
136 our sovereign communication between
the windows machine this local machine
right here and the VPN server that we
configure today I'll frames 16 these
guys right here ending right here use
the UM what today is okay so they
establish communication and they're
using the internet security Association
and key management protocol say that 12
times fast I can't say anything fast is
a i fÃ¡Ã¡Ã¡-- masti okay honestly guys
that's a new one for me so it's going to
be getting a little more research on
next tonight before I power down so this
is the protocols used to perform the
first step in setting up against that
tunnel between the two systems so we're
talking BP and right now this is what is
use to actually set up the tunnel pretty
cool so to extend on that it's a
protocol used to establish tunnels in
and cryptographic keys in an internet
environment so somebody may not
exclusively for VPN so same 7 quick mode
the second phase of sending up the 55th
sent virtual private network 739 easy
response and then once the IFA antique
change is completed in the admin panel
is establish the actual information
exchange occurs and frames 10 through 21
using the ESP protocol which is the
encapsulating security / saul and the
alternative to ESP is known as the
authentication header
for a h6 here's a little clear frame and
DNS is like oh that's kind of random so
frame 16 is actually an unencrypted
netbios name service which is in the MS
what bios name service name query net
file name service main queries and is
outside of the tunnel so this didn't
this guy right here is kind of a rogue
frame is it not happen in are in effect
for our VPN rather and then frames 47
older there's a lot of friends 47
actually there's only 487 package that's
really not a laws 487 267 continue to
secure except exchange between the two
machines using IG mtv3 which is the
internet group management protocol
version 3 and linked local multicast
name resolution and starting on 53 which
is hell else and 10 our guys all these
are our protocols I'm not trying to
simplify oh it's a sump oil protocol but
you know reading off these things a
local multicast name resolution I mean
link-local multi-platinum resolution so
all of these they're simply not simply
protocols and then we can go to your way
down here just go away 200 friend 252
through 272 represent a secure shell
transfer between our local machine and
is the linux server and now if you want
to see SSH SSH if you wanted us to do
some SSH go ahead and despite that up
again you can use the expression box so
it would take so much more time to take
a message and the protocol SSH v2 pops
up the stop frame 271 at the beginning
of this file transfer and then we're
going to go and put the last frame
and it's a file transfers probably way
the heck down here is probably the last
file the last spring the file transfer
there actually no I don't think that's
correct and the strong word of it
affects ac21 guys and stuff i'm going
over right now is super not critical in
the set up a relief VPN we're just like
i said this is some gravy so if you want
to you're still sticking with me this is
going to be going to end in the next
minute but i appreciate you hanging on
this long if you've made it this far so
that is ok so let's try and figure out
where the end of the file transfer
packets are that's it makes me too and
there's so much information on your
sauce
the thing I'm confused about actually to
be honest and in a real-world situation
I would definitely have another box here
right now because I don't understand
where they're getting but there's a file
transfer going on because okay where
does that indicate will it's a file
transfer or should I just should I just
trust them believe the truth is out
there trust and believe the truth is
phong flying machine ok this is definite
call to my supervisor status so
unfortunately guys I cannot tell you
what is the ssh file transfer starts and
ends I'm a little fuzzy on that so be a
good good thing for training ah maybe if
anyone knowledgeable in what they're
seeing right now you can tell me what
I'm doing incorrectly or why I can't see
it be cool okay so we're going to try
PSP to sit illustrate filter function in
theirs are you keyframes to c est
exchanges over the ipsec VPN fall boom
and then one final note let's go back to
ssh so among the noteworthy things about
this capture file is the fact that SSH
transfer fat transfer at first outside
of the inset panel otherwise it would
not be possible to see details of the
ssh interaction between the two machine
because the ssh protocol transaction to
be encrypted with an ESP frame the ESP
frames between these two machines is
carrying other traffic than SSH what
traffic that's there was not that not
what traffic without the keys or access
to the machines with the screenshots
keyloggers or log entries it would be
impossible to say but there are other
types of analysis with traffic analysis
that can reveal more about the exchange
so what they're saying is like maybe
there is an incomplete picture with
wired shirt but as we know
viewing this labs and you know just
experimenting on my own relying in one's
on one tool is just like taking a hammer
and expecting to build a house like you
want to sweet ass hollows you want to
have the tool you're going to have the
know-how but above all I'm sort of have
more than a hammer in just a we'll like
single thing specialized tools to work
together and once you start having a
hammer having some nails having you know
if you don't know inherently what to do
having a book to read or something refer
to modern concrete having tile etc you
understand what I'm trying to illustrate
you're going to have a more complete
picture and you're gonna have a more
complete home or insert whatever
illustration here so each tool build on
each other and they work with their very
centered synergistics know that word is
just so we're very few thousand degrees
they work really well together a lot of
these tools do so don't just rely on
this if you're trying to find more
information maybe something's not like
popping out or you need to perform I
don't know the options are almost
limitless don't get your limewire shirt
all right guys all that said Lt power
down I want to thank you guys for you
people seriously I want a show of hands
in the comment box we get comment below
if you watch this whole thing you've
heard me ramble long ramble on for God I
don't know 45 minutes column with this
video in our holy crap if you've made it
this far and don't lie to me I'll know
if you do I have a special don't trust
candy prize for you I want to send to
you not kidding the real tough candy
secret swag Bob you guys are in forge a
real a real trees thanks for watching I
hope it was helpful definitely play
around with wireshark pretty fun in see
mostly intuitive I mean a colossus if I
don't see it but it's pretty fun and um
happy v pianning and we'll see in the
next video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>