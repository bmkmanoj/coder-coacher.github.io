<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Using Basic Microsoft Security Tools on Windows Server 2008 | Coder Coacher - Coaching Coders</title><meta content="Using Basic Microsoft Security Tools on Windows Server 2008 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/RealToughCandy/">RealToughCandy</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Using Basic Microsoft Security Tools on Windows Server 2008</b></h2><h5 class="post__date">2017-03-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/79-BjvtZh6M" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so you have your VPN up you have your
firewall configured you have secure
Network procedures you're good to go
you're rock solid but yet and still
somebody broke into your system and yet
and still someone was negligent not
intentionally negligent but negligent
and now you're screwed well guys try to
lower the blood pressure because in this
video we're going to be investigating
and responding to those types of
security incidents even if your setup is
rock solid like I said you got the VPN
you've got the firewalls you have your
secure Network procedures in place
mistakes happen and attacks still happen
so we're going to be using a few windows
tools today we're going to be using the
windows task manager doing some computer
management along with microsoft baseline
security analyzer to mitigate these
types of incidents and also mostly to
investigate them research further and
respond to them so I take it back about
the mitigation because you're mostly in
a bad place you're in some hot water
there was no direct fault of you but it
kind of was because you're in charge of
this stuff that's the part that's kind
of a bummer about being the good guy
here is that you have a lot more
responsibility than a black hat ill
intention cracker or hacker so without
further ado this this video is more
geared towards beginners I'm going to be
focusing on explaining some more core
concepts but if you're an intermediate
or advanced user I hope you can find
some interest in this video some use for
it and it might be a good brush up to so
like I said even with all of your tools
that are still doing problems happening
security incidents either by human error
mistakes disgruntled employees like
deliberate actions that disgruntled
employees takes or external you know
black hat hackers
and so your job as a cyber security
specialist or whatever your role is an
organization is to take action so to
mitigate these things and to respond to
these incidents it's a five part process
so you have to prevent it you have to
detect it you have to respond to it you
have to control it and finally you have
to document the security incidents in
order for you to be doing your job
correctly like I said you could be a
cyber security special whatever the job
title system admin incident response
team member etc and if you're doing that
in real life you have a bunch of
automated tools to investigate these
incidents but you're also going to have
to use some grey matters and critical
thinking and some for lack of a better
term analog tools in other words things
that aren't automated to get the full
scoop and like I said those five
components take control of those five
components that formula that serves as a
basis for Incident Response processes
and procedures so moving on we normally
use two types of tools their system
information tools like Windows computer
management and windows task manager most
of us are familiar with the task manager
sometimes if our computers running a
little slow we'll see are we inspected
and you know go to the task manager and
see if there's anything suspicious and
what that task manager does is provide
information about the tasks that are
current with running the use of system
resources and as well system performance
and then Windows computer management
which is a little more probably not
obscure but a little perhaps less you
utilize windows computer management
provides more detailed information about
the system like list of services on
their current state computer hardware
configuration security and system events
and scheduled tasks so that's more on
the system information tool side and
then there's the system configuration
tool side which is where the microsoft
baseline security analyzer comes in and
if you're not familiar with that
a system scanning tool scanning tool and
that tool is going to scan your
workstations and servers running
microsoft windows operating system so no
linux no Apple that's microsoft windows
only so that nbsa is going to check for
system admin and miss configuration
problems application software issues
like mrs. catches missing updates
missing installed system security
updates or partially installed system
updates and nbsa can be configured to
check for missing updates and
recommended security settings for
internet explorer if you're still using
that I know a lot of time most times you
don't have a choice in what your
organization is using for internet
browser but I they please I cannot wait
for internet explorer to be phased out
but that's a different video if you also
be used to check for missing updates and
recommended security settings on the
Internet information server Microsoft
Office sequel server and so on and it's
a more powerful than Windows Update
because it checks systems and software
settings in the registry in addition to
checking for required software updates
okay so today by the time we're done
with this hopefully you can use system
admin tools to gather information and
not just rely on you know scheduled
tasks and actually we're going to go out
of our way to be proactive and use these
tasks hopefully be able to stand
computer system for vulnerabilities use
an automated tool so there's kind of a
there's a meeting point here where we're
doing things we're activating these
things and setting these things off so
we can set up the automation and then
finally hopefully we can explain the use
of automated tools to gather information
as part of an incident response process
again it may seem like I ramble on in
these beginner focus videos but it's
really important to understand the
basics in some of the terms we're going
to be using and the theory behind it in
order for you to do your job better and
not just be the person who licks on a
light switch and call themselves an
electrician we want you to be the
electrician of the IT world where you
understand
you know like a electrician understand
electricity we want you to understand
your job so part one we're going to be
gathering a system performance
information now this system performance
information its supplements info
gathered by those automated tools we're
just talking about some IT Help Desk
will ask an end user to do these tasks
with extra level one support tech let's
see what else can we talk about remote
desktop services our double edged sword
however because our DP can save an
organization your organization a lot of
time and money because it eliminates the
need for a lot of desk-side support
visits by the IT Help Desk technicians
people like us on the other hand the
same remote login services can become a
vulnerability that is exploited by
agents near and far so again this part 1
we're going to gather system performance
information ok I think a little look-see
Lou and see what we're working with so
the first one we're going to do we're
going to go to the remote desktop here
and we're going to go ahead and
double-click this to open a remote
desktop connection we are going to
please on that engine and we're going to
do it we're going to go down here just
to the taskbar here then go ahead and
right-click and then we're going to
start task manager and let's see let's
look to reset this so I can show you
what i'm doing here i'm checking out all
of the services related to the remote
desktop so let's go to services and then
what we're going to do it looks like
this has already been out to the time
but if it's a mumbo-jumbo thing you can
just click name to alphabetize it that
way and then description you can also
alphabetize so we'll start here we're
going to be looking for remote desktop
services so let's start in the
applications see remote access not only
seeing remote desktop though so let's
alphabetize the description because
sometimes the names aren't exactly
describing what they're doing so we're
going to look for remote access here in
the description you call them remote
desktop services rather and here are
some remote desktop services currently
running under the name
service we also have a few more we are
the remote desktop config and remote
desktop services user mode and so on and
so forth so let's go ahead and just
highlight that and then we're going to
go to performance and then we see a big
bike here now if we hang on long enough
we're going to see probably a few more
of these little spikes who really knows
though you hang out long enough in one
place you're bound to get some sort of
action so that is where that is this is
the cpu usage history so if something's
getting used I mean it doesn't take a
rocket scientist tune up to know and you
know do the math here that you know what
it spiked if something's happening well
it's not not so much so there's a spike
there cool okay cpu usage is down about
not to about but down to exactly zero
all right so we saw with that's about
we're going to go on and get out of here
now we're going to go navigate to the
start menu here and we're going to go to
admin tools this is a really cool little
menu year lots of options lots of things
to choose from but we are going to go to
computer management go ahead of course
that wait for it to pop up I would
resize this can i zoom in on a virtual
machine nope I would resize this but
this virtual machine does not play nice
for oao does not play nice with me
unless I'm actually trying to do
something and I think it won't work so
sorry about the small space here guys so
we are going to go navigate to simple
tools here we go system tools and then
we're going to go to events the orange
click the little plus sign we're going
to go to windows along go ahead with the
plus sign and I'll just click on it and
not all populate over here and then we
are going goes to application so this is
the application logs and it records
information about events it's going to
record successful operation system
warnings error messages about sales
operations and then it's going to record
also information about successful and
unsuccessful
old log on attempt so you can see
exactly who or what and when things are
going on you can see how helpful that is
so that is where this is and this is the
law this is where the magic happens is
pretty big log your well I mean it's all
relative but you can scroll for a few a
few iterations there so now you're going
to click filter current log we want to
do some filtering and just get more
specific on this so we're going to click
still filter current log over here in
the applications windows go ahead
because that and we are going to go to
the event level portion of the filter
form which is right here and we are
going to click the following check boxes
because we want to look for critical we
want to look for warning and want to
look for error so all three of these
things are going to be filtered out and
we're going to want to make sure their
bows and information check boxes checked
the lowest information okay we've goes
out awesome and now we're going to click
OK to filters log entries so we're
looking for critical scuffle oh yes okay
whenever you see something already the
next solution point usually not a good
sign so we're going to scroll down here
to the first error event which is when
log on or the source rather is with his
log on let's just drag this over to see
exactly what we're working with okay so
these are warnings and these are errors
okay
here are is general information the
winlogon notification subscriber to 65
seconds the herald a notification event
and then on the details whoo xmlvm usual
that's interesting so
that is that let's just check our
documentation to make sure we're
investigating this okay okay so let's go
to this error oops sorry guys I looked
at the first warning the documentation
wants us to look at the actual error
because warnings you know they're
neither here nor there warnings aren't
going to destroy everything probably
most likely most likely so we're going
to go to the most pressing issues first
which are these two errors so go to the
general and here are the general details
about the error failed extract of
third-party rootless from the auto
updates cab at this website required
certificate is not within its validity
period when verifying against the
current system font or the time stamp
time stamp in shine 5 so in other words
from what I'm reading here this search
is not valid and that is not a good
thing so it's important to note about
log files they can contain thousands of
entries and makes them difficult to
stand by I when looking for some sort of
specific evidence and so that's what we
use that filter you know they're
probably not a thousand thousand upon
thousands of entries in the application
long we just were peeking up before we
filtered it but it's always good to
filter the drawback to filtering however
is that it reduces the number of entries
let me see that again the drawbacks to
using filtering to reduce the number of
entries is that the filter might exclude
events that would be of interest if you
have seen them so again that's where
that gray matter that critical thinking
that human eye that analog skill is
going to come in handy because again the
filtering it's very helpful can help you
find something quickly but it can also
leave out information so now we're going
to go over here let's navigate over the
left side here and other windows logs
we're not we're going to we saw with
this application errors were little
other application areas same thing yep
two in valid shirt
so let's go to security and what this is
some security log now and we are going
to compare information with here compare
this information with that displayed in
application log and then not look at Mia
there's a lot more entries here a lot
and then what's our let's filter this
one and see if anything anything this
spooky is going on we're going to do
critical morning error this might take a
little longer we'll see what we go ahead
and hit okay nothing pop it up all right
so we'll go on a setup nothing here
system movers all kinds of stuff yes
probably a few thousand records here so
again filtering comes in very handy so
now we're going to go ahead and go to
navigate over to your the left side and
we're going to click the plus sign in
front of services and applications which
is down here let's just tidy this up a
bit too are ready to work with it oh
come on come on you go to me Jeremy go
ahead and click the plus sign on
services and applications go ahead and
click services and then we're going to
cook the standard tab at the bottom of
the computer management to the window
right down here we're going to change
the view and then we're going to scroll
to the list of services to find the
group of services that manage remote
desktop again that is our focus and we
started out on this remote desktop we
were checking out onto then the activity
on it so let's go ahead go to this
description here pull it over just to
make sure it's exactly on point remote
desktop configuration services
in fact i'll check my documentation okay
this is actually my method was incorrect
so anything with the remote in it
alphabetize main section here let's
alphabetize this will sort that so all
of these things was one of the two these
are all remote desktop services all
right and status here the registry
hasn't started remote procedure call
these guys haven't started startup type
manual this one's automatic so you can
get some information here in this
computer management window again another
tool to illustrate exactly what is going
on where it is going on services and the
logs guys are very important piece in
this investigation so we're going to not
only have our information here we're a
little more enlightened about what
exactly is running what the startup
types are what the logs are showing us
or critical errors we're getting more of
the picture and if you're doing this in
a real life situation you want a
document everything you're doing
probably there is a sign in a sign way
of doing it according your organization
if not do not use a piece of napkin or
something unprofessional I mean people
actual professional log of it type of a
report even do a screencast and save it
for backup and Kane you know you lose
your notes or someone feels your work
area or whatever so we're going to go
ahead and do that just have proof that
you've been doing this stuff so you know
when the boss meant comes knocking
you're going to be asked me about the
status of this you can say okay I did
this this this and this in a bullet
point fashion you're saving yourself
time you're saving the boss man time and
you're getting paid for it too so guys
that was part one we gathered system
performance information not too shabby
we use a bunch of different techniques
for that and now we're going to move on
to part two
which is scanning this windows 2008
server for vulnerabilities we're going
to stay on this remote machine and we're
going to go ahead and double click the
Microsoft baseline security analyzer two
point oh right on the desktop here your
configuration may vary but this is the
MDS egg let's go ahead and maximize this
all right and then we're going to go
ahead and click scan a computer to begin
the skin we're going to click check for
security updates check box we're going
to because we're going to remove that
check when i get rid of that check mark
let me see wearing on here I'm all
discombobulated to check for security
update get rid of that we don't want to
check right now the reason I'm check
that is because this is a virtual lab
but it doesn't have direct internet
access and in order to check for updates
you need internet access so in a
real-life situation if I did check for
updates it would be a waste of time and
computing power because again this does
not have internet access so let's go
ahead and start and
okay that was quick and it's just a
severe risk so yeah I'm screwed how do
we undo this well first of all we're
going to review the report details for v
labs and sulk that's exactly see where
this is no it's been a hot minute since
I've did this and thanks to my trainer
who has awesome documentation I can
refer to this documentation and be like
okay let me see this graphic and exactly
what I'm doing guys there's gonna be a
lot of times as beginners you're not
going to have a co-worker who knows
everything in your immediate vicinity
and for stuff like this it's going to be
hard to Google because it's so specific
to your organization so rather than wait
rather than spend an hour on google
trying to find what to do thankfully the
person who documented this process was
very clear and what I have to do so
these are the report details here in
automatic update has big fat X on it
because the updates feature has nothing
configured this baseline security
analyzer wants us to upgrade to the
latest service pack always a good idea
guys always seek yourself up to date
that is how hackers exploit you one of
the main ways is that these patches are
not updated and if you're going near
even even a month or whatever even a day
after the exploit has been revealed even
sometimes I mean it can be minutes
sometimes even seconds after this
excellent has been revealed and there's
an update you're not on it you're going
to get you're going to be of a you know
what type creek so they wanted to update
to the service pack and then use a
control panel to configure automatic
update okay and then we have some admin
stuff more than to admin to refine on
this computer this is kind of a min it's
neither here nor there but it's a
non-critical it's a failure but it's a
non critical phase failure and then also
this one's a little concerning
because some user accounts have
non-expiring password so you know
someone's using the same password after
X amount of months or years time to
change it so your job probably entails
just telling that person or forcing that
person who change their password okay so
now we're going to go down to the
additional system information here and
here is the entry for shares or shares
are present on your computer and i don't
mean the diva from back in the day who
or a mermaid costume I mean share as in
for shares are present online computer f
HR e so we're going to go ahead and
click result details and see what's at
bala bala hmm so we have to admin shares
here and everyone and AD van and
everyone admin and then down here
authenticated users in addition hmm
cause for concern i don't know i don't
recall i don't recall taking part of
this so this is perhaps disconcerting so
if we go over and check this out before
we close out of this there's a little
key here f means full access are read
and so on and so forth so admins again
there are two admins as we saw in a
previous investigation that we're doing
that there's two admins on here which
might be cause for concern so these
admins are not only sharing this but
they have you no access to or
permissions to read write delete and
execute and so on and then everyone in
this share here again cause for concern
not critical but everyone has access so
let's check the arse here and then I'm
going to be honest with you guys I don't
know how to totally read this rx built
anything like what what you're talking
like a prescription server operators but
f
full so admins have full access and then
as far as everyone having access I don't
know what their permissions are there
but i'm going to ask somebody who does
so when my supervisor comes around to be
like yo dude i don't have the training
for this yet i'm not getting paid those
six digits just yet can you help me out
and show you what this is about and how
can we fix s so as far as us doing our
jobs we have been thorough but you know
as beginners we're just not there as far
as completely analyzing and making
recommendations we're not as a
recommendation step yet but we did
prevent detect and we are responding and
attempting to take control and perhaps
most importantly we're documenting our
incidents because we don't document
that's when its situation normal all
jacked up lack of communication is the
death blow to start with so many
organizations and not just I t so that
is the two steps guys to that today we
used admin tools to gather information
we stand our system and hopefully now we
can explain the use of these automated
tools to gather information we did a lot
of information gathering as part of this
incident response process I hope this
video was helpful and we'll see you in
the next video if you like what you saw
please hit smash that subscribe button
all kinds of videos like this coming out
nearly every day so I thank you for
watching and we'll see in the next video
is
hey</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>