<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>SqlDataAdapter in ADO.NET   Part 10 | Coder Coacher - Coaching Coders</title><meta content="SqlDataAdapter in ADO.NET   Part 10 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>SqlDataAdapter in ADO.NET   Part 10</b></h2><h5 class="post__date">2012-10-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/vN-CZYP2ZuY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to presume technologies I am
Venky this is part 10 of a do dotnet
video series in this session we'll learn
about the sequel data adapter and data
set objects before continuing with the
session I strongly recommend to watch
part 7 8 &amp;amp; 9 of this video series in the
previous sessions of the serial or net
video series we have learnt about sequel
data reader object sequel data reader is
connection oriented meaning it requires
an active and open connection to the
database while it fetches the data from
the database whereas sequel data adapter
and data set provides us with a
disconnected data access model in this
session we'll learn about sequel data
adapter and data set objects in a later
video session we will discuss up discuss
about where actually this disconnect the
data access model can be used now if you
remember in part 4 of this video series
we have discussed about the sequel
command object when we create an
instance of the sequel command object we
need to pass in two parameters to the
constructor one is the command that we
want to execute and the other one is the
connection upon which we want to execute
that sequel command along the same lines
when we actually create an instance of a
sequel data adapter we need to specify
the command that we want to execute and
the connection upon which we want to
execute that command let's look at a
demo in the sample database I have this
table TBL product inventory which has
caught the sample data and now I want to
display this data within an asp.net web
application we have seen how to do this
in the past using sequel command and
sequel data reader objects in this
session we'll see how to achieve the
same using sequel data adapter and data
set objects so let's flip to visual
studio here I have a simple asp.net web
application project which has got this
platform one dot aspx let's drag and
drop the grid view control which can be
found under the data tab in the tool box
let's auto format that okay so we have
this grid view control let's flip to the
code-behind file so in the page load
let's write the code to load the data
from sequel server and display that in
the grid view control first
all we need to have the connection
string to the database I have the
connection string within my web config
file the name of the connection string
is DB CS so the data source is dot which
means the local sequel server the name
of the databases sample integrated
security is equal to s SPI meaning I am
using Windows authentication with the
sequel server database and the provider
is system data dot sequel client because
I am interacting with Microsoft sequel
server database so let's go ahead and
create a sequel connection object but
before that we need to specify the
connection string and we know that we
have the connection string in web config
file so I have to read it from there and
to do that I can make use of the
configuration manager class we have
spoken about all these steps in the
previous sessions of this video series
so configuration manager dot connection
strings off we need to specify the name
of the connection string so let's copy
it from web config file paste it here
dot connection string so we get the
connection string now we need to create
a sequel connection object so sequel
connection con is equal to new sequel
connection and the constructor expects
the connection string to be passed in we
already have the connection string so
let's pass that to the constructor of
sequel connection class okay now if you
want your connection to be closed in a
timely fashion
you can either do that in a finally
block or we can use the using block
which ensures that the connection is
automatically closed when the connection
object goes out of scope we don't have
to explicitly call the closed method on
the connection object all right so we
have the connection object ready now
what we need to do is to prepare the
sequel command but in a previous
sessions we have seen how to use the
sequel command and sequel data reader in
this session we are going to use sequel
data adapter and if you remember when we
create an instance of the sequel command
object it expects if you look at the
sequel command when I create an instance
of this one if you look at this there is
a constructor which takes two parameters
the command that we want to execute and
the connection upon which we want to
execute that command now when I create
an instance of the sequel data adapter
let's call this D a is equal to new
sequel data adapter I have one
overloaded version of the constructor of
this class which takes in the command
that we want to execute and the
connection upon which we want to execute
that so it's exactly similar to the way
we create a sequel command object okay
so let's specify the command the command
that I want to execute is this one so
let's copy that
and the connection upon which I want to
execute this data adapter I mean this
command is con okay so I have the data
adapter now we need to create an
instance of data set object we will talk
about data you know working with data a
set object in detail in the next video
session here let me introduce you to
data set and by the way data set is
independent of the provider so it's not
present in systems or data or sequel
client namespace it's present in a
namespace called using system dot data
that is common to all the providers all
the dotnet data providers you know or
dotnet data provider for sequel server
which is systems or data or sequel
client dotnet data provider for Oracle
which is system dot data dot Oracle
client mates along the same lines oledb
and ODBC dot need data providers you
know the providers specific classes we
know that they are present in that
provider specific namespace but the data
set is provider independent that's why
it's present in the system data
namespace ok so data set let's call this
D s is equal to new data set so we are
creating an instance of the data set now
if you're wondering what a data set is a
data set is an in-memory representation
of your database we can we can treat it
like that a data set can actually store
tables and the relationships between
them just like how a database would
store tables and the relationships
between them but the database tables are
actually stored in the hard disk
whereas this data set is present in the
memory of the web server and if you want
you can cache that which we will
actually look at in the next video
session okay
so for now understand data set as an
in-memory representation of your tables
okay so now we have the data adapter and
the data set which is capable of storing
tables in memory for us okay so now I
want to you know fill this data set with
data from this TBL inventory TBL product
inventory table and to do that all I am
specific all I'm doing here is on the
data adapter object I am going to call a
method called fill method now most of
the work is actually done by this fill
method now if you look at this fill
method it is expecting a data set to be
passed in as a parameter so I'm going to
pass this data set to that method so now
what is this method actually doing this
method is the one which actually opens
the connection to the database
previously when we were using the sequel
command and sequel data reader objects
we were required to open the connection
before we execute the command okay but
for data adapter we don't have to do
that okay
all you have to do is call the fill
method the fill method will take care of
opening the connection executing the
command on the sequel server database
you know reads the data and then fills
that within the data set and closes the
connection immediately so the connection
opening and closing is managed by the
data adapter for us we don't have to
open the connection nor do we have to
close it
okay that's automatically managed using
the data adapter object for us and the
connection is kept open only as long as
it is required okay just before it reads
execute the command it opens the
connection execute the command reads the
data fills the data set and closes the
connection right away okay so I have the
data set now all that is left out is to
use that data set as the data source for
our grid grid view control so grid we
wonder data source is equal to data set
and call the data bind method
so grid v1 dot data bind all right so
now if we go ahead and run this
application you should actually see that
data as you can see you know the data is
retrieved and displayed on the web form
all right so we have seen how to execute
a sequel statement in inline sequel
statement and we have seen a using
sequel command objects we can execute
you know using sequel command and sequel
data reader we can execute stored
procedures so is it possible to execute
its stored procedure with sequel data
adapter absolutely so let's go ahead and
create a stored procedure first so let's
say I have this procedure create
procedure sp let's call SP get product
inventory as the name of the stored
procedure so let's press f5 command
completed successfully now if we execute
the stored procedure we have the result
so now we want to call the stored
procedure from within our asp.net web
application so to do that all you have
to do is copy the name of the stored
procedure instead of the ad hoc sequence
statement copy paste the name of the
stored procedure and another important
thing that we have to do is we have to
tell the data adapter that it is
executing a stored procedure now even if
you don't tell that if I just run this
as it is all I have done until now is
instead of the inline sequel statement I
have copy pasted the name of the stored
procedure so if I run this as it is the
application you know sequel data adapter
figures that it's a stored procedure
execute that gets the data okay but then
it's a good practice to actually specify
in the code that it is executing a
stored procedure and not an inline
sequel statement because if you try to
execute a stored procedure that has got
parameters then you anyway have to
specify the command type as stored
procedure okay
so da dot select command because this is
the Select command remember the data
adapter you know can also update data it
can update insert delete it can do all
DML operations okay
in this session we'll only see how to
select data in a later session we will
see how to update the data update the
database from the data
set using the data adaptors update
method okay so data adapter dot select
command the command type is actually a
stored procedure okay so now if we run
this way I mean the result is I would
exactly be the same except that we are
specifying the command type stored
procedure alright so we have seen how to
execute a stored procedure that doesn't
take parameters now let's see how to
execute a stored procedure using this
data adapter object that takes in a
parameter now let's say I have a text
box wherein the user can actually type
in product ID and then let's drag and
drop a text box control so user can type
in the product ID and let's say there is
a button called get product
okay so when he clicks that button he
should get only that product you know
for which he has entered the ID in this
textbox control so within the click
event we want all this code so let's
copy and paste that within the click
event handler okay and let's write a
stored procedure which takes you know a
product ID and then returns that product
so let's call this SB get product
inventory by ID and select star from TBL
product inventory where product ID is
equal to we need to pass in a parameter
to the stored procedure so let's create
that product ID integer and specify that
parameter in the where clause so let's
create this procedure execute that
command completed successfully so the
stored procedure should have been
created let's quickly test this let's
pass in product ID 1 + f5 ok I get the
product ok so now let's try to execute
the stored procedure from within our
asp.net web application so the first
thing that we have to do is copy the
name of the stored procedure that we
want to execute paste that here and we
specify this this is actually a stored
procedure using the command type
property on the Select command object
I'm in property of the data adapter
object okay and the next thing is
obviously you have to you know pass in a
parameter to the stored procedure okay
so to create the parameter and pass in
the way you do it is da dot select
command dot parameters dot add so if you
look at this one
you can pass in a sequel parameter
object we have learned how to you know
create an instance of sequel parameter
object when we are actually working with
the sequel command object it's exactly
the same because if you look at the
Select command property it actually is
the Select command if you look at the
intelligence here it's actually a sequel
command object meaning if you know how
to work with sequel command object then
it's
pretty much easy to work with sequel
data adapter or object
okay so sequel data adapter object dot
select command dot parameters dot add
there is a method called add with value
where you can just specify the name of
the parameter and the value that you
want to pass for that parameter so the
name of the parameter here is at product
ID so that's the name of the parameter
and the next thing that you have to pass
in is the value for that parameter so
where is this value coming from this
value is coming from this text box so
let's the ID of the text box is textbox
one so text box one dot text that's it
so specified that it's a stored
procedure and then you associated this
parameter to this procedure that's it so
let's run this and then once we type the
product ID into the text box control and
click this button we should get that
specific product let's say I want the
product that ID to get product and I
only get that product there so we have
seen how to execute a stored procedure
with the parameter as well
now another slightly I mean there is
another way you can do this instead of
passing to the constructor you know here
if you look at this the sequel data
adapter is actually taking in these two
parameters okay now there is another
version overloaded constructor of sequel
adapter which doesn't take any
parameters so if I create a sequel data
adapter like this then I need to specify
the adapters select command so data
adapter dot select command and if you
remember the Select command property is
actually expecting a sequel command
object so if you know how to work with
sequel command object all you do is to
create a new sequel command object and
then specify the command text and the
connection object so let's say the
command here is SP that's the pros
procedure and the connection that we
want to use is the connection object
okay so we have that sequel command here
and we are associating the command
typist we are telling that command type
is stored procedure and to the Select
command we are adding a parameter which
it expects so now if I run the output
would exactly be the same except that
you know we are doing it in a slightly
different way so and product ID 1 click
get product and I get that okay on this
slide you can find resources for asp.net
c-sharp and sequence of interview
questions that's it for today thank you
for listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>