<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 6   Calling asp net web service from javascript using ajax | Coder Coacher - Coaching Coders</title><meta content="Part 6   Calling asp net web service from javascript using ajax - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 6   Calling asp net web service from javascript using ajax</b></h2><h5 class="post__date">2013-11-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/-xMGwiV5A6o" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this part six of asp.net Web Services
tutorial in this video we'll discuss
calling an asp.net web service from
JavaScript using asp.net Ajax this is
what we want to achieve by the end of
this video we want to design a waveform
that looks like this where we can enter
a student ID and once we click this
button get a student we want this
waveform to call an asp.net web service
and we want this webform to invoke that
web service from JavaScript using
asp.net Ajax and the web service is
going to retrieve data from a database
table and then return that data to the
web form the web form should then
obviously display those values within
the respective text box controls let's
see how to achieve this obviously the
first step here is to create a students
table and populate it with some sample
data and here is the sequel script which
can do that I'll have the script
available on my blog in case you need it
and next we need to create a stored
procedure that can retrieve student
information by their ID and this is the
stored procedure that does exactly the
same thing the name of the stored
procedure is SP cat student by ID and
obviously this stored procedure has got
a parameter which is nothing but the ID
of the student and the implementation is
straightforward a single select
statement which is going to return these
columns that is ID name gender and total
marks from this table where ID equals
whatever ID that we are passing into the
stored procedure now let's flip to
visual studio so the first step here is
to add a student class to encapsulate
you know student information so we need
to create a student class that's going
to contain ID name gender and total
marks properties so let's flip to visual
studio add a class file and let's name
it student dot CS and to speed things up
I have already implemented at this
student class so let's copy and paste
this code here so very simple
straightforward properties in all of
them are auto implemented if got ID name
gender and total marks the next step is
to add a web service so let's add a new
item
and we want to add a web service that's
select web from install the templates
scroll all the way down and select web
service and let's call this web service
student service dot ASM X let's click
Add now we want to write some ad or
dotnet code within this web service so
that it can go ahead and retrieve data
from this table TBL students so let's go
ahead and import the required area
dotnet namespaces we need systems or
data we need systems or data dot sequel
client and we need system dot
configuration let's also change the name
of this method from hello world to get a
student by ID and we need to pass it a
parameter that is the student ID and we
want this function to return a student
object so the first step here is to
retrieve the connection string from web
config file within the web config file
of this project I already have a
connection string named DB CS which is
pointing to sample database on my local
machine so let's go and use our
configuration manager class
configuration manager dot connection
strings of the name of the connection
string is T pcs dot connection string
that should give us that the next step
is to create a sequel connection object
so sequel connection let's call it con
new sequel connection and let's pass the
connection strength and now let's create
sequel command object let's call it CMD
equals new sequel command we want the
sequel command object to execute this
stored procedure s be get by student and
get student by ID so let's pass the name
of the stored procedure and then we also
need to specify the connection object
and we know that this command is a
stored procedure so we have to tell the
command object that so command or
command type equals command
dot stored procedure and this tool
procedure also expects a parameter and
the name of the parameter is at ID so we
need to create a sequel parameter object
so let's call it parameter equals new
sequel parameter and let's use this
overloaded version where we can specify
the name of the parameter and the value
so the value is going to come into this
method as a parameter so let's go and
pass it as the value for the parameter
object finally we need to associate this
parameter object with the command object
and to do that command dot parameters
dot ad and we need to open the
connection and execute the command
command dot execute reader so execute
reader is going to return a sequel data
reader object so let's create a variable
of type sequel data reader and let's
call it reader and before you open the
connection let's also create a student
object let's call it student equals new
student while RDR dot read so as we read
data we want to retrieve the respective
column values and then populate the
properties of the student object so
student dot ID equals where are we going
to get the ID from from the reader so
let's specify the name of the column so
the name of the columns matches the
names of the properties so student dot
ID equals reader of ID and this ID
property is an integer so we need to
convert this to an integer so let's go
and do that convert dot to int 32 and we
need to populate student name student
name is strength
so reader off
name and let's convert that to strain so
student dot gender and the column name
is gender and finally we need to
populate total marks property so student
dot total marks equals reader of total
marks and then once that is done we are
going to return the student object very
simple web service all it has a Samaria
dotnet code which is going to retrieve
data from TBL students table let's go
and test our web service to make sure it
works as expected so on this service
page we should see that get student by
ID function so there we have it and this
to web service method expects a
parameter so let's go ahead and pass
student IDs one invoke head and look at
that we get the response back from the
web service we have the ID name gender
and total marks all right
so now let's see how to invoke this web
service from a web form from JavaScript
using asp.net Ajax so let's flip to
visual studio the first step here is to
add a web form so let's go ahead and add
a web form
now we want to design this waveform so
that it looks like this and to speed
things up I have already implemented the
required HTML so let's copy it from this
notepad and paste it in our waveform
let's format this properly by selecting
the entire HTML and plus in control K
and D so this is straightforward HTML
all I have here is a table and then it
has got some TR tags within that I have
you know two TDs in every row so that's
the text and those are the text boxes
now at the moment we don't have this
button control so let's go ahead drag
and drop the button control now we don't
want to do a post back to the server you
know we want to call the web service
from JavaScript using asp.net Ajax now
if we use the button control that is the
asp.net button control you know when we
click the button it's going to post the
page back to the server now we don't
want that to happen instead we are going
to use the HTML input button control so
which is present on the HTML tab so we
are going to use this one let's actually
flip to the source mode and add it next
to the textbox control
so the value on that button is going to
be get a student okay now there are
three steps that we need to be aware of
to call a web service from JavaScript
using asp.net Ajax the first step is to
decorate the web service class with
script service attribute okay so this
enables a web service to be callable
from JavaScript
okay so let's flip to visual studio
let's go to our student service and if
you look at you know the auto generated
code here look at this it's already
decorated with that script service
attribute but then this is commented and
this will comment as well here to allow
this web service to be called from
script using asp.net Ajax uncomment the
following line so let's uncomment this
so if you want your web service to be
callable from javascript then that web
service needs to be decorated with
script service attribute that's present
in system dot web dot script dot
services namespace alright the second
step is to include a script manager
control on the web form itself from
where we want to call the web service
and then we need to specify the part for
the student web service that we want to
invoke so let's flip to our web form and
then let's drag and drop script manager
control and you can find script manager
control under Ajax
extensions so within the script manager
control we need to specify services
element and within that we need to
specify service reference and then set
the part for our student service and
where is our student service present
within the root directory of this
project and how do we specify root
directory tilde for slash and we have
called the student service dot ASM X all
right so that's the second step and what
is the third step we need to implement
the required JavaScript functions to
invoke the web service method so we need
to write some JavaScript code let's
write that within the head section of
the web form so let's specify the script
tag so script type equals
text slash JavaScript and language is
JavaScript so here we are going to write
a JavaScript function let's call it gets
to the end by ID so in order to call the
web service method we first need the ID
of the student and where are we going to
get the ID of the student from from this
textbox control on the webform so what
is the ID of that textbox control on the
webform
it's called txt student ID so using
JavaScript
we need to retrieve the value from the
textbox and in order to do that we use
the document object so document dot get
element by ID so what is the ID of the
element
txt student ID and then dot value is
going to return the value that is
present within the textbox control let's
store it in a variable called ID and
then all that is left is to invoke the
webservice method so if you look at our
student service it's actually present in
this namespace web services demo so here
we need to specify the fully qualified
name web services demo dot the name of
the web service which is student service
and finally the name of the web method
itself so the web method name is get
student by ID and obviously this method
expects an ID value so let's pass it ok
we also need to specify another
parameter to this function now obviously
you know when this method is called the
web service will be invoked so the web
service will retrieve data from the
database table and it's going to return
the result
so once the result is returned we need
another JavaScript function which is
going to retrieve those results and then
display within the UI controls ok now
here we are calling the web service
asynchronously
okay so we call a web service and then
we can do other things as well and then
when the web service finishes executing
that method it's going to call into a
callback function that we are going to
specify here and that callback function
is going to receive the result from the
web servers and then it's the
responsibility of that callback function
to update the UI elements
okay so let's specify the function here
let's call it get a student by ID
success callback you can give it any
name you want but then this is the
function that gets called when the web
service returns successfully so now we
need to implement that function so
function get a student by ID success
callback so obviously this function is
going to receive the result from the web
service and this is the parameter which
is going to receive that results again
you can give it any meaningful name you
want I happen to just choose results
okay so what we need to do inside this
function we need to populate these UI
controls that is name gender and total
marks text boxes okay and we obviously
have IDs for them so txt name gender and
total marks so document dot get element
by ID so what's the ID of name txt name
so let's copy it let's go back and paste
it right there so txt name dot value
equals from this results so this results
should have name within it that is
returned from the web service in a
similar fashion we need a txt gender
and the property name is going to be
gender and similarly dxd total marks
that's it we're done so let's go ahead
and test our platform to make sure it
calls the web service as expected so
let's enter an ID of one click the
button get student look at that nothing
happens why is that that's basically
because we have implemented our
JavaScript functions but we haven't told
this button to actually call this
javascript function okay so we need to
tell that so here we have the button
control so on click the button we want
to call this function get student by ID
so let's specify the function name right
here all right so let's run this one
more time and the student ID click get
student look at that we get the
respective student let's enter number
five get student and we get the data as
expected okay now at the moment if we
enter some garbage something like test
that's not a valid student ID when I
click get student look at that nothing
happens
it basically fails silently you know we
need to give some kind of you know
update to the user stating that you know
this is invalid for integer okay so in
order to do that we can pass another
parameter to this function you know here
we are calling get student by ID that's
the parameter that we pass and this is
the method that gets executed when the
web server is called successfully
returns on the other hand if the web
server is called fails for some reason
then we can specify another function to
call back okay so let's call it get
student by ID failed callback so this is
the function which is going to be called
you know when the web server is called
fails
so let's implement that function here so
function get student by ID failed
callback and obviously when the call
fails you know there are going to be
some errors so this parameter is going
to receive those errors again you can
give this parameter any name you want
and let's simply show an alert box alert
and we want to show the errors so errors
dot there is a function called cat
underscore message which is going to
return those errors so let's go ahead
and run this and see if it works as
expected so let's enter test that's not
a valid ID look at that test is not a
valid value for integer 32 okay on the
other hand if we enter a valid ID it
works as expected all right now here
look at this when we click this button
we are not actually posting the entire
page back to the server and we click
this button the web service will be
called asynchronously and the page will
be updated only this portion of the page
will be updated so here we are not doing
a full page post back it's only a
partial page post back ok let's actually
do the prove that when we click this
button we are doing partial page post
back and not a full page post back and
to do that let's include an h1 tag after
the table and then let's specify some
text there also let's include this text
the time below doesn't change so
basically the time below does not change
when we click get student button as we
are doing partial page postback and not
a full page post back and let's include
a label control here and let's include
an asp.net label control and let's call
it lb our time and let's get rid of this
text from here
and within the code-behind file on the
page load event let's set the current
date and time so date time dot now dot
to string so let's actually run this so
when the webform loads look at that the
time currently is this one okay nineteen
thirty fifty two now look at this when
we enter an ID and click get a student
look at that the page is not posted back
and the time doesn't change that's you
know that proves it so only this portion
of the page is updated so here we are
doing a partial page post bacc they're
calling the webserver is from javascript
using asp.net Ajax alright that some of
the YouTube subscribers have asked a few
questions after watching the initial
videos in this web services tutorial I
thought I will clarify them right now so
here are those questions the first
question is could you explain how an
object-oriented application such as
asp.net web application can make use of
web services to access a relational
database now we have discussed exactly
the same thing here so here we have this
waveform this waveform calls the web
service and within the web service we
have a do dotnet code which calls into a
relational database retrieves data and
then give it back to the web form so
that's what we have discussed now just
like an asp.net web application a web
service can work with any type of data
store you know not just relational
databases it can work with XML files
text files Microsoft Access Excel etc
now another question that I have got is
where does ATO dotnet and XML Web
Services come in the architecture of the
application now most of the real time
applications have three or more layers
and the most common layers in most of
the applications are you know user
interface a presentation layer which is
basically responsible for the UI logic
and business logic layer it contains
logic to validate business rules and
data access layer which is responsible
for perform
the database crud operations that is
create read update and delete now with
respect to this architecture Web
Services belong to the business logic
layer and ad or dotnet obviously belong
to data access layer and this is the
final question that I have got how to
call a web service from the web form
without reloading the entire web page
this question can also be asked in a
different form how to call a web service
without full page post back call the web
service using asp.net Ajax which allows
partial page postback and we have seen
that in action just now so with partial
page post backs only a specific portion
of the page is updated without reloading
the entire page which is better for
performance and also avoids screen
flickers that's it for today thank you
for listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>