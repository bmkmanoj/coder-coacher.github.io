<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Difference between rows and range | Coder Coacher - Coaching Coders</title><meta content="Difference between rows and range - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Difference between rows and range</b></h2><h5 class="post__date">2015-10-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hM1YKSxltDU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 117 of sequel server
tutorial in this video we'll discuss the
difference between rows and range clause
in sequel server this is continuation to
part 1 1 6 so please watch part 1 1 6
before proceeding let's understand the
difference with an example now based on
this employee's table on the left we
want to write a query that's going to
compute running total of the salary
column and then display that running
total against every employee row as you
can see here let's flip over to sequel
so management studio will use this
employees table for the examples in this
demo within our results that we want
named celery and then the running total
to compute the running total we are
going to use the sum aggregate function
and then pass the salary column then
we'll use our favorite both laws within
paranthesis we'll specify the order by
clause let's sort the data by salary
column and let's give this column an
aleeah's let's call this running total
let's execute this query and see what we
get notice we get the running total as
expected
for the first row total it's 1,000 for
the second row total is 3000 it adds
first and second rows together and for
the third row it is 6000 thousand plus
two thousand plus three thousand so we
get the running total as expected
now the most important thing to keep in
mind here is that for the rows or range
Clause we are not specifying explicitly
any value so sequel server is using it's
a default value so what is the default
value for rows or range Clause it is
range between unbounded preceding and
current value we discuss that in detail
in our previous video session that means
we can rewrite this query using its
default value so Auto is salary and then
we can specify its default value so the
default value is range between unbounded
preceding and current row now when we
execute this we should get exactly the
same result
notice the running total is exactly
identical so we can either write this
query like this
without its default value or we can
specify its default value both of these
queries should produce exactly the same
result and we have seen that in action
now we can replace that range clause
with ROS clause and still in this case
we are going to get exactly the same
result let's actually prove that so
instead of this range it Clause I'm
going to use the ROS clause let's
execute this and see what we get
notice we get exactly the same result as
before well the obvious question that
comes to our mind at this point is then
what's the difference between range and
ROS clause the difference is in the way
duplicate rules are treated ROS Clause
treat duplicates as distinct values
whereas the range Clause treats them as
a single entity let's actually prove
this with an example
so first let's introduce some duplicate
values for the salary column to do that
I have this update script right here so
let's execute this now let's select the
data from our employees table and make
sure we have that duplicate data so
notice for the first two employees
salary is 1000 for the third and fourth
employees the salary is 3000 so we do
have duplicate data now let's execute
this query now at the moment notice we
are using rows clause let's see what
result we get notice that it computes
the running total as expected so for the
first row it is 1000 for the second row
it is 2,000 because it adds first and
second rows together and for the third
row it is 5000 because it adds 3,000 to
2,000 we get 5,000 so it's working as
expected
now let's replace this rows with range
and let's execute our query and see what
we get notice now the running total is
not as expected and for the first two
rows it's displaying the same running
total mm why is that
that's because range Clause is treating
duplicates as a single entity and the
same is the case for rows 3 &amp;amp; 4 look at
that it displays 8,000 as the running
total that's because it is adding these
two together and when we add 3 &amp;amp; 4
together we get 6000
when we add that to mm we get 8,000 and
that running total is displayed for both
rows three and four so that's the
fundamental difference between rows and
range Clause and we can see those
examples right here here we are using
rows clause so we get the running total
as expected when we use the range Clause
notice that since the duplicates are
treated as a single entity we don't get
the running total as expected now here
we have the query that shows all - all
the three side-by-side so this query
right here you know is showing this
running totals when no value is
specified for rows or range class so
here you know the first line here where
we are using the sum function notice
that we are not specifying any explicit
value for the rows or range Clause that
means it's using its default value and
here we are for the second sum function
call we are explicitly specifying the
value 4 rows or range Clause and on the
third line instead of using range we are
using rows clause and see only you know
this third call to the sum function uses
the correct running total as expected
whereas the other two doesn't produce
the running total that we expect thank
you for listening and have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>