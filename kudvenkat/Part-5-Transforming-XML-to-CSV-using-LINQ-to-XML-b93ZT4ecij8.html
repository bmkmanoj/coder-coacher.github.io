<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 5   Transforming XML to CSV using LINQ to XML | Coder Coacher - Coaching Coders</title><meta content="Part 5   Transforming XML to CSV using LINQ to XML - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 5   Transforming XML to CSV using LINQ to XML</b></h2><h5 class="post__date">2014-08-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/b93ZT4ecij8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 5 of link 2 XML tutorial in
this video well disk is transforming XML
to CSV using link 2 XML in your
application there may be a need to
transform an XML document into CSV
format or HTML format or to a different
XML format in this video we'll discuss
how to transform this XML on the left to
CSV format on the right and in our
upcoming videos we'll discuss how to
transform this XML to HTML format or to
a different XML format so let's slip to
visual studio here I have a new console
application all I have done so far is
added this data dot XML file to this
project
I'll have this XML data available on my
blog in case you need it now let's flip
to program dot CS file we need four
different namespaces so let's bring them
in first we need a system dot link we
need system dot XML dot link we need
system dot io and we need system dot
text so first let's create an instance
of string builder with no main method
let's call it SP and we want the
separator to be a comma so let's create
a delimiter and the delimiter is going
to be comma alright so we need to load
this XML data from this XML file so
let's actually get the path of this file
so this file is actually present in this
project folder so let's open the project
folder in Windows Explorer copy the path
from there and to load the XML data from
an XML file we have load method that's
available with an X document class so X
document dot load and we specify the
path of our XML file so the name of the
file is data dot XML so now this is
going to load the XML data into memory
and if you look at this XML data what we
want to do is retrieve all the student
and to do that we are going to make use
of this descendants function so we want
all student descendants and now what we
want to do is actually loop through each
student element and then retrieve the
country you know append they come out to
it and then the name gender and then
total marks you know separating each of
those with comma okay so in order to do
that we need to first loop through all
the elements within this XML okay so to
loop through we use for each method now
we don't have for each year because this
descendants returned ienumerable of X
element and with an ienumerable we don't
have for each so we have to convert this
to a list first
so to list dot for each and now what we
want to do is for each element such that
we have the stringbuilder object so SB
dot append what we want to do we want to
first retrieve the country of the
student so we are going to use this
element variable element dot attribute
of what is the name of the attribute it
is country so let's copy that dot value
so this should give us the country okay
and to that we want to append this
delimiter that is comma so delimiter and
to that now at the moment we are right
here so we need to get to the next
element there right so in order to do
that let's actually copy this piece of
code
so now we need to get to the name
element and to get to the name element
so element dot element and what is the
name of the element it is name so we get
the name and then again we up in the
delimiter similarly we need gender and
total marks so gender total marks and
finally look at what we want in the
output you know after total marks we
don't need any comma there but then
there are two invisible characters
between the first row and the second row
you know at the end of this row we have
you know a carriage return and the
escape sequence for that is backslash R
and at the beginning of the second line
there is this newline character which is
backslash n so we need to append those
two characters to every row so here
instead of delimiter we are going to
append backslash R and backslash n so
that's going to close the append method
and we also need to close the 4-h okay
so now within the stringbuilder object
we should have a comma delimited string
of every student now what we want to do
is we want to write that data to a file
and the extension of the file should be
dot CSV so we are going to make use of
stream writer class let's call it SW
equals new stream writer and here we are
going to specify the name of the file
including the path so let's actually
copy this
and let's change the name to result dot
CS way and let's use the right line
method and to this method let's pass the
string so we have the string within the
stringbuilder object convert that to
string and then finally close the
streamwriter
okay so at the moment we don't have that
result dot CSV file within this project
folder so let's go ahead and run this
now so it says build fail let's see what
is the error okay we are missing a
closing bracket there so let's run this
now so now when we view all files notice
that we got result dot CSV file and
notice we get the data as expected so we
have just seen how to you know transform
XML to CSV format in our next video
we'll discuss how to transform the same
XML to HTML table that's it for today
thank you for listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>