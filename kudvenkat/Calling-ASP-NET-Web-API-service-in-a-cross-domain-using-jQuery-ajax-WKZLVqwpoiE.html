<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Calling ASP NET Web API service in a cross domain using jQuery ajax | Coder Coacher - Coaching Coders</title><meta content="Calling ASP NET Web API service in a cross domain using jQuery ajax - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Calling ASP NET Web API service in a cross domain using jQuery ajax</b></h2><h5 class="post__date">2016-09-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/WKZLVqwpoiE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 14 of asp.net Web API
tutorial in this video we'll discus
calling
asp.net web api service in a cross
domain using jQuery AJAX as far as
browsers are concerned there is a
concept called same origin policy first
let's understand what is meant by same
origin policy browsers allow a web page
to make Ajax requests only within the
same domain browser security prevents a
web page from making Ajax requests to
another domain this is called same
origin policy so if you look at these
two URLs right here
they've got same origin because notice
both of them are using the HTTP protocol
they're from the same domain localhost
and they also have the same port number
one two three four whereas if you look
at these two URLs they've got different
origins because they have different port
numbers the first one is using port
number 1 2 3 4 whereas the second one is
using 5 6 7 8 these two URLs right here
also have different origins because they
have got different domains the first one
has got com whereas the second one has
got dotnet and these two URLs right here
also have different origins because they
have got different security schemes the
first one is using HTTPS whereas the
second one is using HTTP now let's prove
that browsers doesn't allow cross-domain
Ajax requests so let's flip to visual
studio now don't solution let's add
another project so I'm going to right
click on the solution add a new project
and let's add a speed or net web
application let's call this client
application click OK and let's add web
forms application let's click OK this is
going to take a few seconds to create
the project project created to this
project let's add an HTML page
let's leave the default name now we want
to write Ajax code here to call our
asp.net web api service now this HTML
page is present in a different project
in our previous video we have created
this
employees
HTML and within this page we have Ajax
code which calls the Web API service now
the page and the web api service they
are present in the same project so the
domain is the same so the Ajax call
worked without any problem now let's
copy this HTML and jQuery code and paste
it within our HTML page one dot HTML
this page is present in a different
project now one thing that we need to
change here is the URL for our asp.net
web api service now if you look at
employees dot HTML we are using relative
URL now this relative URL will work in
this case because both the page and the
asp.net web api service they are present
in the same project but if you look at
where you know the complete URL for
where the web api service is hosted its
right here localhost colon a port number
four slash api four slash employees now
we can get to the employees page using
the same port number okay so this is the
URL where we have our web api service
hosted so within our HTML page one dot
HTML we have to use that full URL so
let's give our solution a build build it
succeeded now let's view this HTML page
in the browser look at the port number
where we have this HTML page hosted it
is six to nine three and look at the
port number where we have our web api
service hosted it is two three two five
eight so we have got two different port
numbers here that means we have got two
different origins so the ajax request
that we are issuing from this HTML page
is a cross domain ajax request remember
browser security prevents cross domain
ajax requests for security reasons let's
actually prove that let's click this get
all employees button look at that we
don't see employees data now let's
launch
browser developer tools and see if we
have caught any errors notice the error
that we have got XML HTTP request cannot
load this URL so this URL s where we
have our asp.net Web API service hosted
and it says no access control allow
origin header is present on the
requested resource origin so this is the
origin from where we have issued the
Ajax request is therefore not a loved
access so this proves that browser
security prevents cross domain Ajax
requests there are two ways to get
around this problem using JSONP Jason P
stands for Jason with padding or
enabling cores cross-origin resource
sharing in this video we'll discuss how
to issue cross domain ajax requests
using TS and p and in our next video
we'll discuss enabling cores so what is
Jason B this and P stands for jason with
padding all jason pitts does is wraps
the data in a function so here we have
regular jason data and here is the json
formatted data notice all we are doing
here is wrapping details and data in a
javascript function the name of the
function here is callback function now
web browsers allow JavaScript to be
consumed from a different domain since
in this case
Jason data is wrapped in a JavaScript
function this can be consumed by a web
page that is present in a cross domain
now let's see how to make our asp.net
web api service written JSONP for
metadata the support for Jason P format
is present in a different nougat package
let's first install that package let's
do that using the new gate package
manager console window so let's click on
tools' NuGet package manager package
manager console and within the package
manager console let's execute this
command install package and the name of
the package that we want to install is
this Web API contributing dot Jason P so
this is going to install this new it
package
as well as any other dependencies the
package is successfully installed now
let's go to web API config dot CSS and
within the register method let's create
a variable let's call this JSONP
formatter equals let's create a new
instance of JSONP media type formatted
class this class is present in a
different namespace and that is web api
contributed formatting dot JSONP so
let's use that using declaration and to
the constructor of this class let's pass
jason formatter and to get Jason
formatter we use the configure object
that is coming into this function as a
parameter so config dot formatters dot
JSON format and then let's inject the
spacing P formatters into the format
it's collection of the config object so
config dot for matters dot insert and
let's insert this as the first formatter
so at index position 0 we want to insert
JSONP formatter and then the final step
is within our HTML page 1 dot HTML now
the data type that we are going to get
back is JSONP so let's set that to JSONP
let's also do the same thing in
employees dot HTML let's change the data
type to JSONP now let's give our
solution a build build succeeded now
let's view this HTML page one dot HTML
in the browser at the moment of a web
api service is written in JSONP format
the data so we shouldn't have any
problem calling the web api service
using jQuery AJAX let's try it from
employees dot HTML page employees dot
HTML is present in the same project
where we have over baby a service
even this works as expected finally
let's test our Web API surface using
fiddler this is the URI where we have
our web api service hosted let's execute
this cat request notice we get status
code 500 internal server error and if
you look at the actual error message it
says a callback parameter was not
provided in the request URI remember all
JSONP does is wraps the data in a
function now we need to specify the name
for that function using this query
string parameter callback now the
function name that we are specifying
here is ABC let's execute this request
completed and if you look at what we
have caught back notice the jacent data
is now wrapped in a function called ABC
now if you want just json data instead
of JSONP formatted data then set accept
header to application forward slash
jason and remove this callback query
string now when we execute this request
notice we get just raw JSON instead of
JSONP formatted data now if you set the
accept header to application for slash
JavaScript and then if you include the
callback parameter and then let's say
for example the function name is my
callback in this case also we are
getting JSONP formatted data look at
that D JSON data is wrapped in a
function named my callback thank you for
listening and have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>