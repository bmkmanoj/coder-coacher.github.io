<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Generate pdf document from gridview data and store on web server  - Part 59 | Coder Coacher - Coaching Coders</title><meta content="Generate pdf document from gridview data and store on web server  - Part 59 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Generate pdf document from gridview data and store on web server  - Part 59</b></h2><h5 class="post__date">2013-04-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/GLTWQBH5EhI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello welcome to precision technologies
I am Frankie this is part 59 a phase B
dotnet gridview tutorial in this video
well this is about generating PDF
document from grid view data and then
storing that PDF document in a folder on
the web server itself in part 58 of this
video series we discussed about
exporting grid view data to a PDF
document and then allowing the user to
download that PDF document now if you
remember you know when I click this
button export to PDF this grid view data
will be exported to a PDF document and
at the same time that will be downloaded
on to my machine
look at this I have this employees dot
PDF here I can open that and see that as
well
so when I click that button you know
after the PDF document is generated it
is sent back to the client machine ok
and basically what I want to do now is
instead of sending that to the client
machine and instead of allowing the user
to download that PDF document I want to
store that in a folder on the web server
itself obviously the first thing to do
is to create that folder in our web
application project so let's flip to
visual studio let's add a folder to a
project right click on the project add
new folder and let's call this PDF
documents ok so when I click this button
export to PDF now if you haven't watched
the previous session I would strongly
encourage you to do so before view
because we will be modifying the code
that we developed in part 58 so when I
click this button export to PDF at the
moment you know I'm able to download the
file and why is that happening because
if you remember we were actually writing
this PDF document to the output stream
of the response object that's why I am
able to download that now instead of
writing it to the output stream of the
response object I want to write it to a
file stream because remember what we
want to achieve is I want that employees
dot PDF to be returned to a file and
then store that in this folder PDF
documents ok so I'm going to use a file
stream to write it to a file ok and to
do that I'm going to use the fie
stream object for that so file stream
and if you look at this file stream
class it has got several overloaded
constructors you know there are 15 of
them I'm going to use the constructor
which takes in these two parameters the
path of the file where you want to
create that PDF file and the file mode
okay so how do we get the path ok the
path you know we can get the path using
server map path function now if you're
new to server dot map pad function we
discussed about this extensively in
asp.net video tutorial so please watch
that video ok so where do we want to
write to the file write the file now
within my web application drew to
directory I have this folder PDF
documents within that I want employees
dot PDF
you know PDF document file to be
returned to ok so to get to the root
directory first of all we want to use a
server dot map path function so server
dot map path and then to get to the root
directory I'm going to use this tilde
symbol forward slash so within the root
directory the folder is PDF documents so
let's copy the name of the folder and
then within that PDF documents folder I
want a file with name employees dot PDF
okay so that's the first parameter for
our file stream constructor class so
what's the next parameter the file mode
itself so file mode and I want to create
a new file so create that's it so that's
the first change that we want to do ok
so instead of writing it to the response
objects output stream now we are writing
it a file stream to create this file
employee start PDF within PDF documents
folder in the root directory of our web
application project
ok the next changes we can get rid of
all these lines altogether ok because we
are not writing anymore to the response
stream so I can get those or delete
those lines so let me run this now and
then when I click that button obviously
the data from the grid view control
should be generated into a PDF document
and that PDF document should be stored
in that folder so export to PDF first
thing to notice I don't have it
downloaded on the client
machine let's go to the web application
project so that's the folder right click
on that open folder in Windows Explorer
we should have employees dot PDF there
so I open employees dot PDF and I have
employees data there okay and one thing
to notice here this employees docx PDF
document is an export rate format now
let's say I want this to be generated in
a landscape format is it possible
absolutely so if you want landscape
orientation then obviously look at this
here we are creating the PDF document
document PDF document is equal to new
document and then we are specifying the
page size as for now I can use this page
size enum to specify you know I want an
a4 landscape orientation look at that
I'm going to use that and then actually
at the moment we only have you know if
you look at this PDF document we only
have four columns within that PDF
document so we cannot really tell if
it's in you know landscape orientation
or portrait orientation so let's add a
few more columns to this table so I have
the sequel script already here so if you
look at this table TBL employee at the
moment only four columns let me add
another few columns here Department name
date of birth date of joining username
etc so let me execute the script and
then let me know at the moment we have
just added the columns so obviously all
of them will be now so we need to update
each row with some sample data and I
have this update script already here so
let me execute this update script and
let's now select the data so we have
some dummy data there now if you need
the sequel script I will have this
available on my blog so you can download
it from there so now with this change
let's go ahead and rerun the application
so now the gridview should load the new
additional columns as well all right so
within the grid view now we have
Department date of birth date of joining
these additional columns let's export to
PDF okay so if you remember using a four
lens
format so let's go to that folder open
the employees now we should expect this
to be generated in a landscape format
but actually it's still in portrait
format okay so let me actually go to
100% here so that's still in portrait
okay so let's see then how to achieve
the landscape orientation to do that
instead of using this a folder landscape
it's a known issue you know this doesn't
work as expected what I'm going to do
here you can specify the page size as
normal a4 and then I can use this
function in a PDF document dot there's
something called a set page size and
then here we can specify the page size
I'm going to specify the page size as a4
dot and there is a function called
rotate so we are going to rotate the a4
so that we get landscape orientation
okay so now this works as expected
so let me run this now so let's actually
close this PDF document so the waveform
is still loading let's click on this
button export to PDF the PDF document
should now be generated so let's open
this PDF document and see if it is
generated look at that you know it's now
generated in a portrait format so
Department data of joining you know look
at that column names now they they show
all of you know basically in a landscape
orientation okay on this slide you can
find resources for asp.net c-sharp and
sequel server interview questions that's
it for today thank you for listening
have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>