<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Select into in sql server | Coder Coacher - Coaching Coders</title><meta content="Select into in sql server - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Select into in sql server</b></h2><h5 class="post__date">2015-09-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/1XQHULQcjG0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 97 of sequence of tutorials
in this video we'll discuss the power
and use of select into statement and
secret server for the purpose of this
demo we'll be using these two tables
departments and employees
I have already created these tables and
here is a sequel script to create and
populate them with test data
I'll have the script available on my
blog in case you need it so what's the
use of select into statement select into
statement selects data from one table
and inserts it into a new table now
let's look at some of the use cases for
this select into statement we can use it
to copy all rows and columns from an
existing table into a new table this is
extremely useful when you want to make a
backup copy of the existing table let's
understand this with an example
here we have caught this employee's
table which has some data within it now
we want to make a backup copy of this
table the easiest way to do that is by
using select into statement look at the
example here select star into employees
backup from employees table so the star
here specifies that we want to retrieve
all the rows and columns from employees
table and then this employees backup
table should be created on the fly and
all that data from the employees table
should be inserted into that employees
backup table this employees backup table
has to be a new table
it cannot be an existing table if you
specify an existing table with select
into statement it's going to throw an
error saying that the table already
exists let's look at this in action
let's flip to sequencer management
studio so if you look at the tables
folder within sample DB database we
don't have the employees backup table
there we only have the employees table
so now let's go ahead and execute our
select into statement so when we execute
that the first thing that should happen
is this employees backup table should
have been created on the fly and all the
data from employees should have been
copied into it so let's refresh this
tables folder notice that we have our
employees backup table there and when we
select the data from it we should have
all the rows of the employees table
within that employees backup now let's
go ahead and drop this table
now we can also use this select into
statement to copy all rows and columns
from an existing table into a new table
in an external database so if you look
at this employees and employees backup
table they are present within the same
database now what if you want you know
the backup in a different database now
here I have another database HR dB now
what we want to do is create a backup
copy for this employee's table in an
external database that is in HR DB
database so the employees table is
present in sample DB but we want the
backup in another database HR dB now we
can still achieve that using select into
statement all we have to do is specify
the fully qualified name
so this employees backup table has to be
present in HR DB database and we're
using the schema dbo so HR DB DB o dot
employees backup so when we execute this
select into statement you know this
employees backup table should have been
created in HR DB database so let's go
ahead and refresh this tables folder
notice that we have the employees backup
table there and when we select the data
we should have all the rows of the
employees table so now let's go ahead
and drop that table we can also use the
Select into statement to copy only
selected columns into a new table so if
you look at this employees table we have
got like five columns in it now let's
say for example in our backup table I
don't want all the columns I just want
the first three columns ID name and
gender okay if that's the case instead
of using star simply specify the column
list the columns that you want we want
ID name gender from employees table the
backup table has to be employees backup
so this table will now have only those
three columns so let's look at that in
action when I execute that the employees
backup table is created on the fly with
those three columns and all the data
should have been copied into that so
let's drop this backup table again
now we can also use select into
statement to copy only selected rows
into a new table so now if you look at
this employee's table at the moment it
has got five rows when it in it now what
we want to do is we want to retrieve and
make a backup copy of the employees
whose department is department ID one we
can still do that using a where Clause
here so in this case this schema for
this employees backup table is going to
match up with the employees table but as
far as the data is concerned it's going
to contain only the employee rows where
department ID equals one so let's go
ahead and execute this query now look at
that the message says two rows affected
and if you look at the data in a backup
table we should only have those
employees whose department ID is one
let's drop that now so far we have seen
examples of how to make a backup copy
from a single table now we can also use
selecting tool to copy columns from two
or more tables into a new table so here
we have got two tables departments and
employees now what I want to do is I
want to copy all the columns from both
of these tables into you know a backup
table okay so if you look at this select
into statement here this is again
straightforward now let me actually
remove that star you know into here and
let me say simply select star from
employees in a joint departments and
that's the joint condition they are
joining with department ID an employee's
table with department ID in departments
table so when we execute this what are
we going to get we are going to get you
know all the columns from both the
tables okay now what I'm going to do
here is select star into employees
backup so this is going to select all
these rows and columns
into this employees backup table let's
actually look at that in action
so I am going to execute this and when
we select data from employees back up
look at that we've got all the columns
and rows from both the tables employees
and departments now what we want you
know only specific columns now if you
look at this data
definitely Department ID is duplicated
we have Department ID an employee's
table and Department ID in departments
table now let's say we want only you
know one column either from the
employees table up from the department's
table we don't want that to be
duplicated we can still do that so
instead of specifying star here we can
specify the list of columns that we want
so let's do that now so let's actually
drop this and I am going to say we want
all the columns from employee table so
I'm going to say employees dot star and
then I want from departments table so
departments dot department name so let's
execute this and now if we select from
employees back up notice that we only
got the department ID from employees
table and then you know the department
name from departments table we didn't
get the department ID column from
departments table so you can either
specify star or the column list that you
want when you are joining two or more
tables so here the example covers only
two tables but you can have as many
tables as you want now you can also
create a new table whose columns and
data types match with an existing table
now there might be situation where you
know your table has got lot of columns
maybe like 40 to 50 different columns in
a given table now your requirement is to
create a table whose schema matches with
that table but you don't want any data
within that new table that you're going
to create now you can still do that
using select into if you have to
manually do that you know you have to
write that create table script and it's
going to take a bit of time but let's
select into statement it's going to take
literally like five seconds to do that
now the trick here is to specify your
where clause and you know the condition
here is never going to be true one not
equal to one that will never be true so
no rows will be copied from employees
into this employees backup okay it will
only create that table with the
structure of the employees table okay
let's look at that in action let's drop
this employees backup table and now I'm
going to execute this query right here
and look at the message it says zero
rows effect that means no rows are
copied from the employees table into
employees backup but the structure of
this table must be very similar to
employee's table look at that we've got
I rename gender salary and department ID
columns the same columns that we have an
employee's table now one very important
thing to keep in mind is that you cannot
use select into statement to select data
into an existing table select into
statement can only be used to select
data into a new table okay to select
data into an existing table you will
have to use insert into statement so
look at this when I execute the Select
star into employees backup now at the
moment we have this employees backup
table we don't have any data in that so
it's an existing table and here I'm
using select into statement I am trying
to select data into this existing table
and look at what we are going to get
look at the message it says there is
already an object named employee backup
in the database so you cannot use select
into statement to select data into an
existing table to select data into the
existing table you will have to use
insert into statement so here insert
into employees backup select star from
employee so when we do that it's going
to retrieve all the rows from employees
and insert them into this existing table
employees backup there we go now let's
actually truncate the data and this one
so truncate table employees back up so
this is going to remove all the rows
from that table so now we don't have any
data now let's say for some reason you
don't want you know all the columns from
employees table we only want to insert
ID name and gender column values but not
salary in department ID if that's the
case you can specify the column list
here so insert into employees backup and
the values that I want to insert our ID
name gender and we want to select ID
name and gender from employees so when
we execute this within our employees
backup and only those three columns
should be populated various cellular and
department ID or not thank you for
listening and have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>