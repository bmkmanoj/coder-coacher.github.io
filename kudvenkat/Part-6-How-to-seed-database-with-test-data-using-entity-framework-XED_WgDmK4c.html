<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 6   How to seed database with test data using entity framework | Coder Coacher - Coaching Coders</title><meta content="Part 6   How to seed database with test data using entity framework - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 6   How to seed database with test data using entity framework</b></h2><h5 class="post__date">2014-05-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/XED_WgDmK4c" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part six of entity framework
tutorial in this video we'll discuss how
to see database with test data using
entity framework this is continuation to
part five so please watch part five
before proceeding so far in this video
series we have been manually populating
the database with test data using the
insert sequel script but entity
framework can automate this for us let's
look at the steps that are involved we
will be modifying the example that we
worked with in the previous session so
please watch part 5 before proceeding so
the first step here is to add a class
file and let's call it employee DB
context Edo dot CEA's
the reason why I have chosen this name
is because we're going to make use of
this class to see the employee database
with some test data so let's flip to
visual studio and then to this existing
project let's go ahead and add a class
file and let's call it employee DB
context cedar dot CS and we're going to
make this class inherit from a different
class call drop create database if model
changes if you recollect from the
previous session within the global dot a
CX file within this application
underscore start even handler method
notice that we are passing an instance
of drop create databases model changes
to the set initializer method okay so
we're going to make our employee
dbcontext see the class inherit from
that base class that it dropped create
databases model changes and this class
is present in a different name space
that is system dot data entity which is
our entity framework namespace so let's
go ahead and bring that in and notice
that to this class we are specific our
of our DB context type which is employee
DB context so within this class within
our employee DB context either class we
need to override a method that is
present in Drop create database if model
changes and the easiest way to get to
that method is by typing the override
keyword and then once we press spacebar
then it's going to show us all the
available methods that we can override
and the seed method belongs to drop
create database model changes so that's
what we want to override so let
select that and look at this to the seed
method what we are getting in as a
parameter it's an instance of employee
dbcontext class okay that's what we have
created in the previous session and you
know we are passing that context object
to the seed method of the base class so
I'm going to leave that there so here we
need to write logic to populate the
employee DB with some test data so
basically what I'm going to do here is
create a department object and if you
look at Department object it has got
three properties basically actually four
so let's call it department one so these
are the properties ID name location
employees now we don't have to specify
an ID for the department because we are
inserting we are going to insert a new
department and the ID is an identity
column so we don't have to supply a
value for that that will be
automatically computed by the database
so it's enough if we just specify name
location and employees okay to speed
things up I have already typed the
required code so if you look at the seed
method here you know we have one
department there so we are specifying
name is ID location as new work and then
employees you know it's going to be a
list of employees so we are creating a
new list of employee objects there and
then at the moment this list contains
one employee first name last name gender
salary and job title and the interesting
thing to notice here is that we are not
specifying the department ID of the
employee object okay that is going to be
automatically computed by entity
framework for us so what's going to
happen is entity framework will insert
the department and then it's going to
retrieve that department ID you know the
auto-generated identity value for the
department row and then use that value
as the department you know ID property
value for the employee object that it's
going to insert we don't know about the
department ID so we can't really tell
that at this point of the time so entity
framework will take care of that for us
we don't have to populate that property
here okay so here I've just shown you
you know an example of inserting
one department and one employee within
that department okay and then notice
what we are doing with the department we
are passing it to the add method of the
department departments object and we are
invoking that on the context object and
what is that context it's nothing but an
instance of our employee DB context and
then we are basically passing that
context object to the seed method of the
base class which will take care of
adding it to the database okay and to
speed things up as I told you I have
already typed this so here I have three
departments so let's copy and paste this
code right here and it's again very
straightforward it looks lengthy but
then it's a straightforward code notice
that here we are creating an instance of
the department specifying name location
and then we have got employees here and
that employees is a list of employees so
this is the first employee mark Ben and
then John okay we got three employees
say that is Department one similarly
we've got department - and then
Department three Department three has
got two employees Department two also
has three M two employees and then
finally what we are doing we are adding
that department one to the departments
collection property of the context
object and the same is the case with
Department two and three and then
finally we are passing that context
object to the seed method of the base
class okay so that's the first step add
a class file you know employee DB
context EDA and then overwrite the seed
method the next step is within the
global tour aax file okay so within the
application underscore start method
instead of passing in a new instance of
drop create database if model changes
class we are going to pass a new
instance of our employee dbcontext see
that class so let's copy that and pass a
new instance here
that's it now what I'm going to do is if
you look at the database tables here
notice that at the moment Department's
table is called as departments but
employees table is called as TBL
employees and that's because if you
recollect again from the previous
session we have used this table
attribute to change the name of the
table within the database to TBL
employees so let's actually get rid of
that so now the model is actually
changing because we have removed that
table attribute I am also going to
remove this column attribute we wanted
first name to be first underscore name
you know as the column name within the
database so that's why we have used this
column attribute but I am going to get
rid of that so that the first name
column will be generated as first name
without an underscore okay
so let's build the solution and then
let's view this waveform in a browser
window so what should happen it should
drop the sample database and obviously
it should recreate the sample database
departments and employees tables and
notice that at the moment it's called
TBL employees but after it drops and
recreates it it should be called as
employees so it's still trying to drop
and recreate the table I guess we are
going to get a runtime error because of
the fact that this database is in use so
let's close sequel server management
studio so that the connection is lost
now it has actually created that
database and to just to prove that let's
open sequel server management studio
Connect and then let's look at the
sample database so notice that it's
called as departments employees let's
right-click on this one let's say select
top top thousand rows so we have got
those three departments and let's look
at our employees and we have called
those employees as well and look at the
department IDs you know there are three
employees in IT department which is
department ID one two employees in the
HR and three and two employees in the
payroll department okay all right
that's it for today thank you for
listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>