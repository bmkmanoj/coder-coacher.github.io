<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 10  Working with multiple tables in mvc | Coder Coacher - Coaching Coders</title><meta content="Part 10  Working with multiple tables in mvc - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 10  Working with multiple tables in mvc</b></h2><h5 class="post__date">2013-05-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/oN1f2Vpc-wU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Oh welcome to prism technologies I am
venket this is part 10 of asp.net MVC
tutorial in this video we'll discuss
working with multiple tables please
watch part 9 before proceeding with this
video in sequel server database I have
caught these two tables on the left hand
side we have TBL department table which
has got departments data and on the
right hand side we have TBL employees
table which has got employee data now
using these two tables I want to build
an MVC application in which departments
list page should display the list of all
departments that are available in TBL
department table department names must
be rendered as hyperlinks once I click
on a department name then we should
redirect the user to the Employee List
page which shows all the employees
belonging to the department upon which
we have clicked and then once I click on
an employee name then we should redirect
the user to the employee details page
which shows the complete details of the
employee like employee ID name gender
and city and then on this employee
details page notice that we have this
link back to employee list which when I
click you know we should redirect the
user back to the employee list page and
once I click on this link here back to
department list we should redirect the
user back to the department list page
let's see how to implement this first
we'll implement the department list page
okay so let's glue or flip to sequel
server management studio look at this I
have these two tables TBL department and
TBL employee so let's flip to visual
studio first let's go ahead and add a
model class ok so right click on the
models folder add new class and let's
call this department department dot CS
that's the name of the class file so a
class is going to be department class
and if you notice the department table
it has got two columns ID and name so
let's go and create two properties
so public end ID and let's have the get
and set accessors and along the same
lines let's go ahead and have you know
the name of the department which is
going to be string and then look at this
an employee I mean a department can have
multiple employees so we are gonna have
another property here so public list of
employee and let's call this employees
so a department can have multiple
employees so using this property we are
going to retrieve the list of employees
who belong to the given department ok so
we have our department model object
already so let's go ahead and build the
solution so that we'll have this
department class compiled so that's the
first step to do okay and this
department class should be mapped to TBL
department table and to do that I'm
going to use the you know table
attribute and if you remember table
attribute is present in system that
component model dot data annotations
that schema namespace so I'm going to
use the table attribute now and then we
are going to specify the name of the
table so which is going to be TBL
department let's copy the name of the
table okay so we have our department
model class right now and then the next
important thing to do is if you look at
the employee context class at the moment
it's only retrieving the DB set of
employees we also need to retrieve the
DB set of departments as well so let's
add another property to this employee
context class so and I'm going to call
that DB set of department and let's name
the property as departments okay so
that's the second change now let's go
ahead and implement the department
controller class and to do that
right-click on Deakin
Julis folder add controller and let's
call it department controller let's
click Add
so that should add the Department
controller class for us and then I'm
going to make use of this default index
action method here so what we need to do
we need to create an instance of
employee context class so where is this
employee context class present that's
present in this MVC demo dot models
namespace so let's go ahead and import
this namespace in our department
controllers class file so employee
context let's create an instance of this
employee context class which is going to
establish the connection to the database
and then let's use the department's
property of the employee context class
to retrieve you know the list of
departments that are present in TBL
departments table ok so this property is
going to return the list of departments
ok so let's convert that to list and
then let's declare a variable which can
hold the list of departments the list
department and let's call it departments
all right and let's handle with these
departments to the view for rendering
okay so the next step is obviously to
add a view which can render the list of
departments and to do that I'm going to
right click on the index action method
from the context menu select add view
the name of the view is going to be
index we're going to make use of razor
view engine and we want to create a
strongly typed of view and we want to
select Department as our model class ok
and let's click Add which should add the
index view look at that in the views
folder it has automatically added the
department folder and within that we
have this index a dot a CS HTML so
within the departments list page first
of all the title of the page should be
departments in list so let's go ahead
and change the title of the page to
departments list and let's also set you
know the text on the page to
department's list ok and let's use a div
tag here just to specify some Styles so
div style is equal to I'm going to set
the font family to area
okay let's go ahead and use a using
statement so that we don't have to you
know use the fully qualified name of the
Department class every time so I'm going
to get rid of that fully qualified name
there and I'm going to use you know
using MVC models MVC demo dot models
okay that's the namespace and the
department classes present within that
namespace okay so we know that you know
to this view we are actually handing
over a list of departments look at this
this is actually a collection of
departments but if you look at our index
dot CSS HTML at the moment we are only
getting one department object so we are
expecting I mean we are actually passing
a list back so I'm going to set the
model as high innumerable of Department
okay so now what we need to do we need
to loop through this list of departments
that this view is going to receive and
then we want to display the department
names okay and if you remember in the
previous session we discussed about
using HTML you know action link helper
to generate the hyperlinks for us okay
so I'm going to go back to the employee
you know index view of the employee
controller and I'm going to copy this
code and then use it within our
departments page so I'm going to copy
this and then let's paste that within
our index dot CS HTML of the
department's folder okay so for each
department because you know this view is
going to receive list of departments so
for each department let's call the
object s department in model what is the
model it's a list of departments so we
are looping through each department and
what we are trying to do we are actually
you know look at this if you remember
the action link you need to specify the
link
and the action name and then any root
values okay any parameters federal that
method has got some parameters okay so
here you know basically the link text
has to be the department name so
department name and then we want to you
know when I click the hyperlink the
department name hyperlink we actually
want to invoke you know we want to
redirect the user to employee list page
okay and to which controller action
method within the employee list page we
want to redirect the user to the index
action of the employee controller so
here we have employee controller we want
to redirect the user to index action
okay so I'm going to specify the action
method as index and if you remember we
won't redirect the user to the employee
controller so I'm going to use another
overloaded version of this action link
method you know it has got several
overloads we discussed about them in the
previous session look at this there are
10 overloads now when I click this
department name hyperlink we want to
redirect the user to the index action of
the employee controller okay
so here we also need to specify the
controller name as well and to do that
look at this
there are several overloads so I can use
an overloaded version you know where it
takes the controller name as well so I
want to redirect the user to employee
controller and then look at this I need
to specify you know the route values as
well because look at this when I click
on a department name then we need that
we redirect the user to the employee
list a page and we want to on that page
we want to display the list of employees
belonging to the department on which I
have clicked so to the destination page
we also need to pass the department ID
okay so that's going to the parameter so
I'm going to call this for now depart
meant ID and then how do we get access
to the department ID use the Department
object so department ID is equal to
department dot ID okay
so that should do so let's go ahead and
run this now and see if the department
names will be listed as expected so we
want to go to the department controller
and in the X action method which should
display the list of departments look at
this
I get the list of departments as
expected and when I hover my mouse over
look at that I am actually getting it
says localhost MVC demo department and
it says question mark length is equal to
8 you know it's not actually working as
expected
why is that that's because if you look
at the overloaded version we are using
we are actually using the wrong version
of action link HTML helper method so I
want to use an overloaded version which
takes the link text you know so we have
the link text the department name and
then I actually look at this I want to
use an overloaded version which takes 4
parameters here the link text which is
the department name the action name
which is the index you know action
within employee controller and then
these are the route values and finally
you know this overloaded version also
expects you know HTML attributes to be
passed I am passing null at the moment
ok so this is the correct version of you
know Action League HTML helper method
that I want to use so with this it
should work as expected so let me run
this once again and then let's go back
to departments controller index action
let me hover my mouse over there and
look at that now it's working as
expected look at the URL there when I
click on this it's gonna fail but that's
fine but look at the you are
we are navigating the user onto the
employee controller and we are passing
the department ID there okay so the
index action within the employee
controller now needs to receive you know
department ID parameter so let's go
ahead and pass that so I'm going to call
this department ID and then look at this
this employee context object is going to
retrieve all employees we don't want all
employees we want to filter the
employees based on the department ID and
to do that I am going to use a where
Clause here the link extension method
where you know the employee such that
employees department ID look at that now
I don't have the department ID property
in the employee object at the moment so
let's go ahead and add that property to
our employee object the employee model
class so let's go to the employee model
class and then I'm going to add here the
department ID property and that's going
to also have the default get and set
accessor all right so now let's come
back to the employee controller index
action method we want to filter the
employees based on the department to
which they belong and I'm going to use
the where clause for that where employee
such that EMP dot Department ID is equal
to whatever we are passing in to this
controller action method and we can with
that to list and then we hand that you
know list to the view so now we are
filtering okay so now let's go ahead and
run this and see if it works as expected
so let's navigate the department
controller index action method so we are
let me click on the IT department so now
look at that I get all the employees
that belong to the IT department let's
go back click on the payroll department
look at that I get the employees who
belong to payroll department
now the rest of the workflow is already
implemented you know this page we have
implemented in the previous session okay
so when I click on this back to list I'm
going to go back but then look at this
the problem is when I actually click on
this back to list look at the URL it's
going to the index action of the
employee controller but then if you
remember the index section of the
employee controller expects a department
ID to be passed back which we are not
doing at the moment so let's go ahead
and change that so within the details
you know view of the employee let's go
ahead and change this here so we want to
you know send the user back to the index
action of the employee controller but
then we also need to specify the
department ID because right now we are
filtering the employees based on the
department to which they belong so here
the model here is actually the employee
object and if you remember employee
object has got a department ID so all we
need to do here is to pass the
department ID okay so how do we pass the
department ID so new and we specify
department ID is equal to at model dot
department ID that's it
so this should fix that issue so let me
run this once again let's go back to
department index let's click on HR
department so we are on the Employee
List let's click on the employee name
and we are on the employee details page
now look at this when I click this I go
back you know to that department which
is the HR department okay now here we
need to implement another link you know
when I click on that link we need to
redirect the user back to the department
list let's see how to implement that so
we let me copy this and then use it
within our index action
I mean index view
so now look at this we want to go back
from the employee list to the department
list and you know how do we get the
department list we have the index action
within the departments controller so we
need to redirect the user back to the
index action of the departments
controller and to do that so I'm going
to use the I'm going to go to the index
action we also need to specify the
controller name to which controller we
want to go we want to go to the
Department controller and we don't have
to specify any parameters for the
department
you know index action because it's going
to list all the departments so I'm going
to get rid of this one and if you look
at the overloaded version that I am
using so I'm using the one which takes
the link text you know this overloaded
version link text action name and the
controller name alright now let's go
ahead and run this we should have
everything working now so I want to go
to Department index click on the
Department we should have the employees
belonging to that department I click on
this one it should go back to the
department list click on IT department
go to that employee back to list back on
IT department employees back to list the
complete you know department list on
this slide you can find resources very
speed or net c-sharp and sequence of
interview questions that's it for today
thank you for listening
have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>