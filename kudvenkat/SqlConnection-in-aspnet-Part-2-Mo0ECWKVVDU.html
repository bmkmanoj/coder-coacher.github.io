<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>SqlConnection in asp.net - Part 2 | Coder Coacher - Coaching Coders</title><meta content="SqlConnection in asp.net - Part 2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>SqlConnection in asp.net - Part 2</b></h2><h5 class="post__date">2012-10-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Mo0ECWKVVDU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to pledging technologies I am
venket this is part 2 of a do dotnet
video series in this session we'll learn
about instantiating a signal connection
object using this equal connection
object why is it important to close the
database connection and how to properly
close a database connection before
continuing with the session I strongly
recommend to watch part 1 of this video
series where we have discussed the very
basics of video net from what part one
it should be clear that ad or dotnet is
a set of classes that helps you know a
dotnet application to communicate with
the data source execute commands
retrieve data and display the data
within the application now we know that
ad or dotnet has got these important
classes within that the connection
command data reader data adapter and
data set classes now depending on the
data provider with which you know the
dotnet application talks for example if
the database is sequel server then we
use the set of classes that are present
in systems or data dot sequel client
namespace because that is the namespace
you know which is the dotnet data
provider for you know sequel server
meaning that all the classes that helps
us to connect to a sequel server are
present in system data dot sequel client
so if the if the database is sequel
server we will be using sequel
connection sequel commands sequel data
reader and sequel data adapter along the
same lines if the database is going to
be Oracle then we use the classes that
are present in system dot data
Oracle client ok and and the connection
is going to be Oracle connection Oracle
command Oracle data reader and Oracle
data adapter so this these objects the
connection command data reader and data
adapter these are provided specific
whereas the data set is provider
independent we will be talking about
data set in a later video session ok so
these are the different dotnet data
providers that are available you know if
we want to connect to an oledb data
source for example an excel or a
Microsoft Access database then we use
the set of classes that are present in
system data oily DB
so if we know how to work with one
database then then it's very simple to
work with the other databases all you
will have to do is to change the prefix
of these objects if it's sequel server
its sequel connection sequel command if
it's Oracle Oracle connection Oracle
command if it's oledb data source only
DB connection already we command etc but
the fundamental logic is the same you
know you create a connection object
prepare a command execute that retrieve
the results and then finally close the
connection okay so in the next few
sessions of this video series what we
are going to do is we are going to talk
about these objects in great detail so
in this session we are going to talk
about sequel connection object all right
let's flip to it visual studio I have a
simple asp.net web application here I
have this webform one dot aspx let's
drag and drop the webform a grid view
control on to this web form which is
capable of displaying data so I have
this grid v1 let's drag and drop that
and let's sort of format that so that it
looks a little nice we will be talking
about grid view control in a very great
detail in a later session so let's go to
the code behind file now from part one
it should be very clear you know how to
create a connection object how to
execute the command you know we have
seen those steps so let's quickly you
know create the connection object source
equal connection con is equal to new
sequel connection obviously the first
thing to create a connection object look
at this I have you know if you look at
the connection class sequel connection
class there are two overloaded versions
of this constructor one version you can
see that here it doesn't take any
parameter if I click the down arrow it
shows the second overloaded version you
know it X accepts a connection string
parameter so let's pass the connection
string parameter before that first let's
create the connection string so I'm
saying string CS standing for connection
string is equal to now obviously the
connection string you know if you have
if we want or dot in the application to
connect to a sequel server you know
still needs to provide the information
about what is the name of the server
what's the database that you want to
connect to what's the user ID and
password now it's just like for example
let's say I have sequel server now I
want to connect to sequel server as a
user now I need to specify the name of
the server to which I want to connect I
have to specify what type of
authentication do I want to use for
example if I use sequel server
authentication I have to provide the you
know username and password whereas if I
use Windows authentication I don't have
to provide them okay so similarly even
for a dotnet application if it has to
connect to a database then we will have
to specify what is the name of the
server name of the database what user ID
and password are you using depending on
the type of authentication if it is
windows authentication then you will you
don't have to provide a username and
password
because whatever credentials that you
have used to login to the computer will
be used to login to the sequel server
also okay so here data source which is
nothing but the name of the server so
here I am working with the local
installation of sequel server on my
machine so I am just specifying dot if
your server is on a network then you can
specify the name of that computer or the
IP address of that computer so here I am
specifying dot because that this is a
local server and then semicolon and then
the database within that sequel server
because if you look at the sequel server
it has got several databases so which
database do you want to connect to okay
I want to connect to the sample database
so I specify that using database keyword
database is equal to sample semicolon
now you know some people call it
database you know you might see
connection strings which is also using
initial catalog so you can either
specify it as initial catalog or
database and then you will have to
specify the user ID whatever user ID
that you are using and password whatever
password that you want to use to connect
to the sequel server now I am NOT going
to use sequel server authentication I'm
going to use you know Bendel's
authentication so if you are using
windows authentication then you will
specify integrated security is equal to
SSP I okay
now if you look at this this is our
connection string which has got the name
of the server the database that we want
to connect to and I'm using integrated
security because I want to connect using
windows authentication so this
connection string is actually named
value pairs or you can call it as key
value pairs now this is the name and the
value for that is dot indicating that
it's local server database is the name
and this is the value and these are
separated by semicolon so connection
string is a string of name value pairs
okay so now when I am creating my sequel
connection object look at this I can say
sequel connection now this connection
object does not know to which sequel
server it has to connect because you
didn't tell it which server which
database okay one way to do that is you
pass that connection string to the
constructor of this sequel connection
object because we have one of the
overloaded version which takes the
connection string okay so we can either
do this or what you can do just create
the connection object and then say
connection dot connection string
property if you look at this
this is a string property so I can just
set CS there okay I can either do this
or if you want to do it in one line just
pass that to the constructor of the
sequel connection class okay so we have
the connection object created now now
the next step is to actually prepare the
sequel command we will be talking about
sequel command in great detail in it in
the next session so sequel command
CMD is equal to new sequel command so
obviously what I want to do I want to
execute this query so let's copy that
and then look at this you also have to
tell the command on which you know
connection we want to execute this
command so I want to execute this on
this connection object so this
connection object knows - which sequel
server and which database so you are
telling this command object okay execute
this command on this connection and this
connection is pointing to a local server
sample database so this command will be
executed on the sequel server instance I
have okay so that's the command object
now after we have the command we need to
open the connection so connection dot
open to open the connection we use the
open method and then execute the command
command dot execute reader we will be
talking about the command object in
great detail in a later session so don't
worry about that now so could it be one
dot datasource is equal to that and we
are calling the data bind method so
finally once we have the data you know
we are setting the result of the command
execution as you know to the data source
property of the gridview control and
then we are calling data bind method
finally just close the connection okay
so now if I run this application as you
might expect you know it will create the
connection open the connection execute
that command get the result and display
it on this browser window okay now but
have we written the code in the best
possible way here no just imagine what's
going to happen when when there is an
exception somewhere over here okay let's
say to open the connection and it's
trying to execute the query and there is
an exception if there is an exception
what happens your connection is left
open
so after this command is executed if
there is an exception it will skip these
two lines so you are not calling
connection but close which means the
connection is left open and
remember connections are very valuable
resources you have to close those
connections if you don't close them
the scalability and performance of the
application will be seriously affected
that's why connections needs to be
closed properly if you want your
application to be scalable make sure you
open the connections as late as possible
and close them as as early as possible
look at this I can open the connection
immediately after creating it but there
is no necessity okay just before I
execute the command you know if I open
the connection that's more than enough
that's why I'm actually opening the
connection after actually preparing my
connect command and then after executing
that and binding the data results to the
grid view control I am closing the
connection immediately okay but then to
close the connection properly always put
this in a try-catch and finally block so
what I will do now is instead of you
know having it here if I have it here
what's going to happen if there is an
exception here you know this connection
will never be this connection will never
be closed that's why let's put it in a
try-catch and finally block so I have
this equal connection let's put this in
try so all these statements go in the
try block and then if there is any
exception you know we will handle that
exception obviously we will lock the
exception to the database or email the
administrator of the application you
know whatever deal with the exception we
have spoken about exception handling in
c-sharp video series but we will also be
talking about exception handling in
asp.net hope we will do exception
handling in asp.net in a later session
and then we have this finally block so
we know that the finally block is
guaranteed to execute so obviously you
know we have the connection object and
we open the connection here if there is
any problem any exception here you know
it it will come to the cache block cache
block gets executed and then finally it
closes the connection even if there if
there is no exception then all of these
statements gets executed still
finally block is executed so our
connection is guaranteed to be closed
that's why it's always important to
close the connections in the finally
block okay actually there is a better
way of closing connections instead I
mean if you don't want to use try catch
finally you know people usually use
another construct called using so I can
either close the connection like this or
if I'm not using exception handling for
some reason and you want and you don't
want to close the connection the finally
block then you can use the using
statement I can just wrap this around
using connection and all I do is that
and I don't need to even have connection
dot close so if we don't have connection
dot close then how is this connection
going to be closed as soon as you know
the program comes to this line it will
close the connection when encounters you
know after this closing brace this
connection is going out of scope so it
will immediately close that this using
block forces that connection to be
closed we don't even have to call
connection or close they're so important
points to keep in mind connection should
be opened as late as possible and should
be closed as early as possible
connection should be closed in the
finally block or using the using
statement okay depending on your need
choose one of the options and this is
one of the common interview questions as
well you know what are the two uses of
in using statement in c-sharp so we have
this using statement we using it
actually at two places one is on the top
here two to import a namespace and then
the other one is to actually close
connections properly and this interview
question is very commonly asked so I
thought I will just share that with you
on this slide you can find resources for
asp.net c-sharp and sequel server
interview questions that's it for today
thank you for listening
have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>