<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GridView insert update delete without using datasource controls - Part 25 | Coder Coacher - Coaching Coders</title><meta content="GridView insert update delete without using datasource controls - Part 25 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>GridView insert update delete without using datasource controls - Part 25</b></h2><h5 class="post__date">2013-03-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/tONdC7ZPx7Q" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so welcome to prism technologies I am
venket this is part 25 of asp.net
grid-view tutorial in this video we'll
discuss about inserting updating and
deleting data from grid view without
using data source controls now in part
23 of the asp.net grid view tutorial we
discussed about inserting updating and
deleting data from grid view using
sequel data source control and in part
24 we discussed about doing exactly the
same thing using object data source
control after watching these two videos
a lot of my youtube subscribers has
actually asked me whether if it is
possible to perform insert update and
delete on grid view without using data
source controls at all absolutely it's
definitely possible and that's what we
will be discussing in this video we will
be modifying the example that we used in
part 24 so I strongly recommend to watch
parts 23 and 24 of asp.net video
tutorial before proceeding with this
video without further ado let's flip to
visual studio now if you remember in
part 24 we were using this object data
source control to retrieve and display
the data within the grid view control so
we don't want to be using these object
data source controls so let me get rid
of that object data source control and
since this grid view is associated to
that object data source control using
data source ID property of the grid view
control let's go ahead and get rid of
that data source ID property look at
that data source ID is equal to object
data source one we have just deleted
that object data source control so let's
get rid of this data source ID property
and look at this after I have deleted
that and when I try to save it I get a
warning message now that's because the
object data source control that's
associated with this grid B control is
removed so it's asking me you know
whether if I want to refresh fields and
keys for grid b1 and I'm going to select
no here because I want to retain all the
template fields and validation controls
that we have you know on this grid view
control okay so that's why I said no all
right so that's our first step get rid
of the object data source control and
then remove the association between the
grid we control and object data source
control by deleting that data source ID
property and the next step since we have
already deleted that object data source
control if you remember in the
code-behind file we were actually using
that object data source control so I
don't I don't want this method anymore
okay now when is this method call this
method is actually called when we click
this insert button it put in the footer
of the current view control okay but
then we are doing that using object data
source control and we don't have that
object data source control anymore and I
will not be using this method going
forward so I am going to completely get
rid of this method elbe insert
underscore click ok so let's delete that
and since we don't have this even
handler method anymore but that's being
actually referred by the link button
that we have within the footer control
look at that within the footer of
employee ID column so let's go into the
in a grid view control into the footer
of employee ID template field so this is
the template field where we have
employee ID and within the footer
template we have this link button and
then there is this on click attribute of
the link button which is actually
referring to that method which we have
just said deleted so let me get rid of
this onclick attribute ok all right so
what's the next step so we have done you
know these four steps until now okay the
next step is basically if I flip this
waveform to the design mode look at this
this edit and delete buttons are
displayed within the grid view control
using Fe I mean using the column type
called command field so they edit and
the cancel buttons are actually
displayed using a command field okay now
I don't want this command field instead
of that command field I am going to use
a template field so I'll have better
control or when I use a template field
so basically you know I'm going to get
rid of this command field and then I'm
going to use a template field there and
obviously when we use a template field
we are going to have edit item template
item templates etc okay so let's go
ahead copy and paste a template field
there and I have typed this HTML you
know just to save some time so let me
call
pay pace there and all let's format it
by pressing ctrl K and D and then we'll
go over the HTML so it's actually pretty
simple you know I have a template field
here and then if you look at that
template we'll actually yeah so if we
look at that template field that we have
just copied and pasted we have an item
template and an edit item template okay
so obviously item template is used when
the row is rendered normally and when I
put the row in edit mode
that's when edit item template is used
now look at this when the row is
rendered normally we want the edit
button and delete link buttons okay and
that's what I have in item template so
if you look at the item template of the
template field I just copied and pasted
it I have to link buttons okay one is
for edit so that displays edit text and
the other displays delete text as you
can see here okay and the other
important properties that you need to
pay attention to here is obviously ID
that's every control needs to have an ID
and command argument look at that
what are we you know we are setting this
command argument property to employee ID
so whatever this eval method is
returning back you know it's it's
actually returning back employee ID okay
so we we are using that employee ID as a
value for this command argument later
we'll actually see how we are going to
use that command argument property of
this link button and then obviously I
have command that name here so if you
look at the command name I have set it
to you know a hard-coded string edit
row' okay those are the two important
properties that we need to set on this
link button because later when we edit a
row we'll be using those properties okay
and then for color Annette is equal to
server and that's the text
similarly for delete button in a command
argument again it's can it's going to
contain the employee ID command name is
going to contain you know this delete
row okay and the rest of the properties
are similar so that's item template but
then when I put the row in edit mode
look at that delete button should not be
visible and then I should get update and
cancel but
and that's what I have an edit item
template another to link buttons and
look at the text that I have update and
cancel because when we put the row in
edit mode I don't want to delete the
link button I want update in cancer link
buttons and that's what I have here okay
again if you look at the command
argument it's going to take employee ID
command name is look at that that's a
little different when I click this
update what do we want to do we want to
update that row and that's what I have
set it to update row in a bit you will
understand how we will be using this
command name property and command
argument properties and obviously when
we click the cancel link button you know
we want to cancel update so that's what
I have set command and name to you can
give it any meaningful name I've just
happened to choose choose you know
update row and cancel update okay and
yeah that's the edit I mean template
field which is going to display you know
the link buttons for editing and
deleting another small modification that
I want to do look at the link buttons
here they have a different color but
this link button within the footer
template has a blue color I want even
that insert button to have you know the
same color as edit and delete buttons
and obviously to do that all you need to
do is you know this link button has got
a full color property so let's set the
color per day on the insert link button
as well where is that insert button
present it's present in the footer
template of employee ID template field
so let's go to employee ID template view
which is this one and with in the footer
template I have this link button all I'm
going to do is set full color and now if
we flip this to design mode as you can
see look at the color is the same as
that okay all right so that's our sixth
step 2 include template fear and then we
are done actually with you know
designing the waveform now it's code you
know obviously we don't want to use any
data source control so I don't have to
resource control setup but remember we
have this employee data access layer
which has caught these methods you know
get all employees to retrieve employees
from our TBL employees table
and then similarly we have delete
employee method update employee method
insert employee method now if you need
explanation about these methods we
discussed about them in part 24 so I
strongly recommend to watch part 24 so
we have this employee data access layer
with these methods so what I'm going to
do now in our webform I'm going to write
a simple private method okay so private
word and let's actually copy and paste
that just to save some time so if you
look at the private method that I have
here all it's doing is I mean look at
the name bind grid view data so what are
we doing we are calling get employees
method that's present in employee data
access layer and if you look at what
this method is returning it's returning
list of employees so we are setting that
list of employees as the data source for
the grid view control and invoking data
bind so obviously when the page loads
when the webform first loads up what I
want I want to retrieve you know
basically I want to call this method
bind grid view data okay basically you
know this method is going to call
employee data access layer get employees
it's going to retrieve the employees set
that as data source and invoke data bind
so obviously now when we run this
platform as you might expect you know we
should be able to display that data
within the grid view control okay so we
have that and look at this when I click
insert I get validations and all because
we already have that HTML in place okay
but obviously now when I click edit or
delete nothing is going to happen
because we haven't implemented you know
what
you know the click of those buttons
should be doing okay so now the next
step is to basically you know we have
done this as well we have called the you
know in the page load then the first
time in the webform loads up if it's not
a postback if it's the initial get
request call your call this bind grid
view data method which is going to load
that data within the grid view control
ok the next step basically is to
generate an even handler for the script
you control now look at this within this
grid view control I have several buttons
you know within every data row we have
edit delete buttons we have once I click
Edit we are going
show update and cancel buttons and then
within the footer template I have insert
button
okay now whenever I click these buttons
within these rules of this grid view
control you know an event is raised and
that even is called as row command event
so anytime you click a button within the
grid view control it's going to raise an
event called a true command so let's go
ahead and generate that root row command
even by going into the properties of the
grid view control so row command event
let's double click here to generate the
event handler and within this row
command event handler I'm going to paste
in some code and we'll go over that in
just a bit again this is pretty simple
to understand it's just that we have
several if-else blocks okay so if you
remember when we were designing of a
grid view control okay especially when
we have included those template fields
which is the template field which is
displaying this edit delete update and
cancel buttons you know we have set a
name a very important property of those
linked buttons here look at this within
the first a template field I have four
link buttons okay and each link button
has got a command name edit row delete
row update rule cancel update you know
this these command name properties are
what determines which button the end
user has clicked so within our code
behind if I look at this when is this
even trace any time the user clicks a
button within the grid view control okay
now which button the user has clicked
how do we determine that using the
command name property you know of the
screen view command even to augment
object that's coming in so a dot command
name if that is equal to edit row that
means we know for sure the user has
clicked the sided button at which point
we want to put the true in edit mode and
to put a row you know off the grid we
control into edit mode programmatically
we use a property of the grid view
control called edit index so if you look
at you know edit index property it
requires an integer the row index which
you want to put in edit mode for example
if I click Edit on the first row you
know the
the row index there is zero so I need to
retrieve the index row within the grid
we control on which the you know the
user has clicked added and to retrieve
row index you know it's a little tricky
thing look at that what we are doing
here basically we are saying a dot
command the source ok this this grid
view command the event arguments object
so how did we land into this event
handler somebody has clicked some button
on the script control so which button
the user has clicked how do I know that
you know using this grid view command
object so a dot command source now that
command source we know for sure it's
going to be a link button either edit
delete insert etc okay so what are we
doing here we are actually typecasting
that to be of type link button and we
know that the link button is actually
present where is this link button edit
or delete or you know insert where are
these present these are actually present
within a grid view row okay so the
parent of these link buttons the control
the parent control of this edit and
delete link buttons is nothing but a
grid view draw okay so when I use this
property look at that a dot command
source will give me the link button
I am typecasting it to the link button
but if you look at command source it's
actually returning an object type but we
know we will get a link button back okay
so that's why I'm typecasting it to link
button and then that link button on that
typecasted object I'm using a property
called naming container naming container
is going to return the parent control
within which that control is present so
here for example the Edit link button is
present within the grid view row that's
the parent control for edit link and
delete link buttons so naming container
will be the parent container which is
grid view row and obviously this grid
view row object has got row index
property which we are using here so
naming container will give you will give
us a grid view row but then if I hover
my mouse over naming container property
it's actually returning a control bag so
we need to typecast it to be of type
grid view row okay so and grid view
Oh object after I typecasted it has got
a row index property which is going to
give me the row index you know where the
user has clicked the edit button okay so
it's the only a little tricky part and
otherwise the rest of the code is pretty
straightforward alright so once we get
the row index we use that to determine
which row to put into edit mode using
the edit index property of grid b1
control and then obviously after we put
the row in edit mode we need to call
this method binded review data if you
remember what this method is doing it's
going to go back to you know that method
get all employees retrieve data and then
bind it to the grid we control okay so
that's when we click the edit you know
edit link button okay on the other hand
when I click delete link button then
what will happen so if the command name
is delete row then what should we do we
should actually delete the employee and
to delete the employee with an employee
data access layer I have got this delete
employee method and all you need to give
it is employee ID and if you remember
when we were including those you know
link buttons we have set command or
command you know - employee ID so that's
what we are retrieving here so command
argument command argument property
that's going to return an object back
but we know it's going to be an integer
that's why we are converting to India
and passing it to delete employee method
and then after we delete that we are
again calling this blind bind great view
data okay so that's the whole reason why
we have these two lines of code in this
method since we don't want to be
repeating these two lines we
encapsulated them into this method and
then we call that method wherever
required because every time you delete a
row or put arrow in edit mode or you
update a row you have to you know
retrieve the data and bind it back to
the grid we control okay and that's what
this method is doing so that's delete
and obviously cancel update so when we
are in edit mode look at that when we
are in edit mode and then when I click
this cancel button what should happen
we should remove the row from edit from
edit mode and then rebind the data to
the grid view control and how do I
remove this row from edit mode you know
set edit you know index of the grid view
control to something negative
so here
I am setting it 2-1 do I have a row
within the grid we control with index
minus 1 no index starts at zero row
index we don't have a row with minus 1
so obviously no row will be put into
edit mode and then finally we are
calling again by in grid view data and
the next one is the update row so when
we click on update you know after we
click edit another row is in a update
what do you say edit mode and then when
I click this update button what should
we do
we should retrieve name gender city and
employee ID and pass those values to
update employee method okay because
update employee method expects all those
four parameters so you know the I mean
we need to retrieve employee ID so how
do we retrieve employee ID again if you
remember we can retrieve that using
command argument property of that link
button ok and then obviously we need to
retrieve you know of the values that are
present in these textbox controls now
obviously how are we doing that look at
that grid v1 dot rows so within the rows
of the widget row how do we know the row
index again we are we are retrieving the
row index that's the same logic so
within the grid view rows collection go
to that specific row and then within
that row find a control for example to
retrieve gender find a control called
drop-down list one so when the when this
row is in edit mode remember we will use
edit item template so within in our web
form one dot aspx when the row is in
edit mode we will use edit item template
for example for gender if you look at
that so here we have gender template
fear when the row is in edit mode we use
edit item template and look at the ID of
the drop-down list there it's drop-down
list 1 okay so what are we doing within
the code-behind file you're actually
saying find that control with ID drop
down list 1 retrieve the selected value
out of the drop down list control and
then we are storing that in this
variable which is then being passed to
the sub date employee method and along
the same lines we are retrieving name
and city ok this this
just simple to understand all we are
doing could be one in the Rose
collection go to that specific row on
which you know the user is going to
click update and then within that row
find a control with that ID way we have
you know name and retrieve that using
the text property okay
because fine control always returns a
control back you need to typecast it to
the type of object that you are
expecting in this case we are expecting
a text box for gender we are expecting a
drop-down list okay pretty simple and
straightforward and after we update so
after we perform the update operation we
need to remove the row from edit mode
that's why we are setting it to minus
one and calling by in grid view data and
finally we want to do the insert so if
the command name is insert then what we
need to do we need to retrieve name
gender and city from the footer so
that's easy to do would be one dot
footer road or find control so within
the footer control we have given IDs to
those controls txt city DDL gender and
dxd name so if you look at another web
forms HTML that's what you should notice
so for example here footer template name
is txt name and similarly gender you
should see it as DDL insert gender okay
so it's actually DDL insert gender we
would have caught an error if we would
have if we would have run this code so
it's DDL insert gender let's copy that
and paste it in find control method and
finally rid City text boxes txt City as
you can see here put a template text box
txt City okay so that's again
straightforward retrieve those values
and then pass them to this insert
employee method and then bind click view
data okay so with these changes let's go
ahead and run this now and that at this
point as you might expect you know edit
insert update delete everything should
work so let's actually insert I know an
employee test let's say male let's try
to insert that look at that city is
required I get that validation
required let me say edit and then let me
try to blank something and update I get
validation errors as expected okay now
let's change that to male and maybe test
five let's update that and see if it
works as expected so test five male
Toronto and similarly let's say test six
and let's say female and that's a test
let's insert that and see if it gets
inserted okay for some reason this is
not working let's see why it's not
working the insert click actually let's
close this let's rerun this right now so
test male and test
let's click look at that the row is not
being inserted let's see why is that
because we know for sure you know when
we click any button you know this row
command event will be fired and then we
are saying do an insert when the command
name is insert row in our webform let's
see what we have as the command name for
the insert a link button in the footer
control okay probably we might have not
set it at all so let's check the varies
the insert button present the insert
button is present within the employee ID
template field so employee ID template
field we have the insert link button
here and if you look at this we don't
have command name property okay so
obviously when I click this button the
command name will be an empty string
there is no you know block which has an
empty string as the command name and
that's why nothing happens so basically
we need to use this as the command name
for the insert button
so let's specify that so we actually
need to specify that within the now you
know link button
that's employee ID here is the link
button so let's set the command name is
equal to insert so that's very important
so now let's run this and insert should
work as expected okay let's say test six
female test let's answer that
look at that it's working as expected I
put the Rowan edit mode I click cancel
because that everything works okay
actually there's a problem here
now I put the rule in edit mode and then
look at that when I try to insert
obviously get these validations because
I don't have it here anything now let me
you know get rid of that validate you
know text there and then let me try to
cancel this look at that I still get
those validations when I empty this box
out and when I try to click cancel
button it's doing the validation
similarly when I try to delete this role
look at that I still have those
validations why is that because you know
when I click these buttons the waveform
is trying to post back and if you
remember these validation controls they
don't have a validation group so anytime
you try to post a webform back you know
for validation controls that don't have
validation groups at then they are going
to be fired and that's why we have those
validation failures but the point is
when we click cancel or delete buttons
we don't want those validations to be
firing so how do we prevent those
validations from happening all you need
to do is for those buttons delete and
cancel link buttons that you have set
causes validation property to false so I
have the link button here I am going to
set causes validation is equal to false
for that and do the same thing for
cancel button as well so that's the
cancel button I'm going to set causes
validation false for that as well now
let's run this and when I click cancel
or delete they shouldn't be validation
so I put this row in edit mode I knock
them out you know a property there and
then when I try to update obviously
where
should happen but when I click cancel or
let's click delete here when I click
delete this row should be deleted look
at that that row got deleted
ok and similarly when I try to update oh
let's put it in edit mode let's try to
update together I get the validation but
then I click cancer it will be removed
from the edit mode without doing
validation so we use causes validation
property for that and another thing that
I want to do is basically you know this
daily this is dangerous operation I want
some you know client-side confirmation
dialog box before the row can actually
be deleted because once I've always
deleted it cannot be undone so I need a
confirmation dialog box is it possible
absolutely and it's very easy to do all
you need to do is if you look at the
button here this delete button that's
present in a template fear and every
button control link button or a push
button you know these button controls
have caught a property called on client
click ok so this event basically on
client click this event is raised on the
client side on the browser even before
the waveform is posted back to the
server so to this event you can actually
attach JavaScript code so I'm going to
use some you know a JavaScript function
called confirm a function this confirm
function will display a dialog box with
ok and cancel button ok so let me first
use that confirmation function so I'm
going to call that and now this is what
is going to be the value let me paste
that and then I will explain what it's
doing so we're using this confirm
function let's run this and then see if
we get what we expect so when I click
delete look at that it's asking me are
you sure you want to delete this row and
I click cancel it won't get deleted but
when I click OK that's when it will be
deleted and if you look at the code that
we have they using JavaScript
confirmation
you know confirmation function and if
you look at this function it's taking a
parameter are you sure you want to
delete this row so that's the message
that's going to be displayed in that
dialog box and then this confirm
function actually returns true or false
depending on which button I have clicked
if I click OK it's going to return true
if I get answer
it's going to return false when it
returns true
you know I am saying return the value of
whatever this confirm function is going
to return if it returns true then the
webform will be posted back and then
whatever you have specified in that
click even handle upon post back that
will be executed but if it returns false
the waveform will not be posted back
okay all right look at this when I click
OK it's going to be deleted so we have
seen how to perform insert update delete
without using object
I mean datasource controls at all all
right on the slide you can find
resources for a speedrun a c-sharp and C
equals the way interview questions
that's it for today thank you for
listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>