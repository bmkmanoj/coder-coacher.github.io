<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 16   Dataset rejectchanges and dataset acceptchanges methods | Coder Coacher - Coaching Coders</title><meta content="Part 16   Dataset rejectchanges and dataset acceptchanges methods - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 16   Dataset rejectchanges and dataset acceptchanges methods</b></h2><h5 class="post__date">2013-10-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/lTitBo4Z44U" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 16 of radio dotnet tutorial
in this video we'll discuss accept
changes and reject changes methods this
is continuation to part 15 so please
watch part 15 before proceeding to
understand accept changes and reject
changes methods better we need to
understand ro States and reversions
every data row that is present in a data
table of a data set has got this row
state property the MSDN link that you
see right here explains the different
values of this row state property will
examine this link in just a bit let's
flip to visual studio this is the sample
application that we worked with in the
previous session let's drag and drop a
button control and let's double click
that to generate the even handler now
within the click event handler we are
going to retrieve the data set from
cache and then we are going to use a for
each loop here so for each data row
let's call it D are n data set dot
tables of what is the name of the table
within the data set students so loop
through each data row that is present
within this table students okay and then
we want to plant that rule state of
every row and to retrieve row state we
are going to use the row state property
of the data row object and let's convert
that to string and to print this on the
bed form let's use response to try it
let's also plant student ID along with
Joe state property value let's convert
that to string and let's separate the
student ID and row state property value
with a - okay and let's also use an HTML
break so that the output of every row
comes in a separate line alright so with
these changes let's go ahead and run the
application so let's click this button
so data is loaded from the stable TBL
students so now after the data is loaded
in
to the data set we didn't change any of
the rows now when we click this button
look at that rows 1 to 5 all of them the
row state is at the moment unchanged
okay so now let's actually edit one of
the rows
let's click update so we've modified the
first draw look at that the first row
state is modified but the rest of the
rows are unchanged now let's actually
delete the second row and click this
button look at that we get an exception
and that's basically because for a
deleted row they will not be current row
version it will only have original row
version but if you look at this piece of
code here it's trying to read the ID
column value for a deleted row from the
current row version and that's the
reason why we have this exception we
didn't discuss about row versions yet
we'll talk about them in just a bit but
first of all let's go and fix this
exception let's flip to visual studio so
basically within this for each loop we
are going to check row state so data row
object dot true state if that is equal
to and look at the different values of
the row state and now there are several
of them we'll talk about all of them in
just a bit but at the moment if the row
state is delete head and what we want to
do is we want to retrieve the ID column
value from the original data row version
okay else
retrieve the ID column value from the
current reversion the default is current
row so basically we haven't specified
that so it's going to try and retrieve
it from the current row version all
right so let's go ahead and run this now
get data from database and let's delete
the second row click this button look at
that second row is deleted and the rest
of the rules that are unchanged okay so
we have discussed about modified deleted
and unchanged
now let's discuss about added row state
so once we have retrieved the data set
from the cache I'm going to create a new
data row let's call it new data row data
set the tables of students dot new row
so new data row of ID let's set the ID
for this new data row - 1 0 1 ok and
then let's associate this new data row
with the stable so basically we want to
add it to students table and look at
this so this table the data table has
got rows property and look at what is
this rows property returning it's
returning data row collection so
basically to the data row collection add
this new data row and to add that new
data row to the data row collection what
method are we using we are using add
method so basically at this point we
have just added this new row to this
data table so the row state of that row
should be added so let's actually run
this and see if that's what we can't
so get data from database click the
button look at that one zero one
what is the row state added okay now
here we have added that row to data rows
collection using add method now let's
comment that line so we have just
created a new row but we haven't
associated that with a data local action
so this state the row state of this row
at this point is detached
it is not associated with any data row
collection so here the row state is
detach and to print the row state since
it's not part of the data set object you
know it's not going to loop you know
basically it's not included in the rows
collection here so this for each loop is
not going to print this new data row
state so let's go and print that data
row state so response dot write new data
row dot Rho state dot to string let's
run this
so get data from database let's click
that look at that
what is the row state of that row it is
detached basically it's not associated
with any data row collection so it is
that MSDN link which explains all that
row state property values so here are
the different row state values unchanged
no changes have been made since the last
call to accept changes or since that
rule was created by data adapter dot
fill okay added the row has been added
to the table but accept changes has not
been called we didn't discuss accept
changes we'll discuss that in just a bit
and modified some of the elements of the
rules has been modified deleted that all
has been deleted from the table and
accept changes has not been called once
we call accept changes what's going to
happen it's going to reset the row state
we'll discuss that in just a bit and
what is this detach the row is not part
of any data row collection the row state
of a newly created row is set - after
the new data row is added to the data
row collection by calling the add method
the value of the roasted property is set
to added I have seen that practically
and along the same lines detached is
also set for a row that has been removed
from a data row collection using the
remove method or by the delete method
followed by the accept changes method ok
so those are different rule states and
along with through States we also have
row versions and here is the different
row versions and these current and
original true versions are very
straightforward so for every row there
will be a current row version and an
original row version so original raw
version is going to contain the original
values and current row version is going
to contain the current value so
basically for example
you know when we edit a row and change
the name for example here so the current
value is going to contain mark the
original value is going to contain mark
Hastings okay so that is current and
original and this raw version basically
the current rule version does not exist
for rows with a row state of deleted
okay they will only have original state
and if you remember we got an exception
when this code was you know when this
Len was not present
we got an exception when we had a
deleted row okay that's because deleted
rows will not have current row version
so this piece of code here is trying to
read the ID value from the current row
version deleted rows will not have
current row version that's the reason
why we had that exception okay and
original draw version does not exist for
rows with arrow state of added so for
new rules that we have added to data row
collection in our original raw version
doesn't take this and that makes sense
that okay so what is this proposed
reversion the proposed value for the row
this row version exists during an edit
operation on a row or for a row that is
not part of data row collection so when
is a row not part of data row collection
when you haven't added it to data row
collection yet using the add method or
if you have removed it from data row
collection using the remove method or if
you have deleted it and if you have
called accept changes method alright and
here we have default so the default rule
version for a particular row the default
reversion for an added modified or
unchanged row is current the default
reversion for deleted row is original
and the default reversion for a detached
flow is proposed okay so that those are
the different row versions and these are
the different row States now let's look
at using accept changes and rejecting
these methods first let's look at reject
changes method
now I'm going to change the text on this
button to undo and within the click
event handler so so we have the data set
from the cache so we are checking if
this data set has got any changes look
at this method has changes what is it
returning back it's returning a boolean
true or false so since the data set is
loaded you know using data adapter dot
fill if there are any changes at all
that we have made to that data set then
this method is going to return true for
example let's say you know I have edited
some of the rows and I have deleted some
of the rows and then what I want to do
is when I click this button undo we
basically want to revert those changes
okay and that's what we are trying to
achieve now using reject changes method
so if there are any changes that are
made to the data set reject changes and
look at what the intelligence says here
rules back all the changes made to the
data set since it was created are since
last time accept changes was called will
discuss exit changes in just a bit okay
so once we have rejected the changes
that were made to the data set what we
want to basically do is store the data
set back in the cache and here is the
code to store the data set back in the
cache so let's paste that there and
let's reload data from cache and to do
that we are going to use load data so
what is that method to load data from
cache get data from cache
so let's invoke that method okay so if
the data set has got changes then this
what we are going to do else
let's actually make some changes to the
HTML of this platform let's bring this
label to the next line let's put an HTML
break there let's set font bold to true
okay so within the label control if the
data set has not got any changes and if
somebody clicks undo then on that label
I want to include this text
no changes to undo and let's also set
the full color of the label to read
system door drawing dot color to red on
the other hand if there are changes and
if we have reverted them then we want to
say changes
undone and let's set the color to green
right so with these changes let's run
this and let's get data from database so
let's say that this row let's update
that let's delete two and three okay
now let's click undo look at that change
is undone and whatever changes we have
done
they are reverted okay let's get data
from the database now let's click this
undo button did we do any changes yet to
this data set pretend right so when we
click this part and look at that no
changes to undo so basically what
happens when we call reject changes
method
so when digit changes is invoked row
state property of each data row changes
added rules are removed modified and
deleted rows becomes unchanged so
basically when we edit a row what is
going to happen to the row state
property of this row it becomes modified
but then if we call reject changes now
what is going to happen the row state of
that row is going to become unchanged
because it's going to revert the changes
bad ok so once we click this the row
state of this row is now unchanged and
all of the roses anyway you know at the
moment it's they are unchanged okay now
let's look at accept changes so what is
this accept change it's method now this
acception jiz method is called by the
update method of the data adapter object
automatically and look at this and we
make a change to the database look at
this update so this row is updated
varies it updated sub dated only within
the data set at the moment so if we
examine the database values you know
here the name is still mark Hastings but
within our data are set it is marked now
when we click this update database table
what's going to happen the value is
going to be persisted in the database
table now at the moment what is the row
state of this row
it is modified okay so once I click this
update database table so the update
method and the data adapter object is
invoked and then that's going to execute
the update command which is going to
persist the changes to the database
table and they call to accept changes is
also invoked and what is that method
going to do it's going to do this
so when accept changes is invoked row
state property of each data row changes
added and modified rules become
unchanged because they are committed to
the database and deleted rules are
removed okay now can we explicitly call
accept changes absolutely there's
nothing stopping us calling from calling
accept changes method so what does this
accept change is doing
it's resetting basically it's updating
roasted property of each data row okay
added and modified rules becomes
unchanged and deleted rules are removed
okay
so let's actually look at that so we
have the data set loaded from the cache
and let's invoke accept changes method
and let's put this back into cash and to
do that again let's copy this code
so let's run this get data from database
now
let's delete first row second row and
let's update the fourth row okay at the
moment all these changes are done only
within the data set so if you look at
the data here so the underlying table is
the same we haven't updated that yet
okay now for the first and second
towards the row state deleted and for
the fourth row what is the row state
updated now when we click this button
what is going to happen we're going to
call here we're calling accept changes
method so what does this acts have
change is going to do for the I mean we
don't have any added rows we only have
modified row for the modified row what
is going to happen to the roasted it
becomes unchanged and for deleted rows
what's going to happen they will be
removed from the data set altogether
okay so now when we click this button so
the row state for this row is unchanged
for deleted rows they are removed from
the data set now when I click this
update database table button do you
think the underlying database table will
be updated no it won't okay so it says
database table updated but look at what
happens you know the rows are not
updated and first and second rows are
not deleted as well and that's basically
because accept changes resets or changes
totoro property values added and
modified rules become unchanged and
deleted rows are removed okay and
remember both these accept changes and
rejecting these methods can be invoked
either at the data set level or the data
table level or at a specific data row
level when we invoke these methods at a
data set level they will get
automatically invoked for all the data
tables within that data set and when you
call them on a data table they get
automatically in
for every data row within that data
table that's it for today thank you for
listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>