<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Calling asp net web services using jquery ajax | Coder Coacher - Coaching Coders</title><meta content="Calling asp net web services using jquery ajax - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Calling asp net web services using jquery ajax</b></h2><h5 class="post__date">2015-06-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/JFt7fbZVByo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 61 of jQuery tutorial in
this video well discuss how to call an
asp.net web service using jQuery AJAX
here's what we want to achieve we're
going to have this database table TBL
employee we want to retrieve data from
this database table using an asp.net web
service we want to call that asp.net web
service using jQuery AJAX retrieve the
data and display that on a web page as
you can see here so on the web page we
are going to have an interface to enter
employee ID for example if we enter
employee ID 3 and then when we click
this button get employee we want to
retrieve employee ID 3 details and
display them in a table as you can see
here so let's see how to achieve this
the first step here is to create this
database table which I have already done
and here is the sequel script to create
the table and here we have insert script
to insert some test data
I have already executed the script so we
have this employee table with ID name
gender and salary columns I have also
created a stored procedure which is
going to retrieve employee PI ID so if
you look at the stored procedure it has
got ID parameter and the implementation
of the procedure is straightforward all
we have here is a select statement which
retrieves ID name gender and salary
columns from TBL employee wear ID equals
whatever value we are passing for this
ID parameter so for example if we pass 2
as the value for ID parameter and if we
execute the stored procedure we should
get employee ID 2 details so these are
the two things that we need to do from
the database side create the table
populate it the test data and then
create a stored procedure to retrieve
employee by ID
now let's slip to Visual Studio here I
have an asp.net web application project
within the web config file I have
included a connection string to our
sample DB database so this sample DB
database contains our table TBL employee
and at the moment they using windows
authentication the next step is to add a
class file to this project
and let's actually name this class file
employee dot CS and this class is going
to contain four properties which
correspond to these four columns in the
database table so the first property
here is going to be of type integer and
the name of the property is ID and we
are going to have another integer
property which is salary and we're going
to have to string properties the first
string property is going to be name and
the second one is going to be gender so
these four properties correspond to the
four columns in the database table all
right so the next step is to create the
web service itself so let's go ahead and
add a new item and if you scroll down we
should find web service and let's call
this web service employee service now we
want this web service to be called from
JavaScript if that's the case you have
to uncomment this attribute system dot
web dot script dot services start
scripts service look at the comment
right here to allow this web service to
be called from script using asp.net Ajax
then uncomment the following line now
here are we actually using jQuery AJAX
which is still a script so if you want
this web service to be called from
JavaScript then you will have to
decorate your web service with the
script service attribute and I'm going
to change the name of this method to get
employee by ID so to this function we
are going to provide employee ID which
is of type integer and what is this
function going to do it's going to
return an employee object back so this
method you know we are going to include
some ad or dotnet code which is going to
retrieve with the employee details and
the employee object back okay so in the
interest of time I have already typed
the required ato dotnet code so let's go
ahead and copy that a do dotnet code
from the notepad and then we'll quickly
go or it so this is straightforward
I do dotnet code at the moment notice
that we've got several compilation
errors that's basically because we are
missing some namespaces here so this
configuration manager class is present
in system dot configuration namespace
sequel connection class is present in
system dot data dot sequel client
namespace and this command type enum is
present in system dot data namespace so
we have included all those namespaces
here and at the moment we don't have any
compilation errors right so if you look
at this code it's straightforward ato
dotnet code the first thing that we are
doing here is creating an instance of
the employee class which we have created
and then we are reading the connection
string from web config file and then we
are creating a sequel connection object
using this connection string and then we
are creating a sequel command object and
this command object is going to execute
the stored procedure as we get employee
by ID that is this tour procedure and if
you notice the stored procedure has got
a parameter which means we have to
supply a value for that parameter so the
next step here since it is a stored
procedure we are telling that to the
command object using the command type
property and then we are creating the
sequel parameter object the value for
this parameter is coming from this
parameter which is coming into this
method and then we are associating the
parameter object with the command object
opening the connection executing the
command and once we have the data we are
looping through and you know retrieving
name gender salary and ID column values
populating the respective properties of
the employee object so where is this
employee object it's created on the top
here and then once we have populated all
the properties of the employee object we
are returning that employee object back
so this is straightforward radio dotnet
code nothing to do with jQuery
Ajax the only bit that is related to
script that is Ajax is this attribute so
if you want your web service to be
called from script then make sure you
decorate your web service with the
script service attribute so now let's go
ahead and quickly test our web service
so this web service you know is going to
expose that function get employee by ID
we provide it an ID it's going to return
an employee object back and the format
of that employee object will be in XML
because this is a web service so we have
this web method available click on that
and if we provide for example let's say
employee ID 3 click invoke notice that
we get employee ID 3 details in XML
format now let's see how to call this
web service using jQuery AJAX and then
we want to display this data on a web
form like this so the first step here is
to design the page like this I already
have added this HTML page 1 dot HTML to
a project and I also have the ready
function wired up within the body
section we don't have any HTML so we
need to implement the HTML so the web
form looks like this in the interest of
time I have already typed the required
HTML so let's go ahead and copy this
HTML and paste it within the body
section and if you look at this HTML
again it's straightforward we have the
literal text id which you see here and
then we need a text box and a button so
to get the text box we are using an
input element and then here we have you
know an an input element of type button
ok and the value on that is get employee
and then we need this table so I have a
table here where we have set border to 1
border collapse and then we have
basically 3 TRS and each TR has got two
TDs every TD has got a text box to
display you know name gender and salary
alright so straightforward HTML okay so
now if we view this HTML page in the
browser
this how it looks like so we want to
enter employee ID and when we click get
employee we want to call the web service
retrieve the employee details and
display them in the respective text
boxes so let's see how to do that we
have the ready function already wired up
here so you know all this should happen
when we click this get employee button
and we have an ID for that button which
is BTN get employee so let's go ahead
and associate click even handler so find
the button by ID and when we click the
button we want to call a function and
execute some code okay so when we click
the button what is the first thing that
we need to do we need to first retrieve
the ID value that the user has entered
in this text box and this textbox also
has got an ID and the ID of that text
box is txt ID so let's find this text
box by ID so let's create a variable
let's call this amp ID equals find the
text box txt and we want to retrieve the
value from the text box all right so we
have the employee ID now we want to call
the web service to call the web service
we are going to use the jQuery AJAX
function so dollar dot Ajax and we are
going to use a JavaScript object so the
first option I'm going to specify is the
URL what is the URL we want to call we
want to call this employee service dot
ASM X so let's copy the name of the
service and within that service we have
got a function what is the name of the
function get employee by ID so that's
the function that we want to call so
that's the URL that we want to call and
this function expects some data to be
pass the employee ID so let's specify
the data option and again I'm going to
use a JavaScript object here and if you
look at the parameter you know the name
of the parameter is employee ID so let's
copy that
so employee ID and the value we have
that within this M PI D okay so that's
the data that we want to pass to the
server now how do we want to pass it
what what is the request type you want
to use get up post I want to use post so
I'm going to specify the method option
and we want to post that data to the
server and what type of data are we
expecting from the server
we are expecting xml data so i am going
to specify that using data type option
and finally if the request successfully
completes we want to execute a function
and process the result so I'm going to
use the success option and associate a
callback function so if the request is
successfully executed we are going to
get that data from the server and what
do we want to do with that data we want
to display that within these text boxes
and each text box has got an ID right so
first of all this is XML data that we
are going to get back right so I'm going
to wrap this data using a jQuery object
so we can use the jQuery fine method
find the different xml nodes and
retrieve their text right so i'm going
to create a variable here let's actually
call this jquery xml equals i'm going to
wrap the data using jquery object so now
this is jquery xml so on this we can use
find method find you know in the xml so
if you look at what we are getting back
look at that we get these elements ID
element name element gender element
salary element so I want to find name
element okay so find what do we want to
find we want to find name so what is
this function going to do it's going to
return this entire name element from
that element we want that in a text John
and to get that text I'm going to use
text function
okay so what we get here is the name of
the employee and what do we want to do
with that name we want to display that
in this txt name textbox and that's
nothing but the ID of the textbox so
let's find the textbox by ID and use the
Val function and this is the value that
we want to display let's do the same
thing for gender and salary so find the
gender element next find the salary
element so gender value we want to
display in txt gender textbox and celery
we want to display in txt salary textbox
okay now if there is an error processing
I want to know about that error as well
so I'm going to associate error option
as well so error I want to associate a
callback function whatever is the error
this function is going to receive it and
let's simply alert that all right so
that's all there to it let's save the
changes and let's go ahead and reload
our page let's go ahead and enter for
example employee ID to get employee look
at that we get employee ID - details 3
we get employee ID 3 details so the
jQuery code is pretty simple and
straightforward specify that you all
really want to call what data you want
to pass what method you want to use and
what is the type of data you are
expecting from the server and you know
the callback function you know that you
want to associate if the request is
successfully processed if at all if
there is any error then we are alerting
that here's the jQuery code but that we
have just written and in our next video
we'll discuss how to call and consume an
asp.net web service that returns JSON
data using jQuery AJAX so at the moment
this XML is returning XML
data and what we are getting here is XML
data in our next video let's see how to
work with JSON data returned from an
asp.net web service thank you for
listening and have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>