<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 24   Self hosting a wcf service in console application | Coder Coacher - Coaching Coders</title><meta content="Part 24   Self hosting a wcf service in console application - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 24   Self hosting a wcf service in console application</b></h2><h5 class="post__date">2014-02-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ZdT5JiIoUCw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 24 of wucf video series in
this video we'll discuss self hosting a
WCF service using a console application
this is continuation to part 23 so
please watch for 23 before proceeding
hosting your WCF service in any managed
to dotnet application is called as self
hosting console applications WPF
applications when those forms
applications are all examples of managed
dotnet applications let's create a
simple WC of servers and then host it
using a console application let's flip
to visual studio let's create a new
project and we want to create a class
library project and let's call it hello
service click OK let's delete this class
1 dot CS file that's auto-generated and
to this project we want to add a WCF
service and let's name this service as
hello service click Add
so that should add a reference to system
dot service model assembly and then
generate these two files for us
hello service noxious I hello service
dot CS so this file contains this
service contract
let's get rid of this do work method and
you know let's make this method actually
return a string back and let's call it
get message and we want this method to
take a string parameter and let's call
the parameter name so this I hello
service contract has got a single
operation contract get message and this
service contract is implemented in this
file hello service CS so let's go ahead
and delete this do work method and then
we want to implement this interface and
the easiest way to do that is to simply
click on that I hello service and then
press control dot we get the option to
implement the interface so let's select
this option and this should
automatically generate a method stub for
us and all this method is going to do is
concatenate the word hello with whatever
is coming into the
third you know using this parameter
alright so here we have a simple WCF
service now we are not going to specify
any configuration within the WCF service
itself so we can get rid of this app
config file within this service so let's
go and delete that and now we want to
host this WCF service using a console
application so here we are self hosting
this WCF service so to this solution we
need to add a console application so
right click on that add a new project
and we want to add a console application
and let's call it host click ok so this
should add a console application the
first thing that we need to do here is
to add a reference to this project the
hello service because we want to host
that service and then we also need to
add a reference to system dot service
model assembly that's the WCF assembly
that contains all the important classes
so let's go in and add those references
add a reference first let's go ahead and
add a reference to system dot service
model assembly and let's add a reference
to hollow service project itself ok now
the next step is to specify the
configuration for the WCF service that
we want to host so let's add an
application configuration file so by
default app config file should be added
to this host project now we need to
write the configuration here for this
service we basically need to expose an
endpoint we need to enable metadata
exchange so that the clients can
generate the proxy classes using the
metadata ok now we can write that code
you know literally hand type this within
this configuration file or we can make
use of WCF service configuration editor
tool now when I right click on this app
config file we should actually get an
option here edit WCF configuration but
for some reason Visual Studio doesn't
show that you know I think that's a bug
in Visual Studio
especially I'm using Visual Studio 2008
for that option to show up we have to
open that config file using the WCF
service configuration editor at least
once and after that when we right-click
you know from in the context menu
we'll have that option so what I'm going
to do now click on tools and then here
you have the option WCF service
configuration editor so select that
option and the tool should fire up and
then we are going to use that tool
basically to point to this file and then
open that using that tool so that should
be launched in just a minute ok so let's
go and open the config file and the
config file is present in C Drive
hello service and with you know this
hello service folder is the solution
folder and within that we have this host
project which contains the app dot
config file so now it should load you
know the contents of this app dot config
file now we want to create you know a
new server so services folder is
selected select this option create new
service and what is the service type so
that service type is present in C Drive
Hollow service so within the bin-debug
directly now we didn't compile the
solution at least once so that's the
reason why we don't have the assembly
generated so let's cancel these things
and then let's build our solution once
so will succeeded now let's go ahead and
right click on Apter config file and
notice that we get the option now edit
WCF configuration select that option
click on file open and we want to open
the config file which is present in
hollow service host a broken fig so now
let's create a new service so the
service type assembly is present in C
colon hello service folder within that
hollow service project folder within
bin-debug we have hello service tour DLL
so let's open that and within that we
have hello service
hello service that's the service that we
want to expose so let's open that so
that's the service type let's go ahead
and click Next now it's asking us the
contract you know the contract is
nothing but hello service dot I holo
service that's the service contract that
we are implementing click Next and then
what is the binding that we want to use
we want to use a TCP based communication
okay
so TCP binding basically so let's select
that and click Next the next important
thing is the address for the endpoint
now here you can either specify the
fully qualified address or you can use
relative address and then specify a base
address so let's use a relative address
now so hollow service is going to be the
relative address you know to reach this
service click Next now here we have the
details that we have provided so this is
the service type and the contract is
hello service dot I hello service we are
going to use net TCP binding and we are
not going to configure customize the
binding in any way so the binding
configuration at the moment is default
it is an empty string and then the
endpoint address basically hello service
that's relative address so let's click
finish
so at this point it has added you know a
service endpoint for us ok now we need
to specify a base address as well
because we are using a relative address
here so to specifically the base address
click on host and then here we can add
base addresses so basically we need to
add two base addresses one base address
is for the service endpoint itself and
the other base addresses is for the
metadata to be available so first let's
add a base address for metadata so HTTP
colon four slash four slash localhost
colon let's have the metadata available
at port 8080 so that's the base address
for metadata exchange now let's add a
base address for the service endpoint
and that's going to be net dot TCP colon
four slash four slash localhost colon
1890 that's the port so let's add
that so now for this service you know
the actual end point that this is going
to be net dot TCP equivalent four slash
four slash localhost colon 1890
/hello service okay so we have the base
addresses and we have specified the you
know service endpoint as well and
another important thing that we need to
do is we need to enable behavior you
know service behaviors basically to
enable metadata exchange so that the
clients can generate proxy classes and
in order to do that expand advanced
folder and here you have service
behaviors option so we want to create a
new service behavior configuration so
click that option and we want to add a
service behavior and what is that
service behavior for to exchange service
metadata so we're going to add that and
then once we select the service metadata
here that this option actually be get
enabled we need to turn that to true and
then let's give this behavior a name
instead of new behavior so let's
actually call this max behavior okay so
we have a service behavior specified but
then we need to associate this behavior
with this service so let's select that
service and then here within the
behavior configuration select max
behavior that we have specified that's
it we are all done so close this it will
ask us to save the changes click yes so
now when I click yes look at that you
know it basically writes the entire
configuration for us instead of V
handwriting it okay so basically here
within system dot service model we have
specified behaviors so we have the
service behavior where we are enabling
you know metadata exchange and then here
we have associated this behavior with
this service using this behavior
configuration attribute the name of the
services this one and then here is the
endpoint that is the address that's the
bind
and that's the contract the ABC of an
endpoint is specified and then here we
have the base addresses one for the
service endpoint itself the other one
you know for the meta data exchange okay
so we have specified the required
configuration the next step is to write
code to open up the communication
channels okay so let's get rid of these
namespaces that we don't need we need a
system dot service model namespace so
let's go ahead and bring that in and
then within the main method we need to
construct an instance of service host so
let's create service host instance and
let's call it host and when we are
creating a service host you know we need
to specify the type of the service that
we are hosting and in order to get the
type of the service we use the type of
keyword and the service that we are
hosting is hello service dot hello
service so that is the service we are
going to host and then host dot open
okay so basically what is this method
going to do this method is going to look
at the configuration that we have
specified within the app dot config file
you know what binding we have at what
address the services available what
contract has it implemented so it's
going to read all this configuration
from the configuration file and then
open up the communication channels for
the clients to consume or WCF service ok
so let's go ahead and write a message to
the console stating that you know the
service host is started so let's say
host started at whatever date and time
so date time dot now dot to string and
to keep it alive let's use consult or
cheat line alright with all these
changes let's go ahead and run
you know the host project by pressing
ctrl f5 now we get an error that's
basically because at the moment hello
service which is a class library project
is set as the startup project so that's
the reason we need to set our host as
the starter project and then run the
solution by pressing ctrl f5 so this
should load in our host
so when host dot open is called
it's going to open up the communication
channels now to test if the service is
actually working we can fire up a
browser and then browse to this relative
address HTTP colon localhost colon 8080
okay instead of that let's go ahead and
create a client for our WCF service so
let's fire up another instance of visual
studio and then create a new project
let's use a windows forms application as
the client okay so when those forms and
let's call this Windows client click OK
so now we need to design a form so let's
get to the toolbox we need to label
controls a text box and a button control
so let's get a button control and we
need to label controls and then a
textbox control and let's arrange this
so we have the textbox there this label
is going to display the result for us
and this label is just going to say name
so that the user can enter a name and
let's get to the properties of this
button and then let's specify D let's
actually solve this by alphabetical
order let's call this get message the
text on the button
and then let's get rid of the default
text and label too and let's change the
text on label 1 to something like name
alright so when we click get message
that's when we want to invoke the WCF
service ok so let's go to the solution
Explorer and then add a reference to our
WCF service so right click on the
references folder add a service
reference and if you remember the base
address that we have specified for
metadata exchange is localhost colon
8080 so let's go and specify that
address within you know the address text
box click go so now it should identify
that
hello service that's running on the
machine so the host is running so the
communication channels are opened so the
client should be able to find that
service and then let's specify the
namespace s hello service here click OK
so this should you know generate the
proxy classes based on the metadata ok
so you know at the class level let's go
ahead and create an instance of the
proxy class hello service client and you
know when the form constructor is called
let's go ahead and create a new instance
of the proxy class and then within the
button click event all we are going to
do is invoke the get message method so
get message and we want to pass it the
name that is going to be typed into this
text box and then obviously this get
message is going to return a string back
which we want to display and label to
control so label to the text equals
whatever comes back from the WCF service
all right with all that let's go ahead
and run this client as well
so plus control f5 so let's enter for
example presume click this get message
button and we should get a response back
from
WCF service look at that hello progeny
and hello regime - alright so here in
this video we have demonstrated in
operating a simple WC of service and
self hosting that service using your
console application now let's understand
the advantages and disadvantages of self
hosting it WCF service so what are the
advantages of self hosting a WC of
servers now first of all it's very easy
to setup all you need to do - self
hosted WCF service is to specify the
configuration you know that's required
for the service within the app dot
config file and then write a few lines
of code you know to have the service up
and running and all we have done you
know to host this service is you know we
have constructed an instance of a
service host specify the type of the
service and then you invoke you know
open method which is going to read the
configuration from the application
configuration file and then open up the
come you know communication channels for
the clients to consume our WCF service
ok so it's very easy to set up basically
and it's easy to debug as well because
you know we don't have to attach a
separate process that hosts the WCF
service you know if we have hosts about
our WCF service in a Windows service in
a Windows servers then to debug it we
have to attach that Windows service you
know to the debugger
but you know when self hosting we don't
have to do that what I mean by that is
let's actually run both the service and
the client in debug mode so let's run
this hello service so we are running the
service within debug mode right now
let's go ahead and do the same thing
with our Windows client and look at this
now if I want to debug let's type in
pledging for example if I want to debug
the WCF service all I need to do is you
know run the service within debug mode
and then stick in a breakpoint ok so we
actually want to debug the WCF server so
let's go to the service implementation
so let's go and stick in a break
point here and then click this get
message button so look at that
you know the debugger you know drops
into this one and I can press f10
inspect what is coming into this
variable look at that presume so it's
very easy to debug you know when we have
the WCF service self-hosted and another
greatest advantage with self-hosting is
it's going to support all bindings and
transport protocols for example if we
host WCF service within iis then i a
supports only HTTP based bindings you
know non HTTP based bindings are not
supported but it's self hosting we get
support for all the bindings and all the
transport protocols okay and it's very
flexible to control the lifetime of the
servers to the open and close methods of
service host ok now in order to make the
service host available for public
consumption all we have done is invoke
the open method on the service host
instance if you want to close the
service host all you need to do is host
dot close we'll discuss this in detail
you know when we discuss self hosting a
WCF service using windows application
we'll do that in our next video session
ok so those are the advantages of self
hosting the WCF service using the
console application there are
disadvantages as well so what are the
disadvantages the disadvantages are the
service is available for the clients
only when the service host is running ok
so if you stop the service host and then
if the client tries to basically think
it timed down so let's detach this
debugger so basically if the service
host is not running and then the client
tries to invoke the WCF service
obviously you know we are going to get a
communication exception so if you want
the WCF service to be available then the
service host has to be running ok and
self hosting does not support something
called
automatic message based acts activation
that we get when we host the WCF service
within
okay so when we have hosted the WCF
service within is you know we don't have
to manually start it you know the is is
always a passive listener so whenever a
message comes in the service is going to
start automatically so it's an automatic
message based activation we don't get
that with self hosting we have to
manually start and stop the service host
and obviously when we self hosted WCF
service we need to write custom code
okay but in general self hosting is only
suitable during the development and
demonstration phase you know when we
develop the WCF service but in real time
for live WCF services we don't really
host them using you know either a
console application or a Windows
application we don't really sell for
stability of service in real time okay
in real time Bay the host WCF services
you know in Windows services or you know
you send is with Windows activation so
this is enable we'll discuss all these
options in our upcoming videos that's it
for today thank you for listening have a
great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>