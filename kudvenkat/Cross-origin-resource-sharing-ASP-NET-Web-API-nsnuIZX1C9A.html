<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Cross origin resource sharing ASP NET Web API | Coder Coacher - Coaching Coders</title><meta content="Cross origin resource sharing ASP NET Web API - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Cross origin resource sharing ASP NET Web API</b></h2><h5 class="post__date">2016-09-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/nsnuIZX1C9A" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 15 of asp.net Web API
tutorial in this video we'll discuss
enabling course cross-origin resource
sharing in asp.net web api in our
previous video we discussed how to issue
cross domain Ajax calls by using JSONP
in this video we'll discuss how to do
the same thing by enabling course
cross-origin resource sharing first
let's undo what we have done in our
previous video so let's slip to visual
studio within register method of Web API
config dot C s file let's comment these
two lines we included these two lines to
support JSONP format and with an
employee's dot HTML let's change
datatype to jason and also in the HTML
file let's change it to jason let's give
our solution a build build succeeded now
let's view this page in the browser
let's click this get all employees
button notice we don't get anything
now let's launch browser developer tools
by pressing f12 key notice we get the
same error which is basically telling
that cross-domain ajax call is not
allowed now let's see how to enable
cross domain ajax call by enabling
course to enable chords the first step
is to install a package that contains
support for course and that package is
Microsoft or asp.net dot Web API dot
cars let's install this package there
are two ways to install this package we
can either install this using new get
package manager console window we have
discussed how to do that in our previous
video so in this video let's use nougat
package manager to install this nougat
package so let's flip to Visual Studio
let's right-click on this employee
service project which has got our Web
API project then I'm going to select
manage NuGet packages which is going to
open this vendor so select browse tab
and then search for the package which
contains support for course so here's
the package Microsoft dot asp.net Web
API dot
cause and we have that package right
here select that and click the install
button so this is going to install that
package as well as any other
dependencies package installation
successful now let's go to Web API
config dot CS within the register method
let's create an instance of enable
course attribute this attribute is
present in a different namespace and
that is system dot web dot h TT p dot
course let's include this using
declaration let's call the instance
course this attribute has got three
parameters the first parameter is
origins this is a comma separated list
of websites that we want to be able to
issue cross domain Ajax calls now in our
case we want this website to be able to
issue a cross domain Ajax call so let's
copy the domain URL and we can specify
that here in addition to this website if
you want another website for example
pledging techcom then you can include
that within the comma separated list
like this if you want to allow all the
websites then include star that's a
first parameter the second parameter is
headers again comma separated list of
headers that are supported by the
resource so if you want the resources to
support only accept and content type
headers you can include them as a comma
separated list if you want all the
headers to be supported then include
star and the final parameter is the
method that is supported by the resource
if you want only to issue cross-domain
Ajax calls to get method can just
specify get there in addition if you
want post let's specify that as a comma
separated list if you want to support
all methods then include star and then
finally on the config object call enable
course method and to the method pass the
instance of this enable course
attribute
so these are the two changes that I
required install the package and include
these two lines of code and the register
method of our Web API config class let's
give our solution a build build that
succeeded
now let's reload this page and let's
click this button get all employees
notice now they get the data as expected
here we have those two lines of code
that we included in the register method
to enable cores and here are the
parameters of the enable course
attribute origins headers and methods
these two lines of code that we have in
our register method enables calls
globally for the entire application that
is for all the controller's and all
action methods sometimes you may not
want to enable cores globally for the
entire application for example let's say
we have got four different controllers
within our web api project and we want
to enable cores on only one controller
we can do that using enable cost
attribute similarly if you want to
enable cars only for a specific action
method within a specific controller you
can still do that using the enable
course attribute enable course attribute
provides us with that level of
flexibility if you don't want to enable
cards globally across your entire
application then don't create an
instance of this attribute within
register method there is also no need to
pass an instance to the enable course
method now we have just prepared our
application to enable course but at the
moment none of the controller's other
action methods are enabled for course
now if you want to enable only employees
controller for cars then decorate that
controller with enable course
attribute this attribute is present in a
different namespace so let's bring in
that namespace now course is enabled for
all action methods only within employees
controller now if you don't want to
enable course for this specific method
within the controller then
you can use disable course attribute so
now course is disabled for this get
method but it is enabled for the rest of
the methods within our employees
controller enable course attribute can
be applied on a specific controller or
controller method to disable calls for a
specific action apply disable course
attribute on that specific action now
let's understand what happens behind the
scenes when course is enabled
let's clear what we have and issue
another request this request is captured
in fiddler let's inspect request and
response look at the request within the
request we have this origin header the
origin header is set to the website that
issued the Ajax request in our case the
website that issued the Ajax request is
this website localhost colon six two
nine three notice within the request
origin is set to that website and within
the response we have this header access
control allow origin it is set to star
star basically indicates allow access to
any website now the request is issued by
this website and access control allow
origin is saying star meaning allow
access to any website and that's the
reason we are able to see the data now
this access control allow origin is set
to star because we have told we want to
enable course for all websites remember
the first parameter of enable course
attribute is origins we have set it to
star basically telling allow access to
any website that's making the Ajax
request that's the reason why within the
response header we have access control
allow origin set to star now if we set
it to
presume techcom then Kars is enabled
only for this website so that means if
we issue a request from this website you
know the origin will be set to that
website but then within the response we
wouldn't have access control allow
origin header now when this header is
not present within the response then the
browser is not going to allow us to see
the response that we get from the server
let's actually prove that so let's
remove this disable course attribute
because we want to enable course for
this kept method as well let's give our
solution a build now build succeeded now
let's issue another request notice
immediately we get an error XML HTTP
request cannot load this resource look
at the message it says no access control
allow origin header is present on the
requested resource so basically this is
telling it cannot find access control
allow origin header in the response so
let's inspect this within fiddler
so here is the response that we got back
now notice within the response we don't
have access control allow origin and
look at the request header origin here
it is set to our website which issued
the request but within the response we
don't have access control allow origin
header and that's the reason why browser
security is preventing us from seeing
the response that we got back from the
server look at this the response that we
have here it has caught the status code
200 okay meaning the request has
completed successfully but then it is
the browser security which is preventing
us from seeing this data in the browser
because for security reasons browsers
doesn't allow cross-domain Ajax requests
for the cross domain ajax request to be
allowed it has to find this header
access control allow origin header in
the response since we don't have that
in the response right here the browser
security is preventing us from seeing
the response that we got from the server
now if we said origins parameter of our
enable course attribute to our domain
which is HTTP colon localhost colon six
two nine three then within the response
that we are going to get from the server
we are going to have access control
allow origin header set to this website
and we should be able to see the
response that we get from the server so
let's give our solution a build build
succeeded now let's issue another
request notice we get the data right
away and we don't have any error message
now let's inspect this in fiddler notice
within the request we have the origin
header set to our website that has
issued the ajax request and within the
response notice now we have this access
control allow origin header and this is
set to the website that has issued the
ajax request so the browser will look at
this response header and it sees all
right so this website which has issued
the request has access to it so it
allows us to see the response that we
get from server thank you for listening
and have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>