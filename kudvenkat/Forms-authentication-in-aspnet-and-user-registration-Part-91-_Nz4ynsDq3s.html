<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Forms authentication in asp.net and user registration   Part 91 | Coder Coacher - Coaching Coders</title><meta content="Forms authentication in asp.net and user registration   Part 91 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Forms authentication in asp.net and user registration   Part 91</b></h2><h5 class="post__date">2012-12-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_Nz4ynsDq3s" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello welcome to team technologies I am
venket this is part 91 of asp.net video
series this is continuation to part 90
if you haven't watched part 90 I would
strongly encourage you to do so before
continuing with the session in this
session we'll discuss about registering
a user using registration page one of
the problems with the examples that we
discussed in part and 90 of this video
series is that we are not able to
navigate to registered or aspx page if
we are not logged in let's see how to
solve that problem
now this is the application that we have
been working with in part 90 of this
video series so I have this login page
now when I navigate to this login page I
have a link here to go to the
registration page now I don't have a
user name and password to login so
obviously I want to register fast and I
want to get to the registration page
look at that when I click that you know
I'm not able to navigate to that page
understand until I login this is
incorrect so let's see how to correct
this problem
first let's understand why we have this
problem in place okay
that's because if you remember in part
90 we enable that forms authentication
and then we also included this
authorization element okay so we want to
deny access to n animus users okay so
with this authorization setting in place
the end users now will only be able to
access login page okay because we have
specified the login URL s login dot aspx
so without logging in into the
application you can only access now
login dot aspx page if you try to
navigate to any other page including the
register or welcome plot aspx page you
will be denied access you will be
redirected back to login dot aspx page
okay so to solve this problem we can add
another web config file to this
registration folder so let me right
click on that add new item let me add
the web configuration file so web.config
file added to the registration folder so
in this web config file I'm going to
include another authorization element
and here I'm going to allow access to
all users including anonymous so if we
specify star that means all users
so now the settings that are present in
this web config file are applicable for
all the pages within registration folder
so a user can get to register dot aspx
page without even log again so let's run
the application with the setting in
place and see if that has fur so I am on
the login page press ctrl f5 and I can
click on that link and navigate to
register dot aspx page look at that now
I am able to get to the registration
page ok now obviously this registration
page it's a very simple page here you
have user name password confirm password
all these are static text and text boxes
to provide those details and when click
when I click register button we need to
harvest these values send them to sequel
server and see we should store them in a
database table ok and on this waveform I
also have some validation controls you
know I have used some validation
controls and validation summary control
so the user will not be able to submit
the waveform unless and until they
provide these details now if you're new
to validation controls because we are
not going to discuss about validation
controls now we have discussed about
them and in the previous sessions of
this video series so please check those
you know video sessions first so let's
go to register page so if you look at
the register page very simple HTML those
are the validation control so if you
look at them there are a lot of
validation controls here and then
obviously when I click this button
that's when we want to retrieve those we
details and save them to the database so
first we need to create the database
table so let's flip to sequel server
management studio so I want to create
this TBL user table so if you look at
the table create table TBL users and we
are going to have 4 columns here ID
username password and email so ID is of
type integer
that's an identity column and a primary
key also for it for our table and
username password and email or of type
and we're cat now we have discussed
about what is an identity column and how
to create identity column and how to
create tables and stored procedures in
the sequel server video series if you
haven't watched that video series I
would strongly encourage you to watch
them as well ok so let's go ahead and
create this table
let's refresh the tables folder and we
will have the table there now at the
moment we don't have any rows in the
table so we have all these four columns
now obviously we need a stored procedure
as well which will add this user to the
table and to do that I have another
stored procedure here SP register user
and if you look at the stored procedure
it's taking in at three parameters so
obviously those three parameters are
going to provide the values for username
password and email columns now we don't
have to supply the value for ID column
because that is the identity column the
values of identity column are
automatically computed on the fly
when the row is inserted okay so we have
these input parameters to the stored
procedure and this is the body within
the body we have two variables one
variable I mean both of them are of type
integer one is called account and the
other one is written code you will
understand in a bit what those variables
are for so first what we are doing so
when we pass in a username password and
email to at the database
now remember user names cannot be
duplicated so if a user registers with a
username venker you should not be
allowed to register again with the same
username so user names have to be unique
so how do we enforce that uniqueness
your finding so if I get a user name to
be added to the table what am I doing
here I am writing a select query select
add count so into this variable I'm and
I'm selecting the count of usernames
where username is equal to at username
whatever use an MV pass in you know we
compare against that if there are you
know let's say one username already with
that name I will get that into this
variable at count okay so if that add
count is greater than zero then
definitely we know that the username
exists in the table so in that case we
are setting the return code to minus one
on the other hand if it's not greater
than zero then we know that it should be
either equal to 0 or less than 0 in
which case we insert that row into the
database so we supply the values for
username password and email insert that
into TBL users but before that look at
the return card we are setting that to 1
so if the return code is minus 1 that
means you know the username exists if it
is one the username doesn't exist and we
have successfully inserted that into
this table okay and finally we select
that written couldn't give it to the
dotnet application and within the dotnet
application we retrieve that value and
then determine what to do depending on
whether it is minus one or one okay so
now let's go ahead and see how to invoke
this you know stored procedure from
dotnet application so on the resistor
page when I click that button control
that's when we want to do that okay so
just to save some time I have this ad or
dotnet code now this code that we are
going to paste here this is not related
to forms authentication this is a do
dotnet code so if you're new to a do
dotnet we have a video series recorded
on a do net as well I will have all the
links for the other videos within the
description of this video so please
check them if you haven't watched them
okay
so first let's solve these compilation
errors that we see here this in tag I
mean the compilation errors and look at
that the first error is configuration
manager class the configuration manager
class is present in system configuration
namespace so let's import that so system
dot configuration so that should solve
that error and then sequel connection
sequel command these classes are present
in system dot data dot sequel client the
namespace and that should solve the rest
of the compilation errors okay and
command type is actually present in
system dot data namespace so let's
import that as well okay so that should
have solved all these errors now what we
are doing here now the first line is
interesting here if page is valid now if
you remember on the register page we're
using validation controls these
validation controls we have spoken about
them in the previous session so please
check that video sessions but just to
give you a quick overview on YBI using
this page stored is valid if you know
the validation controls work both on the
client side and on the server side
clients can disable javascript in which
case
client-side validation will be disabled
and we want to do validation on the
server-side and validation controls does
that automatically now if the client has
disabled validation on the client-side
and if if some of the validation
controls has failed validation then this
page dot is valid property will return
false so if it returns false we don't
want to do anything so this block of
code will not be executed instead the
validation error messages will be
displayed to the end-user okay so we
want to do this only if page is valid so
what are we doing here obviously we are
retrieving the connection string from
web config file so if you look at the
web config file in the root directory I
have a connection string with name DB CS
so I'm pointing to my local server
sample database that's the user ID and
that's the password okay so we are
retrieving the connection string and we
are creating the connection object and
the command type is sp register user and
we are specifying the command type is
stored procedure and we are creating the
three sequel parameter objects okay and
then we are associating those parameter
objects with the command object using
the parameters collection open the
connection
execute the command now we are using
execute scalar because if you look at
the stored procedure it's selecting a
single value so that's why we are using
execute scalar and then execute scalar
returns an object type but we know that
we are going to get an integer back
so I'm typecasting that to be of type
integer storing it in this variable and
look at that I'm comparing if return
code is minus 1 that means user name is
already in use we have to choose another
user with the name on the other hand
otherwise we redirect the user to the
login page so on the login page he can
enter you know his newly created
username and password and then login ok
so it's such a simple code there ok so
let me go ahead and run this application
as it stands right now control f5 so now
I don't have a username and password so
I should be able to click on this
register link get to the register page
provide the username so let's say test
test is the password test is the
password tested test call
is the email and I click register button
okay could not find stored procedure SP
register user that's because we haven't
created this tool procedure at so let's
go ahead and create that
so press f5 now let's go back so test is
the password confirm password is test
click register look at that you know it
redirected me back to the login page
which means it has already added that
test user so let's quickly check it the
test user is added if I look at that
user name is test password is test and
the email is test ok that's fine let's
try to add another user with the same
username so I'm going to add a test ok
I'm going to supply the same user name
again let me click register look at that
user name already in use
please choose another user name so
everything is working fine everything is
good but there's one issue here if you
look at the way VA storing passwords
here we are storing them in plain text
now in reality in real time you
shouldn't be storing passwords in plain
text you know that's because of several
legislative rules as well as the
organization's standards even the
administrator of the application should
be shouldn't be knowing the passwords of
the other users ok so we want to encrypt
and store passwords so how do we encrypt
them to encrypt it's very easy so within
the registration page now dotnet
framework has provided a method called a
hash password for storing in config file
that's the name of the method and that
method is present in forms
authentication class so forms
authentication is already obviously
present in system dot web dot security
namespace so let me go ahead and import
that and then what I want to do if you
remember if you look at this code here
we are passing in the value for the
password parameter at this line so I and
I'm and I am passing that you know
directly by retrieving it from the
password text box instead of that
retrieve that value and clip that and
then pass the encrypted value to this
parameter so how do I enter it the pass
word to encrypt the password so let's
create a variable first so n cryptid
password is equal to I'm going to use
the forms authentication class so forms
authentication dot there is a method
called hash password for storing in
config file and look at the return type
of this method this method takes into
parameters the password that we want to
encrypt and what is the algorithm that
we want to use in order you will want to
use sha-1 encryption algorithm or md5
which encryption algorithm okay so where
is the password pleasant the password is
present in txt password text box so I'm
going to retrieve that and then I also
need to specify the password format so
I'm going to use sha-1 okay so that's
going to encrypt the password using that
algorithm and that's and return that and
we have shown that in this variable and
I'm going to use that and pass it to
this parameter as a value okay so with
this change let's go ahead and run this
so I'm on the login page so click here
to register so I get to the register
page so let's give another username test
one that's the password confirm password
and let's say test a test com register
so I'm redirecting now let's go back to
the table look at that the password is
now encrypted it's not present in plain
text format okay so so far in this video
we have discussed how to register the
user okay in the next video session
we'll discuss about authenticating with
the credentials that we have just stored
now at the moment if you look at that I
will not be able to login using test or
test one because at the moment we
haven't implemented in the previous
session we actually discussed how to
authenticate using the usernames and
passwords that we have stored in the web
config file but in reality we don't
really store user names and passwords in
web config file we store them in the
database like this and we want to be
validating against this list that's
present in the data
based instead of you know using the list
that I have in web.config file we'll
discuss about that in the next video
session on this slide you can find
resources for asp.net c-sharp and sequel
server interview questions that's it for
today thank you for listening have a
great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>