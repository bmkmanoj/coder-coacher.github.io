<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 151   Assigning a master page dynamically in asp net | Coder Coacher - Coaching Coders</title><meta content="Part 151   Assigning a master page dynamically in asp net - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 151   Assigning a master page dynamically in asp net</b></h2><h5 class="post__date">2013-10-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6cZuPWHOps4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">part 151 of asp.net tutorial in this
video we'll discuss how to select the
master page dynamically at runtime
before proceeding with this video I
strongly recommend to watch parts 147
and 149 from the asp.net tutorial this
is what we want to achieve in this video
we're going to have a drop down list on
the master page and that drop down list
is going to list all the master pages
that are available in our entire project
as we select a master page from the drop
down list we want that selected master
page to be dynamically set as the master
page so notice that on the left hand
side we have master page 1 selected from
the drop down list and this is how
master page 1 looks like and on the
right hand side notice that we have
master page 2 selected and this cell
must page 2 looks like notice that we
have a different color scheme and the
menu section is actually present on the
right hand side on master page 2 so
basically the idea here is to set master
page dynamically at runtime let's see
how to achieve this let's flip to visual
studio so here I have a blanket p.net
web forms application first let's add a
class file and let's call this base
master page as the name suggests this is
going to be the base class for all the
master pages that we are going to have
in our project and this class is going
to be an abstract class because this
class is going to contain some abstract
properties and this class is going to
inherit from system dot fab.com
to piccoli when we add a master page to
our project in a master pages by default
inherit from this class system to web
dot you I don't masturbate now we want
this class to be acting as the base
class for all our master pages in our
project so we made this class inherit
from the dotnet framework master page
class and then the master pages that we
are going to add are going to inherit
from this base master page class
okay and in a bit we'll understand the
advantage of doing this okay so this
class is going to contain three abstract
properties the first property is
actually going to return a panel control
and all the asp.net web controls are
present in system dot web UI dot web
controls namespace so let's go ahead and
bring that namespace in so we want this
property to return a panel control and
let's call the property as search panel
since this is going to be an abstract
property we are not going to implement
the get access are in a similar fashion
we are going to have do more abstract
properties the other abstract property
is actually going to return a textbox
and let's call this search text box and
the third property is going to return a
button control and let's call this
property search button so basically what
these properties are returning you know
the first property is returning panel
this property is returning a textbox and
this property a button so basically the
panel that surrounds the search
interface the search text box and the
search button all right now the next
step is to actually add a master P so
let's right click on the project name
add a new item and we want to add a
master page and let's call this site dot
master okay so there we go we have the
master page but then to get the layout
that we see in this slide here you know
I have already implemented the HTML and
this is the same HTML that we discussed
in parts 147 and 149 so I'm not going to
go into the details of this HTML I'm
simply going to copy this and then go to
the master page that we have added so
first of all let's get rid of the
content placeholder that's present
within the head section and then here
I'm going to get the get rid of this div
tag and
paste the HTML that we have just copied
and if you look at this HTML this is the
same HTML which we discussed in parts
147 and 149 okay the thing that we have
to pay attention here is the content
placeholder look at the ID of the
content placeholder its main content
okay so when we flip this to the design
mode notice that we have a similar
interface here all that we need to do
now is to actually add this drop-down
list you know in the menu section on the
left hand side here so let's actually
flip this to the source mode and then
here we have the menu section so let's
get rid of that I'm going to use a bold
tag and then simply say select master
page and then here we are going to have
a drop-down list control so let's drag
and drop a drop down list control and
within this drop-down list control I'm
going to have to list items one is going
to say master page 1 the other list item
will say master page 2 so let's go ahead
and add a list item so a SP list item
text on this one is going to be let's
say master page 1 and value is going to
be the part for that master page okay so
master page 1 will be the site dot
master and this side dot master is
present in the root directory so I'm
going to use the tilde character for
slash side master ok
so let's copy and paste this and let's
call it you know maybe master page 2 and
the second master page is going to be
site 2 dot master we don't have that yet
we'll add that in just a bit ok so
basically this should give us you know
what you see in the slide so we have
that title there select master page and
then the drop down list all right now
within the code-behind file of this
master page so let's actually get to the
code-behind file
so so we are going to make this master
page you know the site master page look
at this by default it's inheriting from
system what web dot you way dot
masturbate instead of that we are going
to make this inherit from base master
page class that we have just created
okay now look at this this base master
page class has got three abstract
properties so obviously this master page
which is inheriting from that base
master page class has to provide
implementations for those properties and
if you remember again in part 149 we
discussed implementing you know those
properties so basically I'm going to
copy the implementations for the
properties and paste them within the
master page and if you look at these
properties they are very straightforward
so what are they doing they are
returning the search panel control the
search textbox control and the search
button controls you know I think the IDS
are little different on the master pages
on the master bait so let's go and fix
them first so let's see what is the
search text box is called so it's called
as a text box one let's actually call it
you know txt search so that we don't
have that compilation error and let's
call the button as BTN search and the
panel as search panel I mean panel
search
alright let's save everything at this
point within our master page you know we
have provided the implementations for
the properties that we have in the pace
class now we need to use the override
keyword because we are providing the
implementations okay
so let's build a solution to make sure
everything compiles so we have two
errors a website in a waveforms demo dot
site does not implement inherited
abstract member search text box dot cat
let's see what is the name of the
property here so the property name here
is search term so that's actually so
basically this property should return
the text that is present within the
search text box so the return type has
actually should be string so within our
base master page let's correct that so
this has to be string and let's call the
property as search term so that should
get rid of the error okay so build it
succeeded all right now within the
master page we have this drop-down list
control so we need to set two things
here first we need to set auto post back
to true and once we double click this
you know obviously the even handler will
be generated so what do we want to do
when the selection in the drop-down list
has changed we want to set that selected
master page as the master page okay so
basically what we are going to do here
is we are going to store something in
the session variable so I'm going to use
a key called selected underscore master
page so within this variable we are
going to store whatever we have selected
within the drop-down list and then we
are going to redirect the user to the
same page in a bit you will understand
why we are doing that so response dot
redirect
and where do we want to redirect the
user we want to redirect him to the same
page and to get the URL of the page that
the user is on I am going to use request
object URI property dot absolute URI
okay
and then I am also going to include a
pre-render event for this master page so
page load let's change the name to
pre-render so when is this even fired
just before you know the page is about
to be rendered so within the
pre-rendered event what we are going to
do is check if there is something within
the session variable so if session of
selected master page if that is not
equal to now then drop-down list 1 dot
selected value equals whatever value
that is present within the session
variable you know this may be a little
confusing at this point of time but
don't worry we're going to discuss why
we are redirecting the user to the same
page and why we have to set the selected
value of the drop-down list okay we're
going to understand that in just a bit
all right so that's all the code that we
need on you know our first master page
now let's go ahead and add another
master page now if we look at this
master page you know this is how the
color scheme is notice that the menu
section is present on the left hand side
let me add another master page to this
project and let's call this maybe site
two dot master okay to speed things up
I'm going to copy the content that's
present in our site dot master so let's
copy all this HTML
and then paste that within our master
page too so we are going to get you know
the same layout but we want a different
color scheme and we want this menu
section to be present on the right hand
side so first of all let's change the
color scheme and to do that within the
source mode you notice the first TD here
let's set the background color to maybe
red okay and then let's add the
background color of this TD first of all
we want that menu section on the right
hand side so I'm just going to cut this
TD from there and put that on the right
hand side okay so at this point if we
flip this to the design mode notice that
we have red background color and then
the menu section is present on the right
hand side and we want this font color to
be white so what we're going to do here
is at the table level let's set color to
white okay and let's change the
background color of this TD to green
and let's actually this TD is clean and
the ste D is blue so we have said you
know the main content placeholder to
have green color and let's add this to
blue so this one let's set it to bloom
and finally Fuda let's set the footer
also to red okay so at this point let's
flip this to the design mode look at
that we have a similar layout okay now
within the code-behind file of the site
two dot master let's copy and paste this
code so we are copying the code that we
have in sight you know basically the
first master page code behind file and
we're going to paste that in the code
behind file of master page two
okay and another thing that we need to
do is make this much you know site to
master page inherit from our common base
master page class okay so at this point
we have two master pages both of them
inherit from our base master page okay
the next step is to actually add a base
page class so let's add a class file and
let's call this base page so this class
as the name suggests this is going to be
the base class for all content pages
that we are going to have in our entire
application so by default when you add a
web form a web form is going to inherit
from system dot web dy dot page class
okay so we're going to make the space
page class inherit from that you know
page class which is present in system
dot web dot y dot page class okay and we
are going to override one property that
is on pre init in a bit you will
understand why we are doing this and
basically what we are going to do in
this event is that we are going to set
the master page dynamically so we are
going to check if you remember within
the master page then the selection
within the drop-down list changes we are
setting we are storing the selected
master page within the session variable
so basically we are going to check and
we're going to have an exact similar
condition on our base page so if session
of selected master page not equal to now
then what we are going to do we are
going to set the master page file okay
to whatever that is present within the
session variable so this dot master page
file equals the value that is present
and now the next step is to add a
Content page so I'm going to select this
first master page so that is site dot
master right click on that add a content
page so look at this at the moment we
have
master page file set-aside master and
then another thing that I'm going to do
here is specify master type directive
what is the advantage of specifying
master type directive
this is going to give us a strongly
typed reference that is associated with
the master page and instead of using
virtual part I'm going to use type name
here now for the master pages that we
have in our application what is the
common base page that is based master
page dot CS okay and this class is
actually present in web forms demo
namespace so the type name here is going
to be based master page that's the name
of the class and then we need to specify
the fully qualified name here so let's
include the namespace as well what is
the namespace webforms demo so let's say
their forms demo dot and base a master
page okay and within the content
placeholder basically we want to display
all the students so let's drag and drop
a gridview control and within the
code-behind file okay now another
important thing here look at this you
know when we added this webform its
inheriting from system got web dot you
way dot page instead of that we are
going to make this class inherit from
the base page class that we have created
so if you look at this base page class
this class is inheriting from system dot
web dot UI page and in this base page we
have overridden the pre init event
within the pre entity event we are
setting the master page file here
dynamically with whatever value that we
have stored in the session variable okay
all right so now
I'm going to write some ad or dotnet
code basically to retrieve data from the
stable TBL students now we discussed the
880 or.net code to retrieve data from
the stable in part 149 of the asp.net
tutorial so I'm not going to go into the
details of that I'm simply going to copy
this function and paste it within the
code behind file of our web form one dot
aspx so here we have a private method
which is going to get data you know from
this table TB of students now this is a
do dotnet code so we need some ad or
namespaces so let's bring them in system
dot data similarly we need system data
dot sequel client and system dot
configuration okay so that should get
rid of the errors all right so this is
the stored procedure SP search students
that we are executing again we discussed
how to implement that procedure and part
149 so basically what is the stored
procedure doing select all the students
where the student name contains whatever
search term that's coming into the
stored procedure okay all right so
basically within the page load event if
it's not a postback then what we want to
do we want to invoke this method get
data and let's pass now okay because we
want to display all the students on the
page load okay but then whenever
somebody enters some search term here
and then click that search button we
want to include only those students you
know whose name contains the search term
that we entered in this search text box
and basically to achieve that again we
discuss that in detail in part 149 okay
so basically what we are going to do
here is in the page initialization event
so let's copy this even handler so n
page in it
so I'm going to use the master property
here master dot there is a property
called search button which is going to
return the search button that is
available on the master page now what is
the master page you know for this class
if you look at the code-behind file look
at that we have specified master type
and we haven't hard-coded the master
type to a the site dot master a site to
dot master why is that that's basically
because we want to be in a position to
change the master pages dynamically at
runtime and that's the reason we have
created this base master page class and
we made these two master pages that is
side that master and site two dot master
inherit from that base master page class
and if you look at this base master page
class we have this abstract property
here search parallel search button and
search term ok and the respective master
pages have overridden they these
properties meaning they have provided
implementations for these properties and
since now within the content page the
type a is base master page and that
based master page contains implement you
know basically the references to
properties we can reference them in the
code-behind file of the content page you
know look at this we get a strongly
typed the reference search button ok and
look at this where is that search button
coming from our base master page ok so
basically we are moving all the common
properties that we want to access from
the content page into that base master
page class ok so search button property
is basically going to return the search
button on the master page and then you
know we are going to associate an even
handle up method for the click event so
plus equals plus tab twice that's going
to generate this even handler method so
within search button under scope click
what we need to do is invoke our get
data method
so let's invoke this get data method and
then pass the search term again where
are we going to get the search term from
our base page base master page class so
there is this property search term so
get data master dot search term should
give us that all right so with all these
changes let's actually learn and if we
have implemented everything right you
know we should be able to change master
pages dynamically at runtime okay so
when the wave form first displays it
should use you know site master that is
the first master page look at that you
know we have that gray color scheme and
the menu section is present on the
left-hand side let me select master page
to look at that and look at the
selection that is retained as well and
let me select master page one so we are
back at master page one okay so it's
working as expected now let's try and
understand what's actually happening
within the master page so why are V you
know redirecting the user to the same
page again that's because when we have
to set a master page dynamically keep in
mind that the master page and content
page are merged during the
initialization stage of the page
processing okay so a master page must be
assigned before the initialization stage
so that's why we generally assign a
master page dynamically during the pre
init stage okay so if you keep the
statement in mind and look at what's
happening here look at this this
drop-down list one underscore selected
index change this is a postback event so
within the post vacu vent we are you
know storing the selected master page
within the drop-down list
now postback event happens way after pre
entertainment so at the same point you
can't change the master page dynamically
so what we are doing here is
we are storing the selected master page
in a session variable and then we are
reloading the same page once again and
within the pre energy event what we are
doing so if you look at base page so
within the pre edit event we are setting
the master page file dynamically okay
because by this time in the session
variable we have the selected master
page from the drop-down list and we are
setting that as the master page file
it's as simple as that
that is the reason why we are
redirecting the user to the same page
okay and then why do we need to set this
once again you know because once we have
selected you know asp.net controls
should remain their view state but why
do we need to do that that's basically
because we are redirecting the user so
it's like a brand new request to that
page okay so that's why within the page
pre-render event we will check what is
there within the session variable and
then we'll retrieve that and then store
as the selected value for the drop-down
list if you comment this one this event
handler then you know basically this
drop-down list is not going to remember
those selections all right now look at
this you may be wondering why did we
create this base page can't we have this
method within the page itself you know a
page can have pre in it event so within
the pre init event we can actually copy
and paste this code and it's going to
work the same way but the reason why we
have done this in the base page is
because tomorrow if we have to add
another content page we don't have to
copy and paste this code on that content
page once again all we need to do is
make that content page inherit from this
base page class and it's all going to
fall in place automatically let's
actually look at that so let's add a
content page another content page let's
right-click on this master page I had a
Content page so first of all we need to
set the master type so
master type and then specify the type
name type name is going to be the forms
demo is the namespace and what is the
name of the class the base master page
class base masturbates so let's copy the
name of the class and paste it here so
the first step is to specify the type
name and the second step is to make this
perform to inherit from our base page
class okay so this is perform to and
within the content placeholder let's
simply use an h2 tag and say this is a
verb form to okay so let's go ahead and
run this now initially when this wave
form to loads it uses the first master
base but then we should be able to
dynamically look at this this is wave
form to master P h2 and we are on the
master page too okay so basically it's
very easy now to add content pages as
well there are two steps all you need to
do is specify the master type directive
and within the code-behind file make
that content page inherit from the base
page class and you're done alright
that's it for today thank you for
listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>