<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>asp.net detailsview insert update delete using objectdatasource control - Part 41 | Coder Coacher - Coaching Coders</title><meta content="asp.net detailsview insert update delete using objectdatasource control - Part 41 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>asp.net detailsview insert update delete using objectdatasource control - Part 41</b></h2><h5 class="post__date">2013-03-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/cyux2KleWdk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello welcome to Collegium technologies
I am venket this is part 41 of asp.net
preview tutorial in this video well
discuss about inserting updating and
deleting data using details view and
object data source control in the
previous session we discussed about
doing exactly the same thing using
sequel data source control in this video
we will be using object data source
control obviously we will have to use
object data source control to perform
insert update and delete then our
employee data access layer should have
those respective methods now if you
remember in the previous sessions we
have been building employee data access
layer but this layer has got only
methods to select employee's data at the
moment so obviously we need to add
insert update and delete methods as well
for our employee data access layer and
to speed things up I have this code
already type so let me copy and paste
that within our employee data access
layer class so the first method here is
going to be insert employee method and
if you look at this method it has got
several parameters why is that that's
because if you look at TBL employee
table it has got several columns for
which we will have to supply values when
we insert a new row into this table okay
so and to pass those values we have
these parameters first name last name
city gender etc and another important
thing to notice here is that this insert
employee method does not have a
parameter which is going to supply a
value for this ID column why is that
that's because the ID column within this
table TBL employee is the identity
column for the identity column we don't
have to supply a value when we insert a
row that's the reason why we don't have
an ID you know as a parameter for the
insert employee method okay so we have
these parameters for this method and
then the rest of the code that we have
here is straightforward ad or net code
okay so the first line here is reading
the connection string from web config
file using which we are creating a
sequel connection object and then we
have our insert query so this is a
straightforward parameterised sequel
insert query so insert into TBL employee
values you know and we have
parameters a list here okay so for each
of the sequel parameter that we have in
this insert query we need to prepare a
sequel parameter object which is what we
are doing here
so all of this code here is actually
building the parameter objects and then
associating those parameter objects with
the parameters collection property of
the command object okay look at all of
them our parameters okay and then to
collect them so that we can read the
code properly I have used a region here
so let me collapse that so what are we
doing here we have the insert query
using that we are preparing the sequel
command object and then we are building
our parameters and then open the
connection execute or non query so
that's the insert method insert employee
method okay
along the same lines I have update
employee method but here if you notice
we have ID as well because why when we
are updating an employee will use the ID
column as the key column so that we can
uniquely identify an employee and update
his record okay so we have all the
parameters again here the same idea lead
the connection string prepare the sequel
connection object we have the update
query and then using that update query
prepare the sequel command object and
then obviously for each of the sequel
parameter we need to you know assign a
value and a parameter name which is what
we are doing here so let's color up
these parameters and then open the
connection execute that update query all
right so that's update employee and
finally we need a method to delete
employee as well and this you know has
just one parameter because why when we
delete an employee we don't really care
about other columns all we care about
the ID column based on which we want to
delete the employee's record so that's
what we are passing in as the parameter
and again straightforward code read the
connection string prepare the signal
connection object prepare your sequel
command object associate the parameter
with the command object open the
connection execute the query and we are
done so at the moment we have all the
methods insert update delete and select
within employee data access layer so now
let's flip to our web form one or aspx
drag and drop our grid view control
let's auto format that let's choose
brown sugar scheme
let's drag-and-drop details view control
lets out-of-home at that lets choose
again the brown sugar scheme and we need
to object datasource controls so let's
drag and drop them onto the waveform
okay now let's build our solution so
that the employee data access layer is
compiled so click on the tasks pane of
object datasource one control click on
configure datasource choose your
business object it's going to be
employee data access layer which is
present in demo namespace click next
choose your select method the select
method is going to be get all employee
basic details which is going to return a
list of employee basic objects ok click
finish now associate this with our grid
view one control and we want to enable
selection so that the select link button
will be shown within the grid view
control so the next step is to configure
our object datasource to control select
your business object which is going to
be the same thing demo dot employee data
access layer we need to specify our
select method this time the select
method is going to be get employees full
details by ID so once I select an
employee record but then the grid view
control for that selected employee we
want to show the full details within the
details you can draw so obviously the
method which is going to retrieve the
full details is going to expect an ID so
that's what is the parameter here and
then in addition to that we also need to
specify update insert and delete because
our details view control should support
you know in addition to selection we
should be able to edit delete and insert
a new record as well so let's specify
the update method which is going to be
update employee the insert method is
going to be insert employee and the
delete method is going to be delete
employee alright that now we need to
specify the parameter for the select
method so where is the parameter value
is going to come for this ID parameter
for the select method it's going to come
from another control on this waveform
which is that other control that's
grid-view one okay so ID is going to get
its value from this
selected value property of grid-view one
control click finish now let's associate
our objective source control with our
details view control and look at that
the moment I do that I have these
options enable inserting editing and
deleting as well why is that because our
details view control has the methods to
do that so I'm going to check all these
boxes okay so with that I'm going to run
this but then we'll get an exception
we'll solve that in a bit okay
so we get an error saying data keys must
be specified on grid view grid view 1
why is that because I mean we have seen
this error several times now that's
because we are using this selected value
property of grid view 1 control so if
you have to use the selected value
property you need to set the data key
names properly so what is the data key
going to be for our grid view control
it's going to be the ID column so let's
go ahead and set the data key names
property which is going to be ID so now
we should have that problem gone so
whenever form loads it should show all
the employees within the grid we control
but the problem here is you know we
don't want the details view to be
visible if there are no employees
selected within the grid view control
and we have discussed about this as well
now to solve this all we need to do is
we can make use of the page pre-render
event you have seen this problem in the
previous sessions as well so let's use
the pre render event and then within the
pre-render event if there is no selected
within the grid view control if selected
row if selected row is equal to null
meaning no rule selected within the grid
view control then we want to hide at the
details view so details view 1 dot
visible is equal to false on the other
hand if there is a row selected then we
want to turn on the visibility of
details view one control so details v1
dot visible is equal to true it's simple
all right so that should solve that
problem so obviously when we run this
now when the grid view renders
details view should be been visible
because no row is selected but once I
select a row I can see that now let's
click Edit here and look at this when I
click Edit first of all the problem is
ID first name city I don't want this at
the bottom I want this to be on the top
of the details view and the second
problem is ID is the primary key which
is non editable I don't want that to be
editable let's all both of these
problems okay and obviously to do that
let's flip the wave form to the source
mode and then let's retrieve these three
bound wheels you know which are
displaying ID first name and City from
the details you can draw and then move
them to the top okay and then we don't
want this ID to be editable all we need
to do is we need to set read-only to
true
okay so now let's run this and then
let's select this and let's click Edit
now okay look at that ID is non editable
now let's change
Nick so fast named from Nick - Nick one
and then let's actually update this look
at this is this updated we don't know
let's actually check the database first
so Nick let's execute this query look at
that next row is not updated why is that
that's because you know if you want the
rule to be correctly updated then for
the details view control you need to set
a data key names property again so
within the grid within details you
control what is the key field it's the
ID again okay so we need to set that for
details view as well so let's go ahead
and set data key names is equal to ID
for details view now let's run this and
then let's try to edit and see if it
works let's close all the other tabs
let's select Nick's record let's edit
that I'm going to change it Nick - Nick
1 and then let's update that okay
so look at this it's updated within
details view let's see if it's updated
within the table it's updated within the
table but then the grid view control is
not refreshed so how to refresh the grid
we control obviously when we update that
row within the details we control and he
these rays detailsview are you know item
updated event so within that even
handler all we need to do is refresh the
grid we control so let's do that and we
have to do that when we delete and
insert as well so let's generate the
event handler for for all the three
methods I mean for all the three events
so that's our details view control go to
the properties by pressing f4 click on
the events icon and then item delete it
and we also want to do the same thing
when item is inserted so let's generate
that even handler as well and finally
for item updated so what should happen
when we update our insider when we
delete an item the grid view should be
refreshed and to do that all we need to
do is invoke the you know data bind
method of grid view one control and then
we don't want any row to be selected
after the row is updated so I'm going to
set select row property of grid view one
two minus one okay let's do this let's
copy and paste this code in the rest of
the event handler methods that we have
here and let's run this now okay so I
select the next record I'm going to edit
that I'm going to change that from back
from Nick one to Nick update that look
at that it's updated the grid view
control is refreshed let's select that
let's you know basically insert a new
record again look at this when I try to
insert a new record again it's asking me
to supply a value for the ID column
remember ID is an identity column and we
don't have to supply a value for that
okay and there's no reason why we are
showing an interface here to do that so
when I put this details view in insert
mode I don't want this ID bound field to
be rendering here so how do I turn off
this field from rendering here it's very
simple all you have to do is this bound
field has got a property called insert
visible all I need to do is set that to
false insert visible is equal to false
and once we do this run this now you
know when we put the details view with
an insert mode
you know you don't have that visible
anymore so let's actually change this to
first name to a the city to be lasting
to siege in the today date of birth to
something zero one to one country to e
salary may be twelve data of joining and
marital status M let's insert this and
see if it it gets inserted look at that
it's inserted let's check our table
quickly so there's a new rule there
let's select that and let's try to
delete that look at that row is deleted
preview control is refreshed as well
alright so in this video we have
discussed about using object data source
control to perform insert update and
delete on this slide you can find
resources for asp.net c-sharp and
sequels of interview questions that's it
for today thank you for listening have a
great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>