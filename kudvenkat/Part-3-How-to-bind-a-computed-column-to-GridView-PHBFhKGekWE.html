<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 3   How to bind a computed column to GridView | Coder Coacher - Coaching Coders</title><meta content="Part 3   How to bind a computed column to GridView - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 3   How to bind a computed column to GridView</b></h2><h5 class="post__date">2014-06-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/PHBFhKGekWE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part three of dotnet return test
questions and answers video series in
this video we'll discuss how to bind a
computed column to a grid we control one
of our YouTube channel subscribers face
this question in a dotnet return test
let me explain the scenario notice that
here we've got employees table with
serial number employee code name and
date of joining columns we want to
display this data within a grid we
control as you can see here notice that
serial number employee code name and
date of joining columns are displayed as
it is in addition to those columns we
also have eligible for graduated column
notice that this column is not present
in the database table we need to compute
that column and then bind it to the grid
view control and whether an employee is
eligible for graduating or not that it
depends on the tenure of the employee if
the employee has completed five years or
more than they are eligible for gradua t
otherwise not and then within the
control wherever we see value as for
this eligible for graduated column we
need to highlight that value with a
different color notice that here we are
highlighting it with yellow color so
let's see how to achieve this the first
appear is to create the database table
which I have already done and here is
the sequel script that can do it
I'll have the script available on my
blog in case you need it now let's flip
to visual studio so here I have an empty
asp.net web application project the
first thing here is to add a connection
string to web config file so let's go to
an include connection strings a section
and to speed things up I have already
typed the required connection string so
let's copy and paste it right there so
we are using this sample database and to
this project let's add a webform and on
this verb form let's drag and drop a
grid we control and let's also set the
style attribute here and set font family
to area and let's now flip this to the
design mode and auto format this grid we
control to choose colorful scheme and
now let's write the required code within
the code behind file so we are going to
write some radio dotnet code
so let's bring in the required area
dotnet namespaces we need system data we
need system dot data dot sequel client
and we need system configuration the
first thing to do is we need to read the
connection strings so string CS equals
configuration manager dot connection
strings off and we need to specify the
name of a connection string which is T
VCS so let's copy and paste that right
there and let's go ahead and create an
instance of sequel connection object and
we are going to use the connection
string that we have read from the web
config file to create the signal
connection object now let's go ahead and
create sequel command object and our
sequel command is going to be pretty
straightforward which simply say select
star from employees so let's copy that
and pass it as an argument for a sequel
command constructor and we need also
need to specify the connection object on
which we want to execute this sequel
command now let's create a data table
object and the reason why we are
creating data table object here is
because notice that within the grid we
control we want to compute this column
now if we bind directly the table to the
grid we control we only get you know
those so columns within the grid we
control now what we're going to do is
load this data from the database table
into a data table and then based on the
data that we have we are going to
compute whether if the employee is
eligible for gradually or not add it to
the data table and then bind that data
table to the grid view control and we're
going to make use of this date of
joining column you know to check the
tenure of the employee okay
so let's select visual studio now so we
want a data table here let's call it DT
and notice what columns we want in the
grid we control we want all these
columns serial number employee code name
date of joining and eligible for
graduate so we need to add those columns
first to the data table so we need to
specify the structure
table so data table dot columns dot add
and there are several overloaded add
methods I'm going to use this one where
we can specify the column name so the
first column here I is going to be
serial number and similarly let's
specify the other columns and to speed
things up I've already typed that code
as well so we need to add columns for
the rest of the columns within the grid
we control so let's copy and paste that
right here so we add an employee code
name date of joining and eligible for
graduating
okay so we have the data table now so
let's open the connection and then let's
create an instance of sequel data reader
let's call it RDR and execute the
command
all right so that should execute the
command and should bring back the
results let's use a while loop here so
while we are reading the data so when we
read each row we want to create you know
a table row for this data table and then
move the data from data reader into that
data table okay
so first we need to create an instance
of the data row so let's say data row
let's call it D R equals D T dot new row
so now this row is going to have all
these columns okay and we are going to
populate the values by retrieving them
from the reader object so I'm going to
say d r of the first column a serial
number so dr of serial number equals we
are going to get that from RDR the
reader object idea of what is the name
of the column within the database it's
called serial number without a space so
let's copy that column name and then
paste it right there okay similarly we
need to populate values for employee
code name date of joining and eligible
for graduating and to speed things up I
have already typed the required code so
let's copy it and paste it right here so
again if you look at this code it's very
straightforward employee code retrieve
it from reader similarly named retrieve
it from reader and date of joining
retrieve it from reader
now this eligible for graduating we
don't have it in the database table we
need to compute that okay and how are we
going to compute that depending on date
of joining okay so the first thing that
we need to do here before we proceed any
further is to write a private function
which is going to take the hire date of
the employee and then compare that with
the current date and time and see if the
employee has completed five years and
then it's going to return s are no
string so to achieve that let's actually
have a private function here which is
going to return a string and let's call
it is eligible
for graduating and to this we are going
to pass day time let's call it hire date
or date of joining okay so now what
we're going to do is I'm going to create
a variable of type double and let's call
this difference in days so what we are
going to do here is we have the
employees hire date now we are going to
subtract that from today's date and how
are we going to get today's date we can
use date time dot now that should return
us today's date so from that subtract
the hire date okay so when we subtract
two dates what are we going to get in
dotnet we get something called time span
and the time span object has got this
day's property which is going to give us
the difference between you know today's
date and the date a given employee is
hired okay so now we get we are storing
that difference in days in this variable
and everyone knows that in linear
we have 365 days except for leap here
which has got 366 days so and our
business rule says if an employee has
completed five years then he is eligible
for gradua t so what we're going to do
here is a simple if condition if this
difference in days if that is greater
than or equal to 5 into 365 days which
is 5 years then we want to return yes
yells Shaytan now
so pretty straightforward code here okay
so now we are going to use this function
within the page load event so what we're
going to do here is D are off what is
the name of the column eligible eligible
for graduate a and we are going to
retrieve date of joining from the reader
object and then pass that to this
function so let's call this function
here is eligible for gradua t it expects
hire date to be passed in as date time
but this reader is going to return that
as an object so we need to type gas that
to daytime okay and this method is going
to check compare their hire date with
today's date and then it's going to say
yes or no so that's how we're going to
retrieve you know whether if an employee
is eligible for graduate or not so here
we have the data row the next step is to
actually add it to the data table so we
have the data tables or data table dot
rose dot add and we want to add this
data row where we have column values
and then while that is done we can
safely close the connection so
connection dot close and then grid-view
dot data source equals data table which
is DT and invoke data bind method
alright so let's go ahead and run this
now so now within the grid view control
we should also get eligible for
creativity column and look at that it
says yes and no depending on this tenure
now if you look at this date of joining
here it is also displaying the time
factor that's actually get rid of that
so now this date of joining
we need to typecast that to be of type
date time and then let's convert that to
short date string so let's go ahead and
run this one more time and this time we
shouldn't have time there so notice that
eligible for graduate eight says yes or
no depending on the tenure now the other
requirement is we want to highlight
those values you know wherever we see s
for this column with a different color
okay so let's see how to achieve that
now we're going to make use of data
bound Eve and row data bound event for
this and to get to that event you know
go to the properties of the grid view
control click on the events icon and
there you should see an event called row
data bound double click on that it
should automatically generate the event
handler so here you know when the you
know row is being data bound with the
grid view control that's when we
determine the value of that cell and
then we change the background color and
it's very easy to do so we are going to
use the parameter that's coming into
this even handler method notice that
here we have grid we rule event
arguments object e so e dot Rho dot so
this row is going to return as the row
that is being bound to the grid we
control and then we can easily retrieve
this cell value and check whether if it
is yes if it is yes then change that
cell
grond color to green it's as simple as
that so we have the rule so e dot Rho
dot Rho type so the first thing is we
need to check if the rule type is
actually data wrong because we don't
want to be changing colors within the
header and footer in our grid B we don't
have a footer but we don't want to do
anything if it's the header row that is
being data bound that's why we have this
check here if it is data row then what
do we want to do so we want to say e dot
Rho dot so within the row which cell is
this one zero one two three and four so
this is the fourth cell so e dot Rho dot
cells of four okay if the text within
that shell equal to yes then we want to
change the background color of that cell
so I'm going to copy that and then say
back color equals system or drawing the
color dot whatever color you want so we
want a local ax and that's what we are
specifying here so now let's go to and
run this and see if we get the output
that we expect so notice that you know
where wherever we have yes it's
highlighted with yellow color now is
this the best way to write this code
maybe not because here you're using
column indexes you know it fine it's
going to work fine but then just imagine
what's going to happen if somebody is
going to add new columns or remove the
existing columns from this grid we
control then the application will either
crash or it will not work depending on
the change that we are doing let's say
for example the business requirement is
we don't want to display this employee
code anymore within the grid we control
so if that's the case what we need to do
what's the change that is required we
will simply come here and then comment
out that line employee code we also will
comment this line right here and then
when we run this notice that the page is
going to crash with an index out of
range
that's because we don't have any sell
now with index 4 okay so when we add new
columns or remove the existing ones you
know if you use our hard-code index
numbers like this you know the
application may not work the way you
want it to work okay so another way to
actually write this code is like this as
you can see here so again it's the same
condition we are checking the rule type
is data row which is very similar to
what we have here and then we are using
the same parameter which is coming into
this event handler which is e e dot Road
or data item so that property is going
to return something called data row view
okay so we are using that data row view
and on that there are chain of
properties like data view so we have
from data row view we're going to data
view and then we are going to the actual
table that is bound that could be
control and then we are checking the
column okay eligible for gradua t okay
so give me this column ordinal that is
the index position of the column within
that table so we are dynamically getting
the column index and then once we have
the column index we are then using that
column index okay and then we're
comparing the value is it yes if that is
the case then again look at that within
cells we are not hard-coding the number
we're using the dynamically computed
column index okay so if we do it this
way we are not going to have runtime
errors like this when new columns are
added or when existing ones are deleted
let's actually look at that in action so
what we're going to do is actually
comment this
let's copy that so f e dot Rho dot Rho
type equals data row so that does not
change the same line now what we're
going to do is use the e object a dot
Rho dot data item now if you look at
what this property is returning it's
actually returning an object but we know
it is going to return something called
data review so let's store it in a
variable of type data review let's call
it D away okay so we have this data
review now what is the next step after
we have the data row view we need to
compute the column index of eligible for
graduating and the way we do that is by
using this chain of properties here so
from the data row view we go to data
view and then from there we go to table
and then from there we go to the columns
within that table and we specify the
name of the column so the name of the
column here is going to be eligible for
gradually that's what we have specified
within the data table and we want the
column ordinal which is going to return
the index position of that column within
the data table so let's call this and
and let's call it column and x equals
that okay so now we have column index
what we can do is instead of hard-coding
numbers like this we can simply say if
dra off look at this here we need to
specify the column index so we are going
to pass this column index if d of a
whatever value in that you know column
convert that to string and if that is
equal to yes
then we know what we want to do we want
to change the cell background color so
you don't row dot cells off again
instead of hard-coding the number like
that we can pass the column index there
so back color equals whatever all right
so now when we run this notice that the
lines are still commented so we're not
displaying employee code so when we run
this it should actually work now because
we are dynamically computing the column
index that is the index of this column
eligible for graduating now let's
reintroduce that column so before we run
that notice that we don't have employee
code there so let's run this one more
time now look at that employee code is
displayed but still the application
doesn't crash eligible for graduated
column work the way it has to that's
because we are not hard coding column
indexes instead we are dynamically
computing that right that's it for today
thank you for listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>