<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>SqlDataReader in ADO.NET   Part 8 | Coder Coacher - Coaching Coders</title><meta content="SqlDataReader in ADO.NET   Part 8 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>SqlDataReader in ADO.NET   Part 8</b></h2><h5 class="post__date">2012-10-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/EzwBuqILfds" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so welcome to prism technologies I am
venket this is part 8 of hey do dotnet
video series in this session we'll learn
about the purpose of sequel data reader
creating an instance of signal data
reader reading data using sequel data
readers read method before continuing
with the session I strongly recommend to
watch parts 5 6 &amp;amp; 7 of this video series
sequel data reader reads data in the
most efficient manner possible so if you
ever have a need to read large amounts
of data within your application sequel
data reader should be your choice sequel
data reader is read-only and forward
only meaning once you read a record and
go to the next track or there's no way
that you can go back to the previous
record meaning if if I'm reading 10 rows
from the database if I have read the
first record and if the cursor has moved
to the second record then there's no way
that you can go back and read the first
record again so it's read-only and
forward only read-only meaning you
cannot use sequel data reader to change
the data okay so this forward only
nature of sequel data reader is what
makes it more efficient okay so see and
another important thing is that sequel
data reader is connection-oriented
meaning it requires an active and open
connection to the data source while it
reads the data an instance of a sequel
data reader cannot be created using the
new operator this is very important to
keep in mind let's actually look at that
in action so here I have a table called
TBL product inventory which which has
got these three columns Product ID
product name and unit price I want to
display this data in a grid view control
in an asp.net web application so I have
a simple asp.net web application here
and within the web config file I have
the connection string to the database so
the name of the connection string is DB
CS so obviously we need to read this
connection string in our web application
and to do that we use the configuration
manager class and the configuration
manager class is present in system dot
configuration namespace so make sure you
import this namespace before actually
using configuration manager class so
configuration manager dot connection
strings is the property to which we have
to pass
in the name of the connection string and
the name of the connection string here
it's DBC s so DBC s dot connection
string so that gives the connection
string so let's create a variable called
cs standing for connection string and
store that within that now we need to
create a connection object and to create
that I'm using the using block using
block ensures that the connection is
properly closed in a timely fashion as
soon as the connection object goes out
of scope it gets automatically closed we
don't have to explicitly call the
connection dot close method if we are
using the using block so sequel
connection con is equal to new sequel
connection and to this constructor of
sequel connection class we have to pass
in the connection string so let's pass
connection string alright so we have the
connection that's required the next
thing is basically to open the
connection so let's call connection dot
open and now we need to prepare the
sequel command that we want to execute
using the sequel command class so sequel
command CMD is equal to new sequel
command and the constructor of sequel
command takes in two parameters the
command that we want to execute and
under connection on which you want to
execute that command
so obviously the command that I want to
execute is this sequel command so let's
copy that and pass it to the constructor
of the sequel command class and the next
parameter that it expects is the sequel
connection object which we already have
here so let's copy that and paste it
here we have spoken about the sequel
connection and sequel command objects in
the previous sessions of this video
series so if you're new to them and if
you don't understand what we are doing
here please check those video paths
first before you continue with this
session all right so we have this equal
command object now the next thing is
obviously to execute the command but
then before that let's create a sequel
data reader object usually to create any
object we say for example here we're
creating an instance of sequel
connection class the way we are doing it
we are using the new operator and then
obviously a constructor of that class so
signal connection con is equal to new
signal connection class so we are using
the new operator to create an instance
of this class but can I do the same
thing for sequel data reader let's see
what happens if we try to do that so
sequel data reader Rd R is equal to new
sequel data reader okay now let's build
the application go to the build menu
build solution and let's look at what
happens look at this we get a compiled
Asian error stating that systems or data
dot sequel client dot sequel data reader
has no constructors defined meaning it's
complaining that you basically cannot
use the new operator to create an
instance of sequel data reader because
it doesn't really make sense okay so I
mean what will you do with with this is
of no use when I I mean why do I ever
need a reader I need a reader to read
data from the database so obviously the
command dot execute reader method
executes the command creates an instance
of sequel data reader loads it with data
and returns that back to you okay so
that's why if you ever need to create an
instance of sequel data reader you
generally don't do that using the new
operator you do that using the execute
reader method of the command object so
command dot execute reader and if you
look at the return type of this execute
reader method its sequel data reader
object which means the execute reader
method is going to create an instance of
sequel data reader for us okay so we got
the reader object so that's what is
important to keep in mind an instance of
sequel data reader cannot be created
using the new operator the sequel
command objects execute reader method
creates and returns an instance of
sequel data reader and another important
thing to keep in mind sequel data reader
is connection oriented and the
connection needs to be opened explicitly
by calling the open method on the
connection object before calling the
execute reader method of the command
object otherwise you will get an error a
runtime error stating that an open
connection is required so here if you
look at this one if you don't open the
connection
if you try to execute the statement you
will get a runtime error and not a
compile time error so the sequel data
reader requires an active and open
connection when it actually reads the
data that's why you have to explicitly
call the open method on the connection
object before you do that but there is
another way to access data which is
using data adapter and data set
it's called disconnected data access
model which we will be talking about in
our next video session all right so we
execute the command we get the reader
and let's say I want to display this
data in a in a grid view control so
obviously we need a grid view control
let's drag and drop it from the tool box
so I have the grid view control and to
make it look better auto format that
select one of the schemes that are
predefined okay so I have the grid view
control whose ID is grid v1 let's copy
that let's go to the code-behind file
and let's say grid v1 dot data source is
equal to Rd R so we are setting the data
source of the grid view control to this
reader and finally call grid v1 the data
bind okay so obviously now if we run
this application you know the data gets
read from the database using the reader
object and that will be displayed in the
grid view control as expected okay so we
get all the columns and rows fine but
there's one thing that we still need to
do here we are closing the I mean we are
not closing the connection but we have
wrapped that inside a using block so
this connection is going to be
automatically closed as soon as the
scope is lost just like how you are
closing the connection sequel data
reader also needs to be closed in a
timely fashion to ensure that your
application is scalable and performing
better so when you use a sequel data
reader object make sure that gets
properly closed okay so obviously to do
that what you can actually do is you can
wrap that inside another using statement
so using sequel data reader RDR
is equal to wrap that inside this using
block so what's going to happen as soon
as the scope of this RDR object is lost
that will be closed in a timely fashion
okay so basically there are two ways to
close a reader or a connection object
one way is to obviously use this using
block which will automatically close the
connection and the reader we don't have
to call explicitly the close method on
those objects another way is to use the
finally block finally block is
guaranteed to execute irrespective of
whether there is an exception or not so
the connection or the reader if you wrap
that close call on these objects within
the finally block they are guaranteed to
be closed okay all right so basically
this is the simplest way of binding a
reader object to a data source
I mean to a grid view control but then
let's say if there is ever a need for
you to loop through each row within the
reader and then if you want to perform
some row by row processing
okay then how do we loop through you
know all the rules that are available in
the reader how do we do that in sequel
data read I mean in sequel data reader
class there is a read method that we can
actually use to loop through each row in
that reader let's see how to do that
actually what we will do is if you look
at the table that we have here it's got
it has got product ID product name and
unit price columns now what I want to
basically do is in the grid view control
I want to display those columns you know
the product ID name unit price and along
with that I also want to show the
discounted price let's say we are giving
a 10% discount I also want to show the
discounted price 10% on the actual unit
price so I want to do at row by row
processing here which means I have to
loop through each row in the reader
object in the sequel data reader object
so how do I do that using the read
method of the sequel data reader object
so let's see actually to achieve this
okay so now I don't want to directly
bind the result of this reader to the
grid view control so
comment that for the time being we'll
come back to that in a while so I want
to loop through each row in this reader
object so how do we do that we can use
the read method
so while RDR is the instance of sequel
data reader dot there is a read method
and look at the signature of this read
method it returns a boolean value a true
or a false this method is going to
return true as long as there are rules
in the sequel data reader object the
moment it comes to the last record and
if there are no more records to read
within the data a sequel data reader
that's when it return false and it comes
out of the while loop and within the
while loop you can actually perform the
row by row processing that you want to
do okay but before that what I want to
so obviously I want to do a row by row
processing and then store the processed
rows in a separate table so I want to
create a data table okay
so that I can store the processed rows
within that data table and to create the
data table I can use data table and
another important thing to keep in mind
this data table is present in systems or
data namespace so you need to import
that namespace using system data okay
so data table let's call this table is
equal to new data table and if you look
at the output how many columns you want
in the output I want four columns so you
want to add these columns to that data
table and the way to add columns to that
table is table dot columns dot add and
then you can specify the name of the
column okay so let's say ID and
similarly I want the column four name of
the product unit price and the
discounted price so let's call this name
let's call this price and the final
column as discounted price okay so we
have all the columns that are required
now what I'm going to do I'm going to
create a new row within this table so
I'm going to say table dot new row there
is a method called neuro which will
return if you look
the return type of this new ro method
it's going to return at data row so
let's create a variable which can hold
that data row so data row let's call
this data row okay so we have the data
row now what we want to do is first
compute the discounted price so how do i
compute the discounted price first let's
get the original price so int original
price is equal to where do I get the
original price from look at this while
RDR dot read this read method reads the
first record and returns it within this
while loop so it reads the first record
at the first time so RDR and look at
this there are two ways to retrieve the
column values one is to use the integral
index ax you can pass 0 1 2 but then
your code will not be much readable if
you do that or you can use the string
column names so if you look at the
column names you know the unit price
column name is unit price so I'm going
to pass unit price okay always use
column names because it makes your code
more readable and and hence more
maintainable and obviously we know that
unit price is an integer so we need to
convert that to integer so convert win32
alright so we have got the original
price and then let's say we are giving
10% discount so we want to calculate the
discounted price so discounted price so
how do we compute the discounted price
if if we are giving 10% discount then
the discounted price will be 90% of the
actual original price so I'm going to
multiply this original price with point
zero nine and obviously if you multiply
that with point zero nine you will get a
double so let's make this data type
double okay so we have the discounted
price and the original price all we have
to do now is to populate the data row so
data of ID is equal to we need the
original ID from the reader so I'm going
to take that so what's the column name
product ID let's copy that paste it
there and similarly you need to you need
the values for name column so name and
what is the original column name product
name so we're going to pass that here
and finally the unit price and in the
data or the column name is price so
paste that there and finally I want the
discounted price and discounted price is
not coming from the database we are
computing that in the code and where do
we have that we have that here
discounted price and actually instead of
passing instead of getting it again from
the reader since you have already got
the original price I will use that
variable and populate this and another
important thing that we need to do so
you created a data row you populate the
column values for that row so obviously
you need to add this row to this table
so we're going to say table dot rows dot
add so to the rows collection of that
table add a new data row do we have a
data row we do have a data also copy
that and pass to the sad method which
will be added to the table so now what's
happening here it will process each
record within the reader and then add it
to this table that we have created and
then what we are going to do now we are
going to use this table as the data
source for our grid view control instead
of the reader object I am going to use
this table that's it uncomment these two
lines now if we run look at this the
what we are doing here essentially is
looping through each record within the
data reader object and how are we doing
that you
in the reed method okay so let's run
this and see if we get the discounted
price so the output should be like this
the actual price and the discounted
price so we get the original price
discounted price now you might be
wondering do we really have to do so
much to actually display the discounted
price you know in reality you don't have
to do this you can you can slightly
modify your query and this all this code
would be gone okay let me actually show
you you know the best way of calculating
the discounted price you can actually
you know change that in the query so you
have the unit price and then unit price
multiplied by 0.2 soul thing will give
you 10% discounted value so as give it a
meaningful column name discounted price
so if you look at your query you're
getting discounted price now what you
can do execute this query and bind the
reader to the grid view control let me
show you that so let's close this first
so all that code will go away what I
want to do I can take this reader and
bind that directly and we have to change
the query so let's copy that query
instead of this one let's paste that so
now if I run the project you know you
will see the discounted price as
expected but then why did we use read
method I know that is just to
demonstrate you know how to actually
loop through each row in sequel data
reader it's possible using read method
but then the same thing can also be
achieved by modifying your query usually
with an ad or dotnet there will be more
than one way to do it so depending on
your situation depending on what we are
trying to achieve we choose one method
over the other but the idea here is to
understand that it's to loop through
each record in a sequel data reader
object use the data readers read
method on this slide you can find
resources for asp.net c-sharp and sequel
server interview questions that's it for
today thank you for listening</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>