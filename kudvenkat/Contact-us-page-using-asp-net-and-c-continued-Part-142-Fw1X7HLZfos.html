<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Contact us page using asp net and c# continued   Part 142 | Coder Coacher - Coaching Coders</title><meta content="Contact us page using asp net and c# continued   Part 142 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Contact us page using asp net and c# continued   Part 142</b></h2><h5 class="post__date">2013-08-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Fw1X7HLZfos" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 142 of asp.net tutorial in
this video we'll discuss implementing
contact us page using asp.net and C
sharp in part 141 of this video series
we have discussed designing the contact
us page please watch but 141 before
proceeding with this video in this video
we'll be implementing the server-side
code so when we click this submit button
we want to send the details that the
user has entered in this form to the
administrator of the website so
basically here we have a sample email
that is sent to the administrator and
notice that whatever details that we
have entered on this form are present in
this email that is sent to the
administrator for example here the
subject is test subject and that is
present in the subject line of the email
and then the name email and comments are
present within the body of the email
let's see how to implement this let's
flip to visual studio so this is the
project that we have been working with
in part 141 so when I click this button
that's when we need to send the email
okay so to send an email we need to
compose mail message object and this
mail message Clause is present in a
different namespace system net mail so
let's bring that in and then we don't
need these other namespaces here so
let's get rid of them to keep code
simple alright so let's go and build a
mail message object and let's call this
reference variable as mail message so
obviously to send an email we need the
from and to address in this case the
from and to are both going to be the
administrator email address because
we'll be harvesting the values from the
form and then we'll be sending an email
to the administrator okay so and if you
look at this from property what does it
expect it expects an object of type mail
address so let's go and create a new
mail address object and then the
constructor of this
expects an email address to be passed so
here we give our gmail address so let's
say I'm giving my gmail address here and
then we also need to specify the to
address so I mean you can send that
email to multiple people so you can have
multiple two addresses so if you look at
this to a property it's actually a mail
address collection so you can have as
many two emails as you want but I just
want to send the email to the
administrator of the site so I'm going
to add an email to the mail address
collection property of this mail message
object and look at this there are
several overloaded I mean two overloaded
versions of this ad method I'm going to
use this overloaded version maybe can
specify the email address as a string so
I basically want to send an email to the
same address so we are going to send an
email from this address to this address
so we are going to send an email to
ourselves but with the details that the
end user has entered on this form all
right so we have specified the from and
to address the next thing is to specify
the subject so mail message dot subject
and where are we going to get the
subject the subject is going to come
from the subject text box so txt subject
dot text and then the next important
thing is the comments that the end user
has entered so I mean basically not only
comments we need to send name email and
comments as part of the body of the
email so we need to specify the body of
the email so let's go ahead and set the
body mail message dot body and if you
look at this body it's nothing but a
string so we need to build our string
okay so the body if you look at the body
of the email first we need sender name
and that should be bolded so let's
include
a bold tag and then this text sender
name
all right and then to that we need to
concatenate the name of the sender so
where are we going to get the sender
name from this textbox
txt name so let's go ahead and retrieve
the name of the person who is submitting
this form and then once we have the
sender name you know sender email should
be in the next line so we need to
include a break there so let's go ahead
and include an HTML break all right so
let's copy this so to that we need now
sender email and the email itself so let
me paste that and we will change this as
required so send an email and again that
will be bolded and valid where are we
going to get the email from from email
text box and then once we have the
sender email next finally we need
comments and where are we going to get
the comments from comments textbox so
comments and we are going to get the
comments from comments text box okay so
we can get rid of this break right here
all right so we have composed the mail
message board a but then look at this
the body of this email contains some
HTML as well so we need to tell that the
mail message object that its body
contains HTML and the way to do that is
by setting this property is body HTML
and notice that it's a boolean property
so let's set that to true all right so
we have done composing the mail message
itself we have specified from to subject
and the body the next thing is to send
the mail message object and to do that
we are going to make use of another
class called SMTP client again this
class is present in the same namespace
system net dot mail so let's go and
create an instance of this class so SMTP
client is equal to new SMTP
Klein and this class has got three
overloads but we are going to use this
overload where we need to specify the
host name and the IP address that we are
going to use to send the email so I want
to use Gmail to send an email so I'm
going to use G Gmail's SMTP server name
so here Gmail's SMTP server name is
smtp.gmail.com if you're working for an
organization then most likely your
organization will have an SMTP server
name so you can use that in this case
okay
so the name is going to bei
smtp.gmail.com that's the name of the
SMTP server and the port number is 587
so let's go ahead and include that so we
have the SMTP client now and look at
that
Gmail works on HTTP protocol so if you
look at this Gmail here it's working on
HTTP protocol meaning SSL we need to
enable SSL so there's something called
SMTP client dot enable SSL again that's
a boolean property so let's go and set
that to true and then the final one
thing is we need to specify the
credentials from the account you know
from which we are sending an email so we
are sending the email from this account
so we need to specify the username and
the password so we need to specify the
credentials and to do that this SMTP
client object has called this
credentials a property and we need to
create an instance of you know the
credentials so system dot network
so system net net for credential so
let's go ahead and create an instance of
that object and we need to specify the
username and password so the username is
going to be your gmail ID in this case
it's going to be my gmail ID and then
the password so we need to specify the
password I'm not going to type that then
here but then in your case you can
specify your password all right so we
have specified the credentials as well
so the next step is to basically send
the email itself and to do that so this
SMTP client object has got the sender
method so to the send method you give
your mail message object that function
is going to send the mail message to
whomever you have specified in the to
list at the moment we only have the one
user who is nothing but the
administrator of your site okay all
right so we have sent the email once we
have sent the email what we need to do
we need to you know convey that status
information to the user maybe we want to
display this message thank you for
contacting us and we have a label
control on the form so that's labeled
one control so that's the label we are
going to use to set the status so label
one dot text is equal to something like
thank you for contacting us and then if
you notice we are setting since it's a
success I want to set at the four color
of the label to blue so to do that label
one dot for color is equal to again this
expects a color property which is
present in systems or drawing namespace
let's go and include that system dot
drawing color dot whatever blue or red
whatever you want all right and then the
final one thing that we need to do is we
need to disable all these controls and
the text on the submit button
so basically text name dot enable
is equal to false so we need to do the
same thing for all the other text boxes
and the button control itself so text
name text email text comments text
subject and finally the button one
control okay so now if you look at this
code that's present directly in this
button one click event so if everything
works fine that's fine but if there is
an exception we need to handle that
exception so let's wrap all this code
inside a try-catch block so let's put
that inside a try block and then if at
all if there is an exception we want to
catch the exception obviously this
exception object is going to contain the
information about the exception that has
occurred and then we basically the log
the exception information either to the
event viewer or to a database table okay
so that the administrator can later look
at that exception and fix that error
okay and obviously if there is an
exception we were not successful in
sending an email so what we need to do
then we need to display a meaningful
message to the user you know something
like there is an unknown problem
please try later in a meaningful message
to the end-user and then since we were
not successful in sending the email
maybe I want to set for color to read
all right
okay so now if we go ahead and run this
we should be able to send an email now
I'm not going to do that now you know
this will not be successful at this
point of time because we haven't
specified the password but if you
specify your password you should be able
to send an email successfully in fact
look at the email you know I have
successfully received the email I have
the test subject Center named sender
email and the comments that I have
entered on the form all right now
another important thing to keep in mind
here is look at this we are relying on
the client-side validation to validate
the form this form
now this client-side validation works
only if javascript is enabled but we can
disable the JavaScript so if you disable
JavaScript then you know client-side
validation doesn't work and obviously
the click event on the server will be
executed so even if you don't enter the
values for the required fields you know
this code will try to be executed we
don't want this code to be executed if
there is an exception I mean if if the
user hasn't provided all the values here
so to ensure that this code is not
executed unless until the validation has
succeeded what I'm going to do is I'm
going to check if page dot is valid
property so this property is going to
return true only if all the validation
controls have succeeded if even one
validation control fails validation then
this property is going to return false
in which case none of these code will be
executed and the end user will continue
to have these error messages messages
displayed because the validation
controls that we have in asp.net they
provide both server side and client
side validation so if javascript is
enabled client-side validation will
continue to work as normal but if
javascript is disabled in a client-side
validation doesn't work but since we are
checking is valid property in the button
click event you know this is going to
ensure that only if all the validation
controls have succeeded validation it's
going to execute this piece of code
otherwise nothing will happen that form
will be rear-ended and then basically
the end user will have a chance to look
at the validation error messages all
right that's it today thank you for
listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>