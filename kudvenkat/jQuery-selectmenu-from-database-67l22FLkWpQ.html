<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>jQuery selectmenu from database | Coder Coacher - Coaching Coders</title><meta content="jQuery selectmenu from database - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>jQuery selectmenu from database</b></h2><h5 class="post__date">2015-07-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/67l22FLkWpQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 88 of jQuery tutorial in
this video we'll discuss how to build a
jQuery select menu using data from
database tables here is what we want to
achieve we're going to have these two
database tables the first table is going
to contain countries data at the moment
with in this country stable we've got
three countries the second table contain
cities data so the first three cities
they belong to country ID one country
eighty-one is USA cities four and five
they belong to a country ID two which is
India and the last three cities they
belong to country eighty three which is
United Kingdom using the data from these
two tables we want to build a drop-down
list as you can see here notice we've
got country USA underneath that we have
all the cities belonging to country USA
and then we have country India cities
belonging to that similarly you have UK
and the countries belonging to that now
here we are not using any sort of jQuery
and with jQuery you know jQuery UI
styles will be applied to the drop-down
list and this is how it looks like so
let's see how to build this drop-down
list using data from these two database
tables so in order to build a drop-down
list like this we have to build an HTML
structure that looks like this so we
have a select element and within the
Select element we have got three option
group elements and within each option
group we have the cities belonging to
that specific country so first we have
USA and all the cities belonging to us a
value is the country ID and the label is
nothing about the name of the country
everything coming from the database so
let's see how to build that this HTML
structure using the data that we have
got in countries and cities tables so
the first step here is to create the
store bills which I have already done so
here's the sequel script so this script
is going to create the tables and
populate them with the data that we have
seen on the slides I'll have all this
sequel available on my blog in case you
need it the next step is to create a
stored procedure which is going to
retrieve data from countries and cities
table I've already executed the script
so when we execute the stored procedure
we
should get data from country stable and
city stable now let's flip to visual
studio here I have an asp.net web
application project within the web
config file I have included a connection
strained at our sample DB database which
contains our database tables now let's
slip to webform one so within the
code-behind file we need to write ad or
dotnet code to retrieve data from the
database tables so the first thing that
we need to do is read the connection
string from web config file i've already
included the area dot namespaces that we
would require system dot data systems or
data or sequel client and system drop
configuration so let's go ahead and
create a variable of type string and we
are going to use configuration manager
class to read the connection string from
the web config file the name of the
connection strength within web drop
config file is DB CS so let's go ahead
and read that connection string the next
step is to create a sequel connection
object so using the connection string
that we have read from the web config
file we are going to create the sequel
connection object now let's go ahead and
create a sequel data adapter object and
using this sequel data adapter object we
are going to execute this stored
procedure so let's copy the name of the
stored procedure and I'm going to use
this overloaded version of the stored
procedure where we tell the command that
we want to execute and the connection
that we want to use in order to execute
that command so the command that we want
to execute is the stored procedure and
the connection that we are going to use
is this connection object and since this
is stored procedure we have to tell that
to the data adapter object so I'm going
to say D a dot select command dot
command type equals command type dot
stored procedure now let's go ahead and
create a dataset let's call it D s and
I'm going to call the SIL method of the
data adapter object retrieve the data
and fill that in
data set so now this data set is going
to contain those two tables which are
TBL countries and TBL cities now let's
go ahead and create two classes to
represent these two tables so first I'm
going to add a city class so let's go
ahead and add a class file let's call
this city dot CS and this class is going
to contain three properties the first
property is going to be of type integer
let's call it ID and the second property
is going to be of type string and this
is going to store the name of the city
so name is the property and the third
property is going to be of type integer
and this is going to represent country
ID then let's go ahead and add another
class file and let's call this country
dot CS
so again country class is going to
contain ID name of the country and a
country contains list of cities so here
I am going to create a property of type
list of city and let's call this cities
and let's have the default get and set
accessors okay so country is also going
to contain a collection of cities that
belong to a given country
okay so we have caught city and country
classes now back in our code behind file
so let's save all these changes so
within our code behind file I am going
to create a list here a list of country
and let's call this list countries
equals new list of country actually what
I'm going to do is move all this code
into a private function and we can call
that function wherever we need so I'm
going to cut all this code and then
create a function here a private
function and this function is going to
return list of country objects and let's
call this get select menu data and I'm
going to paste the code which we have
written so far okay so finally this
function should return list of country
objects alright so we have a variable
here which is going to store a list of
countries so now I am going to use this
this data set now contains rows of both
the tables in our TBL country and TBL
cities so let's use a for each loop here
so for each data row let's call this
country row n we know that the tables
collection in the data set the first
table is going to be country's table so
da store tables of 0.01 to loop through
each data row that is present within the
TBL countries table within the data set
so what do we want to do we want to
retrieve the country ID name and then
list of cities and then populate that
with in this list country so object so
first I'm going to create a country
object let's call it country equals new
country and country dot ID so how do we
give the ID we can use this country row
as we are looping through each raw
country row of ID and the ID is an
integer property so let's go ahead and
convert that to an integer so convert
dot to n 32
similarly we need the country names
country dot name equals country row that
we are looping over and name is the
column and dot to string okay now we
need the list of cities that belong to a
given country to get the list of cities
we'll have to retrieve those rows from
city's table and cities root table is
again present within this data set so
I'm going to say data set the tables of
one so the second table within the data
set contains cities data dot I'm going
to use the Select function here and
using this function we can actually
specify a filter so we want to filter
out all the rows and retrieve only the
cities that belong to the current
country that we are currently iterating
over and to get the ID of the country we
can use country dot ID property which we
have already populated right here so I'm
going to say country ID equals whatever
value we have you know in the ID
property of the country object and let's
convert that to a strength so what is
the Select method going to do look at
the intelligence it's going to return us
an array of data row objects so I'm
going to create a variable here data row
and these are City rows right
or let's simply call it cities so we
have within this object we have the
cities that belong to the country that
we are currently iterating over okay so
now I'm going to use another for each
loop here for each city for each data
row let's call the city row n cities so
this contains B cities that belong to
the country that we are iterating over
now we are looping through each city
object and what do we want to do we want
to create a city objects let's call it
city equals new city and we want to do a
similar thing we want to retrieve city
ID city names I'm going to simply make a
copy of that and instead of country here
I'm going to say city dot ID equals we
have to use the city row city row of ID
we want to convert that to integer
similarly city dot name equals city row
of name dot to strain and city also has
got country ID so let's go ahead and
populate that city dot country ID equals
convert dot two and 32 city row off
country ID so we have built the city
object here now another thing that we
need to do outside of this for each loop
is create a list of cities object which
is going to store all the cities that
belong to a specific country so I'm
going to create a list of City object
here let's call this list cities equals
new list of City and as we are looping
through each city we want to build a
city object and add that city object to
list cities so less the cities tour to
add the city object that we have just
constructed okay by the time this loop
finishes you know we have gathered all
the cities that belong
to the country that we are iterating
over in this object so all that is left
now is to populate cities property of
the country object so country dot cities
equals whatever we have within this list
cities object okay so that's it
so the first loop is going to look
through each country row the second loop
is going to look through each city you
know that belong to a given country and
then we have the country object with all
the information that we need and if you
look at what this function is returning
its returning list of country object and
we have already constructed an object
with list of type list of country all
that is left is to return that object
okay so finally let's go ahead and
return list
countries so we have a private function
get select menu data which is getting us
the data that we need from the database
table now let's go ahead and build the
HTML structure that we would require so
this is the HTML structure that we want
to build using the data that we have
retrieved from the database to build
this HTML structure I'm going to use two
repeater controls so let's drag and drop
the first repeater control so from the
toolbox I'm going to drag and drop this
repeater control let's call this repeat
countries so we're going to bind this to
countries okay so within this repeater
I'm going to have an item template all
right now what is the HTML structure
that we want this is the HTML structure
so the first thing that we need is a
select element so in order to get that
select element I'm going to hard-code
that so the first thing is select
element outside of this repeater I'm
going to have a select element give it
an ID let's call it select menu and this
repeater is actually going to be present
inside this select element so we have
the Select element inside that we have
the repeater
repeater has got the item template and
within the item template so what do we
want within the repeater we want option
groups within the repeater okay so I'm
going to include an option group element
inside the item template so opt group
and I'm going to set the label property
label equals so what do we want as the
label for the option group we want the
name of the country okay so how are we
going to get the name of the country now
we are going to bind the data that this
function returns so what is this
function returning it's returning list
of country objects so we are going to
bind the data to this repeater so
repeater countries the data source
equals get select menu data and then I'm
going to call data bind function okay so
we have bound you know list of country
objects to the repeater so now that list
of country object you know if you look
at the country object it has got the
name property which contains the name of
the country so that's what we want to
bind to this label attribute of the
optic group element so I'm going to use
the data binding syntax here so angle
brackets percentage hash and we are
going to use the eval function and we
want to bind to name property of the
country object okay so this item
template will be executed for each row
that we have for each object that we
have okay so that's going to take care
of building these up to group elements
but within each or up to group element
we want the options which will contain
the date of the kind are cities that
belong to a given country so in order to
build these options of each option crew
I'm going to use another repeater so we
are going to have a nested repeater so
I'm going to place a repeater inside
this opt group element so let's drag and
drop another repeater control so inside
the top two
group element we have another repeater
here and I'm going to call this repeater
city's okay so we are going to bind this
repeater to the cities that are present
within the city's property of the
country object so I'm going to also set
the data source attribute of this
repeater so data source equals I'm going
to bind the data source property of the
repeater to city's property within the
country object so let's copy this let's
use the eval function and instead of
binding to name property I'm actually
going to buy into cities property so
here we have specified we are going to
bind this repeater to cities collection
all right now so this is the repeater
which we are going to use to produce
these options so let's go and specify
the option elements so option so again
inside this repeater we have to use the
item template and inside that I'm going
to use an option element and the value
for that so the value for that is going
to come from again we are using the data
binding syntax so here this repeater is
being bound to cities right city object
also has got name property and ID
property okay so as the value of the
option we want the ID of the city so
here I'm going to bind to ID property of
the city object okay and the label for
each option we want the name of the city
so I'm going to again copy this and
inside that option the label we want the
name of the city okay right so that's
the HTML that we would require so with
this let's go ahead and save all our
changes let's run this so now at the
moment we are not using any jQuery code
so we have only written the area
netcode asp.net and look at this we
don't get anything within the drop-down
list let's see why is that so we have
the repeater countries here and we have
bound repeater countries too you know we
have set the data source to whatever
this function returns but at the moment
for some reason this webform is not
displaying any data let's investigate
why let's first of all see if the stored
procedure is returning the data yes the
stored procedure is returning data let's
quickly see if we are actually getting
data you know when we call the stored
procedure from our dotnet application so
I'm actually going to throw in a
breakpoint here run the application in
debug mode so when the stored procedure
is executed we should be able to bring
the data into a dotnet application so we
have hit the breakpoint so we have the
data set object here so I'm going to you
know view the data in data set
visualizer look at look at that we are
getting the data into the dotnet
application as well now let's throw in
another breakpoint here and see if the
data is actually being returned so at
the moment we have breakpoint here and
the execution has stopped right here so
I'm going to plus a 5 and if we look at
list countries look at that for some
reason
list countries count is 0 let's see
why's that so where are we creating list
countries object so here we have list
countries and look at that we have
created the country object we populated
the country ID country name and then we
are creating the list of cities that
belong to each country but what we have
forgot to do is add the country object
to this list that we have created so
let's go ahead and do that so let's
detach the debugger and all that we have
to do
is to list countries we have to add the
country object that we have constructed
so let's go ahead and add that to list
countries now let's go ahead and run
this once more and now we should get the
data that we expect so notice that we
have you know the city names I mean the
country names and that each country name
we have the cities that belonging to
that respective country and at the
moment we didn't use any jQuery code at
all okay so now let's go ahead and use
jQuery select menu so the ID of the
select element here is select menu so
let's use the jQuery ID selector find
the Select menu and on that I'm going to
call select menu function so let's save
the changes let's run this and look at
that now the width of the drop-down list
you know we want to set the width and to
do that I'm going to use the width
option so with let's set it to maybe to
200 pixels and let's also say we want to
retrieve the selected item value and
label so I'm going to hook up this
select event handler so when the select
event is raised this is a function that
gets called and this function is going
to receive two parameters the event
object itself and the jQuery UI element
that triggered the event so I'm going to
use the JavaScript alert and display the
selected item value and label so alert
label equals UI dot item duck label and
to that let's up in space and then we
want the value so value equals UI dot
item dot value okay right so let's save
these changes on this one more time
and look at this when we set up for
example Chicago so label equals Chicago
value equals three now let's put in
select Chennai label equals Chennai
value equals five you are getting the
value but for some reason look at that
you know we've got a lot of space you
know the alert is not quite what we
expect let's see why's that so here
we're getting the city's option maybe it
has got some space you know as the label
so that's why I have removed all those
let's save this and let's run this one
more time and now let's select for
example Bangalore now look at this we
don't have those extra spaces label
equals Bangalore value it calls for
alright so here we have the stored
procedure the city class in the country
class and here we have the HTML and the
jQuery code and finally the code in the
code behind file thank you for listening
and have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>