<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Delete multiple rows from asp.net gridview - Part 28 | Coder Coacher - Coaching Coders</title><meta content="Delete multiple rows from asp.net gridview - Part 28 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Delete multiple rows from asp.net gridview - Part 28</b></h2><h5 class="post__date">2013-03-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/r2V5VXrFoFk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so welcome presume technologies I am
venket this is part 28 of asp.net
grid-view tutorial in this video we'll
discuss about deleting multiple drawers
from grid view control on this slide you
can see checkboxes in the first column
of this grid we control now users will
be able to select multiple rows using
these checkboxes once he clicks delete
all the rows that he has selected should
be deleted let's see have to achieve
this will be using TBL employee table
for this demo obviously to retrieve this
data and then display that within the
grid we control we need employee data
access layer so let's go ahead and add
employee data access layer class file to
this project and let's call this class
file as employee data access layer dot
CS now we want to retrieve and display
employee related information so
obviously to encapsulate this employee
information we need employee class so
I'm going to create a class called
employee so public class employee and
obviously to represent these columns
within the employee table we need
properties in c-sharp so just be to
speed things up I have these properties
already type so let me copy and paste
these properties within that employee
class so as you can see all of these are
auto implemented properties they don't
have special logic within them so
employee ID name gender and city
properties to represent these four
columns that we have in TBL employee
table all right so within employee data
access layer we need a method which is
going to you know retrieve all these
employees and then return them to
whoever is going to call it so I'm going
to call this method as no public static
this method is going to return list of
employees back so list of employee
objects you know the employee object
that we have just created and then I'm
going to call this get all employees so
obviously this method in this method we
need to write a bit of a do dotnet core
so to do that we need some ad or
namespaces systems or data system dot
data dot sequel client and system dot
configuration let's copy and paste them
there and again to speed things up I
have you know this method already type
so let me copy and
is that within you know just get all
employees method and if look at the
implementations against very
straightforward we are creating you know
a list of employees object and then we
are using the configuration manager
class to read the connection string from
web config file and using that
connection stream via creating a sequel
connection object preparing the sequel
command object look at the command
select star from TBL employee so we want
to retrieve all these employees and then
once we execute that command we are
going to retrieve all those employees
and loop through each employee row
create an employee object and then
convert the columns of each row into the
properties of that C sharp object
employee in this case and then we are
adding that employee object to the list
finally once we are done looping through
each row they are actually returning
that list back to whoever is going to
call this method all right so this is
get all voice method which we'll be
using to retrieve and display the data
within the grid view control so
obviously we need a grid view control so
let me drag and drop the grid view
control onto the waveform and let's auto
format that let's choose brown sugar
scheme click OK alright and obviously to
retrieve data all you need to do is
within the page load if not is post back
meaning if it is the initial get request
we want to retrieve the data and display
within the grid we control
so within employee data access layer
laws we have a method called get all
employees which is going to return a
list of employees we want that list to
act as the source for this grid view
control so grid view one dot datasource
is equal to that and then call the data
bind method okay now we will be needing
these two lines of code at several
places going forward so I'm going to
encapsulate these two lines into its own
method so I'm going to have a private
method here private void and let's call
this get data all this method does is
it's going to call you know get all
employees said that as the data source
for the grid view data bind and we are
going to use this method wherever we
need it okay at this time if I go ahead
and run
this as you might expect all employees
data will be retrieved and displayed
within the grid view control but the
important thing to keep in mind here is
at the moment we don't have any columns
that defined within the grid view
control at design-time look at this we
don't have any columns to find all these
are styles okay but then when the
waveform renders look at this it's
displaying employee ID name general city
so where are these columns within the
grid view control are coming from these
are auto-generated depending on what you
have set as the data source for this
crib you control okay so but what I want
to do is I want to define what columns I
want at design-time so I want to call
them for checkboxes I want a column for
employee name gender and city now we
will come in this the first two columns
that has the checkbox in employee ID
these will be template fields and name
gender and city will be bound fills now
the reason why we are making these to
our template fields you will understand
them in a bit okay
but remember we are going to make the
first two columns as template fields and
the rest of three columns name gender
and city as bone fields so let's define
them now okay let's close this browser
window let's go back to visual studio
and the easiest way to add our columns
at design-time is by using edit columns
you know from grid view tasks so the
first two columns I want them as
template field so I'm going to add a
template field look at this for the
first template field in the header I
don't have any header text so I'm not
going to set anything there I'm just
added the template field and I'm going
to add another template field this one
will display the employee ID so the
header tax is employee ID so for that
template field I am going to set add a
text property as employee ID all right
and the rest of three columns are going
to be bound fields name generated city
so let me add those bone fields one two
and three so the first bone field is
going to be named the second bound Phil
is going to be gender and the third one
is going to be City
okay now look at this employee I mean
first column to display check boxes
employee named general city and in
addition to them I have these other
columns you know which I didn't define
but they are coming so why is that
that's because this grid we control has
a property called auto-generated columns
which is true by default I'm going to
set that false because I don't want any
columns to be auto-generated okay now
that solves that problem but look at
this
none of the columns here are actually
data bound so we need to bind them to
data name gender and City should be I
mean employee name gender and city so it
should be bound to these properties of
the employee class employee ID name
gender and city okay and we need to
specify that and to do that I'm going to
go into columns okay first let me do it
for name gender and City because they
are bound columns we can do that within
this head it feels you know dialog box
so here you have a property called data
field so I have select a name the data
field for that is going to be name the
name property of the employee object and
gender data field is going to be gender
and city is going to be City okay so
look at what's going to happen the
moment I click okay so all these are
data bound employee ID is not data bound
let's try to data by an employee ID now
if I click Edit columns look at this
employee ID is a template field now do I
have data field property here no why is
that because for a template field you
need to define your templates only then
will you be able to bind you know data
bind that column okay so first let's
define the templates you know the item
template or had a template you know
whatever templates that we require okay
now if you look at this slide here look
at the first column in the within the
header template we need a checkbox
control as well so we need to define
header template and then item template
in every grid view draw you know we need
check box control and within the header
template I mean header also we need a
check box so we need to define
had a template and item template for the
first column of the grid view so let's
do that so let me go to the grid view
control edit templates and then I'm
going to define the header template for
the first column column 0 so that's
going to be a checkbox there so let me
drag and drop a checkbox control and
then let's give this checkbox a
meaningful name because we are going to
refer to that a little while later so
I'm going to go to the properties of the
checkbox control and then I'm going to
call this CB 4 checkbox and this is this
checkbox is present in the header and
it's used for delete purposes so I'm
going to call this checkbox delete
header okay so that's the first thing
and the second thing I'm going to set
auto post back property to true that's
because you know anytime I select this
checkbox within the header all the other
checkboxes should be selected and also
the webform should automatically post
back to the server so I'm going to set
auto post back to true and a third thing
I'm going to generate an even handler
for this so double click the even
handler I know check box so check the
changed event of that checkbox is
generated all right so that's the header
template now I need to also define item
template because you know within the
grid view data rows we again need
checkbox so let's define another
checkbox here and I'm going to call this
let's give it a meaningful ID since this
is used for deleting purposes so I'm
going to call this checkbox simply
delete and I'm going to set the auto
post back to true for this as well and
then let's generate the even handler for
this checkbox also alright
so that's for the first column in the
second column we need to display
employee ID and then you know in the
header we have only had a text we have
already defined that we need employee ID
within the gridview rows and then we
want to display the employee ID within a
label control so my item template in
this employee ID column is going to be a
label control let's go ahead and define
that
so that has to be employee ID column and
I want to define item template so I'm
going to select that
I need a label there so let's drag and
drop a label control and let's give this
label a meaningful name I'm going to
call this lvl employee ID okay and then
let's get rid of this default text label
and at the stage let's end a template
editing now look at this we got the
check boxes as expected but look at
employee ID it's not saying it's data
bound why is that because we have just
defined an item template that's labeled
but you haven't set the text property
you know to any of the data fields but
for the bound seal if you look at this
data field is equal to name data field
is equal to agenda but how do I do it
for a template fear you know we have
slightly different syntax again you can
data bind this label directly here
within the HTML or you can use the
designer let's actually use the designer
so I want to edit templates and which
template do I want to edit I want to
edit item template of employee ID
template field so I'm going to select
that and then I want to bind this to
data so if I actually right-click on
that and if I go to properties look at
this I have edit data bindings here and
the moment I click so I am setting the
text property of this label to a custom
binding expression so I want to bind
this to the employee ID property of the
employee object so I'm going to say bind
employee ID that's it click ok so it's
going to write the code for us
automatically let's end template it
thing like that
now it says data bound the employee ID
also and then if you flip the waveform
to the source mode look at this item
template label text property is set to
angle brackets percentage hash and it's
binding to employee ID property of the
data source what is the data source for
this grid view good control going to be
it's going to be this list of employees
and this employee object has got
employee ID column to which this label
within
this template view is binding to right
okay so at this point if I go ahead and
run this as you might expect you know
the employees data will be displayed
along with the check boxes so one step
is done so we are now able to display
check boxes but when I select any of
these look at this when I select the
check box within the header what should
happen all these check boxes should be
selected but at the moment that doesn't
happen because we haven't written any
code there so let's implement that first
all right so if you look at you know
that's the check box within the header
and if you remember the ID of that is
check box delete header and then we also
have generated an even handler for that
check box delete header check that
changed so whenever we change the
selection you know this event is going
to be fired and at that point what do I
want to do I basically want to let me
actually copy this code and paste it
there and then I shall explain what it
is doing okay so look at this one this
is the event handler for this check box
within the header so whenever the check
the status changes this even handler is
raised and look at this parameter sender
what a sender mean sender is nothing but
this check box so if this check box is
checked
we want all of these check boxes to be
checked if this is unchecked all of them
to be unchecked okay and to do that look
at that I'm using the sender property we
know that sender is nothing but the
control which has raised the event in
this case the check box control that is
present in the header okay so that you
know we are retrieving the check test
status of that so this checked property
is going to return true if the user has
checked the check box otherwise it
returns false so if I am checked you
know that is going to return true and
look at what we are doing here we are
looping through each grid-view row in
grid view 1 dot rows okay each grid
viewed row and then look at what we are
doing within that grid view row we are
using this fine
control method and we are finding a
control with ID CB delete so what is CB
delete checkbox delete and if you
remember that's nothing but the ID of
the checkbox control that is present
within the item template meaning all
these checkboxes okay so when I check
this checkbox
I want to retrieve it's check the status
and then set that status for each
checkbox within every Dro of this grid
view one control and that's what
essentially this one line of code is
doing here
so in grid view row finder control with
CB delete and then obviously find
control will return a control back but
we are expecting a checkbox back so we
are converting that to be of type
checkbox and then the check that status
of that control should be equal to
whatever is the check the status of the
sender who is sender sender is nothing
but the checkbox in the header row okay
so simple one line of code here but
doing lot of things okay so now if I run
this with this change what's going to
happen whenever that you know check the
status of the checkbox in the header
changes you know it's going to change
everything else as well look at this I
selected it all of them are selected I
am checking all of them are unelected
very simple and straightforward all you
need to understand is the way to
retrieve you know the check that are the
check box in the header and the check
box within every grid View row okay in
the header if you want to retrieve the
check box you know this event is phrased
by the check box within the header
control so I am using the sender
property in this event handler to
typecast it to you know check box type
and then within the each grid view row
we have this CB delete check box I am
finding that using find control method
okay pretty straightforward alright the
next thing that we need to understand
here is see if we check the check box
header I mean the check box in the
header and it works as expected
but the problem is look at this I have a
check now if I uncheck this this should
automatically be if any one of the
view rose is unselected then this should
be automatically unselected but look at
this at the moment it is not unselected
in spite of unchecking everything it is
still selected so obviously whenever the
selection in these checkbox changes okay
for all of them are checked then that
should be automatically checked even if
one of them is unchecked this would
automatically become unchecked the check
box within the Honda let's see how to
achieve that obviously in order to write
code for that we will write that in CB
deletes underscore check the chain so
when is this even handler fired
whenever the selection within the check
boxes within grid-view rule changes and
if you look at the ID of that checkbox
it's CB delete and then look at the
event handler CB delete underscore check
to change okay so we will write that
code here and again to speed things up I
have that already typed so let me copy
here we have a bit of code but it's
again the same concept here now here if
you remember the sender is going to be
the checkbox within the grid view row
okay so what are we doing here we're
actually first getting a reference to
the checkbox control that is present in
the header so how do I get a reference
to the checkbox control that is present
in the header grid v1 dot header row dot
find control and within the header row
the ID of the checkbox control SC be
delete header and then we are
typecasting that to checkbox so I have
the header checkbox so if the handler
checkbox is checked so if the header
checkbox is checked then what do you
want to do if the sender so this even
handler is raised whenever you know any
of these checkboxes are you know the
check the status off the check boxes
within these grid view rows is changed
that's when this even handler will be
you know this event handler will handle
that event so sender here is going to be
the checkbox within the grid view row
okay so what we are doing here we are
finding the status of the sender and
then the checked status of the sender
and then we are setting that as the
check the status of the head checkbox so
if it is checked and if I uncheck the
checkbox within the gridview row we are
using that status to automatically
uncheck that on the other hand if the
header check box is not checked so if
they had a check box is not checked that
means either none of these checkboxes
are selected or all of them are selected
but one is not selected or only a few
are selected in and a few of them are
not selected okay so in which case what
we want to do I am creating a variable
here so we will come to the cells block
if header check box is not checked okay
so we are creating a variable all
checkbox is checked which is true okay
and then we are looping through each
grid View row each row and then we are
finding the control which is check box
delete so we are retrieving this check
box and then we are checking okay if at
if the check box in those rows is not a
check the meaning if any of it is not
checked that's when we will get inside
this block and then what are we doing we
are saying all checkbox is checked is
equal to false okay even if one check
box is not checked that's when it will
get inside this if block in which case
we are setting this you know private
field to false and then we are breaking
out of that because there is no pointing
looping through the rest of the rows
because we know for sure at least one
check box is unchecked if that's the
case you know this will be false and we
are saying check the header check box
checked is equal to unchecked so the
header check box will remain unchecked
on the other hand if you know if it
doesn't get into this block at all then
we know for sure the user has selected
everything and here selected even the
last one that is unchecked in which case
it will never get into this block and
then all checkboxes checked will be true
in which case we are checking the check
the status of the header check box to
true okay pretty simple and straight
forward so now this is going to handle
the reverse case okay in the checkboxes
that are present in the grid view rows
if I keep on selecting them look at this
when I select one two three four five
and when I select this one look at
what's going to happen it automatically
selected this okay if I uncheck one it
will be automatically selected on the
reverse if I select the header okay that
everything is selected if I uncheck that
all of them are so at least you know the
selection of these checkboxes is working
right now all right
so the next thing obviously we need a
delete button so that's going to be
simple so let's drag and drop a delete
button onto this waveform
and let's change the text to delete and
I'm going to call this BTN delete and
then to display you know how many rows
we have deleted whether two rows of five
rows or all rows and I'm going to have a
label control to have the status
displayed so let's drag and drop a label
control and I'm going to get rid of this
default text here and I'm going to set a
font bold is equal to true and let's
give it a meaningful ID this is going to
display some message so I'm going to set
that LBL message and then obviously when
we click that button delete you know we
want to delete the rows that the user
has selected all right so obviously
let's run this now at the moment when we
click that button nothing is going to
happen but you know once we have
selected these rows and then when I
click that delete button what should
happen we should loop through all the
rows whatever checkbox is checked you
know we need to retrieve those employee
IDs and then delete them from the table
okay but now nothing happens so let's
see how to achieve that again to speed
things up I have this already type so
let me copy that and paste it within
that so at the moment again if you look
at this one I have a simple list of
strings variable list employee IDs to
delete so I'm going to use this variable
to keep track of what are the employee
ID IDs that I'm going to delete and look
at this what are we doing we are looping
through each gridview row okay each grid
Bureau and within the grid bureau we are
using again the find control method find
CP delete so if you remember within each
grid view row there is an item template
and within that we have a checkbox
delete so basically we are retrieving
this checkbox within each row of the
grid we control
and then if that checkbox is checked
then what we need to do we need to
retrieve the employee ID okay so we are
again saying grid-view one in the same
row find control with ID LVL employee ID
and if you remember i employee ID is
also a template field and within that
this label LVL employee ID is going to
contain employee ID so this employee ID
that is displayed here is coming from
that label control so we are retrieving
that label and then using the text
property of that label to retrieve the
employee ID so we are saying grid we
want a fine control LVL employee ID
again fine control will return the
control back but we know it's a label so
we are typecasting it to be of type
label and then we are using the text
property okay to store into this
variable and then we are basically
adding that employee ID to the list and
then what are we doing if list of
employee IDs to delete is greater than
zero so obviously if I have not selected
anything and then if I try to click this
button there are no employee ID is
selected but if I have selected one two
or three I have to be selected in which
case this list of employee employee IDs
to delete count will be greater than
zero in that case we are setting the
full color to Navy and then LBL message
door text you know we are saying
whatever is the count convert that to
string class rows deleted so if I have
three rows three rows will be deleted
that's what is the message the label
displaced but at the moment we are not
deleting any employees okay we don't
have code for that we'll be writing that
in a bit if the employees count is not
greater than zero then we know for sure
you know no rows are selected in which
case we have set in the full color of
the label to red Noro selected to delete
so now with this change if we go ahead
and run as you might expect what's going
to happen we will have you know if I
don't select anything I click tell it
look at that no rows selected to Delhi
the message comes as expected but if I
select one two three and I select that
three rows deleted but they are not
actually deleted because we have
not return the code we have just
displayed that message so obviously to
delete from the table we need a delete
method within the employee data access
layer ok so let's actually add that
method so I'm going to add another
static method here let's call that
public static this is not going to
return anything but I'm going to call
this delete employees and it's going to
take in employee ID ok so obviously we
need to write some ad or net code here
again so let me copy this and then we'll
modify it as required so configuration
manager we are reading the connection
string preparing the signal connection
object so this one is going to be the
lead from TBL employee where employee ID
is equal to at employee ID so we are
going to use a parameterised query to
avoid sequel injection attacks ok so
obviously we need to supply a value for
that parameter so let's create a sequel
parameter
and we need to supply a name and a value
for that so parameter dot parameter name
is equal to you know at employee ID that
we have just created and the value so
parameter dot value where is the value
coming from it's coming into this method
as a parameter so that's what we will
use there and open the connection and
this is going to be a non query because
insert update and delete you know we are
not getting anything back so it's a non
query so execute on query right so we
don't need all this let's get rid of
that one we are not going to return
anything back so
all right
so we don't even need the sequel data
reader objects so let's get rid of that
as well okay so with this change and
here we need to call that employee data
access layer deletes method so I'm going
to say employee data access layer delete
employees and we need to pass an
employee ID okay so what I'm going to do
here are I'm going to so for each
because look at this this list contains
the string of employee IDs to be deleted
so I am going to say for each string STR
employee ID in that list employee IDs to
delete so we are retrieving each
employee ID from this list and then we
are going to call that employee data
access layer dot delete employees and
you need to pass in employee ID of type
integer but this is of type string so we
need to convert that to integer so let's
do that
convert dot to in 32 and let's say STR
employee ID that's it so now let's run
this and as you might expect once we
select these employees let's say I
select 1 and 3 click delete must declare
the variable at employee ID Oh
so where do we have the terror command
dot X must declare the scalar valuable
variable at employee ID so maybe we have
not set the parameter name and employee
data access layer let's check that they
lead from TBL employee where employee ID
is equal to add employee ID
yep we have created the parameter object
but we didn't add it to the command
object so let me add that command or
parameters dot add and that's a
parameter object so that's the reason
why it's complaining okay
I'm expecting a parameter but I don't
have a value all right so now we should
be able to delete the Stroh's let's say
1 &amp;amp; 3 I click that look at that two rows
deleted but the strange thing here is
it's not refreshing the grid view
control why is that that is because we
have not binded rebind at the data to
the grid view control after we have
deleted the data so here we should call
that method was that method we called
bind get data so let's call that private
method get data so this should actually
you know rebind
the data to the grid we control
okay look at that you know only those
the 1 and 3 rows are deleted let's
select 4 &amp;amp; 6 I click there it look at
that they are deleted now let me select
everything and then click that look at
that two rows deleted okay
let's insert the data back now the
problem with this code that we have just
written as look at this what are we
doing here we have written this employee
data access layer delete employees
method you know you're passing one
employee ID at a time and then you know
you're calling this delete employee
method within data access layer now
let's say within your grid view control
you have 200 rows and if you want to
delete all those 200 rows this delete
employees method will be called 200
times and this query will be executed
200 times so there will be a lot of
traffic between your web server and
database server so this is not really
good in terms of performance instead why
don't we you know have all the employee
IDs in you know in a string and then
send those employee IDs to the data
access layer method and then let it use
an in clause you know to execute one
query at a time for you know delete from
TBL employees where employee ID in 1
comma 2 comma 3 comma 4 comma 5 you know
even if you have 200 it's just going to
be one query with employee ID is
separated by comma using the end Clause
now that's much better for the
performance ok so obviously in order to
achieve that I have created a method
here so let's copy and paste this again
just to speed things up so within our
employee data access layer I'm going to
change the definition of this method
instead of taking in one employee ID at
a time I am going to take list of
employees so here I am going to have
list of string and then instead of one
employee ID I'm going to pass employee
IDs a list of string so what are we
doing here the same idea read the
connections in rememb convict prepare
you sequel connection object look at
your end clause
you know I'm setting it to empty and
then I'm looking through each employee
ID in that list okay look at this
employee IDs it's a list of string so
look through each string in that
employee IDs and what are we doing we
are you know appending whatever we have
you know will retrieve if I have 1 comma
2 comma 3 you know I I will retrieve one
plus and then I we are appending a comma
so 1 comma 2 comma 3 so we are preparing
you know a comma delimited string with
employee IDs and then obviously in the
end there will be a comma so we need to
remove that so we are using the remove
function to remove that comma in the end
and then once I have that STR I mean the
in clause the comma separated list of
employee id's what are we doing we are
building this command dynamically delete
from TBL employee where employee ID in
look at that we are concatenated this
string with this string to form the
query so this will be deleted from TBL
employee where employee ID n1 comma 2
comma 3 comma or whatever ok depending
on how many ever employees we have
selected in the preview control and then
I just you know we are just executing
preparing the sequel command object we
are opening the connection and then
executing the query now this you know is
good from performance so this is going
to work as expected it's going to
actually have a obviously we'll get an
error because we have changed the delete
employees method within the employee
data access layer but we have not
changed that within the place where we
are calling it so I can get rid of this
right now and I can simply say employee
data access layer delete employees and
then to this pass the list so where is
our list of employees this is the list
that contains our employee IDs list of
strings so I'm going to pass that now we
run this it's going to work as expected
but the problem with this method is that
we are building queries dynamically by
concatenating strings so if you look at
the delete employees method here we are
building the
very by concatenating these strings and
we have spoken about the dangers of
building queries by concatenating
strings you know it opens up doors for
sequel injection attack okay so this is
better from a performance but then from
a security perspective this is very very
dangerous
okay we should not ever be you know we
should never ever be concatenated
strings to form queries so now I select
these and I click delete it's going to
delete all of them as expected it works
but from a performance from a security
point it's very bad so we shouldn't be
concatenated strings to form queries
okay so obviously the best way from
performance and from security is this
version of delete employees method so
let me copy this and paste it here and
then we'll go over the code so within
the again what are we doing here we are
okay let me copy that okay so there so
we are reading the connection string
from web console file this doesn't
change prevent the sequel connection
object look at this here this is what is
important so I'm getting list of
employee IDs now what I'm going to do is
I'm going to you know add parameters
depending on the number of employees
that I want to delete for example if I
want to delete one two and three three
employees then I'm going to you know say
delete from TBL employee where employee
ID in at parameter 0 at parameter one at
parameter 3 so I'm going to have three
parameters in my in class one for each
employee ID that I want to delete
because converting a list of strings
into in clause is not that easy that's
why we are using this trick here so I am
using the employee ID is the list of
strings and I am basically forming
another you know list of strings called
parameters ok another list of string
basically what we are doing here is I am
going to this piece of line here you
know this is going to be converted into
a list of strings and that list will
contain at parameter 0 at parameter one
at parameter two
if I have three employee IDs I have
selected you know to delete so I will
have here three you know parameters
parameter 0 parameter 1 parameter 2 and
then look at what am I doing here I am
joining you know a comma with these
parameters in the in clause
okay so parameter is 0 comma parameter 1
comma parameter 2 so delete from TBL
employee where employee ID in at
parameter 0 comma parameter 1 comma
parameter I mean in parameter 0 2 3 okay
and then what are we doing the delete
command text you know this this is the
delete command text ok so we are
preparing a command object and and this
is what is interesting here so we have
three parameters because I wanted three
employees to be deleted for example so I
have three parameters at parameter 0 at
parameter 1 and at parameter 2 and then
for each parameter now we need to attach
a value so we are saying command that
parameters that add with value so to
this command we need to specify values
for those parameters so parameters of I
so we need to obviously specific look at
the intelligence here so the parameter
name is parameter of high parameter of 0
employee IDs of 0 so this list is going
to contain you know 3 employee IDs that
I want to delete so this is going to be
the parameters list is going to contain
the parameter names and this list is
going to contain parameter values which
we are adding to this command object and
remember we have already built this
command string I mean the command object
here delete from table employees with
employee ID in the end Clause is going
to contain comedy limited list of
parameter names you know in the format
of at parameter 0 1 2 3 depending on the
number of employee IDs that you want to
delete ok a little bit tricky one I mean
if you want to understand this properly
what I would say is put a breakpoint
here and watch the values of each
variable as you debug it you'll be able
to understand that
better okay obviously converting a list
into you know an in clause for a query
is a little bit tricky now we are doing
this in this way it just you know to be
good in terms of performance as well as
security so this is much better than the
other two previous versions of delete
method that we have seen all right so
with this now if we run this it works
you know there's going to be only one
query and it's also good from sequel
injection perspective because we are
using parameterised queries so let's
insert data and let's refresh this page
and let's say I want to select one and
on those three so three rows delete it
so it's what it works as expected
all right on this slide you can find
resources facebait or net c sharp ends
equals of interview questions that's it
for today thank you for listening have a
great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>