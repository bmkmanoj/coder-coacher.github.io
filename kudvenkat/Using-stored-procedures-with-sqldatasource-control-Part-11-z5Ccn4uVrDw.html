<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Using stored procedures with sqldatasource control   Part 11 | Coder Coacher - Coaching Coders</title><meta content="Using stored procedures with sqldatasource control   Part 11 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Using stored procedures with sqldatasource control   Part 11</b></h2><h5 class="post__date">2013-02-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/z5Ccn4uVrDw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to presume technologies I am
Frank ed this is part 11 of asp.net
grid-view tutorial in this video we'll
discuss about using stored procedures
with sequel data source control in my
sequel server database I have two tables
on the left-hand side you can see TBL
department table which has got
department ID and the department name
and on the right hand side you can see
TBL employee table which has got
employee ID their name and the
department to which they belong
obviously Department ID is a foreign key
so for example if I ask you to which
department as Pam belong her department
ID is three meaning she belong to
payroll department okay so now I want to
design in a webform where I want to have
a drop-down list and a grid we control
on that wave form and then within the
drop-down list we want to display you
know all the departments so whatever
departments that we have in departments
table we want to retrieve them and then
display them in this drop-down list and
when I select the department from the
drop-down list for example at the moment
we have payroll selected now at that
point I want to go to employee's table
and retrieve all the employees who
belong to payroll department and then
display them in this grid view control
so obviously I want to do this using
stored procedures with sacral datasource
control so let's flip to sequel server
management studio and then look at this
I have these two tables already created
TBL department and TBL employee and the
sequel script to create those tables and
populate it with some sample data you
know I'll have this script available on
my blog so you can copy it from there
just in case if you want to practice
alright now I I want to achieve this
using stored procedure so obviously I
need a stored procedure which gets me
you know all the department IDs and
names so I have the stored procedure s
peek at the department's and if you look
at the query it's very straightforward
select department ID name from TBL
department okay so obviously let's
quickly test this so execute so I get
department ID and name and then we want
another stored procedure where I want to
retrieve employees by department ID so
if you remember when I change my
selection in the drop-down list we will
pass the department ID you know to a
stored procedure
and that stored procedure should return
all the employees belonging to that
department so that is the stored
procedure which is going to retrieve
data for us so SP get employees by
department ID and if you look at the
stored procedure it's taking in
department ID parameter and then
obviously since we want a department
name in the gridview control we want to
join TBL employee with the TBL
department table and the common column
between these two tables is department
ID and TBL employee table and department
ID in TBL department table so based on
that column we are joining TBL employee
with TBL department and what columns are
we retrieving employee ID name column
from TBL employee and in our name column
from TBL department again you know if
you are new to creating stored
procedures and joins I strongly
recommend to what sequel server video
series that I have you know already
recorded alright
now let's flip to visual studio so first
we want you know a drop-down list you
know showing all the departments
obviously to serve data to this
drop-down list we need a sequel data
source control so let's drag and drop a
sequel data source control onto the
waveform which will help us retrieve the
data
so sequel data source control click on
the smart tag button and click on
configure datasource so select your
connection string from web config file
you know this connection string is
already defined in web config file click
Next and here look at this configure the
select statement on this screen instead
of saying you know selecting from the
table you have another radio button here
specify a custom sequel statement of
stored procedure select that option and
then click Next on this screen you can
specify either a custom sequel statement
that you want you can write it here or
you can use stored procedure ok now
whatever stew procedures that I have in
my sample database ok will be listed in
this drop-down list and if you remember
we have this SP get department stored
procedure ok so I select that click Next
we can test our query look at that I
have my department ID and Department
name
and finally click finish so we are done
configuring sequel data source control
now we want to display the department ID
and department name in the drop-down
list now remember first let's drag and
drop the drop-down list control onto the
webform now again click on the smart tag
button of the drop down list and look at
this choose datasource so for this
drop-down list where is the data going
to come from from sequel datasource one
control so I select that and then look
at this as soon as I select my sequel I
know datasource for the drop down list
there are two more things that I need to
select you know the display value for
the drop down list and the value you
know itself so what is the drop down
list it's a collection of list item
objects and list item object has got two
properties the text and value so what's
the display the text that you want to
display in the drop down list and what
is the value for that list item object
so I want to display the name of the
department and the value is going to be
the department ID okay so click OK and
that's it so now if we run this this
drop down list should actually show all
the departments from TBL departments
table so it's still taking time to
render the page so now when I drop it
down we can see all the departments
there so the next thing is basically you
know we want another sequel data source
control which calls this stored
procedure SP get employees by department
ID so if I pass let's say for example
department ID 3 which is payroll I
should get all the employees belonging
to that department so as soon as the
selection in this drop-down list changes
you know we should be able to call that
stored procedure and then retrieve the
data
I mean meaning employees belonging to
that department ok so let's go ahead
drag-and-drop a sequel data source
control onto the waveform and let's
configure this now ok
so let's select our connection string so
these steps are going to be similar now
I want to specify a custom statement or
stored procedure click Next and specify
your stored procedure now which is that
stored procedure SP get employees by
department ID
so I select the stored procedure and I
click Next
now look at this this Bazaar is actually
intelligent so it has detected that that
stored procedure has got a parameter
Department ID so we need to supply a
value for this parameter otherwise you
know this stored procedure cannot be
executed right because if I don't pass
the parameter and if I try to execute
that we get an error in a function or
procedure expects a parameter for which
we we haven't supplied a value okay so
for this parameter where is the value
going to come from it's going to come
from this drop-down list and what is a
drop-down list
it's a control and if you remember a
webpage you know can get it per app can
it can get values for its parameters you
know from these different sources I can
get you know from a cookie if I want you
know from a query string or a posted
form value or a session variable you
know from these different sources but at
the moment we are going to get the
parameter value from the drop-down list
so I'm going to choose control here and
then which control you have to specify
the control ID in this case it's going
to be drop-down list 1 that's it we are
done so if you look at this the
department ID should be equal to
whatever is selected within the
drop-down list and I click Next I will
have an option to test my query here and
look at this depart you know the stored
procedure expects a parameter so for
example if I pass for for example
department ID and I click OK I get the
employees belonging to that department
all right click finish and we are done
so now let's actually drag and drop a
grid view control onto the waveform and
then just to make it look you know
better we can select you know one of the
existing schemes
let me shall select brown sugar click ok
so we are done now we need to associate
this grid view control with this sequel
data source control and select sequel
data source to okay so we have employee
the employee name and Department name
columns that's it let's go ahead and run
this now
and as soon as the webform renders the
default the selection is going to be IT
department so the all the employees
belonging to IT department will be
displayed there okay and as soon as I
change my selection
you know the employees belonging to that
department should be shown in the grid
view control but it's not why because we
haven't set the auto post back property
of the drop-down list control to true so
let's go ahead and do that right click
on the drop-down list go to properties
and set auto post back property to true
so that the wave form will be posted
back to the server as soon as the
selection in the drop-down list changes
so let's go ahead and run this once
again and when the wave form loads the
default selection is ID so all the IDE
employees belonging to IT department are
shown now if I change the department to
administration so employees belonging to
administration team are shown ok pretty
simple and straightforward so here you
know this drop-down list is using this
sequel data source control and the grid
view control is using this sequel data
source control you know and both of
these are actually calling stored
procedures this equal datasource control
calls stored procedure which doesn't
take any parameters but whereas this
stored procedure I mean this equal data
source control calls it stored procedure
that takes a parameter and the value for
that parameter is coming from another
control on this webpage which is this
drop-down list
alright on this slide you can find
resources for asp.net c-sharp and
sequence of interview questions that's
it for today thank you for listening
have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>