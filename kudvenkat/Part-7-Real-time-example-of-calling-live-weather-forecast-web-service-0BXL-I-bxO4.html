<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 7   Real time example of calling live weather forecast web service | Coder Coacher - Coaching Coders</title><meta content="Part 7   Real time example of calling live weather forecast web service - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 7   Real time example of calling live weather forecast web service</b></h2><h5 class="post__date">2013-11-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0BXL-I-bxO4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this part 7 of asp.net Web Services
tutorial in this video we'll discuss
calling a live with a forecast web
service from an asp.net web application
here is the URL of that live weather web
service at the moment this web service
can only be used with the US zip codes
let's visit this weather web service so
notice that we have the same URL s we
have seen on the slide
I'll have this URL available on my blog
in case you need it if you recollect
from the previous sessions in this video
series when we click on this service
description link will be taken to the
Vistal page that is the web service
description language page this Vistal
page will be used by visual studio to
auto generate proxy classes for us and a
client application can then use those
auto-generated proxy classes to invoke
the web methods of the web servers this
weather web service has made three web
methods available we'll be using this
web method get' City weather by Z the
name of the method speaks for itself
we provided a zip code this method is
going to return the weather at that zip
code so let's quickly test this let's
pass in a value dat zip code let's pass
2 to 0 for 1 and click invoke look at
that we get a response back from the web
service first of all notice that the
response is in soap formatted message
and look at the first element here you
know an XML element success which says
true response text it's a city is found
state is Virginia city's false church
the temperature is around 51
you know it's cloudy in Virginia at the
moment now we passed a valid zip code
and we get a response back let's see
what's going to happen if we pass and
invalid zip or something like a B C and
click in work look at that the success
element now says false and the response
text is invalid zip now this web service
is useful in case if you have a website
and you want to display us specific city
website our weather on your website so
let's see how to consume this weather
web service
in an asp.net web application let's flip
to visual studio so here I have an MT
asp.net web application the first step
here is to add a reference to the
weather web service and to do that right
click on the references folder and
select add service reference and within
this address text box we need to type
the URL of the weather web service so
let's copy it from the notepad paste it
there and then click the Go button so it
should now discover that whether web
service look at that we have the weather
web service then if we expand this and
select weather soap look at this it
displays all the three web methods that
are available with this weather web
service give it a meaningful name space
let's call it weather service and click
OK clicking on OK should auto generate
proxy classes for us and if you want to
have a look at those proxy classes and
I'll click on this button within the
solution Explorer which says show all
files and expand weather service expand
references dot SVC map and then you
should see references left lines dot cs5
so this is the class file which has
caught the auto-generated proxy classes
so there's a quite a bit of code that
sort of generated for us now we want to
design a web form that looks like this
where the end user can enter a zip code
and then once they click this button get
whether we want to invoke that weather
web service and then display the weather
information within the label controls as
you can see here so the first step is to
add that platform itself so let's
right-click on the project name add a
new item and we want to add webform 1 so
let's click add to speed things up I
have already implemented the HTML to get
this user interface so let's copy that
from the notepad and paste it within our
webform now this is a very
straightforward HTML I have a table tag
within that I have caught some TRS and
TDs and then this text in or zip code
City let's
actually flip this to the design mode so
that you can actually see the design of
it look at that we have this text and
then these label controls to display the
weather information then once a button
control here and then a label control
with red font just in case of the
weather web service as fail we want to
display the terror information within
this label control all right so now
let's click on this button to generate
the click event handler so now we
already have the proxy classes generated
so first is if you read collect the name
space that we have given it is weather
service within that we have got several
classes but then the one that we are
interested in is the weather soup client
class so that's the client to invoke the
weather web service so let's call it
client equals new weather service dot
weather soap blind and then this client
object should have those three methods
that we have seen on the web service so
we should see all these methods but we
are interested in get a city weather by
zip method so let's invoke that method
and look at this it expects a zip code
to be passed in so where are we going to
get the zip code from from this specific
text box and what is the ID of the text
box it is d XD zip okay so let's
retrieve the text property so it's txt
zip dot txt all right
now if you look at the return type of
this method look at what it is returning
from the intellisense it's actually
returning a weather return object okay
so let's create a variable of type
weather return and that class should be
in this namespace with a service so
weather return and let's call this
result okay so now if you inspect this
result object it should have the
properties that are shown in the
response that we get back for example
let's click on this one let's pass two
to zero for one click in work look at
that we should have a successful
property response text property state
city weather station you know there are
several properties but we are going to
use only these you know a few of them
but if you want to display different
information you know depending on what
you want to display you can choose those
properties okay
so now when I say result dot look at
that I have response text I have success
I have state you know all the properties
that we have seen on this response right
now we want to display them in the label
controls so we have label city so label
city dot text equals result dot city
similarly label state dot text equals
result dot state LBL temperature dot
text equals result dot temperature LVL
weather station say Day dot text equals
result dot weather station city and LBL
wind dot text equals result dot wind
think those are all yep all right
so now look at this if it is
successfully returned then the success
element will be true otherwise what's
going to happen if we pass in something
like test and click in work look at that
success returns false so here you know
the web service didn't find the zip code
that we have provided and look at the
response text
says invalid zip so basically we can use
these two elements to you know display
the appropriate information on our web
form so if the result object success
element look at that that's a boolean
property meaning it's either going to
return true or false if that property
has returned true then display weather
information in the label controls else
if it has returned false then it comes
to the else block in which case in the
error label we want to display the value
that is present in the response text
property of that result object okay so
if we provide an invalid zip code what
is response text going to be invalid zip
and that's what will be displayed in the
label label error okay and when we
display an error message we want to
empty out these labels as well so let's
go ahead and set them to an empty string
so string dot empty we want to do that
for all the label controls so let's
quickly copy and paste them for all the
label controls
all right and then if we have found the
city that you are looking for
we want to set error label text to an
empty string otherwise that error will
be still showing up all right with these
changes let's go and run this and see if
it's going to work actually we might run
into an exception we'll fix that in just
a bit
so two two zero four one let's pass in a
value zip code and click this button get
weather look at that we get an error and
it says an endpoint configuration
section for contract weather service dot
weather so could not be loaded because
more than one endpoint configuration for
that contract was found
so basically this error message say it
states that it has found more than one
endpoint configuration so what this
means is when we have generated the
proxy classes within web config file
it has generated some configuration
information for us and if you look at
this client here notice that we have got
two endpoints so now it's confused on
which endpoint to use so we have to
specify the name of the endpoint so here
we have got two of them the first one
name is weather soap and this one is
weather soap one two so specify the name
of one of the endpoints so let's go back
to a webform and then when we have
created this client object here you know
this constructor there are several
overloaded constructors here I'm going
to use the one way we can pass the end
point configuration name and what is the
name weather so if we want to use that
end point so with this change let's run
it once more and then enter a valid zip
code click the button so we should get a
response back look at that we are
displaying you know the information that
we wanted
let's pass in another zip code 2 2 3 1 4
which is alexandria again in Virginia
and let's pass maybe something like
so I said click get weather look at that
it says invalid zip so this is working
as expected that's it for today thank
you for listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>