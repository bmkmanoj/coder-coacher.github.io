<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 13   What is SqlCommandBuilder | Coder Coacher - Coaching Coders</title><meta content="Part 13   What is SqlCommandBuilder - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 13   What is SqlCommandBuilder</b></h2><h5 class="post__date">2013-10-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/F811ruWEHjY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">is part 13 of radio dotnet tutorial in
this video we'll discuss the use of
sequel command builder class with an
example we'll be using this table TBL
students in this demo here is the sequel
script to create and populate this table
with some sample data
I'll have the script available on my
blog in case you need it the first step
here is to design a web form that looks
like this to speed things up
I have already implemented the required
HTML so let's copy this and flip over to
visual studio so here I have a blank
asp.net web forms application so let's
open up this web form one dot aspx first
let's set the style attribute of the
Steve tag and set font family to the
area and then let's paste the HTML that
we have copied now let's select the
entire HTML by pressing ctrl a and then
plus control K and D to format it and
this HTML is very straightforward so if
you look at the user interface here it
has got one two three four and five rows
within a table so here I've got a table
where the border is set to one and
within the table we have the first row
here and notice that within the first
row we have got two TDs and within the
first TD we have this little text
student ID and then a textbox control
and the button control and that's what
we see in the UI and within the second
that here we have two TDs in the first
TD we have this little text name and
then a textbox control and that's what
we exactly see within the second at TR
very straightforward HTML and within the
third at TR we have you know this little
text gender and then a drop-down list
control because a drop-down list would
make more sense to display something
like gender and then this gender
drop-down list has got three list items
basically the first list item is a
prompt to the user to select the gender
and then the second list item is male
third list item is female and then
within the fourth TR we have this little
text total marks and then the text box
control and in the final tee
we have look at the TD bit there there's
one TD but that width of that one TD is
panning across the width of the two TDs
and to achieve that we are using call
span equals two on that one TD and
within this TD we have got a button
control and a label control we use the
label control to display status
information like if we click update
button
you know one row updated okay so we have
the required UI very straight for HTML
now basically when we enter a student ID
for example here we have entered one and
then once we click this load button we
want to load that student record from
the database table and display that
information in the respective controls
okay so let's go ahead and double click
this button control to generate the
click event handler we're going to write
some radio dotnet code here we need
three namespaces so system dot data and
we need system dot data dot sequel
client and we need system dot
configuration and within the web doc
config file
I have already included a connection
string look at the name of the
connection string it's a DB CS and this
connection string is pointing to an
installation of sequel server on my
local machine okay
so let's read this connection string
value within the code-behind file in the
button click event handler so string
connection string equals we're going to
make use of configuration manager class
and we are going to use the connection
strings what is the name of our
connection string DBC s dot connection
string should give us the connection
string that's there within the web dog
config file the next step is to
basically create a sequel connection
object and to create a signal connection
object we need the connection string so
let's pass it to the constructor of that
class now let's go and create sequel
data adapter object now to create sequel
data adapter object I am going to make
use of this constructor which takes two
parameter
the select command that is a select
query and the signal connection object
so select query is being passed as a
string
so first let's prepare our Select query
let's call it sequel query now we are
going to load one record at a time so we
need to have a very class so query is
going to be something like select star
from students so select star from
students from TBL students table their
ID equals and where are we going to get
the ID from we are going to get it from
this particular text box on the UI and
if you look at the ID on the webform
it's called txt student ID so let's copy
that and then use the text property of
that respective text box so here we have
the sequel query so now let's pass it to
the data adapter object and the second
parameter is the connection object
itself so at this point we have the data
adapter object now let's go and create a
data set object let's call it D as
equals new data set and then I'm going
to invoke the fill method of the data
adapter object so what is this method
going to do it's going to go to the
database using this connection object
execute this query retrieve the data and
then fill that data up within this data
set and when it's going to fill the data
within the data set you know we can
specify a table name within the data set
so let's call the table students okay so
at this point we have the respective
student record within the data set now
I'm going to store the sequel query and
the data set in a view state variable in
a bit we'll understand why we are doing
it so let's use a view state variable
and let's call the key as sequel
underscore query and let's store the
sequel query
and in a similar fashion we also want to
store the data set so let's give it a
key data set and what is the data set
instance D s so let's go and store it
ok now for example if I enter student ID
5 0 1 and then click load button you
know we don't have that student record
there so if the student record is not
there then we want to display a status
information here student with ID 5 0 1
is not found so basically we need to
check if you know a student record
exists within the data set and keep in
mind we are going to retrieve only one
record from the database which means
this data set is ever going to have you
know only one record but now let's go
ahead and first check da store table so
of what is the name of the table within
the data set it's called students so
within the data set find this table and
then find the rows and let's use the
count property so this is going to give
us the total number of rows within the
within that table within the data set if
it is greater than 0 then we know we
have a student record within the data
set in which case we are going to
retrieve that student record values and
then populate these controls if the
count is not greater than 0 then what we
are going to do we are going to display
information I mean a message stating
student record is not found so we'll be
using this label to display that status
information and the label is called LVL
status so let's set the text to no
student record with ID equals whatever
ID that we have entered within the
textbox okay if there is a row within
the data set then what we want to do we
want to retrieve the information from
that row so first we need to retrieve
the row itself so I'm going to copy this
so rows off I'm going to use the indexer
we know that there's going to be only
one draw so get that one row that is
present at the at index 0 and look at
this this is going to return as a data
row back so I'm going to store that in a
variable of type data row let's call it
TR and now what we need to do so first
we need to display name within the name
textbox and how do we get access to the
name use the column name dr of name
should give us the name value from that
data row and we want to store that in
this text box
txt student name in a similar fashion we
want to store total marks as well so TX
stay what is the name of the textbox
there it's called txt total marks the
text equals the name of the column is
total marks and then we need a gender as
well and agenda you know we are actually
using a drop-down list
so and the ID of the drop-down list STD
el gender that's selected value equals
dr of the name of the column is gender
okay so at this point we should be able
to retrieve the student record and
display that on the webform and one more
thing that I want to do if the student
record is not found I want to set
basically the color of the label to red
so for color is going to be system dot
drawing color red okay so let's go and
run this now so within this database
table we only have student records from
1 to 10 let's enter maybe student ID 60
which doesn't exist click load look at
that no student record with ID equals 60
okay on the other hand if we enter 1
click load with that that is stored I
mean that's data is retrieved and
displayed
and at this point what do what happened
behind the scenes we also stored the
sequel query that we use in a view
Street variable and the data set also in
the view state variable now once we you
know retrieve the data we can make the
changes to data and then once I click
this update button we want to update the
database table okay
so let's double click this update button
to generate the click event handler now
the first step here is to you know load
the connection string from web config
file create the sequel connection object
so let's copy that from there and paste
it within the update button click event
handler now I'm going to create sequel
data adapter object once again because
once we click the Update button what
should happen we should update the
database table I'm going to use sequel
data adapter for that okay so sequel
data adapter da equals new sequel data
adapter now when we create an instance
of sequel data adapter you know we can
specify the select command now remember
when we were loading the data you know
this is what is the query that we used
to load data and that query we stored in
the view state variable so let's go
ahead and retrieve that select query now
you may be wondering we are not
selecting data here why are we using the
Select query we'll understand that in
just a bit
ok so here the first parameter is going
to be the query in a string format and
we are going to retrieve that from the
view state variable and viewstate is
going to return that as an object type
so we need to typecast it to string and
then the second parameter is the
connection object so let's pass that so
now look at this I am NOT going to write
the update query by hand I'm going to
make you know the update query or to
generate and to do that I'm going to
make use of sequel command builder class
so what is the use of sequel command
builder
last this class automatically generates
insert update and delete sequel
statements based on the select statement
for a given single table okay so here we
are working with one table that is TBL
students and we have specified the
Select query for that table which is
nothing but select star from TBL
students better ID equals whatever ID
okay so based on this select statement
this equal command will the class is
going to generate insert update and
delete statements for us and let's see
how it does that
okay so we have sequel data adapter
object and that adapter object knows the
Select query which we have retrieved
from the view state so now I'm going to
use sequel command builder class ok
sequel command builder let's call it
builder equals new sequel command
builder now I need to associate this
data adapter object with the sequel
command builder okay so I'm going to
pass that as an argument to the
constructor so look at this there are
two overloaded constructors I'm going to
use this overloaded constructor where we
can pass the data adapter object so at
this point the sequel command a builder
object knows the Select query because
look at this sequel data adapter object
knows the Select query and we are
passing that sequel data adapter object
to the sequel command builder &amp;amp; Seek
loop command builder is going to examine
that select query and then based on that
it is going to automatically generate
insert update and delete sequel
statements for us okay so at this point
sequel command builder should have
generated the insert update and delete
statements okay so now you know we can
make any changes that we want and once
we click update we want to purchase
those changes back to the database table
okay now what we are going to do is we
first need to retrieve those values and
store them within the data set so that
when we say data adapter
dot update so when we call this update
method you know basically we can specify
the data set object and within that data
set so basically we don't have the data
set yet where is the data set present
you know we have stored that data set
within the view state variable so we
need to retrieve that from the view
state okay so let's go ahead and
retrieve the data set from view state so
let's typecast this to be off data set
okay so we want you know update the
table thus table TBL students from data
that is present within the data set so
within this data set this is another
parameter that we can specify the table
name there's a table called students so
take the data from this table and then
update this table that's what this
update does but then you know if we run
this code as it is it it's not going to
do any update because you know when we
make changes here we want to apply those
changes to the data set first and then
once we call da da to update that will
automatically update it so first let's
go ahead and make the changes to the
data set itself okay so first of all
let's check if there are any rows at all
within the data set so d s dot tables
off what is the name of the table
students dot rows dot count so if the
row count is greater than zero because
they should be a row to update within
the data set so when we load the data
what's happening we load that data into
the data set as well and we stored it in
the view state and now we are retrieving
that row from the
that and then whatever changes we make
in the UI we are going to apply that to
the data set and then once we call the
update method you know the data adapter
is going to use the data that we have
changed within the data set and update
the underlying database table okay so
first of all if the row count is greater
than zero then you know we are basically
going to say data row D R equals let's
copy this piece of code rows of zero
should give us the row width in the data
set so now let's apply the changes to
the data set table so dr of named so
where are we going to get the name from
the student text box student ID text box
similarly we want to update gender
gender is coming from the drop-down list
and the ID of the drop-down list is DDL
gender selected value and we want to
update total marks as well and that is
going to come from
txt total marks table okay so at this
point we have updated the data set now
if there are if that row count is not
greater than zero then what does that
mean there are no present no rows
present within the data set in that case
we want to print a message stating LBL
status dot or we'll do that in at a
later point okay so if the count is
greater than zero then go ahead and
update that row that is present at
position zero okay and then look at this
we are calling da da to update and look
at the return type of this update method
what is it returning back it's returning
an integer back you know basically the
number of rows that are updated in our
case it's going to be either 1 or 0 okay
so
let's call it end rows updated equals
dot and then F rules updated is greater
than zero then we know for sure you know
arrow has been updated in which case we
want to set the four color of the label
to green and then we want to set the
text to you know how many ever Rose
updated and home where do we get that
number from this variable Rose updated
let's convert that to strain and then to
that string we are going to append this
text
okay now if it's not greater than zero
then we know that no row is updated in
which case we want to set the color to
red and we want to display this message
no row updated okay so let's go and run
this and see if it works as expected so
let's end up for example five zero one
five zero one doesn't exist so when we
say load no student recorded ID equals
five zero one now let's try to update
this and see what happens look at that
no row updated on the other hand let's
enter a valid record number three click
load so we have this student record
let's change the gender of the student
from male to female and let's update
that look at that one row updated and
when you look at your underlying table
for student record three look at that it
didn't update it properly it basically
said name two three let's see why that's
because they using txt student ID
textbox value it's actually student name
textbox okay so let's run this one more
time let's enter the student rec ID 3 so
name will be three there let's then
place a John Stenson as the name let's
update him to male and let's set his
total marks two thousand click update
one drawer updated and that should rows
should have been updated correctly now
okay so it works as expected so
basically what is sequel command a
builder class this command builder class
is used to automatically generate insert
update and delete sequel statements
based on the select statement for a
single table okay so basically here if
you look at this update click event
handler we didn't specify the update
statement at all
okay so who is generating that update
statement for us
the sequel command builder class and how
is it doing that based on the select
statement that we specified okay and for
the transact sequel statements to be
auto generated by the sequel command
builder class they're basically two
steps step one we create the sequel data
adapter object and specify the Select
query okay now here we are doing that in
two steps first we create the sequel
data adapter object and then we are
using the Select command a property
basically to create a sequel I'm in an
oosik sequel command and then specify or
select query in our example we have done
that in just one line okay so we can do
it even in this way first create your
sequel data adapter object and then use
the Select command property to specify
your select query and the connection
object basically here we are doing it in
one line but let's do it in two lines so
here I am simply going to say sequel
data adapter and then data adapter dot
select command equals we need to create
a new instance of sequel command class
and then specify the command text and
the sequel connection object so where
are we going to get the query from our
view state variable so view state of
sequel underscore query and we need to
typecast that to string and then specify
the connection object the application
should still work in the same way okay
and the next step is to basically
associate this data adapter object with
sequel command builder again you can do
that either in two lines or you can do
it in one line like how we have done it
here or I can simply say sequel command
builder and builder dot data adapter
equals da okay so it should still work
in the same way
let's quickly run this and give it quick
test so let's enter to load let's change
that to Nicholas one male and let's
change that to 790 click update
let's select students record to look at
that it's updated as expected okay so
basically you know this is a very common
interview question as well what is equal
command builder class okay so basically
sequel command builder class
automatically generates insert update
and delete statements based on the
select statement for a single table and
for the sequel command builder to
automatically generate transact sequel
statements there are two steps step one
create your sequel data adapter object
and specify your select query and step
two associate this equal data adapter
object with a command builder or class
and then on you know the command builder
class is going to auto generate the
insert update and delete statements for
us that's it for today thank you for
listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>