<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>jquery dialog save to database | Coder Coacher - Coaching Coders</title><meta content="jquery dialog save to database - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>jquery dialog save to database</b></h2><h5 class="post__date">2015-07-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/l7XeKrk82n8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 90 of jQuery tutorial in
this video we'll discuss how to say what
jQuery modal dialog data to a database
table here is what we want to achieve
notice here we have a database table we
want to retrieve data from this table
and display that in a table on a web
page as you can see here below the table
we have a button which says add new
employee when we click that button we
want to display a modal pop-up like this
and within the model pop-up we have
fields to capture first name last name
and email so once we provide the data
and when we click create button we want
to save the data to this database table
and the pop-up should close
automatically on the other hand if we
click cancel the data should not be
saved to the database table and the
pop-up should close so let's see how to
achieve this the first step here is to
create this database table which I have
already done and here is the create
table script and the next step is to
create two stored procedures the first
stood procedure to insert employee so we
are providing first name last name and
email values to the stored procedure and
this stored procedure is inserting those
values into this employees table the
second stored procedure is to retrieve
all employees from TBL employees table
now let's flip to use your studio within
our web config file I have a connection
string that is pointing to our sample DB
database the next step is to add an
employee class so this employee class is
going to correspond to this employee's
table so let's go ahead and add a class
file to a project so ad we want to add a
class file and let's call this employee
dot cs and this class is going to have
four properties in the interest of time
I have already typed the required code
so let's copy and paste it right here so
we have four public properties all of
them Auto implemented the next step is
to add a web service to a project so
let's write let add a new item and we
want to add a web service and let's name
this web service employee service
and this employee service is going to
have two functions the first function to
save employee data so I'm actually going
to change the name of this function to
save employee and to this function we
need to pass the employee object that we
want to save and this function is not
going to return anything it's just going
to save the employee that we provide to
it and we want this web service to be
called from script so I'm going to
uncomment this script service attribute
and inside this function we're going to
write some ad or net code so let's go
ahead and bring in the required ato name
spaces we need system dot configuration
we need system dot data and system dot
data dot C per client in the interest of
time I have already typed the required
ato dotnet code so let's go ahead and
copy this code from our notepad and
paste it within our save employee
function so this is straightforward ato
dotnet code first we are reading the
connection string from web config file
and storing it in this variable next
using that connection string we are
building a sequel connection object and
then we are building a sequel command
object we want this command object to
execute this SP insert employee stored
procedure since that is astute procedure
we have to tell that to the command
object and then we are creating the
parameters of the stored procedure so we
are creating an instance with the sequel
parameter object the name of the
parameter is at the first name so that's
the name of the parameter and the value
for that parameter is coming from the
first name property of the employee
object and along the same lines we are
creating last name parameter email
parameter opening the connection
executing the non query ok so since it
is an insert we use the execute non
query function okay so straightforward
save employee function I'm going to make
a copy of this so let's make a copy of
this we need another function to
retrieve the employees from the database
and I'm going to call the
is get employees and this function does
not require any parameters because we
are going to retrieve all the employees
from the employees table and the same
idea we are reading the connection
string from web config file will this
equal command connection object and then
the command object now using this
command object we want to execute a
different stored procedure and that is
SP get employees so let's paste that
here and that's a stored procedure and
this stored procedure does not have any
parameters so we can get rid of all
these sequel parameter objects and let's
open the connection and we want to use a
different function we are going to get
some data back so I'm going to use
execute reader function and this
function is going to return us sequel
data reader object so let's call it RDR
equals whatever we get back
while we are looping through each row
within the data reader what do we want
to do we want to construct an employee
object and add it to the list so first
let's go ahead and create a list of
employee object so list let's call it
Employee List employee equals new list
of employee so as we are looping through
each row we are going to construct an
employee object and we are going to
populate each property so employee dot
ID equals leader object leader object
has got ID column and we want to convert
that to an integer so convert dot to int
32
similarly employee dot first-name equals
reader of first name and we want to
convert that to a string we need to do
the same thing for last name and email
so here the property name is going to be
lastname
and the column within the reader is
going to be last name similarly here the
property is going to be email and within
the reader the column is going to be
email so we have constructed the
employer object we want to add it to
this list so list employee dot add
employee object alright so within the
list we have all the employee objects we
want to write that list employee object
to the response stream so let's see
realize that to JavaScript object so I'm
going to use another namespace here so
let's bring in system dot v dot script
dot serialization so within this
namespace we have got a class called
JavaScript serializer
so let's create an instance of that
class let's call the instance GS and
this class has got serialized function
which is going to serialize the object
to a JSON string so let's pass list
employee to that function and whatever
JSON string that we get back we want to
write that to the current context
response stream so context dot responds
dot right all right
so let's go ahead and quickly test our
web service so this web service should
have two functions so get employee save
employee so get employees should return
us the existing two roles that we have
so it's returning us to you know objects
in a JSON string all right so a web
service is working now let's flip to a
visual studio now the next step is to
design you know a web page like this so
first we need you know this modal dialog
so to get that so notice within the
modal dialog we have got first name
textbox last name textbox email and text
box I've got that layout using a table
so in the interest of time I have
already typed the required HTML for that
table so if you look at this HTML it's
straightforward we have a table and
several TRS within each TR
we've got a single TD so here we have
first-name
and in the second TDR we have a text box
for first name similarly last name text
box for last name email and text box for
email so let's copy this HTML and paste
that on overperform so I'm actually
going to create a div element here let's
give it an ID let's call it dialog and
inside this development I'm going to
paste the HTML that we have copied okay
so this entire table is present inside
the development and within our jQuery
ready function I'm going to find that
this development using the jQuery ID
selector so let's create a variable
let's call this dialog div and let's use
the jQuery ID selector and find the
development okay
and on this dialog div element I'm going
to call the jQuery UI dialog function so
let's save that and when we view this
web page look at that we get you know
whatever we have in the div as a dialog
okay now another important thing to keep
in mind is that we don't want this do to
be popping up as soon as the page loads
instead we are going to have this add
new employee button when we click that
button that's when we want that to pop
up so what I'm going to do here is
specify the options for our dialog
function which we discussed in our
previous video session so we don't want
this to auto open so I'm going to set
Auto open to false and we want this to
be a modal dialog so I'm going to set
model to true and if you look at this
dialog here notice we have two buttons
create and cancel we want those buttons
as well so to get those buttons I'm
going to use the jQuery buttons option
that is the dialog buttons option and
here we are going to use a JavaScript
object so I'm going to specify key value
pairs so the key here is going to be
create so this tag
we'll be the text for the button okay
create and the value is going to be a
function so when we create when we click
on this create button this function will
be called we want another button that is
canceled so let's specify another key
value pair so key is going to be
canceled and value is going to be
another function okay all right now we
need a button as well so let's go ahead
and place a button here so I'm going to
include an input element let's give it
an ID let's call this BTN add employee
and the value on the button is going to
be add new employee and the type of this
is going to be button ok so when we
click this button that's when we want
this um dialog to show up
so let's find this button by ID within
our jQuery ready function so let's copy
that so here I'm going to say find the
button using the jQuery ID selector and
when we click the button we want to open
the dialog so within the click event
handler I'm going to again find this
dialog div dot let's call the jQuery UI
dialog function and now we are going to
specify that we want to open the Dare
okay so let's save all these changes and
let's go ahead and refresh our page and
look at this we have a new employee when
we click that button we get the dialog
and at the moment notice when I click
cancel or create nothing happens so when
we click cancel what do we want to do we
want the dialog to close so I'm going to
specify that code right here within this
function so again I'm going to find that
dialog
if so this variable which is pointing to
our development and on that call the
jQuery dialogue function and now we want
to call closed function right so let's
save the changes and reload this one
more time and look at this when we click
cancel now the dialog closes but when we
click create nothing happens all right
another thing that we need to do is when
the web page loads initially we want to
load the data from this database table
in a table right we want to load that
existing data so we need a table here on
the webpage and in the interest of time
I have already typed the required HTML
for that table structure so I'm going to
copy that and paste it just above the
button ok so we have a table there let's
include a break element between the
table and the button element all right
now I'm actually going to write a
function so let's name the function load
employees so here I'm going to create a
function let's call that load employees
so we are going to issue an AJAX request
so let's specify our Ajax options so the
first thing that we want to specify is
our URL so the URL that we want to call
is this employee service so let's copy
the name of the employee service
so that's the URL and within our
employee service we have a function and
that function is get employees so this
is the function that we want to call so
that's the URL that we want to call and
we want to issue a post request so let's
specify the method as post and the type
of data that we are expecting back from
the server is JSON data and when the
request successfully completes we want
to execute some code which is going to
be part of this anonymous function so
what are we going to get back we are
going to get back a JSON array so this
data parameter is going to receive that
JSON array what do we want to do with
that we want to loop through each object
that is present so I am going to use
jQuery each function so dollar data dot
each and we are going to associate a
function
okay so what do we want to do now we
have a table here and if you look at
this table it has got this idea
employees and within the table we have a
tea head and we have first name last
name email headers as you can see here
and then within the table we've got tea
body section so to this tea body section
we have to build a table row with first
name last name email values and append
every row right so first we have to find
this table and its tea body section so
what I'm going to do here within our
load employees function is create a
variable let's call it t body equals
find the table by its ID so the ID of
the table is employees and this table
has t body section with net so it's a
child of the stable so what I'm going to
do is find the table and within that we
have that t body section okay so this
variable is pointing to that P body
section so here we are using ancestor
descendant syntax alright so we have the
t body there now I'm going to create
another variable here as we are looping
through and I'm going to call I mean
specify at TR here let's call it
variable TR equals let's create it TR so
opening and closing TR alright now to
this TR we want to build a TD with first
name last name email and append it to TR
so I'm going to call TR dot append and
what do we want to append we want to
append a TD and inside the TD what do we
want we want first name from the
JavaScript object and we want to close
the TD ok so basically we are iterating
over each javascript object that's
present in this data and we know that
object is going to have first name last
name email properties because you know
the employee object is serialized and
employee object has got those properties
right so this here refers to the item
that we are currently trading over and
we are retrieving first name of that
similarly we need to retrieve last name
and email as well so here the property
name is going to be last name and here
the property name is going to be email
so we have constructed the TR what do we
need to do with that we need to append
that to this T body so T body dot append
we want to append that TR that we have
constructed alright so this load
employees function is going to load
employees from the D Bay so this is a
function when you know the document is
ready we want to call that function so
it's going to load the data that is
already there so I am going to call that
load employee's function all right so
let's save our changes and let's go
ahead and reload this so now we get the
table with the existing employees data
and we click add new employee look at
that we get a dialog now when we enter
these details and when we click create
we want to save those details to the DBA
so I am going to write a function to
save employee data so within our jQuery
ready function I'm going to create
another function let's actually make a
copy of this and I'm going to call this
save employee
and what do we want to do here we want
to issue an ajax request to save the
employee object so first of all we need
to construct that employee object which
we want to pass to the server so i'm
going to call this EMP equals I'm going
to create an empty JavaScript object EMP
that is going to have a property first
name and where are we going to get the
first name from we are going to get it
from the textbox and if you look at the
text box here on this page you know
which is capturing the first name it has
got an ID and the ID is txt first name
similarly last name and email so let's
go ahead and retrieve the value from the
textbox so txt first name is the name of
the textbox and I'm going to use the
valve function of that to retrieve its
value similarly let's go to and specify
last name and email so the last name
then email so we want to retrieve last
name from txt last name textbox
similarly email from txt email so this
employee object now has the data that
the user has entered so now we want to
issue an ajax request
so that's the URL that we want to call
but the function is going to be save
employee and notice this function has an
input parameter right so save employee
is the name of the function that we want
to call and we are going to issue a post
request and we also want to specify the
content type parameter otherwise this is
not going to work so content type is
going to be application forward slash
Jason and the care set equals UTF - 8
okay so we specify that we are going to
send that JSON data to the server so we
need to serialize data to a JSON string
so data equals a JavaScript object and I
want to see realize this so I'm going to
include a string here
and if you remember the same employee
function has got a parameter employee
and the name of the parameter is
employee so employee so to that I'm
going to use Jason dot stringify
function and to this stringify function
I'm going to pass this employee object
so it's going to convert that object
also to a string representation and to
that I'm going to append this closing
bracket okay so we are serializing the
entire data that we want to send it to
the server okay and that's it when the
request completes successfully we want
to call this function but this time we
are not going to get any data back so
I'm going to remove that data parameter
from there so when the request completes
successfully what do we want to do we
want to load the data from the server
again right whatever new row that we
have added we want to load it and to
load the data we have this load
employee's function already defined so
I'm going to call that load employees
all right
so and we also want to close the dialog
right so I'm going to call dialog dev
dot dialog jQuery UI function and we
want to call closed function okay all
right so let's say what changes and
let's read on this let's close the other
tabs and let's click Add employee so
let's pause now John Joe let's say JJ at
test comm is the email and when we click
create look at this for some reason it's
not working let's see why is that so we
have retrieved the data from the UI and
this is the URL that we want to call we
want to issue a post request and the
content type is
for slash Jason character set equals UTF
- eight and the data that we want to
send to the server is that's the name of
the parameter and we are string defying
the employee object and to that we are
finally concatenate in the closing place
and the type of data that we are
expecting from the server is Jason we
are actually not getting any data back
so we may or may not have this when the
request successfully completes you know
we want to call load employee's function
and we want to close the development so
this should work now the reason why it
is not working is because we have
defined the function but we are not
really calling it right so we want to
call this function you know when we
click the Create button right so we
already have a function there so what
I'm going to do is instead of defining
an anonymous function here I'm going to
specify that as the function that we
want to call when the create button is
clicked right so let's save our changes
let's good and run this one more time
let's add a new employee John Doe JJ and
test comm let's try this now click
create and look at that it adds it but
look at why the rules are duplicated
that's basically because initially when
a page loaded we already have these two
rows and when we added that new employee
it's adding all those three rows again
to the table that means we'll have to
clear the existing rows and to do that
so I'm actually going to define a
variable here let's call it variable or
let's specify that within our load
function right so when we load employees
what do we want to do we want to empty
the rows from tbody so I'm going to say
tbody dot empty so that should solve the
problem let's run this one more time so
let's enter an employee ABC
BC a at a calm and look at that now it
doesn't duplicate the Rose all right now
another thing here look at that
when I click ad employee again it's
retaining the old data but for some
reason if you don't want that behavior
then you can actually clear those values
and to do that I'm actually going to
write another simple function so let's
call this function clear input fields
and if you look at these input fields
you know the first name last name and
email text boxes they're actually of
type text and they are present inside
this development of a tidy dialogue so
I'm going to again use the ancestor
descendant syntax so what I'm going to
do is okay find all developments with ID
I mean find a development with ID dialog
and within that development we have
input elements of type equals text okay
so find all input elements of type text
type equals text that are nested inside
the development and on that I'm going to
call the value function and I'm going to
set that to an empty string so pretty
straightforward function so I'm going to
copy this function name and where do we
want to call this we want to call this
when we you know successfully create an
employee so when an employee is
successfully created you know this is
the function that gets called so clear
the input fields and similarly even when
I click cancel you know I enter a couple
of field name of field values and then
when I click cancel I want I don't want
to retain those values so when we click
cancel you know this anonymous function
gets called so in addition to closing
the day go ahead and clear the input
fields as well right so let's save the
changes and look at this now let's good
and add an employee let's say
test test T at T comm add the employee
and look at this when I say add new
employee we lost the values right
similarly for example and now let's say
test and test when I cancel and when I
click add new employee look at that we
lose them again thank you for listening
and have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>