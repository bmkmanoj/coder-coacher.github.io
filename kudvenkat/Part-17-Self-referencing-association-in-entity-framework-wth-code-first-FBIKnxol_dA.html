<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 17   Self referencing association in entity framework wth code first | Coder Coacher - Coaching Coders</title><meta content="Part 17   Self referencing association in entity framework wth code first - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 17   Self referencing association in entity framework wth code first</b></h2><h5 class="post__date">2014-06-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FBIKnxol_dA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this part 17 of entity framework
tutorial in this video we'll discuss
self referencing Association entity
framework with code first approach this
is continuation to part 16 in part 16 we
discussed self referencing association
with database first approach in this
video we'll be modifying the example
that we worked with in part 16 so please
watch part 16 before proceeding now
based on this employee class we want the
entity framework to be able to generate
this employee's table look at the names
of the columns that we have got here
employee ID employee name manager ID
employee ID is the primary key column
and manager ID is the foreign key column
now to get the manager of a given
employee we take the manager ID column
value and look up that value in the
employee ID column of the same table so
this is a self referencing employee's
table and we want the entity framework
to be able to generate this self
referencing table based on this employee
class and that's the reason why we have
these three scalar properties with the
same name as that of these column names
so employee ID employee name manager ID
and addition to these scalar properties
we also have this manager navigation
property look at what this property is
returning employee that's because the
manager of an employee is also an
employee and for the entity framework to
be able to generate this self
referencing employee's table based on
this employee class we need to override
on model creating method and this is
where we programmatically specify the
self referencing Association before we
examine the code that we have here let's
look at the example that we worked with
in part 16 now we were able to generate
the self referencing employee entity
based on the database table okay and if
you look at this entity we have got to
navigation properties here one is called
subordinate and if you look at the
properties of this navigation property
notice the multiplicity here is many
okay now if you look at the manager
navigation property the multiplicity is
0 or 1 because for a given employee
there
maybe you know at the max one manager or
no manager at all for example if the
employee is the CEO or the chairman of
the company then he has no manager for
the rest of the employees there will be
at the max one manager okay so we have
zero or one multiplicity there and to
achieve that zero or one multiplicity
look at that they are using this has
optional method and we are saying a dot
manager not that navigation property but
whereas you know a manager can have many
direct reports who are employees so this
is the other end of the relationship
where we have the many multiplicity okay
so this method here is going to specify
zero or one multiplicity this method is
going to specify the many multiplicity
and we want to manage your ID property
to be the foreign key so we are
specifying that using hash for NP start
simple and we want all this to be
affected on employee entity okay so
let's look at this in action so let's
flip to visual studio so this the same
example that we worked with in the
previous session we don't need this
employee model anymore
which we have generated from the
database so let's delete that and from
the web.config file we can get rid of
this connection string and to this
project let's go ahead and add a class
file and let's name it employee dot cs
and this class is going to have the
properties that we have seen on the
slide and to speed things up I have
already typed the required code so let's
copy these property names and paste them
within this employee class and let's add
another class file to this project and
let's call this employee DB context dot
CS and we want the system dot data
entity namespace and let's make this
class inherit from the DB context class
and this class is going to have a public
property which is going to return DB set
of employee and let's call the property
employees
and we want to override on model
creating method and this is where we
paste the code that we have seen on the
slide so this is the code that specifies
the self referencing Association
programmatically and one last thing that
we need to do is within the web config
file we need to specify the connection
string so let's go to and specify that
all right now if you look at the
database here we already have the sample
database in the employees table within
that so let's go ahead and delete the
sample database and now when we run this
platform one we should have the sample
database an employee's table created now
within the previous session we discussed
this code you know this code is
basically going to display the names of
the employees and their respect to
manage your names so the aspx and its
code behind file is not going to change
in any way so let's go ahead and run
this so it should automatically create
the sample database and we should also
get that employee's table created so the
waveform is still loading so it's trying
to create the sample database and
employees table so it's done now let's
come here and refresh the databases
folder and notice that we have got the
sample database and within that we have
called the employees table and if you
look at the columns we have got employee
ID employee name manager ID employee ID
is the primary key column manager ID is
the foreign key column now at the moment
this table will not have any data that's
the reason why it's not displaying
anything on the webform so let's execute
this insert script so it should have
inserted some data there let's reload
this waveform and notice that we get the
same output in this video we have seen
how to achieve self referencing
association with code first approach
that's it for today thank you for
listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>