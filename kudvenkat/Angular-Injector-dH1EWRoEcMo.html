<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Angular Injector | Coder Coacher - Coaching Coders</title><meta content="Angular Injector - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Angular Injector</b></h2><h5 class="post__date">2017-08-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/dH1EWRoEcMo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 35 of angular 2 tutorial in
this video we'll discuss injectors in
angular in part 32 of this video series
we discussed what is dependency
injection and how it is implemented in
angular there are two simple steps to
use dependency injection in angular for
example let's say we have a component
that has a dependency on its service and
needs an instance of it now in this case
we have our employee list component here
which has a dependency on employee
service now to use dependency injection
there are two simple steps first the
register of a service in this case
employee service with the angular
injector and then within the component
we specify a dependency on the service
using a constructor parameter like this
and that said whenever an instance of
this component is created the angular
injector is automatically going to
inject an instance into this component
so in this video let's talk about this
angular injector in angular 1 we only
had one global injector but in angular 2
we have a hierarchical injector tree so
as you can see here we have one root
injector at the root application level
and an injector tree that parallels the
applications component tree so in short
we can say we have one root injector
plus an injector at every component
level now for these injectors to be able
to inject an instance of a service
dependency we will have to first
register of a service with these
injectors the availability of the
service for injection depends on with
which injector you have registered your
service for example if we register our
service with the route app injector then
that service is available for injection
into all components across our entire
application including the lazy loaded
model components we didn't discuss water
lazy loaded mode
we'll discuss them in detail in our
upcoming videos for now understand if we
register a service with this root
injector then that service is available
for injection to all components across
our entire application including the
lazy loaded module components now if we
register our service with the injector
at the app components level that is at
the root component level then that
service is available for injection to
all components except lazy loaded module
components if we register of a service
with the injector at this component a
level then that service is available for
injection only to this component but not
for components XY and said on the other
hand if we register of a service with
the injector this component X level then
that service is available for injection
into component X Y and said but not
component a now let's understand how
these hierarchical injectors work in
angular let's assume we have our service
registered with this injector at
component X level and then let's say
this component said needs an instance of
that service
so first angular is going to check its
injector do you have the service
registered with you the answer is known
so that request is going to bubble up to
its parent in this case component X so
it's going to ask the same question with
the injector at this component level do
you have the service registered with you
the answer is yes so this injector is
going to inject an instance of that
service into this component set which
needs it and everything works as
expected now let's assume this component
needs an instance of that service so
first angular is going to check its
injector do you have the service
registered with you the answer is no so
the request bubbles up to its parent
which in this case is AB component so
it's going to ask the same question and
again the answer is no so the request
bubbles up further to its parent which
is route injector in this case again the
answer is no here so this request is
going to fail with that famous error
no provider for service now let's
understand how we can register our
services for dependency injection with
these injectors in angular2 register our
service with the route app injector just
use the providers property of NG module
decorator we know every angular module
will have a corresponding class and that
class will be decorated with NG module
decorator to turn it into an angular
module so just use the providers
property of that NG module decorator to
reach to your service with route app
injector on the other hand if you won't
register your service with an injector
at a specific component level then just
use the providers property of the
component decorator now we know every
angular component has got a
corresponding class and that class will
be decorated with at component decorator
so just use the providers property of
add component decorator to register your
service with an injector at a specific
component level let's look at all these
in action now this is the same example
that we worked with in our previous
video and here we have our user
preferences service which we are using
both within our home component as well
as within our Employee List component
now for this service that is for the
user preferences service to be available
both within the home component and
Employee List component we have
registered it with this route app
injector by using the providers property
of ng module decorator so if you look at
our route module which is apt at module
tortillas notice here we're using the
providers property to register our user
preferences service with the route app
injector so whenever the home component
or employee list component needs an
instance of it the route app injector is
going to provide that so everything
works as expected now let's try to
register our user preferences service
with just the home component and to do
that we can use the providers property
of the component decorator of that
component class so let's do that
so first let's remove the provider
our route module AB dot module dot yes
and then let's go to our home component
and then we can include the providers
property within this component decorator
so let's include that here providers and
then let's specify our user preference
service there and then if you look at
our employee list component notice here
we don't have the providers properly so
at the moment we have registered our
service with the injector at this home
component level so the service will be
available only for the home component
and not for the employee list component
so when we navigate to employee list
component we should get that famous
error no provider for user preferences
service that's actually proved that
let's save our changes and reload notice
the home component works as expected now
let's navigate to employ a list
component it doesn't display anything
let's launch browse the developer tools
and investigate what's going on we are
on the console tab we've got one error
and look at what the error message says
we got that famous error no provider for
user preferences service and we know the
reason why we are getting this error at
the moment we have this user preferences
service registered with the injector at
home component level and now our
employee list component needs an
instance of that service so angular is
first going to ask its injector do you
have the user preferences service
registered with you
the answer is known so the request
bubbles up to its parent that is the
injector at our root component level
which is AB component and again the
answer here is no so the request further
bubbles up to its parent again here the
answer is no so we get that famous error
new provider for user preferences
service one way to fix this error is by
registering our service again with the
injector at our Employee List component
as well but that's not a very good thing
to do because by doing so we are
effectively registering your service
twice once with the injector at
component-level and the second time with
the injector at our employee list
component level by registering the
service more than once we no longer get
a singleton that is a single instance of
the service when we don't have a single
tun then we will not be able to share
data between these components let's
actually prove that so at the moment we
already have the user Preferences
service registered with the injector at
home component level now let's register
that with the injector at employee list
component as well by including the
providers property within the component
decorator of our Employee List component
class let's save our changes and reload
our webpage notice the home component
works and employee list component also
works as expected but the problem at the
moment is we no longer get a single
instance of the service because we have
registered of a service twice once with
the injector at the home component level
and the second time with the injector at
the employee list component level and
this is how it works when the home
component requires an instance of the
service angle is first going to check
with the injector at that home component
level do you have the service registered
with you the answer is yes so this
injector is going to create an instance
of the service and inject that into the
home component and the same thing
happens with employee list component
when this employee list component needs
an instance of the service its first
going to check with the injector at that
component level do you have the service
registered the answer again in this case
is yes so this injector is going to
create a new instance of the service and
inject that into this employee list
component so now we have two instances
one instance created by the injector at
the home component level and another
instance created by the injector at
Employee List component level because we
don't have a singleton we will not be
able to share data that's actually prove
that at the moment we are on the
employee list component and we see the
default color
which is orange now let's change this to
ello now if we have a single instance
between home and employee list component
then when we navigate to the home
component we should see this yellow
color and not orange but look at what
happens when we go to the home page we
see the default color orange that's
because at the moment we have two
instances of user preference service one
instance provided by the angular
injector at home component level and the
second instance provided to the employee
list component by the injector at that
employee list component level to
properly fix this we may register a
service with the injector at the parent
component level in our case the parent
for whom component and employee list
component is the route component when we
register our service with the injector
at the root component then that service
is available for injection into all
components except lazy loaded module
components if you want your service to
be available for all components
including the lazy loaded module
components then register your service
with the route app injector the general
guidance for service registration is if
you want to restrict your service
availability to a specific component
then register your service with the
injector at that component level but if
you own the service to be available for
all components then register it with the
route app injector using the providers
property of ng module decorator
now let's register our service once with
the route injector so first let's remove
the service registration from our
employee list component by removing this
providers property let's do the same
within our home component as well so
let's remove the provider property and
then let's register our service with the
route injector so let's include use a
preference service as part of the
providers property within this @ ng
module decorator so at the moment we
have our service registered with the
route injector so let's save all these
changes and reload of webpage notice at
the moment on the home component we see
the default color which is orange now
let's
change this to ello now if we have a
single instance being shared between
home component and employee list
component when we navigate to employee
list component we should see this ello
Kalla so let's navigate to employee list
component you see the yellow color and
now when we come back to home we see
that same a local ax if we change this
to pink and when we go back to the home
component we should see that pink color
so at the moment we have a single
instance being shared between home and
employee list component now let's
understand how our application is
working with the help of this diagram at
the moment we have our user preferences
service registered with the route app
injector when this home component needs
an instance of that service now first
angle is going to check with the
injector that component level do you
have the service register with you the
answer is no so the request bubbles up
to its parent so angela is going to
check with the injector at this
components level again the answer is no
so it bubbles up further to the route
app injector we have the service
registered here so it's going to create
an instance of the service and inject
that into our home component when we
navigate to employee list component this
component also has a dependency on the
service so first angle is going to be
checked with the injector at that
component level do you have the service
registered the answer is no so the
request bubbles up to its parent again
here the answer is no so it ends up at
the route injector root injector already
has an instance of user preferences
service so it's going to inject that
same instance into employee list
component as well so here we have a
singleton and with the help of that
single instance of the service we are
able to share data between our home
component and employee list component
thank you for listening and have a great
day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>