<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 17   Strongly typed datasets | Coder Coacher - Coaching Coders</title><meta content="Part 17   Strongly typed datasets - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 17   Strongly typed datasets</b></h2><h5 class="post__date">2013-10-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/fTPc9bCZrnY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 17 of a do dotnet tutorial
in this video we'll discuss what is
strongly typed data set ace advantage of
using strongly typed data sets overrun
typed data sets and how to generate a
strongly typed data set using Visual
Studio let's understand strongly-typed
data sets with an example let's first
design a waveform that looks like this
let's flip to visual studio here I have
a new asp.net webforms application first
let's set the style attribute on the
stip tag and let's set font family to
ATL let's now drag and drop a text box
control onto the waveform and then a
button control and finally a grid we
control grid view control is present
under the data tab so let's drag and
drop that now let's flip this waveform
to the design mode double-click on the
button control to generate the click
event handler we're going to write some
ad or dotnet code here so let's bring in
the required namespaces the required
system the data system dot data dot
sequel client and system dot
configuration
within a web config file I already have
a connection string with named DB CS
which is pointing to sample database on
my machine so here we have sample
database and within that we have this
table TBL students so we need to
retrieve the students information from
this table and display that within the
grid view control now to encapsulate the
student information let's create a
student class with properties ID name
gender and total marks so let's flip to
visual studio let's add a class file to
this project and let's call it student
dot CS and to speed things up I have
already implemented the properties so
let's copy that code and paste it right
here and this is very straightforward
code with for auto implemented
properties ID name gender and total
marks so within the page load event if
not is post back so if if we have a get
request for this page at that point of
time execute the code that we are going
to write here now we are going to write
some media dotnet code here again to
speed things up I have implemented that
all today so let me copy and paste that
right here and this is very
straightforward ato dotnet code that we
have been writing in a previous sessions
of this video series so what is this
code doing here we use in configuration
manager class to read the connection
string from web config file and using
that connect connection string we are
creating an instance of sequel
connection class and we have our select
query here which is again very
straightforward select star from TBL
students so using this select query and
this connection object we are creating
an instance of sequel data adapter now
let's go and create an instance of data
set let's call it data set equals new
data set so here this data set is not a
strongly typed data set data sets that
are not strongly typed are also called
as untyped data set now
let's invoke data adapters fill method
and fill this
data set object that we have created and
we want the data to be stored in
students table within this data set now
let's go and set data source for the
grid we control now we have created the
student class now within the students
table every row is a student object so
we want to convert every data row that
is present in the students table into a
student object and we want to set that
student collection as the data source
for the grid view control now to do that
we can use for H loop but let's write
some link code here okay so we already
have system dot link namespace on this
web form so from data row in data set
dot tables so within this data set the
name of the student table is students so
now I'm going to invoke as enumerable
function so what is this function going
to return look at that this function is
going to return us enumerable row
collection of data row which allows us
to write link code against that set of
data rows that are returned okay so
basically what we want to do is we want
to select a new student object and then
this student class has got four
properties I rename gender and total
marks so let's populate them using the
data row using every data row that is
present within you know this data row
collection okay so data row of ID should
give us student ID but this code here is
going to return the ID in an object
format but we need to convert that to
integer because this property is India
so let's go and use convert class
and convert that to integer and we have
other properties as well so let's
initialize name again data row off name
name string so let's go ahead and
convert that to a string and similarly
we need to initialize gender property so
gender equals data row of gender and
finally total marks which is equal to
data row of total marks okay so this
piece of code is going to loop through
everyday Tarot and create student
objects for us and that collection of
student objects is going to be the data
source for the grid we control and now
let's invoke data bind method okay at
this point let's go and run this
application so when we run the
application a get request will be issued
for wave form one dot aspx so we should
be able to retrieve all the students
information and display that within the
grid view control as expected now we
want to provide search functionality as
well let's say for example if I enter
letter M here and then click this button
we want to display all the students
whose name starts with letter M okay so
let's see how to implement that now keep
in mind here we are storing this we are
going to store this data set now in a
session variable we haven't done that
yet so let's store that in a session
variable using this K data set so that
when we click this button we don't have
to make another trip to the database so
we are going to retrieve the data set
from the session variable when we click
the button so within the button click
event handler the first thing I'm going
to do is retrieve the data set from the
session variable so data set equals let
leave that from the session variable
let's typecast this two data set okay so
we have the data set with all the
student rows now I'm actually going to
copy this piece of code and paste it
right here okay
now if the end user didn't enter any
name here and then if I click the button
we want to list all the students okay
so if this textbox doesn't have any name
of the student then we want to list all
the students there so basically we are
going to check if the value within the
textbox is null our empty
so if textbox one dot text is null or
empty what we want to do we basically
want to let you all the rows from the
data set and display all the students
within the grid we can draw that's what
the space a piece of code going to do
else if it is not null or empty meaning
the end user has typed something then we
are going to change this code a bit so
we want to filter the rows based on what
the end user has typed within this
textbox
so before we select I mean before we
construct a new student object we are
going to use a where clause here okay
where data row off name dot to string
and let's convert that to upper for
comparison so if that name starts with
whatever the end user has typed within
the text box and let's again convert
this to upper for comparison so if the
name that is present within the
respective data row if it starts with
whatever characters that the end user
has typed in the text box then go ahead
and construct a new student otherwise
you know the student object will not be
constructed so it will be excluded from
the result okay
a simple where Clause here all right so
let's go ahead and run this and see if
this
which functionality works as expected so
let's type letter M click the button
look at that we got get our students
that we expect let's type letter A the
button ok so it's working as expected
so here we have implemented this code
using untyped data set a data set that
is not strongly typed let's see how to
achieve the same thing using a strongly
typed data set let's add another webform
and let's call it the form 2 dot aspx
and now first let's see the steps to
generate a strongly typed data set now
first we need to add a data set object
over a project so right click on the
project name add a new item click on the
data tab under installed templates and
select data set let's give this data set
a meaningful name let's call this
student data set look at this the file
extension is x SD XML schema definition
ok now the name of the file is student
data set so now click on View and then
select server Explorer so now this is
going to connect look at this within the
server Explorer we have data connections
and the data connections expand your
sequel server installation under that
expand tables and this should list all
the tables within our sample database
here so we see all the tables right here
so we want to generate I strongly typed
the data set for student table TBL
students so all we need to do from the
server Explorer is drag and drop that
table onto the designer so this is going
to create a strongly typed data set and
look at the name of the data set here it
says TBL students but let's change that
to students and let's save the changes
so here we have a strongly typed data
set now if I expand the student data set
or design or dot CS look at this
we have student data set which is a
strongly typed data set and it is
inheriting from the data set class so
all strongly typed the data sets inherit
from data set class okay
so within our waveform to dot aspx so
within the page load event if not is
post back so student data set table
adapters namespace within that namespace
i have something called students table
adapter okay
so let's create an instance of that
let's call it students table adapter
equals new student table adapter again
within students data set there's
something called students data table
look at that I'm getting intelligence
everywhere
so here we are creating an instance of
students table adapter object now we are
creating an instance of students data
table and let's call the object as
students table equals new students table
so we have the data adapter object we
have the data table now all that is left
is on this data adapter we have fill
method again just like how we have fill
method with sequel data adapter so we
want to invoke the fill method and we
want to fill this table with students
data okay so we have students
information now within this students
data table okay now let's go and set
data source for the grid view control
so on the grid we control B first I mean
on this waveform we first need to have
the grid we control to speed things up
let's copy and paste the design that we
already have on webform one dot aspx so
let me copy that and paste it on
waveform two dot aspx okay so within the
code behind grid we won that data source
again we are going to write some link
code here so from let's call the
variable s student in look at that
what is the students table going to
contain it's going to contain student
objects so from student n students table
so basically we want all the students
okay and we want to create a new
anonymous object here so let's select
student dot ID look at that I am getting
intelligence even on the student object
automatically here I don't have to loop
through rows here because this is a
strongly typed data set we'll talk about
those differences in just a bit
so we need student dot ID we need
student dot name
we need student dot gender and we need
student dot total marks
and let's invoke data bind method so
grid view 1 dot data bind okay so let's
go ahead and run this but before we do
that let's flip this waveform to the
design mode and then double click this
button to generate the click event
handler let's run this now okay look at
that we're on waveform to dot aspx and
we have the same behavior all the
students information is retrieved and
displayed but on this waveform we are
using a strongly typed data set let's go
and implement that filtering as well
okay so if same kind of code if string
dot is null are empty so if the end-user
didn't enter anything within the textbox
control then we want to display all the
students so first of all we need to
store this students data table within a
session variable so let's go and do that
so session off let's use this key data
our table equals our students data table
and here let's go ahead and retrieve
that student's data table let's copy
this code so students data table equals
whatever we have stored in the session
so session of data table and we need to
type gasps that okay so at this point we
have students data table all that is
left is to copy this piece of code and
paste it right here okay on the other
hand actually let's move this code out
of the if block because we need a
student's data table in the else block
as well okay so now I'm going to copy
this piece of code and paste it here as
well but if the end user has typed
something within the textbox then it
will not be null or empty which means
it's going to come to the else block in
which case we want to filter it so let's
use a ver class where student dot name
dot two up r dot starts with whatever
the end user has typed with in the
textbox so textbox dot text dot to upper
okay so the same kind of code again so
let's run this and see if it works in
the same manner so I enter letter M
click the button liquor that we only get
students with that starts with letter M
and we get the output that we expect all
right so we have implemented the same
functionality using an untyped data set
and a strongly typed data set so what
are these strongly typed data sets
strongly typed data set is generated
based on the database schema if you
recollect how we have
generated the strongly typed data set
you know we dragged and dropped it from
the server Explorer on to the designer
so based on this table you know the
typed data set is automatically
generated okay so basically strongly
typed data set is generated on the
database schema based on the column
types you know the data types for the
student class is inferred so using the
database schema you know the strongly
typed data sets are generated and
strongly typed data set derives from
data set class we have seen that as far
within the designer so this student data
set is inheriting from system load data
dot data set class in a strongly typed
data set the database table columns
become properties and the type
associated with each column is known at
design-time so now if you look at this
piece of code that we have written on
webform to dot aspx so here we have you
know we are retrieving each student
that's present in students table and
look at this i have intelligent student
dot ID what is that that's an integer
student dot name a strain gender string
total marks integer so at design-time we
know the types of each properties of the
student okay but whereas if you look at
the other piece of code on webform one
dot aspx way we are not using a strongly
typed data set so if you look at this
code here look at this you know this is
the student class that we have created
now to retrieve the ID column value we
are using this string index er here the
name of the column now if I misspell
this column name here look at this
instead of ID if I say ID one and if we
go ahead and build the solution do we
get any compile time errors look at that
it says build succeeded so that compile
time will not know about the errors so
if I run this now when it loads at run
time you know actually they be
implemented this in the click event
handler
so when it is null are empty so if we
don't have that we click this button we
are going to get an exception look at
that it says column ID 1 does not belong
to table students so that's the problem
with untyped datasets
you can't catch the errors at compile
time if you misspell them okay but
whereas with the strongly typed datasets
so if you look at the strongly typed
data set so instead of ID if I say ID 1
look at that we get an error right away
there is no property with name ID 1
basically so that's the advantage of
using strongly typed data sets you have
intellisense number one and number two
if you misspell anything you will know
about them at compile time itself so in
a strongly typed data set the database
table column speaking properties and the
type associated with each column is
known at design-time so what is the
advantage of using strongly typed data
sets over run type data sets since in a
strongly typed data set the database
table columns become properties and the
type associated with each column is
known at design time development is much
easier as we have intellisense and any
errors to related to misspell to column
names can be detected at compile time
itself rather than at run time that's it
for today thank you for listening have a
great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>