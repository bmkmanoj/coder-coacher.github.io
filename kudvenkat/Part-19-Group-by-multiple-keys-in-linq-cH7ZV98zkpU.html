<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 19   Group by multiple keys in linq | Coder Coacher - Coaching Coders</title><meta content="Part 19   Group by multiple keys in linq - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 19   Group by multiple keys in linq</b></h2><h5 class="post__date">2014-07-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/cH7ZV98zkpU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this part 19 of link tutorial in this
video we'll discuss grouping by multiple
keys an anonymous type is usually used
when we want to group by multiple keys
let's understand this with an example
let's flip to visual studio so here I
have a new console application all I
have done so far is added this employee
dot C S Class file to this project here
we have the employee class this is the
same class that we worked with in the
previous session I would strongly
encourage you to watch part 18 before
proceeding with this video if you have
not done so already now what we want to
do is whatever employee list that this
get all employees method is returning we
want those employees to be grouped first
by department and then by gender notice
that here we are grouping employees by
two keys that is Department and gender
so anytime we want to group by multiple
keys that's when we use an anonymous
type we look at that in just a bit so
once we group the employees by
Department and by gender we are going to
have four different groups so we have HR
department and IT department groups and
within HR department we have caught both
female and male employees and with an IT
department again we have both failed
female and male employees so we will end
up at four different employee groups now
once we have these employee groups we
want these groups themselves to be
sorted first by department and then by
gender notice that in the output we
first have the HR department and then IT
department and within HR department
notice that female employees group comes
first and the male employees group come
next which means again they're sorted in
ascending order the same is the case
with IT department as well and again
within each department we've got
employees and those employees should be
sorted by name in ascending order so
let's see how to achieve this so let's
flip to visual studio so within the main
method first let's create a variable to
hold these groups and let's call these
variable employee groups equals so we
have the employee class dot get all
employees is going to give us the
stuff employees and what we want to do
these employees is group them and we
want to group them by multiple keys that
is first by Department and then by
gender so that's when we use an
anonymous type so new expert we first
want to group by Department and then by
gender so as it is this query right now
is going to give us these four different
groups now what we want to do with these
groups we want to sort these groups
first by department and then by gender
so we are going to use order by group
such that group dot now this is
interesting
notice the key property here the moment
I type a dot after key notice that we
have Department and gender properties
why because both of these properties
form the keys by which we have grouped
the employees so we want the first order
by Department and then by G such that G
dot key dot gender so now we have the
groups sorted all that is left now is to
sort the employees within each group and
for that we are going to project this
result into a new anonymous type so
select G such that let's build a new
anonymous type
and within this anonymous type will
specify the properties that we want we
want the department name so de PT equals
G dot G dot Department and we also want
the gender so gender equals G dot P dot
gender and B also on the employees
themselves so let's call the property
employees equals G now what do we want
to do with these employees we want to
sort them by name in ascending order so
we are going to use order by extension
method and specify the lambda expression
to sort the employees by name in
ascending order all right so what's left
now is to use a for each loop and then
print the output so console dot write
line so how do we want the output first
we want the department name and then
this word department and then the gender
employees count equals whatever is the
count of employee so basically we need
three placeholders one for the
department name one for the gender and
one for the total count so that's the
first placeholder of a department name
department and then the second place
holder for gender employees count equals
and the third placeholder for the actual
count okay now we need to use a for each
loop so let's go to end right before
each loop so for each value in employee
groups all right so we need to retrieve
the group key so group dot key dot I
mean now we will not have key property
you know within this group why is that
that's because here we are actually
projecting the key dot Department into
this property called DEP D similarly
gender into this property and employees
into this property so we will now have
to use these properties so group
DPD and next we need the gender and then
finally the count so group dot employees
dot count
so let's actually bring this to the next
line okay so once we print this line
what do we want we want a dashed line so
let's go ahead and put that line now
console dot readline and then we want
the employees themselves so let's use
another for each loop so for each wear
employee in group dot employees so that
property is going to give us the
employees within each group and all that
is left is to print the employee name
the gender and department name so come
slow Detroit line we want to print the
employee name and then let's print the
back you know tab space and then
employee
gender and then another tab space and
then finally the department all right
and then also in the output we want you
know a an empty line after each group so
let's use two console dot readline
statements here all right so let's go
and run this notice that we get four
groups in our first week at the HR
department and then the IT department
and within HR we have female employees
group first and then male employees
group and the same is the case for IT
department and within each group
employees all sorted by name in
ascending order all right so now here we
have used extension methods in textile
now let's see how to rewrite this query
using sequel like syntax so let's equal
like syntax we'll start with the from
keyword so
from let's call the variable employee in
employees get all employees and what we
want to do is group employee by we want
to group the employees by you know two
keys so we are going to use an anonymous
type so group by so we want to group the
employees first by Department and then
by gender so let's project in our dis
groups into a variable called a group so
next what we want to do we want to order
you know the groups themselves first by
Department and then first by Department
and then by gender so order by each
group dot key dot Department and then we
want to sort by gender okay so once we
have the group sorted we need to know
you know project these into an anonymous
type and populate the required
properties so select new so what we want
we want this TPD property equals so
where are we going to get the DPT
property from a group dot key dot
Department and similarly we want gender
property and that we are going to get
from gender property of the key and then
we want employees employees equals this
group and we want the employees within
the group to be sorted so we'll use
order by X such that X dot name alright
so let's go ahead and run this and see
if we get the identical output look at
that again we have got four groups first
HR and then ID it our groups are sorted
by gender and also employees within each
groups are sorted by name in ascending
order
and this is exactly the code that we
have written on the you know in the
example list now that's it for today
thank you for listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>