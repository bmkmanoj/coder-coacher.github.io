<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>asp.net detailsview insert update delete without using data source controls - Part 42 | Coder Coacher - Coaching Coders</title><meta content="asp.net detailsview insert update delete without using data source controls - Part 42 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>asp.net detailsview insert update delete without using data source controls - Part 42</b></h2><h5 class="post__date">2013-04-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/8V2-djYlmw4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to blazing Technologies I am
fainted this is part 42 of asp.net
grid-view tutorial in this video we'll
discuss about inserting updating and
deleting data from details view without
using any of the data source controls in
part 40 we discussed about using sequel
data source control and in part 41 we
discussed about using object data source
control in this video we'll achieve
exactly the same thing without using any
of the data source controls please watch
parts 40 and 41 before proceeding with
this video so we need a grid we control
on our waveform so let's flip to visual
studio drag-and-drop a grid view control
onto the waveform let's set the auto
format of this grid view one control
alright when the waveform loads within
the grid view control we want to display
ID first name and city columns you know
within the grid view control if you
remember in the previous session we have
implemented employee data access layer
and this layer has got methods to select
insert update and delete employee
details okay so we are going to make use
of this employee data access layer we
discussed about implementing this in the
previous session so it's strongly
recommend to watch but 41 before
proceeding with this video alright so
within the waveform one page load event
if not is post back meaning if it is the
initial get request what we want to do
we want to retrieve the employee details
and then display them within the grid
view control so I'm going to use
employee data access layer which has got
this method get all employee basic
details and if you look at the
intelligence it's going to return a list
of employee basic objects this basic
employee basic object has got those
three properties ID first name and city
columns so this is going to act as the
data source for our grid view one
control so grid view one dot data source
is going to be that one and let's invoke
the data bind method as well alright now
we will be reusing these two lines of
code you know on this page elsewhere so
I'm going to encapsulate these two lines
into its own private method so wherever
we need these two lines of code we just
invoke that private method and I'm going
to call this as grid view data bind
alright okay so we have our private
method and we are calling that within
the postback event now another thing
this grid view control should have you
know a select button displayed okay and
to do that grid view control has got a
property auto generate select button you
know which is false by default I'm going
to turn this on okay so we have the
select button there so now let's run
this and see what's going to happen when
the webform loads obviously you know the
grid view control should display let's
actually set this platform 1 as our
start page and now let's run this so the
waveform should load with all the
employee basic details and we should
also have the select button when I click
select the employee row should be
selected within the grid view control
okay and then for the selected employee
we should show his details within the
details view control so let's drag and
drop a details view control as well onto
this waveform and let's set the auto
format for this one to brown sugar
alright so the next thing is within the
details view we want edit delete and new
link buttons basically to support
editing deleting and inserting okay and
to do that this details view has caught
these properties auto generate you know
basically delete button said that to
true which will show the delete button
edit button to true and auto generate
insert button okay so that should show
edit delete and new alright so as soon
as we select a row within the grid view
control now for that selected employee
we want to display all their details
within the details view ok and to do
that we need to you know when we select
a row within the grid view control what
even does the grid view control raise
it's going to raise selected index
changed event okay so let's go ahead and
generate even handler for that event
selected changed index changed event so
click on the events icon and then double
click on selected index changed event
okay so within this we want to write
code to basically retrieve what the
employee details and to speed things up
I have that already typed so let me copy
and paste that within that event handler
method and if you look at this it's
pretty straightforward look at this we
are you saying selected data key
property of the gridview control okay so
if we have to use the selected data key
property then obviously we have to
specify what is the data key name for
this clip you control so if you look at
this grid view control it's display
three columns ID first name and city so
that data key is going to be the ID
column so we need to set data keys to ID
data key names property to ID all right
so when we select a row obviously there
will be a selected data key and then
look at this so if the selected data key
is not equal to null then I am saying
turn on the visibility of the details
view control and then look at this we
are creating a list of employee object
here and then we are invoking look at
this I'm using this employee data access
layers method get employee full details
by ID so for the selected employee we
need to retrieve the employee full
details okay and we have a method which
can do that but then this expects an
employee ID to be passed into the method
so how are we going to retrieve the ID
of the employee you know on which you
know the row which we have selected in
the gridview control how are we going to
retrieve the ID it's very simple all we
need to do is look at this I'm using
grid view one dot select the data key
property and if you look at selected
data key it's actually returning a data
key object which has got a value
property which will return that value as
an object type so we need to typecast
that to integer that's what we are doing
and then we are passing that entire
thing to this get employee full details
by ID method which is going to return
and employee object and we are adding
that employee object to this list and
then we are setting that list as the
data source for the details view control
you might be wondering why can't I set
an employee object you know as the data
source you know we dismiss about this in
the previous session we get a runtime
error so to solve that we are using a
list or object and adding that employee
to the list object
and the list is then set as the data
source for the details view in work data
buying on the other hand if the selected
data key is null then we know we don't
have any row selected within the preview
control in which case we don't want to
display details view at all that's why
we are setting details q1 dot visible is
equal to false so pretty simple and
straightforward so let me run this and
see what's going to happen so obviously
in the waveform loads we should have all
the employees there select the employee
look at this so we have the selected
employee details here now there are
several problems here we'll fix them
first of all let me click Edit here okay
the details view one fired event mode
changing which wasn't handled okay
so let's understand this look at this
error message the details view fired
event mode changing which wasn't handled
okay so what does that mean when I click
Edit the mood of this details fear
control is changed meaning from
read-only mode we are trying to put this
details view into edit mode similarly
when I click new we are going to put
that into insert mode at that point you
know when we click Edit or new you know
the mode of this details we control
exchange you know at which point it
raises an event and we need to handle
that even otherwise we get the runtime
exception as you can see here so there
is this event mode changing so let's
implement that so let's flip this
waveform to the design mode go to the
properties of the details view control
click on the events icon so we have this
event mode changing so when this event
is fired what I basically need to do is
I need to tell the details view control
to change the mode so change mode to the
new mode okay how do I know what is the
new mode going to be did the user click
the new button or edit button how will I
know that you can make use of this
details view mode event arguments object
so I want to change the mode of the
details view control to its new mode
okay and then look at this after I
change it to its new mode I need to do
the data bind once again to the details
we control okay so I will basically have
to
right all these lines of code there so
instead of duplicating this code what
I'm going to do is I'm going to
encapsulate all these lines into you
know its own private method so let's
right-click on that refactor extract
method I'm going to call this details
view data bind click ok so we have that
you know all that lines of code
encapsulated into a private method and
we are calling it there in the selected
and exchanged event similarly I'm going
to copy that and use that within this
mood changing even handler method so now
let's run this and see if it works as
expected
so now when we change the mode we
shouldn't get the runtime error anymore
so I'm clicking edit look at this now it
works as expected but here we have a
problem look at that the ID field I
don't want that to be editable because
that's the primary key and we don't want
users to be changing primary key and to
solve this all you need to set this time
eeen there are two ways to solve it one
is you can set you know the ID column
within the details view control as
read-only or you can set the data key
names property of the details you
control let's go ahead and set a details
view property I mean data key names
property of the details view control so
data key names is going to be ID okay so
with that change let me run this and see
if ID column is editable within details
view control so when I click that so we
don't have the problem anymore it's
solved now so ID is read-only but then
let me cancel this and let's click new
and look at this when I am inserting you
know when I when I put this details view
in insert mode look at the ID it is
still asking the end user to provide a
value for that
but remember ID column is an identity
column within single server and for an
identity column we don't have to supply
a value when we insert a new row so
there's no reason why we have this ID
field here ok so how do I get rid of
that you know obviously the easiest way
is to set
insert a visible property on that bound
field to in our Falls but then if you
look at the details view control at the
moment we don't have any fields there
all the fields that you see within the
details view control they are
auto-generated okay so if I have to set
insert visible property on that field
then I'll have to you know specify the
field names at the design time rather
than allowing them to be auto-generated
okay so obviously I have ten fields here
last name gender date of birth etc so we
need to design all the 10-pound fields
at design time so let's go ahead and do
that and obviously the easiest way to do
that is by using the designer so click
on edit fields the first thing we don't
want the needs to be auto-generated so
I'm going to uncheck this and I want to
add a ten bound fields here and then I
want to set you know for the first bound
fear let's say I want to display you
know basically in TBL employee table we
have around ten columns so we have ID
first name last name city etc we have
ten columns here okay so we need to set
up you know all these as the bound
fields so the header text is going to be
ID and the data field is also going to
be ID and we have to do that for first
name last name etc okay now let me
remove the other bound fields for the
time being let's say I have only ID here
and when I click OK here and if I flip
the source mode all it has done is it
has added this fields collection and
then I have this bound field there so we
have to you know do this for all the
rest of the columns
you know our first-name lastname etc and
just to speed things up I have that
already typed here instead of spending
time to do that manually here so I'm
just going to copy and paste those here
and let's format this HTML by pressing
ctrl K and D okay so if you look at the
bound fields we have ID first name last
name city gender etc now remember I
don't want this ID field to be editable
so if that's the case we can set a
read-only
to true and we also don't want that to
be
visible you know when the details view
is rendered in insert mode so I'm going
to preset insert visible is equal to
false so that should solve that problem
so let me run this now and see if we
have that problem gone so Nick I'm going
to say new look at that I don't have you
know a ID column anymore there and look
at this the columns are also in the
order that I expect them to be alright
so all that is left right now is when I
click Edit and when I try to let's say
let's change the first name of Nick from
Nick - Nick 1 and let me try to update
this I get a runtime error so
detailsview one control has fired an
event item updating which wasn't handled
so obviously we need to implement I mean
handle this event so let's go ahead and
generate even handler for that one so go
to the design mode or the properties by
pressing f4 click on this events icon so
item updating event so double click on
that to have the event handler generated
and obviously when I am updating the
item you know I can make use of this
update employee method in employee data
access layer okay so within employee
data access layer we have update
employee method but if you look at this
method you need to pass in ID first name
last name you know all the new values so
obviously how do I get the ID of the
employee who's row we are editing it's
very easy we can make use of the
selected data key property of the
gridview control right because that's
what is selected within the grid view
control and that's what is displayed
within the details view control so I'm
going to copy this piece of code
so let's say end employee ID is equal to
that one so we can pass that employee ID
to this method and then we need to
retrieve the first name last name city
etc so how am I going to retrieve them
we can make use of this details view
update event arguments object so e dot
we want the new values so I'm going to
use the new values property so if I you
know the initial value for Nick was Nick
but I changed it to Nick one that's the
new value so if you want the old values
you can use u dot old values property if
you want the new values we can use new
values because we when we are updating
the database we need the new values okay
so I'm going to use the new values and
then this is actually a dictionary I can
specify the key and then get the value
so I need the value for first-name so to
retrieve the value for first-name I am
just going to say first-name and this
will be returned in the form of an
object because it could be any datatype
right look at this when I give a key
it's going to return an object we need
to convert that to string okay so we
need to do the same thing for last name
city gender you know date of birth etc
and just to speed things up I have that
already typed so let me copy that and
paste it within this method
okay so if you look at this code it's
again pretty straightforward it's the
same thing it's just that we are trying
to retrieve the values for all of the
parameters okay so once we update the
table then what we need to do we need to
change you know when I click update here
what's going to happen it's going to
take these values and update the
database table but then it will still
remain in this edit mode we don't want
that to be in edit mode once the
database table is updated we want to get
it we want to change the mood of this
details view control and to do that I'm
going to use the change mode method of
details view control change mode to
which more do we want to change it to
read-only and then we don't want you
know basically anything to be selected
within the grid view control so I'm
going to say grid v1 dot
select row 2 minus 1 meaning don't
select any row within the grid view
control and then call the data bind on
grid view okay we can't call data bind
because the data source for the grid
view control is set dynamically so we
need to call this method grid view data
bind so let's call that instead of
preview one door data bind all right
so now you know when we edit and try to
update it should work as expected so I
select Nik edit that let's update Nick -
Nick 1 and then say so update look at
that the first name is updated to Nick 1
I select that you can see the updated
data there all right let's see you know
if I try to delete this for example
right now look at this I get an error
the same is the case with new as well
ok so when I try to insert here I look
at this you know detailsview fired event
item inserting which wasn't handled so
we need to generate even handlers for
item inserting and item deleting ok just
like how we have done it for item
updating so let's do that
so item inserting and let's also
generate the event handler for item
deleting ok so what should happen when
item inserting event is raised obviously
we need to take those values and then
populate a you know that method so
obviously we have this employee data
access layer method which has caught
I mean method insert employee and to
this method we need to supply the values
for all these parameters first name last
name how am I going to get the values
for them again I can use this grid view
I mean detail so you insert event
arguments object so e dot I have values
now look at this I don't have old values
and new values properties here because
when we are inserting there is no
concept of old values all of them are
going to be new values ok so I'm just
going to use a dot values property and
you know just like how we have used
before first name and that's a string so
I'm going to convert that to string and
again just to speed things up I have
this already typed so let me copy and
paste that within our item inserting
even handler method okay so it's the
same code except that we are harvesting
all the values for all the columns okay
and then the same idea once we insert a
row we want to change the mode you know
to read-only and then we don't want any
rule to be selected within the grid we
control so select Row 2 minus 1 and then
call grid view data bind ok so on the
other hand when we delete a row from
details view then what should happen
obviously to delete the row we call
delete employee method and if you look
at this one it's expecting the employee
ID that you want to delete and how do we
get the employee ID the same area like
how we have got it
while we are updating it so I am going
to use this piece of code to get the
employee ID and pass that let me
actually postpone this restart and pass
that to our delete employee method and
obviously once the employee is deleted
we don't have to change the details view
mode because it's when we are deleting
it's already in the read-only mode so
there's no need to change the mode here
but we still need to bind the gridview
data okay so with these changes
everything should fall in place ok so I
selected this let's edit Nicktoons I
mean Nick 1 to Nick
update that so it works fine let's
select Nick again let's try to delete
that
look at that it's deleted as expected
let's insert a new record let's say
first name is first name last name is
last name city city gender is male later
birth this 1980 country's country salary
let's say once top 1000 and marital
status M let's try to insert the
look at that that a card is inserted
let's quickly check the database table
so we should have that record inserted
there and let's select that let's try to
delete that and everything works alright
on this slide you can find resources
faced with automate scene shop and
sequence of interview questions that's
it for today thank you for listening
have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>