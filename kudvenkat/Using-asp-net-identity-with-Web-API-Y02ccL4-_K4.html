<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Using asp net identity with Web API | Coder Coacher - Coaching Coders</title><meta content="Using asp net identity with Web API - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Using asp net identity with Web API</b></h2><h5 class="post__date">2016-12-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Y02ccL4-_K4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 22 of asp.net Web API
tutorial in this video well disk is
customizing and using asp.net identity
server with Web API in our previous
video we discussed that the users that
we have registered using this register
dot HTML page are stored in a local
database that is auto generated by
asp.net identity framework we can find
that local database in a pan disk or
data folder in the solution Explorer if
you can't find this database make sure
you have clicked on this button which
says show all files this database
contains several tables as you can see
right here but let's understand the
purpose of each of these tables so when
we double click on this MDF file right
here it's going to display us all the
tables in server Explorer underscore
migration history the presence of this
table tells us that it is using entity
framework SP net roles this table stores
information about roles within our
application at the moment we don't have
any roles so this table will be empty as
being at user claims this table stores
information about claims we don't have
any claim Ceyda so this table will also
be empty SP net user logins this table
is used for third party authentication
providers like Facebook Google Twitter
Microsoft etc information about those
logins will be stored in this table SP
net user roles this a bridge table which
basically tells us which users are in
which roles SP net users this table
stores the new users that we have
registered using our register dot HTML
page so when we right-click on this
table and when we select show table data
we should see all the users that we have
registered using our register dot HTML
page notice in this table we've got you
know test 1 2 &amp;amp; 3 at gmail.com all the
users that we have registered so far
using our register dot HTML page one
obvious question that comes to our mind
at this point is can we change the
default name of the auto-generated
identity database now if you look at the
name
of the identity database here notice we
have this word asp net followed by that
we have a dash and then the name of our
project which is employee service and
then another dash and then at times tab
so can we change this default name to
for example let's say users DB the
answer is yes the thing that controls
this name is the connection string that
we have in our web config file so if you
look at the web config file notice we
have a connection string with name
default connection and here we have that
strange name that we see in the app data
folder so now if we want the database
name to be uses DB we have to change it
here to users DB and we also need to
change it for this initial catalog
property so again here we have that
strange name so instead of that we are
going to use users DB let's save our
changes and reload this page now let's
register a new user test at test com
let's provide it password and they
confirm password
let's click register registration
successful so we should now have a
database with name uses DB created so
let's go to solution Explorer and click
the Refresh icon notice with an app
underscore data folder we have a
database with name uses DB so how to
change the default name of the database
created by asp.net identity change the
name of the database in the default
connection string in web config file
another question that we get is can we
have the asp.net identity database
created in sequel server rather than an
app and a score data folder the answer
is yes we can by changing the default
connection string in web config file to
point to your sequel server let's see
how to do that now at the moment we have
the identity database create
app underscore data folder we want this
database to be created in sequel server
instead notice within that databases
folder we don't have users db2 have the
identity database created in sequel
server all we have to do is change this
default connection string point to your
sequel server so we have to change the
data source attribute for that at the
moment the value for this attribute is
this which is going to create users DB
by default in app and score data folder
instead of that I'm going to use dot
which is basically telling use local
sequel server installation we can also
use local instead of dot like that let's
save our changes and reload this page
now let's register a new user let's
provide a password and the confirm
password register registration
successful now when we refresh this
databases folder notice we see the users
DB so this identity database is now
created in sequel server instead of app
and its core data folder and when we
look at the tables notice we see all the
identity database tables as expected
another question that comes to our mind
at this point is is it mandatory for the
identity tables to be in a separate
database can't we have them created in
an existing database the answer is no
it's not mandatory for the identity
tables to be in a separate database you
can have them created by the identity
framework in an existing database by
just making your connection string point
to your existing database let's see how
to do that now at the moment our
employee service web API project is
making use of two databases it's making
use of this employee DB database which
contains our employees table and is also
making use of this users DB database
which contains the identity server
tables now what we want to do is have
these identity tables also created in
employee DB database to achieve that all
we have to do
is make this default connection string
point to our employee DB database and we
do that by changing the value for this
initial catalog attribute within our
default connection string so let's make
this point to employee DB database let's
save our changes reload our webpage and
register a new user let's provide a
password and confirm password register
registration successful at this point
when we refresh the tables folder within
our employee DB database notice we see
all the identity tables created here as
expected in our next video we'll discuss
testing asp.net Web API token based
authentication using fiddler thank you
for listening and have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>