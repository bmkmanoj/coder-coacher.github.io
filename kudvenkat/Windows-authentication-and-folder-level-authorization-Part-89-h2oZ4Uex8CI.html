<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Windows authentication and folder level authorization   Part 89 | Coder Coacher - Coaching Coders</title><meta content="Windows authentication and folder level authorization   Part 89 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Windows authentication and folder level authorization   Part 89</b></h2><h5 class="post__date">2012-12-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/h2oZ4Uex8CI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello welcome to prism technologies I am
venket this is part 89 of asp.net video
series in part 87 of this video series
we have discussed the basics of windows
authentication and in part 888 we
discussed about how to allow or deny
access to specific users how to do
rule-based authorization and finally we
discussed about how to programmatically
check if a user belongs to a specific
role in this session we'll discuss about
folder level authorization within
Windows authentication let's understand
that with an example look at the
solution Explorer here within this web
application one project I have a folder
called admin and it has got an admin
page now only administrators should be
able to access the pages within admin
folder the rest of the pages that are
outside of the admin folder for example
waveform 1 can be accessed by anyone is
this possible to achieve with Windows
authentication absolutely let's see how
to do that
let's flip to visual studio so I have
web application 1 here right click on
the project let's add a folder with name
admin and then this folder is going to
contain a webform so let's right-click
on that ad I'm going to call that new
item and let's add a webform and let's
call that admin page so admin page click
Add and then I'm going to use an h1 just
to display that this is an admin page
and main page so that should show up
nicely admin page alright now let's add
a web config file to this folder so
right click on the folder add a new item
and then I'm going to add a web
configuration file ok so now I'm going
to specify some authorization settings
for this web config file that's present
in admin folder so here what we are
going to do we're going to tell we're
going to make use of this authorization
element and here I will say allow
rulz is equal to administrators so we
are allowing the administrator role and
we are denying access to everybody else
so deny users is equal to star star
indicates all users so now the settings
that we have specified in the web config
file of this folder are applicable to
all the pages that is going to be
present in this folder so admin page is
present in admin page is present in
admin folder so this page will now be
accessible only to administrators now
what is the other thing that we want to
do the pages that are outside of the
admin folder for example webform 1 dot
aspx is outside of the admin folder and
I want that to be available to all the
users to all the authenticated users so
how do I do that I have another web
config file within the root directory of
this web application project so here I
specify the authorization settings so
here I am saying OK you know
delete that allow here and I'm going to
say deny users is equal to question mark
meaning deny access only to
unauthenticated users rest others allow
access ok now I am logged in as Prasad
into this computer so let's check which
is the group Prasad that belongs to and
to check that you know click on start
button computer right click on that and
select manage which should bring up the
computer management window and within
that expand local users and groups and
then if you select users you should see
Prasad there and if I double click that
Prasad is a member of administrators and
home users group and if you look at this
you know the web form where form 1
should be accessible to everyone and
admin page should be accessible to
administrators since I am logged in as
Prasad who belong to admin group I
should be able to access both of these
pages so let me try to access web form 1
first so when I press control f5 I
should be authenticated and I should be
able to access this waveform so I'm
authenticated as Prasad and I am able to
access web form 1 now let's say if I am
able to access the admin page let's
press control f5 again so I am able to
access the
admin page as well okay because within
the web config file of that admin folder
is specified I love roles administrators
okay
now let's quickly you know check blanket
so there are other users as well on this
computer Venkat is a user now if you
check the member of tab Venkat is not an
administrator now let's add venket here
to administrators group so type in
administrators check that so Venkat is
also part of administrators group right
now okay now instead of allowing all
administrators what I'm going to do here
is I'm going to say a la user is equal
to on this machine I want to allow only
venket so when cut is an administrator
on this computer so I want to allow only
that user access to the admin page okay
so now let's close this save this web
config file now remember I am logged in
as Prasad so I should now not be able to
access that page so let's go to admin
page let's press control f5 there now
you know when we try to access that look
at that there is a prompt now I have to
supply the credentials of venket
otherwise I will not be able to access
that admin page so if I cancel that as
you might expect X is denied but on the
other hand I can access webform 1 which
is present in the root directory because
the form 1 allow access you know
basically all the pages that are outside
of the admin folder any user any
authenticated user can access them how
do we know because in this web config
file is specified only deny access to
our north indicated users okay so that's
the admin folder web config file now and
this is the web config file in the root
directory of the web application project
now a very common interview question is
is it possible to have more than one web
config file Apps
and if they ask you when do you use more
than one website config file or why do
you use you know you have a practical
example that you can give okay if you
want to do folder level authorization
with web dot with windows authentication
then it's definitely helpful to have
more than web config file okay now if
you look at this you know whatever is
the page that you are accessing once you
are authenticated the application code
is actually executed using the
application pools identity okay
now instead of using the application
pool identity to execute the application
code I want to use the logged in user
identity how do we do that we discussed
about this in the previous sessions as
well we enable impersonation and how do
we enable impersonation let's say for
example you know when somebody access
the admin page you know I want the code
that is related to admin pages to be
executed using the logged in user
identity in that case within the web
config file of the admin folder we can
enable impersonation so let's enable
impersonation so identity impersonate is
equal to true so now we only enable the
impersonation in the web config file
that's present in the admin folder we
haven't done that to the web config file
in the root application in the root
directory of the web application project
so now if I go ahead and run this so I
am on web form 1 which is accessible to
all users so I am logged in as Prasad so
I am able to access that and look at
that within the root directory within
the root within the web config file of
the root applicant we have not enabled
impersonation that's why if you look at
this code application code executed
using the application pool identity now
let's quickly copy the same piece of
code from this page to admin page so
admin page right-click view code within
the page load event let's copy that as
well okay now let me go ahead and access
this page now remember week I am logged
in as Prasad who doesn't
- who is not wankered so if you remember
within the admin folder the web config
file we said allow only access to rank 8
but I am logged in as Prasad so
obviously I will not be able to access
that page unless and until I provide the
credentials of rented so I have provided
them I click login
oops so rank it test login look at that
you know the application code is now
executed you saying you know the logged
in user identity in this case rank head
ok so it's also possible to enable
impersonation you know for a few of the
pages and not for the other pages and we
have just seen how to do that ok so if
you want to execute the application code
using the logged in administrator
account then enable impersonation in the
web config file of the admin folder with
that setting in place all the pages in
the admin folder are now executed using
the logged in user account whereas the
pages outside of the folder are executed
using the identity of the application
pool and we have just seen that and it
is also possible to impersonate with a
specific user name and password now if
you see here the way we are
impersonating we just said identity
impersonate is equal to true meaning
whoever is the logged in user that's
accessing the pages then that user
account is used to execute the
application code but instead of that you
know is it possible to hard-code a
specific account absolutely all you have
to do is specify the username and
password so user name I am going to say
Prasad and password may be let's use
here vank it so that's the user name and
that's the password
okay now let's allow all rules actually
all administrators so I'm going to say
allow roles is equal to administrators
all right so now I am logged in as
Prasad so I belong to administrators I
should be able to access the admin page
and look at the web config file
here you know we are impersonating but
then we are impersonating with a
specific account banquettes account so
whether I log in as Prasad or whether I
log in as wankered all right whether I
log in as a different administrator's
always the application code is going to
be executed using this account okay so
I'm logged in as Prasad so if I run this
now I am able to access that page look
at that I am logged in as Prasad but
look at the application code is executed
using banquets account why because
within the web config file we have
hard-coded the impersonating account
details on this slide you can find
resources for asp.net c-sharp and
sequence of interview questions that's
it for today thank you for listening
have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>