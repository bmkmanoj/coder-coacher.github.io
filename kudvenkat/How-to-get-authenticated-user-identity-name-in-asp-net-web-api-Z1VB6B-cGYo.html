<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to get authenticated user identity name in asp net web api | Coder Coacher - Coaching Coders</title><meta content="How to get authenticated user identity name in asp net web api - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to get authenticated user identity name in asp net web api</b></h2><h5 class="post__date">2016-12-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Z1VB6B-cGYo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 27 of asp.net Web API
tutorial in its video we'll discuss how
to get authenticated user identity name
in asp.net Web API so here is what we
want to do we want to retrieve the
logged in user name and then display it
on our web page as you can see right
here in this case we have logged in with
test one at test com username notice
here we are displaying a message hello
test one at test com so let's see how to
achieve this
let's now understand what happens when
we login when we provide a username and
password and when we click this login
button we are posting that username and
password to slash took in you are l once
we are successfully authenticated we get
a response back from the server this
response object has got access
underscore token property which returns
as the access token which we are then
storing in the browser local storage in
addition to access token property we get
fewer the properties as well including
user name let's see what are all the
properties that we get back as part of
this response object to see all those
properties I'm going to copy these two
lines of code here paste them within our
success function for now let's keep
these two lines commented and let's
stringify the response object so we can
display it in the bootstrap alert Dave
and stringify the response object I'm
going to use JSON dot stringify method
and to that let's pass the response
object let's say our changes and reload
our login page let's login now
notice in addition to access to again we
are also getting the username with which
we have logged in now we can use this
username property
retrieve the logged in user name store
it in the local storage just like how we
are storing the access token and then we
can use it on any page that we want to
use so let's delete these two lines
let's uncomment these two lines and then
I'm going to make a copy of this line we
know the response object has got
username property so this is going to
return us username and let's use the key
as username and we are storing it in the
browser local storage the next thing
that we want to do is display this
logged in user name on our data dot HTML
page as you can see right here so next
to load employees button let's include a
span element which is going to display
hello and whatever it is to logged in
user name so within our data dot HTML
page next to our load employees button
let's include a span element let's give
this span element an ID span user name
and let's use bootstrap text muted class
which is going to give us this gray
effect that you say and then all we have
to do is within our script section you
know retrieve the user name property
value from local storage and display it
in the span element now if you look at
the span element the ID of the span
element is span username so let's find
the span element using its ID and then
let's use the text method and the text
that we want to display is hello and
then whatever is the user name that we
have logged in and to retrieve the user
name we are going to use the local
storage object and let's use the gate
item method and
member the key that we have used to
store user name is username let's say
all our changes reload our web page
let's login
we have lewd employees and look at this
for some reason it's not displaying they
logged in user name let's reload this
data page as well maybe we didn't
refresh that's why we don't have that
locked in user name as soon as I have
refresh we have caught the logged in
user name now let's discuss how to
retrieve logged in user identity details
from a controller in asp.net Web API
from the controller we can use user dot
identity object to retrieve logged in
user identity details let's look at this
in action let's set a break point within
the get method of our employees
controller and let's run the application
in debug mode we are on the home page
let's navigate to login page let's login
let's click load employees our
breakpoint is hit now let's get to
immediate vendor to get to immediate
window we can use the keyboard shortcut
control di or we can click on debug
windows and immediate now within
immediate window let's use user dot
identity use dot identity notice here we
have got is authenticated authentication
type and name properties is
authenticated is going to return true or
false depending on whether we are
authenticated or not in this case we are
authenticated so we are getting true
back now to find out the authentication
type use authentication type in this
case we are using beta authentication
and to get the authenticated user name
use the name property notice in this
case we are logged in with a at a calm
instead of using user dot identity we
can also use request context dot
principle dot identity request context
dot principle dot identity and notice
even in this case we have got the same
set of three properties is authenticated
name and authentication type now let's
see what these three properties return
if we are not logged in so let's flip to
visual studio let's stop debugging and
let's add a new controller so let's
right-click on the controllers folder ad
and we want to add a controller let's
call our controller test controller
and within our test controller let's
include a ket method which is simply
going to return the string hello from
test controller now let's place a
breakpoint within the get method of our
test controller and run our application
one more time in debug mode here on the
home page let's navigate to slash API
slash test the breakpoint is hit in this
case this controller is not decorated
with authorized attribute this means
even anonymous users can get to this
controller action method since we are
not logged in if we check is
authenticated property notice it returns
false since we are not authenticated
authentication type and name properties
are going to return now notice both
authentication type and name properties
are returning null thank you for
listening and have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>