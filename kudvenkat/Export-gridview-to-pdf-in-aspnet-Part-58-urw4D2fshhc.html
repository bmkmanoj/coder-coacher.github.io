<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Export gridview to pdf in asp.net - Part 58 | Coder Coacher - Coaching Coders</title><meta content="Export gridview to pdf in asp.net - Part 58 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Export gridview to pdf in asp.net - Part 58</b></h2><h5 class="post__date">2013-04-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/urw4D2fshhc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello welcome to prism technologies I am
venket this is part 58 of asp.net grid
view tutorial in this video we'll
discuss about exporting grid view data
to a PDF document we'll be using this
table TBL employee for this demo we want
to retrieve data from this table display
that within the grid view control and
then when I click this button export to
PDF we want to expose this grid view
data into a PDF document so let's flip
to visual studio let's now drag-and-drop
a grid view control onto the webform
let's auto format this let's choose
brown-sugar scheme let's drag and drop a
button control onto this waveform and
then let's change the text on the button
control to export to PDF let's double
click on the button control to generate
the even handler all right the first
thing to do is to write some ATO dotnet
code to retrieve data from this table
and then display that within the grid we
control and to speed things up I have
the CTO dotnet code already implemented
so let me copy and paste this ad or
dotnet code within the page load event
so what we are doing here if it's not a
postback meaning if this is the initial
get request of the waveform use the
configuration manager class read the
connection string from web config file
and using that connection string we are
building a sequel connection object and
then look at our sequel command select
star from TBL employee we are building
our sequel data adapter and then you're
creating a data set object here and then
we are filling the data set with the
data after we execute that command and
then setting the data set as the data
source for the grid view control and
invoking data bind so at this point if
we run the application we should have
this data displayed within the grid we
control now when we click that button
export to PDF the data that's there
within the grid view control needs to be
exported to a PDF document and to
generate a PDF document we are going to
make use of an open source assembly I
text sharp DLL this assembly can be
downloaded from the URL that you can see
on the slide now this is the website
click on this button download you know
once you are on that URL then it's blown
or downloaded zipped folder extract the
contents of that zip folder
it's going to you know extract you know
some a few other zip folders from there
you know extract the contents of this
core zip folder within the co folder you
can find a text sharp DLL assembly now
you need to add a reference to the
system lay in your project so let's flip
to Visual Studio let's add a reference
to that assembly so select your DLL
click ok so we have a reference to that
assembly now now within this assembly
there are you know three namespaces that
we'll be making you so off ok and to
speed things up I have them you know
already typed here so let me copy and
paste them here so as you can see these
are the three namespaces that we need to
use alright so we have the button click
event handler so when we click that
button that's when we want to export
this data to a grid we control so the
first thing that I'm going to do here is
I'm going to create a PDF table here so
there's a class called a PDF P table so
I'm going to make use of this class to
create a table you know that we are
going to use in the PDF document so PDF
P table I'm going to call this PDF table
is equal to new PDF P table and look at
this this class has got several
constructors now I'm going to use a
constructor which is going to take in
the number of columns how many columns
are there within our grid we control 1 2
3 &amp;amp; 4
now you can hard code the number of
columns but I'm not going to do that I'm
going to retrieve the number of columns
dynamically from the grid we control and
to do that I'm going to use grid view 1
dot columns dot count okay but then look
at this if you use this property you
know this property will always return 0
if you don't have any columns defined at
the design time at the moment if you
look at look at our grid view control we
don't have any columns or fields of the
grid we control defined at design type
ok so because of this what's going to
happen is this you know grid we wondered
column struct count will always return 0
so instead of that what I'm going to do
is I'm going to say grid view
one dot header row dot cells dot count
so I can use that because if you look at
the gridview header row we have one two
and three and four four cells there so
cells dot count property is going to
give me the correct account there
so we first created the PDF table the
next thing that we have to do is
obviously loop through each a cell
within this grid you control and then
you know create a cell add that cell to
this PDF table okay so let me loop
through each row first so how do we loop
through each row within the grid view
control I can use a for each loop
so for each I'm going to say grid view
row then the idea of our grid view
control is grid view one so grid view
one dot rows so we are going to loop
through each row within this review one
control let's give that grid view row
you know an object an object reference
variable so we are looping through each
row within the grid we control and then
within each row we have got a cell so
let's loop through each a cell so for
each cell it's called a table cell so
for each table cell and let's call it
table cell in grid view row dot cells
okay so we are looping through each row
and each cell within the grid we control
and then what I'm going to do here is
create so here we have a PDF table that
we are going to use in PDF document and
then in PDF table you have PDF cells so
I'm going to create a PDF cell and then
I'm going to populate each PDF cell you
know with data from each cell from the
grid we control that's the reason why we
are looping through each row and each
cell of the grid we control so it's
called PDF P cell so I'm going to create
a PDF cell
and then look at this this PDF P cell
class has got several constructors okay
I'm going to use a constructor which it
takes in a phrase object okay so I have
to pass a new phrase object to this so
I'm going to create a new phrase object
and then look at this it expects a
string to be passed in so where am I
going to get that string from
I can get that string you know from this
table cell because all we want to do is
retrieve the text out of this table cell
and then assign that text as the text
for PDF cell and how do we assign that
as the text for PDF cell by creating
this new phrase object in and passing it
to the constructor of this PDF cell
class it's as simple as that
alright so I'm going to use the stable
cell pass it to that object and then
close that and all that is left out
right now is to add this PDF cell to our
table so what's our table PDF table dot
add cell and we are going to add PDF
cell object to that okay here we have a
syntax error that's because it expects
you know a string but we are passing in
tables hello object we should actually
be passing the text from the table cell
okay so that should solve that problem
so at this point what we have done we
have looped through each row of this
crib you control each cell retrieve the
text added the text to this PDF cell
which in turn is added to the PDF table
okay so all that is left right now is to
create a document of you know look at
this PDF cell that's actually coming
from this I text sharp dot text or PDF
namespace that's the reason why we have
you know imported all these namespaces
at the top alright so I'm going to
create a PDF document now so again I'm
going to use this document class again
look at this document class where is
this coming from
i text sharp
dot text document class okay so I'm
going to create this document and this
let's call it PDF document is equal to
new document and then you know there are
again several overloaded constructors
I'm going to use a constructor in a way
you can specify your page size so I'm
going to specify page size dot it's
going to be an a4 page size now look at
this if you want the speedy of document
to be rendered in a landscape format you
can use this a4 underscore landscape but
you know it's not working as expected
there is another trick that you can use
you know to render the PDF document in a
landscape format probably we will talk
about that in our next video session for
now let's choose a4 as the page size and
then you can specify the margin left
margin right margin top and bottom for
everything I am going to specify 10 ff4
float because every you know parameter
type here you know is of type float so
I'm going to copy that
and do the same thing for the right top
and bottom margins okay so we have our
PDF document created now so I'm going to
use another class called PDF write a
class and then I'm going to get an
instance of this document so get
instance I'm going to invoke this method
and then pass the PDF document and then
the next parameter is the responses
stream so I'm going to say response
object has called this output stream so
which we are going to pass you know as a
parameter to this method and then all
that is left at now is open your PDF
document and then to that PDF document
add this PDF table that we have created
so copy that and then add the PDF table
and then
close your PDF document so what we have
done we have opened the PDF document ad
at the table and we are going to close
that all right now we need to you know
expose that and B we want to open that
immediately then when somebody clicks
that button so I am going to use the
response object to do that because we
want to send it back to the client so
response dot you know we need to specify
the contact type and we need to you know
specify our PDF file name as well using
content-disposition response header we
discussed about you know content type
and you know response headers in the
previous session when we discussed about
exporting grid view data to a Word
document and to an Excel document so
here we are going to specify you know
the content type as application slash
PDF and to the response object we are
going to append and header so append
header and we are going to use a header
called content
- disposition you know that's the
response header which can be used to
specify a name for your file so I'm
going to say content - disposition
and then here we need to specify it as
an attachment semicolon and then we can
specify the file name and let's specify
the file name as employees dot PDF okay
so we specify the content type we added
a header so what's the next thing the
next thing is we need to write the PDF
document using the write method of the
response object so response dot write
and then pass the PDF document to that
ok flush the response completely and
then end the response ok
so that's all there to it now let's go
ahead and run this see if we are able to
export the PDF data ok so when the
gridview renders it has to display the
employee data and then when we click
that button you know export to PDF we
should be able to export to PDF and we
click that and then look at this I get
this one in this type of file can harm
your computer do you want to keep this a
file employee dot PDF anyway you know
this is an issue with Google Chrome you
know it's a known issue just click on
keep and then you have your PDF
employees dot PDF let me click on that
look at that I get all the employees but
there are two problems with this PDF
document number one it doesn't have the
header and number two this table doesn't
have the formatting that I have in my
grid view control so I would like to
have the header and the formatting so I
want to retain both of them ok first
let's get the header and that's simple
so here if you look at what you are
doing we are actually looping through
each grid view data row but we are not
looping through the header row so let's
do that as well so let me actually copy
this piece of code and then on the top
so I'm going to loop through each cell
of the grid view header so I'm going to
say actually we can get rid of this for
each loop we only need the internal for
each loop
Plus control K and deep to format it
properly so for each table cell in grid
view 1 dot header row dot cells so we
are going to loop through each cell in
the grid view header row and let's call
this header cell okay so we are going to
retrieve the header cell text and then
again we are creating a PDF cell here
which we are adding it to the PDF table
okay let's build this to make sure it
compiles and then let's run this to make
sure you know we get the header as well
along with the rest of the data
so export to PDF click on keep again you
know this error is only on Google Chrome
if you are using Internet Explorer it
works fine so click keep open the PDF
look at that I get employee D name
gender city okay now let's fix the
formatting part so how to fix the pump
formatting part alright so when I add
the header it's not just the header I
also want to you know keep the
formatting there so what I'm going to do
is I'm going to actually create a font
object here so for each cell I have to
do that so I'm going to create a font
object again this font is present in I
text sharp dot you know text namespace
from the assembly that we have
downloaded so font is equal to new font
and then I'm going to use a constructor
which doesn't take any parameter and
then all I'm going to specify here is
the font color and to do that I can use
the color property of the font object
and then look at what it expects it
expects a base color okay so I'm going
to create a new base color object and
then look at this it takes several you
know there are several constructors
again but I'm going to use the
constructor which is going to take you
know system door drawing dot color
enumeration so I'm going to specify
instead of hard-coding the color we want
to retrieve that from the grid view
control itself so how do I get the grid
view you know
font color so basically we want this a
text color and to do that you can simply
say pretty one dot header row dot font
actually header row style dot color dot
for color so we can use that property
there that's it so we have specified the
font object and the color next we need
to pass somehow this font object we have
to associate that with this PDF self and
to do that you know this PDF cell plus
has got several overloaded constructors
so I'm going to use a constructor which
takes in a font object as well actually
it is not PDF cell it's you know the
phrase object so if you look at the
phrase object it takes in you know one
of the overloaded constructors it takes
in a font object so I'm going to pass
this font object there okay so that
should fix before you know the font of
the text but then I want the background
color as well so how am I going to get
the background color now we set the
background color to the cell to the PDF
cell okay so to do that you know for
this PDF cell I'm going to set the
background color so there is a property
called background color again this uses
a base color object so I'm just going to
copy this and then paste it right there
and how do i specify the background
color header style has got this back
color property okay so let's do the same
thing for each row data row as well
so here instead of header style we are
going to specify row style and let's
copy this line and then specify the
background color here so again instead
of saying header style it's going to be
your style
okay so let's run this and see if it
works as expected
okay still loading let's click on export
to PDF keep the document open the file
and look at this I get the format as
expected so let's say we want to zoom in
200%
look at that now it's getting displayed
in a portrait format in our next video
we'll see how to change the format to a
landscape and then also we will see how
to actually instead of downloading this
let's say I want to generate a PDF
document and store it on a folder on the
server you know we'll discuss about that
in our next video session all right on
this slide you can find resources for a
speed or net c-sharp and sequence of
interview questions that's it for today
thank you for listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>