<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 25   Entity for BridgeTable in many to many relationship code first | Coder Coacher - Coaching Coders</title><meta content="Part 25   Entity for BridgeTable in many to many relationship code first - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 25   Entity for BridgeTable in many to many relationship code first</b></h2><h5 class="post__date">2014-06-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/LSHLdJFdfmc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 25 of entity framework
tutorial in this video well discuss
creating an entity for the bridge table
in a many-to-many relationship with code
first approach in the previous session
of this video series we have discussed a
scenario in which an entity is created
for the bridge table in a many-to-many
relationship with database first
approach in this video we'll discuss
doing exactly the same thing with code
first approach so based on the classes
that we're gonna write we want the
entity framework to be able to create
these three tables courses students and
thus preach table the split table is
going to store the data for the many to
many relationship between courses and
students tables so to achieve this we
would design our classes as shown here
now if you look at the students table it
has got student ID and student name
columns so to represent those columns we
have these two scalar properties here
student ID and student name and students
table has got one-to-many relationships
with student courses table so we have a
navigation property here student courses
which is returning and I list of student
courses that is a collection of student
course objects because students has got
one-to-many relationship so we should be
able to navigate from student to student
courses that's why we have this
navigation property here and similarly
if you look at the course class iya
course class has got course ID course
name so those properties are going to
represent course ID and course name
columns and if you look at this course
is table it has got one-to-many
relationship with student courses table
so to capture that we have this
navigation property here student courses
which is returning again a list of
student course objects a collection of
student courses ok and this is the class
for this bridge table so if you look at
this bridge table here we have got
student ID course ID enrolled at date
columns so to represent those columns we
have these three scalar properties here
student ID course ID enrolled date and
if you look at student ID and course ID
properties they're using two attributes
here the first attribute is the key
attribute
keep in mind in this bridge table we
want student ID and course ID columns
together to be the primary key for the
stable so it's a composite primary key
there so to achieve that we have
decorated both of these properties with
key attribute and then notice that they
are also using column attribute and then
we are specifying the order parameter we
specified order as one for student ID
and order s two for the course ID
property that's because we want the
student ID column to be created first
and then course ID that's why we have
specified the order there and then
enrolled are enrolled date gets created
and then from student course we should
be able to navigate to the course entity
and similarly we should be able to
navigate to student entity as well
that's why we have got course and
student navigation properties so based
on these classes and any framework
should automatically create these three
database tables let's look at that in
action let's flip to visual studio so
this is the same example that we worked
with in a previous session so I'm going
to get rid of this employee model dot
EDM x5 which we generated from the
database and then I am also going to get
rid of the connection string from the
web config file web form 1 dot aspx and
it's good behind are not going to change
in any way so now to this project let's
go ahead and add a new class let's call
this course dot CS and to speed things
up I am going to copy and paste the
properties that I have already typed so
this exactly the same code that you have
seen on the slide now let's go ahead and
add another class file and let's call
this student dot cs and again this class
is going to contain student ID student
name and a collection of student course
objects let's add another class for
student course and this class is going
to have these properties all right now
we need employee dbcontext now look at
this we have some compliation errors
here that's basically because the key
attribute is present in system not
competent modeled or data annotations
namespace and the column attribute is
present in system load component model
or data annotation start schema
namespace right now we need to add
another class file and let's call this
employee dbcontext dot cs and we want
this class to inherit from dbcontext
base class and this class is going to
have three properties courses students
and student courses which are going to
return you know the respective DB set of
you know that object so DB set of course
objects TV set of student object and DB
set of student course objects okay all
right and the next step is to include a
connection string within the web config
file so I have already typed the
connection string so let's copy and
paste it right there alright so with
these changes before we actually run
this project let's go to sequence of a
management studio and delete the sample
database so now we don't have the sample
database so when we run this platform
one dot aspx first of all at the moment
when we compile the solution we should
not have any compilation errors so we
have an error here that's basically
because look at the collection here our
student courses ok now this doesn't have
add object method instead we have add
method there so let's go ahead and use
that
similarly here instead of delete object
we have remove method
all right these changes let's go ahead
and run this now so now this sample
database and the required table should
be automatically created and the
relationship between the table should
also be established so look at that we
don't have any data in the database
tables that's why the webform is
displayed blank let's refresh this
databases folder so there we have the
sample database and if you look at the
tables here look at the courses table it
has got course ID course name course ID
is the primary key similarly if you look
at students table we should have student
ID and student name with student ID
being the primary key and if you look at
student courses table we have got
student ID course ID and enrolled at
date and look at that student ID course
ID together they are forming the primary
key for this table and they are also
foreign keys to the respective tables
okay so now let's go and execute this
insert script here to insert some test
data and then let's reload this waveform
so Mike is enrolled in c-sharp and
asp.net John is enrolled in c-sharp
asp.net sequel server now when we click
assign WC of course to might Mike should
be assigned to the BC of course at the
moment is not assigned to WCF but once
we click that reload the waveform look
at that Mike is assigned to WCF when we
click this button we should be able to
remove John from sequel server course
let's reload that if we click it okay
let's see why it's not working so if you
look at where from one dot aspx if we go
to the source I think look at that the
on click attribute is missing there
that's the reason so let's copy this on
click attribute here
and then if you look at the event
handler name here it's button to
underscore click so let's copy and paste
it right there
and then now let's run this and let's
click this button remove John from
sequel server and let's reload this
notice that John is removed from sequel
server course alright so we have seen
how to create an entity for the bridge
table using code first approach that's
it for today thank you for listening
have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>