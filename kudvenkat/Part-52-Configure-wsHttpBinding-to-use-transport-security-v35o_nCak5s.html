<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 52   Configure wsHttpBinding to use transport security | Coder Coacher - Coaching Coders</title><meta content="Part 52   Configure wsHttpBinding to use transport security - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 52   Configure wsHttpBinding to use transport security</b></h2><h5 class="post__date">2014-04-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/v35o_nCak5s" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 52 of wucf video series in
this video we'll discuss configuring WS
HTTP binding to use transport security
mode and basic client credential type by
default out of the box ws HTTP binding
uses message security mode and Windows
client credential type in this video
well disc is customizing this ws HTTP
binding to use transport security mode
instead of message security mode and
basic client credential time instead of
Windows client credential type the MSDN
link right here contains all the system
provided bindings and their security
defaults if you look at the WS HTTP
binding right here notice that the
default security mode is message let's
customize this to use transport security
mode let's flip to visual studio let's
first create a new project and we want
to pre create a project of type class
library and let's call this simple
service let's delete this class 1 dot CS
file that's auto-generated and to this
project we want to add a new item and
the new item that we want to add is the
WCF service and let's call our WCF
service simple service let's change the
name of this operation contract to get
message and we want this operation
contract to return a string and this
operation contract expects a parameter
of type string within this simple
service towards es file let's go ahead
and implement that operation contract
and all this operation contract going to
do is concatenate the word hello with
whatever name that comes into this
function and then return that string all
right so we have our WCF service now
let's go and host this in AI as we
discussed hosting WCF service as in is
in detail in part 29 of the WCF tutorial
so to host the WCF service in is right
click on the solution add
and new website and let's navigate to C
Drive because that's where we have our
simple service solution folder so simple
service so within C Drive we have simple
service and within that simple service
solution folder we want to create
another folder called simple service is
host click open so it's asking us you
know the simple service is host folder
doesn't exist would you like to create
this folder yes click ok so a website is
now created for us now let's go ahead
and first build a simple service WCF
service so build succeeded now the first
thing that we need to do is add a
reference to this simple WCF service
within the website
and to do that right click on the
website and then select this option add
reference and then select the project
simple service and notice that it has
put a simple service DLL within the bin
directory all right the next thing that
we need to do is delete this I service
dot CS and service dot CS files we don't
need them and then let's go and change
this service dot SVC file to simple
service dot as we say
and then let's get rid of this code
behind attribute and then here we need
to give the fully qualified name of our
simple service so if you look at this
simple service the namespace is simple
service and the class is simple service
so the fully qualified name is simple
service dot simple service ok all right
now let's go ahead and configure you
know an application folder within is to
get to is within the run window type
ionic manager so that should bring up is
expand the root node and then expand
sites default website right click on
default website and select this option
add application and let's give an early
ask let's call it simple service and
then let's select the asp.net version
4.0 application pool and then select the
physical part so the physical part is
the actual folder where we have our
website so our website is present in C
Drive and the solution folder is simple
service and within that we have simple
service I as host that's the physical
folder where we have our website click
ok so we have our website created all
right so now within the web config file
we need to specify the configuration
that is required to host the step you
see of service in my ass and to speed
things up I have already typed the
required configuration so let's copy the
config and then paste it with an web
config file now if you look at the
endpoint right here
the address is simple service and notice
the binding we are using WS HTTP binding
and we have not you know customized this
binding in any way which means we are
using the defaults so the default
security mode for ws HTTP binding is
message and the default client
credential time that it expects from the
client application is vendor
okay alright let's save the changes for
web config file and now let's go to iis
and then let's right click on the simple
service application that we have created
and select this option switch to content
view so we should see simple service dot
SVG file so right click on that and
select this option browse so this should
launch your browser and then it's trying
to navigate to simple service status we
see notice that we have the vestal
document now let's go ahead and create a
client application so I have another
instance of Visual Studio running here
let's create a new project and this time
we want to create a Windows forms
application let's call this client and
let's drag and drop a button control
onto this web form so a windows form and
then let's change the name of the button
to something like BTN call service and
then let's also change the text to call
service alright the first thing that we
need to do here is add a reference to
our WCF service and to do that right
click on the reference folder add
service reference and this is the URL
where our service is available so copy
the URL and paste that within the
address box and then click go this
should discover a simple service let's
change the namespace to simple service
and then click OK
so this should generate the required
proxy classes and the configuration for
us and now if you look at the
configuration that is generated first of
all notice the address of the endpoint
we are using the HTTP endpoint and then
the binding is w as HTTP binding and the
binding configuration is this one which
points to you know this element right
here and if you look at the security
mode look at that the security mode is
message and the client credential pipe
for message based security is Windows ok
so it is using the defaults right now ok
now let's go ahead and enable
you know message logging as well for the
stability of service and we discussed
enabling message logging and tracing n
WCF in detail in part 9 of the WCF
tutorial so let's go ahead and quickly
enable message logging and to do that
click on tools and then select this
option WCF service configuration editor
file open and we want to open the config
file and we want to open the web config
file that's present in simple service is
host website folder and select
diagnostics folder and then click enable
log Auto flash and enable message
logging and then navigate this message
logging option and then set this log
entire message to true close save the
changes and reload the changes into web
config file so we have enabled message
logging right now ok so now let's go
back to our client application and then
click this button to generate the click
event handler and then let's create an
instance of our client application so
it's simple service that's the namespace
simple service client let's call it
client equals new simple service client
and this client has got a method called
get message which expects a parameter of
type string
let's pass presume as the name and then
whatever message we want we get back we
are going to display that using a
message box so message box dot show
whatever message we get back all right
so now let's go ahead and run the client
application
let's click call service so we should
get the message back so hollow prism now
obviously this message should have been
logged so now let's go back to our WCF
service open the website project folder
in Windows Explorer they we should have
web message store SVC log let's double
click that to open with the window
service trace viewer and if you look at
the last message right here notice the
body of the soap envelope
so the body of the soap envelope is
encrypted because by default it's using
message based security and you know the
entire message is encrypted here okay
now let's see how to customize this ws
HTTP binding to use Transport Security
instead of message security okay and the
first thing that we need to do here in
order to configure the binding to use
Transport Security is create a you know
SSL certificate and how do we do that
using is okay so get to is click on the
root node and then actually right click
on is and then select to switch to
features view so we get to the features
of this is server and then underneath
here underneath this is you should say
something called silver certificates
double-click the feature and then on the
right hand side you have create self
signed certificate again we have
discussed creating self-signed
certificates in part 101 of the asp.net
tutorial so let's go ahead and create a
self signed certificate and let's call
this self signed certificate maybe
venket - piece a click ok so a self
signed certificate is created for us now
let's click on default website at the
moment if you look at bindings right
here okay we only have HTTP binding now
since we want to use you know Transport
Security with WS HTTP binding we are
going to use that you know using SSL
over HTTP meaning we need HTTP binding
as well at the moment we don't have HTTP
binding so let's go ahead and add HTTP
binding so select the type as HTTP and
look at the port number by default it
assigns 443 and if you remember we have
just created an SSL certificate but
that's a self-signed certificate so
let's go and select that self signed
certificate and click OK so we have an
HTTP binding created as far
click close ok so now we have two
bindings that is HTTP and HTTPS so now
let's get to our website and then within
the features window underneath is no
make sure that you have your website
selected so here we have this SSL
settings now let's get to this SSL
settings and then let's say we we
require SSL and we are going to accept
client certificates and then let's click
apply ok the changes have been saved now
all right so these are the changes
within is now let's get back to our
simple service and then within the web
config file now let's customize this ws
HTTP binding you know to use transport
based security and then basic client
credential type and to do that under
need system dot service model element
let's include a bindings section so we
use binding section basically to
customize a given binding what binding
do we need to customize we want to
customize the WS HTTP binding so we get
into that element and then give your
customization and name so let's call it
WS HTTP and then what do we want to
customize we want to customize the
security mode so set security mode to
transport ok and then since we are
setting the security mode to transport
let's go to select transport element and
then set client credential type so
instead of using Windows client
credential type we are asking it to use
basic client credential type okay so we
have customized the binding but the next
step is to associate this customization
with the endpoint that we have so here
we have an endpoint so how do we
associate that customization with that
endpoint using this name right here so
the name that we have given to this
customization is WS HTTP so let's go
ahead and use the binding configuration
attribute and associate that
customization with this endpoint
alright let's save the changes and then
let's go back to is right click on our
simple service website switch to content
view and then let's try to navigate to
this URL okay so this is I mean there's
an HTTP error click proceed anyway so
security settings for this service
require basic authentication but it is
not enabled for the is application that
hosts this service so basically what we
need to do is we need to enable basic
authentication with an is and to do that
get to I is select your simple service
website and then here you should find
authentication double click that to open
the feature and notice basic
authentication at the moment it's
disabled so let's go ahead and enable
that ok
so basic authentication is enabled now
so now let's go ahead and refresh this
vendor and see if we get away with that
wearer so now we have a different error
what is that are saying here they HTTP
GET enabled property of this service
metadata behavior is set to true and the
HTTP cat URL properties a relative
address but there is no HTTP base
address you know this error is rather a
misleading error but basically to get
this to get rid of this error all we
need to do is at the moment we are
expecting you know HTTPS okay so what we
need to do is within the web config file
so if you look at the max behavior here
we are saying HTTP GET enabled equals
true so let's actually change that to
HTTP GET enabled equals true okay and
then let's come back let's actually save
those changes and then come back to the
browser window and then reload this page
so at this time look at the URL it's
using HTTPS and then look at the service
utility again it's using HTTPS ok so
let's copy that URL now let's go back to
our client application and then delete
this service reference
and then let's riad a reference to our
WCF service so notice that this time you
are using HTTPS instead of HTTP because
we want to use Transport Security so we
are using the transport layer to provide
confidentiality and integrity for our
messages so click go and basically look
at this you know we have caught an error
dialog I mean a security alert dialog
here basically it's saying that the
security certificate for hosts wankered
- PC does not match the name of the page
you're trying to view that's basically
because here we are using localhost but
the name of the certificate that we have
used is ranked at - PC so let's go - and
PC specify that click go now look at
that we don't get that error I mean that
alert basically so let's go ahead and
specify simple service as the namespace
and then click OK now if you look at the
config that is generated so again you
know we are using WS HTTP binding but
look at the address now it's using HTTP
address now ok and then this is the
binding custom configuration item name
and if you look at this item now notice
the security mode it's using transport
security mode and look at the client
credential type for transport security
mode it is basic okay so both the
customisations whatever we have applied
they are applied in the config file okay
alright so let's go ahead and run the
client application so click call service
and let's see what's going to happen now
look at the error message began the user
name is provide it's not provided
specify user name in client credentials
now if you recollect the authentication
that you use and its basic
authentication meaning we need to
provide client credentials ok to the WCF
service and the way we do that
is when we click this button we are
creating an instance of the proxy class
so to provide client credentials we use
the client proxy and then this has got
this property client credentials dot
user name dot user name so on this
computer I have a user called Dan so we
are going to use this user account and
then the password is tan so user name
dot password is tan all right so let's
go to and run the client application
right now click call service and look at
that we get the message as expected all
right and obviously this message is also
logged so let's go ahead and view the
logged message so let's refresh this
page let's open the service log and if
we navigate to the last message here and
look at messages element now look at
this the soap and we Laborde is not
encrypted why that's because the
security now is implemented at the
transport layer and by the time this
message has arrived in order to this
message lock it's already decrypted
that's why we see that in plain text
so this basically implies that the ws
HTTP binding is using Transport Security
mode and basic client credential type
that's it for today thank you for
listening
have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>