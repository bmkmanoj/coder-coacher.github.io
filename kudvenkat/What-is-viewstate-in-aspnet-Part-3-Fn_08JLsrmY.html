<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>What is viewstate in asp.net - Part 3 | Coder Coacher - Coaching Coders</title><meta content="What is viewstate in asp.net - Part 3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>What is viewstate in asp.net - Part 3</b></h2><h5 class="post__date">2012-10-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Fn_08JLsrmY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">- welcome to presume technologies I am
vented this is part 3 of a spirited
video series in this session we'll learn
about the stateless nature of HTTP
protocol however form is processed what
is view state and the rule of view state
in asp.net finally we look at the
primary difference between asp.net
server controls and HTML controls web
applications work on HTTP protocol HTTP
protocol is a stateless protocol meaning
it does not retain state between user
requests let's understand what we mean
by the stateless nature of HTTP protocol
with an example I have a simple web
application here called view state demo
which has got this webform 1 and if you
look at this I have two controls from
this waveform a text box and a button
control let's flip to the code mode of
this waveform but I clicking and
selecting view code and if you look at
the code the first thing to notice here
is that this webform one is actually a
class and along the same lines on this
webform we have got two controls textbox
and button control the declarations for
these controls will be in the designer
file so if you play flip to the designer
file you should see that there's a
declaration for textbox control and
button control and if I right click on
the text box and say go to definition
look at this this textbox is also a
class so what we need to understand that
that this point of time is that a
webform and all the controls that we
usually place on that waveform are
technically classes and we know that a
class can have objects with that in mind
let's Wan so what is this webform doing
here
now if you look at the code it's a
pretty simple code all we have is at the
level of class in the scope of the class
we have this variable integer variable
clicks count which is initialized to 0
and within the page load event of the
webform and the page loads in the
webserver memory and if it's not a post
back in the sense if it is an initial
get request we are setting the text
property of the textbox to 0 when I
click the button any time a user clicks
the button what we are doing here being
clear
the clicks count value by 1 and
assigning the incremented value to the
text property of the textbox 1 control
which means technically when we run the
application and when I start clicking
this button every time I click the
button the value that is shown in the
text box should be incremented by 1 so
if I click once 1 should be shown if I
click the second time it should be
incremented to 2 and that value should
be shown here let's see if that's what
happens when we actually run this
application now to run this application
plus control f5 and we do that you know
the web form loads up and look at this
this is the initial get request so we
first caught the page ok and then when I
click the button we are posting the page
back so this will be a postback request
so when I click the button one time look
at the value gets incremented to 1 I
click the second time I click the third
time fourth time no matter how many
times you play it doesn't get
incremented beyond 1 let's explore the
reasons of why so if you look at the
code it's pretty simple I mean we have
already looked at that ok so the reason
for why it's not getting incremented
beyond 1 is because of the stateless
nature of HTTP protocol web forms are
live only for a moment
meaning when we actually let's look at
what actually happens when we made a
request for this waveform look at this I
have this browser let's copy that URL
I'm going to let's copy that URL let's
make another page look at this as soon
as I type that URL into the browser and
press Enter
you know the request goes to the web
server and this is the get request we
are not posting the web form back to the
server instead we are getting the web
form so it's a get request so when the
request for web form 1 goes to the
server what's going to happen now we
know that this web form technically is a
class so an instance of this web form
gets created so who is going to create
the instance of this waveform now keep
in mind when we build the solution
what's going to happen the entire source
code of this application will be
compiled into intermediate language and
since this is a web application the
applications assembly is generated which
is nothing but a dll since the project
name here is view state demo we will
have an assembly for this web
application you know with the same name
view state demo door DLL and look at
that you can right click on that go to
open folder and Windows Explorer and you
should see within the bin directory the
applications assembly so when when you
request DEP form 1 what's going to
happen this assembly gets loaded into
the memory which creates an instance of
the requested webform which in this case
is webform 1 and then we also knew that
whatever controls we have on the webform
they are also technically classes so
obviously when we request this webform
we know that on this webform we have
this text box and button control so an
instance of this webform itself will be
created and an instance of textbox and
button controls will also be created and
if you look at the code it will process
this code so what's going to happen
after it creates the instance of this
webform it creates an instance of this
variable clicks count and initializes
that to 0 and since this is a get
request the page load event will be
fired and within that we are saying okay
if it's not a postback we know it's not
a postback so it gets into this if block
initializes the textbox control with
that 0 and then this button click event
will not be executed here because we
didn't click the button so it is the
initial get request it's not a postback
request so button 1 underscore click
will not be executed and then finally
what it does it what for after
completing the processing of this code
it generates the HTML keep in mind no
matter what your application does
declined for a web application is a web
browser and web browsers can only
understand HTML they can't understand
c-sharp Java or PHP they can only
understand HTML so no matter what
technology you have used to build your
web application the application has to
generate HTML which the browser can
understand so after the complete
processing what's going to happen it
generates the required HTML to send it
back to the client
and once it generates the HTML it sends
that back to the client who requested
that and what happens to the webform one
object and this variable and the textbox
and button control that it has created
everything will be immediately destroyed
so the webform will not know anything
about that webform 1 it has you know
service ok everything will be destroyed
and the HTML is sent to the client ok
now when the HTML is sent to the client
the user is looking at this ok now at
this point when the user is looking at
this webform the web server does not
know anything about this webform ok so
now let's say I click this button so
when I click this button what's going to
happen another request for this waveform
is going to go back to this web server
this time since I am clicking the button
I'm actually submitting this webform or
posting this web form back to the web
server
so when I post this webform back to the
server what happens let's look at that
so when you post again an instance of
this web form one and text box and
button control and this variable gets
created and it is initialized to zero
this is a you know page gets loaded page
load event happens and it's not if not
is post back this is a postback event so
this code will not be executed and then
we have clicked the button we posted the
page back by clicking the button so
button click event will also be executed
and at this point we are incrementing
the value of clicks count by one so
clicks count is zero it increments that
by one so 0 plus 1 is 1 and we are
setting that one to the text property of
textbox one control so when so at this
point it generates the HTML sends it
back to the client and it immediately
destroys that platform again okay so at
this point we should see the value of 1
now if I click it the second time what
happens the request for the webform goes
again to the web server so another new
instance of webform one text box control
button control and this clicks count
variable will be created and look at
this every time you post this waveform
back every time you request this
waveform this
value is initialized to zero and within
the button click event you are
incrementing that by one so it always
stays at one no matter how many times
you click and every time you request
this waveform and new instance of that
webform controls and this with any
variables on that webform re are
recreated the web server does not
remember the state between requests okay
now to make web server remember the
state in asp.net we have a view state
field that we can make use of let us see
how to correct this problem using that
view State feel so webform lives barely
for a moment when a request is received
an instance of the request waveform is
created and along the same lines and
instance of any controls and variables
on that webform are created even the
processes processed generates the HTML
and post that back to the client and the
webform is immediately destroyed so to
correct this you know I have a variation
of code and it's very simple again you
know here clicks count is initialized to
1 and in the page load it's the same
code if not is post back text set the
text property of textbox control to zero
so if it is the initial get request set
the text to zero and if it's the button
click in the sense if it's a postback
event what we are doing here look at
this this check is very important now
view state of clicks clicks is the name
of the variable okay and this is a view
state variable that we are using to
store the clicks count you can name this
anything you want I just chose to use
clicks so if view state of clicks not
equal to null what we are doing here
where we are retrieving the value that
is present in clicks converting that to
integer and adding one to it now why do
you need to do this conversion because
technically in a view state variable you
can store anything you want simple
object complex object date/time anything
okay and then look at what we are doing
after that we are incrementing the value
of clicks by one and we are we are then
converting that to string and assigning
that to the text property of the
textbook
control and finally we are stirring that
clicks count back in the viewstate of
plagues okay so let's actually see with
this code what's going to happen I have
actually typed this and kept it ready so
that we don't have to waste time and
typing it so I have this waveform too if
you look at the design it's exactly same
two webform one except that in the
code-behind file you know you see this
code that you have just seen on this
slide so clicks count is initialized to
zero so when we first request this
waveform let's close this or you can
just simply type the URL of webform to
here so when I type in webform to dot
aspx press ENTER we are making the get
request for webform two so that is this
one waveform two dot aspx okay so then
when we request when we make a get
request for this waveform two what's
going to happen an instance of this
waveform to get created an instance of
this variable gets created which is
initialized to 1 here and then page-load
gets executed it is not a postback event
so it comes to into into this block and
it initializes the text property of the
textbox one control to zero and then it
doesn't execute this button one click
even because it's not a postback it
generates the HTML sends it back to the
client destroys this platform
immediately okay and that's how we see
this zero here and when I click it for
the first time look at what's going to
happen when I click it for the first
time okay
postback request goes to the web server
so an instance of this webform 2 gets
created along the same lines and
instance of all the variables and
controls on the web form so X clicks
count gets initialized to one page load
event fires is not post back so this is
a post back so it will not execute this
code but in one click event it comes
here and look at this is if view state
of clicks not equal to now here view
state of clicks will be now because we
haven't stood anything in this clicks
view state of clicks variable yet so
this will be null for the first time so
this piece of code will not be executed
so what we are doing here we are saying
clicks count dot to string we're
converting clicks count to what you know
to the string and setting that as the
text property of the textbox control so
clicks count is one so text of the
textbox is set to one and then we are
storing that clicks count in this view
state variable okay so at this point the
text is set to one so when we click the
button the value of this textbox is set
to one and it sends the HTML back to the
web server and destroys that platform
immediately but remember we have stored
the clicks count in this view state
variable now what's going to happen the
value is going to travel between the
client and the observer in the form of a
hidden viewstate field we'll explore
that in a bit
okay now we know that in the view state
the value at the minute is 1 in this
view state of clicks the value at the
moment is 1 so now when I click this
button for the second time look at
what's going to happen the value gets
properly incremented as expected - - and
how is this happening if I right click
on this and say view page source you
should see a hidden field here under
school view state and it has some you
know random characters this is nothing
but you know it is storing the value of
that view state of clicks in a base64
encoded format okay so this view state
field this hidden view state field gets
transferred between the client and the
server between every request and
response ok so now for the second time
when I click this button what's going to
happen the value in the textbox you know
whatever the value that was there in the
textbox you know it's now stored in this
view state of clicks variable so that
gets sent to the server and within the
server you know actually if you look at
the web form there are several events at
the level of the web form you have page
initialization page load you know page
pre-render etc which we'll be talking
about in a later session but for now
understand that
there is an event called page initial
initialization which occurs even before
page load event
so during page initialization views to
it restoration happens meaning from that
hidden underscore viewstate field web
server will base64 decode that view
state data and then populates it you
know either to the variables or the
controls now here we know that we have
assigned this value clicks count to view
state of view state variable of clicks
so when I click the button for the
second time what's going to happen an
instance of this webform - gets created
clicks count variable gets created which
is initialized to one page load event
fires none of this code will be executed
because it's a post back it comes to the
button click event and it now checks is
view state of clicks not equal to null
yes it's not equal to null because
remember in the previous request we
stored clicks count in that variable and
this field is shuttling between the web
server and the client in the form of
that hidden field so now what's going to
happen it retrieves the value from that
clicks and we knew that within clicks
variable we have stored one in the
previous request and we are converting
that to integer incrementing that by one
and then we are setting that clicks
count to the textbox so I think it shows
two and then finally look at this this
step is important you are storing that
back in the view state variable again so
this get base64 encoded and then send
back with the response to the client and
then when the user submits the page you
know along with the request you know the
view state field also comes to the
server and on the web server during page
initialization you know the view state
restoration happens so that this
variable will get that original value
which was there and then increments it
by one so this process repeats so if you
want to retain the state of variables
used between requests between postback
request we can make use of this view
State feel okay so because of this view
state film you know it gets incremented
correctly as you expect
so click the button now and the value
gets incremented every time we click so
how is this possible it's possible
because we are using the view state
variable clicks to preserve the data
between requests the view state data
travels with every request and response
between the client and the web server
and how does it travel using that hidden
field and the scope view state which is
basically base64 encoded now let's look
at a slight variation of this example if
you look at this it's a pretty simple
example and it's exactly same except
that we have modified you know we have
got rid of that clicks count variable
which was there and in and if not is
post backed Xbox one dot text is equal
to zero we are initializing the text of
the text box one control and in the
button click look at this what we are
doing we are getting the text that is
present in the text box control
converting that to integer and adding
one to it and then finally storing that
back as the text property of the textbox
one control and let's see how this works
so I have this webform 3 here and if you
look at the design it's pretty much the
same thing and if you look at the code
it's exactly what you have seen on the
slide so if not is postback you are
setting the text property of the textbox
control to zero and upon the button
click what we are doing we are taking
the text out of the textbox one control
and incrementing that by one and
assigning that value back to the text
property so now if what we have spoken
until now is true then this should not
increment the value because we know that
every time you make a request for this
waveform let's run this first so I have
this waveform 3 I click this button once
ok value gets incremented correctly 2 3
4 now look at this I am not using any
view state field here but then my
textbox is retaining its value across
post back so how is this possible if
whatever we have spoken now is true in
the sense every request is treated like
a new request a waveform gets created
all the controls on it get created you
know it shouldn't
incrementing that value because look at
technically what should happen now when
we request this waveform you know it
creates an instance of this waveform
three it creates an instance of the
textbox and button control on this web
form and then it initializes the text
property to zero and sends it back so
upon the initial get request you will
see a value of zero within that text box
and now when you click the button it's a
new request so a new instance of webform
3 it should be created text box should
be created and it's not a post where I
mean it's a post back so this will not
be executed and in the button clay you
know actually text box one dot text you
know it will be an empty string image
and you will you wouldn't be able to
convert that to integer but then here it
properly detects there was zero and it's
incrementing to one and next time you
click it it gets incremented to two and
it works but how is it doing that
because behind the scenes all asp.net
controls by default use this view state
to preserve the data across post back ok
that's what is the advantage of using
this asp.net server controls they use
this view state field to retain data
across post back and that's why every
time you click this button the value get
properly incremented without Vee having
to use explicitly the view state
variables so upon clicking the button
the value gets incremented correctly as
expected this is possible because
textbox one is an asp.net server control
that uses view state internally to
preserve data across post backs because
web forms have very short lifetimes
asp.net take special steps to preserve
the data enter in the controls on a
waveform data entered in controls is
sent with each request and restore two
controls in page initialization event
the data in these controls is then
available in the page load or button
click or page pre-render any event that
basically occurs off the page
initialization we will be talking about
the events in the page lifecycle of a
web form in a later session but
understand that all asp.net controls
server controls behind the scenes
use viewstate to preserve the state
across postback and finally we look at
the primary difference between an
asp.net civil control and HTML control
and to demonstrate that I have another
waveform and this is a very simple
waveform again all I have done is I have
typed in this text asp.net server
control and I have dragged and dropped
this text box look at this if you look
at the toolbox there are several
sections within the toolbox I have
standard section I have HTML section now
the standard section shows all the
standard asp.net server controls so if
you look at the text box that we have
here
it's from the standard tab this text box
which is an asp.net server control and
on the other hand if you look at this
this is an HTML control and where did I
get this from I got this from the HTML
tab from the toolbox so if you look at
the HTML tab I have this input text this
is a standard HTML control okay so this
is an asp.net server control that's what
the label says and this is the standard
HTML control now what I'm going to do is
I'm going to run this platform so when
we run this I get webform 4 and all I'm
going to do here is type something into
it test test look at the same typing
test word into both the controls and
when I click the button look at what's
going to happen and in this button click
event handler we don't have anything it
simply posts the page back to the server
and look at this the asp.net server
controls retains its stay but whereas
the standard HTML control does not
retain state why because asp.net server
controls uses view state to retain that
straight-across post back but I stay our
controls does not do that that's why you
don't they don't retain state so that's
one of the primary difference between
standard asp.net civil controls and HTML
controls now if you is it possible to
convert an HTML control into an asp.net
server control absolutely all you have
to do to convert an HTML control into
your standard asp.net server control is
to add this run it is equal to server
attribute so if you go back to a web
form
for and if you look at the source of
this waveform look at this I have this
textbox whose ID is textbox 1 and it has
this attribute Trinette is equal to
server this is the standard asp.net
server control whereas this input ID is
equal to button 1 text is equal to oh
this is the button control so input ID
is equal to text one type is equal to
text this is the standard HTML control
that we have and if I want to convert
this into a standard asp.net server
control all I need to do is add this
Lynette is equal to server attribute and
you are done so now flip to the design
mode let's run this once again
so now let's type the same thing test
into both of the controls and click the
button and let's see what happens now if
you look at this both these controls are
retaining state so if you want to
convert an HTML control into standard
asp.net control you can add error and
that is equal to server attribute now as
I told you view state data is he
realized into base64 encoded string and
is stored in hidden input field and that
is something like this actually this is
strong this is even true validation you
should say if we run this if I right
click on that you know let's type in
something into a test test
you know how are these controls
retaining their state because they are
using this input type is equal to hidden
name is equal to look at this the name
of the hidden input field is underscore
view state and this is a base64 encoded
string and this gets you know base64
decoded in the page initialization event
on the web server and it populates that
data back into these two controls so
that you know the data in these controls
will then be available in the page load
of page pre-render or any event for that
matter which occurs after page
initialization
okay so we have a slight error in this
slide you know maybe by mistake I use
the underscore ----eventvalidation'
field it's not even validation fear its
underscore viewstate field the one that
you have just seen here so this is the
field that makes use of viewstate so
just ignore this here on this slide you
can find resources for a speed or net
c-sharp and sequels re-interview
questions that's it for today thank you
for listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>