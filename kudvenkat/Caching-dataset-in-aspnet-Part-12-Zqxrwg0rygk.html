<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Caching dataset in asp.net - Part 12 | Coder Coacher - Coaching Coders</title><meta content="Caching dataset in asp.net - Part 12 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Caching dataset in asp.net - Part 12</b></h2><h5 class="post__date">2012-10-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Zqxrwg0rygk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to regime technologies I am
venket this is part 12 of video dotnet
video series in this session we'll learn
about caching the data set check to see
if the data set exists in the cache and
then load data from the cache clearing
the cache before continuing with the
session I strongly recommend to watch
parts 9 10 and 11 of this video series
now within this sequel server sample
database I've got TBL product inventory
table now I want to display this data
within an asp.net web application so
when when the application runs and then
when the application you know loads the
webform for the first time I want to you
know load this data from the database
but then once the application loads this
data then I want the application to
cache this data so that next time when I
come back to the page or when I try to
load the data again data again instead
of coming back to the database we want
to load from the cache itself so which
will obviously improve the performance
of the application okay we will talk
about cache and how can it improve the
performance of the asp.net web
application in the later session in this
session we will see how to cache the
data set object in the web applications
memory so that we get that disconnected
data behavior if you remember in the
previous sessions of this video series
we have discussed that sequel data
adapter and data set objects provides us
with a disconnected data access model so
in this session we'll actually see how
to cache this data set object so that it
can provide us with that disconnected
data access model okay alright so let's
flip to sequel visual studio
let's drag and drop a button control ok
I'm going to have to button control so
let me copy that and paste another
button control there and then I also
want the label control so let's drag and
drop a label control and then I also
want a grid view control so let's drag
and drop that
okay so to make this look better or to
format that choose one of the existing
schemes let's select this click OK
alright so let's give some meaningful
names to these buttons and labels and
grid view control so I'm going to call
this button ass BTN load data so we will
use this button to load load data and
let's call the text s load data and the
second button will call it as button
clear cache and let's you know give the
text s clear cache in a bit you will
understand you know the purpose of these
buttons and what they actually do ok so
first let's design the form and then I'm
going to get rid of this text property
of the label control because initially I
don't want to show anything within the
label control and then I'm going to call
this label as LBL message I'm using this
label for displaying a message so I'm
giving it a meaningful name alright and
let's call this grid view control as GV
products because this grid view is going
to display some products information all
right so we have given the meaningful
names to our controls on the webform now
let's say I want to load the data so
let's double click this load button
which generates the even handler okay so
what we want to do is when I click the
button I want to load this data from the
database the first time okay so let's
write some media dotnet code to load
data and within web config file I have
the connection string to the sample
database so let so let's read that
connection string from web config file
and to do that we use the configuration
manager class which is present in system
dot configuration namespace which we
have already imported so configuration
manager dot connection strings off we
need to specify the database connection
string which in our case is DB CS is the
name of the connection string
and then dot connection string property
will give us the connection string from
the web.config file so let's give this
connection string a variable string CS
is equal to connection string from web
config file all right so let's create
this equal connection objects equal
connection con is equal to new sequel
connection this equal connection object
expects a string a connection string
parameter so let's pass that and then
let's wrap this connection object inside
and using block so that the connection
object is automatically closed for us
when the scope of it is lost we don't
have to explicitly call the close method
on the connection in case if we use the
using Clause all right so let's use
sequel data adapter object so sequel de
da da da is equal to new sequel data
adapter and it expects two parameters
the sequel command object name in the
the command text and the connection
object that this adapter is going to use
to execute this command and the command
that we want to execute is basically
this select query so let me copy that
paste it there and the connection upon
which we want to execute that is the
connection object we have spoken about
all this data adapter object
you know the sequel connection object
reading the web no connection string
from web config file in the previous
sessions of this ad ordinate video
series so if you have not watched them I
would strongly encourage you to do so
before continuing with the session all
right so we have the data adapter object
let's create the data set object so data
set D s is equal to new data set and
then we call the fill method of the data
adapter which will automatically open
the connection execute this command
retrieve the results and fill that
result into this data set and closes the
connection automatically so fill the
data set and G V products is the
gridview control so let's set the data
source property of the grid view control
to the data set and finally call the
data bind method okay this is regular ad
or dotnet code which we have seen you
know when we were working with
the data adapter and data set objects so
obviously now when we run the
application and click the button load
data it's going to load this data from
the database but then in this session we
are going to see how to cache this data
set so so first time when I load this
waveform and then when I click the
button it's going to go to the database
retrieve the data set and it's binding
the data set to the grid view control
which is fine but then what I want to
basically do here is you know cache this
data set and to cache this data set you
use the cache object so how do we do
that so see ACHC that's the cache object
okay we will talk about in detail you
know about the cache object in a later
video session but now we will just
understand you know you can assign a key
to this cache object and then whatever
you store in that key
you can then later retrieve that using
the same key so I'm using a key called
data and then to that key I am assigning
this data set so basically what we are
doing after we retrieve the D you know
after we retrieve the data into the data
set we are caching that you know using
the cache object and the key for the
data set is data okay so we are cached
now so basically whenever I click this
button what I want to check first is
okay is there this data set in this
cache how do we check that if cache of
data is equal to now okay now if cache
of data is now that means that you know
we haven't stored anything in the cache
yet it means you are coming to this page
for the first time in and this is the
first time you are clicking this button
to load the data so at that point the
cache of data will be now you will not
have your data set within the cache so
it loads the data from the database and
then it puts that into the cache so next
time when you click the button again the
data set is cached and so if if it is
not null then it's going to come to the
else block so let's have the else
so within the else block what I have to
do if the data set is already present in
the cache then it will come here so what
I want to do is copy these lines here
okay now this data set object will not
be available here but then we know that
within the cache object we have this
data set so I'm going to retrieve that
from the cache using the same key cache
of data okay and if you look at this
cache object you know if you look at the
intellisense what is this crash object
returning your back it's returning an
object back okay so we need to typecast
that to data set because we know that
data set is present in this particular
cache key okay so that's it so this is
how you cache the data set and this is
how you retrieve using the same key and
then we are saying okay if it is null
which means the user is clicking this
button for the first time then go to the
database load the data and then set that
as the data source for the gridview
control called data bind but then before
that also put the data set into the
cache object okay so next time when the
user clicks the button what's going to
happen there is this data set going to
be in that cache of data so that's why
this will not be now in which case it
will come to the come to the else part
and then retrieve that data set from the
cache typecast that to data set object
and said that has the data source for
the grid view control now what we want
to do is we want to print out a message
here so if we are loading the data from
the database then print out the message
saying that data loaded from the
database on the other hand if you come
to the else part we know that data is
loaded from the cache object and not
from the database okay so now let's give
it a quick run and see if it's working
as expected okay so the first time you
know we are coming on to this waveform
for the first time so when I click this
load data button
obviously this cache of data will be
null so it comes into this block and
then retrieves the data from the
database look at the message data loaded
from the database now if I click the
load data button again since this cache
of data will not be null it will come to
the else part and you will have this
message data loaded from the cache which
makes more sense okay
now let's see how to actually clear the
cache okay all you have to do to clear
the cache first of all let's go to the
you know webform when I click this
double click the button to generate the
event handler so when we click this
clear cache button what should happen we
should remove that data set from the
cache object okay so let's see how to do
that
if cache off what is that the key is the
data now this cache object is global
meaning you can access that in any web
page within an application okay you know
even if you have cashed it in web form
one dot aspx and if you are on web form
to our web form 3 and you want to access
that on that page you can do that okay
the cache object is global it means it's
available you know across entire of your
application so if cache of data is not
equal to now only then I want to remove
that from the cache so how do I remove
that from the cache the cache object
exposes a method called remove and to
that method you can pass in the key the
name of the key is data
so obviously that key will now be
removed from the cache okay so if we
successfully remove the object the data
set from the cache then I want to you
know print a message saying that the
data set is removed from the cache so
the data set is removed from the cache
okay on the other hand if it's already
now you know you can also set an expiry
time for the cache object which we will
talk about in a later session you know
for some reason if the cache object
cache of data is already now then we
know that we don't have the data set in
the cache
to be clear so we want to print that
message to the user let him letting him
know that there's nothing in the cache
to be removed so we can print that okay
message label message store text is
equal to there is nothing in the cache
to be removed okay so now let's go ahead
and run this application so now when we
click it for the first time it should
load the data from the database and
that's what is the message we get data
loaded from the database and now if I
click it again it loads it from the
cache now I can clear cache by clicking
this button okay the data set is removed
from the cache so there is nothing in
that cache and if I click this button
once again look at what's going to
happen there's nothing in the cache to
be removed because the key cache of data
is already now so obviously it comes to
the else part and then prints this
message there's nothing in the cache to
be removed okay so now let's load the
data again so data loaded from the
database I click that once again data
loaded from the cache okay now you know
that when we click this button for the
first time it goes to the database
retrieves the data and then puts that in
the data set and the data set is cached
in the web servers memory since the
application is running on my laptop here
the data set will will actually be
cached in the memory of my laptop ok now
let us say the database is present on a
and not on another sequel server machine
I can actually disconnect from the
database at this point and then still
continue to work with the application in
fact let me show you that
ok let's actually stop the sequel server
service and to do that click on start
run and type in services dot MSE click
OK and upon clicking that you will get
to the services window within the
services window stop this equals service
and if you have both sequel Express and
the full version of Microsoft sequel
server installed then you will have to
sequel server services one for sequel
Express and the other one for the full
of the Microsoft sequel server depending
on whichever version your application is
using stop that service in on my laptop
it's using the full version of sequel
server so I'm going to stop that so now
once the service stops it's like on this
machine you don't have sequel server
anymore but then if you look at the
dotnet application we know that we have
this data set available in the cache of
my web server memory so when I click
this button load data you know the
application still loads data because the
data is available in cache you know I
can continue to work with the
application I don't have to have you
know a a connection to the actual sequel
server database because I cache this
data set I can continue to change the
data you know and then put that back in
the cache and then when I get back on
the you know network then I can sync up
the changes that are present in my data
set to the actual table in the database
if I want to okay actually we will talk
about that scenario when we like when we
actually discuss about the grid view
control because we need you know some
way of editing the data within a data
set and the best way is possibly to use
a grid view control okay and then when
we talk about grid view we will actually
see how to update the data from the data
set and then sync up with the database
but then at this point what we need to
understand is that this data set object
when it when it is stored in the cache
object it gives you the disconnected
data access model you don't really need
to have access to sequel server database
now let's say I clear the cache okay so
the data set is now removed from the
cache now if I click load data obviously
we know that the application tries to
connect to the database but if you look
at the service sequel service service is
stopped on my machine okay so since it
is stopped now and there is no data set
in the cache it tries to load the data
from the database and obviously it
cannot connect at some point it's going
to thrill you know a network service
because it's not able to communicate to
the sequel server to fetch the data
okay so at some point we will get an
exception saying that you know it's not
able to retrieve the data because why
the if the data is not present in the
cache we are asking it to go to the
sequel server to get to load the data
okay so obviously when it's trying to
fill the data said that's when it tries
to open the connection to the sequel
server look at that we have caught a
network related or instance specific
error okay and this error occurred when
it's trying to connect to that sequel
server on the other hand if I just start
the service up it means now the sequel
server is running and when I click the
load data button it should actually load
the data back so let's click the load
data button and it but we have to wait
for the service to start so let's wait
for a minute so once that service starts
up we have the sequel server running I
click the button look look at that data
loaded from the database okay so this
proves that this data set actually gives
us this disconnected data access model
all right on this slide you can find
resources for asp.net c-sharp and sequel
server interview questions that's it for
today thank you for listening have a
great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>