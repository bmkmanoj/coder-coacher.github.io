<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Creating an image gallery using asp net and c#   Part 140 | Coder Coacher - Coaching Coders</title><meta content="Creating an image gallery using asp net and c#   Part 140 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Creating an image gallery using asp net and c#   Part 140</b></h2><h5 class="post__date">2013-08-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/g6TgFVkftds" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this part 140 of asp.net tutorial in
this video we'll discuss creating a
simple image gallery using asp.net and C
sharp this is how we want our image
gallery to look like we want a file
upload control and a button using these
two controls the end user will be able
to upload an image once the user uploads
an image no matter what's the original
size of the image we want to scale it
down to 100 pixels in width and hundred
pixels in height and then add it to this
panel control and the images within this
image gallery should be rendered as
links meaning the user should be able to
click on an image once the user clicks
on an image we should redirect the user
to another page where they can see the
original image and on that page we need
this button back to gallery so when the
user clicks on this button we want to
redirect the user back to the gallery
and the images that I used in this demo
are available at this microsoft lync
I've downloaded a few of them to the
specific folder alright so let's flip to
visual studio so here I have a blank
asp.net application so first of all
let's add a data folder to this project
so this folder is going to store all the
uploaded images so let's call it data
and then I already have f11 dot aspx
first of all on this platform we need a
file upload control and then we also
need a button control and then we need a
panel control basically you know this
dotted border that you have it's a panel
control so we'll be adding our images to
this panel control let's drag and drop a
panel control as well and then let's set
the text on this button to upload and
then let's set properties to this panel
control
okay first of all we want to set the
border style you want to set it to
dashed and we want to set a border color
to maybe blue and then we want to set
the width of the spaniel control to 440
pixels all right so once we click this
upload button that's when we want to
upload the user image and then add it to
this panel control so let's double click
on that to generate the event handler
all right so to upload the image that
the user has selected within the file
upload control
first of all let's check if there is a
file within the file upload control and
how do we do that if file upload one dot
has file this property is going to
return true or false if it returns true
then we know the file upload control has
got a file which we need to upload so
first of all to upload the file let's
get the file name so file name is equal
to file upload one dot file name would
give us the file name and then what we
need to do we need to upload that file
to this data folder and to do that again
we're going to use file upload one
control dot it has got this posted file
property which will be the file that the
user has selected within the upload
control so save that posted file so we
are basically invoking save as so this
method is going to save that posted file
to whichever path we are going to
specify here so we want to save that
file to this data folder and how are we
going to get hold of this data folder we
are going to make use of server dot map
path function we discussed about this
function in the previous sessions of
this video series so please watch that
video if you are new to this function so
where is that folder present it's
present within the root directory so I'm
going to use this syntax tilde for slash
data so within the root directory we
have this data folder so that's the
folder to which I want to save the image
but what is the name of the image
going to be that is present in this
variable so let's pass that to this
function
so these two lines of code should upload
the image to that data folder once the
image is uploaded what we need to do we
need to loop through that data folder
and what are the images that we have we
need to add all those images to the
panel control okay
so basically to loop you know to a
folder in dotnet we use the classes that
are present in system dot IO namespace
so let's go ahead and include that
namespace system dot IO and now to loop
through each file within a folder let's
use a for each loop
so for each is string let's call this
variable SS STR file name in there's a
class called directory class and this
class has got this method get files
which is going to return you know the
file names that are available within
that directory as a string array so we
have to give the part of the directory
again how are we going to get a part of
the directory use server dot map path
function so basically this one line of
code here is going to loop through each
file within this data folder okay and
then what we need to do we need to add
the image to this panel control now we
are not going to use image control
instead we are going to use image button
that's because if we use an image
control it will only display the image
it will not be clickable but our
requirement here is we want to display a
thumbnail within the image gallery but
then that thumbnail should be clickable
upon clicking that we want to redirect
the user to another page where he can
see the original image so that's the
reason why we'll be using image button
control instead of image control so and
we have to add those image buttons
dynamically to this panel control so
let's go ahead and create an instance of
image button
and let's call it image button right now
for the image button to display an image
we need to set image URL property but to
get the image URL property we know that
the images are present in this directory
but we also need the name of the image
within that so this variable has got the
full path of the image but we don't want
the full part we only need the file name
so what we can do is we can use another
class file info let's call the variable
as file info so if you give the full
part of the file this class is going to
return us the metadata of that file like
the name of the file the size of the
file the extension of the file etc so
this variable has got the full part of
the file we are going to pass that to
this object and this file info will give
us the name of the file so now let's go
ahead and set image URL property of
image pattern object so image URL equals
till for /data /index older we can use
this file info object dot name should
give us the name of the image so within
the route to directly that's data folder
within that you know whatever file you
have got written that filename and we
are setting that as the image URL for
the image pattern now the next thing is
we want the width of the image button
and height of the image button to be 100
pixels so we need to set the width and
the height so let's go and do that so
image button dot width and if you look
at this width property this expect the
width to be set in units so I'm going to
use this unit class and again this is
called a static method pixel where you
can specify the pixels in integer format
so I want the width to be 100 pixels and
similarly we want the height to be
pixels all right and the next important
thing if you look at these images this
is space between each image that is
added and then there's also the space
between the border of this panel and
within the image so to get that space or
that padding we have to set a property
so and how do we set the property's
image button dot style dot add so we
need to specify the style key and the
value for that style so what's the style
we want to set padding for the image
button and how much you want the padding
to be 5 pixels all right and the next
important thing is of a requirement when
I click this image button you know
obviously they should be an even handler
associated with that image button and
that even the handler should be executed
and within that even handler we are
going to write the code to redirect to
another page to display the image so
basically we need to attach the even
handler to the click event of this
button control ok and keep in mind these
buttons are dynamically added so we need
to hook up the event handlers also
dynamically so image button dot click so
to the click event of the image button
plus equals so basically to the click
event of this image button hook up this
even handler that's what we are telling
here ok so we will implement this
function in just a bit
alright so the next step is to actually
add this image button to this panel
control ok and the ID of the panel
control is panel 1
so panel 1 dot controls dot add we want
to add the image button control so let's
pass that to this function that's it at
this point we should be able to upload
in the mage and then at the same time we
should be able to add that image to the
panel control let's actually run this
and see if it works
as expected so obviously this folder has
got all the images so at the moment we
don't have any images within the folder
that's why the panel control is
displayed like this so let's go ahead
and select an image and let's click
upload look at that the image is headed
and keep in mind we also have hooked up
and even handler now let's say we'll
simply use response dot write and see if
this even handler is working as expected
so when I click that button what I
basically want to do is I want to write
something on to the page we will see if
this even handler is getting executed at
all all right let's save the changes
let's build it let's reload this page
let's click upload let's actually upload
another page another file so we got that
as expected let me click this button
look at that the even handler is not
executed let me click this upload button
so the images are displayed now when I
click this image button so obviously
there is an even handler associated with
that so this is the even handler so this
even handler should be executed and that
should write this message on to the web
page but is it doing it look at this
when I click this button so this is an
image button so obviously when we click
this the webform is posted back but the
even handler is not doing what it is
supposed to do why is that that is
basically because keep in mind these
controls are dynamically added so
obviously when we click this upload
button
the controls are dynamically added the
even handlers are hooked up but then
when I click this button now the webform
is going to be posted back to the server
so this is a fresh request to the server
so at that point and it doesn't know
about these dynamically created controls
and the even handlers that are
associated with that so it's a brand-new
request so it forgets all that and
that's why we have this blank page so we
have to fix this issue first and to fix
that
what I'm going to do I'm going to
extract this piece of code into its own
method so let me right click on that and
let's select refactor extract method and
let's call this upload image so we have
a function here upload image so what I'm
going to do is notice that instead of
invoking this upload image within the
button control I'm actually going to
invoke that within the page load event
and then within the button control after
we upload the image to this data folder
I am simply read I I'm simply going to
redirect the user to the same page and I
will tell you in a bit why we are going
to do that so let's redirect the user to
the same page look at this this is
webform one so we are going to redirect
the user to the same page where from one
dot aspx and this is going to solve our
problem okay so basically what's
happening here with this change let's
actually run this and see if this even
handler gets fired and then I'll explain
why it works now okay so first of all
look at this as soon as the webform
loads it checks the folder whatever
images it has got it it has added them
to this panel control now look at this
when I click this image look at that
button click when I click this image the
same message so the event handlers are
executed that's basically because look
at this when are these images added
these images are added within the page
load event so within the page lifecycle
in web forms so page load happens before
the button click event so within the
page load event they are adding image
buttons associating the event handlers
and then you know as part of the same
request we are clicking the button
control so that's why at this point
is able to read remember the image
controls and the event handlers that are
hooked up to each image control okay
that's why it's working now as expected
let's actually make a simple change here
instead of writing button click let's go
ahead and do something dynamically here
now look at this this image button click
event handler this gets fired for each
image that is there within the panel
control so obviously when we click this
image this event handler gets fired
so here the sender parameter is nothing
but the image button that has raised
that event so we know that the sender
here is actually an image button control
so what I'm going to do now is I'm
actually going to typecast this sender
to be of type image button because we
know sender is of type image button and
then image button has got a property
image URL so I'm simply writing the
image URL there so let's now run this
and click on the image and see we get
the image URL not look at that till 4
slash data that's the name of this image
and when I click this that's the name of
this image so all that is left right now
is to redirect and display this image so
instead of doing this pond start right
what I'm going to do is respond start
redirect and let's run this
okay so here we have the image let me
click on that so I'm redirected to this
image page because at localhost webforms
data folder and we are displaying the
image on this web page but we don't want
this we want a button control on another
web form and then on that page we want
to display the image and then once we
click that button we want to redirect
the user to the gallery so we want to
button as well so instead of simply
displaying the web form in the browser
like this let's actually add another web
page let's call it platform 2 dot aspx
and within this wave form I want a
button control and let's set the text on
this button to something like back to
gallery and obviously let's include a
break here and then maybe another break
and then an image control so this image
is going to display the original image
and then maybe we let's also include
another button at the bottom but before
we do that let's actually flip to the
design mode let's double click this
button control and actually let's make a
copy of this button so we actually have
in our button on the top and the bottom
okay now when we land on this platform
what we need to do we need to display
the image the original image within this
image control right now first of all
let's go back to webform 1 dot aspx so
instead of redirecting to the image URL
what we are going to do is we are going
to redirect to
platform to dot aspx and then we are
going to associate a query string with
this URL and let's call it maybe image
URL so this query string is going to
contain the part of the image so image
URL equals they made you other and then
on webform to when the webform two loads
up what we are going to do we are going
to harvest the image part from the query
string and then display it within the
image control so how are we going to get
the query string value we can use
request dot query string and we are
going to get the query string value from
the URL and what is the name of the
query string its image URL
okay so that will give us the image URL
so what we are going to do with that
image URL we are going to set the image
one controls image URL property to that
value that's it we're done
and then obviously actually it's not in
the button click event we have to do
that within the page load event within
the button click event what we need to
do we need to redirect the user back to
the gallery page so response dot
redirect to which page we want to
redirect the user web form 1 dot aspx
all right so let's pull this and let's
actually navigate to web form 1 dot aspx
let's close all the other browsers okay
let's upload another image so upload so
we have a new image here let's select
any of these images now look at that for
some reason it doesn't work but we'll
fix that in just a bit so we are saying
redirect the user to web form to dot
aspx and we are setting image URL equals
whatever but there is a space there
let's get rid of that space and it
should work so when we are redirecting
let's get rid of that space
so within web form - they're getting the
image URL from the query string and
setting the image URL property of the
image so let's run this once again let's
actually go back to web form one page
let's click on this look at that it
works as expected
and then you have this button back to
gallery which when you click you should
be back at this page so let's upload a
new file let's click that and look at
that you get the original image back to
gallery and one more thing to note let's
look at that the first row is filled up
so if I am going to add a new image that
should be added to the second row and
the height of the image gallery should
be automatically expanded look at that I
click that and we come to the original
image alright that's it for today thank
you for listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>