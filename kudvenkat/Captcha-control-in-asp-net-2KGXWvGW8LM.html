<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Captcha control in asp net | Coder Coacher - Coaching Coders</title><meta content="Captcha control in asp net - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Captcha control in asp net</b></h2><h5 class="post__date">2014-10-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2KGXWvGW8LM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 166 of asp.net tutorial in
this video well disk is using capture
control in an asp.net web application
first let's understand the use of
capture control the term capture stands
for completely automated public Turing
test to tell computers and humans apart
here are the two most compelling reasons
for using capture control one of the
reasons is to prevent automated computer
programs from submitting spam comments
capture control ensures only humans can
enter comments and another reason is to
prevent bogus user registrations for
example when we navigate to gmail.com
and when we try to create a new account
notice on this registration page we have
a capture control displayed this capture
control is going to ensure only humans
can register for accounts and not
automated computer programs it's very
difficult for automated computer
programs to read this distorted text
that is displayed in the capture control
let's look at an example now what we
want to do is register you know design a
user registration page as you can see
here we want to capture name email and
password of the user and we also want to
display a capture control on the play
page once the user clicks this register
button if the user has correctly entered
the characters that are displayed within
the capture control in the textbox only
then we want to allow the values the
user entered in these text boxes to be
saved to this registered users table on
the right otherwise we want to display a
validation error message to the end user
now in order to achieve this we have to
first
you know download one of the capture
controls that are available on the
internet there are several of them I
have tested recapture control from
Google it works very well with asp.net
and it's also easy to integrate so let's
look at the steps involved now first we
need to create this database table which
I have already done and here is the
sequel script to do that so this script
is going to create that table and here
we have SP register user
stored procedure and the purpose of this
stored procedure is to simply insert a
row in
two registered uses table that we have
created using this crap I have already
created this table and at the moment the
table is empty now here are the steps to
integrate recapture control in an
asp.net web application the first step
is to sign up for API keys and to do
that navigate to the link that is shown
on the slide here so once you navigate
to that URL you should have a link to
sign up for API keys click on that link
and then sign in with your Gmail
username and password once you sign in
click on sign up now button and enter
your domain name so if you have a
website like prism tech dot-com for
example enter the domain name there I'm
going to enter localhost here and then
click create and go to my account and
notice that localhost is displayed
that's our domain so we need this public
key and private keys in order to use the
reCAPTCHA control in our application so
that's the first step the next step is
to download reCAPTCHA asp.net library
itself and to do that navigate to that
URL so once you are on that page you
have a link here to download the
reCAPTCHA is p.net library click on that
link and then you'll be redirected to
this page click on the download button
so that should download the required dll
and that will be inside it zip folder so
let's navigate to downloads folder
extract the contents of this zip folder
and within this folder notice that we
have recapture dll so we need to use
this dll in our application so let's
select a visual studio here I have an
empty asp.net web application project
all I have done so far is within web
config file I have included a connection
string to this sample database so now in
this project we need to add a reference
to that recapture dot DLL so right click
on the references folder add
reference and let's navigate to C colon
backslash downloads and then select our
recaptured or DLL so that should add a
reference to the assembly now let's go
ahead and add a webform to a project and
now we need to design this waveform so
that you know it's going to look like
this so we need the HTML for name email
password and text boxes and they are
present inside an HTML table to speed
things up I have already typed they
required HTML so I'm simply going to
copy this and paste it on the page so
this is very straightforward HTML and
I'll have this HTML on my blog in case
you need it
so if you look at this HTML all we are
doing is we have a table and inside
table we have a TR and there are two TDs
in h TR so name and we have a textbox
email and there's a text box and then
password and there is a text box and
then a button control to submit and then
a label control so if I flip this to the
design mode so at the moment we don't
have the capture control displayed right
we need the capture control as well but
we'll come to that in just a bit now
once we click this register button this
is where we are going to write the area
dot pet code to save the values that the
user has entered on the form to the
database now we are going to write some
radio dotnet code here again to speed
things up I have already returned that
code first of all we need these three
namespaces so let's copy and paste them
here so this is regular ADA dotnet code
so I'm not going to go into the details
of that and then here we have the code
to actually save the data to the
database table so let's copy that and
paste it within submit button click and
again if you look at this code this is
straightforward ad or dotnet code
nothing to do with capture control so
basically this line is going to read the
connection stream from web config file
we are creating a sequel connection
object using that connection string
we're creating a sequel command object
and remember this tool procedure that we
have created SP register user
they're using that stored procedure and
then we are telling the command type you
know that it says stored procedure and
the stored procedure expects three
parameters at name at email and that
password so we need to specify those
parameter names and the values for them
using the sequel parameter object and we
need to associate these parameter
objects with the command open the
connection and execute the query and
then you know if all this is successful
then in the label we are displaying
message registration successful now
let's quickly test this without capture
control and see if this works as
expected
and once that's good then we will see
how to use capture control so let's say
test test test comm and test is the
password
licorice is to users or registration
successful within our database table we
should have a record there now let's see
how to actually integrate the CAPTCHA
control into our form now so we have
already added a reference to reCAPTCHA
dot DLL which we have downloaded the
next step is to actually include you
know the register direct you on the page
so this register directive needs to go
directly under the page directive on the
form where they require the capture
control to appear so within the source
mode we need to have our register
register director here and again to
speed things up I have already typed the
register director so let's paste that so
we are going to have a tag prefix of
reCAPTCHA and that's the namespace and
that's the name of the assembly okay and
the next thing is wherever we want the
capture control to be displayed we need
to specify this HTML so that's going to
be a recapture control that's the ID for
it run at equal server and we need to
specify public and private keys so this
is just like any other asp.net control
declaration the only additional things
here are the public and private keys so
so I have this already typed so let's
copy that and paste it within our
platform so now we want this to up here
is you know just before the register
button row so let's navigate to the HTML
and just before the submit button we are
going to have another row and another TD
and let's set call span equals two and
then here I'm going to paste that HTML
okay so now we need to specify our
public and private keys and remember we
already have the public and private keys
so that's our public key so let's copy
that
so we are going to specify a public key
there and then we need to specify our
private key so let's copy that and
specify that okay and next within the
code-behind file we are going to check
if the validation control I mean the
CAPTCHA control has succeeded validation
and the way to check that is by using
page dot is valid property so we are
going to check if page dot is valid then
we want the application to execute this
ato dotnet code which is going to insert
the data that the user has entered in
the controls on the form else you know
if this is valid property it's a boolean
property if it returns false then you
know the valid the capture control has
failed validation and in that case we
want to display a message stating
validation fail
that's all there to it so let's go and
run the application quickly test if it
works as expected so first of all notice
that the capture control is being
displayed now let's enter some text
within the fields and I'm going to type
know something else and then click
register button let's see what's going
to happen look at that validation fail
now let's go back to sequel server
management studio and look at that the
data is not saved into the database
table now let's actually type the
correct values so test test and test and
let's enter the correct characters so 3
6 1 click register and look at that
registration successful thank you for
listening and have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>