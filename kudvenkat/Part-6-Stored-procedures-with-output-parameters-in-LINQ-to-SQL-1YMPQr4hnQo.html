<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 6   Stored procedures with output parameters in LINQ to SQL | Coder Coacher - Coaching Coders</title><meta content="Part 6   Stored procedures with output parameters in LINQ to SQL - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 6   Stored procedures with output parameters in LINQ to SQL</b></h2><h5 class="post__date">2014-09-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/1YMPQr4hnQo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part six of link to sequel -
Toria in this video we'll discuss how to
call astute procedure with output
parameters using link to sequel this is
continuation to part five please watch
part five before proceeding the first
step here is to create the stored
procedure itself so let's flip to sequel
server management studio here we've got
a stored procedure with named get
employees by department notice the
stored procedure has got two parameters
the first parameter is the input
parameter and the second parameter is
the output parameter so what is the
stored procedure going to do the stored
procedure is going to written as all the
employees by department so if we give it
a department ID then the stored
procedure is going to return all the
employees belonging to that department
so this is the statement notice that we
are selecting all employees from
employee's table where department ID
equals at department ID whatever
department ID we are passing in and in
addition to that this third procedure is
also going to return the department name
using this output parameter so notice
into this output parameter is selecting
the name column from department's table
where ID equals the past in department
ID so let's quickly test the stored
procedure so first let's declare a
variable and let's call that at the EPD
name of type and we're care so this
variable is going to receive the
department name so we want to execute
this stored procedure get employees by
Department and this stored procedure has
got two parameters the first one is the
input parameter where we need to pass
the department ID and the second one is
the output parameter so we need to pass
a parameter here which is going to
receive the department name and that is
going to be at the PT name and since
this is an odd parameter we use the out
keyword and let's select whatever value
that this variable has received so let's
execute this piece of code but before we
do that we need to create the stored
procedure itself
let's execute first the stored procedure
code and let's refresh the stored
procedures folder so there we have get
employees by Department now let's
execute this piece of code so notice we
get all the employees belonging to
department ID one and department ID one
name is I T so if we pass for example
department ID 2 then we should get all
the employees belonging to that
department and department ID 2 is HR
department now let's see how to actually
call this tool procedure from link to
sequel so let's flip to visual studio
now so the first step here is to go to
the server Explorer and then refresh
this stored procedures folder so now we
have get employees by Department let's
go to link to sequel class design app
file so at the moment we don't have that
stored procedure here so let's drag and
drop this stored procedure from server
Explorer on to link to sequel class
designer so it should automatically
create a c-sharp method for us so we
have this get employees by Department so
within our code behind file we need to
call that method but before that let's
design over webform let's actually drag
and drop a button control onto the
waveform and let's quickly change the
text and ID of this button so let's
change the ID to button get employees by
Department and let's also change the
text on that to get employees by
department and let's double click on
that to generate a click event handler
now let's also drag and drop label
control so within the label control will
display the department name and let's
change the ID of the label to lvl DPT
and let's remove the text from that
label all right so now let's click this
button so now we need to call the
function which represents our store
procedure so the function that
represents our store procedure is this
function get employees by Department so
here first we need to create an instance
of our sample dbcontext class the sample
DB context let's call this dbcontext
equals new sample DB context and here we
are going to call this get employees by
department now if you look at this
method notice that it has got two
parameters the first parameter is the
department ID which will have to pass as
the input parameter to the stored
procedure and look at the second
parameter this is a reference parameter
and this is the parameter which is going
to receive the department name that this
rule procedure returns okay and if you
look at the return type of this method
notice what it is returning it is
returning an I single result of get
employee by Department result okay now
we can change this return type if we
want to employee but we discussed that
you know in a previous video sessions so
I am NOT going to change that now so we
need to pass the department ID so let's
pass Department ID s1 and here we need
to pass a parameter which is going to
receive the department name
so first let's create a variable of type
string let's call this dep t name and
let's initialize that to an empty string
and since this is a reference parameter
we need to use the left keyword as well
and then pass the parameter so whatever
this function returns you know we are
going to set that as the data source for
our create view control so grid v1 dot
data source equals that and let's call
the data bind method and finally within
our LBL department label let's display
the department name
so let's set the text on that to
Department name equals whatever this
variable has received all right with all
these changes let's from this
so get employees by department together
to get all the employees belonging to
department ID one and the department
name is ID that's it for today thank you
for listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>