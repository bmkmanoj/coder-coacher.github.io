<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 2   Insert Update Delete using LINQ to SQL | Coder Coacher - Coaching Coders</title><meta content="Part 2   Insert Update Delete using LINQ to SQL - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 2   Insert Update Delete using LINQ to SQL</b></h2><h5 class="post__date">2014-09-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2KM9HUAemyE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part two of link 2 's equal to
Toria in this video we'll discuss
performing insert update and delete
using link to sequel this is
continuation to part 1 in part 1 we
discussed performing a select so please
watch part 1 before proceeding we want
to have 4 button controls on this
waveform when we click the first button
we want to load all employees from the
employees table when we click the rest
of the buttons we want to perform insert
update and delete respectively so let's
see how to achieve this let's flip
Visual Studio the code that we've got
here at the moment only loads male
employees we want to load all employees
so let's change the code accordingly
employees property is going to give us
all the employees now let's extract this
piece of code into its own method and
let's name the method get data all right
now let's include a button control on
this waveform and let's change the text
on the button to get data and let's also
change the ID to be TN get data let's
double click the button to generate the
click event handler now let's actually
call this method within the button click
even handler
instead of the page load event all right
now let's drag and drop another button
control and let's change the text on the
button to insert and let's change the ID
of the button to BTN insert double click
this to generate the click event handler
so when we click this button we want to
insert a new employee row into the
employees table
all right now anytime we want to do
anything with the data base we have to
use this sample data context class
instance because that is the main entry
point into the database so the first
thing that you need to do is create an
instance of this class so let's wrap
this inside and you
using cloth so that it gets closed
automatically so let's create an
instance of sample data context let's
call this dbcontext
equals new sample data context and let's
create a new instance of the employee
object so employee let's call this new
employee and we need to populate all the
properties of the employee object now we
don't have to supply a value for the ID
property that is because within the
employees table ID column is an identity
column and for the identity columns
equal server is automatically going to
compute the value when we insert a new
record so we don't have to supply a
value for this property so let's apply
values for first-name so let's say first
name is Tim let's say last name is T
let's set gender to male and salary to
55,000 and let's set department ID as
one okay so we have the employee object
so dbcontext
dot employee so this property is going
to have the collection of all employees
so to that collection we want to add
this employee object and in order to do
that we're going to make use of this
insert on submit method and if you look
at the intelligence notice that it is
expecting an object of type employee and
we have the employee object here so
let's pass it as an argument now this
call is going to only insert that
employee object into this collection but
we want that to be saved to the database
table and in order for that to happen we
want to call this submit changes method
and once the employee record is inserted
into the table we want to refresh the
data that is displayed within the
gridview control so let's call this get
data method so what does this get data
doing it's loading all the employees
from the database table so after we
perform the insert we want to call
all get data method alright so with all
these changes let's run this at the
moment if you notice sequel server
employee is stable we have got seven
records so let's click the scat data so
we have all those seven records there
now when we click insert team record
should be inserted and let's quickly
check the database table so notice that
we have that theme row within the
database table as well
alright now let's perform an update so
we want to change things salary from
55,000 to 65,000 so let's see how to do
that so the first thing that we need to
do is have a button control so let's
drag and drop the button control and
then let's change the text and ID
properties let's change the text to
update and the ID property - BTN update
double click on it to generate a click
event handler let's copy and paste this
code and then change it as required all
right so we don't want a new employee
object so we can get rid of that and
what we need to do is load tim's record
from the database table into the
application and DB context dot employees
is going to give us a list of all
employees from that we want a single
employee object so i'm going to make use
of single or default method and we need
to specify the ID of the employee so
let's specify that using a lambda
expression now if you look at Tim record
the ID is 8 so this single or default
method is going to return as an employee
object so let's store that in a variable
of type employee and let's call the
variable employee so now this employee's
holding tim record data and what we want
to do is change salary so employee dot
salary equals 65,000
now what we need to do is submit the
changes to the database table so we can
get rid of this line so then employee
object is already present within that
collection so now this is going to hold
a reference to Tim object and we are
changing the salary of them and then we
are submitting changes so link to sequel
is automatically going to update Tim's
liquor so let's look at that in action
let's run this one more time get data so
at the moment team is on 55,000 let's
click update and notice that Tim salary
is now updated to 65,000 now let's see
how to delete employee's record so let's
drag and drop another button ctrl let's
change the text to delete and let's also
change the ID to bTW and delete double
click this to generate a click event
handler the same idea let's copy it and
change this code as required okay
so we need to load the employee record
that we want to delete so we want to
delete Tim's record so the ID is going
to be 8 and dbcontext
dot employees again this property is
going to give us the list of all
employees from that we want to delete
tim employee object so this is going to
only remove the employee instance from
the collection if we want to persist the
changes to the database we need to make
a call to submit changes so let's run
this and see if Tim's record is deleted
when we click that button so care data
we have all the employees there let's
click delete notice that Tim's record is
gone let's quickly check the database
table so Tim Row is gone from the table
as well that's it for today thank you
for listening
have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>