<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 24   Left Outer Join in LINQ | Coder Coacher - Coaching Coders</title><meta content="Part 24   Left Outer Join in LINQ - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 24   Left Outer Join in LINQ</b></h2><h5 class="post__date">2014-08-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/5K8jwrlKV8E" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 24 of link tutorial in this
video we'll discuss implementing left
outer join and link with inner join only
the matching elements are included in
the result set non matching elements are
excluded from the result set with left
or to join all the matching elements
plus all non matching elements from the
left collection are included in the
result set let's understand this with an
example let's flip to visual studio here
I have a new console application to
which I have already added department
and employee classes these are the same
classes that we worked with in the
previous session notice that here we
have got two departments and with an
employee class we've got five employees
notice that here Mary does not have a
department associated with her now what
we want to do is left join this
employees collection with departments
collection now when we do a left join we
know that we will be able to retrieve
all the elements from the left
collection irrespective of whether they
have a matching element within the right
collection or not so in this case we
should be able to include all the
employees within the result set now in
the output what we want is employee name
and their respective department name now
since Mary does not have a department
associated with her we want to print a
message saying no Department against
name so let's see how to achieve this so
within the main method first let's
create a variable to hold the result
let's call it result so from e n
employee dot get all employee so this is
going to give us the list of employees
and here this is going to be our left
sequence which we want to left join with
departments so we are going to use the
join keyword join the n department dot
get all departments so here our list of
employees is going to be a left
collection and list of departments it's
going to be our light collection now we
need to specify the join condition so on
eid or department ID equals d dot ID and
what we want to do with the results of
this join is project them into a group
and let's call the group e group
from the n.e Group default is empty so
what is this going to do now we know
that some of the employees are not going
to have departments associated with them
if that's the case we want to return the
default for the department for such
employees now what is department type
it's a reference type and we discuss
this default of empty method in detail
in one of our previous video sessions
this method is going to return null for
a reference type right so if an employee
does not have a department associated
with him then we will get now so now
what we want to do is project an
anonymous type and specify the
properties that we want in that type so
all we want is the employee name and
their respective department name
so let's include those two properties
employee name equals e dot name and
Department name equals D dot name and
now let's use a for each loop
so for each where the end result what we
want to do is print the employee name
and the respective department name so V
dot employee name let's print a tab
space and then the department name so
now when we run this notice that it
prints the first four employees without
any problem but when it gets to the last
employee that is Mary element it's
drawing null reference exception object
reference not set to an instance of an
object why is that that's because if you
look at Mary she does not have a
department associated with her so in
this case D will be now and then we are
in working a property on that null
object so it is going to throw that now
the reference exception so to avoid that
what we need to do is check that object
for now if it's now you know we want to
print this message no Department against
our name so d equals now if that's true
then print this word no department
else print the department name so now
when we run this notice that we get the
output so here notice that Mary record
is also included in the result set
irrespective of she in spite of she not
having a matching element within
departments collection so this is
effectively a left joint and here we are
using sequel like syntax now let's see
how to rewrite this query using
extension methods so from employee
I mean employee door kit all employees
now when we want to do a left outer join
using extension methods syntax then we
use group join method so dot group join
so we want to group join employees
collection with departments collection
so in this case employees collection is
going to be our outer sequence and
departments collection is going to be
our inner sequence the department dot
get all departments and then we need to
specify the outer key selector energy
selector and then the result selector we
discussed all these parameters in detail
and one of our I mean in our previous
video sessions so router key selector is
going to be e dot department ID and in a
key selector is going to be d dot ID and
then finally we need to specify our
result selector so we know that we are
going to get back employee objects and
departments so what we want to do is
project them into a new anonymous type
with the same objects amp and the
department's okay so now what we want to
do is give the left or to join so for
that we are going to use select many so
now what we are going to get back is
list of employees and the departments
right so said such that now we know that
some of the employees are not going to
have departments associated with them in
that case you know we want to return the
default for the department
again we are going to use default of
empty extension method so Z such that Z
dot departments are going to be empty
for some of the employees in which case
we want the default to be returned so we
use default this empty method and now we
need to specify our result the selector
so what we want in the result is let's
say we get back a and B so we want to
project them into a new anonymous type
and within the anonymous type we want
those two properties employee name that
equals a dot m dot name and Department
name equals B dot name so that's our
department object we know that
Department can be now for some of the
employees so we need to check for now so
B equals now if that's the case print no
Department else print the name of the
actual department let's run this now so
we get the same output so here we're
using extension methods in tags so in
order to achieve left outer join with
extension methods index style we use
group join select many and default if
empty
that's it for today thank you for
listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>