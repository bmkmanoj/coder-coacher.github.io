<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>asp net multiple file upload with progress bar | Coder Coacher - Coaching Coders</title><meta content="asp net multiple file upload with progress bar - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>asp net multiple file upload with progress bar</b></h2><h5 class="post__date">2015-07-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/QJJSnUVX6PA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 84 of jQuery tutorial in
this video well discus using jQuery
progressbar with asp.net file upload
control so here is what we want to
achieve well the files are still being
uploaded we want to display a progress
bar with this message which says
uploading as soon as all the files are
uploaded we want to display the complete
message in the progress bar and we want
this progress bar itself to slowly fade
out so let's see how to achieve this
let's flip to visual studio so the first
step here is to add a folder to our
asp.net project which is going to store
the uploaded files so let's call this
folder uploads the next step is to add a
generic handler to a project which is
going to do the actual work of uploading
the files and let's call this generic
handler upload handler so within this
process request method we are going to
write code to save the files to this
upload folder so we are going to make
use of this context object which is
coming into this function as a parameter
so the first thing that I'm going to do
here is check if the request object
files property count is greater than
zero if the count of the files is
greater than zero then we know that the
client has uploaded at least one file so
at that point we want to save those
files to the uploads folder let's go
ahead and use the context object again
so context dot request dot files and if
you look at this files property notice
from the intellisense what it's
returning back it is returning HTTP file
collection object so let's go ahead and
create an object of that type HTTP file
collection and let's call this files so
this object now contains all the
uploaded files I'm going to use a for
loop here so for end I equals 0 I less
than
files dot length files count length is
in jQuery I plus plus so what do we want
to do we want to retrieve the file and
save it to the folder so I'm going to
use this files property object and files
of hi and if you look at what this files
object contains look at that it's
actually going to return HTTP posted
file back so let's create a variable of
that type HTTP posted file and let's
call this file okay so we are looping
through each file now within this object
we have the file that we want to save so
now we need to get the path to which we
want to save we actually want to save
that file to this uploads folder now
let's use the file name as what we have
on the client machine okay so that will
be the file name but we want to save
that file to this uploads folder so I'm
going to create a variable here let's
call it file name so basically this is
going to get a complete path where we
want to save the file to okay so we want
to save it to the uploads folder so this
context object has got server dot map
path function so let's make use of that
the uploads folder is actually present
in the root directory of our web project
so till represent the root directory
within the root directory we have the
uploads folder so that is the path to
which we want to save so to that part I
am going to append the actual file name
so where can I get the file name from I
can use this file object and that has
got this file name property now one
important thing to keep in mind yes so
this code will give us the path where we
want to say we want to save it to the
uploads folder and this file name
property of that HTTP posted file object
you know as far as google chrome is
concerned it works correctly it returns
just the file name not the complete path
of the file that is not the complete
path of the client in our file
it's going to return just the filename
okay but whereas Internet Explorer it
returns the complete path from the
client machine okay so that's why it's
this piece of code is not going to work
in IE
but this will work fine in google chrome
for this code to work in both the
browsers
I'm going to make use of a class that is
pleasant in system dot IO and that is
this path class and this has got a
static function get filename so to this
function if you give a path from that
path this will give us the actual file
name but if you give it just the file
name it will simply return on that file
name so now this piece of code is going
to work across both the power browsers
chrome as well as Internet Explorer all
right so the last thing that we need to
do is save this file to that uploads
folder so we have the complete path here
so on the file object I'm going to you
call save as function and specify the
file name which contains the part you
know including the part where we want to
say all right so that's all the code
that's actually acquired to upload the
files okay but then you know all of this
code you know I'm going to upload from
my client machine so the client is going
to be this machine server is also going
to be this machine so this piece of code
will execute in no time but for our
progress bar to be visible while they
are uploading files we have to introduce
some kind of network latency and to do
that I'm going to make the thread that
is currently executing this request to
sleep 4,000 milliseconds so while we are
uploading every file let's use system
door threading dot thread dot sleep and
then make that thread sleep 4,000
milliseconds okay all right so our
handler is ready now the next step is to
design this waveform so it looks like
this so we need this little text select
files followed by that and upload file
upload control and then a button and the
progress bar itself so let's include
select files little text and followed by
that
we need a file upload control let's
include two HTML break elements and then
we need the button so input type equals
button let's give it an ID let's set it
to BTN upload and let's set the value on
the button to upload files okay and
let's include two more break elements
and then we need the progress bar itself
before that I'm actually going to
include it development and set the style
attribute and set width of this div to
300 pixels otherwise what's going to
happen the progress bar will span across
the entire webpage so we don't want a
big progress bar we want maybe the width
of that progress bar to be 300 pixels so
I'm using a container div here and then
using another day which will be our
progress bar so let's give it this ID
progress bar and inside this div I'm
going to include a span element now why
do we need span element to display this
text uploading and complete now we want
to position the span element relative to
its parent you know the development so
I'm going to set the style attribute
here and set the position property to
relative so we want this span element to
be placed relative to its parent this
development that's why we have to set
that position attribute there on the
development itself to relative and on
this panel element let's go ahead and
set the style attribute here let's go
and set position to absolute we discuss
this in detail in our previous video
session and we want the left positioning
to be 35% and the top positioning to be
20%
and let's include this initial text
which says loading within the span
element and let's give this panda
element an ID let's call this progress
bar - label okay and initially when the
web page loads we don't want there's a
div or this pan to be visible so I'm
going to set display : none all right so
let's go ahead and drum this page and
see if we get the UI that is similar to
what we have on the slide so we have the
file upload control the upload files
button we don't have the progress bar
yet we want that to appear when we
select files and when we click upload
files so go right so now all that is
left is to write the jQuery code to call
the upload handler and upload the files
so when should we upload the files
whenever we click the upload files
button so we need to wire up click even
handler to that button and if you look
at that button it has got an ID and it
is BTN upload so let's copy its ID and
find the button by using the jQuery ID
selector and let's wire up the click
event handler
alright so within the click event
handler the first thing that we want to
do is retrieve the files from this file
upload control and that has got an ID
file upload one so let's use the jQuery
ID selector one more time find that file
upload control and I'm going to use the
files property on the file upload
control so that is going to return the
files that the user has selected using
this file upload control and let's store
that in a variable let's call that files
okay
so f files dot length
if that is greater than zero then we
know that the user has selected at least
one file using the file upload control
and at that point we want to issue an
ajax request okay but before that we
have to retrieve all the files from the
files collection and added to the form
data that we want to send it to the
server so I'm going to create a variable
here let's call it form data and I'm
going to create a new instance of form
data object and I'm going to use a for
loop again here to loop through each
file that is present in this files
variable so for where I is equal to 0 I
less than files dot length I plus plus
so what do we want to do to this form
data object we want to append the file
name as well as the actual file that we
want to send to the server so form data
dot append files of I dot name and the
file itself so files of hi all right so
at this point this form data object has
got all the data that we want to send to
the server the next step is to issue the
Ajax request so let's go ahead and use
the jQuery AJAX function and specify our
options so the first thing that we need
to specify is the URL that we want to
call so what's the URL the URL is this
upload Handler dot a shx so let's copy
its name and specify it as the value for
our URL option and we want to issue a
post request so I'm going to set method
to post and the data that we want to
send to the server that's present in
this form data object so form data and
two important things are we need to set
content type to false so basically
setting content type to false will tell
jQuery not to set any header not to set
any head of
they'll type okay and we also need to
set another option process data to false
so these two are important setting
process data to false you know by
default a you know jQuery is going to
convert form data to a string and if it
does that it's going to fail so that's
why we need to set it to false process
data to false so that it will not try to
convert form data to a string okay and
when the request completes successfully
we want to call a function so this is
the function that gets called when the
request completes so when the request
completes that means what we have
uploaded the files so at that point what
we want to do we want to display this
text complete within the progress bar so
to display that text we need to find the
span element the span element has got an
ID progress bar label so let's copy that
and actually outside this Ajax function
I'm going to create a variable let's
call this progress bar label equals
that's the ID so let's use the jQuery ID
selector find the progress bar label
similarly we need let's also find the
prove this bar dev so I'm going to
create another variable here let's call
this progress bar there and the ID of
the progress bar dev is progress bar
okay so within our success callback
function the first thing that I want to
do is set the text within the progress
bar label using text function so we want
to set that to complete okay and then we
want this progress bar to slowly you
know fade out so I'm going to call that
progress bar dev and call fade-out and
let's say we want that to fade out
slowly over a period of 2,000
milliseconds okay and if at all if there
is any error we want to associate a
callback function and that function is
going to receive the error object and
let's simply alert the error status text
all right now when we click the upload
button we are issuing the Ajax request
okay and at that point we also want the
progress bar to be visible and we want
to display the text which says lower
uploading on the progress bar so
actually here we want to say uploading
not loading okay but then in our first
time it displays that when the files are
uploaded successfully it's going to set
the text to complete right so we want to
change it back to uploading on a
subsequent request so that's why when we
click the button I'm going to set after
we issue the request I'm going to set
the text to uploading and what we want
to do is we want this progress bar to
display the progress bar so I'm going to
call progress bar jQuery UI function
and we really don't know how long the
upload is going to take so what I'm
going to do is get a non-deterministic
progress bar and to do that we need to
set value option to false and instead of
displaying this abruptly let slowly fade
that in over a period of maybe 500
milliseconds okay so that's all there to
it let's save all our changes run our
project and let's select some files
so within sequel and images have got
some files so I'm going to select all of
these files now look at this at the
moment I am able to select only one file
why is that that's because you know this
file upload control that we have on the
page by default it it allows only one
file to be uploaded if you want to
upload multiple files then all you need
to do is set I love it's on the file
upload control so it has got allow
multiple so let's set that to true so
with that let's go ahead and run this
now let's select our files so let's say
we want to select all these files okay
so let's click open so we have five
files now let's click upload files look
at that it says uploading and it should
be uploading to our uploads folder and
look at this as soon as the files are
uploaded it says complete and the
progress bar slowly fades out so let's
go to uploads folder open that and look
at that we get the files
so here we have our upload handler code
that's the HTML and that is a legit
recode thank you for listening and have
a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>