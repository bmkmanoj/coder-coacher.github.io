<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Sorting an asp.net gridview in ascending and descending order - Part 48 | Coder Coacher - Coaching Coders</title><meta content="Sorting an asp.net gridview in ascending and descending order - Part 48 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Sorting an asp.net gridview in ascending and descending order - Part 48</b></h2><h5 class="post__date">2013-04-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/uHQWoykoiAw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello welcome to prism technologies I am
venket this is part 48 of asp.net
grid-view tutorial in this video we'll
discuss about sorting in asp.net grid we
control both in ascending and descending
order in part 47 of the asp.net grid
week tutorial we discussed about doing
exactly the same thing but if you
remember the problem there was we were
never able to sort the data in
descending order look at this when the
waveform loads the data is sorted by
employee ID I click on this column once
again it doesn't get sorted in
descending order let me click on the
name column I click on it the first time
the data gets sorted in ascending order
I click on that once again notice that
that data doesn't get sorted in
descending order and that was because if
you look at this sort Direction property
of this grid view sort even documents
object this was always returning
ascending and that was the reason why
the data was never sorted in descending
order so here I click on employee ID the
first time
so the sort expression is employee ID
saw Direction is ascending I click on it
the second time look at that the sort
Direction is still ascending and that's
the reason why the data is not getting
sorted in descending order
let me test that with this name column I
click on the name column notice that
sort expression is named so our
direction is ascending I click on that
once again it's still ascending okay in
this video we'll discuss about
correcting this problem there are three
simple steps to follow you know to solve
this issue okay obviously the first step
is to create a know a custom attribute
on the grid view control so I'm going to
add two custom attributes for this grid
view control the first one I'm going to
call it current sort field and I'm going
to set that look at this when the grid
view control first renders the data is
sorted by employee ID so the current
sort field is going to be employee ID so
that's the column by which the data is
sorted and current sort direction
and I'm going to set that to ascending
because when the waveform loads it's
sorted by employee ID and in ascending
order
okay so current sort field is employee
ID current sort direction is ascending
those are the two custom attributes this
is the first step and the second step is
to basically create a private method now
remember what is the problem here the
problem is this e dot sort direction was
always giving us ascending somehow we
have to remember the previous in a sort
direction and then change it if it was
ascending change it to listening if it
is descending change it to ascending if
we are sorting it by the same column so
that's what we have to achieve and to do
that we'll have to implement a private
method so just to speed things up I have
this private method already implemented
let me copy and paste that here and if
you look at this private method it's
very simple and straightforward all it
has got is four parameters here and if
you notice the first two parameters
it's the gridview control so the
gridview control which you are sorting
in our case it's could be one control
and gridview sort events or event
arguments or object so this object is
coming into the sorting event handler
method as a parameter okay so that's
what we will be passing in to this
private method so those are the first
two parameters and the last two
parameters are the output parameters
which are nothing but sort a direction
and sort field okay so the script view
sort event augments object has got those
two properties sort a direction and sort
field so we are going to use these
output parameters basically to remember
the sort field and the sword direction
that was used to sort the gridview
control and then change them dynamically
okay
so here I am initializing these two
output parameters or directional sort
field to whatever the properties are you
know of this grid view sort event
arguments sort expression and sort
direction okay remember the first time
in the grid we control render is you
know it's sorted by employee ID and in
ascending order and sort expression is
going to return
employee-id and ascending now no matter
how many times you click on this
employee ID column remember short
Direction is always going to be
ascending and that's what will be stored
in this sort Direction output parameter
it will always be ascending somehow we
will have to change it to descending if
the sort field is the same caller for
example you know I click on employee ID
if I click on employee ID again you know
we need to change that to descending the
sorted direction and that's what this
method is going to do ok so that's the
first step the first I mean here we are
first retrieving sort expression and saw
Direction storing them in these output
parameters and then we are checking ok
the sort field and current sort
Direction attributes remember in the
first step we have set them to employee
ID and currents or direction is
ascending if both of them are not equal
to now which is what is the case right
now it comes into this block and checks
ok is the short field equal to whatever
is there as the current short field as
an attribute on the grid we control ok
so if I click on employee ID once again
what's going to happen short field will
be employee ID and the attribute here is
employee ID ok so if that is the case
then check the current sort direction so
is the current sort direction ascending
and that's true so the data is already
sorted by ascending order so all we are
doing is if it's ascending then set it
to descending the sort direction this
particular output parameter if it's not
ascending then we know it's descending
in which case we want to set it to
ascending bag ok and then what are we
doing we are readjusting the attributes
of the gridview control current sort
fear you know set it to whatever we are
going to sort it by and look at this
sort direction if the sort direction is
ascending then we want to use those
abbreviated forms of the Y sequel server
well through a syntax error we can't use
complete words ascending and descending
we have discussed about that in the
previous session as well so I am using
the attributes here if it's ascending
use the string
see otherwise we know it will be
descending in which case use de se so
this is our second step implement the
private method to remember the sort
direction okay and then finally what we
need to do we need to invoke this
private method within our you know
sorting even handler method okay so to
do that let me comment this and then
first of all remember this private
method has got two output parameters so
we need to declare two variables which
we are going to pass as parameters as
output parameters to this function so
the first parameter is of types or
direction so let me go ahead and create
a variable of type sort direction
and let's initialize that to you know
ascending and then the second parameter
is of type string so let me create a
variable here of type string string and
let's call this sort feel and let's
initialize that to an empty string okay
so these two will be passed as output
parameters so let's invoke our private
method so the name of the method is sort
grid view the first parameter is the
grid view control that we want to sort
it's nothing but grid view one control
so I'm going to pass that grid view one
grid view sort even documents object you
know that's coming into this event
handler method which is e and then the
output parameters so we have to use the
out keyword when passing in an output
parameter and the first parameter is
sort direction so I'm going to pass that
and the second parameter is our sort
fear and I'm going to pass that variable
which we have just created so now what's
going to happen these two output
parameters are are going to receive you
know the values from this private method
now sort field is also an output
parameter so I have to use the out
keyword alright after we are done with
that now what we need to do is we need
to resort the grid view control and to
do that look at this I am going to make
use of this variable here STR sort
direction and then notice that we are
using the grid view sort event arguments
objects sort a direction property
instead of that I'm going to use you
know this variable so if that variable
is equal to ascending then set the
abbreviated form ASC otherwise set it to
descending and then we are use we are
passing that to our employee data access
layer that's it let me go ahead and run
this and see if it's going to work as
expected so when the grid we control
renders the data will be sorted by
employee ID I click on this column look
at that it's sorted in descending order
I click on that once again resorted in
ascending order
I click on the name column the first
time it sorted in ascending order I
click on it once again it's sorted in
descending order okay so it's working as
expected another thing here look at that
we are passing in grid view control grid
view one if you don't want to hard-code
the ID there you can use the sender
object here okay what is sender sender
is the control that has raised the event
in our case it's nothing but grizzly one
control so if you don't want to use grid
v1 I can simply say sender but sender
what is the type it's object so we need
to typecast it to be of type grid view
control using the typecast operator so
I'm going to do that grid-view
so even this is going to work fine just
you know instead of using the ID of the
control I'm using the even handler
parameter there so I click on that it
gets sorted as expected all right on
this slide you can find resources for a
speedrun in c-sharp and sequels of
interview questions that's it for today
thank you for listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>