<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Angular custom validator example template driven forms | Coder Coacher - Coaching Coders</title><meta content="Angular custom validator example template driven forms - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Angular custom validator example template driven forms</b></h2><h5 class="post__date">2018-02-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2AAUf32pKy8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 25 of Angela credit
tutorial in this video well discuss
creating a custom validator in angler
template driven forms this is
continuation to part 24 so please watch
part 24 before proceeding notice within
our department select list the first
default option is selected meant we want
to make sure a valley department is
selected if select Department is
selected then we want to validate and
display Department is required
validation error notice the default
option HTML is right here if we can set
this default option value to null then
the angle of built-in required validator
works just fine we discuss this in
detail in our previous video but for
some reason if you're not able to set
the value of this default option to null
maybe because you are loading this
option from a database table or for some
other reason then this built-in required
validator does not work the reason it's
not working is the default option value
in our case it is minus 1 so this value
is being treated as a valid selection
notice the model right here we have that
minus 1 against the department property
so it's treating this value as a valid
selection but we know this is not a
valid Department selection so we want
the required validation to fail to make
this work the way we want we are going
to implement a custom validator to use a
custom validator in template driven
forms we have to create that validator
as a directive once we have the
directive created we can then use the
directive as an attribute on the select
element that we want to validate this is
going to be a configurable and reusable
Val data we can use it with any select
list in an angular application I'm going
to place our custom directive within a
shared folder at the moment within our
project we don't have a shared folder so
let's create that within this app folder
let's name the folder shared and let's
place our custom directive
than this shared folder and I'm going to
name our custom directive select
required a validator
and since this is a directive I'm going
to give it this dot directive suffix and
this is a typescript file so it also has
a dot TS extension just like how a
component is a class in angular a
directive is also a class so first let's
go ahead and create a class I'm going to
name this class select required
validator directive since we are
creating a custom validator this class
must implement this validator interface
we don't have this validator
interface imported yet so let's go ahead
and include the required import
statement so we want to import validator
from angular forms now when creating a
component class we decorate that
component class with at component
decorator along the same lines when we
create a directive we decorate the class
but at directive decorator we don't have
this directive imported yet so let's
include the required import statement to
import it from angular core now once we
have done creating this directive we are
going to use it as an attribute on the
select element that we want to validate
of our department select element is
right here so on this select element I'm
going to use our directive as an
attribute like this notice for example
if we want to use a required attribute
we just use that required attribute on
the select element similarly when we
have our custom validator ready we are
going to use that directive as an
attribute like this so we need to give
our directive a selector so let's
include the selector property here and
if we are creating a component we
include the selector in a pair of single
quotes like that since this is a
directive and a directive is used like
an attribute we need to enclose that
with a pair of square brackets like that
notice of a validator class is
implementing the validator interface so
you can imagine what is our next logical
step is going to be we need to provide
implementation for the method that this
validator interface provides and that
method is validated and this method is
going to take in one parameter and that
parameter is the control that we want to
validate and notice the type of the
control is abstract control
we don't have it imported yet so let's
import it from angular forms now you
might be wondering why is the type of
the control that we want to validate is
specified as abstract control and not
anything else now if you take a look at
our greedy employee form we have several
controls on this form like we have a
text box a check box drop-down list etc
all these elements are represented as
form control in angular so we have a
class called form control now why are we
not using that type for the control that
we want to alidade they using a
different class and that's called
abstract control now it turns out this
abstract control is the parent class for
both form control and form group classes
now what is a form group class if you
look at our create employee component at
the top we have a form element now this
form element is represented as form
group class in angular and this abstract
control class is the parent class for
both form control and swamp group and in
addition to this route form group here
represented by the form element we can
also have nested form groups will
discuss nested form groups in our
upcoming videos in this series
so to allow us to be able to pass either
a form group or a form control to this
validate method angela has decided to
use the parent type which is the
abstract control next let's specify the
return type this method is going to
return either an object or now this
method returns null if the validation
succeeds and
returns this object if the validation
fails and this object is going to
contain a key and a value pair key is of
type string and the value is of type any
if the syntax does not make sense at the
moment don't worry it'll be clear in
just a bit let's format this code a bit
now let's implement our validation logic
within this validate method so what is
our requirement here if someone selects
this first option select Department then
we want the validation to fail so if the
selected option value is minus 1 then
the validation should fail otherwise it
should succeed notice we are passing the
control that we want to validate as a
parameter to this method in our case we
are passing the Select element so I'm
going to include a boolean expression
here so if the control value is minus 1
then we know the user has selected the
first option so in that case we want to
fail the validation and we know this
validate method returns this object if
the validation has failed so let's
return the object and this object is
going to contain a key and a value pair
and we know he is of type string and
this can be any string but I'm going to
return this string default selected to
indicate that the user has selected the
default option and the value can be
anything but I'm going to specify a
boolean true to indicate that the
validation has failed now if the user
has not selected minus 1 then we know he
selected a valid Department in that case
I want to return null indicating that
the validation has succeeded let's
include the return keyword now we know
this control here is our select element
and when angular validation system
detects that we are returning an object
it's going to assign this key here to
the errors collection of our select
element and then we can use this key
within
view template to determine that this
custom validator has failed validation
and then display the appropriate
validation error message so within our
view template let's scroll down to the
Department select list notice we have
these panel iment that displays the
validation error message right here and
we want this pan element to be added to
Dom only if the department release touch
and if the Department feels errors
collection property has got this key
default selected remember this is the
key that we said when our custom
validator fails validation so we are
using that to show or hide this
validation error message and notice they
using our custom required validator just
like how we are using the other built-in
validators like required since we are
already using our custom required
validator we don't have to use this
built-in required validator so let's get
rid of that now before we can use of a
custom validator we have to register our
custom validator with a list of
validators that angular already
maintains and we do that by using this
providers property so these three
properties here register our custom
validator we don't have this ng
validators imported so let's import it
from angular forms now if you look at
this providers syntax right here it's a
bit complicated so let's break it down
the first question that comes to our
mind is what is this ng validators it's
all in capital letters this is called
opaque token in angular
well discuss what an opaque token is in
detail in our upcoming videos in the
series for now understand this ng
validators is an opaque token and it
contains the list of all validators
including the angular built-in
validators for us to be able to use our
custom validator will have to register
it with ng validators and thus the
reason we have said use existing
property value to a custom
later class and then to signal to Angela
to add this validator to its list we
also need to set this multi property to
true finally we need to import our
custom required validator in the module
where we won't use it at the moment
within our project we only have one
module and that is our route module so
let's open the route module file which
is AB dot module dot ES and include the
required import statement to import it
and then we also need to specify that
type within the declarations array let's
say all our changes and then take a look
at the browser notice now when we touch
the department field and leave it
without selecting a valid department we
see the validation error right away and
when we select a valid department the
error disappears if we select the first
option again which is not a valid
department we see the error back so it's
all working as expected
now notice within our custom validator
we have hard-coded the invalid option
value which is minus 1 now let's say for
some reason we changed that invalid
option value which is minus 1 at the
moment to something along the lines of
minus 1 0 1 now when we do this we also
have to change our custom validator code
now remember we discussed we want this
validator
to be configurable and reusable at the
moment the baby have implemented it it's
not configurable and it's also not
reusable meaning if we want to use this
validator
with a select list whose default option
value is something like this minus 1 0 1
you know it's not going to work in our
next video we'll discuss how to make
this custom validator reusable and
configurable on this slide right here we
have the code that we just discussed
thank you for listening and have a great
day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>