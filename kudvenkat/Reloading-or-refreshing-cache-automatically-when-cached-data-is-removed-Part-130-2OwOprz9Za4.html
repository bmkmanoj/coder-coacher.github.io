<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Reloading or refreshing cache automatically, when cached data is removed   Part 130 | Coder Coacher - Coaching Coders</title><meta content="Reloading or refreshing cache automatically, when cached data is removed   Part 130 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Reloading or refreshing cache automatically, when cached data is removed   Part 130</b></h2><h5 class="post__date">2013-02-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2OwOprz9Za4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so welcome to prism technologies I am
venket this is part 130 of asp.net video
tutorial in this video we'll discuss
about when and have to use cached and
remove the callback delegate reloading a
refreshing cache automatically when
cache to data is removed let's
understand that with an example let's
flip to visual studio so here I have
this waveform one dot aspx where I have
the screen view control and a few button
controls and a label control I also have
this country's dot XML file which has
got list of country nodes and then each
country has got ID name and continent
you know XML elements now let's say when
I click this button here load countries
and cache that's when I want to load
this XML data into this grid view
control but then I also want to cache
the data set and we have discussed about
doing that in many sessions in the
previous videos on on caching if you
haven't watched those videos I would
strongly encourage you to do so
before continuing with the session ok
and just to speed things up I have that
code already typed in so if you look at
this all we are doing here is creating
an instance of a data set object and we
are using the read XML method of the
data set to read the contents of this
XML file and then load them into this
data set which is then cache using the
cache objects insert method we also
discussed about all these parameters in
the previous sessions on caching ok and
then once we have the data set cache we
are setting the data set as the data
source for the grid we control invoke
data bind computing the number of rows
in the data set table and and then
displaying that as a message in the
label control pretty straightforward the
important thing to notice here is that
for the last parameter which is you know
cache item removed callback you know
parameter that's a delegate for this
parameter all this well we have been
passing now in this video we'll discuss
about what is this cache item remote
callback delegate all about and how to
use it ok so obviously this is a
delegate and we have discussed about
delegates extensively in c-sharp video
tutorial so if you're new to delegates I
would strongly encourage you to watch
those videos first ok so obviously we
have to pass an instance of this
delegate as an argument to this
parameter
and to do that we need to create an
instance of that delegate so let's go
ahead and do that
so cash item removed callback delegate
and I'm going to call this on cash item
remove the callback so on cash item
removed is equal to I'm going to create
a new instance of that delegate and then
look at this whenever we create an
instance of a delegate to the
constructor of that delegate we need to
pass in a function name can I pass in
any function name no you can only pass
in a function name whose signature
matches with the signature of the stela
gate okay that's why delegates are
called types a function pointers okay
now the easiest way to create a function
whose signature matches with the
signature of the delegate is you know I
can simply right-click on the delegate
go to definition so I can see the
delegate you know declaration there so
this delegate has got a void return type
and two parameters key and you know I
mean of type string and object object
and then cash item remove reason okay so
basically I can simply copy this and
then paste that in my code behind file
and then I can simply get rid of this
delegate keyword and then the semicolon
at the end so now I have a function
whose signature matches with that of the
delegate and I'm going to call this
function as you know cash item remove
the callback method so whenever a cash
item is removed you know that's when
this delegate is going to be invoked
which is pointing which will be pointing
to this function so this board function
will automatically be called whenever
the cash item is removed so to this to
the constructor of this delegate I am
going to pass in the name of this
function okay so at the moment what we
have done we have created an instance of
the delegate to the constructor we have
passed in the name of this function and
then I'm going to pass the instance of
this delegate as an argument to this
cash item removed callback parameter of
the insert method okay so we are hooked
up and we have hooked up everything
whenever this
a item is cashed you know we are also
passing that instance of the delegate
which is pointing to this function so
obviously when this data set is removed
from the cache then what's going to
happen this method will automatically be
executed that is the whole purpose of
this cache item removed callback
delegate so this this cache item removed
callback delegate can be used to you
know define a method that we want to
have executed automatically when that
cache item is removed okay so whenever
this cache item is removed it will
notify the application and then this
this delegate which is pointing to this
function will be invoked and then that
delegate in turn will invoke this
function okay so here in this function
we can do a variety of things now what I
basically want to do is whenever the
item is removed from cache you know look
at this into this function we are
getting three parameters the key of the
item which is remove its value and the
reason it is removed and keep in mind an
item may be removed from cache for three
different reasons
the cache duration has expired so it
gets removed or we can explicitly remove
that using remove method of the cache
object or the dependency of the cache
object has changed you know that's
another reason why the item could be
removed so whatever is the reason we can
we get that reason into this reason
object we also get that value if we want
and the key now let's say whenever you
know a cache item is removed I want to
store that message in another cache
variable is that possible absolutely so
let's see how to do that and again I
have this code already typed so let me
copy that and paste it in this function
so if you look at that that's
straightforward again what are we doing
we are creating a variable of type
string data to store and then this is
hard-coded string cache cache item with
key is equal to whatever is the key is
no longer present and the reason is
equal to reason dots to strings so I'm
converting this reason object into its
string representation using the tostring
method and then I'm using this message I
mean I'm basically storing that message
in another cache variable called cache
status okay so
pretty simple and straightforward
alright so when I click this button get
countries from cash what should happen I
obviously I want to get the data from
cash and then display it in the grid
view control again that's pretty
straightforward we have discussed about
this many times as well in the previous
session so I'm just going to copy and
paste that there so what are we doing we
are checking if country's data is not
null if not now do that into a data set
which is then set as the data source for
the grid view control invoke data bind
compute the number of rows in that data
set and then append that to this message
rows retrieved from cache so since we
are retrieving from cache that's what we
are displaying there if the cache data
set is not present then what are we
saying cache item with key countries
data is not present in crash so pretty
simple and straightforward there and
then what else we have so when I click
this button remove cache item I want to
explicitly remove the item from the
cache so I'm going to use the cache
objects removed method so cached or
remove and I want to remove the item
with key countries data so I'm going to
pass that to this method and that's it
that's going to remove that and then
finally I have get cache status pattern
so what is this but I'm you know when I
click this button what should happen
again we want to retrieve the status of
the cache you know so let me copy this
and paste it and then we'll go through
the code so what are we doing if in the
cache there is an item with key
countries data then we are saying cache
item with key countries data is still
present in cache for countries data is
there if not then we are checking cache
of status okay so what are we doing
cache status you know we are retrieving
the whatever message that we stored in
that variable in that cache key and then
displaying that in the label okay on the
other hand if there is nothing then
maybe I just want to say you know an
empty string so that we know what's
happening there that means both of these
are not present if else
probably I want to take this and move
into else if there get rid of this
F and then else F if both of these keys
are present is not present then I'm
simply saying an empty text okay so
pretty simple so far so let me go ahead
and run this so what did we do we just
specified you know the new thing here is
that we created an instance of cash item
removed callback delegate which is
pointing to this function and then we
passed that as a parameter to the insert
method of the cash object okay so
obviously when I click this button we
should be able to load that XML data
into the grid view control and it would
have been cached so when I say get
countries from cache look at that five
rows retrieved from cache now when I say
get cache status cache item with ki is
equal to I mean key country's data is
still present in cache and remember
we're caching that for 60 seconds using
the absolute expiration so when I say
get countries from cache so five rows
retrieved from cache so that 60 seconds
is not passed yet so when I say get
cache get cache status you know it's
still present in the cache so five rows
retrieved from cache so that products
data set is going to remain in the cache
for the next 60 seconds when that 60
seconds has expired when I click on this
get cache status you know we should get
a message whatever we are storing in
that cache status variable because
remember when when when the cache item
expires you know this delegate will be
notified which is pointing to this
function and in this function what are
we doing we are building this message
and storing it in this variable so I'm
just waiting for it to complete those 60
seconds look at that cache item with ki
is equal to country's data is no longer
present reason is equal to expired
pretty simple and straightforward on the
other hand let's load the data again
into data set so we have loaded that
five rows retreat from XML get countries
from cache so it's present in cache get
cache status cache item with key is
still present now I'm removing it
explicitly when I click this button it's
going to be removed now when I say get
cache status
look at that cache item
country's data is no longer present and
the reason is removed we have removed
that explicitly okay
on the other hand get that let me load
this again look at this now India that's
present in Asia Asia one continent okay
now when I say get countries from cash
so five rows retreat from cash now let
me change the dependency of this cash
object so that is this file now let me
change that Asia one back to Asia save
the file now as soon as the dependency
has changed it would have removed that
data set from the cash object so when I
say get cash status look at that cash
item with ki is equal to country's data
it's no longer present and the reason is
dependency changed okay
so pretty simple so whenever the cash
item is removed
you know this method is getting executed
now look at this what are we doing here
we're actually storing this message into
a cash into another cash in okey now can
I store this message into a database
table if I want to absolutely all you
need to do is instead of storing that in
a in another cash variable put some ad
or dotnet code there okay and I have
that as well so I have simple ad or net
code here let me copy that and paste it
there so if you look at this code what
it's doing it's reading the connection
string from web config file which points
to my local signal server installation
here I have this TBL audit log table
which has caught this integer ID column
this is an identity column and then an N
back care message column okay so let's
say you know whenever the cash item is
removed I want to store that message
into this database table now since we
have written that ad or dotnet code here
it's going to insert that message into
that database table let's see that in
action so let me close that and let me
run the application once again so again
you know these are a few simple lines of
ad or net code we have discussed about
ato dotnet in a great detail in a do
dotnet video tutorial so if you're new
to that I would strongly encourage you
to watch a do dotnet video tutorial so
load countries in cash it should be
present in the cache when I say remove
cash item it should have been removed
now in a do dotnet code what we are
doing we are storing the message into
the database table so if I come here and
then execute that select statement look
at that the message is stored in the
table and the reason is removed okay
so now is it possible whenever the cache
item you know has expired
is it possible to automatically reload
you know the data into cache okay
absolutely it's possible as well all you
need to do is you need to you know write
that code to recache data from the XML
file for example let's say here this
cache is dependent on this XML file
whenever somebody changes that XML file
for any reason maybe new countries are
added or there were some errors and and
the file is corrected whenever that
happens whenever the dependency has
changed I want to remove the item that
is there which will automatically be
done by this cache dependency but then
once it is removed
I want to reload this data as well the
new data into cache object okay that can
be done very easily all you need to do
is you know your you know the code to
cache the data say you know put that
code here that's it so instead of this
code I am going to copy the code to
cache the data set and put it in that
callback method so here and I'm copying
and pasting that I can even get rid of
this because I'm not going to use this
variable anywhere so if you look at that
what are we doing we're creating an
instance of the data set we are reading
that from the XML and then obviously
another instance of cache item removed
callback delegate and then we are
inserting the data set using the insert
method of the cache object okay so now
whenever the cache item is removed for
any reason it's going to reload that
immediately again because in that
callback method we have that code to do
so so let me run this now and when the
waveform loads
soloed countries and cash the cash that
get countries from cash so fighters
retreat from cash now let's say somebody
changed this china to chain r1 for
example so China's name has been named
to China 1 I save that file and look at
this when I say get countries from cash
I get that straight away I don't have to
reload it because why whenever that
dependency has changed you know
obviously the item is removed from cash
when that happens this delegate is
notified ok so that delegate is pointing
to this function cash item removed
callback function and this function what
it is doing it is reading again from
that XML file and re cashing that so we
are able to automatically reload or
refresh the cash when the cash item is
removed and whatever may be the reason
the item is removed we are able to recap
it so obvious living and how to use cash
item removed call back delegate when a
cached item is removed from cash cash
datum removed call back de lavit can be
used to specify a callback method for
notifying every application so this
callback method can be used as an
opportunity for us to decide what we
want to do when cash item is removed for
examples to the information about
removed cash item in another cash object
store information about that in a
database table or reload data into cash
and we have seen all all three things in
a demo now an item may be removed
automatically from cash when any of the
following is true the cash item has
expired the cash is full or the cash you
know there's a cash dependency and the
item that the cash object is dependent
on has changed or we can also explicitly
remove that item from cash on this slide
you can find resources for asp.net
c-sharp and sequel server interview
questions that's it for today thank you
for listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>