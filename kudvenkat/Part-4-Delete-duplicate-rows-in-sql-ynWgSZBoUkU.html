<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Part 4   Delete duplicate rows in sql | Coder Coacher - Coaching Coders</title><meta content="Part 4   Delete duplicate rows in sql - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Part 4   Delete duplicate rows in sql</b></h2><h5 class="post__date">2014-05-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ynWgSZBoUkU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part four of sequence of
interview questions and answers video
series in this video we'll discuss how
to delete all duplicate rows except one
from a sequel server table this is a
very common interview question it is the
table with duplicate data notice that
mark record is duplicated three times
Mary record two times in Bendrick or
three times now the delete query that we
are going to write should delete all the
duplicate rows except one per employee
meaning after we execute the delete
query the employees table should be left
with just three records as you can see
here let's see how to achieve this let's
flip to sequence of management studio so
I've already created this employee's
table and populated it that some test
data here is the sequel script that can
do it
I'll have the script available on my
blog in case you need it now to write
the delete query we are going to make
use of a common table expression and
let's call this common table expression
employee CTE we are going to select all
the columns from employee's table along
with all the columns we also want row
number so we are going to make use of
row number function so row number / we
want to partition we want the data to be
partitioned by this ID column and then
we also want to order the data by ID
column and then based on that generate
the row number and let's give this row
number a name let's call it row number
and let's see what we get from this ete
so let's select you know whatever this
CTE produces so let's go ahead and
execute this query look at this look at
this row number column so first of all
look at these first three records so the
data is partitioned by ID and then the
row numbers are unique within that
partition when the new partition starts
look at that the wrong number starts
from one so here we are partitioning the
data basically by the ID column and you
know within the partition the row
numbers are unique when a new partition
starts you know the note row number is
going to start from one again now using
this column we can very easily delete
all the rows except one in the delete
query we can use this rule number as the
filter so instead of selecting all the
rows from employees what we can do is
delete from employees where row number
column is greater than one okay so what
is it going to do it's going to delete
anything that has got row number greater
than one meaning it's going to leave
just one record per employee let's
actually execute this and see what
output we get so now let's go ahead and
select all the rows from employees table
look at that now the table is left with
just three records
so basically partition by is going to
divide the query result set into
partitions and here we are partitioning
the result set by ID column that's it
for today thank you for listening have a
great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>