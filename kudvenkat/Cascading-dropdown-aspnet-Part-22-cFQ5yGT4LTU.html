<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Cascading dropdown asp.net   Part 22 | Coder Coacher - Coaching Coders</title><meta content="Cascading dropdown asp.net   Part 22 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Cascading dropdown asp.net   Part 22</b></h2><h5 class="post__date">2012-11-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/cFQ5yGT4LTU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so welcome to prism technologies I am
venket this is part 22 of asp.net video
series in this session we'll learn about
cascading drop down less before
continuing with a session I strongly
recommend to watch part 16 17 and 21 of
this video series first let's try and
understand what we mean by cascading
drop down list I've developed a simple
asp.net web application here which
displays three drop down list with
continents countries and cities now the
first one displays the continents unless
and until I select a continent I cannot
select a country based on my continent
selection all the countries within that
continent will then be displayed in the
countries drop-down list okay and unless
and until I select a country I cannot
select the city so based on my country
selection then all the cities within
that country will then be displayed in
the cities drop-down list okay let's say
I select Bangalore as the Indians today
and then look at what's going to happen
when I change my continent currently the
continent selection is Asia if I change
my selection to Europe look at this the
cities drop-down list is disabled and
select City prompt is shown and select
the countries prompt is shown in the
countries drop-down list and then all
the countries within Europe continent
are then displayed here okay so this is
called as these drop-down lists are
called as cascading drop-down lists now
let's see how to achieve this obviously
these drop-down lists are getting their
data from a database tables so let's
flip to sequel server management studio
in sequel server I have already created
these sample tables TBL continents TBL
countries and TBL cities so if you look
at these tables this data is very simple
you know in the continents table I have
continent ID and continent name columns
and then in the countries table I have
the country ID and the country name and
then to associate this country to the
continent I also have a continent ID
foreign key column along the same lines
I have cities in the city stable we have
city ID and city name and country ID
column so based on the
the ID you can associate which city
belongs to which country so country ID
here is the foreign key now we have
spoken about foreign keys and primary
keys in sequel server video series so if
you haven't watched those I would
strongly encourage you to do so before
continuing with the session okay so
first let's create some stored
procedures obviously if you look at the
demo here now to display this continent
data within the continent drop-down list
I need the continent ID and the
continent name so let's create a stored
procedure which is capable of returning
all the continent IDs and the continent
names okay so again we have spoken about
how to create stored procedures in
sequel server video series if you
haven't watched them I would strongly
encourage you to do so before continuing
with the session so create procedure I
want to create this SP get continents
stored procedure as begin and so what we
want we want the continent ID and the
continent name from TBL continent stable
so continent ID and continent name
execute that the stored procedure should
get created let's test the stored
procedure highlight the name of the
stored procedure click execute button so
we get the continent ID and continent
named continent ID will be the value you
know drop down list list item object's
value whereas the continent name will be
you know the text for the list item
object as you can see here okay now for
country look at this when I select the
Asia then we will show all the countries
within that continent so obviously now
we don't want to select all the
countries we only want to select
countries belonging to a specific
continent so we need to create a stored
procedure which takes in a continent ID
parameter and based on that it has to
filter the countries that it has to
return okay
so let's create that stored procedure so
let's copy this
okay create procedure get we want to get
all the countries by continent ID okay
so let's create that continent ID
parameter and obviously it's an integer
datatype so what we want we want from
TBL countries the country ID and the
country name so country ID country name
from TBL countries where continent ID is
equal to whatever we are going to pass
in to the stored procedure so obviously
if you select asia continent then the
asia you know continent ID will be
passed in into this stored procedure
which will then return all the countries
belonging to the asian continent let's
create the stored procedure execute and
if you want to test the stored procedure
obviously the stored procedure is
expecting a parameter continent ID which
we need to pass so let's pass that let's
say i pass two and press f5 i can see
all the countries belonging to europe
continent okay the final stored
procedure that we want is we want to
select all the cities within a country
okay so obviously we need a stored
procedure which takes in the country ID
parameter and returns all the cities
within that country so let's copy this
and i'm going to call this SP gat cities
by country ID and then this is going to
take in the country ID parameter and
then we want to select from TBL city
stable and what we need we need the city
ID and the city name so city ID city
name from TBL cities where country ID is
equal to whatever parameter that we are
passing in he
it's country ID let's create the stored
procedure execute search procedure
created if you want to test this let's
say I pass in India as the country I
press f5 and you should see all the
cities within India okay so we have the
stored procedures that are required for
our application now let's drag and drop
three drop-down lists onto our web form
so if you look at this we need three
drop-down lists one to display content
and the other one countries and the
other one cities okay alright so all I
have done until now is created this Web
form and then added these three
drop-down lists and if you look at the
source all I have done now is given
those drop-down lists a meaningful name
you know DDL continents TDL countries
and DDL cities okay and then I have set
the width to 200 pixels so that all of
them will have the same size and they
look nice okay so the first thing that
we have to do as soon as the page gets
loaded what we need to do we need to
load the continents okay now since we
have three stored procedures you know we
will be calling them over and over again
you know when you select the continent
you you have to go back to the database
and then call the other stored procedure
SP get countries by continent ID and
then once you select your country you
need to call you know the city stored
procedure so there are going to be in a
lot of database calls so obviously let's
write you know a generic method which is
capable of executing these procedures so
we can reuse that okay so let's go to
the code-behind page of this web form so
i'm going to write a private method
because i intend to use this method only
within this webform so ply way and what
is this method going to do it's going to
return a data set and obviously data set
is present in system dot data namespace
so let's import that and obviously we
are making we're writing a do dotnet
code so we also need system dot data dot
c pill client again we have spoken about
a do dotnet in detail in a do dotnet
video series if you haven't watched that
i would strongly increase
you to do so before continuing with the
session and obviously we want to read
the connection string from web.config
file so system dot configuration
namespace is required okay
so private this method is going to
return a data set back and then let's
call this get data as the name of the
method and what is this method going to
do this method is going to take in a
stored procedure name and obviously
stored procedure name is of type string
so I'm going to call this string SP name
and another parameter if you look at the
stored procedures that we want to
execute there are three stored
procedures okay the first stored
procedure doesn't take any parameters
because we want all the continents but
then the country stored procedure and
the city stored procedure takes
parameter okay so obviously we also want
to pass in a parameter object to the
stored procedure so what I'm going to do
is I'm going to create another parameter
of type sequel parameter and let's call
this SP parameter okay so the first
thing that we have to do is to read the
connection string from web config file
so I already have the connection string
defined here DB CS is the name of the
connection string which we need to read
from the web config file so let's read
that and store it in this variable cs
and to read the connection string we can
make use of configuration manager dot
connection strings off what is the name
of the connection string in our case DB
CS copy that dot connection string will
return the connection string and all we
need to do now is to create the sequel
connection object so create the new
sequel connection object passing in the
connection string and create the sequel
data adapter okay so now you need to
pass in the stored procedure name that
you want to execute okay now we haven't
we don't want to hard-code
the name of the stored procedure here
because later we'll be calling this
method you know
from different places okay so let's pass
in the stored procedure name here okay
we pass in the parameter and then
obviously you need to specify the
connection object so I'm going to pass
the connection object and all we have to
do now is create to create a data set
and then fill the data set with data so
da dot fill D s the data set but there's
one more thing that we have to do here
we are going to execute a stored
procedure so we need to tell the data
adapter object that it is executing a
stored procedure so da dot select
command that command type is equal to
command type dot stored procedure and we
have spoken about all this ado.net code
within ATO dotnet video series okay
another thing that you will have to
specify if you look at the procedures
that we have some of them takes in
parameters and some of them doesn't take
parameters okay so from variable we call
this method if we don't pass in a
parameter then you can pass in null okay
when you pass in null you don't want to
add this parameter object to the stored
procedure you will understand that in a
bit when we actually call this method
that's when it makes more sense okay
but at this point what we need to do is
we need to check okay if the ESPY
parameter is not equal to null meaning
if somebody has passed a parameter
object then what we need to do we need
to associate this parameter object with
this stored procedure and how do we do
that da dot select command dot
parameters dot add method and if you
look at the add method it takes in a a
sequel parameter object do we have the
sequel parameter object
yes that's coming in as a parameter so
I'm going to pass this to this
parameters collection using the add
method that's all finally after you fill
the data set you need to return that
back to the caller whoever calls this
method because the return type of this
method
is data set okay all done we have
written a reusable you know method to
execute any kind of stored procedure
okay so the first thing that we have to
do initially when the page loads you
know we want to show the continents okay
so f naught is post back so if it is the
initial get request of the page what we
need to do we need to load the
continents data and to load the
continents data you can simply call this
method get data and then specify the
name of the stored procedure that we
want to execute what's the name of the
stored procedure SP get continents so
I'm going to pass this to this method
okay and the next thing that we want to
do is this method is also expecting a
sequel parameter object okay but then do
we need to pass any parameter to this SP
get continent stored procedure we don't
have to okay because it returns all the
continent IDs and continent names okay
so in this case I just pass now so when
you pass null what is going to happen
this block will be executed only if it
is not now in this case it is null so
it's not going to pass that I mean it's
not going to associate that parameter
object to the command because we don't
need that anyways here alright so we and
if you look at this method it's
returning the data set back and what
does the data set contains it contains
the content ID and continent name so we
want to associate that with our
continents drop-down list which is the
first one okay so the name of the
drop-down list is DDL continents dot
data source is equal to whatever data
set that gets returned and the other
thing that we have to do is called the
data bind method that's set so once we
run this application now it should
display all the continents within the
first drop-down list but there wouldn't
be anything in the second drop-down list
and the third one but then if you look
at the first drop-down list it's not
showing the actual data it's showing
system door data data view and you
should know from the previous sessions
in this video series that's because we
haven't
divide the data text field and data
value feel okay and we can do that
either in code or in the HTML source so
let's do that in the HTML source so data
text field is equal to what's the column
name continent name so I'm going to use
the continent name as the data text
field and data value field is going to
be the continent ID so copy that column
name that's it so now if we run this as
you expect it should display the
continent ID and the continent name okay
which is good but then you know it's
displaying the continent names alone
here
I want to prompt as well please sell it
or select continent you know I want that
prompt within this drop-down list but we
don't have that data within the database
table so we have to programmatically add
that to the drop-down list and we have
seen you know from the previous sessions
of this draw video series a drop-down
list is actually a collection of list
item objects so all we need to do is to
create a list item object and add it to
the drop-down list how do we do that so
list item Li is equal to new list item
let's give this a meaningful name Li
continent okay and if you look at the
constructor of the list item class it
takes in two parameters the text and the
value the text is going to be select
continent and then the value is going to
be minus one okay and what we need to do
we need to add this to the continent
drop-down list and how do I do that
there are two ways you can use the add
method but then when you add it using
the add method this list item will be
appended to the end of the drop-down
list but we don't want that we want that
to be present on the top so I'm going to
use the insert method of the items
collection so drop-down list
DDL continents draw-tite um's dot insert
and you can specify the index where you
want to insert since I want to insert it
at the top of the drop down list I use
zero and then the next parameter is the
list item object itself that's it and
another thing that we have to do is we
also have to specify this you know
select country within the second
drop-down list and select City for the
third drop-down list so you can simply
copy paste this code and change it as
required okay
so this is going to be Li country and
the problem that we want is instead of
select continent it going to be select
country and then we will add that to the
countries drop-down list so DDL
countries and this is going to be Ally
city and here we will say select city
Ally City and it's going to be DDL City
drop-down list okay that's it so with
that if we go ahead and run our
application now it should display all
the continents show that prompt select
continents select country and select
city ok but then another thing that we
have to do is this drop-down list you
know the country and city drop-down list
should be disabled until I make a
selection of the continent but now these
are enabled okay I don't want that to
happen so I want these to be disabled on
the initial page load how do we do that
all you have to do is set the enabled
property to false so ddr countries dot
enable is equal to false and we do the
same thing for the cities drop-down list
that's it so once we run this now you
know on the initial page load the
continents will be displayed but the
seat country and city drop-down list you
know are disabled upon selecting my
continent what should happen the page
should refresh and the country drop-down
list should be enable and all the
countries belonging to the selected
continent should be displayed in the
country drop-down list so let's see how
to do that first of all you should
enable the countries drop-down list and
when should you do that whenever the
selection in the drop-down list changes
okay and we know that drop-down list
exposes an event called selected index
changed okay so let's go to the visual
studio flip to the design mode
so whenever the selection in the
drop-down list changes double click that
the selected index a changed event
handler will be generated so the first
thing we want to do is whenever the
selection changes but then that
selection has to be you know you have to
select a continent
so if DDL continents dot selected index
is equal to zero if the selected index
is zero then you don't want to enable
you know the continents drop-down list
you want to enable them only if the
selected index is not equal to zero okay
we'll come back to this bit this if
condition in a bit but first let's write
the else part so what do we want to do
we want to first enable the countries
drop-down list so DDL countries dot
enable is equal to true so that will
enable the countries drop-down list what
we need to do next we need to load all
the countries belonging to the selected
continent we know that if the selected
index is not equal to zero it will come
to the else part which means the user
has actually selected a continent ok so
now we need to pass that selected
continent ID to the database stored
procedure and then retrieve all the
countries belonging to that continent
and we already have a reusable method
which we can use to call the stored
procedure so I'm going to call this get
data stored procedure so get data and we
need to pass this a stored procedure
name what is the stored procedure we
want to call SP get countries by
continent ID so that's the name of the
stored procedure and then if you look at
this this method actually expects a
sequel parameter object and what is that
continent ID and we know you know when
we actually run this when you select
your continent what's going to happen
the selected continent ID is going to
come from this first continent drop-down
list so we need to first harvest it from
there so let's create the sequel
parameter objects equal parameter let's
call this parameter is equal to new
sequel parameter and if you look at the
constructor of this one the sequel
parameter class it takes in two
parameters the parameter name and the
value of the parameter okay so the
parameter name for this stored procedure
is at continent ID so I'm going to pass
that and the second thing that you have
to specify is the value so where is the
value coming from the value is coming
from the continents drop-down list okay
so how do I get that DDL continents dot
selected value that's all so we have
this equal parameter object now all you
have to do is pass in the parameter
object to this method and we know this
method is returning a data set so let's
create a data set D s is equal to
whatever this method returns and all you
need to do now is to set this data set
as the data source for your countries
drop-down list so DDL countries dot data
source is equal to data set and finally
you need to call the data bind method
and one last thing that you have to do
is to specify the data text field and
the data value field for this country's
drop-down list and we can do that in the
HTML so let's do that there so this is
the country's drop-down list so data
text field so what's our data text will
going to be that's going to be the
country name and data value field is
going to be the country ID perfect so
now if we run this as you might expect
it should disable all the continents and
then the initially the countries and
cities drop-down list will be disabled
upon selecting my continent the
countries drop-down list should be
enabled but then look at this nothing is
happening okay why is that because by
default the selected index change the
event of the drop-down list is cached
event it's not opposed to a key event
okay so we need to convert the cached
event of the drop-down list to a
postback event by setting the auto post
back property to true and how do we do
that set the auto post back property to
true so now whenever the selection in
the drop-down list changes it will
automatically post back to the server so
I select my continent look at that the
countries drop-down list got enabled and
it added all the countries but the
problem here is you lost that prompt so
let's go ahead and add that select
country prompt and when do we do that
within the drop-down list selected index
change so all you have to do is copy
that piece of code and then paste it
within the selected and exchanged event
I said so now when we run this as you
might expect it should show they you
know select country as well within the
selection of the drop
so I change the continent to Asia you'll
see all the Asian countries and then
select country okay and similarly if I
change my continent to South America
then you should see all the countries
within South America okay cool
now the next thing that we want to do is
whenever I change my selection to select
continent what should happen okay look
at this we'll come back to that piece
later but as soon as I select my country
let's say I select Asia as the continent
I select India as the country what
should happen the cities drop-down list
should be populated so obviously we do
that in the selected index change the
event of the countries drop-down list so
let's do that now so I go to the
countries drop-down list double click
that the event handler gets generated
all you have to do is copy this code and
change it it's going to be pretty much
similar and all you have to do is just
change some object names here okay so if
the countries selected index so if the
country selected index is 0 that means
he has not selected anything we'll come
back to that part later but if it is not
equal to 0 that means he has selected a
country in which case we want to load
all the cities ok so which means you
need to enable the cities drop down list
so I'm going to say DDL cities that
enable is equal to true and then we need
to create the sequel parameter to call
the cities stored procedure as we get
cities by country ID so obviously the
name of the Stute parameter is at
country ID so instead of continent ID it
will be country ID and then instead of
continents selected value it will be
countries selected value all right and
the procedure that we want to call is sp
get cities by country ID and we pass in
that parameter there so obviously this
will return a data set and we want to
set that as the data source for our
cities drop-down list
okay and then the final thing that you
have to do is to specify the data text
field and data value field for the city
is drop-down list so let's specify that
so data text field
what's our data text field city name and
data value field is going to be the CT
ID so let's copy that and one last thing
you have to do is you want to set the
auto post back property of the country's
drop-down list to true otherwise it will
not post back upon selection change
within the country's drop-down list so
set the auto post back property of the
country's drop-down list to true okay so
let's go back to the webform see if we
have missed anything yep
and the last thing that we have to do we
have to add that select City prompt and
then we need to add that to the city's
drop-down list and give this a
meaningful name it's going to be Li city
that's it so let's run this now as you
might expect everything should be
functional now the can continents
countries and cities so I select a
continent Asia and I select India as the
country and I see all the countries all
the cities within Indian country India
within Indian country yep okay but then
the problem here is look at this I
select Bangalore and then when I go back
to the first drop-down list and then
change my continent to Europe let's say
look at that the countries gets
refreshed and all the countries are
shown but then look at the cities drop
down list okay it is still showing
Bangalore that's incorrect
we want you know this drop down list to
be automatically defaulting to select
city and then it should be disabled
until I select my country so how do I do
that I have to do that on the selected
index change the event of you know the
continents dropdownlist okay there are
two things to do obviously the data is
getting loaded as expected but the
problem is with the city's drop-down
list you need to you know set if
whatever may be the initial selection
they made you need to reset the
selection to the first item and then you
need to disable the city's drop-down
list how do we do that so obviously we
do that within the selected index
changed event of the continents
drop-down list okay so whenever the
selection here changes I want to say the
selected index of cities is equal is
going to be zero which means the first
item and then we want to disable the
city's drop-down list okay so let's run
this and see if that is working as
expected okay so I select the continent
Asia set the country as India select the
city within India now I go here and
change Europe as my continent look at
what's going to happen the city's
drop-down list is disabled as expected
and countries you know select country
and all the countries within the
European okay so this is X you know
working as expected now I select the
United Kingdom and I see all the cities
within the United Kingdom okay but on
the other hand now when I change it to
South America you know it's working as
expected again when I flip to select
continent look at that when I flip to
select continent what should happen now
select country should be disabled if you
don't select a continent this should be
disabled until you select a continent so
when do we do that so if the selected
index of the continent is zero which
means he hasn't made a selection there
then in that case we want to disable the
countries drop-down list
so we want to say that two Falls and we
also want to set the selected index to
zero which means the first item default
to the first item okay so now let's run
this and see if it works as expected
okay I select the continent Europe I
select some country and then when I
change my selection look at that
it's only disabling this one but it's
not disabling the cities so we need to
disable this drop down list and the
default the selection to the first item
and how do we do that you do it here
exact same code but you change the ID of
the drop down list here
it's going to be DDO cities so now when
we run this it should work as expected
okay so I select continent as Asia
select can happen as the country
Hiroshima as the city now if I say
select continent you know look at that
they get disabled and then work as
expected okay now I make a selection now
look at this and I say select country
the cities drop-down list you know
should be disabled and the selection
should be defaulted to the first one for
the cities drop-down list so let's see
how to do that and obviously we have to
do that in the selected and exchange
event of the cities drop down the
country's drop down list so if the
selected index is zero that means you
haven't made a selection in which case
we want to set the item selected item to
the first one and I do that using
selected index and we want to disable
the selection and you set the enabled
property of cities drop-down list to
false so obviously when we run this now
it should be fully working
as expected so I select a continent I
select the country and I come to the
city I select city and then when I go
back and selects a country look at that
this gets disabled along the same lines
if I say select continent this gets
disabled so unless and until you select
a continent you cannot select the
country unless until you select the
country you cannot select the CP okay I
set my city and then when I change my
selection of select continent to select
continent look at that okay so now these
are the cascading drop-down lists now if
you look at this code within the code
behind file there's a lot of code now if
you actually carefully spend some time
you can drastically reduce this code by
refactoring it okay wherever you have
copy pasted those code anytime your copy
pasting more than three lines of code
then it should drink the bell you should
know that you know you should be
refactoring that put that common code in
one place and then whatever is varying
past them in as parameters so that you
can reduce the amount of code that we
have that we have to write and what are
the advantages of having reduced code
number one maintenance will be much
easier and you have less code to unit
test later so obviously you know you can
maintenance become easier less number of
bugs etc it saves a lot of time and
effort on this slide you can find
resources for asp.net c-sharp and sequel
server interview questions that's it for
today thank you for listening
have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>