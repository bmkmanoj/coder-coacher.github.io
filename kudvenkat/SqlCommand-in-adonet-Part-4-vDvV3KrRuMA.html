<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>SqlCommand in ado.net - Part 4 | Coder Coacher - Coaching Coders</title><meta content="SqlCommand in ado.net - Part 4 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>SqlCommand in ado.net - Part 4</b></h2><h5 class="post__date">2012-10-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/vDvV3KrRuMA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello welcome to prism technologies I am
venket this is part 4 of Radio dotnet
video series in this session we'll learn
about the purpose of sequel command
object creating an instance of the
sequel command class when and how to use
execute reader execute scalar and
execute non query methods of the sequel
command object before continuing with
the session I strongly recommend to
watch part 1 and 2 of this video series
so what's the sequel command class
sequel commands class is used to prepare
an SQL statement or a stood procedure
that we want to execute on a sequel
server database in this session we'll
see how to use the sequel command class
to prepare an SQL statement and execute
that on a database in a later video
session we'll see how to actually
execute stored procedures using sequel
command class now as far as the sequel
command class is concerned there are
three methods that are very commonly
used execute read or execute non query
and execute scalar methods so when do we
use them execute leader is usually used
whenever the T sequel statement that we
are trying to execute in the database if
it returns more than you know a single
value then we use execute reader okay if
we want to perform an insert update or
delete then we use execute non query
whereas if the query returns a single
value that means a scalar value then we
use execute scalar for example you know
if the query returns the total number of
rows in a table then we can use execute
scalar or if we are trying to compute
the average salary of an employee you
know still that is a single value so
whenever the query returns a single
value then we use execute scalar method
let's look at an example of using each
one of these methods let's flip to
visual studio okay so I have a webform
here I have just a dragged and dropped
the gridview control on to the webform
and now let's flip to the code behind so
what we want to do is basically I have a
sequel server database which has got
this you know the name of the databases
sample and within that database I have
TBL product table which has got this
data product ID name unit present
quantity available I want to display all
this data in the grid view control
on this webform so obviously to do that
in a previous session we have already
learned about using the sequel
connection object so in the web.config
you if you look at this I have the
connection string so this is the name of
the connection string the connection
string itself and the provider is
systems or data or sequel client okay so
we need to you know read that connection
string and then create the connection
object so obviously to read from the
web.config we have to use system
configuration namespace and if we want
to use sequel connection sequel command
objects then we have to use the system
dot data dot sequel client which is
nothing but the dotnet data provider for
sequel server
so first let's read the connection
string and obviously to do that let's
declare a variable so we have a class
called configuration manager connection
strings property and then specify the
name of the connection string which in
our case is DB CS so let's copy this now
we have spoken about you know how to use
this connection object connection
manager etc in our previous video
sessions so if you're new to that please
check the parts 1 2 &amp;amp; 3 of this video
series so we get the connection string
and then we need to create the sequel
connection object so let's say signal
connection Korn is equal to new sequel
connection and to the constructor we can
pass the connection string which will
create the connection for us okay and
the good practice is basically to use
using statement so that the connection
will be automatically closed for us we
don't have to close the connection okay
so now we have to prepare our command
object so obviously to prepare the
command we use the sequel command at
class sequel command CMD is equal to new
sequel command and if you look at the
you know constructor of sequel command
we have four versions of sequel command
constructor it's basically overloaded
okay now we are going to use a
constructor which is taking two
parameters the command text which is of
string type and the sequel connection
object we have already created the
sequel connection object so we'll be
passing in that
so we first need to prepare the command
text so the command that we want to
execute is this one select these four
columns from this TBL product table so
let's copy that and it's a string if you
look at that the command text is a
string so you can look at that in the
intellisense
so copy/paste that there and then if you
look at the next parameter that we want
to pass is the sequal connection object
and we already have one here so let's
pass that okay so if you look at our
command object now this command object
you know whenever this query gets
executed on the sequel server database
what are we getting back we are getting
multiple Druce of data back so whenever
we get multiple rows of data back we use
the execute reader method to execute
that command on the sequel server so
obviously we want to execute that
command and to execute that command we
use command dot execute reader and if
you look at this execute reader method
look at the intellisense what is the
return type sequel data reader okay it's
going to return a data reader back okay
what is the sequel data reader don't
worry about that we are going to talk
about that in a later session so I will
have to store that data in a sequel data
reader or you can directly bind that to
a grid view control if you want so let
me bind the directly to a grid view
control so grid view one dot datasource
is equal to that one whatever this
command returns this method returns I'm
going to bind that directly to the
screen view control so call the data
bind method that's it but then before we
actually execute the command we need to
open the connection so let's open the
connection okay so obviously if we run
this now we should see data in that grid
view control loading up so let's
actually close this lesson on this once
again so now what should happen this
command should get executed on this
equals server database and then execute
that command whatever result that is
returned by this method execution it's
going to set that as data source for the
grid view control and calling the data
bind and
we see the results here okay now if you
look at this you know it's pretty simple
creating the command object we are using
a constructor which is taking two
parameters okay
so when we do this we are creating the
command object in one line but you might
see you know and some of the programmers
doing that in different lines for
example they just use a default you know
the parameterless constructor and then
they use the command text property to
set the comment look at that the command
text property the data type is string so
I can just pass in the command name I
mean the command that I want to execute
and you can also set the connection
using the connection property so if you
look at that there is a connection
property so we can specify the
connection that you know that we want to
set which is nothing but this one so
here we are actually creating the
command object in three separate lines
so obviously let's copy that query here
and paste it so now if we run this the
behavior is exactly same except that we
have created the command object in three
different lines rather than you know
using the constructor which takes the
two parameters here we using the you
know the parameter less constructor okay
so we have seen when to use the execute
reader meta now let's look at when to
use execute scalar method and finally
we'll talk about execute non query so
execute scalar use this when the query
returns a single value okay now let's
say you know I have a query like this
select count off product ID so what is
this going to return this query is going
to return the total number of rows in
this particular table let's say I want
to retrieve this now if if if I execute
this query I am just getting a single
value a scalar value so if I want to
execute a query like this then I use
execute scalar now you might be thinking
can I use execute reader we can use but
it's not efficient you know if you just
want a single value there is no point in
returning a reader object back okay we
just want that single value so that's
why we use execute scalar so let's go
ahead and copy this command
so I'm going to copy that let's flip
back to visual studio now the command
that I want to execute is this one
select count of Product ID and we know
that this is going to return a single
value so instead of saying we can
actually get rid of that grid view
control now so let's go ahead and delete
that from the UI as well because we are
going to get a single value back we
don't need a grid view to display that
okay so this is the command now when I
say command a dot execute non query look
at that what is the return type of
execute non query the return type is its
non non query execute scalar because we
are getting a single value back so
execute scalar now if you look at this
execute scalar method what is the return
type it's the object data type okay and
if you look at the query what are we
actually getting back we are actually
getting an integer back okay but the
return type of this method is object
okay now we know that system that object
is they you know base type for every
type in dotnet so obviously you can
convert that object to an integer type
okay because the reason why they have
marked the return type of this execute
scalar as object because you know if I
select the name of the employee who has
the highest salary then it's going to be
a string or I can select the date of
birth of a person who has the highest
salary in which case it returns a date
time so we don't know that what what is
the data type of that single value that
gets returned is going to be that's why
you know it's object datatype depending
on what you are expecting back from that
query you you as a developer has to
convert it to the appropriate type and
use it accordingly okay so since now we
are expecting an integer data type I'm
going to typecast that to be of type
integer so int let's say total rose is
equal to that one but then since this
one returns an object type I have to
typecast that to integer so I get that
there now all we do is write that onto
the response stream so response
right total rows is equal to plus we
have the variable which receives the
total rows so convert that to string and
display that so now when we execute this
it should return those two rows and
print that message total rows is equal
to three on the web form all right so
anytime you want to retrieve a single
value use execute scalar which is much
better than using execute reader all
right so when do we use execute non
query whenever your query performs an
insert update or delete operation so you
are actually inserting updating or
deleting then use execute non query all
right so let's see how to do that
so if I want to insert obviously insert
rows into this table if you look at the
columns that we have now we have so many
columns so we have to provide the value
so let's first write the query so insert
into TBL product table values so if you
look at TBL product and if you look at
the ID column you know this is not an
identity column so we need to supply a
value for that so let's apply a value
primary key is for name of the products
let's say calculators and maybe the unit
price is 100 and quantities of 230
quantity available so obviously we want
to execute this query so let's copy that
so my command that I want to execute is
this one and then this is the connection
on which I want to execute this command
open the connection and instead of using
execute scalar I will use execute non
query because this is an insert
operation so execute non query now if
you look at execute non query
intellisense you know look at the return
type it's an integer so why is execute
non query returning an integer basically
when we perform an insert update or
delete okay the database is going to
tell us how
many rules have you inserted or how many
rules have you updated at all how many
rows have you deleted so that number is
going to come back okay so you can
actually that's why the return type of
this execute query is integer so you can
capture that so I'm and we can get rid
of this interconversion because it's
already an integer so I'm going to store
that here let's say total rows affected
because how many rows did we insert that
let's give a meaningful name so total
rows affected is that one and I'm going
to print that here that's it so we can
say total rows inserted is equal to
whatever we have inserted now let's run
this as soon as we run this if you look
at this now this table has got three
records when we when we execute this
query using the application it should
insert a fourth record into the table so
let's run that
so total rows inserted is equal to one
so now if we come back and execute this
query we should see that okay all right
so now how do I update it it's pretty
simple all you have to do is specify
what's your update statement let's say I
want to update you know the desktops
quantity available to 200 so how do we
do that
the first let's write the query update
TBL product set quantity available is
equal to 200 where product ID is equal
to 2 so we want to update the desktops
quantity from 2 to 200 from 20 to 200 so
let's copy that now what I'm going to do
is I'm going to reuse this command
object and to do that all you have to do
is change the command text so command
dot command text is equal to that's the
command let's copy that here
and all you have to do now is execute
the command so command dot execute non
query and we don't have to read Eclair
this because the variable is already
declared so now you can just output the
message saying total rows updated okay
now if we run this as it is we are going
to get error because we already have a
product row with ID is equal to four so
first we need to delete that otherwise
they are going to get that error or what
we will do is will read the query for
delete as well
so let's delete the record so did they
lead the record we can use delete from
TBL product where product ID is equal to
let's delete the product with ID is
equal to four okay so that's the command
text so before we copy/paste that let's
copy and paste these lines so the
command text is that one there
okay so let's copy the delete from TBL
product table and pass it in here so all
we are doing is delete from TBL product
where product ID is equal to four and
then you know execute non query because
that's a delete query and then we get
the total rows deleted and we are saying
total rows deleted is equal to whatever
and for us to have the output on
separate lines include the HTML break
element otherwise all three lines are
going to come next to each other and the
output will not be good to look at so
wherever we have that response right
just put that there okay so now if we
run this what's going to happen if you
look at the rules that we have here
there are four rows so when we execute
this application what should happen it
should first it will delete a product
with ID is equal to four it's going to
insert that product again with ID is
equal to four so by the time we run this
the product with ID is equal to four
should be there and then there's one
query which is updating the quantity to
200 for product with ID is equal to two
so currently the product with ID is
equal to two is twenty okay and we are
outputting messages total rows deleted
total rows inserted and total rows
updated everything should be one okay so
let's run this so what should happen we
should get that message total rows
deleted total rows inserted and updated
and if we go back and check the results
in the table you know it's updated to
200 and this calculator should be there
okay so we have seen how to use execute
non query as well on this light you can
find resources for asp.net c-sharp and
sequel server interview questions that's
it for today thank you for listening
have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>