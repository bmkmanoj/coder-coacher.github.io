<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GridView insert update delete in asp.net using objectdatasource - Part 24 | Coder Coacher - Coaching Coders</title><meta content="GridView insert update delete in asp.net using objectdatasource - Part 24 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>GridView insert update delete in asp.net using objectdatasource - Part 24</b></h2><h5 class="post__date">2013-03-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ZUCsHxBEPeg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so welcome to prism technologies I am
venket this is part 24 of asp.net
grid-view tutorial in this video we'll
discuss about inserting updating and
deleting data from grid view using
object data source control in part 23 of
the asp.net grid view tutorial we
discussed about achieving exactly the
same thing using sequel data source
control in this video we will be using
object data source control to do the
same thing now we will actually be
modifying the example that we discussed
in part 23 so I strongly recommend to
watch part 23 of the asp.net grid-view
tutorial before proceeding with this
video so let's flip to visual studio so
instead of using sequel data source
control we want to use object data
source control so since we want to use
object data source control to perform
insert update and delete on the screed
view control we need to have employee
data access layer which is going to
contain those methods basically to
select edit delete and insert data okay
so first let's go ahead and build
employee data access layer and to do
that right click on your project add a
class file and let's name the class file
as employee data access layer dot CS
okay so that should add employee access
data
I mean employee data access layer last
now basically to encapsulate this
employee related information that's
present in this TBL employee table we
need employee class so let's go ahead
and create employee class so I'm going
to call this public class employee and
obviously we need to have you know
properties to represent these columns
that we have in this table employee ID
name gender and city and to speed things
up I have that already typed so let me
copy that and paste it in our employee
data access layer class so all of these
are Auto implemented properties alright
so we have you know our employee object
now defined so obviously the first thing
that we need to do is since we want to
retrieve and display data within the
grid view control we need a select
method which is going to return all the
employees that are present in this table
and to speed things up again I have this
type so let me copy the
and paste it within our employee data
access layer class so this is actually a
static method now we have some
compliation errors here that's because
these are ad or dotnet classes so we
need to import ATO dotnet namespaces
which our system door data system door
data the client and system configuration
so let's paste them within our employee
data access layer class file and that
should get rid of those compliation
errors all right so if you look at this
you know get all all employees method
it's a pretty simple and straightforward
method all this code is simple ad or
dotnet code okay so if you're new to a
do dotnet we have discussed about you
know a do dotnet in detail in a do
dotnet tutorial so I strongly recommend
to watch those video so basically what
we are doing here we are creating a list
of employee object and then obviously we
are using configuration manager class to
read the connection string from web
config file and then we are using that
connection string to build the sequel
connection object and then look at our
sequel command we are simply saying
select star from TBL employee so
retrieve all the records from TBL
employee table and then once we execute
that query so we are looping through
each record that we get back and then we
are creating an employee object and then
populating that employee object you know
the employee ID name gender and city and
then adding that employee object to that
list and once we have finished looking
through each row finally we are
returning that list so that's our select
method you know which is going to return
the employees so obviously along with
the select method we also need you know
since we want to perform insert update
and delete as far we need methods to do
that as far okay so I have those methods
as well here so let me copy those
methods and then we'll go over them
quickly alright so if you look at these
methods you know these are simple and
straightforward method so obviously this
is delete employee method so if we want
to delete an employee record we need the
primary key you know the employee ID so
this method is actually taking in
employee ID as the parameter and using
that we have written some it you know
the similar ad or dotnet code and look
at the query delete from TBL employ
we're employee ID is equal to F employee
ID obviously that's a parametrized query
and to the sequel parameter we need to
supply a value and that value is coming
in to this method as another parameter
okay so that's the lead employee and
along the same lines we have update
employee so when we click Edit and then
when we update we are going to update
name gender and city and obviously we
base you know we we update that row
based on the primary key value so we
need primary key as well so all the four
parameters the update method needs to
help or have all those four parameters
and that's what we have here and again
this is simple ad or dotnet code okay so
look at the update statement here update
TBL employee set name is equal to F name
gender is equal to ed gender and city is
equal to add city where employee ID is
equal to at employee ID so again a
parametrized update query and to these
sequel parameters within that update
query we need to pass values again which
are coming into this method as
parameters so all these lines are
actually you know sociated those
parameters to this command object and
finally we are executing the query know
simple area dotnet code again and
finally insert employee method now look
at this oh one of the YouTube
subscribers asked me you know when he
tries to insert a row by providing name
gender and city he is getting a runtime
error you know asking that it requires a
value for employee ID that may be
because in your table TBL employee table
this employee ID might not be an
identity column usually in reality you
know when we add rows to a table you
know the primary column is
auto-generated okay and it gets
auto-generated only if you if you you
know set that as an identity column we
discussed about that in sequence of a
video tutorial so please watch that
video so if this column is not an
identity column on this table then you
will have to supply a value for that
column as well but since on my table
it's an identity column I don't have to
supply you know a value for employee ID
column it's auto-generated when we try
to insert a row into this table so
that's the reason why I am supplying
only name
gender and city okay so that's the
reason if you look at this insert
employee method I only have three
parameters and look at our insert
parametrized query insert into TBL
employee and we want to supply values
for name gender and city which are
coming in as parameters into this method
and again we are associating those
parameters to the command object and
executing that command so pretty simple
and straightforward if you look at this
employee data access layer class it
contains four static methods you know
the first method returns employees
that's for select and this one for
delete this one for update and the final
one for insert okay so that's it we are
done so let's build up a project now so
this should have compiled these you know
this employee class employee data access
layer and employee classes but let's go
back to our waveform now I'm not going
to change the HTML of the grid view
control or this validation summary
controls all I'm going to do is get rid
of the sequel data source control now if
I flip this form to the you know source
mode look at this I'm going to get rid
of this sequel data source control and
instead of that I'm going to use object
data source control but before that if
you recollect from part 23 in webform
one dot aspx okay this the sequel
datasource one control is referred in
this you know link button insert click
so obviously if we delete this sequel
datasource one control from this webform
we are going to get a compile asian
error that's fine so if i build this now
look at this I already have a red
squiggly line that indicating that the
sequel datasource one control doesn't
exist but for now I'm going to comment
these lines so let's comment them ctrl K
and ctrl C to comment you know the lines
using keyboard alright so I have got rid
of that signal datasource control now I
want to use object data source control
instead of sequel data source control so
I'm going to go to the data tab and
retrieve object at a source control and
obviously we need to configure this so
choose your business object it's going
to be demo dot employee data access
layer so I'm going to select that click
Next and look at this this is the very
important screen where we select our
respective method
so to select data which method we want
to use get all employees to update data
we have update employee method and to
insert we have insert employee method
and finally select your delete method
that's it so let's finish that and now
if I flip this to the source mode notice
that I have now objected our source
control and obviously you know your
delete method insert method select
method and update method all are
specified and look at this pipe name is
your employee data access layer which is
present in demo dot I mean demo
namespace okay if you look at the delete
parameters employee ID insert parameters
name gender and city we don't have to
supply a value for employee ID column
update parameters we need all the for
you know parameters basically okay so
that's the second change that we have to
do first we added employee data access
layer class then we replace the sequel
data source control with object data
source control now the most important
thing is to associate this object data
source control with the grid view
control so how are they associated using
a property called data source ID so
instead of sequel data source one I want
to use object data source one you can
change it directly within the HTML here
or you can use the designer you know
whatever is convenient so if I come here
and then if I say object data source one
look at this I get a warning so this is
very important again it's asking you do
you want to refresh fields and keys for
grid v1 control I would say no because I
want to retain you know those things as
it is all I'm changing its object
instead of signal data source one I'm
using object data source one okay all
right let's save that and and another
thing that we have to correct is the
code in this you know link button insert
click let's uncomment that and instead
of opt you know sequel datasource one we
actually want to use object datasource
one so that's the ID so let's go back to
webform one dot aspx
that's it we are done so now instead of
using sequel data source control we're
actually using object data source
control let me run this now and
everything should work as expected
you know the behavior should be exactly
the same so I click Edit I change Mary
to MIDI one from female to male and
maybe from New York to NY and then let's
say blob update that look at that it
works as expected
on the other hand if I try to blank that
and then I click update look at that I
get validation message as expected and
then if I don't supply anything and then
if I try to insert look at that I get
those validations again okay I can
cancel this I try to insert validation
errors let's say test
let's select gender and maybe test as
the city that since of that look at that
that row gets inserted let's try to
delete that row and look at that
everything everything is working exactly
in the same fashion except that now
instead of using Sigma datasource
control we are actually using object
data source control on this slide you
can find resources for a speed or Nessie
shell pants equal to interview questions
that's it for today thank you for
listening
have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>