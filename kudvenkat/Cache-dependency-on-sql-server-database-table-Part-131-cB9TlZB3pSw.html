<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Cache dependency on sql server database table   Part 131 | Coder Coacher - Coaching Coders</title><meta content="Cache dependency on sql server database table   Part 131 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Cache dependency on sql server database table   Part 131</b></h2><h5 class="post__date">2013-02-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/cB9TlZB3pSw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello welcome to prism technologies I am
venket this is part 1 3 1 of asp.net
video tutorial in this video we'll
discuss about cash dependency on sequel
server database table let's understand
that with an example let's flip to
sequel server management studio I have
this table TBL products here which has
got some sample data I want to display
this data in my asp.net web application
in this grid view control and that
should happen when I click this button
get data so here I have straightforward
ad or dotnet code the first line here
actually reads the connection strength
from web config file which is point into
sequel server that's installed on my
local machine and then we are creating
signal connection object using that
connection string and then preparing
sequel data adapter object look at the
command here
we are retrieving all the products from
TBL products table and then we are
creating an instance of the data set
object filling that data set with the
data that we get after we execute this
command ok at this point we have this
data set which we are then caching using
the cache objects insert method and then
we are setting the data set as the data
source for the grid view control calling
data bind method and finally we are
displaying this message you know data
retrieved from database at the date and
time at which we have done that in this
label control so pretty straightforward
code but then if you look at this code
as it stands now every time we click
this button it's going to connect to the
database execute that command retrieve
the data cache it and then set that as
data source in work data bind we don't
want that to be happening if the data
set is there already in cache we want to
retrieve the data from cache rather than
going and executing the commands against
database ok and just to speed things up
I have that coded all ready so let me
copy and paste that here so if you look
at this code what we are doing we are
checking ok in cache do we have products
data if that's the case go ahead and
retrieve it from cache said that has
data source for the grid we control
invoke data bind and then display a
message in the label stating that data
is retrieved from cache and the date and
time at which we have done that let's go
ahead and close the cells block now ok
so we are basically retrieving this data
from TBL products table and caching that
within an ASP
web application but remember what I want
to do is once we have cashed that you
know any time if anybody changes this
data if if this data changes for any
reason then I want the data to be
removed from cache immediately is that
possible absolutely and there are three
simple steps to achieve that okay
so what's step one step one an able
change notifications on the database so
what do we mean by enabling change
notifications now look at this at the
moment we have you know executed this
command retrieve the data and cache that
that's fine
but then when the data changes sequel
server should notify asp.net web
application about the change so that the
asp.net web application can remove that
data from cache okay so to notify those
change notifications we should enable
that on the sequel server database and
then on that table as well so here the
database is sample database and the
table is TBL products so we should
enable change notifications on this
database sample and table TBL products
and there are two ways to do that we can
either do that programmatically in code
using sequel cache dependency admin
class which has got this enable
notifications static method and to
enable table for notifications we have
you know a corresponding static method
okay so we can either do that
programmatically in code using this
secret cache dependency admin class okay
or we can also use this command line
tool a spinet underscore register sequel
dot exe and obviously since this is a
command line tool we can run that in
visual studio command prompt so to open
visual script command prompt click on
start go to all programs Microsoft
Visual Studio 2010 Visual Studio Tools
and then within that you should see
visual studio command prompt 2010 so
once we have that command prompt opened
then you need to execute these commands
that you can see here there are two
commands the first command here is like
this asp net underscore register sequel
so let me paste it there so a spinet
underscore register sequel and then
there are some switches here - e
d means enable database up for you know
change notification basically if you
want to understand what those switches
mean you can use you know forward slash
question mark option and then it will
show you all the help there ok so here
you can basically see
- Edie means enable a database for
sequel cache dependency ok that's what
this option means and then there is
something called a - e what does that
mean that means since we are making a
change to sequel server database you
know you need to obviously authenticate
yourself when I specify - E I'm saying
use my windows authentication on the
other hand if you don't have a windows
authentication and you want to use your
explicit username and password you can
do that using - you and - P - new for
username and then specify your login and
then - P for your password and then
specify your password so you can either
you know authenticate yourself using
sequence of authentication or windows
authentication so if you want to
authenticate yourself with Windows
credentials you use - e just like how I
have done that and - d stands for the
name of the database so in my case the
database name is going to be sample so
I'm going to copy this command and then
paste it in this tool a spinet under
school registers equal and then + enter
so enabling the database for sequel
cache dependency and it says finished ok
so we have just enabled the entire
database but then in that database I
have a table called TBL products on
which I have to enable that so I'm going
to copy another command and then paste
that here now it's pretty much similar
to the previous command except that we
also have a table name specified with -
T option so I press Enter enabling the
table for sequel cache dependency and it
says finished so we are done so first
step is enabling change notifications on
the database and remember there are two
ways to do that you can either do that
programmatically in code using sequel
cache dependency admin class or you can
use a spinet underscore registers equal
dot exe - all right what's the second
step we need to build sequel cache
dependency object okay and that
straightforward to do all you need to do
is create an instance of this class
sequel
kache dependency so I'm going to do that
here and obviously when we create an
instance of this class so sequel cache
dependency let's call that sequel
dependency is equal to new sequel cache
dependency and look at the constructor
you can specify the database name and
the table name
so here the database is sample and the
table is a TBL product so that's what
I'm going to specify here so sample is
the device and the table is TBL products
okay so we have the sequel cache
dependency object now I can use this
overloaded version if I want but I can
use another simpler overloaded version
which takes just three parameters of the
cache key and the data that I want to
cache and the cache dependency object
look at this here
the object is cache dependency but my
object that I am passing into this
method as a parameter is sequel cache
dependency object is it possible to be
done absolutely that's because if you
look at sequel cache dependency that
actually inherits from cache dependency
class so you can pass it as an inherited
type so I'm going to pass the sequel
dependency object so that's the second
step okay prepare your sequel cache
dependency object and then pass it to
the insert method when your caching the
data so that the cached data knows there
is a sequel dependency okay so that's
our second step what is the third step
third step is in web config file we need
to specify sequel cache dependency
settings okay
so again just to speed things up I have
that already typed in so let me copy
that and paste this in web config file
so let's slip to visual studio so here I
have my web config file so if you look
at the connection string the name of the
connection string is DB connection
string which is pointing to sequel
server that's installed on my local
machine and then I'm going to have these
caching settings and the system dot web
the system dot web node I have this
caching element and within that I have
the sequel cache
and insane and look at this enabled is
equal to true obviously that means we
have enables equal cash dependency and
the important thing to notice here is
the pool time which is set to two
thousand now this time is actually is in
milliseconds since I have said this time
to 2000 it means are two seconds
basically so every two seconds asp.net
you know application is going to check
with sequel server are there any changes
to that
you know table basically within that
sample database so that's what this pool
time means now this optional meaning if
you don't specify pool time
the default is 500 milliseconds meaning
every half second you know that's the
frequency at which a speed or net
application will pull the database to
check for any notification changes for
that database table okay and obviously
we have this database element various
specifying name is sample and connection
string is that one okay cool so those
are the three steps we have done via we
have now established a sequel cache
dependency so let me go ahead and run
this now so ctrl f5 as soon as the web
application loads when we click that
button get data it should execute that
command retrieve data and load that into
cache okay
so data retrieved from database at this
time so now every time I click this
button it's going to retrieve that from
cache so it's gonna this data set is
going to stay in cache
you know until it has been changed so I
click that I still get it from cache but
look at this the moment I go and change
this data in the database so at the
moment if you look at this laptops is
laptops so I'm going to update that to
laptops one I press f5 in a one row
affected now look at this as soon as I
say get data data retrieved from
database at that time okay
so the data that was already cached is
removed from cash because asp.net
application detected the data has
changed so now no matter how many times
I click it's going to be retrieved from
cache unless somebody else is going to
change the data again so let me change
this once again back to laptops and see
what's going to happen
okay we have done that and now let me
click this get data look at that you can
see laptops it's change back to laptops
and then we got the data from data base
so anytime the data are you know in the
database table changes the I I mean that
data is removed from cache and we have
done that using sequel cache dependency
three simple steps to do that on this
slide you can find resources for asp.net
c-sharp and sequel server interview
questions that's it for today thank you
for listening have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>