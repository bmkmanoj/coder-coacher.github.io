<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>LAST VALUE function in SQL Server | Coder Coacher - Coaching Coders</title><meta content="LAST VALUE function in SQL Server - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/kudvenkat/">kudvenkat</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>LAST VALUE function in SQL Server</b></h2><h5 class="post__date">2015-10-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/zulLKbTK_j0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is part 118 of sequel server
tutorial in this video we'll discuss
last value function in sequel server
this function is introduced in sequence
over 2012 it retrieves the last value
from the specified column with this
function order weight loss is required
partition by clause is optional rows or
range Clause is also optional but for
this last value function to work
correctly
we may have to explicitly specify a
value for this Clause here is the syntax
for this function first we specify the
name of the function and this function
has got one parameter the name of the
column from which we want to retrieve
the last value and then we use the over
Clause and within paranthesis we specify
order by and then the column list by
which we want to sort the data let's
look at an example we'll use this
employees table in this demo so within
our result set we want name gender
salary and let's use the last value
function so last underscore value this
function has got one parameter the name
of the column from which we want to
retrieve the last value so let's
retrieve the name of the employee and
then we will use the over clause within
paranthesis order by and then the column
width by which we want to sort the data
let's sort the data by salary column in
ascending order and let's give this
column an Ali ass let's call this last
value now what do we expect out of this
query notice we are sorting the data by
salary column in ascending order and
then we are asking for the name last
name so this query is going to give us
the name of the highest paid employee
and if you look at the data that we have
here the highest paid employee is Ron so
we expect
Ron's name to be displayed against every
employee row within the result set let's
execute this query and see if that's
what we get look at that we get totally
different result why is that that's
basically because notice within this
query we have not supplied an explicit
value for rows or range Clause since we
haven't specified an explicit value it's
using its default what is its default
value range between unbounded proceeding
and
sentro so this is what is causing you
know this result now let's understand
how actually this query retrieves you
know the names that we see here within
the last value column so when it's on
the first row so when this last value
function is being evaluated for the
first row you know this value for rules
or range Clause is in effect so what
does this mean range between unbounded
proceeding so what does unbounded
proceeding means it means the vendo for
last value function starts at the first
row so this is the first row so it
starts there and it ends at the current
row so it's the first row and it's the
current row so only that row is passed
to the last value function and then we
are asking for the name column value so
it retrieves mark and display it against
in our last value column when it comes
to the second row so when this function
is being evaluated for the second row so
unbounded proceeding means the window
starts at the first row so it's going to
pass mark row as well as John's row
because that's the current row out of
these two what is the last value John
and that's what is displayed right here
so it goes on like that when it comes to
Ron's record all the rules are passed
and all of this all rows Ron is the last
value and that's how it is displaying
Ron against this row in the last value
column so how to correct this to correct
this we will have to specify you know
what is the vendor going to be for our
last value function so I'm going to
change the value for rows or range
Clause to rows between unbounded
proceeding and unbounded following so
what does this mean unbounded proceeding
means the window for the last value
function starts at the first row within
the result set and unbounded following
means the window ends at the last row
within that result set so when it is on
the first row it is still going to pass
all these rows and that way we should
get the data that we expect so here I'm
going to specify an explicit value for
rows or range clause
so rows between unbounded
preceding and unbounded following so
let's execute this query and see what we
get so now notice we get the result that
we expect so Ron is the highest paid
employee and that's what we see against
every employee row now within this
example we don't have any partitions
right so we have the entire table here
now if we have partitions then the
highest paid employee from the
respective partition should be returned
so let's partition this data by gender
column when we do this we should get two
partitions male and female and from the
female employees partition we should get
the highest paid employee so within the
female employees partition notice that
Jody has the highest salary 8,000 and
that's what we see here and within male
employee partition drawn is the person
with the highest salary and that's what
we see as the value for male employee
partition so we have that same example
right here thank you for listening and
have a great day</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>