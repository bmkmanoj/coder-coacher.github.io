<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>User Identity and Sign In with Google (Android Dev Summit 2015) | Coder Coacher - Coaching Coders</title><meta content="User Identity and Sign In with Google (Android Dev Summit 2015) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>User Identity and Sign In with Google (Android Dev Summit 2015)</b></h2><h5 class="post__date">2015-11-24</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/IkUm27Ic5FA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so I'm here today to talk about a
technology called sign-in with Google my
name is Laurence Moroney I'm a developer
advocate I work out of our Seattle
office and I focused mostly on Android
and on Google Play services I've been
doing a lot of work with identity a lot
of workouts sign-in with Google over the
last few months and having a whole lot
of fun with the new API sand has anybody
tried out the new sign-in API yet by the
way okay a few cool Oh actually one
thing I forgot before I go back at the
bottom of this slide here you see I put
a URL J dot M PE slash off feedback if
you have any questions any feedback
anything you'd like to let us know about
the API anything you want us to get back
to or on anything like that there's a
simple google form on there you can do
it anonymously or you can give us your
email address to give us some feedback
on that so you know anything along if I
don't have time for questions at the end
of the session or anything like that
I promise we'll try and get back to you
with answers if you fill in that form
and if there's any really difficult
questions
Paul here at this table will be the one
to answer them so he's glad they turn
the lights down so yes so today I'm
going to really talk about sign-in with
Google and a particular Google sign-in
technology I have a blue button on the
screen here but we actually have a
branding guidelines document there's a
link at the end where if you don't like
the blue button we also have a white one
there's also guidelines if you need to
customize the button if you don't like
it to say sign-in with Google and you
want to like localize it to your own
language or maybe something like Pig
Latin or something along those lines
then you can actually customize that
button there's lots of resources on
there that will allow you to do that but
before I begin talking about signing
with Google I'm a bit of a stats geek
and I love stats and I find some great
ways I know there are lies there are
darned lies and there are statistics but
I'm going to use some statistics and I
hope that you find them interesting so
the first of all I'm going to start with
is that research has found that 86% of
users do not like creating and
remembering new passwords to interact
with you what I find stunning about this
number is that it's not higher right I
mean I certainly hate going to a new app
or going to a new site and having to do
and yet another sign up and they
probably have different sets of rules
for what's a valid password and what
isn't a valid password and
you know remember all these things and
then six months later the next time I
use that site or app that again I have
to remember what that user name and
password was 86% there according to
research the next number is 54% of users
that if you present them with yet
another sign up will quit altogether so
think about all that time that you've
spent building your app maybe making
your app work on multiple platforms like
iOS Android Windows Phone though all the
different platforms may be working it
with a website as Wells and having a
users identity with that all that time
building that all that time marketing
that all that effort you get for people
to access your site or download your app
and use it and more than half of them
will walk away if you ask them to build
yet another username a password or sign
up will you add another username a
password so that's why technologies like
sign-in with Google are very important
to me in particular because I don't want
to build apps like this and have more
than half of my audience walk away and
one more number is 92% 92% will give up
if they don't remember the username and
password that they signed up for on this
site so if they try to I'm a little
active with my hands if they try to sign
in and then they can't remember the
username or password and you provide
them with a forgotten link research has
shown that 92% and we'll just walk away
at this point right so it's all very
nice to be able to give them that
facility to sign in if to recover a
forgotten password or identity but if
only 8% of them are using it that's a
lot of wasted effort and a funny story
in a true story is I'm doing grad
studies in a university that's not too
far from here that I won't name and
they're one of the best IT one of the
best technology universities in the
world and I'm not a matriculated student
there so I come in through what they
have is a Professional Development
Center and when I go to their
Professional Development Center to sign
in to that I have to give a username and
a password the password on this Center
has a set of rules about what's a valid
password or not and their set of rules
for this one is that you're not allowed
to have any capital letters and you're
not allowed to have any punctuation
it's just lowercase letters and numerix
so I come and I sign in and I put in a
password for that and like most people
all of my passwords are kind of
variations on a theme
very obscure theme that only means
something to me and so no uppercase
letters no punctuation so I use
lowercase letters in a sequence of
digits and then once I'm signed in to
that then to access everything in the
University like I'm a real student so to
access email or to access my grades and
all that kind of stuff they have a
different username and password and the
password on that you have to have
capital letters and you have to have
punctuation and as a result I'm like
thoroughly confused whenever I try to
sign in to this thing and almost every
time I have to reset my password to be
able to access my stuff I'm one of those
eight percents because I have to access
this stuff so I go through all of that
kind of thing and that that's me is
really really annoying and I'm sure it
would be to you too so the idea and part
of our goal with sign-in with Google is
to help you to use what you know to feel
secure that your credentials are backed
up by this what we hope and we will be
believe is a world-class infrastructure
and then if you're a developer so that
you can offer this to your users to
instead of giving them all of this
friction instead of giving them all of
this hassle instead of different sets of
validation rules instead of having to
remember yet another user name and yet
another password that they can just sign
in with the Google ID that they already
have or hopefully that they already have
so some of the features behind this so
what we want to do is we want to make it
easy and we want to make it familiar for
users you know most of your users will
probably have a gmail address and most
of your users are familiar with Janet
signing in for Gmail they probably know
their username and password for Gmail
and they can sign into your app or your
site as frictionlessly as they can with
Gmail we really want to keep it that
familiar and we want to keep it as
strong branding on that they know when
they trust Gmail they sign into it
probably every day it's not a case of a
few months later they've forgotten their
password they're using this it's very
easy it's very familiar for them it's
also secure one thing I'm going to talk
about in a moment is phishing and
hacking and being me there's lots more
stats so I'll have a lot more stats on
phishing and hacking but before I get to
that one of the things is about security
is the backend infrastructure the
support mechanisms the overall machine
behind securing your users identity if
it's provided by Google it's at least as
good as the one that you would build
yourself but I would argue it's probably
better you want to focus on building
your application you want to focus on
building your site without thinking
about all of the time and effort and
cost and building and maintaining a
world-class security infrastructure most
of us aren't big enough to be able to do
that properly whereas if you're using a
sign-in with Google type technology then
Google have done that for you so I think
that's something that it's very secure
and it's also really good for your users
as well as being really good for you
then the next part of this and it's part
I'll be frank that we kind of failed on
but we're really improving on is making
it easy to code
if you've used sign-in with Google if
you've tried to build with sign-in with
Google up until about I think it was
like September of this year the API was
quite complex there would be a case of
you would try to sign in and in a way
that you'd sign in is by connecting a
Google API clients but what would happen
is the first thing that the user would
see is a dialog asking them well which
ID are you signing in with that would
actually error out the connection
process and how you was a programmer
would handle that is by handling that
error then once the user has selected
their ID then in many cases the
application would ask them for some kind
of permission like maybe accessing
contents or if you're building something
for example that uses Google Drive to
give the user to give their permission
to access Google Drive that would also
error out the connection process and
you'd have to handle that as if it was
an error and how you knew when the user
was sign-in was when your Google API
connected and it handled all these
errors and you know as a developer to me
I find I found that a little bit ugly
you know a user picking their name is
not an error a user giving permission is
not an error and so we've really really
improved the API I'm gonna be showing
off some of the stuff in the API so I
find it a lot easier I find it a lot
quicker I find it a lot more
straightforward I hope you do too and
then the next thing is to make it
extensible it's all very well if you've
got a mobile device and you've got a
sign-in dialogue in the mobile device
and the user has signed into the device
on that but then what most of you likely
have some kind of back-end service most
of you are probably storing some kind of
data in that back-end service that as
the user signing in some of the
customization of the app comes from that
data and maybe you want that data to be
secured to
now think about what can happen with a
middleman attack between the device and
your server we'll talk about that a
little bit later in the presentation but
one of the things about sign-in with
Google is it's not just about your phone
it's not just about your device it's
also about being able to secure back-end
services ok so first of all I'd like to
talk a little bit about the UX and some
of the things that we've done to help
you focus on the user reduce some of
this friction and improve the UX so my
speaker notes one is really small here
so I'm gonna just turn around so this is
what it used to look like so on the very
left hand side you have your application
and you've got a set of sign-in buttons
like the top one is sign-in with Google
the middle one is Facebook the bottom
one I think is Yahoo so the user would
pick sign-in with Google what would
happen well first of all they will get a
request asking can this access their
contacts can this access your contacts
why when signing in to this application
should this application access my
contacts and I there's a rule of thumb
that I like to follow that every time
you give the user a choice that really
isn't relevant to what they want to do
at this moment in time you lose 90% of
them and to me this is a great case
where you could lose 90% of them so you
then select that when the user is very
nice and they say okay yes I will and
then they get this oh you've got to give
me permission and then they say ok to
that and then it's like ok
once they've given permission now have
to ask for the contacts again once they
give that permission now finally oh
you've got what account do you want to
sign in with this phone only has one
account on it but yet you need to tell
me the account that you're going to sign
in with so that's there what is that's
the fifth from the left it's once
they've picked that one and they sign in
now guess what this user didn't have a
Google+ profile oh we can't continue we
need to fill out a Google+ profile so
this group they would have to fill out a
Google+ profile they create that submit
and then finally guess what it's asking
them for their basic info including the
list of their contacts and then they say
ok to that they allow it and then
finally they're in sign into the
application there's a lot of friction
here we understand this so we've tried
to improve it and we fixed it so now it
looks like this so now we say ok let's
get started let's sign-in with Google
the first thing is well we just need to
know which
on your phone you're signing in with in
this case I'm going to pick the account
and then I'm in most cases I'm straight
into the app there is sometimes there
will be another step between the second
and third of these and that's if the
user has to give specific permissions to
access something I'd like to use Google
Drive as an example so if you're
building an application that accesses
their stuff on Google Drive then they
would have a you know a third step in
between the middle one and the one on
the right here but that's how
frictionless it has become we're really
really proud of this we ship this in the
last version of Google Play services
back in September ish and we think it'll
make it a lot easier for your users to
be able to sign in and to be able to
feel secure in signing in without
without all these dialogs asking them
for a stuff sometimes stuff that may not
be actually relevant to what they're
doing right now so the next part is I
spoke about security and one of the
points so we've made it easier for your
end users and now we want to talk about
security and I think it's really
important in security that security
isn't a static thing security is always
a moving target and it's really really
important to stay ahead of the game and
as part of like our job at Google is to
stay ahead of the game in the security
landscape I like to show this
infographic so this is from a website
called information is beautiful net
there's a public link I have it in my
slides if anybody wants the slides I can
share the link out later or if you fill
out that form and just ask me I'll send
the link to you now look at all of these
breaches and look at all of the users
that were impacted by that okay some of
these are in the tens of millions of
users that were affected by a breach
some of these we might be familiar with
you know the probably the most famous
one recently was the Ashley Madison one
where 36 million users had very very
personal data leaked onto the Internet
and then some others like you know some
banks and stores and that kind of thing
where people had personal information
leaked out maybe not on to the internet
like in the case with the Ashley Madison
one but the overall picture that people
have is that their data their personal
details their credit card other stuff
like that is at risk every single day
from hackers now a lot of this stuff of
course was inside jobs some of the
retail ones where people had planted a
worm inside the credit card scanning
machines that was able to collect data
about credit cards that were scanned you
know so it's a little bit of it
different scenario than you may be
facing when you're building something
for sign-in but the bottom line is to
users it's all the same it's really
really a feeling of insecurity that
people are out there to get them and
it's our job to at least try to help
them feel a little bit more secure when
they're using your apps when they're
using your sites that kind of thing so
you don't want to be this guy and you
want to help them not to be this guy you
know sometimes I think I should just
change my password to incorrect you know
for this reason you know we really want
to help them not be this guy so the next
part that I want to talk about a little
bit is the bit one of the biggest things
where your users are at risk and that's
from phishing scams now there was some
research done by the Canadian government
and it's spoke about and this research
found that 156 million phishing emails
are sent out every single day
okay now by the way this research was
done a couple of years ago so I think
these numbers are probably bigger now so
of those 156 million phishing emails now
of course we all have great email
filters we all have great you know tools
that allow us to filter out and says
stop phishing scams and and to block
them so how many of that 156 million do
you think got through these filters
anybody take a guess somebody say 10%
that's a good guess 16 million all right
around 10 percent actually got through
so when you think about this a lot of
the free email providers like Gmail and
Yahoo and hotmail etc they all provide
these spam filters and I'm sure like
many of you I've gotten my name on all
of them right I'm al Maroney at Yahoo at
hotmail at Gmail and all these kind of
things and you know these these try
their best to keep spam and phishing
away from my eyes but most of them some
are better than others I won't say which
are bad and but most of them try to keep
fishing away from my eyes but some of
them do get through but it's a little
bit of a side benefit I think if you're
using something like a Gmail because
these have these services receive the
most phishing their best that
identifying phishing much more than
maybe an independent server would be and
as a result if your users are already
using something like Gmail then they're
already being less
- phishing scams because less are
reaching their inbox I don't know about
you who used Gmail but I think when I
look at phishing emails that are sent to
me far less than 10% get to my gmail
inbox all right
so 16 million of the hundred and fifty
six million got through filters to end
users how many of those 16 million do
you think were actually opened by the
end users quarter of a million okay it's
higher than quarter of a million sorry
25 percent okay it's actually higher
than 25 percent I feel like a game show
here right 80 percent it's lower than 80
percent 50 percent thank you Sony's it
it's actually 8 million about half now
remember this is every single day users
are opening and this was an older
research I think is probably higher now
every single day users were found to be
opening 8 million phishing scams okay
next question
most phishing scams have a link in them
right you know to say you know the
typical phishing scam is like oh I'm
from insert email service here your
password is failed please sign in here
to change your password that's the
typical one so there's usually a link
that you go to to a fake website where
they where they harvest your password so
how many of those 8 million do you think
that people actually clicked on the link
and went to the website a million okay
that's close enough it's 10%
it's about 800,000 so every single day
you know be 800 thousand of these links
are clicked on and people are going to
sites with phishing scams on them
alright you go to this site now a lot of
the time you've gone to the site and
some of most people in this room I'm
sure are smart enough to look at the URL
and see that hey look this URL isn't
yahoo.com or google.com or where our
Facebook or wherever you know it's you
know Bob bays slash something and
nowadays browsers have that like little
green thing that they put in the address
bar to show that this really is
certified that this is this is the
correct site but 800,000 of these people
have gone to these sites how many of
them do you think we're still fooled and
actually entered their user data half
okay thank god it's a bit less than that
it still
10% it's about 80,000 so per day 80,000
people fall for a phishing scam and many
of those usernames and passwords are
compromised people might be using the
same username and password on other
sites like I said for me there's a
phrase that I know that nobody else
knows and most of my passwords kind of
root off of that phrase by changing
letters around or adding numbers or
punctuation and and it helps me to
remember password so had I gone to one
of these phishing sites and if any of
fishers are watching this live stream
they now know that my password has that
kind of combination so maybe I need to
change it but if they've gotten a one of
these sources of my password then they
already have several steps towards being
able to compromise my account in other
places so it's a tough landscape out
there and it's up to us as app
developers and as site developers to
protect our end users in that so as part
of the value that we try to offer with
Google sign-in all of this kind of stuff
becomes possible so when you use a gmail
sign-in when you use a Google account
I'm sure a lot of you like me travel
around maybe around the country maybe
around the world you've probably
encountered these things that you know I
was in England two weeks ago and when I
tried to sign-in in England
Google didn't challenge me I then the
following day went to Wales and when I
tried to sign in from Wales Google were
like this is suspicious activity we're
gonna challenge you for some extra
details just to make sure that you know
really you really are moving around
you've been in three countries and three
days what's really going on here and it
was that extra layer of security that
Google were able to provide to protect
my password in case somebody really was
scamming me somebody really was taking
that kind of thing another tool that's
in there is being able to sign out of
sessions remotely now one of the things
that's nice is that if you use like
internet cafes or that kind of thing and
you sign into your Gmail and you forget
about it you know you can go and you can
sign out remotely but it's also really
nice that hey you've gotten this warning
you know if we've detected suspicious
activity on your account somebody in
Wales has tried to sign into your
account
what's going on here you can then go and
just kick that person out remotely
before you change your credit or before
you change your password details things
like that unusual activity alerts same
kind of thing if there's strange
activity going on you get
you get alerts sent to you you can have
like alerts details and all that texted
to you and whatever there's some
intelligent challenges on there for the
same reason there's all of this
infrastructure designed to protect your
username and password so if you wear one
of these people who was you know on an
inadvertedly gave some details and a
phishing scam you can find out right
away you know when your users are when
you are using a Google identity so of
course and then as all the
infrastructure that I mentioned behind
it all the security of the
infrastructure one of the main places
that passwords get compromised is that
somewhere in a system they're stored in
a place that's unencrypted or maybe
they're passing from A to B across an
infrastructure that's unencrypted and
it's easy for somebody to sniff that off
in network and as a result passwords can
be compromised again the infrastructure
that's behind Google's credential system
behind our ID system hopefully doesn't
have any of that we haven't had any at
least that I know of right now any major
compromises for that kind of thing so
again if your users are using Google
identity if they're using any kind of
sign-in with Google all of this back-end
is there for them so enough about the
user what about the developer story and
I'm thinking about I'd mentioned earlier
on about there were some difficulties
and there was some like bumps and the
road that you have when you try to
sign-in so we've tried to make it a lot
easier and I'm gonna like talk through
some of the steps here I'm not gonna
demo it because unfortunately the
emulator doesn't yet run the version of
Google Play services that has this on it
and it's just too awkward to try and
deal with a device while I'm on stage so
I'm just going to demo by showing the
code so first step instead of connecting
directly to a Google API clients the API
has this thing called a Google sign-in
options object or we just call it a gso
for short so your first task is to
create a gso and in this case I'm doing
a very simple one I'm not requesting any
additional permissions other than the
basic email identifier and thinking
about just the person's email address as
the thing that they identify themselves
with you saw that dialog earlier with
the pop-up where it was like Nikhil
quart --let and his email address that's
what Springs this and this doesn't
require any permissions from the user
other than just filling in that account
picker if you were for example to access
Google Drive or you wants to access
Google Drive or and any other things
there will be an additional dot on here
before the dart bills and then the user
will get the dialogue saying hey you
know this app also wants to access your
Google Drive etc but if you're doing at
this and this is the basic and the most
common case you're just gonna have those
three steps that I showed in the earlier
slide okay next now if you've built with
Google Play services and if you've built
with a authentication and identity when
Google Play services you'll know about
the Google API client and here's where
you set up the Google API client you
create it with a builder and you access
it with the ad API and you pass it the
GSO that you just created earlier on the
second parameter there it's off the
Google sign-in API and you just passes
that gso object and that gso object had
the configurations for the type of
permissions that you want to access
right so it's as simple as that the
function to determine it there's an auth
class there's a constant on there and
that constant is the Google sign-in API
so now you've created a GSO you've
created your Google API client so the
next thing to do is to get a sign-in
intent from the API for this Google API
client and you can see it's here I just
create intent dot sign-in intent equals
off that Google sign-in API I passed
that the API clients remember the API
client was configured with the sign-in
object and then I start an activity for
that result there's a constant on the
right hand side there are C sign-in
that's not part of the API usually if
you're building an application and you
start an activity so that Android can
tell which activity result is for which
activity you just pass it an integer and
it can be anything that you want it's
just up to you to do if you've got
multiple activities going on it's up to
you to identify them with your own
constants so in this case you know this
constant or C sign-in I think we made it
there's a sample that you can download
that I took this code from I think it
was like seven thousand and one so when
you get the callback saying hey we got a
result for activity seven thousand and
one you know that it's that one that
it's the same in one but like I said it
can be anything you like and then you
can see the callback here where you
catch the activity result and it's so
you get your own activity results and
then on the activity result you have a
request code remember the request code
that I said that you passed in if it's
that request code that you created for
the sign-in activity then all you have
to do is create a Google sign-in result
object and this is going to be the
result
of the call to Google sign-in API dot
get sign-in result from the intent and
the intent passes you back the data
parameter that you can see at the top so
now you have your sign-in result and the
sign-in results object gives you
everything that you need to know about
the sign-in such as the account and the
account is a Google sign-in account
object and you get that using the result
I get sign-in account as it suggests and
then you can query that account object
for things that the user has given you
permission to including hey has this
user actually signed in and out that
kind of thing so now that you have your
accounts now you can personalize your
application for that end user and it's
as simple as that and again just to look
at the flow again it looks like this the
user clicks the connect with Google
button they get given the picker which
asked them which account that they want
to sign in with they pick that account
and then they're taken to your
application and you can customize your
application as you as you please for
that user like in this case we see we
have the user's name and a picture and
stuff at the top for that user and as I
mentioned before that if you're doing
additional scopes for example the one I
always like to use is drive that if your
app is going to access the users Drive
there'll be an additional step in
between you know the middle one and the
right one there where the user has to
give permission to that so this is great
but guess what this is all very nice for
authenticating on the device but what
happens when you want to extend beyond
that and I like to give a story here
there was before I joined Google I was
an independent application developer I
worked for a lot of startups building
applications for them and there was one
startup that I worked with that they had
this really interesting app for a very
unique audience and their audience where
was people who own pets who hire other
people to look after their pets for them
so part of this was like you know I have
you know I have a dog
I'll use my own dog my dog but is called
Bucky and and if I for example work too
much and I can't walk Bucky then I can
hire somebody to walk Bucky for me but
how do I know that that person has
actually walked my dog for me right so
the idea behind this app was that I
would have this use did my person
they've hired use this app so then as
they're looking after my dog during the
day as they're walking the dog it would
like collect data around that it would
like collect data of where they walked
and all that kind of stuff it was an
interesting
concept but of course in order to be
able to use this people needed to sign
up for this cyst for this service so
that you know they register that I am
Who I am and here's my password that I
sign in and I add dog walkers to my
account and so first of all we hit the
first barriers that I was talking about
earlier on of yet another sign up that
people had to do so we thought okay
let's add social like let's add sign-in
with Google let's add sign in with
Facebook let's add sign-in with Yahoo
and sign in with Microsoft and all these
kind of things to the app so it makes it
easier for people to get into it so that
was that was the first part it was all
very nice but then we had all this
back-end data and back-end data example
including the address of the person who
owns the dog the site where the dog gets
walked all this kind of stuff and it's
like okay it's not crazy sensitive data
such as like bank account details or
other stuff that has been leaked on the
internet in the recent past but it's
it's it's potentially sensitive you know
people know where I live maybe I have a
really expensive breed of dog that could
be kidnapped you know who knows so there
is sensitive data there so how do we
secure that back-end data and it's all
very nice that if we had a sign-in with
Google that gets people into my
application locally on my device and I
can customize it for them but what then
if those credentials get passed up to my
back-end server and I start needing to
identify the person on the back-end
server now certainly you can have a
middleman coming in and maybe a
middleman posting stuff to my server
saying yes this is Laurence Moroney it's
al Maroni at gmail.com give me his
details okay so we need to be really
careful about extending you know our
applications to handle that so here's an
example like here's my app you know my
app has signed it by the way you love my
diagram Sam I'm not the most artistic
person in the world so you know my app
has the sign-in with Google Google has
provided an identity for my user and
like maybe I'm keying that identity off
the users email address I then passed
that email address up to my server and
what can happen is the bad guys can say
huh I can pass an email to the server as
well and then what happens I get there
sorry if I pass the email to the server
as well the server might be able to post
back to me some of the details about
this person that would be bad so part of
the extensibility of sign-in with Google
that we've done is saying okay let's
let's treat this a little bit
differently okay my application as well
as being able to sign in and get an
identity from the users such as their
email I can also get this token and this
token says okay
Elmer onea gmail.com has signed in he's
signed in at this time here's some of
the metadata around that here's how
we're signing that here's how were you
know encrypting and securing that and my
app can pass that token up to my server
so now the server passes that token to
Google and gets an act back saying yes
this is good or you know this really is
a token that we issued this really is El
Moroni at gmail.com this isn't some kind
of fake this is the person now how we
can do this there's two ways the way
that we recommend is we've got a set of
libraries that you can do this so those
libraries do that communication on your
behalf and I have a few code snippets
our show in a moment that show them but
we also have an endpoints that we you
can call then you can just call that
endpoint and get the data back we
recommend the endpoint for debugging and
it's all into the docs I have some links
at the end of the slide and but we
recommend the libraries for a production
work so now if a bad guy comes in and
the bad guy passes up a fake token of
course the usual security happens the
you know your server can then try and
pass the fake token to Google and Google
come back and go ah that's not gonna
happen and then you will know so it just
secures your back-end server with your
user's identity from Google that much
better so let's look a little bit at the
code for this okay remember earlier on
the first step on your Android
application was creating the GSO well
one of the things I've just highlighted
in red here I've added another method to
this and this method was request ID
token and I passed this thing called the
server client ID in there and the server
client ID is this unique ID that's
generated for your server there are
steps in our documentation that show you
how to do that it's just it's a big long
ugly string that you can just put as a
constant in your app and or any other
way that you want to do it and so when
you call the request ID token now once
the users sign in once you get that
successful sign and you're able to get
that token to so that's the only change
that you need to make to your GSL sign
in so then step two when you're setting
up your Google API client spot the
difference there is no difference
right so it's exactly the same thing you
don't need to change anything in your
code for setting up the Google API claim
now step three to get the sign-in intent
it's exactly the same we've added that
one line of code to the GSL but creating
the Google API client calling the Google
API client connecting it and getting the
sign in intent back the flow is exactly
the same but then once you get your
result back so earlier if you remember
this one on our activity results coming
back you know if the activity was the or
C sign-in activity when we get our
result back and we get our account back
there's a method on the account which is
get the ID token so this gets the token
for us we have this token now in our
client upon a successful sign-in and
it's a simple case of posting that token
to the server right to our own server
and in our server sorry when I say our I
don't mean Google I mean our if I'm the
application developer so my back-end
server is an application developer
poster token to that and then that token
can be posted to Google and authorized
by Google on your behalf so again just
looking at that flow you know here my
application the user has signed in with
Google they've gotten the identity token
from that they post the token to the
server so now Google will get the server
a kit and send it back so we avoid the
bad guys doing it let's see what the
code for that would look like here's how
you process the code on your server
sorry I need to turn around because I
can't read it on my laptop and so first
of all the ID token string is that token
that's come from your Android clients
has been posted to the server just as a
string on an HTTP POST or hopefully an
HTTP POST and your secure post and you
get your ID token so you want to just
check if it's not null now you have this
on the API this is not part of the
Android API this is part of the
libraries that I mentioned that you can
use on your back-end server there the
Google libraries for authentication an
object in there is called
surprise-surprise a Google ID token
verifier the Google ID token verifier is
then built just using a couple of
objects that transport in a JSON factory
but the important thing is two things
you need to do number one you need to
set the audience now the audience can be
a number of different servers because
you may have multiple servers posting
into this thing and you want the
audience for each of these and this
scenario I just have one and the ID for
that you remember us talking earlier
about the server client ID I know it
sounds like an oxymoron a server client
but it's the client ID from your server
to Google servers and so you set the
audience with that ID and then you set
the issuer and the issuer is just
accounts.google.com and then you build
this thing and then after you build this
thing you can then just verify your
token by calling verify or dot verify
that actual string that was posted up
and if that comes back as not null then
you know this token has a payload
associated with it the payload all the
things in orange on this slide by the
way a part of the API so the payload
that you create from that ID token has
something for example a method in it
which is the get subject and that just
gives you the user ID so if you think
about the flow the user on your device
tries to sign in when they sign in
Google issue a token to your device your
device then gets that token and post it
to your server your server gets that
token and posts it back to Google Google
then verify that token and come back and
say this is the user ID associated with
that token so you have the complete flow
from your device to your server securely
for your actual end user so then if
you're building for example a dog walker
application and you don't want a
nefarious third party to access data
such as the breed of your dog or your
address or where you live this is a
great way of doing that so all of this
data that's in flight is much more
secure than if it was just an email
being passed to your server to identify
the end user so that's really part of
the value and that's what sign-in with
Google is all about and that's why we're
working so hard to make it the best
technology we possibly can so all of
those above scenarios that I spoke about
become possible hopefully you avoid your
users having the issues that I spoke
about earlier on where many of them walk
away if they don't get the data that
episode if they they forget their
password and stuff like that there's a
few resources that I've put here so the
main website that we have
developers.google.com/live and
information on this as well as some more
complex scenarios there's one that I
haven't gone into here and but describe
it briefly was you know we spoke about
your server being acts of being able to
access Google's back-end to verify that
a person is who they say they are but
what if
using my drive scenario again if you've
built it so that your requesting drive
on the phone and the person is able to
access drive on the phone that's all
very well but what if you want your
server to access drive on their behalf
maybe instead of the dog walks being
saved on the phone you want to save them
to the users drive and you want your
server to be able to do that or
something along those lines
you know there's again there's a more
complex flow that you have to think
about because now you're having your
server talk to your end-users identities
on their behalf accessing stuff which
could be sensitive in their Google Drive
on their behalf etcetera and you want to
make sure that's secure I don't have all
the details in this talk to go through
that but those kind of scenarios as well
as in two that I mentioned are all on
developers.google.com slash identity
there's a really really great sample
code and it's on github and under Google
samples Google services and it's the
sample code actually has four scenarios
in it
the first scenario of simple sign-in
that I've shown the second scenario of
simple sign-in but with drive on the
device being shown the third scenario of
authenticating against your back-end
server that I've shown and in the fourth
scenario that more complex one they were
saying where your server may need to
also authenticate against Google
services on your users behalf that's
also in that sample so it's pretty cool
and then finally if you if frequent
Android developers that blog spot.com we
actually have an ongoing series on
identity there's a post actually going
out today about all the server scenarios
that I mentioned so great resource go
take a look at that if you're interested
in anything identity and of course reach
out to me or any of the team I gave a
forum at the beginning of the talk and
here it is again so jaded MP slash auth
feedback and with that just like to say
thank you for coming and spending some
time with us
I have three minutes for questions so if
anywhere we have one here yeah I'm in
the center here Oh waiting for Mike some
applications might have some sort of age
restrictions so is there any way you
like to check for age or like if they
haven't already put their age in their
Google account ask them to provide it ah
that's a good question I is there an
access on the ID object for their age
this is Paul from the identity team so
basically what it sounds like is you
need actually additional information
that we don't provide so we don't
provide specific ages and things in
profile so actually once they've signed
up with a Google account I would then
ask some additional questions to build
out their profile so like it saves you
asking for username password and
everything but then the rest of the
information you might need you would
request at that point in your signup
flow by that point they've already got a
login so you could potentially delay it
to later on if you don't need that age
immediately sort of say kind of like the
you know you may seem like LinkedIn and
other sort of social network sites ask
like hey you your profile isn't 100%
complete maybe you can add this
information later on and encourage them
to do so with benefits and things but
that's typically how we see it done okay
there may also be age restrictions on
how young you can be to have a Google
account I don't know if the top of my
head but if you post a question to that
we can confirm that over here
does the new flow request any permission
like a you show in the o flow you look
at this get contact contest yet so it
will request permissions in a number of
scenarios like if there are things that
you're requesting that need that
additional permission I use drive as an
example but if you're just saying that
dot request email on the GSO then
there's no further permissions required
are you talking about Android
permissions or user permissions so like
with Android M specifically the great
thing about this new library is that
actually removes any get accounts
permission so there's no sort of system
dialog Commission's that you need to
request now to use Google sign-in and so
that's actually one of the beauties of
updating to the latest versions of the
API is that you can remove that whole
step that was one of the steps was
actually in that horrific slide with
thousands of steps so as far as that's
because then Android permissions there's
no no permissions requested from the
user like contacts or camera or anything
like that
there's just the the permissions you're
asking for for the services you're
trying to use okay thank you
I've only time for one more maybe at the
front here so any other questions please
just fill them out in this form and
we'll get back to you
quick question is a Google Drive and
YouTube or certification that's just
gonna work with this as well so we want
to post from the app to YouTube so of
course there'll be Drive API it's for
accessing drive itself you'll need to do
that this is just the permissions layer
to give you access to that
but identification yeah so for example
if you've got multiple accounts on your
phone as many of us do then there's
multiple ways into Drive and as multiple
access points on Drive so if your
application provides the identity to
drive that you've signed in with it will
be that Drive account that you're able
to access just replace the sign-in that
used to happen on connect and everything
this now you'll notice that it's still
feeding back into the same Google API
client so that still functions in the
same sort of way
so this is all about
the process that happens in the sort of
startup of the API client they connect
and all the rest of it alright thanks
everybody and again any questions just
fill them out in that form it's J dot MP
slash auth feedback thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>