<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Background work with JobScheduler (Android Development Patterns S3 Ep 12) | Coder Coacher - Coaching Coders</title><meta content="Background work with JobScheduler (Android Development Patterns S3 Ep 12) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Background work with JobScheduler (Android Development Patterns S3 Ep 12)</b></h2><h5 class="post__date">2016-09-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/XFN3MrnNhZA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">if you have some heavy work to do and it
doesn't need to be done right now that
I'm going to kindly ask you to use job
scheduler job scheduler is guaranteed to
get your job done but since it operates
at the system level it can use several
factors to intelligently schedule your
background work to run with the jobs
from other apps as well and that means
we can minimize things like radio use
which is a clear battery win and as of
API 24 job scheduler even considers
memory pressure which is a clear overall
win for devices and their users job
scheduler was introduced in lollipop and
is pretty cool because it doesn't
perform work solely based on time but
rather based on conditions for example
you can use set required network type
for jobs that you want to execute when
the users on a metered versus an
unneutered connection or you can call
set persisted for jobs that you want to
persist across a potential reboot and as
of API 24 there are even methods to
schedule a job based on an update to a
content provider and of course you can
read the documentation to see how to
play with other criteria you might care
about from back-off policies to time
limits for scheduling the job basically
this is where the magic happens so spend
some time getting it right you can
define these conditions when you are
creating the job through the job info
object to build that job info object you
need two things every time and then the
criteria all the bonus bits over here
but you need a job number to help you
distinguish which job this is and a job
service now your job service is actually
going to be a service that extends the
job service class and this is where
you'll define the work that you'll be
doing but since you're extending another
class you will need to implement a few
required methods on start job is called
by the system when it is time for your
job to execute this is where the one
tricky part about job scheduler exists
your job service runs on the main thread
that's right the main thread so use on
star job to either perform simple work
or to kick off a background thread for
complicated work and if you do kick off
something else you'll need to return
true but if you're done with everything
go ahead and return false this will let
the system know whether your job has any
ongoing work still on stop job is called
by the system if your job is cancelled
before being Finn
perhaps because the conditions are no
longer being met like the device has
been unplugged so use this for safety
checks and cleanup and then return true
if you'd like the system to reschedule
the job or false if it doesn't matter
and the job will be dropped job finish
is not a method you override and the
system won't call it but that's because
you need to be the one to call this
method once your service or threat has
finished working on the job that is if
your on start job return true because
this is how the system knows that your
work is really done and it can release
your way clock so if you forget your app
is going to look pretty guilty in the
battery status line up job finish takes
two parameters the current job so that
it knows which one we are talking about
and a boolean indicating whether you'd
like to reschedule the job perhaps your
work failed for some reason so this will
kick off the job schedulers exponential
back-off logic for you or else the logic
you specified in job info now as with
any service you'll need to add this one
to your androidmanifest.xml
what's different though is that you need
to add a permission that will allow job
scheduler to call your jobs and be the
only one that can access your job
service finally you can schedule a job
using job scheduler which you will get
from the system then call schedule using
that super perfect job info object you
created and you are good to go not so
scary is that there are a lot of pieces
to be sure and you'll need to think
carefully about when and what should
trigger your job and what happens if it
fails for some reason but overall job
scheduler was designed to be easy to
work with so give it a try and go build
better apps
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>