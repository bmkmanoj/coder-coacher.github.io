<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>DevBytes: Hierarchy Viewer - Overdraw | Coder Coacher - Coaching Coders</title><meta content="DevBytes: Hierarchy Viewer - Overdraw - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>DevBytes: Hierarchy Viewer - Overdraw</b></h2><h5 class="post__date">2013-08-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/URyoiAt8098" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome to a deaf bite my name
is Yan Felix market I'm from the Android
developer relations team in this episode
we are looking at the hierarchy viewer
and how you can use their tool to fix
overdraw issues in your application so
let's have a look at our demo
application here so this is a looks a
bit like an ass as frida we're calling
it the bacon reader application so you
can select articles here on the side and
you can you know you can read some text
here in this frame here this is quite
standard Android layout there we have a
fragment here for the list on the side
and we have one fragment here on the
right-hand side for the full domain
content so let's look at hierarchy view
and I will show you how this application
what the application looks like in
hierarchy viewer so the the hierarchy
viewer application is part of the
Android device monitor you can simply
open open it up by clicking on the
hierarchy viewer button up here so once
you float it in your application you've
selected it we have selected your
activity you get this tree up here and
this tree basically shows you what there
what you have used in your application
actually looked like so in this case
here you can see we have a linear layout
and this is your app or entire
application lives so we can we can drill
down a bit further so you can see here
we have a list view and it is coming
from the fragment that we have on the
left hand side and you can see here this
is this is what we have in this in this
list which is what what's drawn inside
it and we also notice that we have these
these these colored dots here and these
dots indicate how how quickly each of
these views was drawn so green means it
was very fast yellow means it was drawn
it was fast and 50% of the views and the
red means it's one of the slowest trees
in your view hierarchy so this is
actually quite a nice true true that
allows you to drill down and see what
your application actually looks like
when you run it and it particular when
you use some more complicated layout
this really helps you troubleshoot some
of the layout issues so if you want to
use the hierarchy viewer in your own
application you have to include the view
server class in your application you can
get it from this website down here
that's on the screen and I'll show you
what that looks like so you basic just
drop it into your application in this
case you an Android studio and then you
have to add a few
inside your activity lifecycle and the
activity you want to look at it but in
more detail so you have to add a call in
the oncreate method and in ondestroy
and in on resume and that allows you
allows the hierarchy view to connect to
your application and load in the views
justice as we've seen so let's see how
we can use the hierarchy viewer to debug
one very common problem that you often
have any application in this code over
draw and over draw means that you've
drawn the same pics in multiple times on
the screen and obviously that's really
bad before for performance especially if
you define a background multiple times
and it's always the same color doesn't
make much sense to draw it multiple
times on the screen so if you go to the
developer options on your device there
is an option called show GPU overdraw
and that that gives you a nice visual
indication of which pixels you draw
multiple times red and green means to
draw on it once or twice and then light
red and red means you draw get more than
three four five times that's obviously
really bad for your application and if
you look here at our app you can see
that we have the background of the each
of the ListView items is thrown multiple
times and then we also have a real two
rectangle behind our main body of text
and if we remember our application was
completely right you know we're not
using any background color so anything
else whatsoever there's clearly
something going on that we can optimize
here so let's have a look at the
hierarchy view and see how we can use it
to to figure out what exactly is going
on here so here's our hierarchy viewer
here's our linear layout that defines
the right-hand side of the application
the the details fragment and you can see
here that we have a white background
behind the behind the main body of text
so that's that's the problem because we
already have a main background defined
in the application so this is something
we should investigate a bit further if
you click on the article boy down here
you can clearly see there's a white
background behind it so that's one way
you can see what's being drawn on-screen
another really useful feature is the
option to export your entire view layers
as a PSD file
so as this option up here and if you
click that you can save all window
layers as a Photoshop file and I've
already done this here if you open up
Photoshop that's what it looks like and
each of the layers in your view that's
visible on the screen
it's also visible in your in your
Photoshop file so down here we have two
decor view and that's the main window
background so if you turn it off you can
see there is still a lot of light but
the window background already was right
that's a bit strange and here we have a
linear layout that has a white
background it's again a bit strange if
another linear layout see this is coming
from each of our least three items and
again there's a background right here so
this is one way that you can use
hierarchy viewer to to see how your
views are drawn on on the screen another
really useful future I would like to
show you is this year so we have our
preview here that shows you what's this
particular view actually draws to the
screen and if you double click on this
you get you get a bigger view but you
can also change the background color of
that view so in this case because we
have defined virus or background color
for this layout for linear layout you
won't see any changes but this can also
help you to see what's transparent was
not transparent in your application so
let's fix this you know we don't need to
define the background multiple times so
if you look at our code let's go to
Android studio and the first thing you
want to fix up is the main background so
we had our two panes and if we remember
the wall suddenly our layout and all we
had a background so let's let's get rid
of that one first so that's coming from
the activity through pain XML and up
here you can see straight away we are
defining a background color you don't
need that can you get rid of that the
next thing we had we had a background
color in our article detail view you
know have it the body of text at the
bottom so let's get rid of that here as
well
color white let's just remove that and
then lastly we also had a background
color for each ListView item you know
the list of in the list of bacons on the
left hand side and our background is
actually it's selector drawable and you
can see here we have different states
depending on if the particular item is
active this is how we are indicating
which article you're looking at in your
in the application and
here on the in the M and this Straubel
down here is the one that's used by D
for when it's in a neutral State and
again it's white but we can just make
that transparent and there's actually a
transparent color that you can use you
can just from the framework so we can
just make that transparent and if you
run our application again you will see
that we have much much less overdraw so
if we go back to our device let's just
wait for it to compile and here is you
know the the green rectangle we had
behind our caption text is gone this is
looking much much cleaner that's you
know there's no Verret there's only a
few blue spots there we have text that
we actually to draw to the screen so
it's much much better so you've seen how
you can use the over draw setting the
developer options and the hierarchy
viewer to investigate over to issues in
the application so I suggest you just
enable setting and open up your own
application to see how you can optimize
it further</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>