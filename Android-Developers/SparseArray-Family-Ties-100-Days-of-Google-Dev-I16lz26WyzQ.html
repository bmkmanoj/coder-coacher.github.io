<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>SparseArray Family Ties (100 Days of Google Dev) | Coder Coacher - Coaching Coders</title><meta content="SparseArray Family Ties (100 Days of Google Dev) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>SparseArray Family Ties (100 Days of Google Dev)</b></h2><h5 class="post__date">2015-08-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/I16lz26WyzQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">our boxing is one of those weird
patterns in your application sometimes
it's not really a performance problem
but when it is wow does it chew through
your memory and performance my name is
Colt McAnlis and thanks to the Android
runtime you can avoid one of the largest
causes of auto boxing issues hashmap
containers now auto boxing is a process
where the runtime automatically converts
a primitive type to its corresponding
generic object type but this is bad for
two reasons firstly is that auto boxing
will generate an allocation of an
integer object for any type of
conversion it uses and secondly these
generic objects are larger in size than
their primitive counterparts a 16 bytes
for an integer object rather than 4 for
a primitive meaning not only are they
allocating objects but those objects are
much larger than they need to be now
typically this isn't a big problem for
your average computation but where it
really gets you is when dealing with
generic containers like hash map I see
when using a primitive types like a int
float and bool hash map has to use the
object versions so instead of being able
to use a simple 32 bit int a hash map is
forced to use a generic integer objects
which of course eat up more memory and
you need to be careful here because any
time you fetch a primitive from a
generic container autoboxing happens
there as well now memory matters to
Android and a safe space the Android
runtime provides a whole family of
generic containers built specifically to
provide the functionality of a hash map
but allow you to use primitives and
avoid auto boxing welcome to the sparse
array family a sparse arrays are
basically like array Maps and they
reduce the overall memory footprint by
using too tightly packed arrays rather
than one large one for hashing but it
also comes with some overhead for
fetching objects so they're really only
useful for containers with hundreds of
objects rather than thousands or
millions the main difference between
sparse arrays and array Maps is that
it's for sparse arrays the key object is
always defined primitive type rather
than a generic allowing you to save
memory and avoid auto boxing but in
reality the differences stop there like
array Maps you can also iterate over
sparse arrays using indexing rather than
the iterator pattern which is required
by hash maps and is also significantly
slower and takes up more memory to do
and also like array Maps it's not wise
to use these Optima
sparse array family containers in every
single case but there are some perfect
situations which you should consider
number one situations where you have a
small number of items in the hundreds of
lots of accesses and where the accesses
themselves are infrequent enough that
the overhead for a fetch isn't noticed
and number two situations where we have
containers of maps often it's a map of a
map of a map where the sub map says you
get farther in that stack tend to have
smaller number of items and we also end
up iterating over those sub Maps a large
number of times if your use cases don't
fall into either of those two buckets
and then it might be best to stick with
the hash map class instead of one of
these fancy awesome alternatives which
highlights a very interesting points
optimizing performance is a constant
trade-off of finding the right container
for the right usage pattern for the
right memory cases as someone said
there's no silver bullet which is why
you need to check out the rest of the
Android performance patterns content to
get more information about these types
of trade-offs and don't forget to join
our Google+ community as well to hear
war stories from other developers so
keep calm profile your code and always
remember perf matters
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>