<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>DevBytes: Android 4.4 Immersive Mode | Coder Coacher - Coaching Coders</title><meta content="DevBytes: Android 4.4 Immersive Mode - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>DevBytes: Android 4.4 Immersive Mode</b></h2><h5 class="post__date">2013-10-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/cBi8fjv90E4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello I'm Roman Nurik from the Android
developer relations team at Google in
today's day byte we're going to take a
look at the new immersive mode feature
in Android 4.4 KitKat this feature lets
your apps go truly fullscreen let's take
a look so before we talk about immersive
mode let's recap all the different
fullscreen API is that were available in
previous versions of Android now there
are two sets of API is for fullscreen
the first is a set of window manager
flags such as flag full screen that you
can set or unset to show or hide the
status bar now these work on any version
of Android and remain active even if you
navigate away from your app and then
come back the second is a set of system
UI visibility flags now the difference
with these flags is that they're only
available in newer versions of Android
since about Android 4.0 or later
additionally these flags are clearable
by the system so if for example you
navigate away from your app and then
come back these flags will be cleared
and you'll have to reset them so the
first of these new flags is low profile
and this simply dims the status and
navigation bars when it's set the second
is the fullscreen flag and this behaves
basically the same as the window manager
flag it simply hides the status bar now
the big one here is hide navigation
which hides the navigation bar
temporarily for those keeping track the
navigation bar is the one that consists
of the back home and recent buttons and
it's only available on some devices on
some devices the navigation bar isn't
present and all you would see are our
soft keys like back menu and so on now
once the hide navigation flag is set any
interaction with the screen will show
the navigation bar and the touch events
that cause that navigation bar to show
will not be passed to your app this is
an important point to keep in mind when
we talk about immersive mode in just a
few seconds now one more point before we
move on there's a bunch of these layout
flags that control how your screens are
laid out
setting these flags allow your content
to appear behind the system bars this is
especially important when users can
toggle the bars in your app setting
these flags will keep your content from
jumping and resizing in response that
the bar is showing or being hidden so
let's talk about the new stuff Android
4.4 introduces two new mutually
exclusive system UI visibility flags and
their immersive and immersive sticky
let's look at a demo of the immersive
flag first
so to my left you see the simple demo
app now when we touch the content you'll
see that the immersive system UI
visibility flag along with the hide
navigation fullscreen and some layout
flags are set
once you enter immersive mode within an
app to get back to the system UI you can
swipe down from the top of the screen
the system also automatically presents a
reminder bubble to the user the first
time they enter immersive mode in your
app so here's a quick example of that
reminder bubble now an important point
here is that your app can now capture
all the touch events allowing users to
say plain immersive game or scroll
through content without the described
distraction of system bars so you'll
notice here that you know first I can
actually swipe down from the top of the
screen to reveal those bars and then if
I actually start interacting with the
middle of the screen you'll notice that
the bars actually stay hidden and this
is the big difference between immersive
mode and just setting the hide
navigation flag so one important point
here is that swiping from the top of the
screen clears those flags so if you want
to say hide them again after say three
seconds you can set up a system UI
visibility listener which we'll talk
about in a second and then three seconds
later cause a or set the flag again to
hide them so let's look at some code
first we'll use our windows root view or
the decor view as the anchor for system
UI visibility you can use any view so
long as it's visible now the next thing
you should do whenever you use system UI
visibility flags is you should set up a
listener to watch for changes
because the system can actually clear
these flags in response to user
interactions you want to be kept aware
of when that occurs now in this case we
simply show or hide additional UI
controls such as video playback controls
when the system bars are shown or hidden
and now keeping all of your UI controls
in sync with the system bars is the best
practice
to minimize the number of states that
your app can be in resulting in a more
seamless user experience to actually
show or hide the system bars you can
either set or remove the right set of
flags to hide the system bars and enter
immersive mode use the hide navigation
fullscreen and immersive flags in
addition to the layout flags that we
talked about before to show the system
bars just set the layout flags making
sure that the content doesn't jump and
omit the visibility flags like
fullscreen hide navigation and what that
will do is that I'll actually show the
bars and generally you'll want to auto
hide the system bars after a period of
inactivity we won't go through all the
details here but basically you want to
use a handler with delayed messages for
this purpose you can also clear messages
to make sure that any pending highs or
Auto hides are cancelled if need be
additionally you should handle the case
of window focus changes if you gain
window focus you may want to rehire
you lose window focus for example due to
a dialog or pop-up menu coming up you'll
probably want to cancel any pending auto
hides so for example if you're watching
a video and you press the action
overflow that shows up a pop-up menu
you'll want to prevent the case of three
seconds after you show the action
overflow the system bar is an action bar
hide automatically closing the action
overflow so this will help you prevent
that
lastly you generally want to allow users
to manually toggle the visibility of the
system bars by touching your content
especially if single touches don't do
anything else in your screen to do this
you may think of just using a simple
click listener now the problem with this
is that click listeners are fired even
if you drag your fingers across the
content after pressing down you probably
don't want to do that
instead you probably want to use a
gesture detector like shown here and
handle the on single tap up event this
makes sure that if your users finger
moves more than just a little bit during
the touch it won't toggle the system
bars next let's look at the immersive
sticky flag now in this mode almost
everything is the same except when you
swipe from the top of the screen so
here's that demo again and you see the
same bubble now if you swipe from the
top of the screen you'll notice that a
couple of things are different the
system bars will show up in a
semi-transparent state as you can see
here and the system bars will
automatically hide after a short delay
or if the user interacts somewhere with
the middle of the screen now the third
thing that is different is that the
system UI visibility change listeners
that you created before will not be
triggered because this state this kind
of temporarily visible system bar state
is intended to be very transient and
your app should basically be completely
unaware of this and last but not least
the system will not actually clear this
flag so when you when the user swipes
down from the top of the screen those
flags will stay there they won't be
cleared and this gives this flag the
sticky name now the code for immersive
sticky is really simple anytime the
window receives focus simply set the
immersive sticky flag along with the
other flags mentioned before now you
don't have to worry about the system
clearing this flag due to user
interaction because again the flag is
sticky okay so let's summarize with some
use cases when should you use these new
Flags so if you're building a video
player or something else that requires
minimal user interaction you you'll want
to use something called the Leanback
approach and this gets its name from you
know you start watching or you know you
turn on the content and you lean back
and you don't really do much else with
the screen now the Leanback approach has
been available since Android 4.0 it's
been refined in jelly bean Android 4.1
and so on and it simply involves using
the fullscreen and hide navigation
system UI visibility flags now in this
mode in this lean back approach
any interaction with the screen will
automatically show the system bars and
other playback controls that you've
defined now if you're building something
like a book reader or magazine or
something that has a little bit more
interaction you'll want to use the new
immersive flag in addition to full
screen and hide navigation in this case
swiping up from the top of the screen
should reveal the system bars in
addition to your own UI chrome lastly if
you're building something truly
immersive such as a game or a drawing
app you may want to use the immersive
sticky flag in addition to the full
screen and hide navigation flags again
as we talked before in this case swiping
up from the top of the screen will very
briefly reveal the system bars in a very
very transient State
so that's immersive mode in Android 4.4
KitKat check the video description on
YouTube for links to the sample code
thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>