<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Game On!: Game Physics with Liquid Fun | Coder Coacher - Coaching Coders</title><meta content="Game On!: Game Physics with Liquid Fun - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Game On!: Game Physics with Liquid Fun</b></h2><h5 class="post__date">2013-12-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Khngnjhnpjo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello game developers and welcome to yet
another exciting episode of game on I am
Todd Kerpelman I'm a developer advocate
here on the Google Play games team and
here with me today of wool is Wolff
Dobson developer programs engineer also
on the Play Games team and he is here to
talk about one of my most favorite
things in the whole wide world and that
is physics engines so Wolff want you
take it away all right so today we're
gonna talk about liquid fun this is our
brand-new open source physics engine
that we've just released cross-platform
in C++ very exciting mm-hmm so first
thing we should talk about is where do
you get it and our producers here I've
added a link that you can click on that
will take you straight to our github
page and in this little chat here we're
gonna do an overview we're gonna do a
little some demos and we'll even talk
about a little code so first let's talk
about physics engines what's a physics
engine well it's your favorite thing in
the world oh that's right so a physics
engine is the mathematical simulation
that helps you create procedural
animations filled with physical bodies
so in a game you're simulating per frame
and the system divided times into little
slices and updates on all the objects
each frame based on their positions and
velocities so if there are conflicts
like collisions then the system resolve
those safely the most basic physics
simulation you can think of is actually
pong with a single body it's moving
around bouncing off against two paddles
yes that's true this is obvious a little
bit more complicated liquid fun that
we're providing is just a numerical
simulation we have a little simple
visualization but in your game you're
gonna want to add art sound story and
all the rest red stuff so this is just
the mathematical so like like in a you
know model-view-controller kind of
analogy this would be the model this is
telling me where everything is in my
game but it would be up to my game to
actually take that information and turn
that into something on screen that I
would present to my player exactly all
right
so this is a superset of box2d box2d I'm
sure you've heard of box yes it's it's a
very popular physics 2d physics engine
developed by Aaron kado I believe and
it's used in like just about any game
out there that uses physics I know Angry
Birds is it anything with 2d physics has
a pretty good chance they're using box2d
if your game uses box 2d you should be
able to drop this engine in it will just
work so just as a view this is our the
typical whoops this is our typical
piston demo here that shows just rigid
bodies interacting with each other and I
mean this is demonstrating a lot of
interesting things right it's sort of
demonstrating like well first gravity
and also momentum and I guess you would
see like angular momentum if that joint
stew on the thing and motors turning the
thing this is all very standard box 2d
stuff the the sort of special sauce
we're adding with liquid fun is
obviously particles hmm yes so let's
look at some particle demos this is a
whole bunch of particles and a giant
rigid body slamming into all those
particles Wow
yeah it's a lot of particles they had
thousands and thousands of particles
running around inside there and this is
an active simulation so if I grab hold
of this I can kind of I can kind of swim
through this and push these guys out of
the way I can touch groups of particles
and throw them around it's pretty cool
yeah because normally when I think of
particles I think of them used for like
sort of visual only effects like fire
and smoke but I guess what you're saying
is particles could also be used for for
generating things that look like water
yeah exactly and and these particles are
actually and these particles can
interact with the entire rest of your
physical system and this is your typical
wave machine you can actually see kind
of wave physics going back and forth as
it swims around gotcha and so I mean
basically this this engine is simulating
each of these thousands of particles
individually and sort of by by grouping
all these behaviors together you get
something that suddenly creates waves
yeah it looks like water it's pretty
neat yeah that's cool
so as I mentioned before the engine is
cross-platform it's written in C++ and
we've provided builds out-of-the-box for
Android NDK obviously we also have Linux
OSX windows and people can feel free to
contribute to whatever other platforms
they want to add gotcha so there's a
pretty good chance I could add this to
any mobile game I wanted mm-hmm all
right so this is kind of way out of
scope but we'll talk a little bit about
how physics engines work so in physics
engine you basically create a world you
add some rigid bodies to it
so here circle and triangle you might
add some joints to connect them and then
you stop the simulation for it and in
this case since there's nothing
supporting those guys they're just gonna
they're just gonna fall no but the again
the secret sauce with liquidfun is that
we're adding very large numbers of
particles that can interact with these
rigid bodies okay so what makes a
particle different than a rigid body so
particles are the smallest unit of
matter that can interact with thing they
are they act like rigid bodies but they
don't have rotation so we consider them
uniform circles and they are sort of
packed intelligently in the system so
they can be rendered and simulated very
quickly okay rigid bodies basically are
going to be slow and expensive and
particles are small and cheap so by
basically placing a few limitations on
these things the engine is then able to
render hundreds or thousands of them at
once thousands okay so particles come
with basic physical characteristics like
color size position velocity color is
for your reference when you're rendering
them they don't actually it doesn't have
actually have any effect on the
numerical simulation I can i can ping
the model and say hey what's this what
color is this and then also strength so
if you have particles that are Kohi
that are sort of stuck together like
viscous particles you can say how strong
you want that viscosity to be okay
and as noted there's no rotation for
particles so if you rendered them as
little like top hats the top hats would
always be facing up even though
thousands of them are smacking against
each other
gotcha so as a general rule you probably
don't want to render them as it's
something that anyways where you would
notice it doesn't rotate yeah exactly
in fact most likely I might kind of
apply some sort of filter to kind of not
show the individual particles but kind
of group them together so I might see a
big wave or something no actually in
these simulations we were just sort of
rendering a Gaussian spot and as lots of
them are as they sort of the spot is a
little bit bigger than the body and as
they kind of overlap each other you can
you get this sort of areas of they look
kind of solid okay so here's the code
for creating a particle if you use box2d
before this should seem really familiar
you create a particle def you can set
some flags on it and you can also set
its position and its velocity but not
its rotation and then you tell the world
i'd like to create a particle using this
definition what is that elastic particle
there mean so elastic particles are
springy particles they're particles that
are that are connected together like a
jelly we'll see one in just a minute all
right we'll see a lot of elastic
particles in just a minute particle
group is created by instancing sets of
particles together in a different in a
shape there ways for you to create and
destroy lots of particles at the same
time so you can set all the regular
properties like velocity and position
but you can also add the rotational
angle if you have one of these jellies
you can also set sorry you can even
rotate the shape and then you can set
the rotational velocity as well if you
have one of these jellies okay so
particles don't have rotation but a
particle group does have a rotation if
it's if it's an elastic one yeah okay I
think I think you're gonna need to show
me a demo I think we're gonna show it mo
all right so creating product groups is
again should feel pretty familiar to
box2d people you create a shape you
create a particle group definition
object and then you instance the group
with that so what is the shape here mean
a shape is a bar
to be primitive so it's gonna be like a
polygon so you can make a circle you can
make a John square you can make an
l-shaped you do it okay and is the idea
these particles have to fit into that
shape all the part of it will create
particles with the density in the shape
that you specify hmm okay I'm a little
confused maybe maybe maybe can go
through this code and let me know what
you mean right so you can see here we
have the particle group definition and a
shape the shape is just a box and then
the on the particle group definition
we're saying you know look at this shape
we're setting some flags on it its
initial angle its initial angular
velocity and that's the angle of the
entire shape that we're setting and then
we're instancing five groups of these
all at once so you're creating I see
you're creating five groups of of square
shaped particles but then within these
you're not
you do need to then create the particles
that are attached to these shapes no
when you say create particle group you
just pull human since all these
particles at the same time okay and so
that's kind of that's where the shape
definition comes in is it's creating
these groups that that essentially fill
this shape yeah gotcha
and the the density of particles within
that shape is that something that I
would specify or yeah you can say you
can set the particle size okay so I
don't need to have like two for nested
for-loops that create I'll just you just
make a shape and and it will fill it
with well that makes a whole lot more
sense all right so if you want to
destroy particles as a group it's pretty
easy this code example here walks the
entire list of particle or the entire
list of groups in the world and just
destroys all of them this would be like
a simulation shut down step
if you the particles in the groups can
interact with each other but then you
can kill the groups on Moss so let's say
I have two groups here and I mix them
all together and they form this you know
giant message I can then say kill Group
a and like half my water will suddenly
disappear exactly huh so I guess you got
to be careful about using that to make
sure that that's actually the side
effect that you want
exactly okay once you start pulling
those together they become international
yes particles have a lot of human
behaviors by default they operate as a
simple liquid but you can add these new
particles like elasticity with a with
flags so let's let's show some demos
here okay
so first I'm going to show you a set of
particles that are elastic so here you
can see they're kind of acting like
jelly and if I grab any small collection
of particles and move them the whole the
whole body moves at the same time gotcha
and I can see they're trying to keep
sort of their original shape but they
can still be deformed if I drop objects
on them they're gonna they're gonna sort
of deform to accept that and so these
were created by particle groups mm-hmm
yeah this has a shape that's a circle
the other has a shape that's a rectangle
you give them elasticity which means
that they are springy and they cannot be
broken apart right okay so that would be
useful for like if I wanted to create
bouncy balls or just fun looking jelly
types of things like somehow yes is such
a cool jelly and somehow it's important
for my game to make sure that this is
still one solid object it doesn't get
broken apart right okay
so here's an example of particles that
can color mix so this is a regular fluid
but as the particles brush against each
other it averages their color as they as
they as they rub so you can see the red
and green turned into this yellow on the
left and if I kind of if I kind of mix
these whoops I kind of spilled if I mix
these I can I can kind of bring the
green
a blue and get kind of a uniform light
blue gotcha and so these colors
basically mix just based on because I'm
when they touch yeah so I could like
let's say as a developer I could use
this if I wanted to like you know
measure like some hot water and some
cold water or something and like yeah
you can I would just sort of ping the
color as sort of a way to represent how
hot or cold these things are sure okay
and so I've noticed these break apart
brazen so these are not elastic
particles no no these are these are
regular fluids okay and lastly here are
some viscous fluids flowing through a
maze and then we have a couple of little
pumps that are kind of moving it back
and forth and you can see I'm getting
this sort of blob down here in the lower
left mm-hmm
and also if you look up at the right you
can see I'm applying a constant force to
this pump and it can't compress these
this viscous fluid enough so it kind of
bounces off of it sort of like real
water I guess exactly and then down at
the bottom oh there it fell by itself I
can use this to sort of pump water
uphill and and knock the knock this
other rigid body into the into the drain
and so by saying these are viscous what
you're basically saying is like these
have some amount of surface tension
mm-hmm yeah there's probably want to
stick together this gives me more
realistic looking water than if they if
they were not like it would probably
look like sand if you did not have this
visit yeah he turned on yeah they would
look it would look more it wouldn't it
wouldn't you couldn't go here as much
you wouldn't end up with the as many of
these sort of big blobs gotcha
and the more and more viscous kind of
the yeah and you were like toothpaste or
yeah exactly
all right and the maple syrup I'm trying
to think of yeah yeah something like
that
okay and we have more particle behaviors
besides besides even these like powder
and tensile and wall and things like
that what do those need powder mean so
powder would be something like smoke it
be things it doesn't stick the walls
very well and it doesn't want to stick
to itself very much at all so as a
powder you can read more about all these
in the in the user manual that we have
and speaking of our user manual
come on by to our github page join us we
have a discussion group and we have a
programmers manual and we have an API
reference and we have a whole thesaurus
so cool
so what's the what's the license on this
you said it's open-source mm-hmm it's
open-source you can pull it into your
game right now and publish it and that
would be great
awesome well that sounds like a very
useful thing mm-hmm
why are we giving this to the world wolf
because we want to make games better oh
that's a good idea we want to make
people's games awesome all right well
this seems like a good start
I'm as someone who is a big fan of
physics games I encourage you all to
take a look at this and start adding
crazy-looking jelly things to your game
there's probably a whole probably a
whole world of like water and jelly
games that we just have a onra of jelly
again just waiting to be discovered and
so maybe that will be you yeah seriously
check it out I think the physics engine
always defined really interesting
because it's like a very complicated
system where you can have a lot of kind
of rich behavior and create a lot of
really interesting rich puzzles but at
the same time like you know a
three-year-old intuitively understands
how everything in the world is going to
react well I think it makes for a really
good game design I think why there's so
many good space game designs out there
it's really a sandbox for emergent
gameplay
unexpected things happen when you put
physics together and that makes a little
surprising and fun or you could you know
really just kind of make this wave
machine and I'd watch that first several
hours yeah this you get hooked just
looking at these things
so you said OSX can I make a screen
saver using this stuff if you want to
awesome all right well I know what I'm
doing over the winter break all right
well thank you everyone for joining us
take a look at what we've got in our
github page I think it'll be pretty
interesting and we will see you all in
in a week or two</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>