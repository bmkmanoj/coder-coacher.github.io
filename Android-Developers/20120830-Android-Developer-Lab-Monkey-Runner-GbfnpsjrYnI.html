<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>2012-08-30 Android Developer Lab+ - Monkey Runner | Coder Coacher - Coaching Coders</title><meta content="2012-08-30 Android Developer Lab+ - Monkey Runner - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>2012-08-30 Android Developer Lab+ - Monkey Runner</b></h2><h5 class="post__date">2012-08-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/GbfnpsjrYnI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in about the delay about this this to
this week Android ADL class show and my
name is Tony Chan and I am a developer
advocate for Android I babe I'm based
out of Hong Kong and today I have anyone
here joining us for the wait for the
show anywhere yeah hi everyone I'm
Manuel from Hyderabad I know we are
missing a regular uncle today it's just
gonna be me and Tony today so let us
give you a brief introduction on the
format of adl+
which is presented to you by the APAC
android team here so we're gonna do a
brief presentation on an interesting
topic that we got a big daily every week
and then this will be followed up by the
Q&amp;amp;A of the questions you've been asking
us on the moderator so anyway is the
slide showing up fine yes it is thank
you Tony
great alright so we will kick off the
will kick off the presentation so first
we've got news and I let Tony present to
you the news
okay so we have trouble news this week
and the first one we we didn't mention
after last week as Playstore is now
having gift cards and it's now available
in the US and hopefully we can make it a
bit more better go in other countries
the other give you other news on events
we we have a GDG Google developer group
event tonight in Hong Kong and coming up
we have India in India in New Delhi we
have an event from a gap Kochi India is
on the September 4th and 5th and
anywhere and I will will we have a sash
two sessions actually talking about
Android on the fifth okay so I'll pass
it back to you anywhere to to do the
presentation for today all right so this
week we're gonna be talking about monkey
runner it's a do matters president in
the Android
DK tools folder it's not related to the
monkey tool which is used for stress UI
testing so monkey learner is a different
thing it's a it's a tool that provides
you an API and we will see how we can
implement quality control other
application using monkey rather so we
move to the next slide right so like I
said monkey runner provides an API for
interfacing with devices what this means
is that you can connect two different
devices or emulators available attached
to your system and you can basically
send commands and inputs and we'll see a
detail what we can do so it uses jython
which is an implementation of Python
that uses Java programming language so
it's a there are multiple options unable
to you in all you want to run your
script you can go to an interactive
session or you can actually write a
complete script and run it to the two
that we provide so also it's important
to note that the code runs on a
different device that it's it's running
on your workstation where you have the
SDK and while running on your machine it
controls the attached devices so it's
not actually running on the Android
device next thing is let's look at some
of the capabilities of monkey alert so
like I said first it allows you to
connect multiple devices not just one
you can actually connect multiple
devices it can launch application and
activities it has api's to help you do
that to send start activity and send
podcast events you can also send touch
events and keystrokes which means you
can provide input to your running
applications sort of a remote way to do
that also there is a API to help you
take screenshots so you can grab some
images of the applique of your
application running on the phone and you
can script the above operations in a
sequence of commands so you can just say
do this and then sleep for some time and
then watch the activity sleep again and
so you can write a complete script and
run it okay so let's move to the next
slide so since this session is dedicated
on quality control
capabilities let's see what monkey
learner can do or so basically there are
there are two ways you can perform
testing on your applications using
monkey learnin
the first one is a functional testing
and like I said you can write a scrip so
it gives me a fully automated test
procedure where you can perform an
end-to-end test on your application you
can also execute use cases which are
interactive with input events
the second thing can allow you to do is
do a regression testing so I mentioned
that you can take screenshots from your
application using monkey runner so what
we can do is once you have a good build
and you've done functional testing with
a good bill you can compare this with
your daily bill by taking screenshots
and comparing the screenshots to see if
your UI is working fine so now we will
look at some of the key API is as in the
code packages and modules available to
you so the first one is monkey alright
it's the most important model it
provides you static utilities to help
you obtain a device or obtain our image
or a connection the second is a device
so once you actually have monkey run are
giving you a device object you can use
the device object to the present which
actually represents the attached device
an emulator and in track starting
tracking with that device and third one
is monkey image so this represents an
image that you have crap from a device
or emulator using them take snapshot API
alright so here's how you can launch a
monkey on an interactive tool if you're
now looking at how to write some code in
monkey donor so you can see this is
present in your Android SDK tools fonda
tools folder there's a there is a to
Tirana so this is as soon as you launch
the story you will see an interactive
session much like the Python shell so
this is where you can start you know
doing a kind of hacking your way through
monkey Learner exploring different
api's the other way is to write a script
so when you actually write a scrip
procedure is the first thing you want to
do is when you have or when you have a
monkey runners script running first
thing you want to do is connect to a
device and this is John be done with one
of the static unit please available in
market owner and this is Wade for
connection so once you do a wait for
connection this this this API is a
blocking call and will return me back a
monkey device which represents the
device attached so once you once you
have a connection to a device what you
want to do is install your apk now like
I said this is an end-to-end test
procedure so we're gonna we're gonna do
our build using or pin system and then
we have an apk that we watch the multi
and ask where to install the apk package
onto the device and like I said you can
have multiple devices and not just one
device if you are testing different
configurations you can actually do this
for multiple devices so you you do a
call through install package onto the
device giving the part to your full apk
and this will help you store the package
on to the device and once you install
the packages what you want to do is
probably launch your main activity and
all that is available the API here is
start activity and you pass the
component which is your which comprises
of your package name and the main
activity so putting it all together you
can see how it goes this is a small
strip that's actually importing some of
the modules that we talked about there's
a monkey runner there's a monkey device
and a time module to install to to
basically allow the device to sleep for
some time so that if you are installing
the device and it's going to take like
five ten seconds to install the APK onto
the device you wanna do a sleep
meanwhile before you execute the mix
come on so this is the this is the
module to help us with that so as you
can see the first car there was monkey
monkey runner dog bed for connection and
yeah the teeth the three things that we
just discuss on how you wanna begin
testing alright so what
once you've installed the a begin we got
your main activity on monkey Anna you
want to do is what you want to do is an
automated way we want to send some touch
inputs or type text or send input so
this can be done using a touch using a
touch API and when you send in x and
y-coordinate of where you want to
generate the touch email and the type of
touch so for example this can be down
and up so this is a touch where you
press down and up and then there is a
type text which is which is basically
used if you have an input field on the
screen and you wanna put in some text in
an automated way so as you can see now
we can now we are executing our use
cases how we want to test our app using
some of the monkey mother in Korea api's
alright so so now we begin we've
installed our apk onto the device we've
we've launched our main activity and
we've sent some input commands and we're
going through our screens so at this
point for functional testing what you
want to do is take a snapshot this is
basically it's gonna give you a
screenshot of the of watch on your
screen right now in your device or
emulator and as an image and the object
that's representing this is the monkey
image and you can write this to a file
for if you want to do regression testing
if you want to see that if something has
changed between my last film than this
you can compare the images from take
snapshot using this so here's a tip
there's a there's a very popular program
imagemagick and there has a compare
utility so you can run this program and
it can help you compare images and
doesn't aim regression testing so now we
going to look at the script altogether
so you see the complete script and this
is all available in on the Android
developer website so if you go there and
look for tools and Marty are you gonna
see a lot of the API is and links and
documentation so this is a this is a
script from from the website and as you
can see this just puts together what
we've been doing so we install a package
we run the main activity and then
we start the activity we we send a key
code menu which is which is just
pressing the menu button onto the device
and then we take a snapshot on how our
menu item looks on the screen and then
you just write the file to a disk so
over a simple script something you can
start with image you don't want to run a
script what you can do is just like I
said mentioned you can go to an
interactive shell and using the
interactive shell you can just start
typing device not touching forth here
and there figure out your buttons figure
out the X&amp;amp;Y positions and then write a
complete script that can be controlled
so so these are what we discussed ways
of doing functional testing which is
executing your use cases remotely in a
in a automated way using scripts but
there is more to monkey rather than
functional and regression testing so you
can also extend the API by writing your
own plugins in Java language there are
some utilities like device thought shell
it's a monkey run at a why you got shell
which thinks n80 become a sphere device
we can also use the standard Python sub
process and OS modules to launch
external programs and again like you
think launch ADB and send commands to
ADB using this uh process and OS modules
and again there is also a java api which
is available as a smokier or jar and
this is this this jar file is present in
your to slurp folder of sdk and it also
has a program sample swing app Java
swing app that that basically allows you
to remote control your device using
using a screen shot grabbing utility so
it grabs a screen shot every five
seconds and you can click on somewhere
on the screen shot and it figures out
the X&amp;amp;Y from the from the sample app
this swing app and then it sends the
same coordinates to generate attach on
the actual device using java api so
that's another example you can look at
yeah so so let me just summarize here of
what we have discussed is using monkey
runner tool as a way of
quality control in application as a way
of controlling multiple devices in a
test environment where you can execute
your test cases and end-to-end test
cases and you can also extend this API
so with this we come to the end of monte
other presentation if you have questions
about this please feel free to ask us
now if you join the hangout or you can
process questions on the next week's
more Google moderator link for the for
the area plus show and we will
definitely answer your questions there
so but this will move to this week's Q&amp;amp;A
and Tony if you can yeah sure thanks any
word for showing us the monkey runner so
we have quite a few question this week
and so let's start talk about some of
these questions so the first question is
from Ivan so there is a serious memory
really in map view that cause crashes
when useful map in one direction for
some time with the link it's not yet
softened first path submission was like
three years ago is there any hope that
this will be solved so we understand are
the the map the map view is a chemical
update and we we are aware of that and
we're working our engineering team is
working to improve that but at the
moment we we don't have any thing to
share but unfortunately if we have
anything we can advance know as soon as
possible so the next question anywhere
can you take the next question
sure so the question is why can't
Android app developers from India and
China and they're absolutely doodle apps
Google job market I guess what you're
referring to this is a Play Store what
are the alternatives available for such
developers will this
should be ever lifted ifs when alright
so so I'll talk about India and then
later Tony can talk about China this is
more familiar with that market there so
what are the alternatives available to
such developers to begin with I want to
mention that as the developer you can
still register a developer account with
Google Play and you can upload your apps
and they have to be free apps for now
which is a restriction but you can still
use some of our ads offerings for
revenue that's one option
an alternative to for revenue the other
one is I know some developers actually
have bank accounts and different
countries which allowed for selling apps
or do the Play Store and you will have
to probably consult your tax consultants
and to figure out if that works and but
I know some developers actually do that
the other alternative available to you
is to find a partner in a country which
actually has access to the to the play
store to sell apps there and enter into
a partnership where you can you can be
the developer and the partner can take
care of the distribution waves of the
application so for China is a sponsor
similar issues by getting payment enable
in countries informal of policy and it's
more than just technical issues so again
again but as anyone mentioned we see a
lot of developer they have partnership
or business partners in in countries
that we do a lot of we do support Google
Wallet and that's how they they selector
the developer account and in in China
that will be this in similar situation
so yeah so the next question is are
there any restriction in Google Play
preventing application being served by
charity to source donation
I have revealed a Google Play Terms of
Service and not found any obvious issues
so so in general what Steve mentioned is
correct
so there's no policy on the Google Play
site to defend developer to create apps
that sauce donation that said for Google
Wallet does have certain policy in terms
of receiving payment for donation and so
you have to be a u.s. 501 C 3 or our c6
nonprofit organization and and there
there is a process in order to receive
donation you have to we have to worry
about you are you are certified don't
carry organization as you claim you so I
think in short light you have to be a
501 C 3 or 6 organization so the next
questions are anyway yeah so the
question is from Jay Dixon what Western
Australia I have 8 plus years of Java
dev where I'm new to android I wrote
this and it's something to do a spinor
example on the difficulty I had mappings
when our user to system values without
right did I miss something so I didn't
take a brief look at the thing that
you've shared went through some of the
code n nodes and it looks fine for what
you're trying to do there but yeah and I
also mentioned in your example that one
way to do that is to actually use a
system resource with from string store
XML you use an area to map into spinner
which is what we see very commonly use
and you can use that so I see what
you're trying to do was attach some
listeners so you can do some length
checks and actually the system menu
which sounds fair this
to me but yeah it's very simple to use a
spinner with the with a with an area
from your streets or XML or from a data
source from adapter from a data source
it's it's pretty encoding we have some
examples on our on our
developer.android.com website yeah cool
thanks and so Steve just back to your
donation question so I just noticed you
are from Melbourne so so if you are
interested in our help creating apps for
international international charity that
maybe I need to check with the Google
Wallet team and see whether we allow
that so if you're interested to find out
for nonprofit organization outside of
the US sent sent us opposing G+ or semi
opposed we can follow up with you so the
next question I have here is from
William so how do I get a user identify
for an in-app billing transaction so
that I can collate and manage
transactions on my server identically
just need to be unique with my app but
needs to spend multiple devices and no
Commission beyond Google Play so I think
Billy mentioned quite feel like key key
points here just for general audience
benefits on Google good in Google Play
we have two types of each other
in-app purchase products so one is we
call a managed products and another type
is managed products so for the manage
products Google Play server does
actually manage the user to restore like
other information if if someone will be
installed again and developer in the
application call and call the week or
transaction
methods in in the in-app billing API to
retrieve all the people PDS like
purchase items so that's done taking
care of in the API but what William
mention is those unmanaged item which is
not managed by Google in that case I
think our general recommendation is not
to create any that unique identifier has
to be something like we recommend using
give you ID and and we actually have an
article if you search Google search for
they talked about how to identify a user
and we specifically discourage user to
use device ID or IMEI like things like
that or even the Android app ID which is
with the OEM depends on the
implementation of oh yeah and it could
could not be may not be unique so you
your ID is the recommendation I guess
the key question is how do we persist
that UUID and how to retrieve that
information when whether user signing to
to the to a new device so something is
coming up soon is what we call Google
place this and and Google Play service
we will have an implementation of all of
- as well as a Google+ API and with
OAuth to you it will be very easy for
developer to to talk to a lot of the
Google divin api's at Google so one just
idea is we you can store the UID or that
particular user on Google Drive and
using OAuth 2 or medicai and then
you can you can you can retrieve the ID
and and use that to to connect back to
your server name deserve ling-ling the
user to retrieve all the necessary
unmanaged products information so that's
that's one idea we have here I need
anything you want to add anywhere ok so
anyway why don't you take the other
question the next question yes the next
question is from either globins from
why's that
hi I am developing iPhone app so here I
integrated Google+ but here everywhere
we need user ID please tell me how to
get user ID thank you so going on I'm
sorry we we don't have much expertise
with iPhone here so can't really ask
your question here and this is just
targeted at Android developers in terms
of user press again we are not really
exports on to the + api's but you can
feel free to browse their website we do
have some API is there mister thank you
so ok I'll take the next question is
from some Samir and which is the best
cheapest Android tablet with call
function I guess that's really another
developer questions and probably you you
can ask your friends and we don't have
any recommendation here ok so let's go
to the next question the last question
for today that's paint
Google Translate API provide better
quality than free online Google
Translate again this is a developer
question for this but we are mainly
focusing on Android here but since
anywhere then I we have nice also we do
we do actually research an answer for
you so first of all the translate API is
a pee pee I so so there is no free
options there and in terms of quality I
was at suggest you to ask that question
on Google Translate API forum so there
is a forum and and probably you can
there is also a contact form to to the
paste to the one to the pay support team
and you may you may want to ask the
answer there but high level our our
guest is actually the API is is it's
probably the same as the one provided on
the Google Translate site so but check
with the check with the support team
alright that's that seems like that's
all we have for today I guess like if
there's mmm anyone is there anything you
want to cover or so what we'll do is
we'll share some links to resources for
monkey learner it gets you other go
through them and thank you for joining
us today we don't have any live
questions to this okay
thanks so much thank you bye bye see you
next week</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>