<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Architecture Components: Improve Your App's Design | Coder Coacher - Coaching Coders</title><meta content="Architecture Components: Improve Your App's Design - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Architecture Components: Improve Your App's Design</b></h2><h5 class="post__date">2017-05-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/vOJCrbr144o" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in response to popular demand the
android framework team has written an
opinionated guide to architecting
Android apps and they've developed a
companion set of architecture components
hi my name is Lila a developer advocate
for Android and I'm here to introduce
you to these shiny new architecture
components these components persist data
manage lifecycle make your app modular
help you avoid memory leaks and prevent
you from having to write boring
boilerplate code your basic Android app
needs a data base connected to a robust
UI the new components room view model
live data and lifecycle make that easy
they're also designed to fit together
like building blocks so let's see how
I'll tackle the database using room
which is a new sequel Lite object
mapping library to set up the tables
using room we can define a plain old
Java object or POJO we then mark this
pocha with the @ entity annotation and
created ID
marked would be at primary key
annotation now for each Pocho you need
to define a Dao or database access
object the annotated methods represent
the sequel Lite commands you need to
interact with your approaches data now
take a look at this insert method and
this query method rubas automatically
converted your POJO objects into the
corresponding database tables and back
again room also verifies your sequel
Lite at compile time so if you spell
something a little bit wrong or if you
reference a column that's not actually
in the database it will throw a helpful
error now that you have a rube database
you can use another new architecture
component called live data to monitor
changes in the database live data is an
observable data holder that means that
holds data and notifies you when the
data changes so that you can update the
UI live data is an abstract class that
you can extend or for simple cases you
can use the mutable live data class if
you update the value of the mutable live
data with a call to set value it can
then trigger an update in your UI
what's even more powerful though is that
room is built to support live data to
use them together you just modify your
Dao to return objects that are wrapped
with the live data class we will create
a live data object observing the
database then you could write code like
this to update your UI the end result is
that if your room database updates it
changes the data and your live data
object which automatically
triggers UI updates this brings me to
another awesome feature of live data
live data is a lifecycle aware component
now you may be thinking what exactly is
a lifecycle aware component well I'm
glad you asked through the magic of
lifecycle observation live data knows
where your activity is on screen off
screen or destroyed so that it doesn't
send database updates to a not active UI
there are two interfaces for this
lifecycle Oder and lifecycle observer
lifecycle owners are objects with life
cycles like activities and fragments
lifecycle servers on the other hand
observe lifecycle owners and are
notified of lifecycle changes here's a
quick peek at the simplified code for
live data which is also a lifecycle
observer the methods annotated with at
on lifecycle event take care of
initialization and teardown when The
Associated lifecycle owner starts and
stops this allows live data objects to
take care of their own setup and
teardown so the UI components observe
the live data and the live data
components observe the lifecycle owners
as a side note to all you Android
library designers out there you can use
this exact same lifecycle observation
code to call setup and teardown
functions automatically for your own
libraries now you still have one more
problem to solve as your app is used it
will go through various configuration
changes that destroy and rebuild the
activity we don't want to tie the
initialization of live data to the
activity lifecycle because that causes a
lot of needlessly re-execute at code
example of this is your database query
which is executed every time you rotate
the phone so what do you do well you put
your live data and any other data
associated with the UI in a view model
instead view models are objects that
provide data for UI components and
survive configuration changes to create
a view model object you extend the view
model class you then put all of the
necessary data for your activity UI into
the view model since you've cached data
for the UI inside of the view model your
app won't require the database if your
activities recreated it due to a
configuration change then when you're
creating your activity or fragment you
can get a reference to the view model
and use it and that's it the first time
you get a view model it's generated for
your activity what do you request a view
model again your activity receives the
original view model with the UI
a cache so there's no more useless
database calls to summarize all of this
new architecture shininess we've talked
about room which is an object mapping
library for sequel light live data which
notifies you when its data changes so
that you can update the UI and
importantly it works well with room so
that you can easily update the UI when
the database values change we've also
talked about lifecycle observers and
owners which allow non UI objects to
observe lifecycle events and finally we
talked about view models which provide
you data objects that survived
configuration changes all together they
make up a set of architecture components
for writing modular testable and robust
Android apps you can sensibly use them
together or you can pick and choose what
you need but this is just the tip of the
iceberg in fact a more fully fledged
Android app might look like this for an
in-depth look at how everything works
together and the reasoning behind these
components check out the links in the
description below to jump straight into
code and get started working with these
objects you can check out the code labs
and samples for lifecycle and
persistence happy building and as always
don't forget to subscribe</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>