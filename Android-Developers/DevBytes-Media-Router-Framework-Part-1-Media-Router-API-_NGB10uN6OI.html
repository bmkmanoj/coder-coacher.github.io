<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>DevBytes: Media Router Framework - Part 1 - Media Router API | Coder Coacher - Coaching Coders</title><meta content="DevBytes: Media Router Framework - Part 1 - Media Router API - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>DevBytes: Media Router Framework - Part 1 - Media Router API</b></h2><h5 class="post__date">2014-02-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_NGB10uN6OI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello my name is Fred Chung developer
advocate at Google this is the first of
a two-part dev byte series covering the
Android media router framework in the
support library it has become
increasingly common for users to stream
movies or music from their tablets or
smartphones in the living room for
instance you may want to make use of
those external speakers or Wi-Fi this
place to enjoy your personal library of
media content Android offers a flexible
media router framework for any apps to
cast media content to support external
devices for playback in this episode we
are going to talk about the media router
which is a mediation layer for apps to
cast media content to support devices
the paths to these devices are known as
media routes at a high level the media
router offers api's to render the cast
button discover and select media routes
query the capabilities of the routes and
control remote playback via an intent
based protocol in the next episode we're
going to explore media route providers
which is a components that encapsulate
the underlying communication between
Android and external media devices
device manufacturers can implement that
their own MLPs
in order to publish themselves as media
routes on Android for example chromecast
has implemented an MRP in the Google
cast SDK through which apps can
integrate with with this architecture
apps are essentially decoupled from
underlying transport implementations of
the media routes we're going to look at
some implementation details but before
doing that I want to call out that the
media router framework we are focusing
here is in the support library which
means that it is backward compatible
with Android 2.1 and above and let's not
mix it up with the media router in the
android framework to initiate media
routing the user would click on the cast
button which typically is place
on the actionbar through the button the
user would be able to select a media
route disconnect from the route control
playback on a connected route and so on
one way to add the cast button in the
action bar is to add an action provide a
manual item pointing to the class media
route action provider then in the menu
initialization code associate manual
item action provider with a media route
selector object route selector is
basically a filter for media route
capabilities an app can specify
categories of media route and points it
can work with the framework uses the
selector to present only the appropriate
media routes to the user for example
even that asks for video streaming
capability the system won't present
audio only media routes to the user
there are several predefined categories
including remote playback audio
streaming and video streaming of course
custom ones can also be defined by the
MLPs let's have a look at the
initialization of the media router
object which maintains the overall state
of media routing once you've gotten the
reference to the singleton media router
object you want to register the media
router callback which provides events on
media route changes suggest route
selections modifications and volume
changes have a look at the API reference
for details in this code snippet the
particular callback flag causes the
system to immediately discover available
media routes keep in mind that route
discovery may involve Network cause and
therefore you should be diligent in
removing a callback when the route
discovery is no longer needed in your
app I also want to point out that if
you're using fragments another option is
to use media route discovery fragment
which gives you the same hooks for
callback registration once a media route
is selected by the user the app can
begin ensuring remote playback controls
to the endpoint the implications are
asynchronous which makes sense
considering media and
maybe remote the mediarouter framework
defines an intent based protocol for
basic playback controls such as play
pause or seek you can find the
definitions of the action and extra
parameters in the media control intent
class this snippet illustrates the
invocation of basic remote playback
where first it constructs an intent with
proper action and category values as
well as the URI of the media it then
checks if the selected route is capable
of handling such requests it's finally
fires of the intent the framework will
report the results of the invocation VLE
asynchronous callback while not included
in a snippet it is good practice to
account for situations where remote
playback is not possible in which case
your app should fall back to local
playback that's it for an overview of
meteor from an app casting perspective
have a look at the docs and samples and
stay tuned for the episode on media
route provider thanks for watching and
happy casting</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>