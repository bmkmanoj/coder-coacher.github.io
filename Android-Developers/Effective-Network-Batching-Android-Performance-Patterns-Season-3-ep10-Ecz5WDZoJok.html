<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Effective Network Batching (Android Performance Patterns Season 3 ep10) | Coder Coacher - Coaching Coders</title><meta content="Effective Network Batching (Android Performance Patterns Season 3 ep10) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Effective Network Batching (Android Performance Patterns Season 3 ep10)</b></h2><h5 class="post__date">2015-10-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Ecz5WDZoJok" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">batch batch batch it's really all you
here the networking folks ramble on
about nowadays almost like they're
trying to tell you something
my name is Colt McAnlis and while the
truth is they are we all know that
networking is the biggest offender when
it comes to battery drain on mobile
devices I mean consider the cellular
radio in any of your phones after a
request it'll still wait around for
about an extra twenty to sixty seconds
keeping the chip awake drawing power
just in case a server response comes in
if nothing comes in only then will it go
back to sleep and in the super worst
case scenario your app can end up in a
position where each one of its network
requests wakes up the cell radio and
pays the cost to keep it awake over time
batching is the ideal way to coalesce
these requests together so you only have
to pay the wake up and keep alive
penalties once but the big question here
is how do you go about actually doing
batching well first understand that any
requests that are generated as a result
of a user action generally need to be
handled right now everything else though
is completely fair game basically if
there's even a slight chance that
delaying a request won't cause the user
to throw their phone out the window then
you should be considering it now from a
code perspective the easiest way to
implement batching is to basically
intercept any outbound requests and
rather than executing them immediately
store them in a pending list of actions
to be made in the future this can be
simple as a queue object or as complex
as a content provider for serializing
them to disk in case you're worried
about them getting lost when the apt is
terminated but here's the tricky part
how do we know when to send these
pending requests well you could just
wait until some threshold has been
reached like a ten request or something
and then purge your list waking up the
radio and sending out the data which is
a completely fine way to approach the
problem but the truth is that the system
is doing a ton of other things in the
background and chances are that before
your threshold is reached the cellular
radio will be turned on in order to
complete some other tasks therefore it
makes a lot of sense to try and
piggyback these operations when they
happen basically you can set up this
code to give your app a callback anytime
the networking hardware has been fired
up when this happens go ahead and purge
your pending queue but things might get
a little bit more complex than that
so what if you want to wait until you're
on Wi-Fi or
into a power source or something crazy
like you want to wait until the user
isn't riding a bike or in a car anymore
this is exactly why you need to use GCM
network manager this is a Google Play
services API which helps to schedule
Network oriented tasks and handle
batching for you this greatly simplifies
the implementation of common patterns
such as a waiting for network
connectivity Network retries and back
off basically all the good stuff you
need with one single helpful API now if
you don't know what your request profile
looks like or you're in a bad spot check
out the networking monitor tool inside
of Android studio this tool will help
you see how often inbound and outbound
requests happen and the size of each
request batching is one of the
fundamental techniques that can improve
your application performance for users
but it's not the only networking
technique you need to know which is why
you need to check out the rest of their
Android performance patterns content and
don't forget to join the Google+
community as well so keep calm profile
your code and always remember perf
matters
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>