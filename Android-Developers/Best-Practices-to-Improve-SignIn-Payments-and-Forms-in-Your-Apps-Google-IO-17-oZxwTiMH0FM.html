<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Best Practices to Improve Sign-In, Payments, and Forms in Your Apps (Google I/O '17) | Coder Coacher - Coaching Coders</title><meta content="Best Practices to Improve Sign-In, Payments, and Forms in Your Apps (Google I/O '17) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Best Practices to Improve Sign-In, Payments, and Forms in Your Apps (Google I/O '17)</b></h2><h5 class="post__date">2017-05-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/oZxwTiMH0FM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">good morning everyone cool first talk of
the day so hi I'll start by introducing
ourselves my name is Akshay Kenan and
I'm a product manager on the Android
team I'm from Italy I'm soft engineer
and android framework skin hi I'm Simon
G Singh Kohli I'm soft very endearing
Android authentication team and our talk
is all about Android API is that you can
use to improve sign-in payment and other
key forms and experiences in your apps
so let's dive right in why are we giving
this talk what are the goals you want to
accomplish with this the first is to get
more apps to use existing data from
Android and to avoid prompting your
users throwing up any kind of blank form
in your app such as an app login or a
credit card can create friction and
result in drop-off when users don't know
this information off hand
we've created ap is for you to
automatically get this information when
it's available so that you can let your
users skip past this step and get right
to the stuff that actually matters in
your app secondly we'll talk about how
you can provide a seamless experience
and reduce churn when your users switch
devices getting a new phone is awesome
but it can also mean that your users get
locked out of or stopped engaging with
your app here also we have a set of API
is to maintain your app state across
devices let's start by focusing on how
you can use existing information that
the user has already provided to enhance
your flows the first feature I want to
talk about is a new one you may have
heard about this in the keynote starting
in Android oh we've added native support
for password managers this functionality
is integrated tightly into the OS so you
don't have to rely on hacks like
accessibility services or custom
keyboards in order to securely fill in
passwords credit cards and other
information we've partnered with dash
line
LastPass keeper and one password to
support this feature when Android o goes
out this year and
really excited about this of course not
everyone uses a password manager but we
still want all Android users to be able
to experience the security and
convenience of autofill so for those
users we're introducing autofill with
Google this feature comes bundled with
Android o devices and lets you fill in
passwords addresses credit cards and
other information that you already have
saved to your Google Account with chrome
sync all with a single tap we've made a
preview of this feature available to
developers as part of the ovate a--
which you can play around with today and
used to test out functionality for
auto-filling logins
in your apps support for credit cards
and addresses is coming later this year
along with a consumer release let's take
a look at what this looks like cut to
the demo so let's say that I'm logging
in to Twitter on a new device I simply
open the app I tap login and you could
see here that my username already auto
populates as a suggestion I simply tap
on that my username and password
automatically get filled in I hit login
and now as you can see I've been able to
log into Twitter without pressing a
single key on my phone next I'll hand
things over to Felipe who's going to
talk a little bit about how this all
works and how you can optimize your apps
as developers for autofill thanks Shay
we have the klappas for him or four out
of six google but pretty sure was not
for me
anyway so the Android auto soo framework
was designed to work out of the box is
the existing app without changing the
apps to support it out of film we in
fact for our Twitter demo we just get a
Twitter we just decided to it if you
can't read it app from the Google Play
Store and it just works without any
involvement for the Twitter developers
we hope it is going to be decades for
most apps but we still provide some
api's that you can use to make sure that
your app integrate integrates well with
out of you will see some of these api is
over the next slide but first let's take
a high-level look on how all of the
works because that will make it easy to
understand why using this API is
important so the author of the workflow
involves three processes in one hand you
have your app which is there to being
out of food in the other hand you have
the out of your service which is the app
that has the user data like a pattern
manager or auto so is Google then in
between then you have the Android
runtime system which is a mediator it
uses for privacy security performance
reasons the whole workflow which starts
when the user selects an editable field
on the app for example when the username
view on Twitter lost focus so at that
point there is an outer few links are
running on the air to process and that
inference is going to create a
customized version of the first vector
that is optimized for autofill then it
will send this view structure back to
the Android system where the Android
Vista will sanitize the data by
stripping out sense to the values next
the Android assistant sends the data to
the autofill service now here is the
part where things get interesting from
API point of view the order to
serviceable parts that is restricted and
will look for food that can be out of
fill then it will look on the user data
for that app and see if there is a match
if there is a match then it creates
another data structure called data set
and send that data set over to the
Android system at this point the Android
system is able to ROC
but it doesn't do that without the user
confirmation so what it does instead it
shows the out of your dialog which the
options sent by the service and only
after the user selects an option we sent
the data set back to the app and then
the out of two infrastructure will
automatically set the views and change
the background colors to show that this
view was not of fields so this workflow
works pretty fast it's professed like we
found the demo the auto fill dialog
became is out almost at the same time at
the keyboard itself but this workflow
has a catch it only works if the order
to serve can figure out what can be out
of field in your air
generally speaking the password managers
have good heuristic ease and they can
pretty much figure out how to auto fuel
almost any app but I don't wanna rely
only on that he'll risk is to make it
work it's better if you can tell them
for sure what can be out of certain area
and how it's also nice to help generate
the system to optimize the workflow by
telling which fuse should begin or
because they don't make sense to be out
of field you can accomplish both these
goals by simply annotating are active
XML with out of the tags as you're going
to do the next slide using a very simple
login screen example so this login
screen has three editable fields there
is a username and password and the
capture Challenger the username and
password are they really the foods that
will make sense to be out of food while
they capture something the user has to
type in to make sure to prove that the
user is a human being or a tree in this
case and other robots so without further
ado let's take a look at the XML the
first and most important tag you can use
this call out of your hints this tags
tells the Rasool service what is the
meaning of her view or what kind of user
information they deserve you can use it
to fuel your view for example on our
password field there is only one way
only one way to fill that info which it
is using the users password so we say
out of two hints
equals password
but on our user name our app allows
either a username or email address but
we don't know advanced which of these
two information of the order to service
it have so it's better to give the order
to serve satellite so we put all values
that possible here so we say username in
coma email address the other few hints
can take any string you can have
something as bizarre as my dog's
favorite color Y on vacation California
last year during the drought but these
things are only useful if the service
understand what they mean so we provide
the constants and view Java for the most
common cases like user name email
address telephone number credit card
number expiration date so it's better if
you try to use this constant instead the
next tag is called important for out of
you this tag is used by the Android
system to optimize whatwhat's to
optimize the workflow so basically it
tells the Android system whether the
view should trigger it out of view
workflow and whether the contents of the
view should be included in the
restricted structure that send it over
to the service so in our example we can
mark the capture as the capture edited
tests are important for out of few week
oh no that means that when the auto fuel
workflow is triggered by the username or
password we don't send the capture over
so this might sound like a small of a
minor improvement but remember this is
running on a mobile environment where
every little optimization counts in fact
there might be cases where the whole
activity doesn't make sense to be out of
field for example in a spreadsheet
editor like the one in Google Drive in
this case you can mark the route of view
of your activity which is important for
all of you equals no extra descendants
and that pretty much intelligent writing
system that no view inside the
directivity should automatically trigger
out of you just keep in mind that the
important for out of you is an
optimization hint another way to
effectively disable all of you on your
app the user can always bypass your
decision your hints by manually
requesting out of fuel for example the
user can longer press the text to edit
text and then select the outer few
options
in the overflow menu and when that
happens not only we triggered out of
fuel workflow but we send over all views
included those marketers not important
so this is pretty much the tool is the
way you can optimize your your apps for
all of you there are other tech is then
Java API that you can use but we didn't
have time to show in the presentation
but they are available on the official
documentation on the official Docs for
doubt of you now back to Akshay from our
tip thanks Felipe as we mentioned
earlier along with introducing the other
full framework in Android we're
launching our own auto full service that
comes bundled with Oda vices Auto filled
with Google one of the nice things about
autofill with Google is that your data
is synced between the Chrome browser and
the mobile apps that you use in order
for this to work you need to claim the
association between your mobile app and
your website and you can do this using
digital asset linking if you've used
other things like app linking in Android
you might be familiar with this already
basically for autofill this enables any
web logins that are saved using Chrome
to to work with mobile apps and vice
versa
and basically in order to make this
association work there's there's just
two steps involved so the first step is
to host some JSON on your web server at
your domain slash dot well-known slash
asset link JSON and this tells us about
the mobile apps that are associated with
your domain along with the permissions
that you want to share with those apps
here you you explicitly define the
permissions that you want to have shared
so in this case on the slide there is
the common debt login creds permission
which enables your credentials to be
shared from your website to your mobile
app and it is in addition to credential
sharing there's many other permissions
that you can also grant to your app
using this same JSON for example there's
also the handle all URLs permission
which lets your app handle incoming with
web links via app linking so that your
users can seamlessly open links that
your app was designed to handle the next
step once you've hosted this JSON on
your server is to define the
corresponding association in your mobile
app and you can do this by modifying
your app's amount of
just to enable credential sharing you
need to add the following metadata tag
to your manifest here Android string
asset statements points to a JSON string
resource that contains a list of web
targets and permissions similar to what
you hosted on your website and that's it
with these two steps you can share
credentials between your website and
your mobile app this works for autofill
and it also works for smart lock for
passwords which lets you automatically
signing your users now I'm going to hand
things over to similar jeet who's going
to talk more about how you can enable
automatic sign-in for your users in
further detail haengsuk share we want
our users to get as much value out of
their device as quickly as possible
a lot of that value is associated with
their accounts so we have provided a set
of API is to make user logins easy and
seamless the first one is smart lock for
passwords which was introduced last year
the second one is account transfer API
which will be released in an upcoming
Google Play services update there are
benefits to each of them that we will
look at as we move on the first API we
discuss here is mic lock for passwords
it allows for automatic sign-in and
skipping password forms completely it
syncs with passwords showed in users
chrome profiles as a result egg per
search across app installs it has some
differences from autofill my load of L
is only supported Android o onwards
smart lock is backward compatible with
ICS and delivered by a Google Play
services with smart lock users can be
logged into your app programmatically
without any user input here as you can
see in the Netflix example on this slide
user did not have to do anything they
just open their Netflix app Netflix
makes the API calls gets the credential
Israel verifies the credential with the
server and science and user
automatically in this case login can be
skipped complete login screen can be
skipped completely this water-filled
user at least has to tap into the field
in order to populate them
smartlock also provides advanced
security features there are two major
flows associated with this API
retrieving credentials and saving
credentials here's how to retrieve the
retrieve credentials using the request
API if the credential was already
available you get success on the
callback and you can sign in user
immediately
as for shown in the Netflix example in
the previous slide the other cases
require user action which are triggered
by launching relevant intent if the user
has multiple credentials they can pick
the credential they want to use
if there are no credential available
they get a dialog to select email
address or phone numbers to sign in or
sign up with here's an example of a save
API if the credentials were already
saved previously and you are making a
call to updating them the callback
results in a success but to save a new
password the user must give consent for
the credential to be saved in this
scenario you have to call start
resolution for result
additionally the responses from Snipe
log api also includes a sign JSON web ID
token if Google has verified the user's
email address you can use just token on
your server to verify users email
address and sign them in without a
password or you can use it as a strong
positive signal in anti abuse algorithms
also check out the talk later to their
own phone which will cover a new smart
lock API to verify phone numbers via SMS
messages now let's talk about a second
API the account transfer API while
setting up your new Android device you
might have seen the following flow where
it gives you an option to copy your data
from your existing phone initially
introduced at Epson go in lollipop
release this flow allows you to copy
your Google accounts from your existing
device through your new device we
thought about how we can make it more
seamless for our users to get started on
the new device and we came up with
account transfer API
help transfer non-google accounts also
during the setup process after you
select that you are copying your data
from another device our flow kicks in as
you saw in the previous slide account
transfer API transfers credentials
during the setup of the device it's a
device to device transfer some
organizations do not allow the storage
of their users credentials on our
servers due to the nature of their
security policy so in that case decide
this API is very useful also there is no
dependency on Google accounts if you are
an identity provider this API provides a
lot of benefits it is only available to
Android authenticators authenticators
are apps which implement abstract
account authenticator and integrate with
Account Manager on the Android platform
account transfer API provides an
encrypted channel between participating
or syndicators on a user's existing and
new device this encrypted pipe is
established by Google Play services
running on both these devices apps can
do two-way communication over this
encrypted Channel if they are also
present on the new device but if the app
is not present on the new device
transfer credentials are held in
temporary storage if your app is be
installed on the new device here it here
is it how it looks you can send messages
from source to targets and from target
to source establishing a two-way
communication you can perform key
exchanges or perform cryptographic
challenge response flows Google Play
services running on both these devices
notifies you of available data on that
device by a broad cache however if your
app is not installed on the target
device the credential syncs from your
app on the source to the target are
showed in temporary storage then your
app gets installed and is opened for the
first time make a call to our API to
retrieve the transferred over
credentials to participate in this API
you need to register this broadcast in
your manifest
this slide shows which broadcasts are
active on the source and which ones are
active on the target if your app doesn't
come pre-installed on any om system
image
you only need start account export
broadcast here is a sample code that
will be called on your users source
device when source site broadcast is
triggered you should start a new service
in the service you first get a handle to
the API object and then send the user
credentials in byte format using the
same data API in case there is a failure
notify about it to our API on the target
side you can retrieve the data guide was
sent over here also when your broadcast
is figured you should start a service in
the service
grab the API object and then make the
retrieve data API fall and retrieve the
byte data diagnose transferred over
convert this byte data to your
credentials using your custom logic and
then add the account on the device using
Account Manager API finally notify our
API about success or failure this is a
simplistic example where only one-way
communication is happening so since the
data and Cal get retrieves it this is
sufficient for many apps like apps
managing email IMAP pop3 accounts the
same code can be used if the app is not
installed on the target and when the
user opens the app for the first time
however in this case you can't send the
data back to the source also make sure
not to call this API from your main
thread now I will hand it over to Akshay
to discuss Android pay and backup API is
next Imogene so in the last few slides
you learned about how you can
automatically sign users in using smart
lock for passwords or how you can
securely transfer credentials from your
old device to your new device using the
upcoming account transfer API
similarly for payments also we offer a
set of api's to help you get this
information automatically on behalf of
the user and
Oh similarly this also extends down to
older Android versions so you don't have
to depend on your users running autofill
on Android Oh currently we have the
Android pay API today which gives you
Android pay cards but as you heard in
the payment session we'll be introducing
the Google Google payments API in the
coming weeks to extend this API to
include all of the cards tied to users
Google account not just the ones that
they have using Android pay and best of
all there's there's no commission or
fees involved at all in using any of
these api's to make this work there's
there's basically three steps involved
first thing you do is you request a
masked wallet and that shows the dialog
similar to the one in the screenshot you
can see on the slide and this lets the
user pick a form of payment once they've
selected one you can handle the response
from this and use that to present a
final confirmation to your user
confirming the amount what they're going
to be ordering and the method of payment
they selected and then once the user
confirms this you can request a full
wallet and what that does is that gives
you the credentials that you need to
complete the transaction so that's it
for payment api's so in the first whole
first part of this presentation we've
talked a lot about using existing
information that the user already has
provided to speed up critical forms and
flows in your apps whether it's logins
or payments or anything else in the
second part we're going to focus on
using backup and restore to reduce churn
when your users switch devices or if
they reinstall their app on the same
device even if someone's using a new
device our goal is to make it feel like
they never stopped using your app so as
as we mentioned before throwing up a
blank login screen the first time an
existing user uses your app on a new
device can create unnecessary turn and
stop users from Rhian gauging if they've
already used your app you can skip your
Welcome flow pre-populate login
information and transfer over settings
and any other states to give your users
a warm welcome and a seamless transition
onto their new device
the goal is to preserve as much of your
appstate as possible
so that your users continue to stay
engaged we offer to api's for doing this
there is the auto backup API which as
you'll see in the next slide is
extremely low effort for developers it's
basically a line of code that you add to
your manifest and it backs up everything
in your app wholesale for more
fine-grained control over exactly what
gets backed up in your app we recommend
using key value backup this works on
Froyo and above so pretty much all
active Android devices today are
supported
assuming a user has backup turned on
we'll talk through both of these api's
will explain how you use them and talk
through some of the trade-offs between
them let's start by talking about the
auto backup API as you mentioned in the
last slide it's extremely low effort for
developers to add to your app you just
add this single line to your manifest
that you can see on the slide and
everything gets back to the wholesale
including shared preferences your files
and your databases in addition you can
also define custom XML including Xcode
rules to control exactly what gets
backed up all of this data gets
persisted in a private folder in the
users Google Drive account which is
limited to 25 megabytes per user per app
this doesn't count towards the users
Drive storage and only the most recent
backup ever gets stored so every time
there's a new backup it overrides the
previous backup
that being said auto backup is limited
to marshmallow and above and if you want
broader support or more fine-grained
control over exactly what gets backed up
you're going to want to use the
key/value backup API instead the key
value Android key value backup lets you
preserve your app data by uploading it
to androids backup service the amount of
data is limited to finally bytes per
user per app and it's available
completely free of charge there's
basically two steps to make this work
you update your manifest and then you
write the code to do the backup in the
first step where you update your
manifest you want to point to the backup
agent which in this case is my backup
agent which will define in the next
slide
and you want to register for the Android
backup service in the API console which
gives you an API key that you can copy
paste into your manifest next once
you've updated your manifest you want to
actually define your backup agent and
this is the code that actually does the
back of in most cases rather than
extending backup agent directly you can
extend backup agent helper and use the
two included helpers that we've already
provided which are the shared
preferences backup helper for backing up
shared preferences and the file backup
helper for backing up files in the right
you can look at an example of what this
looks like basically in the oncreate
method of your backup agent helper you
can instantiate one of these helpers
with the name of the file that you want
to backup and then you call to add
helper method which adds this helper to
your backup agent helper if you need
further control over versioning file
portions or databases you can extend the
backup agent directly rather than using
our included helpers so that's the
backup and restore in this whole talk
we've discussed a lot of api's to help
you streamline your apps ranging from
logins to credit cards to backup and
restore our vision with these API s is
to lower the barrier for new users and
even existing users on an old device to
start interacting with and engaging with
your app we want to move to a world in
which your phone knows more about you
and it can provide this information to
other apps when you allow that
information to be provided to them we
want to make forms a thing of the past
and as app developers you should be able
to tap into information that's already
been provided by the user rather than
forcing them to type it over and over
again just so you can get it especially
within synapse upfront forms can
significantly hurt the experience and
increase the friction that's needed to
try something new
so our goal with these API s is for
mundane stuff like credential entry to
become a thing of the past and if the
user purchases a new device we want this
information to stay with them and move
with them so they don't feel like
they're starting all over again
so just to recap the key takeaways from
the whole talk first and foremost
autofill is coming with Android Oh as
you saw in the demo please optimize your
apps for autofill you can annotate your
XML using the hints that Felipe talked
about and also you can use digital asset
linking to associate your website and
your mobile app so that credentials can
be seamlessly shared between the two
second populate credentials and payment
information automatically when it's
available you can use the smart lock API
to do to back up your username and
password associated with chrome sync you
can use the Android account transfer API
if you need a secure and encrypted pipe
during device setup and you can use the
Android pay yes today and the Google
payments API is in the coming coming
weeks to get payment information from
the user without any sort of Commission
and thirdly make sure you persist your
apps data across devices we talked about
the auto backup APs which is extremely
low effort and backs up pretty much
everything in your app and for more
fine-grained control we also offer key
value backup this is a lot of ApS that
we talked about today we have a short
link here on the slide that takes you to
a doc where we've provided links to the
developer documentation for each of
these API so you can learn more thank
you so much for coming up with our talk
hopefully you'll check these api's out
and use them in your apps thank you so
much
Oh</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>