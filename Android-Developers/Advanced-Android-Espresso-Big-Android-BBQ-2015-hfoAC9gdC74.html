<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Advanced Android Espresso (Big Android BBQ 2015) | Coder Coacher - Coaching Coders</title><meta content="Advanced Android Espresso (Big Android BBQ 2015) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Advanced Android Espresso (Big Android BBQ 2015)</b></h2><h5 class="post__date">2015-10-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hfoAC9gdC74" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome my name is chicky Chan and today
we are going to talk about advanced
Android expresso in case you do not know
expresso it's a testing framework so let
me just back up a little bit and asked
all of you how many of you do Android
testing oh okay
more than half that's excellent and how
many of you have written
expresso tests little bit less than a
half so cool so this is an advanced
Android expresso so I'll be going
through the beginning stuff pretty
quickly but hopefully for those of you
have not done it before you still get a
good enough overview so that when I
explain more advanced techniques you can
follow along well first what is
expressed so in short expression is an
automated UI testing framework meaning
that you write some code and then you
can let go of your hand because expresso
will click buttons and type tests and do
all these user actions for you and then
you can verify the stay out of app to
make sure that it's behaving the way you
expect it to behave and what's nice
about expresso is that well first of all
is a first-party library it is written
by people at Google is get delivered
through the Android testing support
library and like I said a similar user
action so people are not people I guess
the program is actually cutting the
button and then exercising your app that
way but the most interesting thing about
expresso is that it does automatic
synchronization that sounds really fancy
and whatever that means so I can tell
you what happens before expresso came
along before expresso came along there
is already a way to do all these things
and click on buttons and verify but the
problem is that the click action that
comes from your test app it's not
synchronized with your main app meaning
that your app may or may not be ready so
for us human is instantaneous right now
you open the app and the buttons are
there but it actually takes a few
hundred milliseconds for the rendering
to have
and your test threat is super fast so
when I was writing tests before I
expressed though well what happened is
that I would say go click the button and
my test code be like that's no button to
click and that's not because there's no
button it's because I was too fast so
that's what I mean by synchronization is
that expresso actually have watches it
will watch over the UI thread and make
sure that is I know it's not it's done
rendering before it goes try to click a
button and me also watches the async
task thread pool so if you are doing
something in the background with async
tasks and wait for that as well
so that's what's nice about automatic
synchronization another way to put it is
I don't know if you've written test
before and you have to make it sleep to
make it past to do the synchronization I
mean I make it sound like magic but
actually behind the scene that's why
Express with us but it sleeps for you
it's not just blindly sleep for like 500
milliseconds it's like sleep and wake up
say hey UI thread are you done
oh yeah nothing ok I'll sleep again so
it makes it a little bit more
intelligent sleeping so that you don't
have to worry about it so behind the
scene that still some sleep here going
on but at least you are not the one
that's randomly guessing some random
number of milliseconds to sleep so I'm
gonna go through hello well for those of
you have not done this before
expresso will kind of have a formula
that is I think what people call a
fluent API so there are three parts to
this on view perform and check on view
is the way to find a view on your app so
for instance while we have this hello
world app we'll have this button called
greet to look for this button we can use
the with ID function and we can give it
the ID that says look for the greet
button ok so now at this point we have
located the button now we need to do
something to it with that if view action
we can ask
expresso to then click on this button
and afterwards we'll verify something in
our case for some reason you can only
greet once once you greet the button
will be disabled so once I click on the
grid button I want to check that they
stays check matches not enabled so in
expresso you can also combine different
reactions and reassertion so in this
case there's a built-in function call
it's an able that I can use to verify
that the button is
labeled there's no function cut is not
enabled what you do is you negate that
and I have actually published this under
this github repository and like I said
the whole slide deck is already shared
if you go on Twitter you can click
through and find all these example there
are a lot more coming so don't
frantically write down URLs that is not
the best use of your time right now so
like I said a little bit earlier the
whip ID is something that Express so
provide for you to look for a view there
are other things like click matches and
it's an a boat so almost everything here
is coming out of the expresso library
but the notepad is from hamcrest it's
still bundled with the expresso library
but it's not written by the folks at
Google it's a Java specific library that
you can do different things so these are
all the expresso view matches view
actions view assertions and we're going
to sit here the whole talk so go through
one on each one of them and then until
you fall asleep no no that's not the
agenda I'm just gonna show you this
because that's a cheat sheet online that
you can go check if you are wondering
what is the capability of expresso on
top of that like I've mentioned earlier
that's hamcrest again cheat sheet
function galore not going to go through
that but you can go and you can take a
quick look and yeah there's things like
what I did already is no no not is one
of it and then you can also do other
things that is an instance of so
basically Java level matching rather
than enjoy matching so with this you can
actually combine them and it's going to
become much more powerful instead of
just a single one let's go through one
example suppose I have an app that uses
the toolbar I mean you have an app that
uses the poodle toolbar right did you
supply the layout to the toolbar
no so we are not going to be able to you
with ID to find the toolbar to verify
what the title is so what are we going
to do if we want to verify that I set
the title properly well we're going to
bust our hierarchy viewer how many of
you have used hierarchy viewer great
what this is is you can take a look at
not just the part of the UI that you've
set so by summer when you run an
activity you do set content view and
then your given layout and that's the
puppet you define it actually showed the
whole UI that's being rendered so you
can see things that can't be on your
control in our case we can see that
there is this textview which has my
awesome title in it and that's the view
that we want to verify but the problem
is doesn't have an ID so how we can
don't look for it well fortunately we
can see that this is a child of a class
that is of the type tool bar so we can
combine matches to pinpoint this view
let's see how we're going to do this
well first of all I have a helper
function that help me find the toolbar
title and the reason why I have this
helper function does match toolbar title
is because that way I can reuse it right
if I have multiple tests that I want to
find the toolbar title match it I just
need to write at once
so here is kind of the magic where all
of that's the hamcrest matcher and then
I will look for something that is
assignable from textview meaning I'm
looking for a class that is a textview
or a child of textview like maybe it's a
button but in our case it's a textview
and then oh so we have you have to
satisfy two conditions the first
condition is the view itself is a
textview the second condition is that
that view also has the parent that is of
type to be' so we are trying to
translate what we see in hard to viewer
into the matches so with all that we
will find that particular text view and
then we can go ahead and do the match
with text so that we can verify that the
toolbar is displaying what we expect you
to display so far so good
okay good exercise this much of your
body
but even though there's a lot of matches
and can combine them there are times
that we want to write a custom matcher
in fact we're going to change this code
to use a custom matcher and it's not
just for demoing purposes the reason why
I want to change it is because when you
are doing that trick that I showed you
that you use the hierarchy viewer to
look deep into a view it may change
right this is not your code this is
probably the support library if you're
using app compat right today the toolbar
display it by having one single layer so
you can use with parent to to pinpoint
your view tomorrow things may change you
may get nested inside a linear layout
because what did not explain to you why
I just want to do it right so to protect
yourself from those changes it's much
better to use and published API right
because when you are sneaking into that
view hierarchy that's not a part of the
public API and they are allowed to
change it whereas for example here we
are actually going to use the toolbar
get title function that is a part of
public API of the tuba object so instead
of using all those match parents and all
of and whatnot what we're going to do is
this play is very similar on well this
is actually just a function with you
toolbar title but what we have is that I
have written a custom thing called
with toolbar title now this is the dance
code coming can everybody see it
okay that's good so what we have here is
something called bounded matcher this is
again I think is actually hamcrest what
happened here is that I'm saying that I
want a view matcher
that is specific to a toolbar which is
why there's a generic that I passed in
the Tupac class and when I want to see
whether this matches safely I will go
ahead and call the toolbar which is
passed in to me in this function because
of this generic and I'll call the
function get title and then I will match
it with the test measure so test measure
if you can see here is of mature class
so the the previous line the if
that's the problem confusing if that's
the matcher
so we're passing out a semester and the
reason why I did it this way it's
because you can also pass in a different
mattress so you can also do something
like starts with and with contain so
it's much more powerful than if you're
just passing a string so those are all
again hem crass bachelor you don't even
do right the function starts with you
can just pass it in so with this since I
just swap it in to my helper function
then I'm done right although all the
code I'm trying to verify the toolbar
title will now use the get title
function so this is how you write a
custom matcher what well is in this
particular case because what I want to
do is I want to verify the to power
objects so by giving it as a generic I
can have access to the functions so I
can verify so I've also written matches
for example that I can verify the text
color of a text field so for example
expresso you can do the with text to
find out what is printed out but I want
to know what color is textview provides
that you can use that you can ask you to
get you the current color right so can
unwrap it inside a bounded matcher and
then in the match safely function called
the get current color function yes I
already covered that again there's a
full example that's even the blog post
if you want to read again what is
actually what I just said but if you
want to read improve go ahead and do
that now something more interesting on
data has anyone used this matter what
does this do
you are half right it checks the list
view but not recyclable so we'll get to
that
so yes the on data allows you to check
on the list view so for those of you
have not written it before you may be
wondering why do you need a different
thing so the problem with what the
problem is the way listener is done is
that the views comes in and out as you
scroll because it's using the same view
but just swapping into new data to the
supply so you cannot just say oh I'm
going to look for the view with ID list
item that doesn't not go into work so
the formula for using on data is similar
to the on view if you compare it
side-by-side except you have some extra
things like COD data option we kind of
get through an example and it's much
easier to understand so one big thing is
instead of a view matcher you have an
object matcher so the way on data work
is that it will instead of look for a
view it will look into the data
essentially your array for example if
you're displaying an array of strings
you'll look for strings rather than
views like tech news and the data
options hope you can see it is things
like in adaptive view so for example
even if you're just if you just define a
look for the data but you have multiple
adapt of your multiple list views in
your app then it doesn't know which one
you're trying to match so you can give
it a matcher so this time you can do for
example in a depth of the view with ID
list in outer ID list and you can also
do things like on child view so maybe
you pinpoint that particular list item
but then it has two text views and an
image view inside so you can use on
child view with ID or the ID the image
or something like that to do further
matching here's an example I have a
pretty benign looking ListView and what
I'm gonna do is that I'm going to look
for item 27 and verify that is age 27 so
why not the bad that's a problem right I
can't see item 27 but the beauty of on
data is that it will scroll for you yet
another reason why you want to use on
day
just a very quick kind of like how the
app is set up I have a array that is the
data that is a type item side I made 30
of them and iteration filled it in and I
used to initialize my list adapter and
the item is pretty simple it has an
integer and then when it needs to be
display it displayed the value of the
integer so now when I guess more
complicated than I initially said
there's also an onclicklistener so when
I click on an item it's going to display
in the footer just because writing a
demo app so now we go back to the test
and say let's run a test to verify that
before I click on any list item the
footer is not displayed I click on one
of them and then it will display with a
matching number so this English and
translate it into expresso I said before
I click anything so in the beginning of
the function I want to find this is the
footer text view on veal with ID tax
check that it matches that it is not
displayed okay so it's very similar to
what we did earlier of the not enabled
not enabled next we are going to use the
on data with value 27 to pinpoint that
particular item in this particular depth
of view in case the multiple of them and
then we'll move on click on it once we
are there we repeat what we did earlier
except this time we actually want to
make sure that it has the proper tax and
it is displayed so so far everything
looks pretty good just one tiny thing
with value is not an expresso function
you have to write it
o our best friend bounded matcher here
again this time when still founding it
to a toolbar we're binding it to a item
so I pass it in at value of 27 that I'm
looking for and then in mesh safely I'm
going to see that it matches to the item
so that's what Express will go through
it looks for an item as a a are you 27
27 and if it's not it just keeps growing
and keep looking good all right
recyclerview so yeah i've a gentleman
here already mentioned it so this
recycling will look pretty much the same
as our ListView however you cannot use
on data with it does anybody know why
good I'm gonna teach you something the
reason why you cannot do it is that
recyclerview actually a viewgroup not an
adapter view and even though it looks
surprisingly similar under the hood they
are actually very very different so when
you're working with recycle view you're
actually going to go back to use on view
ends up on data so let's go through an
example here is the same test car
functionally Ram we've verified that the
food is not displayed and then we are
going to click on the item and then
verify that it's display however the
meat of it
it's completely different we start with
on view with ID recycle of you to
actually find the parent and then we go
ahead and perform this really really
long function which is available to your
expresso
so in in the recycler view actions you
can use these to pinpoint items so in
our case we are calling the one at
position so we say at position 27 click
on it so that's already different
records before we actually looking
inside and looking at the item I'm there
other things that you can use so instead
of using the position one no ok I'm
going to slide ahead
so anyway this is the this is the
equivalent of the other of the on data
case when you use it in the ListView
ah here I hope it's not too long so
besides using this function there are
other matches that are the view actions
that's provided for you in the
recyclerview actions so instead of
matching the position you can also match
it in the holder position or in the and
the item itself with a mattre so this
this get a little bit confusing because
here we're looking
the position but here what we're doing
is it's still going through other views
and then trying to mesh the view so
you'll probably want to cap go through
the recyclerview
documentation and just see what it does
again examples I love putting on
examples because I want you to go home
and actually download this and muck with
it and change it a little bit I try a
different view action and see what
happens so this is available idling
resource who has used an idling resource
before three hands okay so this we are
really getting the point where I'm
showing you something new that's cool
I'm so I didn't resource if you remember
very very early in the talk when I was
telling you that expresso knows to wait
for the UI thread to be idle before it
goes and click buttons but the other
thing that's happening in their app that
you may want it to wait as well how do
you tell expresso right the resource is
the interface that you need to implement
and for some reason is really confusing
to people so I have done multiple blog
post on it so we're gonna go through one
example in this particular case again
that's what I said expresso has a notion
of idling and these two things are the
things that express was watching for we
are going to go for an example where say
you have an intense surface and you want
to express her to wait until it's done
so what happens is this in your app you
have a button that stays do something
and instead of doing it in the activity
because it's long-running
it goes off to after in terms of us do
it and then in turn service and back and
say yeah I'm done and can update the the
you I don't setup and this is the code
for the actual idling resource so it's
an interface and there are three
functions that you need to override the
first two are kind of boilerplate it
needs to get a name because when you're
registering your resource it need a key
basically so that it can keep track of
them so usually I just give it the class
name and then there's this callback you
are just stashing away the callback that
at some point expresso will give you a
call back so that you can use in this
function so is I don't know now it's the
meat of your idling resource you're
going to basically expressions
one after you register the item resource
express one's going to come along and
say hey are you idle by calling the item
malfunction and you return true or false
in our particular case we are trying to
make sure that the intent service is not
running so in the next slide that's
going to be actually implementation of
this but let's say we have this magic
helper functions that will tell us
whether my intent surface is running or
not
and I say if it's not running then is
idle when is idle I can go ahead and
call this callback that I special way
here so that I can notify and expresso
and say is idle go ahead and do your
things so that's how idle resource is
structured so like I said this is the
magic helper function basically what
we're doing is we're querying the
activity manager for the particular name
and make sure that the one that we are
looking for well it's there then it's
running right if it's not there then
it's not running it'll be confusing
records then one level later with negate
so this is if it's running if I can find
it then it's running so once you have
define your idling resource then you
need to register it so that Express will
know to actually ask this particular
item resource like hey are you idle now
before it moves on like I said very
confusing topic so I've written a lot
about it and one other thing that I want
to mention because even I forgot is that
Express or only check the idling
resource if it's trying to do a view
action or view assertion so I have done
things where I am like oh I registered
an island resource and then I'm going to
go check some Java level thing and then
it was not actually waiting for stuff to
finish because what happens is that if
it inserts itself in the view action and
the via certian so things like on view
and click and matches and those are what
I'm talking about so make sure that you
are waiting at those points if you're if
you think Express was waiting and it's
not waiting is it could be because that
you are not at the point when is acting
on the view action or a view assertion
good
okay all right so now this is the point
where I think things get really
interesting
expresso alone allow you to click on
things and exercise code paths and
verify things but a lot of times as
Android developers when we want to test
it's more of an architecture problem for
example we are going to go through an
example where your app depends on the
current date how am I going to verify
things it's going to change every single
day so dagger and mockito allows you to
set up a test environment that's
predictable and repeatable data that's
dependency injection that's a fancy term
all it means is that in your
constructors it's going to have a
central repository to grab objects from
this way you can have one repository of
objects for your app and a different one
for your test oh wow I just said what I
wrote on my slide that's pretty amazing
and makino is what you can use to
provide those objects in your test so
that you can control for example today's
date so this is how the basic formula
for dagger - I'm dagger 1 is different
what we need to do is when I say our
repository of object what I'm talking
about is a component so here I have
defined a component and it knows that it
can inject fields into the main activity
and I have two different subclasses
the application component which with
empty meaning that it only rejects
igreja only injects into the main
activity and there's a test component
that it will inject also into the test
and they are Singleton's because we want
the same object to be used in app and
test so that when you change it in your
test your app is actually using that
object and here the way the define was
inside your component is by these
annotations so for the application we
will have a clock module that will
actually give you today State and in the
test component will provide a mock clock
module so that I can control what date
gets used
and I have given you also a beautiful
diagram in case these doesn't make sense
and what my explanation is makes sense
so this is just a graphic representation
of what I just said right so here I have
an application component which injects
into mini activity and it has a clock
module that knows how to provide a clock
and then in test will have a mock one
and it will be injecting into both the
test and the app in the application in
your own create function we are going to
go ahead and instantiate one of these
application component the reason why it
has such a funky name is that what you
define the application components is
actually just an implementation dagger
we'll go ahead and do some code
generation behind the scene and generate
this class for you then you can go ahead
and use this class and create an
application component and stash it in
this variable and then we are actually
also going to have a set component
function because we're going to use it
in tests so what happened is that when
is tests actually it's probably going to
be in the slide just you know maybe I
shouldn't get ahead of myself so let me
just get into the next slide so here
what we are going to do is that so
special way what you what I just said
the the part that we have an app
component and then we also have a set
component function which is used in test
so in tests we are going to have
something different for the function get
now so in the app have you used
joda-time that's a really nice date and
time library for Android and for Java so
daytime is what the Jordan I'm will
provide you if you just give it with no
parameters
it will give you today's date and this
exact moment in the test what we're
going to do is we are going to go to the
view that has the ID date this is
actually attack view and then we're
going to verify that it will display the
text 2008 - oh 9 - 23 if you don't use
makino and you don't have control over
the clock what an everyday that you run
this
it's going to display a different string
so you can't really test that um so
that's the power of using Makino and
dagger dagger allows you to provide
different components to your app and
your tests and mockito allows you to
mock the behavior of that car so if you
look at it again the syntax is like when
this function is called then return this
particular object you don't actually
need to like write a function to define
things so it's all very fluent and you
can you can divine find a lot of
different things in Makino again blog
post repository this one is slightly
different because I actually have a
course a video course that's
pre-recorded that I actually stepped
through a one particular example the
example is using shared preferences
because when you think about shared
preferences it changes the state of your
application right so maybe the first
time you open this app someone say that
my favorite animals cat and then the
second time you come back and want to
show that it's a cat but you don't know
whether it was provided or not and you
don't want your test to where to modify
the state of the app right because then
it's persisting and the next time you
run you don't know whether it's going to
be having an initial state or not so
using dagger and mockito
you can also do things like that you can
provide an in-memory share preferences
which every time you run it is going to
start from fresh new stuff go and delete
your database of the app so that is
actually a course that you have to pay
but since you are all here there's a
coupon code PA PB kill if you go there
and you check out you can put that in
for a discount so in summary we have
gone through a lot hopefully you still
remember despite all the drama of what
we learned today
that's the basic formula of expresso
where we have a matcher a view action
and a view assertion with that you can
combine them to pinpoint a particular
view we were using the example of a
toolbar and then we actually use the
same example but this time draw a custom
measure because we actually want to use
the toolbar to get title function after
what that we went through how do you
test something in the list view and the
recycler view was surprisingly
it's very different different oh they
look very similar on the surface then I
went through an example with you on the
idling resource and finally kind of I
think most applications will need to go
beyond just using espresso and their
game akhira to other libraries that is
often used in conjunction so that you
can set up your test environment and
have control over the data this is some
bonus I actually wrote this app and open
sourced it in August it uses the nearby
API and it's completely on github
you know also download on the Play Store
if you want to just check out what it
does well I'm gonna explain to you what
it does is that you will click on that
button that says Google+ sign-in and you
will sign in and then you will open this
screen to find nearby devices that also
has this app and then you will exchange
some information how on earth are we
gonna test that how are we going to test
Google+ login how it'll test nearby
devices well guess what this app has
really really high test coverage because
of other techniques I showed you I used
a girl makino so I actually have a
bridge what I call that instead of
calling the Google API client directly I
call through the bridge so I call on pre
on connect on connect and you cut the
connect function of my function through
the bridge and then I can use mojito so
that always someone called the connect
function then I'm going to capture it
and then call them on on connected
function and spit it right out back and
run the callback for them so it's
actually really advanced so much more
advanced than what we have gone through
before but it's completely open so go
ahead and study it and they are also
beyond that we don't expresso testing
also has J unit testing which is testing
on the pure Java level mostly on the
models right so if you're my mother I
mean in a POJO like a java object stores
different fields in there so you should
make sure that if you initialize it this
certain way it has certain data in it
and then I also have what I call your
ILS instrumentation meaning that is
instrumentation in the sense that you
still have contacts you still have
says to your standard enjoy libraries
where when you do a unit you cannot do
bundle you can do all these things but
there is no UI so what I'm using that
for is exercising the database code
essentially so I'm creating a test
database and then I'm storing things in
it and then I'm calling some function
that will read the database and then
give me some gift I'm trying not to kick
anything give me some statistics back so
that's that's that example day as well
and then of course there's a lot of
expresso going on so go ahead and play
with the app again download it change it
and see what it does and if you don't
think this is awesome and you don't
trust my word I have someone who said
that there is some seriously bad as
testing come flow on display thank you
I agree with himself but you have to go
check it out and see if you'll agree
that there's some serious badass testing
kungfu on display in this repository
with that thank you very much and these
are a lot of different resources that
we've covered already the first one is
the slide deck and then the rest are the
example code that you can find on github
and also i actually also author video
classes on perl site which is a
subscription-based service you can also
check that out and there are the things
i teach and then other places you can
find me on to the internet story list is
read along I have two newsletters I have
a blog I have Twitter I have Google+ so
plenty of ways to find me so one other
thing that I didn't have time to ask sly
for is that a lot of people tell me that
there is so much effort in doing testing
like why would you bother so I just want
to give you like one reason why I do it
myself I work with startups and a lot of
times they will have a server team they
need to implement some server change
before I can implement the Android UI
change and they're slow they're usually
slower then like you know we will do a
sprint and then they'll let's go and
implement them and I'm supposed to be
implemented in that sprint and I'm
holding my breath and waiting for them
to implement the server change well no
more because I have mojito I actually
use mock web server
so what I do is that I have my test and
all I need to do is agree on the Java
and other Java the JSON format with my
server team and then I would just mark
out whatever I expect the response from
the server it's going to be and I can go
ahead and write the UI code before they
are ready and I can even test bad cases
right what if I get a 500 error like
what would my app behave
you don't usually test the happy path
and it's really difficult how are you
going to do that in a real life scenario
you're going to like ask them to shut
down the server so they can test your
500 case no right but in our case if I
have said on my testing infrastructure I
have complete control of what my mock
server is going to do and I can go ahead
and write my app without the server
ready by testing so testing so that's
actually how I use testing which of
course then the side benefit is that it
is actually automatically running right
so I can also catch regressions so
sometimes I would change one thing in my
style thinking that will be all good but
then Express will be like yeah you said
the color supposed to be gray is
actually purple now so I can also catch
regression because I have written my
test so I almost looked at that as a
side benefit of like the testing part
like the part I really like is the fact
that I can mock out the server and then
I can go ahead and write my app with all
my server team being ready so with that
thank you very much thank you for
tolerating with my kicking of the stand
feel free to leave but I can also take
some questions right now yeah
okay so the question was because of
technical difficulty we were interrupted
right at the dagger point which is kind
of tricky so he wants to know how you
can set up dagger two if you go to my
github repository there is a sample
project that is called Android - test -
demo it uses dagger - mojito and
expresso - and that's a blog post that's
linked from there in the readme so I
hope that the blog post will explain
pretty well half step by step how you
set it up yeah you can refer to that yes
question
okay the question was can I improve the
idling resource for the intense service
so instead of checking whether the whole
intense service is running can I check a
specific task I don't know off the top
of my head
whether intense service is queryable if
there make any sense that I can ask that
what is running and it's kind of not
really expressive specific right because
it's basically intense service specific
you're trying to detect whether your
particular task is running so sorry I
don't know sorry yeah question
so the question was he has a viewpager
that has multiple recyclerview on the
different pages essentially and he will
swipe and said okay this one is the
visible and I want to test it but
secretly the other the either recycle
used to hanging out because that's how
he can swipe back in and he's asking how
can I make sure that I'm verifying the
one that I want to verify right that's
that sound good give them different IDs
does that work oh I see so they're
dynamically so the the dynamic test show
is not going to be using the IDS that is
from the XML file okay
he said he uses dynamic tests I think
that's reasonable I mean I was going to
suggest something similar right you can
just issue you your IDs essentially to
them and then you can verify them but
that's gonna be random though so if you
have something that is predictable then
you can go look for them so you I think
you are doing something quite very
reasonable I mean there may be better
ways but I cannot think of it right now
yeah
so the question was get real now how
much time did you spend on writing there
are your tests so it's true
like to set up like you actually add
some complexity by using dagger and
making it so that you can mock and
whatnot
I have not clocked the hours that I'm
strictly writing tests versus I'm
strictly writing the app because the way
I describe my work right
I used the test to drive my app I will
mock out of the survey response and then
go implement something in the test and
run it so for me it's a very integral
part of my development habit essentially
so I can't really tell you specifically
how much time but what I can tell you is
this there are times when it's such
things that I would not cut on my own
for example what I did was I did a map
fragment which I was inflating
dynamically rather than statically for
some reason and when I upgrade from
Google Play services I don't know six
point five to seven or something some
version it broke and usually I don't go
to the part of my app that has the map
on it because it's karf not on the main
use case but my test caught it right
away because I crashed so I feel like
the value it's very hard to quantify
like what if I when I didn't have the
test then it will probably be launched
with that crash and people will yell at
me from the internet and then I have to
go find out so I don't really have a
hard number for you but I find it very
it's worth doing I think that's the
short answer but and you have to trust
me on that because I don't have data for
you cool well thank you very much I'm
going to stay around a bit so we can
chat offstage as well okay thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>