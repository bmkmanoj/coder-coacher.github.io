<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>DevBytes: Bounce Animations | Coder Coacher - Coaching Coders</title><meta content="DevBytes: Bounce Animations - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>DevBytes: Bounce Animations</b></h2><h5 class="post__date">2013-01-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/vCTcmPIKgpM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi I'm Chet Haase an engineer on the
Android team at Google I work on
graphics and animations and today I
wanted to talk a little bit about that
specifically I want to talk about value
animator and object animator and now you
can get different kinds of movement on
the screen so let's take a look at a
quick demo I call this bouncer I have my
little electric sheep at the top of the
screen and I click on the screen and the
Sheep moves down in a very boring
fashion to the bottom of the screen
not much of a bounce so let's take a
look at another variation which I call
bouncer one so we run bouncer one and
now we're actually going back up to the
top of the screen which is a good start
it's actually continuing to move which
is kind of what balancing is about but
it's got this weird sort of linear
oscillation thing going on so let's see
if we can do a little better we have
this other variation which I call
bouncer two and click that and all of a
sudden we've got a bouncing motion so
we'll see how we create that with one
line of code and finally we've got this
other variation called bouncer three
which is going to look remarkably
similar to bouncer two we've got the
same bouncing gravity motion going on
there the interesting part is in the
code and how that one was created using
a different kind of animator so let's
look at the code now so we've got this
bouncer file go up to the top of it
you've got this activity called bouncer
we have a custom view where we're going
to be drawing this sheep as it moves
around on the screen and here we have a
set up shape where we decode this
resource so this is the electric sheep
thing that I spent hours and hours
drawing because it's such complex art we
get the width and height of this thing
to position it appropriately later so we
can sort of Center it in the screen as
we change the position properties of the
sheep to put it in the center of the
screen or to move it down down and back
up the screen during the animations we
call these setters set shape X and set
shape Y and this one basically figures
out the only reason there's any complex
code in here at all is because we need
to invalidate the correct area so that
we erase where the sheep was
and then draw the shape in the in the
correct area otherwise we're going to
leave litter artifacts all over the
screen if we're not erasing correctly or
if we just do an invalidate of the
entire view then we're basically going
to be doing too much work because
there's no reason to reate to erase the
entire view if all you did was move the
sheep from here to here so we get the
Union rectangle and we invalidate
appropriately and we do this for both of
the centers here on sides changed this
allows us to Center the Sheep or
proprietary drawing the sheep on the
screen we simply draw the bitmap at the
shape X and shape Y properties that were
set before for running the animation we
have the start animation method here
that gets called when you click on the
thing and we create a value animator
object and this is one of the new
classes that was created in the 3.0
release part of an overall more robust
timing and animation engine value
animation animator is basically the the
timing the meet of the entire animation
package it's the timing engine between
object behind object animator animator
set and view property animator and we'll
see all of these in future episodes and
all it is is a timing mechanism a timing
and value calculation mechanism doesn't
know about views doesn't know about
objects at all all it knows how to do is
to calculate values based on parameters
that you give it for the start and the
end values as well as durations and
other properties which we'll see today
so we create this value animator by
calling get value animator this comes
down here and says value animator dot of
float and this is going to calculate
animation values between starting value
of zero and an ending value of one and
then we add an update listener and if
you use value animator which is a more
manual way of doing an animation then
you probably want to have an update
listener and this will get called on
every frame of the animation and then
you can do whatever you want to with the
values so every time we get a call let
me reposition this code a little bit so
you can actually see it on the screen on
animation update we get a reference to
the animation object itself and then we
can get the
animated fractions so we can find out
between value of 0 and 1 what is the
current animation fraction and we could
also get the animated value at that time
if we wanted here we're just going
between 0 &amp;amp; 1 it doesn't really matter
and we basically use that animation
fraction between 0 &amp;amp; 1 to effect the
height of the sheet so we basically want
to move the sheep from the top of the
screen down to the bottom of the screen
minus the height of the sheep so we're
going to take the 0 &amp;amp; 1 factors that we
get during the during the animation
itself and simply apply that directly as
a proportion of the height at which the
sheep is drawn and that's all - bouncer
so it gets a little bit more interesting
once we start adding actual bouncing
capabilities all this one does is
animate the thing down to the bottom of
the screen in a very boring fashion
bouncer 1 is a way to do that with a
little bit of repetition this is the one
that oscillated down to the bottom of
the screen and then back up so here we
get value animator same exact thing
going on
but we also set a repeat kind of
infinite which means it's just going to
repeat until you finally quit the
application because it's not very
interesting and it's also going to set a
repeat motor reverse so when it reaches
the bottom it's going to animate back up
to 1
internally what that means is the value
animator is going to run from 0 to 1 and
then back to 0 and ad infinitum until
you kill the application then we start
the animation ok that was the second
animation the third one was the one
where it was actually bouncing it was
speeding up as it fell down and then it
slowed down as a windbag up sort of a
gravity motion to it so that logic is in
the bouncer to file and it's exactly
like the previous one we looked at
except for this one line of code where
we set an interpolator an interpolator
you can think of as a way of
reinterpreting time and by
reinterpreting time we also reinterpret
how the values are calculated because
those are based on the time value so
here we're saying use an accelerate
interpolate er which means the longer
you go the faster you're going to get
but then interestingly when it reverses
it's going to use the interpolate er in
Reverse so it's going to speed up on the
way down to 1 and then it's going to
slow down back up to 0 and that's how we
get the bouncing behavior as we go down
and up the screen and then finally we
can take a look at the bounce of three
file which
produced exactly the same visual result
but with a little less code this gets
into use of the new object animator
class that also came out in 3.0 and this
is a class that specifically not just
about animating values but about
animating the values on a target object
and a set of target properties in
particular we're going to have an object
animator which is created right here
that's going to animate integer values
it's going to use this target which is
the custom view and we're going to
animate the shape Y property which is
just a string that we're passing in
which will then use reflection or j'ni
underneath to say okay well given this
string name is there a setter of this
type that I can associate with this and
then call that setter over time to
animate and in fact it does find that
because we have the set shaped Y setter
that we saw earlier and it's going to
animate that property from the value of
zero to the maximum value so you can
compare this to what we saw before where
we created the value animator and then
we needed to use an update listener to
actually use that value over time object
animator does that all for you you
pointed at the target object to animate
the properties in that object to animate
and the values to use then you simply
start the animation and away it goes it
calculates the values it sets it on the
target object and it's basically a set
and forget thing you create the
animation you run it and you're done so
this was a little bit about the property
animation system that started in 3.0 so
if you're running on devices with 3.0 I
would suggest you take a look at these
classes in addition to the view property
animator class which we'll see in a
future episode thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>