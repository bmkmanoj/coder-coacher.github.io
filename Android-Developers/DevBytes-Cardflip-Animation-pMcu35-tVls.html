<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>DevBytes: Cardflip Animation | Coder Coacher - Coaching Coders</title><meta content="DevBytes: Cardflip Animation - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>DevBytes: Cardflip Animation</b></h2><h5 class="post__date">2013-09-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/pMcu35-tVls" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi my name is Daniel Shan ski I'm Chad's
intern here on the Android team at
Google and today I'll be discussing a
few car flip animations so today I'll
just show you how to flip cards both
from side to side out and in and as well
as a few little tricks on how to do
graphic animations on on darkening and
spinning the cards when you need to the
main trick to today's animation is going
to be the fact that after every single
animation we're going to update the
layered parameters such that previous
animations future animations are not
going to be dependent on the values of
previous animations so be animating the
properties but then at the end of every
th single animation we'll be setting
them all back to zero such that any
future innovations won't be depending on
what has been done before so going
straight into the demo here we have a
stack of red cards I can use touch
events to flip it from right to left
similarly you can flip it from left to
right the the speed at which the
sentiment is actually dependent on the
speed at which it fling it you can also
swipe down to open a stack of cards or a
swipe back up to close the stack of
cards slice the boats text or if you tap
on the stack then there's little delayed
animation showing you how to rotate a
full stack of cards completely so
jumping straight into the code there's a
lot of boilerplate code that you can
look into where at where I you handle
all the touches of to me which way I'm
flinging and things like that but the
interesting things happen here in card
view so scrolling down initially one of
the things you need to note is that
views and in turn image views have this
property called set camera distance so
what this actually lets you do is set
the position along the z-axis of how far
you want to be from the actual animation
originally in this animation if you were
to set it back to its default value
you'd see that we don't actually see the
flip animation because it happens behind
the screen we as after that we retrieve
the bitmaps that we use for the front in
the back of the cards and keep going
down here there's actually this is
important to note we what we're doing to
the bitmap drawables is adding a one
pixal transparent border and the reason
we're doing this is when you're rotating
a when you're rotating a rectangle and
within some view the the edges don't
actually have any values that they can
retrieve outside the boundaries of the
rectangle so you get end up getting
these very jagged edges when you rotate
a rectangle but this problem can be very
easily abided simply by having a one
pixel transparent border and it's done
right here and then you'll see that the
edges are actually smooth as you rotate
the cards then there's two methods flip
from left to right and flip from right
to left before we actually call the
flipping animation we need to set the
pivot by default that x and y pivots of
all views are a long center so if you're
rotated would only rotate about its
center but saying this manually would
give us more precision as to how we want
to animate it then there's a method
called flip horizontally after we set
the pivot what this does is set up a lot
of use property values holder object
animators and things like that to
actually animate the rotation of it from
along the y axis by 180 degrees we also
add a translation animation such that
when it finishes animating it's in the
correct offset within the corresponding
pallet that it animated to and what
we're also doing is adding an update
listener such as as its animating we
need to make sure when it reach the
halfway point and at the halfway point
we want to switch the draw go from the
red bit map to the blue bit nut border
the other way around because it's on the
other side now going down farther or
more we're setting up I'm setting up a
few keyframe animations on a property
called shadow this is a this is a custom
property used to darken the image as its
as its animating which I'll show you in
a second
scrolling down even more I set a
duration using the velocity passed in
from the fling and then use an animator
an animator set to play all these
together at the end of the animation I
need to update the bitmaps and set some
default values back to back to their
default values so like I said I'm
animating and custom value a custom
property called shadow so since my
string is shadow my object enemy
just going to look for a property on
that target called sad shadow right here
and all I'm doing here is using an alpha
using alpha blending and Porter tough
mode multiplied and all this does is
just darken the image as its animating
and that's how you get that shadow like
effect toggle front showing simply
switches the red and blue bitmaps as
which is the flag determining which
bitmap you're using and there's some
more very simple set up thing that
boilerplate code to do some set of
things here as well so the thing is an
on draw when I'm flipping when I'm
flipping my card instead of actually
creating a new bitmap that's where it's
on Thalia mirrored from my original
bitmap all I'm really doing is
concatenated this with a matrix that
does diag that exact same thing so this
one it's a lot more efficient doesn't
use as much memory uses the exact same
bitmap but I'm still able to achieve
that horizontally the horizontal
mirroring effect of the of the image
after I've actually flipped it and the
reason I need to do that is because in
update layer parameters
I set the rotation X&amp;amp;Y back to zero
that's what I'm trying to do here I'm
making trying to make any future
animations be independent of what they
were before but in order to achieve that
I also need to update my my left the
left margin of my layout parameters to
be exactly where it is after the
animation and then of course update the
parameters as well so this in
conjunction would drawing customizing
the canvas when I need to let's me
achieve this whole independence effect
after every single animation again some
simple code to offset it where I need to
switch the bitmaps and then so here it
is here's the code for rotating the
actual card what this does is determine
determine what angle I should rotate it
by depending on how far the card is down
the stack and then I simply return an
object animator that rotates that view
by that angle the other thing that I
also that I can also do is when I tap on
a card and all the cards flip in a
circle with certain delay between them
it's almost a sitz all
same animation except the angles or
which 360 degrees but the other thing to
note is that you need a start delay
every the cars on tops are animating
almost immediately where's the cards
underneath only start animating when the
all the cards above that card I've
already gone past a certain point in the
animation so I add a different start
delay depending on where the card is and
then I play all those animations
together and the other thing so that's
how you actually get the animations for
every individual card and if you look in
the cárcel activity which is the main
activity all I'm doing here is looping
through all my cards when a some stack
has been tapped
I'd retrieve that object animator that I
can get from my card view and the other
thing I'm doing is bringing that child
to the front so depending on how I've
been flipping the cards I don't exactly
know whether all the cards in the left
and on the right side are on top of the
cards of left side so I'm just a
quantity calling brain child to front to
change the set order of all the cards in
the stack that I'm animating and the
other thing you need to do is always
call request layout after you've called
brain child to front in order for those
effects in order for that change to take
effect otherwise you'll have to wait for
a child to be brought to front until
somebody has requested a layer on your
view very similarly in order to achieve
the full chord rotation I am retrieving
the object animators from all the cards
bringing the objects the front and doing
almost the same the exact same thing
except with a different object animator
which I can retrieve from my card view
so that's pretty much how you can flip
cards rotate them and animate them in
different ways thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>