<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>A window into transitions - Google I/O 2016 | Coder Coacher - Coaching Coders</title><meta content="A window into transitions - Google I/O 2016 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>A window into transitions - Google I/O 2016</b></h2><h5 class="post__date">2016-05-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/4L4fLrWDvAU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello hello everyone thank you very much
for coming to this talk a window into
transitions it's one of the last talks
of i/o or the ultimate talk if you will
my name is Nick butcher I'm joined by my
colleagues Ben vice and George mount
we're engineers on the developer
relations and Android engineering team
okay so we hit here today to talk about
the Android transitions API
we've got a lot to cover so we're just
going to jump straight into the topic
and get going so first up transitions
what are they the basic idea of the
transitions API is to help you and teach
and whenever there's a change in the
scene where scene is basically a view
hierarchy on screen so the idea is that
when a scene changes my animation
doesn't work properly ironically and we
perform a transition so transition being
look at what has changed and then
animate that difference so the API for
the transition is it's pretty simple it
just exactly this thing what has changed
firstly there'll be two callbacks into
your transition which is capture start
values and capture end values and
passing in this object this transition
values object so this object has the
view and you can look at the view and
capture properties about it and save it
into some kind of map in the transition
values and so you do that in a start
state and the end state and then we'll
call the create animator method giving
those those two states and you create
animators to you know animate the change
between those two states cool so that's
the very basic API covered off there's a
bunch of transitions which come in the
android framework which you can and
absolutely should use so let's have a
quick survey of what they are so you
know what these learned primitives you
can build with are the first and super
handy one to know about is and the
change bounds transition so this will
help you out whenever you are moving or
resizing a view and it will animate the
top left and bottom right properties to
help you move it around and crucially
this change bounds also helps suppress
layout so you don't want to be calling
request layout repeatedly because that's
going to be bad for performance whereas
change bounds will do this in a
performant way for you secondly and is a
fade transition we
as the name suggests helps fade things
in and out so anytime an object's
visibility changes or get added or
removed from the hierarchy you can run a
fade to ease that change and lastly this
is awesome little guy called the Auto
transition which will put some of those
things together so when the hierarchy
changes it will fade new and newly
arriving things in it will move and
resize items which remaining or changing
position and then fade out anything
which is disappearing very handy in API
21 a lollipop and the transitions API
got a bunch of new and exciting and
additions first up was the slide so you
can anytime anything's entering or
exiting the scene you can like do so
from an edge you know kind of like nice
stack at a Manor and then it's in a
bunch of transforms for whenever you're
changing the bounds so you can actually
just clip the mounds of something
changing size or if you doing a change
transform which will affect the rotation
and scale of a view or if you're doing
an image say you're changing from one
scale type to another scale type and
this will help animate the changes to
the matrix of the image view and to
change between those scales their
transitions object itself got some
upgrades in 21 and so firstly it got
this thing called path motion which
basically allows you to control the
movement and along a path so here for
example we're looking a and transition
which is a shared element and we can
control the path that it follows when it
moves from one state to the other don't
actually do this kind of horrible loopy
thing this is exaggerated for effect
please don't do that and the classes
you'll probably want to look at and when
doing this kind of and controlling the
path is called arc motion and pattern
path motion and we'll return to those
later and lastly the transitions API got
this new and ability to control the
propagation and epicenter so what these
two properties that you do and is to
choreograph the way they're group of
views are going to move easiest shown
with an example so in this example here
when I click on an item see how the
views around the grid all move out
together this is called an explode
transition but basically this and by
passing in the epicenter which would be
the view you touched on you can then
like set the start delays on the other
views which are exiting as well in order
to have this coordinated movement so
these are the kind of API is to look for
if you're trying to build this kind of
them transition yourself so that's
transitions it turns out that and
quite frequently when you're changing
scenes and if want to perform an
animation on those changes is activity
boundaries so when you're going from one
activity to another so API 21 added a
whole bunch of new api's to help do this
kind of thing and which we call window
transitions there's two main types and
the first type is a Content transition
so that's when a window exits or new
window enters you have an opportunity to
run an animation on the content coming
in so in this example here if we go from
the grid and we launched into like a
details type screen wearing an enter
animation on the views coming in and the
details where they're sliding in from
the bottom from the bottom the second
type is a shared element transition so
this is where I went to further go back
okay a shared element is where when you
tap on one view the element transitions
smoothly from one activity into the
second activity and as you just had a
sneak peek of there those two things
aren't mutually exclusive you can of
course run a shared element and the
content and transition as well so here
we are sharing a view and also sliding
in the unshared content as well now a
note on shared element views like a
shared element transitions excuse me you
can't actually share a view between two
activities you can't pick up an image
view from one activity and supplant it
into the other one and so what we do as
many animation things API is do is kind
of like fake it allow you to give the
appearance of what that's what's
happening while still you know
maintaining your even one activity or
the other so the way we do it is when
you click on an image in the source
activity we record some information
about that view and a small amount of
information like the position and bounds
and a few other things and then we pass
that information over and to the
destination activity so we then launch
the destination activity but don't show
anything just yet
and then we layout and measure and all
the views in the destination activity
and work out where that shared view
wants to end up then we do something a
bit sneaky we actually we've applied
transforms to the shared element in the
destination view and to kind of put it
back into the position of it was in the
source view and then fade out any
unshared competent so at this point
nation activity is launched it's the
activity on top but it you know it
appears as if you're still in the source
activity because it's been transformed
to appear so then we simply run
animations to move the share element
back into place and fade back up any
unshared content voila
looks like you share the view from one
activity to the other that it hasn't so
this is important to remember that
everything happens in the destination
activity you're never actually changing
the view in the source activity other
than hiding it so shared element and
content transitions can run and a number
of points so there's a kind of a life
cycle to think about here so when you go
from one screen to the other so when you
call startactivity you have the
opportunity to run and transitions on
the exiting source activity and on the
entering destination activity and then
on the way back you can also then
animate on the return and re-enter so
these are the four points you can hook
into and it's worth noting that these
kind of come in pairs and such that if
you were to set an exit transition from
the source activity so you know do
something with the views on the way out
well by default if you don't specify a
different reenter and it will just run
the same transition and in Reverse so
you but worth bearing in mind that's
what's going on there so that's in a
nutshell what the transitions API is
trying to do to give you an example of
how to do it Ben's going to walk you
through an example application that
implements these API
Thank You Nick so as you saw we had a
couple of transitions going on there and
let's see what we're going to claim it
we will have an application having a
master activity and a detail activity
and once you tap on one of the items it
will move the image and perform a couple
of other transitions so let's get
started we have the app we have our app
we are before we actually got started
with the with the transitions this is
what the system gives us we type of
phone and we use and the detail
activities slides and fades in pretty
cool but in order to do the transitions
use the transitions API what we want to
do is we first enable the window
activity transitions within our app
theme
or simply and heard from theme that
material or as many of you use it app
compat is also inheriting from theme
that material on lollipop and plus so
once we got this we can go through the
next step and do it the shared element
transition for the image view in order
to do this we set a transition name on
both the starting and the target view
and remember those have to be or should
be at least unique for the view
hierarchies in order to avoid a couple
of issues that we will cover later on
after we have taken a look into this we
need to tell the system how to actually
deal with the shared element because as
we just learned
Sharyn key element is something that
happens within the receiving Zoar the
detail activity so we have to tell the
system that at the point where we
actually started a new activity that a
couple of things have changed we do this
by calling the make scene transition
animation pass it the image that we want
to share as well as the identifier for
tag of view so the name that we just
said on that pretty cool pretty
straightforward and awesome to use after
that we add the exiting transition for
the grid which is the explode that we
just saw which is probably one of the
things that you should think about if
you actually want to do it because it
can confuse users it can be very handy
as well on the other hand so make sure
that you don't just throw explodes in
everywhere because it can be not helpful
on the other hand as well so to do this
we create a transition and get
transitions folder called grid exit and
we just say explode and that's it from
the Declaration of the transition pretty
straightforward again we then set that
in we then have to declare the window
exit transition within our homes
activity home activities theme and as we
just learned this will be replayed
reversed on the way back in when the
activity has its reenter transition when
we press back on from the do tha video
let's go and take the next step for the
detail activity we also want the content
that is not shared
we slide to slide in from the bottom you
don't jet you can't just create the
transitions from XML but you also can do
this directly within code so let's take
a look how you can do that we just
create a new slide transition we want to
slide have the content slide in from the
bottom and we want to have it ax enter
at full speed and then ease in all the
way up until it reaches a resting point
to do this we inflate an interpolator to
do exactly that
then on the window of productivity we
set the enter transition to be the
transition we just created this can be a
lot more complex than this if you want
to but to get started just adding one
transition seeing if you actually got
the right things and in place works
pretty well since we are already in the
motion of getting things feel more
natural by having them enter it very
quickly let's take a look at another
thing that Nick already mentioned it's
curved motion so usually you have just
one linear motion of the shared element
view but we want to have this motion in
the end so that it feels while you go
out while the active while the well well
the views growing it should also have a
curved path that it follows to make it
feel more natural let's take a look at
one of the transitions that we use there
we have a transition set which is a
which is a collection of different
transitions that will be run at a point
in the animation and we basically just
have to do this on the set bounds we
just say we want to add an arc motion to
that pretty straightforward again and it
helps to get exactly this this done you
can also set maximum minimum angles on
that to make sure that the user actually
sees what's going on
you shouldn't exaggerate like like Nick
earlier said so but for development
purposes this can be pretty handy so
those are all built-in transitions
let's take a look at a thing that we can
do with getting into custom transitions
we also want to share the detail text so
the title is the author of the picture
and we did a couple of things there
other than just growing just just
sharing that we also grow it and to do
this from the declaration point of view
we just go back to the transition that
we already had add another transition
add a target to both of the transition
to
have the initial transitions that only
target the photo that we already shared
then we go and add a second transition
set targeting the author that we want to
share as well and add a text resize
transition to that which is a custom
transition that George will cover in a
minute and then of course we need to
tell the system what's going on on that
things have changed so far we changed we
shared the image and it's Hargett
directly if you only have one share
element this is the right is a good way
to actually get started without it to
share this information with the detail
activity if you have multiple share
elements though you want to have pairs
which can be created in separate ways
but this is one of the ways you just
create a pair which basically all
contains the same information it
contains the detail we the the starting
new as well as the target transition
name and then instead of having this
Sonia here you just passed those two
pairs in here and start the activity as
is and after all this is done this is
the nice transitions that you get and
with that let's take a look behind the
curtain all right how's that fire hose
everyone good let's let's drink some
more all right let's talk about some
making your own transitions now we saw
the built-in ones change bounds change
transform those ones those are great
basic transitions but if you want to
change the text size for example it's
not built-in we have to do that
ourselves so let's see how we go about
making it let's make this resize text
transition all right so we need to
capture some data right and we need of
course the font size that's obvious
right we need to capture the font size
at the beginning caption the font size
at the end and we also need some other
data but when we return the data set
that we're going to track in our
transition we only want we only care
about the font size because if the other
stuff changes Relays the balance changes
only on your text view we're not going
to do any transition on that
we're only transitioning when the text
size changes so we just ignore the rest
data we still want to capture it so
that's why we have those those pieces of
information that tag that we're going to
use in our transition values but we just
don't want to keep that for the
transition API for the transition
framework so when we capture our start
values and then values you remember this
from what Nick said we want to capture
them and we said this is the same thing
and both the start in the end we have a
common function to do and first thing we
have to do is we can just throw away
anything that's not in text view right
we're only animating text views so
anything else we just ignore of course
we want to capture the font size the
text size here and we also want to
capture some other data and I just stuck
this all in its own class and to kind of
hide that information but it's basic
things like the bounds of the text view
because we're gonna need that for the
animation all right when you animate
texts what do we do are we gonna animate
the font size well if we do that we're
gonna thrash our font cache right every
font size between the start and the end
is going to be used and created in our
font cache and we're gonna have like
font size 26 point two eight one and you
know we're never gonna use that again
it's just gonna thrash our font cache we
don't want to do that so what we're
gonna do is we're going to capture a
bitmap at the start and a bitmap at the
end and we're gonna animate so here if
we if we animate just the start it looks
pretty terrible right you see that thing
blown up from the beginning and also if
you animate just from the large size
down you end up with a little bit of
kerning error in the final text view and
you might not see it here on this on
this slide but you're definitely going
to see it when you're looking at the
phone and you really don't want to see
your user user to see that that effect
you want to see a perfect transition so
instead of this what we're going to do
is we're gonna animate piecewise so we
animate a little bit from the start and
you don't really see that blown up image
right and then we're going to swap it
out for the final image just scale down
and then we're gonna animate the rest of
the way and because it's done during the
motion nobody will see that animation
that change that swapped there in the
middle okay let's see how we do that
okay when we create our animator first
thing we have to do of course is to
capture that we use our start values and
end values but here we are checking this
start values it's or null what does no
mean it means the view didn't exist
difficut exists at the beginning or at
the end we don't want to animate sighs
that's for fade right that's for the
other transitions okay next thing we
have to do of course is capture the
start bitmap right so we just capture
that bitmap that's where that extra data
is useful and we also have to capture
the end state bitmap and then of course
we have to say don't text you don't draw
yourself set yourself to transparent all
that text stuff make it transparent we
don't want you to draw it because what
we're gonna do is create a drawable with
those bitmaps that we just captured
that's gonna do the swapping for us all
right so we need to animate some things
on that drawable one of them is the font
size we're gonna have this font size
that we're gonna animate on the drawable
and we also have to animate those other
things that all that other data I
captured but we need to know that stuff
so we we get property values holders for
those and then we create the animator
right and then we're all set to return
right everyone not quite remember what
we just did we set it to be invisible
they no no text when the animation is
done we want it to go back to the normal
state so we set the text color back to
normal and we remove that overlay we
just added all right so we're all set
our transition looks great we're all set
let's put it in an activity transition
all right what does it look like
holy-moly did you do this all right no
no okay
remember what happened what what Nick
was saying about this the values are
captured in the destination activity and
when the values are captured in
destination activity textview doesn't
have the text size of the source
activities text so it doesn't even know
that it was there it doesn't know what
that font size was so what we have to do
is send that along as extra data now
the activity activity transitions system
will send the basic stuff for you it'll
send you position size and image scale
right because those are very common
things and those are the things that are
built into the system those transitions
are built into the system but the other
stuff anything that you need to animate
you're gonna have to send along as well
so we put those in as intent extras
that's easy enough and then we get that
intend extra in the target activity and
we get the our font size and then we
call this shared element callback the
shared element callback is where you put
all the really complex part of your
activity transition this is a callback
that has lots of extra stuff for you to
hook into to do the little tweaking that
you need to do and during the start what
we would have to do of course is capture
the the transition the text size of the
current textview and then set it to the
one that we want it to be in the start
and in the end of course we have to
reset the text size back to what it was
before otherwise you just animate to the
little tiny font from the start so what
happens now you end up with a beautiful
transition from activity to activity
nice and smooth now misc I'm gonna come
back I show this really awesome
transition that he made up I you guys
have to see this thanks whew
Olson and so that's been some pretty
cool transitions we've looked at so far
one of my favorite things in the updated
motion guidelines in the material spec
is it's like a section on transforming
things if you haven't seen this I highly
recommend you check out both this as
well as also awesome session IO on
Wednesday by John Schlemmer about the
updated motion guidelines this talks
about material design about how things
are you know sheets of digital paper and
so on and that they can transform from
one thing to another this transition in
particular caught my eye which is
transitioning transforming sorry a
floating action button this circular fab
into a different sheet of material and I
thought this is pretty cool and I wanted
to use this in a open source app which I
built called called plaid and I wanted
to transform from this fab here
into this and this bottom sheet which is
essentially a linear layout so unlike
the transitions we've looked at so far
which are pretty much acting on the same
kind of view so transitioning an image
viewer in one window to an image view
another or text view to a text view for
example this is like pretty different
right we're gonna go from a floating
action button basically an image button
to a linear layout essentially so how do
we do that so it's really really
important to remember as we've talked
about before that everything happens in
the destination window so in the window
with this kind of bottom sheet here so
as with most animation things we do some
tricks to make it look like that one
thing is transforming into the other so
what we do is in the destination window
we use set translation X&amp;amp;Y
to basically Center the dialogue on the
web the coordinates of the fab so where
it started from just translation X&amp;amp;Y and
then we use the view overlay again so if
you haven't used the view overlay this
is a the ability to add like draw balls
on top of and the view so we add a solid
and color drawable as well as an icon on
top of the view and locate that sits in
the center and then we run some
animations on this entire view so first
we we fade out the color and the icon we
run a circular reveal animation so that
applies a circular clipping mask and we
start from the the size of the fab and
then we animate that clip mask out to
and you show the whole dialog and at the
same time we move along a curved path
using this motion thing so when we run
all of those animations at the same time
you get this effect it looks like you're
transforming from the fab to the
dialogue and so can we see how we build
this yeah before we do you have to let's
think about what information we need to
build it so in order to build this
transition we need to know the positions
like where the fab was to where the
dialogue is we need to know the color
it's going to and the icon because as
we've talked about whether we keep on
hammering on about it all happens in the
destination window so the sheet doesn't
know anything about the fab right so how
do we get all this information so the
position is pretty easy as George said
the position is one of the few things
that actually does get passed through so
we can just in the
capture star and capture in bounds we do
the same thing we just call capture
values and we put those bounds into the
value transition values map and we'll
get access to those a bit later on so we
have the bounds of the fab and the
dialogue so for the color and the icon I
basically created a and a couple of
constructors each you can use so just
like views and transitions can have can
be inflated from XML so when we looked
at the XML translation sets that then
we're showing you before and you can
define your own transitions as we did
with the text resize but you can also
add your own attributes so here's an
example where we're doing and you know
context sort of tame style attributes
just as you would in a custom view and
you can define your own declare styler
balls and pull them out that attribute
so we could pass in the color and the
icon three attributes and just a quick
note and we're setting the path motion
here so this is what we talked about
before adding a path motion to control
the path which is going to move along
later and we'll come back to using that
in a second but as an alternative and I
also added a dynamic way of determinist
because there's actually different entry
points I have into this screen so I
can't couldn't statically declare in the
details activity what color and icon it
was going to come from because it can
come from multiple places into that
screen and so I added a constructor
which will pass in and the color and the
I plan to use and so we can do and the
technique which George talked about
earlier of using an intent extras to
pass this information to details
activity but here's the pattern which I
found really helpful for implementing
this this isn't part of the transitions
API contract but it's just a pattern I
found useful so I added a and the static
method on to the transition object
itself and called add extras so you can
call this from the source activity from
the activity which has the fab and knows
about the icon of the color so passing
those things in a static method and it
will add them to the extras for you and
then a corresponding and set up method I
call it which you would call from the
destination activity so from the
activity with the bottom sheet which
will then pull those activity those
parameters out of the intent extra
fields
and then it will actually create an
instance of this transition object which
I called fab transform itself and set
the target and then set it on the window
as a shared element enter the reason I
like this pattern is it because it means
it keeps the the keys and so on private
to the transition you don't have to
worry about exposing that it kind of
keeps it nicely encapsulated notice here
that we're using set shared enter and
element transition but if you remember
from the animation it goes both from the
fab to the sheet as well as animating
from the sheet back down so what that
means is the element the so the shared
and transition was going to get used on
the return transition as well so bear
that in mind it's going to become
important in a second all right so we
have all the information we've created
the transition objects itself how do we
actually create the animators to to run
this transition to make it all happen
first off we grab out their bounds that
we saved into the transitions values map
and hold onto those I then do something
where I just check basically which of
those is wider it's maybe not the most
sophisticated method but that's how I
work out if I'm going from the fab to
the dialogue or from the dialogue to the
fab I'll basically use that billion
later on to set up the appropriate
animation so for example if you're going
from the FAFSA sheet you do in expanding
circular reveal or if you're going from
the sheet to the fab you do a
contracting circular reveal circular
hide don't know so and next up the view
is always the end values of view so even
though you give me the start values and
the end values you're always acting on
the end values of view and something
that took me a little while to get my
head around was that view is always in
the state that it ends up in which is to
say when we were going from the fab to
the dialogue it was already laid out and
positioned in the dialogues position and
then we reversed it by setting those
translations and so forth to put it back
into the tabs position right so it's
already in this an end state well the
same is true when I'm going back so what
that means is when I'm about to do the
animation from the dialogue back to the
fab the dialogues actually laid out like
this just in the exact same bounds as
the as the fab and so what you need to
do
to manually call measure and layout on
to the dialog in order to put it back
into the position that you want to
animate from so it may sound
counterintuitive at first that you have
to call layout and measure yourself but
this is just how the system works that
it's already in that same state it was
easy for us on the way in we have to do
a little bit more work on the way back
and then I just want to highlight the
translation as well so this is how we
use that path motion so we set a path
motion on the on in the constructor
early on and here I'm using one of the
overloads of object animator which will
actually animate two properties at once
so here I'm animating the translation
X&amp;amp;Y of the dialogue and we get hold of
that path motion again and call get path
passing it in the start and x and y and
the end x and y and that will generate
the curved path and animate the
translation along the curve but for us
we do some more and animators for the
circular reveal and the fade and so on
and we put them in a set and return that
and that gives you that entire animation
so that's how it's done and this is all
open source as well so there'll be a
link at the end you can go have a look
if you want to go into all the
nitty-gritty details that was awesome
all right so let's talk about a few
things that I think you guys will find
really useful here transition names now
if you do things well with transition
names the system will work for you and
that will help you a lot for example we
have a an animation here transition to
go from this little guy to a big ticket
for the big thing man active activity
transition like that and what's
happening in our activity transition is
of course we call start act make scenes
transition animation and we have this
view and it my view doesn't have a
transition name here or please don't do
this
you call view set transition name right
here in this call oh don't do that okay
and I'll show you why we have our
activity here we launched a new one and
then we are a change the orientation of
the phone what happens now that's right
our activity gets rebuilt but further
the thing underneath that gets rebuilt
too so even if you called vue de set
transition name you just lost that it's
gone so now when the view goes cut tries
to come back it has no idea which is the
share element the transition name is
used to identify which it you know going
from the source to the target and so it
can map those two and if it loses that
transition name it won't know what to do
you course can fix that up for it if you
want and we'll talk about that a little
bit later but the transition name is
your friend so in a system like this
where you have a recycler view for
example when you bind your view that's
when you set your transition name and it
should be a unique name that you have
for that item and it can be a URL or
whatever you want it's fine it's as long
as the string that's unique now here I
bound it to the position and my view
holder of position is unique whatever or
then it'll plug for data binding you can
do it right in the layout too if you're
using data binding all right that's
awesome by the way I know some guy who
works on that let's talk about changing
the shared elements that means we have a
different shared element than you
originally thought here I have a view an
activity it launches another one and
then we
scroll in the detailed view and when we
go back we want to go back to a
different share element right now that's
a transition system of course it's going
to try to go back to the same one you
had before we have to tell it something
else
step one when you launch the activity
ask for which shared element is coming
back so you start activity for a result
okay step two before you go back set the
result tell it what shared element it's
gonna come back to you here I have an ID
that I'm gonna send back as a result
step three in on activity reenter not on
activity result now I've gotten bitten
by this just yesterday I think it was
what I was writing a demo on activity
reenter that's a new thing just for
activity transitions here it will be
called before the shared element comes
back and this is where you can do some
tweaking here I'm going to get the data
get the shared element okay and that's
gonna come back to me all that data is
coming back to me and then we can also
called a shared element exit callback so
if they share the share element callback
for the exit now the exit is used for
the exiting on also for the reenter it's
the same callback used for both okay and
this is where we can switch up our
activity our shared elements we can set
our shared element to whatever we want
in our view hierarchy so here I've just
I used the ID I just had got before from
the on activity we enter and I used it
right now for my share to change my sure
element and now it works perfectly let's
talk about overlays shared elements
often go into the overlay if it'll just
go right into the overlay unless we
specifically tell it not to now the
great thing about this is it's drawn on
top of everything right because you
don't want to have your shared element
drawn underneath something over there
right and it's also not clipped by the
parent and that's really important but
the problem is is drawn on top of
everything I'm going to start on top of
everything there's a little bit of a
problem and it
and it's also not clipped by the parents
Cove it all right yeah yeah yeah here's
a real example I had of this issue it is
in this screen again from plaid and when
you click on a you know a list item I
wanted to have this expand and grow out
so I wanted to have a shared element
where the bat the background was
actually one of the shared elements so
if your kids transition this to share
that's going on here
there's an image going from one position
to over but also the background
transitions to give that growing effect
so this is all well and good but if you
were to use the overlay to do the
transition if you put the background
into the overlay it's going to be on top
of everything else right so you get this
horrible effect where it kind of grows
up and you don't see any content and it
snaps in right that's not what we want
we actually want the content to be able
to kind of come in on top of the
background so hopefully we can control
that George yeah we can well oh if do to
make the share amount do something
different is tell it not to and so we
just set this value in your in your
styles but you might end up with a
little bit of a problem I think it was
you you did it right
no well the problem is this let's see
what's going on here the shared element
is of course popped into the new
activity and when that happens it's
being clipped by its parent and it's
only visible when the cherem it slides
into the parent view so what we can do
of course is tell the parent don't clip
it so you say tell the parents a clip
children to falls and also set clip to
padding false as well now this is might
cause you a little bit of a problem with
the drawing so be careful with this and
also it's a performance issue you might
consider doing this only during your
transition but you can't do it just on
the parent of the view of the shared
element you have to go all the way up
because the grandparent can also clip
the child and clip your share element
that's no good the other option is to do
as nicked it in his is to put it right
into the root into the root of his
layout as a child of that and now it's
not gonna be clipped by anything because
the root of course owns the whole window
it's fine all right let's take a look at
it now that it has no clipping it comes
in instead of like a flash comes in on
top just like we want all right then
cool so as you may have seen within some
of these transitions and in general if
you work with transitions you also have
access to the window decorations those
basically status bar and the navigation
bar backgrounds so let's take a look at
what you can do is you just say define a
slider transition and what will happen
with that is that it slides all the
content in as we highlighted the status
bar here to show you what's going on so
it slides the status bar in as well but
we actually don't want to do this and as
you can see on the bottom under
navigation bar there's also flash and in
the last moment of that it still it
slides up as well so in order to avoid
this there's a couple of ways you can do
this but what you want to do is you want
to exclude both the status bar
background and the navigation bar
backgrounds so we provided IDs as well
as transition names for those so you can
work with them that is one of the ways
that you can do it obviously you can do
this not just in XML as we showed you
before but also when you do this within
your within your codes
you basically just say on this
transition exclude the target and set
those values to true but you can also do
something a little bit more nifty you
can add this to the shared element
transitions so you could have three
colors in there or just fade out stuff
when you want or fade them out within a
shadow roman transition this is an order
to do this you basically go all the way
up in the view hierarchy you get the
dÃ©cor view of your window then you find
views by ID you create the pairs this is
the second way you can create pairs so
in other and it's another way into
calling that and then adding them to the
shared element transition to actually
have the system being aware of exactly
that and then you get the desired
behavior of not no flashes no
exploding or just moving out of the way
status bar or navigation bar background
and with that we actually have a little
room for questions so you can start
lining up if you have questions about
six minutes thank you very much for
being here it's been a pleasure to talk
to you about transitions and we have
open source all the code already for the
samples that we gave here so the new one
the one with the images that we just
showed is on unsplash you definitely
have to take a look in Nick butcher
splat app if you want to go into the
advanced things on transitions there's
also Topeka out there and another sample
called our streets you can take we
looked through the training that we have
and yeah thank you very much
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>