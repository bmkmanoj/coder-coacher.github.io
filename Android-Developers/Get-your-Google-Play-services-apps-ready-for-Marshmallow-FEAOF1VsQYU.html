<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Get your Google Play services apps ready for Marshmallow | Coder Coacher - Coaching Coders</title><meta content="Get your Google Play services apps ready for Marshmallow - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Get your Google Play services apps ready for Marshmallow</b></h2><h5 class="post__date">2015-10-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FEAOF1VsQYU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Android 6.0 also known as marshmallow
has a new permissions model that
streamlines the app install and auto
update process this new model gives your
users great flexibility but you need to
make sure that your app behaves as
expected when they allow or deny
specific permissions hi I'm Laurence
Moroney and I'm here today to take you
through the steps that will ensure your
apps give your users the best possible
experience in marshmallow step 1 set
your API level and target SDK to at
least version 23 you can see them in
your Gradle code here also make sure
that you're using the v4 support library
to verify and request permissions add it
to your Gradle file if you don't already
have it
step 2 go back to your code when you
connect to Google Play services you
first connect to a Google API client
it's a common step that you may have
seen a hundred times before
but before you skip over this it's
extremely important to set your code to
handle Google API client connection
failures gracefully using the proper
resolution process for details and code
samples take a look at the link here
step 3 at this point you've likely
connected to Google Play services and
it's easy to assume that once you've
done this that you can just go ahead and
call the api's well that's mostly true
prior to marshmallow users had to agree
to your permissions before installing so
by the time your code was running you
could assume that you had the
permissions to do what you needed to do
in the new model that's not necessarily
the case before calling any of the api's
that require permissions you need to
check that you have those permissions
every single time because users may have
changed the privileges granted to your
app and you may need to re-request the
permissions again you do this by calling
the checks self permission method on the
activity compact fragment or contacts
combat you can see it here if this call
returns false then the requested
permission is no longer available it
might have been previously but it isn't
now so don't call the API the good news
is does this request permissions method
that you can use to inform your user
that you need those permissions
and that they can choose to grant them
in the previous step you requested the
permission again and the system would
call you back with an unrequested result
function so step four is to implement
this callback function the callback
gives you a request code parameter which
you can check against the particular API
call types that you want to access and
if it gives you the go-ahead by passing
the permission granted constant then you
can safely call the API knowing that is
permitted step 5
if your user has explicitly denied a
permission to your app but your app
needs that permission to continue you
will need to manage their expectations
and help them understand what your app
needs for that specific permission to
function you can do this with the should
show request permissions rationale
method on an activity fragment or
context so for example here you can see
that a permission has been granted for
fine location so UI can be generated to
tell the user that what this UI is is up
to you it can be as simple as a toast
notification or an entirely new activity
it's entirely up to you from there you
can go into the user flow to request
permissions again but be sure to be
respectful and clear in the message that
you give and that's it
Android marshmallow is the latest
greatest version of this mobile
operating system and while the
permissions model has changed quite a
bit it's pretty straightforward to get
your apps ready to use it by allowing
users to choose their permissions when
they're relevant and in context instead
of being overwhelmed when they first
install the app their experience with
your app will be much better we have
some great samples that you can look at
and to see how to handle user
permissions in marshmallow thank you
I'm Laurence Moroney and you're gonna go
build better apps</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>