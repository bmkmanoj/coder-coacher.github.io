<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Tales of Optimizing for Android Wear (Big Android BBQ 2015) | Coder Coacher - Coaching Coders</title><meta content="Tales of Optimizing for Android Wear (Big Android BBQ 2015) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Tales of Optimizing for Android Wear (Big Android BBQ 2015)</b></h2><h5 class="post__date">2015-10-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0_D1VzFdfxk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I'm here today to tell you a couple
stories about optimizing things for our
Android wear and uh well first off a
little bit about myself I'm an engineer
on the Android wear frameworks team I
spent a lot of my time doing battery
life optimization among some other
things and I've been developing for
Android since the dark days of cupcake
many many moons ago and yeah the I guess
the only other thing you mentioned I'm
Canadian so you see any funky spelling
and so on so forth that's because you
know that's how you spell English and
it's real Queen's English and yeah so
well first off the most important part
about optimizing your Android wear is
well battery life pretty
self-explanatory the worst thing you can
possibly have when I watch these days is
one that has a blank screen we all kind
of like and our users all like having a
screen that's always on so always got
information and you can always you know
glanced at it and see what's up so
there's a couple challenges when it
comes to optimizing for battery life and
well the screen being on all the time is
actually a pretty big problem to
actually have the screen on we have to
make a lot of compromises and there's
actually want just a pretty good they've
got enough performance run Android it's
gotten a performance to run full videos
and that tends to be a problem because
if you run full videos and your watch
they don't tend to last very long so
yeah there's quite a few things we have
to deal with if you want a very very
powerful device that can last a long
time you could strap your phone to your
want to your wrist but that's also not
very pretty so yeah we have now three
tails for about battery life these are
sort of cautionary tales sort of a
campfire ghost stories of things that
have well what's also happened but you
know lessons that we've learned so first
I want to start off with the watch face
so this watch face wants to be really
really really pretty and how you make a
really pretty watch face oh we start
with like go
gorgeous animations and i'm talking like
animations that have a slowly moving
second hand that sweeps gracefully
across the screen it's got cogs
basically taking away the background
gorgeous gorgeous luscious well there's
a big problem of that um animations are
very powerful they're great they're
gorgeous but they're really power-hungry
um if you have an animation that runs
every time your watch face shows up from
its ambient mode every time you look at
it it you know that's a little animation
yeah that's perfectly fine you know half
a second animation whatnot but you have
to keep an animation going all the time
well you're the application processor is
going to have to calculate all those on
all the pixels moving it's going
everything on your in watch is running
at full speed your watch is going to
heat up and that drains a lot of battery
life so probably want to avoid having
animations that run all the time so you
know you want to pick the best hot spots
for animation well the other problem
with animations and Android we're
actually well on phones you don't really
get screens that change in the refresh
rate very much almost all universally 60
Hertz so we target 60 frames per second
and parental unlatches because we're
using really small screens very power
efficient screens they're only
guaranteed to be an operating at 30
Hertz and this is sort of even more
compounded by the fact that some screens
work slightly faster some screens may
even go all the way up to you know 60
Hertz but the only guaranteed to work at
30 hurt so your animations actually have
to look good at 30 frames per second
which isn't a big deal but if you're not
aware of it you will suddenly pull out
your watch and don't this animation
doesn't look good no matter what I do
remember how fast i render it no matter
all the little hacks I do it still looks
like it's raining or 30 frames per
second that's not like something broken
that's actually how fast a hard-working
possibly render because the screen is
very energy-efficient that said you
still want to hit 16 millisecond frame
rendering target that you need for 60
frames per second
you know other watches will have better
screens so you know you may not your
watch may not be great but have the
greatest screen refresh rate but your
other users may do and finally you get
you I'll have somebody will always ask
you you know what these watch face the
animations are great now but we can save
more battery life if we turn on hardware
acceleration right and we get asked this
basically once a month somebody will
think we'll ask hey can we turn on a
cell heard reservation it's going to
save battery life so in this Watchers in
particular we actually sat down and we
measured the current when we turn on
hardware acceleration and you have a
fifty percent increase in battery drink
which actually kind of makes sense when
you turn on harder acceleration you're
actually using more silicon on the
actual device normally things that
wouldn't be running would now be running
in because they're accelerating your
graphics so yeah you don't you if you
need her oscillation you should totally
use it to get you know better frame
rates but if you don't need it turning
it on won't help your battery life
whatsoever so something to keep in mind
that it's not magic that you sprinkle on
top of whatever animation you're doing
it actually has cost involved in it so
you know this gorgeous you know
animating watch face had this other
thing to want to do and they wanted to
have photos and specifically they want
to pop photos from you know the actual
phone that this watch was paired with
and you have giant bitmaps that you want
to render in a screen so they had really
really big bitmaps that sucked up a lot
of memory which became a bit of a
problem because these devices don't have
a lot of memory on that they have about
half a gigabyte of memory and that's it
now that's more than enough because the
you know the the screen with the biggest
resolution is currently to holly watch
which is 400 by 400 pixels not a lot of
pixels to push you don't need gigantic
you know 15 mega yeah
pixel photos but they sent it over on
the bluetooth radio the radio that needs
to slowly send every bite on both your
from your phone your watch so now you're
draining battery from your phone you're
draining batteries from your watch and
that didn't work out very well and we'll
just say that once we actually got the
phone to actually shrink the images
beforehand and send it over that way
battery life became a lot better things
sent a lot faster for some odd reason
apparently if you send less data over it
sends a lot faster watch faces always
are always loaded on your watch in the
sense that every time your watch goes
back to the watch mode you see a watch
face seems obvious but that does mean
that anything that is running on your
watch face is loaded in memory which
means that if it takes up a lot of
memory the application you just used is
now garbage collected and stopped so it
means that you want to be a good good
citizen of Android and actually not use
too much memory if you don't have to so
that other applications won't randomly
shut down every time you far and take
longer to boot up every time um so
taking all these things into account to
what we end up with a watch face that
etch luis you know fairly power
efficient on many many devices but you
know we pulled it up on certain devices
and suddenly the battery life jumped up
destroy batter life jump down the batter
consumption jumped up and and it was
really strange because it was only a
certain class of devices and those are
specific devices with Oh Lodi screens um
Oh Lodi screens are not like LCD screens
we have watches that implement both just
so we have watches that have all LED
screens and we have watches have LCD
screens and all LED screens have to emit
light they emit light from the
individual pixels you know it's fairly
obvious but that means that if you go
with a darker palette it mitts need to
emit less light and therefore
takes less battery life on an LCD screen
it doesn't matter so if your watch face
is completely you know bright it's got
lots and lots of colors in it it's going
to cost the same amount or battery life
as if it's completely dark well similar
amount on elio LED screens a dark
background saves you a lot of power in
comparison to say a completely white
background so something to keep in mind
but you know if you take that into
account then you will have similar
performance across both you know I have
watches that have LCD screens and LED
screens so we're gon know that this is
basically the you know rough ways to
actually make a watch face not suck up
say for extra hours of battery life off
your watch and but not we don't always
have to use watch face down it's a full
android system we have apps we have apps
that we can run so a classic app that we
run is the fitness app so this is the
fitness app in which you know first time
I got it you pull it up I click on the
icon and I wait no wait no wait no wait
hey wait for a long long while for it to
load but long while I actually mean like
about a second and a half or so look
whenever i'm using a watch you use it
for about five seconds you pull it up
tap tap look at some information it's
done you if you if your app takes a
really long time to start up it's not
ideal you're going to suck up all up
users time just waiting for things to
boot up so because you want to use the
launch as little as possible or rather
for users used to watch as little as
possible you want to watch you go back
to sleep that saves power so you wanted
things to load quickly so the best way
of making things load quickly is don't
load things that you don't need um so
yes don't do things you don't need to do
like all android apps but i mean even
things like loading in classes can take
a while uploading you know big images
can take a while loading data from the
SD card that you could defer later on
could take a while so one of the things
that's important about watches more so
than phones because phone see you get a
splash screen you know I've already
pulled my phone out up and unlocked it
taking the next row second not a big
deal take an extra second for your watch
to load up actually a pretty big deal
especially by my only using it for a
couple seconds to look up some
information so and of course as I
mentioned before for launch faces if you
use a lot of memory you'll kill other
applications and if you exit you're out
and if you use a lot of memory the the
system will also remove your app from
memory which means the next time you
open it is also going to take longer so
you want to actually keep your memory
usage low even for an application but
well so for a fitness app that you to do
any work at all it has to use sensors um
now if you don't use sensors fitness app
doesn't really do anything it just sit
and watch and probably tell you some
information so a nice things about
Android wear watches is that they have a
full suite of sensors just like Android
most android phones and you know picking
the right sensors also actually really
important seller AMA ters are great i
love them they use very little power and
for almost all our watches our cell
numbers actually have some built-in
memory inside them that allow them to
actually operate without the application
processor on your watch from doing
anything which means that it actually
takes a lot less power to gather data so
you don't have to be running an
application completely what while
collecting minutes of data and that's
really important because that actually
wore steal overall power use if you use
seller ometer gyroscope on the other
hand doesn't have that sneak feature and
it doesn't match any of the data and
more importantly a seller the seller
ometer is use about at about a tenth of
the power as a gyroscope so if you're
doing your own motion algorithm if
you're doing your own gestures and
playing on that consider just trying to
get everything to work with a seller
ometer like android you want to use
sensors as little as possible by
I mean you don't want to use it if you
don't have to so you can do things like
Lord a sample rate if you lower the
sample rate you can actually match up
more samples of data before it actually
runs out of the memory and sends it all
to your application to work with and of
course you want to turn off the actual
sensor if you're not going to use it
there may have many or may not have been
issues where an application would turn
on a sensor and then just keep the
center on indefinitely a bit of a
problem when you're trying to save power
especially if you're trying to sample
data at this highest possible rate
possible so you want to be very very
careful and you know da ting rad ice
crossing your T's shutting down things
when you don't want to so once you've
gathered the data one of the things that
all fit in a snap like to do is they
like to synchronize some server
somewhere so they use a network to send
some data so the important thing about
sending data again senden use a little
as little data as you possibly can get
away with so one thing not to do is to
send all your logging data about how to
send network information as a part of
network information to send back that
tenants not work very well especially
the end up in a situation where and say
you send a hundred kilobytes of data and
that gets followed by two hundred
kilobytes of logging data something to
avoid perhaps but the timing of sending
network data is actually pretty
important to them so say I'm accessing
information from your phone frequently I
have to do it quite a bit and every time
I do it I do it every only collect like
two three bites not a lot of information
to send right so I'm following you know
sent as little as i can but every time i
ask for information it's you know I have
to ask every 10 seconds every 10 seconds
it got to send a couple bites well the
Bluetooth radio has to turn on well is
always on which is great bluetooth
radios on your watches home is always on
unless airplane mode is turned on
but just because it's turned on doesn't
mean its operating at the same power if
it's idle it doesn't use much power at
all if it's not idle it actually has to
spend time to ramp up has connect your
phone it's connected to your phone but
you know it has to actually tell your
phone hey I'm about to start talking
that takes power and then has to send
the information which takes more power
and then s it shuts back down which
actually takes even more power and all
those things takes a couple you know a
half second to start up absolutely such
shutdown and if i'm only sending two
bytes of data that's mental maybe about
10 milliseconds but you're 10
milliseconds of data being sent that
should cost a whole second of the
bluetooth radio turning on and off and
if I do that every 10 seconds that
someone becomes a huge problem so what
you want to do is you want to batch
although theta so usually you don't
really need immediately to the second
the data from the launch from the one
from the phone to the launch so you want
to batch it so that you know you may
want to send it once a minute and why
mention once a minute is well your watch
actually has to do something every
minute especially when your watch face
is on that's the update well your watch
face every every minute on your time
ticks to watch face updates and you if
you're going to have to do some network
synchronization you want to do it when
it actually takes in during that time
you want to do all that work at the same
time you want a dogpile together and
then stop so if your watch if you
developed a watch face that needs data
to be synchronized every minute maybe
you want to synchronize five seconds
before hand instead of say trying to
keep the entire watch on by
synchronizing at random intervals so
sending a lot of little things can be
really bad so you want to batch it
together but you still want to send as
little as possible so keeping the other
thing that is really bad is listening to
in tents are frequently dispatched by
which i mean we may
have encountered situation where a
certain fitness app was keeping was
sending data every time you turn to
screen on by which I mean every time you
look at your watch it would send data to
the phone and then request it on a phone
and then every time you the screen turns
off it with do the exact same and if you
wear an Android wear watch you'll note
that you actually look at it every now
and then a lot every time you look at it
it would suck up a tiny bit of memory so
a tiny bit of energy and do it again
again again so it's not the greatest
thing in the world to do that um it may
or may not have dropped bad wife a
couple hours you know all these little
things add up over time especially if
you operate every time any minor thing
changes so please don't do that please
avoid intents are dispatched a lot and
if you absolutely have to please stop
using them if you don't need them
anymore one of the things that a lot of
people don't forget is that you can
actually disable listeners especially
even the even broadcast receivers that
you register in your manifest you can
disable them in code when you don't need
them so something to keep in mind you
don't always have to run when you're
listening for certain intents even if
it's set up in your manifest so that's
basically it for a fitness app you you
know we have an app that efficiently
gather is yours fitness data we have an
app that actually sends data in a very
power efficient way um so you know I'm
walking down a street done my run I want
to go home one of the things that it's
really nice for me is that you know
getting transit information so let's
talk about the transit app that you know
I got time you know I have popped them
with watch and sunday great it got a new
transit app I tap it opens up tells me
the time the next bus is coming all
right okay I gotta run to a bus stop now
and I start running and take a quick
look at my watch again after
min or two the app is gone so me being a
guy who likes my lunch I said hey it
would be great if you could just keep
telling me that information lo que know
if I'm looking at the trends information
odds are I'm occasionally running to the
bus stop in a hurry because you know I
woke up late so the person knows that oh
sure we can we can we can keep the
screen on by what you mentioned he kept
a full wake lock on which meant the
screen was permanently on full
brightness the entire time it's not
please don't do that it means the
pollution processor is running really
really fast it strains a lot of energy
when it does that the screen is on it
also doesn't work really great when your
screen is on at photographs Wayne
earlier talked about a couple modes that
you could use so interactive mode when
we call something in Turin interactive
mode that's when like you could touch
the screen you can you know it's got
touch sensors you could top buttons and
so on so forth that's what happens when
you keep a full wake lock button and
require we introduce something we call
it a am be active mode what that means
is that your app is running but the
screen has turned off by off I mean in
the sense that the screen isn't active
this touch screen is off you can't touch
buttons you can touch the touch screen
and it will switch it back into
interactive mode that's actually pretty
great because what that does is that you
can actually your app can actually give
the system a particular image to display
on the screen so you can be like you
know you can turn all your text to a
certain color say white turn your
background to black like you know and
discrete do you watch we'll just keep
that image on it's great for stopwatches
it's great for transit apps it's group
it's great for keeping power because
your screen no longer has to be running
at full blast the system doesn't have to
be operating a full glass the actual
systematic turns off a lot of the
display the silicon involved with
displaying because it doesn't have to
actually receive any new information now
all it has to do is just displayed up
one image that you've pushed to the
screen
so that's great you can you can turn on
the NB active mode I can now use the
actual app and see my transit time you
can update the image how you know every
minute or half a minute or whatnot and
it's useful and it's actually one of the
things that's most useful about this
device you can actually create
applications that can take over the
entire screen and be used the entire
time without create your own watch face
because but I'm a like my trans it up
but on a day to day basis I don't need
it to be my main watch face and I don't
want to keep switching my want trace I
like my watch race it's pretty that's
nice colors in it the other thing about
am be active mode is that you know the
five percent screen use is still
important you OLED screens have a very
bad tendency to burn in by which I mean
back in the olden days we had CRT
screens we have plasma screens and if
you like kept them the same image on the
screen or like kept the weather channel
on or MTV on it would burn in as you
have a burnin ghost of an image oulad
screens hatching out the same problem
it's not a big deal on phones because
chances are your phone aren't going to
be stuck at the same image and turned on
all the time but the problem watches is
that on the eli or watch face they do
that you have the same you know time
ticks and stuff all over it so you only
want to use a very very small bit of the
screen and we do our own magic to shift
the actual image around in order to
combat burnin so screen savers are kind
of back so yeah that's something to keep
in mind whenever you're doing and be
active you don't while the system can
definitely hold the screen that's
completely bright on it's not great for
all that screens because it wears them
out so he turns it app well we end up
getting rid of the MV active problem the
active it doesn't hold a wakelock
anymore that keeps it on at full screen
all the time
so we were looking at other ways to
improve it and one of the problems that
we were having was that we found out
that it was getting it was hitting
network a lot by which I mean every time
you would move like a couple hundred
meters it would refresh all the traffic
data are the transit data because well
we had another you know we got to
another bus stop and it's got new data
to update him so you know that this is
great for certain applications but for
applications where your data changes a
lot it's not so great i don't i love my
transit but i don't actually need to
know when the next bus stop is all the
time I kind of just want to know when
I'm you know trying to commute home or
something so your users may not always
want to use repin you surprisingly may
not always be the most important thing
on the watch I mean I I know it's
surprising that we know whatever
application that we are developing isn't
the greatest thing in the world but data
that gets stale and you have to load
again and again again not so great you
may want to actually start floating to
data whenever the user opens up the
application now that does mean that it
is not as responsive as we possibly want
the actual application to be but that is
something that you know it's a design
decision we have to sort of work with
that and decide to take one not taking
up with more of the user spider life
overall is good or we're not being
slightly less responsive is good so we
are towards the side of an on-demand
synchronization model at so when the
user wants to actually get the data and
provide it the other things you can sort
of you know going back to the fitness
model you know you want to synchronize
maybe once an hour or so not not every
time the user takes a couple steps seems
obvious in retrospect but you know you
can usually get away with it when you
have a giant battery strapped to say a
phone size body you know the luxury of
doing synchronization like that is not
so much when it comes to having a small
battery on a wrist-mounted device so if
it turns an application the other thing
that's real important is of course for
it to get location data without location
data I can't really tell me where my bus
stop is so the problem for asking a
location unit is that it's kind of crap
off the phone in watch so you could grab
location data from the GPS we have one
device right now that's the Sony
SmartWatch 3 and it has built-in GPS and
it's pretty much just as bad as when
your phone uses to gps it takes up a lot
of power it's actually kind of bit worse
because the battery the battery inside a
SmartWatch is smaller than a phone
surprise surprise so GPS is even more
expensive when it comes to how much
battery life it drains from your device
but even grabbing from the network is
also expensive your phone actually talks
your watch cert and tells it what the
actual location is because of course
your phone has a bit more buffer when it
comes to grabbing your location your
phone also has a cell radio and we can
do fancy stuff with that to grab your
location but when you use your Bluetooth
radio to send information it drains
battery life from the phone it drains
battery from your watch and if you say
no grab the location information every
five seconds assuming that you know it'd
be just like grabbing it from a phone it
may drop their battery life by two or
three hours I mean I'm not saying it's a
terrible idea but maybe you should avoid
grabbing location data every five
seconds one minutes great maybe five
minutes maybe only grab it when you
absolutely positively have to but just
you know certain things to keep in mind
whenever you're grabbing location it's
no it's not exactly free and on a watch
more so it can drop your bar
life by a very very substantial degree
so I mean no it's bitterly but um this
is basically it from a tail yeah I kind
of have a couple themes that I think are
I've sort of harped on quite a bit you
don't want to do much or rather you want
to do everything you can to make a good
user experience but you want to use
everything as little as you possibly can
use less sensors don't grab as much
location data use the screen as little
as possible be conservative in your
animations um it's you know you you
can't when you work more with entry
where you kind of find it's kind of like
an android phone like everything in
front impacts an android phone comes a
better life also impacts android wear I
mean they're pretty much the same device
but because of the smaller battery
because you know we want small nicely
sized wristwatches as opposed to giant
you know cuffs on our wrists DD any
little drain is amplified in the overall
battery life the device so you want to
be really really careful whenever you
make decisions on what not an extra
feature is going to be a very bad impact
on your users overall powder life and if
you have to do a certain thing like
sending network information getting
sensors sort of batching everything
together is great you want a dogpile to
get all your inch all your work together
and then allow advice go back to sleep
so serve the overarching features you
want or device to sleep as much as
possible because then it could last as
long as it can so that's basically it
for my talk um I haven't twitter handle
up there you feel free to sort message
me I can talk on and on and on and on
about all different little things we can
talk about paralyzed but that's
basically the things i want to sort of
talk about and my colleague wayne is
doing a code lab on Android wear
development if you want to you know get
your hands dirty on that and he's just
the code lab room think like there and
yeah help you here to take questions</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>