<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Architecture Components: ViewModel | Coder Coacher - Coaching Coders</title><meta content="Architecture Components: ViewModel - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Architecture Components: ViewModel</b></h2><h5 class="post__date">2017-11-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/c9-057jC1ZA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">the architecture components lifecycle
library is designed to help you solve
common Android lifecycle problems and to
make your apps more maintainable and
testable this is an introduction to view
model a view model holds your apps UI
data in a lifecycle conscious way that
also survives configuration changes now
here's a real-world example of why that
might actually be useful rotating your
phone is considered a configuration
change configuration changes cause your
whole activity to get torn down and then
recreated if you don't properly save and
restore data from the destroyed activity
you may lose data and end up with weird
bugs or even crashes like this yeah
that's no good so enter the view model
which survives configuration changes
instead of storing all of your UI data
in the activity put it in the view model
instead now this does help with
configuration changes but it's also just
good software design one common pitfall
when developing for Android is to put a
lot of variables logic data and other
things in your activities or fragments
and what this does is it creates a large
unmaintainable mess of a class and it
violates the single responsibility
principle you can use view models to
easily define up that responsibility
view models will hold all of the UI data
for an activity then the activity is
only responsible for knowing how to draw
that data on the screen and for
receiving user interactions but it
doesn't actually have to process them if
your app loads and stores a lot of data
I also suggest making a repository class
as described in the guide to Android
architecture now you should make sure
that your view bottles don't become
bloated like your activities and
fragments were to avoid this you can
create presenter classes or you could
implement a more fully fledged clean
architecture there's tons of
documentation linked ok
so let's actually make a view model to
make a view model you extend the view
model class and then you put all of your
UI related instance variables that were
previously in your activity into your
view model you should encapsulate these
variables by providing getter methods ok
now in your activities on create you get
the view model from a framework the
utility class called view model provider
notice the view model provider takes an
activity instance this is the mechanism
that allows you to rotate the phone get
a technically new activity instance but
ensure that that is
is always associated with the same view
model with the view model instance you
can use the getters to access the UI
data from your activity documentation is
linked now you may want to modify the
default constructor of your view model
which currently takes no parameters you
can get around this by using the default
constructor and then immediately calling
a set method with a parameter that you
want to pass in alternatively you can
use the view model factory class to
create a custom constructor
documentation is linked now as a warning
you should never pass context into view
models so this means no passing in
fragments activities or views the view
models don't care about specific life
cycles of a single activity or fragment
which can be destroyed or recreated many
times during the life cycle of that view
model so let's say thank you
accidentally do pass in an activity to
the view model when you rotate the
screen and the activity is destroyed you
now have a view model that's holding a
reference to a useless destroyed
activity and this is a memory leak now
if on the other hand you find yourself
needing at application context you can
use the Android view model subclass this
includes a reference to the application
for you to use ok one more warning view
models are not a replacement for on save
instance state now as I said view models
survive configuration changes but that
doesn't mean that they survive a process
related shutdown due to resource
restrictions so make sure to use your
view models to store as much UI data as
possible so that you don't need to
reload or regenerate that data during a
configuration change on save instance
State on the other hand is meant to
store the smallest amount of data that
you need to actually restore a UI state
if your process is shut down by the
framework so for example you might use
on save instance state to store the ID
database ID for an object instead of
storing the full object documentation is
late ok I'm gonna finish off with two
more view model facts you can use view
models to share data between different
fragments in an activity and this
removes the need to have the fragments
reference each other or to have them
communicate through the parent activity
documentation is linked now view models
could also be used to create reactive
you is using another architecture
component class called live data live
data can be stored inside of viewed
models and then can automatically notify
linked fragments or activities when it's
updated
to learn more about live data watch the
introduction so hopefully this has
inspired you to try out the new view
model class in your own apps to learn
more about view models or any of the
information I mentioned check out the
documentation which of course is linked
below</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>