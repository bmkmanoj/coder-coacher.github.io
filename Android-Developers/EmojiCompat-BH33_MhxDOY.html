<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>EmojiCompat | Coder Coacher - Coaching Coders</title><meta content="EmojiCompat - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>EmojiCompat</b></h2><h5 class="post__date">2017-08-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/BH33_MhxDOY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">
FLORINA MUNTENESCU:
Have you seen
this blank square
character called tofu when
an app can't display an emoji?
New emojis are constantly being
added to the Unicode standards,
but since they are
bundled as a font,
your phone's emojis are set
in stone with each OS release.
Well, they were.
With the EmojiCompat library--
part of the Support Library
26-- your app can get
backwards-compatible emoji
support on devices with
API level 19 and higher--
and get rid of tofu.
For a given char
sequence, EmojiCompat
can identify the emojis,
replace them with the EmojiSpan,
and then render the glyphs.
On versions prior
to API level 19,
you'll still get
the tofu characters.
EmojiCompat builds on
the new font mechanism
to make sure you always have
the latest emoji available.
Before using
EmojiCompat, the library
needs a one-time
asynchronous setup.
We recommend doing this in the
application class like this.
When a downloadable
font configuration,
create your FontRequest, and the
FontRequestEmojiCompactConfig
object.
If you can't use
downloadable fonts,
you can then bundle the
emoji font like this.
Note that the size of the
font is multiple megabytes,
increasing your
size considerably.
And on top of this, you'll
have to ship updates whenever
the emoji font is updated.
Independent of the
way you're using it,
the initialization takes
at least 150 milliseconds,
even up to a few seconds.
So you might want to get
notified about its state.
For this, use the
registerInitCallback method.
Here's a pro tip for debugging.
You can enable a span
indicator like this.
Display emojis by
using the widgets that
extend from AppCompat Widgets.
You can preprocess
a char sequence
using the process method.
You can then reuse
the result instead
of the initial rostering
in any widget that
can render spanned instances.
So, for example, if you're
doing your own custom drawing,
you can use this to
display emoji text.
If you want to add emoji
support to a TextView subclass
beyond the provided ones,
for example, to an AppCompat
checkbox, you can use the
EmojiTextViewHelper class.
So now, with the
new EmojiCompat,
I can see that my
friend isn't asking me
if I want tofu for
brunch, but avocados.
And the answer is,
of course, yes.
</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>