<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Virtual Files in the Storage Access Framework (Android Development Patterns S3 Ep 11) | Coder Coacher - Coaching Coders</title><meta content="Virtual Files in the Storage Access Framework (Android Development Patterns S3 Ep 11) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Virtual Files in the Storage Access Framework (Android Development Patterns S3 Ep 11)</b></h2><h5 class="post__date">2016-09-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/4h7yCZt231Y" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">a computer file is a resource for
storing information almost all the files
you're used to working with our open
Bowl files files the direct
representation in bytes but there's
actually another kind of file a virtual
file a new part of the storage access
framework added an API 24 now on Android
a traditional file is known as an open
Abal file this comes from the fact that
you can open a file stream and get
directly at the bytes that make up the
file via something like open file
descriptor or open input stream and in
most cases when you're using something
like content or action open document
this is exactly what you want so way
back in API 1 Android added category
open Abal you'd add this to your intent
and then you could ensure that what you
got back could be opened virtual files
will appear but they won't be selectable
if you're already using that category
never get a virtual file and you don't
need to worry about them but if you
don't include caddy or open bol the user
will be able to select both open level
files and virtual files in both cases
you'll be able to get the documents
metadata and use other documents
provider API such as getting a thumbnail
if supported but beyond that you'll need
to handle virtual files a bit
differently you can determine if you
have a virtual document by using a
method like this which looks at the
column flags for the URI that flag
virtual document is the indicator which
marks a virtual file with this
information you can also take advantage
of one of the API 24s other new features
alternate mime types for the storage
access framework think of this as
on-the-fly transcoding or exporting a
virtual file into an open file such as a
PDF file
get stream types determines what openal
mime types are available say checking if
we can get an image from the file then
use open typed asset file descriptor and
create inputs
dream to get an input stream for the
file this is really useful if you're
just wanting a one-time export of the
file say to send as an email attachment
but for local viewing and editing of the
file you'll need to rely on the app that
provided the virtual file in the first
place
in those cases the virtual file serves
more just as a link to a file allowing
you to use action view intent to open
the file in the native app which would
know how to interact with whatever crazy
internal format or database or cloud
storage system the document might have
under the hood so for developers
interested in using virtual files in
your documents provider you want to make
sure you add the virtual document flag
to each virtual document then make sure
you have an activity that supports
action view for the mime types you use
on those virtual documents that way
there's at least one app that can render
the file oh and if you want to provide
an alternate mime type that is open bull
which is strongly recommended override
get documents stream types and open
typed document just make sure to call
the super implementations for non
virtual files this ensures that every
client app can call it whether they're
explicitly checking whether it's a
virtual file or not so make sure that
you're explicitly including category
open abble if you want to ensure open
bull files and handling virtual files
correctly in every other case check out
the links in the description for all the
details
as you continue to build better apps</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>