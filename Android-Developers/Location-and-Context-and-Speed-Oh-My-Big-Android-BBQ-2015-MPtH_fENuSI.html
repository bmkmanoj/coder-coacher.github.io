<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Location, and Context, and Speed -- Oh My! (Big Android BBQ 2015) | Coder Coacher - Coaching Coders</title><meta content="Location, and Context, and Speed -- Oh My! (Big Android BBQ 2015) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Location, and Context, and Speed -- Oh My! (Big Android BBQ 2015)</b></h2><h5 class="post__date">2015-10-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/MPtH_fENuSI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Laurence Moroney I'm a
developer advocate here at Google I'm
taking a big risk of doing a talk with a
brand new Linux laptop so I've been
having some tech challenges here on the
podium particularly with screen
resolution so bear with me if any of the
demos go a little bit awry so I'm a
developer advocate here at Google I
focus on a technology called Google Play
services primarily and Google Play
services if you're not actually who's
familiar with Google Play services okay
most of you so then I don't need to go
into too much detail on it but basically
it's a way that we have of shipping
their runtime for various Google
back-end api's and we it's a something
that we update like roughly every six
weeks so that we not go in like Android
release cycles we can go much faster
than the typical Android release cycles
and we ship via the Play Store that kind
of thing so I've been a developer
advocate at Google for about two years
prior to that I did a lot of mobile
development freelance mobile development
including quite a few mapping apps on
the on the iOS platform and on the
Windows Phone platform and it was it was
an interesting experience and what I'm
trying to bring today is like having
used Google Maps through Google Play
services and having built various
mapping applications I wanted to come up
with like a set of tips for various
things that you may not realize that
will really really improve the perform
apps and as perfmatters is the theme of
the show hopefully some of these will be
useful to you I'm an author I've
authored 20-ish of lost count of
computer programming books primarily
under Microsoft platform but forgive me
for that and about two years ago I got
into writing novels and this is
shameless self plug of my newest one
which is coming out next month and I'm
the host of a show called coffee with a
Googler on the Google developers Channel
anybody watch that nice thank you thank
you so that's basically where what I'd
like to do is just grab a Googler sit
down have a coffee with them and talk
about what they do why they do it how
they do it and you know just try and
like lift a little bit of the veil
that's around Google so that you know
you guys can see like you know we're
we're just normal guys normal developers
like you or we love this technology and
that's why we do what we do
so the agenda today is just really
talking about location-aware
applications and looking at some of
these 10 tips around building better
apps build better apps as a mantra that
Magnus if you're familiar with him and I
came up with that you know really why we
do what we like to do is that we really
want to help you guys build better apps
it's very easy to build mobile
applications it's very hard to build
really good mobile applications and it's
a journey and it's a journey towards
making them as you know trying to
improve them in any way you can and no
matter how good your app is I think
there's always ways to improve it and
we're always here to learn from you just
as we hopefully you can learn from us
and with some of these 10 tips some of
them may apply to you some of them may
not so your mileage may vary okay tip
number one and this one actually blew my
mind when I started trying to think of
some of the new things and number one is
like with Android studio if you've
refreshed it and brought it up to date
there's a new Google Maps activity
template that ships in Android studio
and for me I've been building maps with
Google Maps for Android for like a year
two years and I got to the stage where I
always bypassed the the wizard and I
just rolled my own maps and I roll my
own apps that use maps and if you do
that you may remember that you got to go
to the developers console you got to
register your app you got to remember
the namespace for your Android app you
got to turn on the api's you got an 8
gotta get an API key for that oh sorry I
forgot you got to get the sha-1 key for
your development machine first right and
then you got to go back and there's all
these ugly steps that you got to go
through and all these hoops that you've
got to go through just to get an API key
so that you can build a mapping app and
it's like that's it's not necessary it's
a lot of friction particularly for new
developers but it's one thing that we've
really improved I believe in the new
Android studio and the idea is like if
you use the Maps template you get an XML
file it's called like map activity dot
XML or something like that and it looks
a little bit like this and if you can
see in the comment at the top there
there's a URL and that URL is generated
dynamically for you based on your app
and it remembers the name space it gets
the sha-1 key all that kind of stuff you
paste that URL into your browser you get
your API key back and you paste your API
key into that and you're done so all
those ugly hoops that I was talking
about
all that you know all that stuff that
gave people like me a job teaching you
had to do it is now gone and you know I
taught a court who's familiar with the
audacity you guys anybody use audacity
oh wow how do you it's really cool I
love lead acity and I've done a maps
course on audacity and the Maps course
had three modules in it and like most of
the first module is teaching you how to
jump through all those hoops so it's a
lot of time that I had to spend
recording it but more importantly it's a
lot of time that you guys have to spend
watching it in order to like figure out
how to jump through these hoops but
thankfully this new template that ships
with Android studio takes all of that
complexity away from you and gets you
quicker at producing Maps and when I'm
talking about perf I'm not just talking
about run time perform developer perf as
well your own performance and hopefully
this will get you into using Maps a lot
more quickly a lot more easily and you
know a lot more friendly so that you can
focus on what you're doing okay tip
number two is to think about light mode
Maps
now it's all very easy to put a map into
your application but I've seen
applications I'll give one example it
was for Sports Complex near where I live
and they had this application and they
asked me to like how can they make this
application fast there are some of their
users have been complaining about it and
they had a map in the application which
was directions to where they are and
that's all the map did but they had the
full map in there with all of the
controls and all the panning and zooming
and all that kind of stuff and they use
the full control and it took them time
to develop for that when most of the
functionality that that gives you for
all that extra weight they never used so
it's a common mistake that developers
make because they're not aware of light
mode maps and we have light mode Maps
now it shipped like a few months back
with what for Google Maps and if you
follow this you're awry or it'll you
know you can learn about it but the idea
is that you trade off a little bit of
the interaction in favor of having a
much lighter map within your application
and some of the things that are
available to you so I can't see my
slides because of my screen issue so I
have to keep turning back just for one
sec like some of the things that are
available to you is going back to this
sports app this like Sports Complex
after that's talking about one thing
that they really wanted to do is okay
well if you can touch on the map then
can it navigate from where you are now
to get to us like if you want to come
skating with us how do
get there so guess what lightmaps will
actually give that you can launch an
activity you can launch a view or
directions request from that so you
don't lose that by going to light maps
all the different types normal satellite
hybrid all that kind of stuff are still
available within light maps if you like
to draw on your map like maybe draw a
circle around the area that you cover or
draw polylines for whatever you would
draw like maybe a territory that you
cover as well these are still also
available projection is still included
in API maps and by that what I mean is
that's calculating the latitude and
longitude offset based on the pixels on
the map itself rather than just the
pixels on the screen location is
supported so if you're using location on
your phone you can still plot the
location on the map it has partial
marker support this is one of the
trade-offs if you build an application
where you want people to be able to drag
markers around drop them in different
places and customize them at run time
light mode is not for you but if you
just want to plot markers on a map which
are static then you know you don't have
to trade that off if you're gonna use
light mode Maps and same partial camera
support there's some nice little
applications if you watch my Udacity
course you probably saw where I built
one application where you could fly from
Dublin to Tokyo in about two minutes
wouldn't that be really nice and or from
Tokyo to Dublin and back and it was this
beautiful panning that the camera can do
around the earth showing the earth
flying underneath you all that kind of
stuff unfortunately you can't do that
type of thing with light maps you'd
still need to have the full you know
Google Maps experience to be able to
take advantage of that but if you're
thinking about your application if
you're thinking about you know you just
need a basic map in your application
that maybe have some polylines maybe has
some markers you can but you still need
to maybe launch out to navigation light
mode maps will work for you and then
it's much much lighter and it'll perform
a lot better within your app okay so tip
number three is to consider geo JSON or
KML now anybody using either of these at
the moment nobody okay so for some types
of applications and I'm going to demo
one in a moment of I have an application
hopefully I can get it to work on this
screen which plots like all of the
earthquakes that happened on planet
earth in the last 24 hours
and what happened is the the US
government the USGS
has provided a feed-in geo JSON of of
basically those earthquakes including
the latitude and longitude the magnitude
of the earthquake and all that type of
thing and because they have formatted
their data in geo JSON the role the the
task that I have as a developer to
actually build a map to plot that is
insanely easy now consider that if
you're building an application that
maybe needs to plot a lot of pins on a
map how would you do that you might have
your server that's like generating these
pins dynamically and you've probably
rolled your own data format in order to
download that and then on the mobile
phone you have to write your own parser
to parse that and to plot them and we're
all smart developers that's something
that we can all do but have we optimized
that the first time we've built it have
we optimized the data transfer the very
first time we've done it have we
optimized the client for consuming that
and plotting those pins the very first
time we've done it the answer is
probably no and the answer is like we
may have a lot of work to do to actually
build a client to be able to plot these
but if on your server side you encode
these in geo JSON and it's a really
straightforward format and then on your
client side if you use there's a set of
utility libraries they will decode the
geo JSON on your behalf and plot it for
you
and I'll show a quick demo of an
application that does that and then I'll
show you how much code and the client
side was required to do this so bear
with me when I change out of presenter
mode on the side screen and see if I can
drag the demo over
Wi-Fi in here has not been behaving for
me so it might take a while for the pins
to appear and I can't really drag any
further than that can I
there we go so I'm just running this in
the emulator it's hitting the services
at the moment to download the pins there
we go
now the pins are beginning to appear so
this is very simple application I got my
map I get my standard controls on my map
I can zoom into my map I see these pins
these pins are colored based on the
earthquake magnitude so we can see like
a green pin here was a magnitude of 1.69
earthquake and this blue pin was like I
guess a magnitude of less than one so
the amount of lines of code to actually
do this where it's about two lines of
code to consume the Geo JSON and to plot
it on a map I'll show that code in a
second but as you can see typical map
lots of pins very very easy to develop
now the URL this is one of those Linux
laptops with a really large screen
resolution but the second screen is not
so big and we get something like this so
if I go to the URL it should be here or
if you want to open this URL yourself
you can see a little bit of what geo
JSON looks like if my again Wi-Fi here
is not really behaving I'll give that a
second
um you know I'll come back to it but it
gives you the idea and here's what the
code looks like when I had my geo JSON
URL up it actually loaded when I moved
it away I'll take in a second so when I
have a Geo JSON URL and I download the
geo JSON data into a JSON objects from
that all I have to do is create from
using the Android map utils libraries
all I have to do is create a new geo
JSON layer and then add that layer to my
map and that's it right I didn't have to
write any code for parsing out the data
I didn't have to write any code for
plotting the pins and the people have
written this code haven't written it as
a v1 it's an open-source library you can
see all the changes and it's continually
being optimized so performance of
productivity if nothing else it's great
but I would say also argue for
performance of like if you need to plot
a lot of pins on your map and these pins
are something that your app you need to
generate server-side like one
application that I wrote when I was
freelancing was a it was for hotel
chains and each of these hotel chains
had a curated set of things near their
hotel that they wanted guests to be
interested in and that was a set of pins
it was set at latitudes and longitudes
and a little bit of metadata about the
location they had a server that would
spit that out and this iPhone
application that I had written I had to
write a custom parser to parse that data
to plot it to pin it all that kind of
thing I wish back then I had known about
geo JSON and let me drag my geo JSON
over a full screen first and you can see
a little bit what geo JSON looks like in
the browser it's pretty straightforward
JSON code so this is the code that was
generated by the US government's
earthquake service and you can see it's
you know you have JSON where you just
say it's like it's been generated it's
there's a time there's a time that was
updated but ultimately there's a
latitude and there's a longitude and
there's metadata about the event and all
I did load a JSON object with this code
created geo JSON layer add the geo JSON
layer to the map and I was done in
creating that mobile application that we
saw earlier that was plotting these pins
I think it's pretty cool
okay in addition to that let me go back
so that was a code for using geo Jason
in addition to that there's also KML
there's very similar context but KML is
usually used for drawing like outlines
on a map so for example you may have
seen maps that show the Googleplex and
has outlines of the actual buildings and
the googolplex and when you go down to
them then you have different floors and
you can see like what's on different
floors or maybe you see that in shopping
malls there's a great one on a Google
Maps the language KML is a markup
language that's used to define that and
again if on your server side you need to
generate some type of dynamic floor or
outlines on a map why not generate it as
KML and very similar kind of thing here
two lines of code to be able to apply
that to your map instead of you thinking
in terms of all the polylines and all
the floors and all those kind of things
that you would have to do makes your
life a little bit easier okay tip number
four cluster is not necessarily a bad
word so this is a map anybody guess what
city this is I guess you can read it on
it there's a train station this is the
city of Cardiff in Wales and this is
where I went to university and I'm
getting to go back there next week I'm
really excited it's one of my favorite
cities in the world and when I was there
as a student there was a Chinese right
that was a poor broke student and there
was a Chinese restaurant with a really
cheap lunch that I absolutely loved and
it was almost every day I went there as
a student so I went on to a I won't say
which web site I went on to a web site
to start looking to see if I could find
this Chinese restaurant and I did a
search for Chinese restaurants in
Cardiff and I found three and then I
went on to one of them and I asked her
plotted on a map and I got this alright
can you spot the Chinese restaurant in
this map and Cardiff is a wonderful city
with lots of restaurants but I can
almost guarantee not every one of those
dots is a Chinese restaurant there's all
kinds of things there that were sandwich
bars there's Hebert if you if you've got
sharp eyes there's the dot over on the
right the rightmost one is actually in a
prison and and it's no joke it's
actually one of the parent Li it's one
of the best restaurants in the city I'm
gonna go visit it and what it is it's
for rehabilitating the prisoners they
give them jobs as chefs and it's you
know waiters and all I can
and people say it's one of the best
restaurants in the city I discovered it
when I was you know looking for
something that you know something
completely different but anyway so the
problem with a map like this one and
when I took the screenshot I was using a
really cheap Chromebook when I was
searching for this it's like a hundred
dollar Chromebook and when I have a map
like this I can only see a limited part
of the city and I've got all these dots
on this map and if I pan this map around
there's several hundred dots here they
have to pan around as well if i zoom in
and out the map has to plot where these
are and as you can imagine that can be
very very slow particularly on a really
cheap Chromebook and so you know it my
experience in using this was very very
poor but clustering and here's another
example of when you you can cluster pins
together so that the map is smart enough
that it determines that if there's a
over a certain number of pins in a
specific location instead of plotting
all of those pins it will gather those
pins together and plot one entity
instead and if you were looking this is
a map of London and if you look here I
believe there's about there's over a
thousand items actually plotted on this
map you can see there's four 200 there's
a hundred there's a couple of 50s and as
well a thousand and seventy items
actually being plotted on this map but
the number of things being drawn on the
map is is it nine yeah
there's nine items so if I like zoom
this map around I'm only moving nine
items and if i zoom in then it will reap
lot this I mean I can show a live demo
later if anybody wants to see it I'm
having troubles with this screen so I
won't show it now but if you've seen
clusters before if you zoom in then it
will pick you know the location that
you're in and it will intelligently
cluster them but the idea behind that
first of all the great user experience
but second of all performance because as
the user pans as the user zooms around
you're only moving eight nine ten
entities instead of a thousand entities
which I'd be moving if I tried to pan
this map without clustering so
clustering not a bad word it's a good
thing I'll skip over the demo for the
time being and I'll show the code again
the code is really really simple if
you're reading your clusters in so you
there's we provide an object in the
utils library called a cluster manager
and you create a cluster manager for
your map as you can see here I have
cluster manager is new cluster manager
of item and just this don't get map and
then I have cluster items and if I store
my locations as a cluster item I'm sorry
if I store my like just general my I
have a collection of my locations if I
create a cluster item from that location
and then add those cluster items to the
cluster manager and then render the map
all of that hard work of managing the
clusters of drawing is it 200 in this
area is a 100 is it 50 of panning and
moving them around all of that work is
done for me by the mapping engine so
again it's like I said this is something
you could roll yourself and you'd roll a
v1 border will be optimized you know I'm
sure there's some great developers here
could build something awesome but it may
not be optimized at v1 this is stuff
that we've been working on for some time
and this will make your Maps faster and
it will greatly improve your user
experience now they may not discover a
restaurant in the prison the way I did
but at least you know you'll be able to
you know really really polish and make
your app your mapping apps a lot more
slick when using this okay next one is
consider something called polyline
encoding so one of the apps that I wrote
when I was freelancing was for a company
that provides services for pet owners
and in some of the major cities like New
York City if there's a big business of
hiring people to walk your dog right
while you're at work but if I hire
somebody to walk my dog when I'm at work
how do I know they actually walk my dog
and so part of this application I
couldn't put a beacon on the dog maybe
someday that would be good but part of
this application was that the part of
the service was that your dog walker
would then run this application while
they're walking the dog you would ask
them to walk in a particular location
and then it would plot you know a little
bit like you've probably all seen apps
for like managing if you go for a run or
if you go for a bike ride and you can
plot that same kind of thing and it
would plot the dog walk and it would
plot when the dog walk happened and you
can even plot when you paused for a
little while while you were walking the
dog and you can figure out why your
pause for a little while while you're
walking a dog and you know all this type
of thing was very valuable to the
subscriber because now they could see
that this money they paid to a dog
walker the dog really was being walked
now when you map a route like that you
generate a lot of data and now give one
data here this isn't that this isn't a
dog-walk this is a bike ride this is a
bike ride that my wife and I did about
three weeks ago and we did this 26 mile
bike ride on the east side of Seattle
and I took a look at the data dump for
this bike ride and there was three
thousand and eight data points were
collected when I did this bike ride so
this the data points that were collected
were like you know the longitude
latitude the time speed I was going at
the elevation all that type of thing and
the service that you know provides these
data points would give me an XML dump
and I downloaded that XML dump and I
took a look at it and it was 1.3
megabytes of data that's a lot of data
now to be fair on this service they have
a lot more data than just latitude and
longitude
you know when I'm drawing a line all I
want is latitude and longitude so a lot
of that data is also a lot of that size
is because of really useful data like
speed and elevation excuse me and that
type of thing but when I take a look at
if I want to just draw a line like in my
dog walker scenario I did a polyline
encoding of my latitude and longitude
data from this plot am i 26 mile bike
ride three thousand and eight data
points when using polyline encoding was
about 30k okay that's a lot less than
one point three megabytes right and so
if I if you're building an application
that does something like my dog walker
or plots anything on a map and you need
to store that data consider polyline
encoding I'm not going to go into the
algorithm now it's quite an involved
algorithm but it basically turns the
latitude and longitude numbers into its
string encodes them ASCII encodes them
and it takes about eight to ten bytes
pair latitude longitude pair to be able
to do that and that's where I came with
like 30k for three thousand odd points
I'm just rounding it to ten bytes per
one the URL here sorry if it's hard to
see but I'm sure the slides to be shared
we do actually have a on the Google Maps
website the polyline encoding algorithm
is there but guess what you don't need
to write it yourself because we've
written it for you so if you want to get
it set of data and you want a polyline
encode it you can do so so on your
server for example you could polyline
encoding like this so it's 30k instead
of 1.3
debates and then on your client you're
gonna download that 30k string and the
libraries will decode that for you into
a set of points that you can then plot
on a map like this so again great parfum
provements you don't need to write all
this for yourself you don't need to you
know store all this type of data for
yourself and you know just just use the
libraries that are out there and again
as I've been saying they're optimized
for you so here's my favorite map again
and tip six is really around curated
locations so one of the things that I've
found that provides great value and I
spoke a little bit I created a mapping
or hotels app that had mapping in it and
one of the things that was of great
value to our customers the hotels was
that instead of a blind API call to
something like a places API that just
throws like a bunch of places at the
user that have been generated by
Google's algorithm it was much better
for the customer experience for
something curated so the the concierge
of the restaurant and the concierge of
the hotel has tried this restaurant and
loved it you know we want to tell that
to our customers he's been to this
museum and it was awesome we want to
tell that to our customers so there's a
dichotomy between having a pure just
curated set of content or having
something that's API driven so you can
take advantage of the universe of
information that Google API scan give to
you well there's also a happy medium in
between them and this happy medium is go
ahead build your curated content store
it in a local database so it's fast the
user doesn't need to be connected or
anything like that but guess what these
locations when you use the place in the
places API have an ID so why not just
store that ID in your local database as
well and get the best of both worlds so
now you're looking at for example I go
to my hotel scenario best 10 restaurants
within a mile of the hotel the hotel is
pick these the hotel might have a
relationship with these that'll give you
a coupon or yeah they have pictures that
they've taken of these restaurants but
for the user experience you can also use
the places ID ID to call the places API
and to get back information that Google
provides about that place such as
reviews such as a street view so you can
see what the whole what the restaurant
looks like such as the online menu and
everything that would be available in
reviews so a great way to really
optimize your Maps or location
experience for your users is to curate
curate curate and use the places API
smartly this map of my future visit to
Cardiff was an example where the places
API really wasn't used that smartly it
was like this guy's looking for a
Chinese restaurant let's plot every
everything that's associated with food
within a you know 2 mile radius of his
hotel and this really doesn't help me
because there's no way I'm gonna click
on every one of those dots to check out
that restaurant ok I ended up about
finding the prison one that I've been
joking about just because it was off by
itself on the right-hand side okay
location and sensor optimization is our
next one now if you're using location
services on your phone guess what it can
eat your battery with Android we have
this thing called a fused location
provider that allows you to pick
different levels of location access you
know the topmost level is like that's
the you're using the GPS you're using
the radio using a Wi-Fi signal using
lots of other sensors to be able to
determine location but of course the
more accurate the more expensive it can
be on battery life so you really really
be careful and really optimized how
you're using you know your location
services first of all you don't always
need to turn them on and start up one
thing that we've noticed when working
with apps and when looking at apps a lot
of the time is soon as the app opens bum
I need to use location there's one app
that I've used for when I ride my bike
and that's what it gave me and I'm like
I'm in my garage pumping up the tires of
my bike right now and I open the app why
do you need my location now what how
often are you gonna be pinging you know
the GPS to be able to get my location
now it might be 20 minutes before I
actually start writing so think about as
you're building for location starting at
the appropriate time with activity
recognition on your phone you can get
really smart about that you know you
don't even need to I mean you'll ping
the user for permission to use location
services and an Android am we do that at
the point that the location service has
been accessed rather than when the when
the app is first installed but once
you've done that you can start using
some of the like activity recognition
say okay Lawrence is now riding his bike
let's start pinging for location
services doesn't always have to be it
start up and it's a common mistake that
we see secondly a lot of times for a
good user
experience you turn on your location
services you open a map and then you
wait and you wait for like a few seconds
maybe it may be a little bit longer for
it to actually plot where you are right
now there's a little use and really cool
get last-known location on the location
API and what that will do is that the
last-known location that you're at it
may not always be right may not always
be where you are now particularly if you
travel a lot it's kind of funny where
it's you know I might open an app that's
using get last location and I live in
Seattle and it will show me I'm in
Seattle until location initializes
properly and then say actually you're in
Dallas so doesn't always work great but
in some scenarios it works really really
well to just get you you look your user
into using the location and it's seeing
where they are and it may be for example
seeing restaurants or whatever around
them very quickly and it's something
that's really worth investigating for
great user experience maintaining a bad
best estimate is also something that's
really good when you receive location
updates from a fused location provider
there can be random noise in there
you've probably seen some applications
where it's showing your bike ride and
you're going and you like this you're
like this like this and then there's one
point over here and then you're back in
like this and like this and like this
again and like what that application is
doing is that's just receiving updates
and plotting them without really
thinking about them without doing
anything smart there's good things in
there for maintaining a best estimate
we've provided some code it's on the
Google developers site for smartly
maintaining a best estimate like that
I'd strongly recommend to go and take a
look at it and then secondly to adjust
the fused location provider as needed I
mentioned before there are different
tiers of the fused location provider and
you can you can change them on the fly
and again if you're concerned about
saving your if you're building an
application that needs to plot your your
GPS location every few seconds like for
a bike ride it's pretty obvious you need
to keep it on the highest level but
maybe you're building and you're not
building an application that does that
maybe you're building an application for
example it says find the nearest coffee
shops near you you turn on the fused
location provider to the highest level
you find out where you are and then you
turn it right off again or you turn it
down that type of thing it's a really
really powerful tool but like any
powerful tool you have to use it wisely
so remember the higher the sensitivity
the higher the cost and your users don't
like it if you spend their battery life
flippantly a bad habit that people do is
to use overlays to segregate data and
you've got to be really really careful
when using overlays so for example in
the earthquakes example that I showed
earlier on there were different colored
pins for different magnitude of
earthquake and there's an argument for
you to put each of these on a different
layer so then from the user experience
point of view you could say okay turn
off the layer of low magnitude
earthquake so I can just see the high
magnitude ones or turn off the you know
vice-versa that type of thing so the
user has this really nice experience and
it's very easy for you to develop
because you know turning layers on and
off is very very simple but you've got
to be really really careful when using
layers and overlays like this because if
you think about there's say 20 different
types of earthquake magnitude and I now
have 20 different layers and I'm using a
low powered device if I start dragging
my map around I'm replating 20 different
layers and each of those pins on each of
those layers has to have its relative
coordinates plotted based on its
latitude and longitude and perf can be
killed as a result so my recommendation
would be unless you absolutely have to
use layers avoid using too many of them
great examples of layers you probably
see in Google Maps like traffic is a
good layer so like I like when I'm using
Google Maps that I don't see traffic
until I ask for it and then I turn on
the traffic layer and if I'm dragging my
map around to see my location say from
here to the airport then I understand
that I'm getting a perfect because of
all this extra data but I've asked for
this extra data so it definitely
recommend that when you're using
overlays you know just be very very
careful about using them design your
application sensibly so that the number
of overlays that you're using is really
based on what the user needs and don't
forget to give you users the option of
course like in the case of the traffic
one to turn overlays on and off ok tip 9
using beacons and the demo gods haven't
really been with me today so I can't
really demo this but how many of you
have used beacons oh wow are you cool so
beacons I find a lot of fun I have a few
s demoed beacons up here on stage with
me and one of the things though what
beacons is that sometimes a lot of the
samples that I've seen with beacons and
a lot of the methodologies I've seen
what beacons are unless
thoroughly complicated and they can be
quite difficult for the user as well as
for the developer let me give an example
I've seen a scenario where beacons could
be used at at bus stop so you put a
beacon like this on a bus stop and you
write an application for your phone so
that when your application is open and
it's sniffing for the beacons and
against the ID of this beacon and then
it knows which bus stop that you're at
and it will give you a bus schedule for
buses at that bus stop great right
anybody see the drawback trick question
what's that I wasn't thinking in that
one but yeah that is a good one and the
sticky on this isn't very good they keep
falling off but more it's a case if this
broadcasts a unique namespace an ID
anyway so why do I need to register I
can just sniff that namespace an ID at
any points and I can build an
application that's based on sniffing
that namespace an ID and in Google a
couple of few weeks back we actually ran
a competition for people to build
applications based on beacons and for
the competition I I won a prize in the
competition I came up with the idea of
virtualizing these beacons so instead of
thinking of a beacon in terms of
absolute sense like this beacon is at
this particular bus stop and needing to
register and having that kind of thing
there are scenarios where you want
beacons anywhere to be used to be able
to do something now that sounds very
vague so let me give an example what I
wrote was a game and my game was a
virtual tour around some locations so I
had these three locations I work in
Google Kirkland I had these three
beacons around Google Kirkland and I
knew the ID of these beacons and I built
a little server-side application that
said the beacon with this ID is in the
barista cafe the beacon with this ID is
in a Cara member was in like
registration and the beacon with this ID
is like in such-and-such a meeting room
and then when somebody played the game
the idea the game was that does this
like animate a character who talks to
you through cyberspace I have a picture
of her here this you know or there's a
bunch of videos these CGI videos that
are on YouTube of her talking to you and
she's guiding in you saying can you go
to this location and in the location is
what
at the bottom in this case it was
building be barista and then you got to
go there and play a game and then she
tells you to go to the next one and you
go there and play a game but the idea is
then by virtualizing the beacons anybody
could take any set of three beacons
anywhere
maybe bus stop beacons or maybe beacons
around the conference centre here and
turn that into the same game you didn't
have to be playing it in Google Kirkland
and that's the concept that I'm talking
about when I say to virtualize beacons
it's really really powerful another
great example if you're building for
customers would be for example
department stores so there are a Macy's
there's one just across the road here in
the mall there's one nearer I live you
know big department stores like Macy's
instead of you registering a particular
beacon in a particular Macy's location
somewhere you could say the beacon of
this ID is in the menswear and Macy's in
Texas in Dallas the another one is in
the menswear in Bellevue in Washington
that type of thing so then when your
user when you use location services to
say oh this user is in Washington he's
in he or she's in Bellevue and let's
start sniffing the beacons that we can
see ah I've matched this beacon against
the menswear
and now I'm able to give an experience
for menswear and Macy's that type of
thing so virtualizing beacons can
actually be really really powerful I'm
gonna open source that game if anybody
wants to mail me if you want to take a
look at it it's all a lot of fun I hired
a professional actress to voice this
character it's it's really cool I'll see
if I can run it on my phone in a moment
but the Wi-Fi hasn't been behaving so
tip 10 we're onto next is a lot of the
tips that I've been talking about today
actually are part of this we have a
thing called the API utility library if
you build anything to do with map so
strongly recommend you going download
this today
download the samples for this today
dissect this today because a lot of the
tips that I've been going through have
been encapsulated in in api's that are
in this so geo JSON and KML that I spoke
about are available in this so your
decoders for Android are in there heat
maps is something I haven't spoken about
but if you want to like plot a heat map
around a particular area like you know
thunderstorms I hear the thunderstorms
coming tonight so if you wanted instead
of just plotting pins for
thunderstorms based on the concentration
of thunderstorms in a particular area
it's actually build a heat map which
would give the user a better or the
earthquakes there's another one to give
the user a better feeling of what you
know is really happening with the data
heat maps are great you can customize
your markers instead of just the usual
regular pins you can customize them and
have a whole lot of fun with them
clusters which is probably my single
favorite feature if you've ever built
any map applications clusters are really
a friend you know all that cluster
manager stuff is in there the polyline
encoding that I spoke about so the
libraries to turn latitude and longitude
into a few bytes so that you can store
decode them make your life a lot easier
is in there
things such as calculating distance
between two points you know it's not
really a straight line because of the
curvature of the earth these are things
like that those type of distance
calculations are in their area of
allocations same thing when you think
about curvature of the earth as well as
contours that's in there heading
calculations in there and it's all open
source and there's a really teeny tiny
URL there sorry about that hopefully
with the when their slides are shared
you'll be able to see them but wait
there's more and good what's the word
commercial sense anyway so tell you what
what are those late night commercials
what are they call infomercials thank
you and good infomercial sense wait
there's more so there's lots of other
great stuff with maps that I didn't have
time to fit in maps on Android wear is
something that we shipped so you can
actually have a little map on your watch
like great for like navigation
applications that type of thing and
there's something called ambient mode
which turns it down into like a low
contrast map a very dark one when you're
not moving your watch around to save
battery life the camera to play with the
camera is really interesting to create
very dramatic scenarios there are 3d
plots you may have seen on Google Maps
and when you combine those 3d plots with
satellite imagery you can create really
interesting fun beautiful flyer rounds
of cities and again they perform really
really well
Street View also known in my opinion as
best heck ever okay so the Street View
was the tech that made me fall in love
with Google and I tell this story all
the time and this is a true story and
earlier on at the beginning of the
presentation I said I write books and I
wrote this book back in 2000
eleven and it was a science fiction book
most of which was based in the Navajo
Reservation in New Mexico and some of
which was based in a small town in Japan
just outside of Nagasaki and after the
book was published within within the
same week coincidentally enough I
received two emails from readers one
from the town in New Mexico that the
book is based is called Shiprock and one
from O'Mara in in Japan and they said we
loved the book it's so cool that our
town was in this book this is well this
is fabulous
when did you visit you know when did you
like write this book if you ever come
back you know let's grab a coffee
together or something like that this is
fabulous and I was like I've never been
to either of those towns and I did
everything using Street View you know I
opened up Street view and I walked
around the town and like one of the
scenes in this book is in the high
school in Shiprock and apparently I
nailed it you know what it looks like
and it was like I've never even been I'd
love to go someday and but it was all
thanks to street views that's right I
love Street View to me AKA best hack
ever and think about the things that you
can do for your users by having street
view in your apps mark of visualizations
custom markers i've mentioned already
sorry another one is geofencing anybody
build anything or familiar with
geofencing oh cool nice
so geofencing is the idea is you can
pick a latitude and longitude you can
define a radius around that and generate
an alarm when something enters or exits
that area and I used to have this app
that I used at home and my family still
use it so that you know I might when my
daughter started driving we asked that
she used this app so that just we could
know where she is and but one of the
downsides of this app was what whenever
she came home and went through the
geofence for home a sound would play on
everybody's phone now my dog got to
associate this sound with my daughter
coming home and my dog loves my daughter
to bits so he would hear the sound on
the phone and he'd go crazy right you
know cuz he would go run to the garage
and like bang bang bang on the door so
he could open the garage that he could
go out and he could greet my daughter
coming home and so so one day is an
experiment I decided to get the wav file
of the same sound and play it poor dog
went nuts
Mehcad my daughter wasn't home I open
the garage she had to run out to the
garage he had to run around the garage
that kind of thing and
took a little while for him to be
satisfied that she wasn't actually there
at that point I was tempted to play the
sound again but I'm not that girl you
know but it's just it's some of the
scenarios that can be enabled by
geofencing I just think are really
really cool you can you can trick your
dog with it or you can you know you can
build applications that are good for
families or whatever using geofencing
and one thing that I actually built once
was a like a the virtual reality game
that used geofencing so once you ran
into a particular area then you have
augmented reality in that area and then
you have to do things with an augmented
reality it was all a lot of fun and then
finally the activity recognition that I
mentioned you know the activity
recognition API is they will give you
back a percentage likelihood that you're
doing something they're not entirely 100
percent accurate they will say hey at
this moment in time you're you know
there's a 20% chance that you're running
but you're probably standing still that
type of thing so you know it takes a
little bit of work working with them and
a little bit of intelligence to be able
to use them very very accurately but
they are pretty good
okay so contact my Twitter's I'm at Al
Maroney if you have any questions for me
its Aylmer Oni at Google on plus and
plus Laurence Moroney or Facebook at
facebook.com slash Laurence Moroney so
with that thank you sorry for the few
technical hiccups that we had and if
anybody has any questions
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>