<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Smaller Serialized Data (Android Performance Patterns Season 4 ep15) | Coder Coacher - Coaching Coders</title><meta content="Smaller Serialized Data (Android Performance Patterns Season 4 ep15) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Smaller Serialized Data (Android Performance Patterns Season 4 ep15)</b></h2><h5 class="post__date">2016-01-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/qBxeHkvJoOQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">for mobile applications serialized data
is a large and constant chunk of
information that you have to pull down
from your servers but did you know that
the ordering of the data inside your C
realized form can have a huge impact on
its resulting size my name is Colt
McAnlis and when it comes to serialized
data it might be worthwhile to kick your
object-oriented standards to the curb
for something a little more powerful see
most folks organize their data in memory
as objects are full of members and
functions and all the other stuff
serializing arrays of those objects
preserves their structure in the
resulting data stream this kind of
organization is what we call an array of
structs form or array of objects or
classes or whatever language you want to
call it the gist is that the serialized
format mirrors the in-memory
object-oriented layout of the data which
is convenient from a programming
perspective but actually ends up
bloating your serialized stream firstly
consider that in the serialized form
each member value must generally be
declared with its property name meaning
that for each instance of your class
every property will have the full
property name as well as the value
declared in the serialized file so
obviously your file is going to be
larger as a result of all these
redundant property names just sitting
around secondly you need to understand
that this is the worst possible data
layout for applying compression to your
serialized file consider gzip
compression which is standard for most
HTTP responses gzip compresses data by
finding duplicate strings in your file
as long as they're within a window of 32
K characters from each other so the
larger your serialize classes the
further away similar data types are
meaning that there's less duplicating
inside of that 32 k window resulting in
less compression savings in general
using the array of structs form creates
larger serialized files that don't
really compress as well as they should
so what's the solution the struct of a
raised form basically think of struct of
arrays as a transposon your data given a
list of objects take all of one property
from every element and list them
together in their own array and then do
this for each property in the class for
example make an array for just the width
values in a separate array for the
height values the serialized result of
this produces simple
raise of similar typed data and when it
comes to serialization this format has
some immediate benefits firstly it
removes the redundant property names
from the serialized format basically
they all get collapsed into a single
instance so already you're going to be
producing a smaller serialized file
secondly similar data types are now
contiguous meaning that the gzip
algorithm is going to have a better shot
at finding duplicate matches since
duplicates are now going to be closer
together and more likely to exist in the
32 k window and thirdly organizing your
data in this form helps you actually
separate out content for different types
of compression for example if you have
an array of a thousand numbers the
chances are gzip isn't gonna do much
with that information but it's better
for you to apply Delta compression to
that stream of numbers before throwing
it into the serialized file this is
something you really couldn't do in the
array of structs form due to the
complexities of the object-oriented
layout that is inherent there now it's
worth pointing out that once you've
transposed your data you can get even
better compression and faster
serialization by adopting binary
serialization formats like protobufs
nano buffs or flatbuffers these formats
produce much smaller files than json or
xml counterparts and at the end of the
day that's kind of what you want right I
mean different layers of Awesome that
you can pile on top of each other to
create the smoothest app possible which
is why you should check out the rest of
the Android performance patterns videos
and don't forget to join the Google+
community for other insights from other
great developers so keep calm profile
your code and always remember perf
matters
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>