<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>The App Clinic: Cricket | Coder Coacher - Coaching Coders</title><meta content="The App Clinic: Cricket - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Android-Developers/">Android Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>The App Clinic: Cricket</b></h2><h5 class="post__date">2013-07-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/yxW29JVXCqc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome to the app clinic my
name is reto Meier and I'm the tech lead
on the Android developer relations team
and today I'll be designing the ultimate
cricket tracking app for Android if
you're wondering why I'm not joined by
my usual co-host in nee Lewis well
despite four hours of excruciating
training ian still can't reliably
determine an lv w decision without
referencing both hot spot and hawkeye
and even then half the time he'll forget
to check the pitched outside leg so
rather than subject him to the written
examination on the duckworth lewis
method i've decided to host today's app
clinic solo now I'm the sort of person
who considers pictionary a torture
roughly in line with waterboarding so
the focus of my design will Center on
architecture I'll be using apps that let
you follow cricket scores to provide
some context but the same techniques and
approaches will work just as well for a
range of apps particularly other sports
like baseball or any code of football
whether that's throwing kicking catching
around or any other shaped ball now fair
warning I took many of these screenshots
during day two and three of the second
Asha's test so any members of the
Australian Test squad suffering from
PTSD should look away as engineers it
can be tempting to start designing our
apps in terms of the data we have access
to then considering how to display that
data instead of building the ultimate
hammer and then packaging it in a shiny
box invest some time examining the
problem as a user without considering
how you'd go about solving it so let's
take a look at the problems the existing
apps already solve cricinfo is
celebrating its 20th anniversary this
year and they've always been my go-to
site for following the cricket what I
really like about their mobile app is
that the info you're most likely to want
live match scores is front and center
swiping left and right allows you to
move between all the different currently
live matches beyond that everything else
fixtures news video etc are all within
easy reach directly from the front page
Creek buzz takes a similar approach to
life scores but has limited the front
page to a list view of current news
articles the other content is still
available but they've moved it off the
main UI and into this navigation spinner
now I actually prefer this approach in
general as it makes the app landing page
you're a little less cluttered so in
terms of solving problems we can see
that both apps are providing live scores
upcoming fixtures cricket news photo
galleries and access to the rich world
of cricket statistics in terms of
priorities the focus of both apps is
live scores so let's dive in here a
little deeper when you select a live
match in cricinfo you're shown this
standard score summary it shows the
current inning score the batsmen bowler
and even the last few balls from the
current and previous innings below all
of that we have our commentary now like
the landing page everything is available
by interacting directly with the UI you
can swipe or click these icons to move
between the summary score full score
commentary and news views clicking on a
particular player will take you to their
stats page this is really the heart of
the app and they've done a great job of
fitting a lot of information into a
small area quick buzz has a very similar
match score display but it's moved the
navigation into the overflow menu
they've also incorporated a couple of
really cool features specifically
they've got score tracking and a live
audio commentary now I actually think
audio commentary is a big enough feature
that a deserves promotion right to the
action bar now note that both of these
apps have used a refresh button now big
part of my architectural redesign is
going to talk about how to eliminate the
refresh button from apps like this
things like a refresh button are a great
example of how implementation can
sometimes drive visual design as
engineers we need a way to call the
method that initiates the downloads and
then you add a visual control who's
event handler triggers that method right
well no if you start with your idealized
visual design you wouldn't include a
reefer
button you just make sure that the
scores were always up to date much like
a Save button why would I ever not want
to save my work now just because you
have a save method doesn't mean you need
to have a save ctrl on screen and it's
the same thing with refresh now I never
start a project without sketching out my
UI and I can't draw fish love or money
but this is really an important place to
start by defining the user experience
early you add useful constraints around
what your app needs to do and how it
needs to do it that clarity is what's
like is what lets you build something
that's targeted to solving real problems
rather than a collection of features you
build because you could now I took those
raw sketches and use the design
guidelines to try and put together some
mocks that sort of had that simple and
consistent feel in line with the Android
visual language in addition to the two
apps that we just looked at I also took
some inspiration from the ABCs Cricut
site which is a really clean design
without being too Spartan so I've really
tried to sort of merge those
philosophies now I'm clearly no designer
but for today's app clinic I've at least
taken my pencil sketches and turn them
into some primitive mocks for us to look
at for the real deal the Android design
and action team are going to transform
them into real mocks for next week's
show so this is the first of the mocks I
think it's important to remember that a
lot of developers can get lost in the
weeds of potential of what their app
could do so we get so caught up in what
we think we might be able to build in
the long term that we lose sight of why
we built the app in the first place so
my guiding principle for software design
both visual and architectural is to
focus on the simplest way of providing
the most important information and I do
that by asking why has someone
downloaded this app in the easiest way
of answering that question is to ask it
yourself
why would I download this app now for me
it was to track the scores of the Ash's
tests so like cricinfo and Creek buzz
when you open the app you get the live
scores for all the ongoing matches front
and center and you can swipe to
transition between them for the
remaining space I was tossing up between
displaying either just all kind
news or upcoming fixtures and to make a
choice I tried to imagine the user
experience based on someone's intention
when opening the app for the first time
when downloading or even once it's
installed every time that they open the
app now if you're checking for an
upcoming match that takes exactly
however long it takes for you to find
the match that you're trying to look for
now that's a fixed time cost that's
entirely dependent on my implementation
on how long it takes for you to get to
that point within the app now if you
open the app to re cricket news the time
cost is variable and it's dependent on
how much time the user wants to spend
reading the news so the time taken to
navigate to news is really only an
incremental additional time cost on top
of the time that they were already
planning to spend reading so by
displaying fixtures we're removing time
from a critical path of one of those
user interactions now for navigation to
other features I've actually gone with a
sliding drawer mainly because it's the
new hotness but also because I think
it's a really elegant solution to
navigating around a lot of heterogeneous
content now this is the case for an app
like this where you have a lot of
different features which could
theoretically each be separate apps but
they've been bundled together for
convenience or because they're so
mathematically similar so a navigation
drawer a sliding drawer is a really neat
way of being able to have that sort of
meta layer on top now really all of this
is window dressing for the real money
the live match display now following the
same principles of focus I've tried to
keep the match activity as simple as I
can you land on this score summary where
I've used country flags to add a little
bit of visceral reaction something that
only a national flag seems to be able to
evoke now the commentary is immediately
below and the whole thing is just a
vertical vertically scrolling ListView
now you can do a swiping horizontally
and that will switch between the summary
view the full score view or related news
based on that match so we've got a two
dimensional scroll which will let you do
the change the content that you're
displaying or the content within that
view same as the other two outs we
looked at clicking on a particular
player will take you to their stats page
and clicking on a country will take you
to a country pledge which is going to
include stats recent results and
upcoming fixtures now any sport that
includes five matched series that last
five days each is going to produce a lot
of statistics and any sport that
includes an afternoon tea break is going
to give you a lot of opportunities to
delve into those stats now in this
tablet mock-up I've tried to give an
idea that the sort of space you've got
available when optimizing for tablets
now to me it seems obvious that you're
going to want to drop the summary and
other list views over here on the
left-hand side and then you've got
almost two thirds of the remaining
display space as prime real estate to do
things like commentary player stats not
to mention even more detailed things
like match statistics player versus
player breakdowns a multitude of graphs
and of course even the possibility of
adding things like Hawkeye directly
within the tablet experience now the
mobile phone app is an ideal way to keep
track of a series or a match but done
the right way a tablet app actually
introduces the opportunity to deliver a
true cricket companion that gives you an
immersive experience that's richer and
more easily accessible than the
information already available on the web
and we already know that users spend
more time in apps on tablets so creating
a rich tablet experience is a great
opportunity to drive that deeper user
engagement now the last feature I want
to talk about from my visual mock-ups is
starring a match now starring is a
pretty well understood metaphor an
Android that's generally associated with
bookmarking something or marking
something is important now within my app
I'm going to take it as an explicit
signal that the user is interested in
this match and as an implicit signal
that she might be interested in one or
more of the teams or even the location
where the match is being played now we
can use this information in a number of
ways first by adding a shortcut to start
matches directly from our navigation
drawer but also as a way of enabling
notifications for match events now by
default I'm going to trigger a
notification
for every heartbreaking wicket every
change of innings and every merciful
stumps for every match that has been
starred and I will include a flag within
the settings menu to let users des elect
any of those particular match events now
the notification itself should show
everything related to that event so the
inning score the wicket details and when
you expand the notification the
commentary associated ideally you
shouldn't have to click on the
notification to enter the app to be able
to understand the full context around
the event that has triggered it there's
a range of actions that you can
associate with each notification
anything from links to the video clip to
sharing the data or even an option to
cancel further notifications for the
remainder of the game when it all just
becomes too depressing now the real
trick is making sure that these
notifications are timely but don't drain
the battery and that's really the
underlining philosophy behind my entire
design moving beyond the visual design
we need to create an information
architecture that will let us bring
these mocks to life now we need to
consider three factors in our software
design what do we need to show when do
we need to update what we're showing and
how do we perform these updates
efficiently now fundamentally the
answers to those questions are pretty
simple show users what they're expecting
to see do updates as often as you need
to but don't do updates if they're not
necessary and perform them using a
combination of Google Cloud messaging
sync adapters and the volume library and
of course you want to do all of that in
a way that makes it look as though it's
happening by magic now I'll forgive you
for thinking that those answers are a
little simplistic and certainly I
understand that a simple design can look
very different once you've implemented
it in the real world so before we dive
in let's take a look at a few simple
techniques we can use to add a little
bit of magic we're going to do that by
offering some features which will which
I think users will appreciate but
probably weren't expecting now when we
looked at Creek buzz I mentioned that
their live commentary option is a big
enough deal that should get promoted to
the action bar directly but what
you don't have access to a live audio
stream fear not you can take advantage
of androids text-to-speech library to
create your own dynamic commentary this
is a massive feature for folks like me
who want to follow a match while I'm
driving to and from work in fact you can
take this a step further and include an
option to automatically trigger dynamic
commentary when the user is driving
using the new location-based services
activity detection api's but of course
the real magic comes for an app that
seems to have been built especially for
you and that means showing you exactly
what you expect to see now when you open
the app to the landing page there's
likely to be several cricket matches
being played including tests one day is
twenty20 domestic and international so
how do you make sure that the match I
downloaded the app to track is the first
one displayed in this list now at i/o
last year I talked a lot about context
and taking advantage of what your phone
knows about you to create a personalized
experience that will make your app feels
though it was custom built for each of
your users so how do we find out what
match each user wants to watch without
asking them first well for a start we
can assume that the teams involved in a
starred match are likely to be an
interest similarly we can keep track of
which matches a user has watched over
time we should be able to see a pattern
to understand which teams or which
grounds a user is interested in the
games off but that doesn't help us the
first time that the app is opened for
that we need to be a little bit sneaky
err so let's start with the most obvious
check where they are using
location-based services requests the
course location permission and then
reverse geocode their last known
location to figure out which country
they're in you can even go a step
further and figure out which state or
province they're in to understand which
domestic side that they're likely
interested in but I live in the u.s. so
that's really not going to work so what
else can we try well another good signal
is the locale that the device is
configured to it's a strong signal but
my device doesn't let me choose an
Australian locale well if I asked you
what the score was on the cricket you'd
assume our
interested in Australia and it's not
just because I'm a masochist but because
I have an unmistakable Aussie accent now
it turns out that the Android voice
recognition lets you select your accent
as well as your language so using this
code you can see which language
variation has been selected boom now you
can use my accent as a way to guess
which country are support and suddenly
you've got the opportunity to customize
the UI for me and put the Aussie matches
right at the top of the list now this
might seem like a lot of work for a
fairly trivial modification but now the
first time I open your app there's a
very good chance that I'll be presented
with the exact match that I downloaded
this app in order to find out the score
for and that's a really powerful
positive signal that I've done the right
thing that I've downloaded the right app
that the person who developed it is on
the same wavelength as me other ways we
can find out what people are interested
in we can take advantage of Google+
integration and we can use the
explicitly and implicitly track teams of
our friends to help inform the the app
of the matches that we are likely to be
interested in and as a bonus by using
Google+ sign-in
you can now synchronize those starred
matches across all of the users devices
so now we know the matches that your
user has indicated that they're
definitely interested in and the ones
that they're likely to be interested in
so how else can we use that data to
improve the performance and usability of
our app well we can start by sending it
all to your server now this is an
important step as it's going to help us
is sure that we only perform updates as
often as needed to ensure that we can
eliminate the refresh button now that
means that the data being displayed
needs to be constantly up-to-date and
for sports scores that means getting
updates as soon as they happen but
without wasting bandwidth and battery
requesting updates in between overs or
during the drinks break now updates are
going to fall into two broad categories
background and foreground when the app
is open and the user is looking at it
they're either going to be browsing
looking at new stats upcoming fixtures
and so on are they're going to be
watching and match
that happens now in the latter case you
should be looking to implement the best
practices for creating apps that
transfer data in battery efficient ways
so that when they're browsing around
your site they're not draining the
battery every time they click a link now
I like to call this the big cookie model
of data transfers in real terms that
means minimizing the number of Radio
state transitions caused by your app
transmitting data to do that you need to
prefetch enough data so as to prevent
additional downloads usually within the
next two to five minutes without just
cheating by downloading everything on
your server now typically that's going
to look like around five Meg's of data
now what you download is whatever you
think a user is likely to request within
that next five-minute time window it's
another good opportunity to use it as
implicitly track teams to prefetch
commentary for matches that they're
likely to observe or which new stories
they're likely to read prefetch data is
available instantly and has zero
incremental cost in terms of battery
life so it's generally good practice to
be pretty aggressive with what you
choose to pull down ahead of time well
all the time being conscious of the
Associated bandwidth cost when we do
need to transfer data you'll want to
batch all of your transfers together
it's more efficient to transfer a lot of
data at once rather than spreading it
out over time so if you need to pull
down commentary for a new match you
should take that as an opportunity to
preempt your next batch of prefetch news
stories and score updates the easiest
way to do this is by bundling all of
your transfers together within a sync
adapter then within each of these
methods you can make a more fine-grained
choice regarding what data you actually
want to transfer each time the sync
adapter is called
now for example fixtures you probably
don't need to be updating them more than
once a day whereas news headlines we
will likely want to be much more
frequent now when it comes to real-time
updates there's a temptation to set up a
timer that just pings your server for an
update every minute while your app is in
the foreground certainly that's an
approach that I took years ago back in
the days of Google Desktop before I knew
better I
myself a widget the tract scores on
cricinfo by scraping a particular page
every minute was perfect while the match
was ongoing I got those constant ball by
ball updates
unfortunately it had a bug that included
a race condition which when triggered
meant that the widget whistie missed the
end of a match so would get a 404 but
would keep pinging the site over and
over every minute of every hour of every
day
there's only brought to my attention
when the company's tech ops folks
wondered why I was downloading one on a
quartic gig of data every week for a
month while I was on holiday so regular
updates foreground or background need to
be carefully managed in fact foreground
updates are really just a special case
of background updates one which happens
much more frequently so let's take a
look at how they can work together and
we'll start by taking a closer look at
the background update case now we have
starred updates for which we want
notifications we have implicitly tracked
teams for which we want to do regular
updates to keep the app fresh and
updates on fixtures and stats that
probably only need to happen once a day
you may even argue that the only that
only starred matches need to be updated
in the background but personally I think
that there's value in keeping the app
up-to-date even when it's not running as
long as we can do so in a way that
doesn't drain the battery if you do it
right you minimize latency at startup
you can make sure that the app is still
useful even if you don't have
connectivity right when you open it so
like the visual design I start my update
architecture with pen and paper now this
design translates into this flow chart
so let's step through it and we'll start
with our starred matches now these are
the games our users have explicitly
marked as important and for whom we're
delivering notifications while that apps
in the background now matches that are
being observed while in the foreground
for which we want to have those
real-time updates they fit into the same
category for those updates
both the foreground and background case
we're going to rely entirely on Google
Cloud messaging
we'll set a flag on the server to decide
whether we want to have every ball
updates or if we just want significant
events like
wicked sort end of innings but rather
than just sending a push message
notifying the client of a pending update
we can just send the entire update
within the GCM payload now every GCM
message can contain up to 4k of data one
overs worth of commentary is typically
around 1k so you can safely send the
commentary for each ball of an observed
match all the details of a fall and
wicked including the commentary for
background notifications now the result
is a significantly decreased latency for
those updates and a simpler more
efficient update implementation where
you're not having to figure out how to
modify the timing of your update based
on the current state of the match and
you're never doing updates more
frequently than you need to now for
matches that we aren't actively tracking
we can use Google Cloud messaging to
tickle the client when there are updates
related to the team's we implicitly
track now we don't want to initiate an
update for every new news update or new
fixture on you match for teams we aren't
actively tracking so we can prioritize
prefetching information related to the
teams we think are the most relevant to
our users now given that the data is
changing on the server it again makes
sense for these updates to be driven
from the server side using GCM but we
can make them even more efficient by
having the client influence the
frequency with which we actually receive
these updates now I like to implement a
usage back off pattern backed by a sync
adapter so every time we perform a
redundant update defined as two updates
that happen in between the app being
closed and being reopened we double the
amount of time that we wait before we
perform the next background update now
that same approach will work either by
changing the frequency of a periodic
sync set for a sync adapter or by
setting a flag on the server for each of
those client updates to say how
frequently should we should be
performing those tickles the update
itself will be performed by triggering a
sync adapter in exactly the same way as
it should happen when the app is opened
and you want to get that fresh data when
the user starts browsing now
alternatively or additionally you can
use
further context to modify the background
updates and browsing prefetch rates of
your application
for example a user standing still
browsing the app is much more likely to
browse for longer than one who is
walking around so you can use activity
detection to increase the prefetch
amount or the frequency of prefetches
based on the fact that they're standing
still similarly you can use the tilting
activity to determine when to initiate
daily updates like fixture changing
fixture changes every morning when the
user picks up their device rather than
specifying an arbitrary time finally
there's one more piece of magic that we
can build which sits at the confluence
of background updates and implicitly
tracked teams series notifications so by
tracking the teams that we think users
are interested in we can send them
infrequent notifications to alert them
of significant events related to a
particular team this can be a really
effective way to help drive engagement
by reminding people to use your app but
it's important to be very careful not to
become spammy I'd recommend only sending
notifications once per series it would
be great to know that the ashes is about
to begin but I don't necessarily want to
be told every single match that
Australia is playing now it may even
make sense to add a stop these
notifications action to the notification
itself or go the other way and perhaps
include an action to star every match in
that series so they get one prompt and
are then able to opt in or opt out of
getting further notifications so we've
covered all the technologies already but
let's quickly review the technologies
that we should be using to perform all
of these updates now I'm not going to go
into too much detail because I've
already been talking for a very long
time but I'll share some of the
resources that you can use to find out
how to implement what I've been talking
about so everything in this design is
driven from your server with Google
Cloud messaging either transmitting the
data directly or initiating a sync
adapter update through tickling the
client the Google Cloud messaging API is
are described in detail at developers
donut and red comm / Google / GCM and
you can find out lots of detail on
implementing sync adapters in this new
Android training class on transferring
data using sync adapters for populating
list views particularly useful for
things like news you can use volley
which you can find out all about from
flaccus Kirkpatrick's awesome io talk
from earlier this year one of the
challenges of having server generated
notifications based on matches that
you're syncing across multiple devices
is avoiding spamming your users with the
same notifications on their phone and on
their tablet or if you're someone like
me on four of their phones and seven of
their tablets now one of the great new
features in Google Cloud messaging is
user notifications which is part of the
upstream messaging API it's available
through Google Play services
now this API lets you send a message to
other instances of your application so
if you dismiss a notification on one
device you're able to send a
notification to the client running on
every other device that that
notification is no longer relevant and
it will disappear this is something you
can see in the latest version of Google
Calendar you can find out more details
from Francesca in the Aires IO talk from
earlier this year where he went into a
lot of detail on Google Cloud messaging
and how you can use it within your app
now that was a lot of information to
digest in a relatively short period of
time I hope you enjoyed this slightly
different take on the app clinic as
always we'd love to hear your thoughts
and feedback in the meantime I'll leave
you with these key points the refresh
button is dead Google Cloud messaging
allows you to eliminate all unnecessary
transfers while maintaining those low
latency updates the transfers themselves
should all be handled by the sync
adapter which is not only efficient but
also handles things like connectivity
changes to make sure your transfers
always get through context anything from
your user's location to their accent can
help provide those magical touches that
will cause people to fall in love with
your apps and if you're an Australian
cricket fan it's probably best to avoid
installing any of these apps for at
least the next six to twelve months
thank you for joining us this week on
the app clinic
check out developers.google.com slash
live slash Android or the Android dev
youtube channel to find out more about
our upcoming episodes of this and other
Android developer shows my name is Rotem</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>