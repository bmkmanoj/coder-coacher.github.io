<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>ðŸ’¥ Step-By-Step Implementation of a Structural Directive - Learn TemplateRef and ViewContainerRef | Coder Coacher - Coaching Coders</title><meta content="ðŸ’¥ Step-By-Step Implementation of a Structural Directive - Learn TemplateRef and ViewContainerRef - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Angular-University/">Angular University</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>ðŸ’¥ Step-By-Step Implementation of a Structural Directive - Learn TemplateRef and ViewContainerRef</b></h2><h5 class="post__date">2017-06-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/WJXgXZ-reZ4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone and welcome back in this
lesson we are going to be implementing
our structural directive we will also be
introducing the notion of view container
first let's quickly recap how our
directive is going to be used so let's
just show here how this would be used we
are going to pass in here the login
button in its initial implementation and
when we click login this is going to
trigger the opening of the model so
let's have a look at it
let's switch here to the open unclick
directive what we're going to do here is
we are going to inject here in the
constructor two things that all
structural directives need the first one
is a reference to the template itself so
as you know this directive can really
only be applied to an NG template tag so
if we inject here the template reference
we are going to have a handle to the
template so that we can use it to
instantiate the component that is inside
it now we are going to inject here
another thing which is called the view
container so what is the view container
the view container represents a
container where one or more views can be
attached so let's have a look at what we
can do with the view container so we
have here a couple of methods we can
create a component and attach it to this
view container but we can also create an
invalid view the creating valid view
method takes as input parameter a
template that we have here this is the
ng template onto which our structural
directive was associated so this means
that we can take the template we can
create an embedded view and attach it to
this element onto which this directive
is being applied so now let's go back to
our application template and see how are
we going to use this directive so let's
rewrite this we are going to remove this
ng template which was just to
demonstrate all ng-if works and we are
going to simulate here the same
situation as we have before so
we are going to adhere ng template we
are going to put the directive inside it
and we are going to remove here these
directives which gets applied here
instead so we are essentially manually
de sugaring the star syntax into this
syntax here which makes it a little bit
easier to understand what is going on in
this type of directives so the template
reference that gets injected here at the
level of the constructor of the
directive is this ng template and the
view container corresponds here to this
element we are going to be able to take
this template and by calling create
embedded view we are going to be able to
instantiate it and display it here
inline in this template at this
particular location the same location as
the ng template so now let's see how
could we implement these functionality
so we have here an input property which
is called au model open on click which
corresponds to the name of the directive
itself so what we're going to do here is
we are going to receive the value of
this property using the input decorator
with this decorator we are going to
define here a type script setter which
has exactly the same name as the input
property so this means that we will be
receiving this value here that is
getting passed to the input property of
the directive so in this case this is a
reference to the login button now
because there is no directive applied
here to this button element login button
will actually be a HTML reference to the
login button so it will be a reference
to the Dom element so what we are
receiving here is a Dom element directly
it's an HTML base element so we can
annotate it here with this type script
type definition that is a global type
definition that is available from the
typescript compiler directly so this
element does not have to be an HTML
button it could be any clickable element
on
Paige so what we want to do is we want
to take the element and we want to
detect hear the click dumb event and in
response to a click in the elements onto
which the directive is applied we are
going to take the view container and
just in case that something was already
instantiated inside the view container
we are going to clear it and then we are
simply going to take again the view
container and we are going to call
create embedded view and we are going to
instantiate the template onto which the
directive is applied so at this stage we
should already have the model showing up
on the screen let's quickly switch back
to this screen we have refreshed here
the application and now if we click here
on the login button we can see that the
model is being displayed as expected now
let's notice one thing here in the
implementation of this directive we are
adding event listeners but we are not
removing them now because the whole
element will be removed from the page in
principle this will not cause a problem
but it's always a good idea not to rely
on implicit removal of any listeners
that we add later in this course we are
going to refactor this in order to
remove these listeners manually but
right now let's concentrate on the main
functionality of what we are
incrementing which is the open and
closed modal functionality so let's see
how we are going to implement that we
are going to add here the possibility of
opening the model on the signup button
as well so right now we are only passing
in here a button let's see how could we
improve this implementation to receive
multiple buttons so the idea here is
instead of receiving only one element we
will instead be receiving here several
elements now what we are going to do
here is we are going to create here a
elements property which will be an array
of HTML based elements
the way that we are going to use this
property is that we are going to apply
for each to all these elements so we are
going to do elements dot for each and
for each element we are going to apply
the same logic that we had here so I'm
going to take this logic and I'm going
to use it here inside this inline
function we are going to call element
dot add event listener and we are going
to apply the same logic here now here we
want to support the case where only one
element is passed on and not necessarily
an array so let's quickly test here for
the presence of the length property so
if there is a length property then we
can be sure that this is an array so we
can assign it directly otherwise we need
to create an array ourselves so we are
going to create here an empty array and
to this empty array we are going to add
here a single element so it will be an
array with only one element which is the
input that we have passed on to this
property so now if we hit ctrl s this
should already be working let's get it
out if we click login the model is
showing up which means that the initial
implementation of our structural
directive is already in place and
working as expected now if we go back
here to the component and instead of
passing only the direct reference to the
login button
we instead pass the reference to an
array with only one element let's see if
this is still working so it's still
working is expected but now let's also
pass in here a reference to the signup
button so a second element in this array
is the signup button let's see how this
works so if we now hit signup the model
is still opening at this point we would
like to pass in a parameter to the model
that would control which tab gets
displayed when the model is shown on the
screen and we are going to do that in an
upcoming lesson but right now did you
notice something how would we implement
the functionality for closing the model
because the directive
that controls if the model is displayed
does not have information about if there
was a click outside the model that
information is available at the level of
the model component which is completely
separate from the open and close
directive so let's see how can we make
the two directives communicate with each
other in a transparent way this is
coming right up in the next lesson</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>