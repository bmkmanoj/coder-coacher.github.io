<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>ðŸ’¥ Angular RxJs - Separating The View and The Service Layer With An Observable based API | Coder Coacher - Coaching Coders</title><meta content="ðŸ’¥ Angular RxJs - Separating The View and The Service Layer With An Observable based API - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Angular-University/">Angular University</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>ðŸ’¥ Angular RxJs - Separating The View and The Service Layer With An Observable based API</b></h2><h5 class="post__date">2017-03-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/qvDPnRs_ZPA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone and welcome back in this
lesson we are going to continue to
refactor our application we are going to
extract more methods into the coffee
service where we see that this is the
first step that we need for solving the
method subscribes problem so what we can
do now is go back to the course detail
component which is still not compiling
and we are going to extract these
queries here also we are going to do
calls to the coffee service as well so
here what we were doing was something
else we were going to the list of
courses retrieving the course of a given
ID retrieving the course with a given
course URL so this is the output of this
part here this returns and observable of
course lot of a list of courses but one
particular course then we were
subscribing to it and we were further
retrieving from the database the list of
lessons of that particular course ID so
now let's refactor this into multiple
methods of the service layer so the
first part would be this one that
retrieves a particular course so we are
going to extract this code and we are
going to move it here to a service layer
method that we are going to call sign
course by URL and we are going to define
what is the API of this method so this
will return an observable of course so
it's not least of course it's only one
course in here we are going to return
here and observable and we are going to
define here one parameter for this
method is going to be named course URL
and it's going to be of type string so
as you can see now the code is compiling
correctly so just one explanation about
this map operation we are retrieving a
list of courses but here what we have is
an array because there is only one
course with a given URL we are receiving
an array with one element so that is why
we are accessing
here's the first element of these arrays
and we are returning it as an observable
of course so now if we go back here we
can use this new method to implement
this part of the query that we are doing
sign course by URL and we are going to
pass in the course URL so as you can see
this part of the program is already
compiling now we are subscribing to the
courses service and we are doing yet
another query here so let's start by
extracting this part here so what these
retrieve this the list of lessons for a
given course IV so we are going to
extract this and move it here to another
method in the service layer we are going
to call to that method find lessons for
course we are going to pass in one
parameter which is the course ID of type
string and the return type will be an
observable of lesson array so this will
return the list of lessons for that
particular course if we paste in here
this code we can return this because
it's returning an observable and we are
going to specify that we are acquiring
the lessons node of the firebase
database so if we go back here to the
database this is the note that we are
querying and we are querying the entries
that have a given course ID so we are
ordering by course IV this is the way
that fire by squaring works in general
we specify an order and here we say that
this property is equal to this parameter
here so now we can use this method to
finish the implementation of our course
detail so the way that we use this new
method is we call courses service find
lessons for course we passing the course
ID and we get back and observable we
subscribe to it whenever the of the rule
emits a new value that will be the
lessons for that course we are going to
store that data here at the level of
this local variable but as we can see at
this point in the program we still have
the nested subscribes problem so it's
clearly visible here free nested
subscribes so now we have extracted
these queries to the coarsest service
let's see how can we use observables to
combine these queries together and solve
the nested subscribes issue this is
coming right up in the next lesson</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>