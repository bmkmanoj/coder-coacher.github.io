<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>ðŸ’¥ Angular and Firebase 3 - Build a Web Application - 1h Course Sample | Coder Coacher - Coaching Coders</title><meta content="ðŸ’¥ Angular and Firebase 3 - Build a Web Application - 1h Course Sample - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Angular-University/">Angular University</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>ðŸ’¥ Angular and Firebase 3 - Build a Web Application - 1h Course Sample</b></h2><h5 class="post__date">2016-10-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/LVrF-aQ6NxQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone how's it going it's Vasco
from the angular diversity and I am
super excited to bring you this build an
angular 2 application with firebase
course so in this course we are going to
assume that you saw the previous lessons
on angular 2 namely that you are
familiar with components directives the
router forums and service layers but for
firebase we will start together from
scratch actually the application will be
built from an empty folder using the
angular CLI in the firebase part of the
course you will learn best practices for
data modeling you'll learn how to
structure your data you will learn how
to use the firebase push keys you will
understand how the firebase SDK works
you will also learn how to set up
security rules for your application and
do authentication in fiber you will
learn how to use the new angular fire
observable based library to interact
with firebase the real-time database
also authentication in the angular 2
part of the course you will put in
practice all that you have learned on
previous lessons you are going to set up
an application from scratch from an
empty folder we are going to configure
the router you're going to use the CLI
to generate new components and you are
going to implement them we are going to
implement many of the common patterns
that you will use in just about any
application that you build you will
learn how to setup the master-detail
client-side search you are going to
learn how to protect parts of your
application using Rooter guards you will
implement forms for creating new
elements and edit existing elements also
on the firebase part you are going to
learn how to do rest calls to firebase
if you need to and you will also learn
how to build a custom back-end in
node.js if by some reason your system
needs a custom back-end that is also
possible
we will be using the firebase cue
library for that let's do a quick
preview of what the
application will look like let's do a
quick demo of the application that we
will be building in this course so it's
angular CLI powered application that you
will be able to run from the command
line in development mode simply typing
ng serve once the webpack build finishes
the application will be available here
in port 4200 the applications front-end
is built with angular 2 and the database
that we are using is firebase so the
application is meant to have many of the
common patterns that you will use in a
real-world application such as for
example we have here the home page we
can do here for example some client-side
search let's search for template as you
can see the list adapts as we type in
the search box so this application has
for example a master detail example here
so the application is a small elearning
platform where you will have a list of
courses so you have here two courses and
if we click view on the course you enter
the detail where you will have here the
first page of lessons for this course so
each entry here is a particular lesson
and you can click to the next page to
the previous page so we will cover
pagination in firebase which is another
common pattern that you will use
probably in just about any application
if you click the lesson you will be
redirected to the login screen so this
is another common pattern in an
application
protecting the access of screens that
are only meant to be accessed by
authenticated users after login we can
access this screen that was previously
protected so it's the screen that
displays a lesson we can navigate
between two lessons of the same course
let's do that so you can see that the
lesson screen shows the title of the
lesson the duration so the course also
covers forms let's say that for example
we want to have a lesson to this course
and we have here a similar form to the
previous one but now it's sort of in new
creation mode
instead of in edit mode we're going to
see how to implement this
it's another common pattern that will be
used in just about any real application
as I've mentioned the database is in
firebase so you will learn how to setup
your own firebase real time database you
will learn how to do rest data
modification calls to firebase you will
learn how to data model your data in
firebase
what are those firebase push IDs and how
to use them best practices for data
modeling and this is only actually a
small overview of what you will learn
with this course I hope you understand
the overall idea the goal is to apply
existing angular 2 concepts to the
building of a small application learn
firebase from scratch and the focus is
on the patterns that you will use always
in any application also the focus is put
on observables observables are used
everywhere from the batch client to the
service layer so without further ado
let's get started with our angular 2 and
firebase course hello everybody and
welcome
it's Vasco from the angular University
in this lesson we are going to set up
firebase from scratch we are going to
set up the firebase SDK and we are going
to do our first firebase query we are
going to know how the SDK and firebase
works under the hood we are going to see
how WebSockets are used by fire ways and
how to debug them it's coming right up
in order to have firebase up and running
the first thing that you need to do is
to go to firebase google.com and you can
sign in using your Google account so in
this case I will sign in with the
account that I used for T's less and so
here we go and then you need to go to
console here on the top right this will
open your firebase console so now I
already have here a project but I'm
going to create a new one from scratch
let's call it final project reco
and we just click create project and
these will set up a new firebase for us
once this is done you click on the
project and you are going to open here
the welcome screen you can see here the
tutorials for firebase if you want but
in this case we are going to go straight
to our database which is empty now take
a look at this URL so everything in
firebase has an URL we are going to get
into data modeling in firebase but
remember this URL this will help you
uniquely identify your database now
before we do anything else take a look
at this informational message here so
default security rules require users to
be authenticated actually to start we
just simply want to give read and write
privileges to everyone we will setup the
security rules later but right now we
simply need to give read and write
permissions to everyone so that we can
quickly set up some data again we're
going to revisit this in the future
please don't use such a setup in
production it means that anyone could
destroy your data this is just a
temporary setup to quickly get started
with our development so if we go back
here to the overview screen
let's now grab the configuration to add
fire ways to our web application after a
while the config is ready and what you
can see here all of this is public
information there are no secret keys
here there are no private keys that you
cannot publish in this configuration so
if we just copy it let's take this
configuration and we're going to simply
add it to our index dot HTML and we are
quickly going to demo fireplace in
action let's start by writing some data
in the database so let's select the
project and we're going to click here on
the database tab and this gives us the
data of our database we are simply going
to say
here as a value as a root value hello
world
firebase now let's read this value from
our database so for that we need to
start by creating a reference to the
root node file final project recording
that we have here for that we are going
to use the firebase SDK we are going to
use the real time database and we are
going to create a reference to the root
node from here we use the firebase SDK
to subscribe to this node so you will
see this in a moment how does it work
but we're going to subscribe to value
and we are going to pass in a callback
the callback will be called once the
value is available in the browser so we
are going to be passed in the callback a
snapshot we are just going to pass it
snap and we're going to see what the
snapshot is in a moment so for the
moment let's log to the console the
value of the snapshot to see what we
have so we have the angular CLI here
running we just hit ctrl s to save the
bundle is now available and here we have
just reloaded the application so let's
try this again we just refresh the
application we can see here that
HelloWorld
firebase shows up on the console and so
we have done our first firebase query
let's now understand better what is
going on here so let's switch to another
view we have here the same hello world
application and we just received here
hello world firebase now why is it
called a real-time database let's just
edit here this message we hit enter and
take a look at the console here so we
hit enter here immediately in the
application the new value is reflected
this means that an application that is
connected to a real-time database can
receive in real time as the name says
new values for the data and in a very
performant way these allow
us to build a whole new class of
applications let's see how this is
working if we switch here to the network
tab and we turn on the filter to only
filter WebSockets let's just refresh the
application so what is happening here is
that the firebase SDK client is
connected to this firebase via a
WebSocket let's take a look if we choose
the WebSocket initiated by the firebase
SDK which is marked here we just switch
to it and we see here the data that came
over the console let's just try to
change here another value so hello
firebase again and we are going to see
that these camps via the WebSocket into
the application the on callback gets
triggered and we receive the value of
the data in the database under the form
of a snapshot the data is under the
snapshot dot Val function call
but the snapshot contains more than just
a value let's now try a more complex
example let's create an object as the
root entry of the database so let's just
call it messages and let's add shelves
to this messages object let's call it
here message 1 and message 1 we are
going to add a property of text and a
value of hello world so let's try this
out we can see here that we have here
created a messages entry under it we
have an entry with a key of 1 which is
an object which has a property of text
which has a value of hello world
so let's take a look at what we get from
the callback let's modify this message
and see what we receive here in the
console so immediately we receive the
new value let's just open it up and
under the key of 1 we have the text with
the latest message as you can see the
real-time database is very powerful if
we write to the database we can see that
our clients are being a plated
transparent
and in a very efficient way via a
WebSocket if a WebSocket is not possible
the firebase SDK will transparently
fallback to an AJAX long polling request
and so you have seen the firebase
real-time database in action and as you
can see it's really super powerful we
have introduced a couple of concepts of
the firebase SDK a reference and a
snapshot let's dig deeper into these two
fundamental concepts in the next lesson
hello everyone welcome Vasco here from
the angular diversity in this lesson we
are going to learn a couple of essential
concepts of the firebase SDK references
and snapshots it's coming right up let's
now better understand the concept of
snapshot and the concept of reference so
a reference is a reference to any node
in the firebase not only to the root
node that's for example point to the
messages null we can do so by specifying
here in the ref call let's just ask for
the messages null and let's print its
value so after clicking ctrl s we can
see that the snapshot value that I
receive directly is the one entry which
is an object with the property of text
and a value of hello world and what
happens if I print also the key so the
snapshot comes also with a key property
so this is not a function call so if we
try snap dot key what we get we get S
key
we have messages and s value we have an
object with a property of text and a
value of hello world so when we point it
to the messages node we received a
snapshot that contains as key messages
itself and as value an array with only
one element with an object let's have
another object to the
messages list so let's add here the knob
jecht under the key of two so the
message will be the second message for
example so now we have two objects in
the list so take a look the key is still
messages but the value is now an array
with two objects so as we can imagine
each object will correspond in order in
this case two the messages that we have
added here and so what happens if we now
query directly one of the objects is
this possible so let's try it out let's
try to read the message to for example
so if we go to messages
/ - and we hit ctrl s what we receive
here as key is - which corresponds to
this so this is the key of the node and
the value corresponds to the object with
message second message which is this
object right here as you can see the
firebase real-time database contains an
arbitrary structure just like a JSON
object we can point to any node of the
database using a reference and we can
query it and receive back a snapshot
which contains a key and a value did you
notice how sometimes you get back an
array and sometimes you get back an
object be sure to see our lesson on
firebase array support now in order to
better understand firebase we are going
to need some more data let's populate
the data of our development database in
the next lesson
hello everyone and welcome Vasco here
from the angular University for
populating our firebase we need to run a
script that I previously prepared now
for that we need to install firebase via
NPM instead of using it as a script tag
so let's do that first
in order to fill in the database with
some data we are going to use a script
that I have previously prepared but in
order to run the script we are going to
need the firebase SDK installed for our
initial demo we installed it here via a
script tag but in general we want to
avoid this we are going to leave the
firebase initialization script here
running and what we're going to do is we
are going to install firebase but this
time using NPM so let's just close here
the console not to have these error
messages and we'll just go in simply to
say NPM install firebase - - save and
this will install fire ways in our
application let's have a look here at
our package J'son after a while here we
have it firebase installed but this time
via NPM so if we now see npm LS firebase
we can confirm that the version
installed is free that 4.0 if we now
reload the application we will see that
we get an error let's say over here look
at the console so reference error
firebase is not defined this is normal
because we installed it via NPM but we
did not require it anywhere in our
application so that's why the firebase
variable is not installed at runtime
instead what we're going to do is is
we're going to take this code we are
going to remove it from this script tag
and instead we are going to move it to
our application let's for example go
here to our application component and we
are going to do this initialization for
example here in the constructor now as
we try to compile this application we
are going to get an air
let's have a look at it so the error is
of course cannot find name fire ways
that's because we have not imported the
fire based type from anywhere so let's
try to do that what we're going to do is
we are going to import the initialize
app function and we're going to import
the database function and we're going to
import this from the firebase module so
we'll simply do import initialize app
and database from firebase so these two
types are available in the firebase
module let's give it a try
so our application is now working again
and we are receiving know as the
snapshot value this is normal because
the database is empty we can now use the
firebase SDK with typescript so let's
use this functionality to make a small
script that will fill in our database
with some data for our application it's
coming right up
in the next lesson hello everyone
welcome in this lesson we are going to
cover firebase data modeling essentials
stay tuned it's coming right up so let's
talk about firebase data modeling and
the push keys so why did we model the
data like this so we have it here a node
of courses and we added a node of
lessons and we added here a third node
lessons per course so why would we want
to do this well to understand this let's
go back to our program here in the
constructor of our application component
we are creating a reference to the root
of the database so this root node
corresponds to let's collapse all the
actually there is a button here collapse
all date the root corresponds to this
the final project recording node so when
we subscribe to the value of this node
notice that this is an open subscription
this function this callback will be
called each time
that we receive a new value and we will
receive a new snapshot so if we just run
this program what we are going to
receive here is value take a look this
is the whole database so whenever we
select a node in firebase we get
everything literally everything under
that node we cannot let's say that for
example we had put the lessons inside
courses there was here property named
lessons if we would query a course we
would also get all of its lessons but
maybe we just want to show a list of
courses so this is why in firebase it's
important so it's the same thing as in a
relational database you want to
denormalize your data you want in
firebase to keep your data as flat as
possible
so do not use multiple levels of nesting
instead of that insert your entities in
lists and if you want to link them
together one way of doing it is to
create an association know where you
associate the increase together
so to summarize in five ways you should
try to always keep your data as flat as
possible preferably put your entities in
a top-level node which has the name of
the entity like for example courses or
lessons if you want to associate the
data together make sure to use an
association node where you link the data
using its key so we are going to learn
more about what are these push keys
exactly remember the structure of the
database is arbitrary so nothing
prevents you in firebase from using data
nesting you could put the lessons nested
inside the courses assuming that a
lesson only belongs to a course but
let's say that for example in the future
that is not true anymore you could have
a lesson that belongs to two courses
that would be quite troublesome to fix
to refracture also let's say the
you assume initially that there aren't
many lessons per course so you wouldn't
fall into performance problems also that
could very easily change in the future
you could have courses with a lot of
lessons again refactoring that would be
very troublesome I would advise you to
normalize your data as much as possible
from the beginning and systematically
this is probably the safest and most
future-proof approach for structuring
your data in firebase now that we know a
bit about data modeling it's time to
answer the question what are these
strange-looking push keys
we will not wait any further we are
going to go through it in the next
lesson hello everyone how's it going
Vasco here from the angular University
we're going to dive straight in to the
angularfire library which is observables
based we're going to start by the first
concept of the library how to query
lists in firebase it's coming right up
so far we have been using the firebase
SDK directly using its firebase
typescript definitions what we're going
to do now is we are going to use the
angularfire library instead in order to
interact with firebase and we are going
to see the advantages of doing so in a
moment first let's just install the
angularfire library in order to use
angular fire we need to install the
angular fire module in the imports of
our application so let's just do that
let's just import it and we need to call
initialize app and we need to pass it in
the firebase configuration that I have
put here in an external file so firebase
that perfect es contains the
configuration for accessing firebase
with this our angular fire module is
installed let's now use the angular fire
module to do our first query what we are
going to implement with angular fire is
the equivalent of what
see here so this is just a plain query
to the courses node where we are going
to print all the courses to the screen
we're going to implement the same thing
with angularfire so for that let's
simply inject here angularfire in the
constructor of our class we don't need
to initialize the application anymore
because it's already initialized so
let's just delete this what we're going
to do is we're going to use angularfire
to query the courses node and retrieve
its contents so take a look with
typescript with Auto completion you can
see here that the angularfire injectable
has either a database or off property so
we can access the database we want to
query the database you know we have two
options either list or object let's do
list for the moment I'm going to explain
the difference between both in a second
so let's just query courses now what do
we get back from this function call this
is actually a firebase list observable
so this is an observable let's assign it
to a variable so let's call it courses
and we're going to add a dollar at the
end of it to mean that it's an
observable the type of this variable is
implicit but let's make it explicit just
to confirm the actual type so let's make
it a firebase and we have here list
observable see as you can see there
aren't any compilation errors so this is
the correct type that we are retrieving
from the list call now let's have a look
at what we have here available in this
type so we have a series of methods that
we will be using throughout the course
right now take a look we have a
subscribed method this is indeed an
observable so let's subscribe to it and
simply output its value to the screen to
see what we get let's just do a console
that log of the value and let's try it
out one thing to bear in mind is that
the firebase lists observable is a
generic
type so we need to pass in here so it's
unobservable but what is the value that
the observable returns and that is the
meaning of the type so for the moment
let's specify it as being any let's see
what we get in the console so if we
refresh the application we can see that
we get here an array so take a look this
is a list call so it makes sense that it
returns an array so what are the
elements of the array let's compare it
to the content of the database so the
first element is a key take a look it
ends it with M underscore M underscore
so it's discourse here right Engler -
tutorial for beginners it does match the
same course and the second key is for D
which corresponds to the second element
of the array which is the angular - HTTP
and services course so notice that under
the variable dollar key we do have the
value of the key of the list item that
we just square it and the other
properties are the values now take a
look at this we are going to clear the
console remember we have subscribed to
an observable so what will happen if we
modify anything under these note courses
let's for example modify here the
description of this course let's add a
string to it
let's click enter we have received here
in the console and new value so the
subscription for that observable is not
canceled it's still active so any
modification on the database we have
here the new value that is available
with the string test so the subscription
is still active we are continuously
receiving from the real-time database
any new value if we do any modification
to any node that is below courses let's
do for example here a modification of
the description of the second course
this also triggers here a new value so
we can see here again the string test
but this time in the angular - HTTP and
services course
so this is a very important notion with
this we can see that the angularfire
library is completely based around the
notion of observable so the API calls
returned observables
and we subscribe to them to get the
contents of parks of the real-time
database we are going to see that the
observable API is really a great way of
modeling a real-time database a
real-time database can really be seen as
simply a stream of values over time by
the way one interesting thing what we
are doing here is we're passing to the
first argument of subscribe a function
that takes as argument a value and
console logs the value itself so what we
need is a function with one argument
that outputs the value to the screen
this is actually equivalent to simply
doing subscribe console that log so we
are passing a reference to the console
dot log function so this also works and
it's a little bit simpler to read so as
you can see observables are a really
great API solution for interacting with
something like a real-time database if
we would be using promises they get
resolved and they only return one value
that is inherently not what we are
looking for while interacting with the
real-time database the real-time
database we are interesting in
subscribing to it and receiving multiple
values as they evolve over time we are
going to see how to take only the first
value if that's what we need for our
application right now let's go to the
second primitive of angularfire how to
lower the objects it's coming right up
so let's start building the home screen
of our application so we're going to
start really simple we are just simply
going to display a list of lessons so
not courses but lessons we are simply
going to display all lessons on the
screen in a data table it's simply going
to be a read-only table and later we are
going to have more features to it but
for now let's implement that it's a good
start we are going to take here some CSS
that we already have prepared we are
going to put it in app dot CSS and let's
start building the home screen so the
first thing that you want to do is you
want to build the home component so for
that you just use the angular CLI so ng
generate and you specify what you want
to generate light in this case a
component and let's simply call it home
and let's see what gets generated here
so you can see here the list of files
that were generated and their path so
they are under here in app and we can
see it here under home we have here a
series of new files so here we have it
the home component now what we want to
do is we want to apply this component to
our application so let's go here to the
main HTML template of our application
and we are simply going to replace this
with the app home element so notice that
whenever you add a component via the CLI
the CLI will also take care of adding it
here in your application module so if
you now run ng serve again the component
is ready to be used and we should see it
displayed here in the home screen so as
you can see the home component let's
take a look at the HTML so this is the
HTML generated by the angular CLI so we
can see that the component is working
and ready to use
so let's now implement it but before we
implement the component we want to
change a little bit the HTML over
application let's instead add here a
main element and we're going to put app
home here inside a main container
to remove a poem from here so the goal
here is to simply Center the content on
the screen now let's implement the
component itself what I am going to do
here is I'm going to paste some initial
HTML so this is plain HTML let's build
it to see what it looks so there is no
angular specific functionality here what
you get here is just a list with a
single element and what we are going to
do is we are going to implement this
title here where we are going to put in
the total number of lessons then we are
going to loop through each lesson and we
are going to output the description and
the duration so the first thing that we
need to implement this screen is to get
the data from our firebase real time
database so we have here the initial
version of the home component now
nothing would prevent us from injecting
here angularfire directed directly this
would work but this is not recommended
the component should not be aware of
angularfire
or firebase direct it's better in
general to inject here a service which
is part of your service layer the
service is going to return observables
of playing data types such as for
example lesson in this case let's create
a lesson service to see what this looks
like what we're going to implement now
is client side search so whenever we
type here on this text box let's say
that we were typing template the word
template the list below should reflect
the search here on this input box so in
each key event each time that I type a
letter here I would like to update the
results below immediately so how do we
implement this first of all the lessons
list component which is a presentation
component is unaware of this logic it's
simply at each moment receives a list of
lessons and displays it it does not know
if the
lessons are the result of a search of a
back-end query etc so let's refactor the
home component to include this logic the
first thing that we are going to do is
we are going to rename this variable
lessons to be all lessons now we won't
get any more results because what we're
displaying is a variable called lessons
that no longer exists so we are going to
create here another variable called
filtered so what we are going to do here
is we are going to use it instead of all
lessons so let's just pass this to the
lessons list component the filtered
lessons in the initial call from the
back end we are going to store lessons
in all lessons so whatever we receive
from firebase we are going to store it
here but we also want to initialize this
variable so let's do that so we did this
by using here a chain of assignments we
have assigned lessons to filter it and
all lessons so we have here again back
some results now to implement the filter
logic what we need to do is we go to the
input so it's this search bar here what
we're going to do is we are going to
detect the KeyUp event so with each key
up we are going to trigger search and
search is a method here in the home
component let's create it now the search
method receives one parameter and we are
going to call it search as well which is
the current content of the search box
and how do we pass it in if we go back
to the template well we need to pass in
the content of this input so input dot
value what you can do for example here
is using a reference using hash input we
define a reference to this element so as
we know a reference whenever it's
applied to a plain dom element the
reference will point to the dom element
itself so if we do input dot value we
are passing in the value of the textbox
to the search
now how do we implement the filtering
what we can do is we are going to assign
to the field trip variable we are going
to filter all lessons so we can use for
example the array filter method and we
need to pass in here a function that has
one parameter which will be a lesson it
will be of type lesson and that it
returns a boolean true or false that
indicates if the description of the
lesson contains the string that we are
searching for so we are just going to do
a very simple implementation so lesson
dot description and we are going to see
if it includes the search term so if we
now try this out we should have a
working functionality for searching
lessons so you can see that the list is
being updated as we type on the input
box
let's now implement the navigation
between the courses page so the list of
courses and the course description so
whenever we click on the View button
what we want to do is we want to
navigate to a concrete course based on
its URL so let's say that we clicked
angular 2 tutorial for beginners we
click view what we want to do is we want
to navigate here to a URL angular
tutorial etc for beginners and we want
here the main route our outlet to be
replaced with the course detail
component so let's start by simply
create a course detail component so ngg
component and we are going to generate
the course detail component so we can
see here that the course detail
component was generated now what we want
to do is we want to configure the router
with this master detail navigation
scenario to configure the master detail
scenario what we can do is we define a
series of child routes so let's use the
children property and
so we are going to define a couple of
routes so let's define here for example
the empty path and here we are going to
pass in the courses component again and
we are going to specify the child route
so with the route parameter of I D so
this will correspond to the URL of the
course so here the component is going to
be the course detail component
okay so let's quickly try out the
configuration so remember the router
configuration it's a good idea to test
it from the beginning we don't even need
to add Reuter links to the application
we can do so by testing the URL so we
can see here that courses still matches
to the courses component but if we add
here some URL we should get here the
course detail component which is the
case in order to implement this
navigation from master to detail we need
to go to the template of the courses
component so this template right here
and in this button whenever we click the
View button we are going to use the
Rooter link directive to do the
navigation so what we want to do here is
we don't want to pass in a constant
string so this is what happens when we
use the directive without this syntax
the template property syntax now
whatever is inside here will be an
expression that gets evaluated so here
we are going to pass it in course dot
URL let's see the data so remember each
instance of course has an URL so let's
see this in action if we try this out so
meanwhile the application has reloaded
we click on view and let's inspect the
the URL first so we are still in slash
courses but now we have here getting
started with angular 2 which is the URL
of the angular 2 tutorial for beginners
course so this is what we would expect
and here in the main root or outlet we
have the course detail component so this
is working as expected
let's now implement the functionality
that loads the next page so in firebase
the way that we lower the next page is
we have here the first page which is the
first free elements we need to take the
key of the last element of the first
page and we need to query firebase
saying start at this element and take
four elements and exclude the first one
that's how we are going to retrieve the
next page so let's implement it we need
access to the last element of the lesson
array so that we can retrieve its key so
in order to have access to it one way of
doing it is to actually subscribe to the
observable and retrieve the lessons and
store them in lessons variable so this
does not end with dollar because it's
not an observable these are the actual
lessons we will also need the course URL
we need to store it here in a member
variable of this component so that we
can use it in the previous and next
method so let's define here course URL
simply as a string in order to implement
the next page logic let's start by
implementing the API call to the courses
service because that will define the API
that we are going to use so we are going
to call an API name lower the next page
this is the API method so we are going
to pass it in the course URL and now
here what we need to pass in besides the
page size we need to pass in the key at
which which should start our query now
currently we only have the key at which
our current page ends so let's pass that
one so to obtain it let's simply do the
following we take the lessons array and
we take its last element and we take the
key so it will be as simple as that now
again this will return an observer
so we definitely need to subscribe to it
we are going to save the lessons into
the lessons member variable now to
implement the courses service load next
page call so I'm going to do here some
formatting so that we can see so it
needs to return an observable of lesson
array just like loading the first page
it's actually very similar so what we're
going to try to do is we are going to
base ourselves on this method but these
will no longer be the first page lesson
keys let's rename these to simply keys
actually let's name it lesson keys
instead we add a dollar signifying that
it's an observable so instead of wearing
the lessons per course starting at the
beginning end limiting to the first four
elements actually to the first three
elements what we are going to do is we
are going to start at this lesson key
that we received so it's the lesson key
of the last element of the first page
and we are going to load one more
element because if we are starting here
on the third position we need to load
four and then remove the first element
and like that we have the next page from
elements from four five and six
let's also specify that we want the
query to be ordered by key so the key is
this element here and we also want to
remove the first element that we receive
because we are going to receive four
elements remember here it's page size
three plus one we're going to receive
four elements so we are going to remove
the first element using the slice
operator let's try this out if you click
on next page you can see that the next
set of lessons is being loaded as
expected
hello everyone how's it going it's Vasco
from the angular University in this
lesson we are going to learn how to
create a safe URL pipe that allows us to
inject iframes into an angular 2
template security always comes at the
expense of convenience in order to
better protect us against common
security related attacks angular 2
prevents us from doing certain
operations like for example simply
adding an iframe to an angular 2
template that are allowed in plain HTML
that are not possible by default in
angular 2 we can still do those
operations but we need to explicitly
inform the framework that a certain
resource is safe let's see how to do
that so let's add to our lesson screen
let's add here an embedded video which
will be pointing to my YouTube channel
so if we check here the data you can see
that there is a video URL property for
each lesson which points to simply an
YouTube video in my youtube channel so
we are just going to use that as an
example what we want to do here in terms
of HTML is actually very simple we want
to create here an iframe let's give it
some fixed dimensions and set some other
commonly needed properties when dealing
with iframes now one thing that we want
is this iframe to only be visible if
there is a lesson with a video URL
otherwise it will give a strange effect
on the screen so if the lesson is not
available the iframe will not be
displayed now the only thing that we
need to pass to the iframe is the URL to
the video and that should be it but as
we will see in a moment that is not the
case let's try this out to see what the
result is we are going to pass in here
the video URL if we now try this out we
can see that we get an error so let's
see what it is we have an error caused
by unsafe value used in a resource URL
context and here they point us to the
documentation
turning cross-site scripting attacks or
XSS now what is causing this we are
trying to pass him to the source of an
iframe to the source attribute of an
iframe we are trying to pass in some
arbitrary data that we received from the
backend this data might have been
submitted to an attack and now if we
simply use it in the page we might be
showing some unintended content so in
order to protect us from this type of
situations angular does not allow this
we need to explicitly mark this video
URL as safe in order to be able to pass
it into the source attribute of an
iframe in order to fix this issue we are
going to create a pipe we are going to
call it safe URL pipe and this is going
to give the indication to angular that
this is actually a safe URL to use so
let's implement the safe URL pipe if we
go here to the command line we are going
to use the CLI to generate a pipe and we
are going to call it safe URL and we are
going to put it under the shared
directory and and everything that has to
do with security
so let's generate the pipe so we can see
that the pipe here was generated under
the security folder as expected
let's now implement the safe URL pipe so
the implementation is actually quite
simple we just receive a URL here as a
string let's inject the Dom sanitizer we
are going simply to use the sanitizer to
mark this URL as safe as you can see
everything is working as expected and we
have here the embedded video from
YouTube so we can play it open it on
YouTube etc
we are now going to enter the forms part
of the course we are doing to create a
new lesson form that will allow us to
add a new lesson to a course and we are
going to create an edit form that allows
us to modify the values of a given
lesson these forms are very similar
these two forms actually visually they
are almost identical so we are going to
see how can we implement this without
repeating code let's start by creating
the new lesson form and we are going to
be using reactive forms so for that we
head over here to the application module
and we are going to import the reactive
forms module here so as you can see we
have imported reactive forms module from
at angular slash forms so now our
application is ready to use reactive
forms so let's head over to the command
line and we're going to do ng G
component and we're going to call it new
lesson so the new lesson form will
contain a form to create a new lesson
and it will contain a Save button
but that form we are going to put it in
a separate component because we want to
reuse it across pages we want to use it
also in the edit form so we are going to
do ng G component and we are going to
call it lesson form our next step is now
to configure the router so that we
navigate into this new form screen where
are we going to make this button
available it will be inside the course
detail component in order to configure
the navigation to new lesson let's
replace this with a list of shell
droughts so we are going to have here
the children property and we are going
to pass it in an array inside this array
we are going to put in first the same
path that we had before so if it's the
empty path we are going to display the
list of lessons for a given course the
course detail component but if we
navigate to a path and let's call it for
example new if we navigate to a path
called new we are going to show a
different component we are going to
show the new lesson component let's
implement the navigation to this
component so if we go to the course
detail HTML template we have here the
new lesson button using the router link
directive we're going to say that if we
are in this course and we navigate to
the sub path new we are going to trigger
the new lesson component so let's try
this out as we can see we are here in
the course detail for the angular 2
tutorial for beginners course and if we
hit new lesson we have just triggered
the new lesson component now one of the
things that the new lesson component is
going to need in order to save a new
lesson for a given course is to know
which course are we adding a lesson to
we are going to add that information but
as an optional parameter in the
navigation so the way that this works is
this is a query parameter we are going
to have new and then we are going to add
a question mark we're going to pass in
the course ID in order to do this we are
going to use the query parameters Rueter
directive that we have not used so far
so we simply pass in query parameters so
the end of the URL will be slash new but
now after the question mark we are going
to pass in a couple of parameters and
here we pass in an object and we are
going to give it a property which is the
course ID now remember in this template
the course is not a member variable we
are going to use the sink pipe and we
are going to extract the key of the
course let's try this out if we now
navigate from a course page into the new
lesson screen we can see that here at
the end we are adding in a parameter
after the question mark course IV where
we are passing the course IV now let's
go to the new lesson component and let's
retrieve this ID for that let's inject
here in the constructor the activated
route and since we're here let's also
inject here the lesson service because
we are going to need it to save the new
lesson we are going to create a new
method
lessen service that allows us to save a
lesson to the database now here in ng on
in it we are going to retrieve the
course ID and we're going to assign it
to a variable let's declare it here this
is going to be a string and using the
router snapshot in this case we can use
it because there are no navigation onto
itself scenarios we can see here that we
have the parameters the query parameters
these are not the URL parameters so
using the array notation we are going to
extract here the course ID and as a test
at this moment we are going to simply
going to log it to the console so let's
try this out if we go here to the first
page of the angular 2 tutorial for
beginners and let's hit new we can see
here that the course is being printed to
the console it ends in un let's see the
URL it ends also in UN so this is the ID
of the course angular 2 tutorial for
beginners so with this we have sort of
the skeleton of the screen in place
let's now start implementing the new
lesson form hello everyone how's it
going it's Vasco from the angular
University welcome this lesson we are
going to cover the angular 2 router
resolve functionality how to write
resolvers for the angular 2 router
specifically we are going to cover the
case of writing a data resolver using
observables if you find yourself in a
situation where you are trying to do a
transition between routes and the
transition is not happening it might
have to do with something that we are
going to talk in the end of this video
it has to do with how we should write
our observables inside our resolver so
stay tuned it's coming right up
so the lesson forum would take here as
input a lesson we should pass it in a
lesson object as input let's first read
it from the database so how can we do
that we could read it directly in the
edit lesson component but we are going
to do it in a slightly different way we
are going to read it using a router
resolve
so how does this work we start by
injecting in this component the
activated route in this activated route
we have here available a property called
data this data property receives input
data for the component that was
previously retrieved before the
component was created by the router so
if we subscribe to the data observable
we are going to receive here a data
object in this data object we are going
to extract a lesson that is already
available for us and we are going to
find it under the property lesson of the
data value this property here lesson of
the Edit lesson component will be of
type lesson so let's import lesson now
how do we feel in this lesson data
before the component is even created if
you go back to the Rooter config what we
need to do is to the edit lesson
component we need to configure here a
router resolver to configure a router
resolver let's see what properties we
have here we have here the property
resolved now in here we are going to
configure which data resolvers are
triggered just before we create the edit
lesson component we are going to create
here a resolver for the lesson property
and we are going to call it lesson
resolver this class does not exist yet
so let's create it we are going to go
here to the shared folder and here in
the model folder we are going to create
file called lesson resolver TS and
inside it we are going to define a class
called lesson resolver now how is this
class implemented in order to be a valid
router resolver well this class needs to
simply implement the resolved interface
this resolved interface takes the
parameter type and we are going to make
it a parameter of type lesson so we
import the lesson and now we are going
to implement the resolve method of the
interface
let's see what is the signature of this
method so we take this first argument
activated route snapshot and here a
second argument the whole router state
in this resolved method we are going to
return an observable of any in this case
we are not going to return a promise in
our implementation a resolver is
actually also a angular2 injectable so
this is just like the lesson service we
should configure it in the injectibles
of our application let's switch here to
our application module and what we're
going to do is we are going to provision
the lessons resolver here in the
providers of our module declaration now
because this is an injectable this has
access to any of the injectables of the
application and this includes of course
the lessons service that we are going to
use to retrieve the lesson data so how
do we retrieve the lesson data via the
route activated route slapshot we have
here available via the parameters of the
router the IV parameter we have
available the URL for the lesson so
let's use it to retrieve the lesson
using the lesson service let's do that
if we use the lesson service and we use
the find lesson by URL and if we replace
it in the route params ID property these
will return us the lesson so we can
actually make this observable and
observable of lesson if we go back to
the Rooter configuration we can now
import the lesson resolver now let's go
back to the edit lesson component as we
can see we are assigning the lesson that
we received from the data lesson
property we are assigning it to this
variable to make sure that this is
working we are going to use the do
operator as before to do a console dot
log we are going to try this out and we
are going to run into a very common
observable related problem take a look
we are going to go to this lesson so
this is the first lesson of the first
and we are going to click Edit lesson
now what we can see is that the
transition is not made we did not lower
the edit lesson screen and why is that
in order to understand what's going on
let's go back to our lesson resolver so
take a look we are returning here in the
resolve method we are returning an
observable of lesson and this observable
is built using fine lessons by URL which
is internally built using angular fire
now the angular fire observables that I
returned by the angular fire API they
are not completed after the first
emission of the first value so if
someone goes let's say here to the
database and they would add it here the
long description that would trigger the
emission of a new value for the lesson
with this URL so what's going on here is
that the resolve method when it receives
an observable it expects that observable
to eventually complete and only after
the observable completion will the
routing navigation be triggered so in
this case what we need to do is we need
to return to the call of resolve we need
to return an observable that completes
and this observable emits one value but
then it never completes so one way of
ensuring that this observable completes
after emitting the first value is it is
for example to call first
on it another way would be to call take
one so that would work - let's use the
operator first let's try this out now if
we now go back to the lesson detail
screen and we click on the Edit lesson
button now the routine transition
completes this is because the observable
that we are returning is completing due
to the first operator and this scenario
of a hanging route navigation that we
have just shown this is just one example
among many of how when we are dealing
with observables either returning them
from our API calls etc or sending
observables back to the framework it's
important to bear in mind when this dis
observable complete because that might
lead
to some strange situations like it's the
case here for example there are XJS
operators that won't work if you try to
use them with an observable that doesn't
complete so it's just something to bear
in mind</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>