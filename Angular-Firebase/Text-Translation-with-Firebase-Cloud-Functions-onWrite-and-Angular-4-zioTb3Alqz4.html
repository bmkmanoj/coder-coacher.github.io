<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Text Translation with Firebase Cloud Functions onWrite and Angular 4 | Coder Coacher - Coaching Coders</title><meta content="Text Translation with Firebase Cloud Functions onWrite and Angular 4 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Angular-Firebase/">Angular Firebase</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Text Translation with Firebase Cloud Functions onWrite and Angular 4</b></h2><h5 class="post__date">2017-06-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/zioTb3Alqz4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this episode we're going to build a
text translation feature in angular 4
and we're going to do it completely in
the background using firebase cloud
functions and the Google Translate API
this example is going to take a string
of English text and translate it to
French Spanish and Arabic we're able to
make this work using the on write call
back from the firebase database which
will trigger a cloud function that
handles the entire translation process
in other words we're going to build a
micro service specifically for
translation and we're going to trigger
this micro service to run every time new
data is added to the database the first
step is to model the data in this case
we just have a collection of translation
and each translation has a set of key
value pairs where the key is the
language and the value is the translated
text so the user will enter the text in
English and then the cloud function will
write the data at every other language
that we want to translate the first step
is to allow the user to input their tags
to the firebase database so we'll start
building that in a service the service
only needs one function called create
translation it starts by pushing the
user text to the database then it
returns that as an object observable so
we can update these or interface
asynchronously
now we can start building the component
first we define a variable for the users
text and then we define another variable
for the current translation which is the
observable returned to us from the
service then we create a handle
translation function that will trigger
the entire process when the user submits
their form from the template I'm also
creating a default message helper that
will tell the user when the cloud
function is running in the background
it'd be a good idea to replace this with
a loading spinner or possibly a progress
bar and the template we start by
creating a text area then we use ng
model to bind it to the user text
variable that we defined in the type
script then we create a button and
attach the click event to the handle
translation function since our current
translation isn't observable we can use
the async pipe to unwrap that
asynchronously in the template
in this case we use the question mark to
safely access the attributes before
they've been defined otherwise an
exception would be raised and we also
use the or operator to display the
default message if the translation is
undefined now we can start building the
cloud function if this is your first
time using cloud functions in angular
you'll need to run firebase in it from
the command line from there we'll need
to install the necessary packages in the
cloud function environment I'm using
lodash to make the java script a little
more readable and also using the request
promise library to send the request to
the Google Translate API make sure
you're in the functions directory and
then run npm install and the index.jsp
file we start by importing the necessary
libraries then we run exports translate
to you name our actual cloud function
from there we make a reference to the
database location we want to trigger the
function then we call on write to run
this callback whenever new data is added
to the database at that particular
location next we create a promise for
each language that we want to translate
we build the promise by making a request
for the Google Translate API through
this URL here URL self needs the source
language the target language and the
text itself when we send the request we
need to make sure to resolve the promise
with the full response if we get a
successful 200 response we convert the
response to JSON and then use the
translated text is the data that we use
to update firebase the final step is to
update the firebase database as an admin
user and if there's an error we want to
throw that error to make sure it shows
up in that cloud function logs if we go
back into the app now we can see that
our data is being updated and we're
getting translations back from the cloud
function pretty quickly
looks like about 300 milliseconds for
the function to execute
that's it for this episode if you found
the video helpful please like and
subscribe and if you want to support the
channel consider becoming a pro
subscriber at angular firebase comm for
just a few bucks a month you'll get
access to exclusive content as well as
free one-on-one project and Colton
thanks for watching and I'll see you
next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>