<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>TensorFlow.js Quick Start | Coder Coacher - Coaching Coders</title><meta content="TensorFlow.js Quick Start - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Angular-Firebase/">Angular Firebase</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>TensorFlow.js Quick Start</b></h2><h5 class="post__date">2018-04-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Y_XM3Bu-4yc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">the most exciting thing to happen last
week was the announcement of tensorflow
GS
a javascript library that allows us to
build train and make predictions from
machine learning models directly in the
browser will use tensorflow j/s with
angular to take a hand-drawn digit image
and then predict its actual numeric
value I'm super excited about this
because it opens up a whole new world of
possibilities to combine web development
with machine learning make sure to
subscribe if you're new here and you can
grab the source code from angular
firebase com the first thing we need to
answer is what is tensorflow and the
simple answer is that it's a library for
performing mathematical computations but
it's famous for building deep neural
networks that power some of the most
impressive artificial intelligence
technology that we have in the world
today the sad part of this answer is
that if you don't have a background in
machine learning tensorflow is not going
to be very easy to use or very useful to
you that being said I started out with
zero machine learning knowledge a couple
years ago and it worked my way up to an
expert rake on kaggle which is the hub
for data science competition around the
world if you want to get really good at
machine learning I recommend spending
about half your time with traditional
courses such as Coursera or Google's
machine learning crash course and spend
the other half of your time applying
what you learn in data science
competitions on Kaggle but be careful
because data science competitions can be
very very addicting if you're watching
this video with zero machine learning
background I still want to give you a
high-level overview of how machine
learning models work the typical
narrative goes something like this we
have a set of data and each item in that
data set has a label telling us what it
is in this video we're using a data set
called M nest which is a series of
images of hand drawn digits because
you're most likely a human being it's
easy for you to recognize what these
digits are but to a computer each image
just looks like a matrix of values and
it has no way to discern the context or
actual meaning of the image itself a
typical image recognition convolutional
neural network is going to look at many
samples of these images and attempt to
extract features out that will
distinguish one digit from another the
algorithm starts off completely random
then slowly corrects itself
after seeing more and more samples of
these images so that's a very high-level
overview of how a tensor flow model
might work what I want to show you now
is how we build and train a model and
then make predictions from it in the
browser I'm going to generate a new
angular app with the angular CLI then
we'll CD into the app and install tensor
flow J ass for this first part what I
want to do is show you how to build the
most basic possible tensor flow model
which would just be a linear regression
so we'll feed tensor flow an array of
values that should predict some other
value think of the relationship between
a person's height and weight you should
be able to use their height to roughly
predict their weight we will train the
machine learning model and angular when
this component is initialized and then
when the user enters a new value into
the form field
we'll run a new prediction with that
tensor flow model if you're more of a
visual person the actual data set would
look something like this with blue dots
being our samples and then the red line
being the model that tensorflow
generates let's go ahead and code this
up by opening the app component in
angular then we'll import tensorflow
under the namespace of TF then I'm
setting up a property called linear
model that defines the actual tensor
flow model that will train and make
predictions we're going to use the
sequential API and tensor flow J S which
is a little bit higher level and easier
to work with it's very similar to Karis
if you have a Python background then
I'll also set up a property for the
prediction value so we can show it in
the front end UI in this demo we're only
training some randomly generated static
data so we'll do that as soon as the
component is initialized tensorflow j s
works in promises so it tends to be
really easy to work with in JavaScript
apps we'll set up an asynchronous
function here called train new model
then we'll define an empty model by just
calling TF sequential in this case we're
just performing a linear regression and
we can do that by adding a dense layer
or a fully connected layer that will
output a shape of one and also take an
input with a shape one in larger neural
networks you have multiple layers and
the dense layer keeps all of the neurons
in each layer connected together but
since we're only drawing a single
straight line through the day
we don't really need to worry about that
we just need to define the loss metric
which in this case will be mean squared
error in other words we're just trying
to minimize the mean squared error of
the predictions from the algorithm then
we also define an optimizer which is the
function that determines how we reach
this actual minimum error point SG d
stands for stochastic gradient descent
and there's a number of different
optimizers that you can choose from so
that's actually our entire model right
there now we just need to Train it by
feeding it some data but we need to feed
it that data in the form of a tensor but
you might be asking yourself what the
hell is a tensor for our purposes the
easiest way to think about it is just as
an array for example a one-dimensional
tensor would look the same as an array
of numbers the actual tensor terminology
is not something you really need to get
tripped up with especially when you're
just learning tensor flow as you can see
here we have 1 tensor named excess when
you have a variable named X in machine
learning that means it's your actual
training features for the data set the Y
variable on the other hand is the label
for that data it's the actual thing that
we want our machine learning algorithm
to predict depending on the size of the
data set training the model can take a
long time but in this case we just have
a few values so it's going to happen
very quick and we make that happen by
calling linear model fit with our x and
y data the end result there is that we
have a statistical model that can now
predict values based on this data set
that we've provided to make a prediction
we'll call linear model predict then
pass on the value in the form of a
tensor that's going to return a
prediction in the form of a tensor so
now we just need to convert that tensor
into something that we can use an
angular everything in tensor flow runs
in the context of a session so to get
out the data we actually want we create
an array and then call data sync on the
tensor now we'll switch over to our HTML
and run this linear prediction method
whenever the form value changes on this
HTML form input if we pull up the app in
the browser we should get the results of
our linear regression
if you enter a smaller number the
prediction should decrease if you enter
a larger number it should increase now
that you know the basics let's do
something
a little more complex neural networks
have really revolutionized image
recognition problems in this example
we're going to take an image of a
handwritten digit using an HTML canvas
and then we'll have our neural network
predict what the actual value of that
number is the training process for an
algorithm like this is way too CPU and
memory intensive to run in the browser
but one of the really cool things about
tensorflow j/s is that we can import
models that have been trained in Python
so that means you can build your own
machine learning model on your local
system and then upload it to your web
app so your users can use it on the web
I included my model in the source code
for this project but I recommend going
to kaggle and participating in the digit
recognizer competition using Kerris to
build your own from scratch caris will
allow you to export your trained model
and then tensorflow has a tool that
allows you to convert that model into a
format that can be used specifically by
tensorflow j/s to install that tool you
need to install tensorflow j/s with the
Python package manager pip then it gives
you a command that will take the Charis
file and not only convert it to
tensorflow j/s but it will also shard
the file so you can load it efficiently
on the web for right now I'm just using
the assets directory and angular but
you'd want to use a cloud storage bucket
in the real world now that our model has
been converted to tensorflow I'm going
to go back into the app component and
add a load model method to ng on init
and a quick side note I'm using this
drawable directive to create the HTML
canvas I'm not going to show you that
code but it's in the main repo if you
want to check it out
you'll notice here that this time our
model is type two just a point tensor
flow model that's the lower level API
that's generally a little more difficult
to use if you're a newcomer then this
time our predictions will be an array of
ten different values where each value
represents the probability that that
index is the correct value for the
drawing on the canvas so we can take the
index with the highest probability and
assume that that's the number that was
drawn on the canvas
since our models already pre trained we
can just load it with a simple one-liner
of tensorflow load model but our predict
method is going to be a little more
tricky
the first thing that makes it more
tricky is that we need to think about
memory management neural networks can
use a lot of memory and we want to avoid
memory leaks in our client side app to
do that we can run all of our code
inside this tensorflow tidy method that
will ensure that all of our tensors are
released from memory when that
prediction is finished
the actual image data that we want is
coming from the HTML canvas that were
extracting as the image data type you
can pass on a variety of different types
here and it will convert the image into
a tensor that can be used in the tensor
flow graph in our case this model was
trained with images that were 28 pixels
by 28 pixels with just one color channel
so we need to reshape our data into that
shape the first value here is the batch
size which is going to be 1 because we
just have one image then 28 pixels by 28
pixels and one color channel the Python
model that I trained for this demo is
using an integer data type but
tensorflow requires it to be a
floating-point so we can change that by
calling tensorflow cast because all data
types in a tensor need to be the same so
now that we have our data in the correct
format we can just pass it into our
model and call predict and just like
last time it returns the prediction as a
tensor so we'll convert that to an array
and call data sync in this demo I've set
up my app to run this predict method
every time a new image is drawn into the
canvas it's not a perfect model but it's
about 90% accurate with my handwriting
and you can clone this repo to try it
out for yourself but if you're curious
to you visualize how the neural networks
under the hood I recommend going to the
tensorflow playground this was actually
the original inspiration to tensorflow
j/s and it shows you how neural networks
build complex boundaries around data
sets to make predictions I'm gonna go
ahead and wrap things up there if you
want to see more tensorflow content
please let me know in the comments and
if you want to learn how to build modern
JavaScript apps for any platform
consider becoming a pro member at
angular firebase comm you'll get access
to a huge library of exclusive content
as well as one on one project support
thanks for watching and
see you soon</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>