<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Single Page Web App Fundamental Architecture | Coder Coacher - Coaching Coders</title><meta content="Single Page Web App Fundamental Architecture - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Love2Dev/">Love2Dev</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Single Page Web App Fundamental Architecture</b></h2><h5 class="post__date">2017-03-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/aabWPheE93M" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so you're curious as to how to build a
single page application well you're in
luck because I was going through my old
recordings and just happened to stumble
across a screen cam that I did
explaining core concepts of single page
applications the caveat I recorded it
nearly four years ago some of the code I
would not want to write today not the
way I write code today but fundamentally
sound explanation of single page
application concepts many of which are
the foundations of what we call a
progressive web app today
so if you're wanting to know a little
bit about how to architect single page
applications this video is for you now
the application that I'm using in this
video was a demo application I built for
a book that I wrote about the same time
called high performance single page web
applications if you'd like to buy the
book is available on Amazon still $39.99
and you can click the link in the
description below now go on and enjoy
the video
on single page application features
Oh
okay let's look at how a single-page
application works I'll try to talk about
some of the issues that I found over the
years again I started actually doing
single page applications almost out of
necessity
about three three and a half years ago
when I first started building mobile web
applications and I quickly realized that
that traditional request/response model
just wasn't going to work to make the
kind of stuff that people wanted on the
mobile experiences also another thing
performance performance is a huge deal
making a site load within one second is
always my goal and then after that
making everything else extremely fast
and a natural fluid transition so the
users don't have to wait at all and
that's something that should be
extremely important to you in your
applications just so we get this out the
cruft out of the way I want to just move
the focus there we go
so now we looked at the responsive
nature of this website I kind of touched
on some of the single page features and
I want you to pay attention up here at
the top to the URL I'm gonna expand this
out so we make sure we see everything if
it will let me here we go now do you
notice I've got the hash-bang there for
the default I talked about that kind of
being the de facto standard to drive
single page application URLs even if
you're say building a lot of business
applets behind the firewall I still kind
of recommend you use these hashbang urls
to drive stuff apparently because now
you can use the little engine that I've
got with the routes and stuff involved
and you've got the deep linking so that
your employees can actually bookmark
things and you can kind of control how
those URLs articulate themselves if you
will so
despite tension to that and as I go
through the different things I want you
to kind of notice what's going on first
like I said I've got a little flip
animation and going on here but probably
the production I'll take it out just
because it doesn't just doesn't see any
work in ie11 it did work in ie10 but
they seem to have broken a CSS feature
that I've reported so anyway there we
saw the little flip animation and went
from the home page to a list of movies
that are opening this week just the full
list instead of the short smallest that
we had before and notice at the top my
URL hash fragment actually changed and
have movies and opening now if you've
been like me over the years
I loved hacking at URLs especially query
string parameters and stuff as a simple
way to hack it stuff well you can hack
at these two so if you do that it's
gonna go in theaters that's great now
that's cool and all let's go to the
network tab and let's do a recording of
all the traffic that goes back and forth
so let's go back to the home and let's
go to opening movies and let's go bring
up Kerry now let's go back to the
network waterfall tab okay I have one
request I just went through from the
home page to a list of opening movies
and then I opened a movie detail page so
that was three page requests in
traditional sense but as you'll notice
the only content that was actually
requested was an update to an image and
that image was we look at the response
body was the actual movie poster for the
Kerry movie for some reason that was not
I didn't have the proper a caption if we
brought it up before which I think we
did so that net wasn't necessarily there
but I didn't have to actually go request
any data and the reason is is because
I've already cached that locally and put
that into local storage now what I want
to do is just kind of keep going through
this part I want to kind of show you how
I give up
the spa part of the application
first here's the JavaScript for my main
movie application module now any modern
application there's some there's
maturing guidelines I guess you will our
best practices for building modern
JavaScript applications generally that's
to have a core application that's
extensible and to do that I actually
reverse engineered Java jQuery the way
they actually build that library and
found a very useful pattern and that's
how I structure all my JavaScript
patterns these days and the reason is is
because it's easy to understand to build
as well as extend it's just dirt simple
to extend and to create new objects of
it so we create a new movie application
I'm actually going to go through and
self instantiate it and then I want to
go through and do some initial set up in
this case I'm making sure that I have
some features that I need ok so in this
case I've got a reference to backpack
I've got a data abstraction a little
library that I wrote and then my
template engine in this case I'm using
mustache for my JavaScript templates and
mustache allows you to precompile
template so I go ahead and just pre
compile those templates and then I set
up some other things here's where I set
up toolbar here's where I sew up some
navigation touching features for the
hamburger nav and the main nav and
here's where I add a global resize event
I actually have a little mechanism when
I put in play where you can actually
inject methods or callback methods that
need to get called when the views resize
based on the individual view and that's
just kind of an example of something you
can do actually use some of the dynamic
features of JavaScript called
associative array techniques to actually
make this happen here and here's where I
want wire off the bat the back button
the little left arrow at the top left
corner and then I would return a
reference to the new instance that we
created up here at the top so now that
everything's initialize the way we want
we've got access to that now to kick it
all off I actually use a what I call it
bootstrapping technique and this is one
of the last Java there
should be the last javascript file in
your chain of JavaScript files and what
that's going to do is going to create me
a new instance of backpack my little
data library and then I'm going to pass
in or those references to set up in my
movie application and got those all set
up then I'm actually going to create a
new instance of my spa and that's going
to be set up and I'm passing on some
parameters for that as well to set up
now to actually show you how I extend
the core application each view has its
own set of methods and I tend to put
those methods into a dedicated file
again it's easier to organize and find
when you're developing you don't step on
each other's toes so easily you don't
get these giant JavaScript files that
for a development are just hard to
maintain manage
here's where I'm actually loading there
the the initial load method for my home
view and that's going to go through it's
gonna set up some stuff it's gonna go
grab the data I've got some these
methods are actually defined in the API
file but notice I'm using a reference to
that which is a local variable of this
and the reason why you want to do that
in JavaScript is because you gotta kind
of keep track of this this context
because inside of this little callback
method here the this is not going to be
necessarily the same
if this outside that method call so what
you do is you create a local variable
and then you actually can reference it
inside of this method and I'm know I'm
using this and that a lot just try to
keep track and trust me on this so then
now when I use that it's actually going
to reference the variable that that I
have defined up here and then I have a
merged data method which is a general
method that I have to actually merge
data that comes back in JSON format with
a particular template mustache template
that I have defined and then once that
content is actually generated by the
templating engine to append that or add
it at the right place which I'll have a
glass here that I'm gonna actually use
as my anchor to put my movie credits in
there and as you've seen actually using
the application that all happens
extremely fast so I did the same thing
here it's just opening the movies and
it's got took at the callbacks here
here's where I'm actually setting up the
resize event for this particular page
and I want to make sure that panorama
width is constantly set to the the right
size there are some JavaScript things
that I'm doing to set the styles for the
actual width and stuff so it responds
'iv those kind of do need to be called
as the screen size adjust and you want
to kind of make sure you're not
constantly running through the entire
logic string every single time it
resizes so it's a little detail oriented
as far as making it work correctly so
and this is the actual method here and
as you can look at the code later on and
you can see these methods are available
to you so this is wrap those on a
self-executing anonymous function so it
keeps it make sure it's out of the
global namespace which is good but for
every individual view I make a different
javascript file to have its methods
stored and they're all extended by doing
this the movie app itself is called
movie app and that's gonna actually be a
member at the global point that's the
only variable at the global that I'm
actually creating call it is called
movie app and that's the one I'm going
to make new anything else is a member of
that particular object now if you
actually go back and look at the the
main core note module an alias in the
prototype 2f and that's something that
the jQuery module actually does and I
found it to be actually be useful
because it's a shorthand notation and
it's easy to kind of see and read and
then I'm just extending that prototype
to the load movies view and you want to
extend the prototype and instead of
extending at the main object level
because then as you new up new instances
these things just carry along with it
and that's what you really want it's
better for performance memory etc and
then so all these methods now are just
part
of that object they're just extended off
because javascript is dynamic you can
add and remove members as you need them
now one of the things I actually do is
here's I've got all my little data calls
to make the Ajax calls I've made
abstraction methods for each one of
those because I reused a lot of the code
over and over again I just want to make
it a little easier to use
now one thing you may be noticing I
don't have jQuery in my application I've
kind of don't use jQuery unless a
customer requires me to use jQuery
because it just can't meet my
performance guidelines especially in the
mobile context and I found that it was
actually not that hard to write vanilla
JavaScript meaning that I actually
talked to the native API directly so
think about it this way if you didn't
have to use c-sharp and you could you
found out that was actually pretty easy
you see to call the win32 api you can
make some extremely fast native windows
applications not saying that c-sharp
applications aren't fast but you could
actually make measurably fast and much
smaller tighter applications as well
that's effectively what I'm doing here
so I don't have a jason ajax library per
se although it's not that hard to kind
of write it up yourself I did find a
nice little ajax library called request
on micro j Escom which has a list of a
lot of little small oops
tiny fast almost a fastest qualitative
but they tend to be fast libraries to
accomplish the things you need you don't
necessarily need a full library like
angular jQuery or something like that
that's a everything for everybody kind
of library because generally you only
need a small portion of that library to
actually accomplish what you need and
these little micro libraries are great
for them and I found the request is
pretty easy to use it actually
implements the same interface that
jQuery does except it's just a lot
smaller and tend to be a little bit
faster so that's kind of why I went with
that now I actually wrote an abstraction
library over top of that and the reason
why I did that is because I use a
technique to store data in local storage
and we'll look at that here in a second
it's easier to visualize in chrome but I
want to walk you through the code first
and again I'm making them
just like I showed you before and in
this or ultimately going to do what we
call an AJAX pre-filter now this comes
from jQuery the read the place I got
this particular methodology here was
there is an AJAX pre-filter available on
github I think kind of think of the guys
in that James Pierce I think the guy who
made it anyway and what you're doing is
you're kind of injecting yourself into
the ajax pipeline of the library and in
this case i'm wanting to see if the data
already exists in local storage if not
then i'm going to ultimately make the
ajax request i'm going to store the
result in local storage with a
time-to-live value as well so that I can
do kind of determine when that data
becomes stale so they don't have data
hanging around that's no longer valid
anymore now that could be a minute in
your case it could be a month or a year
it depends on your data and your culture
so you kind of need to think accordingly
I've set it up so that you can define
how long something lives so in the case
of a movie a movie detail doesn't really
ever change it comes back from Rotten
Tomatoes so in theory I could probably
set that out to a month or two before
that becomes stale but a list of movies
that are opening next week
that changes every week so I need to
make sure that that is time so that it
it updates itself accordingly you know
top box office obviously changes every
week generally those change on Thursdays
with movies but I can't necessarily
guarantee that's what's gonna be the
case so I think what I've done is I've
actually set it up to me to keep those
lists for a day and typically try to
keep the the movie details a little bit
longer because those tend not to change
very much at all now like I said in
general you get five megabytes of
storage and local storage older mobile
devices it may be a mega two but
generally those devices they just aren't
really used for
heavy browsing if you will I don't want
to sound prejudiced or anything but most
the time
what they do is users of those phones
they don't really do a lot of browsing
or anything they're generally talk on
the phones and text messages and check
Facebook but that's that's neither here
nor there now with Windows 8 and
Internet Explorer 10 and 11 of what I've
read and I haven't totally verified as
you can get up to 50 Meg's of storage
and local storage so I hope you enjoyed
that video on single page application
architecture and principles again record
the video sometime in the 2013 timeframe
however may those principles still hold
true today and they are the foundation
for progressive web apps and honestly
some of what the Google Chrome team
calls the purple pattern as well as the
rail pattern so hopefully you've been
able to learn a little bit maybe apply
that to your development process and
maybe it'll make your applications
better you want to know more about
making great web applications especially
progressive web apps and service workers
you want to subscribe to this channel
you can do it by hitting the button over
here or in a button down below</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>