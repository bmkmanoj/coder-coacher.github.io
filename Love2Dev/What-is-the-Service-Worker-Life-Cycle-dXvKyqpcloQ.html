<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>What is the Service Worker Life Cycle? | Coder Coacher - Coaching Coders</title><meta content="What is the Service Worker Life Cycle? - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Love2Dev/">Love2Dev</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>What is the Service Worker Life Cycle?</b></h2><h5 class="post__date">2017-09-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/dXvKyqpcloQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is the serviceworker lifecycle I
mean what am I even talking about here
but honestly this is an area that trips
up a lot of new serviceworker developers
and I'll want to take a little bit of
time to try to explain it to you today
hey guys Chris love the owner of love
the dev and today we're going to talk
about the serviceworker lifecycle now
you may not have heard about this
especially if you have a not started
working with service workers but this
might be one of the more important
topics that developers really need to
master when they start learning service
workers once you understand the
serviceworker lifecycle then you can
start doing think cool things like
caching and push notifications now what
am I talking about when I talk about the
lifecycle well really what we're talking
about is how is a service worker
installed and what does the update
process look like
now there's trips up a lot of developers
because when a service worker is
initially registered and installed it is
not necessarily in control of the actual
client that they're working they're
trying to debug through so what
typically happens is a new service
worker developer writes a little with
service worker code registers it in
their client-side code and goes to the
developer tools and tries to start
debugging but the touch event never
triggers the activate event never
triggers the install event does trigger
and they're wondering what is going on
why is my service worker not actually
working well there's honestly two
reasons why your service worker may not
be working yet and the first one is
there was an exception in your install
of them now that's not a part of the
life cycle but it kind of is and it is a
common reason that service workers are
not actually operating now normally if
you're in the developer tools and you're
looking at the service worker tab in the
developer tools you'll see like an arrow
that's logged there and you can actually
go look at the error usually in the cons
but typically what's going on is if you
try to precache things and one of the
files that you tried to precache had an
error like 404 some 500 level error code
that causes that cache at all or any
kind of cache add function to throw an
exception and anytime there's an
exception in the install event handler
then the entire service worker
registration fails and that's why you're
not seeing it now we can go into that
antenna into another additional videos
and stuff like that we've got some
content on that and some of our courses
as well that today we really want to
focus on the serviceworker lifecycle now
there are basically three phases to the
serviceworker lifecycle the first one
you must register the serviceworker when
a serviceworker is registered then the
serviceworker subsystem actually
installs the serviceworker and there's
an event that you can capture at that
point and do things next when the
serviceworker does become active or
actually becomes the serviceworker
that's running against any potential
clients within its scope the activate
event triggers so there are three steps
in the serviceworker lifecycle process
but there's more to it than that now on
the board here I've drawn two different
gears each one representing a
serviceworker if we have an existing
serviceworker
running against a client don't scope
then this one's going to be running but
if we register if we load a page and a
new version of a serviceworker is now
available then the register and install
event are going to trigger and you're
technically going to have two versions
of the serviceworkers running however
serviceworker 2 is not in control of
anything to do with any of those clients
and the reason is they don't want a new
serviceworker potentially breaking an
application and this couldn't really
happen now think about it if you've got
probably even if you got just one client
but let's just say you have multiple
clients multiple tabs open and the
browser is the easiest scenario
and tab one tab is constantly being used
by the person which triggers the second
Service Worker to be loaded because now
it actually notices that there's a new
Service Worker available well those
other tabs are being controlled by this
one and the client side code is actually
synced up to think about this one being
the Service Worker this can control but
because you've got a new version you
could put have potential braking changes
there and you need to be aware of that
so what they do by default is this one
sits in wait until all of the clients
have been closed this means all the
browser tabs any push notification
clients background seeing clients just
that you've got to realize it may not
necessarily mean that the browser tab is
the only client under the scope of a
particular service worker that is
currently active you may have to wait
for some of those background tasks to
close out as well remember a Service
Worker is a different thread and it does
not run in the scope of that UI throw
that were used to working with and
that's why this can get a little tricky
because there is going to be one
instance of that Service Worker running
and it could actually control number a
numerous amount of different client
experiences think about it if you've
been in any enterprises and you sing a
lot of business workers a lot of times
it will have multiple multiple tabs open
to the same line of business business
website may be on different pages so
they can see different things at the
same time so you need to be cognizant of
those particular situations now once all
those clients are closed then this
particular Service Worker will then be
terminated and it will go off into the
serviceworker graveyard let's call it
okay so it will be will no longer be in
scope no longer be available to it and
serviceworker too is now the
serviceworker that's in control and then
you can start actually debugging your
new serviceworker now if you are
absolutely positively sure that your new
serviceworker will not break any
existing clients that are open they give
you an opportunity
cause that new Service Worker to just
jump ahead and take control in your
install eventhandler
you can call the Skip waiting function
and this will cause the new Service
Worker to take control just be aware if
something breaks it's on you so be very
careful about this at that point the
activate event will trigger and then you
can do any kind of cache cleanup or
anything like that if you really need to
if you really wanted to you and you did
that skip waiting you might even do get
away with doing that in the install
event highly highly recommend you debug
this experience before you deploy it and
to make sure you're not going to break
anything and try to give yourself the
ability to easily get out of those
scenarios where something breaks now one
way that you can get away with it when
you do the Skip waiting is you can cause
the put you can pass a message over to
the UI thread that would then trigger
something like a message going to the
user and asking them to reload the page
because you've made some background
updates now there's a lot of
applications that employee that type of
update process so it's not something
that's completely unfamiliar to
end-users but you want to be very
judicious and just throwing that around
and thinking about a great way to
actually provide them that experience
that way they know that it's safe or
it's something that it's okay to do all
right so that gives you an opportunity
to just make your service worker take
control now as developer that's gonna be
very convenient for us because we're
trying to troubleshoot and get things
done quickly and a lot of times we may
just put that skip loading code in there
before you ship it I gotta tell you make
sure that everything is kosher with your
application and you're not going to
break anything because you could get
yourself into some sticky situations and
deployment if you do that I have
personally been guilty of that because I
didn't realize that I was breaking
things now once you've done that
obviously your service workers are in
control and then your fetch event
handler is going to trigger your push
notification events will Han it will
trigger your background sync events will
trigger and they'll everything should
have a nice happy dance at that point
now as a developer if
don't wanna put the code into your
install of that but you do want your new
Service Worker to become active so you
can debug it and that's exactly what I'd
want to do
he had the developer tools open and if
you wanted a debug it you probably
already do you can go to that Service
Worker tab and you can manually do the
Skip waiting there and that way you
don't have to write the code in there
but you're still going to need to
actually click the link to make the
developer tools force that service
worker to become active
just remember to do that just because
you do it you may not necessarily
realize certain things are going on
I know manually doing things in the
developer tools is maybe not necessarily
the best way to do it it's a quick term
fix you may forget to do that from time
to time sometimes I've had the thing
where it's completely offline and I've
totally forgot so you need to be very
careful when you do that to make sure
you've got essentially a standard
operating procedure that you follow and
you're going to man know you to manually
do that if not go to the Skip waiting
but also be sure to only ship that when
you need to so I hope this is tease you
a little bit about Service Worker
lifecycle there's a lot more to it
there's a lot more detail you can get
into a whole clients API and taking over
those clients and managing those clients
talking to those clients and to help you
get better knowledge of the Service
Worker lifecycle we have a whole course
on just-just-just dedicated to the
surface Service Worker lifecycle and
that's because this is such an important
topic and it's much deeper than the
surface stuff that I've talked about
here in this short video and I want to
make sure that you are a developer that
really understands how to do service
workers and do them well and
understanding Service Worker lifecycle
is one of the key aspects that is like I
said it's very overlooked by most
developers it's not common that we need
to dive into something like that as
service workers are a much different
programming paradigm than we're used to
doing on the client side and even a node
and just because they're JavaScript
we've got a lot of different things we
have to understand and learn so if you
like this video you found it useful
definitely hit the like button share it
with your friends but as always she got
questions and I hope you really have a
lot of questions feel free to leave
those in the
section below and I loved dialogue with
you and who knows if the question is
good and useful for a lot of folks I'll
try to make some more content dedicated
just at the answer for your question or
maybe you've provided a good answer and
I can go deeper with you on that as well
thanks a lot I'm Chris love the owner of
love - dev and I hope this video has
been very helpful to you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>