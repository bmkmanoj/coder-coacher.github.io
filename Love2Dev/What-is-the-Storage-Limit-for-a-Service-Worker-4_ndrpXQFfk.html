<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>What is the Storage Limit for a Service Worker? | Coder Coacher - Coaching Coders</title><meta content="What is the Storage Limit for a Service Worker? - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Love2Dev/">Love2Dev</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>What is the Storage Limit for a Service Worker?</b></h2><h5 class="post__date">2017-11-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/4_ndrpXQFfk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi guys Chris love the owner of love to
dev and in this video I want to answer a
question that developers and managers
are having about serviceworker caching
but the answer really is more about how
much space does the browser give us to
actually store content or cache content
on the client device and the answer is
it depends but the good point of that is
that there's kind of a de facto standard
that's more or less being adopted but
there are variations to it
but first let's kind of look at storage
and what's part of storage if I go over
to Chrome and we go down to application
and you see we have storage here but we
also have cache now this cache is our
serviceworker cache and it's gonna show
us what's being persisted in in cache
you're also gonna see the app cache
value here it's right now I've got
nothing because I'm not using that cache
on this particular site just yet the up
here in storage you also see we have
local session storage index DB web
sequel which you shouldn't honestly be
using anymore and cookies which
hopefully you're not using that many or
much of at this point on there but
that's as much as you probably should
have these days anyway so how much
storage are you actually using well you
could in theory go through and calculate
it but it would be a real pain in the
rear do it and I've seen some scripts
that are trying to attempt that
especially over local storage because
local stores you only get about five
Meg's to persist content and it has to
be string based so you're not really
going to be storing images or media
files font files things like that in
local storage anyway and because of that
you should be able to store just about
an entire website in there without the
media files most websites should be in
the kilobyte range when you just break
it down to just markup from scripts and
CSS
so you you definitely could have enough
room to store all that there but now
we're getting into service workers and
there's potential to cash a lot of
content
now before I kind of really go over the
kind of guidelines on that let me just
tell you if you've got a large site you
need to put a lot of I would say
customized logic to manage how much
you're persisting in your storage and
the reason being is most people are on
phones these days and they're not gonna
have a ton of storage allocated to you
the other side of that is they're gonna
be on cellular devices and you don't
want to be downloading your entire
website payload over a cellular network
to the customer that's just bad manners
and it's gonna eat up their data plan
now the whole goal is try to reduce
network traffic and if you've properly
designed your website meaning you may or
may not be using an app shell but you've
got the common assets precache like
javascript and CSS and maybe some common
images some frequently visited pages on
your site you've got proper cache rules
and stuff in place for that
then you should not be burdened or
concerned about consuming too much
bandwidth to make your site load and
work offline nicely now I'm not gonna go
over at those kind of strategies here in
this video in our course we're about to
launch we will have a lot of deep dive
on caching strategies and there will be
you know several hours worth of content
around that that you definitely want to
stay alert for so you'll know when we've
got that course ready to sign up for and
you mean one of the first ones to go in
there and master progressive web apps
and service workers now so we've got all
that said get my little public service
announcement about being kind to your
visitors and everything what we do have
is the way
cash is allocated instead of an
individual value being given say the
local storage or to indexeddb or to the
browser cache in general what the
browser's do is they allocate
I would say a know a rough amount of
space to you for your your domain and
the domain being like your domain calm
your origin is what we call it - and all
that you get a certain amount of space
and that space available varies based on
the amount of space available on the
actual device now I'm on a surface 3
recording this right now enough right
now I've got about 250 gigs of free
space because I recently repaved the
machine and I have not downloaded a ton
of stuff to it to clutter on hard drive
so I've got a lot of space available now
if I was on a phone and remember the
average person's phone is somewhere
around a nexus 5 kind of phone is what
the average person actually carries
around these days they're not carrying
around massive amount of storage even
though if you get a say a large iPhone
the apps on the iPhone are so large
people generally don't have that much
space available anyway especially if
they take photos and videos and/or have
music that they've downloaded they
generally don't have any space available
on these devices and so you're gonna get
a lot of space to work with
in fact I'll right now I think Safari is
kind of the one holdout of this room
about to go over to my knowledge they
haven't adopted this pattern yet right
now I think it is capped out at 50 mix
is the maximum you can get now I do
believe you can prompt the user to get
more space say for indexeddb but I've
never hit that limit personally so I
haven't had to go down that route just
yet but back in September Ollie with the
Microsoft edge team was going over the
serviceworker roadmap for Microsoft edge
and he finished up his presentation by
kind of going over this question and I'm
talking to you about today and he he
shared this kind of guideline that
generally the browser's are starting to
adopt now there can be variations to it
the catch here is that there is nothing
in any of the web platform
specifications it says how much space
the browser should allocate to
storage for an origin or for any of
these particular cash services but the
rule is based on this kind of table if
the volume which is the amount of disk
space available on the device really the
hard drive you're persisting the storage
on is less than 8 gigabytes available
then it's going to limit you to 20% of
the overall space which can still be a
lot or 50 megabytes okay so when I say
the 20% could be a lot it technically it
could be a whole lot but it's going to
be 50 megabytes is probably where you're
gonna be sitting and that's why I say
pretty much Safari is gonna be sitting
at that 15 mega limit because it's gonna
be very rare that anybody on iPhones
gonna have more than 8 gigabytes free
space on that particular device so 50
Meg's is probably probably need to count
on because most people I'd say 90 to 95
percent of traffic on the web right now
is on phones and you're probably gonna
definitely gonna be under that a Giga
limit for just about everybody
so don't when I say do your calculations
still calculate on about 50 Meg's being
free but with that said there are
scenarios where obviously you can get
more if you're in that 8 to 32 gig free
range then you can go up to 500
megabytes which is really large I think
you could you could justify just about
every website that's out there and
probably fit it on 500 Meg's if you've
got properly optimized images and don't
cram a lot of unused JavaScript and CSS
on there etc you could probably get I'd
say 95% of the websites in there for
sure but you don't want to do that and
then if I've got 32 to 128 gigs what you
know which is probably you know a lot of
desktop computers laptops and stuff that
are still in use I've got a good chance
of having they're gonna get 4% of the
actual volume size which is still quite
a bit of space and then if you're in the
state that I'm in like right now you're
gonna get 4% or 20 gigabytes whichever
is smaller now you're gonna see here in
a minute that is not
true but anyway so in theory I should be
capped out at 20 gigabytes but as you're
gonna see in a second I looks like I've
got 33 gigs or something like that
available to me so least in chrome so
that is a good segue into what I wanted
to go over next as you can see here on
this little config page of the fast
furniture demo application I have a
thing here for how much space is being
used and it's telling me I've got 18
gigabytes use I know that's definitely
not true
so it's probably why this is off and
it's saying that many is I've got to
figure out the math on this but
basically there is a storage estimated
estimator thing and I think what is
wrong is the example code I followed was
by dates and I think that was bits is
what I was really trying to show me so I
probably got 18 probably 1.8 Meg's is
probably what I've actually cut cached
it might be 18 Meg's think about all the
images I do have a cache at this point
so probably it was 18 Meg's probably 18
Mattox and I probably have it's still
probably 33 gigs or whatever I got to do
the math on this but basically just
echoing out what's going on now if I go
over here to sources this is gonna be
pretty ugly because I'm on the small
screen move this a little bit there we
go it's a little better there is a new
API that's getting deployed right now I
can only verify support in Chrome and
I'm not sure what version of Chrome but
most likely you've got the version of
Chrome at this point because most people
will never get two versions of Chrome
behind and if you want to do that I've
got I've got a progressive enhancement
feature detection which is how you
should always do it it is to check to
see if storage the storage object is in
the Navigator object and that the
estimate method is in the storage object
and if so then you can use it and what
it's going to do is you call the Storage
Manager and the estimate method that
returns a promise and it'll give you a
an object back in this case it's called
estimate
and that estimate is gonna have a couple
of properties one is usage which you can
see right here and the other one is
quota and right now I'm trying to divide
by million because I was thinking anyway
I'm still working on the math I gotta
just kind of hack this together real
quick for the video and I'm just echoing
those out for us but I'm also logging
that here so it's go to the console you
can see what it says and that's that's
actually where I got the the sample code
from to play with was just going out the
number of bytes so I gotta I gotta work
on this a little bit but that's okay
so this is one way you can kind of at
least echo out how much is being used
within your application and also
remember to if someone has on Chrome for
Android specifically at this point
they've got Oreo they can also manage
storage like a regular application
because if they've added the progressive
web app to their home screen it
automatically gets converted to that web
APK format which makes it a native app
on the platform and so they've got
additional interface to it at that point
so hopefully this gonna help you in your
pursuit of knowing how much space do we
have available to actually store stuff
and honestly you've you've probably got
a lot more you think but I would say the
rule of thumb is to know that you've got
about 15 Meg's on most cases but as far
as what are you going to store in
serviceworker cache you're definitely
gonna have I would say just plow that's
just like 40 35 40 Meg's at most is what
you're really gonna do and you if the
storage estimator API is supportable
platform you should be able to access
that and even put some logic in place to
manage what's actually stored in a
serviceworker cache now if you start
hitting those limits the browser's will
start throwing things overboard as they
see fit and no one's really told me what
the heuristics are as far as determining
what which one of your assets is gonna
be thrown overboard so you definitely
want to be in control of that and always
just know that things may or may not
even be there but if you design your
caching strategy correctly
worse-case all you're gonna run into is
a network halt and not your application
completely falling over so but if you
are designing for a scenario where your
users are going to be offline or or in
poor connectivity consistently and you
need that offline capability then you
definitely need to plan accordingly and
again if you've got media that needs to
get persisted try to keep that to a
small amount
try not to possibly use like high
resolution images and definitely make
sure that those images are optimized I
always advise using responsive images as
well and when it comes to leveraging
those responsive images you may need a
caching strategy in place for the
particular device that you're being that
the application is being used on and
download those file sizes accordingly
and I should do a good video or two on
responsive images so definitely stay
tuned to the channel for that you've got
any questions about browser storage
please leave those in the section below
if you think this is useful really
encourage you to like this video and if
you think it's helpful send it over to a
friend and let them see it as well and I
hope this is helpful against krislov
I've loved to death and want to be one
of your top resources for progressive
web apps and service workers and
hopefully this will help you pursue and
add those to make your site's an awesome
experience</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>