<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Philly Code Camp PWA Search and Faceted FIlter Source Code | Coder Coacher - Coaching Coders</title><meta content="Philly Code Camp PWA Search and Faceted FIlter Source Code - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Love2Dev/">Love2Dev</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Philly Code Camp PWA Search and Faceted FIlter Source Code</b></h2><h5 class="post__date">2018-03-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/-sh4usydx3s" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys Chris love the owner of love to
dev and I am going over the Philly at
progressive web app whereas the Philly
code can't progressive web app that's
just got all the scheduled to close the
session schedules here and I just wanted
to go over in this video how the search
and faceted filtering works now I'm on
the home page here as you can see I've
got lots of sessions the dank em but I
don't want to have to deal with all of
these one of them probably reasons why I
decided to make this Apple in the first
time I don't have to go through all this
not out you do - you're looking for
certain things so I'm looking for a
juror I'm type a juror and these are all
sessions that either have is your in the
title or the description now I do think
I need to put the session speaker
presenter in that search as well and so
I'll probably do that later today I am
it so right now it's triggered based on
once you get past four characters and I
realize that I missed last night I need
to add so you can hit the inner key so I
will also do that today as well now
let's just uh let's go back
doo-doo-doo-doo it's not gonna yeah it
doesn't really update based on that
anyway all right someone's gonna reload
and I wanted to show you to hit that it
real time filters out and that so what I
wanted to do is just see if I can
explain the code to talk about how that
piece works okay
oh yeah see they were getting prompted
to add it because it's a progressive
lookup and should all right there we go
there we go got the little thing to
verify so I headed to my desktop now you
got to see that little bonus coverage
there all right now this is the home
page now this is the cool thing about
this feature the way I designed it if
you're on a session detail page and you
go to search it's just going to do it
right then and there it's going to
replace that session detail and I may be
it may wind up being a little confusing
but if you're in a progressive web app
if you've got a full screen
you'll never go to the URL anyways I
didn't really matter to you so it
doesn't it's not that big a deal so but
what we want to do is I want to go down
here just show you the JavaScript
references because that'll make a little
difference there
there is a sessions script and then the
overall app script you know sessions I
tried to make this the one responsible
for dealing with the data and the app
more for UI I got a feeling there's a
little bit of bleed over between the two
of them at least from the app side maybe
doing a little too much data but that's
okay we'll deal with that now what I'm
gonna do is almost go like to collapse
my code and let's even take that out of
the equation and what I do is I'm using
immediately executing method to abstract
or keep this out of the global scope and
then I'm just calling this initialize
app this is kind of my simple way to do
a bootstrapping process now I've got the
filtered sessions as an initialized
array and then the actual session card
template which I'm going to show you
real quick how I go and load those this
initialized faceted search though is a
little bit involved we hit f12 takes me
to the method there we go
and what I'm doing is I'm looking for
those check boxes and those actually are
labels if we go over here to the index
file and let's minimize exit makes
things easier to find if you don't know
about that and Visual Studio code that's
ctrl K and open parenthesis which
totally makes sense right guys I wish
they would have mapped the visual studio
ones over but that's okay I've already
forgotten how to use the visual studio
ones I think it's controlling zero
alright and this is how that's organized
there is an actual check box but the way
the CSS works is it shoots that off way
off to the side so it's not visible and
it kind of works in the background the
way the CSS is set up is how it drives
the actual check that's happening here
on the label itself and if you notice if
you're just look
the JavaScript I'm looking for elements
that have this class applied and that is
what we're doing right here I'm getting
all of them so this creates a node array
now it's not gonna let me do for each
here that's okay because this is
something that's running in the browser
and I can't guarantee the browser
supports some of the newer syntaxes I'll
just go ahead and use bar instead of a
constant let if you noticed in the node
script I use Const and let and I do have
a video and I think I've got a video and
a blog post on what the differences are
between consulate and var definitely
encourage you to go read those if you
haven't looked into it and it'll help
explain and clear the fog for you but
anyway so because this is in a browser I
use bar and I'm just gonna loop over
this you can't do for each on a node
list because it's not supported it's not
an actual array it's I don't get into it
but it's it's it's an iterator I think
or something but anyway so this is a
list of those checkboxes and then I'm
just going to pass that into this method
down here to actually do the individual
binding and as you can see all I'm doing
is binding a click event handler
I used to do go through all the mess
with the touch I actually wrote the
deep-tissue library but honestly the
browser's got really good with the click
events being fast so most the time it's
not even needed so that's why I just do
click events now and that will handle
the touch force as well now here I'm
getting the the I'm getting the
attribute value for if we go back over
here that's going to give me this value
and if you notice it automatically
highlighted the checkbox here for that
which means I can also getting the value
which is the time and that way it gives
me something to manipulate this will
actually select the checkbox okay and
that's this is important because we have
to manually toggle that because the
checkbox is way off the screen and the
action is not happening on the checkbox
but we need to toggle the checkboxes
check to actually drop the CSS which
we'll look at here in a moment anyway so
basically if it's not checked I set it
to or if it is checked I set it to false
and I'm calling them to the session data
module and telling it to remove the
session time and then it's going to
render out the full schedule which is
going to go through a little bit of
logic which is why when soon as you
check that yeah and you uncheck the 8:30
let's say the 8:30 sessions get removed
because this rear Enders the whole thing
and it's all super fast it's like
lightning fast to to do that run it
through the mustache library and it just
does it for us it's fantastic and of
course here's the opposite instead of
removing I'm calling add again call the
same render full schedule and I believe
if I hit f12 it'll take me to that
method and we can see that's going to go
to again to the session thing get me the
fastest what I called it the faceted
sessions which are going to be filtered
by the times that we've actually got
active and then we called it render home
even though I probably should just call
it render sessions because originally
was just for the home page but it works
on every page and honestly I had some
more logic I was gonna put in there so I
think I just found a way to refactor yay
let's code big win all right so here
this is the the container that will hold
all of the cards that are the actual
things now notice I'm doing mustache
with a capital M if you recall from the
build script video it was a lowercase M
because that's what I named the mustache
reference there but because I'm not
actually having to name it it's just a
static object the library actually uses
mustache with a capital M and so that's
why that's different here is our card
template which we retrieve in the
initialization via Ajax and here are the
actual results notice I'm I'm setting
those two sessions and that's because
believe over here I'm using the mustache
to loop syntax here and to do that I
needed to do such a vit an actual name
I think there's a way to do that flatout
with any array but it's I've never quite
figured that out so I always just name
the object array so that it loops
through those and that's what's going on
here
and so the all I'm doing is the HTML
it's rendered the other mustache is just
using the innerhtml method which is
lightning fast and no muss no fuss and
it's done and that's in essence how the
fastest search works from a UI
perspective and just to go back over
here to go over her little thing this is
going to initialize this as the search
functionality and notice right now I'm
looking for anything as long as bunch of
over three value characters then it's
going to do that I also need to check
the key code here if it's in or to call
this at that point as well and I will
add that here sometime after I post this
video essentially it's calling the same
basic thing too it's rendering the
search results which really is the the
exact same process it's no big deal to
go through that now if we go back up to
our initialization process here I'm
getting the actual data source of the
guy of all these sessions and Here I am
loading the the mustache template via
Ajax
which now is actually fetch I mean it's
just a super simple touch call to it
it's bringing back HTML so you use the
response text to extract that out of the
body and here I'll just set it to our
session card template variable which is
defined I know I'm moving fast here guys
which is defined up here and that's all
there is to that then the next step in
this stack is to initialize the menu I
won't go over that that's well maybe oh
let's just do that because this is
simple instead of like a big complicated
I don't know why all these all these UI
libraries have these really super
Plex things all you're doing is just
adding and removing a class that's all
it is to it so here I'm doing the event
binding to the actual menu item menu
thing
now this isn't here on this one if we
got to go it's only visible if you've
got a small screen so here we go all it
is is binding the event handler here on
the little hamburger and that makes it
move in and out why I see literally
hundreds of lines of code to do this I
have no clue but I match it up with the
bootstrap responsive breakpoint and when
that hamburger thing is shown are not
shown and that's what's going on here
and all we're doing is just toggling
that class list on the document body and
that will cascade through the CSS all
right so that's just a real quick
run-through of the UI side of it let's
go look real quick and some of this cuz
I don't want to spend a lot of time on
this but I am persistent stuff like this
session times in in indexdb and I will
be putting the custom schedule builder
there when you want to like add your
sessions I've got to add that
functionality it may not be today maybe
tomorrow but it'll certainly be there by
Saturday and that's going to go in index
DB and that's going to be so I've got
different keys for those objects and
I've got the default times for all the
sessions here now if this was you know
more complex application I wouldn't
definitely wouldn't hard code this and
there would be some sort of data source
kind of thing whatever but because it
was just a fixed thing I don't want to
over complicate it and it was easy
enough just to make a local array and
hard-coded here we're getting the actual
scheduled data again just calling that
single file getting a JSON setting it to
the camp schedule up here and that's
just a fetch call if you aren't familiar
with fetch I've got a lot of lessons on
that in my progressive web app course
and if you're still using xml
httprequest you need to stop because
that will be deprecated in a few years
and thatch is so much cleaner and nicer
you
definitely want to upgrade and change if
you're using libraries or dependencies
that you do use the old way of doing it
you need to possibly look at replacing
those sooner rather than later because
you can't necessarily rely on them
upgrading for you so okay and if I
wanted to get an individual session what
I'm not doing so I'll probably wipe this
method out that's doing the same thing
to get the individual session file this
is what I already put in place to allow
us to save and get the actual saved
sessions like I said our indexdb I just
have not wired those up to the UI yet
shouldn't take very long to do but I do
have the infrastructure for that it
looks like now I'm using local Forge to
manage my interactions with indexdb you
can look that up it's on github there
also have a really good page that's got
some great documentation which is why I
actually chose local Forge over a few
other options the other thing is it has
methods that make it look like local
storage the local storage API which I've
used quite a bit over the years but
because service workers cannot access
local storage they need the asynchronous
nature of the index DB has I've switched
over to index DB plus you get more
storage and indexed DB not that I ever
really needed it but it's just nice to
know you have that and here I'm getting
the selected times again out of local
storage these are basically just get and
set add obviously kind of things and
remove I'm not the cleanest I'm having
some sort I'm sure there's some proper
way to do the naming conventions on that
but I suck at that kind of stuff so
anyway so here's how we update it here's
how we get the session times this will
go through get the faceted session so
what it does is gets the x and then i'm
running a quick filter over the array of
all the sessions and that will return an
array that just includes sessions in the
selected times based on the fasted
search and that's it that's all there is
to the data management of this like I
said I think I found this method we
wound up never using
we'll probably wipe that out but pretty
pretty slight lean and mean both the
files combined are less than 500 lines
of code and so that's all there is to it
basically guys hopefully this is helpful
I know it's a quick run-through of how
the code that JavaScript side of the
code actually works and I hope this is
good for you if you get any questions
feel free to leave those in the comments
below hit me up on twitter at chris love
and if you're in if you need to learn
about doing like a lot of details on
progressive web apps i've got a really
big course on that if you hit pw a
course comm you can sign up for that for
just $29 which is 871 dollars off the
regular list price and right now as I'm
recording this there's over 21 hours of
video instruction on there and I'm going
to be adding a lot more and if you're
going to the code camp this weekend I've
got a session on Saturday where I'm
gonna be going through actually walking
through this particular application and
doing it real time with you so thanks a
lot guys I appreciate it</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>