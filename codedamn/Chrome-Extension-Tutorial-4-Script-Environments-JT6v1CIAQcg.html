<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Chrome Extension Tutorial 4: Script Environments | Coder Coacher - Coaching Coders</title><meta content="Chrome Extension Tutorial 4: Script Environments - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/codedamn/">codedamn</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Chrome Extension Tutorial 4: Script Environments</b></h2><h5 class="post__date">2017-06-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/JT6v1CIAQcg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so what is going on YouTube my name is
Mei hole and welcome to your fourth
Chrome extension development tutorial in
which you're going to take a look at
some script execution environment as I
say in Google Chrome extensions and what
does that actually means is that with
the JavaScript the native JavaScript we
have in web pages it's very much like
you have your JavaScript you have access
to all the Dom and all that's API and
that's it pretty much so yeah but in
Chrome extensions what we have is there
are different execution environments
where some of your JavaScript will work
in one environment and some would work
in another environment so for example if
you want to communicate to a native
application on desktop right like if you
want to execute a Java file or a general
method from a Chrome extension you would
like to have that in your script
execution environment which is kind of
protected from the user interference
like you do not want the user to
maliciously pass any argument to your
java class or whatever that means
so there are different kind of
environments where your JavaScript would
execute in a Chrome extension and let's
just take a look at that so if we go to
I guess I close that there we have this
manifest.json documentation you would
see something known as this background
script I want this back on script is
pretty much is that it has access to all
the api's of Chrome right so what that
means is that chrome provides some aps
starting with chrome dot star whatever
it is and these API is are kind of
exclusive to Chrome extensions only you
cannot run these api's inside browser
obviously obviously because they are not
chrome extensions so we can do is we can
actually add some scripts in here and
that those would execute in the order so
you can also go to this background
and you would see pretty much something
like this would say diagram scripts and
background arches and you can add
multiple scripts because you see that
this array so let's say we add
background digest
only how we can create background or
chairs right here and say I guess we are
in the wrong directory let's just create
a new file right here valium that yes it
is and I guess it's a lot of foolish for
running simple extension well we can
just get rid of that later on so what
I'm going to do is right here I'm going
to say console does log hello world
right and we can actually just console
dot log the document that location as
well so that we can see what's happening
so right if I go into extension and
reload you would immediately notice that
we get something like inspect your
background page now what happens is that
background scripts are completely
isolated from all the other scripts in
your extension background script doesn't
clear what content script is doing or
what your pop-up is doing they have
their own kind of environment you can
see so if we take a look you would see
that you get hello world and this ugly
butt which is completely isolated from
HTTP and all that world right so yes now
one thing to note is that we have added
this persistence false right here so
what does that actually mean
well actually what makes is that if your
background script is not really doing
anything then Chrome will actually just
make it rest like it would just free up
resources being used by your script so
you could kind of omit that doesn't
matter but if you set persistence false
what this means is that you are
essentially making it an event page as
the chrome documentation phase which
means that your timers would be kind of
thrown away if you are running like set
in the world
your background script or you are doing
any I don't knows some science some sort
of asynchronous operation in your script
and in the meantime Chrome extension
sees that oh this script is per system
let's just take it off so it'll just go
away so you can just pretty much omit
this it doesn't really matter on modern
devices a lot because Chrome anyhow eats
up a lot of RAM so yeah it doesn't
matter if your extension takes up 2 mb/s
or 3 MB small ramp so you can just omit
that it's up to you so once you do that
again you can take a look and reload it
and right now as you can see you get
this background page inactive but you
reload it you won't get background page
inactive with it because now your script
is always running in the background
regardless of it needs it the extension
requested or not right so this brings us
to content scripts and Chrome extension
and what these are is pretty much they
run on the page and these would be the
mostly the scripts will be mostly
interested in too so content scripts if
we take a look right here so if you take
a look it's tasers that in many first
searches on file we have to do something
like this what essentially they are is
that they actually run in the context of
this page so that you can actually
access some of the data are not really
all of the data of the page and you can
like show a toolbar or create any sort
of change to the page if you want to so
if you had a content script right here
you see that it is an array which is an
array of objects and it gets the matches
and CSS and shears and all that stuff so
we're going to omit the CSS and for the
GS we're going to remove this jQuery
part and what I'm going to do
I'm gonna make this wild card something
like this so it's kind of a very kind of
open sort of wild card which will match
all the HTTP and the HTTPS as well and
it runs my Square Dodgers so let's just
create one my scripted chairs and let's
just say we are developing a time
application where we will just want to
replace every link or you know any
product with our athlete link or
whatever even stuff you can think of and
we can do that with this my script so
I'm not going to go into that but what
we can do essentially is for now we're
going to stay console.log
document.location.href and we can say
something like sending user history to
database something like that so that we
can act a bit evil and then we can do
this instead so now if we take a look
reload our application go to any page
inspect element and if we reload this
you would see that we get sending user
history to database and this thing and
again in the view you can also see that
our I don't know what this is but hello
world I guess so yeah hello world
so inside hello world context we have
access to this document so right now if
you're not familiar with this what I did
with this is I changed my console
context to hello world context so as if
we are writing script right here inside
this file only
so if I write document here you would
see that we have very much access to the
same document right here which we have
so we can access like document
like that so we have access to the same
body which the user right now is staying
with in art or rather ideas we are in
the wrong file right so yeah same we
have access again access to the same
body which the user is seeing right now
but the difference is if I right window
well window is technically not same
because let's see if I go to top which
is my main page and I define like wore
my awesome value is for whatever that
means is 10 and I switch back to hello
world and I try to write this I get it's
not defined and if I try to write this
we get undefined because we do not have
access to the window object right here
this window object is different for
content scripts then from the scripts
which are running on the main page so
you cannot really access the data
defined by the JavaScript inside the
main page from content scripts within
you have to execute the script directly
into the page itself to get access to
that well really get to that later and
that is really much really our third
category which is the injected scripts
which can be inserted using content
scripts into the main scripts where you
want if you want to access some data
like associated with window global and
then again you can just create some
pop-up dodgy script as well well that's
kind of a different environment only
where you can just write script SRC
pop-up dirtiest and we can create a
pop-up like this file here and we can
stay like alert document that location
of that risk which would be a weird URL
for you right here you can see that we
get this real little URL so yeah that's
pretty much it on the scoping or not
really scoping but kind of execution
environment for Chrome extensions
and that's all for this one and if you
liked it then please don't forget to
subscribe and thank you for watching
I'll see you then in the next one</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>