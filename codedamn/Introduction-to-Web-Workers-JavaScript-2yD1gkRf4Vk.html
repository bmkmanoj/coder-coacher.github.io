<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Introduction to Web Workers | JavaScript | Coder Coacher - Coaching Coders</title><meta content="Introduction to Web Workers | JavaScript - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/codedamn/">codedamn</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Introduction to Web Workers | JavaScript</b></h2><h5 class="post__date">2018-01-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2yD1gkRf4Vk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so what is going on everybody my name is
Manuel and welcome do the toriel for the
workers in es 2017 and we actually call
it es 8 as well indirectly but one of
the coolest things yes it brings to us
is web workers and it is pretty much
implemented in all major browsers all
major browser vendors and you can use
them right now so web workers actually
provide you to create a multi-threaded
like environment in JavaScript and not
actually like but it is a multi-threaded
environment and by that what I mean
I suppose that let's just say there are
some boxes here right and you are a
person this is you right so you have to
transfer all these boxes from here -
let's just say here like that so you
have to do that this task all along now
what if I give this task to one another
person with you so this guy is now
helping you now obviously there would be
a performance gain right not really well
there are a lot of conditions in
parallel programming which if you do not
set it up correctly
we're actually cause you performance hit
instead of a performance boost so we
will come back to that later on but for
now let's just assume that our intuition
is correct and this guy which we have
added would actually help you in your
process so you can see that it dutifully
it seems like the second person is going
to help you by speeding up the tasks he
can carry these two you can carry these
two and you will be done in half the
time
so that's essentially what web workers
will be used for dividing tasks among
multiple web workers each web worker
being run on a separate thread and they
can just pretty much communicate with a
script which call them and so on and so
forth so enough of talking let's get
started so here is our script GS file
and to create a web worker what we need
to do is so let's just give it a worker
name and we have to say new worker now
this would expect us to write a filename
which is work on our chairs in our case
because I am working in the same
directory right so work on our GS would
be the file which we are going to in
which we are going to write our worker
code so once you have done that what
happens is the browser behind the scenes
would perform an HTTP request to the
script file it will download it it will
start compiling it and pretty much
browser will started as a different
JavaScript file on a different thread
other than main thread right so inside
worker what we have is we can attach to
an event which is message and we can say
and we can pretty much just say that
main script sent and then data right and
right here as well we can say our event
listener message data and then we can
say worker sent data right so we are
listening for messages on each other but
how do we actually communicate from this
script to the worker well to do that
what we have to do is just say worker
dot post message
and our message goes here so I can say
hello there and save it so what happens
right here is first of all we define the
worker then we are adding an event
listener to it it doesn't matter the
order can be flipped it won't matter
actually so you can attach an event
listener later on as well and you can
attach it's something like on message as
well if you want function but I just
prefer this adamite listener approach it
kind of makes it look professional
I don't know so yeah we attach the even
listening to this worker we listen for
the message we get the data we
console.log it right seems fairly easy
to understand then we post a message to
the worker so we can just say hello
there from main script right and inside
worker we can actually say a post
message back so whatever you write in
here you can actually write it like self
as well self dot add event listener self
dot post message so self is the kind of
window here windows not available in
workers because Dom access is not
available in workers
now the reason Dahl access is not
available in the web workers is because
Dom API is not thread safe so you are
very very likely to run into race
conditions if you try to manipulate Dom
given that Dom had given access to
workers to be able to get manipulated
from them directly but that's not the
case so we do not need to discuss that
so in one-liner Dom cannot be modified
from workers directly so if you want to
modify a I don't know some element on
the screen you have to post a message
from worker to the main script the
calling script and the callings
which is running on the UI thread the
main thread is has only the power to
modify the UI or the Dom or whatever so
we can dispose the message back hi there
from a nice worker and that is it so
let's just see what we have in here so I
have a local server running which is how
the root in the same directory so you
can see that when we reload this we got
something like main scripts and then a
message event now the message even
consists of this whole big thing but
what we are interested in is in the data
which is the data being sent so it is an
object so you can attach objects to it
you are not confined on sending just the
strings you can attach objects right so
here we have the data as hello there
from the main script so main scripts
sent we call we got a call from this one
right so we got the main script first
sent the hello there from main script to
the worker so we are we have a loader
from main script and then worker sent is
hi there from a nice worker
pretty good right all right now this is
okay but what is the actual use of this
so let's just quickly take a look at how
we can use this so let's just say I want
to actually let's just leave it like
that only for whatever reasons ten
thousand hundred thousand million ten
million hundred million billion right so
let's just make it two billion for
whatever reasons I just want to count up
to two billion and I just want to say
count plus plus there's my variable
let's count to zero and then I'm gonna
alert something on UI thread right if
you take a look in the browser you can
see we are hanging we are hanging
because the UI thread is busy it's
counting you can see that we actually
got hanged and we can actually just
calculate it as well so you can just
console.log this thing that time taken
is performance which is just an API to
get the millisecond time more precisely
up to 20 nanoseconds I guess because it
was increased from 5 to 20 after the
Spector and meltdown attack so you can
see that it took us around 7 seconds to
do this calculation and block the UI
thread now the obvious thing here to do
is move this thing on a worker thread so
what we can do is actually just say here
I just want to say worker dot post
message and I want to say type command
and then I'm gonna say I don't know let
us say action count to 2 billion why not
and there we are so we can say that if
data I'll actually since we are only
interested in data so we can use the
destructuring es6 thing to get the data
directly dot listen now this is the
thing we are receiving from the worker
so we're gonna define that later data
dot action is
count to two billion then I'm
console.log we are done right
without locking the UI thread and inside
the worker what we can see is first of
all let's get rid of the self and we can
say similar thing here and right here we
can say if data dot action is equal to
count to two billion and make sure that
is correct
count to two billion yep so when I run
this loop here Alice wanna post a
message that done not really done but
action count to two million status done
okay so let's let's take a look in the
browser now and see how this looks like
so you can see that UI thread was not
blocked and count is actually not
defined here so let's just define this
thing real quick and we can just omit
some semi collister we don't need those
let's just reload something on UI thread
and you can see that the USA is not
blocked meanwhile worker was performing
its task in the background so it is kind
of like if you're developing a game it's
just got a CPU intensive task you need
to perform a bunch of request request to
the server or whatever you need to get
some graphics you need to perform some
CPU intensive work some calculation or
whatever so you move that thing off load
to a worker worker works on it on a
separate thread main UI thread is not
blocked worker is a long living
connection it is different from
asynchronous
in the sense that you can see it's
pretty much a file itself asynchronous
functions are just functions async/await
is good but again workers where they are
required cannot be a replacement right
so that is pretty much a very basic
introduction to web workers and in the
following tutorials we're gonna take a
look at how to make use of share data
buffers to actually see the real magic
of paddle processing the data and
computing things so that is all for this
one and if you liked it then please
don't forget to subscribe and thank you
for watching I'll see you then in the
next video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>