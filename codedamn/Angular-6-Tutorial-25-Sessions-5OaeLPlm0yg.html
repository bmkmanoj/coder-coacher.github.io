<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Angular 6 Tutorial 25: Sessions | Coder Coacher - Coaching Coders</title><meta content="Angular 6 Tutorial 25: Sessions - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/codedamn/">codedamn</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Angular 6 Tutorial 25: Sessions</b></h2><h5 class="post__date">2018-03-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/5OaeLPlm0yg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so what's gone on YouTube my name is
Miro and welcome to your 25th angular 6
tutorial in which you're gonna take a
look at how to implement sessions in
node and basically implement sessions in
such a way that the user can reload or
navigate away from your page and still
be logged in in your angular application
so let's get started
ok so let's just first of all install
Express session module and we should be
able to do that by going to still intro
yep and or actually we just need to be
in server only I'm gonna do NPM install
Express session save this will give us
access to Express sessions which would
allow us to create and send cookies to
the client and once we had done that
what I want to do next is go into my
sublime text which has the server opened
and right here what we're gonna do is
just say equals to session session is
require Express session module and then
we just need to initialize it with what
we want to use app dot use session and
then secret which is secret use to sign
the keys sign the cookie this could be
any random garbage and you can provide a
lot of other options as well
one of it is save on initial and I NIT
JLI CTD save vanish uninitialized which
means that the cookie would not be
created for someone who's not
authenticated right and then you can
also have resale as false which just
says that do not force receiving the
cookie over
your back-end when no change is made so
with that being done we are ready to use
Express sessions so right here
when we do API login when we have
success true I'm gonna say a response
quest dot session dot let's just say
user I said this user to the email
address which the user has passed and we
have login UN as the thing right and
once you have done that what we can do
is actually create another thing here a
blog post or rather just a dot get let's
just say data and we're gonna say with
quest responses here now here I'm just
gonna say console.log user is then I'm
just gonna say request a session dot
user so as to just check what we have or
rather instead of console just send this
thing to response right now we can just
concatenate that as well all right makes
sense let's just quickly test this out
and we can I should test this out if we
have the server running we can just say
NPM start here now you can see we are
using a proxy file to proxy the
connections and actually we just need to
start the server as well and there we
are so let it just build
all right once that's done let's reload
and let's just try to login username
Mabel one add 30 in glad the read one
comm password was one two three four I
believe I'm not sure I remember that hit
summit looks like we has some errors yep
Mongo is down so let's just start Mongo
first and let's just try one more time
it's dumb it and what's up here let's
just try one more time
summit login request is still pending
for us okay the connection is not alive
yet for Mongo because we do not
reconnect on save uninitialized quite
safe on initialized option all right
whatever it's just a warning let's just
ignore that so you can see that we have
an error here
it's summit incorrect details was it 1 2
3 4 5
yep so I can see that when we post the
successful request we get a cookie of
what the hell request headers response
ok so in response we do not have any
cookie if we go to data here or actually
we just need to go to API slash data
because API or rather yeah actually if
we go to API slash data
then we should get that so now if we go
to API data user is undefined
okay well let me just post a fault here
all the cookies here real quick and then
go here login we will add the right one
calm one two three four five good summit
login gives us noches cookie we get that
here we are and then if I go to API
slash data we get user is still
undefined
okay all right if we try to console log
here request dot session let's just see
if we get
what if I said something like would
Chris Dodd session dot test equal to one
here and then if we reload this and
reload it again okay so you're not okay
so now adding with West dot session dot
safe allows us to actually save changes
to the session and what we have is that
we just need to put this requested
session but save after we have made this
change right and once we do that if you
go to the browser again now we clear the
cookies one more time go to login mingle
at the rate 1 dot call one two three
four five its summit we get our cookie
in the response now if we go to API
slash data we see that the user is us
only alright
so good so far so far so good and now
what you want to do when the sessions
are us with us we just need to modify
this author paddle so I'm gonna say if
this not orders is logged in true then
we're returning true this logged in
let's just see what this method is you
should EB don't get API slash is logged
in so let's just implement this real
quick so what I'm gonna do is go to my
sublime here and create on the route
which just says AB dot post is logged in
API is logged in and then request
response I'm just gonna say what does it
expect me to send status right so I'm
just gonna say here too
Spahn store JSON status is equal to
request dot session not email actually
exists right so that is how we're gonna
check it so once that is done or this
part is solved the get path then what we
have is our earth guard this logged in
then we're gonna get this if response
what said is true so that logged in it's
true return true else now we get to
login return false perfect all right so
now if we go to our what we have our
module app module file here we can see
our admin had this can activate route
you just move this because we're not
using admin component anymore right I
will just copy the admin CSS as well to
our dashboard CSS there we are and now
inside our providers we have auth God
and for the dashboard thing I can also
add can activate God which is just for
the car for - put yep that makes sense
for now
all right so finally if we take a look
at the app what we have is that you just
need to create another route which is
API data which returns us some
information regarding the user so I'm
just gonna say email is email is request
dot session not email and then my code
which is originally we stored that would
be my code right let's just make this
boy async and we're gonna get the code
by a weight user dot fine one email is
requested session not email and let's
just make it user first so that we can
just check if not user then Wes response
dot JSON status let's just make state is
true here status false message the user
was deleted or something like that
turn otherwise what I want to do is code
would be user dot code right if you take
a look in our models we should be able
to see that are kotas store like that
all right with that being done inside a
dashboard component what I want to do is
for loading for admin what we had was
that ng on in it got a some data so it's
that good - but again this dot user but
CAD data the SUBSCRIBE data this dot
message stated or message cool now what
I'm gonna do is from user user service
get data my data API data just like that
my data would be modified status email
and code for now right and then what I'm
gonna do is say this dot code is stated
or good then we're gonna say loading
your personal good something like that
and to also on the email data dot email
and I'm gonna say email is getting your
email something like this and we're
gonna first of all check that a data dot
status is true then only perform all of
these chicks otherwise I'm just gonna
say that you should be navigated to this
local fault else this not router but
navigate to log out and then just in
shape router here as well
there we are so what essentially we are
doing here is that let me just show you
let's just do everything from the start
through the cookies go to login naval
terrain one calm one two three four five
its summit we get we kept logging you
out
okay user was deleted now this is
because if user not find one requested
session dot email well
quest on session here if you check it
one more time
you
your cookies good summit we are actually
getting logged out oh this is actually
user I guess I write email there there
we are okay let's just try one more time
maybe we'll wait one.com 1 2 3 4 5 8
summit we get this logout button because
we are not displaying anything from our
dashboard component here so our message
is blank so I'm just gonna say coat here
and by email something like that laughs
we reload this thing go to dashboard ok
cannot get API 404 not found well if we
take a look inside our routes cannot get
get API right so if we go to dashboard
now we will add the raid 1 comm 1 2 3 4
5 its summit you have no code by we do
not get your email address because this
is user not email right and also inside
inside logged in this should be user ok
lots of errors there so now if we do one
more one last try on our final
application its summit you have no code
by maybe ladder it 1.com I can reload
this thing
I still get the same thing now say open
Robo Treaty and we go to angular DB
collections users and our user is this
one edit the document we change the port
right okay
something like success only comes to
those who don't it it's safe to go to a
dashboard hit reload and this is
probably because of caching let's just
reload alright our do we have multiple
users here yep so we had multiple users
here which should not be allowed
obviously but we're just gonna take a
look at the validation later on yeah now
this happens because the first user
which was associated with that cookie
was deleted right so we need to perform
the login your game so if I log in here
may hold add the red one calm one two
three four five okay so take a look make
whole H add the right one but calm okay
so we actually deleted the wrong user
so anyways summit so we get success only
comes to those who don't wait by this
guy right and if you take a look at the
log of that what we are doing for logout
is that we are case the user is involved
logout gets us API slash logout
then subscribing to data if dated of
success is true what should it return
success boolean right so now we do
something like and this is a get request
yep
so AB dot kit logout API slash logout
request response now we can just pretty
much say request dot session we can
actually destroy the session as well but
I'm just gonna do something like that
because this is easy on the eyes right
now you cannot actually destroy the
session as well using request session
destroy' and that is it you're gonna
send spawns tour JSON success is true
now we should be good to go
now how logout you see we get logging
you out but we get a internal error
request dot session but safe and once we
do that we log out successfully log in
Mayville edge at a red one comm one two
three four five summit logout register
one two one two one adder eight
gmail.com
one two one two one one two one two one
its summit we get redirected to login
summit we get you have no code by one
two one two one other HTML calm and you
can see that after we register sister
looks fine and we can actually just
destroy the session here anyway yeah
Burkhardt unit
or you can just do something like this
Troy
right so now if we take a final look at
the application we can log in or we can
just go back and register first let's
just say mail MTT one two three four
five one two three four five sumit
signup was successful summit you have no
good by me hole MPT log out if I try to
Lister with the same username its summit
ok you can see that we get the response
like this but we cannot we are not
showing it here so if I change this to
me will MPT 2 1 2 1 2 with summit we are
good one to its summit we logged in we
log out and this is how pretty much
everything is working we can not just go
to dashboard directly it does not really
work so that is how pretty much we would
create a very basic gist raishin
application and what we are left with is
just the validation part so yeah and one
more thing that how we can allow user to
edit the code the user has we are left
with that as well so we're gonna take a
look at board of that both of those
parts in the next video which would be
the final video for this mini series and
that's all for this one and if you liked
it then don't forget to subscribe i'm
thank you for watching and i'll see you
then in the next video and one more
thing if you like this video then don't
forget to subscribe and press the bell
icon to receive instant notifications</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>