<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>A Platform for Studying Language Features in Java | Coder Coacher - Coaching Coders</title><meta content="A Platform for Studying Language Features in Java - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Learning-Library/">Oracle Learning Library</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>A Platform for Studying Language Features in Java</b></h2><h5 class="post__date">2013-02-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/xt0tO5n8-qw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi everyone and I'm not rolled my name
is Joel and I was rose Oracle one of our
old Oracle Oracle mentors when it did
this internship at us this summer so I'm
here to talk about roles platform for
studying language features in Java and
I'll start with a couple of disclaimers
I might be saying we a lot but I should
claim very little credit so when I say
we I mean row mostly and I had one more
disclaimer I can't remember it so yeah
here's the big Oracle disclaimer don't
trust this for making money basically so
role is doing his is doing a PhD at
Cambridge and my name is joe i work in
the line tooth group at oracle currently
i'm doing work on annotations and
reflection and also helping role was
Alex Buckley who's also in the line
tools group and is to speculate for java
role did an internship at us this summer
designing this project so the questions
he wanted to be able to ask and answer
was how do people use java features and
as a language designer language
developer how could we how can we take
that information and help making the
language evolved and it makes sense that
it did is it for us it makes sense to
getting help from him answering those
questions or from anyone from the land
whose perspective where i work this is
these are sort of very relevant
questions because we are in the business
of evolving java so it was fun having
him over
so today there are a couple of ways to
get this feedback you can go to
conferences or user groups for example
talking to people I suppose you can do a
data mining on Stack Overflow see what
people ask what are the problems how do
they solve them you can follow the
mailing lists and the way Raul explored
or we explore this see what's called
corpus analysis so Rose definition of
corpus analysis is apply program
analysis on a representative set of
software mine it about mine insights
from it about features and hopefully
test impact of a new change I see it
like collect lots of software analyze
them and then profit that's my idea and
this is useful we claim and it has been
used for example in ATK 7 when when we
did or when yo yo da SE did project coin
we changed we started using type
inference in the diamond operator and
that had a couple of conan cases and we
modified or they modified the oversea in
order to try this out and on a number of
programs and see how often you would hit
the corner cases also there was the more
precisely through analysis that they did
in in order to figure out if we would
break programs with them sourcing
compatible change and for java 8 we are
considering a more aggressive type
inference and that as well we can
examine and if this will lead to
problems using corpus analysis
and also one of I think this is I think
your old it'd work on this specifically
to it identify if there are unused or
very likely used features that we can
possibly deprecated that would be very
helpful having a corpus to do that
analysis for us and in general to be
able to gather insights about about
programs out there it is hard as a
language designer and the language of
over two to know how people use our
programs and the better we we know that
the better we can make decisions for for
evolving the language basically and here
a couple of recent papers i think that
have used corpus analysis in order to
and to study languages
so for example overloaded methods Jessie
at all I'm not in the research business
I I don't know them but they they did an
analysis of a lot of code and on their
sample they concluded that about
twenty-five percent of overloaded method
calls and in constructors was there to
implement default arguments that is a
pretty strong strong case to to perhaps
change the language to introduce default
arguments another example and I think
this is pretty famous here's the more
precisely throw in Java 6 this was legal
java source in the other seven it turned
out that the first line that says
sourcing compatibly incompatibility one
there before you would throw an
exception of type foo in this case you
knew that you would show throw an
exception in seven you know yet that you
will throw an exception of of type
daughter of foo which means that the
catch part becomes unreachable code it
will never execute so in Java 6 this
would compile in the other seven this
won't so they did an analysis trying to
find out is this a real problem or is
this just a corner case that won't
happen basically
right so the problem with corpus
analysis are a few it is time consuming
it is it's kind of difficult to just to
gather as substantial amounts of
software and having it compile that
takes a lot of time and and then there
is the problem that you almost today you
have to be a compiler hacker in order to
do the analysis you have to be able to
modify one of the compilers out there in
order to write your plug-in that will
give you the data you need so it's time
consuming to too it's a time-consuming
business basically and also if you want
to do this on a large scale which from
our perspective in the line to scoop we
would love to do it it also requires a
lot of reporting infrastructure perhaps
you want to do this automatically when
you check in a new compiler you can see
that it handles the properties you're
interested in in the same way and that
sort of stuff and that requires
infrastructure
so his solution and the project he has
been working on and we have been working
on and it's a solution to a few of those
so the idea is that it should be should
be easy impossible to query this corpus
without hacking the compiler you should
get immediate feedback like you used to
today and it should be good looking and
it should be easy to analyze the data
and roll also wants to democratize this
facility to be able to let people do
this online and I think that's a good
idea I think you still have to you have
to have some prior knowledge in order to
make this useful but having this project
out there will enable people to start
trying this out and have them learn to
do this which will generate more
compiler hackers for us to hire
basically so and so we we set out or he
set up to to actually sort of do this
and try this so um I have a demo that
just like five minutes ago started
crashing so it isn't as pretty as it
should be but we can the demo shows you
how to query for use of wildcards
overloaded methods and covariant agree
assignments and and this is something
that that isn't that easy to do today so
I'll try to make this work
Oh
one of this one
so this is the covariant assignment the
corpus tool he has built and has a
two-part as it sort of two-part query
and I'll go into more detail about that
but on one hand you worry about the
structure of the source and on the other
hand you also worry about the semantics
of that structure so in this case the
query says find me a ray assignments
where and that's the structure and the
where the right-hand side is a subtype
of the left-hand side and that's the
covariant array and it turns out it's
not that common and in the projects we
have indexed I think there are this was
supposed to show me how many occurrences
to work but the demo devil ate it but
yeah so so at least we got the snippets
so this shows us examples of this in
this case the left hand side this
recovery of some sort and the other one
is blank record ray seems to work so
this is this is what he has been working
on and i'll see if i can get the
overloaded methods to show something
well it says that in the projects he has
index there are 3000 methods are loaded
and we were supposed to get a nice graph
of this saying that almost all of them
had the name of visit I guess it's the
visitor pattern oh well
so yeah and here's a backup slide of the
demo right there's the what's the thing
the method of loops yeah so all of those
are almost almost all of those are named
visit and so this is the yoga corpus
tool and we hope obviously to make it
less crashing and and better so these
tool consists of a back-end a database
where we store the the corpus report
generation that is obviously a little
bit broken and soon to come query
language that rule calls wiggle I
actually don't know where I got that
name from and the query language is the
part that is least finished her a bunch
of questions that that we sort of had to
where he had to answer along the way but
how expressive should acquire language p
what questions what type of queries are
you supposed to be able to do with it
and these are all as in wiggle not yet
sort of decided but he went went out
there and started investigating the
current quail languages and checking to
see would they support his use case so
we he got out there and found 77 query
languages that already exists to to
query java language features and he made
six use cases that are sort of typical
for for this and started to examine if
if the the languages would be able to to
expresses his use cases and the results
are mixed so the once we or he examined
where JTL BB q sali a query q l jackpot
p and the expo and here are some example
syntax of the respective language and
they're like it's a mixed bunch they
contain a lot of a lot of different
pairings for example jackpot is pattern
based and jquery is a logic-based so the
first use case he wanted to study was
fined overloaded methods with multiple
parameters the chair single type and
this this pattern is interesting because
this suggests that the the writer of the
of the code should perhaps use the verb
feature instead and also it it is
necessary to do this you know you need
to be able to to bind variables to the
types in the ED methods English
signature and refer back to them in the
semantic query the second use case was
fine generic constructors where the type
parameter to the constructor has a type
relation to the type parameter in the
class and this is a another corner case
of the diamond operator it can't handle
this the inference rules I think
currently break down so this is
forbidden in the other seven if I
understand it correctly and this also
involves pattern matching over types and
also or binding and and and
understanding the typing relations in
the language
and then there were three more former
use cases right the sort of the fake
mutable lexical by enclosure pattern
where you use an array with only one
element in order to be able to mutate
the your lexical bindings finding
capture conversion in the arms his I
think this is his favorite funding a use
cases of what no that's another
alright yeah finding car interior uses
and also the read-through of assignment
and the results were mixed soul nql they
could express all his use cases jackpot
can express 206 the United constructor
plus the wreath row and the rest of them
couldn't express a single one basically
because lack of variable binding and no
sort of good AST support knowing from to
limited information about types and no
filtering mechanism and for example so
was rather verbose the the this is the
final final array with one mutable array
element case so it's this based on the
Eclipse compiler compiler internals so
so as a query language it's perhaps a
little bit too verbose so his wiggle
quare language and has the idea that
that you should decouple the structure
from the structure query from the
semantical query so and I think almost
every question where we came up with you
had the ability to say I what I want to
match this kind of source construct and
I want to bind variables to different
elements in that source construct and
then I want to do a also semantic
filtering over those those variables
and this is working progress so here's
what he hopes that the covariant arrays
require we look like I've already
explained that and this is the method
declaration overloaded methods all right
so here he selects a method name a type
and a variable name from all method
declarations and on those tuples he does
the semantic query that the method is
overloaded and that the type in the
parameter list is string so this would
find all all over all the methods where
the type is of the parameter string and
there is a lot more to do basically so
one thing that we would like to be able
to do is suppose you're changing your
compiler a lot and you want to be able
to to run the old compiler and have it
executes or am say it makes a lot of
properties about the source code you
just compiled and then you change it you
want to do the same thing and and here
the the open question is will this
language the troll is designing will it
be at all useful for that kind of of
query and we don't know that yet
so that's the query language and the
model was there are a couple of of a
ways to represent the source code these
are all the query the query tools that
we that he investigated they had I think
examples from from all of this at least
XML and relational database way and they
all have pros and cons so in the end we
were sort of we consider doing the
relational database model and then we
would have to sort of hack our own
support for recursive queries and there
will be a lot of joints in that
relational database and it turned out
that if we choose a graph-based database
I mean an ast that is graph so you can
just take the same text three of the
source code throw it into the D graph
database and then you add a bunch of
relations like type information that's
just relation string has subtyping
relationship to object so you take your
abstract syntax tree your throat into
the database you you add type
information and you're basically done
with the model and you get draw graph
traversal for free which is very useful
and also you get transitive closure
operations which turns out to us be be
useful
so we we settled for neo4j which is open
source scalable has a Java API and it
has a quare language and currently the
demo and the only thing the demo is sort
of it's the real deal it uses the model
that that we intend to use and it has
the fronton that doesn't give you the
bar charts you want and what the query
language isn't done yet so we are using
the cypher query language instead and it
turns out to be well this is fairly
straightforward to do queries so here's
the architecture you have the corpus in
this case is three projects you index
them using a plug-in in Java Sea and
wealthy the idea here is that we write
to plug in one time and and then you can
just reuse it on and you don't need to
write your own plug-in we say we take
the syntax tree we throw it into new
year for j and we index eight and then
we can do queries on it basically here
is part of the compilation dasd for i
think it is doesn't say I think it is
string
so you have a compilation unit node it
has a lot of import statements and that
encloses clastic that has modifiers and
and in turn then you can get down to for
example and you declare methods and that
can enclose for example wild cards and
that encloses that has bounds for
example so this is the this is how the
data model look like and and two queries
you just need to follow these
relationships if you're interested in
find me in the classes well that's a
lexically in closing so query so you you
follow enclosing paths in this in this
graph and if you're interested in in
type queries well then you follow
another different relationship in the in
the graph so going forward and he wants
he plans to continue working this to
finish wiggle finish reporting features
we need to fix the performance currently
and it is quite it's quite fast to do
the querying name for JS is it since we
really fast and querying and we haven't
been able to index fast those three
projects that we use and they were
foreign thousand lines of code and it
took I think 30 hours sindh exam and
that's a bit
might not be that useful yet and we hope
to open source this lawyers haven't had
their final say yet and in that case
we'll make it a Java net project and
gladly accept outside contribution and
in order to improve this basically so
and that's was my last slide so any
questions
I'm Jeff for the example companies
they were let me see
poi
which I don't know what it is PMD which
is a query language in itself and then
hsqldb those who wanted to index we also
tried in this thing jealousy when we
when we develop this or when he
developed this and that was a bit too
too small but we that was really I think
we found like three cases of covariant
array assignment in yellow see it's that
wasn't that interesting but so those are
for code bases we've been working
yep
look into
so the question was we wrote a plug-in
for jealousy how do we do that and there
is not yet an API that we could just use
for that there is a listener mechanism
that you can plug into but what we had
to do was so we inserted a new
compilation stage basically so and and
but hopefully there is a plug-in API
coming that's that's a hopefully and
that would that you would be able to so
there you can say I want to listen to I
want to plug in at this stage of the
completion for example and and it turns
out that this is this is also necessary
for or might be necessary for other
projects for like for example the
checkered framework they also need to
plug into the compiler in order to run
the checkers so we might be able to
combine those ideas into two one plug-in
API
more questions
okay thanks for coming and oh no oh well
the demo devil I hope you find the hope
you can soon find a project of Java dot
net and start making your corp I start
making your queries
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>