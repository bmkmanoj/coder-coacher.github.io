<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>What's New in Grails 2.0? | Coder Coacher - Coaching Coders</title><meta content="What's New in Grails 2.0? - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Learning-Library/">Oracle Learning Library</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>What's New in Grails 2.0?</b></h2><h5 class="post__date">2013-01-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/rZPhqEG5Yr8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Graham Roche i'm the project
lead of the Grails primer cat and i work
at spring sauce which is part of vmware
i'm going to be doing a little talk on
the latest features of the in the two
point x line of releases of the Grails
framework before I got solid who who
who's already a grails user in here
where hey that's pretty good which are
one actually sometimes you just get
folks dropping out of curiosity and but
yeah that's that's awesome so um so
let's get started on the agenda today
I'm going to take you through what's new
and grails too so where else to was
released to towards the end of last year
and went to throw out the top 2012 we've
been iterating on 2.1 and we just
released Grails 2.2 rc1 release cabin at
once so we're just about to release 2.2
for those of you who are lucky enough to
be coming to spring 12 GX which is in
Washington in couple of weeks we will be
doing the 2.2 release there should be
exciting and at the end of the article
but about feature roadmap as well 2.3 so
let's get started so in grails to in
grails 1.3 point x we we really want to
look at the developer experience and
improve it in every possible way that we
could so one of those areas was the
actual command line interface to the
users so how users interact with the
system and to make that slicker and more
intuitive and more user friendly we cram
cram with a completely new console you I
and interactive mode so this is a
screenshot of what it looks like but
essentially I can drop into the command
line here and and show you you get a
nice tab completion of commands I can
for example created two main class book
run that it'll execute my command after
initially have income timing to compile
things but the population happens once
and that'll generate everything and then
for example you can run test app and
just run the unit tests there you go and
you can see that we have a single test
failure at the moment the test itself is
currently marked as to be implemented
hence why the tests are failing there's
also a nice shortcuts to get an open
command where you can simply open easily
open the test report in the browser
there it is and the UI in terms of the
test reports is going to be completely
updated and refreshed as well so it's a
better unit test template which I just
showed you there will give you thanks to
Groovies support for power assertions
will give you deep insight into exactly
that the values of the different
variables in your assertion failures
we've got a new documentation template
so a lot of folks don't actually know
the Grails is a documentation engine
built into it so you can type doc / in
it and that will essentially initialize
the documentation engine if we look at
my source docs directory now we've got a
couple of directories a talk dot llamo
and some documentation there if I just
run doc it will publish that out and
then we can open the documentation that
that I generated and of course you can
customize it this is just an example
this is the same documentation engine
that is that powers the actual Grails
documentation so it's familiar to the
users and there's example harder format
things how to create reference items
so if you look at this documentation and
then you look at the Grails door now I'm
user guide for example it's the same
template that you see in that was used
to create the pretty comprehensive
Grails user guide that's available to
your projects so that's the the
documentation engine none thing that
really looked at is error reporting so
in grails 1.3 we have an error page that
just kind of showed you the the
exception that happened but didn't
really give you got kind of any kind of
deep analysis of what was the cause and
so on in grails to we have a new new
error page which has a lot of our more
comprehensive display of what actually
went wrong so if you have an exception
for example that comes from a service
and it propagates up through the work to
the controller and then into the browser
will show you the error but will also
show you the snippet of code that caused
the error in the service and the snippet
of code code they called the service
from the controller in a kind of
recursive formats so you can get go
really deep into what actually caused
the problem and there's also a new stack
trace format which is a lot easier to
read and understand so error reporting
again a big focus of this release and
making it easier to understand errors
from the framework wow this room is
really fooling opening up as I'm talking
check that out very cool welcome to the
newcomers people have just arrived
another thing that's new is we move from
H sequel db2 h2 as the default in-memory
database and this is a nice added bonus
of the fact that there is now a embedded
database console that you can access via
the web via your web browser and you can
inspect your schemer and and run sequel
sequel queries against the data and it
doesn't just work with h2 it even works
with my sequel and other other databases
so it's a great way
if you just want to quickly inspect your
table and expect your data without
having to open up open up the tool for
your database you can do that with in
grails now so that's pretty handy of
course it's enabled in development time
only it would rather be rather risky if
this was enabled in production so pretty
handy that girls does that has that more
sensible default for you seven Grails 20
as well we have upgraded library so we
upgraded all the libraries in the
framework to the latest version tomcat
and spring and hibernate and so on and
in grails 2.2 rc1 which just came out
recently we've upgraded to groovy too so
it could be tues been out for a couple
months on and 2.2 will be the first
rails release to support for groovy too
so that's exciting for if you want to
check try out Grails 22.2 I see one and
groovy to support now is the moment so
another thing that we worked on and we
really wanted him improve was the
reloading engine inside Grail so the
previous one in when the one point X
releases was based on + loaders and that
has its problems so basically when you
in development time you want to see the
changes in your application immediately
yeah this is probably something rather
technical that us flip framework authors
have to deal with and you as the user
don't really want to think about but but
for us it's been a real challenge one of
the biggest challenges bit on the JVM
was making things available all the
changes you make to your application
available in the browser without
restarting the server it's a it's a lot
easier for interpreted languages like
PHP and Python awesome they don't have
to reload the whole byte code or
anything like that because it
interpreted line by line it's a lot
harder on the JVM so initially we had
this class load of a system where when
you made a change to a class we would
reload the class in it in a child class
loader and then you would see the new
class in the child falsehood this kind
of worked
uh in places so it worked for things
that didn't have anything relationships
to each other so it worked quite well
controllers when because they don't
really linked to each other but it
failed miserably with like for example
domain classes where you have a
relationship between say a book and an
author if you wrote it reloaded the book
then the author would still have a
reference to the old version and it just
yeah just got really ugly so we we tried
to come up with a better solution and
basically there's now a JVM agent that
is attached to your application when
run-up is executed and I will basically
it doesn't even think about groovy code
it just thinks looks at byte code and it
will reload it all changes to any by
code using it using an agent so that
means changes to the main classes types
services java code everything now we
loads in your browser application
without you here having to restart the
whole server which is pretty cool so you
can by default when you do Grails run-up
it's activated automatically for other
commands you need to add a hyphen
reloading flag and that will get it up
and running and of course it works in
interactive mode and integration with
integration tests as well so what else
we got in grails 2.0 we added support
for binary plugins so normal Grails
plugins are basically like zip files and
they have all the source sources I
inside the zip file and they're
distributed that way and we wanted to go
over that approach because we didn't
want to have to deal with binary and
compatibility issues and so on because
when you pre compiles groovy your source
code you have to make sure that you
complete when you compile it that it's
compiled with a certain burden Java or
certain written groovy and and that mean
and that means if we had chosen to go
for binary plugins from the beginning it
would be a lot more difficult to get
right depending which JVM were using an
English version of groovy we're using
you could get binary incompatibilities
so we decided to distribute them as as
source but there was still scope and the
demand for binary plugins so these are
plugins that are precompiled as java
files and you can deploy them to
standard maven repositories you can you
just declare them as jar dependencies
they're happy the specific uses like for
commercial plugins because they're
precompiled you don't have to ship
sources and no special ID integration is
needed because just put it on the
classpath and it's and basically it's
another option footage speeding your
plugins and also for maven users I guess
you know having them as jar files it may
be more more convenient and in 2.1 which
i'll discuss and shortly we have a lot
of new features for maven users ok let's
move on to the web page any questions so
far on any of that stuff yeah yes yeah
yeah yeah yes
yeah obviously you need to have this in
your in your data source config there's
a you can have it so that it's hibernate
there's like a crate drop or update
setting you need service set to update
so that it recreates so it modifies the
existing tables and what drops them and
obviously if you if you have that
disabled then it might not work and you
unless you run the and you're using the
database migration plugin for example
you might have to run migration manually
before that that's only if using the
database migration plumbing okay any
other questions before we continue
really ok so we in Grail to we we change
it so that controller actions are not
declared as methods and previously they
look like closure properties we went
this way so that things like a ope could
be applied more two controllers and also
the memory usage with is less because
controller properties each of them
creates a kind of a class no it's like
an anonymous class and it's more
expensive to instantiate so these it's
more efficient this way and the other
thing that we allowed is that basically
you can I declare parameters so in the
topic top example here I've gotta save
action I take the name in an age and you
can define a form with two input fields
and it will automatically bind those to
those form to form fields to the actions
and just based on the names of the
arguments to the action then
automatically do type conversion and so
on so the age property will become an
intern so on and so forth
yes come on objects as well come on Doug
objects work the same as they did before
so no no changes there so in grails too
we we we did the scaffolding to use more
html5 techniques in terms of CSS and
markup that gets generated so there's
some html5 validation happening in the
form fields and so on which modern
browsers will pick up and and deal with
such as Chrome and Safari and so on the
newer versions and yeah in general the
mark-up is cleaner and more more html5
compliant so to speak and then we have
some new API so so in previous versions
of Grails if you wanted to render a GSP
outside of a web request that was kind
of tricky it was kind of tricky tricky
to create the GSP they were there were
ways around it but it was very awkward
and so what we have now is a new page
render a p.i and this allows you to for
example if you have a background job and
that renders I that sends emails for
example you can have the be cotton the
contents of these emails sword in a GSP
and the background job can use the page
rendering API to render the pages and
send the emails without needing a web
request present which is always a
problem before and the same thing for
link generation so again generating
links was kind of dependent on a web
request now there's some configuration
properties that you can set to define
your server URL and you can generate
links inside a background job or or some
kind of asynchronous task or whatever
that that is not bound to your current
web request yeah
it's it's globe its global it's in
config block groovy but there are
parameters that you passed the link
method to override the global default
Grail students of the also the first
version of Grails to support to have
some base support for the server three a
sink ap is so tom cat 7 is the default
container which is a servlet 3 compliant
and we we've added some basic hooks into
the servlet 3 API so that you can do
things for example like startin start an
async request and then render a template
a synchronicity or you can basically and
and we deal with all the intricacies
because obviously the start action here
is executed on a separate thread we deal
with all the details of binding the the
hibernate session to the thread and
making sure you don't get lazy load
exceptions and so on so it all works
works nicely with a servlet 3 API
there's some more interesting a chasing
stuff happening outside of call so if
you're interested there is a there is a
plugin project underway called platform
core and a lot of lot of innovation is
happening not just within Grails but
also within the plugins ecosystem and
platform pause in interesting it's
developed by the korg rails developers
and one of the parts of this platform
core is the eventing api so there's a
new event bus which allows you to
decoratively define events and listeners
and trigger events and listen for them
and so on so you can trigger and listen
to events
and this has some interesting
implications for example is another
plug-in calls events push which builds
on top of that and basically allows for
a sink communication between the browser
and the event model for that the new
event bottle build upon by the events
push plugin so in terms of acing
programming there's a lot of innovation
happening this area i recommend you
check out these different plugins if you
interested in that field in that area
okay
so who's used the resources plugin
before anybody few hands so in grails to
bundled by default installed by default
is a new resources plugin and it has
static resources for you automatically
so what I mean by that is essentially
all of your JavaScript CSS and so on
assets and obviously nowadays with the
amount of innovation happening within
the JavaScript and CSS community not
just JavaScript CSS but less files and
coffeescript own you know there's a
whole bunch of new innovation happening
there and what resources does is it
defines a resource pipeline and a
decorative way of specifying reasonable
static resources so and plugins can
specify these data resources as well so
for example the jquery plugin that we
have for Grails declares a resources
what's call the resources module and the
backbone one it does as well and so does
the the various CSS for example Twitter
bootstrap again it also declares the
resources module and with all these
modules what happens as Grails reads all
these modules and automatically does
things like merging all your CSS into a
single file again movingly your
JavaScript into a single file making
sure it loads lost on the page so that
the page loads instantly their separate
plugins to add gzip in caching so and
the it integrates deeply of Grails so
basically it optimizes your your
application static resources
automatically for you as long as you
play within its rules it's a very
powerful plugin and with very little
effort you can have very fast and snappy
and responsive up web applications
without
having to manually think about all the
rules that are needed in order to get a
responsive application so basically this
is an example of a resources module so
you can see here I've got various
modules defined I've got a call module
and utils call module depends on utils
you use tools module depends on jquery
and you can see how i'm declaring the
links to my static resources explicitly
in in here and notice on on the top
right that disposition head so by
default resources will automatically
load your JavaScript at the bottom of
the page so that your page loads quickly
but if you have some requirement where
your job needs to load at the top of the
page then you can change the disposition
so it loads in the head tag and then if
you need caching buy e-tags and the
browser and so on you just installed
cash resource to plug in if you want
your aesthetic resources to be gzipped
and compressed you just install the
zipped resources plugin and it does it
off automatically for you without you
having to think about it
ah
ok so the web stuff that is new in 20 so
in 20 we we jquery is another default
JavaScript library that's pretty much a
no-brainer given the popularity of
jQuery now we added some api's to make
it easy to piles dates it previously it
was you had to kind of create a command
object can use the binding API now if
you just want to get a date from the
questions it's a lot easier we added
customizable URL formats so you know by
default by default rails hairs like
controller name action name and the
default is to use like camel case so if
you have like an action called if you
have an action called start again would
be like start winds up with the word
locust ish and then again with a nap
case a in the in the kind of camel case
way to execute actions now if you want
you can have hyphen separated all in
lowercase what kind of SEO compliance
and so on so forth okay so any questions
about the web features so far no okay
it's gone to persistence then
so gone is a pretty key part of Grails
in that it's one of its kind of killer
features i mean you know everybody with
I speak to buy trails or sucks but gone
as being the killer feature and for good
reason it's it makes persistence
ridiculously simple and historically has
done with relational databases but with
you know things moving fast in terms of
different types of data stored in
different places we realized we needed
to abstract gone away from hibernate and
make it applicable for more different
types of data stores basically so we
created a gone api which before before
gone was basically just a bunch of meta
programming code now it's actually a an
API there's actually a class called gorm
static API which defines all the static
methods and there's another class called
gone instance API which defines all the
instance methods and so on and then
there are various implementations for
the different for different databases
obviously the Hibernian one is still
obviously the most popular and mature
and widely used but then we we recently
released 1.0 GA of the MongoDB plugin
for gone so and that's written well
really well received lots of people
using mongoid MongoDB with grails so it
provides basically the full gourmet p I
on top of MongoDB so you can map all
your classes to MongoDB documents you
can use embedded documents in this
dynamic fine there's criteria queries
where queries all the normal gone
features they used to and if you need
access the underlying MongoDB the API as
well you can no problem doesn't take
anything away from accessing the
underlying Mongo driver and then we have
a various other gone plugins is one for
neo4j there's another one for
amazon simple DB another one for amazon
diamond dynamodb many of these are
community direct MongoDB is developed by
at the core team but the other ones are
community development it's for Redis and
so on so lots of innovation happening in
this area and we also kind of created
hooks into this plugin should not assume
hibernate so for example they were
plugins that hooked into the kind of
hibernate API to do stuff for example
there wasn't there is an ordered log in
a plug-in that adds ordered log into
your application just fine cloning it
and that used hibernate events so as
part of the creation of a gourmet p I
we've created a completely separate
events API that works for both Mongo and
hibernate so now you can now plug in
authors can effectively write plugins
such as ordered logging and so on that
essentially are not dependent on
hibernate and can work with both
hibernate and mongodb and other other
other types of data stores so he has it
here's what I was talking about earlier
this is the list of the Gorn plugins
that are currently available these all
implement the official API and mongodb
is currently in 1.0 g a status some of
the other ones are in milestone status
but but are being adopted and used
already near for j is already used in
production in a number of sites that are
out there at the moment and serving 11
particular german for port side serving
significant amounts of traffic using
warm for neo4j so a lot of interesting
stuff happening in the space worth
following so one of the more exciting
peaches in terms of persistence in
grails to always wear queries so this is
a new compile-time checked query dsl and
basically you just use native groovy
operators so for example there's an
example
so you basically do person not wear and
then you cross in the closure and it
just looks like like a normal groovy
kind of finder or something like that so
in this case I'm saying where first-name
equals bart just using the equals equals
operator and that creates a query object
and then on that query object it doesn't
actually execute the query at that point
when you call where it doesn't actually
execute the query it's lazy and then you
tape query and you've got them call find
or you can iterate over it or a little
xq list so it's kind of a lazy lazy api
and then you can just use the kind of
native groovy operators so for example
in the second example here i'm saying
where first-name equals fred and the
last name doesn't eat something notice
I'm negating that that expression even
like the negations like that work fine
so you can you can express your your
your goal queries just in terms of
logical operators Ruby operators equals
not equals greater than less than less
than equals greater than equals and
create these really expressive queries
that in very little code basically just
and they just look like kind of normal
code doesn't look like some weird weird
you know database specific API that
we're calling into here and you can do
things like I would get functions so for
example I can say find all the people
whose age or greater than the average
age and this various aggregate functions
supported such as some max min and so on
it's really worth checking out the
official user guide on where queries
because it's really a heck of a lot you
can do so if I find where careers yeah I
just kind of brush the surface but if
you haven't already you know there's um
there's the basic query I talked about
but you can also declare like static
variables of the class and then
and you know it's right over them like
that again very expressive queries you
can see that you can do I like queries
using kind of regular expressions if the
database supports it you can do between
between queries using ranges groovy
ranges you can do kind of is null is not
null type queries just by doing null
comparison you can compose queries so as
I said when you create when you create a
query object it's it it's essentially an
instance of the of detached criteria
over the search criteria class and with
that you can even compose new queries so
if I call what call the where method on
the query itself it will return your
brand new query composed of those two
logical operations merge together and we
can do conjunctions disjunctions you can
d comparison queries so you can compare
two properties so I can find all the
people who have their first name the
same as the last time completely
ridiculous query but for example as an
example you can query associations and
you can you can query the properties of
a collections for example size with the
size of a collection whether the size is
greater than or less than so that you
know there's really a huge amounts of
flexibility again sub queries it's an
interesting example here we can sit you
can see I'm asking for the where the age
is greater than the average age of all
people with the last name Simpson you
know really quite robust wearing support
to create some pretty powerful
expressive queries with this new API
yes
all it does is build all it does is
build a hibernate criteria object behind
the scenes so it's just a little town
hibernate for going for hibernate and
then obviously for mongodb it builds of
MongoDB query document behind the scenes
so depending what you're doing which
persistence API are you using but
essentially yeah it just builds a normal
query behind the scenes so all of the
ones that implement the gourmet p I
works with mongo DB all that list neo4j
all of them that support the API works
fine okay okay so what else we got
multiple data sources so in 2.0 we
implement support for multiple data
sources so basically you can define a
class which maps with two particular
data source and you in your data source
core groovy far you can have multiple
data sources declared and then if if a
class maps to two different data sources
you can you can basically the the goal
methods can be accessed by a scope so in
this case I'm doing zip code or auditing
access the auditing data source get to
get the object but if it if this class
awesome app to the default data source I
could just use if code get so you have
scoped access to different data sources
that are defined in your application and
there's also in that Tom Tom across
plug-in that integrates with this for
two-phase commit so if your your your
persisting to two different relational
databases and you want to roll back the
whole transaction you can do that with
grails girls too so they say in parallel
and in this works with grouse 1.3 as
well but we developed a database
migration plugin so the official docs
are at that link below but essentially
model for it is initially when you're
going 1.0 of your application it's fine
you can use hibernates automatic system
for creating the tables but at that
point when you go 10 1 point 0 it's when
you want to start install the database
migration plugin and then what it allows
you to do is dip your production
database against your against your local
database and producer change log of
changes that need to be applied applied
to your production database before when
you migrate to a new version so as you
go making adding adding properties you
on the main class or creating new domain
classes Eirik you can run a command
called can run a command called so
essentially after when you get a
production you call you call dbm
generate change log and dbm changelog
sync to synchronize synchronize your
production database with your local
database then I make you make a change
to your domain model then you can run
DBM gorm diff and that will generate a
diff change lock for between your local
database and your production database
and then when you before you go before
you upload your new site you run ddm
update and it will apply the differences
to your production database obviously
before running DBM update on your
production head of a database you should
review the generated change logs and
make sure they're okay it's it's it's is
fairly awesome automated but you know no
changes to brood of production
motivation should ever be made without
first reviewing the generated change all
okay so other going improvements of
interest we now support abstract domain
classes so previous versions of Gorm we
essentially didn't really take into
account abstract the main classes so
they they didn't results in their own
table and you couldn't run go on queries
against them so in grails to this is not
a no longer the case now you can define
abstract classes in your domain model
and these can be can have gone queries
execute against them and they result in
a table if you're using table for
hierarchy and then obviously the roots
of the table the hierarchy if you're
entitled the subclass and they have
their own unique table and so on there's
a new method called find or create where
so and find all save where so that those
two methods essentially allow you to
shorten the top code a top piece of code
into the bottom piece of code obviously
your user domain class is unlikely just
to have a login property so it's rather
trivial example but but you can get the
idea in terms of what it allows you to
do now into unit testing so in grails to
we really looked at the unit testing
experience of Grails 1.3 and really
wants to improve it on a number of
levels there's a lot of innovation
happening in groovy around unit testing
and a lot of different unit testing
frameworks and tools and we wanted to
make sure that Grails could take
advantage of all of those in whatever
API we came up with so here who's ever
seen a prick um who's ever used a tool
called Spock he hands okay another
question who actually writes unit tests
well that's good to know so we want
obviously when using a dynamic language
and like groovy it's pretty essential to
write unit tests I can't really
emphasize that enough but I mean it's
pretty essential to run it unit tests
with a with a static type we typed
language like Java as well but but
because groovy and dynamic languages are
really designed around writing unit
tests and admit they make it easier to
write unit tests because the dynamic
typing the static types don't get in the
way you can really easily write unit
tests unit testing obviously it was a
big focus for Grails too so what we went
Paul was like a mixin approach to
writing tests so in grails in brayles
one it was the kind of typical j unit 3
style of extending a parent class so
groovy test case or rails unit test case
whatever it may be and that had a
problem in that the whole API was
designed around a unit 3 and if Spock
wanted any of the unit testing features
of Grails they had to kind of duplicate
the hierarchy and maintain parallel
implementations of the hierarchy so now
with the mixin approach you have these
mix-ins that you put at the top in this
case I got at test for this is targeting
my controller and I'm at Mach which is
defining anymore collaborators so that
could be the main classes or services
and so on and and that essentially
weaves in the behavior into this in this
case chain for tests yeah so it
basically applies an ast transformation
to the test and for example at mach will
automatically enhance the person class
with a in-memory version of the gourmet
pie so based on the same same project
that we used to build going for mongodb
we built a gone for concurrent hashmap
they make so so there's a gourmet pie
that persists to a current in memory
concurrent hashmap and that's used in
this case for unit testing so you can
call you can use where queries criteria
queries don't find is and in the
background is storing the data actually
just in a comp are concurrent hash map
instead of in your oil in no relation
renege relational database so this makes
a unit testing obviously a lot faster if
you don't have to have database
connections you don't have to set up
hibernate you don't have to connect to
MongoDB or whatever if you want to do
that you can still can you can write an
integration test but with this unit test
it'll get it will get you most of the
way in terms of locking the majority of
the cases that you need to write good
tests and the at tests for our
annotation about their automatically
injects the controller instance that
you're testing and the necessary mocking
to be able to mock like controller so it
automatically binds a with a web request
each test execution and there's a prime
subject and so on so so you can you can
then take the same test as before and
then convert it to Spock so this is this
is a Spock specification and again you
can see the two mix-ins at tezpur and at
not being used at the top the same the
same use of the gourmet p I to load the
test data and in this case my actual
test is a spot test so for those of you
are not familiar with Spock Spock lets
you have descriptive names for your
tests so instead of having a method name
you can actually have full sentences in
your test names so I can say this test
that the index action the lower below
like you can write a whole sentence in
you as your method name which is when
the test fails it's a lot easier to know
what actual read what actual test failed
and then it has this model
of like when then so you can kind of
give more descriptive for the for
somebody who's coming back and reading
this test more descriptive detail of
what is actually being tested so in this
case I'm saying when the index section
is called then the people variable is in
the model so you know exactly what the
test is is is to actually testing it's
descriptive it's very readable and you
get power assertion failures and and and
so on so you get it trust me if you
writing tests unit tests and grails
which I hope you are doing you should be
using Spock so yeah as I said there's a
full gorm implementation as part of the
unit testing API and that's based on
concurrent hashmap it's based on the
Gulf Coast for no sequel code base so
the same code base that we built going
for mongodb on we also have home for
concurrent hash map for those of you
interested by the way the project comes
specifically referring to is called
brayles data mapping and it's a full of
course like everything we do it's fully
open source and there's a developer API
so if you have a fancy building your own
form of conversation this project the
instance being a bit slow at the moment
but anyway this project will is
essentially where you would start and it
has a full AP developer guide on how you
would go about building a gone
implementation and it's actually not
that difficult but anyway this is where
you would you find all the
implementations so you got like simple
DB and Reija can read as neo4j and Mongo
and JPA hibernate gemfire DynamoDB
accessor this is where all those
implementations live the concurrent
hashmap implementation is called test
those used for testing but they're all
living there
so also in grails too we really looked
at like the whole framework and may try
to cover all the bases in terms of what
you would want to test and hope and
define in ways to test them because too
many times in one point three people
would post on the Grails user list how
do I test this and we were like well you
need to do this you need to do that you
need to there was a way but it was like
quite a lot of work for the user so we
looked at everything and made it a lot
more trivial to do so testing tag
libraries command objects xml json
responses file upload viewing template
rendering filters your l mappings
criteria queries loads of stuff and
another thing compared to the compared
to the 1.3 documentation on testing we
really have put together a more
comprehensive chapter on testing so
under the unit testing section there's a
lot more detail on how to go about
testing the different things that you
would want to test controllers tag
libraries domains filters your L
mappings etc it's a it's a lot more
in-depth the user guide on testing
so that kind of wraps up on Grails to
now let's talk about 2.1 2.1 was
released when was released two or three
months ago I think and it was actually a
pretty significant engineering effort
2.1 there's no from a user perspective
there is not that many visible changes
compared to two point oh but we had
investigate a large project to migrate
the plugin repository for girls from an
svn repository to a maven repository and
that was a huge effort because we had to
the process the repository was like four
gigabytes of plugins 850 something
plugins we had to I had to write a
script that went through all the plugins
downloaded each this release
distribution it took days downloaded
them all generated a pom file for each
one because we published a maven you
need palm and generating a pom was
wasn't trivial either because we have to
actually generate a valid pump which
meant because I no no good generate a
palm when you it's not even going to do
anything so where to generate a valid
palm and we had to verify the palm and
then we had to bet publish to the art
and units and new route maven repository
back by auto factory excellent project
and the auto factory online guys are
providing the hosting and so we it took
a lot of back-end work to get this
working and then we had to write like a
bridging layer for all the versions of
Grails so that they could keep resolving
plugins against the new repository so
for all the versions of Grails
everything just keeps working and we
changed the dns entry and it's full it
still looks like an svn based repository
for all the versions and girls but yeah
but we having the Grails website is
actually rewriting URLs to make it make
it compatible with all the versions of
Grails so we didn't think forget about
users of
else 1.3 in world's 1.2 and then for
newer versions of Wales obviously
they're using me the Maven pure maven
based resolution so there was a lot of
work happening in the background and
then we we rebuilt the maven plugin from
from will essentially spend a lot of
time rebuilding them the maven plugin so
it worked with all this new metadata
that was generated for the plugins so
now you can now you can define plugins
in your pom file Sonya your actual pom
you can declare your plugins and maven
does all of the resolution when using
maven we also integrated maven commands
into the command line so it's very easy
to get up to get a maven build up and
running we had a lot of flack from our
mailing users after 20 came out and
didn't really support maven very well so
really focused on getting this right you
can create an app create a pom file
prompt for your app and run Navin
package you can also use maven to power
a multi-project build for your browser
application so i can create an app and
two plugins for example and then there's
actually a command I've shortened it
here to grails CMP be that actually
works by the way rails will expand that
command you know you can actually type
that command that second last one and
grails will order expand it for you
scigirls cmp be which is dance will
create multi-project both will create a
multi-project billiton to plugins in the
app and then you can use maven to build
your two plugins and your Apple together
so maven users who are who are required
to you avin is a build tool for their
environment how many people s using
maven yeah it's quite a lot here so yeah
now can use maven and girls together and
we also we also change the maven plugin
to pork Grails for command execution and
this is
orton for a number of reasons one it
puts a lot less pressure on the Maven
process because it maven the maven
process itself is not containing the
Grails process which led to a lot of
permian problems and suffering for maven
users so that's no longer an issue the
other thing is that will another
advantage of the sport mode is that we
can we can essentially attach the JVM
agent I was talking to you about earlier
so when you do maven Grails run out
it'll attach the JVM agent and you get
reloading even with maven which is uh
which is really great maybe users
because they can run using maven install
would get reloading and all the cool
stuff from Grails to ok so that was me
and the other big feature of 2.1 is we
have a new caching plugin so it's
installed by default and it basically
lets you annotate services so two to
cash method calls inside inside a given
cash it uses the spring 3.1 cash
abstraction and it takes into company
arguments to the method and so on so
intelligent cash key generation and so
on it also lets you annotate controllers
so I can I can annotate a controller
action and it will cache the entire
response of that action so including the
GSP view whatever GSP were is rendered
it will cache the whole page basically
so you get you get content level caching
as well with the cash plugin and and
there's also a set of cash tags there's
a cache block tag which lets you cash a
block of whatever is inside the body you
don't need to specify a key each block
is a closure and the closure has a has a
unique ID unique name so we use that as
the default key if you
specify your own key you can obviously
you need to be careful of not repeating
the same content or multiple ties but
anyway if you don't specify key it's not
a problem there's also a version of the
random tag which will cache the
rendering of a template which is useful
as well so when you when you install the
cash plugin by default it uses a uses a
concurrent linked hashmap as the cash
but then there are various
implementations so at the moment there
are three but I expect that there will
be more in the future as Reyes plug as
the plug-in ecosystem expands around the
cash plugin right on the moment they are
three it's there's cash eh cash cash
Redis and cash jumper so when you
install one of these sub plugins all
those annotated method actions and
control actions and so on and the tag
someone get cashed in eh cash or reddit
or gemfire depending which one you're
using also part of this there's a cache
configuration dsl so so and this is
important for plugins because a lot of
plugins they want to define caches that
they need but they don't want to they
don't want to force the application to
depend on a specific cached
implementation so now there's a DSL
where plugins can define I need this
cash but I'm not bothered about if it's
a Redis cash or it's a gem file cache
what's a eh cash cash just just make
sure there's cash there that I can use
and these are these the kind of
properties are one or a lot so plugins
can now do that as well as applications
which is important and we're out of time
but another cool with improvement which
we shamelessly stole from Gradle is the
Grails wrapper so you can type grail
space wrapper and it will generate a
bash script in the roots of your project
or a bat file for Windows called Grails
w
so you can type grails w run out and the
advantage of this is you can check in
your project and you can check it out on
your build server for example and you
don't actually need Grails installed on
the build server or anywhere to run
girls w you'll automatically download
install Grails version of girls are you
using and run the run run the
application automatically so you don't
need to set up the Grails installation
where it's also good for your general
team because if you don't if you don't
every book individual developer to to
have to you know in setup and install
the right version of Grails you can just
see if Grail w just check-in the girls w
file and everybody just uses Grails w
there's also some command aliases minor
peach you can type Grails alias and to
create aliases and for commonly executed
commands so grey else is also i'm going
to go into this and in great detail but
Grails is also available in the cloud so
various planning in infrastructure
support Grails it's a ruger plugin is
cloud foundry plugin amazon plugin its
works in cloudbees Grails is pretty
prominently supported in various cloud
services out there worth checking out
future roadmap stuffed we're working on
rest improvements the sum of these we've
already checked off but in terms of 2.2
Grails 2.2 which is just now an RC stage
what you'll see in that release is build
isolation so I isolating runtime from
compelled time class parts namespace
support and groovy to that again as I
said available in arathi stage right now
and then we've just started work on
growls 2.3 with grails 2.2 and being an
RC stage and we're going to we're going
to dramatically improve the rest client
support implement gorm on top of rest
improve data binding and work on more
or interesting eating stuff girls 2.3 as
well general stability and then moving
into next year we're going to start work
on Grails 3 which will be our Gradle
integration and application profiles
which will basically be a way to have a
template for an application so lots of
cool stuff coming up thank you very much
questions</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>