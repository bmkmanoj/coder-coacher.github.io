<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Cross-Build Injection Attacks: How Safe Is Your Java Build? | Coder Coacher - Coaching Coders</title><meta content="Cross-Build Injection Attacks: How Safe Is Your Java Build? - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Learning-Library/">Oracle Learning Library</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Cross-Build Injection Attacks: How Safe Is Your Java Build?</b></h2><h5 class="post__date">2013-02-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/K2aTRS8uvY4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">thank you guys for joining me for this
talk on crossbills injection attacks my
please CC season many people and before
we get started I'd just like to know is
there anyone who in this room has heard
before about the term crossbills
injection attacks raise your hands if
you have not so many that's actually
good because hopefully you'll pick
something at new along the way but to be
honest into the beginning of the year or
halfway last year I didn't know about
them either I mean I had some fake
notion about how your build could be
vulnerable to some some kind of attacks
but I really haven't thought about it
very deeply but actually working with
one clients who had a highly sensitive
application really turn my eye to watch
this problem of vulnerable bills because
it's pretty interesting that we put a
lot of efforts into securing our
applications building safely secure
coding standards applying and best
practices keeping up with the latest
updates of your framework so you don't
have any vulnerabilities and those are
all good things to do and good things to
have there were many talks here java one
as well relating to these topics but a
point that i want to drive home in this
presentation is that you shouldn't only
build safe applications but you should
also build your application safely
otherwise all your effort will be for
nothing and i hope i can show that and
can demonstrate it in the stock and i'll
give you some food for thought and if
not they come up and discuss and now
we'll see but that's the central premise
of the stock you shouldn't only build
safe applications but you should also
build them safely so now your next
question is of course okay how can i
build my application safety what can go
wrong and and we'll have a good look at
that during this recession first a
little bit about me my name is Sal amok
i'm from the netherlands where i work as
a software consultancy calls info
supports it's a medium sized at least
from netherlands medium sized
consultancy i focus mainly on the java
development and architecture image spare
time i'm really interested also in some
scholar developments
currently not for any production
projects but who knows an addition to
that I try to be really active in my
java user group as well in the
netherlands so i do that by giving talks
writing i have a bloke as you can see so
this yeah all kinds of stuff i tries to
do to keep up with the latest and
greatest so trust I mean before we dive
into any technical details I think this
is the most important thing to keep in
mind who do I trust what do I trust and
this is not just in relation to who's
coding at your work but also in relation
to older by libraries etc that he use
and and while I was researching this I
ran into this great article by ken
Thompson and it's called reflections on
thrusting trust sounding kind of
recursive and it's also a kind of
recursive story so it's really good read
recommended written in 1984 so before
all the fancy stuff that we're working
with today has arrived but the central
message still applies today and in this
story on reflection on trusting trust he
has a nice story about the c compiler
which obviously is written in c and in
the sikh empire if you wanted to
implement a new feature you could do
that of course but you could not use
that new feature to implement a new
future because well the compiler didn't
understand the new feature yet so we had
to do some clever tricks and workarounds
to create a new feature and then compile
the compiler with it all compiler and
then you get a new compiler that
understands this new trick and then you
can rewrite your compiler using the new
trick so there are all kinds of
dependencies and recursion going on this
is all because you're using software to
build software but he also so that is
not only used for good things like
adding features to compile this is also
a very good way to add trillion horses
too for example applications compiled
with comp artists and he gives an
example of the log in command of of UNIX
and how you can create a nefarious c
compiler which
I was in a back door into login and you
wouldn't even see it in this in source
code of C compiler because of this is
recursive Drake of learning to compile a
new new back doors so really it's a tale
of caution and and the more or less you
can't trust code that you didn't totally
create yourself and even then you have
to trust your compiler and the you can
says even deeper you could trust your
compiler while you must also trust your
CPU to do exactly what you think it
should do well of course Turtles all the
way down and then the trust has to end
somewhere but just this I think of a
pretty nice story to read and really
shows how things can go wrong at places
where you don't even think about it so
today is this still something that's
applicable well maybe not at the c
compiler level I think we have a
certified c compiler even that's proven
to be safe etc etc but that's not a
point i mean there's this lots of things
going wrong currently also on the
security perspective so just some
headlines that I am through together at
the illustrators point one is the fact
that an open ssh distribution and got
severely back doors and you would just
use in in any bsd distribution you
reduce your port commands to instill and
install openssh and it would download
the source code and it will compile it
for your you're compiling from source so
that should be safe right what can go
wrong and I still the back door was
there that's all because of a breach in
their build system similarly if you look
at the distribution of source ports just
recently they had a beggar into PHP my
admin which allows hackers to access any
of your databases if you weren't paying
attention and it was it because of a
corrupted binary in one of their
delivery notes so how did you end up
there it's really a matter of making
sure every note in your distribution
network is safe and so there are other
stories as well sent mail had a breach
in the build system as well which
allowed people to inject code
and even even worse at github there was
a a hack that allows you to commit in
any repository if you knew what this
brick was so obviously this all has been
patched in a sober has been solved but
in the end it should have been prevented
of course and because it isn't it is as
well when we assemble our applications
from from binaries we use promoter
applications we use to pay very very
close attention to the security of the
whole process of assembling your
application so you may still be thinking
okay these are all like sea-based build
projects and that article you mentioned
was 30 years ago house is still relevant
today and for that I just like to show
you a very small example using a maven
and just a Java compiler just to be be
sure I have a perfectly legit install of
nathan's or Nothing hacked in there and
also a perfectly legit install of the
Java compiler at least I hope that's
what I've depended on but so far so let
me show you a little example in this
case and this will be the only code of
the whole talk and it will be the most
trivial class you've ever seen of course
it's a public last test with a main
method in which we just print haider ok
so it will be built using maven with a
super standard palm just defining the
group ID i defected eversion packaging
and i have a definition for my American
compiler plugging of it says okay this
will be yahoo one source the targets
java 16 byte code I mean what could
possibly go wrong right so let's see do
just a maven clean install to build the
whole thing
success now let's execute so I'll add
the class to my classpath i'm just going
to execute it hey that was not enough
source code what just happened here
let's see
and there it is it still just hide area
my source code so something must have
gone wrong but where and why and can
this happen to you as well that's the
question that we're trying to answer
here so does anyone want to take a guess
what happens here yeah a transitive
dependency they could pull in at the
head it might be possibility but now in
this case not really so let me get back
to your presentation and for any one of
you that's wondering okay well I don't
use my episode it won't happen to me
actually what I'm talking about
crossbills injection attacks it applies
to all the modern build tools in our
jihad landscape and even outside of it
so what are you using Grail IV or
whatever everything that uses automatic
dependence management's and retrieves
dependencies from a central repository
as those maven is vulnerable to attacks
from the outside and it may sound
obvious but we don't really think about
it right and just quick ball who uses
may even here okay whole room that
settles that okay so a picture of the
situation that we have ok we have maven
rights Nathan downloads its dependencies
from maven central and very convenient
very easy to use but in this case I
would say that convenience might some
way sometimes also conflict with
security there's an inherent trait of it
seems and what happened here is that
maven does not only download the
dependencies for your application but it
will also download dependencies it uses
for its own execution so in this case
the maven compiler plugin will be
downloaded from the central repository
if it wasn't already in your local
repository and will be used by maven to
actually compile because well I made
sure that there was not just a normal
made from compiler plugin
was in the local repository but of
course the hack version which replaced
some code in my sources and compiled it
and then replace it back so nobody would
see only at runtime so hopefully in this
case my QA department would have caught
this problem if not then well I rest my
case all else is lost but you can of
course if you have the possibility to
inject arbitrary codes into an
application you can do much much more
invisible things and much much more
dangerous things than just replacing a
string in this case so i don't know
maybe maybe injects a back door into
your banking application so you as a
hacker can log in and transfer money or
maybe even if you're smarter if there is
a security vulnerability in a certain
web application library let's say spring
MVC and it gets fixed and developer
things okay good go fix I'll update to
the next version and he basically next
version in his making palm and then you
as a hacker nefariously replace a new
version with the old version that still
has the vulnerability and nobody would
nobody will notice so in this case the
change was obvious but it doesn't have
to be so it's really something you
should be be aware of a bit of a maven
central because that's the example that
I'm taking I'm using maven as an example
here but I said earlier it applies to
everything that's that uses a
centralized repository mason make
essential is most widely used java
repository it has over 400,000
components 7 half billion requests per
year it's really mind-boggling and more
than 60,000 organizations around the
world uses and if you want some more
stats there's a nice sonatype white
paper or presentation that contains all
these numbers but really what this shows
is that if you can can get into this
maven central if you can somehow make
the people who use making central you
can inject yourself between them that's
really something
you want that of a hacker really but it
hasn't happened so far at least know
that I know but if i get if i can think
of it somebody else can think of it
right it's prime targets but still this
doesn't mean that's the maven central
the repository is better or anything
it's just that we should use it wisely
so what could go wrong well since may
even just downloads jars and code in the
open over the internet all the caveats
of using a normal internet connection
apply a hacker could position itself in
between you in between maven in this
case which makes the connections and
maven central and you request a HR and
you will get a malicious jar back of
course you might think okay haven't we
solve this problem already using secure
protocol etc I will get back to death
but as it is maven just downloads things
in the open and things might go wrong
with this scenario there's also slightly
related scenario in this case called DNS
poisoning which case the hacker doesn't
sit in between but it's somehow
convinces the DNS dns server that you
use that Mason central is not at knife
essential but at hacker central for
example and it redirects the request to
this this nefarious hacker central and
it will send you just malicious jars and
do it like death so these are both
transport level dangerous and securities
and as I said you might be thinking of
some solutions to that and we'll get to
that but what about this what if maven
central would be compromised that will
be something right I mean I think they
could go packing then and nobody would
use it anymore so there's no known
breaches so far of maven central but
what if it happens how would it affect
you would you notice
will you just download these jars anyway
and put them in your bills and run your
banking application and everybody is
happy including the hacker so all these
different tech factors have wrong
results namely the fact that there's
arbitrary boundaries may end up in your
application and it might be convenient
to ignore this because as I said I'm not
aware of any have any place where this
has happened but I don't think that's a
professional approach right I think that
we really should be working and together
to prevent this from happening and to
prevent people from trying to do this
and this process built indexed in text I
mean there are cons of meshes and we
will talk about them in a remainder of
stock but you will have to work for it
it doesn't come out to Megan
automatically at least not by default
just for a tribution that the cross
build injection term is not invented by
me it's a term coined by fortify and
their research department they are a
security club who have really nice
software for scanning your applications
for security holes etc and they identify
this this weakness in the whole build
infrastructure of java applications so
if you search for coachbuilt injection
or xvii you will either find my blog
post or their white paper at the moment
and they found it first and they
recognize this and soil nice term writes
it goes well with the cross-site
scripting the sequel injection and all
the other acronyms that we have so you
have something to sell to your manager
used to say we have to do something
about xbi you will say okay so about the
countermeasures the first two that a
text layers data shows we're really
something that could have been prevented
by using HTTPS right because many men in
the middle just isn't possible we would
have to have the certificates of the
targets and well that's not really going
to happen and also for DNS poisoning the
same applies so if you're only able to
access make essential about HTTPS
you would have at least prevented these
attack vectors the fact is that maven
central is just it's a community service
right and you saw the numbers seven half
a billion requests per year
mind-boggling so if you want to have
HTTP access https access to tomato
central you will have to become a sauna
type because I so no type is the
commercial guardian of the whole maven
and ecosystem I would say and I don't
think that's a bad deal I mean really
this community service that are
providing for the past years it's really
helped java grow and if you're using it
in any commercial capacity and if you're
depending on this then this is a good
idea you want to exit by HTTPS now there
is a open repository the open source
repository the certain type dot org or
just on top of the torque which is sort
of an alternative but it's not really no
alternative because it only contains the
subsets mostly of the more recent
components and it's really not built for
the kind of traffic that may the central
was built for so we are going to do that
at home skill and if you're really
paranoid and you're thinking about it
you say ok htps yes it's here but we
know about a lot of breaches in the last
few days in certificates etc so in the
Netherlands we had a company called
DigiNotar who was really popular or
unpopular i would say because they lose
lost their root certificates which
allows anybody any any hacker to get a
certificate that was signed by Dakota
which was trusted by all browsers etc so
I mean I don't know where you are in the
paranoid skill and this would be pretty
low in my skill but still something you
have to think about them so some other
countermeasures that he could take you
could just say okay well I won't use any
automatic dependency management
management then I will do everything by
hand and I will throw away maven I will
do just copied by binaries and we'll
verify and check that we're okay
and well okay nice you've prevented a
whole lot of attacks that I described
but still it's of course not scalable
and we don't want to lose the
convenience of the build tools that we
have so another thing that you could do
is say okay I introduced a local
repository manager in my company and
regardless of the whole security thing
is something that I would recommend any
way for lots of reasons which I won't go
into now but if you have this repository
manager you could either have it
connected to the internet so it proxy
make essential and downloads the
artifacts and serve them to your company
and in that case you would have
shortened the attack window because you
only download once from maven central
and then it's in your local repository
distributed to your company so that's
not a complete fix of the situation but
it helps there are also companies that
I've worked at that's say okay let's do
a local repository manager and just good
old ties to the Internet and we just
don't do any automatic dependency with
24 from the internets if you want
something you have to put it in by hand
this is a repository manager and then
you can still use may connect your
developer sides and it points to this
local repository manager and everything
will be fine well yes it will be fine
but that really depends on who feels
this reporter eden okay how do they
assess the security of a binary if it
was compromised and when it was retweet
and it was put in your local repository
yeah you're screwed anyway I mean there
there is some things that you prevent
again you shorten the attack window but
it isn't really a end-to-end complete
fix of this problem so that's this
tomato manual verification I'm talking
about
and when I was talking about this and
some some some clever people said okay
but but doesn't may even have checksums
right so it should be safe and yes Mayim
does use checksums to verify and
binaries against these checksums so ear
and sha-1 or md5 checksum must be
present for can be present for a
artifact in central and where may even
downloads it it verifies this check sir
but the problem with checksums is the
only input for calculating a checksum is
the actual artifact and if you control
as a hacker the artifact if you can
replace that well then you can just as
easily replace checksum that goes with
the artifacts you just calculate a new
one and all for that one so while
checksums are very useful for detecting
any transport richest download glitches
it doesn't really help us to check the
integrity and the authenticity of the
actual artifact that we downloaded so
it's it's an automatic automatic tech
that's really asked some value but not
the value that we're looking for you and
another side note is that if each action
fields in maven currently it tries to
redownload and then it were warned we
will not fill your bills if ejection
fields you can force this by setting
this checks and policy property to feel
and I would recommend that because
something is not right when checksum is
wrong but well by default it doesn't and
as a side note at the md5 algorithm to
create a checksum is sort of broken
anyway in the sense that is trivial to
create arbitrary files that conform to
this md5 checksum has been research and
published so no checksum join up the
answer we're looking for although it's
helpful if you don't ignore it right so
here you see the default situation if it
checks in fields such as retrying net
feels organic says okay
or so set your checks and policy to feel
and it will it will feel and it will
notify you so we've seen some kind of
measures and they're not completely
undependable is there something that
will work and that's when we get to
using a pgp pretty good privacy and
pretty good privacy is nothing specific
to maven or or or anything it's a it's a
product that goes a long way back and
it's used for either encryption or
shining artifacts and in this case we're
of course not so interested in a Crip
shin because we're downloading open
source anyway so no need to encrypt but
we're really interested in the signing
part to a certainty authenticity of an
artifact PGP itself was popularized by
by by using it in email setting to sign
your emails so people could receive okay
that's really summer who wrote this
email and have signed it with it's a
British pgp key but you can use it
anywhere I'd say there's also an open
PGP standard so it's not well it was a
closed source product there are open
implementations of this whole protocol
and the interesting thing is that the
designing is based on a asymmetric
public and private key pair so it's sort
of like with with ssl right but it's
also different we'll see that later but
you generate your own private key if you
want to sign artifacts and you publish
your public key so other people I can
verify it now as I said there's a free
implementation and the one that I'll
show is the new PG gpg free
implementation of PGP and we can use
that to verify our maven artifacts and
why is that well that's because in maven
central not only there is a jar and
and a check soon but recently about
three or four years ago I guess
publishers of libraries were also had to
publish a signature a pgp signature-----
just mandatory if you want to publish to
make essential you have to add a pgp
signature----- alongside your library
and not lonely for the jar file but also
for the poem file why is it important
well of course if you control pom file
you can just transitively include any
other dependency and go you have a
problem again so now if you are a
publisher of the library for open source
library you would have your library
which you uploaded but also this this
signature which you create by signing
your jar and your palm using your
private key which is of course not known
to anyone but then of course there's
still problem of actually enabling other
users to verify that the signature were
heroes and therefore you have to have to
publish your public key to a pgp key
server and other people can download the
key I use it to make sure that your
artifact is really authentic it really
comes from you question the question is
is there a pgp key server for maven
central not a dedicated one but there is
a key server that is I guess mandatory
does the MIT pvp server to a blow your
key to so that's hosted by someone else
not by by maven ocean attack but it's a
widely known server where you can upload
your keys and
the question is in both the default
maven settings this is PC peekers key
server mandatory or optional I'll get to
that in a bit but in the default
settings maven doesn't do anything with
BT to be currently so so as I said in
the beginning it is possible to be more
security conscious and to avoid these
crossbills injection text to a high
degree but you'll have to work with and
that's what we're going to do now there
will be several steps involved the first
one is just getting the key getting the
signature story because as it is maven
doesn't download these signatures by
default automatically like adverse
projections etc so you will have to do
that by hand for your dependency that
you'd like to check in this case I have
the plexus cipher library version 1.7
and i append the ASC and i will get this
signature so in the second step i'll
just show what's inside this file says
okay begin pgp signature----- it's made
by you know PG version 1204 what and
then then you get a whole lot of
gibberish which is of course the the
signature that you're going to have to
verify so luckily you don't have to
apply the algorithm by hand you can use
the gpg the new piggy implementation and
you can use the option and SS verify
i'll give it the signature and the
location of the jar file that's of
course in my local repository now and
then gpg says okay yeah this is
signature and is made at july 26 2011
and it's made by a key with a certain ID
HDD 1bd FD at the far right but i can
check the signature because i don't have
this key right so let's a hold of the
whole key distribution problem so at
this point you're already kind of an
elite program right because as this
tweet by Jason frizzell SS
the founder of maven and yeah you're in
the minority if you downloaded even
downloaded this signature because only
two percent of people who download the
binary binary also download the
corresponding a signature as it is
currently but that's going to change
because you now all know about it you
will do it right yes okay that's the
answer but we're still not there okay so
the top command is just repeating the
verify command of last life and the
green arrow shows that I'm feeling this
key ID into a next command GPC there's
key server and that's when I refer to
this PGT PGP does mit.edu key server
which means okay go look there for the
key with this ID and then it says okay
I'm requesting the key and it's found
its a public key from sonatype pink it's
their Shona type release key which they
have used to sign this artifact and is
imported well okay mission accomplished
well not quite because we only have the
key now in our local keyring but we also
have to verify the artifact right so
again we do the verification step which
is again the same command gbg verify
with the signature in truth and the jar
files input and now it says okay it's a
good signature I can check it against
this quita importance and it's good but
and this is the these are the signs that
is good you input it the key and it's
good signature but there's question
how can you get a key server for a jar
well currently you have to upload your
public key to PGP does MIT and this key
server that's mentioned here that's just
mandatory if you want to publish to
macon central so all keys should be in
there yeah yeah but we're still not
quite there because we just downloaded a
key and GPT gpg tells us okay the key is
valid in a sense that it checks out with
the signature but I don't trust this key
it's not certified with a trusted
signature it's just some random key that
you downloaded from the from the key
server I mean anyone anyone can upload a
key to a key server it's just it's an
open system and anyone can say okay I'm
sonatype or I'm some amok it's just a
piece of text that that's attached to
this key so how can you now be sure that
the key let you download also originated
from the actual person who says it's
from and that's where the whole story
sort of diverges from what is normal and
the public key infrastructure of for
example ssl because there you have these
ruth authorities that everyone trusts
they can give out other certificates and
now these are twisted because your
browser or your other client trusts this
ruth authority but in PGP they said okay
that's much too centralized right
because if one of these with authorities
fields and the whole system falls down I
mean the whole digging did you note our
story that's all at the beginning it's
really really really breach of this
whole system if one of these root
authorities feels so instead of death
pgp doesn't reviews Ruth authorities now
it has a web of trust which means that
tryst is much more decentralized and
unfortunately this makes the whole story
also a bit harder of course with SSS
secure
it doesn't come for free yeah you'll
have to work for it so what does a web
of stress look like so we had this
sonatype release key rice and the blue
keys here are a public keys and the red
keys are private keys and nice thing in
pcp is that a public key can be signed
by other people and when you sign
another person's key you actually say
okay I trust this person I trust that
this key belongs to this actual person
so in this case when you go look at the
pgp key of sana type you'll see that is
signed by brian f jhansi Damien be and
if you trust any one of these people
already they are good because trust is
transitive if I trust one of the people
who signed this top-level senator
Valesky then I'm good if adults already
trust any of these people in my web of
trust because for example you're just
starting out with PCP and you don't have
anything in your in your key ring well
then you have a problem right you could
just say okay I'll sign one of these but
don't just do that you have to make sure
that the key is actually blowing to this
person how do you do that well pgp has
this nice concept of well it's not
actually PGP concert with a smaller
community concept of key signing parties
where you go face-to-face with people
and you say okay show me show me your ID
or whatever you need to be certain that
this version is we says he is I mean
maybe simple as DNA or whatever but it's
up to you to make sure that this person
is actually associated with a key and
then you can say okay now now I sign now
if you've done that then you have this
empty breath and these other person's
web web of trusts and so you can expand
your own web of trust so in this case if
I move we wanted to get a trust relation
to the sauna type of whiskey I will have
to go talk to sauna type but that's not
really a person right who can go to keep
silent party I guess but in this case I
modeled the scenario wherein i imported
key of bride F and I sign it and just
applied at rest relation to this to this
key then transitively I also trust
ethernet/ip because Brian trust so no
type right so obviously it takes effort
to create your web of trust and you will
really have to pay attention what you're
doing so this is not for the faint of
heart but again it's the professional
thing to do if you think about it if you
think about what can go wrong so
actually I've heard that there's sort of
a possibility to to do ki signing and
key verification at the sonnet I booth
if you're interested in getting your way
into the web of trust of maven central
so I'd highly recommend that if you want
to get this started but for now for the
demonstration I'd like to show it's not
just a few people who trusted each other
if you look at just the subsets of the
web of thrust of the apache software
foundation as visualized here I mean
it's huge so if you get your way into
that you will really see that you easily
at least four the apache projects will
get your web of trust up and running so
now less step because of course we want
to see it work all the way right we
don't want this warning anymore about a
untrusted key the last gbz commander
will show in this case I also use some
body functions I say I won't download
any key span by ID anymore by hands I
just say also key locate from a key
server and this case the key server
should be the MIT key server I will give
it some options to say retrieve keys
automatically then in a third line there
are familiar verify information again
using the signature and a jar and in
this case actually we're all good it
says okay you have one ultimately
trusted certificate well yeah that's my
own certificate if I wouldn't trust
myself well I don't know what will
happen and we have one
one f1 fully trusted certificates and
that was the certificate of Brian that I
trusted ash I'm tres Tew by signing this
and that way you have path to this
sonatype risky and yes it is good the
contents are good and it originated from
sonatype so now you're done finally
verifying one dependency of your
application I don't know many
applications that have only one
dependency do you I mean gift ends with
them probably so that will get really
tedious if your application grows and
you have if you have many applications
so somehow it will be good if you could
automate this right and now of course we
could squid a lot of those things that
happens in the previous view slides but
well that's not really a scalable
solution island of course it would be
really cool if we got to support to do
this so what I'll show you is a short
demo of the Nexus repository manager in
which we can define rules to actually
apply this PTP verification inside the
repository manager just a small caveat
is not available in the open source
version so you'll have to get a license
to the professional version of nexus to
do is but anyway let's do the setup this
case I'm switching to a slightly
different projects again defined by a
bomb which in this case contains some
work more XML and we love XML right so
first I override the link to make them
Central and I say don't go to make sense
on but go to my local repository mention
right so in your organization if you do
this you will probably do this
overriding inside of the settings of
your maven installation and not in every
bomb file but for now this is visible
for you and easy
to do for me I also override the link to
the plugin repository because at a set
maven doesn't only download dependencies
for application but also for its plugins
in its own functioning also redirected
to the repository manager and then
running locally and it's just a very
simple project using j units as a
dependency and again this displaces
cypher library that we saw in previous
slides so a nice thing is that that we
know that this plexus eiffel library has
a signature right that could be verified
and i can already tell you that j unit
for the food doesn't have one so it got
into central before it was mandatory to
create signatures so what we're going to
do is just build this application
okay and you'll see that in between
building is our color little shell
scripts clean my local rep 0 which
cleans out the actual entries of the
dependencies in various places to
trigger everything again so otherwise
may even wouldn't go down those and I
wouldn't be able to show this
demonstration to you so now let's do
make them clean install office project
and will see that it feels and it says
okay the following artifacts could not
be resolved J units jar for the two and
plexus I 417 couldn't find them now why
is that let's switch to the
administration interface of Nexus and
here it shows that i have a soak
so-called procured repository and i
procured repository sits in front of a
proxy to maven central it applies it
applies rules to artifacts it allows you
to say okay and I'll allow this in my
organization and not death and not that
etcetera etc so currently there are no
rules defined in this procured
repository which means that by default
it will deny any download it's pretty
sane default I'd say and in this case we
can do something just to check that
everything works we apply rule to all
groups all artifacts all versions and
let's just say that we approve
everything and see if it works now so
I'll switch to my command line again do
the cleaning and install and hopefully
yes it will allow the downloads now now
let's of course not a very interesting
situation right if you just say okay
well download everything then this
produced reporter doesn't make any sense
so I'll remove this rule remove it and
replace it with a much more sane
room in my opinion which is to say that
I apply a rule to all groups artifact
conversions but not this automatic
approve but the signature population
grew and when I check that box yeah here
it says if this option is enabled
artifacts what missing signatures will
be denied so if there's no signature it
will be not be served by this procured
repository so let's see how it fares now
I would expect the plexus to be
downloaded but Jay you need to feel
because well it doesn't have a signature
that can be verified right and indeed it
says J unit 42 so now we have a choice
to make of course how do we solve this
well actually it's pretty simple we can
say okay for this one instance is j unit
402 I'll just allows without a signature
because after my do I've done my due
diligence diligence and sorry the other
rule of course forced approve deny it's
a proof and now it should build right
well not quite because now something new
services maybe says oh well I couldn't
find J unit 381 okay why well because
the maven resources plugin depends on it
well what do you know okay will never
expect to death but in this case I'll
have to do my validation of this
artifact as well and if it's okay let's
say okay and I this prove this artifact
as well and finally I can build my
application
yes there is build success so I could of
course I could have said okay approve
everything and down in this branch of j
unit and be done with it but i would
advise to be a really conservative in
what you approve and deny not just hope
trees of a repository etc I mean
insecurities it's better to be
conservative than the too liberal I mean
don't apply this to all ways of life but
don't take this a photo of ice but
insecurity absolutely a bit conservative
so are any questions by this yeah sorry
ok the question is I said that the AAC
file is required for a blood to make
sense all yes but not three years ago so
everything before that still doesn't
have a AC file of course you can imagine
if you have set 600,000 components in
there and a lot of them don't have
signatures you can go around email every
every author of the library and say ok I
still need your signature otherwise I'll
throw it away which is really not an
option of course and a repository like
Nathan central so there will be lots of
artifacts that don't have a signature
yet that's a problem and there may be
some workarounds that can be done there
can be done by either sonatype maven or
but currently that's just the way it is
ok
let's get back so I mean of course this
is important build your application
safety not just build safe applications
but there are other things that you can
do of course to ensure the security I
mean you should also also do security
testing penetration testing maybe scan
your binaries using one of the
applications that can scan for
vulnerabilities are you can mess a mess
imply heard of some people here at the
show we have an agent that attaches to
your jvm and that scans for security
vulnerabilities at runtime mean there
are lots of options that you can do to
do defense in depth that even if
malicious code got into your application
you'd still be able to neutralize it so
what other things might be sent back
send boxing the application you using
Java to security and etc to restrict
what the application can do take a good
look at your network topology of course
oh yeah alchemist ends with really
important too and some recommendations
on build security I really think it's
beneficial for any other organization to
introduce a repository manager whether
or not you're even doing the whole
procurement and applying the rules etc
doesn't matter as we saw in the
beginning you decrease your attack
factor but you also get all all kinds of
other really nice features but you want
to use in your organization besides the
security so so do that really there's
lots of good open source one AR gyfer
Nexus artifactory we all have open
source versions as well edmonton please
please think about what you put in your
application I mean we won our prayers do
not download anything from the internets
do not click on this binary and yes
every day every night Lee bills we
download dependencies we put it into our
application and we ship it right not
good so
question okay the question is is nexus
pro the only reporter manager they can
do this verification currently I believe
it is so yeah
it does also checking of the signature
what it doesn't do is it doesn't check
whether the key is in your web of trust
so it stops at step two of three right
so we had the third step where we also
make sure that this key was really
trusted by us and that might be improved
in the future but but currently it does
it's make sure that their signature and
it's a valid second signature but not
whether it's in your web of trust so
that answer your question
well worthless is a big word but it
would be more useful if you would be
able to also look at it feel if it's not
in your very first agree yeah so let's
point here audit your build process so
not just this PGP verification but all
aspects of your build infrastructure pay
attention to it because it isn't really
easy attack factor if you don't pay
attention so about the security dispute
tools the future I mean it would be
really great if all of this were all
made it in maven at least maybe download
these signatures if they're there and
hopefully verify them well currently as
I said it's not there but let's make our
voice worth and let's make ya make a
statement that security is important and
if we all want this it will get there
someday so this is also call to action
for all of us to pay attention and not
just for yourself we get on the mailing
list discuss this with us and yeah move
this whole thing for together so if you
applied all of this and if you do pgp
verification if you make sure it's in
your web of stress I mean are you safe
now mr. nothing more you can do well now
probably not I mean security is not
binary it's not either you're secure or
you're insecure I mean the other thing I
can tell you is that it if you're using
all the default setting as the default
settings and just using it as it is then
you're definitely insecure now if you do
this you will be more secure but as the
gentleman notice even if you employ
something like Nexus pro things can go
wrong well if you do buy hands you can
also get your web of trust involved and
it will be better etc etc but yeah
security comes in relations and I won't
say you will be perfectly safe if you do
everything I told you today but who will
be a lot safer than you were before so
are there any questions and by the way
before I take questions a lot of this
talk I've also written down on my blog
if you follow the bitly link there you
will see you right up as we can look at
it at home and questions please there
any left
the question is have I published how I
actually did this this nice exploits of
the end of the demo I guess in the
beginning no no I haven't but there
might be nice one for my blog as well so
I'll think about it definitely here yes
yes well this was also my call to action
right I mean let's discuss this in the
open and let's be aware of this this
issue and do something about it and it
shouldn't have to be exactly what I says
it can be and yeah there may be other
solutions as well but well this is what
I research so far and yeah yeah okay
thank you okay well thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>