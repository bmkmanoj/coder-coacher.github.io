<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Runtime Class Reloading for Dummies | Coder Coacher - Coaching Coders</title><meta content="Runtime Class Reloading for Dummies - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Learning-Library/">Oracle Learning Library</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Runtime Class Reloading for Dummies</b></h2><h5 class="post__date">2013-02-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/djcwL4705tw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Alan Gregerson this is
michael rasmussen we're from the
division team we are happy to be here to
present the runtime class we loading for
dummies I know it's kind of rude to put
dummies in the title because I knew that
no dummies would be here except for like
one guy that I know of so but anyways we
are really thrilled to see so many
people here we're going to talk about
class reloading and we'll tell something
about civilian our class we loading
system and i'll be doing most of the
talking and michael of my lovely
assistant here as always will perform
some very cool live demos along the way
so yeah yes this is above just feel free
to jump in any questions along the way
and and we don't necessarily have to go
through it all I have some cool demo set
at the very end so i hope to be going
through it all but there should be some
from some time for questions and answers
at the end so let's get going so what is
class reloading actually well you can
say simply said it's basically changing
a class code while it actually runs
inside an application right that sounds
pretty easy so what are the mechanisms
that we can actually do in in plain old
java well we have the hot swap as you
probably all know you have some class
with some codes in it you have your ID
running some debugging session that
available and decides to change the code
press the hot swap and the hot swap
actually changed the code so the only
problem here is that's all good right
but the only problem is that it only
supports changing method bodies and it
it doesn't really do the trick right
because it doesn't allow for any true
class evolution developers tend to
perhaps right too long methods because
they really want to avoid these
redeploys because they are really truly
annoying so we simply need something
more powerful here so in j'ville Ian
what we are all about is this class
reloading stuff and we do support a
bunch of additional features to the
heart swell so we have the simple
student last year and we can put in new
fields you can remove fields you can
change parameters you can put in new
methods you can also remove them in any
way you like and we can even implement
new interfaces for existing classes
which is pretty unique compared to other
systems out on the back of place and
last but at least you can also change
the super class and we will see example
of this in just a few minutes so why
don't you Michael take over and show a a
cool demo of some of this stuff oh okay
let me just switch to my screen yeah so
I have this very very simple student
application we can create a student with
a name and see Michael but so to show
some of those class changes that are all
talking about let's add an a student ID
so we create an ID and well the ID will
just create it as a counter and it's
just a static counter just
and 20 ghosts out of 42 those even the
ordinance will probably know why and
just to show that we all know
Oh
ah
there we go
so this is all I isn't good and we'll
save it and let's see what happens over
here oh we got some student IDs but as
you can see since we are assigning the
ID in the constructor and the
constructor is only meant to be run once
per object it doesn't reflect that it
just has the standard value so let's try
something different instead instead of
calling let's create a new variable I'll
just delete the old one and then call it
student ID instead and then we'll do a
class level initialization instead
student ID let's see what happens here
whoopsie now we have a field that
automatically initializes just because
it's initialized outside of the
constructor and if you see we will add
greg whatever and they'll continue
adding incrementing the ID as it is
expected now let's try some of the
changes in class hierarchy let's oh well
let's start with a new interface so
let's see let's create and it's a face
first of all whatever
and let's add this
and just to show that we're using it
return list okay so now we've
implemented an interface let's use it as
well so in our a-list model for this
list let's just change it to list the
balls in it and since right now when I'm
clicking it way I have a select a
student selected method here that it
pops up the value so let's change that
instead to say list of all this table
and call the list method that's safe and
then now try clicking oops as you can
see here it's now using the list of all
interface and the list of all method
instead let's go one step further and
create a superclass person so let's
separate let's put the name in here
instead
Oh
so now we have a simple super class for
the student let's extend it as well and
then we don't need the name here anymore
noticed i may I i had the same variable
name string the name a variable called
sorry field called name of the type
string which was the same as i had in
the suit in class and the reason why did
that is because when I then updated now
it still gets the same it the state from
my student what's actually moved to the
person let to show you this let's just
do this and you can like to see that the
state was moved to the superclass so
yeah I think imma we'll talk a bit
further Europe before so so that was
pretty cool right and it's kind of funny
when Michael say whoops it means it's it
was a big success it is that's just what
he does but every time said whoops then
it's a good thing so don't worry so yeah
that was pretty pretty amazing because
what you just saw here was existing
objects having been created changing the
superclass to those existing objects
that it's a pretty cool feature to me so
and what he also kind of jumped and wee
bit too too much forward he went once
Michael get going he just move it's just
amazing so he also showed that you can
actually preserve the state when you
move the field upwards into a new super
class so we already showed this and you
also saw that the state was actually
preserved and that also accounts for
changing or moving fields downwards into
into a subclass if that's what you need
okay so we already saw that demo so
talking a bit more about the constructor
problem as Michael said well perfect
I really meant to for just creating
objects and they should only be be
executed like once per uptick right it's
pretty important for the for the
language to actually work so and we did
see the aliens automatic field
initialization support that's kind of
like incremental or partial
initialization of the object right but
you can have many other stuff inside a
constructor you and that becomes truly
evident when you have like you I classes
where you have this frames windows
having a call to an innie components
method that's pretty standard and and
those new codes inside the contractor
will not be rerun so you will not see
anything in the construct in the in the
UI and Michael will show this in a demo
in just a minute so pretty much any new
code addisu the constructor will not be
reacts acute it because we can't infer
which codes and which not to execute for
this particular constructor that's
basically impossible so that's that's
where these objects transformers come in
very handy and and what is it an object
transformer will in in in davillon we
have this special method called javelin
dela dela updated that actually gets
executed once for each subject after it
has been after the class has been
redefined for this object so let's just
see again switching to Michael a short
demo of how this actually works in a
real application yeah ok so let's try
making a change to the UI let's see yep
ok this is the building NetBeans you I
editor so let's just find something a
text field let's drag it into place
so and let's use it for showing the info
instead of when you click on the person
right now it pops up a message dialog
let's add that to a text fuel on top of
it instead so let's come on let's just
give this a meaningful name so I just
info doesn't really need to have a text
to begin with so and save this as you
can see here from the constructor it
calls the a new component methods which
initializes everything but when I go
over here nothing happens because the
constructor has run once so i'll just
quickly implement the method that Alan
mentioned whoopty had it here already
which just clears this is a symbol for
you I works but werewell you just clear
the existing components from the from
the content pane and then initialize a
new I'm going to do that whoopsie you
get the text wheel up here and to see it
in use we'll just change this to say
it's text info search text and select
list let's remove this method again we
don't need it anymore we've already
accomplished what it does so now when we
know when we oh that's coming out this
line that's annoying there we go now
when we do the selection it pops up at
the top instead of in a message dialog
so back to you Ellen wait it seems like
Michael is really on fire today to me
that looked pretty good so instead of
having this civilian doubt that i
updated it's not actually convenient to
have that in your production code if you
forget to uncommon it it looks like it's
just annoying right it's convenient for
these small kinds of stuff that Michael
just showed you but but it can become
just yeah some people are just an
by having to write this artificial
method in their production code so what
we can do instead is actually give you a
reload listener that will actually
notify your code when classes are
reloaded and you can implement if you
have like complex you I things you can
just repaint or whatever you need to do
on every class we load for specific
classes and we can do that you have you
just simply have you don't actually need
to depend on our code we have just
implemented this using a simple change
listener and it's simply configured as a
JVM argument by civilian dot reload
listener and then a fully qualified name
for your class and we will generate an
object and invoke the method so an
example of this is this simple j'ville
yin listener where you have this main UI
handler object and you get the subject
from somewhere here's he would just use
the get main UI a method that is not
showed here so you have this main UI
entry or reference and when the classes
are reloaded it simply just refreshes
the UI as needed so so it's pretty
convenient as well if you don't like
this weird methods ending up in your
production code so we have talked about
some nice features in basic class
reloading and some pretty advanced stuff
by changing the superclass talked about
the constructors and then we have the
problem on static initializer serve as
well so what should actually happen to a
class once it's reloaded what should
happen to the static block you could
have changed code inside the static
initializer right you could have new
static fields and what should we do what
should give real and actually do when
classes are reloaded it's actually a
really good question should it just
react secure the static initializer will
perhaps that sometimes what you really
want to do and unfortunately that's not
always what you want to do and we cannot
really infer this anyway in general so
it's impossible for us to know whether
you needed to reinitialize the static
initializer or not so but I can say it
can ex
the lead to severe side effects and not
to mention that by react securing it it
would actually wipe out the entire
static State for that particular class
and that may also lead to some weird
problems in your application so you can
have this law state and errors and
specific things that only needs to be
run like once you get you end up in
illegal access errors and illegal state
exceptions and I've seen this in some of
our users so so what could we actually
do to make this quite it just a little
bit better well the villain has some
nice support for actually initializing
new static fields so if you add a new
static field we will actually pick up
the code to initialize that specific
field without touching any of the other
things in the static initializer and so
that means we actually keep the site for
the aesthetic stuff and Michael would
just briefly show how this actually
works in in the application yeah okay
let's switch back here so Bella we saw
we actually saw me doing earlier that I
added I aesthetic student counter but
just to show that it's not reset when
adding other things let's see laughs one
two three you can see now let's go over
here if you look up top you can see that
new field was initialized to the value 1
2 3 and the old one you can see this the
student counter is still counting up
from the old value at hat so the the old
the the values of the existing static
fields are preserved while new fields
are initialized to the value that's set
yeah wow that's that's pretty cool so so
all this class we loading is is pretty
awesome right so but but really is that
enough to support your updates of your
running application well it turns out
it's it's it's quite it's just not just
quite enough you have for instance the
NetBeans platform which we have at like
good integration within the last come
few years yes they have all these
decorative stuff inside the NetBeans
platform window existing file actions
that you can actually register you
actually need to put in some annotations
on top of classes those are pre
processed by annotation P processors and
if you don't know about this stuff it's
pretty cool and you can talk to y'all
Slavs to like here in the audience if
you like it's pretty cool stuff but
these are picked up by annotation
preprocessors and stored or generates a
layer XML file that we can actually pick
up so but you need specific integrations
in order to pick that stuff up besides
the basic class we loading right soja
villain has some nice support in this
regard and let's just let's just go to a
demo of this okay so I fired up a an
empty netbeans application cloud
platform so this is well just have some
simple it's what I basic NetBeans
platform application has so let's just
have a module here called demo and let's
just add a simple action to it so let's
see action
hello world I would define and
come on
you
let's say and for netbeans we do
complete module reload set design so
let's see if our new menu item was dead
up here we have it right here now in
file hello world hello John one and just
to show the generated file for this it's
down no that's the one there this is
generated file that's that was that
contains all the metadata required to
add the new action in the menu which was
empty beforehand and which comedian then
picked up and was able to pour sand
integrate into the running application
to Ellen okay so there was still like
one example of our our integrations so
what about Java EE can we do something
about all the web frameworks and
containers and all that stuff that
really need specific integration and and
we've just released just over 20 24
hours ago we released giving in 30 with
new a java ee support so now we actually
can do something in this market as well
so web applications they tend to just
use a broad variety of containers and
frameworks and many of them use some
kind of cash mechanisms class metadata
about classes so when you actually
change a method add a method or remove a
method it won't really show up in the
application or you will end up having no
such method errors because of the method
will not be picked up because it was not
it happened not to be in the cash so we
need to clear all those caches at
appropriate times and really deeply
integrate with these kind of things so
why don't Michael show a JBoss demo he
needs just a few seconds to set up but
let's just switch it's just starting up
so it should be should be okay yeah I'm
just buying up right now so let's
if this is ok so it it looks like i will
have my spring demo instead i have one
demo today and it's just I just having
one demo is dangerous because it always
just fails like Mike right migraine
notes yesterday so so I hope it will
work out so we have specific integration
with a number of containers and we have
just begun our quest to support pretty
much any major service and frameworks
out there and and we add more support by
the day so you should check back to see
and you can comment with we feature
requests for your own specific
frameworks and we will look at it so we
have tom cat 6 and 7 jelly 7 &amp;amp; 8 &amp;amp; J
plus 7 dot 1 integration in you can have
class be loading in those SF now we have
some bean validation support spring
model-view-controller you can do some
cool stuff in there well since equation
was DC and more and I'll just do a quick
demo showing a demo of an application I
found on the Internet I know that
there's one guy that probably will
recognize this application but nevermind
it was just something I found so it's
just a simple pet application where you
can just add some pads and you can view
information about pets but you really
can't because that's not implemented yet
so let's go on and change that in the
code i know that i can just um uncommon
this in an existing controller this new
request mapping what I really want to
show a bit more in this demo soul it
let's try to add a new controller and a
new auto Wyatt Darrow object and see if
if that connect Lee work so I'm going
should create a new control
yeah and I'll just add the controller
annotation I will just copy the request
mapping to the new controller and I'm
coming it and thus a bunch of imports I
don't need to do yep oh I need to order
wire this tile feel right so I need an
or white field like that and the
annotation for that like that and one
more import and we should be ready to
more imports so let's try to save that
file and see if we have the new request
mapping well we had so we can actually
change request mappings or wired and
inject new beans and spring and all the
stuff and I really encourage you to try
this out yeah and are you ready with the
jboss demo good so let's go to my home
yeah okay so just to show that we also
have some support for jboss i have a
very simple java ee so you might know it
it's the default maven architect jpost
so let's just try some of the things we
have support for right now so if we try
to add a new member here we'll see okay
let's just do one two three four five
six seven eight okay bean validation
right now this phone number requires to
be between 10 and 12 characters long but
since we're Danes and in Denmark gig
phone numbers or eight characters long
so let's just change the bean validation
for that too only require eight
characters since that
and let's see that's and now it works
now we have a now the it validated
because we change the validation to
eight instead of ten similar let's look
at some of the rest easy stuff that it
has right here if you look at here we
have a simple a xml of the of the member
we just created but let's try to add a
new field to this subpoena so let's just
add a alternate alternate phone number
and I just get us in service for it so
if we save this really real out here now
we have they also had phone numbers
showing up as well but let's try
something more let's try actually
creating something new let's create a
JSON that for it instead so now we add a
new path for the rest easy with adjacent
mpit just to show that it doesn't exist
before hand doesn't exist now we save
and it's real or and let's try and now
we have the jason variation of the of
this member yeah and back see you Alan
yeah that was pretty cool java ee demos
and again I encourage you to try this
out and give us feedback and comments
and then feature requests because we
really need it at this moment so I guess
we kind of speed it through this session
and but that just seems gives us more
time for questions so I hope that you do
have some questions yep
it's pretty IDE dependent all we all we
do is actually you only need to add like
one or two actually two JVM arguments
like a java agent and a boot classpath
that's it so you can tweak the debugging
by going it gets pretty annoying in any
debugger if you have all these synthetic
methods that we need to add so you can
just add a simple filter and not going
into synthetic methods and you're done
we don't need any deep integrations in
any IDE to actually work just just to
show these two lines is all that's
required to add to any JVM up to enable
artist tubulin to to work so it's pretty
easy to use there may be some
configuration with the mapping of
workspaces and the wit and where class
notice and application look no
application servers Lotus actually no
classes that you can set up by simply
providing a xml file simple
configuration yep
right now we don't have support for
remoting that's something that we need
to look into so and we'll be looking
into shortly good question yep
how we're doing it it's a it's magic
yeah if I was supposed to tell you how
we did it it would take me like five
hours but but basically we instrument
classes as they are loaded enabling them
to we set in some hooks and enabling
them to actually reload once we have a
reload event that's the very short
version I don't know if it really makes
any sense yep at the back comparing
Couvillion to Jay rebel well civilian
can do like unique things like changing
implemented interfaces changing the
supertype it can do automatic
initialization of fields instance and
static fields civilian has a bunch of
support support for many many frameworks
and many servers and we will get there
eventually but that's that's pretty much
the main difference right now Jay rebel
has been around for years and it's it's
more mature and and we omit that but I
think that we are on the right path yep
could you hear that michael i couldn't
know
I couldn't really hear it you're talking
about simple changes to ya when I try to
use with weblogic server gelam and
simple features are working for example
the changing internal of the method and
then try to load the class and without
restarting can I see the change or not
yeah you can any change to classes you
can will be actually picked up by our
class we learning system we don't have
weblogic support yet but that's also
something that we will need to look into
so we have tomcat jetty and gave us for
now but we added this like in a few
months so I would expect many more
servers to come and many more frameworks
it has been easier fortunately than than
we anticipated to integrate with these
and I'm sure we'll get a number of
issues in like any other software oh I
can see issues for looking at the j
rebel forum as well so yeah any such
issues mostly welcome them and we are
pretty good at fixing those issues so
mm-hmm it requires a little bit more
configuration it depends on whether or
not you use custom class loading to
actually note this jar file but if you
if it's just like a simple library file
that you actually change it can be set
up to actually pick up the changes to
that file as well yeah yep java 6 and 7
we could support java five but it seems
like not many users are still on Java
file any more questions yeah
I'm not sure what you mean what are the
use cases well I mean any to me with
what I'm doing like any project in java
this i really think that this is very
useful because you do reach that even
small restarts for small projects it
really gets really annoying and it you
do all these contexts which is and it's
it's a lot more fun to have this
incremental development cycle that you
can like interactively see the changes
and you can just stay focused that's
yeah so any i would say any project but
i may be wrong I maybe people disagree
with me but i would say i would use it
always and and people also tend to sort
of work around this restarting problem
by adding more test driven development
and it really just adds to the
complexity because you need to write a
bunch of dry code and then you need to
test it and if the test is successful
it's good but you may actually test way
too much code at the time so this is
really good for it really changes the
way you code i believe so by allowing
you to see small increments of changes
but it makes a huge difference yeah
I would say as long as generating our
generating source code or byte code that
doesn't really matter yeah and then you
compile it and then you load it with
some lower right and if if if it gets
loaded with a loader then we will
transform it those classes the same as
they were ordinary application classes
so it wouldn't be a problem yep it's
what yeah yes it is fully supported I
didn't do is you may have noticed we did
annotation changes so annotation
reflection is also supported a lot of
the e examples we used to for
annotations yeah yeah yeah if reflection
was not supported we would have be in
deep trouble because nut marks could
actually work any other questions well
then thank you you have a question you
can go to comedian calm and sign up for
a free trial what yes it's a licensed
product yeah there's a trial period free
trial period where you can use it for 14
days and then after that it's you know
it's a commercial product yep so please
try it out yeah thank you thank you very
much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>