<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Live-Coding BOF: Writing a Game with JavaFX | Coder Coacher - Coaching Coders</title><meta content="Live-Coding BOF: Writing a Game with JavaFX - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Learning-Library/">Oracle Learning Library</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Live-Coding BOF: Writing a Game with JavaFX</b></h2><h5 class="post__date">2013-02-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/XOStAVGCMVo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Michael I'm working the JFX
team I'm the technical lead for the core
components which means the properties
the binding API the new collections and
the animation framework and before I
joined Sun Microsystems later Oracle I
was a game developer so today I have the
great opportunity to actually combine
those two parts of my history with a
professional history and I want to show
you how you can write a game using Java
thaks so we just have 45 minutes so you
don't expect doom or anything like that
it's it's more going to be a casual game
and to be honest it's not going to be a
full game I mean I know it's what
writing a game means it's usually not a
weekend job it takes a lot of effort but
what I want to show today is how you can
actually write the the basic game
mechanic in just 45 minutes so now for
talking Jessica over here
does he work to hear me sorry hello
No
hello now works okay great so I'm using
NetBeans for this exercise I'll start
with a new project and when you have a
current version of NetBeans it has the
Java facts plugin already installed so
I'll just choose a new project which is
Java thaks application give it a some
name and make sure that the application
class already gets created so how many
of you have developed your FX
application so far ok not so many so
I'll go through this very quickly so
what NetBeans already generated is a
very basic application when you start
that it'll just show a small small
window with a button and when you press
it it prints hello world so that's what
Java what NetBeans already provides for
you I'll just quickly remove all of that
not actually not all of that the parts I
don't need so we have this basic class
which extends application that's a class
in the job in the JavaFX runtime and
every job X application needs one
instance of this or one one yeah one
instance of this application class which
is your starting point and there's one
method stored which gets stage stage
Schism and abstraction it depends on the
platform you're running on on a desktop
system you can think of a stage as
window so you get the first window and
you fill it with the content and you can
create more windows later so down here
there's a main method
which will be started in environments
that don't know the the applique
application class yet but this will
probably change in the future but for
now you can just ignore it
NetBeans generates it and then you can
just ignore it
oops okay so Allen show effects
application starts with a stage within
that stage you put a scene which defines
the content and within that scene you
have a scene graph the scene graph is
basically just a tree and the leaf nodes
of that of that tree are the elements
which will be visible on the screen so
let's see we have the primary stage
charvaks of the runtime is mostly based
on using lots of properties so you can
see the primary stage when I want to
change the title I'll set a property
title and I set the scene which are
generated before just change that to
something not really more meaningful but
anyway okay so
I'll decide I'll define the screen size
usually in in constants because that's
certainly a better way to go I don't
know why NetBeans is not doing that
actually so these are the parameters
that you pass in the constructor of the
scenes so the first one the second one
is the width and the third one is the
height and root that's the root node of
your scene graph so as I said it's a
tree and the root node of that tree has
to be passed to the scene as well
so we can quickly around that already
oops not get actually I have to fix the
import and have a typo that should be it
now
so now I have the scene with the right
size and it's empty because the root
note doesn't have any children or
anything to show so we're going to fix
that next first I want to I will use
images mostly for this application
so here I create an image and I pass in
the URL on the path to that image
and I'm using this long construct
because that makes sure that it's always
found no matter in how I have this
application built as long as the file is
in the same folder as the source file it
will be found if it doesn't depend on if
it's a char or if it's just running
class files from the from the file
system and actually I have to copy those
images over
this one
okay
so I'm copying the the image files and
all the source files into the same
folder I have to find the image and now
I need to define the background
oops worse
now the imageview is actually the
element you show on the screen and the
concept here is the image class just
contains the data an image view is the
note you can show on the screen and that
is much more it is better if you want to
show the same image several times on the
screen you just load it into memory once
in an image and then you can have
several image views pointing to that
image and you don't have to use you
don't have to load it for each instance
you want to show it on the screen so now
background image
and I'll pass that ass to you in the
constructor
and now we'll see the first image as you
can see I hired a young talented artist
to create my my images was pre cheap
just nice cream and my daughter was
happy
so and now we want to generate some for
Graham because in the game you usually
have several layers of graphics you have
a background and if the main character
is doing whatever they are doing in the
game and then you often have a
foreground and you can do that very easy
actually in Anjar effects using the oh
it's hard to talk and code at the same
time you can use that easily using the
the tree capabilities because if you
want to render the scene on the screen
we just traverse the tree so you can use
the tree itself to define the set order
of your elements here just
create this
okay now I create a new group which will
be the foreground and have to create the
trees first
okay so if we do that now we'll see that
the the trees are not at the right
position actually not visible at all
because I forgot to put the foreground
into the scene
so now you can see that the trees are
all up here so we have to set them at
the right position but you can see also
that they are on top of the background
and that's because I put them behind in
this group this is a list and I put it
behind the another list I mean it's a
lark but the order of the elements to
find how how the how it will be stored
internally because the background at
first it will be rendered first and the
foreground will be rendered on top all
the trace here so now I have to move
those using the translate X properties
in order to check the values I was using
here so the translate X property and the
translate y property allow you to move
the work okay and to move the elements
okay Alex team
so when I write now you can see it's at
the right position but actually it's um
impossible to figure out what foreground
and what's background and to fix that
I'm going to apply some effects on the
background on the and on the foreground
just to make it clear what is what on
the foreground I'll add an effect on
drop shadow
and on the background oops
background I'll put a different effect
which is a blur effect and all of that
is already provided in the runtime which
is set it or you just instantiate it and
you set it for the note and then the
runtime will apply that effect what was
the other one oh yeah and I want to make
the opacity a little smaller one would
be fully OPAC and zero would be
transparent so I'm going to run that you
can already see because the background
is little blurry and the and the opacity
was reduced
it looks really a little distant and the
foreground because of the drop shadow is
a little closer to you now so with that
it's pretty clear what's foreground and
background so now we have the scene set
up pretty much now we're going to add
our main character
as the name suggests it's going to be
Burt and I have two images for that
because I want to animate this little
character now okay put it here
okay now to make the animation later
I'll need to put that in a group and
then I'm going to switch the content of
that group with an animation so I'm
switching the which means I'm going to
switch those two images group
okay and I put it between the two
so now we can see the some thing which
is Bert I asked my daughter twice but
she ensured me it's Bert
so start the animation there are several
concepts and the Jeff X runtime that
allows you to to generate animations and
one is the concept of the timeline
timeline that has a certain duration and
then you can specify key frames
positions on that timeline and for each
of these key frames you can then specify
that a certain variable should have a
value and then it will interpolate the
values in between plus you can also give
a defined event handlers for all of
those keyframes and then when the
animation plays and hits those keyframes
the event handler will be triggered I'm
going to use that here now there's a
property cycle count with which you can
define how often this timeline should be
played I'll set that to indefinite
because I want to have that move on
forever okay
see
okay so here I'm using actually the the
Builder pattern which is available for
pretty much all of the hoops for pretty
much all of the classes in the jar of X
runtime and with that I can easily set
up complex complex objects because if
you would just use the constructor and
then say call the setters all the time
it gets kind of messy and it's not
really nice and so we have these
builders so you can actually put all of
that in one long line have a use it
before actually mentioning it now and it
get it makes the whole declaration of an
object much much more much smaller while
still making it clear which properties
are going to set so you don't have a
long list of parameters in a constructor
and later II don't really know which
what is what but you can see what what
you're actually setting here so now I
need to define two key frames one should
be at on 150 milliseconds and I want an
event handler
what was that
oops wrong kind
okay
and
okay fixing imports so this event
handler has just one method I need to
define which makes it kind of you know
it looks awful right now but once we get
lambda expressions this will be really
easy because all of the event handlers
are Sam's I mean single abstract methods
I have just one one abstract method and
so you can use lambda expressions later
which would make this whole thing
extremely short so now I take the group
and then I replace the children which is
actually just one note right now I'll
replace replace that with a second um
image and I need another keyframe
shall set after 300 milliseconds and
this one is going to set the first image
again see
okay so now you can see it's flapping
just by switching those two images now
we want to make this bird fly for that
I'm using another concept for defining
animations and that's these are
transitions so a transition is so I'll
type timeline gives you a lot of control
and flexibility when you define your
animation transitions are meant to allow
you or to allow you to specify one
specific type of animation and but they
do that a lot easier I mean define your
using time lines gives you full control
but it's also very verbose and kind of
complicated but if you use transitions
is really extremely straightforward but
I'm doing that in a little method which
I want to use because I'm going to start
this animation form from different
positions I mean from different parts of
the oops
of the code so here at the end I'm
calling start animation which should
start the animation and now I have to
see okay so in order to access this
animation I have to declare it as a
field
what was it Oh animation current
so just to be sure that the current if
that the current animation will be
stopped I'll just do that first that was
too fast stop this one okay and then
I'll have to create two random numbers
and I have to declare the use the random
so as usually in games the quality of
those random numbers doesn't really
matter so can she do it like that
and I want this to be
some will between up between the height
quarter height or and three-quarter
heights
and then I declare a new translate
transition with these values oops
yeah Berg has to be a field as well
because I want to access it in this
method
and I have to remove the local variable
here okay so now it can access it here
and you can see to define a trance-like
transition I just said which note I
actually want to to move across the
screen and then I specify the starting
x-coordinate oops
was that 2x and the starting
y-coordinate will be my first random
number Y and then I need to define a
duration
I want the whole thing to be two seconds
and to start a new animation if the old
one finished I'll use this unfinished
Handler and that's fired as soon I don't
know why NetBeans always gets the gets
this wrong so this event handler gate
miss gets fired once the animation ends
and then I'll just start a new one by
calling the method
build oh I didn't explain the Builder
pattern to the end so we have these
builders you call create to create
instance of this builder then you set
all of the properties here and at the
end you call build and that generates
you a new instance of this class with
the currently set properties here you
can reduce builders actually when you
want to create similar objects several
times you can just declare the Builder
one once and then you change just the
properties which are different between
the different instances and call build
several times and each time you get in
your object so here we just need one so
I'll just finish that let's see
so now you can see how the bird is some
flying across the screen and now we want
to allow we want to enable the player to
shoot this little bird with a mouse yeah
I think I have to make it slower here on
stage so to do that we can apply an
event listener a mouse pressed handler
to the object itself to the bird so when
we hit the bird with the mouse this
event and leg it's fired and that's how
we trigger our how we measure if the
player was able to hit the bird so now I
just put it somewhere because I'm losing
every side on this small screen
okay bird that was our group and I set
the on mouse pressed handler here
and
okay
and what do I want to Oh I'll create
another hit animation I'll start that
here and that's pretty much it for now
so now I have to define this hit
animation so and for that we use another
feature of the animation framework which
are group transitions a group transition
so far I mean we have we have simple
transitions you can use timelines for
complex animations but the group
transitions allow you now to take those
simple transitions for examples and then
assemble them to more complex animations
so there's a sequential transition which
takes a list of animations and then
plaits them one after the other and
there's a parallel transition which
takes also a list of them chitchat a
list of animations and then place them
all up together and what makes that
really powerful is that you can actually
combine those two and you can nest
sequential dramatic transition and pearl
transition into each other so you can
actually define very complex animations
just by using those simple transitions
and combine them using sequential
transition and parallel transition I'll
do that now by defining the hit turn or
I'll use that to use to define the hit
animation
sequential transition builder that's the
101 okay I have to oops sorry
so again I'll just I'll set the note I
want to to any made here and then I'll
define the children
for that I'll take a rotate transition
which as the name suggests rotates a
note values were the I specify the
starting angle and the end angle and
duration again
okay
that's the first one and then I want to
translate transition and here I don't
specify a starting value so which means
as soon as the animation starts the
current value will be taken and I don't
specify an end value but just say it
should go down by 1000 pixels and the
duration was 800 can
okay so
supplanted
now let's see if I can hit it yeah oops
okay that actually it wasn't really what
I intended here when I start the
animation I have to make sure that the
rotation is correct so let's just take
the rotate attribute because that's the
one that gets changed by the rotating
transition I'll make sure it's zero when
I start something actually here I wanted
to when I hit it I want to stop the
other animation so you can see once you
have an animation you find it pretty
much works like the CD player or
something you call play pause stop you
can jump in the animation and do all of
this stuff and it's pretty
straightforward to use it that way so
yeah
okay but one thing once this sequential
transition is finished I'll call this on
finished hammer use the unfinished
handler again yeah and again I have to
write all of this crap here as I say
it's designed really to to become really
fun when we have lambda expressions but
right now it really sucks okay
no I think you have to slow it down a
little okay so now I want to add a
little display counting the shots and
the misses
so for that I'll define two java x
properties both are going to be use
integers
and I have to pass in two parameters the
first one is the beam of the property so
the containing class and the second is
the name of the property or actually
it's it's kind of optional but on which
one should use it
okay the hit counter for that I already
have my event enter so I take the one
most pressed handler use the hit counter
and it's a property so it has to get her
in the setter to increment it I have to
make it like this unfortunately right
now maybe somebody will file a feature
request to give us increment and
decrement so in for the for the shot
counter I'll add a mouse event handler
to the scene so whenever the user clicks
somewhere on the screen it will
increment the number of the shots you
did
shucks counter
okay now I actually want to show that on
the screen so I create two labels the
hit label and another shot label or
shots I know where I need to fix the
import and two to set the value I'm not
going to do that myself in a change
handler or something but I'm using the
binding capabilities of gel effects the
binding means if you have two properties
or property and something observable you
can bind it to the property and so
whenever the observable value gets
updated the property will be updated
automatically which makes on the code
much easier because you don't have to
think about all the cases when the value
should be updated you just define the
binding ones and then you can forget
about it so I'm doing that right now
hit label is so text actually it's not a
class in the Java X runtime it has
property text and which means it also
has a method text property which returns
this instance of a property and that has
a method bind now I'm using the bindings
class there are a whole bunch of very
useful methods in this bindings class
too to generate new bindings so this is
hits there's a contact method and
put there this
okay
and I'll do the same for the shot label
oops
okay and then I have to show all of that
on the screen
oops something is wrong yeah I think
this constructor doesn't exist so I'm
going to use the Builder
what
just move it down here
have to move it a little
to make it visible
oops
okay I just moved it around so that it's
declared already and I'm just adding the
stuff here and there's some error oh I
forgot to copy the
eventhandler here
so you can see the shots already
counting but the hits are not okay so
now the hits are updated as well and the
strings here which are concatenated our
crew are calculated automatically that's
done by the bindings API so what else
maybe maybe one more binding here so if
I want to show also the misses
I think I can't really do sound you
won't hear it anyway
such as to the calculation of the missus
for that I don't want to add a new
property but I'll just calculate it on
the fly create another label and this
time it is going to be bound to
I'm gonna do
you know here I'll take shut counter and
this is also part of the binding API I
just take the one property called
subtract on that subtract the the hits
and I have to add it to the HUD here
now you can see mrs. get updated as well
and I'll just declare those findings
once and then that's done so I think the
time is almost up so now this is
certainly not the full game I mean if
you want to write a full game you need
to add menu a high score list certainly
better graphics more levels and all that
stuff
but what I wanted to show you here is
that you can use gel effects to write
casual games and the API is really very
straightforward you can use it
straightforward when you write games and
it matches really very well what you
need when you write casual games and
what I also wanted to show you here is
how fast you can or how fast you can
actually develop something and when you
write games the hard part is actually
not really coding the game but it's
finding a new game idea a new game
mechanic that's fun and and addicting
and you can actually just figure that
out by trying out so you need to you
need to be able to get your ideas
implemented quickly too to try them and
to fine tune them until you have the new
Angry Bird or bejeweled or whatever so
and with Joe effects I mean it took me
just less just 45 minutes here to
actually have the basic game mechanic of
this simple game ready and I think
that's true for most casual games so you
can have a good idea in the morning and
you can actually test it already in the
afternoon with Java effects so thank you
very much
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>