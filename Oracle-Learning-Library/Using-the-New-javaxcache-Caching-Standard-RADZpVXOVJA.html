<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Using the New javax.cache Caching Standard | Coder Coacher - Coaching Coders</title><meta content="Using the New javax.cache Caching Standard - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Learning-Library/">Oracle Learning Library</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Using the New javax.cache Caching Standard</b></h2><h5 class="post__date">2013-01-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/RADZpVXOVJA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey good morning everyone I'm Greg luck
CTA terracotta and I have with me brian
oliver from oracle you can explain your
job title sort of architect at large guy
with the coherence team but and also
want to introduce somebody who's
refusing to come to the podium yanis
cosmopolis so you'll see yiannis his
name all over this thing because he and
I worked together or last year and then
he up and left auricle and brian's the
new victim but we're just sitting down i
guess in the next few weeks to start so
so far everything you look at is a
product more or less of jana sanam and
myself yeah let's did actually handed
over yeah he sent me an email would like
here's the staff actually no jaani jaani
no work together a lot so but that's
good so i don't know if anybody can you
just have a show of hands if anybody
came along to this session last we had a
similar session last year anybody come
asked you that that's good some new
people alright we're just going to
bright and I just going to do this
together so first of all we're just
going to basically tell you about what
we mean by caching going to stop right
yes so I assume most people to see what
caching is but essentially what you're
trying to do is improve some performance
well there's sort of two parts to it
improve some performance or exercise
like offload some requests to some high
latency slow thing so it may be
protected oh good well let's pick on
databases so you've got a database it's
under load and you want to do some more
queries you need to get some more data
out of it then having that data if
you're using it often that's important
using that it often keeping in memory
sticking it in a cache basically keeping
a copy of that data then you're going to
improve performance of your application
does Oracle have a cache we have many
now which one do you work on our corn
coherence so an oracle coherence so so
this this spec is coming to you
basically from from the clearance team
and the eh cash terracotta team so i
guess between us we've got a pretty
like we got a lot of users yeah I think
well my background has been in I was a
customer of Oracle several times before
I joined the team and all of that work
was in caching and distributed cache in
like your oth cash so right so between
us I think we know a little bit about
caching now yeah we just have to
actually agree on stuff yeah yeah well
you know that's the anise and I agreeing
on stuff was a monumental effort and now
I've got to start all over again with a
new guy thanks Janice but but the yeah
at least actually can anyone understand
it's because we're both Australian and
went to it yeah we're both Australian
now so we're going to change all the
domain over to Australian animals so
yeah so when two Australians get
together the accent will change a lot
usually used to be an Australian and a
Greek so so the interesting thing about
caching is that my my background doing
eh cash was simple in process caching
and then the the coherence style of it
which is data grid and the terracotta
style of it is kind of different so over
the last three years I've went out and
met a lot of people that are doing more
the enterprise style what we're trying
to do with the spec is actually cover
cover the the entire spectrum from
simple and process caching to using data
grids just to pick up on one of the
first points here the typical way that
caching is introduced is that is to an
existing application so even this
existing application often it's the
database that's the problem and you it's
very very simple to add in I talked
about Lucas I'd caching where you know a
request is going down to the database
what you do with the cash is you
basically put in an if-then statement
and you go across and have a look at the
cash and see if it's actually there if
it is you return it back to the
requester if it's not you continue on to
the database on the way back you put it
back in there you put in the cash that's
very very simplistically how it all
works so it's very very simple it's
really like an interception idea now we
talk about the database but actually
it's any you can k see anything and over
the years
I've done a lot of web page fragment
caching anything that took all over the
network of any kind you can often a
really good place to catch on the client
side and as Brian was saying the the
effect of interrupting that normal flow
down to that resource is that you
actually offload you offload the load
off that resource and you actually
protect it quite a bit so you know
certainly the companies that I've worked
out where we've put this you know this
cashing in that sort of what cash aside
approach we've seen like database load
go from you know sixty eighty percent
down to like twenty percent or even
where and my it's insane when you when
you spend a huge investment in in your
database and something as simple as a
cash can have a massive impact yeah
patient yeah I think the challenge for
like the community is that we've not you
know we've talked about this for I don't
know ten years it's the longest running
JSI ever and remains so today a personal
best record we think we'll get out in
the next ten years but we keep talking
about it at conferences but now i will
give you a status update there in it
we've actually provides a breath well
you haven't yet but you know we're going
to put you to work justjust back to the
what you can expect if you've never done
it on a database if you if you'd like do
it properly I've usually usually
achieved about an eighty percent offload
when you're when you're caching things
that are network calls often your focus
is not so much on offloaded section on
performance because you're about to go
and doing something that's very very
slow so so caching is kind of one of
those little magic tools that you know
while you're while you're saving your
precious resource and offloading it
you're also dramatically boosting
performance and because all of us cool
vendors are all distributed you actually
can scale out as well so you can as your
system grows you use it a data grid or
distributed cache and and once it's in
the case all the nodes can use it that's
the simple principle so a little little
query to hear
was interested in obviously a run super
caching who's interested in for
improving performance of an application
okay who's here to improve capacity Wow
okay who knows the difference between
them ok so let's I'll just give it a
little anecdote how to how to how to
deal with this so with caching we always
talk about pretty much always you'll
talk about performance and let me let me
explain to you what happens and why a
lot of people think about performance so
if you go to an airport who's flown in
ok a lot of people fun in so you go to
an airport and there's a this is Q right
and there's one person they're serving
away you know stamping your bags I won't
pick on any particular airline but
there's going to be one there tomorrow
or this afternoon but there's only one
person there who's collecting bags you
in the queue can see the entire
environment right you can it's slow
right you're queued up and and there are
two things you can observe you can say I
wish that person would hurry up because
they're going slot right that's
performance well what else could they
what else could the airline do add more
people right one is about going fast
performance the other is about capacity
right adding more capacity because then
you can like processors request faster
now inside a system you hit a web page
right you go to pick an airline let's
talk about American got American
Airlines and there's nothing in
particularly wrong with these guys but
you go to american airlines and their
website is slow like you go to book in
your notebook what do you say what do
you say what you say the site is slow
right so the CTO gets an email says that
your site is slow and then the CTO comes
down to you and says the site is slow so
what do you do try to improve
performance right you naturally just go
you immediately think that I'll put some
cash in and they'll improve performance
but often what you also think about is
have to start thing about how do i
improve capacity where are the
bottlenecks you think you can see Q's
and how do you add more capacity so it's
greg was saying like we've talked about
this for a long time so as guy you just
scale out that's the idea and having
part of this API is the ability to have
an API you can talk to that yeah as a
cash you can do things fast in memory
but also the same API will let us what
you plug in infrastructure that lets you
scale out because often you in these
types of systems you have a capacity
issue not a performance issue whatever
the technology is clustering I mean
there are lots of technologies that let
you scale out some i would say clustered
someone's more of a farm approach in a
cluster there's usually some sort of
shared state arrangement between the
members about the key thing the key
thing that's true of of distributed
Katia's and data grids is that once
you've put once you've gone retrieved a
data item and put it in there all of the
nodes can access it so you never have to
go and do that piece of work again
unless you unless you have a TTL and it
expires or you update it or whatever but
that's the key thing and that lets just
go out so we call it single system image
so you have every machine in the cluster
or as access to the cluster has exactly
the same view of the data well that's
what we try to achieve and sometimes you
may want to relax that and caching lets
us do that because you can have parts of
system which is slightly out of date
when you don't need completely live data
but this API is you know we see is
really really important to allow the
community and Java developers to start
you know adopting cashing in a
standardized way and then choose what
what type of caching you want whether
you don't want pure caching or a
datagrid you can start with that one
point so that's a nice segue under the
next slide so I was a little bit about
caching now about the java caching
standard so the the package name is java
cache it's being developed by JSI 107
which is the longest-running JSI ever
people have tried to kill it and failed
people try to finish it and failed we're
still standing
it requires java 6 and above it will be
included in java ee 7 that still the
case jovi 7 was due to be completed in
2012 is now slip 2 2013 we've slipped as
well but we're still on track to be
included Brian Brian's actually on
weekly phone calls with the EE 7 group
so I guess it's going to make it know
how to work a lot going to work a lot
here so the e7 is being wrapped up like
we're wrapping it up and I don't know if
you've seen any of the other talks on a
Cameron protease keynote on Sunday
talked about you know Jay cash and 107
being part of that will in the status up
you'll see update you'll see why we've
sort of had had a slight pause but where
you know very dedicated to make sure it
gets into e7 now when we finish right
now e 7 gets done 2013 you'll start to
see app servers that implement it you
know I guess the RI which we glassfish
2013 but then weblogic will be what 2014
or later and other vendors might be
later so you know the question becomes
what do you do in the meantime well Jess
I 107 will be immediately useful and
usable now it'll be it'll be usable as a
standalone standalone jsr and an API so
the java akash even though even the
current version is actually in maven
central so you can just go and grab it
the other thing is that the annotation
side of things is actually designed for
java ee 6 so you can use that with your
existing app servers and tomcat and so
on and we support CDI spring and juice
so for those annotations so it's going
to be immediately usable be great if it
gets included EE 7 if we if we make that
deadline because it's kind of built in
but even without that it's not going to
change things practically for you very
much and all of the vendors have
basically committed to implementing it
so whether it's part of a 7 or not it
you know
I think we the e7 is just a goal we
wanted want to achieve yeah it's yes
yeah absolutely yeah you know it doesn't
it's not it's not a java ee technology
it's really more of an SE technology in
fact you know possibly well let's get
done and worry about what happens after
that but possibly I you know a default
version a default lightweight and
processed version could be included in
Java 8 yeah but just yet it's more yeah
it also says immediately usable by any
java based am so SC is fine in fact i
can't think of any actually i'm going to
show you a very very like super simple
demo which is just SE so you'll see that
it's just occurred movie could be an
Emmy as well there's nothing that stops
are being an Emmy we're going to be
everywhere man yeah just need to get
done so after this talk we've got to get
ahead then I write some code this
morning so terracotta and Oracle
developing the spec it's developed in
the open so I'm an open source guy I
guess you're not partly half open so
there's a mulling list just i 107 on
Google Groups com you don't have to be a
member of the expert group everybody's
welcome also the the spec the spec the
reference implementation and actually
the unit tests that form part of the tck
are all up on github com such as
github.com / j sy 107 so everything's
completely in the open i'm now licensing
so the the spec will be the standard jsr
license so it's free to use like any any
specs are if you're an implementer and
there's lots of implementers of this
then I think Oracle's usual deal is that
if your non if your commercial that
Judge something like thirty five
thousand dollars a year for the tea
together for the tck so that you can say
that you're a compliant you know you can
advertise yourself as being compliant
with any spec now that kind of cuts
against Albert against the grain with me
so what what we negotiated was at least
the first five years five years is zero
dollars right so and then what I think
is going to happen most likely is that
they'll probably be a success or an
update to Joss I 107 and if we're still
around we'll hopefully we negotiate
another five years one of the reasons
why it's taking so long is because i
want you know we wanted these changes
which it seems like very very few people
actually ask oracle for ya yes the 350
3.5 that's the umbrella jsr for java ee
7 so it's one it's 107 it's github com /
just i 107 everything's up there
actually also up there is the is the ehk
wrapper for JSA 107 which unfortunately
wasn't building for me this morning this
is the problem with contributors I'm
like dude can you please give me
something that builds with maven clean
install anyway i'm going to show you the
the reference implementation instead of
eh case this morning now the RI the RI
what do we do about the RI because likey
education is really popular do we make
that the reference implementation well
unfortunately that that doesn't work for
the other four other people involved so
what we've done for the RI is is we and
mostly yiannis developed just basically
just a brand new reference
implementation it is not a complete case
it's basically a simple in process case
it's not a complete cash and it's not
really useful for anything it is apache
to perform simple in process happy well
it's it's you can't it's actually
missing things well I'm not I'm not
particularly interested in building
another eh case i have a whole
engineering team at terra cotta that
works on that and
guys are not really interested in
building another key here is you've got
a whole team that works on that right so
but it is apache2 and if anybody wants
to wants to take it and like go under
your own open-source caching project
quite welcome to start with that it is
at you two and because what I'm trying
to do here is actually get a standard
out the door and the if you say all you
know you know I'm the spec lead north co
spec lead and already have a que should
I just want to use that then the vent
the other vendors go we'll hang on is
that giving you an unfair advantage does
that make making any educational you
know even more of a further default and
it just makes it less likely that your
effort to produce a spec is actually
going to succeed but well well they both
the sauce isn't running the spec so
remember this is one part of a very
large group of specs so so for example
yep terra terra cotta have invested a
huge amount in optimizing age cash do
they want to give all of that investment
away because if it probably did give it
away at least in the in-process version
mean right so it is part of it your way
but then that has to be then bundled
with glassfish which is open to the
community so not only is like then and
there's no there's nothing in it for
them apart from getting it out there so
there's a huge amount of resources so
you know we have to work together to
produce a reference implementation that
passes a TCK and then let's all the
other vendors equally implement their
own it's the same with JMS it's the same
with jdbc it's the same with server
phases it seemed like we have that's the
whole reason behind specs and the tck is
to let people do them and mix and match
so if you if you want to build if you
want to put together an app server that
has different pieces from everywhere
else as long as they're all spec
compliant they should work together
you're not tied into one
yeah I mean it's just it's just politics
you know like your look at what you're
trying to achieve we're not trying to
further popularized H cash we just yeah
you know you know what this is all about
so Massimo Pezzini from I mean I want to
do this anyway but like you know I'm
trying to convince our company to devote
resources you know what is helpful is
Massimo Pezzini who who analyzes the
data grid space in his research he you
know he's saying 2014 is going to be
really mass adoption of data grids
saying the single biggest inhibitor is
the lack of a standard that's his number
one item so you know it makes it makes
it a no-brainer for the executives at
terra cotta and oracle to support this
and so that say you know the way the way
we benefit is by you're removing that
obstacle to broad adoption of data grids
and then we are a data grid and you know
that that's the point here but look you
know the edge case j cash will be
actually released it's not the reference
implementation but it will be released
as each dot as each dot release up to
0.5 gets released a new version of the
edge case je cache module gets released
sitting up there on github so you can
start to use it i would say probably the
next release of it would be the first
one that i'd look at using in production
technology compatibility here technology
compatibility kit so the way the way it
works is that is that any implementation
of a JSR has to pass the tck or it
cannot claim to be an implementation
come and it can't wash lee it can't
claim to be ninety-seven percent so
wholly for rules you've either got to be
an implementation or not and you have to
pass the tck and if you're a vendor
you've gotta play oracle a fee and the
fee it's not really a profit-making
exercise for oracle i mean 35 grand a
year they provide support and developer
assistance and all the rest of it so you
know
nah no I mean well let me move on to
status so it was a question of that yeah
yeah yeah that's another that's the next
slide so let's get there just want to
talk to you about the expert group the
expert group is really alive and well so
I'm co spec lead and then Oracle's the
other coast back lead we've got Cameron
birdie who refuses to resign even though
it doesn't do anything to help illegal
things oh yeah well he actually does and
then we've got we got it basically
everybody everybody that is involved in
this with either an open source project
or commercial projects on the expert
group very very happy to announce that
fujitsu only joined about three weeks
ago I became aware that fujitsu have got
a new brand new data grid they've just
entered the market they're known in
Japan there's only a Japanese web site
for this thing so far it's called
interstage xtp brand new data grid and
they're actually using they're using
java api as their primary api i pointed
out to them are actually using the 0.5
well actually they check for me they're
actually using the zero point 5 draft
and i like that you realize that that is
not it's not a snapshot but I said
that's it aroused and they're like
really how much is it going to change
we've released that cover anyway I said
look guys why don't you join the expert
group anyway we've got 20 20 members on
the expert group some old-timers some
some new people who got just just a
neighbor guy pick a few names you know
we've got nikita ivanov from grid gain
we've got
I see the other thing we've got a couple
of wall street people like David ma
sakowski we've got IBM what was the
what's the guy that headed up IBM's
effort building import Billy Newport is
he there he said because he is an expert
group member and his own right yeah he's
it yeah he's probably listed under
Goldman Sachs yeah Goldman Sachs oh we
got Billy Newport so we got kind of all
the main people right progress so so the
last release was that enter March to 0.5
and we were doing we're making fairly
fairly regular progress up until that
point and then we paused why do we pause
so why we paused was because 0.5 was
ready for public review we felt though a
couple of open issues but we basically
felt that what we really needed was to
put it out there get the public review
and then and then basically drive to
drive to completion so this it's all
open you can go and look at it now and
you can make comments and we really
welcome them but part of JCP is is for
more public review process and once you
sort of past that and pass changes are
necessary both then it can actually move
on so it's really important to get to
this stage but getting to that stage can
be somewhat challenging so there's all
sorts yeah I p we have two different
companies who want to protect their IP
and the way you know your employment
contracts life but work that we work on
is so sort of sharing work out becomes a
bit of a challenge so also i mean we
actually wanted some modifications to
the standard the standard the standard
license agreement we wanted the for the
tck we wanted zero dollar fee we're
actually at about five or six other
changes just little things and yeah it's
actually taken over a year so what
happened is I submitted actually
uploaded everything to you know that for
a review to the JCP and of course if JCP
was an independent or
ization like a foundation maybe they
would have just released it but instead
they take oh and they do it they do a
little look over to the Oracle lawyers
and say is this okay and the Oracle law
is like well you know we don't have we
haven't finished all the agreements it's
quite annoying because I can see that
you need final agreements to do the
final release but surely just putting a
draft out I mean it's like you said
everything's actually out there now
already the big the big challenge I
think you know I think you know
personally if the JCP was a separate
group than how they fund themselves so
ultimately they got to be funded somehow
so it all sort of pics the tab up on a
lot of this stuff so so where we're at
we're right now is is we did actually
finally reach agreement between terra
cotta and and oracle on on every last
thing about three weeks ago now we've
just been waiting to sign and what's
been going on for us two and a half
weeks is that oracle are just
double-checking all my personal
paperwork and the latest i heard today
had an exchange with the oracle lawyer
they've lost my Exhibit B from an
employer I had six years ago so when I
get back to Australia I'm going to have
to sort that one out but but hopefully
the signing will happen in the next week
or two toys hard to say then the draft
will come out for a view where I'm
satisfied that it's now going to happen
so we're going to what I wanted to do
today what we both what we both wanted
to do today was to say look this thing
is coming out we want you guys to start
giving us feedback so if you just go to
I've got got the link there github com
Jess I 107 please go and take a look
please give us your feedback there's
just open issues there you can create
issues there you can post comments to to
the to the group I think we we kind of
just I'm sick of waiting for the JCP we
want feedback and Brian's coming out to
Australia the 22nd of October I'm going
to spend a week he and I going to do a
mind-meld and see if we can get to some
degree of agreement and then we're going
to basically try and wrap this thing up
yeah you don't have a holiday
no there's slightly it's slightly
different but it'll be going up yeah
well I didn't blow a bit like I didn't
realize that when you uploaded the deck
they were actually going to like display
those slides before you even gave the
talk because that was just a draft okay
expected implementations there's
ourselves this coherence we both think
we'll be out pretty quickly with rappers
in finnish banners well planning to do a
rapper to begin with we've got extreme
scale gemfire grid gain hopefully the
java memcache client for both Google App
Engine and spy memcache and then fujitsu
are already done with the draft what
what it basically looks like to use the
API tin maven central just java cache
cache API at 0.5 i guess you're probably
not supposed to i guess i'm not probably
not supposed to do this but it's there
everything to get started is on is on
the j so i 107 speculates let me just
show you real quick
if you just go to the JSA 107 spec
module we've got an extensive read me
and that's your starting point it's this
thing here so explains how to build it
also the other thing is that what I'd
like to encourage is you know a lot of
people like to create their own cases
because an in-process case is a pretty
simple feast what's kind of cool is that
you can if you use if you create your
own casing implementation if you have
your own casing implementation you can
adapt it adapter to implement JSA 107
and then we've it's just a little a
little set of mavin little little maven
command line here that you can actually
use to actually test your implementation
actually see if it's compliant so kind
of fun thing about that is that you can
start off with your own your own
implementation and you know there's kind
of interesting possibilities like let's
say you know you want to use Cassandra
fication or whatever you could build a
little API to Cassandra you can make
that jazz I want to seven compliant the
point is that you could then you could
basically then swap out swap out that
implementation for something else
through time if you actually I mean
that's the whole point of having a
standard but it should be really easy to
do that
okay what are the key concepts key
concepts is that you have a case manager
case manager is kind of like a container
for caches exactly what it is actually
will depend on the implementation that
you're using occasional manager has a
collection of cases a case has entries
an entry is made up of a key and a value
so it's basically key value store to key
value store with each each store being
really a named store and then a
collection of stores comprising a case
manager and what this looks like on the
ground say with terracotta is that
you'll have a terracotta server array
which will have a case manager in it
with all the cases and so that kind of
maps to physical resources and in our
implementation you'll have certain
configuration like where's the
Terracotta server and as a minimum
there's other things that you can set as
configuration of the case manager level
and then you have then you have
configuration for caches so that you
know two basic things say for a case is
obviously its name the capacity and if
you want a time to live do you want to
add any more comments on that Curren is
pretty much the same so the whole goal
is this we try to actually have some
overlap in configuration and all vendors
doesn't matter whether you even if using
JMS they all have slightly different
vendor specific optimizations and flags
it's the same with jdbc this this has
exactly the same so we try to bring
together the common stuff so for you
using coherence then similarly you'll
have to you know configure coherence
clustering or whatever the parameters
you want to use for that and then down
to individual caches as well and so it's
really based on the semantics yeah was
it stalled by value store by reference
sighs limiting and so on well what I
might do before we get into the API
features I was kind of thinking let's
just look at the simplest possible
example that you could do with this
thing so i actually created a little
demo this morning
because before we start talking about
all the advanced features I kind of want
to show you what the simple features are
right so i just created a new project in
IntelliJ you know just use the default
maven archetype yes you know so I've got
a project with you know j unit in it i
specify the case avi dependency which is
a which is up on maven and then you have
to have an implementation so as i said i
couldn't get the education JK Shin to
build this morning or to show you that
one but we've got the RI implementation
which is also up on maven central what's
that bad look that dirty look Krista to
contribute a man what can you do it's
open source now it has been updated to
the latest upper yeah yeah that's that's
the part that's not working what so yeah
well they're probably not implemented
correctly this is a contribution but
yeah yes so basically that's 30 API and
you need an implementation so in the
future they'll be implementations from
us and from all the vendors and just
specify it and then okay how do you use
this thing caching get cash manager
returns you a return to a cage manager
with the default name
Oh
yeah it's not control plus in intellij
you
very good
can you see that
okay how about that yeah right so you
need to get a case manager so caching
case manager will will look it will look
in the classpath and find grab you the
first case manager that it finds if
you've got if you've got you know if
you've got a more complex scenario with
multiple vendors and so and we deal with
that but just that this is super super
simple right you have a giant you have
you have a jar in your classpath loads
of cash manager we then declare a case
you notice that this is using generics
so you specify the type of key and the
type of value we're creating a case here
which is stored by value so in in
process cases it's possible if you think
of map when you put something in a map
it's stored by reference so if you've
got if you've got our if you've got
other references to to the values in a
map and you know you change it you know
you actually go and put something in a
map but you hang on to the reference
you're able to actually change the value
this this is actually how we education
process has always worked it makes it
really really fast because it's doing it
that way it does create the possibility
of side effects if you misuse the idiom
also if in fact it is you have a data
grid of a distributed cache anytime
anything goes over the wire or if it
goes outside a heap at all it obviously
can't be store by reference so for all
those reasons we've made the default the
default in 107 store by value so in fact
you don't really need to do that because
it's the default what you do is false
if it's by valued means to create a copy
it doesn't that's implementation
dependent right it'll it'll do it'll
it'll it'll know the reference of that
you are the reference that you are
hanging on to if you then change that
object white change the thing that's in
the cash that's that's the guarantee we
don't specify how you do that that's why
it's it's some yeah it's completely up
to the implementation how it goes about
that in fact everybody does different
things like coherence you're hearin so I
think you've got like puff is one of the
storage options isn't it there are
multiple different ways of serializing
and you can plug in your own sterilizer
so if you decide you want to use Google
protocol buffers you can plug that in so
it you know we don't then for we don't
force the vendors to implement how they
do the copy but everyone default
everyone can default I think to
serializable right yeah yeah so everyone
will do serializable if you haven't done
anything we've got I mean in in
terracotta we've got a similar feature
called copy and read copy on write that
you can specify the default strategy is
is serialization but you can plug your
own in no yeah and and the reason for
that is that we're trying to cover we're
trying to cover everything from simple
in process caching all the way to data
grits so we can't we can't require that
ya like like seriously this thing would
be a really good choice to use for that
little case that you actually write that
you're using in an in-house application
why because because you know because you
can substitute in another implementation
what what what I found in giving
previous talks is about 99% of people
have written their own cases at some
point stop doing so and you just got to
go in and change the code so that that's
what this thing's for
it's using the service slider mechanism
yep from Java the Yanis is sitting right
there can speak at length on the
intricacies of how it works so so we
then let's just so to use it we do we'll
do a case doc with key and value you'll
notice if I try and do this it won't
like it because it's generic so this is
not what the education does it's what we
will do though you then get things you
can and then remove so you know put get
remove and it works now I'll just show
you something what happens if you've got
no implementation in your classpath
no casing providers found in class bath
ok so that's the 101 what I'll do is
I'll post this up on my blog because
like this is the absolute simplest way
getting into it just grab the code and
then you can explore from there so now
we're going to talk a bit more about the
features how do you do caching and
validation so there's yeah so part of
the actual jsr has deals with eviction
so eviction about and you can specify
those through configuration how you want
to do that there are two styles we've
started discussing how to make it
pluggable so this is this is one of the
reasons why that we really encourage you
to go and look at the jsr look at the
spec look at the documentation look at
the examples look at look at the tests
we have there and go this bit is missing
or I'd like this feature or yeah because
we could everyone can tell us something
now and we're just going to be writing
but yes right yeah that and that's why I
think like what we will surprise you
about the spec is that of the things
that we've left out so so the idea is
that you should be able to change from
one implementation to another without
changing code other than your dependency
other than the jar if you're using our
API but what you will have to do is
you'll have to configure the new
implementation so in in fact like that
like invalidation invalidation that the
default way that you do it in cases is
to set an expiry I'll just I'll just
show you real quick what what the what
the very very few programmatic
configuration options are on a case
that no you you if you're using the
simple API you shouldn't need to change
any of those things you'll specify
whether it's store by reference our
store by value the default store by
value so if you start off store by value
there's no particular reason why
swapping out say swapping from education
to key hirons you would need to change
any code at all well if you get if
you're going to copy we have to
serialize there's like no other way we
have to serialize so even if you're
doing something simple and you want to
do copy like oh store by value means
copy how do you copy an object well we
could reflect on it and try and work it
out but then you know they're just
serialize so implements serializable and
we'll call that now depending which
vendor using they have different
mechanisms to serialization so if you're
doing sure so sure so and and just just
to let you know the cost of doing that
basically eliminates the need for actual
cash it so these are high so this is the
this is the case builder these are the
only things the only things that in the
spec we we provide by wave configuration
so there's a hell of a lot more on that
you actually need in a real life
situation why don't we why don't we add
add add them because the reason is that
these are the only ones that the spec
actually needs to function so we're only
adding those things that we need what we
think is going to happen although
whether you age coach want to be done is
that when you build a case you'll cast
it to our builder and then add the extra
properties at the extra methods if you
want to do it programmatically but the
way the way we are
slee configured as Viron are educated
xml so coach manager starts up it
creates two cases that are named that
way you simply do case get so if you're
doing things that way you should be able
to just swap out an implementation be
sure you know yeah further the best
chance of success make sure that the
objects implements serializable even
though it's not required if they don't
then as soon as you want to go move from
in process casing to to data grid you'll
you'll have issues and I think I think
that who I think eh casters does this
you can confirm but on the coherence you
don't actually have to implement
serializable you can there's a
externalized serializable so so you can
plug in a serializer that you can work
with anyone into a domain objects so you
can just have one implementation and if
you want you can make that use
reflection so this is one of the you
know when we're thinking about the API
when you do put we don't enforce the
value or the key to implement
serializable because it's totally
dependent on you right so bite out of
the box what we want to do is make it
really simple you should better grab
this thing and just use you know very
simple implementation and just start
working with it and then over time if
you've got certain serialization
requirements and you have your own
custom sterilizers and use a different
serialization format then we're late you
know plug in those bits now what we'll
do we only have another ten minutes
we'll just do a quick a very quick
run-through so the core features and
point some things out I'll update sorry
i'll upload this updated presentation up
to the website later this evening
probably from the airport so busy
running around all afternoon give it to
me all of it yeah okay I'll give it to
you just some key features and we have
read through caching and right through
caching and that's one of the things
that that you're asked to configure what
do we mean by read-through we mean that
you you ask the cash for something if it
doesn't have it
there's a there's a case loader that
will actually go and load that so
whether or not the case shoes read
through whether or not the case is right
through so you're right to the occasion
right behind something that work just to
be something that we're working on right
now is integration with a dupe there's
there's people that want to there's like
a use case we've got an endless amount
of data we just want the last 45 minutes
of that data in in terracotta big memory
we want everything else in HDFS we want
to use right behind so you know in this
example what you do is you basically
write everything to Jessa 107 and then
what the case Ryder underneath is doing
this time it's not now to be a mess it's
actually writing to do though that's the
thing don't just think about database
this is a generic technology they can be
used with anything the other one is case
event listeners so just a call back when
something gets put in the cache
statistics obviously there's generics
the other thing very very interestingly
is in trying to span everything from the
absolute simple world to the most
complex it turns out there's a breaking
point there's the simple people lose
interest at some point the people from
Wall Street are very demanding about
what they want you can't quite do it
with one spec so what we've done is
we've made optional features so the two
at the moment that are optional are
transactions so JTA transactions is what
I'm referring to which Brian thinks is a
bad idea to have in the spec but the
Wall Street people have to beat him up
I'll talk to them over financial
background thought I'll talk them down
like why are using transactions that's
like how you build financial apps just
doesn't make sense putting our product
manager made us put transactions in a
few years ago so kind of already done it
so we did in coherence as well I don't
know and in Finnish man just put
transactions in as well so you know I
will revisit that but but this is one
where there's a debate right so it's
optional so you can have before when I
was saying the tck you've got a you've
got a pass the tck to actually say
you're compliant
we you advertise what optional features
you implement your implementation so you
can say whether or not you implement
transactions you can say whether they
implement annotations if you do you got
to pass all the tests if you don't those
tests don't run almost almost out of
time so we actually imported a few of
these really what we might do what we
might do is is maybe just open it up to
questions so that we don't run out of
time in the back
okay so the question is what's the
impact of SSD from i'll give you the
terracotta perspective and then brian
can give you the coherence perspective
so so our latest ladders the education
release has got a new fast restorable
store the first restorable store is
designed to work with SSD it will also
work with rotational drives what and the
next release of terracotta coming out in
a few months will feature the same fast
restorable store now on the first result
will store when we start up the cash we
load data into ram so we can load at
about 1 gigabyte a second out of SSD so
our strategy with SSD is to just use it
as a faster form of persistence so we
have about a terabyte in RAM there's a
bit of larger supported size at the
moment so what we'll do is when we start
up the cash will just light everything
out of SSD which which to do at one
terabyte per second then that's some
sorry one gigabyte per second then
that's like a thousand seconds to
actually load up that terabyte so we
find that SSD is still much much slower
than ram and so our strategies
occasionally is just to use it as a form
of persistence and the other so SSDs
have very good read performance but
generally bad write performance so
although you think oh it's SSD well you
can't actually just right when you when
you're right to SSC the way it's written
is when you write a block if you want to
change one bite in that block you have
to raise the whole block and run it
again right so if you have a cache which
is being randomly accessed and you've
mapped that directly to SSD you're going
to run it a lot of problems so you guys
have done something similar to what
we've done with coherence we use SSD for
capacity and overflow but if you want to
run like long queries
you guys run Cruz as well so Reid is ok
but it's still nowhere nowhere near what
you can do a memory so it is increasing
the amount of performance but if you've
got lots of streaming events the last
thing you want to do is actually go
right through the stack down to SSD and
then back up I think there's a we're
aiming for a different performance level
so we're aiming for we're aiming for you
know depending on which store you hit
from less than a micro second up to tens
of microseconds that's that's that's the
performance that we're aiming for you
know you can't go anywhere near that
loading from SST right yeah yeah I mean
it you know the database you know there
hasn't kind of been a revolution in
databases that has obviated the need for
our business it seems to be coming well
but you know change the time one of the
things that yeah it'll be interesting to
see what happens over SSD we might we
might what we haven't done yet but what
we might do is actually have a specific
SSD tier I think maybe you guys did that
we haven't done that we just use it for
persistence we have we have
optimizations on the exalogic equipment
so you've seen them it's basically some
of the database equipment but it's got
huge volumes of actual RAM and huge
volumes of SSD got a question from the
back there
oh yeah I didn't answer your question
let me answer now okay what is the
difference between 107 and 347 so so 10
sevens occasion expect 347 is a datagrid
spec which which has as one of its
dependencies 107 so it aims to use our
API and extend on it so the jboss group
have been Pete and mostly Pete and some
extent manic have been very interested
in agreeing all these details with us on
107 then you know they're anxious for us
to finish so that they can build on top
at a conversation with a guy a couple of
weeks ago is like our how do we how do
we verify that our data grid
implementation also as an implementation
of 107 i just showed him that maven
thing you know do that so basically the
idea is to build on top the I guess 107
is is all is almost technically complete
347 is is very very early I think
Monica's monix no longer leading in
finnish band he said to me the other
night that he's got more that he's
actually going to now devote some time
to 347 kind of like he's handed off the
day to day an up level so he'll work on
347 but if you we have I mean there's
kind of a the 107 has got 20 expert
group members I think three four sevens
got two or three so it's you know it's a
very early spec the other thing is what
exact parts of the data grid do you want
to agree on there's a zillion things
that they do I mean one thing that we
all do in cases is search we all do it
you know but we're not actually putting
that in the spec why because it's
probably going to be quite hard to to
agree to agree on and it's like you know
the question would become you know
shouldn't us another jsr to find that
and not you and and there are there are
actually you know he's already work
going on in this space so particularly
if you start to do search you need to
you're probably going to have object
models involved in which case you know
things like top link eclipselink stuff
already have all of this and mapping
that not that is
you know you think of top link and the
ORM is no object relational mapping this
sort of object star mapping now because
they can map onto all sorts of their
MongoDB no SQL stuff yeah well hibernate
I gm's just come out in beta and where
where where provider for that so to your
point so it's like if if we're going to
really do something in search and data
grid then we probably should use
something that's pori there because the
last thing you want to do is like oh
let's mark up your object model but yet
another set of annotations Oh a long
sides of stuff you're probably doing to
go to a database soil so I think that
you know it's been I think it could be
it could be very very difficult to build
to bring 3472 to any sort of near time
end unless they seriously reduce the
scope right down
impress pricing yeah there's basically
in prose processing as well in here as
well yeah I don't know if we manage
knows but we we added it we added that
yeah we've actually added that into 107
so what's he got one thing in addition
and 347 the thing that we're not
interested in doing yeah hey he wasn't
quite sure what things he wanted
actually a year ago so it sounds like
he's made progress at least one minute
we've got one minute so one last
question yeah there is there's a bad day
they are there so they're the
annotations the spring group the spring
have got their own they're going to
actually also adopt these and these will
be theirs will be in EE 7 as well these
look remarkably similar to the sure is
there well
this is optional by the way so we
there's you know what can you can you do
me a huge favor can you post that
inquiry on to the mailing list because
we actually have a whole sub group we've
got Eric Dahlquist who kicked off this
whole Casey annotations thing he's on
our Ichi we've got a CDI guy we've got a
juice guy put your concern and let's get
some action on that I don't we're not
the answer is right now we're not
planning it because I don't think we
thought of your concern okay all right
thanks guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>