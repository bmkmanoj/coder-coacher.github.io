<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Oracle Cloud Infrastructure Instance Principals | Coder Coacher - Coaching Coders</title><meta content="Oracle Cloud Infrastructure Instance Principals - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Learning-Library/">Oracle Learning Library</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Oracle Cloud Infrastructure Instance Principals</b></h2><h5 class="post__date">2018-03-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/coVBTrKN9fs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">introduction to Oracle cloud
infrastructure instance principles in I
am running applications on the cloud
involves multiple functions
Oracle cloud infrastructure Identity and
Access Management I am let's you control
who has access to your cloud resources
you can access the iam service using the
console REST API command-line interface
CLI or SDKs basic configuration
information for example user credentials
and tenancy Oracle cloud ID or ocid are
required for the command line interface
CLI and the SDK is to work
hi I'm looking to automate the
distribution and rotation of credentials
to multiple instances can you recommend
a solution
sure there is a new capability in I am
called instance principles instances are
a new principle type in I am
this new feature removes the need to
configure user credentials or a
configuration file using instance
principles you can authorize an instance
to make API calls to the following
Oracle cloud infrastructure services
compute vcn block storage object storage
load balancer interesting can you tell
me more about instance principles
sure each compute instance has its own
identity and it authenticates using the
certificates that gets added to the
instance by instance principles
since these certificates are
automatically created assigned to
instances and rotated customers do not
need to distribute credentials to their
hosts and rotate them
dynamic groups allow you to group Oracle
cloud infrastructure compute instances
as principal actors similar to users in
user groups
what are dynamic groups
you can group instances in logical
groups called dynamic groups you can
then create policies to permit instances
in these groups to make API calls
against Oracle cloud infrastructure
services membership in the group is
determined by a set of matching rules
against Oracle cloud infrastructure
services
when you set up a dynamic group you also
define the rules for membership in the
group resources that match the rule
criteria are members of the dynamic
group matching rules have a specific
syntax you must follow any user who has
access to the instance who can ssh to
the instance automatically inherits the
privileges granted to the instance
before you grant permissions to an
instance using this procedure ensure
that you know who can access it
what are the steps to be followed to use
instance principles
here are the steps describing how to use
instance principles create a dynamic
group in the dynamic group definition
you provide the matching rules to
specify which instances you want to
allow to make API calls against services
create a policy granting permissions to
the dynamic group to access services in
your tenancy or compartment
build the script or application which
will run on the instance a developer in
your organization configures the
application built using the SDK to
authenticate using the instance
principles provider the developer
deploys the application and the SDKs to
all the instances that belong to the
dynamic group the deployed SDK makes
calls to Oracle cloud infrastructure
api's as allowed by the policy without
needing to configure API credentials
can you demonstrate the steps using an
example
sure we will walk through an example
where an instance runs a Python script
to read data from object storage
before that there are some prerequisites
that you must fulfill let's take a quick
look
to create a dynamic group you must be an
administrator on the OCI tenancy when
creating a dynamic group you must
provide a unique unchangeable name for
it the name must be unique across all
groups within your tenancy you can
provide a description too but that is
optional Oracle will assign a unique ID
called an Oracle cloud ID or OC ID for
the dynamic group once created
login to the Oracle cloud infrastructure
portal click identity and then click
dynamic groups
click create dynamic group
enter the following details name provide
a unique name for the group the name
must be unique across all groups in your
tenancy dynamic groups and user groups
you can't change this later description
provide a friendly description you can't
change this in the console but you can
change it using the API the next step is
to create matching rules for this you
can use the launch rule builder or use
the text box resources that meet the
rule criteria are members of the group
in this example let's use the rule
builder which makes it very easy to
define the matching rules for a dynamic
group and auto constructs the rule
choose the attributes that you want to
group instances on and add them to the
dynamic group
the rule builder will auto-populate the
matching rule textbox with the rule now
click the create dynamic group to create
the group
the dynamic groups in your tenancy is
displayed
next to give permissions for the
instances in the dynamic group to read
buckets from object storage you need to
write a policy
create a bucket in object storage the
code running on the instances part of
the dynamic group would be able to read
objects from this object storage bucket
based on the policy defined in the
previous step now upload an object in
the test bucket
next create an instance which is part of
the dynamic group we created above check
the matching rules and make sure the
instance fulfills these criteria
you
the instance is now created and should
be able to read the contents of the
object storage bucket test bucket based
on the policy set on the dynamic group
from the instance
install SDK on instances in the dynamic
group log into the instance and install
the Python SDK
the following Python script would list
out the available buckets and object
storage in the compartment where we
defined the dynamic group we will run
this on the instance the instance being
part of the dynamic group inherits the
policy defined on the dynamic group
after executing the Python script we get
the following output and it lists all
the buckets in the compartment the test
bucket we created can be seen in the
output the output also prints the
contents of the bucket
this way you can easily use instance
principles to read data from object
storage furthermore for each API call
made by an instance the audit service
logs the event recording the ocid of the
instance as the value of principle ID in
the event log
great I now have a clear idea about
authorizing instances to call services
in Oracle cloud infrastructure thanks
you're welcome
please go to the Oracle cloud
infrastructure portal to learn more be
sure to sign up for the free trial and
get started right away</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>