<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>SQL Analytics - Part 1.6 SQL for Reporting Examples | Coder Coacher - Coaching Coders</title><meta content="SQL Analytics - Part 1.6 SQL for Reporting Examples - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Learning-Library/">Oracle Learning Library</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>SQL Analytics - Part 1.6 SQL for Reporting Examples</b></h2><h5 class="post__date">2013-12-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/VmsVCRp94uE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to this next podcast in this
series on Oracle's in database sequel
analytics my name is Keith Laker and I
was seeing a principal prime manager the
data warehousing and big data and Oracle
in this podcast will look at some
examples of how to use or a course in
database sequel analytics to answer some
typical business questions our first
business question is determine who are
my salespeople in each of my sales
regions done so this question we need to
cite the salesperson region and sales
amount and one order the result set by
region we can use the sequel analytical
function rank to help us determine who
are our best salespeople the syntax for
the rank function is similar to the
previous examples that we reviewed in
earlier podcasts again here we're using
the over clause followed by the
partition by clause to group our data by
region and the order by clause to sort
the data by sales in descending order
and we've extended the final order by
clause so that we organize our result
sets within each region by rank as you
can see the result set is ordered by
region and then in descending order
sales people within each region with the
best performing sales person as the
first record in each region so in East
region Adams is my top performer and in
West region Donna is my top performer of
course we could reverse the ranking
process and see who are my worst sales
people in each region and to do that we
simply change the order by clause in our
run function to sort on sales in
ascending order
now let's extend our sequel statement to
use some reporting aggregates in this
case thumb using the over clause to
answer some additional business
questions comparing sales with regional
sales and total sales so here we're
computing the total sales for each
salesperson within their region and
that's why sales column the total sales
for each region that's why our sales
column and the total sales for all
region that's mighty sales column so as
you can see from the sequel results set
this contains multiple levels of
aggregation and this is all generated
from a simple single sequel statement
obviously at this point it's relatively
easy to extend analysis even further by
looking our contributions how much is
each person constantly using in terms of
regional sales and in relation to total
sales they're going back to our ranking
calculation let's add some additional
ranking functions and just to warn you
here please note that we modified our
original data set just for the purposes
of this particular example so going back
to our rank / claws again partition by
Regents regroup our sales people by
region and then sort in descending order
based on sales as you can see in the
East region we have a tie for third
place between Baker and Donna and what
this means is that Edward is allocated a
rank of five if you're expecting Edward
to be raped fourth then we can resolve
that particular issue by using the dense
rank function as shown here now Edward
is ranked fourth and not fifth and there
are probably instances where you will
need both types of ranks because of
specific business rules within your
organization
and this is why we provide two types of
rank functions now let's extend the
analysis step further by using what's
called the Kuhn dist function and this
computes the number of rows with a value
as specified in the order by clause in
this case greater than or equal to the
current value divided by the total
number of rows in this specific
partition this can be used to select or
create a Pareto type result set where
you extract the top eighty percent or
bottom twenty percent from your data or
conversely the top twenty percent or our
bottom eighty percent from your data so
how does this work for the first value
which is adam's with sales of 200 there
is one row with that value or higher for
the second row which is connor with the
value of 180 there are two rows with
that value or higher and so we move
through our data set for the third and
fourth rose when we have a value of 150
there are four rows with that value or
higher so each of these row count values
are divided by the total number of rows
in that partition and as you can see
from this modified set we've increased
East partition to have five rows so the
first row is 1 over 5 which is gives us
a Kim dist as shown in the last column
of 9.2 for Row 2 given that we have two
values that are equal to or greater than
the value shown of 180 retain 2/5 and we
get nine point four and four rows three
and four there are 4 raised with that
value or higher so we have 4 over 5
which is not point 8 and finally row 5
is 5 out of 5 equal to 1
so now let's change our data set and
switch from looking at sales people to
looking at products the next business
problem we're going to look at is how to
calculate the contribution of each
product in relation to total sales and
to do this we need to compute the total
sales for each product and then divide
those sales for each product by the
total sales for all products and there
is a sequel analytic function called
ratio to report that will actually do
this for us the highlighted code box
there shows this analytical function
ratio to reports and we're using the sum
of sales revenue for each product and
comparing it to the total for all
products which is why our over clause is
blank because we need to compute the
total sales so just to confirm the
details of the calculation we can see
that shoes contributes twenty-two
percent of total sales as to say 100 /
445 and socks contributes ten percent of
total sales
now let's consider a different business
problem how the sales compared versus
this month last year and to answer this
problem we're going to use what's called
a lag function and using the leg
function we're interested in sales and
we want to step back 12 time periods to
get to the last year which is why we
need to order the data by the time
column in this case time key and we'll
name this column sales last year the
final calculation is to calculate the
change in sales between the current time
period and the prior time period as
shown in the final column table sales
change and we can do that by just doing
a simple subtraction of sales minus
sales last year and renaming the column
as sales change so this example showed
it's very easy to create sophisticated
sequel using or opposing database sequel
analytics obviously there are lots of
different ways to answer these business
questions that we just looked at however
using sequel analytics offers some key
advantages over other methods the use of
sequel analytics can enhance the
capabilities of your existing tools by
embedding these features within views
you can make the result sets from sequel
analytics available to a very wide
audience for developers the use of
seeker analytics is going to help you
simplify your application code and it
offers investment protection because
these features and functions comply to
ANSI standards learning how to use the
sequel analytics features and functions
is minimized because they use a
consistent and C standard syntax most
importantly the Oracle database contains
specific optimizations for these
features to ensure the best performance
in fact
there really is simply no reason not to
use sequel analytics in your data
warehouse projects</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>