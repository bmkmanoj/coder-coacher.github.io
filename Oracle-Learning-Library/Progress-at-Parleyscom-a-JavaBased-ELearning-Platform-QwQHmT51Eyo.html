<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Progress at Parleys.com, a Java-Based E-Learning Platform | Coder Coacher - Coaching Coders</title><meta content="Progress at Parleys.com, a Java-Based E-Learning Platform - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Learning-Library/">Oracle Learning Library</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Progress at Parleys.com, a Java-Based E-Learning Platform</b></h2><h5 class="post__date">2013-01-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/QwQHmT51Eyo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Stefan Johnson and this is my
colleague yobo deckers i'm the founder
of JCS and a few other initiatives like
parlays and devoxx as you might probably
already heard of and also the Belgium
Java user group and probably because of
that I'm also a Java champion so and I'm
you for the gifts i met stephin a couple
years ago when we were working for the
same company and I recently I started my
own company a company to do some
freelance work and I'm also active in
the jug and devoxx and I'm now like
working actively with Stefan on parties
and some consulting for other companies
at the same time so what we're going to
talk about today we really wanted to
give you guys a view behind the scenes
of what we've been doing with parlays
for the past six years so we'll give you
a little bit of info about what is
parties for the people that don't know
it the past the current version and what
we're looking at doing in the future and
so the last part is really the most
interesting part because we're basically
redeveloping it every year so we've got
quite a few interesting things to share
with you with the new version so in a
nutshell be blue every I assume
everybody probably knows of bar lace is
it just raise your hands everybody use
it or yeah so people who haven't used it
I don't know it was started in 2006 and
it's basically an e-learning platform to
consume conference sessions so you can
actually watch the videos and sync with
the slides you can see demos and what's
also very nice is that you can actually
watch them online but also download the
talks offline so we did that for example
last year for Java one people were
downloading the talks on their iPads
they could watch it on their plane while
they were flying back and a lot of
people are using that in that way really
in a mobile way but you know if you're
sitting on the toilet and your boards
you can actually you know make it a
quality time moment on the restroom so
it's all about knowledge sharing and
because it's actually grown out of deaf
oxenby jerk it's very for the time being
it's very Java centric
we have a lot of Java conference talks
there what's also nice is that we
actually offer this as a service to
other Java user groups so i have about
close to 40 java newsgroups using this
as a way to content and share it with
their members or virtual members like
we're doing here as well so in total
1800 talks so it's really a lot I mean
really we have sessions on whatever also
in different languages so it's really
something nice that you can use for
yourself but also with your junior
developers if they want to get up speed
to certain technologies just give them a
few days a few talks and they will
really learn quite a lot and of course
we are open for other content so it's
not just Java we want to actually also
support other presentations it being
technical or non-technical so that's
definitely going to involve so what I
want to do is actually give you a bit of
an idea of how it started so the past
the different versions give you like the
pros and the cons and then really look
at more the technologies that go from
the client and the server what we are
using and where we had some problems and
issues so it's really that type of
presentation so I actually started well
before I did the confluence version I
actually sent DVDs of the conference of
Java polish to people but the dvds never
always reached the person because we
often have these interesting themes and
the mailman sometimes for these were
porn dvd so he actually kept it for him
right so people were complaining I'm not
getting my DVD and so that wasn't really
the best way to actually distribute
content so that's where I started this
this website which was basically based
on the confluence we came from atlassian
I more or less developed at in a few
weekends so it was really nice because
out-of-the-box conference reports
already content management you have
searched you have statistics you can add
comments and so on so in a very short
time span I actually had one version
that people could consume it Eva their
RSS feeds and I had to then customize a
bit the macro and actually create a
flash player for the video and that was
it was basically six rainy weekends in
Belgium and I had a virgin so
time-to-market wise was really nice I
really had a very rapid prototype that
people could use
and actually you know look at the
content and enjoy those dogs
unfortunately there were there were a
few challenges and opportunities link to
that I mean I was really pushing the
wiki to its limits i remember when i was
talking to Michael and Brooks the
founder of atlassian and that showed him
what I was doing with his product he was
going like man you're destroying my baby
you know I was misusing it basically for
what it should be used for but it worked
I mean it had some interesting aspect
but from a content management the wiki
isn't a real best structure 282 to use
that right so that wasn't so good and I
also needed software to do post
processing I mean to give you an idea a
one-hour talk six years ago took me
eight hours to post process and like do
the syncing with the slides and so on so
I felt like a priest I was like
spreading the words in a religious way
and but that wasn't really the best
productive prod so I really needed post
processing software so what we started
doing based on that was start playing
with different rich Internet application
technologies so very soon after we
actually developed a flex version we did
the javafx version we did a Google web
toolkit version we even did a
silverlight version and an iphone
version just to you know see what
actually it could bring and look at the
dynamics and look at the pros and cons I
mean we're IT people so it was more like
an R&amp;amp;D type of initiative as well to
actually evaluate the technology and it
was 2007 so everybody had to have an
ipad app an iphone app right so in 2008
i was involved in developing javafx
version back in the early days of
Farley's just as a prototype just to see
how far we could push his technology and
it was it was still pretty new but it
was promising but we had we had a few
problems with it and so it was a bit to
be too bleeding edge to her a lot of
rough edges the api's weren't stable the
the main issue was that we have we
already had a lot of content in in
certain video formats and it didn't
support all the video codecs that we
encoded her or stuff in from the past
years and yeah
the browser plugin it's it wasn't that
good at the time and they've improved in
a bit but still it's not where it should
be according to me and back then it was
only supported on Windows and we really
wanted to have like a cross paths from
experience for our users and it was kind
of resource heavy and because it was in
a different scripting and different
language scripting language no I des
were already supporting that and the
language still was evolving as well so
it wasn't the best experience from a
developer perspective although that the
language had some nice you some nice
features but unfortunately that one the
language didn't survive as some of you
might know so that was one of the
reasons why it's remained a prototype
and we started evaluating other
solutions as well so what you see on the
picture here was actually from the
keynote at javaone 2008 and and there we
actually showcase that the java fixed
version a lot of people said like what
so why didn't you release it I mean you
were showing this nice cake with candles
on it and this is basically the reason I
mean it only worked on windows so if we
would have released it we would have
done more harm to Java fix actually than
then good because it was really not
working on Linux there wasn't any
politics and but it was really really in
bad state on Mac which is today a
completely different story I'm pretty
excited about what I showed at the
keynote for our affection but we were
talking about the history right so we
also did an iPhone prototype friend of a
friend of ours did that these are some
screenshots from that and but we soon
realized that it was still in the early
days of the the app store and it was
just starting to come all together so we
realize a few things about developing
for mobile that well you have limited
screen space so it's not the ideal
format to do our type of application
where we have video and slides of a
speaker in the same screen so that was a
challenge and and also here we had the
same similar problem about the video
X and it didn't support flash video of
course and a very strange thing at the
time we didn't thought about it at all
is that we could only play video in full
screen and yeah but that just is not a
good fit for our model where we have a
slight end video so we couldn't do that
so we did first prototype is fouled back
22 just having audio and slides but we
found out that our users weren't so
happy about this and didn't like this
experience so in fact we just continued
this and we reverted to two podcasts
just to give people a mobile experience
so what we did basically from confluence
which was an HTML d HTML version we
actually migrated to a flex version
which was in during the keynote of Java
polish 2007 I basically announced the
Flex version and here you can already
see a bit of the composition you have
the video on the left you have the
synchronized slides on the right we have
this nice timeline where people could
add comments they could add tax and what
is more importantly you can actually
skip the boring parts right so you can
actually go directly to the meat of the
talk which is often the demos or really
you know the interesting stuff and you
can even swipe your mouse over the
chapter and actually see and bake
already the previews so that's where it
started so whether it's build on flex
forage for version free using the the
flash plugin very reliable I mean the
nice thing about flash even that we'd
there's a few people who really dislike
flash but from that perspective for us
you know it supports multi platform and
you don't really have to tweak it like
HTML we have to do right so it's it was
very nice distribution to the different
operating systems and browsers
relatively good performance I mean flash
also with the release of version 10 we
were able to even move the video to the
GPU so the GPU was doing all the arm
wrestling as a result your CPU was
really dropping considerably so you know
there were some nice evaluate evolutions
both from flash and flex and what's also
important for us we started with the
flash video correct so that was of
course supported by flash these days
basically migrating everything to em
back for which is becoming more or less
the standards they have a very good IDE
support and when integration for
designers was also there so that that I
mean it did work pretty well and that's
also the version that basically has
evolved over the years using the Flex
technology yes it's it was a good choice
back then to go for this technology
because today we are the current version
is still based on that technology stack
so that's yeah so it was quite nice
however we still didn't have a post
processing tool we still had no admin
tool we still needed tools for some kind
of API like a restful interface and
things like that so there was still
quite a thing quite a lot of features
missing that we had to focus on and like
for example a lot of people who don't
know this is that if you do a flex
version it needs to be searched friendly
so to be able to do that you actually
need to create a shadow to HTML version
so we had a full we already had a full
HTML version of the Flex client just so
google co actually index our code and
then you have some hidden valley some
javascript which redirects you them to
the flash version if you would actually
click on that link so there were quite a
few interesting techniques that you had
to do right so and to be able to do that
we we finally decided to to go with a
custom a custom server because we think
that the confluence wasn't cutting it
anymore for us so we started off with a
bunch of common technologies at the time
it was spraying security hibernates we
seen and so on and that worked really
pretty well for us but they're also
opened some other opportunities to add
some new features to the platform as
well so we added a rental space and so
for example like conferences like java
one or j focus they rent a space with us
and then you can put all their their
content on there and when you run the
space you can also have monetizing space
by having subscriptions to it so or so
it's pretty nice
and by developing the new server we can
we could also offer this feature to
download the talks for offline viewing
which is pretty nice if you have a long
a long commute every day so and next to
that next to these features we had our
API for post-processing and to create a
channel admit and basically this allowed
us to build the the player as it looks
right now today where you have more or
less what you saw in the initial screen
shot from 2007 but it's just more
evolved than and more slick and and some
added features like it downloads and so
on so another thing that we did of
course because our users were pushing us
each time when we present the new
versions like well can be customized it
so like last year for Java one they
wanted to have at least a bit of the
Java one look and feel so this is a you
know a view of how the Channel looks
from Java one so you have a bit of
customization but flex on that level is
a bit limited I mean you can do CSS but
you can't actually dynamically load CSS
so there are some limitations by
following the Flex version which will
come back to later but what you can see
is well you can search it it takes all
that data locally and then you can do
filters locally you can search it
locally it doesn't have to go back to
the server so it's a very very fast
response which is nice and we also then
included on the left top you can see
like the links through the google the
android app or the the iphone or sorry
ipad app and actually talking about the
ipad this is a screenshot of the ipad so
we had two versions we had one version
where we developed it in adobe air and
did a cross compilation to objective-c
but that wasn't really the most crispy
experience so we redeveloped that an
objective c which is the onesie that you
cannot find in the app store and it's
really nice it's so slick i mean i can't
really show you that on a screen show
but if you turn it the noting that the
transitions are I'm getting goosebumps
just thinking about it it's so nice
right so we're really hoping to do the
same thing for Android as well because
they're we're still using Adobe AIR on
on Android and but yeah we should just
do that natively but that's really nice
because you
on the right down error it downloads
that talk and then you can watch it on
the ipad if you're on the plane or the
train or in your bed i think the most
intellectual property or the biggest
investment that we've done was really
then starting to focus on a publisher
too I mean that's where we spend years
multiple years actually focusing on and
this is this is really awesome i mean
this is basically are you used final cut
pro in the beginning years I mean that's
an expensive product and we basically
redeveloped final cut pro but a
lightweight version like in our very
soft version just for us so you can see
we have like multiple tracks you can add
your videos you'd with your audios if
you want and so on you can import your
PDFs and then what we did is that we do
video recognition so we will be convert
a PDF s to images and we find the images
in the video stream so it will actually
automatically say okay here is this
slide here is this slide here is this
light so in the past it took eight hours
now it takes 15 minutes for a one-hour
talk but you do need to record it in a
professional way you do need to do need
to have the video of the screen and a
good way otherwise it won't match the
slide so you have to then do it manually
but the nice thing is this is an Adobe
AIR application so it runs on multiple
platforms we own the license so anybody
who wants to start publishing content on
our channel just downloads that and has
fun but we even do extraction of mp3's
we create small thumbnails and so on so
this is really the power horse that the
tool that makes the difference yeah so
so these are awesome features and our
users also love them and we gain a lot
of users and a lot of content from
different conferences and then soon we
we realized that our performance was
degrading it even took at some point
eight seconds to load our homepage and
two seconds to load our presentation
data so which is very unacceptable of
course and yeah we noticed some
increased activity by looking at
view counter so every presentation has a
number of you is number of downloads and
we saw that increasing but we weren't
really sure about how many users we had
because a counter is only on a specific
presentation we saw a little increase in
a network throughput but what really
struck us at some point with that are my
sequel database was working hard like
really really hard I don't know how it's
possible but on Linux apparently I
processes can take more than on the
percent CPU so yeah we were thinking
okay what what's the big issue here is
that ok since my sequel is working so
hard we should probably offload some
work from my sequel so that everything
can go faster so what you do you apply
caching right so how can you do that so
we had a two dependencies eh cash a
pretty standard of the first product and
since we were based on spring we had at
the spring caching annotations and
basically you just add cashable on or
you're all your remote service methods
even on your data minutes at some points
right and then you just add a few
triggers removes where you update your
data and all right yeah congratulations
or your server is fast in over one hour
time to get a beer Cheers so we're from
Belgium so we might be right but few
days later um something happened so of
course yeah our server was down on its
knees so every realize that wasn't the
best strategy so well it's a minor
discomfort i mean i have a few shell
script things that I can do so I just
did well it's dual chrome top unless we
start or gut you know every hour or
every day right I mean how many people
don't do that way but I don't know away
come on be honest right so this plenty
of people do that so yeah we just
restarted every day and let's go to pop
grab a beer man yeah yes so but and
Stefan likes likes you tweet a lot and
every time when he publishes new content
on parties he does that and yeah
unfortunately it happens again so Stefan
ass can't we just restore it just before
I tweet I said nah that's not really
accepted
yeah but I mean we're restarting a
server a day so that means we have a lot
of users I mean right if you don't have
users you don't get out of memory
exceptions so I mean that was a positive
problem to handle right so that's okay I
can live with that well but keep in mind
the first version was still running on
one single tomcat we didn't do any load
balancing no failover you know the
servers went down and we deployed it I
mean I couldn't go on holiday anymore
because I had to make sure that it was
just keep on running well it was really
very stress e are you also a small team
yeah so we basically have grown the solo
server setup I mean it was clear that
that wasn't the way to continue if I
ever wanted to have a social life you
know we had to adjust that so we got
actually I just said well let's get free
service now let's let's get three big
machines dual cpu quad-core lots of RAM
because yeah we were thinking of doing a
lot of cashing in memory of course and
this was basically the the new setup we
had to parlays one and four days to
which were basically master and slave
using an Apache load balancing and then
we had another machine for staging and
testing basically so that was a very
nice you know improvement good so that
was all nice and having these beefy
machines but yeah just having more
machines means that you have more
problems right so all of a sudden we
needed to solve clustering issues load
balancing issues even deployment issues
database replication issues and media
and asset replication issues so yeah we
were it we were expecting those in fact
so already we did a few a bit of
research and we came to a solution is
that ok let's from instead of tom cat
let's go to glass fish because they do
data clustering it's open source it's
free so that's that's a good fit for us
we wanted that we then needed to have
low balancing the load balancing as well
so we used we were already using apache
with mod proxy and it's just an easy
conflict to add balancer in front of
that
and what is really nice is that with
glassfish you have this nice admin tool
to make your deployments and in fact we
also we already had a Jenkins server to
do our continuous builds and Nexus
repository that holds our releases so it
was really nice that we could then
script it to once a release with done to
pick it up from Nexus and deploy it on
our production system so that was a nice
improvement that we did at that point at
that point in time so we set up my MySQL
in the master-slave setup also
relatively trivial and then yeah finally
it's still something we're struggling
with or what I'm not too happy about
this the way we're synchronizing our
assets or static files and the media
it's we are seeing them basically over
ssh so okay yeah we realized well it's
it's we thought that was that was it
right but we were we were only realizing
that we were only scratching the surface
there so it was running fine for a while
and then at some point I received a text
message from Stephan saying well I got
this this jug leader that has a strange
thing he published the talk but
sometimes it's visible sometimes it's
not so we start to see inconsistencies
between between our two servers so and
then I went to investigate and I said
well and the database everything is fine
but apparently the data that's returned
from a service depending on which server
was not the same so we said well maybe
we missed one of those slick new eh
Cashin and spring annotation so we went
on a welt wild-goose so it's true decode
and we spent a lot of time there but in
fact the code was fine and and then it
struck us like okay we have two
instances but they each have their own
instance in instance memory right so
it's it's logic that's they are
disconnected so it was a little bit
harder to do than we expected initially
to yeah I just get three servers and I
or likely imagery here so we then
started thinking back and said well why
would you need to use caching in the
first place
real core problem here so and then I'm
sad case but there's this high mysql
load and then we turn on the queries and
we saw okay that's that's interesting so
we were using a hibernate but hibernate
by default thus lazy loading but once
you turn it in once you use it in jp-a
mode hibernate all of a sudden defaults
to eager loading which means it's doing
a lot more queries than you would expect
and there's also the typical and +1
select problem that was that was all
over the place in in our code so yeah at
that point at that point in time or
server was on its knees so you want to
solve your problems as soon as possible
to get your users up and running so we
said well let's strip out hibernate in
GPA that's that was not really not
really an option at that point in time
and yeah you could you could change your
annotations to do then lazy loading but
since all your code depends on that all
of a sudden means you would get a bunch
of lazy initialization exceptions and if
you don't have a lot of functional test
cases to test all these different things
it's really tricky to just flip the
switch there so eventually we sought for
us we were looking for a solution and we
ended up by by clustering our cash and
this is where our good friends from
Terra Cotta helped but it was funny
because we organized the Java user group
event where Terra Cotta was actually
invited as a speaker and then we got
inspired said well yeah ok let's try
then we had a few friends working at
terra cotta like Alex knobs and so on so
they were very eager to help us so we
got a free open-source edition so we
have like a one hot master tc Server and
one hot spare on the other so p1 machine
1 and p 2 and it says so a lot of people
don't know that there is actually a free
free to use open source version of
terror color so you can use it the only
limitation is that you can only have one
master server and but in a failover the
scenario and it's really very simple to
integrate I mean of course EJ caches is
linked to that ok sure there's still its
potential out of memory exception but
nevertheless you know adding that you
know more or less in one year in one
hour and you know ready for bear so
that was a very positive experience
actually and we're still using that so I
tweeted that because I was really eager
oh yeah we got this really fast caching
a solution out to eat and then so
apparently our server got got more
performant by having a bit more memory
and we're apparently Morgan we can
handle more concurrent connections and
all of a sudden we bumped upon this
optimistic locking exception so that's a
this nice feature that you get in JP is
that you can be conversion your end at
least right so in typical crook crud
style applications you do that so that
when people work on the same data that
they at least get an exception when they
know that somebody in the meantime
touched that that entity but in our case
since you're also logging the the number
of views and downloads on our
presentations the problem is that all of
a sudden all these different users that
go to the same talk when Stefan tweets
and you link that the thing is
constantly trying to update it and it
feels horribly so that was interesting
to to define out that we made a little
mistake there by including the diffuse
in the downloads there so yeah we softer
the the consistent caching issue but
constantly incrementing the view counts
was a problem so another thing that you
get there is we had a triggers remove
each so each time when you update your
your data you need the triggers remove
to remove something from the cash so
that gets updated and refreshed the next
time somebody fetches out data but since
people were constantly viewing talks
what you get is it you get constantly
invalidation of your cash basically
meaning that you're not catching at all
so that's really something that you need
to watch out for so since you are
already so happy with with terracotta
and the caching we decided to like store
or our counters in the cash in a
dedicated cash and basically we still
have them on our presentation objects
but instead of like constantly updating
them there we update we store them in
the cache and when the user when we do a
request we read from the database and we
read from the cache and combine the two
and basically only asynchronously every
15 minutes right the the stuff back to
disk and there's one thing you need to
know when you're starting to work with
each cache is that even when it's
replicated it's only doing that through
object serialization so if you take an
object out of your cash and your modify
it it doesn't mean it automatically gets
replicated to the other notes you need
to do to put it back in the cache and
that's we found out that also a hard
rates so you would think we're almost
there right so we still had one on one
guy on on on our list so we did
hibernate search and its really neat it
into it integrates pretty tightly with
with hibernates you just annotate a few
fields that you want indexed and works
pretty well although we're here again we
had a similar issue to our caching that
the leucine behind has a file store user
the file storage for its index basically
meaning that when something's changing
on an individual notes the indexes get
only updated on these individual notes
so the only solution there with what
they offer is that you need to use a
combination of TMS and our sink so okay
JMS that's fine so glassfish comes with
one although you you need to be careful
kiss initially we realize that yeah when
you set up JMS inside of glassfish what
you get is a cube per node and not a
shared q between all of your bit in
between all the notes in your cluster so
we still use the GMS that comes with
glassfish but we use it in an external
process and target both instances to
this individual cube so the way 10 works
is that is that in the middle you have
your master hibernate search note which
which updates the index and when it
updates to the database if it triggers
that triggers the index
but when his slaves updated data what
happens is that instead of updating the
index they send a message to the queue
that the master picks up and this one
will update its index and the indexes
gets replicated to the other nodes
through some scheduled arcing jobs so
that's the way that works so yeah we had
a bad piece of mind we were able to then
actually introduce all these different
instances on the cluster on the
hibernate search there's a hibernate
search book think it was from Emanuel
Bernard which actually there's a small
chapter explaining that so you can find
more information about that so we had
still you know had many different
components that we want to also trace I
mean we have films for example
self-healing scripts which were like
talking to glassfish checking you know
what the hell was and so on so we could
actually output males to us seeing you
know what was going wrong or was what's
going on we had backup in place to
actually replicate our data so if we
talk you know the server would crash
that we at least have you know backups
of those folks from our customers so it
was you know becoming a rather
interesting setup and as you know we're
IT people we're not really DevOps
infrastructure people so that would
really be now if we ever hire an extra
person that would be really a DevOps
person because it becomes also an
infrastructure cha-cha good challenge
and so they actually orchid invited me
last year to do a bit about what are our
experience was of glassfish and one of
the problems there is that we didn't
really have any view of what was going
on behind the scenes like no real
monitoring and so luckily after that
talk somebody approaches thus and guys
from ASL have a product called RT view
and they were so generous to actually
allow us to use it which was really nice
because this act actually a view of our
infrastructure it actually shows you how
many sessions you have how much memory
you using and said it's not a free
product so watch out and actually have a
goof as well and they didn't even pay us
to tell us that but we're happy user I
mean at least it gave us a few of what
was going on in our
them on the different of the different
instances an addition to that you'd need
to remember we were still using flex and
a net so we actually have to find ways
to also get hooks to Google Analytics so
in an ActionScript there are actually
small libraries that you can use to feed
google analytics so you can actually see
who's actually hitting your website and
then now also with the real-time view we
can actually see real time how many
people are watching dogs and even which
talks they are watching so that
combination with rt view and Google
Analytics you know gave us also a bit
better view of what was going on but
however there were still quite a few
unresolved issues definitely every year
we rethink and we see like okay what's
going to be the next version I mean one
of the things that's still hurting is
for example the down time when we deploy
something if we deploy a new war file
and you know it's going to go down for a
few minutes and okay you can start
playing with but is it the proxy and
maybe you know say like well take that
one out the part of the equation and
then wait till all the sessions have
disappeared and then deploy it but still
it's not really something you would
expect that it's like really fluent and
we don't have the budget to like buy a
project license so luckily the guys from
certainly a French company are actually
working on the automatic updates not
without any doubts down time but that's
going to be glassfish version for ya and
what we also would like to get to to do
for the future is set up a state whole
system because right now okay we do this
we a stateless system so it's one of our
issues at stake full right now is that
the problem there is that right now we
we know that we have beefier machines we
have we have more memory but we know
that our approach on the back end with
all the problems with the database is
not solved we just worked around it and
we know that at some point it won't
scale anymore so we are looking into
solutions for that in the future so if
it's fully stateless you don't even need
a cluster you just have as many
instances as you want I mean it doesn't
have to be glass with you if you want
jboss instances glass which I whatever
we could have just beautiful different
scale really horizontally
but for that we need to remove the state
out of the current implementation
another issue is that not an issue but
it's a side effect we used spring right
but the problem with spring is there
that you if you create a war file you
get a 50 megabyte war file because they
include all those all those dependencies
so that was also our next target is that
well let's maybe look at just pure java
ee 6 specs and reduce the 50 megabyte or
maybe a one megabyte war file which will
allow us to really rapidly deploy as
well and we run java ee right we're on
glassfish there myself makes sense to do
that data storage not are definitely
unresolved issue like I said the
infrastructure how do you replicate data
like also people who are streaming data
in San Francisco our servers are located
in the UK so there's sometimes a bit of
lag so it would be nice to like with
Amazon does that it can work with
different regions and you can actually
get the data closer to where the people
are viewing it from and also with it now
we have like three servers but imagine
in the future we go to the cloud and
want to dynamically add more systems and
this becomes a constant issue right you
need to have the data available on on
all those machines in a performant way
so so another opportunity was the jba
eager loading we need to actually solve
that one we need more statistics but I'm
not a very important one the future of
flash and / flex and there's a lot of
people who hate flashes well I really
get some every once in a while I get
tweets like man you're losing flash you
know and okay it worked up to now but
you know it's there's clearly a an issue
there but also not only that Adobe
stopped supporting adobe air on Linux
right and we want to be cross-platform
of course and this is this is not really
an issue but Moor an opportunity for the
future is that within our application we
haven't even looked at at expanding to
the social networks and see what people
are doing there like if jet is
interested in a talk but I might be
interested in the same talk so with
their there's a lot of things we can we
can still do there and with our current
or current architecture and our and the
technology that we have it will be
harder to to integrate that and
ham all the machine learning and the big
data stuff that we can't do it I mean
things don't think about Spotify you
probably know that right where you can
see your friends listening to what I
mean we can do the same thing for
parlays where you can see what talks
your friends are looking at and so on
but from an educational perspective not
from a musical perspective so there's
there's quite a finger quite a few
things that you know we looked at and
then basically last year we said okay
let's do a sanity check then it's a
reflection and let's look at the future
what should we do and that's where we
first of all I thought a good thing to
start was to maybe start with a new logo
so we got our new logo we got our
priorities right right so we got our
logo having made t-shirts yeah and we
made six t-shirt for one one for every
day here right and so we were on a
mission for our top secrets new project
right and we're a bit like Oracle or sun
in the days where we are event-driven
right so our deadline is devoxx which is
in November so basically what we're
going to do is is release a new version
our top secret new version in six weeks
time in Antwerp but nevertheless because
we don't tweet this but we are in a
small group here we can be a bit more
intimate with you and we will actually
share you a few sequence ok but don't
tweet right so what do we have in our in
my the pipeline so we're completely
rebooting parlays of coming in fact you
got a new logo and you're styling it
used to be a big self-contained flex
application what we what we really want
to do now is make me the platform or
accessible make it look more like a
website with all these content that's
easy searchable and available for
everybody and and really make a platform
that we would like to use ourselves and
okay we use parlays but it there's still
something that we can improve dare we we
were not blind for that so an done
definitely consider the scalability
constrain upfront and also for ourselves
make make it a lightweight system either
to develop and like limit the
dependencies to deploy it and make it
easier on our app servers and to scale
up so and the point is then to build a
architecture and our tools around this
and and the part I really like because
I'm I'm more oriented towards
client-side development or I have been
in the past and also always been
interesting the client is that right now
we're we're moving to html5 and css3 and
JavaScript and you know JavaScript used
to be like this is this ugly thing that
note that I doubt yeah that the java
developer didn't want to touch and then
you had all these other tools like like
Google web toolkit where they were
trying to hide javascript but it's not
so bad anymore to nowadays there it's
it's still a quite a nice language and
we're now applying all these these tools
to build our client and that's it's it's
proven to be a very very good set of
things of course there's a lot of stuff
out there and it takes a while before
you can assemble a nice set of libraries
and tools there but once you get it you
you really start to enjoy the
environment you're working in from a
client side perspective of course it's
amazing what an ecosystem you have in
that world I mean if you just look at it
I mean there's so many different
JavaScript libraries and it was I saw
those guys because I do the server side
they do the clients I do you have
another colleague in Berlin been if
you're listening been there hello but I
am they will had a challenge just gluing
also all of these different fame works
together and make me want cohesive yeah
what is all is also keen or our thing in
our setup was like the Twitter bootstrap
the the responsive CSS design that they
have their or our website doesn't look
at all like Twitter but the components
that are in there really make it very
easy to go to create an interface that
that responsive with so that means that
we have the same layout and depending on
the size of your screen or your device
it will adapt and you can watch the same
content on your tablet on your desktop
by using exactly the same HTML and CSS
and that's pretty cool um and yeah go on
sorry well it's also very nice again so
in the past we had different versions we
have to really be were really doing
polyglot development
in objective-c we have to Android you
have to do flex air and so on now what
we really want to do is just focus on
one technology stack and that should
basically spread over you know the
different devices and different channels
so it's looking very promising and like
I said if you made another six weeks
we're going to release a better version
there and you can just play with it and
it's it's really awesome again getting
goose bumps here all the way of my arm
it's really nice so that's the client
side we're going to be sticking around
after this so you have some questions
feel free to shoot because there's a
bill testing stuff yeah I'm still have
some time no but it will sink yeah but
what's also nice here is that even
coming from a Java world you can just
integrate it with your Jenkins built and
you have build tools to to compact
everything and compile everything to
make it fast and streamlined and you
have unit testing and and and like what
school there is that you also have
phantom jess with is just a headless
WebKit browsers that runs all these
tests so he can run it on your app on
your continuous integration server
that's that's pretty cool that you have
still you have this this nice
comfortable environment that you know
from the Java server site and that you
can have it right here so that's the
client side control-alt-delete basically
on the server side we did the same thing
control-alt-delete see so I mean I'm a
strong believer of if you go stateless I
mean jax-rs is a very nice way to go so
I mean I'm really into Jack service I
really love it and I mean there there
are a few improvements that can be made
which is one of my next slide if you
want to go fast on on database and you
don't want to have the JPA an eager
loading and so on then yeah Mongo Mongo
DB is really two way to go so that's
what we did I mean you'll build a groovy
migration project so we can migrate our
MySQL into Mongo and they are we then
using also the Jackson Mongo mapper so
we can just have Java representation or
choco photos of your Mongo documents and
then and this is one if you if you go
out of this room this is an interest 1
i'm actually using swagger so anybody
knows yeah because I told you
right okay so nobody but so I've got a
few sites seriously that's a really nice
and that's something I want to see in
the jacks or respect which I'm push
with the speculator and I'll show you a
bit of examples of that they run and
then I was also looking like okay I
hibernate search really nice but for
Mongo that doesn't really fit so we
actually looked at the Chez bannon's new
baby called elasticsearch which is
basically a restful layer on top of
leucine supporting a Mongo stream
indexing and then we re actually using
the JSON client to access the elastic
search response or more or more we wrote
a JSON client foreigners true because
they have a Java API but if you do that
they include another 20 megabytes in the
war file if you're actually are
dependent on that stuff and we didn't
want that we really want to have a very
small war file make it as as as tiny as
possible we will still use MySQL in jp-a
but more for the transactional parts so
Mungo is war for the read-only and I'm a
lot of people use Mongo even for caching
so it's really very fast unbelievable
fast I mean even our prototype is named
Greyhound because that's a fast dog and
it is fast is unbelievable but for the
transactional like the payments the
subscription that's one you still need
transactions so that's where we gonna
still use MySQL and JPA too but then no
no separate instance just for that type
of service yeah like use the right tool
for the job right yeah exactly and then
of course glassfish free or but again
that could be any java ee container and
we were going to play definitely with
different containers there as well just
to see how they behave etc but coming
back to swagger this is how you actually
do it I don't know if you can read it
more or less but this is like a
standards resource at jax-rs resource
for tags for example let me highlight
the ones that you need to do so on the
top one watch what swagger does it added
it adds extra new annotations and these
annotations think about you remember the
days of Java doc right well these are
basically annotations javadoc
annotations for your restful data so you
document your your class and give it a
name you give it the value of how you
can reach it and then / methods as you
can see here you can actually document
your operations
and also the errors that it can actually
produce and the same thing for the
parameter so you can say like okay this
parameter is required this is the name
maybe it's a it's a combo box so you can
even give the different values and so
you add that to all your resources okay
but becomes a bit more verbose but the
nice thing about this is that because
I'm doing the server side and these guys
are doing the client side in a different
city in a different country right we
need to have some kind of design by
contract so our design by complex is
this swagger then actually based on this
annotation produces these nice websites
on the fly that these guys can then
actually see our there's a new method
and it does this and they can click on
it and actually even test it in that
HTML client and then say okay well
that's URL okay I'll take it over and
they put it in their JavaScript nice it
you like it so we should have that in
jax-rs 2.1 or maybe no 2.0 won't be
won't fly anymore but it would really be
nice if they could standardize that so
other people can build tooling around
that so I'm really very excited
especially if you have a public API
that's definitely something you need
because if you write a lot of
documentation about your API to get
outdated right so this is really
something to you mean it's close to the
code so yeah it won't get updated
there's a lot of people here and I did
that before as well i did a wiki and
then i documented but the wiki gets out
of date so rapidly so this is a nice
nice one so we told you about longer
they be right but what most people know
is that it's just extremely fast and
it's it's just different from from
relational database but what you need to
know is that it's actually documents and
for some people it's not entirely clear
what that means is so essentially we
have we used to have in our old system a
presentation and then a speaker and then
another table with assets and then files
link to those assets a bunch of
different tables were right now all this
data is centralized in a document of
presentation document that contains
everything which makes it really fast
for us kiss if somebody goes to see a
talk you just fetch one record and you
immediately have everything right you
don't need to join so a bunch of
bunch of tables turn and what people
maybe don't know is that although you
don't have transactions you can do
consistent increments of counters for
example like like or counters for a fuse
and our boats and that stuff you can do
that in MongoDB so it's good to know
that but there are some things to learn
as well as that you need to learn to
structure your data in a way that it's
it's going to be consumed don't think
about the way it's it's it's organized
like in your object graph or the way it
used to be in your relational database
you really need to think about how will
you consume this data because especially
organized yeah do you normalize because
we are we're reading a lot but we had we
only write the presentation gets edits
only a few times per month but documents
presentations get read thousands of
times per second so that's what you want
to optimize for but the downside is that
you get yet another dsl and SQL is is
actually quite a good dsl and the one
that's in in mongoid yeah I don't like
it that much but you know comes with the
tool and what's really nice is like
yourself on side you have the mapper for
for Jackson and there's one thing that
that was a bit unfortunate is that you
can do lookups in in MongoDB but you can
do full text search which is a problem
for us case we have a search based on
the description of a talk and stuff and
so you can't do that with a MongoDB can
only look of specific values of
properties in your documents so we had
to find a solution and we already gave
away the answer so that's elasticsearch
and like Stefan said a restful api
around leucine under the covers but that
also does the replication and that stuff
that you don't get out of the box from
know all you seem so that's pretty nice
and the one thing about elasticsearch is
that they don't officially support
MongoDB but there is a community efforts
that but basically they have a plug-in
that will read the MongoDB replication
log so the journaling that they sent
through the different notes and it reads
that data and then index
into the into loosing so enough stuff
and said they have a flu in Java API
that's that's really nice to get to know
it it to learn than to write your
queries but if you value the size of
your deployments don't use it because
they it currently it's just the full
elasticsearch distribution that you're
including in your web app which you
don't need right so use the rest api for
now and the good thing is that it's it's
extremely fast so and this brings us to
our last slide which is questions and
answers so we will be happy to share any
secrets well not all secrets but yeah
yeah yeah yeah they did and the answer
was bado and jason home those are the
current you know solutions that you
could have as an alternative for swagger
so so what swagger does it it basically
generates an xml that's this this web
web UI this is swagger you I so if you
have a swagger server-side component and
then the swagger UI which is the HTML
javascript stuff that just consumes this
XML and then builds the nice UI with all
the things yeah yeah no unfortunately
you just get the classic building type
like strings and integers in that stuff
and it shows also a project still in
flux like for example the post they
don't support so we don't get a proper
forum where you can enter the data they
don't do that yet but that again if they
standardized that and you know there's
going to be hopefully a whole ecosystem
allowed to that's not entirely true you
can you can get a forum as long as you
get requests but not you cannot to
oppose a reporter yeah to the folks you
know but if you have like this rest this
get call with a bunch of parameters and
you can just go to that and it gives you
built you a nice poem to to play with
that the other questions
so when we released like like yesterday
we said all the talks of devoxx 2011 are
now freely available we reach between
1000 and 2000 concurrent users basically
that's a bit of the statistics that we
get also out of the tools so we can see
the number of sessions that are open
there and we haven't really gone into
lower detail where you can see how many
requests per seconds but we're looking
more at the number of sessions because
each section represents on memory etc
but it's we peaked like last year when
we announced the Java one talks he also
had was very similar rounded two
thousand concurrent users and the nature
of our of our application is that you
fetch the presentation data is basically
get all the details of the talk and all
the files that are associated so the
slides and and all that stuff and the
video streaming files but once the
client has that it's just streaming the
stuff it already fetches that's the this
the static files are just fetched true
oh yeah that's maybe not clear but so we
have the application logic then we have
different streaming servers and then we
have different asset servers so we have
really spread it over three types of
yeah container so so what Stefan says
two thousand concurrent users that to
town concurrent users on glassfish it's
not exactly the the total number of
requests because you also have the
streaming and the static files yes well
we know that a lot of people in China
it's not blocked in China youtube is
blocked for lace is not and there there
have users and and if they do have
issues in lagging they just download the
talk so we have a lot of people in
Africa for example who they download the
talk overnight and then in the morning
they can share those talks with their
friends so so that helped a lot as well
so that's always a fallback I mean
there's also like add offices where they
have a very restrictive firewall well
again HTTP download works there so they
can do that as a plan be
yes definitely we definitely like Amazon
does with cloud front way they work with
regions that's definitely oh or like
Akamai but again we don't have with this
is like a break-even effort right so we
still need to create some kind of
dynamics also financially and see if we
can it be like because Akamai would be
the perfect solution but then it would
break our model we couldn't really
afford it we're already currently
supported right yeah we support me
support card front we already did tests
but the problem was that girlfriend is
more expensive than having your own
servers because we streamed terabytes
and terabytes of data I mean I really
need to talk to these guys who have porn
sites and let them know like where do
they host it like I need to get some
good deals there because if you do with
the official Enterprise way it's so
expensive so that's a challenge for sure
there was the question you know yeah
yeah so we're using we're based on
Twitter bootstrap which is a CSS
framework and yeah basically it comes
with that framework so you use a certain
CSS classes and constructing in your
HTML and it it basically what it what it
does then is your what rot your browser
does is it inspected the size of your
browsing window and depending on that it
will realign objects and for example we
have we have video and slides next to
each other but if for example you're on
an iPad and you turn it in in portrait
mode it will detect that okay I don't
have that much wit anymore long enough
screen space so I will position the
video in the slides underneath each
other and stuff like that and that's
that stuff that comes out of the box
when you you pace yourself on Twitter
bootstrap it's really something to look
at them and and it's not only that
because they also have a very nice set
of components and already some some
plugins so it's if you start a new
product it is is a good idea to start
from
that and start restyling their style
sheet to make it fit with your corporate
design but it's really a head started to
get by applying that yeah can really
recommend it any other questions
donations now well thanks for coming
hopefully you can use a session</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>