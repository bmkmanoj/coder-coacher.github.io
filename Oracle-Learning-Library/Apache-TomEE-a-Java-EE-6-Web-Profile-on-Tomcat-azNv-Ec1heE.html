<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Apache TomEE, a Java EE 6 Web Profile on Tomcat | Coder Coacher - Coaching Coders</title><meta content="Apache TomEE, a Java EE 6 Web Profile on Tomcat - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Learning-Library/">Oracle Learning Library</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Apache TomEE, a Java EE 6 Web Profile on Tomcat</b></h2><h5 class="post__date">2013-01-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/azNv-Ec1heE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I'm dedicating my slide layer of my
presentation later on today to Karthik I
will be mentioning him if you come
you'll see it okay so after you know big
build-up always makes jokes funny so
here we go super continuous cloud
elastic dev ops ii agile dosis that was
a little play on disney i figured if i
can get a wall in one slide and i don't
have to worry about for the rest of the
threat of presentation so I've filled my
buzz word quota for the for the for the
hour and if you want this might make a
fun drinking game if you have a death
wish because their view those words of
you set a lot this week ok buzzword
quarter reached you may now proceed
alright so what is Apache Tommy well the
short answer is it's tom cat we take tom
cat we unzip it we add some jars I'll
show you exactly what we do when we make
Tommy to try and dispel any you know not
knowing what's going on under the cover
is kind of kind of thing its web profile
certified it's Java EE 6 web profile
certified it's using all apache parts so
in Tommy we take Tomcat we add open jpa
open web beans which is a CDI
implementation we add open ejb my faces
and then another distribution of Tommy
we add CX f and apache activemq and the
thing that drives a project in terms of
you know design what we you know when we
make decisions and how we do things
technically we always gravitate towards
these three things which is be small so
don't you know we don't want another
large apps wherever we want a small one
be certified so in the end we can't
choose not to if the spec says we gotta
do it one way we have to do it that way
by default we can provide other options
but we always have to be certified and
then be tomcat so if we have ruined any
part of tom cat so you don't feel like
you're using tomcat anymore and we've
complete
so I urge all of you if you try out
Tommy and you find something that all
this is better in tomcat or we somehow
managed to do something to mess up Tom
KITT we're going to fix it so please let
us know and you know that's you know
it's a critical part of what we're
trying to do Yeah right I'll show you
those in a moment yeah so what is a web
profile that kind of leads into that
question real well so web profile is
something that was created in java ee 6
and it was to address specifically the
concern that ja ve had become too large
there's a lot of tech I mean you know
Java is over 10 years old there's a lot
of things in there that you have to have
for compliance reasons you can't yank
out major parts that people might be
using just because they're old so you
have to keep things in there like
jax-rpc which is I mean if any of you
had to work with jax-rpc I you know my
condolences that was not very good and
you know korba I mean still used by some
people but if you were to design a
consistent completely from scratch you
wouldn't go hey let's use korba you know
it's it's there for backwards for legacy
reasons and you know cmp entity beans
this is the precursor to jpa but you
don't use those if you can avoid it and
you know yeah so these are all things
that are in the full profile for example
that add a significant amount of weight
to those installs that are not in the
web profile so the web profile is
basically half of the full profile it's
the full profiles about 24
specifications around that and the web
profiles about 12 so when we created the
web profile and you know I've been
helping out in the Java EE
specifications since ye 6 and I've been
helping out with the ejb specification
since ejb3 so i've been working in that
space a long time you know not just
implementing you
servers but to help you know define the
specifications and when we created the
web profile was sort of like manifest
destiny someone had to certify tomcat
eventually because it was sort of made
to do that made to have these small
footprints but it's also missing some
really good things so in the web profile
is not jax-rs that will be in the web
profile at java ee 7 but in java ee 6
jax-rs is not in the web profile jax-ws
that is not in a web profile either in
Java EE 6 or job e 7 it's going to stay
in the full profile and JMS that's a
really core popular one that's not in
the web profile that's outside web
profile so to lead in the question you
know there are a couple flavors of Tommy
yet right and that's primarily for
certification legal reasons and it does
make things easier you know in terms of
giving people smaller footprint servers
so we have a the web profile certified
version of Tommy and that includes the
standard technologies JP a CDI ejb jsf
bean validation and java mail which is
actually not a web profile but we add
that to our web profile server because
it's no 500k it's very small and it's
very useful so that's in a certified
version of Tommy we just now released
today Tommy 1.5 we jumped up the numbers
because we did a lot of development
between the one point oh and that
includes everything that's in Tommy web
profile plus jax-rs and it's a
stripped-down version of CX f because
the patch ECX f is rather large it's
like four megabytes or something so with
Tommy jax-rs it's another distribution
that conclude that includes the entire
web profile plus jax-rs and that's also
certified and then Tommy plus includes
everything within the first two stacks
plus jax-ws the connector architecture
and JMS and that one is not certified
because you have to certification works
like this if you include five
technologies all five of them have to
pass and if that's the minimum bar say
the web profile then that's that's fine
but if you include a six technology and
it's not the web profile and it doesn't
pass its respective sections of the tck
it doesn't matter if all the previous
ones are exactly the same and still pass
you can't call it certified so it's not
certified but it passes the same tests
as the first two stacks pass eventually
we would like to certify but it hasn't
been hasn't been a huge focus of the of
the project currently Tommy is having
its birthday this week here at javaone
we announced a very first release of
Apache Tommy last year at javaone I gave
a talk and was the very first release
the very first certified version of
Tommy so it was it's when it made its
debut we've had a pretty crazy year so i
would call I would you know to be candid
about the releases and things like that
I would say that the first but the beta
that we did was you know obviously
certified but it was a beta and it
wasn't as fast as we wanted it to be
mated to was significantly faster the
one point 0 final was leaps and bounds
faster that's when we really hit our
stride that was in April we got so much
feedback off that one that it was hard
to close the lid and take out a release
on that we finally did that we've got
that out and that was says yesterday but
that actually got put up today you know
how things never go quite as quickly as
you want them to anyway and so you know
the theme of that 51.5 you know we'll
see what it has to be one point oh we
there's a lot of gap closing that we did
people trying to migrate apps from Tom
at tackling common issues people trying
to migrate apps from jboss a glassfish
you know tackling my common issues
ironically we have far fewer issues
coming from the jboss glassfish side
than we have from the tomcat side on the
tomcat side you have to be putting
entire servers in their web app and that
becomes difficult when you go to move
that on to something that includes those
jars we've got a lot of those things
solved and that we have some pretty
clever ideas on how to deal with that
definitively without having to use
things like osgi the simple answer is
don't put the libraries in the server
add them to the web app unless they have
them on the web up already so a clever
little twist and we will like to try
that out and see how much mileage we can
get out of that and that would avoid
huge amounts of complexity like osgi
crazy class loaders and things like that
as I mentioned we really want to keep
Tom simple so if there's a pragmatic
simple solution we're going to take that
over redesigning a whole new
architecture to tackle simple problem
there enough of those servers out there
not that they're bad they're great when
we released Tommy 1 point 0 final there
was a no story on invoke you about it
and people were really excited and some
of the vendors showed up and started
being a little territorial and
threatened and we came out and just said
you know we didn't create Tommy because
we thought the existing servers were bad
we created Tommy because despite the
existence of really awesome choices
people are still trying to turn tom cat
into a Java EE server and so we just
wanted to give them what their actions
were showing that they wanted and so
here's a some feedback we've gotten
about Tommy and I've taken the the
server names out because I just think
it's crass to to bash other servers that
can't defend themselves and it's not the
point to say that we're better than
somebody the point of this the feedback
here is just to say that it's it's worth
checking out and I hope you take a look
at yourself and judge for your own
you know if tommy is good for you
incidentally I agree with the third
comment the most it's a great and
footprint sighs great and speed we're a
growing project and so if you're going
to have to take care of yourself a
little bit on that regard there's some
things changing there and i'll mention
that up you know there isn't currently a
support company actually i'm in the
process of launching went off so you
know you can look for you to talk to me
after the session and if you have any
questions or you want help with Tommy
definitely help you out but yeah you
know we're growing project so here's the
kind of year we had so that little blip
in the middle there that's Java one last
year and we've just sort of had a really
crazy year since then so you can see the
second really big blip is our final or
one point i'll find that we released in
april and that's the one that did it and
our mailing list traffic is kind of gone
like this and that's all the mailing
lists then this is just a user mailing
list our commits on the project have
gone also trying to keep up with all the
feedback we're getting and then here's
the hard part the committers on the
project actually stay the same so
despite all of this growth where the
same number of people so if you guys
have any aspirations to be appserver
developers we need you for an open
source project come on board we're happy
to have people we could use the help and
you know that would be fantastic it's an
Apache projects are very simple to get
into you just commit some documentation
you do some patches anything that you
would do to support yourself go ahead
and do that and if you want to help some
other people out while you're doing that
that gets you commit really quick so how
to help Apache Tommy well code
contribute some code contribute
documentation as you'll see during this
slides there's quite all
large number of features that we have
which are not documented I have like 70
slides will try to look through those
and the goal of this will be to give you
just a really good overview of what's
their blog write articles those are also
really really really big helps you write
a blog saying I tried Tommy out this is
my experience you don't have to say it
was positive you can say whatever was
one we're going to read it and we're
going to it was there's some criticism
in there and we're going to fix it we're
going to respond your blog say this is
what we did to address those concerns
but more than anything it just shows
adoption it shows a you know that there
are independent voices out there if we
say Tommy is great that only goes this
far if you say tummy is great that goes
that far so if you if you do try out Tom
and you do like it blog about it tweet
about it and if you would write an
article those are huge huge things blogs
and articles also serve as documentation
so that's a big help as well so in fact
better than writing writing
documentation is to blog which is
documentation and that's great you can
also follow us on Twitter Facebook you
know the whole standard stuff if you're
on linkedin make sure and add Tommy to
your skills and experiences section it
takes like I don't know 100 or so people
before it shows up as our one of their
artificial skills and experiences so
that will help us out ok so how do we
make Tom that's a really important
question Burger King we do it like you
do it so when you develop something on
tomcat you throw some libraries in the
library directory you try to do just
that really and you don't do any major
tinkering with tomcat and that's what
you want to use because you want to use
Tomcat so that's exactly what we try to
do that's exactly what we do in fact we
take Tomcat we unzip it so we don't even
like do building from jars or anything
like that we'll grab Tomcat from the
website the tomcat web site we unzip it
we add in two extra comp
miles these in a bin directory we add
some executables simply for a
convenience a person on the who's a
committer on the project wrote them
because it uses them they're not
critical they don't need to be there but
they're nice so if you're on Windows
there's some stuff to do you know
windows services and things like that in
the endorsed directory we have three
things that's primarily for java 6 which
has some outdated standard library so
Java X resource is using javac
sanitation resource annotation changed
in Java EE 6 but the Jeb the JVM 6 has
an old version of it so we have to put
that into an endorsed directory to
override the one that's in the JVM same
with Jack's be Jack's be with the 21 is
required I camera Lee is 21 is required
for jax-rs and jax-ws in e6 but in the
vm is two point oh and so we need to
override that it's either 2 point 0 and
then 2.1 or 2.1 and 2.2 i can't remember
the exact versions but then of course in
the library directory of Tommy we add
the parts missing for the web profile so
being validation that's part of the
specification the EE 6 web profile we
got a transaction manager in there the
job II API libraries my face is open you
gbu open JP open web beans quartz and
you know of course in Tommy jars yeah so
it's it's pretty pretty basic this is
the one non drop in a file change that's
critical to Atami we add a listener
because we do all of the work with the
tomcat life cycle so when tom cat starts
up it admits these events saying we're
going to start and when it goes to
deploy an application says we're going
to deploy an application we were in the
middle of deploying an application we're
almost done deploying the application
there's this whole standard life cycle
that Tomcat has and that's how we
integrate into tom cat is we
ish basically a life cycle so when
Tomcat boots up and says we're going to
deploy a web app it scans for all the
servlets we scan for all the CDI beans
we scan for all the new JB's the scan
for all the jax-rs stuff real basic we
add them to the web app context in
tomcat terms that's the standard context
and that's it so we add that listener
and that's the only really critical
thing that we do we do add a some a roll
into the Tomcat users file that's just
for the Tommy web app that we add it's
not critical you can go ahead and delete
that we add a java agent which is used
for open JPS runtime enhancement so jpa
when you implement jpa you do
subclassing like hibernate does or you
do enhancement like open jpa eclipselink
do you enhancement you have to change
the bytecode of the actual classes so
you either do that a runtime and then
you need job agent or you do it at build
time and then you don't need java agent
so if you do build time enhancement with
the open jpa or eclipselink you don't
need the job agent you can go ahead and
revert that change if you wanted and
then this is completely optional if
you're in Java 7 we don't bother putting
those endorsed libraries in there that I
mentioned because those are part of the
java 7 JVM uses the latest version of
jack's b and any adaptation so we do
remove three things we move the outdated
annotations api it's in java ee 7
there's a tree source look up there's a
look up at attribute that was added in
java ee 6 that is not in the tomcat
version of the annotations api so we
have to remove it put in one that does
have the required look up attribute
because that's part of passing the tck
and then same little thing for the ELA
api we include that in our java ee api
we simply don't need it so we yanked
that one the web app examples that was
just a whim there's nothing
technical that stops it from functioning
we just yanked it to keep the zip size
the sort of the server down okay so
testing we of course have a ton of our
own test that's growing but the
important tests are the certification
tests are several thousands of those
tests tens of thousands of certification
tests it takes days to run this test
suite we're a small project we try to
keep everyone as productive as possible
so we don't want open source developers
we're contributing their time waiting
days to get test results back so what we
did to to make it possible to create
Tommy quickly is we just went ahead and
set that up in ec2 we take these tens of
thousands of tests and we split them
into a whole bunch of chunks like 750
chunks of tests we throw them out an
active in QQ we launched off a bunch of
spot instances they grabbed all the
tests they bring it down they trim away
at their testing send the results back
over a JMS topic and then we get full
results of the tck well ninety-eight
percent of results of the tck in an hour
and a half two hours so that was a huge
huge reason that we're able to sort of
come out of nowhere and make a certified
version of tom cat it's really difficult
to run the tck it's really difficult to
pass the tck it's a labor of for us love
and for everybody else both love and you
know finance so yeah it's it is not easy
to create a Java user which is why they
do not come along very often and the
fact that we're able to do it and do so
very little to tomcat is a so i sort of
a mix of the fact that myself and a
couple of the people to project have
been working on key servers for more
than 10 years i launched off Geronimo
was one of the founders of Geronimo last
year I did three servers that were
certified websphere siiii Apache
Geronimo and apache Tommy so I know the
test quite well by now after 10 years
and so that was really sort of a thing
that made it possible to push something
like Tommy to completion yeah and so as
a result we're certified on ec2 with
three we run it on three of the instance
Amish am I types I'm sure it works on
all of them but those are the ones that
we try the t1 micro is the most
impressive because it's a very small
machine it's a 613 megabyte of memory
machine and when we run it we only use
64 megabytes of memory we don't change
the default JVM settings so Tommy
actually passes the full java ee 6 web
profile with the default set memory
settings we don't increase beyond to you
know into 100 summer so it's pretty
crazy I at one point i'd like to see if
i can get it to pass on a cell phone
because you know why not right it's a
bit of a claim to fame for us it's it's
pretty cool so the results are we have a
web profile certified server that is
everything you like about Tomcats 27
Meg's the web profile version boots and
runs just fine with 64 bits of memory 64
megabytes of memory excuse me works with
all the Tomcat tools Eclipse IntelliJ
your kit J rebel announced support for
Apache Tommy a week after we did our
final release well that's because they
just you know change Tomcat to Tommy and
look we added Tommy support you know so
it was a it was pretty fun and then New
Relic and you know so yeah it's it's
it's very tight so the next session I'll
do a little demo titled you know look
mom smaller web apps or alternatively do
these jars make my apps look big if you
ever watch rocky and bullwinkle you know
that double titles are fun ok let's and
let's will pray that the gods of demos
are with me
all right ok and I don't think I've ever
done this looking over my shoulder for
we'll see how much that affects my
typing
eclipse okay clips extracting I'm too
impatient to wait for it go ahead and
now extract a Tommy
and I'm going to do the plus version and
we'll check the clips will open that up
and you see how
okay all right so we're just going to
create a great work space in the
temperature here where I'm extracting
everything all right so who uses Tomcat
in Eclipse fantastic so I was tempted to
show how that works with the cliffs but
clearly I don't need to do that all
right so these will be the same steps oh
well they've split the menu so you can't
see the menu options that's sort of
unfortunate okay so i'm going to create
a new dynamic web project is it possible
to do that oh really yeah let's try that
up
mirrors arrangement mirror displays
fantastic that's so much easier thank
you very much what was your name Alan
okay Karthik and Alan they get to you
get the honorable mentions in my session
later on today okay all right so perfect
we don't need the performance monitor
all right so I'm just going to create a
project name javaone going to create a
new runtime click apache tomcat 7 next
and we'll just optionally add a little
Tommy tag there for it and then I put it
the temp directory so we'll go to pacha
Tommy plus and then finish okay and then
we can finish our project so this is the
same thing we always do in tomcat it's
no different and now I'll go ahead and
create a servlet hello
world or servlet mom okay we got all the
useless boilerplate code which will just
delete it okay content-type text oh yes
I didn't even think about that was
trying to get gone fast and why don't we
do like this oh that little bit better I
can go even a larger I don't do not know
how to increase the font size in Eclipse
try this there we go much more readable
fantastic thank you for that okay so
so we go and we just say run on run as
oh thank you geez yeah pizza see we
worked in agile anyway we thought we
could escape it okay and quite a quite a
lot of parents though okay so there we
go hello timing and that just brewed up
a little quick pretty quick that's 914
milliseconds the web profile is slightly
fast it slightly faster that's what
includes JM ash and see XF and things
like that the web profile on is about
800 milliseconds the one point 0 was
about 600 we added some stuff it's a
little slower I got to do some
performance tune and get back down our
goal is to just always keep it around
that fast speed so let's do something we
can't do in tomcat don't say class hello
beam will make it a singleton Adam
method on there
called message will return not recompile
alright a net on our servlet we can get
that injected standardly so we do that
time that's right let's forget the
command for doing the automatic import
thought i saved it so it's going ahead
already redeployed that
in get message we'll save that and it
should reboot apply at some point here
go over to our did it already redeploy
there it is why don't I do wrong the
demo gods in that with me today named
already bound yep demo gods are not with
me today well darn it let's try
something i'm using trunk which is never
a smart idea
that's the one release today and we'll
just move that too
and then we'll start that again
okay that's what I get for using trunk
code I should just use the release
binary anyway so that totally worked
okay so there we go we have an ejb right
in there and it's it's great same thing
will happen with CDI we had a beans XML
to the web apps directory will get CD I
support this is the plus version so if I
want to just you know go ahead and make
this a web service
also complete my ejb need to add that
view now that I've had our web service
water Eastern yes that's fine and
there we go wisdom I added one
annotation now I have a web service now
I can do the same thing with jax-rs I
had at path on the top and I can get
jax-rs what is it to the u.s. RS go on I
just need to pick a path let's say rest
hello and at get GWS
get there you go ok and now i need to
redeploy
okay and then we'll go to back to the
browser and we'll say rest hello and now
I gotta rest response I mean how long
would you spend hunting down libraries
to add the stuff to tomcat would be a
lot more than 800 milliseconds I'm
pretty sure so you know it's difficult
to to justify cobbling all the stuff
together yourself because it's better
than Java EE I mean the whole reason we
created Tommy like I said was to try and
remove that thinking the actions of
building up your own java server is
really what's happening when you put all
the stuff on top yet you're not just
using tomcat you're adding all the stuff
to tomcat which is great and so we
decided we'll add the stuff to tomcat
for you and we'll actually certify so
you don't even have to worry about that
and so I mean you know it's it's it's
not entirely straightforward oh now I
got this went thing in the other window
come on
oh all right well whatever I can't see
my other window so awesome there we go
alright so the perils of doing it
yourself there are a few of them that
might not be so obvious one of them is
that when you add all these libraries
and the specifications when you add
annotations we really love scanning we
don't want you to have to put a location
of a class file in an XML file we want
to just find it in the classpath well
that requires scanning okay so you throw
the stuff on the web app including the
libraries so you throw open jpa in there
you throw all your jersey you throw all
this stuff in there you throw my faces
in there well guess what happened Jersey
is going to scan open jpa and it's going
to scan my faces and it's going to scan
all your stuff looking for rest services
open jpa is going to scan all those
libraries as well looking for jpa entity
beans my face is is going to scan all
those things again looking for jsf
managed beans and if you have any ejb
libraries in there that is going to scan
for all the stuff looking for ej bees if
you have CDI wow then you're really
going to get skinny because CD ah
doesn't even want you to configure with
things even an annotation they're even
more permissive so they're going to
they're going to actually load all those
classes into memory and make them CGI
beans so when you add these things all
together side by side what you have are
completely disconnected not working in
QWOP in tandem pieces of code that want
to do all the work all themselves over
again it's really interesting there you
know marks treuburg he's the one of the
main developers of open web beams and he
of course a huge tomcat fan and a huge
open web beans fan and he has an app
that he's been developing with my face
with my faces open web beans and open JP
on tomcat and he's one of those diehard
I hate java ee kind of ET kind of guys
and we got him to try Tommy
and we're like so did you like it you
know in you didn't want to respond he's
like my app was faster it's like well
that's because that's the benefit of
tight integration you know we don't have
it down to the science we're not
everything's going to scan like open jpa
will still skin but we have most things
boil down so we don't have to so we can
completely avoid those repeat scans and
it does improve the startup time like
your web apps significantly that then
the fact of a lot of the libraries that
we would need to include in your web app
are now on the server so they're now not
scanned so these things really affect
the startup time significantly what I
can see ok so another thing that has
effect of doing it yourself with this
style is that these particular libraries
will load all the stuff in the memory
that takes that takes a lot of of memory
space your third-party libraries get
loaded into every web app that you
choose to put them in so you're putting
you know open jpa into three web apps in
tomcat well then you have open jpa in
memory three times in tomcat you put in
the server Lib directory and you end up
with it once and apparent classpath so
all the third party libraries you throw
on your web apps they do add
significantly to the weight on the JVM
because you have them all X number of
times you put them in a server Lib
directory you cut down on the
duplication that's where we put all
these particularly classes and it does
cut down significantly on the on the
duplication there's also a second it's
another thing that is a false
understanding of there's a false
security when you add some of these
components into Tomcat that you have a
complete web profile in fact you do not
if you add open jpa you're missing a
huge portion of the jpa specification
which is container managed entity
managers and these
any managers that will if this servlet
over here and this Java Bean over there
have both reference to an any manager
with container manage any managers they
will get the same entity manager because
there are in the same transaction and if
you do a resource local JPA then you
have to pass that entitymanager round
either through the session or something
all that passing is taking care of you
with container manage any managers so is
the rollback logic and the commit logic
so open JP does implement that because
it's not something that really can do
there not a container similarly open web
beans only runs about 60 percent of the
CDI tck because the other forty percent
has to do with integration between JSF
or ejb or things like that see you guys
very much an integration technology so
there's all these partial portions that
they don't run so if you add well door
open web beans into your web app you're
still not getting all of CDI so that's
another thing there and then Tomcat
itself has elected to not implement a
lot of things and it's fine but they're
useful things at data source definition
so you can define your data source in
your web app vien annotation and
deployed at your web app not have to
muck with any server XML files not
supported by tom cat jboss free more
than a decade has had global jane di
which is very useful not present in
tomcat was added to the specifications
in EU six tomcat didn't implement so
these are things that have they've
elected not to do and these are gaps
that we fill you know with Tommy another
thing is that even if you do add open
jpa and you had open web beans and all
these are things you can't use like at
persistence context on a servlet and get
a jpa Energy Manager injected this is a
level of integration that only happens
when something is aware to inject those
things and put them into Jane di these
are the kind of things that jboss does
when they use tom cake inside jboss they
finish these parts
and then spring of course finishes these
parts by doing all the injection
themselves but all this sort of
injection support doesn't happen when
you just throw the libraries together in
in a web app and then also you cannot
discount the fact that if all of you
have custom stacks and they use various
components if you find a bug and someone
else finds a bug how do you share that
like if only there was some way we could
put all that code together in one
project and share that code and use that
server we might call it something like
Tomcat shared enterprise or I can't Tom
I can't think of a good name for it but
anyway that would be great if there's a
project like that because then we could
all save some time and also we run
hundreds of hours of tests on our
binaries I use as you saw the production
one was pretty good the trunk version
not so good these things happen all the
time any time you upgrade a library in
your web app you run the risk of
breaking something very fundamental and
very simple and unless you have tons of
tests to protect against that just a lot
of waste of time and then of course
normal portability is a big trick Pete
you can move a web app from jboss to
glassfish fairly easily you can move
them from weblogic to WebSphere and all
that kind of stuff but moving one of
those apps to tomcat that requires a lot
of reworking so now you can actually do
that with Tommy it's completely
certified you can actually move an app
from weblogic websphere jboss glassfish
to tomcat the tomcat enterprise version
and you can move it away if you don't
like it I don't think we have too much
time but just a moment on configuration
which is the server.xml in tomcat still
works we don't must be messed with the
draw all the resources and things you
configure in tomcat work
we don't disable any part of tomcat in
fact we go to the level of ejb security
and jax-ws security work on tomcat
realms so you can have your jdbc realm
implementation whatever realm you have
you'll get a completely integrated
security environment on top of those
Tomcat concepts it's very very very key
point so if you drop in at all jax-ws
implementation on tomcat you do not get
security integration with tomcat realms
you got to go how are we going to solve
security for ourselves and then you have
to go maybe look somewhere else for some
source cute some security library or you
got to figure out how to integrate them
on top of the Tomcat security support
well we did that work for you and if you
use ejbs on tomcat when you have a
trolls allowed that also works on top of
the Tomcat security roles so it's
completely integrated security
environment on tomcat security you know
that's really it's a really key part you
can put all your stuff in your contacts
XML that's fine if you want to have a
data source in context XML and then
inject that into a CGI beam or an ejb or
jax-rs jax-ws that injection works just
fine normally you wouldn't get that
injection unless you found some way to
wire it up tom cat will inject into
servlets and jsps or servlets but it
won't inject into jax-ws things and in
such a debt so data sources that you
configure in your contacts XML will be
injectable into jax-rs and jax-ws
components and all the other components
we add additional config files because
there are things that Tomcat isn't
prepared to configure like JMS and
things like that so just to give you a
quick overview that's what a config file
looks like for Tommy it very much is
meant to be simple we try not to do ten
tons of nested XML and make you follow
these huge chains we want to roll it up
and just give you the most important
stuff for right in front in a very flat
style so you don't have
to deal with kind of like spring light
config files where you have to follow
one objects reference to another object
reference and it's just you know that's
great for development but that's not
good for management for man you know
from managing servers Arkin properties
are not case sensitive so if you mess up
a case that's totally fine if you use a
property that doesn't exist we will tell
you that property is not does not exist
you can cut out as much as you want so
if we would simply supply defaults for
everything so your config file really
actually only needs to show what you
want to be different you don't have to
show all of the options so really you
can rely on all defaults and then what
you have new config file is very
obviously the things that are unique to
your environment so it's a nice little
feature there you can get very small
very very small and that's because if
you do put an application that has like
JMS in it and you don't configure
anything it's pretty obvious that you're
going to want a topic if you have a at
resource topic and the top and the ave
resources foo we're going to create you
a topic called foo because you want it
and if you have a data source reference
you didn't create a data source will get
you a default data source that's
actually going to be part of six or
seven so all this sort of you know you
don't have to configure anything in
tongue you deploy your app and you only
have to configure it when you want
something to be different than the
defaults that will typically be data
sources and then really practically
everything else you can rely on the
defaults so it's very easy just to try
it out because you can just throw your
app in there and if it works it works
you don't have to spend a whole day
adding all the things that required for
your app just to see if it would work
what we want is it for it to be forward
to work people to try get a good feeling
is it worth putting more time in yes no
you know another thing is that really
annoys me personally is all these
timeouts config files are in like
milliseconds all right so can someone
tell me what one hour and 42 minutes is
in middle
seconds all right yeah you you have to
go power calculator but can you tell me
what one hour and 42 seconds is in plain
English of course it's one hour 42
seconds so we just all of our timeouts
we're really proud about this we put a
lot of work into it you can configure in
plain English we will just do the math
figured for you and then that's that's
your timeout saves you lots of time and
it saves you bug because when you're
really tired and you've been working a
whole lot it's easy to do the
millisecond stuff wrong slap slice up
type it wrong slice a zero off and you
got a whole different timeout than you
then you might have otherwise wanted and
you can put comments and config files
you can put all this stuff in the
application itself there's a meta INF
resources file throw all the same things
into this meta INF resources file throw
that in the web app deploy that and you
can put all your data sources all your
collar configuration right there in the
web app if you hate XML you can do it
via system properties so there's a comp
system properties file we have a
property syntax for absolutely
everything we have an XML syntax for so
that's all one hundred percent match up
between properties and XML so if you
like property is better because they're
nice too easy to grep you can do that
also you can put those properties in
plain old java system properties and
they'll find their way to where they're
supposed to be so if you want to put all
your configuration not just outside the
app or outside the server but like in
the script that boots the server you can
do that you can combine them all so here
I've declared my transaction manager on
the top I've declared my datasource but
I've actually specified the tricky parts
that change more often outside the
application and outside the server I
specified the username and password in
my startup script vs system variable in
my environment this is extremely
experimental I want to it's a strong
strongly typed version not
not too much to show on that let me we
do have our Killian adapters who uses
our Killian yeah okay I suggest you all
check it out they want a Dukes Choice
Award last year for its amazing testing
framework for java ee applications
really go ahead and take a look at that
we have a maven plugin who uses maven
pretty good about half the room if you
want to have just a plain maven pom file
no code in there uh run maven with this
plugin and we will extract the Tommy
server we will add the web apps to the
web apps directory add the libraries
that you want to the library's directory
booted up and run it so basically you
can get provisioning with just a little
xml file via maven plugin and you know
of course maven is very nice it will
download your web apps for if you
publish them you can just pretty amazing
provisioning with this it's great
feature requests on that are great we'll
take them it's pretty good ah one aspect
of Tommy we're particularly proud of and
something we're growing throughout the
server is that we try and save you as
much time as possible if you make simple
mistakes what you do and I do and that's
why we have a lot of the stuff i go to
make examples and even I get them wrong
and I wrote some of the text in the
specification and I AV and I can't
remember so if that's the case and what
hope does anyone else have you know II
can anyone spot how many errors are
wrong with this ejb so use the bean
class and then there's the interface all
right looks pretty kosher well these are
the problems with that beam you can't
use the in it and remove on a stateless
being because stateless beans can't be
removed the at resource annotation was
used to get an entity manager injected
the appropriate annotation is at
persistent
context same for any manager factory the
appropriate annotation is entity of
persistence unit the at resource and the
top was used to declare a reference to a
data source but we didn't say it was
typed data source so that was a problem
so all these things are typically what
most servers if they find one problem
they'll go this one thing was wrong
they'll kick it back to you and then you
fix that one thing build everything you
deploy it again they go the next thing
was wrong and you repeat that all day
long we try and give it to you in a
compiler style everything up front
because odds are if he made the mistake
one place you made it a bunch of other
places and you could fix that all at
once all one go and it's a thing to save
you time that's not necessarily
speed-related doesn't have to do with
how fast the server is or watching your
back and we go out of our way so if you
put annotations where normally they
wouldn't be found we look in places that
they're commonly misplaced like
interfaces you can't put annotations
like security annotations or transaction
annotations and interfaces like this it
just doesn't work so those are part of
the things that will say we were
ignoring this annotation because it
wasn't in the right place do you have
two interfaces and each of them have
different sets of annotations that
conflict when you implement that on the
beam there's no way to resolve that so a
standards level would just say you can't
do that so we tell you you can't do that
you want to extend Tommy in your at
resources XML file you can put your own
javabeans and here we say we have a
class name on this resource that is
injectable view the same at resource
annotation that you can inject I think
we're done with the time here yep all
right let me just cut to the end here
alright so I hope you try out Tommy I
and my java one exclusive offer is that
if you want to pour a nap to Tommy and
you're not sure that's worth your time
you want to if you're gonna have issues
contact me if you were willing to write
a blog post about it I will help you out
directly so it's a little exchange if
you're willing to you know to write your
experience and blog that I'm happy to
help you I we help people all the time
on the open source mailing list so this
is this is not too much of a bother
that's my email information up there I
do have cards up here and if you're
interested in using Tommy like in your
work and you want a demo I will help
with that too so I'm at your disposal so
go ahead and take that information down
and thank you so very much and I really
hope that you liked on</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>