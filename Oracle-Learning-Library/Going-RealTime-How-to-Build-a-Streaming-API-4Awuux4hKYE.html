<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Going Real-Time: How to Build a Streaming API | Coder Coacher - Coaching Coders</title><meta content="Going Real-Time: How to Build a Streaming API - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Learning-Library/">Oracle Learning Library</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Going Real-Time: How to Build a Streaming API</b></h2><h5 class="post__date">2013-01-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/4Awuux4hKYE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so first of all thank you for coming I
mean it's 7:30 start like Java 1
typically at this stage of the game I'm
half drunk somewhere so thank you for
coming in and actually paying attention
today we're talk to you about going
real-time and this my experts a fly off
my hangout let me do that is that I'll
try again
all right so the whole point of this
talk today is to talk about an emerging
trend and technology which is real-time
API source streaming API so now the
first time I gave this talk no one had
any clear what I was talking about and
it's because I started at the middle and
started talking about how to implement
them without describing really what they
were so this session I know the Buffs
are supposed to be very technical by I'm
gonna start with some slides and talk
through the what and why of streaming
api's and if you on Twitter
then please tweet the session no one
believes in anymore would turn up at
7:30 so thank you very much a bit about
me so I actually created the the mule
project which is an open-source
integration platform quick show of hands
who knows mule good showing and how many
could we use it just a few of you ok
damn you all you know you're not using
it that's not good ok so I also started
the founded the the mule soft company as
well and we do integration on the cloud
and on-premise so you know I'm a boy
with that but essentially if you need
integration you can come to us I started
life in banking actually I was an
architect for investment banks I worked
at two different major projects and I
really got to see how middleware kind of
sucked and it hopefully now thanks to
mule and new other things that happened
it sucks laughs but essentially what I
really am as a plumber all I do all I
think about is is putting plumbing
between different applications I think
it's a saying which you can either focus
on the the plumbing or the porcelain the
porcelain being the sexy stuff that
people get you know lots of money for
the
integration the plumbing is at the
background that no one really cares
about but it's actually horrible and
painful so we try and fix that for you
now finally who knows what Marmite is
quick show of hands just a few of you do
you like the ones who know what it is do
you like it I know once you don't like
it
show of hands all right can you please
leave because we're not gonna get on
like Marmite is one of those things you
either love it or hate it and I'm a
massive fan of it but anyway we say in
the in the UK is a great way to divide
that a group of people is just by
whether you like Marmite or not doesn't
carry here clearly so quick agenda what
the heck is real-time API I'm going to
talk about the technologies and then I'm
gonna give you some demos and we're
getting some code and hopefully by then
it all makes sense
oh I can't walk very far clearly I'm
tethered all right so I'm never to meet
you over there I'm sorry so what is real
time well it's actually just the ability
to react to changes as they happen
I mean life happens in real time real
time it just means that things happen
and you get to know about them if you've
worked in banking real time actually
means low latency sub nano sort
millisecond message processing on the
web real time is is a bit more lenient
it's probably about a second or 900
milliseconds so that means the pointsme
happens to the point you know about it
there's a latency there of me you know
up to 900 milliseconds to one second
that would be considered real-time on
the web so what is a real-time API well
it allows you to register interest in
things that you care about on an
application so you know some examples of
this would be I want to know when a new
customer registers I want to know what a
new signup happens or you know when I
stock price changes or you know no it
can be a long-term thing as well so you
can say when these three things happen
then let me know or you know four weeks
tell me about something that sounds like
Google Calendar but in essence it also
works as a selection query on a
real-time API so why real-time and
I mean basically you don't make people
wait so it's a bad experience if you
make people weigh and what I mean by
that well real time tends to be a
back-end server site technology but
actually it feeds data to usually
front-end applications so on the web
JavaScript sort of grew out of this
notion of everything happening at
callbacks and and with Ajax and long
polling in there and the request process
on the browsers and the old ones at
least we have this notion of Ajax where
data would come back and forth to the
browser without pressing f5 the bizarre
thing is that happened on the client on
the server we're still doing this HTTP
request/response model so it's kind of
weird we've sort of done loads and loads
on the front end to make a you know our
user interface is much cleaner and
simpler and more reactive and the
server-side web we're polling which is a
little bit weird also certainly my world
we think a lot of rounds not as people
but actually other applications and
other systems and processes and devices
and all these other things and they
don't like to wait either
so for example if if I've got a
Salesforce CRM application I have a
financial package if I create a new
product or I have a new customer a new
invoice some of that information needs
to be propagated to the back-end system
the reason why you want to happen in
real time is you do want things getting
out of sync when things work out of sync
essentially you have to then start doing
sort of batch processing and you create
this Delta of information between what's
actually current and what's stale so
consistency is a big key P part for me
when you talk about system the system
real-time and so before everything else
happens in real time anyway and
certainly consumers of our applications
how many build web apps it just quick
show of hands well quite a few of you
you know that your your users and
certainly the employees that use your
applications are looking for more
real-time experience right there they
actually want to things happen in real
time they don't want to have stale
information they want as much
information as possible
this means that real time is going to
come more and more important part of
your everyday lives because the
applications you connect to or the rest
aid
Piz had published if they're not
real-time there's always going to be a
Sandman delay and it's not for every
application some applications are fine
but on the whole we'll see a trend and
I'll talk a bit about this in a minute
where people will offer both a REST API
and a streaming API so you can get the
best of both worlds and by the way it's
a good size group but if you just want
to ask questions in between I feel like
birds of a feather we should you know
flock together sorry we should be able
to ask questions so just raise your
hands and I'll repeat it to the group
okay so why real-time when I just spoke
to some of the advanced here's one of
them being speed just knowing about
something when it happens in real time
is better than like knowing about it
four or five seconds later so as an
example what are we on API is let's talk
about REST API first what do we do on
consumers
well we poll polling doesn't seem
inherently evil actually isn't but you
are making a request to an API say every
60 seconds
pretty of the quickest for most ap is
the thing with that is about sixty two
point three seven one percent of those
requests yield no result that's an exact
figure I have that number at hand
so there's some people are paying
attention that's good so the problem is
is one is I'm making a lot of calls
without getting any data back there is
actually quite a high number of polling
requests that happen so I use Salesforce
as an example because I know their
platform team they work on their their
API and especially their streaming API
in the same way they build their product
it's a massive part of what they do they
have over fifty percent of their
customers who use their API and don't
use the front-end technology and with
them they have so many people pinging
their API any given time they may create
a massive load on their own data centers
and you can get some motion if you've
got millions of requests coming in the
stuff you have to do there to serve that
only to deserve nothing back it's kind
of pointless yeah sure
yes
yes it is you are yes so you're in the
right talk so the question quickly was
and we all seem to be talking about
streaming as well as real-time I
actually use real-time as the umbrella
for streaming and push so I'm going to
separate those two in a minute as well
so way ahead of you there so yeah I
guess we're Salesforce the so they're
API yields a lot of no results the other
challenge with polling if it's three
minutes or every hour is there might be
new updates like half a millisecond
after you polled and now you've got an
out-of-date system that really matters
in some areas it doesn't matter in
others but on the whole you don't that
gap to be too large to where two systems
have different sets of data especially
when there's many consumers hitting it
another thing you had a hit is actually
boundaries on the API themselves so if
you're using open api s-- from
Salesforce as an example then you're
gonna hit rating mitts so there's only
so many times I can hit the Salesforce
API until they shut it down and ask me
to pay more so I can hit it more
frequently so actually if 6% of your
calls and not returning any result and
you hit your threshold limits then
you're really getting 40% value of the
API so it doesn't make sense the other
thing is the broadcast generally
broadcasting means that when an event
happens when you go to streaming you
actually think of the world in terms of
events something happened that
somebody's interested in I'm going to
let them know the great thing about that
is when you actually building the API is
that allow you to do lots of
optimizations on the server side which
we won't really get into today but
they're there but on the consumer side
it also means you have lots of things
happen at once because an event happened
so event-driven programming generally as
a discipline is is pretty interesting
because it sort of mimics the way things
happen in the world anyway like
something happens if something else
happens and you tell people about it so
real time allows you to do this because
you have multiple subscribers
subscribing to topics that they care
about a finally engagement because
things react more quickly and you have
more control over the events as they
happen you can provide more interesting
engagement of your applications that
they're the speed of efficiency of just
getting their data when you expect
and the fact that things don't get out
of sync or you know very close to sync
means that your application will run
better and your users will be happier so
push versus streaming user especially
for you
so there's two types of technologies I'm
talking about really here one is push
technologies which is more you register
a hook with something to sort of say let
me know when something changes and it
will send you a message and the other
one is streaming whereby Europe and up a
socket directly to the server and new
events come down the pipe as they
received they're a bit different because
one is one is connected one is actually
disconnected push is disconnected you're
not waiting on something to come back
it's not long polling if you how do you
all know Ajax here well maybe I should
say comedy really comedy quite a few of
you so comment DS her that uses long
polling or used to maybe it's changed
with the web WebSockets approach but the
difference is you know one is will call
you back though when you keep the line
open and it's a bit more request
response so streaming sort of sort of
mimics what we do anyway when we do
socket based programming essentially
they both have drawbacks the one with
push that people seem to forget so if
you know web hooks as an example of a
push technology is you have to set up a
reply channel I mean you have to set our
sorry a a push channel and that means
that for a lot of people you've gotta
open up a new socket on your firewall to
receive incoming data folks don't like
doing that especially in the IT and
security side and there's not a lot of
reliability there just because once we
gets pushed is then going over the
Internet and it should be received by
you but there's not a lot of recourse
there's no acknowledgement mechanism in
web hooks as an example by default it's
just an ideal rather than a complete
framework so there's some real
challenges there just on reliability and
then streaming API is you do have a
socket connection open we do find ways
of doing that but actually if you build
a streaming API there's a real challenge
there on how do you manage your
load balancer as an example because at
some point if you you have over you know
that one what is it thirty six thousand
or sixty-four thousand connections then
somehow you need to gather low balanced
those over to a different subnet so in
terms of this architectural complexity
streaming API is can be troublesome when
you have many many clients and durable
collections are a little bit more
difficult not impossible but they're not
that easy either so rest of real time
this is one of the first questions I got
my last time I did this because a lot of
people build breasts api's and I'm
talking about real-time or streaming
api's and I don't think people realize
that they're actually different but they
are so you know going to take it's sort
of a jax-rs implementation and add a
sort of streaming annotation to it as an
example you actually implement a
different technology strike stack for
streaming api's than you do for rest
api's so the one of the weird things
about this is it does actually fragment
your beautifully elegant restful api
because now you've got two ways of
accessing it but the benefits so it also
means you have two different clients so
bear that in mind for usability as well
typically a streaming API so for reading
data so the whole idea is is i want to
read something so tell me about it when
it changes or something new happens but
it's not typically used the same model
for updating or publishing new
information this is not a lot of return
and value in sending things over Ajax
versus just making a simple rest call so
if you're using javascript programming
you already know all this stuff so I
mean this is kind of what a REST API
looks in is a very basic form so you
have a database in the backend you have
a number of resources and your consumers
connect through the REST API when you
add streaming it's a secondary box and
it's this secretary box that we'll talk
a bit more and now about so the first of
all you have you have a front-end
technology here and I'll talk about the
technologies in a minute but typically
it's it's things like comedy or some
sort of just saw
connection or there's other sort of push
technologies like pubsubhubbub and a few
others then typically what makes it
streaming is also there will be some
sort of subscription manager whether
that's topic subscription or is actually
query queries from the end-user there's
some way there's some way there you need
to manage the identifier that says this
is what I'm interested in so it's a bit
different from a REST API because
there's never this just this one thing
that people are interesting they get
make calls to resources now I'm
registering interest in something it
becomes a subscription so again if
you're familiar with event-driven versus
request/response programming this is
request/response
this is far more Drent event-driven and
as such the semantics changed quite
drastically and then quite often with
subscription there's also query so what
I mean by that if you think about
salesforce or facebook or twitter or a
number of these other guys that have
have streaming AP is one of the things i
have is you register their interest by
passing in a query so if you're familiar
with salesforce they have this thing
called salesforce object query language
and you define which objects you're
interested in you make that a topic that
you want to subscribe to and then it'll
give you updates it's quite elegant
actually it's a nice way of it's just
it's like having a database that calls
you back which is pretty neat but the
challenge of building one is if you
don't naturally have a query semantic
inside your application that you don't
have a filtering language or something
then the query mechanism either has to
be built or you have to leverage
something and there's not many
technologies yes
okay yes yes exactly did everyone hear
that so he said it Belen I did so I'm
gonna just take off the mic now inkjet
hand over to this guy no so the roles of
these two is this crucial manager
controls who gets the events so ties
events to interest and the career
processor actually filters the events
that the PERT you know that the
subscript t is is interested in
essentially makes sense there is mud all
right thank you so there's a few
different there's a few different
technologies here at place so on the
real-time side on the transport side at
least there's things like comment and
comment d which is the implementation in
java web sockets you've all have heard
of those and know what they are they're
not the same if you if you know both you
know why but you know comedy actually
has subscription built in it's like a
publish deprive engine it's not just
opening sockets back and forth to the
server there's also some defined
protocols so there's things like XMPP
which is that the chat protocol that was
always destined they thought there was
gonna be destined to be you know
real-time message on the web turns out
it's horribly painful the clients are
quite heavy and whenever I see XMPP I
back away slowly Bayer is actually the
protocol behind comment so that's
actually the handshake when you get the
messages saying subscribed and subscribe
that's the Bayeux protocol and also
activemq have a similar thing called
stomp that is a wire level protocol for
doing also cross language subscriptions
and a lot of people actually invent
their own so because this is very new a
lot of lot of API is actually invented
their own ways of doing this and it's
kind of valid to do that right now
because there's no you don't get much
support out of the box for an you know
so Twitter for example I think is pretty
ad hoc in the way
those things Facebook uses pubsubhubbub
but a kind of a subset of it and they've
really bastardized it to make it work
for their environment and then on the
push side the two main ones are you know
pubsubhubbub which is this project from
google that basically implements a
handshake and a publish/subscribe engine
on top of HTTP and web hooks is well web
hooks it's been around for a long time
I'm pretty sure everyone is they're more
familiar with web hooks roughly what
they'll know one is okay so web hooks is
actually just a definition of of how to
exchange information over the web using
this notion of registering interest and
then also a callback URL that will get
called back and people have build it
into their platforms it's pretty basic
but it was the first sort of push that
really took on in the web okay so
they're here I've just got you some
examples but the rest you know some of
the guys that really have streaming API
Salesforce users comment D Facebook
users pubsubhubbub with asterisks
because they sort of mist around with it
a bit Instagram also had their own
callback mechanism which there's also
sort of built based on the ideas of web
hooks and pubsubhubbub so no one's the
only one vanilla here actually is super
feeder
it was his XMPP and and Salesforce you
know popping up is interesting because
I've actually had people fooling with
popping up it's it's like a WebSocket
based messaging system on on on the web
it has basically a very simple API and
what a lot of folks are looking at for
is is using it as the implementation for
their own streaming API sometimes and
the reason being is because it's just be
like a very simple publish/subscribe
service as you get from Amazon but it's
called PubNub and it's very very fast
and they've done some very cool stuff
making it low latency by using CBN's to
deliver your messages and things like
that so it's kind of cool
but yeah this is a very small list of
stuff you may may not have heard of but
on essence I think
the number of streaming API is out there
today very small so 1% according to
program a web of api's have a streaming
interface so still very new so the
reason I'm talking about this is because
I've sort of been an advocate of real
time since I built mule a long time ago
and real time to be fairly common in the
enterprise it's not so common on the web
and I think it's got to get there if you
think about the levels engagement that
users are gonna want the type of
information and the way they want to
interact with other systems real time is
pretty there any way that we can really
do it really well so I still talk about
real time the other interesting thing
here is on actually this is just child
of protocols so pretty much most
streaming API is are tied to rest-based
API and rest-based API is are taking
over soap-based api is generally so
newer api is essentially also adopting
streaming API and the data formats used
it's pretty even split between Jason and
XML so depending on your flavor I still
prefer JSON over XML but there's reasons
to have both I guess okay all right so
I'm gonna stop talking I'm gonna dig
into some code so the examples I'm going
to use I'm doing a mule because I think
they're readable and we can I can
probably communicate a lot through the
expressive language that you've all
looked at but not using so I'm gonna go
there so give me a second so I've tasted
stop the presentation a second
okay I'm going to show you two examples
the first one the first one is actually
Ajax bass so it's a really simple
pub/sub with Ajax just so you can see
really the notion of the subscription
engine in play which is essentially a
client would register interest on a
topic and then get published updates on
it there's a few bits of this demo first
what we're looking at here is is the
mule XML if you're not familiar with
mule
it has a XML DSL Lite language which
defines integration flows that describe
how to interact with a system it doesn't
say what you should I says what you
should do doesn't say how you should do
it so I guess so for example here
well let's start at the top here this
embeds a JMS broker ActiveMQ in this
instance so you know here you might
connect to a remote one or a local this
will just embed it inside mule
essentially we create two different HTTP
servers because we're using client and
server in the same file this actually
creates Ajax layer on top of the HTTP
server one and just as a matter of
course that's just what it does so by
putting this in my if you're familiar
with tomcat web XML this is kind of like
binding your servlets to to code the
differences is in mule it's a very much
more sort of fun functional based
language so what happens is a flow has a
trigger and then everything that happens
execute it inside the context of that
flow and you move through through the
steps as each task gets executed so so
far we've created our HTTP servers and
we create a nigga a server on top of one
of them I'm going to just jump down to
the bottom because I'm also doing
something else on these two here
that's just generating some dummy data
so every three seconds it will create
new events and I'll post it onto a JMS
queue as an example so every three
seconds
some payload score pop out and you'll
get put on to the public football scores
q we do the same thing here for just
demonstration purposes I want to I
wanted to generate new different types
of data to show that in actual fact you
know we're using the Q as the
subscription metric mechanism for
publishing so the Q name that we really
care about is public football scores and
then what this does is it receives these
events on exam is in by an endpoint that
could be coming from a web client can be
coming from any like us use JMS because
is easy to embed as a messaging
technology and then it extracts the
charging channel by looking at the
destination that received the message on
and essentially what it really does is
look us the cue name stripped off the
public and replaces the dot with a slash
which would create a channel name that's
got a publish Ajax events on okay so
it's not happening there it's quite
convinced because mule just does a lot
of stuff under the covers but
essentially this is just describing
exactly what we want to happen Justin to
have to say how it happens okay let's
have a quick look at the bootstrap for
this okay so all I'm doing here I've got
an abstract demo at the white base and
me just show you what this looks like
see you have a full picture so here
we're just embedding mule and we're
loading our configuration file so
nothing major there that terminates here
that's just the termination hook and
then we hit run demo and this will go
into depending on sorry let me go back
on the Ajax demo in run demo we override
it and what we do is we set up an HTTP
client which you guys might be familiar
with I think this is just the Apache I
notice the jetty takes to be client and
it creates a long long pole transport so
again if you're on the browser this is
kind of what the browser
do it would create a Ajax request using
the the comedy libraries on the browser
I'm just doing on the server side just
for demo purposes and creates a new
client waits for the handshake so this
is part of the by year protocol waits
for a handshake to come through so you
can add security and things like that
there and then on the cloud clients I
have this egg hammock channel called
football scores which is pretty similar
to our JMS key topic I mean it's cute
and I create a new message listener that
all it does is just does a system out
received on the channel and the message
itself so pretty basic but when I run
this demo this is just going to run all
in my IDE I just wanted to run it one in
one place but essentially I can connect
multiple clients to that and have them
all
listen so if I run it
should start up and then oh I run them
on one hand it's the wrong demo although
they actually look exactly the same when
they come out but the the pretext is
different let's try that again
okay so essentially even though I'm
generating financial data and football
scores I'm only getting notifications or
football scores but if I change the the
XS channel - let me just go back to the
previous config financial news
all right
let's stop that and run again
I said basic he's got a different set of
results
yeah okay
I didn't change that but well it's
actually that's probably the most basic
streaming API is there using Ajax on the
server side and it publishes so every
climb that connects to financial news
gets exactly the same data so the
typical demo people give his chat rooms
like this couldn't bring myself to do a
chatroom demo 8 o'clock on a Monday
evening I apologize so the other quick
demo and I'll give you and then I'll
wrap up and ask for questions is
WebSockets so there's a bit more
interesting because I'm actually now to
introduce a query engine so actually
I'll go sauce a quick show of hands
who's familiar with Esper the complex
event processing engine anyone a couple
of people all right so the whole point
of Esper is you can send it a stream of
discrete events and it will run queries
over every event and then well you know
fire off a new event when something
happens the nice thing about it has it
has support for things like time windows
so I can say if I get this message five
times you know hundred times in the next
five minutes let me know about it so the
obvious you know use cases is things
like brand awareness or you know
anything network traffic and you just
want to monitor certain specific events
I happen over anytime in this instance
I'm not doing the major we're there by
going to show you how easy it is to plug
in a query engine because otherwise
you've got to think about building your
own so this is actually a pretty good
query engine so in this example I'm also
going to use WebSockets
so instead of using Ajax which I always
find more people are familiar with I'm
actually now using just a normal HTTP
impound endpoint here and so it creates
a WebSocket on top of that I just need
to put this extra element and here which
creates on that same URL but events
there's a WebSocket that the clients can
now connect into so pretty basic I have
this bit of code here that when I
receive
when I see van events I execute this
Esper WebSocket update listener and we
look at that really quickly might be a
bit of an eyesore but essentially what
it says is when this statements which is
just an esper query executes call back
on this processor and I just do some
stuff with it and essentially I create a
new message and then write it to the
events Channel
so that's what like a bit of code does
it just creates an event and writes it
to the channel when something happens we
go back and yeah if you if you're
wondering this but here this is allows
you to use spring injection like you
would any other mules built on the
spring XML so if you use spring you can
do all the stuff you can in spring plus
you get this other syntax on top and yet
again we just have this other sign of
events generator so this is just
creating new sum of events which is just
sign up with an idea fake and when I
listen to that let's have a quick look
at the Esper config so Esper the way you
create subscriptions is just by defining
what type of events you want and that
can be done by root elements or by XPath
queries and this this instance I'm just
creating I want to hear everything that
starts with the root 11 or sign up but I
could be football scores it could be
financial information or whatever else
okay and then all that does is it
creates the event converts it to XML and
then sends it into the Esper engine so
espera itself is pretty powerful so just
by doing that embeds an esper engine you
can actually add a connector up here
this actually creates the engine inside
mule so mule is just the container of
containers and down here now when I
guess fire in a an event I give it a
name and I pass in the contents which is
this by the ways mule syntax for the new
message coming in and the payload of the
message so pretty basic and I run it the
same way this takes a bit longer because
we've got s4 running in the background
as well and every three seconds I'm
gonna get the same thing again the only
other thing I'll just highlight here as
well just so where we see the same thing
on both sides is where is it
on the client-side the way we do
WebSockets is we're using the the
Eclipse jetty X to be client with
WebSockets
so create a client this is the endpoint
it connects to and you are execute a
handle on it essentially and in there on
open this is what I'm interested in so
this is the important bit so when I said
there was always a query that had to be
executed this is the client saying
selects all events from sign up events
right so just going to go back and tie
that in again very quickly we fire these
events we call them sign up events and
then the user says hey you know what I
want to I want to listen to those where
did it go so and here you can also do
select star from Sun of events where
time window is this or when the and of
something the payload is similar but
this is the query language on top of
just the subscription processing and
that's pretty much it for the demo I
mean I guess the takeaways here for you
are there are a number of technologies I
will just picked meal for one minute
mule makes it very easy to work with
these technologies and we haven't yet
really codified the the whole process of
creating a streaming API but that's kind
of what we're working on the moment so a
lot of this stuff is still a bit bleep
bleeding engine you have to do it all
yourself but very soon we'll start
building all this stuff into our
platform as well okay so just to wrap up
here
so you saw a mule how to create two
types of two types of AP ice one based
on exacts which just was published and
subscribe
the other one was actually based on
WebSockets and also had a query engine
embedded as well but we actually support
a whole bunch of technologies so
depending on whether you're you're doing
comment to your web hooks as we just saw
you can build your own pretty easily we
support pubsubhubbub and we support
these other guys down here plus we also
have connectors to other third-party
streaming API so our platform is really
sorting geared up for connecting to
these these newer technologies as well
today and the stay the nation of REST
API sore and sorry streaming API is
generally it's still very early adopter
territory it's really good to know about
it's good to understand what people mean
when they say real-time or when they say
streaming or they say push because they
will get mixed together real-time for me
is really the umbrella term that covers
both push and streaming API so I
remember push is you know registering
stress and a callback URL when when
something happens and streaming is when
you actually open up a socket to the
server there are some limitations to
these API so there's no discovery
protocol so what I showed you there you
saw the client that you had to write
that's kind of the client you've got to
write so it's not very easy to generate
clients today because there's no way of
describing a streaming API in a in a
normalized format so that's something to
be you know be aware of typically if you
distribute a client for your API you can
actually build streaming into it and
that's actually pretty the preferred way
to go in my opinion and I would say that
there's lots of different methods so I
just showed you two there's there's
demos for about another two or three I
could have shown you the challenges is
you're sort of hampered a bit by your
client if you're on an older browser
technology then you know comedy works
better if you're on newer browsers then
I would always go WebSockets
pubsubhubbub is okay for some things I
don't know really about you know the
performance I think that's probably why
Facebook sort of forked it the way they
did so you know I understand the
technology is actually quite important
because it helps you make a decision and
if you saw from the earlier
for api's no one's done it the same yet
so I don't think anyone really knows the
best way of doing it but the fact is
once you offer it your application
immediately becomes more reactive it's
in people building real-time
applications and pretty much today
anyone building a web app or mobile app
is building a real-time app I mean give
you an example I I've been using this
app on my iPhone called queue up which
is like a replacement for your calendar
that it starts bringing contextual
information so you have your calendar
but then it'll also show me who crave
the event with a phone number link on it
it will have the last known email I sent
to that person so I can very easily ping
them on the last topic we spoke about
and it has things like I'm running late
so you know I can even click it and just
it'll send a message automatically say
I'm running late very nice ah the reason
I'm telling you about this is I've got
rid of it because it runs really really
slowly it because it pulls everything
and it has a lot of information to get
it's almost unbearable and the time when
I need it I'm usually in the car and I'm
running five minutes late it takes 15
seconds to load up so you know it's
super important so I'm gonna make a
break of your app in a lot of ways that
it will actually respond really well and
this is only one aspect of speed of
course there's also net we're late and
see everything else but by giving people
streaming API is you actually giving
them more you know more options to
provide more engaging applications on
your platform which is kind of what you
want all right so that's me and thank
you I'm going to take some questions now
the slides will be on SlideShare in just
a minute I'll upload them before I leave
we've got a blog where we talk about a
bunch of this stuff and we're always
hiring so if you're looking for a job in
San Francisco or you want to relocate
then please come and talk to me or
Melanie who's sitting here alright thank
you very much can I have some questions
okay clapping question zero
and if you are some good ones I'll throw
you a squeezy meal all right I think
actually the guy gets behind you as a he
had designed up first
yeah yeah so how do you scale the
backend well actually if you're using
streaming that's actually a really hard
problem and it's one of the reasons why
Heroku if you know Heroku don't have a
tech support or they didn't last time I
checked because when you've got that
many clients working over you know that
virtualized network and potentially
millions of people connecting it's
actually really hard to manage open
sockets there is a way of doing it
Salesforce have figured it out their
platform team I can't give you the
details mostly because I don't really
know them I actually do want to sit with
him to find out how they did it because
it's a pretty complicated problem okay
there you go
the back bear
yeah
yeah exactly so that I guess the
commentary really was as I spoke mostly
around open-ended queries but there's a
massive use case here of more
traditional applications that request a
lot of data and you just want to deliver
some of the results early the nice thing
about having a streaming API in
particular is you got an open socket so
you can start sending stuff way before
you finish a know executing the whole
request as an example which has kind of
a whole point of it fir from the Ajax
standpoint was that was that your
question though I mean comment no there
really is it's just that you're using it
enables you to do that over HTTP which
hasn't really been any very easy in the
past alright thank you
you want one of these I want to hit the
guy next to you so oh I always hit a man
yes so who's next over here
okay yes I repeat that so the question
really was there's obviously a lot of
data coming from the server side but the
the client also needs to be at least
built in a way that it has enough
resources to consume the data that's
receiving the short answer is is yes I
mean that's what the by the very small
snippets of code for a sync client and
jetty users it's not really apportioning
resources but it you need to think about
that as part of your application today
so there's no that's what I mean by
there's no standards there's nothing
really on the server side to say this is
exactly how you should do it and on the
client side it depending on what you
choose on the server it sort of dictates
the same client technology that matches
the server so command D has a client
there's various clients for WebSockets
obviously which makes it appealing if
you're using you know things like pubs
or anything with a protocol typically
they define the client as well because
the protocol has to be honored on both
sides if there's no protocol like the
ad-hoc ones and and WebSockets then you
can define your own client essentially
oh there you go
so just pretty much into this piece I
think they're talking stuff I haven't
played with it yet so I can't talk about
it but yes it is definitely interesting
yeah no no it's an interesting
technology for sure it's not really a
question but you get one anyway there
you go
so the back there
okay
so reliability I mean I didn't make a
comment it was hard to achieve the
reason it's hard to achieve is it's a
it's very much a one-way so it's a bit
of a fire-and-forget on the server side
and if the client disconnects or you
know in transit then it's kind of gone
at least with you know you have a
representing your state transfer with
rest right you you know that did happen
or it didn't happen with streaming you
don't necessarily know so it's actually
a really good idea to have what our
customers have done and they put a
reliability layer on front like a proxy
that grabs all the vents that's highly
available and then it accused them up in
something a bit more reliable and then
and then consumes them sometimes it
doesn't matter I there's a lot of apps
on the web that just doesn't matter and
there's plenty that do and when it does
I always recommend putting something
more robust in front of it so using mule
and then feed them into Redis or
something would be you know great
example I think is publishing matter
there would be fine you're gonna make me
throw everyone I hope I don't anyone
there you go I mean so security it's
largely dependent on the technology well
it's not really actually you use a lot
of HTTP based security so you have a lot
of the same tool at your new exposure
because under the covers all these guys
use HTTP except for XMPP so it doesn't
really change the model there's nothing
new so there's not anything new they're
like they haven't introduced any new
frameworks around security cuz cuz it's
streaming you still you know you still
use OAuth for doing the checking and the
past tokens around because it's still
xtp requests the server can still get
those requests and handle the security
the same way you go
oh there you go with push you are so
definitely we push you are more
vulnerable because you're actually
opening up a new socket it's not over it
can be SSL but it's not gonna be a 443
it's going to be something new which
really the security teams don't like
generally and most companies will
actually say you can't do that on the on
the web and on the front of TMZ on
streaming potentially I mean there's
there's a lot of documented things out
there that could happen but the
frameworks tend to lean in to help you
not make those errors but there's
there's always some risk but it no more
risks than your REST API actually on the
streaming side all right
guys getting further and further all
right
yeah yeah actually Jenny does and Jenny
does it has pretty always been the
leader I think on the app server side I
think Tomcats implementation I don't
know how good it is I'm not saying it's
good or bad I haven't heard great things
but I haven't used this I couldn't
really say is terrible or great almost
all right well ok yes no streaming you
don't that's the good thing about it
because yeah yeah that the the bayer
protocol is you sent a request to the
server and it opens up a long polling
socket for you so that's why it's kind
of nice because it doesn't change the
the web paradigm that we have today it
doesn't create the new pubsubhubbub also
works on port 80 as well or 80 yeah
no exactly all that pushed all the
streaming technologies will work on the
same port so even you know WebSockets
the same some of the other the others
some of the push technologies don't so
that's pretty difference there as well
there you go oh god I'm running out
mules I got plenty more henna it's all
good
maybe just believe it's there yeah so
typically on the client side there isn't
a whole lot that's one of the challenges
so you'll notice anyone who publishes a
comedy API will actually have a very
rigorous sort of session timeout
variables it was sort of say this is
when the server will give up on you and
that's the way you manage it and
actually I think that's fine because you
always have that problem with you know
misbehaving clients don't always do what
they're supposed to do
so having terminating things on the
server is definitely a best practice
giving it a time window yeah it times
out yeah I mean you you can be nice
actually send a message saying you're
timing out because that allows clients
to reconnect and that's what I see Oh
Bayer does but it does not know that you
got there you don't I mean because their
client might not be there
well WebSockets is just the the
transport there's no protocol on top
yeah so sprout core or any one of the
other venting engines on top of
WebSockets pretty direct do provide that
you go grab a few more of these
I could be in which the server sends to
recognize to the screen whenever the
trunks are available and you could
actually hire or something again
yeah yeah exactly yeah well then the
good thing about comment I know if you
heard that question on that side but you
know the simplest streaming API could be
just chunking data to clients that
connect over a long polling connection
or even frankly TCP right the the what
comedy Avid's adds on top is a protocol
so the protocol is a thing that sort of
says here's my hand it introduces a
discrete set of steps for handshake
connects and disconnects and also for
meta so has this thing around meta that
you can extend the protocol to do other
things so having a protocol and Frank
just means that's one you you have a
discrete set of events we can plug stuff
in so it's not completely Wild West and
two other comment clients can also
access it so whether you're in
JavaScript or Ruby or anywhere else the
the XS is exactly the same but some
people have you know just do that the
TCP route and that's fine as well they
go
no actually no no and it's pretty
painful even finding information out out
there yeah there's not like this
presentation would have been easier had
someone had done them I'm gonna started
whether I'm probably ended with it but
no it hasn't happened because it's a bit
like certainly comparing apples and I
suppose you get to find your categories
and maybe I'll maybe I'll do it because
now I've done the works I may as well
share it if you have particular x-act
you know things you want categorize be
thrilled you know email me on those the
like and I can do that oh actually you
and then you yes
using example yeah
if you and all the technology doesn't
support it it well first I start on the
server side and I think you know I've
never got existing application what do i
what needs to be real-time here and
typically it's some some aspect that you
people were interested in whether you
like some API is really have filters for
example so you could see making flicker
adding a streaming API element to it
because you already has a very strong
filtering mechanism so you just codify
that back into something a bit more
usable and maybe you can just leave it
as it is we allow people to say and when
updates let me know about it right so
that's on the server side once you've
got that on the client side the API
changes anyway I mean there's there's
not many frameworks out there really to
have this baked in yet we we're sort of
doing it at hoc at the moment ourselves
will we actually pretty good have baked
it in with one of the existing or a
couple of this existing front-ends
technologies but there's nothing there's
no great answer there for that yet you
you really have to sort of sticks it
together yourself a bit at first yeah
but I mean for example if you use a name
Jax streaming API then jQuery already
has it built in and you just use jQuery
I mean with DWR I'm not so sure whether
they have that but you can use the two
together on one page as well you're
loading more libraries of course but and
you can do it got a three more all right
so a few more questions and then we'll
head out
oh I looked at that long hard I was
hoping someone would do it and it
yeah yeah I know so I looked at it this
socket IO is a framework that was built
I looked at a long time ago it didn't it
doesn't have a Java implementation and
no one has done it I think if I had
spare time my hands I pretty would have
done it myself but yeah I don't really
write much code anymore unfortunately
but yeah I I don't know I'd love to see
it because we'd support in a hobby as
well in your because it was a pretty
good implementation who's doing that Oh
Oracle testing
yeah no that's interesting okay I did
not know that thank you
yeah but you should get two meals so
that are anyway all right oh okay
I didn't what's involved in doing there
but it's based on Java so you know under
the covers you either use a JSON
language or and is flex JJ's our
language 1fx is that it
I don't think about FX I I should know
but like this never never went that
direction okay Oh does it I mean
wouldn't it guesswork or not is it
different link Java
oh yeah okay well yeah absolutely I mean
you just in embed the same clients as in
Java as you would normally
yeah
okay I'll let you guys but III because I
don't fronted technologies for me is is
like oh my god
you know I guess know what a good out
looks like I can't build it I can do the
backend for you
but issue I mean if his java it should
work good catch by one last question
anyone hey Yuri got one okay
sorry you can go ahead I'm kidding I'm
kidding
that sort of thing yeah not bad metaphor
yes sir mule in the second example
because a good question actually you
know I showed that we're using web
sockets and JMS as a sort of queue
manager and then Esper as the query
manager the thing that mule provided
there was in that real basic example was
just the app server but the difference
is is that every point where you saw
those components you can start plugging
more stuff in so you can do more
interesting stuff so for example when I
receive certain events I may want to
kick off events in other systems whether
it be Salesforce or you know - another
custom back-end system I can get plug
that in really easily so that the
example was basic but in reality what
you want to do is more stuff on the
server side when things happen tell all
these other things about it and you know
give me some results back you store that
somewhere else I might need to enrich
the data that I get mule makes it really
easy to sort of work with message based
technologies and and pull in lots of
different sources of data and then
create new events out of them yeah not
the last one there you go all right well
thank you very much I really appreciate
you coming so late on a Monday night</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>