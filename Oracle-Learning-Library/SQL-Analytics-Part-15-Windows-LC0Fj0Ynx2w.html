<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>SQL Analytics - Part 1.5 Windows | Coder Coacher - Coaching Coders</title><meta content="SQL Analytics - Part 1.5 Windows - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Learning-Library/">Oracle Learning Library</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>SQL Analytics - Part 1.5 Windows</b></h2><h5 class="post__date">2013-12-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/LC0Fj0Ynx2w" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to the next a series of podcasts
on Oracle's in databases simple
analytics my name is Keith laker and i'm
a senior principal prada manager for
data warehousing and big data at Oracle
in an earlier podcast we introduced a
concept called windows and this podcast
will look a little deeper how analytical
windows actually work as we discussed in
an earlier podcast windows can be
divided into two distinct types where we
have dense data we can use physical
windows and where we have sparse data
for example in a time dimension we might
not have sales every day in the year due
to public holidays we need to use
logical windows so let's look at some
examples of how these types of windows
are used in this first example we have a
dense data set you can see that we have
a stock price for today we're going to
calculate an average price based on the
current row plus the three preceding
rose so let's see how this works the
first point to notice that we're
ordering data within the window by the
time stone so we can simply move back
three rows because we have a dense data
set with all the required time periods
and the data is correctly sorted so we
can infer that the three preceding rose
will correspond exactly to the required
dates for the first ray the calculation
is obviously relatively simple price
from Ray 1/1 for the next row windows
expanded to two rows so we add the price
from Row 1 to the price and row 2
divided by 2 and we get the average this
process continues until we get to the
fourth row this is where our windows now
in its maximum size the current row plus
three preceding rose so when we move to
the next row a sliding window of four
rows now starts at Row 2 and stops and
pray five the window for computing the
average continues to slide through the
data until
reach the end of the table that simple
example hopefully explains have physical
windows work with dense data note that
the physical window is a fixed size so
how do we manage data that is sparse and
or contains duplicates the first point
to notice that we change the syntax of
our over clause the ordering is still
the same using the time stone column but
the shape of the window has changed so
that we're now building a window based
not on Rose but on an interval of three
days and we can use other types of time
periods if we need to such as months
quarters or years this is subtly
different to the previous example
because here is not possible to just
step back three rows with the Assumption
this will contain the required data
looking at the table if the current row
is seventh of April then stepping back
three rows would mean including data
from April of the third and that's
outside the time limit defined and air
into applause therefore we're going to
use the built-in time intelligence and
set the interval as three days and let
the database automatically size the
window according to the day within our
time step so where we have duplicate
data you can see that the database
calculates the final average across the
duplicates and then applies that average
to all of those duplicates to compute
the moving average for the third of
April we need to include the duplicates
for both the first of April and the
third of April and again the average of
the duplicate rows is based on the final
average for all the rows within the
window which is then applied to the
required Rose when we get to the fifth
of April the range of three days only
covers the fifth of April to the third
of April and then it does not include
the first of April which is as expected
so as you can see in this example the
size of the logical window is actually
dynamic it's changing to match the data
set the analytical window feature allows
us to calculate many different types of
calculations such as moving average
centered averages cumulative running
totals and we can use the time and where
logical window to ensure we include the
correct data points in our calculations
so let's look at an example of using
some of these features in a single query
we can actually create aggregates at
different levels and in this example
we're reporting the sales within each
region by salesperson the total sales
for each region and the total sales for
all region so you can see that we have
three different levels of aggregation
within the same query the first
analytical function groups the data by
region to create a regional total for
sales the second analytical function
creates a grand total for sales the use
of the blank over sin tax generates the
final table total across the whole data
set now we have our basic analytical
data set we can actually apply
additional filters over that result set
to get more insight and this highlights
one of the key benefits of using
analytical sequel is that you can use
any of the other sequel features and
functions alongside these analytical
sequel features and functions so using
the different sales totals we can now
easily search for regions that are
contributing more than fifty percent of
total sales and where our salespeople
are contributing more than eighteen
percent of regional sales and to do that
we just add our where clause and filter
the result set so the first step is to
find the Rays contributing more than
fifty percent
of total sales then we need to find
sales people who are contributing more
than eighteen percent of regional sales
which limits our results set to just the
first two rows of our data set so I hope
these examples have given you some
insight into the real power of using
electrical windows and how they can be
used to create different levels of
aggregation within the same query
finally we've shown how you can use
those analytical features to drive very
sophisticated</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>