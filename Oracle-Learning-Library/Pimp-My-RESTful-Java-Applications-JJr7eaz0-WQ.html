<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Pimp My RESTful Java Applications | Coder Coacher - Coaching Coders</title><meta content="Pimp My RESTful Java Applications - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Learning-Library/">Oracle Learning Library</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Pimp My RESTful Java Applications</b></h2><h5 class="post__date">2013-01-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/JJr7eaz0-WQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Malik Boetticher and I'm a
software engineer at Oracle let me also
introduce my colleague ocupada shock who
is also software engineer Oracle and we
together work on project jersey which is
a open-source a project for providing
the implementation of restful api for
for developing for restful api restful
web services API in Java it's an Oracle
sponsored open source project is part of
the larger project glassfish so Jersey
is the implementation that's being
included as part of the GlassFish
application server by default for
providing jax-rs API implementation
jerseys are also a jersey also provides
a restful impairment implementation for
Jack Sarah's API and by the way I'm the
jax-rs api specification elite also so
on top of working on the implementation
we are also coming up with the API and
today we are here to talk about what's
new and coming in the next major release
of Jersey to the doll which will be
focused on providing the reference
implementation of jax-rs to the doll API
and that will be released sometime very
early next year currently we last Friday
which acts as a PIV we Came we published
the public review of the specification
public review draft of the specification
which means that currently there is some
period where you can all look at the API
the APR should be already stable and you
can provide us with feedback anyway in
this session we aren't really not going
to talk about the standard stuff we are
going we are trying to reach beyond
what's what's in the standard and what
you can just do with jax-rs and we are
going to look at how you can use some of
the jersey specific features so that you
can develop your web services may be
more conveniently add more conveniently
additional features that Jersey provides
on top of the joxer's API so why we are
coming with you
with why we why did we decided to come
with a major release of jersey with with
Jerry to the doll if you look at now if
you look at the diagram you can see that
the in 1 dot x version there was a jack
sirs API and then Jersey provided the
implementation for the API and also
added some additional features such as
filters client API it also had some
internal injection manager manager I
will talk about it a little bit lighter
and although all those features were
missing in the jack servando Dex I API
so that's why Jersey was providing these
features as a proprietary extension to
the jack sirs API and since this is
changing in Jack tars to the dough so
injectors to the doll basically the
client API filters and interceptors and
a bunch of other stuff is becoming part
of the API it means that the API becomes
standard at the same time it's a little
bit different API so if you ever used
joxer's if you ever if you ever used
jersey api before the client api all the
filters this api is similar but it's at
the same time not backward compatible
it's different it has it sits in a
different package obviously it has
little bit different signatures on
methods and it also it's more more major
i guess i'm even more advanced than the
original api provided in jersey so we
did with that ok so in in dirty too we
are going to focus on adding some
additional cool features in the aps such
as programmatic programmatic resource
builders chunked io supports support for
json SSC and such and such as well as we
decided hey it's probably good time to
rethink our philosophy how we are how we
are internally designing designing
Jersey code base and we decided to take
the proprietary Jersey injection manager
that we spend quite a lot of time on
updating keeping up-to-date and
providing support for and we decided to
ditch it and replace it completely
the video of the self solution basically
provided by HK too so it's the same
injection manager that glass fish is
using and we are basically not deferring
to that injection manager instead of
having our own proprietary Jersey
injection manager so the also the
layering changed why I'm told why I'm
mentioning this so so the question was
if you have the jackster application
wondered oh and you are migrating to to
dot over if there's an easy migration
path yeah ok so just to answer this
question the the backward compatibility
is in the jersey proprietary ap is
backward incompatibility is in the
jersey proprietary ap is obviously
jax-ur as a standard Java API must be
backward compatible so if you have only
Jack stairs applications the there is
there is no problem with migrating your
applications you are you can just ended
into the double API we are adding new
features we are not changing any
signatures Lee as a matter of fact we
are not allowed to do that we just very
briefly change some signatures and
suddenly all the tests started to fail
so we obviously had to immediately
revert all those even those very minor
changes that we even thought would not
impact the API so in the jackster api we
really make sure to have to retain the
backward compatibility and there is no
problem with migrating applications
anyway you reminded me of something what
I wanted to ask you we are going to show
some code and I'm not sure do you want
to take the questions as we are showing
the code and there is that we are not
going to show you everything we want to
show you today or do you want to keep
the questions for the for the complete
afford it for the end with still with a
little bit of risk that we are not going
to be able to show you everything you
want to show you today so who wants to
take the questions as we are showing the
code please weekend okay only couple of
you so who wants to really defer to the
end
oh okay okay who doesn't my doesn't care
okay so i think we are we are going to
take the rest of the questions hopefully
in the end of the sessions and if you
don't make it and they will kick us out
we will be kicked out outside and you
can approach us and we'll talk about it
anyway so let's move quickly a little
bit more about the jersey to the doll
project so what we are doing as I said
it Jersey to the dough aims to provide
the reference implementation for Jax
ours to the dull since Oracle is leading
this bag and jerseys or a co-sponsored
project it's typical that the reference
implementation is coming from from this
from the speculate company the the
prototyping of the project the early
work started in 2011 and in that phase
we basically decided to really well as I
showed you those diagrams in not only
the diagrams are different we are really
talking about completely different code
bases here so just to the doll has
nothing to do with George the one total
code base we just we just made sure that
we migrated all the Jersey wanted all
tests so that we are sure that we are
not introducing any you know bugs as we
are changing the change changing the
replacing the code with with a new stuff
and and that we don't introduce any
regression regression boxing in the
jersey to the dull code base so the
truth as I said prototyping starting
into the 2011 and we released the first
public milestone which was very limited
in functionality sometime early in 2012
in February and we Jersey to the doll we
started to really do more of a scrum
based project development so we are we
are having mostly for weeks sprint in in
the summer during because of the
vacations we prolong we had some six
weeks print development sprints and the
latest milestone that was released about
a week ago is milestone 8 and currently
covers about ninety percent
of all the tests in jax are stood at all
so basically we are almost on par with
with the jackster Studio features
already be implemented everything all
the releases that we are doing our
announce either on a Twitter or I'm on
my blog i'm blogging about every release
mentioning all the major major feature
so if you want to check what's being
implemented just go through the blog
entries and ago you should be able to
get a feeling of what we are adding as i
said since we are coming with the
completely new code base the backward
compatibility is little bit gun also due
to the jax-rs api changes and the
features being taken up there we decided
to also kind of we decided to make sure
that we are also compatible or we are
following the same package and maven
group ID partner pattern as the rest of
the GlassFish based project so we
changed the maven group ID as well as
the root package ID and we are creating
basically new API is based on those
things that you learn in Jersey wanted
all and didn't quite work well we are
trying to make sure that in Jersey to it
works better just to give you feeling
when I'm saying that that the Jersey to
the doll provides not only the reference
implementation those boxes this is the
current state of the Jersey modules all
the modules that we are all the maven
modules that we are providing with
Jersey don't bother with with names just
to just to see just to check that all
those orange boxes are part of the
joxer's RI and everything else is extras
so so and I'm not even showing and this
is just the runtime and I'm not showing
additional extra things like all the
tests that we are having their all the
examples that you are providing the
documentation stuff like that so as you
can see there's a lot more in Jersey
than just the jax-rs RI so if you want
to leverage the additional features that
are provided by Jersey obviously can
okay so now let's move on really too
to some of the features and and what
start with how would you how Jersey can
help you too to configure deploy and
test your applications now in jax-rs in
a standard jax-rs if you are deploying
an application and you want to configure
it you have two options well defined by
the specification you can either just
let the specification scan the class
part and all the all the classes I'm
taking it at part or at provide your
annotation that will be found and unload
it for your application this is good for
development but it's really bad practice
for for for a production why because if
you have a library that happens to have
some provider that you really don't want
to include or you even don't know about
it well obviously an X on the class but
you obviously don't want to include that
that provider in your application so it
might be even a security problem so
that's why you shouldn't do it and
instead you should really just extend
the application and in the override the
gate classes and or get singleton
methods and return all the list of all
the classes that should be that should
be a part of the application whether
it's the resources or or or providers
that's how you do it so you create a
hashmap basically populate with all the
classes it well sometimes you may even
forget about when you add a new class to
package you may forget about it so
that's not very convenient why how to do
that so that's why in Jersey we are
coming with an extension of application
class which is a resource config it's a
mutable class and it provides the
mutable API that jakub will be showing
in a moment for essentially adding the
properties classes instances even the
new programmatic resources that we are
adding in Jersey to your custom
injection binders based on based on the
injection binding API that we are
exposing as a new API as well as a
resource finder so that you are not
really need to add the instances and
classes you can just really tell the
tell the config to scan the particular
package and find all the resources in
the classes to
to scan particle files and cetera and
you can combine these approaches to
assemble your application so let's say
even if you have your own classes
residing in your own packages you just
you would just use the resource finders
to scan your own packages and then you
know okay so i have this third-party
library which has like millions of
providers but i want to use only those
three so just add those three to your
application using this using its
programmatic api of the resource config
oops sorry as for deployment and we are
there is a standard way how we can do it
but that standard way only lets you kind
of somehow if it's available create an
endpoint whatever it is typically it may
be java is eli to HTTP server endpoint
or grizzly endpoint or evolving server
deployment you are not doing that
because you are just deploying to some
running application server in jersey we
are coming with a with a container in
Jersey to the dough we are coming with
the container SPI that exposes two main
classes one is a container provider
which basically lets you create a
container and then the container which
is the kind of represents the instance
of the container and lets you do
interesting things like well start stop
and but more interesting reload or
reconfigure basically you can at the
runtime just change your application
passing new configuration passing new
research configure the new application
and just say reload and the container
will reload video with the new
application while making sure that all
the old clients currently communicating
with the application will still will
don't lose connection and will still
work on the audio and communicate with
the old application until and once the
once all the clients died basically you
are going to you are going to see that
all the new connections all or the new
client connections are going to be to
the to the new version of the
application as for testing again how do
you test the application so in just
below we are coming with with the
Chargers the test framework where it's
based on the J you need the
I a base class and provides a couple of
metals that you may want to override and
and extend so that you provide and
basically the jersey test framework is
written in a way that you can test your
classes in a variety of containers
because we are able to do to the
Container API we're able to plug in
seamlessly different different
containers currently be support in
memory container the Java Sea HTTP
lightweight server the Grizzly and the
external which means that you are
deploying your application to some
external external server whatever it is
Oh typically it's a servlet base or Java
EE server and what we also plan to do in
english test framework is to add support
not only for just Jersey client
implementation but also for various
different implementation of the jax-rs
client API so that you are able to
really test portability even on between
the different client and server
implementations using the jersey test
framework I think with that I would hand
over to yaqoob so that he can so that
they can show you the demo of what I was
just talking about how can you hear me
yes okay cool so I'm going to show you a
basic demo so we'll be deploying a
simple web service and then I will be
implementing a test for it so that you
make sure the resources working fine and
this would be done using the Grizzly
container that the implemented support
for in in Jersey so can you please raise
your hand with a handsome experience
with jax-rs okay quite a lot of you so
who hasn't touch it never okay so i'll
be starting with so here i have a
project the only thing i had configured
there is the dependency so I've put some
some Jersey modules in there but
otherwise i'm writing from scratch so we
will see how to to develop a jersey
based application so i'm going to start
with adding a simple resource so i'm
creating a new new Java class I will
call it session resource and this will
be really simple jax-rs staff I hope you
can you can read even from there could
you please okay thank you so I'm going
to bind the resource to the session URI
I need to import at path sanitation and
I'm going to implement a simple method
that would respond to HTTP GET so this
method will produce text response and
we'll just return a stink
fixing imports and now this thing would
be would be my pattern will be returning
the the idea of this session which is
called 7 11 45 not mistaken so that's it
I got a simple jax-rs resource nothing
new yet so now i'm going to create a new
jersey application that would take the
resource and make it make it available
for the client so that will start a
grisly container so i will call it a
jersey up and here mark mentioned that
we have a concept of resource config in
Jersey so I'm going now to introduce the
the main method this will be the main
entry point for the application and I
will create a resource config and use it
to start a container so I'm creating the
main method
just that I don't need to bother with
tight edge blocks for sake of simplicity
so now i am going to create a new
resource config like this I'm passing it
the the session resource class and just
to separate it from from the other code
i'm going to introduce a special method
for four days called create resource
config like this so now we have some
utility methods in in Jersey to start
the Grizzly container so I'm going to
use our grizzly HTTP server factory to
create a grizzly HTTP a container for me
so I'll pass and URI to it and the
resource config so I'm going to choose
this factory method I need you are I to
bind the new application to so i will
just create a new one attach it to local
interface port 8080 and I will pass it
the resource config I've just created
using that utility method billo see
what's what's wrong open it up a bit
okay so I need to fix the import okay
and I need to fix this as well so I hope
you can see just just a single line of
code and I've retrieved a running HTTP
grizzly container maybe I i should also
handle stopping so i will just wait for
an input from the console like this and
then i will ever stop the server so i
need to keep it in a variable like this
and now if i press enter I'll just call
server stop like this so this should be
it I'm saving and I'll tie to to run the
application to see what happens ok so
the container is running and I can test
it from the browser so switching to the
to the browser and it should be
localhost 8080 now session and my finger
turns
let me let me see
person
should be all right I didn't expect an
error that deadly it should be it should
be started already so
okay does anybody spot any any mistake
okay I / in the session I don't need
that I don't need that so okay so let me
let me cheat a bit I I don't want to
waste time so i will be i have a
completed application here so i will
just sorry for that oh never mind so i
will just copy this and this or maybe I
can just restart think it must be
working so clean and built and hopefully
but it's only baseball
that's the mum
okay let me let me copy the stuff I
don't need to show you what what's going
after so let me stop this one first
copying the application
libertas as it is i'm going to delete
this one and foreign
yeah yeah this is different because as
you know it was supposed to be evolving
during the demo so I don't know what was
wrong it's it's an early early access
stuff but it didn't happen aight aight
aight several times before so now i'm
going to rewrite a bit so i'm going to
rename first and now i'm going to so
maybe i can i can stick with this
configuration so i'm i'm using the
packages method so that i can configure
wear a jersey should look look up the
resources and this should be this should
be this should be fine so i'm also going
to maybe copy the decision resource over
to here I want to delete this one first
and ok session resource and now
my best shooters left it lasted are
anyway so
like this and now I can try to rebuild
and hopefully it doesn't doesn't need to
be there so it is better of course no
poor children be taken with can I think
anything else Wow
let me stop this guy first for my bi
come
this is interesting it doesn't doesn't
respond so maybe in the meantime while
you are debugging the session I'm going
to try to proceed with the with the next
section so that we are so basically
typically that works that and I saw it
working you can trust me yeah so
basically when you are when the basic
stuff works we can we can move on and
try to add additional additional thing
so rather stuff that we are adding in
england jersey on top of jax-rs either
one the doll or even to the dull
features are JSON the custom injections
that the API have to provide the
injection binding sadly enough at the
moment not even a CDI doesn't provide a
completely good way how to how to
programmatically define your in your
custom injection bindings I know there
is a there are ways but it's nowhere
near the API that just provides for
instance as well as manager acing and
i'll get back to now and i'll talk about
what does it mean the man chasing so
let's start with the JSON support so
again unfortunately there is no standard
JSON parsing and binding API in Java yet
it's coming there will be a parsing API
in java ee 7 introduced or we although
there will be i was told that will be
the rights english phrase for something
that may not happen again but now
hopefully let's let's hope it going to
happen still the problem is that in the
jacks our specification we are releasing
earlier than jsonp and that's why we are
not able to you know to have a hard
dependency on a json api even even not
on the Jays and parts of the API
we are going to be part of the same
platform version and that's why we are
not able to include the JSON support not
even for parsing in indy jax-rs and we
need to rely on on on the support
provided by the implementations in a
proprietary rights so hopefully that's
going to change in a maintenance release
of jax-rs to the dough some some
somewhere in the end of next year or
maybe early 2014 and the binding API is
even further back so it's going to come
on in Java 8 and the solution for that
is basically to use the Jersey Jason
extensions and basically Jersey has a
media extensions not only for Jason but
also for other stuff and all the all and
currently as for Jason Jersey provides
support for for all the major existing
Jason Java frameworks such as Jackson
jettison but the new thing that is
coming is an a preferred way of a
preferred extension from from our point
of view is to use moxie why because it
provides the full jugs be support are
not only for Jason but also for XML and
obviously a couple of additional
features that is being able to use the
XPath expressions on your on your own
your beans and works not only in XML but
again in JSON so basically we we feel
that Moxie's the way is the right way to
go I think is the most major framework
out there also another thing that we are
we are adding early in Jersey one if you
wanted to provide support for Jason P
which is the way of sending json data as
a as a JavaScript function so it's like
basically name of a function and then
all the colleges and data are inside so
that it for that you had to create a
special wrapper for your data in Jersey
to you don't really need to do that you
just add annotation to your method at
jsonp annotation where you can specify
additional things like whether you want
to
change the default adjacent be named to
from from from call back to whatever is
custom or whether you want to let users
let the client specify where I a query
parameter the custom name of the call
back so that's all possible to configure
right the annotation and you really just
returned your JSON data and it will be
automatically wrapped using the jack
sirs to the Interceptor into into a
proper format and the cool thing is that
this is going to happen automatically
and only if the client requests the
JavaScript media type back if you just
request the JSON the wrapping of this
doesn't happen at all so based on the
client accept header and based on the
based on the configuration of the of the
annotation or based on the Curie
parameters you are going to be able to
return back the JSONP data another thing
we are adding we are changing the jersey
as i said earlier jersey had had its own
solution for injection management and it
had all it had its own specific API
which was based around injectable
provider factory and injectable provider
in Jersey to do though we are relying on
a dedicated hk2 injection manager which
is as I said used in glassfish and it
provides a flexible programmatic API so
we can really just use the fluent api to
build your extensions to build the
others are instantly to give your
injections you build your own custom
injections and it also provides
out-of-the-box support for inject a
notation and the whole just are 330
dependency injection api what we are
still planning to do is is to leverage
the the plant support of HK to to
integrate with other injection managers
such as cbi juice and spring which
basically for us means that all the
jersey users can use the same api to
define the bindings and then whatever is
the underlying injection manage
all those new injection binding all
those new custom injection bindings will
be properly propagated to that other
injection manager and the also the
bindings defining the other injection
manager should be vice versa available
in HK to why the integration layer also
another thing is that well yeah so
basically here you can see also kind of
an example of a API you can extend the
abstract binder and then override the
configure method and basically if you if
you have a reward with juice it's very
similar even though so i think the Jews
gather api almost right and we got it a
little bit better because in the jews
you bind the contract and another
contract and then maybe you add the
service class and scope and stuff like
that but that doesn't get doesn't read
let you retain the type information
about the service so we reversed it and
instead we are starting starting with
the service and so we are binding a
service to set of contracts and by that
we are able to do compile time check and
type type say and we are very able to at
compile time know whether this service
is really supporting that contract and
we will we are able to show you the
errors in the ID if you are trying to
bind a service to a contract that it
really doesn't support and that's
something that just doesn't provide at
all or is not able to provide because of
the other way of binding the API ice 4d
as for the managed server side
asynchrony the thing is that yeah so
sometimes good features don't making it
into the API for various reasons this
case the reason is red hat
we have access to the API comes with the
asynchronous processing for for services
anybody is not familiar with the concept
of asynchronous processing should I
spend some time talking about it just
raise your hand okay so not too many let
me so just very quickly the thing is
that when you when you are when you are
when you are processing the data
typically the work pool of the threads
that are processing the data the i/o
container has only limited set of
threads and while you are processing one
request you are not able to process the
other requests if the if the I of
container thread is blocked by a process
request so the principle behind the
asynchronous to offload this processing
to a different thread pool and let the
i/o container threats be free so that
all the requests can be processed
basically at at once and you can use the
other thread pool to really scale your
processing your processing rates better
while not blocking the aisle container
threats so that's basically the main
principle one thing that you need to be
aware of is that if you are offloading
the first thing to different threat and
you are not informing the container that
you are doing it it will often like it
will automatically close the connection
when the workers thread is freed and
basically are not able to send any data
back to the client side so that's why
you need to have some way of API that
tells the i/o container hey I'm done
with this thread but please don't close
the connection i'm going to take care of
it later so that's basically the basic
principle why you need a special API for
asynchronous processing and if you are
offloading the pressing to different
thread so what are the options currently
you can either use the async ejbs for
for spawning new thread or you can spawn
on your own thread if you're running in
the jaw a container of Bill sanandaj a
layer architecture really thrown upon
you because you are not supposed to do
that
all in enjoy a container and or you can
basically pray for a concurrency API
tomara materialized in joy 87 and unlike
Jason API which really is going to
happen this one is not social I'm not so
sure about so that that API should
provide the concurrence utilities and
workers for java ee 7 which will which
would basically which would replace the
need to spawn your own threats but as i
said i'm not sure if it's going to
happen or what you can do is to attach
at manage a chasing jersey proprietor
annotation to your resource and once you
do that you are informing the jerz
container that it should run the method
in a separate thread and automatically
inform the container too well to do not
do not close the connection and and it
and basically let you close the
connection or send the response as as it
is convenient for your for your
application so you could wrote me a
message that it works now hopefully and
i'm switching so i'm switching back to
him and I let him do all the demos where
you can maybe I apologize for that was a
network glitch I part unplugged
everything Wi-Fi and and then the
network cable and why it works so i
would like to ask what would do what do
you want to see because i don't think we
have enough time to cover everything so
a sink manage a sink support the first
first thing Jason support then Jersey
test framework so wants a sink support
okay Jersey test framework and Jason ok
let's most demand it so I will start
with Jason then the nice thing and then
then
the straight world so let's let's see
what i have here so this is how I left
that just to prove that it works it
started at and running so yeah I can I
can also try I from from cattle command
line client so now I will tie to
sometimes it works you want to be the
network yeah using the loopback
interface so now what I will do is I
will create a new new beam I will call
it a session bean a doe session so that
it could be used for the JSON processor
to populate the JSON data so this will
be just a you know data data Papa Joe Oh
Joe class so it will have maybe an ID
then I will put our title and to show
you something else than plain string
values he'll also have a kappa capacity
just a demonstration so we'll make it
public as well and i will ask i will ask
that beans to give me some career
convenient constructor for this so i
will need a not know arc 14 moxie
because i will be using Moxie to
sterilize json out and i need another
one which will take some arguments to
make to make me happy and to be able to
to quickly create instances of sessions
ok so that's that's it i have a data
pool Joe and now I am getting back to
the session resource and instead of
returning staying i will just return the
the bojo i will create a move on
here well maybe use this session data
for this so I don't recall the name
let's call it Jersey to coding session
and capacity I don't know okay here we
go so now what I need to do I just
change the jacks are AC source and I I
now need to get back to the resource
config and make sure that i configure
the Jason support properly Jersey one we
had default setting for this but Jersey
too we don't have anything like that we
need to explicitly configure what kind
of Jason processor you you wish to use
so what I'm going to do is I'm going to
update the resource config and I will I
will up okay at binders method I at the
Moxie binder which is available so
basically the Moxie Jason binder is not
only binding the providers it's also
binding it was all its own custom
injections which it internally uses and
it's basically using this new binding AP
a new injection binding JP I was talking
about prism ok so now i will try to
restart the application let's see what
what now i'm getting oh I i forgot to
update the produces that produces
annotation so I don't need to specify
that I'm going to produce I can put it
here or here it's maybe better so I'm
going to use the standard jax-rs of the
annotation that produces and they'll use
application Jason media type saving now
and going to restart again hopefully in
a bin so
recompile for me if not I'm going to do
it explicitly and now let's see what
what happens here so I'm asking for the
same resource and I'm getting that the
JSON populated for me you can see that
the capacitate sits really a number it's
not you know I I cook you could see
maybe in Jersey van we had yet doubles
two to get get this work so this is this
is marshaling of jaisa so now we are
running out of time so maybe now I can I
can show you the manage a sync feature
so what I'm going to do now is I'm going
to wait here for five seconds I will
prolong the response so that the the
client is not service data right back so
I'm going to use this thread sleep
method I'm going to wait for fifty
thousand milliseconds I need to fix
something here so let's see okay i'll
use the thai cache block and now again I
need to restart the application okay and
we'll see I want to reload this waiting
for local host it's here and now we got
the response so so far so good just one
single client it's not not an issue so
what I'm going to do is I'm going to use
shell here first I am going to ask for
it once more to make sure it it works
here a single client and now i'm going
to launch some more clients so lunch
maybe 100 clients
and I'm going to use the curl command
again put it to the background and I'm
done so I'm simultaneously running 100
pearl clients and asking for for the
resource so you can see if I if I list
the jobs here and I will tell them that
I got some responses back but some
clients are still running so does the
reason because by default only five
threads are available and visible only
five connections at the time five
requests can be served so others are
waiting in a queue for the voltage
threats will become available so that's
the same case that's that's that's why
the in some cases where you have the
building operations the same case
doesn't doesn't really is not a really
good option okay so now I'm done yeah
so can I come you can you answer the
person later okay so now what I'm going
to do I'm going to utilize the jersey
managed a sync feature here i will be
using the standard standard jacks sipi
so i will use the suspended at suspended
annotation i will ask the a sink
response to be injected here like so I
don't need to return anything from the
from the method oh excuse me so I will
be just returning void and hear what I
want to do is I I just I just asked the
response to resume after five seconds
and I will pass it the data to be
returned back to the to the client like
so so again I'm saving this restarting
the application they started and now I'm
doing the very same thing again so
hundred clients again simultaneously
running against the the server one two
three four five let's see so how many
jobs select running zero since we
offloaded basically all of the three all
of the requests have been choices
advanced by the or sir advanced because
those five threats were just passing it
to the other thread pool that was really
doing the sleep so now I don't know
whether we are going to take questions
or I think what we can do if do you want
to see this SSC example or do you want
to take questions sorry Jersey test so
you want to sit as you don't want to see
SSE support okay okay so who wants well
who wants to see test and who wants to
see test SSC server sent events so
basically we have a chunk processing you
can stream the data there is yeah we
have we have a example of streaming data
from Twitter life and that's not the
WebSocket WebSocket is a different
specification it's not okay so if you
want to see SSC okay I have kind of
ready and basically I'm just going to
show you a demo well or maybe I can
pitch around through d4 the slide so
basically we provide just the important
thing to know is that we are adding
support for corporal processing chunked
streams and basically in a type safe way
so we are not really able you are not
really needed to process it as a stream
you can just read chunks of type data
let's aim messages you can you can do it
generically but we have also added
additional support for specifically for
the SSC protocol which is currently part
of the html5 and is also supported on a
javascript in the browser conveniently
this is how a message how SSC message
look may look like there is a command
and there is some ID it's an optional
then again event it's some arbitrary
even name which is also optional and
then some data which are not optional or
separated by by a blank line and then
you can have another another SSE event
so basically except for data everything
else is optional that's that's the
format of the assessee event and that's
what you would see on a cc stream and we
are providing some some some API for
working with the sse streams everything
is also this example will be part of the
jersey example so you will be able after
the session to look at the code and play
with it more so the demo what it does is
really using the Twitter streaming API
and their cells there is an something
that I call aggregator
connects to the Twitter and streams the
data stream JSON data it extracts only
some of the JSON data into into a
proprietary message object and uses a
resource to put the data into the
aggregated resource where another
clients can connect and get older and
stream the stream all the messages from
the resource while SSC so this way we
can use even multiple aggregators I have
a test aggregator we just randomly send
some messages so we can we can turn turn
both on and we will see that multiple
message sources are aggregated into a
single stream of SSC data internally the
message aggregator is implemented as a
Twitter client well that the Twitter
aggregated is implemented Twitter a
client that post the messages into the
queue and then there is aggregator
client which puts the messages to the
resource that is done streaming them
while SSC so let's let's switch to the
no let's switch to the browser now this
is basically a way this is basically
that the Twitter API you need to you
need to be login that's my Twitter
account so it requires at least basic
authentication and I'm now basically
tracking a hashtag beer so all the tweet
about the beer should be slowly coming
up well what many people are talking
about beer at the mall somewhere so okay
so these data are coming and these are
the data that are coming into the
aggregator which is done basically
parsing them this will be something that
I'm going to show a little bit later and
this one as well so those are those were
those were the Twitter JSON data let me
now show you the application so this is
the swing application as I said I have
the Twitter aggregator which will which
is green will be sending messages with
the color green the
is the test aggregator which just sent
some random stuff so let me add a quick
keyword that we are going to the track
we can also track for the beer what
should L what else should we track jawan
ok and let me start the aggregators yeah
so and basically I'm connecting some I'm
getting some messages here and i'm
posting it to the service and the
service is up and running you can see
the new messages are being received on
the service side and in the browser
window that's what I'm going to show so
this is the service this is the service
stream that is going to be sent back
from the browser it can't connect to get
the street to get the SSC data so yeah
and basically I missed first message e
so as you can see it's basically the new
messages are still coming still coming
70 178 so well whatever so this is again
the the Twitter data compressed into the
form that I'm interested in so I'm I
just want to see the text of the tweet
and the profile profile image URL and
then I'm adding the the color of the of
the message of how it should be
displayed not in a client so as I said
the it's the SS is part of the SS is
part of the html5 standard so there is a
really nice there is no I support for
for even the JavaScript clients or where
am I so let me show you how I how I can
implement a very simple JavaScript
client that consumes the sse event so
basically I have the even source
listening on some URL and then basically
I'm registering the function on on that
source when whenever a new message comes
and since I know that I'm sending the
JSON data as part of the SSC event i'm
using the json to
the building json parser to parse the
data and then I'm basically producing
some deal to displayed so let's look at
how it how it really works in the in the
browser if I access the if I access the
page that uses this JavaScript Oh as you
can see i'm basically seeing the data
the blue ones are coming from the test
client as i said the green ones are
coming live from the twitter and I'm
displaying the the profile image URI and
the tweet itself so and in the color of
the message aggregator amusing so that's
basically the basic sample I think we
can now as I said we don't have time for
code so maybe we can take some questions
and we can do it even while twitter if
you want to send us some time so don't
just stop it remove the remove these so
so what should be the hashtag we should
be listening two minutes away I don't
think we have Java you know so
Jason for days
how compatible is
or to migrate from the jury
the question was about the disease NPAPI
so currently we know how the jay-z jay-z
MP API would look like and we have some
kind of applications already using it so
we are probably going to include this in
Jersey so that's no question about that
but what I was showing was a Jason
binding API where this is not going to
be included in Hawaii server and we will
need to wait for maybe joy a I you know
it's not going to happen soon so we have
the proprietary API and yeah fell apart
a box a box library and another support
is provided by jackson library so we
have a provider for that and jettison we
have something as well but you can plug
in your own implementation so it
shouldn't stop you from being able to
use another third-party libraries sure
so one cool thing about democracy for
instance is that as you saw these large
chunks of data that we're coming from
Twitter and I was only interested in in
getting the text the profile image and
then I was adding so well from from
those Twitter large set of the data
which were nested I really want to just
attack than the profile image which was
somewhere nested inside that so here I'm
using this message object which is a
POJO to get the data and basically I'm
just defining okay so I want to text and
then i'm using xml path to to get the
profile image from somewhere inside and
basically the democracy does it for me
so it ignores all the rest of the data
and just populate this these two these
two fields with with with the data I
want so that's really cool feature I
guess okay I guess we are timed out now
we can take the questions outside will
be will be there we need to pin
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>