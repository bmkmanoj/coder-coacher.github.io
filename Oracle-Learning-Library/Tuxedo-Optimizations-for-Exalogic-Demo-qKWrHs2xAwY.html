<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Tuxedo Optimizations for Exalogic Demo | Coder Coacher - Coaching Coders</title><meta content="Tuxedo Optimizations for Exalogic Demo - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Learning-Library/">Oracle Learning Library</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Tuxedo Optimizations for Exalogic Demo</b></h2><h5 class="post__date">2013-01-24</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/qKWrHs2xAwY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi I'm Mark lindros a principal
curriculum developer Oracle today I'm
going to show you how to configure
tuxedo to use optimizations available on
the oracle exalogic platform first you
learn how to configure tuxedo to use a
shared application directory for two or
more machines I also show you how to
convert a standard tuxedo to machine MP
configuration to use shared memory cues
instead of IPC message queues infiniband
networking that provides extremely fast
networking performance between compute
nodes in an extra logic environment
socket direct protocol networking or SDP
that bypasses the standard tcp/ip stack
for high performance data transfer and
remote direct memory access or RDMA to
bypass tuxedo bridge processes which are
responsible for communication between
machines configured in a tuxedo
environment this is the architecture of
the environment used for the first
demonstration it's a basic tuxedo MP
configuration it consists of two
machines connected by tuxedo bridge
processes the site to machine hosts to
servers called ping server that simply
accept requests and return replies there
are also two clients client ping which
is a native client at WSC pain which is
a workstation client client pain runs
insight one and makes twenty thousand
requests over the tuxedo bridge to the
ping server processes on-site to the WC
pain client is compiled from the same
code as a client ping client the only
difference is that it's remote client
that connects the tuxedo using the
workstation listener or WSL process over
a network WC pain runs on site too and
connects to the wsl process of site one
to ensure that there's a real network
hop between the client and the wsf
server the WC pink line
also makes twenty thousand requests that
travel from the client over the network
to the wsl process and then through the
bridge back to site two and two one of
the ping servers there the client ping
scenario shows a single network round
trip and the WSC ping scenario shows a
double network round trip this example
uses a shared apt dear all client and
server executables configuration and log
files are located in the same shared
directory which is accessible from both
exalogic compute nodes all the examples
in this demo use the same shared after
this example uses standard tcp IP for
networking as shown by the host port
syntax used for the bridge and wsl
processes we start off with two terminal
windows one connecting the site one and
one connecting the site to site one
represents a tuxedo master node and all
unique configuration and main
administrative pasts are done on this
terminal window any administrative tasks
that are meant for a tuxedo slave node
are performed in the site to terminal
window so the first thing we're going to
want to do is we're going to want to set
our environment we have a steady and V
script for that and we want to run it on
both machines and the script sets the
environment based upon which machine is
running on so we're able to use the same
script for both machines let's take a
look at that file so we've got our tux
dear said we've got tux to your bin set
in the path we've got tux to your limp
set in the lib path we've got a couple
of environment variables set for
internationalization so we can view
tuxedos instant messages we've got apt
near to find tux config and what we're
doing with tufts config is we're putting
it in the application dear and we're
we've got a suffix of the hostname so
that we ensure that the tux config for
each machine has its own unique file
name so that we don't get them
overriding inside of the share
application directory and then because
we're going to be using workstation
clients we're going to set wsn adder to
the host and port of where the
workstation listener server is going to
run which is on site one at port 4000
now we're starting off just verifying
that we have a multiple machine
configuration working so we've got this
in you BBMP and we've got a pretty
typical configuration here it's the
models MP options or land we've got our
master machine set up a site one our
slave machine set up a site to if you
look closely here you'll see that after
is identical on both machines and tucks
config and you log prefix both use that
shared apt here is their base folder and
they use unique file names for their
respective machine then we're going to
go down to groups we've got two groups
app group one is on site one after two
is on site too we've got the network
configured for site one insight to and
then we get to server so we've got a
ping server we've got a min of two so
we've got two of them configured to run
an app group to which is on site to so
this will cause to ping servers to run
on site too and then we've got our
workstation listener configured on app
group one which is on site one and we've
specified a network host port
combination that matches our wsm adder
address right now that we've got our you
bb config file we can convert it to the
binary version of the file let's verify
our x config is created and there it is
now what we can do is before we start up
we it's an MP configuration so we need
to start our t listen processes I've got
a script that does that quickly for us
using ssh to
start the remote one so what we can do
is we can verify that the t listen
process is running on each machine and
we've got one for site one and we've got
one for site too so everything seems to
be in order so let's start it up using
TM boo see if everything starts up
successfully
and it looks like everything did start
up successfully and we should be able to
verify that there are now two tux
configs in this folder and there are and
we also have the you log for the local
lore master machine and remote or slave
machine so now that we've got it running
we can run the client so we're going to
run the Native Client ping on site one
first which will make 20,000 service
requests to the ping servers in sight to
and now what we can do is we can go into
p.m. admin and first what we need to do
because it's a multiple machine
configuration we need to set the default
to all machines so tuxedo will get
information from everywhere then we do
print server and we see that each pane
server was called 10,000 times we want
more info we can do print service not
really necessary but there you see the
service pain was called 10,000 times in
each server so let's quit out of that
come on over to here and now let's run
the workstation version
you should notice it's taking a little
bit longer to run that's because it's
making to network hops instead of
instead of one
and if we come back over here and rerun
TM admin again I suppose I could have
left it open we see that we've got about
20,000 more calls distributed across our
two ping servers again okay so that
pretty much verifies that we've got a
working environment with an MP
configuration on an X illogic platform
using a shared application directory so
now what we can do is we can shut this
down using TM shut down and we can start
taking a look at some of the exalogic
features for top cita so next we're
going to be looking at a shared memory
cues this is the architecture of the
environment used for this demonstration
it's basically the same tuxedo MP
configuration used in the last example
except this time the applications going
to use shared memory cues instead of IPC
mess excuse this example still uses
standard tcp IP for networking and shown
by the host port syntax use for the
bridge and workstation listener
processes this example takes the
previous example and converts it to you
shared memory cubes instead of IPC
message queues that tuxedos used to
using there's no real demonstration of
how this benefits you in this example
because shared memory cues are meant for
improving performance for communication
between processes running on the same
machine while under heavy load and this
example doesn't really have server to
server communication on the same machine
so it's really just a how to exercise so
we don't have to set our environment
because it's already set from the last
exercise what we're going to do is we're
going to take a look at
you may be config file for this exercise
and there are not a lot of changes the
the configuration is basically the same
except if you look in the options
section of the resources section here
the options parameter has exalogic and
sh m qorshe mq specified to configure
shared memory cues and then if you look
a little further down and there's a
parameter called Shem q-max mem and we
have it set at 16,000 so that's
basically all that you need to do to
configure shared memory cues so we'll
quit out of there we will run TM loads
DF to create our configuration our
binary for version of the configuration
and because we didn't change anything
from a networking perspective we don't
need to reconfigure our key lists and
servers we don't need to restart them we
don't need to shut them down we're just
going to leave them running we're going
to start tux up right away
you may be noticing by now that the
server's tend to take a little bit
longer to start up just the the BBL
servers and that's because behind the
scenes tuxedo is creating all of the
shared memory resources required to to
create all of these queues for the
particular environment you want to run
so although there's a little bit of a
start-up costs when you do have an
enterprise-grade application really
hitting the system hard across server to
server it within the same machine you're
going to get increased performance and
part of the reason for that is because
shared memory is being used between
processes on the same machines you're
getting you get to reduce a lot of
expensive buffer copying operations that
you would have to do with regular IPC
message queues okay so now that we've
got everything running what we can do is
we can take a look at the IPC resources
on the system and see that there are a
lot more shared memory segments created
then I in a typical tuxedo configuration
obviously for our application purposes
we specified a Shem cumin max number of
16,000 for an application of our size we
could have gone way smaller but I think
this gets the point across I'm just
going to quit out of this early and now
what we can do just to verify that
things work we can run the client paying
application again
basically everything is still working
and we're going to shut down the
application
this is the architecture of the
environment used for this demonstration
it's the same basic tuxedo NP
configuration used in the first example
except that this time the application
uses the high-performance InfiniBand
network for bridge and wsl connections
as shown by the host port syntax used
for the bridge and W cell processes the
dash print aiming convention in these
machines mapped to private infiniband
addresses on these machines this example
takes the first MP example and converts
it to use infiniband networking
connections our environments already
said so what we're going to do is take a
look at the EBV config file for this
exercise and I'm going to get rid of
this Shem q stuff alright so the
configuration changes that are made to
make this work with infiniband are that
options in the resources section you
specify exalogic because it's an
excellent feature ok so the only
configuration we really need to look at
to make InfiniBand work beyond setting
exalogic and options is to set the
network to use InfiniBand networking
connection so the host names with dash
prive in them are actually mapped to
InfiniBand networking IP addresses so
here um EXL one CN 11 dash print is for
an InfiniBand connection running on that
machine and EXL one CN 12 dash prive is
for an InfiniBand connection running on
that machine and then down here in the
workstation listener we've also set up
the network connection to be an infinite
band connection
so we're going to create the binary form
of the UV beacons baby and because we
are changing to infiniband network
connections we need to change the t
listen process on the slave machine so
that it is also using an infiniband
connection so i wrote a script to help
me out with this almost forgot the dash
crib i'm going to verify that it's
running and it looks like we've got a
winner ok so now i can come over to this
side and boot up that configuration
and everything is working so we will run
client pain get our twenty thousand
calls done and over here we will set wsn
adder again because now that's also
using infiniband connection forgot the
riff again I set it to the wrong machine
all that supposed to be 411 there we go
and that pretty much shows that our
configuration is working so real quick
just to make sure I'm going to unload
the binary cups config that our tux
config environment variables talk
pointing to and just make sure that it
is actually configured for our
infiniband connections and there you go
you see we've got um network and they
are the network connections for the
infiniband network so now we're going to
shut down and move on to the next
example and this is the architecture of
the next example which builds upon the
last example it's still using an
InfiniBand connection but now we're
going to use the socket direct protocol
which bypasses a standard tcp IP stab
for bridge and wsl connections as shown
by the host port syntax used for the
bridge and W cell processes in this
diagram the dash prive naming convention
these machines map to private infiniband
addresses on these machines and the stp
colon declaration indicates that SDP is
used ok so we're going to take a look
and see what it takes to turn that last
example into an sdp configuration so
we're going to take a look at this EBV
configuration file and once again we've
got exalogic configured and we'll go
down to the bottom of the file will see
the network section and if you look at
the network section you see that it's
still using an InfiniBand connection
with the dash prive suffix and then we
have a protocol sdp colon protocol
specified as the prefix for the the host
address for all network connections
including the wsl so quit out of that
we will create the binary version of the
configuration file and over here we will
kill the t listen server because we've
changed the networking so now we're
going to run a new t listen process and
always forget the proof and you make
sure it's the nls address as specified
on the server will verify it we've got
it running the right machine the right
port and the right protocol and come
over here and we'll run TM boo and all
the server should start
alright so now we run client ping again
and you may have noticed with the output
that sometimes it went a little bit slow
but then other times there were huge
jumps in the number of requests return
and it's just the way that the internal
underlying protocols work with with SDP
you'll see the same thing with RDMA
they're really designed for very high
throughput systems all right so now over
here we have to make a new wsn adder to
include that stp protocol so xl1 CN 12
each bridge for a thousand made that
mistake again the wrong machine I'm on
the site to machine so I'm thinking of
that machine when I'm here but the wsl
is running on site one let's try that
again there we go
and that shows stp working so let's do
tema shutdown move on to the next
example this example takes the previous
infiniband example not the SDP one and
converts it to use already ma to bypass
the bridge connection between machines
in an RDMA environment each client or
server process making a request to a
remote machine establishes its own
connection through the infiniband
network this eliminates the bottleneck
created by the bridge process and
greatly increases the bandwidth
available between tuxedo machines ok so
let's review the configuration file to
see what it takes to make this work I'm
going to look at the already in a
version of the ubp and here you can see
that in options we have exalogic defined
once again and then we also have RDMA as
a setting for the options parameter you
look a little bit further down and you
have exalogic shared path which is set
to the folder of our of our demo and
it's basically our app dear we've
decided to make that the shared path for
a file transfer in an RDMA environment
so the configuration takes a little bit
of a change here when you look at the
machine section so right here we've got
four parameters for each machine we've
got our DM a demon IP this is the IP
address where the message queue demon
listens for requests and then right
under his RDMA demon port which is the
port that it listens on those requests
already make you sighs and already make
you entries are the configurations used
to specify the the size of actual cues
that are going to be created for cross
machine communication and
the number of entries that are allowed
on a queue and if you look at the slave
machine it has the same four parameters
just the IP address is slightly
different because that's the infiniband
connection available on that machine you
may have noticed that we're using IP
addresses instead of host names now and
that is because the RDM a message queue
demon does not support using host names
so we have to specify the IP address
directly of the infiniband network ok so
now let's scroll down and look at the
configuration in the network section now
we still have the regular InfiniBand
connection that would be made for
setting up the bridge process and
connecting for the whole boot process
and all of that and I had originally
asked why we still needed a network
section and still needed bridge
processes set up if you are using RDMA
well it turns out that there are still
certain processes that are part of
tuxedo that's that utilize the bridge
maybe first starting up or other
purposes so you're still required to
configure the network section and then
of course we've got the workstation
listener here I'm still using the
infiniband connection ok now let's
create our binary form of the file
and because once again we have changed
the network address we need to kill the
t listen process on the slave machine
I'm going to do the same over here the
master machine because we're going to
use scripts that are going to start up
to listen processes on both machines so
when it comes to starting up the T
listener on the slave machine you have
to start the tuxedo message view monitor
and the message queue demon as well so
there's a convenience script for making
that work and I've written a script to
just kind of handle this forest easily
so on the slave machine you have this
you have to start it up on their first
so I wrote scripts we're going to run
i'll show you what that has done it in a
second and here you see that it listed
out that we've got a t listen process
running at a particular address and you
can see the tux message queue monitor
and the message queue demon running on
the the proper port and network address
so let's take a look at that bio real
quick so star so this uses the
convenience script t listen star Dennis
H and we pass in all the parameters that
used on the command line there and we
also specify the teeth listen address
that's going to be so this manages to
start up those other processes in the t
listen all in one
now let's come over to the master
machine and do the same thing and we
have another similar script that handles
starting all of those processes in
starting tuxedo
turns out I was mistaken about starting
up the t listen process on the master
machine but that's okay because it's
it's not needed for anything that's
mostly for migration purposes which
we're not doing in this case so you can
see by the process list that we also
have the tux message queue monitor and
message queue demon running on this
server as well as a tuxedo servers DVD
I'll be a bridge and that workstation
processes alright so now that we have
all of this running we can try to run
client pinging it and at times you may
notice this going slowly but then at
other times there may be big large jumps
in a number like that just one from like
500 to 20,000 in an instant and so now
let's go over to site too and see if we
can find the right wsn add or address I
just want to get rid of the SDP protocol
then let's try to running WSC ping from
over here
and you notice the father goes along a
faster it starts going and that pretty
much shows that already ma is working
and if we do it TM unloads DF over here
you'll see that the configuration is
indeed RDMA using all those processes
and shut it down that's the last
demonstration the next the end of our
demonstration of tuxedo features
leveraging the X and logic optimizations
to find more information about tuxedo or
exalogic in general or other Oracle
products you can go to OTN the Oracle
technology Network oracle com the
education portal education at oracle com
or you can go to the Oracle Learning
Library WWE are calm / go to / oll I'm
mark Lindros and dec 01 exalogic thanks
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>