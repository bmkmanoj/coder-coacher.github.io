<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>What's New in jclouds 1.5 | Coder Coacher - Coaching Coders</title><meta content="What's New in jclouds 1.5 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Learning-Library/">Oracle Learning Library</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>What's New in jclouds 1.5</b></h2><h5 class="post__date">2013-01-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/qKW8AyKOk0g" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">go ahead and get started I've plenty of
content but what I do is because people
are coming from various backgrounds I'll
leave as much time as possible for
questions and make the best use of it so
that further ado review what Jay Claus
is before we talk about what it does now
which which was something that i think
the hands waving underscores and i'll
talk about some extras so Jay clouds is
a core library but there are some things
in the ecosystem that might be might be
interesting as you discover like what
what Jay Claus is used for i'm the
founder of jay clouds started back in
march of 2009 it actually came out of
the back end for amazon s3 for the
project called j boston pinnace ban so
that's a data grid needed to do some
right behind to amazon s3 the idea of a
storage plugin became too too big to be
just a storage plugin and we went from
there started with storage abstraction
and then later moved into provisioning
and I'll go into a little bit more about
that stuff and I'll try and spend as
much time as I can on on some ground
work considering not everybody here is
familiar with what's going on I
currently work at mule soft in the
platform group for cloud hub which is
basically an integration sass so that's
basically things like data loaders into
Salesforce things like that when people
publicly housed connectors so Jay cloud
started with a few goals in mind the
main goal was to simplify cloud
interfaces which are often enough HTTP
interfaces I have a talk tomorrow called
I got 99 problems but rest ain't one and
so there's a lot of ways that people
describe their API is a lot of people
call them rest and if you've if you're
interested in that stuff I think it's at
eleven-thirty or something like that but
you can look that up but most of them
happen to be rest
or rest like the idea was to try to be
idiomatic to the programming language
not necessarily show the world all the
intricacies of dealing with HTTP
services so in that way if you've heard
of things like Jersey or rest easy then
there should be some familiar things
underneath of the scenes that actually
make that happen we went with a view
approach so what that means is that say
you have a particular cloud service it
probably has some common features to
another cloud service so we have
portable abstraction views which are
which are like anything else you've seen
like for example if you've seen that the
java cache specification is that a
portable abstraction we've all dealt
with those things but one of the things
we focused on also was to try to allow
folks to use the vendor specific
interfaces and that actually ties into
how we develop things so for example if
we have an API that is about monitoring
and there's a lot of value add features
there that aren't necessarily covered by
our abstraction then we want to make
sure people can access those so if you
think of it like reaching under the
covers get the role driver and work with
that and that's actually been really
helpful for us developing what the
abstractions should have because we can
capture all the patterns that people use
with the vendor specific stuff and
naturally okay this you know through
pragmatism we can we can figure out what
the next thing should be added to the
abstraction so that way we we sort of
design things based on customer
requirements customers you know being
those in the community and the first
thing we tried to do in order to make it
make a j-class an attractive place was
to deal with testing specifically unit
testing at the time that Jay cloud
started a lot of the libraries that were
working with the storage services
particularly didn't have a way of
decoupling their HTTP transports from
the code that you would use against them
and so it was very hard for folks to
test without using their credit cards
without using network sockets and the
whole idea of unit tests sort of broke
down so we did a lot of work there
of course this is years ago we've
actually improved our testing
methodologies over time when I say
customers I don't necessarily mean
paying like Jay Klaus is not a
commercial organization but I just use a
word with a capital C so there's lots of
folks that are integrating with Jake
clouds everyone from sales force
themselves to GE and down to startups
and open source projects and it's
because we you know in my opinion where
we're not too dogmatic about for example
are abstractions they're optional like I
said you can choose vendor specifics if
you want you can when you have a library
that's tested against services you get a
head start you don't have as much of
that two to three-week black hole where
something just doesn't work at all and
so for example one of the one of the
things that we do during our release
process is we actually live test every
connector that we have to various types
of cloud services doesn't mean they all
pass but at least you know so if you
were to actually go to j closet or right
now look at her release notes you'll
find that most don't actually pass which
is real because for example it's very
hard for cloud service to have one
hundred percent pass ratio on functional
tests over time there's many reasons why
that could fail for example they lock
your account out and you can't even test
so how do you even know if it works
anymore maybe it's a private private
cloud installation is it's a product
that's actually behind someone's
firewall and during that release no one
bothered to test it for you so we what
we try to do is just be transparent
about it and you can just look for
yourself and we allow the community to
actually update the test results by a
pull request if you've worked with
github before then you'll know that you
can actually submit a series of changes
with with with get and actually
overwrite code but that's not limited to
code we use that for documentation to so
in our release notes section even the
test results are contributions handle
with pull requests click approve merge
stuff like that so we try to use as many
tools as possible to make it easy for
folks to collaborate with us
now that's all sort of like metadata
about Jay clouds as a project what does
it do so we have portable api's what
does that mean we have a couple the ones
that are in blue are the ones that are
more mature blobstore is a measure
mature API that was the one that we
started with that's a key value store
it's very very similar to a cache
interface it's very similar to a map
interface but it doesn't come with all
the stuff that's hard to do with in maps
so for example if you look at the
java.util.map the if you remove a key it
has to return the old value things like
that and and so a lot of those things
are very expensive to implement across a
wire so blob stores is sort of like a
you know an RPC type of interface for
manipulating data that doesn't have to
adhere to contracts that are very
expensive to use we also have compute
service which is about provisioning and
i'll show you code examples of both of
these so for example a lot of people are
used to virtualization nowadays they
need to run their stacks on things and
so they might use the compute service in
order to spin up a windows machine
that's running whatever or it's been a
linux machine that's running whatever
and so this handles simplifying that
process we have some work in project
progress abstractions for example we
have a load balancer abstraction because
a lot of clouds are actually giving
reasonably portable semantics about
about you know things like what you
would otherwise do with h a proxy and
then there's there's an influx at the
last year with a lot of more
infrastructure services so for example
block storage which are like you know
volumes that you can you know take
attached to one machine detach it
attached to another machine which could
help you for example if you have a
database and you want to restore that
note quickly the quickest ways to
actually move the volume to another
machine things like network services
like I need to create VLAN for my
machines to live in that's fire walled
off from everybody else identity
services so for example
I have the ability to create new users
on a particular cloud so i can create my
own organization there and then and then
handle self-service on my own and other
another little networking things we find
people are actually a lot interested in
it in the infrastructure he deals
because they're there layering services
on top so for example you may have heard
of platform services such as like open
shift or claw foundry and these
basically have an abstraction level of
middleware or services they also need to
run on things so what we find a lot of
folks that are in the J clouds community
or doing are actually tool builders or
product builders and so like gigas basis
folks might make their cloud if I it
needs to do provisioning commands so
that they'll use this as a part of their
sweet then they raise the abstraction
for other folks so if you haven't used J
clouds directly it might be because
you're using it indirectly or might be
because you're not using a product that
uses J clouds yet but at anyway what we
try to do is be very very clear on our
boundaries so we don't want to sneak
around and also do you know tom cat
stuff and also do this and also do that
because it's very hard to keep all these
things reliable as they are much less
expanded two dimensions that other
people are doing pretty good job at so
already mentioned provider specific
cooks so for example if you're in
microsoft windows azure cloud you can
get access to the windows api is there
if you're an OpenStack which is a new
open source foundation particularly
relating to infrastructure things
providing alternatives to stacks like
VMware stacks and things like that so we
have a lot of stickiness in those
communities what's also helpful is that
particularly an OpenStack there's there
are folks that are staffed from the
companies that are in the foundations
and actually actively committing so for
example they respects from rackspace and
HP that are actually you know full-time
assigned to work on the J cloud support
to make sure that all works out as far
as like I'm using a word connector to
say things that connect to cloud
products or services we actually call
them
providers and AP is API is more product
specific and a provider as a service a
public service and I have a slide about
you know why we differentiate like that
but basically odds are most services are
actually using a similar product to
somebody else so if you're dealing with
modularity and you want to you know have
less copy/paste reuse and you figure
that out eventually and you figure out
who's running what products then you can
keep your software models pretty concise
so right now i think this slide is is
reasonably up-to-date meaning that
there's 40 public services that we test
but we also have a labs area with
another 20 some more so all in all we
have almost a hundred different you know
connectors to various things most of
them are infrastructure related now Jake
laws programming style we use a lot of
google code and so for example for
dependency injection we use google juice
how many folks have ever used google
juice before okay fair number so juice
is basically you know it's an
alternative to spring it only really
focuses on the dependency injection part
it doesn't have all the utilities that
spring comes with doesn't have all these
templates and such like that and for
example it doesn't actually declare in
XML format or JSON format for your
bindings it actually encourages you to
write them in code and test them in code
there are a couple reasons we use juice
originally one was it wasn't spring the
other one was it was very small and I'm
saying it wasn't spring not to hate on
spring but but mainly I worked in
middleware for ages and the easiest way
you could screw somebody up was to use
spring in your middleware product and so
you know it was all so cool so I have to
admit that juice is very stable juices
and also guava which I mentioned in a
second is a core part of Google's
infrastructure so it's running the
largest applications in the world it's
it's extremely well tested it has a very
slow release process and the beginning
of the project was it was very
burdensome how slow that released
this was now we don't really notice it
because we don't care guava we use that
sort of for style guava is sort of like
looking in the future of what Java will
look like one day that's at least what
we hope it's a functional style if you
haven't looked at guava before a lot of
the leaders in a lot of the Java jsr
talks or at least ones that are
influencing or have influence at the
time may have been underneath of these
things some people think that guava is
is sort of like the codification of the
effective java book it's worthwhile
looking at draw your own conclusions we
use it because if you're working with
resources such as storage and compute
providers it's it's a very functional
thing you're doing more often than
anything else you end up doing a lot of
transformations you end up doing a lot
of concatenations and aggregations and
all this other stuff guava has a lot of
tools for that through using both of
these like you know Google open source
projects it leaves you also to a style
of less less parameters in your list
less nulls different approaches to that
and you'll see some of that bleed
through in the code slides that are
coming up and so it's sort of like if
you understand juice and guava you'll
probably understand Jay clouds maybe you
can even point out some flaws in Jay
clothes generally speaking I mentioned
we were optimizing for other folks to
build value on top of Jay clouds as
opposed to making end user tools
directly and so what ends up there is is
we optimize for different things so for
example our core API is optimized for
asynchronous first in synchronous second
so if you look at our provider specific
rest bindings everything returns the
future and then we happen to have a
convenience blocking sync proxy that
just makes it look like it was
synchronous so a lot of especially
people with storage or queuing services
they tend to like that a little bit one
of the things that's helpful is that it
actually allows you to decouple
the way that you implement concurrency
from you know the way it's currently
configured so for example within juice
we can swap out the way hdb is
implemented so if you want to make your
neti provider if you want to use closure
and to find your own at runtime or if
you want to use Google App Engine which
has their own a sink of connection
services then you can just replumb those
behind everything it doesn't need to use
threads in other words and and not
having to use threads is pretty helpful
we in the compute service which is the
one that launches virtual machines we
deal with groups so for example we
decided that it's it's more likely the
case that you're going to launch more
than one machine then you're going to
launch just one machine if you optimized
for that it makes especially making
elastic middleware things a lot easier
to deal with and it's also always
possible to create one of something just
make a group of size one and so
optimizing for that is another another
sort of back end concern over time a lot
of the cloud ap is are getting stronger
and stronger they do more and more
aggregates on the server they do a lot
more they'll accept units of work that
involve more things so we can actually
offload that responsibility out to the
server J clauses a library it's not a
service has no state so if we can
instead of like firing off 100 features
and then tracking them and figuring out
what happened if we can just say ok
launch this aggregate will track you we
prefer to do that so it's these are the
sorts of optimizations we use because we
optimized for being a part of middleware
or somebody else's tools or their
libraries one thing we decided though at
the beginning was that you know this
idea of cloud has a lot of financial and
location relevance so besides just
automating infrastructure there are some
pieces of like the cloud model that kind
of leak into J clouds so you know for
example these services are some place
that place matters you don't want to
have a
storage service that's in a different
country than your compute service and
try to share data between them for
example or maybe you do maybe you want
to set up some like long line
synchronization thing or whatever so we
actually decided to create a unified
location model that regardless of the
abstraction you can interact with that's
also help for some things we haven't
developed yet so for example there's
guys at notable which is a pretty cool
company on real-time analytics and
they've started creating an inventory
service so if anyone's heard of this
thing called like cmdb or whatever you
might have a lot of assets that you're
managing in your data centers that are
physical but what if you're actually on
the cloud someplace you still have to
probably take inventory of what you
thought you had and compare that against
like what you have now because maybe one
shut down or whatever so you know if you
use the same location model at least you
can even if the resources are abstract
like this is some inventory item at
least you know where it is and it helps
you when you're especially looking at a
global set you have a chance of getting
that single pane of glass that people
seek out so location models is kind of
handy we had some other little handy
things but that's probably the more
interesting one so here's some code
sorry took so long so Jake clouds if you
had used a previous version of Jay
clouds and I'm just saying everything
before one dot five is a previous
version then there will be a little bit
of differences here for example we
change to a builder pattern for creating
contexts which isn't too surprising for
Java folks but we had a factory thing
that got little clunky we found that in
general factories are really hard to
deal with because factory is almost
always you know require you either
create some parameter object or list out
all your parameters and then you know if
you have different cloud providers and
different requirements it's a lot easier
to handle that with builders this
actually build pattern was designed by a
whole bunch of pokes we had temp rails
actually helped a lot with this it looks
very much like cash builder in guava and
that's another thing we intentionally do
we
Ripoff patterns as much as possible so
if there's something that makes it look
and feel like something else we just
want it to be idiomatic we don't want to
keep teaching people style we actually
don't want to teach anybody anything if
we can avoid it so something else that's
so for example this says look up the
whatever we can find named awss three
and then you know supply the credentials
and give me this view of that API so the
view is another new thing in Jake lots
125 before we had a one-to-one
relationship between an abstraction and
an API what we found is a lot of people
are making like monolithic api's and
they might have various different
features and we don't want to just keep
tacking on things to our stuff just
because other people are what we do
instead is just create a very succinct
views okay maybe your API supports
monitoring and storage okay here's the
monitoring view here's a storage view it
makes things a lot easier to unit test
as well there's other parameters and
options for example one of the things
there's also a little bit different
about how we maintain Jake laws under
the scenes is that we use service
registry or optionally we have a
blueprint service if you're using osgi
so so for example in previous versions
of Jay clouds we did this horrible thing
that a lot of projects start out with
which is a central registry and you
pre-register your components that you're
going to have and then it's awful and it
took a while before people got really
pissed off enough to do anything about
it and so we finally did and what this
means is that you can pass a and in this
case it's going to be looked up by a
service loader and if you hate service
loader or whatever you can actually pass
in the typed class that represents
Amazon's s3 connection so for example we
have types for everything so one of the
advantages of doing that a is a lot of
times people use configuration and so
they do want a string of I key for
something so that's helpful maybe you
don't even know what api's are available
maybe you want to list through them it's
kind of nice to have a service loader
registry to figure those things out
it gives you a default yellow pages
which is also helpful what isn't helpful
is that service loader is really slow
when you have a bunch of jars so your
initialization time can take you know a
while measured in hundreds of
milliseconds so for people who thrash
and like create new contacts all the
time it's really stupid especially if
you're doing it in the request response
cycle because a lot of a lot of folks
who are writing HTTP services you know
they want to keep the the time of that
response down as much as possible you
cut your overhead whenever you can so if
you pass for example in the object this
one would be a WS s3 provider metadata
then it would save you a couple hundred
milliseconds probably depending on how
many jars you have in your classpath the
little things so the blobstore is one of
our interfaces actually has an async
sync pair so I told you before our
back-end api's have a an async
abstraction first and then you have a
blocking abstraction what do I mean by
that same method parameters one
interface returns a future the other one
returns the actual value that's wrapped
in the future and most of time are
abstractions don't really work that well
because like for example in compute
services as a series of events as
opposed to returning a single value
blobstore is very simple what's like put
receive data you can actually convert
those requests natively so we actually
have a an asynchronous version which is
the same thing but it returns futures we
don't allow no very often we do allow
null for containers I mean it's sorry
for locations so if you're trying to
create anything in J clouds that asks
you for location it is ok to supply no
we do allow people to just not know
about location and let you configure
that and but we but we definitely need
to make sure that everybody has the
ability to know what location things are
so you can programmatically manipulate
locations to builder pattern again for
blobs I don't have to really explain
that to you but if you've ever used any
other life
brace for accessing s3 or something like
that you'll notice that it's it's not
builder II it's it's like 17 parameter
II the the compute service is of course
going to be creating machines not pieces
of data and in this case I'm going to
give you a little bit more insight into
how you work with a private cloud what
is a private cloud mean it basically
means somebody sold you or you
downloaded a product and you installed
it and that that is basically it the
cloud part generally is referring to the
self-service nature if you're talking
about private clouds meaning that you're
standing up and install and it has the
ability for people to you know provision
their own things or do whatever they
need to do you create accounts for
people you don't create resources for
people basically in this case obviously
endpoints are important this is an
example of OpenStack specifically
OpenStack Nova and this also hints at
how we handle modularity from a like a
driver perspective in j calls we don't
have a lot of dependencies in our core
we allow you to choose them even things
like logging which is always everyone's
fun debate in the case of like for
example ssh a lot of compute services
people want to SSH into these hosts we
have two different ssh implementations
that come with j clouds in a way we have
ssh j and with jsch ssh j is much higher
quality but a lot of people use as jsch
so we don't want to conflict with your
libraries you just choose which one you
want and so this is plumbing it directly
so this is a little bit different than
spring because for example you're
literally putting the class here now you
can bill it with spring and for example
people who use things like camel or
whatever and they configure everything
up with a spring context would actually
supply these builder methods with with
parameters via spring XML file you
there's nothing no problem with doing
that just that the guava way it's it's a
module that establishes the links
between interface and implementation and
if you look up
Jews you will see more about that
suffice to say there are some things
that we don't know exactly what
implementation you're going to want and
you have a way of writing those in this
case we're looking at a way to create a
group called HBase master with a single
machine in it and what we're telling it
is as soon as you boot up run this
script and open up these two ports
hopefully it's intuitive most of time
it's not intuitive to actually implement
this but we try to keep exactly the same
syntax doesn't matter if you using
VMware vCloud or ec2 or OpenStack or
whatever you use the same commands
that's that's what the portable
abstraction is buying you and the the
hints are basically what we feel user
requirements truly are a lot of times
user requirements are not like create
this static NAT IP to this IP and blah
blah blah although some people do most
of time they don't even know what's
going on with all that stuff they just
want I want a machine with a IP address
on it maybe the the thing I'm going to
highlight here that's pretty interesting
to some folks is that I didn't even
specify an operating system what is
actually going to run when i when i boot
this up so in j clouds like I said we
test on every release we test our
default template so we have the same
cloud template and it defines like what
operating system version it is which
family it is what you know size of
Graham it is and all this other stuff
and so there's a default always the
priority is the highest version of
ubuntu and that opinion is basically
because a lot of the cloud providers
have a strong stickiness with canonical
for some reason and we want things at
work so that happens to be the one that
works first but however in Amazon Cloud
it's a centos variant called Amazon
Linux if there's you know something else
you know a lot of clouds are Fedora
based we have Dora based installs the
main thing we do is we actually run our
test cases can we install Java on it can
we bring up jetty on that on that cloud
if we can install with an own script we
actually have a class called install JDK
and if you put in install JDK as your
run script that's what it will do if
that passes then we say okay this
default template is okay doesn't mean
it's going to be what you want but at
least it'll it'll install Java and
that's fine gives you a start it's
really helpful when people have to do
like proof of concepts like oh my boss
said I need to use Rackspace or whatever
and so you get a really fast way to try
something out and have a chance of it
working there's configuration behind the
scenes I don't have a slide on it but we
have this thing called template builder
spec we have all these builders but
sometimes you need to actually spec the
series of commands that go to the
Builder we also ripped off something
from guava which is basically a comma
delimited equal encoding of the
parameters that you actually pass to the
Java methods so that you can actually
stick those in a config file someplace
our spec is also tested to be
serializable a nice to JSON that's one
of the things you have to do if you're
dealing with systems nowadays a lot of
folks right there gluey code and Ruby
and people get used to like these really
nice-looking configuration files that
actually happen to represent a ruby
object someplace but you know the other
thing is doesn't matter what language it
is try to persist your classes and see
how they look do they look awful you
know you use annotations use things like
juice onto to make them look nice we
support closure as a top level language
it doesn't mean that the other languages
on the JVM are not supported it just
means that we have more active community
and closure that are actually
contributing code so there's a lot of
interesting stuff enclosure anyway it's
a functional language so it's a very
good mapping to the way we approach
resources anyway there there's plenty of
folks that use Scala groovy even JRuby I
know for example cloudbees folks use
Scala they used a clouds but they
actually have their own scholar wrappers
for it what I've noticed about Scala is
it tends to go like this good or like
some conference we were like yeah man i
really want to contribute that they
never do
so that's that's basically why we don't
have a scholar rapper closure happened
mainly because closure folks are you
know I wouldn't say very likely to use
things like Hadoop and clusters and
things but it's kind of like that
sometimes there's a lot of folks that
are doing pretty important pretty
interesting real-time stuff enclosure if
you look at actually any of any of the
local meetups or any of the other
meetups you'll find some pretty
interesting stuff including like Twitter
storm and and products like that which
happens to use day clouds to do its
provisioning so in this case is just
basically mapping things into a closure
idiomatic style this is our second style
in fact this namespace is called compute
to which is to everyone's dismay but we
just didn't really have a better name
for it and so that's that's where the
deal is in this case where we're
defining predicates using closure style
these actually map directly to guava
predicates so which is really super
handy so one of the things is is that
one of the guys Matias home piss who's a
guy over in Upsilon in Sweden for citrus
helped design this interface that we
have a nice way to actually flow
directly from one functional style to
another functional style so the thing is
pretty cool I mentioned the location
model it's extensible should mention
that so for example if you're in a
private installation you want to publish
your IP the IP of your router or like
that the physical address or something
rabab coordinates if you want your bomb
coordinates in there it's just a map of
string to object so you can put whatever
you want there by default we really have
only a little bit of information about
the location settling on the ISO 3166
code it is a jurisdictional code it's
not a bomb coordinate meaning that you
could be in the jurisdiction of the US
while you're in another country because
you're in the embassy but but anyway for
most people it's it's a it's close
enough and it solves a more important
problem which is illegal
modularity we end up I mentioned api's
and providers it helps us deal with the
amount of code we already have five
hundred thirty-six thousand lines of
code and most of that is actually in the
modules to support specific providers or
specific API dialects and so for example
we do use maven we do use you know osgi
packaging this is actually the first
release that we don't use fragments in
osgi we're actually true blue yay
finally compatible with osgi runtimes
and in fact that that goes even further
because we have a carafe support
directly and that's maintained by
yiannis from Red Hat no and anyway you
can imagine that that people will make
dialects of AP is sometimes they don't
intend to but you know it is a dialect
in the cloud world I'd say a lot of
times you get this like wiki doc about
what the API does and then people try to
copy it and it's not a speck it's really
just a how-to guide it's like you know
put this parameter and do this there's
no scheme or anything else so
unintentionally you have a lot of
dialects because it isn't standard
anyway so what we do is we we basically
just you know use class inheritance
where we can sometimes it's wholly
incompatible class trees we try to if
someone says that they're s3 compatible
we try to make sure that they're you
know at least they can get tested by all
of our base live tests against s3 and
have a way to like for example override
the test configuration for all of their
weird quirks and and then we we decide
that okay sometimes the dialect is also
implemented by multiple providers
especially with software right so if
somebody goes out and buys a product
maybe I think react now actually has a
show has the some sort of a cloud
implementation of s3 that you can
actually buy now so you might have like
10 different cloud providers running the
same product with the same dialects and
same behaviors so it's just a way of
recognizing that
the the interesting thing we have to
some folks is that we actually store
configuration and providers the defaults
and that's mainly because we want that
parameterless run so when you say like
create a node and you don't actually
require parameters we want to give like
a good base and also targets to correct
URLs and all this other stuff we could
have figured out a new packaging
distribution system what we figured that
you know jars are already published a
maven central they're already integrated
with things like osgi and everything
else like that so if you need to change
the very base configuration of a
provider connection one way you could do
that is is upgrading your version of
that so if we look at configuration as
code for example you could say that okay
my connection to google storage is
actually a releasable artifact that i
want to version just like every other
piece of my application if I'm depending
on it I want to be able to maybe to
pause that take it offline do some
things so a year and a half ago or
something like that Gustavo I don't
remember how to say his last name but M
something rather created like a little
demo it basically shows like you know
taking a storage provider offline and
bringing it back online because we
actually store the configuration the
base configuration details as a maven
artifact and that's how we get 50
actually yeah almost 50 of these things
because you know we test those
individually it's also really helpful
for troubleshooting a lot of times
people say like our ec2 stuff is broke
and like which easy to write because we
have like seven layers of easy to which
one is broke so we can actually
quarantine a different cloud provider
and we can move the whole code base
forward even if one cloud provider kind
of sucks so new toys in j clause 15 AI
kind of hinted at some of those and i'll
just talk about some interesting bits so
firstly we have a new website anyone
who's worked with open source knows that
did most of the time we all suck at docs
and we're even worse at design we have
an MVP on this silk
son on Twitter Beck woods she's a lead
and spearheaded our documentation effort
it was actually sponsored by cloths off
really really handy for folks to
collaborate with that we got like one of
those big vaunted websites now so you
can click on things and they probably go
to directions that might make sense I
could show you what it looked like
before it was very designing but our our
content was a little bit disorganized so
hopefully that helps out with folks like
I said earlier we actually use github to
manage our content so Jake law org is a
render of markdown that's stored in the
J cloud github com repo it's using
github site's functionality so if you're
actually creating a project and you want
to have like a nice way to use source
control to deal with your content and
have Auto publishing and association
with your favorite cname I'd recommend
looking at the github sites essentially
convention is something github com is
the name of the repo and then at that's
a special way basically it will it will
basically push it out to their web
servers every time you make a change
really fun expect tests we get a lot of
weird errors because you know people you
know get some stack trace with some HTTP
traffic in it came very often that we
need to make sure that our behavior that
we deal with these dialects are is is
tested properly most of that we don't
even know because we only made sometimes
we don't even have access to the product
itself so what we do is we say okay if
you are going to submit an error don't
just send us HTTP and will guess what
the problem is will actually take that
and like a VCR we'll play it back inside
of our test cases it's sent similar ish
to I guess your mock HTTP unit type of
stuff but what we actually do is we
actually wrote I said earlier that we
have different stores back ends I'm
sorry different HTTP back ends like our
default one uses java HTTP URL
connection we have one for apache HC we
have one in labs
Nettie we have the google app engine one
we also have a mock playback one so it
exercises all the functionality and Jake
laws except for you're just feeding it
requests and responses instead and so
it's a little bit better than a mock
because it actually forces you to go
through everything including your
locking subsystems if ever had to like
debug middleware and production
sometimes somebody's debug flag and
totally screw up code because whatever
you know so that's that's what we do so
one day actually there's a lot of things
we can improve in testing if you haven't
seen our Killian you should check it out
I think there's a presentation a couple
hours about how you do like live
functional testing of deployments we'll
probably look at that as far as
improving further but for offline tests
we can do some interesting things so for
example we found that somebody's
installation of OpenStack started
displaying hexadecimal version numbers
so we're like okay that's weird and but
we don't want our stuff to break anyway
even if it's weird so we just okay fine
let's run a test case we'll make sure
that doesn't you know bomb and then that
way you won't have to talk to us next
next release so in this case we just
literally build the requests and
responses and then we will get for
example connection to the backend API
called Nova here and then call the gate
configured zones this this would
actually result in an authentication
request and authentication response
which includes the zone information and
then we just make sure it parses
properly it's it's fairly
straightforward to do this once you have
the framework in place it's really hard
to make a new framework and in fact this
also can be improved over time one of
the things that's that's really hard and
this is when you have multi-threaded
tests and that's just hard API metadata
a lot of people are doing the same
things so if they're going to Jake laws
generally speaking they're trying to use
multiple resources so for example if we
look at like
GE we're looking at how they use
different internal virtualization
products to provide the same services to
their size groups and so that whole like
I want things to act the same comes up
but we have the same problem as like
internationalization and localization so
J calls uses abstract names for things
like identity and credential but the
cloud providers themselves use user name
and password or access key and secret
key or oh all you know signature thing
or whatever so if you actually present a
GUI or any UI and you're actually giving
the J clouds abstract words most people
have no idea what to put in there well
it will probably fail so we actually
have a type called API metadata and
provider metadata which we populate with
the actual friendly names and the
describing things that you get so for
example in OpenStack it would tell you
that the URL field has to end in the
version of the identity service and that
gives enough hints for people to not
throw in like random stuff so we find
out a lot about that stuff from well I
find out about it from personal email or
IRC rants or whatever and then we're
like okay fine what can we do and one
thing is is just okay package more
metadata don't get silly with it but you
know this is a really good balance the
other thing we do with metadata is we
can actually allow people to inquire
about the services before they make
connections to them so for example where
are they what type of api's do they
support what type of views do they
support so you can create a reasonable
like flow in your in your UI so you can
say okay what are you trying to connect
to is that a blob or is it a computer
what were you trying to do then you can
say okay well there's all these how do
you refine that list so in a way we're
not trying to create like a huge data
model but there is reference data there
that you can use to select from things
so for example you can you can use our
we have built in searches that just
search through the service
but obviously you can use this with with
osgi two or whatever you you can
actually store these are objects they're
serializable so you can you can persist
them anywhere json you know put them in
s3 bucket it doesn't matter what you do
with these api meta data objects but by
default they're stored and the service
loader information so we can look by
type we can look by by all services that
are bounded by a specific region code
it's not super smart but it's smart
enough meaning that like the region code
standard says that there's a hyphen to
separate like the major from the minor
so usca is bounded by us so so you can
you can do things like that and then for
the hackers you can you can make your
own weird versions of our services so
like I said we use juice you can
overwrite anything by passing a module
that changes the bindings so it's
getting more popular for people to put
like their own s3 api's on top of their
internal systems and so what you can do
is you could actually say okay give me
the s3 API metadata which includes all
of its configuration including how its
wired together and I'm going to tweak it
a bit i'm going to save that as like my
archive store that's backed with some
filesystem someplace or whatever and so
you so if you get really advanced you
can sort of make your own hacks of
things that way another famous topic in
especially REST API s or any HTTP API is
how you deal with large result sets this
is a is a pretty interesting 1 i'm also
touching this a little bit on that just
a rest talk but pagination is is
surprisingly not will not well modeled
in general and and what that means is
that what i mean by that is like how
actually advanced from from one page to
the next is is at least a few different
styles some of them use some of them
basically expose their database
semantics like you know maybe an offset
on sub-query some of them might be back
with like Cassandra there's no way to do
that so it's just a marker and opaque
system and over time when you're getting
more and more diverse types of back ends
that are supporting a resource it's it
becomes more important to not lock
yourself into something that only really
is there because it happened to
correlate to a sequel query so we we
went through a lot of thought on this
and we're not completely done but we
found some process to do this and what
we did firstly is we extended something
called fluent iterable this is a new
thing in guava version 12 or 13 but
basically it's a way that you can say
give me this collection or iterable of X
and then convert it up sorry convert it
to something else and then to something
else and one of those conversions could
be concatenated and I'll explain why
that's important here so for example if
you're dealing with pagination then what
do you have you actually have a list of
pages you know or a list of lists that
are coming back from the API a single
call gives you the first page if you say
give me the next you actually get the
other one but you can also just think of
them as a list of lists you just haven't
advanced through them yet so if you were
to actually try to get like all of your
metrics and you have 2,000 or maybe
20,000 metrics on a specific thing in
your network we would have a function to
concatenate the list of lists into just
something that appears as a sequential
stream and then as soon as you get past
200 it will automatically go back make a
rest call to get the next page and then
it and then continue until it's actually
out so that's that's a really handy
feature and what allows us to do is we
can actually test at a high level the
pagination capabilities of an API
without knowing exactly how they're
implemented some of them might be using
markers some of my be using offsets you
know we can do that one of the things
that the closure guys told us was that
hey we don't like your breaky
abstraction e stuff and basically say
like I don't want you
across a network boundary without me
asking you to do that so that's actually
why we didn't end up with just one
continuous list we actually have a page
of pages so that folks if they want to
just say I want to be in control of when
this pagination is you know when I
advance from one page to another then I
can actually use it and then I can
explicitly ask for index zero index one
and then I know that there's actually a
remote network call happening so you can
create reliable systems or more reliable
systems that way at the expense of a
little bit more complexity and how you
how you handle that one of the features
of fluent iterable itself is just what's
built in so you can do things like first
match so if you instead of iterating
through the entire set it'll just break
as soon as you get to a specific
predicate so for example if I'm looking
for you know a load balancer that's on a
particular Network I could create a
predicate which basically is a interface
with a generic type that evaluates to
true and as soon as that happens it band
ins the rest of the list and then you
don't make any more network calls that
you need it gives us a chance to do
something even more fancy but I don't
even know how we're going to do it yet
which would be to convert the predicates
into the backends query language that's
like sci-fi at this point optional
extensions is another reality of AP is
and how and what we're doing now about
them so thankfully not every product is
you know has everything in the box
there's a lot of modular products out
there specifically like OpenStack has a
core that has a bunch of extensions and
also a whole bunch of optional services
now if your current trying to create a
typed API on something that has a whole
bunch of things that are optional it can
be tricky especially without an optional
type this is another thing we have from
guava guava has optionals type system
which will hopefully get into java may
even be scheduled for nine or something
somebody can fact check me on that
but basically we need to be able to
discover if a particular piece of that
service is available or not before we
try to use it there's there's
essentially two approaches you can just
try and then catch
unsupportedoperationexception but that's
sort of like using try blocks as flow
control in a way we don't want to do
that if we have an option to not do it
so so it'll is a type and it has
basically is present stuff like that or
or null or other ways to like handle the
idea that something might not be there
the cool thing about this we look at
like our floating IP extension first off
one thing you have to realize is that
extensions like everything else our
location specific if I look at maybe my
brand is US and UK but I have completely
different release cycles between us and
UK so if you want your code to survive
use the highest you know or the lowest
finest granularity possible because then
you then you actually have a chance of
checking more and so for example this
get floating IP extension is present for
zone that will return us an optional of
type floating IP extension that's
actually implemented actually we have a
web by deuce we can implement it
different ways we can implement it via
configuration override so like always
return true if this property is set
because we know better we can in this
case is actually implemented by a meta
data query against their API because
their API actually has a rich enough
system that it can support the presence
of services and extensions you can check
to see if a specific name spaces
available before you use it so that's
kind of handy so this is this is
something sneaking into the new versions
of code because it ends up being the
case that you you have like multiple
ways you can achieve a goal and so you
can just look through your extensions in
a preferred list and maybe I prefer this
way but I can also do it this way and
that we have a higher chance of
portability when you're building
products
final section is sub-project so Jay
College has we still keep all of our
like api's and providers which people
might call connectors inside of the same
repo which is getting big we actually
had to go through a really big maven
refactor recently to make it possible to
build that sucker in less than 15
minutes we're really really thankful to
cloudbees for both the club's itself for
the debit cloud stuff but also for this
build hive service if you haven't used
build hype before it's awesome what it
does is it would check pull requests so
somebody has like a branch they want to
they want you to merge it and they issue
a pull request into github it'll come up
and you can just ignore it until build
high says that it ran all the tests
successfully so it's a really nice
monitoring system and for example as me
as a product li lead I don't really want
to I get scared because maybe something
looks like I really want to say except
because it's so simple but maybe it
broke a whole bunch of shit so yeah
that's what that's one of the things is
awesome about copies anyway we
decentralized some certain things that
don't have the same release cycle as the
other things so it might still have a
similar audience but has a different
release psyche or maybe a different
audience how many folks have heard this
term flowing around called DevOps DevOps
is basically trying to treat
infrastructure concerns in the same
agile ways that you a treat software
developing concerns it's trying to align
people under the same value system and
delivery process and try and knock out
all the kinks as a unit so it ends up
being a very cultural movement but it
also sometimes turns into fists and
there's tool fest generally surround
things like configuration management
monitoring stuff like that one of the
companies that popularized that was
opscode but there's other companies of
popularized it like puppet labs and this
tool called chef is actually a way to
manage configuration as opposed to just
doing it with shell scripts so you can
use you know a more
or sometimes a more succinct way
sometimes a more precise way of managing
your configuration I started this
project a couple years ago ignasi from
abaco has been maintaining it for last
year this is the first time we've
actually published this to maven central
but in this case what you can do is you
can actually iterate over your
configuration servers API to just to
discover what type of configuration
features are available like can this do
Apache can this do Mongo can this do
whatever else that I might have to put
on these machines and then you can
assemble a list of configurations and
then assign them to a group which is
compatible with Jake clouds groups for
notes so for example you can say that
this group cobweb prod now equals these
firewall rules these services maybe this
log rotation scheme and any other stuff
you might need and there's a very direct
relationship between the two so
essentially you don't need to make a
shell script that installs this you can
use a config management server to do it
instead and the reason why this is
important is a lot of times people
create images of their known working
configuration but they don't know how to
recreate those and so if you can
actually say i want this this this and
this sometimes you would the downside of
configuration management servers is
generally speaking there's some extra
time to actually boot up these things so
maybe your server takes a couple minutes
to start up but then you're fifteen
minutes waiting for all these packages
to install and everything so in general
if you ended up using a config
management server you probably also want
to end up still cashing them as images
so after you create a specific you know
break point where ok I've got all my
software installed but it's not
configured yet I snap an image and then
go from there and that way you still
have the ability to create everything
reliably but you don't have to pay extra
overhead Jenkins is another thing we've
got going on Andrew barrer from cloud
air has been super awesome with this and
basically we have two features of
Jenkins that we support so if you need
to have your build jobs run on something
besides ec2 or your local ms
chains or you can you can use Jay clouds
to run slave someplace else this first
came up actually through the drizzle
project which is a fork of MySQL if
you've ever actually tried to build
anything in C you'll know that you have
to do that with every platform that it
might be installed in and there's bills
take forever so if you have a cloud then
maybe you can do like all you know 48
combinations of platforms you have to
support simultaneously get your bills
publish those artifacts out to your
repository and voila so if you have a
combination of the ability to portably
launch a bunch of slaves and then also
have those slaves be able to publish to
the central place all the better so so
the combination of the computer service
&amp;amp; blobstore here are helpful because you
can use a lobster that happens to be in
the same network as your compute cloud
and you can do those things it's it's
it's an alternative but not as full
services like a claw peas so for example
this still requires you to configure it
you have to set it up you have to manage
it and all that stuff and it's not
actually a cloud it's just a plug-in so
in other words your choice comes from
like okay what's my choice ec2 to like
gazillions of options and that's useful
to people especially if they're not in
the US and or or they don't think that
Europe is Ireland wrapping up here CLI
so devs always leave their servers
running and then they get a big bill
this was the primary motivation of
creating a CLI I said earlier we weren't
actually trying to create energies or
products but we just all got killed too
many times as we get this like three
hundred dollar amazon bill because we
left some stupid thing running so that's
why it happened also happens to be the
case that people like see Eliza can
relate to them and yiannis from formerly
fuse now Red Hat is the champion of this
as well as our craft support which is
actually built with so you can download
Jake la CLI it's a tard
tar or zip file you extracted you can do
Ben Jay clouds and you can just like
make a command on a single cloud at a
time or you can do J Klaus hyphen c li
and it opens a craft show which you can
have an interactive prompt pros and cons
of the approaches if you do the fire and
forget thing it's easier for people with
with like bash scripts but it takes a
while to actually make all those
connections to the various cloud
providers and so you might feel a bit of
a hesitation that you're not comfortable
with if you use the interactive then
there's a it's a lot more powerful you
can work with multiple cloud
simultaneously all of the metadata is
cached after the first grab so things
are a lot snappier and correct if you've
not used it before gives you a lot of
tools when building CL is including
auto-completion tab completion so for
example you can tab complete here all
the commands that are available you can
tab complete things like image IDs which
is weird one but more likely like my
words from my buckets or like the values
of parameters you can even tab complete
the parameter names themselves so it's
very easy to work with the only thing
you can't tab complete is your password
so this is the end and this is where I
allow you to ask questions for those who
want to stay minutes late to do so but
there's a bunch of places we store
goodies for follow-up so we try to keep
a good repo together on Jake laws
examples there's a bunch of projects
that are pre-built to do common things
everything from like uploading a really
big file someplace to launching
minecraft to you know just stuff it's a
repository for stuff little sample
projects Jake laws work obviously
self-explanatory we hang out on on IRC
and we discuss things on google groups
so those are basically the two places
that you can find more information so
thanks for your time and ready for any
questions if you have any
sure good question so which code so
actually what's interesting is is that
sometimes providers write code for
consumers because they just want their
ecosystem to survive so that okay so
let's just say Salesforce so Salesforce
how they use J clouds is they have a
large build test infrastructure that
actually I think they have a couple
thousand machines and that so they
actually have their own internal
development team to create advantage the
tools that actually manage that their
build farms and so like that you can
think of them as their own like software
shop inside of sales sports that focus
on continuous integration yeah yeah
yeah so for example we don't have things
like auto scaling so what a lot there's
there's folks here that do that like
gigas spaces has this thing called claw
defy that can set up like a feedback
loop with your monitoring system and
then start cranking out more machines
things like that and basically a lot of
that sort of functionality would be
handled by tools on top and luckily
there's there's a lot of open source
tools for that but we've also noticed is
that most of time internally there's
much more bespoke infrastructure
management things than you might guess
and so even if there are tools it's you
know for whatever reason they have their
own suite of things that that does all
their provision II stuff I'm noticing a
tendency towards integration nowadays
too so for example like GES pipeline
includes an integration server in this
case I think you're using servicemix to
actually say do this workflow then start
up this machine and do whatever else
like that yeah so I mean one of the
things is is that if you actually look
and we have a community page that that
lists out a bunch of a bunch of things
that are sort of pre-canned so like
palette is one of them its enclosure
clarifies another and they actually do
things at a higher level stacks and then
there's a bunch of services too so I
mean if you look if you look at the the
catalog one of the good things is is
that there's there's a number of folks
doing this stuff and so we try to we try
not to eat our children so the more
things you like dive into the more
likely you're going to have a conflicted
relationship with your ecosystem so yeah
trying to we tries try to make a better
or higher quality
I was a large enterprise yep
right yep that that's what people do in
fact it's not always a movement it's
sometimes just a like adding more to
your resources so they just sort of add
things and so it's similar to like
introducing another product into your
environment like some will some will be
using it immediately some will be using
it later and and that's how like a lot
of the enterprise-e folks that are using
J clouds are attacking the problem like
they try to make the most attractive new
space so that their developers will be
interested in going there because right
now there's actually like a little bit
of a fight because people can get access
to cheap hardware in the sky with credit
cards and so internal IT departments how
to sort of raise their game a little bit
because there's a little bit of cowboy
ISM going on and so it's actually really
nice change because some some
environments are just saying okay well
let's not that's not like go around with
a hammer and break people's knuckles
every time they use easy to let's make
something that's more attractive and
that's pretty cool
it's actually a very common concern
especially I've had a lot of stickiness
with the van where over the over the few
years in fact they were the first paying
you know when I was trying to like okay
how am I actually going to pay my rent
the first contract was actually with
VMware which is really helpful and
kicking off the project and what I've
noticed just talking with people in the
vm world where world is that they had
these new products like their cloud
editions but then still people don't
really know a what to do with them or be
how to Kabul them together as much and
so sometimes it's just that they want to
somebody else to prove the concept you
know and then then they can hire you
know the sis or whatever to do their
jobs or whatever but and so vcloud
support has actually been one that's
been really helpful for us and getting
enterprise adoption because when people
are put in a pressure position often
they they go with the brand that they
know and so if you have something that
will allow you to use different brands
they can also switch later anyway on we
can feel free to talk later but thanks
first an</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>