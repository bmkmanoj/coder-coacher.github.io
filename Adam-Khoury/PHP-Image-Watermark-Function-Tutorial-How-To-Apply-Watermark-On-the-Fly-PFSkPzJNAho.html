<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Image Watermark Function Tutorial How To Apply Watermark On the Fly | Coder Coacher - Coaching Coders</title><meta content="PHP Image Watermark Function Tutorial How To Apply Watermark On the Fly - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Khoury/">Adam Khoury</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Image Watermark Function Tutorial How To Apply Watermark On the Fly</b></h2><h5 class="post__date">2011-03-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/PFSkPzJNAho" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello there and welcome back to the
mastering PHP image processing video
textbook in this lesson you will be
learning how to apply watermarks to
uploaded images on the fly as they are
uploaded and we will be stemming off
four previous lessons within this
textbook to more easily accomplish this
task so I'll show you how to have your
image upload application take in a PNG
gif or JPEG whatever type and we'll
apply a watermark dot PNG file onto the
uploaded image directly in the center no
matter what shape or size the image is
the watermark will be directly in the
center now before we get into the
nitty-gritty of the code let's prove
that it works like we've been doing our
other functions let's upload the flower
let's upload the girls and let's upload
the sky now let's go into our uploads
folder and here we have the protected
versions so I'm going to bring those
over to my local machine to inspect them
alright let's look at protected flower
beautiful lay the transparent watermark
directly in the center of that PNG file
and that PNG file has been converted to
a JPEG so you can see that this is now a
JPEG image that is protected with
watermark and it used to be a PNG file
when it was uploaded it was a PNG so get
protected girls beautiful right in the
center and nice and transparent and
protected sky alrighty so now you know
it works you can see that it places any
watermark image that you want to use
right in the center so it's a really
good function for you guys to start
playing around with and like I said
we're stemming off of the image upload
application that we've been working off
of since the beginning of this video
textbook and by now you guys should be
comfortable with what we're doing and
how we're adding these external
functions so here we have from the last
lesson or convert
JPG function that's how we got those
images converted to JPEG to more easily
watermark them so here I'm going to add
Adams image watermark function so what
this does is it takes three parameters
which are these three variables
established here you can see them at
work right there so those three
parameters get fed to the aka image
watermark function which is going to go
in our a K PHP image library 1.0 script
so let's take a look at what those
variables are so the first one is target
file which is the uploaded file after
it's been resized and if it happened to
have been a gif or a PNG it was
converted to a jpg using this function
here second parameter is the watermark
whatever kind of watermark you want to
be creative and make all kind of crazy
cool watermarks that's great just create
a dot PNG with no background I'm
actually I'm going to show you guys how
to make the watermark PNG file in
fireworks cs4 so don't worry about that
I'll show you how to make that but this
is where you designate that file and
then the new file this is going to be
the output JPEG that's going to be
protected so I just put a prefix of
protected underscore in front of the
files name so instead of resized
underscore kaboom that JPEG is going to
be protected underscore kaboom first
element JPEG okay so that's the three
variables or the three parameters being
sent to this aka image watermark
function and this function has to be run
after you run this convert function so
if you plan to use this watermarking
function then you have to run this file
conversion function before you do to
make sure that every file that runs
through the watermarking function is a
jpg before it runs through there you got
it okay good and it's just a whole lot
easier for your image application to
work with nothing but JPEGs since we
know where we can convert any image and
not lose any quality we can convert any
image to a jpg you might as well it'll
save you a lot of headaches in the long
run with your programming if everything
is a jpg from the get-go
because you can convert it to a JPEG the
image watermarking and everything else
is a whole lot easier to do all right
now all you guys need to see is that
function aka image watermark which is
going to be in aka PHP image library 1.0
which is this file right here along with
all of our other functions so the last
one we put in was image convert function
this is the function that converts any
image if it's a gif or PNG converts it
to a JPEG so right under that one I'm
going to put a new function it's called
aka image watermark remember I said it
takes three parameters so here it is
taking in those three parameters the
first one is the target file the second
one is the watermark file and the last
one is your new copy the one that's
going to be placed on the server the
protected file so the first line within
this function use the image create from
PNG function to create a new PNG file
from the watermark files source and you
can just name that watermark keep it
simple then we use the image alpha
blending and image save alpha functions
on that watermark and you can set those
appropriately for your needs to true and
false I set my watermark to an alpha
manually so you can choose to do it the
way I did it or use whatever kind of
method you want you can see mine work
just fine you saw the finished product
and it had it was a nice finished
product
okay the next line is we create our
image from the JPEG which is the target
JPEG image and that's in a variable
called IMG then we find that images with
and that images height by using the
images Y and images X functions so
you'll need that images height and width
then you'll have your watermarks height
and width variables using the same
functions images X and images Y but on
the watermark this time because in the
image copy function you're going to need
the watermarks height and width and the
images height and width that way we can
Center things nicely here also you can
see I added actually this is code I use
in flash a lot
ActionScript 3 for dynamically centering
items within containers so I just used
the same code to Center the watermark
PNG file into the center of any image
that's being uploaded directly in the
center the way you do that is you take
the images with / - and you - the
watermarks width / - same thing with the
height that way you find the center
point for the big image and then you
offset the watermarks size to plop it
right in the middle that's basically
with those two lines do and they give
you destination X and destination Y then
you use those values in the image copy
function to place the watermark directly
where it needs to go and you create a
new jpg image that has a blend of the
original image and the watermark right
on top so it's really creating a new
image from those two but blending them
then you can use image destroy on your
image that was created from JPEG and
image destroy on the watermark since
they're not going to be needed anymore
once the image JPEG function runs you
won't need access to an image or
watermark so you can save resources by
destroying those it's a very simple to
understand function for creating a
watermark and like I said it works in
conjunction with this convert to jpg
function so you convert any image to a
jpg that way you can more easily water
market your water marketing
functionality doesn't have to be so
in-depth it's a lot easier just to
convert to jpg then water market
alrighty guys so now you have another
notch in your belt for expert image
processing in PHP and stay tuned for
more because we're not done yet oh I
almost forgot some of you guys might
want to see how to create the watermark
actual watermark PNG file in fireworks
or Photoshop or whatever image editing
software tool you use so I'm going to go
to create new fireworks document 8 by 6
is fine and you can go in and the way I
made mine exactly if you want to see the
exact way I made mine was
let's see let me first change the canvas
to black that's what I did first then I
pulled out the spiral tool I held down
the tool section you hold that down
you'll get all of the different shapes
that you can draw imma grab spiral and
then I drew out the spiral I made sure
it was white you can make it any color
you want I made that too and then I spun
it around to give it as many spirals as
it'll get then I think I twisted it
something like that or whatever and then
I had the words develop PHP right here
so once you have that you can highlight
those two items go to modify flatten
selection so there one item all together
or you can group them and I'm going to
bring the Alpha down on it till about I
don't know 30 whatever you feel is best
so now you've faded the Alpha on it so
it's going to be transparent so make
sure you go to your canvas make it
transparent canvas now you can hardly
see your little item that's on there but
trust me it's there and then you fit
canvas and your watermark is still there
remember if you bring your alpha all the
way up to 100 you'll see it better you
see it right there but let's keep the
Alpha down to about 30 or 20 in between
there 23 is a good number whatever you
want to make it and then you go to file
export wizard continue the web continue
exit and make sure you have PNG 30 to
set and I like to make matte clear no
matte just make sure you set to PNG 32
and then you export you save it call it
watermark and it'll be watermark dot PNG
you put that on your server make sure
that's on your server where you're
running your script and that's all there
is to it
we'll see you guys in the next lesson
mang</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>