<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>WAPG 5 Collision Hit Detection DOM Programming JavaScript Tutorial | Coder Coacher - Coaching Coders</title><meta content="WAPG 5 Collision Hit Detection DOM Programming JavaScript Tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Khoury/">Adam Khoury</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>WAPG 5 Collision Hit Detection DOM Programming JavaScript Tutorial</b></h2><h5 class="post__date">2017-04-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/h-zwL615rb4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome back to the animation
programming guide in this video we're
going to demonstrate collision and hit
detection in the Dom the Dom is the
normal web development environment we
already made collision and hit detection
tutorials for the html5 canvas in my
canvas bootcamp playlist which you can
find on my channel anytime you want
that's already there that series also
deals with a lot of animation concepts
for the canvas but in this lesson we're
working in the Dom the example that I
wrote up today stems off of the code
that we left off with in the last video
in this playlist number four and you can
get today's lesson code by following the
link that I put in this video's
description text under the video the
code that we left off with in video
number four gave us something that
allowed the user to control and objects
animation on the screen by giving them
control buttons and you can give them
controls in any way that you like but
the basic effect was allowing the user
to control the movement of an object on
the screen and that can be a player
character or whatever kind of object
that you want it can also be just normal
Dom elements you can allow people to
move a form field button an image
whatever you want so what we'll do now
is add another object to the screen and
then as this object is being moved by
the user if it happens to collide with
that other object then we want to have
something happen in our program a
collision detection so we're going to go
down into the code and right here where
we have the player div we're going to
add another one that has an ID of thing
1 then we're going to go up into our CSS
and we'll put the style rule for thing 1
so we'll have all of these properties
and if we look at our program now we'll
see that we have thing 1 sitting right
here which is the little blue box and
remember it can be anything that you
want it doesn't have to be a little blue
box and it doesn't even have to be a div
it can be any type of element that you
want now right now if I was to go and
collide into that or move into
it with the other object nothing happens
so now we're going to go down into the
script and here where we're initializing
some variables that our program will use
we're just going to add some more
variables to initialize and this
variable P represents the player object
this variable T represents thing one
then we're going to represent player
with player height player X position
player Y position X position is where it
is on the horizontal plane on the screen
the Y position where it is on the
vertical plane or the vertical axis on
the screen and the same for thing 1 its
width its height its x position and its
Y position and here we're going to go
down into our function dock ready and
this function is where you get
everything ready in the program after
the document is fully loaded so this is
where you can set a lot of things up
before the program runs so I'm just
going to take this line and copy it the
one for the player and I'm going to put
T representing thing one which was the
variable that represents thing one and
then we'll just put thing one's ID here
that way we have an object reference
ready for thing one it's represented by
variable T and in this doc ready
function we're also going to run a
function or start up a function called
detect collisions so it's always going
to be detecting collisions on the screen
right when the program starts up and
let's go ahead and put that function
detect collisions into place now I'm
just going to put it right here where
the other functions are written I'll put
it right above at the top and here we
have this function will be set to repeat
very fast now the way this detect
collisions function is set to repeat
very fast is the method that we
discussed in video number four which is
the request animation frame method so
when you run request animation frame
it's going to be something like 60
frames per second
it makes this detect collisions function
run over and over again 60 brain
per second approximately 60 frames per
second now I'm going to take you through
all of this code line by line explaining
every bit of it but essentially our hit
detection logic is sitting right here in
this if condition so it's basically one
line of code that handles the logic so
the first thing we do inside of detect
collisions is we access the current
location and dimension of both objects
so we have to know where they are on the
screen and how big they are so those are
the variables that we're going to get
we're going to get the players with the
players height the players x position
and the players Y position then we're
going to get thing ones with height x
and y positions using all of these
properties in JavaScript offset width
offset height offset left and offset top
that lets you know where it is on the
screen and how big it is then once you
know how big the object is or both
objects are and where they are in the
screen then you can set up some logic in
an if condition and if they happen to be
intersecting or collide then you can run
any code that you want to make anything
happen in the program so first before I
explain this code right here - which is
not overly complex but it's the most
complex thing in the script that we have
here let's take a look at what happens
in the browser so if I move right I
collided with the object and the object
went away so the player object eight
thing one or collided with it and made
it go away and that code was document
dot body dot remove child T so you're
removing from the screen thing one you
can also have code in here that gives a
point to the player object if it happens
to collide with thing one or any kind of
functionality that you need to occur and
I'm also going to show you how to run
over an array of objects so there
wouldn't be just one thing there could
be many things on the screen that the
player will run into or collide with
and you can make whatever you want
happen so we'll do that in just a second
but first let's explain this code real
quick right here and what we're doing
with this line of code is we're checking
to see if thing one has intersected with
thing two
actually let's call this player check to
see if player has intersected with thing
one in any direction so if the player
object happens to be coming from the top
and collides with thing one it will
still have a collision detection that
works just like it does here or if it's
coming from the from the left instead of
going right for instance if I was to say
left 300 here for player and we check
that out and we go left right at the
moment of collision you can see it takes
it away so let's just put this back on
20 and now let's explain this code real
quick now all this is doing is taking
the objects both objects size and where
they are in the screen and constantly
checking to see if there's an
intersection if they intersect or
collide and it's just knowing those
values and a little bit of math you can
see we're using Plus here to add the
players exposition to the players width
so we're taking players exposition plus
the player with and we're checking to
see if that value is greater than thing
ones exposition then we use the and
operator to make sure that we're
checking to see if the player's
exposition is less than thing ones
exposition plus thing ones with then we
use another and operator to accommodate
for the vertical axis to see if player y
position on the screen is vertical axis
plus its height is greater than thing
ones Y position on the screen and we're
also checking to see if the player's Y
position on the screen its location in
the vertical axis is less than
thing ones y-position plus its height
now there are a lot of different ways
that you can set up this detect
collisions functions for instance this
if condition could be inside of its own
external function and you just feed
variables into it and objects that way
it runs independently of the detect
collisions functions but it would be
this pretty much the same as being
inside of the dedications function which
all the detect collisions function is
doing is running 60 frames per second
approximately so you just basically want
to make this code run at a high enough
framerate to where you're always
detecting collisions in the screen for
any amount of objects that you desire
and you can also have math involved more
complex math involved to create any type
of shape that you want or bounds area
for these objects if you don't want to
use their true size and shape you can
make this formula a little bit more
complex for instance if you wanted to
detect collision only in a small area
inside of player one and not its whole
size or if you wanted a different kind
of shape detecting on the collision and
not its actual size you would just have
to add more math within this line to
make any imaginary type of bounds that
you want in relation to where player one
is for instance you can have it detect
collisions if you put math in to make
the box imaginary imaginary ly bigger
you just have to add more math like
twenty more pixels and then it will
detect collision before it even hits see
what I'm saying so that that math could
be added by you according to your
personal needs or according to your
specific needs
now here's another files code that I'm
going to give you that you can play
around with and what this one is doing
is it's changing T from being just one
thing to three things so let's take a
look at what that renders
and actually we'll look at that in
Firefox and we'll open up the developer
panel the web console and what we'll do
is start moving and then you see in the
the web console that it logged collision
detected with thing 1 and if we keep
moving across the screen collision
detected with thing two collision
detected with thing 3 and even if you
start for instance let's put the player
at a left position of 400 pixels okay at
400 pixels it's already
callate it's already detected the
collision of thing 1 when the program
starts up as we move left detective a
thing to detected with thing 1 now the
only difference between this example and
the first example is that thing 1 has
now become an array so we get use the
get elements by class name over things
and you can see that each of the things
that we want to detect collision 4 has a
class of things for the each have an
individual unique ID as well but they're
all grouped together using the class
things so here T is now an array instead
of being just a single object it's a
group of objects that all have the class
of things so what we can do is in our
detect collisions function the only
difference in this function now is that
we're iterating over the length of the
array using a for loop so for each of
the objects in that array this for loop
will run one time for each and you just
set up your variables to represent each
one of the objects within that array so
you know it's specific individual with
high exposition and Y position that's
different from the other things and this
code is exactly the same nothing has
changed there
and when we're removing child we're just
referencing the thing in its position in
the array so each time this for loop
runs this I variable it's going to start
at zero so that's the first object in
the array and then it's going to I plus
plus so it'll be the next time it runs
it's this I will be a 1 then it runs the
third time this I will be a - and that's
how you target each one of the objects
in the array independently or in
succession so the fundamental difference
is that you're now putting a for loop in
here and you're using an array or a
group of objects that you wanted to
check collision for because T now
represents an array of objects instead
of just one thing that represents three
things and it could be 50 things if you
wanted so that's about it I'll have both
of the code examples where you can find
them and I'll have a link to that code
in the description area under the video
you might want to set your program up to
do different things for instance giving
the player a point each time it runs
into one of those objects or you can
kill the player you can make these
little sawblades little images of
sawblades
and then as the users running along if
he happens to hit one of the saw blades
you can make the player die you can do
whatever you want in the program it's up
to you or it doesn't even have to be a
game this can just be a box with words
in it or a form field or any type of web
element and as it runs into something
else maybe you want to make that
something else that other thing bounce
away or move away or an animation start
on that other item that it runs into you
don't have to take it away from the
screen or off of the screen you can do
whatever you want now none of this CSS
has to be in the document you can
externalize that none of this code has
to be directly in the document you can
externalize all of that this if
condition can be in its own separate
function that runs by being given
argument
and parameters but I just set it up this
way so it's not overly complex and you
can really grasp what's going on so
don't focus so much about how I have my
code set up you don't have to have your
CSS in the document you don't have to
have your JavaScript directly in the
document this code down here these on
Mouse down and on Mouse up events could
be set up within your doc ready function
using add event listeners in your doc
ready function to give event listeners
of Mouse down and mouse up to these
button elements and it wouldn't take
much work at all to make these things
get this out of the HTML for instance it
wouldn't take much work to externalize
this all of the CSS and all of this
JavaScript it's very simple to do okay I
hope this lesson in collision detection
for the Dom was helpful to you and that
you enjoyed it we'll be getting into a
lot more cool stuff as the series
progresses</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>