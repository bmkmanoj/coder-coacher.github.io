<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>14. Ajax Tutorial Photo Gallery Programming Social CMS PHP MySQL JavaScript | Coder Coacher - Coaching Coders</title><meta content="14. Ajax Tutorial Photo Gallery Programming Social CMS PHP MySQL JavaScript - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Khoury/">Adam Khoury</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>14. Ajax Tutorial Photo Gallery Programming Social CMS PHP MySQL JavaScript</b></h2><h5 class="post__date">2013-02-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/qA9U_FjiZUE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this lesson we will demonstrate a
simple way to achieve photo gallery
programming within your social network
website software that you're building
from scratch all by yourself because
you're awesome this is not a completed
or polished photo gallery system they
must be redesigned by you to make things
pretty and unique and it must be
enhanced in its programming by you
before we quickly explain the new files
we will demonstrate the live
functionality so you can evaluate
whether or not you even want to
understand the code to work behind the
scenes before you get too deep into this
video you know what I'm saying okay the
first thing you'll see on everybody's
profile on your website is that there'll
be this photo stack looking thing here
and we're digging one random photo out
of the users photo galleries if they
have any uploaded yet so if the user has
uploaded a pictures into the photo
galleries then one random picture will
always come out of there so if i refresh
the page you'll see it's a different
picture and I'm going to show you what I
added to user dot PHP to put this in
place basically it's just a div with a
CSS background set to this little stack
of Polaroid looking things here and then
I have a image tag inside of that div
and I am is able to position that in
there just right to where it fit on that
first photo in the stack so it's just a
little design tip now once somebody
clicks on that they're going to be
ushered to a page called photos dot PHP
you can see I have the blinking
notification thing that's because I put
some other systems in place but I'm
going to discuss those with you in the
next video so I'm now receiving
notifications and this thing is blinking
wildly to let me know that newness is
there for me to see so you're going to
be getting this script called photos PHP
or it's a page called photos PHP and the
gallery user interfacing is all Ajax so
what happens is when the user first
comes to the page it's showing all of
the galleries here's the pets gallery
myself gallery and my random gallery so
if I click pets it opens up to show all
of the pet photos within that gallery
and it's still on the same page no URL
change or anything then if I click on
one of those image
is it shows the full-size image with a
little X button and I put in some
functionality so you can create user
options only for the person that owns
this photo so since I own this photo and
it says these photos belong to Adam it
says delete this photo Adam and I can
delete this photo if I want here I'll
show you delete press ok to confirm
delete action ok the picture has been
deleted successfully we will now refresh
the page for you
see if I go back into pets it's gone so
what happens is when somebody clicks to
see the large image they have this
little X button on the side and they
close that and it takes them right back
to the gallery they were in and then
once they're looking at a specific
gallery they can say go back to all
galleries so the user can click this and
it goes back to all galleries and it's
also connected to a file that you're
going to get photo system dot PHP which
is within your parsers and that's for
the person uploading so if the user
happens to be the person who owns that
photo page up top it'll say hi Adam add
a new photo into one of your galleries
now I didn't give you the programming to
allow your users to establish galleries
that's something that you'll have to do
on your own and it's not hard at all you
just have a little form that says
establish new gallery put a little field
that says name the gallery and then I'll
create button basically and then you
stick that into a new table that you
create into your MySQL database called
gallery titles and then you can connect
that to your photos table so every photo
that goes in gets connected to a certain
gallery that that person has named and
created specifically you'll see in this
system that you get from me there's
already default galleries in place and
the user does not have the opportunity
to create new galleries they can only
put pictures into these so let me show
you if I go to pets and choose file
let's get this one right here and upload
photo now so when the upload is finished
you'll see I have a new picture in my
pets gallery you can click on it and
check it out see that DeBellis but and
this is Bella's little house that I
built for her with cardboard and sticks
so that
pretty much all of the functionality now
if I go to the home page and go to a
different user and I see that he has
photos scrim and click on that he has
two galleries he has some in random and
myself and since I'm not the owner of
this galleries or these photos there's
no forms up top for me so I click on
random and I can click on these photos
and check them out and says these photos
belong to ican 95 and there's a whole
lot of functionality that you guys can
add to this very very basic simple
system like I said if you're the owner
of the photographs you see this little
if I click on the photograph see this
little option to delete the photo that's
where you can put all kinds of different
options or anywhere you want you can do
like some sites and put the options
right on the photo when the user hovers
their mouse over the photo so if the
owner owns the photo and he puts his
mouse over it you might want to put the
options in there just like we did here
see when I put my mouse over my photos
since I own it a button pops up you can
do the same exact thing within your
gallery so you think imaginatively and
make you systems great and since I know
a few you guys are going to ask you can
definitely borrow my graphics for this
little stack of photos here that way you
can play with it until you get something
created of your own okay if you go to
web intersect all you have to do is go
to style photo showcase BG JPEG so you
see the URL and that's where the image
will show up and you can just take that
save image as okay that way you'll have
it in place on your site without you
having to actually go and make the
graphics you can just recreate it later
actually you can use it keep it if you
want I don't care I created it in
fireworks so you'll have no concerns
about copyright or whatever over that
particular image
okay so under the video you'll be
getting the updated user dot PHP you'll
be getting this photos dot PHP and
you'll be getting photo system dot PHP
now on user dot PHP what I did was added
another little PHP block here under the
rest and this is for the cover picture
and there's also some CSS in place for
that cover photo let's see the photo
showcase element it's a div you can see
I gave it a background of that style
photo showcase PG JPEG and then inside
of that div I have an image tag and
that's how you see that image inside of
it positions in just such a way to where
it looks like it should be the the cover
picture on that little stack of
Polaroids we select file name from
photos where user equals you order by
Rand limit one so you're just taking one
random photograph out of there all of
their photo galleries and if they happen
to have one then you can run mysqli
fetch roll to grab the information for
that file name and put it into an image
tag that way you can display that image
if they happen to not have an image
it'll just be a blank gray spot or you
can choose to not display that little
stack of Polaroids at all whatever you
choose to do the logic is up to you ok
so you've seen the PHP and the CSS so
let's go down into the HTML and where is
that so here we had the profile picture
there's their default avatar and then we
have another div under that now that is
photo showcase and it's positioned in
such a way to sit off to the left side
of the profile avatar and inside of it
that's where you put that cover pic that
we got here in the PHP okay you put that
image tag right there inside of that div
with ID of photo showcases and then on
click of that div there's JavaScript to
navigate to the window location of
photos dot PHP for this user alright so
that's pretty much everything inside of
user PHP that was not in it before now
photos dot PHP this is the page that the
person's going to land on the viewer
will land on when they click to view
anybody's galleries and this page shows
the galleries it show
all the images in the galleries and it
shows the single image all by itself all
on one page using Ajax so the first
thing we do is include check login
status PHP and we see if the you
variable is set and we filter it if it
is then we're going to check to see if
the viewer is the account owner so if it
is the account owner we make this
variable say his owner equals yes and
then we populate the photo form this is
the form that was sitting on top of the
galleries that was all green that was
only showing to me when I was logged in
on my photo galleries page so only the
logged in user will see that form up top
and this is the place where you would
add another form if you want to allow
your users to establish custom galleries
that they can name and create and
remember like I said you'll need another
table you'll need another database table
called gallery titles if you're going to
go that route okay so that's the check
to see if the user is the account owner
then you select their user galleries so
you set up a variable called gallery
list because that's what you're going to
put into the HTML here see gallery list
is living within a div with an ID of
galleries you can set up your CSS for
that galleries div and anything inside
of it and anything to do with your
gallery software CSS can go right there
okay so you can see down in the HTML
we're echoing gallery list
we're also echoing the photo form so
gallery list is created by selecting
distinct gallery from photos where user
equals this user then you run that query
and you say if the MySQL num rows from
that query is less than 1 this user has
not uploaded any photos yet so that's
all the HTML output that you get in your
gallery list variable else they do have
photos then you can run the while loop
over that array and this is what
produces just the first gallery view
where the user would just land on that
page initially and then when they click
one of these gallery boxes that is when
the page will request using Ajax to get
different photos to show for that
gallery dynamically so if I have four
galleries they're all going to be set
in a div they'll all come pouring out
within this while loop and you can see
for all of these divs there's a show
gallery function so on click of those
divs show gallery runs you have to pass
the gallery name and the user and that's
a JavaScript function that I'm going to
show you right here see show gallery so
that's really the last thing in this
file I have to show you because really
that's all the PHP right there
so let me collapse that backup right
there and let's talk about the
JavaScript so when show gallery runs
you're going to make an AJAX request to
photo system dot PHP which is the file
I'm going to show you in just a second
and that's in your PHP parsers folder so
don't forget to put photo system dot PHP
within your PHP parsers folder now what
I'm going to do is just let you guys
reverse-engineer my JavaScript because
I've explained this Ajax object and
posting to PHP about 20 times within
this series so far so I'm not going to
explain that again all I'm doing is
making an ajax request to PHP to get a
whole stack of images for that gallery
back and I'm going to get a string all
I'm doing is from PHP s PHP is going to
send back a long string with all of the
images that belong in that gallery and
with JavaScript you're going to split
that string that PHP returns once that
string is split then you'll have all of
your images individually and then you
can split the string one more time to
get at each little component of
information for each image that's the
only difference between this Ajax
request and the rest that I've been
showing you is that PHP is going to send
a big string a strong I'm going to call
it a strong array it's going to be just
a an array that we are going to create
custom using delimiters and I'm using
this as a custom delimiter to separate
each image that comes back and then each
image also has this as a delimiter to
separate its file name its ID and little
pieces of information just for that
image then when all those photos come
pouring out in this for loop then you're
going to have a function called photo
showcase that runs
let me close this function and photo
showcases right here and this is the one
that shows the picture big to the user
and you'll have a little delete or not
delete you'll have that you'll have a
delete link if the user happens to be
the owner you can see I'm just popping
in PHP directly echoing it right there
into my JavaScript to see if it's the
owner so if it's the owner he gets the
little delete link under the image but
everybody gets this little button which
is it runs a function called closed
photo so when the image is in grand
display you give them that little close
button the close photo javascript is
very simple you're just basically
closing certain things and opening other
things back up for viewing okay this
delete photo function runs when the
owner of the photo wants to delete it
that's going to be an ajax request that
sends to these photosystem PHP and
photosystem PHP parser script is what
deletes it then the last thing is back
to galleries and basically that's just a
way to close all of the images
displaying for a certain gallery and go
back to the main landing page of the
photos PHP alrighty so that is the whole
photos up PHP page pretty well explain
that I'm not going to go really into
depth into the every line of code
because you guys have really gone
through a whole lot of Ajax in PHP at
this point and JavaScript so you should
know what these little lines are doing
as you go through and reverse-engineer
all of these files you should be reading
each line intently even if I don't
explain each line you should read each
line to make sure you understand every
single line if you don't ask questions
okay so photosystem PHP this one is set
up to not check to see if the user is
logged in until after this if condition
here because this is the one that you
want to show when you want to grab all
of the gallery pictures so even if the
user is not logged in or whatever you
want to make sure that this can run at
least two where you can show all of the
gallery pictures to just every
and them visitor so we say if is set
show and the show posted variable is
equal to gal pics then we're going to
gather all of the gallery pictures for
that particular gallery for that
particular user okay so you get the
posted variables of gallery and user
from the Ajax and you're going to filter
those clean them up before you make a
query with them and the SQL is going to
be select all from photos table where
the user equals this user and the
gallery equals whatever dynamic gallery
is being passed to this script ordered
by upload date ascending so I'm ordering
the photos by their upload date for that
gallery then we run that query right
here and then we run a while loop over
that result set to get all of the data
out and append to a pick string variable
so this pick string variable is what
we're going to send back to Ajax
you can see I have each image in the
gallery is a little string of all that
particular images information its ID its
file name its description and it's
upload date and then after all of those
little pieces of information are put
into the string
I put three bars and naturally in
between each little piece of information
for each file there is a single bar so
you could have 20 pictures being piled
into this string and when it gets back
to Ajax JavaScript can just easily split
the string by these delimiters that you
establish it could be any sequence of
characters that you want so then we
simply close the database connection and
we trim the pic string to pull off the
last three bars because on the end of
your pick string there's going to be
three bars placed there just naturally
by the way this string is established
here so when this while loop is finished
putting pics into this pick string
you're going to have three bars on the
end that you have to cut off so that's
what the trim function is doing it's
cutting off those last three bars that
way when it's split in Ajax it will have
a good array structure if you didn't use
trim on these three bars at the end it
will still split in JavaScript but
you'll have an empty array all
on the end and then you just echo back
the whole pic string to Ajax and then
Ajax will do the splitting and setting
up the interface and showing of all
those images in a simple loop so back in
photos that show galleries you see this
loop right here this for loop that's
where you're setting up the display of
all those images because you split that
string very cleverly back in JavaScript
and so this is a way you can get by with
passing a whole lot of data dynamically
to back to Ajax to be displayed in any
way that you want and you don't have to
use JSON you don't have to use XML this
is a very raw way to send a lot of
information so that is the first
condition that is to show all the
gallery pictures then the rest are for
the logged in user
so you'll have it to where he can upload
a new avatar and you already have this
code actually from the last tutorial so
you know all about this that I have
highlighted already the new code that I
put in are these two blocks and this is
for if they upload a new photo into one
of their galleries then you're going to
grab that information coming in and all
this PHP does is it basically resizes it
to the size you wanted to make sure
everything is okay and then it syncs
this image into the database well it
doesn't put the image in the database it
puts the string for the image name in
the database associating it to this
gallery and then that image whatever
it's named is put into the users folder
and we have also a new system of
renaming your picture so you see the
file database name so the database file
name the string that's going to get
stored in your database and the actual
name the file will have where it's
sitting in the users folder it's going
to be a little different from the last
when we were uploading the avatar for
these we're going to use the date and
put a special configuration to this
string basically to make it output
something like this that's basically
what it's going to look like
I made it out put the day the month down
to the year so it has the hour and even
the seconds are in there but when this
image was uploaded that way you won't
get any duplicates and since we're using
a random number on the end there's going
to be a four digit random number put on
the end so there will be no conflicts of
naming of files when they're uploaded
even if you have multiple file upload
mechanisms so if files are uploaded at
the same exact second they still won't
have the same name if you use this
method right here so basically it's just
a way to make sure that no two images
will have the same name upon upload
since you're renaming things dynamically
and this file name will be associated to
this user in the photos table so once
it's renamed it gets popped into the
users folder and the string gets put
into the photos table for that user
that's basically it and then when you go
to display all those images that's when
you query all the photos out all right
so I'll collapse that back up and that
is the whole section of code for when
the user is logged in is adding a new
photo to one of their galleries now this
next part is what the user wants to
delete the logged in user wants to
delete any of their photos this is very
simple you just grab the ID of the photo
they want to delete from the Ajax
request you want to make a query to see
if the user actually owns the image so
after that query you'll have a user
variable that you can say if the user is
equal to the person who's logged in that
means it's the owner you're verifying
that that's the owner of that photo then
you can set up the delete and unlink
function so you unlink the file from the
users folder system and you also delete
the database string name in the photos
basically you just delete the row in the
database for that photo so just make
sure whenever you're deleting files that
you unlink it in the folder system and
delete it in the database
wherever the reference for that file is
stored and then we echo back to Ajax
deleted okay
and that is the whole entire photo
gallery system that you saw me
demonstrating you get user dot PHP just
the little few lines of code we added to
that you'll get the photos dot PHP
script and that's basically the user
interface of the gallery's display and
then photo system dot PHP which is
strictly just your parsing mechanism now
in the next video I'll be showing you
how the notification system is setting
this to blinking now because I actually
have new notifications and so you'll
have the programming to understand how
to send notifications to everybody's
friends so basically I get notifications
when all of my friends do certain things
and they get notifications if I do
anything and you'll also see this
conversation system which allows people
to talk on other people's profiles if
they happen to be friends and the
profile owner can comment back right
there if they want profile owner can
also go to that other person's profile
and say something to them start up a new
conversation and then once people are
replying to things you'll have
notifications see I have all these
notifications if I click this one I'll
see the juggernaut posted something to
his status so let me go check it out he
says hello everybody and I can reply
I'll say hey dude reply and it just puts
it right under his original post it says
posted by juggernaut then it says reply
by you just now if i refresh the page
it'll say replied by Adam whatever time
that was so that's what you'll be
getting in the next video tutorial for
the web intersect tutorial series
alright</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>