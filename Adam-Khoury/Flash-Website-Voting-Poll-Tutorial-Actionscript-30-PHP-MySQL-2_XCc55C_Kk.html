<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Flash Website Voting Poll Tutorial: Actionscript 3.0 PHP MySQL | Coder Coacher - Coaching Coders</title><meta content="Flash Website Voting Poll Tutorial: Actionscript 3.0 PHP MySQL - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Khoury/">Adam Khoury</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Flash Website Voting Poll Tutorial: Actionscript 3.0 PHP MySQL</b></h2><h5 class="post__date">2010-03-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2_XCc55C_Kk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Jara every tutorial that I do usually is
something that people go to develop PHP
in the requested tutorial section and
they request us to do it so I'm not
yanking these out of my arse these are
highly requested things and what this is
is a flash poll that has PHP and MySQL
functionality and auto updating this one
says what do you think who is your
favorite character on Sesame Street
mine was snuffleupagus so I'll pick
snuffleupagus press boat booyah baby
snuffleupagus has one cleared the field
says thanks for voting have a nice day
now it recorded my IP address so let's
see if I can vote again Oscar the Grouch
vote up you have already voted it in his
poll and it turned red now what if we
try to vote without even choosing
something let's try that oh please
choose before you press boat so it's a
very smart application you want this for
your website okay now I'm gonna change
my IP address that are recorded in the
database and show you how I can make
another selection like I would if I were
somebody else
okay I went to the database changed my
IP address that was on that first choice
and I'm gonna pick Big Bird vote and
there we go so now you know it works you
want to learn it you can write now the
first thing we have to do is create a
storage mechanism it's gonna hold all of
the votes all of the choices that the
users make I have created my MySQL
database already so I'm just going to go
into phpMyAdmin
I'm gonna add a table to that database
that I created special for this if you
have a database for your site already
set up you can add a little table to it
for this or you can have a whole
separate database it doesn't matter so
I'm gonna click on the left over here
the left column on the new database that
I created and there's no tables in it so
I'm gonna add a table to it
so let's name our table voting poll
fields three press go when the fields
come up to populate you're gonna make
the first one ID it's going to be
integer length it's going to be auto
populated for you they'll have a value
of 11 let's go down an auto increment
and check that box or set it to true and
then primary for the index now this
one's gonna be choice this one is going
to have it's gonna be int as well it's
just gonna be a number and mine's gonna
have a value of 1 if I was to have 10
choices that they could choose from in
that question in the poll this would be
a 2 if it was 10 or more if I had a
hundred or more options for them to
choose from which is crazy that would be
a three so you see what I'm saying and
so I'm only gonna have like three
options for them to choose from this is
always gonna be a one because it'll
always be under nine or under ten the
amount of options I give them I'm only
gonna have three options so this is this
number this choice field will hold only
a one a two or a three
that's it I'm only gonna have three
choices the next one is going to be the
IP address so IP address that's going to
be bar char 255
I just make my bar chose 255 usually
because that's the max fight limit that
they can have in the bar chart field and
but you can set bar charts to 50
whatever if you know it's going to only
be a number under that because it will
cut it off if you said that the bar char
12 no more than 12 characters will ever
go into that field it'll just cut it off
automatically alrighty so they think
that's everything we need very simple we
press save
and now we have a table we browse it you
see there are zero results is nothing in
the table but each time somebody makes a
vote each vote is going to have its ID
and that will auto increment their
choice number which will be a 1 a 2 or a
3 depending on what they choose and IP
address that way they can only choose
once they can only vote once but this
for the most part will make most users
not be able to vote twice most people in
the world so don't worry too much about
it
ok so this application has two more
components to it this is the flash file
that's the user interface and then
there's a PHP script that's a parsing
mechanism the dynamic language that's
going to send data in between flash
ActionScript and the MySQL storage that
we set up so we have the flash file and
then there's going to be a PHP parse
file that I'll explain also so what we
have here is stuff on stage you'll see
when you download this file I'll have
the download for it in the video
description area you can just click on
that download the source package and
follow along
we'll have stuff on stage you'll notice
when you open it up and here's scene 1
first thing when you grab the file
you'll be in scene one you'll see layer
1 there and you'll see this thing is set
up into a movie clip everything's
contained into a movie clip called whole
poll that way you can slap this bad boy
that movie clip right into a flash
website a full flash website and it'll
still work all on its own independently
because when you double-click inside of
it that's where the code runs it is
living so the code that runs it is
living inside of the movie clip with all
of these other things that means it can
be independent within your application
and still work and communicate with that
PHP farce file and the database no
problem so inside the movie clip you'll
see there's all the stuff on stage on
that bottom layer the top layer is
ActionScript let's Lock those so that we
don't happen to put in any objects on
those on stage
we just want stuff on the stuff layer
and this one's ActionScript report
requests the totals that is the total
numbers from the choices that people
have made
first thing we want to do before they
even vote or anything is put the amounts
into these three fields here count 1
count 2 and count 3 so that's what this
code is for this one is for when they
press vote they make a choice and press
bolt that's when this code comes into
play so let's take a look at the first
section of code request totals and
you'll want to dig around with the
things in the file click on everything
and notice that most things have an
instance name see how they have
different instance names each little
thing we have on stage here has an
instance name almost all of them and
those things are things that communicate
with the code this is just static that
static text but most things here will
communicate with our code and you'll see
those the name of these the instance
name of these items in the code all
right so let's highlight ActionScript 3
layer request totals press f9 open the
scripting panel there and here is the
code complete that requests totals using
the PHP parse file you can see what the
parse files named parse my poll dot PHP
and that is going to be living in the
same folder as your flash file now we
have the first thing we'll do is set up
the URL variables and then the build the
bar sent variable up build that up with
certain options that we wanted to have
it's going to have the post method
instead of the get method and we're
going to have data variables going along
with this end and here we build the var
loader variable which sets up the actual
communication transmission between
ActionScript and PHP and this is we're
able to give it a complete listener so
have you seen the previous tutorial I
did the guestbook you'll be very at home
with this code because it's pretty much
the same thing we request information
and then when somebody interacts with
our flash file then we send any data
that they gave us or choices or whatever
to PHP in a different section of code
but you have to request some data
initially if you're gonna have a dynamic
application so that's what this all this
is for and it's very similar to the last
tutorial so if you already know what's
going down with it you don't have to
listen it is just bash board so we build
the URL loader up and has the complete
event assigned to it and that means when
data is sent from this using this
variable we're going to send the
variable called my request to PHP and
it's going to have a value of load
numbers so PHP is gonna know exactly
what we want in our request we're asking
to load the numbers so then the complete
handler fires off when that data comes
back from the PHP file so right here
this line actually executes the load
process to the PHP file when it comes
back this complete handler fires off and
then we can put data in that we acquired
from the PHP file PHP file talks to the
MySQL database so that's how it works we
put in the count text fields all of the
choices that we get back from the PHP
file right here in the on complete or
the complete handler function and that
is that now if or we go to section tool
let me explain something to children
these are three dynamic text fields when
the user presses Bo and if this is empty
they're gonna get an error message what
happens is with these three dynamic text
fields anytime the user presses any
button corresponding to that field that
fields information the string data the
words inside of it gets sunk into this
field that's how that works now let's
talk about the send choice code now this
part of the application is a little more
complex is a little more going on but
when we do in the first line is we hide
the processing movieclip much like the
last tutorial there is a processing
movie clip so when the person presses to
send data we load that processing movie
clip up make sure it's showing that way
they know something's happening set it
to have a visible visible property of
false sorry
that way it's not seen until they press
the button the first thing we do said
that the Falls cannot see it when they
press the button below in the code is
when we make it visible true so they
can't see it
second thing we do here is initialize
the choice number variable that will use
below we're going to change this
variable up depending on what they
choose option 1 2 or 3 so this choice
Nome will become either 1 2 or 3 and
then get sent to the database and stored
these bars here are two text formats
that I set up one for error formatting
which has a color of bright red set on
it and then the next one is a text
format that I set for the success color
which is I think a bright green and
those are applied in different parts of
the code that way you can make this text
field have different colors by default
it's white if they get an error it's
gonna be red if they get a success
message it's gonna be green bright green
you can set those colors any way you
need now what we have here are button
click functions let me scroll down a bit
right here we have button function setup
for those three blue buttons so each
button gets an event listener on it that
way we have a function that can run when
that button gets clicked so we run I
have an event listener per click for
each one of those three buttons when
each one gets clicked we have a function
that fires off that handles changing the
choice number variable to that choice
you can see choice known as one choice
number two choice number three then the
choice num text is equal to choice to
underscore txt so that's how we take
this C choice underscore txt that's how
we give that field any one of these
three values depending on what the
people click that line of code right
there where it says choice on the scroll
to XT is equal to choice two or it's may
be equal to choice three if they pick
three or may be equal to choice one if
they pick one
so that's all the button functions and
the event listeners for those buttons
now we can go down to the code that is
very much like the other code on top we
build the URL variables again the URL
request URL loader so this is the
complete handler and what happens when
the button gets pressed is here at the
bottom and we'll go to check that in a
second but here is the complete handler
for what happens after the button gets
pressed and data comes back from PHP
let's explain this first because its
first in the code so in the complete
handler we set the processing movieclip
to false because in the validate and
send function right here we set it to
true so it's they see the processing
movieclip when they click the button and
the complete handler when the data comes
back we said that the back to false so
they can't see it because everything's
done no more processing choice text is
given a value of blank so that will get
no value that way it will clear that
field because there will be information
in this field when they press vote when
the data comes back we want to clear
that back out so we clear that out and
we make the choice now variable 0 again
I don't think that's a very necessary
thing but I did it I don't know why it
doesn't hurt anything then we load the
response from the PHP file see these
event that target that data these are
variables coming back from PHP return
message and then we have the return
message is going to get sunk into the
status text field and we give it the
errors format if it happens to be an
error if the returned return message is
thanks for voting that means it's not an
error everything went through good so we
give that status text a success format
so here we have a little conditional
that's saying if the return message from
PHP is thanks for voting
that means everything went cool they're
there their choice was stored in the
database their IP and everything and
then we can load the new numbers in
because we're gonna have PHP
re-establish what the new numbers are
with their choice added to everything so
we just load the count text right back
up and that's how we get the real-time
updating to happen so they don't have to
refresh the page or anything to see
their choice added to the votes within
the system okay so that's the on
complete or the complete Handler or when
the data comes back from PHP after they
vote the response okay now let's talk
about the last little bit which is the
validate and send function that is tied
to this boat button here when they press
boat ok this is very simple we have an
event listener for the boat button we
have to be listening for the click event
and then we have a function called
validate and send that fires off when
that button is clicked and here's that
function validate and send you can see
inside of that function I have an if and
else condition statement set up inside
of this if conditions we have we're
saying if the choice text length is
empty that means if the choice text
field is empty we want to give them an
error message saying please choose
before you press boat and we sink that
into the status text field and make sure
we put the errors format on it so it's
red and in the else condition there
would be no error because the choice
text would have some value in it and
then we can process everything so we say
processing MC is visible visibility
property is set to true that way they
can see it flashing and we ready the
variables for sending the first one is
going to be user choice and that's the
choice number the value of what they
chose well not the value of what they
chose but the choice number of what they
chose is going to be either 1 2 or 3 and
variables my request that variable is
going to be store choice that way PHP
file knows exactly what we want to do
upon this request
there's going to be 2 sections to the
PHP file just like this two sections to
the ActionScript code
then finally we load all of that using
the bar loader here to the PHP file
these two variables when it's done and
comes back
remember the oncomplete or the complete
handler fires off and refreshes
everything so that's it that's how all
of the action script works and that's I
put here the last thing to show you
really is this thing it's just a static
text field and it has a link on it you
see that and I am going to my poll
results you know let's just put it right
there
that'll go to your poll results page and
you can go HTTP and all that if you need
to but that's if and only if you have a
page where you may be sort of storing
all of the results from all previous
polls you've ever taken because I do
that at develop PHP and it seems like
it's just the thing that people visit
and check out all right now let's talk
about the PHP file and we've done and
these four files will be available for
you to snatch up okay here I am in
Dreamweaver cs4 and you can be in any
text editor you like but it's nice to
have highlighted syntax that has
different colors so I don't know what
you're using if you use a notepad
everything's black and white and that's
pretty boring using something else
you'll have code syntax highlighting and
you'll be like hey that's cool that
helps me helps me code and keep things
organized and I could see my errors are
easily stuff but anyhow we have section
1 in section 2 and I'm not going to
spend a whole lot of time on this
basically you connect to your database
right there
using your connection data from your
database then the first section is
saying if post my request is load
numbers because remember in ActionScript
we send my request variable will be the
load numbers or store choice this first
section here handles load numbers so we
initially load the numbers up we got to
gather them from the database and I know
some of you PHP uber geeks are gonna say
Adam there's more efficient way to do
that through an array
a multiple addition insert and a
multiple select well I don't care I'm
trying to set it up and structure it so
a beginner can really understand how
it's going on and this is way it's mad
fast man
you're not gonna improve this much more
come on shut up anyhow what we do is we
query from the database table called
voting poll we select ID we're choice
equals one so if there's 80 people in
there that chose selection number one
we're gonna get eighty IDs coming out of
here and we can access exactly how many
with MySQL num rows so the this will
have a value of 80 for instance so we do
that for all three of our choices that
we're giving people and all you have to
store in the database for their choice
is a simple number that's why you can
just query these simple numbers and
you'll get the exact amount of how many
people voted for what so then we echo
back in choice text one choice text two
and choice text of a choice amount three
and those the first one you can see it
has no ampersand no and symbol but
everyone after the first one has to have
an and sign there if not it's gonna be
seen as the end of this value and you
don't want that you want each one to be
broken into URL encoded variables key
value pairs
now the second section of code runs when
we have flash has a my request of store
choice so when they make a choice first
thing we want to do is obtain their IP
address and this is just a way to you
can kind of make sure that everybody
only votes once but have like that so IP
address will get recorded so that gets
put into a local variable called IP here
we create a local variable from the
posted variable that came from
ActionScript which is their user choice
local variable is called user choice
right there then we make an SQL query to
select ID from voting poll table
where the IP address equals this
person's IP address so if an ID comes
out of there if somebody has that IP
address already in the poll we can know
with this MySQL num rows this will be a
1 this row count variable will be a 1 so
we say if row count is equal to 1 you're
already in the database sucker you have
already voted in this poll we give them
that return message into flash and we
don't load any new numbers else if this
is a 0 which it should be most of time
we run this little bit of code and this
what we do is insert into the voting
poll table the choice and the IP address
and here are the values those variables
choice and IP so those fields in the
MySQL database table called choice an IP
address remember we sync these values in
to them and then we do what we did up
top by selecting all those values for
all 3 and this away you can just add one
to the number that they chose I'm
showing you how to structure it out more
for beginners to see how it's set up
doing it with math is a little more
complicated and it would take me a lot
more time to explain so I'm doing it
this way
excuse me this flies to super fast so my
message is equal to thanks for voting so
then flash knows to give us a green
success message and all that good stuff
and then we echo back that return
message thanks for voting and the
choices the values of how many or one
two and three and it gets auto updated
in flash when they vote and that's how
everything works so that is that coming
next is one that I've been promising
asgard at the site he who's in fireworks
in Dreamweaver for creating a site
creatively and maintaining it and
Dreamweaver and expanding it making more
pages and stuff using that fireworks
layout so if you want to see something
like that check out our next tutorial
bye bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>