<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to Build a Community Web Site Part 11 - Profile Edit Page | Coder Coacher - Coaching Coders</title><meta content="How to Build a Community Web Site Part 11 - Profile Edit Page - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Khoury/">Adam Khoury</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to Build a Community Web Site Part 11 - Profile Edit Page</b></h2><h5 class="post__date">2009-04-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/9end7knQHHc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to part 11 of building a dynamic
web community using PHP MySQL and flash
brought to you by develop PHP calm and
before we get back into the edit profile
page and parsing these little forms here
for them to for the members to change
their profile data I'm going to create a
new page well in the register page I I
remove the phone number field because I
don't want to gather the users the
members phone numbers somebody asked me
at YouTube why was I gathering phone
numbers and it occurred to me I have no
idea there was no rhyme or reason for
that I was just throwing random things
in here there's no set purpose this is
just like a demo site but it's going to
have pretty good search engine indexing
and all those good things like any other
website where you can join as a member
to help spider and promote your web
entity so I grabbed the phone number
field and I went into the code of the
register form and the register script
and I removed all the things that dealt
with the phone number field and adding
it to the database and filtering it and
all that stuff it's all gone so now what
I want to do is go into the database and
change the phone field because when we
created our site fuse it open let's go
to scripts when we created our table
remember we had we placed a phone field
so now there's a phone field sitting in
a database with it's not going to be
used so what I want to do is change the
name of that field in the database to
style sheet that way i'm going to show
you guys how to let your members just
pick a style whole ready-made profile
pimped out thing they can stick with the
default or you can give them these cool
styles to pick from and that's what i'm
going to show you so we're going to
change this to style so to do that we're
going to make a new script so let's just
close that script and save file new
PHP script remove all that actually
let's replace it with our little script
and then I'll explain the little script
so I'll automatically pop it in and here
it is and let's file save this as in the
scripts folder alter table alter
underscore table dot PHP actually it
will give us the extension automatically
so it's because alter table and press
save so now we have our table that PHP
script in our scripts folder and we're
going to send it up to FTP and what
we're going to do is change actually I
have to swap these two well let me show
you inside of PHP my admin you can also
change it right from here in PHP myadmin
and you can log into PHP myadmin from
your your host server cpanel or whatever
kind of admin panel they use that your
main host servers log in when you log in
at your host server there's an interface
called PHP myadmin where you can
manipulate your database directly
through a nice easy to use interface you
can just change phone right here press
edit and change the word phone to style
sheet and it would be that easy and so
what I'm going to do is show you how to
do it through a little script if you
didn't have the ability to go into PHP
myadmin and we'll be able to see if this
changes from phone to style sheet so
let's say let's put phone in the front
here
change
let's just put stylesheet here change
this the phone so it's going to change
phone to style sheet and give it all
these these attributes and so then it's
going to run the query and if the query
runs successfully there's no hang-ups
then we get print success in table field
manipulation else it'll say script
failure so let's go ahead and put this
bad boy up via FTP alter table and I
already tried a little experiment just
to make sure it would work and sure it
does so now our script is in there so we
can go to a detective tent type it's up
on the web now like we can navigate
straight to it just by going to our
website wherever your website is then
you go to your scripts folder scripts
navigate to alter table
and it says success in table field
manipulation so that means good things
so now let's refresh our database and
look at and make sure it really did that
so let's just my members see after zip
it said phone now it says stylesheet
that's what we wanted now I'm going to
let the members pick the style sheet and
so that was that we can close that out
everything is good now at the edit
profile page which we are currently
which is the point where we are at in
our tutorial series we're going to now
show you the parsing mechanisms for all
of these little things and I'll explain
them all these little tables that you
see here they each have a form inside of
them for all the things you want let the
user manipulate and you'll see this
source file when you download the if you
want to download the source file package
and you'll see that each one is nested
inside of a table each form is nested
inside of a table and it has its own
submit button so when they the reason
why I did that it's for efficiency I
believe I think if you have one submit
button down on the bottom to refresh
everything you're going to be running a
larger SQL query on your database to
update things then wouldn't would be
needed all you have to do is run what
they want to change no reason to change
all of this nonsense and unless state
actually put a change into one of these
fields and press submit on that section
so it will just run a little leaner to
do it that way and this account settings
link is not even active yet which I just
put a pound sign in there to make it
blue with an underline and like an
active link so now I'm going to show you
how I'm going to put in the code to
parse all of those little forms when
they press submit and here's our default
code that adds all of that data tutors
to those fields in the forms there and
this one's going to stay in
just going to add a little space here
and here's where i'm going to code all
these queries in and i'll show you and
explain and then you download the source
files and and look further or maybe look
while i'll explain it whatever you want
to do okay okay so i've created the
mechanism the parts mechanism for the
member picture when they attempt to
upload or replace their profile picture
and it looks like it's line 23 251 so
i'll explain those lines in just a
moment first i want to show you what it
does say let's edit profile okay so
right now i have you see my default
member picture because i don't have a
picture yet so i uploaded the new edit
profile page with the new parsing
mechanism and i'll show you on that the
parsing mechanisms for the name location
website this should say YouTube are not
even coded yet I just kind of put the
little condition nest there or the
function nest for the that if statement
and what happens inside of that when
they they parse is going to be database
updates but when they upload their
picture there's no database updates
needed for our simple system here so I'm
going to show you how this works now and
then I'll explain the code for that
image upload script or parsing mechanism
so we go to browse as a logged-in user
and we go to thumbnails when we find a
picture that's less than 50 kilobytes
because we have a 50 kilobyte max set
and we're not doing any image resizing
in this application later on down the
road in some separate tutorial I can
show you guys how to do image resizing
it's really easy and you can also rename
them and reconfigure the file to be a
dot jpg if they happen to upload a dot
gifts or dot PNG but your say your flash
gallery would only allow the JPEGs to
run it you know so you might want to
convert them I show you how to do all
that in later tutorials but for this
system we got to get going along here so
I'm just going to show you how to get it
upload so I press submit you see how it
shows this green text here your image
has been updated it may take a few
minutes for the changes to show please
be patient plate please be patient no
need because the image already shows the
change and if i go to view my profile
booyaka so that's how that works and
we're just setting the profile image
dimensions in the page oops in the page
that shows the the profile data and this
one is set to 100 and it shows on the
profile as 250 so if you were to happen
to not browse for an image and press
submit like I just did you see red text
here ever text it says please browse for
an image before you press submit or if
they try to load one that's way too
large we don't know if I have a really
large one no let's see images here we go
I don't have any large images
here that one's huge 181 kilobytes there
we go now i'll press submit it's going
to tell me your image was too large
please try again alright so let's talk
about this so what renders out all of
these errors and success messages and
actually uploads the picture to my spot
in my folder where it belongs and then
renders it on page is right here lines
23 251 and online 23 we check to see if
the post bar equals pic and what I did
to make coding easier for us is I added
an a an input to the form to pick one
form a hidden type input and the value
is pic so in each one of these little
forms down through your page you just
put a I'll show you for the next one I
haven't even put that in yet so I'm
going to load it here and it's going to
write before the submit button and this
one is going to be named so the parse
variable is named the hidden parts
variable is named in this form the
hidden parts variable is pick you see
what that does so that way in your form
you can just process that piece of data
and not the whole page or whatever you
know what I mean so when they if so we
say if the parse bar equals pick then we
run another conditional these are ever
conditionals here to say this one says
if they're the file the field is
basically if the image is not there when
they press submit then we say please
browse for an image before you press
submit and we lay out this ever message
and this is very important right here we
claim I even wrote you guys some nice
comments out through here it says now
let's create some devolve are so our
script does not return Evers when we try
to print them to page they cannot be
missing so error message is right here
it's claimed as with the value of
nothing success is claimed here with the
value of nothing so at least we claim
their variables
because on the page on the HTML section
if you go to the design you'll see that
we are printing right there success
message and error message so if you go
to the page you press edit profile there
is no error message and no success
message there because there's no need to
show it it's only in that conditional if
they try to upload a picture that's how
that works so if they try to upload a
picture they're definitely going to get
an error message or a success message
either one is definitely coming their
way and that's when we print it out the
page so if the page is set to always by
default print that ever message and
success message if those variables
weren't set up here by default the
script could return errors to the
browser and you don't want that so
that's why I said those okay so inside
of the mechanism to change the picture
first the error message we print out is
please browse for an image before you
press submit if they happen to not
browse and then press submit then if
that condition doesn't meet and
everything's cool there then we claim
the max file size to be 550 1200 bytes
and that's equal to 50 kilobytes so you
can set your size your max file size for
any size you want to allow them to be
the max file size and then you check to
see if the file size meets the criteria
so if the the actual picture being
uploaded happens to be larger than the
max file size we give them this error
your image was too large please try
again you can see my font tags right
there where I make it red and then if
its success here success message I make
it green okay so the next error would be
to check the preg match so if the preg
match does not meet for gift jpg PNG for
this file trying to be uploaded here
we give them this error message your
image was not one of the accepted
formats please try again on length of
picture like we did up here on link just
removes it from the temporary upload bin
or wherever the temporary storage is for
uploading files then we just put out the
that's the end of the error messages so
if all of these error messages or the
error conditions do not get matched up
everything is cool so we are going to
now parse the picture or upload it and
move it to the place in on the server
where it belongs for this member in
their folder and we're going to rename
it whatever they named it let's see what
if they load of P&amp;amp;G I'm not sure if this
works but we're going to test it out if
it doesn't I'll fix it up but I'm going
to test to see if they upload a PNG or
that gift if I can just transform the
extension name to dot jpg if that will
work it might knock out the
functionality of animated gifts that
might be something that has to be fixed
but for now we're going to roll with it
let's see so what we do is we claim the
name for the new name of the pic and we
run the this place file variable which
at this point right when the script hits
this it's going to run this function
move uploaded file and here's our file
name for the file that the user is
uploading and it's temp direct and then
we take the folder we have to access the
directory path members folder ID is
going to be that members ID they each
member has their own folder and then we
just sink in the new pic
right there and then put up a success
message yet we print success message so
no error message would come to the user
only a success message because these
conditionals won't be met and pretty
much that's it then we close this else
right here this last else then we close
the else that checks if the file exists
that would be this guy right here he
gets closed right here and then then we
close the main one up top actually yeah
this one right here and that's the whole
shebang so what I'm going to do is add
the rest of these mechanisms and the
rest of these are going to be database
you can notice here we didn't do any
database queries or updating but here
all the rest of these are going to be
database oriented and it very simple and
you'll see it's just simple updates and
I'll explain those
okay I've got the rest of the parsing
mechanisms script it out and it was
pretty simple and let's go to the web
let's look at this thing I already ftp
the page up and I'm on my edit profile
page and let's change North Carolina I
already tried it out it works good too
let's just say New York and then if i
press submit it says your location data
has been updated we get a nice green
text 6x success message then we go to
view profile and voila I am now from New
York edit profile make this you put it
back to North Carolina because that's
where I live submit
location that updated view profile okay
so we know everything's working right
now let's go to edit profile again and
I'm just going to mention that I removed
allowing people to change their name if
they don't put their correct name into
the form with a register to the site and
register form and these these files will
be updated in the zip package when I put
it up later actually before you can even
view this video the source package will
have been updated so you can go right to
it and get it now okay so i removed
middle name gathering middle name from
the register form because i realized i
don't even want it i don't know why i
was gathering that so it's not in use in
the database anymore and on the edit
profile page they cannot change their
first and last name if somebody gets
married and they change their last name
and they want to change it in our system
they can delete their account because
i'm going to show you guys how to allow
people to delete their accounts and
start over if they need to but a lot of
people wouldn't even ever need to change
their name especially men and that's
probably what's going to be mostly
joining this site it's going to be a big
sausage fest here because the males are
mostly developers and geeks and stuff
like that okay so most males won't need
to change the name i'm not even going to
put it and i removed it from all the
parsing mechanisms and let's talk about
this location parsing mechanism now and
this is the mechanism that runs when
they use this submit button in this form
it'll update all those four fields and i
show you how to do that here so first
thing we're going to do is check if it's
the location parse bar and if that's
good then we run it and we bring the old
location variables posted variables into
PHP locals and then we run error
handling from any missing data we want
to make sure
watch if i take this state field and
make it blank and i press submit i get
an error says error read text please do
not make the field or fields blank in
that section so they know and you put
North Carolina back in for them see
there now if they press submit all the
four fields are there and says your
location that is you know that would be
normal functionality okay so that's why
we check to see if any of the missing
data or any of the data is missing then
we give them that error message right
here see it please do not make the
fields blank in that section it's very
simple else if all the data is there and
everything's good then we take the state
city and zip because those are the three
fields where they can actually type
something in and try and hack your
database so you go to replace well first
thing I do is I run a replace for any
apostrophes if they happen to put you
know if they're from st. croix or I
don't know maybe some locations have an
apostrophe in them you want to preserve
that so we put in the hex value for that
symbol and just make an apostrophe
become the hex value and it displays as
an apostrophe on the page and same for
the little squiggly little mark above
the squiggly key until the key and
because that's used in dated database
queries sometimes as well so you remove
those and you make them apostrophes then
we run mysql real escape string to clean
and filter the data before we make any
queries with it or update our database
and same for cities city &amp;amp; zip replace
apostrophes
run the filter placed apostrophes run
the filter then everything can go into
the database nice and safe so we say
this query is saying update my members
set country set state and set city with
those values that the user is placed in
and the zip is here also and you can
just use a comma to separate all the
values there you can update as many of
the fields for that member that you'd
like in one query like this where ID
equals this user ID that's what that
that's how that query works so we say
here right after the query is processed
in the script if SQL update is all good
font colors green your location data has
been updated else font color red error
message that's very simple then we just
closed off our else conditions up top
there close it off here and that's it
for that now get to this section if they
post the VAR of website that means if
they hit this submit button to change
your website address the URL then we
just bring the post it into local we run
the replace like we did in the register
script so we don't if they happen to put
the HTTP colon slash slash then we
remove it because we added for them when
we we're going to render it on their
profile and we want to make sure that's
not in there when they when they set it
so then we run the replace for any
apostrophes that might be in it which
should never at be any apostrophes in a
URL but just in case somebody's doing
something screwy we're going to replace
those with the hex digits and run mysql
escape real escape string to filter then
we run the update which says MySQL query
update my members table set website
equals this new website
value that the users trying to update
and so we replace that value or we
replace that that field and column with
this value here and then where ID equals
this members ID and we run the same kind
of if and else condition to give them
the success or error message it's very
simple and now the next or i guess i
should mention that none of these will
run and i put in nice comments here that
tells you that none of these are going
to run unless they hit that particular
submit button i hope that makes sense to
you because it's very simple the way
this all works but this is probably one
of the more complicated scripts that
we're going to have in the whole system
and it's really not that complicated you
can you can get your head around it
pretty easily if you dig in especially
if you have a little bit of knowledge on
PHP already so or any kind of
programming for that matter so now for
the next one we say if the post war is
YouTube we run our regular things and
replaces and filtering then we do the
MySQL update it's going to update the
mind member set YouTube to the YouTube
value that they enter where ID equals
this users ID and then we run the
success or error message handling here
next one is for the bio body the About
section so if the post VAR r equals x 0
body we put it into local then we will
we put the post variable into a local
variable here and we do that so we can
more easily you know you don't have to
use this you can just use this anywhere
in the script below making local
variables out of posted variables or
things like that just helps you minimize
your your scripts when you're trying to
access that variable and do conditions
on it and things like that or run
functions on it
it just helps to have them in local
variables but it's the same value that
value is going to be placed into this
variable so then we run the replace and
for the apostrophe thing filter it and
then here I run nl2br and HTML special
chars I run two functions there that are
native and PHP that you can research
from PHP net I'm not going to explain
all the things that these do because
it's already documented very nicely on
the pages at PHP net all you have to do
is sink this into the search field for
the function list up top and it'll show
you everything you want to know you
don't have to ask me a darn thing ok so
SQL update my member set bio body with
this new bio body where or the bio body
value that the user is placing in where
ID equals ID and then we run the success
or ever and that is it and here I like
making a nice visual separations in my
code you can see that here each section
where they're going to update has a nice
bar here separating a nice three line
bar and then down here where we're
finished doing the parsing I put a
little for section dash bar and
we talked about all the parsing has
ended by this point in the script so
query the most current data for the
member this will show the refresh data
to the user so they do not see old data
after making changes it's really simple
the way the script works but it might
seem really big and it might look
complex the first few times you look at
it but don't let that get the get you
down this is so simple the way this
thing works it runs exactly the way we
program it to so then the final default
query is here we get all the information
on a database that's current and we
display it to the page that's how it
works so we will I guess this would be
part 11 so in part 12 we're going to
delve into back into the profile display
page because right now it looks like
crapola so if we go to view profile this
is not the way I want this to look so
I'm going to do a little bit of tweaking
and i'll talk to you about what we're
doing there and show you how to embed
the YouTube channel a couple of other
cool things okay we'll see you in part
12 I just want to mention to you guys in
this part of the series I did a couple
of changes to the CSS file and I added
one little thing see how it says form
fields here it's a class definition for
form fields I just named it form fields
you can name it whatever you want really
and i'm using a certain text color and a
background color to make my forms look
the way i want see when you go to the
Edit paging all the form fields are but
like a light blue and the register page
as well and all I had to do to achieve
that was set this in the CSS file which
is going to be in the new uploaded
package the updated package today
and if you go to the register form click
on that you can see it has a class down
here set on it a form field it's very
easy to do you go to the codes you see
it right there class form fields and
that's set in the CSS file and that's
why you see all my fields in blue I just
thought I'd mentioned that to you so you
weren't confused about why you see blue
fields in mine and not yours you got to
get the new package it's got the new
updated CSS file okay see you in part 12</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>