<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>15. Ajax PHP MySQL Tutorial Conversation System For Social Network Websites | Coder Coacher - Coaching Coders</title><meta content="15. Ajax PHP MySQL Tutorial Conversation System For Social Network Websites - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Khoury/">Adam Khoury</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>15. Ajax PHP MySQL Tutorial Conversation System For Social Network Websites</b></h2><h5 class="post__date">2013-02-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/rPAqWQGFRiw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello this is the exact list that I
showed you guys in video number one of
this series and guess what everything
except one item is crossed off that
means this is the final video lesson
from me on this particular series I'm
not a list deviator I wrote the list in
video number 1 I plan to stick to the
list all through the video series I'm
not a list deviator you guys are all
lists deviator x' i've been noticing
your comments and you're all this TV
aters so in this lesson we will
demonstrate how to create an AJAX and
PHP driven conversation system that you
can install into your user profile pages
you can say it is the blab system
extended I also just tested the html5
markup for user PHP file and it passes
html5 validation nicely and this
conversation application is something
that must be redesigned by you and the
programming of it must be enhanced by
you if you wish to have a polished
complete conversation or timeline or
wall system or whatever you have in your
noodle now even though the system I'm
about to show you uses Ajax for all of
its data transmissions this system
you're getting from me is very basic and
made for educational purposes only so
keep that in mind now just because this
is my last web intersex social site
building video does not mean this lesson
series is stopping with me and at the
end of this video I'm going to recommend
the channel to you that you can
subscribe to if you want to see
enhancements or additions to this sort
of website programming logic he is a
helpful english-speaking person much
like myself gifted with code logic and
design skills to bang out nice working
applications that he can explain the
inner workings up to people on video so
that's why I'm going to recommend that
you subscribe to his channel he also has
existing video tutorials you may be
interested in and I already asked him
about it and he said that he'd be able
to extend this lesson series now to what
extent or directions he'll go with it I
do not know and that's up to him to
ponder so at the end of this video I'll
introduce you to him and I would imagine
that half of you already know who he is
so it's just because this is my last
video of this particular series doesn't
mean this
Ares is actually ending with me and
since I already put in tutorial form all
of the aspects that I promised you I
would in video 1 of this series my hands
are clean and I feel good about my part
coming to a stop here
okay so let's bang out this last little
bit of logic which is the conversation
system and first I'll show you how it
works live on the website
now since my little envelope is all
blinky blinky that means I have new
notifications and in the code examples
that I'm going to offer you in this
tutorial you're going to see an example
of how when somebody posts on your wall
or your profile timeline whatever you
want to call this stupid thing when
somebody posts it starts a conversation
with you or whatever you get a
notification and if I was to post on my
own wall say I am doing great today
and then if I post that right then all
132 friends of mine they just got a
notification and they'll be all blinky
blinky and on their notifications page
when they click it you'll see a little
notification that somebody posted
so my last notification was Bobby boy
posted on Adams profile if I click that
it takes me directly to that particular
conversation so if I was to go back to
notifications and click one of these
other ones it takes me to a different
part of my profile where that
conversation resides right here see so
on the notifications page when you click
those links they'll actually take you to
that profile and that conversation that
particular conversation on the profile
now here I am at Don's page and I can
since I'm a friend of his I can comment
on his post and say thanks Don nice
comment buddy reply and Ajax just pops
it right in it's already in the database
and everything and it says replied by
you
just now and then I have a remove option
if I want to remove that so if I reload
the page you'll see it says reply by
Adam and the time now if you guys want
to put the ago time like if you want 10
seconds ago or two hours ago if you
wanted to save 3 weeks ago if it
happened a long time ago or whatever I
have a script of that already it's
called the time ago programming OOP
tutorial
that's a develop PHP so at the develop
PHP if you go into the PHP and MySQL
video section into the miscellaneous
the first video in the miscellaneous PHP
and MySQL video tutorials is PHP convert
MySQL timestamp to a go format OOP
tutorial so click on that watch this
tutorial grab the code and you'll have a
way to convert all of these times to a
go time so that's why I just left it
like this because I already have the
tutorial in the code for that waiting
for you here and you can apply it to
your system alright so you basically you
just have an ajax driven conversation
system that is tied to this notification
system okay
now let's discuss the code
okay the three files that you're going
to get within this tutorial are the
updated user dot PHP and in users out
PHP you'll see that I only added just a
few lines to that and template status
PHP and status system dot PHP template
status dot PHP is a file that you can
include into your user dot PHP that kind
of modulates the whole conversation
system if you prefer to work that way it
externalizes most of the conversation
system and I'll be explaining that file
to you in a second and also this CSS
could also be externalized in to an
external CSS file just like your style
sheet you can make a new style sheet
gold status CSS and just put these view
lines of CSS within that it doesn't have
to be direct here in your user KHP
script but I just have it sitting direct
in user dot PHP this is where you can
tweak the CSS for the conversation
system so all I added to user dot PHP
was these lines of CSS and then down in
the HTML I added this one line include
once template status type PHP so since
that's all of the code that I added you
can wrap your head around that easy so I
won't explain any more about users PHP
since I added just those few lines of
code now let's talk about template
status PHP now template status dot PHP
is a file that has some PHP in the top
of it then further down it has some
JavaScript logic and then it outputs
some HTML so basically all the HTML
output that would come here is going to
be embedded directly into your user dot
PHP right where this line is
okay so you'll have a div with an ID of
status UI which is short for status user
interface and if you look on the site or
on your example site wherever you're
building you'll see that this this box
this text area and this post button are
the user interface the status user
interface everything under that all the
conversations that are listed out here
they reside within this static
area div so up in the PHP the first
thing we're doing is setting the
variables to output the status user
interface and the status list and we
make them empty at first because if the
user is not logged in or if they're not
a friend of that person they won't see
the text area and the post button to
make a post on that person's profile so
the logic here is if his owner is equal
to YES on the user dot PHP page that
means it's the profile owner so he will
see this text area and this button
that's the HTML that you feed that guy
whoever's the logged in user and you can
see this button is running a function
called post to status and it pretty much
just takes whatever he writes in the
text area and uses Ajax to post it to
the PHP and MySQL side of your system
then the next bit of logic is else if
it's not the owner of the page you want
to evaluate if the person is friend
equals true then you give them this
little bit of status and actually this
status area title does not belong so you
just have this text area and this button
which is very similar to the one you
give the profile owner but instead of
being post type a it's post type C in
the database because remember when we
created the status table we have post
type a B and C a is for if a profile
owner is making a post on his own
profile C is for if a friend of that
profile owner is making a new post on
his friend's profile and B is for all of
the replies all of the replies on any of
the status posts are marked as Type B so
you have a B and C type so you're just
giving people different types of HTML
and different variables in your
JavaScript function can be laid in here
according to whatever logic you want to
layout wherever the user is that happens
to be viewing the page if they have
special privileges if they are a friend
all of that logic can be listed out here
so no matter what those variables come
out to be whether the viewer is the
profile owner or if it's a friend or if
it's somebody that's not even logged
in you're going to select all of the
status posts for the profile that the
person is viewing so you say select all
from the status table where the account
name equals the user's profile that the
person is viewing and type equals a or
the account name equals you and type
equals C so whether it's Type A or type
C we're going to dig it out with this
mysqli query you can see I limit mine by
20 if you want to have a very very long
list of conversations that people can
leave on their profiles then you can
make that limit whatever you want or
just take the limit off completely now
another interesting tutorial along these
lines is in the JavaScript video section
at develop PHP where I have a here it is
see it says JavaScript scroll tutorial
low dynamic content into page when user
reaches bottom so basically this
tutorial right here will show you how to
when user reaches the bottom of the page
boom right there you can load more
content into any containers basically
you can use Ajax to load a whole bunch
of more page content into the page so
watch this tutorial if you like and I
notice that Google+ and Google+ and
Facebook and Twitter and all of them use
that sort of functionality now they'll
only load a certain amount of
conversations or a time line into the
page but when you scroll to the bottom
more magically just loads in and this
tutorial can show you how to do that
exact thing so that's why I have mine
just limited to 20 and you can handle it
any way you like you can take the limit
off or you can limit it to 20 and like I
said when the page when the user Scrolls
to the bottom you can load more things
into dynamic containers on the page so
basically we're selecting the whole
status list here and within the wild
loop for gathering all of the data for
those particular status posts is where
you're also going to gather up any
status replies so these are only type a
and C that you're querying out but you
also have to query all the B types of
replies within this Y
for those respective posts because
remember type a and type C are the
initial start of the conversation the
initial post type B are the replies now
you also want to have some logic here
that says if the author equals log
username person logged in or if the
account name is equal to the log
username so basically if a person
viewing a conversation is the one that
wrote that post they'll be able to
delete it you want to give them a delete
button to delete the whole entire
conversation or if it's the owner of the
profile maybe he didn't start that
conversation but he owns the profile you
want to give him the ability to also
delete the whole conversation that's
with this little bit of logic take care
of and it creates a little status delete
button here that runs a JavaScript
function called delete status then like
I said within this while loop you want
to gather up any status replies so you
start a status replies variable here
that will get appended to over and over
again with all of the replies that
happen to be found within the database
for that particular conversation so we
can query all of the replies for a
particular conversation by saying select
all from the status table where original
status ID equals this status ID that's
coming through the loop and type equals
B order by post date ascending and you
say if the reply num rows is greater
than zero then we're going to run an
inner while loop to get all of the
replies into this status replies
variable you can see we're appending
using dot equals and we're just putting
a bunch of divs in place that are the
HTML for all of the replies for whatever
conversation that is and within that
while loop you also want to have the
logic to give the person who wrote that
reply the delete button for that reply
and also the account owner
whoever's profile that the reply is on
whoever owns the profile they you always
want to give them the delete buttons for
everything then you can see right here
status replies variable is getting all
the replies compounded into it and you
notice that I'm when I'm making
these divs they all have unique IDs so
this one has an ID of reply underscore
and it'll be some number after the
underscore whatever these status reply
ideas will be attached to that ID so
this way when Ajax or JavaScript needs
to zap that div off of the page
JavaScript can easily target it by its
ID and they have a class just to style
them the way you want them to look
that's what the class is for these are
all the reply boxes get the class of
reply boxes but they all have unique IDs
so outside of this little while loop in
this if condition you're going to
compound the main status list so what
this does is it puts all of the
conversations and all of their replies
into HTML format and then under each
conversation towards the bottom of the
person who is viewing this profile
happens to be the friend of that person
or if the logged in user is viewing
their own profile then you want to have
the text area that is for replying this
text area is for replying to the
conversations and you have a little
button that says reply and that runs a
function called reply to status so
basically you're just cleverly query
all of the conversations all the posts
for that particular profile and within
that queries while loop gathering up all
of the replies also because those have
to be listed within the conversation now
we can discuss the JavaScript that
powers everything and the JavaScript is
connected to this status system dot PHP
file so status system dot PHP needs to
live within your parsers folder so don't
forget to put status system dot PHP
within your parsers folder now template
status type PHP is what's connected to
that using Ajax so you have functions
post to status reply to status delete
status delete reply and status max now
I'll explain this status match just
really quickly because it's very simple
basically what this does is it make sure
that nobody can put more than
250 characters here when they're typing
or here and if you don't want that in
place you can simply remove the status
max you can see right here status max on
key up event for this text areas so on
key up event we have status max function
running all you have to do is remove
this whole event if you didn't want that
in place just put it just like that and
there won't be any limit to the amount
that people can write in but you'd also
have to change your field in your
database to hold more than 255 varchar'
I think it's set to borrow are 255 right
now or maybe it's set to text you want
to set yours to text if you want to hold
a lot more and I just really put that in
for educational purposes that way and
some of you guys might want to limit the
amount that people can type into these
text areas
now this next JavaScript function is
called delete reply and you're feeding
you have to feed two arguments or past
two parameters to it the reply ID and
the reply box remember when I was
telling you that all of these divs for
the replies have a unique ID that's
basically what you're passing to this
function the reply ID and the identifier
for the reply box the div that holds
that reply so inside of delete reply
first thing you do is you can set up a
confirm and also you can delete this if
you don't want to confirm if you don't
want to confirm box just delete these
four lines of code here and the deletion
will happen immediately so you can see
it's just the same kind of Ajax requests
that we've been using the whole time so
you posting to status system dot PHP
which is inside of your PHP parsers
folder and what your posting is two
variables I think yep action delete
reply so you're posting action and reply
ID to status system dot PHP and I'll
show you it's a action is delete reply
so inside of status system let's go to
that we have if post action is delete
reply down here at the bottom I'll
discuss that with you right now
we do is we check to see if the posted
variable is set for reply ID and make
sure a reply ID is not empty so if it's
not set or if it's empty we're going to
exit this script immediately then we
gather up the posted reply ID and we
cleanse it through the place function
making sure that it's nothing but
numbers can be in that sequence of
characters and that is in a variable
then called reply ID nice and clean so
we can query that data against the
database and what this query is aimed to
do is to check to make sure that the
person deleting this reply is either the
account owner or the person who wrote
the reply so within a while loop we can
gather out the account name and the
author for that reply in the database
then we can evaluate to see if author
equals log user name or if the account
name equals log user name then we can
successfully delete that reply for those
people because it's either the person
that wrote the reply or it's a person
who owns the profile that that reply is
living on those are the only people that
should be able to delete that reply and
that's a simple query that says delete
from status where ID equals this reply
ID and you can actually put a limit one
on that then after it's deleted from
database you go back to the Ajax delete
okay now when delete okay gets back to
the Ajax request what we're doing is
we're saying if response text equals
delete okay then that reply box
style.display equals none basically
remove it from the page else if the Ajax
response text does not equal okay
you're just going to alert the Ajax
response text to the user that way they
can see whatever kind of problem it is
so you see that's not too hard it's
pretty simple let's collapse that one
back up so I've explained status Max and
you know delete reply now delete status
is very similar but basically this one
helps the person to delete the whole
conversation and this works in a similar
way you're passing the status I
II to this delete status function and
you're passing the status box basically
the div that holds that post and all of
its replies is going to be a div that
holds that post and all of its replies
for each conversation listed and that's
what the status box is it holds
basically each conversation that way
when that conversation the whole that
whole little thread is being deleted by
a user that has privileges to delete it
you want to make sure that you can wipe
it off from the page and that's why we
passing this parameter to it of status
box and that represents the div that
holds the whole conversation and all of
its replies so we do a similar thing
where you have a confirm box and like I
said you don't need that and then after
the confirm you just have an AJAX
request once again to status system dot
PHP this time you're posting the action
of delete status instead of delete reply
the action is delete status and we're
passing the status ID variable so let's
go into status system the PHP script
that's parsing this Ajax and this one
was delete reply so we don't need to
look at that anymore since we explained
it all already here we have delete
status so if it said post action and
post action is equal to delete status we
run this code and it's basically the
same thing it's the same exact kind of
logic and PHP as you saw down here okay
it's the same exact logic the only
difference in this little bit of PHP is
right here you're going to delete from
status where OS ID equals the status ID
now what that delete logic helps you do
is to delete all of the items from the
database that are associated with that
particular conversation so not only the
original status post will be deleted but
all of the replies that are connected to
that original status post basically the
whole conversation will be deleted in
this one line that's the only difference
between this and the PHP that I just
explained the second ago for deleting
the replies okay so I'm
not going to explain that very in-depth
that's the only difference between that
code and the code down here okay we only
have two more JavaScript functions to
explain function reply to status and
function post to status now reply to
status is the function that fires off
when somebody is replying making a new
comment into an existing conversation so
you want to make sure that you pass to
this function the conversation ID or I
call it the status ID the username
whoever's profile the conversation
happens to be on the text area that the
user is typing into to make the reply
and the button that is associated to
that reply box so those are the four
arguments that get passed through to
reply to status function now let's open
that up and explain it first thing we do
is create a variable that grabs the
value whatever they typed in to that
text area you have that in a variable
called data and you say if data equals
empty you alert type something first
weenus and then return false because you
don't want this code to run if the data
is empty so you say return false right
there and that stopped this function
from running any further then we're
going to target the reply button by its
unique HTML ID on the page so within
that HTML tag it's going to have a
unique reply button ID for this status
ID so you target that reply button and
you disable it now here is our Ajax
request that sends the reply to the
status system dot PHP script for parsing
so you creating your Ajax object and
here's your onreadystatechange function
and this Ajax request is sending the
variables of action and that has a value
of status reply so the action is status
reply the status ID is equal to whatever
dynamic status ID is being passed to
this function the user variable is the
whoever's profile is being viewed and
the data variable is the value of the
text
area where they're typing in so status
system dot PHP is going to be ready to
intake those four variables for the
action of status reply so let's go look
at that here we have status reply so if
is set post action and if the post
action variable is equal to status reply
we're going to run all of this code here
first thing we're going to do is make
sure the data is not empty that's what
this little bit of code takes care of
then we're going to clean the posted
variables coming in so these are all of
the posted variables we have the status
ID we have the user and then we have the
data now what I'm doing is I'm running
the data through HTML entities and HTML
entities is a PHP function that will
take things like this look so for
instance if I type in script into the
text area that is the reply box if I
type in script and say I'm a hacker and
I want to put in window dot location
some evil place okay so basically if you
want to not allow people to put code in
like if they want to underline something
you don't let them use tags and allow
those tags to process basically what you
do is use HTML entities and what that
will do is it will take this code and
it'll make it something that looks like
this instead of that left bracket it'll
be and lt semicolon and then the right
bracket turns to and RT semicolon so
basically instead of these brackets for
the tags this is the string that will go
into your database and then here I'll
show you what I mean let me just go
right now and I'll show you I'll show
you the purpose why I'm using HTML
entities if I'm on my profile and let's
say I'm trying to hack this little
system by typing in a script tag and I
want to put in some malicious code that
will navigate any user when this page is
loaded back to my website or something
like that so I can put WWE Adam Cory
calm or what
all right so if as the programmer if
you're not so as a programmer if you are
not changing these characters to their
HTML entity equivalents then this script
will hack your system basically if I
post this all that happens is their hack
attempt or their code is displayed in
their post and it doesn't process at all
so if you didn't use HTML entities on
this text what would happen is people
would actually be redirected to Adam
Cory comm directly when they come to my
profile here at web intersect you don't
want that to happen and a lot of people
can put a lot of malicious JavaScript
into your website if you allow them to
you don't even want to allow them to use
HTML code here to format things or
anything like that
so changing these symbols to their HTML
entity equivalence helps your system
stay safe from JavaScript tags that's
why I'm running data through HTML
entities I'm also running data through
MySQL I real escape string what that
does is it will put an escape character
before any of the single quotes or
double quotes in MySQL I real escape
string further secures your data before
it goes into the database and you don't
have to worry about running account name
or os ID through MySQL I real escape
string because you know for sure that
after this post the data runs through
preg replace there won't be anything but
letters and numbers in here and there
won't be anything but numbers in here
actually this doesn't need an I because
this should only be numbers in the ID
the account name will have letters and
numbers that's why you see me not
running this data through MySQL I real
escape string function because there's
no way that any harmful characters can
be in it after it runs through this
prayer please ok after we clean the
posted variables and get the data ready
to go into the database we're going to
make sure the account name actually
exists so the profile that is being
posted on you want to make
show that profile that person actually
exists in your system so we're going to
say select count ID from the users table
where username equals account name and
activated it equals one basically this
little bit of code just evaluates
whether that account actually exists in
your system if it doesn't exist then
you're going to echo back to Ajax
account no exists and then exit the
script but if everything is cool then
you're going to insert the status reply
post into the database now and that's
very simple we just have the SQL syntax
of insert into the status table original
status ID field into the account name
field into the author field the type
field the data field and the post date
field all of those fields will get
populated with all of this data right
here and you run that query and then you
get the ID for that inserted data
basically the reply ID is right here and
you want to send that back to Ajax that
way the person can instantly delete it
if they would like to without page
refresh so right when it is posted
magically to the page using Ajax you
have to send that ID back that way you
can be associated in the delete function
that's the only reason we're using MySQL
I insert ID to get the ID for that
inserted reply all right so once it's
inserted then we're going to insert
notifications for everybody in the
conversation except the person typing
you don't have to give a notification to
the person doing the replying because
they're the ones doing the replying they
know it just happened what you want to
do is update everybody else in the
conversation by sending them a
notification so whoever's part of that
conversation is going to get a
notification inserted into the
notifications table for them letting
them know about what just happened and
you can write whatever you want into the
app variable I just wrote status reply
and then the note can be constructed any
way you like and it would be helpful in
your note on the notifications page if
you put a link to wherever this
conversation is happening and make sure
that you put
the little reference to the exact status
ID for that conversation so it snaps to
that point on the page okay so it's
important to put the reference for the
status ID on that link let me just show
you what I mean on the notifications
page you can see you click to view that
conversation you see and it will go to
that point on the page it won't start at
the top so if it started at the top the
person might not know what the hell
conversation that there we're trying to
be notified about you know what I mean
and then we finally send back to Ajax a
delimited string you can see I have this
string has two pieces of data in it
they're separated by that little bar
basically I'm just sending the reply ID
back on the right side of that bar on
the left side of that bar the string
reply okay and then I exit the script so
Ajax is waiting for that reply so what
we do in Ajax is we say if Ajax
returning was true we're going to gather
up the data array which is that
delimited string that I was just talking
about that had the bar in it on the
right side of the bar we had the ID for
the reply ID on the left side of the bar
remember we had okay so we can just say
if data the first part of the array is
reply okay then we can make a variable
out of the second part of the array a
variable called reply ID now the data
that you're going to display to the
person using Ajax when they write when
they make a reply is not actually from
PHP because you already have the access
to that data right here so you don't
have to bring that back from PHP when
javascript already has it available
within this function so we're going to
use some replacing functions on that so
basically what this line is doing is
JavaScript equivalent to the PHP HTML
entities function basically you're
taking this character and you're making
its HTML entity replacement that's all
you're doing there then all you do is
append more data in
to this status conversation and you put
the reply div directly into the bottom
then you can make the reply button for
that conversation enabled again this
line enables the reply button again this
line clears out the text field or the
text area that they were typing into
that way the same data is not in there
when they successfully reply you want to
clear that box out so they can maybe
make another comment or whatever so
that's how that whole word function
works and we only have one left which is
the post to status now this is the one
which is the main conversation creating
function so if I'm on my profile I'm
going to create a new post a new status
I feel funny post now what I did was
just made this function run post to
status and this function will also run
in this case I'll show you if I let's
say if I go to call rids and I want to
say hi Karl I'm making a new
conversation a new post on his profile I
can post it and there it is I just made
this post a status function run again so
this runs to create post types of a and
C the main posts the main conversation
starter types and the guts of this
function work exactly almost exactly the
way the guts of the reply to status
function work post the status takes in
the action variable the type variable
the type will be either a or C the user
variable meaning whoever's profile that
the viewer is on and the text area you
can get the data by saying text area
value that takes everything typed into
the text area and puts it in a variable
called data you can evaluate to see if
that is empty if it is you say alert
type something first weenus and then
return false so this code does not run
if there is data then you want all this
code to run first thing you're going to
do is say status button disabled equals
true you're going to disable the post
button
until the Ajax request and data returned
comes back and everything then you can
enable it again and we do that right
here alright so we have our Ajax request
set up once again and this Ajax is
posting to PHP parsers status system dot
PHP once again and the variables are
action which if you scroll up top you'll
see the action could only be status post
in either case C status post for either
a or C type that action variable is
going to represent status post type is
going to represent either a or C user is
the user's profile that we're on and
text area so action variable is
populated with the value of dynamic
action the type is going to be sent the
user and the data so let's go into
status system and let's find that if it
said post action and post action is
equal to status post if that is the case
then all of this code right here is
going to run now it's very similar to
the code that we had for the status
replies but in this one we're going to
insert notifications at the bottom here
to all friends of the post author
so basically when I went and created
this post saying hi to call all 132 of
my friends just got a notification
letting them know that I post something
on calls profile so that this one works
a little bit differently when in the
status replies we're only giving
notifications to the individuals that
are part of the conversation and not
everybody's friends but when people make
new posts either type A or C we can
notify all of their friends because
their friends might be interested in
what they're saying around the website
ok so first thing we do within this
logic is we make sure the post add is
not empty that code takes care of that
then we're going to make sure the type
of post is either a or C so if post type
is not equal to a and if post type is
not equal to C actually this should be
or I don't know why I have and
operated there that should be the or
operator not the and operator so if post
type is not equal to a or if post type
is not equal to C then we're going to
exit this script all together then we're
going to clean all of the posted
variables that will interact with the
database so once again we're running
preg replace over the post type variable
the post user variable and we're running
data through HTML entities again so that
cleanses your data gets it ready for
database storage then we're going to
make sure the account name exists then
we're going to insert the status post
into the database now so we insert into
the status table account name author
type data and post date fields all of
this information so all of these fields
within that database table will get all
of this specific information then we're
going to run that query to insert that
data and we're going to get the insert
ID once again that way we can send this
status or this conversation ID this
status ID back to Ajax and we're doing
that so when people want to instantly
delete something they just wrote a
second ago that the remove button is
ready to go for them now with this
update query does is it takes the row
that you just inserted and it makes its
os ID field equal to the inserted ID
then you want to count the posts of type
a for the person and evaluate the count
and basically what he's doing here is
this code is checking see if they have
10 or more posts of type a which my
system is programmed to limit how many
conversations they can have to limit
everybody in my example system to only
having 10 conversations that they
started on their own profile but pay
attention if you want to allow your
system to allow way more than that just
remove all of the code that I have blue
right now my code is set up to delete
their oldest automatically so they can
just keep making
conversations they don't have to delete
any my system is going to auto flush I
even wrote you a comment if they have 10
or more posts of type a delete their
oldest post if you want a system that
Auto flushes the oldest conversations
you can auto flush four posts type C and
B also if you wish all right so that's
what that code does and you can change
that to any numbers you like now we're
finally going to insert notifications to
all friends of the post author now to do
that I'm just going to run two queries
that are going to gather all of the
friends into an array then I'm going to
run a for loop over that array and for
each brackets a notification inserted
into the system that way they have a
blinky blinky envelope next time they
come to the site and they can see what
their friends were doing then after the
inserting takes place to notify all the
friends and we're going to echo back to
Ajax post okay on the left side of the
bar and on the right side of the bar
we're going to echo back the status ID
basically the conversation ID alright so
that's how all of that PHP works now
this insert notifications to all friends
is a very important piece of code that
you're going to use maybe many many
times on your website that you might
have you know when somebody changes
their profile photograph their avatar
you might want to put a notification to
all their friends hey your buddy just
change this profile picture go check it
out
that's a good time to use code like this
and that would go into your photo system
that PHP script so you see this code
could be used in many places where you
want to notify all of the friends of a
particular user of some action that
their buddy just made or some
interaction that they had on the website
okay so it collapse that back up and
that is that's pretty much everything in
all three of the files that's the whole
conversation system so you can see
within six hours we achieved a pretty
good level of logic and software
programming just within six measly hours
now you have all of these
in place and let me introduce you to the
person that I think would be best suited
to extend this series
mr. Shawn Lloyd and I'll put a link to
his YouTube channel down in the video
description that way you guys can just
check out the description text for this
video and click that link and go
straight to his channel and subscribe
just like this subscribe ping now I'll
see all of the videos that mr. Shawn
Lloyd puts out now I talked to him about
extending the web intersect tutorial
series and he said he'd be game for
doing that but I don't know to what
extent that he will enhance or extend
the series so that'll be totally up to
him and if you want to subscribe to his
channel you'll see any future videos
that he puts out and you can see the
videos that he puts out or all along the
lines of things that you guys want to
learn anyway so it's not even if he
doesn't put out any tutorials for the
web intersex series to extend it you'll
get good knowledge from this guy
now before I go I want to discuss how
instant chat or video chat is built
because a lot of you seem to want that
feature built into your website you
could script a very simple server
polling mechanism using Ajax with just a
short interval time to request to PHP to
see if new things were added to the data
storage and if new things are found
within the data storage then you display
those new things to the user so it's a
timed it's a short interval timed Ajax
request that checks the database
frequently to see if there's any updates
but using that method if your site gets
over a few hundred users your server
will be continuously stressed and go
down frequently so for a large scale
site that has many simultaneous users
web developers can apply socket servers
html5 JavaScript PHP Python Java and
many other web technologies are equipped
to create socket servers and handle
socket interaction for instance in the
modern web one could create an HTML
based socket connection software where
HTML and JavaScript are the client-side
and PHP and MySQL make up the socket
server or you can establish a Python
socket server that you can use
javascript and html5 to connect to and
alternately you can just go grab a
socket based server software that was
written by somebody else that's made for
multiplayer games and highly interactive
social applications smart Fox server is
one such framework among many that makes
life easier for you until you learn
socket programming from scratch using
the modern technologies that you like
best so you don't have to build your
socket server and your client scripts
from scratch you can get a pre-existing
framework or software that handles all
of that already now things you would
want to use socket connections for are
instant text chat software within your
social network video chat software
social multiplayer games or massively
multiplayer online games and anything
that's requires and anything that
requires instant open data flow which we
the server and the client which the
client is the browser software so that's
how people who are developing social
applications online that are involving a
lot of simultaneous users that need
instant data flow so that's how you can
set up things like instant chat video
chat or social multiplayer games without
bogging down your server if you happen
to have a whole lot of simultaneous
users on the system but a lot of people
like to use polling is something called
long polling - and you can dig into all
of that but I wouldn't recommend polling
if you're going to have any more than a
few hundred users you know if you have
maybe ten users polling is okay and hey
what do you know the entire series is
complete everything that I promised you
from the beginning has been covered I am
NOT a list deviate a lesson plan that we
promised from the beginning is what we
have delivered we hope you've enjoyed
this webinar SEC 2.0 social network
production training series</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>