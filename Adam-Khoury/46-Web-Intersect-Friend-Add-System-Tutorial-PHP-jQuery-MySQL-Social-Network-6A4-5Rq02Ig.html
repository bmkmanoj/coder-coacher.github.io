<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>4/6 - Web Intersect Friend Add System Tutorial PHP jQuery MySQL Social Network | Coder Coacher - Coaching Coders</title><meta content="4/6 - Web Intersect Friend Add System Tutorial PHP jQuery MySQL Social Network - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Khoury/">Adam Khoury</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>4/6 - Web Intersect Friend Add System Tutorial PHP jQuery MySQL Social Network</b></h2><h5 class="post__date">2010-09-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6A4-5Rq02Ig" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay here we are on the profiles and if
you're logged in looking at your own
profile you're going to see this button
called friend requests and I added in a
new container a new interaction
container for the friend request list so
when we press that you can see that
opens up and it toggles just like the
other ones and it shows that person's
picture it's clickable you can go to
their profile and their name sends you
to their profile as well and you have an
accept or deny link now those accept and
deny links are going to be Ajax as well
- when you click them this sentence here
or this line is going to process
information over the server without
refreshing the page and it's going to
bring back a result we are going to list
out the friends because once we accept
or deny people here we're going to need
to show on our profile who our friends
are okay to get that new box to appear I
simply created a new div here under the
private message div and the add friend
div and if you want keep these nice and
tidy
you can close those up by hitting that
little minus sign there when you want to
expand it you just hit that line again
right there hit the plus sign and there
it goes so I added a new interactions
container and you can see it has a
little bit of its own styling I what I
wanted to make sure it had a white
background a height of 240 pixels and
overflow:auto that way if there's more
than like two friend requests it shows a
scroller rather than making the page
really long it'll be in a little block
just like you saw it here you see that
little block it's in a scroller because
I have more than two okay so what I did
was inside of that I put a little
sentence says the following people
requesting you as friend you can see
that line right here the following
people requesting he was friend then I
did
my SQL query to get everybody in a nice
list here and the query is wrapped up
right here and I'll show you that you
can see the query and everything all
this PHP code is inside of this div
called friend requests so let's open
this up you can see it's about I don't
know 20 lines but in those 20 lines we
select all friends requests that's the
pending friend's request table that we
made in the last lesson I think it was
where a member to filled in that table
is equal to this profile owner's ID
order by ID ascending limit 50 so it's
only gonna give you 50 results and it's
ordering them ascending not descending
you can order them ascending descending
or random any way you want but I think
ascending is best here because I think
it'll give you the first ones that
requested you first on top and the query
is then we use the MySQL num rows
function on that query to get the
numbers into a variable here then we run
a little if condition right here to say
if the number owes is less than one we
echo out you have no friends request at
this time else we execute this code
which is all of this right here we run
the while loop with the MySQL fetch
array over the query to get all of the
row data out that we need that we
specified specifying here row we're
grabbing the ID on that table and mem 1
mem 1 would be the person who's
requesting your friendship now that's
put into a variable here called mem one
so you can then SQL once again so what
you're doing here is you're in a while
loop and you're creating another while
loop to get but it you're only gonna
have a limit of one on this so it's not
like you're gonna have crazy loops going
over and over and over and it's going to
use a lot of system resources it's not
it's pretty efficient the way it's set
up so you run another SQL using that mem
one variable the ID for member one
that's a person requesting your
friendship all the people actually
that's all the people requesting your
friendship as they come through this
while loop and we've run another query
that is selecting the first name and
last name from the my members table
because we have to access what the
person's name is it's requesting the
friendship each one in the loop so we
get each requesters last name and first
name here in a little while loop that's
set to a limit of 1 then we do a check
pick mechanism once again which if we
wind up using this check pick mechanism
a lot there's things we can do to put
that into a function or even a class
file
that'll make it to where we can reuse it
over many different files and many
different parts of the profile script if
we need to but for now in production
we're just going to leave it like this
and run the mechanism again we come out
with a variable called little pick so
here we echo out in the while loop each
member that's requesting us as friend
and it's in a little table I just
slapped it in a table that way I can
easily put the picture over to the side
it's in one cell and then in another
cell here there's these two sentences
and wrapped in those two sentences in
that little section in that cell in that
table cell we have a span ID of request
ID so what's going to happen is there's
an AR EQ and then the number for request
ID is going to be here and that's going
to be very important for when you want
to put the output line from the Ajax
process here it's going to overwrite
this line it'll take out those two links
and it'll put the result of accepting or
denying that's why that is wrapped in
that span so you can target that ID when
those things are pressed and there's
JavaScript that's going to go along with
this so there's a little more to it and
I'm going to explain every bit of it
don't you ready so here we echo out for
each member this set of data within this
table just like we've been doing all the
it's a little link that has on click
return false put onmousedown we run the
javascript function accept friend
requests on this one it's denied so we
deny friend requests all you need is a
JavaScript function called accept friend
requests and then one called deny friend
request and simply send the request ID
through it as an argument
so let's go ahead and make those
JavaScript functions now for accepting
and denying which they are going to
enable some more Ajax functionality to
have been real quick now we will return
to the file which is request as friend
PHP which is the friend request URL for
all three of these functions and we're
going to make sure we put a part two and
three in here now because remember we
have part one which was if the request
equals request friendship you can see
here request is accept the friend here
request is denied front so we can simply
go here and put new if conditions to say
if post request equals deny friend or if
post request equals accept friend we run
a whole different set of code and this
code here would not process because if
post requests equals request friend
would not be coming from any one of
these functions that's how it's going to
work so here in request as friend of PHP
we're going to put part two and three
now which are going to deal with
accepting a friend or denying a friend
and since we're going to use this same
script for three things we got to remove
a couple things like this if mem one
this error if member wonnie comes mem
two when they're trying to request
friendship we should put those inside
now let's see right there let's grab
those two we're gonna put those right
here instead because that is more where
they properly belong because that's the
only scenario that would affect these
because memoir and mem two aren't going
to be sent
and we can actually take these yeah
let's take these let's put them where
they belong to right above that because
that's the only time we would need those
variables is when the post request is
request friendship otherwise we're going
to be using a request ID for parts 2 &amp;amp; 3
of this script which will be handling
these two Ajax functions accept friend
and deny friend okay here's the part of
the request is for end up PHP script
that deals with handling accepting
friend requests first we get the friend
request ID variable into a local
variable the posted ID then we SQL query
from the friend request table where ID
equals this request ID that way we can
access number 1 and member to the ID
from number 1 and number 2 of this
friend request run a loop here to access
a value of M 1 and mem 2 that's in this
friend request database for this ID each
ID in the friend request database has a
value of M 1 and mem to fields to go
with it now here's where we start
getting into dealing with and creating
arrays first thing we're going to do is
SQL friend array member 1 and SQL friend
array member 2 are going to be local
variables created from the value of
querying where we select the friend
array from my members table and we added
that friend array field I think it was
tutorial number 3 of this series no
tutorial number 2 we added the friend
array field to the my members table then
we simply run a while loop on that query
to access the friend array
we put it in a local variable right here
so now we have access to those both
friend arrays for number one and number
two we take both of them and explode
them that means they're going to be an
array an official array and the PHP
compiler is going to be seen as an array
once it's exploded then we can say we
can use array functions once we explode
it we can use all the array functions
let me show you develop PHP 9 PHP where
is it working with arrays array function
reference lists right there all those
like you can see in my script I'm using
one called an array let's see if that's
y'all right I an array checks if a value
exists in an array so I'm using that
function there to see if each member is
ready in each other's list because we
don't want to be adding people who are
already in each other's lists by
accident here in this part of the script
so reaches echo out this member is
already your friend if each one happens
to be found in each other one's friend
array then after that all as well so put
both into each other's arrays now to
make them friends so we say if friend
array 1 it's not equal to nothing that
means it has friends in it already then
we're going to put the array and a comma
and then this new member and that's how
it works
else if the friend array is empty then
we're just gonna make their friend array
in the database equal to this member
because that it would be its only friend
you don't need all the other and then
the comma and then the new guy you just
need to put the new guy I hope that
makes sense because that's how it works
same thing but a member tool you do the
same thing to his array
if his array is not empty then you just
add this one with a comma this person to
the end of his array else his array is
empty he has no friends so you just add
the one member that means he only has a
one friend so pod the next time he goes
they have another friend this will run
for him because it won't be empty okay
now we s ql to update both stored arrays
so update array member 1 update array
member to execute here we update my
members set friend array so the field
called friend array in the my members
table from member one here and member
two we're gonna be updated with this new
friend array we compiled here by adding
together by adding these two people
together into their friends arrays and
we echo out you are now friends with
this member and we're gonna have that
shoot into this part of the page here
let's see where is it right here this
line is going to be replaced by whatever
the output is that's what we're going to
attempt to do now now back over in
profile that PHP I just have to make
sure in the accept friend requests
function that's looking to get returned
data back from that script we get the
data to show that way like I said this
line will get overwritten very
seamlessly it'll be kind of magical this
line will get overwritten by an output
result for each time they click any of
these accept or deny buttons on any of
these people I'm going to FTP and test
the out whoopsie
I got to change this to X that won't
target the right thing okay I know my
profile let me refresh
and let me except one of these guys here
preferably somebody with a picture it's
gets a crew ease except okay this is you
are now friends with this member it took
over that whole sentence just like we
wanted that whole line is gone and now
it says you're now friends with that
member so they can't click anything else
for that person there and if i refresh
Zach Ruiz will be out of my list because
he and I are now friends see no Zach
Ruiz he's out all right now all we need
is when we click this deny button and
that's going to be very very simple I
told you it'd be simple those four lines
take care of it so let's say this is
part three if denying friendship
so if post request is denied friend
posted with the request ID see him from
post from profile that PHP here's the
post request is denied friend with the
request ID save that so what happens is
we get the request ID into a local
variable then we just MySQL query the
database to delete from friend requests
where the ID is equal to request ID
limit 1 then we just echo out request
denied and let's FTP and test that as
well okay I'm going to refresh do
scripts are up click friend requests
here and I'm going to have to deny one
of these people
uh Jason Sweeney let's deny Jason you
can just or I'll I'll uh I'll send a
friend request to you because I'm not
purposely denying you here let's press
deny see request denied now if i refresh
Jason is not going to be in my list
anymore and he and I are not friends but
I can go and request him now
okay so it's pretty much that's how it
works you see it's all working good so
we have the ability when we're on
another person's profile to request a
friend right here then while we're on
our profiles we have the ability to
check anybody who sent us a friend
requests and accept and deny them and
part 5 will get the friends displaying
now that we're accepting them and
everything we have
I have like four friends now that I can
display here and that's what I'm going
to work on doing and then after that
there's only one more part one more
video after that number five which is
going to be number six I think that'll
be the final one maybe and that one will
show you how to remove friends because
you don't want to be able to make
friends with somebody and then they piss
you off and you can't remove friends you
know alright see you in part by</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>