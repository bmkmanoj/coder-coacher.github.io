<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to Build a Community Web Site Part 6 - Header, Login, &amp; Sessions in Flash PHP Tutorial | Coder Coacher - Coaching Coders</title><meta content="How to Build a Community Web Site Part 6 - Header, Login, &amp; Sessions in Flash PHP Tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Khoury/">Adam Khoury</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to Build a Community Web Site Part 6 - Header, Login, &amp; Sessions in Flash PHP Tutorial</b></h2><h5 class="post__date">2009-03-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/mwUeGtnamfQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay welcome to part 6 of building a
dynamic web community in PHP MySQL and
flash and in part four and five parts
four and five we created this
registration form and a parse mechanism
in PHP for it and we also created the
activation script that gets sent to the
user's email address so we can be sure
they are who they say they are and
they're human and all that good stuff so
at the end of this lesson at the end of
part 6 i'm going to package up the
source files for everything I've done so
far and put it in a zip package and
place it on develop PHP for download in
the PHP mysql section under this
tutorial series and so each time i
create the script or add something at a
video and a script i'm going to update
that zip package to where anybody who
wants to follow along as I build you can
have the the files that I place in as I
go or you can just wait till the very
end and snatch up the whole source
package and then watch videos as you
need to okay so in this one we're going
to create the we're going to go into our
header flaw flash file and we're going
to put in the buttons that we need and
here I have the flash file open and i
created a little orange rectangle and I
gave it a rounded edges and I'm going to
use that as a button my first button and
I'm going to think about what buttons I
need here and the basis of this file is
going to be very simple on frame one
we're not going to have any of the
buttons buttons are going to be on frame
two and three on frame one we're going
to have a pH peak connection code and
the PHP script is going to tell this
flash file whether or not the user is
logged in or not if the user is logged
in this file is going to snap to frame
to
and if the user is not logged in it's
going to snap to frame 3 where the login
form the login fields for the email and
password will be in the little button
and or maybe i'll have it vice versa or
maybe the login on frame 2 and the
buttons for the logged-in people on
frame 3 it doesn't really matter
whichever one you want to snap to but as
long as those buttons are separated so
the logic is you want to have different
items different menu items based upon
for the user to use based upon whether
that user is logged in or not it's very
simple and we can do this in flash which
I'm going to do and i'm going to show
you an actionscript 3 or you can do it
in straight PHP and HTML and CSS a nice
HTML and CSS header that would have the
ability to make the server call to check
if the user is logged in or not it's
very simple it would almost be simpler
to do it in PHP and mysql and CSS and
HTML alone and not use flash it would be
simpler so if you would like to use that
method you can try it out but I'm not
going to be showing that method I'm
going to show how to integrate a flash
header that has the ability to sense
whether users logged in or not
okay I've got my Universal header all
set up and now I'll show you what it
consists of the way I separated
everything out and layered it and you
can see here we're on frame 1 in the
main seen the main timeline and the top
layer is 10 timeline frame code
actionscript-3 and that has three
different or three independent scripts
that will be placed on each independent
keyframe there and the not logged in
stuff is here so this is the items that
the user would see they're not logged in
register an account link so they can get
to the register form and page they
forgot password link that will set that
up soon this one's already active this
one's not set up yet we'll do that in a
later tutorial in this series here is
the login button and the two fields for
the email and password and here is the
status text that would give them an
error message and here is this is on a
different layer actually so let's not
even explain that yet so here's the not
logged in stuff and you can see that
it's above on a layer above the logo and
the bar so here's the logo here's our
bar that's on a layer by itself and that
has a little bit of code on it and in
that code on that layer that's just
simple code to make this home button I
have a button sitting on top of the logo
and that word and that invisible button
if I bring the Alpha up you can see the
buttons here that invisible button there
is you know what people would use see
here
click that goes back to the homepage you
know any time you're anywhere on the
site you click that and go back to the
homepage and so that's what that's for
and then we have and so yeah what's on
that layer is just the button that's
over the logo the logo itself and the
bar and then there's a dynamic text
field of welcome text and that just
throws the user's name in after they
login it'll say web intersect atom or if
your name is John it'll say web
intersect John and so that's after you
login so here is the logged-in stuff
it's very simple it's just three buttons
so if the user is logged in they get to
see this the view of the profile button
edit the profile button and logout
button and we still have lots of room
here on our bar that we can put menu
items for when we start building content
onto the site and so the first frame
let's explain the code now when the file
opens or when the file is accessed in
the browser right away in a split second
this little script runs to check and see
and you can see the URL here connects to
a scripts folder and inside we have a
file called check user log that I just
created and this script is set to
connect to that PHP file and it checks
to see if the user is logged in if the
user is logged in or if the users not
logged in it says go to and stop frame
too so they see the not logged in stuff
the user is logged in right here we give
the welcome text the member name and we
remember that text sitting right here
the member name and we also go to and
stop frame 3 where they see the logged
in items so where they can edit the
profile view the profile log out all
that good stuff and anything you want to
give them
and if you don't know how to you need a
tutorial on the basics of sending data
or sending a call out to PHP to get data
back or whatever to check things I have
lots of tutorials and that kind of stuff
my contact forms and working with
external data section in my flash
tutorials but that's a very simple
mechanism just for sending a request out
to a PHP file then getting data back
from it and if you need like I said if
you need tutorials on that I've got it
i'm not going to explain all the
fundamentals on that and this we have a
lot to cover and then frame to the
timeline frame code layer this is for so
this code is for when they press the
submit button in the form when they put
in their email they put in the password
and they press login this is the script
that runs when they press the login
button it does some validation and it's
just like a form just like my form
tutorials so I'm not going to really
explain that code either if you don't
understand it go take my other tutorials
and get get the knowledge before you
want to work with this let's see in here
we have a stop action and soon I'm going
to be putting in the URLs which we
haven't made those pages yet so we can't
put the URL link to them there would be
basically three button links the code
for three buttons here these three but
we haven't created any of these pages it
so we can't do that and that's really
how this whole thing works and I tested
it out in Google Chrome Safari Firefox
and Internet Explorer it logged me in
and everything works beautifully and I'm
going to explain the the scripts the two
scripts that we had to create because
see here we have where is it frame to we
have a login script that I created is a
very simple little tiny PHP
Crips I'll explain in a second and a
frame one we have the check user log
script so there's a two scripts that
this header universal header requires
that i created already and now i'm going
to explain them to you
there is one little quick thing that I
need to explain before we look at those
two scripts let's see where is it
buh-buh-buh-buh-buh right here if the
login comes back saying no good we give
them the status text saying no matching
our records please try again when they
put in their email and password on this
frame too and then press login if the
script the PHP script returns no good
then we give them this message but if
it's all good and they are logged in we
logged them in with the PHP script and
we run this section here and what this
does this is the JavaScript kind of hack
that I put in and I tested in all
browsers and it works in all browsers
all major browsers the people are using
today I tested in Firefox Safari
Internet Explorer in google chrome and
this refreshes the page automatically so
right when the event target that data
return message equals all good when it
comes back then we refresh the page and
we do that just in case they're on a
page where it requires logged in data to
look at something and then they go to
login to look at that data that way the
page will refresh on its own to show
them the data as a logged-in member
would see it and that's what that does
and not many people know about this
little trick here but it's a javascript
trick that you can use in the URL
request that will reload the self page
or reload the current window that's open
in the browser pretty cool trick and now
let's talk about those two scripts here
so first one that this header file needs
to access is check user log to check if
the users logged in and where is that
check user log here we go first thing we
do is this is our PHP file for check
user log and these bolts sit in the
scripts folder so here in our root
directory of web intersect we have
scripts folder and that's the one where
you have our connect to MySQL file and
here we have check user log and log in
that's where those live and that's where
they also live on the server see go to
scripts check user log and login connect
to mysql all in the same folder there
and now let's talk about it first we
start a session start or we claim
sessions start to run to access any
session variables that might be present
and we say first we run a condition and
its nest starts here and it closes here
and the condition is if the postcode
from flash it equals check log which in
flash we send out that variable C bars
postcode equals check log that's how
that works we make sure we're coming
from the flash file here so we wouldn't
run this code if we weren't the script
would never run so if that's coming from
the flash file and an equals check log
then we run another conditional here and
it's an if and else conditional
statement and it's says if the session
ID for the user their ID session is not
set then we print the return message
equals not logged in it's very simple if
the session ID then we say else here
which is pretty much saying if the
session ID is set or if it is present
and they are logged in then we print
back all good no we don't print back all
good we print back
the member ID and the member name the
member ID I'm not really accessing right
now in the header file but i might down
the road but i am accessing the first
name now let's talk about the and then
after it's after a checks then we exit
the script actually put this exit up
here two dozen doesn't necessarily need
it because there's nothing down below
that would even run anyway but i like to
exit my scripts when they're when they
don't need to process any further down
okay so let's check user log let's ftp
that new one up and let's talk about
login now now login form a script sorry
is similar it checks to see if the post
email does not equal nothing because we
need to have a value and it needs to be
posting an email posted variable in
order for this script to run and it must
have that email variable must not be an
empty variable it must have some kind of
value so that's what that condition
states and it closes here at the bottom
so what we do inside is if the email
this variable is set and the user sent
is trying to log in and we include the
connect to MySQL we grab the posted
variables from the flash login form and
we create local PHP variables then we we
filter them then we take the password
and we run the md5 hash on it now this
is this is important for logging the
user in because you got to remember in
there in the database their password is
all hashed up it's not wouldn't be human
readable you Minh Lee readable to what
their Patrick for it actually is it's
just
long string of jumbled up numbers and
letters so you run the md5 hash on what
that users just input into the form and
then you'll have the match so you if it
matches it'll make the same exact hash
and then you check for that hash
matching the database hash so you say
select from my members where my members
table from the database where email
equals email from the forum and password
equals the hash pass here from the form
and email activated equals 1 i'm going
to make sure they already activated
through that activation script that we
made in the beginning and then we say we
get the value of the the number of rows
that's accessed that's gathered from
this query and it should be 1 and if we
claim a that variable gets packed into
this or that value gets packed into this
variable then we making additional it
says if this value is greater than 0
which it should be if they remember and
they're in our database then we run a
while loop on the the the array of rows
of the array of fields and we can access
all of those fields and we session we
register the sessions for those fields
and then we set the values into the
session and that will log the user in
and make session cookies for the people
and that way you can have run sessions
site-wide and that way they don't have
to log in on each page you know if you
want to understand how sessions work you
can go to php.net and check out all
about that the MySQL query here updates
their last log date to now to today's
date because
want to update that and then we just
print a message back to flash and we say
all is good and our flash actionscript
is waiting for that message all good and
we return the I user ID and the first
name again and then if the login did not
work we send back in this else condition
statement we send back my message of no
good the return message of no good to
flash and the actor script is waiting
for that there as well you can see right
here if the return message equals no
good we do this if the return message
equals all good we do this and that's
how this whole little universal header
system works it's this header file and
those two files that I just explained
check user login login dot PHP and now
I'm going to wrap up boulders sort
source code into a zip package and like
I said it's not going to be the complete
system it's just going to be for people
the source code that I'm putting out
tonight after this video uploads to
youtube is just for the people who want
to follow along step by step as I built
a lot of people might choose to wait
until I get to the end or but the source
code will be available tomorrow either
today or tomorrow and you can get it
from develop PHP com no actually i might
i'm just going to make the source code
available here from web intersect and
actually you guys can join at this point
please do help me out you can help me
out by registering an account and you
can help me get some some members in the
system so i can get things right when
I'm building my member search page
member listings
you know tweaking tweaking out profiles
and now well that's good stuff but if
you're a developer looking at creating
these type of systems it would be a big
help if you get in and join it early so
I can build a little easier don't have
to make as many dummy characters in my
database I can have some some real
people in there from the start that'd be
sweet okay so part 7 we're going to go
into the next phase of what we need here
but we took out a big chunk of a lot of
the functionality that the header is
going to need and all that good stuff
and let's see let's try and log in
hit tab hey password I'll show you how
this works now test it out first login
it says processing is my name is my
three magic buttons that only the logged
in user sees and I'm still on the same
page and it refreshed it and everything
and that's exactly what we wanted it's
beautiful let's go back to the homepage
it and it checks to see if I'm logged in
again and everything's great okay so in
part 7 will will probably get the pages
set up for the log out the mechanism set
up for the log out and we'll just keep
going down knocking out each step each
each phase of the project as we need it
so stay tuned for part 7 and look for
the source code if you want to follow
along source code will be available from
web intersect here and I've also linked
to it from develop PHP and all that good
stuff alright see you guys later</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>