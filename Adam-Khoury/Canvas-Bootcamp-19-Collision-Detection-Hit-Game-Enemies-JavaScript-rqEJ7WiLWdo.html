<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Canvas Bootcamp 19 - Collision Detection Hit Game Enemies JavaScript | Coder Coacher - Coaching Coders</title><meta content="Canvas Bootcamp 19 - Collision Detection Hit Game Enemies JavaScript - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Khoury/">Adam Khoury</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Canvas Bootcamp 19 - Collision Detection Hit Game Enemies JavaScript</b></h2><h5 class="post__date">2013-12-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/rqEJ7WiLWdo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this exercise you can learn collision
detection on the canvas with JavaScript
along with a few other useful tactics
collision detection is the act of
detecting when specific objects come
into contact with one another and then
programming some resulting effect of
that collision we're going to be putting
the logic into a video game programming
scenario to best demonstrate detecting
collisions for multiple objects
simultaneously all of the code used in
this basic application is code from all
of the previous exercises in the
bootcamp so I'm not going to explain the
code character by character since you
guys already understand the building
blocks of everything that will be
applied first let's take a look at the
finished product of what you'll be
learning how to do when the application
starts we have enemies coming down and
then we have the launcher down here that
can move left and right and then it can
also fire missiles so if I line up and I
fire missiles you can fire as many
missiles as you want and when I hit
certain objects they get destroyed and
go away and then when I finish killing
all of the enemies
it says level complete okay you can see
we're starting with a blank canvas the
first thing I'll do is go into the body
and add some HTML it's a little HTML
there's three buttons in a div element
and then we have a status element that
just it's going to output some status to
us okay now all we have to do is apply
to JavaScript so the first thing I'm
going to do after we establish our CTX
object is I'm going to get the canvas
width and the canvas height into
variables then directly under that I'm
going to create a variable it's an array
called enemies and in this array there's
a bunch of little JSON objects one for
each enemy now what we're going to do is
just loop over this enemies array to
have them come pouring down the screen
at the launcher and what we can do is
just put that into a function called
render enemies so we say function render
enemies and then we have a little for
loop that runs over the length of the
enemies array and each of the little
JSON objects that represents an enemy
will get accessed within this for loop
and it can be rendered to the canvas
and you can see what i'm doing here is
replacing the X&amp;amp;Y and width and height
at the specified values for each of the
objects but I'm incrementing the Y
position by 0.5 which is half a pixel
each frame so they'll go half a pixel
down the screen and that's how I get the
effect of them coming down the screen
now this render enemies function is
going to be fired off within an
animation loop and that's how you get
the animated effect now right under that
or a few lines down we can put an
animation loop in place and what that
will do is allow us to render enemies in
an animated fashion crawling down the
screen you can see our animate interval
is set to 30 milliseconds press ctrl s
to save it and render in your favorite
browser you'll see that you get the
effect that you want now all we have to
do is add the launcher and then make the
launcher shoot to missiles and we also
have to put listeners for these buttons
which we'll do in just a moment ok so
right under the function render enemies
we're going to put in an object to
represent the launcher so now I'll pop
that into place and I'll explain all the
code real quick now since we have the
new launcher object ready I'm going to
put the render method for the launcher
in our animate loop you can see one of
the methods for the launcher object is
hit detect so let me explain all the
code within this function launcher which
creates the launcher object first we
specify some properties for the launcher
then we specify the methods we have a
render method we also have a hit detect
method so we set the y position at 280
so it's down near the bottom of the
canvas then we set the x position of the
launcher centered in the canvas we give
it a width of 50 and a height of 50 then
we give it a property called dir which
is short for direction that lets you
keep track of which direction that it's
being controlled to go by the
user then we say this dot B G equals
orange and then this dot missiles equals
empty array and the missiles array is
also little JSON objects that we place
into the missiles array when the user
hits the fire missile button so it just
starts out as an empty array and when
they fire the missile button we just
pack as many little missiles that need
to be on the screen into that missiles
array
okay now this dot render method is where
a lot of the movement and the shooting
logic can occur so the first thing we do
in that render function is we say if
this direction is equal to left that
means if the user is pressing the left
button then we're going to make this X
minus equal five that means it'll go in
the left direction and the canvas else
if this direction equals right if the
user is pressing the move right button
then we're going to say this dot X plus
equals five to move in the right
direction then we give our launcher a
background or fill style which in this
case was orange and then we place it on
the canvas and remember that the
launcher that render method is the one
that's fired off within your animate
loop so it's going to be fired off a lot
constantly and it's always going to be
listening for hit detection and movement
or ready to react to hit detection Xin
movements and firing of missiles and all
those things so to fire off the missiles
what we're going to do is for loop over
the missiles array length now we get all
the missiles into the missiles array
when the user presses the button which
is the fire button down in the HTML we
have the fire button down here when they
hit that fire button all we're going to
do is push a new little object into the
missiles array that will represent a new
missile so here we're looping over the
missiles array simply to render them to
the screen and since the missiles are
being shot from the bottom of the screen
up we can just take each missile and -
equals five on its Y position to give it
upward movement then once it's rendered
and it has upward movement we also want
to hit detect for every missile against
every enemy and I'll explain this method
hit detect in just a moment the next
little bit of
odhh is to see if a missile goes past
the canvas boundaries then you want to
remove it so you say if the missile dot
Y position is less than or equal to zero
then we're going to splice it out of the
missiles array so it no longer exists
because you don't want a bunch of
missiles that are outside of the canvas
you know taking up memory for your
program or hogging up graphic resources
or whatever or maybe it wouldn't if it
was outside of the canvas but still you
want to make sure that you just remove
those things if they don't exist on the
canvas anymore there's no use having
them still be in the program and you
don't have to be moving them still
outside of non visible space so that's
the only reason we put this in places
just to remove a missile if it goes past
the boundaries of the canvas and this
little bit of code is for ending the
level of the board you say if the
enemy's that length is zero if there's
no more enemies then you clear the
animate interval and you put some text
on the screen that says that level is
over and then under here you put
whatever code you want to load the next
level or whatever you want to do now for
the hit detect method we're passing two
parameters the first parameter is the
missile in question and the missiles
index within the missiles array where it
lives what position it lives within the
missiles array that way we can splice it
out when we need to if it happens to hit
an enemy you want to get rid of the
missile you don't want the missile to
keep going through the enemy unless you
want that then you don't have to remove
the missile but I just chose to remove
the missile when it hits an enemy that
way the enemy explodes and the missile
explodes they no longer exist
so for hit detect the logic is we for
loop over the enemy's array length so
for each enemy on the screen or for each
enemy that's still alive within the
enemies array so what I did was I just
named each e within the loop to make
things easier within our hit detection
evaluation so each enemy within the loop
gets represented by this e now here's
our hit detect logic which is similar to
the mouse hit detect logic the touch
finger touch hit detect logic that we
did yesterday in exercise 18
doing here is setting up a rectangle
bounce to see if the missile is in the
same space as any of the enemies so we
say if the missile dot X position plus
the missiles dot width is greater than
or equal to the enemies x position and
the missiles dot X position is less than
or equal to the enemies that X position
plus the enemies that with and that
takes care of your horizontal space then
for the vertical space we want to say
and m dot y position is greater than or
equal to the enemy's dot Y position and
the missiles dot Y position is less than
or equal to the enemies at Y position
plus the enemies at height so you run
all of that math and that what that will
do is give you pounder e that tells you
of any of the pixels of the missile are
in or on or have come in contact with
any of the pixels of the enemy you just
want to make some kind of equation that
lets you see if any pixels of the
missile have come in contact with any of
the pixels of the enemies and the way
our code is set up each missile that's
fired even if there's 20 missiles on the
screen there each hit detecting all of
the enemies so if any of those hit any
enemies we'll get the results that we
want and that is all of the code then
all we do underneath the launcher object
is we save our launcher equals new
launcher object that way we have a
reference a new instance of that
launcher object and we say launcher dot
render down inside of our animate
function now all we have to do is put in
the button listeners the event listeners
for those little buttons in our HTML and
we'll have a working application okay so
I'm going to go under the animate
interval where I put the animate
interval which is basically the last
line within our application and we're
going to pop in the listeners for all
the buttons so we save our left button
is equal to the left button that's down
on the page here I'm going to do the
same for the right and the fire button
so we have object references for all
three of those items and we say left
button we add an event listener for
mousedown and when the
user presses the mouse down we just take
the launcher and make its direction
property equal to left that way it
starts moving left then we want to make
sure that when the user Mouse's up on
the left button when they let go of it
that we make the direction equal to
nothing that way there's no more
movement and that's also a smarter way
to program your keyboard movement if
you're going to supply movement in
videogames for keyboard controls you can
just set the direction in the listeners
for those keyboard events those keys
when they're pressed set the direction
and then when the user key ups when they
let go of the key you just set the
direction to nothing and then your
movement will stop now for the right
button we do a similar thing we make the
direction right this time though instead
of left and then when the user Mouse's
up we make the direction nothing again
that way movement stops now here's the
little important part the fire button
when the user hits that fire button we
push a new little JSON object into the
missiles array that way there can be as
many little missiles on the screen as
there needs to be and we can handle
their position and all of the little
properties that we need to independently
for each little missile and it's easy to
handle them if we put them into little
JSON objects that are packed into an
array and we can easily for loop over
that array so every time this fire
button is pressed you're going to pack a
new missile into the missiles array and
each missile gets an X a Y a width and a
height and a background you can give it
any properties you want you can give
them all custom properties that you need
to have for any of your objects and we
make the missile shoot out from the
front let's see if we have a working
application ok we're firing missiles we
destroyed enemy - let's move left here
fire missile fire a bunch of missiles so
no matter how many missiles we fire they
go away when they leave the screen up
top alright we have a working
application now if I get I'm the way I'm
getting the missile to come out the
direct center of my little launcher down
there is we're setting the X property
equal to the launcher X plus the
launcher dot width times 0.5 which is
divided by two so you take the launcher
with divided by two and you add it to
the launchers x position that'll give
you a dead center on the X plane dead
center too relative to where the
launcher or the ship is then the Y can
just be simply equal to the launchers
dot Y position it'll make it come out
the top then you set the width for your
little missile and the height for all
your little missiles and basically that
is all of the code alright so now you
have a really good understanding of how
to detect for collisions for any of
those arrays of objects and there's a
lot more additions you can add to this
code to make it a more complete game if
you just sit there and put the time into
it and work on it so that completes
collision detection and we've done it in
such a way that allows you to detect
collisions for a whole lot of different
things that are on the canvas at the
same time many objects simultaneously</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>