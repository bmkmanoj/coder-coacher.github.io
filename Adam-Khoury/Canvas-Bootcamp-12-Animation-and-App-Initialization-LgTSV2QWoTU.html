<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Canvas Bootcamp 12 - Animation and App Initialization | Coder Coacher - Coaching Coders</title><meta content="Canvas Bootcamp 12 - Animation and App Initialization - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Khoury/">Adam Khoury</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Canvas Bootcamp 12 - Animation and App Initialization</b></h2><h5 class="post__date">2013-11-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/LgTSV2QWoTU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">howdy pilgrim in this exercise you'll
learn to structure your code for
animation programming on the canvas
we're also going to demonstrate how to
initialize canvas applications to place
all of your JavaScript in the head of
the document in order to keep your
documents more logical and tidy
javascript might be long leads in the
head section of the document just like
the styling so our two goals are to
properly initialize our canvas
application in case it's a very complex
canvas application or maybe it's a very
complex game we want to know how to
properly initialize it so we can have
our body element stay clear of things
like scripting tag we want to have our
scripting tags up in the head element
and you can refer to an external
scripting tag after you get done
programming your application you can
just make it an external file and then
refer to it up in the head of your
document so we're going to talk about
properly initializing complex canvas
applications and we're going to talk
about structuring your code for
animation programming okay so in the
head element of our document we have a
scripting tag open and inside the first
thing we're going to do is initialize
the canvas application so we'll add an
event listener to the window object for
the onload event and then when that load
event fires we're going to run a
function called init canvas open close
parenthesis semicolon now init canvas is
going to be the function that
initializes the canvas and gets it ready
for programming so let's just copy that
control C and right above our window dot
onload event function we're going to
type in function init canvas initialize
canvas opening curly brace and closing
curly brace now here is where we're
going to access our CTX variable the CTX
object I'm going to go ahead and
collapse this style element because we
don't need to see that now the next
thing we're going to do inside of our
initialize canvas function is we're
going to set a couple of variables we're
going to call this canvas width next
going to be equal to CTX canvas dot
width and we also want another variable
called canvas height and that's going to
be equal to si
ix canvas dot height property and we'll
put a semicolon that way we have easy
access to the canvas height and the
canvas width within our code now I set
up the window load event function like
this that way you can run more code
inside of it if you need to maybe you
want to run another function or a few
lines of code in the onload event of the
window you can do that here within this
function still so really that's the
basics of proper initialization of a
canvas application you just do
everything you need to do on your canvas
inside of your init canvas function now
very quickly I want to jump over to
YouTube because one of you guys placed a
comment on my last video that I want to
address and the comment is from Samuel
Hickok and he says out of curiosity will
you be linking your canvas bootcamp with
a bit of OOP so what I'm going to do is
in the very next video tutorial we're
going to show you how to add assets to
your canvas in an object-oriented
fashion so basically they'll be
object-oriented assets that you'll be
adding to your canvas and that's really
handy when it comes to game programming
and any kind of application programming
on the canvas so yes we'll be dealing
with OOP and we'll demonstrate how to
add assets to your canvas in an
object-oriented fashion in the very next
video
okay now that we have proper
initialization out of the way and taken
care of we'll show you the code
structure for animation so inside of our
init canvas function we're going to
create a new function and name it
animate just so everybody knows what its
purpose is opening curly brace go down a
couple of lines and put in your closing
curly brace now inside of function
animate we're going to be able to access
this CTX object no problem now what you
want to avoid doing is creating your bar
for your CTX variable inside of your
animate function unless you're doing
something very simple and basic but if
you have a complex animation or set of
animations you want to make sure that
within the animate loop that it's built
very efficiently all of the code inside
of the animate function because this
function is going to fire off many many
many times per second and you don't want
it overloaded with things it doesn't
need to be overloaded
for instance creating the CTX variable
or recreating it every time the function
fires off which is many many many times
per second so my point is you keep the
code inside of your animate function as
slim as possible now the first thing I'm
going to do is type in CTX dot save
which is a method used for animation
purposes when you want to restore all
the transform effects on the canvas and
then you put CTX restore after you run
all of your changes on the canvas
they put changes happen here and this is
where you would draw to your canvas
let's just say draw here now within an
animation loop you also have to clear
the rectangle so right after you save
the previous layer on the stack we're
going to see TX dot clear rect which we
already covered and that's the method
that lets you erase the canvas and you
have to erase the canvas every time
you're animate function runs or else
you're just going to get everything's
going to look like it's being drawn so
that's why you have to clear the
rectangle and to do that is simple you
just put in the coordinates for a
rectangle and within that rectangle
that's what gets erased so we put 0 X 0
Y and we're just going to use CW which
is the canvas width and sea height which
is the canvas height we already
established those variables up here so
we're clearing the whole canvas now I'm
going to show you the contrast of using
CTX save and CTX that restore that way
you guys can see when it is handy to use
those two methods you don't always need
them so in order to make this animate
function run many many many times per
second to animate things we're going to
type in var animate interval is equal to
set interval and the two parameters
we're going to feed the set interval
method the code that we want to run in
our case this is an animate function and
if you put this at 1000 milliseconds
it'll run every second but we want it to
run very very fast so I'm going to put
it on 30 so what's happening is every 30
milliseconds this animate function is
going to fire off which creates the
animation and notice how we're putting
our variable
outside we're setting the interval
outside of the animate function right
outside of it and we're putting it into
a variable that way we can easily stop
the animation when we need to now if you
were to run this right now you're not
going to see anything because you
haven't drawn anything to your canvas
yet so I'll put in a magenta rectangle
that's 50 wide by 50 hi it's set at zero
and zero coordinates to be in the
top-left corner now if you run this
right now you'll see that it's
stationary it's not doing anything
because you're not animating any of the
properties and that's what animation is
all about on the canvas is adjusting
properties dynamically so just for
demonstration purposes let's animate the
Y position so this travels down the
screen in an animated fashion so let's
go outside of our animate function let's
create another variable called Y we'll
make that equal to zero by default now
we'll take that Y variable and we'll put
it here for the Y coordinates of where
that rectangle should be drawn now we
can just put Y plus plus so the first
time the animate function fires off Y is
going to be equal to zero the second
time animate function fires off Y will
be equal to one and so on and so on and
so on Y we'll just keep incrementing so
let's refresh and now we see we have an
animation of where the little rectangle
is traveling down the screen now what
I'm going to do is grab that rectangle
go down a couple of lines to make
another rectangle just make this one
blue any color you want these can also
be images or any other shapes and this
one we're going to set at zero Y and
we're going to affect the X so it
travels on the other axis and we'll just
put the X variable up here say X is
equal to zero
and then we're also going to X plus plus
and I'll see what we get okay now we're
going to demonstrate the importance of
clearing the rectangle or erasing the
canvas every time this function runs I'm
going to comment out that line now watch
you see that's not the results you want
unless you really want those kind of
results so you're clearing the rectangle
that way it gets erased every single
time that
you get the appearance of objects moving
instead of lines being drawn now let's
see what exactly what CTX dot save and
see t x dot restore are doing for us
we're going to experiment with that by
putting in rotate so for this first
rectangle right before it's drawn I'm
going to rotate the canvas and then
before the second one is drawn I'm going
to rotate the canvas yet again to a
different angle let's put this one on
0.3 and the next one on 0.8 actually put
this one in minus 0.3 now let me comment
out see T X dot save and see T x dot
restore and let's take a look at the
effect and that's not the effect I want
now what I want to do is save this the
last layer in the stack in the animation
stack and then restore it at the bottom
and look what I get now see a massively
different effect a lot of people ask me
what save and restore are used for and
there's your evidence right there that's
why you use save and restore I'm going
to remove these rotate methods there so
that's a good structure for animation
now if you ever need to stop the
animation you can just clear interval on
this variable so I'll just use a click
so if anybody happens to click the
canvas it'll stop the animation so let
me go right under my animate interval
variable and putting in a new event
listener for the canvas of click so we
say CTX canvas add event listener of
click and when that event fires off
we're going to run this code clear
interval on the animate interval
variable now watch I'll just click the
canvas and it stops the animation so
that's how you can effectively stop your
animations at any time that's pretty
much all there is to it I've explained
the CTX dot restore and save I've
explained why we clear the rectangle
each time the animate function runs and
we want to make sure that we don't clog
the animate function with creating new
variables or recreating the CTX object
every time the animate function runs so
you can keep all of that stuff up here
above the animate function because the
animate function runs so many times per
second
that you want to have it as efficiently
programmed all the code inside of it as
efficiently programmed as you can okay
so that completes structuring your code
for animation programming and properly
initializing your canvas applications
the next exercise we're going to learn
all about how to add assets to your
canvas in an object-oriented manner</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>