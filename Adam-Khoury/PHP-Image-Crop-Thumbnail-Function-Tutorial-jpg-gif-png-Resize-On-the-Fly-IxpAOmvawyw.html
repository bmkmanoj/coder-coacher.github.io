<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PHP Image Crop Thumbnail Function Tutorial jpg gif png Resize On the Fly | Coder Coacher - Coaching Coders</title><meta content="PHP Image Crop Thumbnail Function Tutorial jpg gif png Resize On the Fly - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Khoury/">Adam Khoury</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PHP Image Crop Thumbnail Function Tutorial jpg gif png Resize On the Fly</b></h2><h5 class="post__date">2011-03-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/IxpAOmvawyw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so I'm going to show you using
programming how to crop this image say
somebody uploads this image to your
website let me show you how to crop a
perfect square out of the center of it
but you might be saying here Adam
what if somebody uploads an image that
shape like this and I'll be like P
chance same thing I'll show you how to
crop it we're right out the middle but
it'll be turned that way don't be a
doofus
and before we get into the nitty-gritty
of the code let me show you improve to
you that it's working I'm going to use a
PNG so that's uploaded resized and
cropped and press back choose file I'm
going to go with this JPEG that's a
definite distinct different shape than
all the rest upload it okay now that
one's been uploaded resized and cropped
now I'm going to grab that gif that has
a different shape than the other two
okay that one's been uploaded resized
and cropped okay let's go into the
uploads folder on our server and you'll
see we have our flowers girls and sky
the originals that uploaded we have our
resize flower resize girls resize sky
now we have thumb for flower thumb for
girls and the thumb for sky so I'm going
to take those and put them in my folder
so I can get a good look at them and
here's what I have so you can see the
flower the girls and the sky are the
originals here and they all have
different shapes and they're all
different types this is this is P and G
this is JPEG this is gift now my script
takes care of creating a true square
thumbnail or whatever shape that I want
to make it PNG file that's 150 by 150
cut out of the center of this flower now
you can see the girls it's a 150 by 150
square cut out of the direct center of
this picture in the sky same thing 150
by 150 square that's a gif file
cut out from the center of this gift and
that's how cropping works
that's smart cropping right there okay
this is how it works and we're going to
stem right off of the
lesson where we created the image resize
function and included it into our
parsing script that is our image upload
script PHP so we just included that file
and we run a custom function that's
inside of it feeding it specialized
variables right now we're going to go
under that function inside of this image
upload script and we're going to run
another custom function called a kay
image thumb and that gets fed five
custom variables as well and these are
the four variables that are set to go
into this function and file extension is
the same file extension we're sending to
this whatever the file extension is for
the file that's being uploaded at the
time that's that variable now I'll
explain these other four being fed in
right here this first one is the target
file now what we're doing is we're
targeting the resized image because you
don't want to target somebody's original
upload that might be a huge pile you cut
out a 150 by 150 square out of the
center of a huge file you're just going
to get a little tiny view of whatever's
going on in the picture which is going
to be a little tiny square cut out of a
big giant file so you want to target the
resized image that makes more sense and
cut a square out of that one so you get
to see more of what's going on in the
image after you crop it and you can play
with these numbers you resize numbers
and your crop numbers - it's a 150 width
and 150 height that way it crops at a
perfect square for me if I wanted it to
crop a rectangle shape I would maybe
make this 100 so it's wider than it is
tall but I want mine a perfect square
directly out of the center now the next
variable is thumbnail and that's going
to be the destination file where you
want it to live on your server and what
its name is going to be in this case I'm
just taking the original upload file
name and putting a thumb underscore
prefix on it just like I did the resized
file so that one will say thumb
underscore whatever the file name is and
in later tutorials for this series I'm
going to show you guys how to rename
uploaded files that people are uploading
that way you don't have any
clicks with people having weird
characters in their filenames or spaces
or anything like that for now we'll just
use the original file name
and trust me renaming files when they're
being uploaded and you're putting them
on the server and all that it's really
easy to rename them and it's no sweat at
all I'll discuss different ways that you
can rename them now the next two
variables being fed into this custom
function called aka image thumb is the
width of the thumb that you want and the
height of the thumb that you want like I
said mine is 150 by 150 to make sure
that it's a square cut and that's it so
that's all you have to put in your
existing upload form and if you're not
using the resize function what you do is
you just target the uploaded file
instead of targeting the resized file
you just target thee whatever uploaded
file but normally in this circumstance
somebody would resize the file then they
would crop it because like I said if you
crop a giant picture you're just going
to give it a little piece of it now I'll
show you the function that we're going
to put inside of a K PHP image library
1.0 and that's an external file that
we're including here to run the resize
function and the thumb function so you
don't have to include it again for
anything else once you include it up
here you can access any functions that
you put inside of it so we're going to
put another one here so you can see here
we have the resizing function in a K PHP
image library 1.0 that we created in the
last lesson let's just go right here and
we'll add another function alright so
there's the new function let me get it
all in to view here so you see the whole
thing there it is function for creating
a true thumbnail cropping from any jpg
gif or PNG image files now this one
works in a very similar fashion to the
resizing function that we have up here
the only difference is the math or the
values rather that are put into the
image copy resample function you have to
put different values in there that way
you don't get an exact copy or a resized
copy of the original that you're
targeting what we want to do is target
the resize copy in the
function and set coordinates within the
image copy resampled function where it
cuts out a nice square in the center of
the original image and makes a new image
from that that's what the image copy
resampled function does it takes a
source image it creates a new image from
coordinates that you set for the source
image so you change the coordinates up a
little bit and you'll get a crop instead
of a resize and the key to doing that is
right here so you can see the function
so that we gather the variables that are
coming in then we can use these
variables within our script here and
just like in the last function we get
the original height and original width
of the target image which is the resized
image then we take that resize image and
we want to get the source X point and
the source Y point to begin our crop and
to get those numbers is pretty easy so
basically you're taking the original
width and the width being the length of
any image and you divide that by two so
you take your target image you divide
its width by two you divide its length
by two then you subtract from that the
value that you get from taking the width
of your crop size divided by two and the
same with the height here so that's how
you get the source X and the source Y
those are the two coordinates that
you're going to need for representing
the top left-hand corner of your cropped
image so you're basically taking the
length and the height of the original
image and you're dividing it by two to
capture the center point and you
subtract from those values the width and
the height divided by two for your new
cropped size image that way the left top
corner of your new cropped image doesn't
start in the center point of the target
image it'll start offset this is a way
to offset that to where you get an exact
center cut out now everything else
within this function is pretty much the
same as the last functions these lines
right here I don't have to explain again
because I explained them very in-depth
in the last lesson now here and also in
the resize function I decided to
make a little amendment to the way I was
outputting the file
saving it to the server in the last
lesson I chose to just use image JPEG
which I showed proof of image JPEG
outputting a gif a PNG and a JPEG and we
were able to view those files and they
had the correct extension and everything
but I decided to make it more proper by
using the extension to evaluate which
function I should use to output the file
so if it's a gift I'm going to use the
image gif to output if it's in PNG I'm
going to use image PNG function to
output and if it's a jpg then I'm going
to use image JPEG to output it just
makes more sense so we'll change that up
a little bit we're doing the same thing
at the end of this function so after
image copy resampled which is a very
similar thing we did in the resize
function we're just running the code to
output it this this code outputs the
file to the server it saves it and
that's all she wrote
and you saw a proof of this code working
because this is the exact code that I'm
using on my server my server is running
PHP 5 right now
so if you're running PHP 5 on your
server it'll run exactly like mine does
if you're running anything less than PHP
5 you might want to think about
upgrading or ask your hosts to upgrade
you to PHP 5 get with the times man</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>