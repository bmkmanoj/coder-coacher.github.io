<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>2/6 - Web Intersect Friend Add System Tutorial PHP jQuery MySQL Social Network | Coder Coacher - Coaching Coders</title><meta content="2/6 - Web Intersect Friend Add System Tutorial PHP jQuery MySQL Social Network - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Khoury/">Adam Khoury</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>2/6 - Web Intersect Friend Add System Tutorial PHP jQuery MySQL Social Network</b></h2><h5 class="post__date">2010-09-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0i9KiUXQ_Hc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right here we are inside of the
first interact container which is has
the idea of add friend and that's the
one I put the question in see how it
says add first name last name as a
friend then there's a little space there
and next to that line there's a link
that just says yes now when they click
yes this is another one of those on
click return false links we're on mouse
down when they do press it we're going
to fire off a javascript function named
add as friend through that function
we're sending two arguments the first
one is this session logged in the guy
who's logged in ID using the session
variable the second argument is the
person who owns the profiles ID ok now
let's add this function called add as
friend and inside of this script tag we
can put more JavaScript let's go ahead
and borrow this function at the
beginning of it anyway let's make a
little note for ourselves here and say
function for the function is looking for
two numbers alright let's put that here
let's call this was in a minute add as
friend add as friend and we want two
numbers the first one is we can make
them say whatever we want here and that
will be the variable name so let's let's
just say a and B remember a remember be
remember those are going to be numeric
values ok we'll just put an alert right
here for testing make sure those two
values which is going to be the person
ID who's requesting friendship and the
person who they are requesting as a
friend so let's put an alert window to
pop up and we'll test that real quick
let's say remember with ID
space then put a plus sign here and put
the a plus sign double-quote
double-quote space is from member with
ID plus the B that's going to be the
other members ID so when this alert
window when this alert function fires
off it's going to show us the member of
the I the member ID of the person
requesting friendship and the member ID
of the person who they are wanting to be
friends with so let's test this out now
we'll ftp it all right let's refresh try
to add Alex's friend add alex son house
key as a friend yes and see there's that
javascript pop-up alert remember with ID
1 which is me is requesting friendship
from member with ID 351 which is Alex
you press ok and now you can continue
developing knowing that your values are
going in correctly ok let's go ahead and
comment this out that alert don't need
it and let's pop in what we do need and
let me explain what's going to happen
and I hope you're paying attention if
you don't know how to use jquery's post
mechanism to access Ajax functionality
you're going to learn it right now ok so
this is the code i just placed in and
let's explain it first we make a value
for a variable of URL the value is going
to be scripts for profile / request as
friend PHP that's a PHP script that
we're going to use to communicate with
this function to check everything or to
actually add them as a friend if
everything goes okay so we need to make
a folder in the system
called scripts we already have a script
folder I think we're going to make a new
one called scripts for profile we're
just the scripts for the profile will go
and some people like to put little gif
gif animations of loading sequences or
whatever to let people know that
something's happening or you can use the
actual add friend container and put this
text in it saying please wait there's a
lot of different things you can do I
like using the dot gif animated pictures
so eventually I might add one of those
but for now I'm just going to leave this
to where it will take away that question
and it will put please wait into the box
and so while they see please wait in the
box they should wait and it really is
split second as fast as all this works
it's split second so they won't be
waiting long they probably won't even
see that please wait thing they're very
long at all now here is the actual post
mechanism or post function and what
we're doing is we're sending this URL
this post function takes on parameters
so what we're giving it as parameters
URL and then in here we can send any
variables we like the request variable
has a value of request friendship the
member one variable has a value of a
remember that we're getting remember
one's ID using that a new member to
value is going to be B which is the
member who is requesting friendship now
when you say function data that means
there's going to be data coming back to
this page without the page refreshing or
anything and right here is where you can
execute code that will communicate with
elements on the page to change things so
what we're going to do is say the add
friend element that add friend window is
going to get HTML data that means it's
going to be HTML coming from this PHP
script data is going to show and fade
out 12 seconds
so it will show the results of them
trying to make friends with that person
without the page ever having to refresh
and that is how you can use jQuery to
very easily access Ajax functionality so
now we have to create this Boulder
create the script called the requested
friend PHP I'm going to do that now and
I'll show it to you and then we'll throw
everything on the survey and chased it
out okay here is that request as friend
dot PHP script that is living in the new
folder I created and that new folder is
here you'll see it's called scripts for
profile and there it is scripts for
profile alright what happens inside of
the script is those two variables that
are coming from this jquery post
functionality those two variables are
the members of the two member IDs needed
to make the friend request and request
this friend first thing you want to do
is get those two posted variables mem
one and mem to see they're being sent
there mem 1mm to you get those two
posted variables and then you can
cleanse them if you like filter
everything but numbers for security then
you have variable mem 1 and mem to hear
that is cleaned ready to go so you do an
evaluation say if there's no value for
mem one if no value for mem too then
echo ever missing data and then exit the
script keep in mind this echo will go on
to the profile page into the add as
friend container because we set it up
that way in the JavaScript here right
here HTML data coming from that script
is returned to the page in a seamless
sort of way so if that data is in place
it'll skip right through this condition
it will go to this condition if m1 is
equal to member to you cannot add
yourself as a friend that's what they'll
see this scenario should really never
happen and you can check for it in the
JavaScript here to make sure a does not
equal B you can give them an alert
instead of doing the evaluation here in
PHP ok so if those things two things get
bypassed and everything's ok then we're
going to include once to the scripts
folder since
are in another folder we have to jump
out of this folder using board / will
help you jump out of the folder will go
up into the scripts folder like normal
into the connector connect to MySQL file
once this line runs we're connected to
the database then we can do things we
need to do here so if the post requests
equals request friendship which it is in
that JavaScript function we're going to
query the database and we're going to
select ID from friend requests and note
that we don't have this table may just
yet I have to make this table called
friend requests and I'll be doing that
inside a PHP myadmin so you select ID
from friend requests where member 1
equals mem 1 and mem 2 equals member two
then you check the num rows on that and
if the numbers is greater than zero you
echo out you have a friend request
pending all ready for this member they
must approve it when they view their
request list then you exit the script
that means they already have a pending
request for that member already they
don't want to you don't want to have
multiple pending requests for the same
people you know I'm saying so if that
one gets bypassed and that's not an
issue then we go on to this code where
it's checks to see if there is not a
request pending where profile owner is
not already requesting this viewer that
means unbeknownst to you this person
that you're on their profile has already
requested friendship from you and you
have a friend request from them already
that you need to go and check into proof
so we select from firm requests where m
1 equals mem to at mem 2 equals mem one
we just kind of swap things and check if
the other guy has requested his
friendship already then we echo out this
user as requested you already go check
your friend request in your profile exit
all right so that's kind of like ever
checking to see if there's a pending
request for those two people already in
the friend requests table and remember
the friend request table that we're
going to build in just a second is only
prepend aquest seeeeee we're also going
to put one field inside of our existing
table that way we can hold the array
which will actually be the friend
list all right so what happens is after
those two conditions make it by and no
errors are there that means there's no
pending requests and we want to insert
into friend requests m1 into field mem
one and field mem too that's what we're
going to name the fields in the database
I'm going to give them values of this
mem one variable in this mem two
variable and that's it that's when the
friend pending friend request goes into
the database then the next SQL query is
going to insert into private message
system this is the table I'm just going
to actually comment this out because
we're not going to be doing this just
yet this is going to be when we build a
private message system into the site
will have this send a message to that
person a private message saying you have
a friend request but since we don't have
that application in just yet will
comment this out and then uncomment it
later to actually send it in give them
give the person a private message when
they get a friend request that way they
were alerted to it and you just echo out
friend requests sent successfully this
member must approve the request so that
is it for that side of things and
there's a little more to the system like
you want to be able to block people so
you're going to have to act we're going
to have to add extra code for that
you're going to be able to want to
remove friendship so we're going to need
some more code to handle removing
friends from each other's a raise man
you still with me you paying attention
please type in the word oh sure i think
i'm going to add one more thing to this
friend request table so let's put a
comma here and let's say this will be a
field called time just call the time
date so it'll be a time date and a field
called time date which I want to put now
into so here are the values I can borrow
this little now down here
right there just grab a comma put it
right in there with those guys and the
values that way it'll put this time and
date if I make it a time date type field
it'll put this time and date that way we
can record when the friend requests
happened that way later on down the line
if you want to remove friend requests
that are like a year old in your system
you could just easily run a script to
find all the ones that are prior to a
certain date and delete all of them
that's why it's good to record the date
on everything when you're working with
mysql it's good to record now when
things happen now let's go make this
table called friend requests in PHP
myadmin okay here i am inside of PHP
myadmin i'm going to make a new table
what did you need to name it friend
requests that's going to be in the same
place blabbing and my members table so
friend requests number of fields I think
I only need three right 1 2 3 iron a 414
the ID go
now field one ID this is going to be for
the auto incrementing ID that's in most
every table you have so let's put this
an int no length value go all the way
over to auto increment click that index
primary now the next one when we have we
have mem 1mm to and time date we need to
throw in there mmmm to time date now
this time date field you want to be
daytime date and time so daytime and you
don't need a default value it'll do it
on its own let's good now ma'am 1mm two
are going to be integers there's going
to be numbers because their IDs
remembers but you want to lengthen a
value on that you can use 11 now let's
save that okay now we have our friends
requests table so insert into friends
requests m1 m2 and the time of day and
those are the values bada-bing bada-boom
if it fails you'll get an output saying
friend request insertion ever and when
we get the private messaging system
built into web in the safe then will
uncomment this query and give that
person a private message saying you have
a new friend request you better go check
in get some brains buddy alright so
that's that now i can ftp this up and
check since i have this table available
and yes yes everything good good good
while we're in PHP myadmin let's go into
the my members table we're going to add
something let's go into the structure
this is going to be very important you
done missed it is in here somewhere you
want to add something called friend
array so let's let's do that now under
youtube so we'll go to here too after
you to add one field go
we'll get to name this field will call
this friend array text actually this one
if you wanted to hold the most amount of
friends you would use I think long text
here right there medium text will hold
more than just regular text text holds
ten thousand i believe medium text holds
got some big huge number long text holds
an even bigger huger number i'm going to
go with let's just go with text for now
because I don't see web intersect that
actual site people getting over a
thousand five thousand ten thousand
friends if it gets to that point I'll
change this field to medium text and I
can hold that many it'll be okay now and
I might set a cap I might only let
people get a thousand friends or five
thousand friends who knows that way it
actually means something you know if you
limited to only ten friends it'll really
mean something people will have their 10
favorite people from your site in their
list at all times but you know it's all
the way you want to do it alright so
text you don't have to put length value
or net I think everything is good to go
on that save now when friend requests
are accepted you have this friend array
field ready to go it's a text field you
can hold a lot of texts a lot of text in
that array okay you want more medium
text you want a lot long text now I can
finally FTP and test this script and
this javascript ajax functionality here
okay now I've ftp the files up and I
already requested friendship from Gabe
so I know it's working and i'll show you
now I'll prove it let's go to some other
portion let's go to Erin
and add as friend just click yes it said
please wait for a brief second there and
then it said friend request sent
successfully this member must approve
the request and then it fades away you
can see that we're all set so if I try
to add as friend again it already has a
data in there telling me my friend
request was sent successfully but five
minutes later if i refresh and come back
or whatever and I try to add them as a
friend again let's see what happens it
said please wait you have a friend
request pending all ready for this
member they must approve it when they
view their request list and if he tries
to add me at this point it's going to
tell him I already requested him and
it's going to instruct him to go check
his friend list that's exactly how it
works and so all we have to do now is
allow people to accept those friend
requests so that means making a list so
when I go to my profile I need a link to
my friend requests the way I can check
my list so stay tuned for pot nama tree
now i'm going to make sure</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>