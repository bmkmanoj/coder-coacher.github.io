<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Feature Extraction - Machine Learning #6 | Coder Coacher - Coaching Coders</title><meta content="Feature Extraction - Machine Learning #6 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Roshan/">Roshan</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Feature Extraction - Machine Learning #6</b></h2><h5 class="post__date">2015-02-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/HuDIbSCnsqo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone and welcome to the series
about machine learning this is part 6
and it's about feature extraction we'll
be working with the feature extraction
from Tex so when we have a text-based
feature that has like a sentence or
maybe a whole document and you need to
do a classification or regression solve
an classification regression or
clustering problem using this text
feature I will so how can you do that
it's one of the most common ways to do
it is to analyze the text by splitting
the thick's into words and count how
many times each word was used in a text
or a document this may sound they may
not sound very useful but with the large
amount of text this can build a fairly
accurate classifier so let's do that
actually
that's the stud first we'll import some
required libraries I'm importing pandas
for data analysis Alex Alex ml for
parsing XML documents and in part the
importing count vectorizer
this is how we'll export or extract
features from text using trade this
split just to split our data set into a
training set and the test set and then
finally I'm importing multinomial naive
bayes classifier then I'm just ignoring
the warnings because there is some
depreciation warning that might annoy
yes so let's start by fetching three RSS
feeds from Reuters I'm importing
fetching their business feed a news feed
technology a sports using request to
fetch that that I'm using an XML
III object to parse this into a into an
e 3 object basically and I'm using utf-8
unicode encoder to do that so let's
fetch our results so this is a small
function that basically prints out a tag
inside our XML document so let's start
with our let's start with examining this
C document we have a tag called RSS
version 2.0 and there is one child
inside that one child tag inside it so
let's look at this tag a channel and we
can see inside channel we have title
link description a lot of other tags but
if we go down we will see that we have a
bunch of item tags in here if we use
XPath to retrieve one of these tags I'm
just gonna access one of them number 0
and I will print that I can see inside
this item there is a title which is the
articles title link to the article
description of the article the
description actually goes all the way
until here we have category publishing
date GID
etc so what we want to do is we need to
get the title description and finally we
need to get the category sorry the
category so this is what we are doing
here
I have three lists one for title
description and category looping over my
documents and in each document
I'm getting all item tags
and looping over them as articles and
extracting the first tag the tag zero
type two and type three which are the
title description and category so let's
do that
finally I'm putting them all and you
know data frame panda's data frame and
you can see we have title description
category and we have 60 articles
basically we can see that we have twenty
business news articles we have another
twenty technology news articles and we
have twenty sports articles let's do a
little cleaning up for the data we're
interested in the description so let's
display that let's actually display only
one of them so we can take a closer look
and here you can see that we have this
beginning of each article and it just
shows where the article was written and
that's not really useful information for
what we want to do and we have a lot of
HTML code whenever you want to visualize
HTML code a quick dirty trick is just to
copy the code go to a tag use the HTML
magic and you have your HTML code you
can see that we don't need this
beginning and we don't need any of the
pictures or links here in the bottom so
let's filter that out the way to do this
as loop over all our descriptions and
get a substring from each description
that starts after this thing space there
space and it ends at the beginning of
the first tag so if we look at this text
here
you can see it will stop in here the
beginning of the first tag so let's do
this I'm saving the cleaned-up
description inside a new column called
short description you can see that short
description has now basically the same
description but it's cleaned up and we
can see that all of them process just
fine
so let's extract features from this
short from this short description the
way to do that I'm getting all my short
descriptions I'm passing them into a
vectorizer and then this vectorizer
basically will create a matrix with the
columns representing each words and the
rows representing each article and it
will just put there how many times each
word was used in a certain article so in
here we have 60 rows by 809 columns
representing 809 words in our vocabulary
basically and 60 articles and you can
see this article has this word was
mentioned once and this article this
article has this word was mentioned once
don't know exactly what's the word but
we can transfer it back and read back
the words so this is basically our
vocabulary now and this will be the
feature less that will be used for this
practice you can get from your
vectorizer
the feature names so these are the words
in your dictionary just trimming them to
25 words because it's a very long list
of words you can see about abroad abused
except etc
the second thing I want to do is process
the results the categories
so I created a results variable that
holds all the results from this table
sports or news or technology and I used
a small category dictionary to translate
to map these three words and to three
numbers 0 1 &amp;amp; 2 so we can see in here
that we have a corpus size of 809 words
multinomial naive bayes classifier first
I'm splitting my my features and my
results into X test X extra exists and
why train why test for training and
testing the classifier second thing I'm
doing am training
a classifier with extreme and white
train and checking the score of this
classifier I can see my class my score
is 83% which is fairly accurate this is
our actual categories and these our
predicted categories here let's just
print the dictionary again so we can see
what happened here you can see one
technology zero business and two sport
so business technology of sport you can
see that technology what was predicted
correctly
correct correct you can see all of the
all of these were fine and here it
predicted a technology news as business
and here's one again technology news as
business we can do some manual testing
for our classifier and here I have a
text
who won the Super Bowl and vectorizing
this text and passing it to our
classifier to predict what category
would that be and it shows us it's
Sports News
this tutorial is available open source
on github and it's viewable on mb viewer
feel free to use this for any text work
that you're doing I hope you like this
you'll subscribe to this channel and you
will watch the previous part in the
series about pre-processing or then
expert about pipelines thanks for
watching and hope to see you next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>