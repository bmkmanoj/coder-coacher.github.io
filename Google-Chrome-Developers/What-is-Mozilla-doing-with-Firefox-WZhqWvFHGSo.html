<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>What is Mozilla doing with Firefox? | Coder Coacher - Coaching Coders</title><meta content="What is Mozilla doing with Firefox? - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>What is Mozilla doing with Firefox?</b></h2><h5 class="post__date">2015-09-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/WZhqWvFHGSo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">yeah I wanted to talk to you about what
Mozilla has been working on lately in
the area of WebRTC and what's coming up
next so let's start reflect a pretty
basic example of how do you make your
video connecting to a remote site you
basically do your getusermedia call to
get to ask for the permission to access
the camera which gets the nice prompt
and if the user allows it then you get
the video stream and then in your
JavaScript code you connect that to the
peer connection for the for this
presentation we don't worry about the
the the far end of this so here's like a
little bit of sample code which
obviously doesn't work like that but
just to give you an idea as we heard
earlier before you want like a video
tech to locally render the video you
just got from the camera so people can
like basically check that the camera is
actually correctly pointing at them you
instantiate your peer connection then
you do your getusermedia call and if you
get your your your stream and their you
first attach it to your to your local
video that basically renders your your
preview and then you attach the tracks
to your peer connection that's the
normal scenario so what we have been
working on is use a canvas as a video
input for peer connection
hopefully the the web developers here
will be will be familiar with the canvas
for the voice of you guys it's probably
like a more new thing so yeah basically
what it allows you to do is to take a
canvas instead of a camera and it will
you get like a video stream out of it
and you can connect that to your pro
connection it's supported in Firefox 41
which is I think is in beta right now if
you want to try it out it's right now
it's what we call pref off so you need
to go into about config and like switch
user preference to turn it on but we're
expecting it to be live in Firefox 43
which is I believe hitting the market in
November just to go back to the to the
previous slide so
basically in the picture we just
replaced the the camera with a canvas as
the video input so this would be like
well you could like draw on the canvas
right and there at the far end would
would see what you're drawing sample
code we no longer need a video to attach
it because the canvas is going to be
rendered anyway locally in your browser
and so the the new thing is basically
this what I highlighted in red is the
the capture stream function call you can
tell it to how many frames per second
you want that's the the 15 and out you
will get like a video stream and then
you attach that video stream to your pic
connection as as we have done before
with the of the regular getusermedia
call to make it a little bit more
interesting we can do again music
getusermedia call first from the camera
get that video stream connect that video
stream to a canvas do some little magic
on the canvas take that video stream
from the canvas and attach that to the
peer connection so that's what I'm going
to to demo now let's see
and I'm not like brave enough to
actually do this with like two browsers
and remote and so on so this is all just
locally in my Firefox so here is just
just a regular canvas on the left side
that's a pure connection to myself with
the remote video being rendered here on
the right side and so I can grab this
with cloth here and like basically it
transfers as the video to the far end
which is nice but yeah I mean the more
interesting demo is actually the one
where we have the local preview we know
we have the canvas and the remote video
so if I do share my camera here so now
my video gets first in the canvas
inverted and then sent over to the far
end and I can play around and like
change the colors pretend that I'm on an
old TV or like for the for the real
geeks like turn myself into an esky
thing you can find the links to these in
the in my
like at the very end there's also a link
to an actual demo which does exactly the
same thing but with like two different
browsers
basically uses PHAs to do it for for two
browsers just watch out that the actual
PHAs 0.3 the official one currently
doesn't work with Firefox use the one
from Skype Skyway they have fixed it so
if you take if we take this a little bit
further I think this is where it gets
really interesting you can basically
take your canvas and like for example
take multiple cameras and all attach
them to the canvas and then you stream
off from that one canvas to the loop you
connection or you take your local video
and your screen share and mix them
together in the canvas and stream that
off to the far end right so one of my
colleagues basically use this this
feature recently in a meetup in in Oslo
to turn Firefox into an MCU so he
basically ran and headless Firefox on
Amazon ec2 and had an MCU which was able
to do video mixing for up to eight
participants probably not what you want
to use for like for scaling your service
but like for quick demoing pretty nice
so yeah I think this is actually one of
these pieces were like web RTC it has
actually a big advantage over like
what's what has been referred earlier
here to as the voice of AP technologies
because the canvas stuff the AP eyes are
like well known well supported in the
browsers and if you would have want to
do the same thing and a voice over IP
installation it would have meant like
writing tons of C++ code deal with
desktop phones whatnot right here you
just like we did the work for you of
like okay get a video stream out of
canvas and you guys go have fun with
like whatever you can do on a canvas it
will get streamed to the far end right
so yeah that's I think a pretty cool
feature which is hopefully going to go
live soon and the second part of my
presentation is about other upcoming
features so you can get get thinking and
become
rate of moron a little bit on a
technical side we added ipv6 support the
FX basically is our internal
abbreviation for Firefox so that's like
that comes with Firefox 42 opposed to
Google it's not worth the prep so it's
on by default we will see how that flies
we added support for Ice TCP in 41 but
again this is pressed off so you need to
go to about config and switch the press
if you want to play with it we're
probably like going to turn it on either
and Firefox 43 or 44 what that means is
if you if I make my test calls in the
office now I basically for like a like a
call of audio/video and the data Channel
you get like easily over 50 ice
candidates which is like yeah
interesting interesting to debug
interesting to watch upcoming audio
features so we're spending quite some
time on improving the the performance of
the audio stack in in Firefox basically
means for example like garbage
collecting as was optimized and the
whole we're probably going to like
rewrite lots of parts there to prepare
for for more features for example the
the stereo support it's going to be
coming hopefully in the in the Firefox
43 actually the actual stereo support is
already in currently we're only the only
piece left us the opus codec which right
now it's I mean it's not the codec
itself is just the way how we use the
opus codec is that it does only
everything in mono so that's the only
remaining piece - before we before we
can you can really test it yeah we are
increasing the audio from 16 kilohertz
to 32 kilohertz to further improve the
audio quality and then another feature
we're working on is like audio capture
for screen sharing probably again in
Firefox 43 this is probably going to be
like screen sharing first and then
application sharing and temperature
probably comes later I don't know which
which version exactly more upcoming
features as we started working on
simulcast even though it's not not final
the spec yet
I just heard that's what the the
controversies in in Seattle I actually
don't want to know about it
we're working on apply constraints for
getusermedia that basically allows you
to for example if you make your
getusermedia and ask for like the
highest resolution from the camera you
were able to get you can go and like say
apply constraints and like I want like a
lower resolution video scream right now
right so like basically if your
application for ever reason like you you
shrank the video or like you figure out
that there's not enough bandwidth or
whatever you could like basically shrink
the stuff down locally already and safe
maybe CPU time or bandwidth or whatever
we edit in Firefox 43 a bunch of new
prefs
and and abilities to basically control
how your ice candidates are going to be
exposed to the JavaScript so that's in
that comes in Firefox 42 we just
yesterday published two blog posts about
that and you can find the links in the
in my attic and another fun one is that
in Firefox forty-three we're going to be
removed the most prefix from peer
connection so we have already like
getusermedia is already on Prix
unprefixed in Firefox for quite some
time
you just have to do the media devices
get user media so peer connection is
basically the piece left which still has
a prefix and so we're going to remove it
soon basically stating how how we think
how stable this whole solution is that's
that's about it any questions
questions just give me one second get
your microphone so when you add a new
feature like the canvas capture is
generally the path to push that back
into the web RTC standard so that all
browsers will support it or are there
there's that's based on a draft which is
again similar to to simulcast it's
basically being actively discussed and
it's not final yet we just went ahead
and like we had we got like lots of
demands in the community and so we just
went ahead and implemented the draft
which also means that potentially at the
API could still change but it's like a I
think a fairly small API and not as much
worried as with simulcast and in general
I mean as Mozilla comes up with new
ideas and cool new stuff is the idea
that all of it will become common or
that there will be some Mozilla value
add maybe in some areas of cool new
functionality well I mean we're an open
source company so we cannot keep
anything private for us like whatever
whatever we add like you will be able to
find in our source code anyway but in
general we cooperate with like the
Google guys about all of the by party
stuff pretty closely so yeah the chances
of Firefox having like a pretty unique
really WebRTC API based feature I think
is pretty slim we have time for one more
anyone in in the back since uh no all
right so the video mixing is interesting
is there a delay in combining into
canvas and what's the performance that
are the requirements for the guts of the
machine I have to be honest I haven't
done any any performance measurement I'm
I'm pretty sure there's a performance
penalty as I have said like my colleague
restricted his his MCU demo to eight
that's where you figure out was the
biggest that that Amazon ec2 instance
could give or handle for him but yeah
you probably don't want to try this with
like with tons of
tons of things so that's what I said
like you don't want to use it for for
doing your professional video mixing but
it for like little demo purposes might
save you some bandwidth might save you
some some time but yeah you would have
to I would anyway probably recommend to
like double check it on your machine if
I would tell you like some some
performance numbers there is no
guarantee that that will be the same for
your machine right so wait thank you yes</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>