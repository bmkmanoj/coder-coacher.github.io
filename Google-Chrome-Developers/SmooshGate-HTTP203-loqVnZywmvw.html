<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>#SmooshGate - HTTP203 | Coder Coacher - Coaching Coders</title><meta content="#SmooshGate - HTTP203 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>#SmooshGate - HTTP203</b></h2><h5 class="post__date">2018-05-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/loqVnZywmvw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">can we have like a pile of paper so
every time you can go like no news there
we go oh well I guess we should it
describe what actually happened
yeah I might might actually not be clear
to everyone that let us know smoosh gate
and actually know what it's behind us so
mootools Mutual's is one of the the
ancient javascript libraries which
modified the prototype chain and they
had things like array tooling and
probably uh some other things as well
yes like pre jQuery yes I would say or
it's think you're at least right yeah I
mean it it was very similar to prototype
which was definitely jQuery so they were
modifying we're adding things to array
objects and loads of stuff so in now I
thought so we had a raid up flatten is
the proposal that tc39 made and it's
like at stage free and we spoke about it
a couple of episodes
yes Lamas I think I seen one of the
Christmas ones but the problem is is
mootools
also had a radar flattened mm-hmm now at
first I thought the problem was that you
know they were doing if not a radar
prototype drop flatten and then they'll
add their own which I think that are
doing they're only oh this is the thing
and because I because I went into the
the Mewtwo's code in the mootools code
and they are overwriting that method no
matter what but then arrest the problem
because this is the thing that's the
right thing to do if you well if you
must override the prototype if there
isn't a spec to follow then yeah you
have your daughters or conditionally yes
because otherwise in the future
something else comes along with a
different behavior and has taken and
taken over your namespace I was under
the impression that it conditionally no
the real problem is is even more
interesting than that and it's not
nothing to do with code that calls array
dot fan if this is where we would cut
for the next episode if we wanted to
retain more viewers you
well steam yes tune in next week to find
out what it's actually on so they had
this thing called elements which is sort
of representing essentially an array of
elements
it said this thing that same it
underscored us we say like underscore
parenthese and it wraps an entire array
so it could very well okay like that I
mean it's it's only what jQuery does
okay are the jQuery elements that much
it's sort of sort of inheriting from any
sort of kind of yeah or it's got its
array like and what they had a bit of
code but you know to save time they
thought well this elements thing it's
kindly we want to be behave a lot like
an array so let's do a for in loop of
all the stuff we've added onto the array
prototype okay okay yeah so if you do
array dot prototype dot foo and I set
that to a function or something that
becomes enumerable if you do a for in
loop that is that key is going to appear
okay yeah but if you do array dot
prototype sort and set that to a
different function
it remains not in neural because
properties already defined as an unknown
enumerable property exactly interesting
that's what happened is by shipping
array dot flatten it became non
enumerable so they're added method was
no longer showing up in this foreign
loop so it was no longer being added to
their elements object and so those
people who are using the wrapped element
couldn't call flatten anymore couldn't
golf despite unconditionally overriding
the prototype exactly so that's
interesting so because they define
because TC certain I wanted to ship
flatten it would have removed the
function from the people relying on
neutrals yes that is very unintuitive
interesting and I knew that was a
surprise to me that it would remain non
enumerable really because the property
exists you just defining you're
assigning a new value yeah I can make
sense I suppose it does make sense but
when I read that I was like oh yeah okay
so that's why the first intuition was to
not ship tc39 s flatten is flattened but
under a different name to just avoid the
whole clash it was like a
twit up all done by someone in tc39 yet
of like what should we do here should we
break the web sure you call it smoosh or
shall we change like the how the our
implementation works to match new tools
also soft anything exactly because they
were already unconditionally operating
it and that's why I think that I have
some sympathy for people who were
confused by it because I was confused by
it that was very confusing three four
days I mean technically it's still going
I think at the time of recording there
still people going really yes I'm only
options is to rename the the flattened
efforts is something that let's say
smoke smoosh and speakers the joke one
but it was a pee offer it so there yeah
that's its dad a joke I don't know I
think that's I I think that was an
in-joke that sort of leaked out
maybe turns out bit her buzz my private
exactly yeah it's not a place for in
jokes and and so people were kind of
angry at this ridiculous method name
yeah
to be fair I think in name it hasn't
shipped yet and was an unreasonable
amount of anger I think some people felt
it was a done deal and it's not it's
still absolutely maybe that's where the
confusion came was the most drastic to
fear weekly but when as a PR to actually
change the method name it's reasonable
to think that it wasn't merged I would
be like right right that's fair enough
so yeah so that so the options really
are rename it or break the web and there
are a lot of sites in the top 1,000
sites that are using new tools whether
they're using elements not flattened we
don't have the data for that yet I think
we're Irish has had this like 1.8
percent or something
well that was using new tools yeah so we
don't know that they're using them of
course but at least you can see that
mood holds despite its age or want to
look at it and it's still fairly on
fairly many page loads exactly so it's a
big risk and we have seen big sites
break or Firefox so this ice break in
their nightly with flattened shipped a
lot of people are saying well you know
new tools is stupid for doing that and
then some people are jumping to move
tools defense going well we didn't know
back then and that's a lie we did
I was writing JavaScript libraries back
then and a lot of us who were writing
libraries which didn't touch the
prototype were shouting at the libraries
that were going this is going to become
a problem really some profit yeah but I
mean we saw it happen with prototype
they had get elements by class name and
that big that clashed with a real node
eventually so we knew this was a problem
so yeah I think same with like array has
contains and class list has includes and
like the contains includes and has or
something these the triple of these
functions completely inconsistent
because of other libraries hogging that
name in the past yes so we have string
contains are often a string includes and
is for exactly the same reason as smoosh
as the flatten like it's the same bit of
code in mootools cause the Muto's i
didn't know that it's the for in loop so
I so mootools is wrong a for messing
around prototypes but be the biggest the
way they are completely unsubdued what
they think it does yeah because it's
it's not catering for the idea that
methods will come in later and change
the ability of properties right we can't
punish musel's for this because if you
break the web you're not punishing new
tools you're punishing the users on
sites I think I thought I had this idea
and I would like to call it and quirks
mode right oh so okay so what would your
new trigger be for the if you include
mood holes you are in quirks mode so
that has been considered and that is
really on the table to some degree well
because we've done it before it like
document to all document all is a thing
that works but if document dot all
returns false it it doesn't yeah you
know is yeah document dot all inside an
if statement will be false II
interesting even though it's an object
with properties and because this is
because a lot of code would branch on
that kind of thing yeah and and this is
the part where my memories fading a
little bit died I think you were using
it as a branch for ie
okay I could or not I can't
the it was used as a big assumption of
the browser which was no longer true
so in odd for browser to support
document dot all four sites that were
store using it but didn't want to be
part of those if statements that's why
that was introduced so it is possible
that we introduced some kind of similar
hacks oh boy yeah that if you overwrite
a red dot prototype dot flat and it
becomes enumerable it's a horrible hack
but it and it's it's that would be
really silly but but it would break less
sites then the other way around
yes but it just means that when you
teach JavaScript to someone you have to
go oh by the way if you over at a
property it remains its enumerator wait
for the web's like French at this point
you have rules but you have more
exceptions so the rules then go ahead
yeah right and so maybe it's I think a
new one is not bad but the alternative
is we just come up with a name a new
name that's yeah it's not a silly smooch
it's not flattened or not smoosh exactly
do you think we have I just feel like we
have baby abled baby on Mabel
the library is Babel right Lisa
pronounceable that's the official no
because I'm quite upset about that
because it was always like that word was
always Babel to me yeah because of
Hitchhiker's Guide to the galaxy that's
the way the Babel Fish yep yeah the
Babel Fish</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>