<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Accordion: TL;DW - Supercharged | Coder Coacher - Coaching Coders</title><meta content="Accordion: TL;DW - Supercharged - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Accordion: TL;DW - Supercharged</b></h2><h5 class="post__date">2016-07-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hw4mo7EALOw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome to this supercharged
TL DW last time Surma and I made an
accordion not the musical kind her that
would be weird no instead what we made
was a UI element let's take a look at
what we made so you can see on screen
here we have a bunch of panels one two
three and you can see that they're
sliding up and down now you can also use
your keyboard as well tab and arrow keys
and so forth as well let's also look at
the performance side I've got the
timeline here in dev tools open if I
click around these panels you'll see
that each one of those clicks there's an
animation and if we zoom in it's a
comfortable 60 frames a second lovely in
green no red markers they're working
really well so how do we make it well as
we get into that of course there's only
one place to go for this discussion yes
yes Theory corner hello my friends
welcome to Theory corner now his asset
at this time we have a bunch of panels
and by default what we're going to do is
we're gonna leave those well alone
sounds odd but if JavaScript doesn't run
we don't want to lose this content so
we're gonna style based on the fact that
javascript is running so if javascript
isn't running for some reason these
panels will just stack up okay if
javascript is running we're going to set
a flag on the element which is going to
cause the panels to reject into this
format where we have them kind of
stacked up like this and the other
things that we need to do is as you
click on a panel header we're going to
slide that panel into place for this to
also work we want to make sure that all
content that's kind of outside this box
is hidden so we use overflow:hidden and
we want to make sure that the content
itself only takes up this amount of room
and anything that's longer than that
would need a scrollbar fair enough okay
let's go and have a look at the code
welcome back let's look at the code have
you ever noticed how you never have
heavy metal and an accordion GG row
never works out so let's look at the
code
itself now the code is quite interesting
overall and if you've got time
definitely watch that livestream it's
about an hour long but there's bugs and
there's loads of stuff and loads of
discussions some brilliant questions
from the people who are watching the
livestream so it's really worth catching
that if you can but there are main
things that we can dive into and
actually have a proper look at and the
main thing that I think we'll start with
is the attached callback we're using
custom elements here for the accordion
and the panes you can see that actually
in the HTML it very quickly
there's the accordion and then each of
those panes is in there with a header
button and the content itself so let's
look at the accordion again so what are
you guys attached what we do is we ask
for all the panes and then we calculate
the geometries the geometries is
basically how tall is the header okay
and then we figure out the available
height based on the total height of the
accordion minus the number of headers
we've got and that's the amount of
content space that we've got when we
move the panel's around and we set up
set up everything what we want to do is
you want to make sure that we've set the
the pane content height to be that
available height so you see over there
the flower that's the available height
that's where that bit is so we want to
make sure that all our pains have that
available height perfect when we see a
pane that has the aria-expanded
attribute then we jump down because
that's the expanded pane so we need to
make sure that all the other content
stacks up below it fair enough
all good so we've done that in the
calculator on trees move panels then we
set up some event lessness for handling
clicks and handling other things and
then we basically set this attribute
which is active and that means that the
accordion is now ready for business and
we can get going but maybe you're
wondering how in fact do you do the bit
way you click on a header or you select
it with a keyboard and you hit enter
what happens then
glad you asked here to answer your
questions indeed so we have to jump over
to the SC pane JavaScript for that and
all we have in here really apart from a
couple of getters is this attach
callback and when you click on the
header inside one of the panes we
dispatch a custom event now if you've
never come across custom events before
there
what they do is they act like a normal
event except that you get to name it and
you get to set things like whether it
bubbles or it's cancelable all that kind
of stuff here we're using one called
panel change and we're gonna say that
it's bubbling up through the Dom which
is great because we want to delegate the
handling of the panel change up to the
accordion element itself in which you
will notice in the event listeners event
listeners here there's this panel change
same name great and then there's this
Dom panel change which involves
basically stepping through all the
available panes telling them all to
collapse and then finding the one that
you actually selected and telling that
one to expand last but not least we then
call move panels again and move panels
is going to basically tell all the the
panel's you know where they should be
and basically by the power of
transitions on transforms what will
happen is as you tell the pain to be
translate why 200 pixels it's gonna go
down the screen which ultimately gives
you the effect that we saw before
so we're basically sliding panels around
the screen performed really well so
there you have it a prototype of an
accordion that is performance and has a
really good foundation for something
like accessibility now don't forget that
you can subscribe to the channel and you
can watch the live stream it's about an
hour long but there's loads in there
great discussions bugs bug fixes whole
heap of things and I will catch you of
course next time now I know it looks a
bit strange
click it and subscribe also live stream
over there that's worth watching bugs
and everything</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>