<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Web Components for VR (Polymer Summit 2017) | Coder Coacher - Coaching Coders</title><meta content="Web Components for VR (Polymer Summit 2017) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Web Components for VR (Polymer Summit 2017)</b></h2><h5 class="post__date">2017-08-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/8GmTu2JF4-0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I have 16 minutes to talk to you about a
topic that usually takes university
students half a year to grasp and that's
computer graphics basics but hey virtual
reality is cool so let's talk about it
real quick um and the clicker is not
clicking that's not a problem I have a
keyboard oh you're my clicker now
awesome so um when it comes to creating
web content in 3d the thing is that you
have to deal with very different things
that you're usually dealing with you
have a bit of Dom a bit of JavaScript
with a CSS hoorah that's your web
application however in 3d and graphic
things are slightly different so one of
the biggest problems of getting started
with that is there's a lot of lingo a
lot of terminology that you have to get
behind and this is an excerpt from an
actual tutorial for beginners and it
reads obviously it's not the start of it
but still it reads this is passed to the
shader and used to calculate lighting
for the objects okay I think I get what
possibly I would have to research what
the shader is but okay lighting for the
object I get lighting okay I understand
it is the transpose of the inverse of
the upper left 3x3 sub matrix of this
object one of you matrix right obviously
um so I'd rather not click man you're
doing a good job don't worry all right
I'll just I'll just do it
the thing is in nor key um so I'm saying
we don't do that thank you very much
instead we are doing the following thing
click ah that's good that it paces me
should I yeah click yeah dude all right
ok are you're watching this now I
understand it we're basically doing
Morse code because if I click here it
blinks there future um anyway so so
instead we don't have time for that Shh
serious stuff ok so if you want to do
graphics we have to start with points
and because mathematicians are
very pedantic people they're like no no
no those are not generic points they're
vertices because that's where two line
segments meet and so we call them
vertices but they're points of our shape
but points really don't make shapes
until we connect them so we connect them
up to triangles by triangles well I
don't really want to teach a computer
every single shape there is so it turns
out that triangles are kind of like the
brute force method of graphics if you
use enough triangles you can approximate
pretty much every shape so the
convenience would be we only teach a
computer to draw a triangle and then I
can make every shape appear and then
some clever people build hardware that
actually figures out what kind of pixels
we have to color in to make that shape
look more than like a 90s like laser
show kind of thing so now we have a
shape that we can color in it's ready to
color in then we write a program that's
called a shader that actually determines
the colors for each of these points and
how it does that is absolutely up to us
writing that program we can use like a
normal color we can make everything like
green for instance or we can say make it
a gradient or we can use like we can
read pixels and colors from an image and
put that onto the triangle we can do
that and then we get a triangle that
looks like something like this for
instance great so that's 3d graphics but
if I look at that abstraction level I'm
like I don't really know how to build
applications with that right so I'd like
to introduce a little higher higher
level application or abstraction sorry
and higher level abstraction to work
with and so for instance think about
making a movie one thing that you need
to make a movie or a theater play for
that matter is you need a stage you need
a scene where things happen okay sure
then you need some props and actors to
actually go on to that stage and make
something happen because an empty stage
is not very fun to watch right so here
we are putting some meshes that's the
lingo that the 3d people use we are
putting some messages which are 3d
objects made from triangles connected to
faces and then shaded we put those onto
the scene and then we have something
that we can possibly film using a camera
the camera is only a conceptual things
like where am i from where am i looking
onto the scene and like because
different like I see the scene
differently than you guys see the scene
because we have different angles from
which we are coming so the camera
basically encaptured
it's that and once we have the camera
the camera would film onto a film or an
SD card or something we're not doing
that we are putting it in the web and
the web means there's a canvas element
that is really good for pixel access and
it gives us access to a technology
called WebGL so there's a WebGL API that
is really good at putting pixels onto a
rectangular area into your website and
that's the renderer we could
theoretically render with something else
we could use SVG or CSS or something but
we are using WebGL because it's really
fast and really optimized for 3d
graphics and then we have our content on
every device that has a browser that
supports it and that's pretty much every
browser out there because this
technology is around since 2011 works on
ie 11 works on edge works on samsung
internet works on what's the thing with
the doger servo so yeah all these things
basically supported iOS all good nice
sweet this is the code that you would
have to write to do that in vanilla
WebGL don't read that code we don't have
time for that it's terrible don't do it
luckily there's libraries like three J's
that abstract this away into the
application or abstraction layer that
I've just been talking about it's like
making a movie and here we have like
scene we have a camera we have renderer
and we have a box which is a mesh we put
the box onto the scene and then we have
a render loop that runs all over again
and basically just films the scene via
the camera and puts it onto the canvas
using the renderer okay that's better I
think but if you look into it we're not
only putting one thing on screen most of
the time so let's have let's do a little
thought experiment here so what if I
have a ship that has a captain and I
want to move around the ship then I have
to move around the captain as well as a
bit tedious so how about we make that
captain 3d model a child of the ship
model and if I moved around the ship the
captain kind of moves with it and then
maybe there's something else on the ship
as well maybe there's a table and on the
table there is a coffee mug and maybe
some binoculars in the map and if I move
the table on the ship the ship doesn't
move the captain doesn't move but the
table moves and with it hopefully the
coffee mug and the binoculars and the
math and all that kind of stuff so we
have to build a tree but that's cool
because we as web people are like really
good at building trees
so we're like yeah this is some stuff
that I know who you knows the Dom tree
huh and I now know who's like what's he
talking about I just check my emails
that's perfectly fine
it's going to be more visual in a second
so I thought well actually not only I
thought we have archeologic which is the
company that I work at so I we want to
make 3d content on the web and VR
content on the web easier for everyone
how can we make that easier because
right now you have to like write a lot
of JavaScript and AH it's tedious and
boring so how about we have some
declarative way of creating 3d content
and that looks to me as a web developer
that looks much much nicer to work with
I have seen and in the scene I nest my
elements I have my camera that has
attributes like position and rotation
and I can just rotate things around
things and I don't have to deal with
radians I just used degrees like every
human being does and then here we have
mesh okay there's a bit of
implementation detail I want to be able
to to specify the geometry which is like
the points and vertices and all kind of
stuff you know and the material like
color and how reflective it is and all
that kind of stuff I want to be able to
to manipulate that manually I also want
to load like 3d models and all that kind
of stuff so this is the API that we
dreamed off and when that came up in our
work
I said polymer is the thing so I built
it with polymer and now comes a live
demo and I hope that you're all with me
and how all your you know fingers and
toes and all that kind of stuff crossed
because it's going to blow up big time
right here we go so here we have a scene
that hopefully it's large enough to read
if not top lock so here we are seeing
like we have a three scene and in the
scene we have a camera and the mesh and
in the mesh we have the geometry and
material so what happens if I say for
instance I want to change the material I
want to change the color from green to
red and I do that and Ebola
my box is now red to be honest this is a
little super boring thank you
we don't have time for that um so that's
that's cool and nice and fine and all
and I can make like you know I'm a kid
up in the 90s so I go like Maya frames
and I make that green again because you
know green is awesome for wireframe so
yeah a green box and and what about I
can change this to let's say a sphere oh
that doesn't look like a sphere that's a
sphere well that is because of the
parameters here are saying how many
triangles is the first one is that it's
the radius so I can make that larger for
instance but then I use one triangle for
each of the sides and it's like it's not
very good so how about we use like 16
triangles and hey is fear appears so yes
that dub-dub-dub just we're not there
yet Jesus you are easy to impress and
I'll just remove that and pull out the
most dangerous thing ever I load from
the network yeah that's going to go well
um so there's a 3d format called G LTS I
it's like GL transfer format but like
it's called WebGL it should be WTF right
anyway so now it's like gltf that's what
we got I have a few really cool people
that I work with and one of them is
Madeline a calendar who's probably
watching the livestream right now and
she made me a 3d model because on
Twitter
two days ago someone's like I showed the
gif of that demo and he's like we do it
with a like polymer logo I'm like yeah
and I'm like hi Madeline I know that you
can do blender and 3d modeling and icon
so please and see she said yes so we
have a 3d model and I'm going to go and
give it an ID as well just so that I can
access it later on and I position it
into the screen so that we see it minus
five meters into the screen and that
should pretty much be it and there we go
a 3d model off of that and because we
don't have time for that
so um because this is a Dom API I can
totally go and say hey three Scene can
you give me an update whenever you are
rendering something so whenever you're
rendered there a frame please call this
function and do something and I'll take
a I know VARs out and boring but screw
you all no not logo I want an angle and
what I can then do is I can say logo
rotation equals template strings hoorah
because template strings are awesome and
I want to rotate it around the y-axis so
if this is my wife because I want to
rotate like that and I use plus plus
angles on each frame I increase the
angle by one degree and there we go that
was easy
now you can clap okay whoo okay tada
this is kind of like my my two-sided
slide if it would have failed I would go
sorry I I didn't know that was a picture
when I was young and pretty and now I'm
just old and the opposite of pretty
anyway um so moving swiftly on let's
talk about VR all right so the native we
are experience if you want to call it an
experience is you start by like googling
for something and then you download it
and then probably Windows has to make an
update or something and then you install
it and then it requests that probably
crashes your computer or reboot your
computer because it's windows no I was
just kidding um so basically you have to
download it you have to install it and
then you go into VR when I find that
bizarre because that feels like back in
the 90s I'm like yeah I remember that
like sitting in front of my computer
waiting until like a cd-rom has
basically vomited everything onto my
hard disk and then I could finally
install it and run it and have fun but
this is 2079 so I would like an
experience where I open my browser and
type in a URL and then I put on my
headset and then we're done right
because it makes so much sense and we
are living in the future
thanks to standard code with VR when
that VR basically gives us three things
first things first
it detects if there is VR hat where
available and that might as well be if
you're on the phone and you have a
daydream or cardboard device then it
goes like yeah this thing can probably
be put in a cardboard device for
instance and it also gives you a bunch
of parameters like how do you have to
distort everything and all that kind of
stuff
so it gives you this kind of information
and then it gives you information that
you really need because we're putting
the user front and center into our
application whenever the users turning
around their head we have to take that
interaction for like our achama or can
has to act to move the same as I move
around in the in the room I have to kind
of like update my camera to move around
in the room so it gives us this kind of
information as well hold the pose also
we have like hardware that is additional
controllers like the the daydream
controller the Samsung gear VR
controller HTC vive has them oculus rift
has them so you have controllers in VR
space and you want to have access to
them as well
so the vet be our standard augments the
gamepad API to actually provide you
access to this information as well and
when you have all that then you write a
bunch of code so here for instance we
are asking for the displace it resolves
to the promise because it's a modern API
and it gives you a list of this place
great you want to grab and hold onto a
reference of one of the displays if you
have one because then later on when
there's a user gesture so the user has
to explicitly say I want to enter the VR
mode now so for instance clicking a
button or something then we can ask this
display hey I would like to present what
I have on this canvas over here so you
can have multiple like scenes or
canvases and you can select which one
you want to render you don't have to use
WebGL but we are in WebGL are two
different things
it makes sense to use WebGL because you
want to render a lot of stuff really
fast but you don't have to necessarily
use that you can't render dumb content
unfortunately yet but let's see what the
future brings once we have that in our
render loop what we do is we are
basically asking for frame data which
means we are getting back like the
position and orientation our kind of
stuff then we are rendering two times
one for the left I want for the right
eye and when we have done that we submit
that information onto the H like on the
device that you have in front of your
eyes so we are sending this information
over so that you that the user actually
sees it there once we have done that we
are using the VR display
requestanimationframe because for VR we
want at least if we were like doing
proper VR then we want at least 100
frames per second now you know that the
requestanimationframe loop is usually
like locked at 60 frames per second at
best even though your hardware might do
better so here we get the native refresh
rate of the VR device so we can
basically deliver this information or
the graphics as fast as the VR device
can do it not as fast as our browser can
do it that's an important difference
even in three days that's a little more
complicated so we thought how about
we're making this really easy and all
the change in the code that I showed you
earlier on from our demo is I say allow
an AVR mode automatically which means
like we are putting a button somewhere
for you without you having to do
anything if there is a VR display if not
then we are not showing that button and
then we have a VR controls which gives
us like where's the user looking at and
then we put our camera into it which
means that whenever the VR controls are
updating they are updating the position
and rotation of the camera automatically
for us and that I think is amazing
because it's a tiny change to go from 3d
content to VR content if you're doing it
declaratively you don't have to deal
with any other than hi Harry
API things beforehand and this is like
how it looks like then I'm sorry for the
quality it's a gift and turns out gifts
are large surprise so it kind of like
you know you see that it automatically
like does the distortion or kind of
stuff so you don't have to worry about
that at all that's the the vehbi our API
at play for you however the the actual
reality coming back from virtual reality
is that it's not like that and you're
not going to find this project online
because there is as it turns out prior
art and there was Vernal in 1995 and it
was like standardized in 1997 and was
XML based and pretty heavyweight and not
really never caught on really that much
you needed a plugin into the browser and
oh my god but then browser vendors set
together in 2001 and said hey it's
freedom
yes it's pronounced it's freedom as an
XML extension for the browser that you
don't have to like install a plugin for
it still works in your browsers today
probably and gives you also the
possibility to like declaratively create
3d content and vr content but they're
not very good but then we found that in
2015 Mozilla put out a frame it has a
huge and vibrant and amazing community
and like beautiful wonderful dev tools
support it's really really cool it's
really vibrant it's the thing and it's
basically doing what we're doing just
better so use that but the good news is
this is a polymer conference so don't
worry polymer and a frame play really
well together thanks to the fact that
they are platformed
they're using the platform rather than
hiding the platform so here I'm having a
color picker and I'm binding the color
attribute straight to the color
attribute of my box so that's all that
it takes to do that really so yeah I
learned a few lessons and I'd like to
share them with you at the end of my
presentation
first things first just because you can
do the thing doesn't mean that you
should really do it because if I would
have done my research I would have found
a frame and I would have saved like
three days of working on the other hand
working with polymer is pretty amazing
because you get really good results
really really fast also you know don't
really have to reinvent the wheel all
the time so I mean I was like okay even
if the a frame exists we still have to
wrap it for you know there and it turns
out no that's not true
because actually polymer is really
friendly to integrate with things like
this they are all using platform API
they're using Dom events they're using
attributes they're using elements it's
really easy to kind of like put them
together and have fun right you don't
have to like very about it that you have
to wrap it into something it's fine and
last but not least use the freaking
platform because we have it and it's
awesome and with that I like to say
thank you very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>