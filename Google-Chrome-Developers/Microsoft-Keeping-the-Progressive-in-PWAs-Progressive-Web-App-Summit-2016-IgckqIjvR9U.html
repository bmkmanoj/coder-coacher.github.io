<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Microsoft: Keeping the Progressive in PWAs (Progressive Web App Summit 2016) | Coder Coacher - Coaching Coders</title><meta content="Microsoft: Keeping the Progressive in PWAs (Progressive Web App Summit 2016) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Microsoft: Keeping the Progressive in PWAs (Progressive Web App Summit 2016)</b></h2><h5 class="post__date">2016-06-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/IgckqIjvR9U" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Patrick feel free to call me
P Diddy no one actually does but I'm
here today to talk to you about keeping
the progressive in progressive web apps
um like Paul said my name is Patrick
hetner if you google me that's the photo
you'll find over there and despite what
my shirt and my cake have I actually
work at Microsoft specifically I work on
the edge team in the edge browser if you
guys are up-to-date on your news you
might have seen a couple of days ago one
of my co-workers Jacob Rossi released a
wonderful blog post called the progress
of Web Apps which is an awesome pun
hi-fives were all around when we thought
of that um and it's all about a
Microsoft's plan for what progressive
web apps can be on our platform and
maybe I'll turn it evinced all flows or
stuff like that it's a great blog post
the edge team has done a lot of
phenomenal work and we're continuing to
commit a lot of resources to the
progressive web app story but that's not
really what I'm here today to talk to
you about I'm here today to talk to you
as a web developer I've been a web
developer for a pretty long time but
when I started writing websites they
looked a lot less like medium and more
like that well that's not like that but
like that yeah hey that's mosaic and um
when I first started writing websites
like about Ninja Turtles it was just
kind of really exciting that we had the
ability to save a file and then someone
around the world would like open a file
and see it was just my mind was blown
that I could actually show someone my
ninja turtles and they would be excited
about it as much as I was not that
anyone ever was this is the first time
I've had an audience to show my favorite
ninja turtle but um yeah I was just I
was hooked at a really young age
basically and it's been such an exciting
experience being able to be a part of
the web community and kind of see it
evolved to win like dhtml was introduced
do you guys remember that woo yeah PPK
you know it's who the the wired redesign
where we showed that standards were
actually a really good thing and you can
make some really awesome websites that
didn't need table layouts and you know
CSS Zen garden the responsive web
article by Ethan Marcotte you know
there's all these big stages in web
development these kind of
seminal moments where things changed and
they never ever really went back and so
a while ago I was sitting at my home in
Seattle and I heard about this kind of
really new exciting way to make websites
one that would use the latest web
technology that was you know safe and
secure and would use the same encryption
that our banks and e-commerce used and
it would look and behave exactly the way
that Apps did and one of the most
compelling features being that they were
easy to release you could just change
the code rather than go through this
really complex update process that
anybody ever developed on an Android or
iOS app and you know how painful yeah
it's kind of painful to release anything
and in preparing for this talk I was
thinking about how far we have come you
know in the last year you know all the
different amazing progressive web apps
that have been created and have been
shown and I was just really thrilled at
how far we had come since Steve Jobs
talked about all this in 2007 at WWDC
when he introduced the original iPhone
and all of the web apps that came with
it you might not remember that but he
actually did and that there was a great
collection of web apps that worked well
for the web nine years ago we actually
just passed the nine year anniversary of
it it was the middle of June 2007 and
eight years after that about a year ago
from now Alex Russell had dinner with
his wife Frances and they came up with
the concept that we now today call
progressive web apps he penned it the
next night and it was you know what
brings us here today and progressive web
apps are finally that fulfillment that
we have been promised for nearly 10
years on the web the idea that you can
have this rich native experience that
leverages all of the users device and we
have gotten some really really beautiful
wonderful examples of what that can
really be like stuff like the Flipkart
api the flip card redesign flip cart if
you're unaware completely shut down
their mobile website and then a month or
two before Alex's article and brought it
back with an amazing reference
implementation of what progressive web
apps can be the Washington Post had
their recent progressive web app demo
that is incredibly fluid incredibly
slick they have 80 millisecond load
times on new articles it's it's it's
wonderful
one of probably the best reference
implementations air horn or comm of a
progressive web app it works across
I've yet to come into a device that it
doesn't work wonderfully on except if
you don't support Web Audio I guess but
you know I was sitting there and
thinking about how how it was amazing
that we could finally do all these
things on the web and something as
excited as I was something wasn't quite
sitting with me right now it wasn't the
sites themselves the teams that made
them are wonderful they do incredible
work but it was more of the way that as
a community were sort of focusing on
progressive Web Apps it wasn't the sites
it was it was this it was that we're
sort of thinking of them as standalone
applications that are created wholesale
for the mobile web and what's been
presented isn't really the mofo I mean
this is a better example of the web and
I mean that's the again Eric Horner is a
phenomenal app and you know it's even
then like err corner or sorry not ironic
progressive web apps in general and how
we've thought of them including err
Horner isn't just like this there's more
than just this I'm sure you guys are all
aware that last year Google announced
that mobile search had taken over
desktop search for the first time in
history it's been well over a year now
and that's true Mobile is the future in
India China Africa any emerging markets
Mobile is where people are going first
but if you think about what that is
saying that it's just now surpassing
desktop that means that there is still a
huge non-trivial part of the web that is
still the desktop people use computers
even though we spend a lot of our time
on mobile there is still a lot of people
my parents included never hardly touch
their smart phones they touch their
desktops at work and there's a lot of
content in a lot of ways that we can
introduce progressive web apps and the
ideas behind them the API is behind them
to produce stuff other than just new
wonderful mobile experiences but
wonderful web experiences because
progressive web apps are not just a
radical new way to create sites they are
so they are also radical new way to
update websites you as booking.com
showed you can take pieces of the what
make up progressive web apps the new API
is and update your existing app have
something that is a really compelling
experience and I like to go over a
couple of
ways that I've myself and my team have
come up with them recently first of all
the app manifest if you I'm we've
mentioned it a number of times so I
assume everyone was at least paying
attention at some point when we talked
about the web app manifest it is
basically just a big text corpus it's a
JSON file it has a whole lot of metadata
about your website stuff like the
language the direction of the text a
description for like search engines an
array of different icons that might be
used where you want to start the
orientation a whole lot of stuff like
theme color just a lot of different
metadata about your website you can also
include related applications ways if you
also for those few that raise their
hands because they have helped to work
on an iOS device you can actually
support a user being able to
automatically jump into a native
application if that's what your company
wants you also have the ability to say
prefer related applications hopefully
that's always false and the great thing
about the web app manifest is to add it
to your web app today or your website
even all you have to do is this it's a
link rel tag it's a simple line of HTML
you just plop it into your web site and
the great thing about a link rel tag is
that there's no feature detection needed
you just add it to any web site today
and it'll parse in mosaic - it'll work
everywhere if your website doesn't
support manifest it's fine it ignores it
it skips right over it but you can add
it and Hance everyone's experience right
away something that kind of bothered me
when I started looking at the manifest
first when I compared it to the websites
I've worked at is that most of that
content that's in the manifest file is
also in my HTML already it's just a
little bit different and so I created a
tool to try and help people transition
into using the manifest as soon as
possible
called manifestation it's available on
NPM and it does a lot basically what it
does is it goes you give it a URL and it
parses the HTML of that page and
generates the most comprehensive
manifest file possible an example of one
of the things we do is for the language
detection it will go ahead and load up
some node modules it will load the page
in cheerio which is like a server-side
jQuery it will check for the Lang
attribute on the HTML if that doesn't
exist we'll check for the XML
language attribute if that doesn't exist
we'll check for the Dublin core language
attribute anybody ever heard of that no
one has but it exists and so we parse it
yeah you have prayed librarians yeah and
so if none of those exists which is
unfortunately a common experience we
actually fall back to Google's compact
language detection where we'll load up
the entire text of your page throw it
through the tool that is powers google
translates language detection and we'll
try and get the result out of that it
detects a hundred and forty languages
roughly or a hundred and sixteen
languages and it's pretty reliable
unless you're using a more obscured
language it almost certainly results in
something it's only ever broken when
I've tried to break it not on live web
sites and finally we grab all that stuff
and return it more complex check is like
the icons check I try and get every icon
anyone has ever referenced on their
website ever you'll notice that the
amount of modules that I use barely fits
on to a slide and rather than go into
the logic I'll just go over what it
covers the favicon favi favicon I've
never said that out loud the that ICO
file it'll download it parse it check if
it's multiple ICO files inside of that
one because that can be you know
multiple icons within the one file it'll
also download it automatically if you
don't have one declared on the page from
the server's root it obviously gets the
Apple touch icons all the different
sizes available for that it even
downloads the MS application tile image
which I'm sure everyone has on their
website and or even the config inside of
that where we had where you can declare
a tile image it checks every possible
place you could have a tile and then
some now to make this even easier I
actually created a website web manifest
I have you would pronounce that and if
you go to it you'll get this ugly
website that I made in an hour that is
all you do is you insert your URL and
then you'll get a pop-up dialog that'll
give you the web manifest file you can
add it to your site right now and as
much time as it takes you to deploy a
single line of HTML you should do that
today and your journey to creating a
progressive web app has already begun
hooray web manifest also has a couple of
cool short URLs if you're interested in
the spec it is pretty neat about slash
validator will give
you Google's web web cache manifest
validation tool if you want to modify
what we give you
there's also slash spec which will give
you a hot link to the specification now
moving on something called service
workers I'm not sure if anyone's ever
heard of this because Google doesn't
talk about it that much but it is
actually a really cool part of
progressive web apps now like I
mentioned I am a web developer at heart
I work for a browser but most of what I
do is from a web development perspective
and an example of that is I'm actually
one of the lead maintainer for
moderniser moderniser com had a redesign
about a year ago now and the biggest
change between moderniser 2 &amp;amp; 3 was us
going completely modular every single
detect became its own module we had
roughly 262 I think we're up to almost
270 now individual detects along with a
couple of dozen options modules the idea
basically is every single time you check
off anything on that page although you
get a dependency but that dependency
might have sub dependencies and sub
dependency it goes on and on and on and
the problem is that a single module that
you might be adding might be might be
triggering dozens of requests on the
network and that really sucks if you've
ever traveled or used hotel Wi-Fi by
chance you can know that if a website is
doing a whole lot of network activity
it's going to be a really really crap
experience and so we used a
serviceworker to try and speed that up
and our serviceworker implementation was
super simple because we didn't need
complex content generation or anything
like that we just needed a really simple
cache and so we have two different
sections our prefetch cache where we you
know list a whole lot of files that we
want to download in an array that
prefetch checksum and then we open up
the cache when we load the page and we
add all those files to our cache and
then they're available instantaneously
these are files that every single user
is going to have stuff like our icon our
CSS that's shared across browser sorry
across the users it's available
everywhere then the second part is again
really simple on our fan fetch we check
to see if anything that that's being
requested is already cached something
that was in our pre cache and if it's
not we trigger off a new request we
check to see if it is in our cache if
it's not we fire off a new request and
grab it from and then cache that
response later on this is that trust the
cache
hit the network after it works really
well for us because we only ever need to
update files when we do or release and
so we can just update the hash file on
our serviceworker the next time we have
a new file to change we can just
everything in the cache will be
invalidated so it it's a really simple
serviceworker and something that works
for a lot of websites that I helped the
only problem was serviceworker if you
can call it that currently is it support
obviously Chrome and Firefox have it
shipping this is actually a couple of
months old I apologize but the and it's
coming to edge which is awesome and
hopefully to all other browsers that
people use on Apple products and it will
be really exciting when it has there but
it's not there now even though we're
lucky to have most of our content or
most of our content being served to
Chrome and Firefox as a developer
focused website it's only about 75% of
our traffic that support service workers
which is great it's average better than
the average about 50% but it's not
everybody and that isn't acceptable I
can't serve a crap experience to 25% of
my people and so I did something that
you were kind of told to never to do I
used app cache and now it was don't yell
at me yet it is a douchebag I'm not
saying it's not if you've never watched
app cache douchebag from the J's comp
2013 it is a wonderful talk and it will
help educate us to why everyone hates
app cache if you've only ever been told
that app cache is terrible it's great
serviceworker is much much much much
much better than app cache and app cache
is going away on top of that it's
already deprecated in the HTML 5.1
specification but it covers our use
cases and on top of that it's available
basically everywhere every single
browser that you'll probably ever
counter will do that it's like 90%
there's almost nothing on can I use
that's 90% it's out there and so if you
keep in mind the problems without cache
and you're aware of all the problems you
might hit I think it's okay to use it
it's a douchebag but it can be like that
douchey friend you have that you have to
have in high school until you can get
rid of them
and so in order to use it it's a really
simple check obviously we want to use
serviceworker if it's available and so
we'll do it simple check for
serviceworker in navigator if it's there
we register it if that's not there we
check to see if application cache
in window if that does we at the
appcache if you've never used app cache
which seems pretty common if in order to
add it to the page it's an eight-day
attribute on the HTML element
it's that manifest attribute you just
pass it a URL to your app cache manifest
file and the problem with adding it by a
JavaScript is that it's a little bit
complicated that manifest attribute has
to be there at page load time you can't
dynamically add that attribute and have
the app cache take over so in order to
add it to the page we had to do a little
trickery we create an iframe that is
hidden with a the source is a file
that's just a really lightweight HTML
page that just has that manifest then we
append it to the page so that file just
looks like this that's the entirety of
the file and we we register it you know
in that iframe container and then it's
available on the page instantaneously it
works really really great in fact oh
sorry yeah actually this is what a
manifest file looks like but basically
that prefetch section that we showed in
our serviceworker cache we're able to
shove into this section for app cache
manifest that's stuff that we know for a
fact every single user is going to want
and going to need in order to use our
website and it's able to function now we
now have over 97% or 98% of our website
works completely offline and it took our
website from 20.7 seconds on non
serviceworker stuff when i from hotel
Wi-Fi down to 190 milliseconds on reload
app cache is a douchebag but it can be
useful if you know what you're doing
just pay attention know the problems
watch that video and check it out it can
be useful for the short time until
service workers are available everywhere
the next thing I'd like to talk about is
web workers now web workers are not a
part of progressive Web Apps in the
traditional sense but they do enable one
of the most important parts and that is
keeping your applications fast now
web workers have been around for a
really really long time they were added
to WebKit back in 2008 which is insane
it's been almost that long
it was version 2 of Chrome when it
looked like that I mean it's it's it's
been around for a really really long
time and for some reason every time I
talk about it I generally get this
reaction from people it's like
Herta webworkers but I have no idea what
they do or why like anything about it
and so web workers if you're unaware
solve a really basic problem on the web
and that is that it's single threaded by
default if you've ever tried to create
like a scroll handler we tried to create
one of those really super cool like
parallax websites and then all of a
sudden everything gets terrible and slow
and janky like almost all of them you'll
know what I'm talking about it's because
everything fights for CPU time you can
only be doing one operation at a time
and so if you ever try and do a lot of
calculations at once you get a really
really janky experience and it ends up
being a really terrible user experience
so what web workers allow us to do is
offload tasks to a background thread
a we're basically able to take stuff
that would be too expensive to run and
still have 60 frames per second and be
able to generate a much faster
experience by having a go in the
background you lose access to the Dom
you lose access to most web api's but
just about anything that's pure
javascript in calculation that has to
run can be done without a problem
as a result super expensive functions
become really really really cheap you
can able to do some crazy stuff that you
would never imagine possible on the web
without completely getting like this
spinning beach ball of death or a blue
screen of death or any other kind of
death that you might imagine um
and it's completely fun you get 60
frames a second it works great even
better web work is like I said 2008 it's
green baby like it works everywhere just
about anywhere you can run JavaScript so
basically not Opera Mini guaranteed you
can run a web worker and if they work
phenomenally well one of my co-workers
Nolan Lawson created pokedex org it's a
great example of a progressive web app
if you haven't checked it out before I
highly recommend it and one of the
really cool things he did here I'd use
virtual Dom of virtual Dom is sort of a
smaller version of react it's the idea
of being able to take a virtualized
version of the Dom and then when there's
changes you're able to do a diff of
those changes to get the smallest number
of JavaScript actions that have to
happen to make that change that's what
the concept is what makes react super
fast it's coming to uh it's in embers
glimmer engine it's coming to angular 2
you have the ability to use at an
angular 2 rather the really interesting
thing that no one did was that he used
virtual Dom inside of a web worker he
used it to do all expensive
daaamn diffing he did that inside of the
web worker then responded over the
postmessage api back to the website as
far as what changes need to be made it
would make the Dom changes and then wait
to send back what changes need to be
calculated again as a result he was able
to run at 60 frames per second on a
Galaxy Nexus this is from 2011 a phone
it's nearly 5 years old and he is
getting just phenomenal experience on it
it's awesome just about anything so you
might be thinking you might be not do a
whole lot of calculations on your
website but you'd be surprised if you're
not getting 60 frames per second debug
your JavaScript in your dev tools find
out what bottlenecks are and see if you
can do some off lot some off thread
calculations it makes almost every
website I've used it on much much faster
and it's in criminally underused on the
web you can find out more of a Nolan's
website on its open source and it's a
great implementation it's available on
github
it's nolan lawson pokedex network the
last thing i want to cover because i'm
running short on time is index DB index
DB is another api like web workers that
have been around seemingly forever
mozilla was one of the first
implementers back in 2010 and that's a
yeah i think was like chrome version 5
version for a firefox that's been around
for a really long time and if you've
never used index DB there's probably a
good reason for it
it's that you have other things that you
can possibly use that make a lot more
sense local storage I'm sure most of us
have checked out before it's local
storage that's that item and get item
and it just works it's synchronous it's
simple you cloud stays clean this is a
similar thing in indexeddb it's hurts my
head really hard to read that there are
cursors there are transactions if you
come from a database background if your
DBA then you might understand this and
you are way smarter than me and I don't
know maybe I can hire you to make me
something work better but it is very
confusing to me and it's really
difficult and on top of that index so
when you're presented with the concept
of using index DB for something a lot of
people are like well I can just use
local storage or app cache or
document.cookie or any of the other
possible web storage things that are
available on the web there's 15 16 17
different ways where you can try and
store content and index DB you
comes one of the more complicated ones
and therefore one of the less used ones
and that's a shame because there are
wrappers around x wrappers around
indexdb like dex ejs which give you this
really super clean in a amazingly
beautiful promise based API and you have
the full ax you have full access to
index DB all of the content that you can
store in there you can do through this
beautiful promise based API it's like
the jQuery of index TV it's beautiful if
you like local storage style
implementations there's local forage
from mozilla and it gives you literally
rather just change the st and storage to
an f and local a you have local forage
that set item local forage get item it's
got packed by indexdb and it works great
nolan the guy who created that pokedex
implementation created a thing called
ouch DB and it's a full couchdb
implementation that is works off of
index DB and the great thing about all
these things is that they can fall back
to web sequel something that is
supported in browsers even older and
then Firefox for you basically just
about any brow fallback to web sequel
they'll fall back to local storage
they'll fall back to in memory so all of
these libraries have phenomenal browser
support because they are able to run and
because they take into account that
we're not necessarily planning on these
you know cutting edge browsers in the on
the mobile space they want to run as
many places as possible and if you use
one of these and you get and you start
to plan around using index TV you get
storage that is way higher than most of
us even realize you can store gigabytes
of data and indexeddb on the desktop
with it with a G not an M not anything
else gigabytes of data I've created
demos of podcast apps where I'm able to
offline sync dozens and dozens of 120
200 megabyte episodes completely offline
and have it work fine and it works great
now that storage didn't guaranteed to
stay around constantly it's not it can
be deleted by the browser if the user
runs low on space there is that
persistent storage API that Ben Kelly
mentioned that is coming from Google and
hopefully all other browsers in the near
future but for stuff that Kim just
helped to be worked offline that just is
better if it's offline media content
even just static caching of your assets
on browsers that don't support the full
cache API there's tons of stuff indexdb
can be used for today and it works great
on top of that if you're if you've never
checked out web storage there's this
awesome thing called the breath a
browser storage abuser that's made by
one of the Google guys and it's
available online and you're able to see
just how much storage you can you can
shove into the browser basically and all
the different types this is going it has
file system API the file API indexdb web
sequel local storage session stores all
this types of stuff I'm requesting five
gigabytes right here without a problem
I've gone up to 200 gigabytes on my
laptop and it's never once complained it
works great the quota API can explain
more about that it's available at this
URL
and yeah I just I can't say enough about
why aren't you guys checking out indexdb
you can store so much phenomenal content
you can make your websites scream if you
store your assets offline and you don't
have to wait for the cache API you don't
have to wait for the new api's and all
browsers to be there this is stuff that
you can do on a slightly crappier API
than what's available but have it
available to all your users today you
know I guess the point of what I'm
trying to get across is don't wait for a
Ryoka tech chure to start using these
features you know just check out what
fallbacks exists
check out what you can do to create a
similar experience something that you
want to be in the future today because
most of the time those things already
exist you know don't be afraid to use
the new things in the web if it's only
if it's a feature that's only supported
in one browser don't wait for it to be
everywhere you know feet do feature
detection x' fallback to things that if
they're if you're able to and have a
great experience today make awesome
websites and make your users you know
love the web as much as we do you can do
phenomenal things with the web if you
start pushing the limits I would love to
see more and more experiments that bring
app like experiences to the stuff that
is you know years and years old Steve
Jobs said we could do it so let's show
them that we were right about the web
now like I said my name is Patrick
Kettner that's my handle pretty much
everywhere on the web that's also my
email on Microsoft I'd love to hear
about anything other than Internet
Explorer feel free to contact me it's a
great great time the edge team is
awesome I'd love to hear you guys as
feedback or questions or complaints
about anything thank you very much and
I'll be in the code lab later if you
guys want to talk
for breast enhancement thanks for having
me</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>