<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>WeakMaps - HTTP203 | Coder Coacher - Coaching Coders</title><meta content="WeakMaps - HTTP203 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>WeakMaps - HTTP203</b></h2><h5 class="post__date">2017-12-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/18MRkysjsC0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so do you know no good
next topic so you know how JavaScript
has now this primitives like map set and
week map and all these like little nice
data structures to build things yes I
wanted to build something with a week
map yes I'm week maps are great they are
underused but great we should say like a
week maps are a way of associating an
object with another object and see you
already said that and this is where I
was already wrong because I just wanted
to have strings mapping to obvious my my
concept was I must have a list of cheese
strings you know I and I want to map
them to objects but I wanted to allow
these objects a get garbage collected if
necessary which is the purpose of a week
map you can have them in this map but it
does prevent garbage collection so we
have this so I should say that one of
the good use cases for this is that we
used to put like if you wanted some data
associated with a Dom node say we used
to use like expand dos we should just
like Dom node underscore some data we
got data attributes in the end but what
if you want to be objects or something
and a week maps a great way of saying
this object that I don't really want to
edit because I don't own it's the
prototype I want to associate with this
set of data right do own yeah and then
so then if that Dom node goes out of
reference cuz it's like removed and you
know nothing's got access to it then
your object as well can be garbage
collected if it's not reference to it so
this is what I was wrong it's not about
the values not being garbage collected
but the keys not being garbage collected
yes so you get to you get to keep your
access your ability to access the value
as long as you have the key and that's
why strings don't work yes because it's
a well and it's a true for numbers as
well it's true for all primitives yes
you need to have all we're always I
found out that you need to have an
object and understand why but I guess
this is where my mental model of the
weak net was wrong because I thought the
keys are just keys but the values could
get garbage collected even if they're
still in the map but it's
the keys that still can get garbage
collected yes they're in use in the week
map and you use your key to unlock the
door to get access to the value you see
Oh Monica Monica is amazing yeah yeah
I'm one of the things that I've always
been baffled by is like weak set yeah so
one thing that need a bleep map nor weak
set half so I guess it just as many
clever saying you know the keys can get
garbage collected great excellent that's
true that's crammed in the set it's just
a set the no thing can be in the twice
but also doesn't prevent garbage
collection yeah it's a matter if only
keys but neither of them are iterable
right because that would expose garbage
collection and that and that's a rule of
the web for reasons I don't fully
understand but it is a rule that we
don't want to expose that for some
reason do you have a use case for weak
said no so I think I figured it out have
you ever used a weak map where you know
the key is an object something we used
to we'd map release I know you know I
well I look great by the way the value
is true so I which is a common practice
to emulate a set exactly and I had this
and I and this is because I've been
thinking for HSI or week set it's
useless and I had a piece of code where
I needed to I needed to tag a request
object in that like I've dealt with this
request object or visiting response or I
want I want it to say I want to say I've
had this is from it was a response I
wanted to say this is from the cache and
I snide with just using an expander
underscore from cache equals true and
then typescript complained and so I
thought good do this properly okay oh so
I ended up with him acting where the
value was true and I stood back and
fortnight's is not a weak map this is a
weak set I might actually have to use
this because my current approach to what
you just said basically marking elements
as having been processed already is the
expander thing but instead of using
underscore something I use symbols
because those are guaranteed not to
clash so it feels sick oh yeah but this
one is arguably better right because
your your
keeping the separation of data yeah and
at some point like the symbol thing or
it's possible that typescript will start
complaining about yeah and I just often
mainly the type and type to go and say
like this thing is now on this type
right okay which is what I did as well
and I want it to not do that and yeah
and so that's something if you want
that's just so she ate a piece of data
there you go I will try to refactor that
I learned something today yep
become a better developer although to be
honest that is probably something that I
would expect to be in reacted somewhere
or like any framework because I feel
every framework it has some kind of
upgrading mechanism like you have Dom in
me to what did we call hydrated or do
any kind of processing on Dom it's like
we are now aware that this is not only
Dom but this is tied to a react
component for example yep this is where
this would come into play so this is
something that hyper HTML uses so we
were talking about this in the last
episode if you've got like a sort of
hyper HTML calls it a wire but it's kind
of like a partial so you've got a list
element and you've got something to
create list items from like an object
hyper h2 i'll wants you to use an object
you'll give it an object that it will
associate that set of data with and so
usually that will be an object you have
that represents the array of things so
that means that if stuff like you know
when you go in and that's how you know
how it knows you're modifying existing
list rather biotin yeah uses use a week
map and it means it doesn't leak memory
because as soon as your object goes that
reference so does hyper html's cache so
I think yes we is like there a little
bit of the unsung heroes of the
JavaScript the egg musket what is it
I echo script but sometimes it's
JavaScript did you get dragged in by
people's accents yeah Google being in
San Francisco whenever we go out there I
find one weekend I'm like yeah yeah is
that like I'm like totally until I stole
you there yeah what accent I was trying
to do there it's one of the ones you
ever know people they can tell the
accents apart is like it was totally
American</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>