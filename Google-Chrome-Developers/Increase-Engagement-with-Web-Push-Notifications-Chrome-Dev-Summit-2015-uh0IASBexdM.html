<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Increase Engagement with Web Push Notifications (Chrome Dev Summit 2015) | Coder Coacher - Coaching Coders</title><meta content="Increase Engagement with Web Push Notifications (Chrome Dev Summit 2015) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Increase Engagement with Web Push Notifications (Chrome Dev Summit 2015)</b></h2><h5 class="post__date">2015-11-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/uh0IASBexdM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">good morning I hope that all of you I
hope that all of you can understand me
today and maybe I'll get some help with
translation from my friends over at the
side um so my name is Owen Campbell
Moore and I'm here to talk about web
push notifications and I'm a product
manager on the chrome team and I have a
clicker okay so the outline for today
first we're gonna be talking about what
are web push notifications and why are
they important and then we'll go on to
talk a bit about how do they work and
how can you implement them on your site
and then we're going to wrap up with a
sneak peek into the future of these
features and some of the new things that
we have coming down the pipeline but
before we start with what these are I
think it's important to take a step back
and ask ourselves what's the context in
which these features exist so this is
something that we've been talking about
a lot today the idea of the reach that
the web has and this is something we've
really come to realize in the last year
here you can see in numbers the average
monthly unique users for the top 1,000
apps versus the top 1,000 mobile web
sites and you can clearly see the top
mobile web sites have on average 2.5
times the number of monthly unique users
at the top native apps do but the
struggle is how do we take these monthly
unique users that we have on the web and
convert them into weekly active users or
even daily active users and this is
especially difficult in contrast to
native apps which really take advantage
of the capabilities of these mobile
devices like push notifications so this
is the question that we asked ourselves
how can we take this amazing reach that
the web has and combine it with the
engagement capabilities of these mobile
devices like push notifications is this
even possible and so I'm gonna try and
answer that with the demo which I know
is everyone's favorite way of answering
a question and the the thing to note
about this demo is that this was
recorded earlier this week running in
Chrome stable on my phone on a local
host server and nothing that you see
here is pre-release or experimental this
is all in production and working today
you could go off and bill
this this weekend and ship it to your
users on Monday so let's imagine okay in
that case I'm gonna just describe for
you what you would have seen demo gods
man let's give it a round of applause
for the demo gods please okay so what I
was about to show you is a experience
that I pulled together where I was going
to go online and look for some concert
tickets in San Francisco and I was going
to see that a band I really like was
listed on the site but they hadn't yet
announced when their concert was going
to be but the site had this new amazing
feature using web push notifications
where I could opt in to receive a
notification when the concert dates are
announced allowing me to buy a ticket to
go and see that concert so I would have
clicked through to accept the permission
to receive notifications from this site
and then you can imagine that I closed
off the site chrome is not running and
weeks or months later I'm kind of stood
in a coffee shop I pull out my phone I
see a notification it's from that
ticketing website and it tells me that
the tickets are now available on sale
for that band that I love and now I'd be
able to buy those tickets and get the
best tickets before anyone else and I
get to show that off to my friends so
that's really cool so I think this is
really the key here it's that web push
we believe allows you to take the reach
that you're able to get on the web like
we saw with all of those monthly actives
and combine it with the engagement
features of your mobile devices like
push notifications and I think this is
really amazing because when you think
about some of the most prominent
experiences on mobile today many of them
are social and messaging and experiences
where you really need this kind of low
latency notification as an enabler and
so that's been restricted just to native
apps in the past but now we can build
those kind of social and messaging
experiences on the web amongst many
other experiences like the ticketing
demo and so to talk a little more about
the potential of these features and why
we all really need to pay attention to
them
I'd like to have you all join me in
welcoming nature lost from Facebook to
the stage
okay thank you sir
cool hi my name is Nature Lawson I'm a
software engineer at Facebook and I
worked on Facebook's web push
implementation and I also work on
Facebook's use of new JavaScript
technologies and new things that are
available in the browser so as a mobile
first company the mobile web is a key
part of our overall strategy like you've
heard earlier today mobile first does
not mean native only you can't have a
complete mobile strategy without
investing in both the mobile web and
both native and many people might think
all right great
you're investing in the mobile web but
maybe that's taking away from a lot of
the growth in native or maybe you're
investing a lot in native and that's
going to hurt the mobile web but that's
not what we see the mobile web is
growing and it's growing at a similar
rate to what we see on native when we
see native grow a lot we also see mobile
web grow at the same time and when we
see a lot of people really engage with
the mobile web
that helps native just as much this is
especially true in emerging markets in
places like India where the barriers to
download an app are very high and it's
hard for people to like go through all
the steps the mobile web is even more
important and it's often people's
primary interface for an interacting
with Facebook and similarly with the web
overall the desktop web is an area of
continued strategic importance to
Facebook many people still use the
desktop web as their primary way to
interact with Facebook and it's an area
where we need to continue to make a
great experience and overall just
support and develop really well and
there are a lot of features on native
that we haven't been able to bring to
the web the web is great for many things
but up until recently it's been a huge
disadvantage to native especially with
when it comes to like reengagement one
thing we've known that is very impactful
on native for a long time is push
notifications it's great for people they
can see when they're missing out on
information click on it and go exactly
to where they want to go so we've really
wanted to bring push notifications to
the web for a long time and we
implemented a proprietary push
notification integration with both UC
and Opera Mini and it's been great we
saw a lot of the same wins for users and
Facebook that we saw and our native apps
we know that push is great and we know
that people want it and they want it on
the interface that they use the most so
just because somebody uses the mobile
website the most doesn't mean they
should miss out on
the great options that they get from
push swim we heard that Firefox and
Chrome and others in the web standards
community we're working on a
standardized way to do web push
notifications we're really really
excited it's an implementation using
that as well and we shipped a really
great implementation on mobile and we're
gonna ship our desktop implementation
really soon as well and as we saw in
other interfaces when we ship web push
notifications we see really really great
growth engagements it's great for users
because they get the notifications on
the interface that they're using and
it's really great for Facebook because
people come back to the site more and
are able to engage and this is a chart
that shows the increase in monthly
active users as a result of doing web
push notifications on desktop and as
with any really great growth chart it
just goes up and to the right so there's
just a lot of advantages from being able
to do web push and we're not the only
company that's been able to see such
really great growth wins from web push
to talk a little bit more about that
one's gonna come back up thanks Nate so
we're gonna try the demo once more I
think the the northern monkeys have gone
and tried some some technical jiggery
and we hope okay yeah okay so now let's
imagine that I've got in this concert
web site I'm looking to buy some tickets
to go and see a great band
I noticed methodical tactic they're one
of my favorite bands but I don't see any
upcoming concert announced but I do see
a new option saying that I can get
notified about future concerts by them
in San Francisco so I'm gonna go ahead
and notify me and this shows the local
host or the website it would be in
production want to send me notifications
that's great so now we can leave that
site and I can even kill chrome entirely
and forget that I was ever there now in
a couple months time I can be in my
coffee shop I noticed my pocket vibrate
and there I have a notification
appearing and with one tap and back in
and I'm able to buy the tickets for the
concert
okay and now back to where we were so
it's great to see these kind of results
from Facebook taking advantage of
features like this but it's not just
Facebook here's a stat from beyond Iraq
which is a online shopping company they
released a push web push on their site
and they saw a 50% increase in repeat
visitors within three months so this
just goes to show how impactful this can
be so this is all pretty awesome right
but how does any of it work so in that
demo you notice that chrome wasn't
running the site wasn't open and yet
somehow it was able to run some
JavaScript download some resources and
show a notification like how is any of
that even possible
given what we have today and the answer
magic okay so maybe it's not magic but I
think the theme of this summit is that
whenever you see something and you think
how could this possibly work like I just
don't understand the answer is almost
always serviceworker so it turns out
that serviceworker is this amazingly
powerful new primitive but when we
normally think about serviceworker we
think of something like this it's a kind
of small javascript file that we can
keep on the user's device and then when
a network request is made to our origin
an event is fired into it that we can
grab and we can generate our own
response and send it back down to the
page how does that help with our push
notifications the answer is that we can
actually flip this diagram around and if
we flip this diagram around we can
imagine a flow in which our web server
sends a request to a push service in
Chrome's case this is Google Cloud
messaging which keeps a persistent
connection open with the device now with
that persistent connection it can say
hey device go and wake up this service
worker so Chrome starts running it
starts the JavaScript context and it
fires a push event into it and so in
this way the service worker is this
amazing primitive that's giving us this
ability to do event handling
the background on the user's device but
in a very controlled way so the event
fires it's able to show the notification
and then we can kill it again
immediately so these things don't stick
around they don't take up your battery
but they they really provide a new bunch
of possibilities for us as browser
vendors and for developers to see what
we can do with them
so it'll be really exciting over the
next year to see all of the cool new API
s and functionality we can enable web
sites to have using this new primitive
of service workers ok so we've talked a
lot on a high level but this is a
developer conference right so let's see
some code so here we're going to talk
through subscribing for push
notifications so this is on the site
when I tap that notify button the first
thing that I need to do is have the site
set up with the push service registering
the Service Worker so it knows how to
wake it up later so I start by assuming
that the service worker is ready
installed on the device I'm able to call
navigator service worker ready which
returns a promise which will resolve
when it has the registration of the
Service Worker
ready to use and then with that
registration I can call push manager dot
subscribe and what this is doing in
Chrome's case is sending a message to
Google Cloud messaging saying hey I'm a
Service Worker this is my identifier and
you should know how to wake me up later
and you can see here that we're passing
in user visible only true now what does
that mean essentially the way that the
push system is designed today you could
send a push message to the device have
this push event fire in your
serviceworker and you could run
something in the background you could
start mining bitcoins you can you know
do whatever you want and just not tell
the user that something's going on and
obviously that would be bad for our
users and we don't want that to happen
so what you're saying here by specifying
user visible only true is that you're
committed that when a push event is
fired on your serviceworker you're going
to make a change that the user can see
so they know that your site ran in the
background you're going to show a
notification so in this case it makes
sure that sites are only running when
users know that they're running and that
you're using push to deliver
notifications not just to send an hourly
push to take up cycles on that computer
so once this resolves we're going to get
back a subscription so this comes back
for
GCM and is essentially an identifier for
the for the service worker and then this
is a function that you write yourself
that just sends that subscription up to
your back-end and then later you'll be
able to use this to send a request to
GCM in order to send a push down to the
device okay so that's subscribing to
receive push notifications now let's
talk through how we actually receive the
push event and show the notification so
this is the diagram I showed you earlier
about how the web server sends the
request for the push shoulder which
wakes up the service worker now it turns
out this is only mostly true and the
detail here is that when the service
worker event is fired it actually
doesn't have any context it's not given
any payload or any data from the push
message so this means that the service
worker wakes up without context and
doesn't know what it's supposed to be
displaying so the first thing that you
need to do is send a fetch request or a
network request back to your server in
order to say hey I'm awake what
notifications am I supposed to be
sharing to this user so let's take a
look at the code for how this works so
here we're in the service worker code
and this is our event handler for our
push message so in the push event fires
the first thing we do is we get this
event and so this this line is kind of
magic so event dot wait until basically
says hey I'm running in the background
in my serviceworker you need to keep me
alive you need to wait until this
promise results when this promise
resolves and done you can go ahead and
kill me this is how we get the
performance benefits and how we make
sure that it doesn't keep running in the
background on the user's device so the
developer calls event dot wait until it
then makes a fetch request to its server
to work out what notifications it's
supposed to be showing it passes that
into a JavaScript object and then using
that result from the server it's able to
use the show notification API and pass
in the information provided by the
server and that is what actually shows
the notification on the device so it's
been really awesome over the last few
months to see a bunch of developers
adopting this new capability and
exploring different UX they can build
with it and I think it's interesting to
share
some of those lessons that we've all
learned together about how to build a
good experience with push notifications
now some of these lessons came over from
native and some of they're entirely
original to the web so here's the one I
think is the most important thing make
sure that you're sending notifications
that users care about now is this is a
new kind of communication channel with
users I think the first thing that a lot
of us think is great I'm gonna vibrate
that pocket whenever anything happens
and take all my email and send it to
them as push notifications now I think
it's important first to ask yourself is
what I what I want to send them both
urgent and important because if it's not
urgent you probably don't want to be
taking them out of their context
vibrating their pocket and disturbing
them and if it's not important but it is
urgent then it's also not something that
you probably want to disturb them for
unless you think that it's very likely
that they're going to be interested in
it so take for example that there's a
live stream starting this is urgent
it's starting right now right but do
they have any interest in this live
stream is it a topic that they care
about
if yes and you think that there's a high
probability that they're going to go and
click and watch that live stream then
it's probably a good notification if
you're not sure or they might not be
interested sure it's urgent but it's
actually not important to the user and
the best examples of push notifications
are those that are both urgent and
important like an incoming chat message
from a friend or your vehicle is arrived
outside the building and you need to go
and get in it so those are the kind of
experiences we really want to be
building and another thing to remember
about this is that chrome makes it
really easy for users to disable
notifications from sites that they find
using it's family so if you start
sending notifications too aggressively
users are going to disable it and then
you'll never be able to send them more
notifications and take advantage of this
new stream so use it carefully the next
thing is not requesting permission on
page load so the story here is we first
ship this capability back in May and in
about June I was landing on the blog and
I saw a permission request pop-up and it
said hey this site wants to send you
notifications and at first I was like oh
this is so awesome a feature that I
built is you know real and people are
using it how cool and then the next week
the same thing happened I landed on site
and this permission popped up anyway
actually don't even know what they want
to send me notifications about and I
don't even really know what this site is
yet I haven't had a chance to take a
look around
so I think the key here is not to forget
the lessons that we've learned about
general UX make sure that users
understand what you're asking and why in
this case I think Twitter have done a
really good job of this where if you go
in the direct messages panel on desktop
you see a new section that says would
you like to receive notifications for
new messages and in the ticketing
example earlier there was a box that
said do you want to get notified when
these tickets go on sale and then when
the user clicks enable notifications or
notify me there's a lot of context and
they understand why they're being asked
to give permission so it's really
important to make sure that we remember
those lessons when building
permissioning flows because the
permissioning flow is a first-class flow
within our site just because the UI is
being shown by the browser doesn't mean
that we can forget the UX that leads
through that process the next thing is
making permissions controllables
this is again back to the fact that
we've made it easy for users to disable
notifications from sites they don't want
but you don't want them to do that you
want them to first go into the settings
on their on the site and try and control
what they do and don't want
so here Facebook have done a great job
of letting you go in and say I want
notifications for when I'm tagged in a
photo but not when someone comments on
one of my photos and this is a great
example of control that you should be
giving your users so this is a really
meaty topic now deduplicating with
native so you can see an example here of
notifications imagine I installed the
ticket now app and I'd been on the
ticket and our website and accepted this
permission request well now we're in
this difficult world where I might get
notified twice once from the app and
once from the website and this is a
problem that we're trying to solve and
there's no ideal solution today and
we're looking for kind of suggestions
and ways that the browser can help you
do this and new tricks that we as
developers can use to do this but the
best advice that we have today to deal
with this is two things firstly you can
use a kind of heuristic that says if the
users logged in on two different
platforms don't send notifications to
both of those platforms
if the device looks really similar if it
has the exact same screen resolution
it's probable
there's a mobile phone and you don't
want to send it to both so be careful
about that and the second thing that you
can do is when the user taps turn on
notifications in your site you can
actually fire intent into the native app
on your on the device and so if the app
is installed it'll open up the native
app and you can in there say hey
notifications are turned on you can
control them in this way within the
native app and if the app isn't
installed you can specify the URL that
the user should go to to complete this
opt-in process so again this is an open
area that we're working on and we're
looking for feedback and new ideas as we
go but these are some of the best
practices we would suggest at the moment
okay next is refocusing existing windows
so when you get a notification on mobile
from a native app and you tap on it it
takes you to that app and the app takes
you to the exact page that you're you're
looking for this is great now on the web
if you do this naively you'll just end
up creating new tabs and new tabs and
then in the taps which you'll see pages
and pages from the same site especially
if you're doing a low latency use case
like messaging so the key here is to
refocus the existing page that's already
looking at this site so if you already
have a window open on the device which
is on this site you should navigate that
to the to the new page and focus it so
let's look through exactly how you do
that first you in the serviceworker you
can use the clients match all API to get
a list of all of the active windows that
your serviceworker controls on the
device and then if there is at least one
of these clients you're going to go
ahead and send a post message to it
saying hey navigate to this new URL and
you have to receive that post message on
the other side and actually do the
navigation and then focus that client
and if it turns out that you didn't have
any windows open you can just go ahead
and open a new window the next thing is
to make sure that you're summarizing
your notifications no one wants to open
their notification panel on Android and
see that one app has sent them 15
different notifications or four
different chat messages within the same
thread so you should always think when
you're showing your notification you
should use the API to find out what
notifications already showing work out
how to group them and summarized in the
and then replace the one that you have
currently showing with the summarize
notification that the groups of all of
the interaction that's happened since
and the last tip I want to share is a
throwback to Jeff's talk which was
earlier today and you can find online on
YouTube about loading instantly so when
the notification is there you got to run
in the serviceworker in the background
right that doesn't mean you can just
download the notification contents and
show it you can also download all the
resources to show that page which means
when the user taps on it if you've built
your app shell correctly the page can
load instantly and the content in the
page can load instantly and you get this
amazing experience and it works even if
they're offline so if they get a
notification saying they have a message
and then they go into a tunnel they can
still tap on that notification and get
to that message immediately which is an
amazing experience okay so we've talked
about what these web push notifications
are and why they're important we've
talked about how to do them and how to
build a good experience with them so
finally I want to talk about what's next
what's coming down pipeline the first
thing I'm really excited about are
custom actions so here you can see this
notification includes my custom button
so you could set this to say whatever
you like and you can do what you like
when they use attempts on it open a new
page or just send a network request
change the contents of the notification
so you can imagine being able to build
entire experiences that work within
notifications so imagine that you've
gone on a an auction website and you've
set a bid on a product and then you get
a notification saying hey you've been
outbid but there's a button on it that
says increase my bid to you know X
dollars this means that user can just
tap that they don't even need to go back
to the site you can say great done they
can swipe it away and you've built this
entire flow all within the notifications
I think this is really powerful and
something that we're all gonna get to
play around with this is available in
chrome dev today so you can start
playing around with it and the next
thing that I'm really excited about is
payload so earlier you'll remember that
I said that when the push message is
received in the serviceworker you have
to make a network request back to the
server to find out what happened so this
is changing with payload support and
what this basically means is that
your site is going to be able to include
some data basically serialized JSON with
the push that it sends to the push
service and then that will be sent down
and included when the event is fired on
the device so you'll know immediately
what you're supposed to do and you don't
need to make the request back to the
server like you did before okay so to
wrap up since May of this year chrome
for both Android and all of the desktop
platforms has supported the new web
standard designed together by Mozilla
and Google and others in the web
standards community that enable web push
notifications based on service workers
web push is really fundamental to this
idea of progressive web apps and service
workers are providing this new
fundamental capability on the web like
we've never seen before and web push is
making real business impact to companies
like Facebook and beyond the rack today
and we can't wait to see what you build
with it next thank you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>