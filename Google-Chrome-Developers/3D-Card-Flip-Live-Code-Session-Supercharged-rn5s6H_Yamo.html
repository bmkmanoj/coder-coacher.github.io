<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>3D Card Flip: Live Code Session - Supercharged | Coder Coacher - Coaching Coders</title><meta content="3D Card Flip: Live Code Session - Supercharged - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>3D Card Flip: Live Code Session - Supercharged</b></h2><h5 class="post__date">2016-08-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/rn5s6H_Yamo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome to the supercharge
livestream I'm Paul and I'm sorry I'm
gonna tell me what is better than two
dimensions for let's make a 3d conflicts
hey awesome right so let's get started
yes 3d who does everybody looks 3d and
there's loads of people I already see in
there on the chair we've got people from
Austria Costa Rica and Netherlands
everyone hey welcome thank you
monitoring the chat so keep talking I'm
just going to try to keep up
and if you've any questions post them
there I'll weave them into the
livestream and see if we can you know if
you can change where this is going maybe
all right so I'm gonna dive right into
some code because that's how we want to
roll today you know everybody's busy
busy right bit of HTML those will drop
in a title we'll call the car 3d carpet
all right let's get some styles in there
so we need to link rel equals
stylesheet' href you have to fix the
limitation on the title I know it's gone
okay I know you're struggling oh you
fixed it for you so much better
dot CSS fine gonna go with that today
all right styles styles dot CSS CSS
there we go
so in the announcement people have
already said or at least there was one
comment saying that if a 3d card flip is
not much real design no and that is
correct it is because we just do what we
do we do what we think people want to
say and what we want to make and in this
case we thought people would want to see
some 3d card flipping stuff but I'm
there's gonna be some I think really
really interesting bits and pieces in
today because when you're talking about
3d you actually have to do a little bit
of a little bit of figuring stuff out
the other gonna use CSS transforms or
OpenGL they know what just I've reached
my goal for today you'll be thrilled to
hear my watch tells me how active I've
been I've just hit a hundred percent
because there's nothing like I did you
did some excessive typing yes I did do
it so a lot of excess Adobe obviously
just decided you know what if you want
to stay fit type more a live coding on
YouTube is one way to stress your heart
so I do that apparently
anyway right let's make a CSC card let's
go with SC card today why not you also
have the question is this real life yes
yes it is very wise in are we doing this
for real
live yes we are it is really lifelike as
I said keep posting questions asking in
the chat or on Twitter and we can answer
them for you life this how it works
all right let's dive into some I'm doing
that I'm doing that I've already got so
I'm gonna Chris Mullin I'm going to do
today going to call se card and let's
see we put a div here which we're going
to say class equals front let's do that
because we're gonna have a front of the
card and we have the back of a card so
we'll put say supercharged on the front
of this card div and then we'll do
another div inside it meaning you don't
have to do this way there's loads of
ways to do it just do class equals back
and I have sort of thought ahead a
little bit here yeah I know and we
actually how I made this little little
thing for the back of the card a little
super toy super judge graphic bear for
us to look good no I wish I had her so
it's fair game and I guess you would
change hair if possible they are right
so front of car back of card I mean I
want to do just kind of temporaries pop
a button on here and we'll say flip card
so that's fine it's not going to look
great but we'll just put it there for
now right so we've actually got some
markup let's go ahead and so I guess in
case someone doesn't really know what
it's really close if you're starting
with front and back what we're doing is
we're gonna have the card like you might
actually know from at your design and I
guess this is why people thought of
material design yeah this and we gonna
flip it over in 3d yeah so he's gonna
come out of the screen gonna flip over
and then drop back onto the screen and
we're gonna have to do some work with
like faking shadows and stuff as well
for it to look right but we can start by
having the front of the card in the back
of the card and then we'll work out when
the two plasmas will work our way from
there so we're gonna have to do a little
bit of styling to get this under way
though body let's say with 100% I
understand in fact I'm gonna have to do
that and the HTML as well
whatever's right do that
and then I'm gonna say that the HTML is
gonna be display flex today and it's
gonna be doesn't actually matter we can
icebox hardness a line item center and
then justify contents and I think that
does it
well they SC card and I'm gonna go
because I've already got this image so
I'm gonna make my card what is this it's
260 by 380 so I'm going to say my card
today is with 260 for what it's worth I
have done this kind of approach before
and you can make the cards responsive so
I am hard coding these values today but
this technique works even dynamically it
does get more involved but the the
concepts are the same I guess this also
makes it obvious that this is not the
production-ready code it's like that we
probably gonna repeat in all future
episodes as well yeah this is more about
the techniques on how you achieve
certain effects without dropping down to
2 frames per second because you can
easily shoot yourself in the foot if you
use CSS the wrong way but if you want to
do something like this on a production
website you should probably tidy up the
code and maybe yeah you know do some
testing and other other browsers as well
which we're not gonna do today correct
so what we're gonna do is there's a foot
one of the first things that we're going
to see here 80% right so we've got the
front in the back so what I've said is
the the containing element the car at
position relative said its width and
height then the actual front and back
I've said back face visibility to hidden
because as we flip the the parts the
front of the back of the card over we
want that to we want the contents to
disappear as its flipped okay and by
default I don't think back face
visibility is set to anything other than
visible so we wanted to be back face
visibility what you would see otherwise
I think and correct me here if I'm wrong
is that one of the cards is always run
at first independent of where they are
so that means it would just see the top
card the top half of the card but ran it
backwards yeah it's not what we want
that's why we said it to him right so we
have that and we need to do a little bit
of right so let's say background
well we'll look at what it's actually
looking like in a second let's do that
fat let's make it a little bit a little
bit darker there and then we'll say so
we're gonna say the front of the card
I'm gonna say the front of the card is
background where we got to it for color
and I'm also going to set the contents
of the card to be sent on a central like
so right so let's see what that looks
like okay so actually we are in a
reasonable spot here what it's a tiny
that's a good question I think it's
because of the the the way that this
screen is set up so they can do the live
streaming stuff sixteen by nine I
obviously know loads about live stream
uses we have seen the promo you did turn
on the camera successfully but that's
about it
sound good right so what do we got here
we've got the front of the card on the
back of the card let's do the back of
the card as well while we're here back
of the card interesting question on the
side where do you think what you're
about to write the flipping card is
reasonable even a good choice in terms
of UX I think as long yes like I I think
intuitively it's very a very good choice
for anything that where you have details
that you want to hide and that the user
wants to look into so you have like a
topic which has has the big topic name
on it and when you click on it it flips
over just like it would like an actual
flip card when you do like a flash cards
I think you call them when you try to to
learn words when you learn in language
so here's what we've got here we've got
the front of the card and the back of
the card is just appearing over the top
right yeah so what we can start by doing
now is we can actually say transform
rotate and I'm going to go with the
y-axis so gonna flip around the line
down the middle so the cars going to
come forward flip around it it's
vertical axis and go back we could do it
over the x axis as well that would also
work so and we can see how we get on
whether we want to actually pursue that
one today
now with it's the back face of the card
hidden it's the
there but we won't see it so we're doing
really well let's add on let me see
didn't say what we'll do is we'll make
that an h1 as well like so and let's
just change the font family because it's
currently not very nice see what we've
got for Arial that'll do it
and that's still quite monstrously large
so I will probably do it I'll probably
do it for now let's just change the law
okay it's gonna pack this in today font
size 24 pixels just do this this flip
card I'm gonna fix this now as well
while we're here what I want is I want
buttons on the front in the back for
flipping the cards just so that there's
a button that covers the whole thing
loads of ways you could do this front
and back and while we're here let's put
on a border radius of 3 pixels again
just so that we're seeing a little bit
of rounding us on the corner just so it
feels more like a car so the front in
the back and I want to say that that
applies to the button so I could just
get rid of that that would do it as well
there we are the front in the back how
is everybody doing on the chat it is
very much alive today like lots of
conversations going on fabulous got a
question and did we consider using the
animation API instead of skipping
animation who said we're doing CSS
animations Oh smarty pants on the chat
you're absolutely right we're gonna be
using web animations today haha I was
saving that and you've just come
storming in via Surma and yes he's gonna
blame me after oh yeah I'm totally good
I'm gonna take the blame in afterwards
right now his fault
there you go yeah absolutely we are
gonna go down that path you can do it
with keyframed animations I actually
found that when I've been doing stuff
like this
the web animations API is brilliant for
this it's support is actually really not
good by default so you actually have to
look at the the polyfill if you
want to use it so for production again
you might want to reconsider and also
custom elements as well they're still
very early days so we're talking about
the approach but I think it is possible
to do this with keyframes as well but
you know we like the bleeding-edge teach
new things here so background non-border
nan and text-indent - for now okay so we
actually have we have a button there on
the front in the back so this is good
now we can actually get into some
JavaScript and let's do a custom element
so we're gonna do SC flip card and I
call the SD card so SC card and we'll
see how we're going I don't think I'm
gonna have attributes today so we'll
leave those out okay so let's think
about this so we've got front and back
so I know we're probably gonna have to
enumerate that at some point so let's
just do that now with a getter sides
return front 1 back 2 so that's one
thing and we know when we create it that
we're showing the front of the card so
we can say this side equals this dot
sides in fact if I did static static
there we are can do that sides that
front so we're saying the front side is
the one that's showing at the moment
right now we need to query select the
front in the back so it's got front
equals document query selector there we
are front I'm having a bad typing day
and anybody who watches this show often
will know that every day is a bad typing
day for Paul front and back okay we've
got the front in the back and we need
the buttons as well well I see what
we're gonna do is we're going to create
a flip function and the reason I'm going
to do that is because we want to be able
to call it on the API if we wanted to
just grab the card from somewhere
outside and say just flip the card we
should be able to do that and then the
buttons inside will just get them so
that is the mindset of custom elements
right and that you expose the functions
that are supporting
explicitly yeah so starts our car but
supposed to be flippable so we give it a
flip function document dot query select
all button for now and then we will say
mmm can you do for each kind of you on
on a node list nail I'll do a radar from
this stop buttons so interesting remark
I think you did document query selector
but since you have all the sides of the
card actually I could use some this
query selector but not traverse the
entire document oh no no no they're
quite right I actually am fully intended
to that and just it was a brain problem
moment for me there where I just didn't
get it quite right so thank you yeah
well the people who just joined us or
maybe joined us just now and welcome
this is supercharged we are doing a 3d
card flip we're gonna have a card and
when you click it it's gonna flip over
and you can see the backside and that
it's actually pretty unusual on the web
which is one of using economy be using
the web animations API we're gonna be
using lots of CSS and Java scripts and
custom elements so if there's in that
join us and and watch Paul make mistakes
yay alright so we're gonna do so what
I've got here is I'm just kind of
stepping through the buttons and just
saying when you you know when we click
on a button we want to call the flip
code which is going to be this here so
let me just drop of debugger statement
in there so that when we click we we
know that that's doing its job we'll
have to wait and see when the other side
does its job but that for now it is
doing its job so we actually have to
figure out what it involves to do the
flip do we have any attached and
detached actually you know I should be
doing that in here probably yeah so I
immediately kind of think that I never
can quite remember if you can attach the
event listener before you attach it to
the Dom and doing
well it worked but I think whether for
cleanliness sake you'd normally want to
do this kind of sort of attaching
touching is a point where you can put on
the listeners and take them off probably
so I mean I'll put it there for now and
I should have a corresponding detached
but I'm going to leave it just for now
in in the interest of time right so
flipping the card so we've got an
animation that we need to do so let's do
this Const side 1 equals and this is
this is the where the fun stuff is about
to happen because we have to first of
all all right but in this way to do the
3d we're gonna actually have to put
perspective on here now anybody who's
looked at this has been confused by this
yeah you put your measured perspective
in pixels which is this kind of virtual
camera yeah yeah how much time have you
spent looking at this enough to be
confused I think I think I understand
but I have not used it yet so I might as
well be wrong this is gonna be fun okay
so we've got a perspective of 500 pixels
basically what a way to they remember
this is the smaller the value the more
extreme the 3d motion is going to appear
as the perspective value gets bigger you
get sort of less distortion and Foundry
pixels for something else more isometric
it almost looks like yeah they're almost
more distant yeah basically it's to do
with how much when something's rotated
and the size that it is how much it's
going to get shrunk or also stretched by
I think I have a small perspective value
you get this fish I look right yeah you
just get more extreme 3d motion and
Founder pixels is typically five hundred
to a thousand is normally a good place
to start just for a lot of content it's
a place to start and this is where
literally magic numbers come in nobody
else yet there isn't plane to why these
numbers are good but it's because it'll
be dependent on how far back you push
the thing and how big the thing is that
you're pushing as well in the Zed space
so because they're the kind of size of
card it is founda pixels is probably
gonna be okay now what we actually have
to do is we're gonna have to push the
cards back
in in dead space because what we're
gonna do is gonna have them kind of come
forward well in order for them to come
forward they've got to be in the back
first so also if if you lose track at
any point that it's fine the code is
going to be on get up later on our UI
element samples repository we're gonna
link to it in the description the video
is going to be up as a video-on-demand
on our youtube channel as well if you're
not subscribed you should be subscribed
so click the subscribe button below
cool right so we're gonna so side 1 and
I'm calling it side 1 because depending
on which side is actually gonna be the
one that we flip yeah as in the one that
is at the front to that particular mount
is the one that we actually have to work
with so we're just gonna side 1 and side
2 it will hot-swap depending on which
side is actually facing us anyway so I'm
gonna have a transform now the transform
is going to start at we're going to say
translate whichever it is translate and
translate the said I'm going to start
with minus 200 pixel so I'm going to
push it back in 200 pixels it's going to
have a rotation of 0 degrees okay so
it's it's basically pushed back in Z and
it's got 0 degrees so it's not rotated
at all the problem is right now if I
were to in fact let me just drop that
signs form on just to explain this this
array a little bit this is the beauty of
the web animations API because you're
using you're basically declaring an
array of CSS values those get transition
from one element to the next yeah we're
gonna definitely cover all that here's
the thing you see what happened there
when I actually just applied that that
that translate Z value that Z value to
the front yeah you can see that it got
scaled down right so without it there so
now we actually have to scale it back up
so that it doesn't look small right
because we don't be kind of coding at it
to 60 by 380 and then going but actually
it's only one hundred eighty five point
seven one but that's not going to work
for us what we actually wanted to do is
we want to appear as it was originally
so do you know how you calculate the
scale factor that you require
No I wondered if you were cause III
could probably I wouldn't claim that I
would be able to work it out but I can't
do it in my head it's it's basically
it's in the spec it's this one liner
that's actually in the spec oh really
yeah if and I did not know yeah if you
and if you read through it will tell you
and I thought what the heck it's like no
camera angle it's guy no it's the scale
value that you require is it will be
that it's the perspective so in this
case it'd be 500 over and then 500 minus
whatever the distance will be minus 200
so you should just plus 200 right so
found it over that that's how far it's
like that's how much has been scaled
down I will have to check that later so
that you know which it's been scaled
down but you because you so if we did
that value that the dur here if we do
that it's not 0.71 right is what it
currently is so - in order to account
for that we actually have to do one over
all that lock so he has to be 1.4 scaled
up to to kind of reverse it which Colin
is almost the square root of 2 there you
go so we can do that instead would
actually do it now I'm hard coding these
values again you wouldn't do in in for
reals because you probably want to make
this totally dynamic but we can say and
we can trans transfer that across to a
templates drink we can say scale and
then we'll do that okay so this is going
to be this is our starting point so it's
going to be scaled back up but it's
actually pushed back at 200 pixels then
what we want to do is we want to bring
it forward to say - 100 pixels we don't
to bring up to zero because half of the
card will disappear when we rotate it we
want to leave enough space for it to
flipping is going on yeah we want the
entire car to flip so that's why we are
doing this whole dance where we were
pushing back but don't want the user to
think that it's actually going backwards
exactly so then we're going to flip the
so at minus 100 over 180 degrees and
then the last thing we need to do is we
need to push it back down to 200 like so
so these are the kind of key frames of
our animation does that make sense
they're really happy so far on the live
stream is everybody not terrified of
that I don't think they will be there
very smart lunch right so good so far
yep cool so that's the side one now side
two is going to be the back of the car
Denis is pretty much gonna be the same
thing except but the moment is is
already at 180 degrees because it's got
its back to us if you like and so we
need to rotate it around from there to
360 degrees basically back to zero but
we want it to go in the same direction
so we'll take it up from 180 to 360 this
hopefully should sort us now what we can
do is we can switch based on what the
current side is so case is that it's
flip card dot sides dot front so if
you're if this is the front card we're
gonna say this stop front dot animate
and we're going to give it the side one
and we're gonna have to make some timing
data in a second whoops-a-daisy
same goes for the back we want to use
side two for that with the timing and
the receipts complaining because timing
doesn't exist yet also let's create it
mmm default because it's probably gonna
want that we throw in you error well
that happened something really did yeah
unknown side is where I'm going like the
good old days when you have enums and
suddenly yeah something goes really
really very strangely wrong so we need
to do the back so it's the back of the
card we're going to do side two there
and side one okay so this we just now
need some timing information here oh it
doesn't it doesn't like it because I'm
throwing there you go
so timing const timing is it's an object
and we're gonna say duration and we'll
do it slowly at first we'll do it for
like 3000 so that's three seconds
iterations will set look at it one
easing we need some of that and we'll
say ease in out so that we get a nice
easing on it and then we need a fill and
the reason we need a fill is at the end
of this animation we don't it's a snap
back to the first frame we want it to
hold on the final frame so will fell
forwards which is the correct key word
for that
so this should look like all these
keywords should look very familiar if
ever then CSS animations yeah which is
exactly the point so basically what the
dot animate call does is it takes an
array of CSS property dictionaries and
it will animate from one dictionary to
the next one and to the neck until it
has gone through the entire array so you
can basically define a sequence of
movements and they will be actually
that's one animation very smoothly
exactly and so what we're gonna do is
I'm just gonna remove that transform
that I put there okay all being well it
goes up flips it goes back look at that
we actually have now a car flip now I
don't like the timing of it because when
you if we just bring it down a little
bit faster or a little bit yeah so it's
okay most of the time is spent and
lifting up in there and then flip itself
is very yeah and also it feels lucky to
get to the flip point the the
interaction that you always want with
these things is kind of do the thing
that the user that actually can asked
you to do as quickly as you can so what
we want to do is we want to front-load
this animation so that come on coming up
forward is actually gonna happen faster
get into the flip and then get and then
come back down slower so what we can do
here is we normally would do an offset
in side to the object and you put in a
value between zero and one and so on
0.15 it's going to basically normally if
you don't put it it'll be 0 0.25 0.5 and
0.75 or not whatever they know I
wouldn't you be 0 0 3 3 6 6 and then 1
so you have that whatever the entire
duration is the start is 0 the end is 1
and you can define the start points of
all the steps sub steps by putting me in
this offset value which is a value
between 0 and 1 so I'm going to do an
offset of not point 1 5 for when it's
coming forward and we're set it to say
offset not point 6 5 here for when we
are at the flip point so we spend half
of our time rather than 1/3 of our time
we're going to spend half of our time
flipping the card over so hopefully it's
just a touch slower let's see how that
looks
yeah so that comes up quickly
you good yeah I'm Jen got multitask
right how's it going in there oh we got
some questions and people sharing links
answering questions for me already which
is amazing thanks for everybody who's
helping out whoo
looking good yeah good so what I've done
is just by finish it finish to type in
and I can talk to you dude
sorry you're good now you good you're
good okay so what I've done is I've used
the offset and and now it's actually
it's a little bit sort of slower so that
kind of lifting up faster other things
in the array keep the same default
others are the last one it's still zero
points oh you did you yeah changed these
so it's basically this is this is
happening what the cards coming forward
by 0.15 is taking half of the available
time not 0.5 if you like to do the flip
so the flip feels slower and then push
back like we had it before from not
point 65 to 1 so coming forward is no
point 1 5 and it gets no point 3 5 to
push back so the slowdown at the end is
more strongly felt okay okay if you
hadn't passed in the 0.65 it would have
still had default value of you they
divided the available time should've
been 0.85 between these two okay rooms
which you can play with these numbers
and just try and get different fields
and now it's also affected by your
easing as well because it's going to try
and kind of figure out that kind of
stuff
question on the side what do we use to
build for es6 we use nothing we
currently do not use everything that is
available in the current chrome stable I
think well yeah I'm actually running in
Canary today but yeah chrome stable I
believe has all of these all the same
things if and one of the things we say
on the repo is that if you're planning
to use this code or something like it
you would obviously need to transpile it
or do something with it but I Goldie
here is is partly to sort of show some
of these new things and it's partly to
you know choose the kind of correct
thing that we think for the the job that
we're doing in which case this is
actually a really good use for web
animations and it's a really good use
for custom elements so we're kind of
taking advantage of both of those but in
a production setting as soma said right
start you probably have to do some yeah
dancing to make make sure it's doing the
right thing for you right all good we're
actually doing really well but what we
need to do is at the
so the thing is at the moment it when we
click it the second time it goes back to
the first side so for that for a
temporary and we'll come back to this
and we're just going to set the side to
so for the side is currently SC flip
cards sides dot front if it's them well
if it's the front of the card that we've
seen then the side is now going to be
not dot sides dot back otherwise it's
gonna be front okay so this love these
pair of expressions they always feel so
redundant so yeah so now we know we can
basically you can see how it or actually
card flipping we already are have a
pretty pretty thing going on so much fun
to keep nothing that I want to do it it
actually works
it doesn't anything now his here's
something that if you've not seen Rob
Dodson casts yet it's a brilliant show
very new on the channel and one of the
things he talked about in I think the
first proper episode was the inert
property which basically at the moment
these two buttons for flipping the card
both sides of the card you'd only seen
one at that one at once right and so you
want to be able to kind of say to
whichever ones the the back side of the
card you shouldn't be Taba ball right
now usually tap to both the front side
button and the back and you wouldn't
even know where the tap focus is when is
on the back side but when you press
enter the button will still get clicked
so if I do a document dot active element
so this is not gonna help you can yeah
what you haven't
yeah parent parent yeah so so for
example here I had it as it was the
front but if I tap again it's the back
so it has focus we can't see it but if
somebody pressed enter I had a screen
reader where he would hear things that
are not even there who sent them to use
exactly we want to kind of we want to
handle that so inert is a thing that
there's a polyfill I've gone ahead and
actually added it into this folder so
we're just going to pop this in
like so and what we'll do is in the card
flipping code here when we are being
snarky about you're using an enum and
not just a boolean for which ciders yeah
okay I'm fair enough there I mean
technically this could be is the more
extensible explode approach where you
want to have a flippable cube at some
point or something yeah oh he knows who
knows definitely valid point we could
have used a bully and a half of all of
this logic be a little bit simpler but
in this case I guess it's more explicit
and more extensible yeah you could and
and I actually like the readability of
saying this is the front side it's the
back side but you could you're right if
it was a billion then we could say this
side is not this side which would flip
that immediately and that would also be
perfectly a reasonable thing to do so
I'm gonna start by saying this dot back
dot inert because I've added in the
inert polyfill it's true and the front
is not suggested to slap ourself on the
back
the thing that Rob Dodson fixed with his
inert polyfill in that alley cast video
was our site nav one of our very first
lights already slopping ourselves in the
back so much is actually having our work
correct I tried to frame that nicely
here it's just make us sound good
oh yeah he fixed our side nav whenever
was in terms of X ability not good so
we're going to say the front is is not
in at the back is inert for now and then
obviously at this point we can pretty
much swap those over so the front is now
inert and the back is not and here the
front is inert and the back history the
front is not inert in the back is so you
know again you know you've probably
could tell you this code up and it is
very repetitive so there is again would
be ways to to resolve this I'm sure but
it does mean that we have that all of
our for example do that and then if I go
back in and time again you see we don't
get we don't go through to the back
elements so it's basically toggling the
availability of that those elements very
easily for us it's a brilliant little
thing is the inert property I would love
to see this become part of the platform
person because I think it just makes you
know makes these things so much more
obvious the other thing we probably want
to do as well is we want to say this dot
back dot focus we want to actually make
sure that we focused the
the correct part of the card because you
know I think you switch though the wrong
way around I know if you're in the back
oh it's happening about so we bring you
back to that and I only from in order
for that to work we actually have to set
a tab index 2-1 so it's not naturally
Taba ball but it needs a tab index in
order for focus to work if you didn't
understand it what Rob Dodson saboteur
yeah and also there's a seed asset
eCourse as well so that's well worth
taking as well so we're doing really
well all I want to do now I say all I
want to do is I want to add some shadows
and that's gonna be fun and I can't
decide do they want us to do the bit
that doesn't perform well first or would
they like us to jump to the one the bit
that performs well that's a question for
the livestream I'm gonna make a call for
them here and we want to see the leggy
version first okay well it's gonna be
hard to do the like version without a
phone but I will put it up and then
we'll talk about why this will lag on a
phone okay so I'll do that so what we
need is we need two shadows they peaking
of I think you know we now have landed
CPU throttling okay that might do it
might might do enough we'll do it we'll
do it time that in fact actually what
before we even get into that let me show
you this um
paint flashing so this will cook every
time we repaint the page you see this
paint flushing okay remember this button
it's very helpful so when we what I want
to do is just come off this here if you
see this there we see a little bit we
see some paint flashing here okay
because of the button okay but other
than that the cards itself they're not
actually as an initial paint and then
inch out any mation yeah can't finish
this without a repaint which is good
which I want and if we so for the other
thing is if we did document my first
young duelist do it this way if I just
grab the card and say dollar zero dot
flip there we go you see there's that
right at the start there where where we
get a bit in emission so what we can do
is since we know we're going to be
animating that let's put will change
transform what happened there is that
the card that the browser didn't know
that we're gonna animate this because we
didn't tell it's a raster right is onto
the background but once the animation
starts it gets its own layer so it has
to repeat once
interestingly we are still seeing I am
still seeing this where it is it is
still painting so there's a bit of a
mystery there for me huh I have a wonder
just let me just set the the buttons to
display non see if that they're still
doing it interesting ah it's because of
the inert stuff
I think Dennis let's just try switching
out inert for a second seeing whether
that that's doing anything for us there
we are okay interesting yeah so there's
something something to be aware of there
but the now that we've actually I'll put
the inert stuff back on this little
thing is worth having and I still think
we'll get away with that on there'll be
a performance issue in reality but I
just wanted to show this that right now
this carb animation is not painting okay
so with will change
we told the browser keep this on its own
layer at all times we can start
animating immediately without having to
wait for the browser to put it on its
own layer and then do transforms so I'm
gonna do I'm also going to do a timeline
recording over here let me just switch
off the the painter paint flushing know
that it's actually gonna pay flash but
I'm gonna switch off anyway I'm gonna
flip the card again just so that you can
see what the timeline looks like so this
is the back face visibility bit here
this is a well-known optimization I
suppose that chrome does when something
stops being back face visibility:hidden
doesn't know it's going back to us it
doesn't actually get painted its when it
comes round at 180 degrees chrome says
ah this is now now is a good time to
paint this so that's why we see that
slight hitch in the middle but it's fast
enough that we still actually get away
with that we don't really notice it on
the way through but it's worth noticing
that it's actually happening there main
thread
it couldn't be any quieter on the main
thread it looks really really good
there's just nothing going on the
comfortable 60 FPS or 50 FPS here
because of the screen capturing so
you'll notice that we're getting roughly
20 24 insects so this 50 frames per
second is by designed to be super clear
we're capturing today at 15 frames a
second not than usual 60 and you can see
that Chrome's adapted it but as you can
see there's loads of white space in
between your frame bars so we could do a
lot more work this frame there's nothing
there's nothing doing so that's really
good so that I just wanted to kind of
point that out before we get into doing
the shadow stuff right so now we need a
shadow now I am going to switch back on
the
as well just because I don't want to
lose that I remember from my school
lessons that there's the thing called
the Umbra which is the kind of the
darker shadow underneath ins that kind
of softer shadow which is the penumbra
so we're gonna have an Umbra like so and
we're gonna have a pen Umbra like so now
or as the Germans call it shuttin
attention there you go you see I love it
I love it I mean you were telling me
what what did you think CSS would be
called if you were to translate CSS to
German I think it would be called
Cascadian - steel easy homes for long I
think it's a brilliant work I mean
that's just a mate of either remembering
it or pronouncing it correctly but when
I hear it I mean I'm just gonna go let
CSS so good right what we need to do
let's start with the the Umbra let's SC
card Umbra and we'll do the pen number
as well a little bit this is it sounds
like a shadow to me with a hundred
percent height and they will do
background yeah black background and
we're gonna say position:absolute top:0
left:0 so the first question from you
was going to be like why not just use
box shadow right so yes this is a fair
question so the box shadow is gonna have
give us a problem that we will want to
animate this shadow because the further
it gets away from the background the
more we want to have a blurry kind of
shadow the problem with that is that you
have to do that box shadow I have to
create a box shadow on every frame and
as we just shown we're currently not
painting on every frame all we're doing
is just we're taking textures and we're
moving them around and we don't want to
repay those textures changing box shadow
will change those textures so we will
repaint on every frame and it would most
likely be very much below or a 60 or 50
FPS exactly so we don't want to do that
so okay so I'm wondering why my button
has stopped working because I did have
what
worked before so I know you made him
just plain done and use the console
except that I displayed on okay they
work right so we got these two black
background divs behind I'm gonna set the
penumbra to display non from now we're
going to work with the Umbra for a
second display display:none okay okay so
we've got this this black background the
sitting underneath which doesn't look
particularly good okay i watch a bit yes
and that's why i don't design is right
what we need to do is we need to do so
box shadow no we're not going to do that
because i'll because repent what we
might want to do is we might think ah
you know what I could do I could do a
box shadow here and this would be fine
or what I'll actually do cuz I'm
thinking really would be nice is will do
a WebKit blur its WebKit filtering it
filter and then blur and then two pixels
these are all the CSS filters let CSS
lets you apply elements so we can blur
out things you can invert things I even
know or the other SVG fares photos are
that you can see there's the sepia one
there's a website out there that Rick
recreated all the Instagram filters just
with this attribute which I thought was
really something I've blurred it and
I've transformed it down to pixels okay
so it's kind of it looks like a kind of
a box shadow kind of feeling thing there
but it's not really it's not really very
nice because it's it's also a bit too
darks we'll bring the opacity down stain
or 0.3 okay so it gives us now you can
see it's just there you maybe you have
to kind of look at it then you see when
I want to do the animation it's there
it's it's it's you know below the
element below there what we'll do inside
our code here so we've actually we
haven't got the Umbra and the penumbra
picked out yet so we're going to do that
now let's do that
Umbra is the Umbra and the pan Umbra is
like so
the question that we have is will
containment help with a painting lag and
I guess in this case it won't because we
are not actually fighting against the
bubbling of right we're not
and we're actually what we're fighting
against is what's known is that there's
a convolution filter that we've got here
blurs require not looking when you're
figuring out what the pixel should be
you have to look at one that you have to
look at and you have to inspect and so
it makes it proportional to the amount
of blur that you've got so if you've got
a blur of like 20 pixels that kernel
around the pixel of that one pixel that
you're trying to is quite large and they
depend easily algorithm averaging out
the environment there are distribution
which is the Gaussian distribution has
the name Gaussian blur but you you're
doing that per frame per pixel of the
shadow depending on how blurry you've
decided to make it so this is a point at
which even if you could contain
everything else the sheer computational
cost of doing that paint work that
blurring work that we just get to type
one line of code which is WebKit filter
blur to pixels or 12 pixels or 20 pixels
but under the hood all the browser's are
having to do all this maths to try and
get to the actual blurriness and that's
stuff we kind of want to bake we don't
want to be doing that on every single
frame anyway right so I wanted to with
my this shadow here I'm gonna say
animate and I'm gonna do Umbra and we'll
do timing so better given the same
animation to the well it will be okay I
have to define what Umbra and penumbra
are I'm just gonna get rid of that for a
second so Const the Umbra or they're
similar animation it's gonna be very
similar here what we're actually going
to do we're going to set for the Umbra
and the penumbra we're not gonna set
back face visibility to visible we want
to make sure that when the shadow flips
over it's still actually there because
it's a shadow and we do that kind of
stuff so here we're going to do is we're
actually just going to go from with a
transform again
and what we want to do is we want to
rotate you know you want basically to
rotate zero degrees I'm not even going
to push it back or forwards I don't
think under grass on the ground it's
basically yeah so we're going to do that
but what we're going to do is we're
going to translate it down so I'm gonna
start with a translate y of 2 2 pixels
so it's just a little bit below the
current so it just feels like it's just
a little bit rotated at 0 degrees and
then what we're gonna do is we're gonna
know that and we'll bring it down save
62 pixels and then back to 2 so it's
going to come sliding down and then
sliding back up and with that halfway
point when it's do it to 180 degrees
that and we need our two offsets as well
because we want it to kind of copy the
behavior of the main card yeah wouldn't
be in synced it would be weird with all
the offsets correct so hopefully we're
gonna see something that slides down
rotates and slides back up again and
that should in theory work for us okay
let's try that seems like the foot click
well the people have joined us welcome
where you're now seeing the the first
stage of what we're trying to build
which is a 3d flipping card click it
okay that's something it works no it
didn't work it actually does work but
it's just flipping the wrong way is I'm
pretty good at ladies boys because I
didn't plan the actual axis I just said
rotate when so it assumed I meant on the
z axis actually so do that let me I
let's try that again yeah okay now see
now we're talking we're actually getting
an AK a nice little thing going on there
okay and when we enable repaint flashing
yep okay when we enable repaint flashing
flashing it's going to lie to us okay
now we've got our tape on it so you
would think this looks good I'm gonna
I'm gonna switch off the inert again
just so that we get to see that and we
will get some from the box yeah so let
me just switch off the boxes again just
so that we can see this but and then we
can talk about why this isn't actually
as good as it appears okay
mmm oh I'm gonna actually select that
element first see card console okay so
this is pretty much what we saw before
there we are no now we have a flipping
cart with a shadow which is great this
is fine but we can make it even better
and I think what we'll do is just
temporarily we will add and we'll do our
penumbra now so I will do the penumbra
stuff which is going to require so we
can getting rid of this particular code
and we will do this bring this across
and we're going to start it off at zero
and we're going to blur it up to 12
pixels okay and over here the penumbra
will take this little chunk here call
this pen on bro pen on bro and we're
gonna do is we're gonna do the exactly
the same animation now what we can also
do is we're starting at an opacity of
not 0.3 here but we're going to animate
this down to zero I'm doing this I'm
doing 0.0 doot so the indentation stays
the same or the distance because I found
that easier to read I'm gonna fade that
out the Umbra out we're gonna fade in
the penumbra which is so it's not
technically correct but it kind it
should work for us and I'm going to go
from zero as we said if it looks right
it is right okay so this is the panels
what we're trying to emulate here is
that when you have light source and
something going towards the light source
the the diffusion of the shadows Luria
and what we try to do is we just we're
just fading between two between
something with a two pixel blur and a 12
pixel blur and I've slowed the animation
right down now so hopefully we just
switch off the peg flashing so see if
it's actually visually correct first or
at least kind of visually correct yeah
got to do all my button unhiding stuff
that's my fault
in there I keep forgetting that I'm
doing that okay so you see how we get
that crossfade between edges of the
shadow it becomes more blurry you but
the further the card lifts up looks like
exactly the effect we're looking for
let's slow down even more just so it's
really obvious so getting that across to
that blurry aversion and then back into
the the sharper version as we go down
the I will notice that even when the
animation is fast the the human eye will
notice it hopefully as well with the
paint flash
we're gonna see mm come on Paul you can
do it after actually sitting here okay
with the paint flashing we're in a
pretty good spot okay we're doing pretty
well here now this is the bit where I
having done all that work I'm about to
tell you that this is not actually very
good let me show you why that is well
I'm not going to be that easy to show
you why that is other than I'm gonna
have to let's see if we can least figure
something out the cpu throttling there
okay so let's try it and see what we get
so rendering let's try this see what
happens okay so we're gonna do our
animation like so now we're on a fast
desktop machine hopefully down here
somewhere you can see the amount of time
on the GPU is actually occasionally
quite hefty that is a good amount of
time for a machine that's powerful there
yes and the reason it's is taking this
long sometimes and it is gonna be worse
on something that doesn't have a meaty
GPU like a phone if the WebKit filters
are done later in the pipeline so we
talked earlier about the fact that we're
kind of baking these textures and these
textures actually gets sent over to the
GPU and then they get basically put into
boxes and moved around the screen and
that's what the transforms do is just
moving those boxes around when you apply
a WebKit filter we take those textures
at the end of the pipeline and we do
something like a blur to them so that
blur is actually happening GPU side
butwe means that we can't do any other
instructions to the GPU like keep this
animation going because it's going well
I'm busy doing that blur that you just
asked me to do so we need to find
another way to basically do this this
blurring as I say if you would you have
to trust me if I do maybe even a low-end
device just see if it if it I'll do it
as I'm presuming this it's not really
CPU bound so we might not see it here I
mean it still looks okay it's it is it's
something that soon as I did it and
checked it on my phone this effect I was
like yeah this isn't good so okay okay
let's jump to what we can actually do
instead what we can actually do instead
is we want to bake something with the
texture now we could go 1998 style as
you refer to it the
today and we could make pings we could
actually make a graphic of a blurred
well basically precompute the blur put
it in an image from and it has
capabilities for transparency because we
need them for the edges and we could use
that but you know you also live in the
time of responsiveness yeah different
screen sizes so how are we going to do
that well I mean there are options you
could use a boarder image and so on
true that is going to work for you what
we've chosen to do today is actually to
use SVG because SVG supports Gaussian
blur and if we were to set the those
Umbra and penumbra divs to use these SVG
files as their background those will get
kind of baked as a texture and then we
will get exactly the same effect we
won't have the blur in the series so
using the same process we are blurring a
black square right like we're using it
at different points in the pipeline
exactly so let me just show you what one
of these actually looks like so before
we try the fun you have an interesting
question I thought how is the flipping
element affecting its surrounding
elements it won't it had a short beauty
of transforms transforms don't change
the actual layout to position if you see
what I mean they're not they're not
moving they just are they look like they
are atomic sense so we lay out a browser
layouts all the browser's layout their
elements and then the transforms had
applied purely on a post effect basis
yeah so if you say scale it will get the
the image has been rendered already will
get scaled yeah and then they might get
repainted at the end this is a true
sorry I got it yeah it is a key point
too though sometimes if you do a scale
at the end of the scale the browser will
go well now I need to kind of make that
image bigger for example so it doesn't
look blurry so there is some smartness
here but in this particular situation we
should be fine so Umbra and our pen
hombre you can see what that looks like
I'm going to open that in reveal and
find it and then I was going to drag
that all the way down here into Canary
so this is what it looks like this is it
pretty much the same thing we actually
got from the the CSS blur filter so
let's see how we get on with that look
what we're gonna do though is we're
going to switch across so we need to go
back to our CSS and we are going to get
rid of
background there we don't want that we
don't want the blurs we definitely don't
want those
but everything else can actually stay
the same for now ish what we're gonna do
is gonna say background:url I'm gonna
say images and this one is the Umbra SVG
downside center center no-repeat okay
I'm going to say the same for the pen
Umbra should also be a pontine well I
mean this is the thing at the moment
they're set to 100 some width and height
they don't want to maybe set 200 own
width and height again I've hard coded
these values you can do this in a
responsive manner but we'll just do it
like the hard-coded version today just
to you know get us through so the actual
width of the Umbra in the SVG is 270 by
390
so all those we'll go back and we'll set
this to with 270 pixels height as I say
319 I think I did to the side which is
probably interesting to you we called a
card flip but shouldn't shouldn't we be
using flip we don't need to so flip is a
really good technique when you don't
know the transforms ahead of time
exactly we've been able to hard code
these transform because we know the card
is going from one side and it's rotating
180 degree we know from 0 degrees to 180
it changes size and we don't know the
size of the screen or anything like that
would be it would get involved that's
the second flip comes in yeah when you
don't know the transforms ahead of time
you would use a technique like flip
we know those ahead of time so we
shouldn't try and make it more
complicated then you know then it needs
to be so that's 270 by 390 now the
problem there is that the card itself is
260 by 318 which means we have to
position this top and left by 5 pixels
minus 5 pixels top minus 5 pixels left
minus 5 pixels and that will now
position that correctly same is going to
hold true for the penumbra except
there's going to be even bigger
it's 330 by Flores position:relative or
something no we are position:absolute so
330 I 450 and so it was what was it to
60 so that is 70 which is 35 pixels so
we've - that
five pixels I think in both directions
all being well cool I trust you all
right I say that
so all being well now if that works
there we go we actually have it doesn't
look visually any different but the
Umbra is backed by this SVG and the
penumbra is backed by this SVG over here
and I'm going to switch back on my nurse
as well so that I don't forget too that
the dirt and basically mm-hmm just
record I will yell do it I'll do it it's
slow speed just so that there are plenty
of frames to go up there you go
still completely quiet totally quiet
nothing doing
steadfast there now it also worked on a
device that hasn't hurt doesn't have a
GP this beefy GPU exactly this this will
work everywhere the only other last
couple of bits and pieces that I'd like
to do for a little bit of Talia nurse's
sake is we flip the the side immediately
but we really probably only want to do
that at the end of the animation
so what we can do here is we can do a
non finish so this returns something I
believe in the future this will start to
return a promise but for today there are
reworking BAPI on oh yeah unfinished
equals and then it's a function and we
could bounce this out to its own
unfinished but we don't think we need to
and the other thing I think I'd probably
want to do this got locked I think I
want to lock it while we're in the
middle of the flipping over animation so
this locked is false and it's when it's
there when it's finishing it's also
unlocked and then the start of the
flipping animation so this was basically
meant users that are just violently
clicking yeah you have multiple
animations in it you know you could
figure out ways I'm sure if it's locked
we're just going to return earlier so
that we don't do that so you can't
basically you know cause this to go lots
and lots of times and we just speed it
up
let me just check it actually works so
that with a zero go to the console so we
select the card and we can say flip and
if I see no you see that's that's still
broken
so all being well it's now ignoring me
until it reaches the other side and at
the end of the animation
it should unlock so that we can now call
flip again and it will go back over so
we're actually sort of protecting
ourselves from that kind of brokenness
that we just saw there something I
always forget in the first iteration of
my code and then I wonder why people
start using it I'm saying it's broken
its violently clicking users always
breaking my stuff okay so no we are you
see that we have a flippable 3d
flippable card why don't we just for it
for because I think we have a few
minutes left
let's do axis equals I'm gonna do round
but let's let's see what we get here
because this this should work in fact
let me yeah let's do this let's do it
this way when we and we need to do the
attribute updated callback so after this
I will actually add some of that code
back in but we can say this dot axis
equals this.getattribute attribute
axis or default it to the x-axis for
example okay
I am assuming you're going to find how
the card flips yeah and we say if the
axis equals I'm gonna do to upper case I
suppose to upper case equals random
we'll just choose one at random so this
dot access equals math.random is greater
than not point five will do the y-axis
otherwise we'll do the x-axis okay so
you might be wondering what is he doing
here well we've we've chosen at this
point to always do rotate why well we
can just select all these now well no
that's a what we do for rotate why them
yeah
there we go and we'll do this taxes and
for these that these ones here where we
didn't actually have them set we're
gonna have to yeah I was wondering if I
was going to happen sometimes when you
do the multi quotes or those things in
vias code are a little bit iffy in my
experience in Canberra yeah so sometimes
you get this kind of situation where you
have to do a little bit of tidy up yeah
but all the same because I set it to
random hopefully see there you go we got
it we got we've got one that flips an X
here if i refresh we've got one that
flips and why it's almost like it
decided to help me out there and didn't
do like ten in a row in X so there you
go down that now you see that code just
works there for whatever axis we want
and we could change the perspective we
can change the we can give it more at
you as like how far should the current
lift up yeah although I think the custom
elements Eurasian or
yeah duration we know we've hard-coded
the duration to be what it is we can
let's just look why not let's just do
that let's just do this let this dot
duration we have the time I think I hope
everybody's enjoying this thank you so
much for joining us it's lovely to have
you all here I'm gonna say pars int that
listens the axis is going to be
generation no that one shouldn't mean
that should remain as this that axis so
I'm gonna ask for the duration attribute
and oh that's not good if is none this
dr. ation this stop duration equals
whenever you're handling user input and
attributes are in this case user input
yeah validated yeah absolutely
Golden Rule so we're gonna basically ask
for the duration that should be all
we're going to default it to 800 and so
we can do that this now duration
you equals 3000 so now we should have a
three second card flip in a random axis
that felt like three seconds there you
go well done Paul there you go
so thank you so much for everybody who
tuned in live obviously if you're
watching this you know on demand as it
were welcome I hope you've enjoyed this
if you're just annoyed you're too late
yeah yeah yeah yeah now next time it's
it's normally UTC plus one at two
o'clock if you didn't know that we're
going to be life subscribe to this
YouTube channel follow us on Twitter we
announced this ahead of time and a few
minutes before we go live so no excuse
next time okay
cohdon go Punta get up as soon as
humanly possible once I've had a little
bit of a additional tidy up and I guess
we will catch you next time see ya</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>