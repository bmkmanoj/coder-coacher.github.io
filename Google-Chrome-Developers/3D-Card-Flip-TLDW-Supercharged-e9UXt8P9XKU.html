<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>3D Card Flip: TL;DW - Supercharged | Coder Coacher - Coaching Coders</title><meta content="3D Card Flip: TL;DW - Supercharged - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>3D Card Flip: TL;DW - Supercharged</b></h2><h5 class="post__date">2016-09-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/e9UXt8P9XKU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome to this supercharged
TL DW last week summer and I built a 3d
car flip let me show you what we got to
building so you see I've got this card
on screen and when I click on it it
flips over in 3d and there are shadows
and all sorts of things underneath as
well to make it look just right now the
other thing I've done is I've taken a
timeline recording and you can see that
it's hitting a comfy 60 frames a second
and it probably would what it is doing
the same on most mobile devices as well
so with that said let me show you
actually how we got to building it and
of course that requires a trip to the
most famous corner of them all Theory
corner hello my theoretical chums
welcome to Theory corner so let's do a
little bit of 3d Theory not loads don't
worry about it it's not that bad so
imagine we have our axes X Y and Zed or
Z depending on what you prefer and
imagine our screen is kind of at the
front here and so is the card now what
we need to do is we need to push the
card back into Z space so that it's got
space to kind of come forward and flip
over and go back again so we push it
back in z space now the way we do that
is we put perspective on the containing
element and the perspective value is
always in pixels according to the
spectral mostly is anyway and so we push
this card back say by 200 pixels or
something and when we do that we find
that the card gets smaller as it does in
real life the further things are away
from us the smaller they appear so
that's fair enough
but we don't want the card to appear
small necessarily we just want it to
start on its actual size but be 200
pixels away from us so what we do is we
look at the spec and it says well in
order to figure out how much something
has been scaled down you take the
perspective value and you divide it by
perspective minus the distance that
you've moved your thing so let's say
we've got a perspective value of 500
pixels to figure out what we need to do
for the scaling of this card we say 500
over 500 minus minus 200 can we moved it
minus 200 pixels in NZ that tells us
that we've got to scale down its scaled
down by not points
well we want to scale it up so we have
to do one over that value so we can
scale it by one over not point seven one
which works out at a very convenient one
point four so now our card is scaled up
what we can do is we can set up an
animation to bring it forward flip it
over and push it back again so that's
just the 3d conflict will talk about the
shadows and so on when we get to the
code in fact talking of code let's go
and look at some welcome back to the
Cody bit now what we'll do is we'll have
a look at some of this code in fact
let's look at the HTML first we have an
SC card it's a custom element we
normally do this it's just for
convenience and because it's actually
quite handy to do that you don't have to
do that it would work just fine if you
had dibs and so on and for now we can
ignore the the attributes that we've
added on here
the main thing is we've got this front
and we've got this back and in fact if
we look at the styles for this front and
back mostly it's just gonna be you know
absolutely positioned and so on because
we want the front in the back to appear
over the top of each other but the super
interesting bit I think is the back face
visibility set to hidden we do this
because we want to make sure that even
if these cards the two halves of the
card are placed over the top of each
other if one got its back to us
we don't see it anymore and that's
actually a really important thing here
we need to make sure that the only the
side that is facing towards us as the
camera is the one that's actually
visible so we switch back face
visibility to hidden for the front and
the back of the cards now when it comes
to the JavaScript most of the time most
of this code is fairly sort of
boilerplate I suppose
except for this actual flip function
which is the sort of the meat of what we
actually get into so let's have a look
at that now
what we're doing is we're setting up
first of all we're setting up this scale
which we talked about over here in
theory corner we need to know how much
our card needs to be scaled up by now
I've hard coded these values and more
generalized version unit you know you
take the actual dimensions yourself and
you'd figure out exactly what you need
to do I'm not going to do that in this
particular situation but you can't do
that because what we said over there
it's actually I've inverted it so rather
than it being 500 over 500 plus 200 I've
actually
500 plus 200 over 500 that's going to
give us the the 1.4 value here okay with
the scaling done let's talk about side 1
and side 2 now the card could be with
its back facing to us or its front
facing to us so we just call it side 1
and side 2 and we just choose whichever
one of these is going to make sense
depending on whether the cards facing is
on you know one side or the other side
one side two they're pretty much the
same thing they're an array of key
frames and each key frame is an object
and in this case we have the transform
so let's step through what we do for
side 1 basically what we're saying here
is we're going to push it back 200
pixels like we discussed we're going to
set its rotation to 0 degrees and we're
going to scale it up so that it looks at
the correct size then we bring the card
forward by 100 pixels and we leave the
rotation where it is and the scale where
it is as well next keyframe we're gonna
be still at minus 100 but this time
we're going to rotate the card across
the X or the y axis depending on which
one we want to use by 180 degrees and
then finally we're going to push the
card back to minus 200 pixels in z space
or Zed space side 2 is pretty much the
same thing except that instead of going
from 0 to 180 degrees it's going from
180 degrees to 360 degrees so we know
that that's going to work for us because
basically we've got back face
visibility:hidden we've got one card
that's 180 degrees and one card of the
side of the car that's 0 degrees and we
will just basically choose which one
needs to be said 1 and which one needs
to be said 2 and you can see that is
down here there's the if the card is on
its front side we're going to animate
front our side 1 if it's on its back
then front will be animated aside too so
we basically hot-swap between those two
so that gives us the card flipping over
and that works just great let's have a
quick chat about the shadows now I'm not
going to spend a lot of time on this
because we spent a good amount of time
on the live stream and if you've got a
spare hour it's definitely worth your
time this one there's loads of really
interesting bits and pieces in there
about why we can't use a blur filter why
we can't use box shadow there's loads of
stuff in there but if you can't watch
the live stream there is actually an
accompanying blog post we'll put an
annotation or put it in the description
below have a read of that it really does
get into 9 slicing and
SVG and how it is we're actually going
to do a performance shadow that's
disconnected from the element that it's
actually shadowing it's really an
interesting technique what we have
though is we have two shadows we have
the I'm calling the Umbra and the
penumbra and the Umbra is they really
sort of tight shadow with a little bit
of blur and it looks like it looks like
this it's got a little bit of blur and
it's SVG which you can see here it's
just you know some SVG with a Gaussian
blur with a deviation of two and we just
have a black rectangle that's been
blurred by it the penumbra is a blurrier
version again it's got a blur I think
twelve pixels on it and what we do is we
actually fade from one to the other so
when the card is like this and it's at
the back of the the you know 200 pixels
back we use that very tight a less
blurry version of the shadow watch
closely as we do the animation we fade
from that to the penumbra with a
blurrier version and that is exactly
what we'd expect in real life we as
something gets further away from a plane
its shadows gonna get blurrier and
bigger and so that's what we're trying
to mimic here and it's a subtle thing
but it's going to give it the kind of
feeling of reality and the code for it
is very very very much the same as the
other stuff we have an Umbra and a
penumbra and we fade you can see not
only do we do the rotation stuff that we
were doing before we translate the the
shadows down and then back up again and
we also fade the opacity so you can see
that the the smaller tighter less blurry
version goes from no point three two
zero and then back up to not point three
and the blurrier one follows it moves in
exactly the same way same rotation and
so on but it goes from zero to not 0.5
and then back down again so it crossfade
in between those two shadows to give us
that effect and finally finally finally
right at the end of this we have that
animation call for the pair of them and
when the penumbra the the blurry one
when is finished animating we basically
unlock the car so that people can tap on
it again and we flip the side we know
that we flip the card over so now we
just say if you're on the front you're
now on your back and if you're on your
back
you know on the front and that is
basically all that goes into this so
there you have it that's how you can
make a 3d card flip you can check out
the the blog post on the shadows stuff
and nine slicing really interesting
stuff there you can have a watch of the
livestream that was about an hour as I
say it's got loads of super cool stuff
in there definitely worth your time and
of course you can subscribe to the show
and subscribe to this this channel and
you'll find loads of amazing content and
they're definitely worth checking out
alley casts with Rob Dodson I didn't
have time to talk about the inert stuff
that we use in here but that's super
cool definitely check out that show and
I will catch you with Surma next time
don't forget you can subscribe one of
those two will work or you can watch the
live stream and I am NOT going anywhere
until you do one of those two things
still here</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>