<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Supercharged Q&amp;A: July 2016 | Coder Coacher - Coaching Coders</title><meta content="Supercharged Q&amp;A: July 2016 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Supercharged Q&amp;A: July 2016</b></h2><h5 class="post__date">2016-07-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/nX7_HDh_QM4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome to the supercharged QA
I'm Paul I'm sorry yes now we get
questions on YouTube on Twitter all
sorts of places and this I'm gonna
answer just the one question and you've
chosen it which one did you go for I
chose a question that I thought was
interesting because there's so many
layers and it is what's the best way of
injecting new content on scroll because
layout is expensive you see what I did
it with the layers yeah dude getting
sorry sorry ya know the person is right
injecting content is expensive on scroll
two reasons right you're scrolling so
you've got an animation and so you want
to keep everything nice and fluid 60
frames a second and then you basically
trigger layout and styles and paint in
one go by attaching content to the Dom
so I totally get where they're going for
or what they're going for the first
thing I thought was to use something
like containment but that's only going
to be chrome 52 and it's not available
everywhere but you be able to be like
the thing that's having content injected
you be like contain content or contain
strict and then at least the layout and
paint and so on all those calculations
are at least locked into the element but
I know that you've been doing some work
recently with some chrome engineers on
an infinite scroller so why don't you
explain what's going on there so layout
is expensive but it's also something
that you can't really get around like
when you attach something new it will
has to be layout it into your document
or otherwise the browser won't know
where to put it so another approach to
basically keeping the cost down is to to
just keep the number of elements or in
the dorm low right so we excuse in this
before right with recycling views
basically on on native this is a flat a
standard thing like just kind of
recycling them ok so then what it's one
thing that we did that basically we keep
only the elements that are actually on
screen and a little bit on the top and
the bottom when you scroll up and down
right and but basically the further out
you go there's not going to be any
elements anymore we just use the space
with an empty element instead of having
all the actual content up there so you
still got recycling which is going to
trigger layout and painting all those
things but by the sounds of it by
keeping the Dom count
exactly you basically it is fast enough
fast enough I wasn't fast enough on
mobile or just fast enough on desktop
both actually that was one of the target
it's actually fast enough even on
mid-range to low range devices that they
can keep up with the work so it will
have the smooth scrolling at 60 frames
per second okay so the other question I
had is I know it does some tomb stoning
so explain at least for me again what
the tomb stoning thing actually does so
tombstoning is this technique where you
ain't because you don't have your data
edge and for in this example we are
actually amazing a network source when
we get the data in we want to show but
sometimes people scroll that fast that
you have to be on screen but you don't
have the data yet so instead of putting
nothing or janking or blocking we put a
tombstone which says there's going to be
content here which is something that
Facebook actually does prominently when
you open the app way just show here's
got to be a person and show empty lines
with no text just Bray boxes okay and
once they arrive it actually turns into
the actual item and suppose we displayed
and we do the same thing so we when the
user actually Scrolls too fast for us to
keep up with we instead of attaching
nothing and not being able to scroll we
attach to inscribe tombstones okay and
so that allows us to keep the scroll
going and then we take care of keeping a
staying at the same position once data
arrives because the element could grow
because it is unexpectedly large amount
of texts or there's an image and they're
all these kind of things and it makes
the user experience very smooth so the
one of the other things that occurred to
me about this was it sounds like that
prioritizes the scroll above everything
else which is absolutely crucial thing
to do it's like that's the interaction
of the users got yes they want to see
the content but they don't want you to
get in the way of the scroll because
that feels off yet two people do you use
anything like request I will call back
to make sure that they're like the main
thread is available for work before
actually sort of spending time trying to
populate the data set or is that not
something that gets done yet emulator
fetch and once data comes back we check
I don't think we use red crest I'll all
back in the demo but we check if the
element is still on screen you get it
even needs to get attached
if it's off-screen already in the
student has been scrolling so fast
there's no need in treating the layout
and then removing it again because
already way off screen so that is the
kind of booking request alcohol back
would be great though if we know that we
are on screen but maybe the browser is
still Billy with with decoding it fetch
request or something so it would be
worth decoding that first and wait until
the browser is actually available to
attach the data to the don't L replacing
the tombstone all right cool so
basically i think in summary it's like
avoid it if you can if you can't avoid
it keep the cost down and then basically
be really really tactical about the work
that you do either by checking that the
thing is still in the window still needs
you dealt with or maybe even considering
some work that that you really need to
do that is one of the things i learned
what isn't also really important i think
is always test on a real device like we
have a malaysian mode which is good to
see the Flay up works and you can even
throttle down the network you can I
think in future versions of Chrome you
can even throttle down the CPU to
emulate a slower device but nothing is
going to tell you how we are really
feels once you're on a ram constrained
and cpu constraint device and realize
even though it works fine on desktop on
mobile your way below 60 FPS which we
had a couple of times with this thing
and it's just a complete experience if
you're on a device okay well i guess
that's it like we said basically avoid
the work when you can performance is the
art of avoiding work and if you can't
avoid it keep it to a minimum so with
that I guess we'll catch you next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>