<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Swipeable Cards: Live Code Session - Supercharged | Coder Coacher - Coaching Coders</title><meta content="Swipeable Cards: Live Code Session - Supercharged - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Swipeable Cards: Live Code Session - Supercharged</b></h2><h5 class="post__date">2016-04-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/rBSY7BOYRo4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome to supercharged I
guess it's the live edition I don't even
know what that means but we're stood
here nonetheless on the set of
supercharged I'm Paul and what we're
gonna do is well like last time I did a
live stream I did an image Zoomer
element and I said at the end of that
what you want me to do next and you all
went swipeable cards I actually put up a
little poll and you voted for swipeable
cards so that's awesome so that's what
I'm gonna do in this one or at least
attempt to do and I have a little bit of
help in the form of Surma the form of
Surma that is me I'm here basically to
monitor the chats that we have we're
gonna have a chat on the live stream on
YouTube but mostly I would like to ask
you to move over to the slack channel
that I created on the chromium death
slack it's like each other is more
comfortable and we have action archived
version of the chat afterwards so if you
want to chat with us and actually
influence the way that we do this join
us and talk to us right swipeable cards
oh yeah before we started I wanted to
ask you what even is exactly swiping the
card because the term itself is not
really self-explanatory no actually when
I put the pole together I was like I'm
not sure what I'm actually asking here
but I thought some people can't seems
like something decent then it turns out
that polymer actually has a swipeable
card
oh that one so it's like it's like
dismissible cards I think is the way
alright that's why I'm gonna go for
right um well you know if chatter what's
going on with some code because that's
why we're all here
so what I'm gonna do I dive straight in
I've got my editor open and it's all
I've done so far is just fire a little
server and they said a little sermon a
little server get that right um all
right let's make a index each - no mmm
there we go wipe swipe a ball oh let's
just do some HTML to begin with why not
div equals card I'm gonna put them in a
container I think yeah that means I can
have something that's a bit more
responsive I think let's do that div
class equals card
No there we go one two three right let's
pop in we don't need the manifests I'm
not using that today so link rel equals
style sheet H ref equals cards yeah yes
with a goal that you have in mind
my immediate idea would be to have like
listen to touch events use transforms
and then animations to do the
dismissible thing yeah yeah all right
totally totally gonna go for that
let's see what happens you never know
HTML body
let's see margin:0 background one of
those do a card container o width 100%
let's see max width 450 pixels want some
padding on the sides and I've got border
box that'll be okay
piling up 16 pixels yeah then in the
card say background white and the border
radius 3 pixels Chris what's that like
yeah box shadow that's what I want I
want a box shadow cuz I want these cards
to feel like they sit off the page a
little bit so we'll do 0 and X I will do
3 pixels in Y will blur it by 4 pixels
and we'll do an algae behave not not not
not point 3 and let's put a margin of 20
pixels and then nothing to the side it's
not gonna work
take a look No oh I didn't put a height
on it there you go
hi 200 200 220 pixels yeah we have cards
good right
we'll put a margin on the centerline for
now margin:0 auto cool we have cards
let's let's label them really memorize
the material styles didn't you well you
know card one hang on we can some
friendly names
I'll let's just do that's thermo Aero
twist look at the last card in the
Kinlan yeah bond I'm gonna go with the
kindling yeah can la animus Maximus yeah
let's do display flex a line-item Center
justify contents base around that should
put the text right in the middle nice
and I want to fund I saw the way I look
to that not like Arial font size say
pixels color look you should have a
color on there as well
Hey look that codes will halfway there
yeah cuz that's gonna be that's the hard
bit yeah nice try so nice right well
done right new file
let's do cards Jas
now I will need to pop that in here
script source equals card stop Jess this
is where the juicy bits come yes the
Java stress is the bit where I probably
get it really wrong so let's say use
strict and I'm gonna do class cards
because I like that and I'm gonna do
window.addeventlistener I'm just gonna
do this the lazy way from then our new
cards right I will do a constructor that
says console that log hello world hello
world hello world now you know tada
and the nice thing is we don't even need
Babel or anything because Chrome has
support for a melon that's so convenient
there we go
okay I knew I should have done at the
start of a general if I've been really
thinking I could have done like Jason
and hit tub you see I've already done
all that before ah
so dim sometimes there we are no okay
well good right so let's think about
this this dot cards why I want to pick
up a reference to all the cards cuz I'm
guaranteed I'm gonna want them later on
so document query selector all anybody
asking any interesting questions over on
this so far we got nothing we got quiet
piece and people are watching though
that's all
hello everybody hi thanks for joining us
if you're just tuning in because you
might have been a few minutes behind
we're doing swipeable cards I'm doing
the coding he's doing the chat stuff for
making sure that I get interrupted every
so often so I lose my train of thought
that's his gift to me to you just in
time for the actual interesting yeah
because I've done a bit of styling you
see over here this is what it looks like
some cards how exciting some cards but
what we need to do is obviously make
them behave properly which is as Surma
says the fun and interesting bits I'm
actually going to go into
the device mode emulator here in dev
tools because what I want to do is I
want to switch on actually do we have
touch we do under here I think you can
do do or is it not in there they move it
and I don't know where you don't know
where okay I'll tell you what I'm gonna
do just ok I could just go for a phone
it will automatically enable it
ok 6p let's do the 6p now at least got
touch yeah right which is cool so that's
good because that's what I wanted so
normally what I do when I you have been
corrected you want query selector all oh
yeah back god by the audience yeah
thanks guys
that saves me a lot of heartache later
on right so I'm gonna do on start
because later on I'm gonna want these to
be reused for both touch and mouse I
don't wanna be like on touch start on
move because I'll be on mouse move as
well and on end and I know what I'm like
I'm gonna want to defer these with a
requestanimationframe so I'm just gonna
have an update function here oh why
can't I take today server update I say
today I'm often I just like typos with
king of typos if such a roll existed I
would inhabit it on start I do this
quite a lot I rebind these because only
inside of their call backs this would
refer to the element the target and I
don't want that often I want to kind of
operate on the function or in this case
the class so I tend to rebind them so
I'll say this dot on start take it from
the prototype which is where this
wouldn't exist and bind it to the actual
instance it's just the foible of how I
do wanna code advanced j/s trickery and
it's not really it's just how we roll
alright so we got that update as well
this the updates equals this stuff
update stop bind this there we are
awesome so these are all be bound to an
instance and I guaranteed I'm gonna want
to do that and add event listeners I
tend to do this pattern as well where I
basically normally have a remove event
list is an add event listeners as well
so that I can just do that all in one
place so I'll say document ID also when
I'm doing stuff like this
I always attach the document rather than
the thing that I'm moving because often
I want to kind of delegate it and have
just one
listen to that I do an early exit from
if it wasn't the right thing but
everyone is like this everyone's a bit
different and document.addeventlistener
to start this the on start document move
amia that's the point usually you don't
listen to one event you have like a
whole collection of things you need to
banker that's kind of nice to have a
function that contains all the binding
actions yes exactly I like how you're
the voice of reason in a monster because
I'm trying to talk and code and think
I'm I can only at least do one of them
and normally none of them so so that's
fine so let's see no it's a touch move
so it touch starts we're gonna have to
do event up prevent default here because
otherwise we get throttled back and
we're going to want to get all of those
oh yeah okay so if event dot target dot
this will be my early exit class list
that contains card yeah so if it doesn't
return so we only then console let's
just check that works card so mmm-hmm
that didn't work why do they not work
mmm okay let's do console dot log
there we go that didn't work
all right because I didn't call
adamantly there you go Oh also we just
got to ask why query selector and not
get elements by class name and I think
that's really more a question of taste
than anything else yeah it might be a
little bit more performant to use get
elements by classmen because you don't
need to parse the CSS selector at a park
violin I wouldn't bet against any of the
vendors any of the browsers at this
point on that topic you know that is a
good call because you could probably
find one situation where one's faster
than the other I think oh yeah I'd say
this is just a convenience thing and I
agree if you did anything else you'd be
like you just got possibly a micro
benchmarking head
personally I prefer just preferred the
very terse syntax of CSS selectors we
know a hash tag is an ID yeah got period
is a class I kind of wish me but this
would work in the situation as well so
right we've got a card if I tap outside
it is that gonna work down here yes sir
touch event is there but only that one
registers the card you should zoom in on
the dev tools I'm gonna zoom in on the
dev tools it doesn't want me there we go
so let's do that again
that's got a card down there not a card
God not card God not card we know we've
got a car that's golden Paul thank you
all done thank you
right so we know we got that so what
I'll do is I want to keep a reference to
whichever card we've got so I'll call
that target I'll initialize that to null
and I'm gonna say on start so if we've
got past this we can say that we know
that it's event target and that's good
and I think what we can do is we can
also track the we want to track the
exposition so let's say this dot starts
x equals zero
and we'll do the current X as well which
will be what we keep up-to-date
I'll explain myself in a moment my
thoughts are ahead of my explanation
right what we want to do is we want to
say EVT dot page X or EBT duck touches 0
dot page X so we know where we've
started because what we want to do is
we'll want to move the card and I'm
absolutely mount each time
from the market starting position so we
can start by saying well the current X
is definitely the start X because we
haven't on start yeah it's good stuff
but during this on move we can say the
current X is now that and all we want to
say if we've not got a target return
return and on end if we're not going to
target we want to return there too so
that we don't bother with anything so
let's say you so we've got start X got a
current X and T what we'll do is we'll
just call and are we don't to call to
all them I'm going to do I'm gonna do go
into a permanent loop so once they
permanent loop I mean normally and I
might get time to do this depending on
how the everything goes normally I
wouldn't just go into like this kind of
permanent requestanimationframe loop for
something like this I'd do it for as
soon as you start touching that start
the animation frame looping and then
when it finishes its animation either
dismisses or resets back to the middle I
would then kill the animation frame but
in this case just for convenience I'm
just going to keep going and do this
means that we will always be in sync
with the frames and not miss
repositioning yes that's the one right
so in here what I'm gonna do is I'm
gonna say shouldn't you'll be saying if
not this target hmm yeah yeah was that
from the was that used it was me but
it's someone just said in the chat as
well so you can claim it though because
they can't see so you can claim that and
you know and ah sorry I'm a source mod I
saw it after Const let's see like screen
X call it that is their current X minus
the start X and then we can say this dot
target in fact we will want to do if
this is going to run from the start let
me say if there's no target return all
right
so we can do is style Duck transform
equals and then I'm going to do
translate X and then do stream X px but
see what happens
nothing I do nothing it's doing nothing
that's not good all right let's find out
why well that's kind of fun what every
frame that's why because we fire it and
it early exits but it doesn't request
the next frame there we go so we've got
something actually animates which is
brilliant let's have a look what I want
to do is I want to check the painting so
it's yeah this is why I thought was
going to happen right every time we move
we just update the transform and that
means that we this by itself doesn't
qualify for its own way if we show layer
borders there's no orange box around
this right and we love our orange boxes
lavera especially if it's on those got a
transform we won that to have its own
Orange Box so here's what we'll do is on
star if we've got ourselves a target we
will say this dot target dot style that
will change equals transform and that
will give it its own layer and we could
do it for every single way just do it in
this style today right because if I have
a thousand cards then I'm going to
create a thousand layers good point so
you could definitely put this in the CSS
but I would say so you're just promoting
it at the touch even once there yeah
touch is going on your Kita's only on
afterwards yeah and this would be
something I'd keep an eye on if I felt
like this was becoming an issue when you
tap on mobile particularly if it took a
while before you got that new layer then
I would consider pre promoting the ones
that are on screen kind of make sense
but at this point this will be it was
like a version to kind of feature right
so now all being well you can see it's
got its own layer there because we soon
as I tap on it it gets its own layer and
you can see now we're not painting at
all all right and that is important
because performance yeah it is called
supercharged Sarlacc losing
yeah so we'll move that there we go
right now
if let's see on end Oh what do we want
to do what do we want to see I think you
want to unset target no i don't i
actually don't because this this update
requires that the target exists right if
it's got no target this will early exit
but when we let go we might want to
slide out in the middle so i'm gonna
break okay what i'm gonna do is i'm
going to say i'm going to turn turn this
gonna know where this is gonna go this
is going to go to the ez easing version
of the world here we go right if this
dot dragging card yeah okay let's call
it that yeah fine I know right
let's see so at this point we're gonna
say you're not dragging the card but on
start we will say that you are dragging
the card and we know definitely that we
at the end here you're not dragging the
card anymore so that's okay that's all
working what WIA working as intended
right if you're dragging this this will
need to become they start screen X so
we'll do this that screen x equals zero
this is fine so what we want to do is so
this should still work all being well
they should still work yeah it does when
we let go we want to say this dot screen
X plus equals so this is the you've come
across this season before this is where
you want to be - where you are all over
some value and it basically eases slows
down over time so that's cool
so we'll do 0 because we that's what we
want to be - this all over 10 and I'll
put that in parenthesis porins
brackets and I call them and sorry
initialized it to 0 - lies it to 0 I did
we have been asked if you should reset a
will change when we're done yes
yeah so the moment everything see
actually at the moment that everything
gets promoted or get the card gets
promoted and what I'd do is I'd wait
until this animation finished like that
slide in at the end
I'd get rid of that mm-hmm okay but for
now because basically I need to detect
when that's finished and then I'll get
rid of it there that makes sense
but little but that's me adding the
sound effect it doesn't actually do that
it's an upcoming feature then yeah it's
an upcoming feature um okay so the
screen X is going to move itself back to
the middle however what else do you want
to do well I think you need to implement
like the hump that you have to move the
card over so it continues going out and
it's being removed afterward okay all
right all right all right so in which
case the way I would do that is this
right we're going to need to know this
dot target BC bonding client rec I'm
going to take take some measurements of
the target when we first pick it up so
on start this target that is this dot
target don't get bounding client and in
case someone doesn't know target get
bounding client rect is a particularly
expensive operation so it's good to do
it once but not every framers and that's
why we do it on start and not in that
date function yeah what I do every time
but though you it basically uses that
layout information that the browser's
already has so you can call it the start
of a frame and it would be cheaper there
but you're right
and there's no reason for us to do this
doesn't change its then know exactly it
doesn't change dimensions that's all we
actually wonderful you could use offset
width and offset height I just prefer
this because I get an object back with
them all in rather than like a separate
thing but you could be like you know
offset but I'm not going to do that so
what we need to do is let's see so be on
end I think
mmm yep okay so that we're assuming that
you want to go back to the zero here but
you might want to go back to zero you
might want to go to somewhere else and
we're going to decide that in the on end
we'll do that here if right target VCR
width so we need to know how far you've
moved so let's say we're going to repeat
ourselves a little bit so all though is
when you release we'll say the all
interesting we need to grab this so
we'll grab this again
so we'll update this and we'll say
problem R and if the math that abs
screen X so if you're negative or
positive we just want to know how far so
we just want the kind of absolute value
some people like to do screen X they do
like modulo now a binary or with zero
that's equivalent parameter ah the the
bit level hackery - yeah I just use math
uh because then I can I prefer the more
expressed as a present version because
if I read in six months I'd be like Paul
what you do you don't make any more
sense like by not point four so if
you've got more than four tenths of the
width two fifths of the width then we'll
consider that one that's completely at
random I haven't I'm just guessing
so that's a constant you could move it
to the top of the class and something
middle and for now for now no we don't
know no why would I do that
so what we need to do is we need to do
this dot target X which is gonna be
where we're gonna actually aim to send
the card and we will say that we assume
that you want to go back to the middle
so in fact this should still work if I
need to initialize it up here don't I
yeah so this should work still and
doesn't page X of undefined okay oh yes
because that's fully enough when you on
end in the event there's the there is a
not a touches there's something else is
let me find out what it is
but it's not the same as the others
something I know that's when the good
old console.log comes in to help with it
you know some people like debugger and
stuff uh now we don't really good
touches yeah so that's the thing there
is something that you come query to find
out what changed if that makes sense
don't I'm gonna assume that the last
known value from the on move is good
enough at this point never be fine yeah
you should be fine
and even if it's not it'll be fun so
that goes back to the middle so now
we're just deciding to actually send it
off to the left or to the right so we
can do that with if you're over that
we're going to set the target to be mmm
green X is less than zero so Ananse deal
over there if you're over zero we want
to send you and I know what I'm gonna do
in a minute I think I'm gonna make it
fade out that seemed sensible yeah so so
let's do that so if you go past there
OOP yeah I think you know a little but
okay that's interesting
it's quite far isn't it she does that
you have to go bitch here are so I'm
going to make that down to like not
point two five yeah it seems good I'm
gonna switch off this cuz this I don't
need this anymore yeah that feels and
then if you don't go far enough
mmm don't like it gonna say about three
five number fishing there we go that
feels better
yeah if you do if I had you Clippers our
best numbers yeah I know right
so how oh I tell you what we can do we
can because we've got the width up here
and we from the target BC art so we can
basically say this dots green X mm over
that over the width and that would
normalize us now so we can then say if I
could be a constant opacity equals one
minus and then as you sow the screen X
hits the width that should be easy it
should be one so this would be so that's
what fraction off the card is still
visible on screen kind of is how much
how much yeah yeah yeah and we turned
that into opacity you know when it
reaches at the end point it's going to
be completely transparent translucent
what's the one whatever the word is
that's all of that opacity right style
target opacity is the past thing so that
didn't work that's depressing
there it is okay so you can see how it
goes transparent comes back in oh yeah I
think it'll tear absolute oh yeah it's
that master abs again so what I'm gonna
do as well in a moment you see how it's
got quite a linear feel right yeah yeah
well you might want to curve it a little
bit yeah so what I'm gonna do is I'm
gonna do I'm gonna call that Const
normalized how's everybody doing on the
chat they're fine no good right now they
don't seem to have any questions but if
you have any you can ask as I say that
will we publish the code afterwards yes
this yes we will yes of the last code
the last code the last live stream the
code went up onto github on his github
comm slash Google Chrome and I get you
maybe get you to find this and shove it
in yes I'll put it in the chat yeah
sorry sorry Dave
yeah hope calm such Google Chrome slash
UI element samples I think that's - its
yes
you're right so that is kind of good the
image Zoomer in there which incidentally
addy Osmani used in his smaller pictures
up so if you actually want to see in a
in a sort of a more production context
you can actually see he you know sort of
threw it into that after the last
livestream so what we'll do with the
cards today but anyway so no statistic
you say was posted it so that's good
right anyway back to where we were so
I've got normalized drug distance so
what I'm gonna do is instead of one
minus one what I'll do is if I do math
dot pow-pow and let's say if I squared
it then if it was at naught point five
you'll be actually you become not point
two five so take one - not point two
five so you're gonna give it this kind
of curve like the parabola curve the
probability exactly and the stronger the
power the more it's kind of going to go
from that which would be nice in fact
let's do it like two quad no Q and and
then you see it hold it hold and it
holds and it goes just at the end AC so
now it holds and hold and hold and it
just looks a little bit nicer I'd say
right so we have so actually now we have
something that yeah the only thing I
don't like is that that's not going fast
enough so I divide by four it should be
a little bit faster there you go yep
that's cool
there are all right how are we doing one
else do we need - oh yeah when you get
rid of one we need the rest of shunt up
don't weigh in and get it out of the way
oh actually you know what I want to say
because we if we've got a target right
then we don't want another card kicking
in yet we kind of want to deal with one
before the next one kicks in that makes
sense because what we're going to do is
when we move the mob we kind of won that
animation to have completed before we
allow interactions again so this now
becomes important for me to figure out
how to actually release the target back
okay let me see so well I tell you what
we can do is if not dragging anymore so
if they're not dragging the card that's
a good start and opacity hang on hang on
Const is nearly invisible I'll pass the
relays I know there's like less than
that okay so if they're not dragging the
card right if this is nearly invisible
yeah then we could say this duck target
equals null right and we could say this
before we do that I'd say what let's
just try this first they start target
dot parent are taunted taught it know
target that parent node dots remove
child they start target one T but
wanting so so this is probably gonna
jump look but it's a good step also
we've been asked to enable the FPS meter
so people can do it's actually 60 FPS
which i think is a good call it's not
miserable though it's not visible why is
that visible
I don't know canary on here the
responsive mode that hides it for some
local host 933 Oh wasn't it
I think so
let's see and see what we're gonna do we
got a responsive mmm I was hoping that
we'd actually get how we do we get touch
then you have to go and phone Nord again
I think no no I didn't I didn't want to
do that I'm gonna do that I wanted to I
wanted to wanted to want it to where is
the device type show device type mobile
now I've got it right yeah that is very
touch okay that's know that seems gone
are you saying FPS meter and zoom in on
the dev tools okay provide it we can
actually see the FPS meter yeah okay
that seems okay right let's see if this
works
look too far do far where oh yeah
FPS meter doesn't show ah it is
responsive not interesting
alright say what we'll do then let's add
in Mouse events then so mouse down mm mm
mm so yeah I think that should work well
the people who have just joined us or
maybe came a little late what we're
doing is we're implementing swipeable
cards basically we want to use some
JavaScript and some vanilla CSS the
other way around some vanilla G is j/s
and some CSS to implement dismissible
cards on the web in a performant and
kind of pretty way and that's what you
can see on screen and what we are
developing right now
so we're kinda you know we get the 60
frames a second um pretty much
so there you go see what we could do it
might be slightly easier to see if we
take a timeline recording of a bit of a
bit of an animation there we go stop so
these bits here where we get a dip will
be probably yeah
see we're actually seeing animation
frame fire so I think there's a an issue
with canary not picking up the frames
per second here because you can see
there's a regular tick here of animation
frames animation frame fired animation
frame fired animation frame fired so I
think I'm I'm more inclined to say the
frames might actually be there just
devtool to may be missing them yeah I
think this is canary so there could very
well be a very easy but you can see this
it is you know doing the right thing
anyway right so I yeah so we need to
release back do you what I'm actually
gonna switch back to stable because I'd
rather because I was working just fine
for us the thing is um when this card
comes back I'm not releasing the right
we are not releasing the target so we
can't move anything else so so it was if
it's nearly invisible bright so mhm yeah
yeah I know what I'm gonna do
Const is nearly at start equals I know
that is let's take notes people I know
it's nearly at the start and if it's
nearly at the start then we can say this
dot target equals no I'm not gonna have
to think if there's a better way to do
that
beautiful
alright so that's working like it yeah
general I'm gonna do when you get rid of
one of these cards like that I feel like
the other card should slide up into
place definitely can go now with feeling
very nice um
and similarly oh did I generally didn't
do since we've released the target for
this case by the way we should be saying
this no target dot style dot will change
equals initial they have to be motion
we've been waiting for
yeah target the target dot style dot
transform equals non as well so we will
put that back so that's first thing we
can check what we can do is in here we
will go to your card and you can see
that you know we're doing fine I'm pop
at the end transform norm opacity one
could get rid of that capacity as well
if we wanted layer borders you've been
demoted but nice okay so that's good so
the is what we'll do is we'll switch off
those for now and so if you're not
dragging the card actually know if we
did get rid of your card what we want to
do is we want to say this cards for each
and you're going to need the cards card
and what I want to do is I want to say
let is after current target equals false
and what I'm going to do is I'm going to
say if card equals this the target then
I'm going to say that's true I'm going
to return and then if it's not
after the current target done a single
one returns everywhere else why not yeah
all right and so now we know for any
card where we get to this point we know
where after that the current target so
we can say card dot style dot transform
equals this dot target bc r dot height
yeah transform equals translate ech
translate y and it with that so we're
going to translate it to there we are
translate it down
not working no there's errors Paris it
doesn't like it what's the error this
cards for each is not a function because
it's a not an array mmm okay I read a
transfer miss a friend ever got from
different oh do I have to yes you have
made up from stock cards I think in
canario can now actually call for each
on the selector all results see so it's
pushing all these cards down by 200
pixels which is correct except for the
margin because after and they're the
margins are collapsing because web yes
so we need to add in the margin I added
which would be 20 pixels and I'll hard
code it but I guess you would do
something a little bit fancier here so
now there you go so now all our cards
and that was interesting yeah I think I
know what's going on here where he's
heading the transform and I'm also I'm
releasing this and I don't want to
release this yet because we haven't any
meet that see we have to animate on the
end of that animation will release the
target okay so card dot style dot
transition transition equals transform
not point I'm gonna do actually I'm
gonna do it slow
three seconds keep it busy a 1-up cubic
busy not know what not point three one
one that'll be a decent curve and then
you just pulled that right like asleep
didn't you how did really card dot
eventlistener
transition and on transition and and I
am because I want to unhook it
afterwards so I have to make your name
function so I will say contest were on
transition and equals
you were just asked as you're typing the
word Const would you suggest using Const
whenever possible and led only when the
variable actually changes over time yes
so I've gone I've gone full circle
recently - not full circle but I've sort
of iterated on my kind of my thinking I
thought how you feel about it but
basically yes Const I kind of go well if
I didn't intend for this to change and I
know when I'm declaring it actually I
think this thing should for the life of
this function or whatever it should be
remain the same value so if so yeah
Const and I made a mistake because I
used to think that if you had like Const
x equals some objects then you couldn't
mutate a property on that object but
that's not true it's just the reference
to that object and then so yes and a
fallback to let if their values going to
change and then fall back to VAR i
haven't used VAR in a good long term so
I found that constant let gets me all
the way for the stuff I am writing at
the moment in case people don't know let
declares a variable in the block scope
it means it's only valid between the
surrounding two curly braces yeah var
however is function scope and will be
valid throughout the entire function
even if it crosses curly braces
boundaries yes right so so basically
we're gonna say cuz these are all gonna
happen pretty much don't do that do it
you want to get rid of that straight
away so we get rid of the that we're
only we're just gonna so these will all
all these cards will get the same
transition and I guess you could if
you're you know you could basically do
it to one of them maybe I'm going to do
it for all of them yeah it's okay that's
it's really fine I mean it's just gonna
overwrite null a few times but chances
are it's gonna be fine because all the
cards are gonna move in a block so all
being well we'll see them ooh what's
going on there okay yes oh I know what
it is we set them there and then we tell
them to transition but we don't want to
do that what we want to do is we
transform them down we want to request
that animation frame so that style that
transform takes hold okay and then we're
going to switch on transition
and then we're going to set style
transform equals non like that so we we
just assign them the 220 pixels in this
case down and then we wait a frame so
that takes hold switch on transitions
and transform them up so we wait for the
browser to realize that they're actually
now is you know it trends from being
uptight remove childhood know so it
doesn't like remove child of null which
is interesting
mmm-hmm I wouldn't know I doesn't like
it does not like I know well it's it's
closely it's close to there so it's
doing it on every single can week
property so that means that parent
notice Nadi find mm-hmm I have no idea
why so hang on if you're not dragging
the card that's not any visible cards
for each card this seems okay well
because of this right cuz this is the
only place what we call it has to be hmm
I wonder if it's this nice let's just
comment that out so it opens no not just
check us this then it's definitely that
interesting okay it's there because once
it's been detached why would that run
more than once it's nearly invisible oh
because it's still at it's still okay
this is gonna run multiple times so
there's a point where we say right
you're nearly invisible okay but we
still have a target okay
and so it gets that listen it says
parent node well after it's been removed
once it's there's nothing there's no
parent node anymore that's not your
child or not so we need to say if it's
got a parent node like so you can now
tell it to remove child and maybe little
just be super uptight about it there you
go
now we can't do anything here until
that's finished and then oh can we yeah
then we can grab that and those are
really slow now okay so that means that
on here when this is finished we need to
say card dot style dot transition if not
so I'll be mall that goes can't do
anything and now that one goes right
let's speed it up not 0.15 yep yep yep
we hope no cards anymore we have
dismissible cards so look at that
oh that was a jitter then there do you
see yeah I did that one too but did
because of the third card let's find out
slow it down slow it down so that goes
mmm one
see that that's weird why is that doing
that the transition is still set it
shouldn't be it isn't it's because of
the Lala it's the blocks it's not the
blocks coping is it mmm what's the I'm
you know what I'm gonna do I'm actually
gonna do for let's Michael's not eyes
less than they stuck cards dot length I
was bluffing good old for loop I know
right and I'm gonna do black card in
fact we did Khan specially
constellations
all right now the reason this isn't not
this is gonna work is because the let is
scoped to this particular iteration of
the for loop which old-school var would
actually update the var to the nearest
function so this would when the
callbacks fired this would refer to a
different card or something anyway very
intricate detail es6 let and for loops
no unexpected what did I do forty it's
yeah there we go okay mad is not broken
it's really broken again and wonder why
interesting thanks it's okay
let's have a look how's everybody doing
on the chat everybody okay yes everybody
happy people are learning about es6 and
CSS and everything oh cool
good all right if people have been
asking if there's similar sessions for
Android which I think we should forward
to our colleagues yeah Android team well
you know what if you enjoyed that you
know why not let them know let them know
that's a and we can do that I mean
they're just out there so we can do that
can't we I heard you were saying we can
do the Android session I certainly don't
know no it's been a while since I wrote
Java um so there we go right so where
were we we were saying if this is I've
lost my train of thought hmm you had an
arrow that you wanted a fiesta gate yeah
that the cards didn't split up anymore
right yeah right so we know that it
should nearly be invisible at this point
or is it so let's have a check cause
this card just oh it's because the
returned continue I should we continue
not return that is one of the dangers of
refactoring yeah are anything suddenly
it all makes sense again it goes no
jitter no jutsu this time look at that
yeah I think it was just doping thing
that last one was strange though let's
make it a little bit faster cuz that's
just pretty pretty painful
all right looks good no that's not good
the transform is still sad about ya
transition I mean yep so let's think
about why this is we need to it's it's
to do with I think it's to do with the
card I think see well yeah the card
variables buy into a cons that changes
on every for loop right so you only
remove the transition on I should be
doing it for every single every single
one of the but this is a closure that
only binds this it doesn't bind card
right so they God should be fine this
should work well but it should work but
it doesn't work well since it doesn't
work let's let's have a look at what
console we should see at least two cards
and then one card so what do we go a lot
of cards it's a lot of cards it should
maybe add a class so we can distinguish
them from one of the state you can see
the text it's all the Kinlan no hmm it's
all the last card yeah okay we need to
get to the bottom of why this is why
well my theory was that you're looping
over all your cards you'll buy rubber
duck I am your oh but you're my Robo dog
that talks back okay if you never come
across the idea of the rubber duck this
was a blog post wasn't it a few years
ago I think so yeah yeah somebody was
like that I keep a rubber duck on my
desk and the reason I keep a rubber duck
on my desk is because when I get stuck I
just talked to the rubber duck and
talking to the rubric helps me solve my
problems and I guess he's my rubber duck
hello and really you have to introduce
yourself politely to the rubber duck
first I think he does not quack when you
squeeze him what a disappointing duck
yeah I'll buy the upgrade for the next
time alright just than that was it so
hard unbelievable right I'm sorry okay
we need to figure out this one all right
what is the cause why are we seeing so
many cards okay let's let's oh hang on
hang on hang on hang on hang on hang on
hang on right this should be declared
outside the for loop we don't need to
have it so many of them
that's one thing right
how does not define of course it isn't
could it be it's all inside the for-loop
yeah yeah yeah yeah
however we can say we can do function
EVT and we can say this dot bug - TV T
target
where's the card oh come on Paul okay
now the problem which is that this no
longer refers to okay so we're just
going to do this then that is usually
the beauty of the error function to find
this for you automatically
well they don't bind it they just it
falls through the anyway yeah I'm gonna
be pedantic me pedantic strange still
not right is it why is that not right
see at this point we shouldn't have a
transition on this right because we've
set transition event target dot style
dot transition that should have been
totally totally resolved add
eventlistener Tran and I spot that
correctly transition and you know he
just caught right yeah so so
okay sees we're gonna do is we're gonna
say card don't you know this is exactly
how I debug by the way in case anybody's
wondering with a lot of this is how how
you and also I actually work in no it
wasn't very glamorous no it's really not
but we got there in the end there coda
inner text adding event listener and
then I'm just gonna just go
fired no I was not good right this is
the problem this is the problem here why
are we getting so many of these so oh it
yes ah
it's exactly the same problem as before
so we need to say around this every time
it comes into this nearly invisible it's
executing this block which means we're
getting lots and lots and lots of event
listeners oh yeah of course and only the
first one is being removed yeah I know
right now it makes sense right
so what we need to do is we need to say
if this is like this so if you're you
finished dragging okay users finished
dragging there we go
then we've got it to the bottom of this
one day if the card is nearly invisible
nearly gone if Paul starts commenting
his own code Hey no he's being serious
in six months I'm gonna look back at
this code now I'm gonna be like what was
I thinking and this is exactly I don't I
don't believe in self-documenting code
cuz it doesn't know my code anyway maybe
yours doesn't of you you're smarter than
me
I think nobody should believe in that
yeah yeah very I've seen very few
examples that actually are so good in
terms that you don't need documentation
after well so yeah if there's still a
target a target and the target is still
attached
to the Dom oh that's close I'm gonna
there we go
if it's still attached to the Dom we
execute this code Oh Paul no we didn't
they right tell you what we're going to
do that's just bad code so we're gonna
do now I'm going to return okay so if
there's if we got a target and the
target is a paranoid return and what
we're going to do is we are going to
actually undo that move that back in if
right if there's if there's no target oh
you can do it you can invert it that way
you can you know just do it
I'll do the obvious way to do more again
or what there's there's a there's a knot
and is the same as all if you've got
multiple yeah DeMorgan loss okay there
you go and I know of it or in order to
use it I think can be very helpful with
along if expressions yep right so if
it's nearly invisible if we haven't got
a target or we I'm going to target
parent node then basically what we're
gonna do is we're going to say I'm gonna
go through this whole rigmarole here and
that may be enough so we only had it to
event listeners card is not defined
where's the card
oh it's on the transition end
there we go I think I think I've got it
we might have have it we might have it I
think we might have it
wow what a debo likes speed up the
transition and see if it feels right
maybe had some more cards as well yes to
me the Sun affects yes nicely done
sorry mm it's very exciting right let's
we have written code that works I know
dear diary wrote code it worked
let those add some more let's just add
let's add our colleagues from what was
about idea what we're doing right go on
my colleague no no they didn't come into
the room here with me
that's true no I mean like totally
tooling Oh Rd REO and gone team ik go
aunty technically correct yeah and it's
their legal names some there's some guy
I work with Jack Archie bungle think he
does something to do with anything I've
ever heard of them no some the dots
dozen there we are right we have more
and now you can see that this is working
this is working this is what can we can
even scroll down Garret Oh buddy and you
can see the page is actually collapsing
wheelers which is really kind of Handy
it's kind of what we want like hey we
said get rid of Eddie all right I didn't
mean you know I mean I only on the page
I mean I'm not just anyway so good I'm
glad we had this chat right so there you
go
what we're gonna do is let me ask are
there any final questions from the chat
anything anybody wants to know no we had
a few volunteer help that answered a lot
of the questions already
um well in which case let me say thank
you to those people we really appreciate
you chiming in and being part of this
little so that we've had today okay
here's what's gonna happen next then
we're gonna push this code up on to the
github repo we are going to
what are we gonna do after that well
we'll probably run a poll to see which
ones you want next because there's gonna
be happening again at some point yeah
you know doesn't still doesn't quack I
don't I still have to pay the upgrade
first Oh next time it's gonna work I
promise
fine okay well in which case I guess all
is left to say is thank you very much
for tuning in and I've been poor Lois
I'm dust Surma yeah he really is he
finds on Twitter a taro twist at dust
Surma
don't forget to subscribe to the youtube
channel at youtube.com slash chrome
Developers and I guess we'll see you on
the flip side - hello thank you for
being you
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>