<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Router Part 1: TL;DW - Supercharged | Coder Coacher - Coaching Coders</title><meta content="Router Part 1: TL;DW - Supercharged - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Router Part 1: TL;DW - Supercharged</b></h2><h5 class="post__date">2016-06-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/q2azIeeeqZA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to this supercharged TL DW I'm
Paul and last week server and I built a
Rooter let me show you what we built so
you'll have recognized this kind of
thing from you know progressive web apps
or in just any web app really where
you've got a page and you can click on a
nav and it dynamically switches the
second it updates the route in the the
address bar and you can click back and
forth and so on as you go well let's
take a look at the code but no wait
before we do that we need to have
ourselves a chat over in theory corner
Oh welcome to Theory corner theory in a
corner one of my favorite places to have
theory we have our route here and the
reader actually has to have two modes
and a lot of people when they make their
first route they don't realize that you
need both modes you have an active mode
where you tell the Rooter actively I
want to go to this URL but also you need
a passive mode when the URL changes the
route needs to be notified so this is
it's kind of passive mode where it's
listening for the pop state event and in
both cases we're going to handle what
happens with a view so the Rooter can
has to be the middle of your world when
of course when you push actively you
also need to push state as well and
change the URL yourself okay so we've
got all that setup on this side as I say
what we do is we look at say the path
name of the location and then we decide
well which view needs to come in which
view needs to go out if it's the same
view then we need to just update and we
decide all that in here in the Rooter
welcome back to reality I love it over
here it's great this code in reality
super duper let's actually have a look
at some code first of all let's have a
look in the HTML now the first thing to
notice is that we have a couple of
custom elements now you don't have to
use custom owns we just took the
opportunity to give it a try but SC view
here which represents a view that we
want to move between the thing to notice
here is there is a root attribute the
root attribute we're going to use to
decide which view should be shown or
hidden or whatever
further down we also have this SC Reuter
and then you'll see that there's
JavaScript to control both let's have a
look in the SC Reuter then itself itself
extends the HTML element because it's
going to be a custom element and you can
see at the bottom we call register
element down here and we tell it what we
want well that's fine and that means
that we get created callbacks attached
callbacks detached to callbacks all
those kind of things really really
useful because it allows us to have a
life cycle
the main thing to notice is in the
attached callback here we call the add
event listener on pop state and we say
that we've got this unchanged function
and you will discover this unchanged
function is where all the really
interesting stuff happens
same with the detached callback we just
remove it when you create it we actually
set up that unchanged callback and we
actually match a bunch of roots where we
create a map for them so what happens
here is in the ad routes you see we
asked for all the views the SC views and
we step through each one and we add a
route for it which involves creating a
regular expression from the views route
and assigning it to the view so that
later on we can say you know which route
do we have that's the view that we need
to either bring in or take out so that's
actually all the setup work what we need
to do is we need to have a look quickly
at the go function which I mentioned
over there in theory corner this is the
active one
we've got window dot history dot push
state so we're going to push the new URL
and again we call this unchanged well I
think we're ready to actually have a
look at the unchanged so let's head over
there
so the unchanged itself the first thing
we do is we ask for the current path
name and then we step through all the
routes that we have and we try and find
a match if we don't find one well we
just leave not to worry if we do find
one that's when things get a little bit
interesting because there's three things
that could happen we either need to just
bring it in if there's no existing view
if there is an existing view we need to
decide whether we're just updating of
you or whether we're telling one to
transition out so that we can bring our
new one in so let's deal with those one
at a time but it's actually deal with
the state where you've actually got a
current view so there's something up on
screen and it's either
match for the current view the new one
and if it is we can just update it with
any you know new information that we
might have from the URL if not it's
basically a replacement for the current
new current view so we have to tell that
one to go out the current one to go out
and we wait on a promise here and I'll
talk about that more in a moment
whenever the current view has left and
that might happen immediately if there
isn't one we can update our reference to
the current view and we can tell the new
view to animate in now you might have
noticed that these in out and update
functions there there we go I can double
click on if I try out enough in/out and
update and you might be thinking well
where do those get set well remember
back here we actually had SC view
element and we have an SC view class
very similar to the SC Rooter one stands
for supercharged Kapow branding all
right so we've got SC Rooter and SC view
in the SC view here's the in the out and
the update and the main thing about the
in and the out particularly is what they
do is they just simply add a class to
the view and that view is going to then
animate in it's going to do a scale and
an opacity change to kind of fade in or
out depending on you know whether it's
coming in or going when that animation
is finished we fire a transition in end
and that means we can resolve the
promise this is a easy way for us to
chain up these animations so that the
inn can definitely follow the out
animation but you could overlap them you
just decide when you want to resolve the
promise and that will cause the
animation to trigger so there you go
that's all that's involved in making a
Rooter involves making a passive and an
active and it also involves chaining up
a few promises of course you can make a
much more advanced Rooter by allowing
people to load in content lazily and if
you want us to make that one in the next
live stream just pop a comment in below
we're watching those we're going to
respond to them and we really appreciate
your feedback so don't forget to
subscribe to the channel and so and I
will be back in a few weeks with another
live stream I'll catch you right there
there is the live stream you should
watch that if you've got a spare our
brilliant owl there's also the subscribe
or down there either one will work both
good click one of them though good idea</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>