<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Working with Promises | Coder Coacher - Coaching Coders</title><meta content="Working with Promises - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Working with Promises</b></h2><h5 class="post__date">2017-04-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2D1fQgWH-mI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">by this point you should have been using
promises to fetch files and work with
the serviceworker I gave you a quick
introduction in the core technologies
presentation but using then and catch
just scratches the surface of promises
let's go deeper remember that promises
are designed to make asynchronous
programming easier they replace nested
callbacks like this with the then and
catch functions your code becomes easier
to read and error handling becomes much
simpler here's the same code using
promises one thing that may not be
apparent here is that the value returned
from each function is passed to the next
one so the result of get image name is
passed to fetch flag the result of fetch
flag is passed to append flag and so on
if you're familiar with UNIX pipes this
is the same idea note that you return a
single value and each function accepts a
single parameter
this may seem limiting but it works well
in practice now let's add some error
handling all of our examples so far have
put the catch at the end but you can
have more than one catch each catch will
intercept errors for the calls above it
and will continue execution with the
next then in this case the first catch
intercept errors fetching the image name
and substitutes an alternate name
possibly a no image symbol to catch at
the end intercepts and here's above it
and logs the error you might read throw
the exception to let whoever calls this
code know about the error we've been
using promises generated by such and the
serviceworker but you can create your
own normally you would use this to wrap
a callback or event based function
here's an example using a callback based
function do async thing takes a call
back with a result and we want to
convert it into a promise first create a
promise object it takes a function with
two callbacks named resolve and reject
inside the function body
call your asynchronous function in this
case do async thing if it returns
successfully call resolve with the
result of the asynchronous function if
it fails call reject with the error this
might seem like a lot of work just to
wrap up a callback
but you can handle more complex cases
such as code that returns events in
practice a little work wrapping
asynchronous code and promises yields
smaller more maintainable programs we
stored the promise in the variable P so
we can now use a regular then and catch
chain so far we're processing things one
at a time
fetching single files and alike what if
you want to do these fetches in parallel
you can use promise all to run multiple
promises concurrently Thermostat all
takes an array of promises and returns a
single promise when they all resolve or
when one of them rejects this result
will either have an array of results or
the reason for the rejection note that
even if an input promise rejects causing
promise dot all to reject the remaining
promises still run and the results will
be discarded at the time of this filming
there's no way to cancel a promise
though it's under discussion you might
want to run multiple promises and take
the first result to come in from start
race lets you do that
it also takes an array of promises and
resolves or rejects with whatever
promise settles first this behavior
causes an unexpected problem let's say
you have two promises a slow one that
resolved eventually and a fast one it
rejects immediately the fast one will
always win that's a problem because you
may be taking two paths to the same
resource in that case you really want to
wait for the first promise that resolves
not just the first one that settles
happens more often than you think your
service worker might want to try both
the network and the cash at the same
time but if this isn't in the cache or
if the network is down the race will
fail even though the other location
might have the resource the only answer
here is to write your own race function
if you don't like the current behavior
Jake Archibald offline cookbook includes
a replacement race function in ten lines
of code including comments now it's your
turn go to the promises lab in there you
will practice wrapping calls and
promises chaining them together and
catching errors you'll also get to
experiment with running promises in
parallel have fun and good luck one last
thing if you're an instructor this final
slide links to more information on
promises
you're a student these links can be
found in your textbook you may want to
use these while you're working on the
lab</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>