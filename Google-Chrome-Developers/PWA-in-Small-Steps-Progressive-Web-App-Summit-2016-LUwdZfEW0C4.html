<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PWA in Small Steps (Progressive Web App Summit 2016) | Coder Coacher - Coaching Coders</title><meta content="PWA in Small Steps (Progressive Web App Summit 2016) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PWA in Small Steps (Progressive Web App Summit 2016)</b></h2><h5 class="post__date">2016-06-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/LUwdZfEW0C4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">good morning everyone thanks for being
here my name is Jessie young I work for
the mobile web team of booking.com I was
in charge of developing all the
subscribers related six features for our
mobile website and first of all I want
to ask how many of you have used to put
intercom before oh that's a lot thanks
guys and how many of you are from
outside of Amsterdam for this event day
oh did you use dog hell for your
commendations ah that's a small number
but so wise choice for you
you can never go wrong to book a hotel
for in Amsterdam we are a company in
Amsterdam right and booked intercom was
first founded in the Netherlands in 1996
and after 20 years we now have over
nineteen hundred and forty thousand
properties worldwide
and we its day there are over 1 million
room lights reserved our sites and apps
and in terms of the mobile web sites
it was first to build on 2010 and after
six years as you can see the look has
changed a lot and I bet you the code has
changed altitude but all these histories
and numbers contributes to the premises
we need to take into consideration when
we build our sayings for service workers
and the progress of rapa first of all
our website is already highly optimized
it's converging well it's serve the
business needs and there is just no way
we're going to throw it away and build
everything from ground and seconds we
have a very large team that is still
growing fast and we don't want to slow
things down just by introducing a whole
new way of work second we search we have
a very large code base that is serving
the website's found since the beginning
of time like from since 1996 of course
and we have a very convenient a be
testing
the structure we use eveson we use that
for every features we put online and we
just have to use that for or even new
features like service workers that's why
but it's very important to be
progressive and that's the whole idea of
Rubeus web app right and then the team
sat down and looked into the real
possibilities there were potentials we
have four so from service workers and
progressive web app and also what we can
really achieve with it and you know
ideally you should have very extremely
the optimized performance with all this
fancy new patterns and the
infrastructure and technologies
supporter can do you can do percussion
app show and even stream downloading and
better a lot of people have talked about
this from these two days and those so
you can have a fantastic user engagement
experiments you can have full screen
that's opening your web sites are from
the home screen of users you can have
also push notifications to better we
engage your users and for us for our
business it's about such a key reminders
review invitations that is when you
check our hotel we invite you to review
to add reviews for the hotel and also
it's something else like abandoned
baskets when you browse some hotel but
you didn't book when you met you to come
back and finish your booking but we have
a very limited skill for what we can
work on service workers we currently
only have secured that working to
counter men that is what we use for
booking process and opposed to booking
pages all there's users security
sensitive data pages and we don't have
HTTP for the main web sites there are
such results on hotel pages that means
we can't really experiment Barrowman
term much in that in those
pages second is for those user
engagement sayings it's really hard to
see what a real impact is our current
experiment orderin have that much of
metrics for our users offline behaviors
how would you analyze those behaviors
how how would you decide they are good
for your business it's a challenging for
us and also for those pretty
notifications we are a little bit
concerned what to push for those of you
who have used a book into account I bet
you have all these experiments of
receiving many emails from us right and
those and even push notifications if you
used our apps so that's why we don't
really want to Annoying our users even
more with push notification from the
webs and then there is another idea
versus reality check that is
implementation wise implementation wise
you should have web components and for
client-side rendering and all the fancy
things that's making your websites or a
single page app and you should also
ideally have your users always logged in
so that you can put some more
personalized - stuff for them but we
don't have we can't really go for
strings for all these things we still we
are a traditional web page which means
it's simple robust and su friendly not
Eastham that is just some traits you
can't easily give up for just for the
for making your things more technically
the exciting and second we use still use
jQuery we're not ashamed of it and we
use this use jQuery and all the small
pieces of libraries that we have to
write very fast a be testing and
experiments and that's making the whole
or ways of our work is quite
Kanzi is the norm but so we are trying
to still trying to improve the quality
of our codes of course and then for the
users we have mostly last-minute
Booker's and new users that is who is
who will do all in very low frequency
purchases you don't stay in the hotel
every day right and that's why we start
to think about the real small list so
viable steps for our experiments with
service workers what we can really
achieve with it and what is the
meaningful features we can push to our
users first experiment we tried is to
make our booking confirmation page
accessible offline but so without
telling your users that they can access
it offline the reason is that we wanted
to play safe but we still want to have a
meaningful feature online and just to
see how users interact with it we with
this experiment we get the idea of what
the traffic size is like how many
percentage of our users actually have
serviceworker available and we are also
trying to clear the potential roadblocks
that is how to integrate serviceworker
codes with our existing current code
base how to make the build process most
news and also we just delivering this to
users to observe if there is any side
effects like in any aspect and actually
we did in see a few side effects and we
saw much more page views on the booking
process which is not the page we install
the serviceworker
there are the pages under the same
secure topic into account oh man but
people still visited those pages much
more we started wondering why is this
and then explanation would be users
opened the confirmation page a more
often because the
they can reach Cass now and then they
navigate to other pages but well still
can't say for sure whether that's true
or not and we did also see an increase
in page no time why is that when with
serviceworker with all this performance
improve and everybody else is talking
about why we see an increase in the page
load time the explanation would be we
didn't really add any additional cash
for things but because every assets is
already cached by the native caching
mechanism of browser when explanation
might be supposed to encourage consumes
some CPU and somehow make the browser
slower and we didn't see an inconclusive
without sound conversion impact that's
why we didn't really put this experiment
for long and the way went through the
experiment next spearmint is more
meaningful to the users
what kind of telling users to add the
day they lasted me last night
latest booking to the home screen so
they can access their bookings even more
easily and this homesman icon will opens
the last thing confirmation page from
cache and it opens very fast it works
offline and it will always be the latest
booking users made say say if you booked
another booking after you add this home
screen and you open you use that link
again it was still open your latest
working and for this rhombus users just
ignore this spam because it's prompt out
after right after users made a booking
the x2 is next next iteration we added
this explanation banner before we show
the prompt this is done with the before
in stop from event I think even if you
have played with app manifest there
should be
you should be aware of this event and
it's quite straightforward to set up so
we use a click on the spanner which you
distillate upfront with this approach
usually get a better understanding of
what it is and actually a very high
percentage of people who clicked on the
banner will accept the instrument of
home screen icon and a lot of them who
added it to the home screen we actually
use it so they are not just accepting
something you you you you promote to
them they are doing this with the
conscious and this approach also lead to
more people added the home screen than
previous language we showed their prompt
so right away with regarding this I want
to talk a little bit about this
engagement check that is something you
need to pass when you want to display
this prompt this is a flag you can turn
on in chrome which will allow view in
dev mode to always show this prompt but
in real in real life real users will
only see this prompt when they pass some
kind of engagement check and that
criteria is defined by Google it is said
to be the user have has visited your
site at least twice with not with at
least five minutes between visits at
first we thought it's requires user to
leave your site and come back again but
actually it doesn't users can still or
get engaged parsley engagement check in
the first wizard but still that number
is this kind of discount limitation
makes us really hard to control which
type of users can see this feature we
still see a very decent amount of people
who who should've seen the prompt even
when you see it
we don't know it's whether it's really
because they didn't pass
engagement check they didn't meet MIPS
in the five minutes requirement or
whether because some version of Chrome
doesn't support this feature at all or
whether it's because some vendors some
custom rooms of Android disable disable
this feature for good and that's making
it harder for us to really examine the
real impact then I want to dive a little
bit into the code we wrote for service
workers this will show you how powerful
service worker can be just by
intercepting the network requests the
first story we tried is the first one I
want to talk about is consolidating
canonical URLs so the idea is different
URLs for the same resource should fetch
the same caste right or even ID only
fetch the same request we have all these
kind of different structures of URLs
that is actually pointing to the same
same we have language either in the HTML
dark or either in the parameters of
queries and that's why we use to this
sw-toolbox middleware to write our all
middle well to handle this sw-toolbox is
the library way built by google chrome
team if you haven't check it out
do please check it out it's a it
provides all this cash patterns you have
and it's very easy to use so we created
this network first enhanced middleware
which will just which is add a
additional user canonical option to the
options and if this - we will check
whether the request the UI or has a
canonical URL and that is just a
function we wrote on a client side just
to sum Wrigley X matching and try to
figure out so what's the canonical you
are for that specific URL and then if
it's the
Fenster than the requester would just
fire new requests with the canonical URL
and then another story we had is to
homescreen link here with a quick
kitchen if you remember what we added to
users home screen is linked to the
latest booking and their latest booking
will have different URLs right if they
made several different bookings and
that's why we you need to enter for the
app manifest you can only add a static
URL as they start the URL of the home
screen icon so that's why we do this
kind of redirection for the stats URL
and that's redirection will always
redirect to users latest bookings so
this router intercepts all the requests
for the confirmation page and we user
reach that open that confirmation page
each time a 302 redirect your response
was forged on a client site and stored
in the cache and then the last
confirmation endpoint is used for the
start URL and every time user with a
search URL
it'swell goes to a service it will go to
a cache element in service worker router
and it will always try to look at this
302 director from the cache this allows
us to make the Holmstrom icon work as
the shortcuts for users bookings but
actually it is not recommended to do so
now simply because the chrome team has
decided that this is not the best
experience for the users its will feel
weird if you have a home screen I can
that's just opening something in the
browser as a shortcut
starting from crown 51 I think if you
set the display mode in the manifest to
anything else other than standard on all
four screen
you will get this error and the the app
banner will never show up and then we
have another solution for pre-caching
and traditionally for percussion you
will have to like mr. all the URLs in an
array or something and you pass that we
a message to service work and let's
service worker to fetch all the content
but what we did is to fire and Ajax
requests from the client sign page and
add some kind of additional or request
header to it then the service worker
gets to read that header and tries to
figure out whether this is a request for
the cash for pre cash if this is a
request for precache the civil soccer
tries to match in those requests from
the cache and if the cache exists then
the request will never fire if the cache
doesn't request then it fires a request
with no seer with CEO arm as mode set to
no CEO eyes this will enable this a
check request to be able to work even
you request something outside of the
domain and that's some ideas we had for
this Service Worker scene then I'd like
to talk about some final thoughts we
have for service workers and for us it's
always a belt offending the best
approach fits your business needs we are
a very large websites we have a lot of
people working on the same thing we
don't want to sew people down that's why
we have to go into this small step
approach and gradually adding things up
and then you need to be creative on your
solutions I guess some of the direction
and the things quite surprising to you
guys if it is but if it's not sighs so
so okay and we kind of start because we
can't try web completes we can try
polymer then that's why we start to
think about so what else we can try for
that and our general experience with
serviceworker is even if we're trying
something so small we still see
sometimes the API is unstable it's
changing and it has some added
limitation for the lexicon version and
that you don't know you have then you
have to restate your experiment which
prolongs our experiment circles and
that's kind of frustrated to us
frustrating to us and but we still think
the future looks bright for
serviceworker itself and for us as well
so many opportunities still awaits us to
explore and we do want to try the apps
show architecture even that we are not a
single page web app we want to try to
use this streaming API to to return
users a app show screen when they load
to the page and from there the app show
screen will be returned from the client
site but we will stream the real request
from the server that's the plan we want
to try and also we want to try
projective loading this way for example
when you select a room in the hotel page
it often means you want to make a
booking so that's when we decided we can
preload
assets for the process and we also of
course are very open to build a offline
resilient app and once we have HTTPS
deployed for all the web pages we have
then it will become possible and of
course notifications although it's kind
of annoying to some users we will still
want to see the real value of it
and so the message is clear just
experiment and learn even if you are a
large company who has a lot of
restrictions
yes thanks a lot I hope you enjoy your
stay in Sudan
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>