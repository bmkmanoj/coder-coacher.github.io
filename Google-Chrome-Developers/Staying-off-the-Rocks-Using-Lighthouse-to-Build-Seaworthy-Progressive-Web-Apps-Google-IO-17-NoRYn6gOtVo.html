<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Staying off the Rocks: Using Lighthouse to Build Seaworthy Progressive Web Apps (Google I/O '17) | Coder Coacher - Coaching Coders</title><meta content="Staying off the Rocks: Using Lighthouse to Build Seaworthy Progressive Web Apps (Google I/O '17) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Staying off the Rocks: Using Lighthouse to Build Seaworthy Progressive Web Apps (Google I/O '17)</b></h2><h5 class="post__date">2017-05-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/NoRYn6gOtVo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right welcome everybody thanks for
sticking around during lunchtime we're
going to talk about some cool cool stuff
how about lighthouse how you can build
seaworthy progressive web apps for the
web so my name is Eric bidelman this is
Brendan Kenny we are both on the
developer relations team at Google where
you focus on Chrome and web and we
basically just give presentations help
developers use what technologies build
tools build libraries build things like
lighthouse that hopefully will make your
life easier
fun fact about me is that I'm from
Michigan
so I point to where I'm from on my hand
go blue and Michigan actually self
proclaims to have the most number of
lighthouses of any state in the country
so you're basically never going to run
into any shoreline in Michigan because
we are well well-protected
fun fact about brendon is that he wrote
this really really cool demo back in
what like 2010 yeah and it uses what CSS
2d transferring transfer arm why does it
what we only only have 3d on like the
iPhone at the time everybody else was
still stuck in that 2010 not a lot of
support for GPM and awesome stuff like
that but this is really cool part here
where you click as button says don't
click and of course when you do there's
this inception moment we got really
excited about this we actually we hired
Brendan because we saw this demo I have
done some things let's do them right now
well speaking of we both actually work
on Santa tracker every year something
that launches on Google comm it's kind
of fun it uses it's a PWA it uses all
the latest web technology so it's
polymer web components we've got a
serviceworker
there's these games that launch every
kind of day this is one of my favorites
where you can actually give standout
little shave and he's totally cool with
it he's Santa he's the jelly guy the
Santa's gift to you that's brutal
let Olivia but that's a fun one and we
do this because we want to not only
build like real stuff on our team but we
also want to open-source it and have
people learn from these apps that we
build but today we're here to talk to
you about lighthouse and so lighthouse
is a tool for web developers that helps
you improve the quality of your web app
not just PWA but general web that's
this is and it's also for maintaining
the quality of your app because I think
maintenance is actually really important
you want to have the ability to you know
take in pour request from a community
but also ensure that your app is fast
always stays fast and it meets the
progressive web app requirements you
don't want to be this guy this was
actually me back in January where I did
a push to an app engine app my latency
roads like 2 to 4 X because I was doing
way too many database queries totally
just a boo-boo it was a mistake but I
fixed it you can see where the graph
went down man wouldn't it be nice if
there was a tool to help us prevent
mistakes like that only there was a way
to automate if only there was a way you
probably also heard about progressive
web apps here at i/o and probably even
before that so let's say you want to
take go down this journey of building a
progressive web app you've probably seen
our documentation over on
developers.google.com/live and it's all
kind of just a manual process you have
to you know serve your site over SSL you
have to have a serviceworker for offline
and all in that entails responses Add to
Home screen are you fast on 3G if you
actually just go and scroll this page
like that daunting right there's just a
lot of things that you could think about
again wouldn't it be nice if there was a
tool to help us out with some of this
stuff turns out tools are nothing new
they've existed for thousands of years
in many different industries we have
Road Science to help us navigate the
road and divots information we have
lighthouses to help ships at sea guide
and stay away from the coastline so we
said hey this is a great model why don't
we take this and build a tool it does
this for web developers so we kind of
like rewarded the definition of
lighthouse for web developers so
lighthouse is a beacon of light that
guides web developers nothing more
nothing less it keeps you on the fast
path it allows you to know your site's
accessible until you that you're using
best practices that you're PWA
and that your performance last year Paul
Irish who's sitting in a front row right
here with that Paul Alex Leon yeah he he
actually introduced lighthouse and back
then we had we were basically just a
bunch of automated checks for
progressive web apps
we had a really sweet fancy logo done in
done an mspaint
as every life you know alpha project
should have at the time but we've done a
lot of work since then today we're
talking about lighthouse 2.0 so a year
later the open source project is still
open source that we have a bunch of new
stuff in lighthouse so we still have the
progressive web app checks lighthouse
we'll just go through your site we'll
demoed a little second and tell you what
you need to do to be a progressive web
app we have a ton of other stuff so best
practices are you using the latest and
greatest best practices on the web so as
the web continues to evolve lighthouse
will adopt these new practices and then
write audits for them is your site
performant it's great to have a
progressive web app but if it's not
performant no one's going to come back
and use that experience so we have a ton
of new stuff for performance and lastly
there's a whole section dedicated to
accessibility I'll be the first to it
that I often forget about accessibility
when I build things but no more
lighthouse we lighthouse can basically
guide you through this process and tell
you what you're missing we also have a
fancy new logo which is animated and an
awesome new Twitter handle with four
four underscores it's really important
yeah that don't forget that I don't know
why we did that but anyway in the
foreigner story that we created it had
more followers than me that's not fair
so everybody go follow Brendan but with
that I guess that's enough talk
let's go ahead and just demo and show
off lighthouse what you get in a
lighthouse work yeah let's try it out so
if we can switch to that perfect okay so
if you've been over to the mobile web
sent and that you'll have seen a giant
bye house and this is the page that runs
on it it's a simple app you put in a URL
in this text box and it goes and test
your app so we you know done a
simulation here maybe you know marketing
ask for like some tracking scripts and
maybe and uh I don't know a business dev
wanted some extra features here and as a
result your page was gotten a little
slow so let's load the page and I want
to use it so I start typing in a URL but
as you can see it's still loading and it
just erased my progress because some
JavaScript loaded and made it work so we
want to like bitch mark this in
lighthouse the the most popular way so
far has been through the lighthouse
extension which is in the Chrome Web
Store and we can go up here and it's a
simple click to
get lighthouse started it'll actually
clear things out try and load this as a
mobile device would rather Lane network
even throttling the CPU to try and
simulate that and it refreshes a few
times so it can take a look like does it
work offline does it work you know with
a clear load was how the accessibility
look and then here you can see the the
kind of checklist that Eric went through
before so at the top is the progressive
web app checklist how your site is done
as a progressive web app and you can see
that here's four things that we still
need to do get a serviceworker is a big
one and it may be work on our security
but we have seven things that we're
already doing so we're doing okay and we
weren't even track we're doing some
stuff that's good so next up is the
performance section and here you can see
a great breakdown of some really key
metrics that have been talked a bit
about at the show so far we're going to
talk a little bit more about in a little
while but you can see in context of the
screenshots of the page load and down
here accessibility accessibility is a
great one that a lot of people feel like
they have to be experts before they even
start on making their site uh you know
properly accessible but lighthouse is a
great tool to help you get started and
just say like hey make sure you do this
make sure you do this and you have a
bunch of things you're doing great on so
far good job
and finally best practices don't use
doctor dot right you know make sure your
your anchors have like the proper opener
is there external sites that sort of
thing okay so that's lighthouse in the
extension super easy I don't know why
anybody would want so that's a one
button press you get lighthouse get a
lot of information in that but what if
like I'm a power user right is you know
I want to tweak some things that they
want to change some of the default
settings in my house what do you got for
us
yeah well it's plenty of us Eric because
I have a terminal back here Oh what just
for people like you so White House is
also a CLI tool and it's as simple as
NPM install G lighthouse and then we
could do lighthouse you know H tests the
same demo server and then I'm going to
add up you know the pro move adding - -
view to open up the report but there's a
bunch of options here where you can also
do things like turn off network
throttling you know emulate a different
device
that sort of thing so this is just a
little note script it's doing the exact
same thing as what the extension an
exact same saying it's going in the
background here you can see chrome is
loaded and it's going trying to load the
page right in a bunch of audits and
tests and then BOOM got the exact same
report very cool guy - all very cool
okay so Chrome extension it's a one
button press I can run it a command line
use it a note if I'm if I'm in that
environment yeah programmatically -
which we'll talk about right what if you
know I don't really want to install
anything like there is there an even
better way I'm working in you know at
the volume er is a lot of work so if
your web developer and you already have
from-- canary installed you might have
heard this week already
all I recovered this this morning in
Chrome Canary right now you already have
dev tools or you already have lighthouse
in dev tools so you open up dev tools
and you go over here to the audits panel
and you can see here's lighthouse it's
already installed for you you can do
this run audit and I boom there you go
that logo follows you everywhere now
yeah that's awesome yeah the same thing
same open source project is running in
all three these different environments a
take now into the chrome dev tools yeah
so if you've ever felt like contributed
dev tools that's a little intimidating
just go you know contribute to
lighthouse and it'll get put right into
dev tools onto can I'm code running that
yeah everybody can have code in dev
tools now yeah awesome Thank You Brendan
okay
so let's switch back over to which back
slides about performance metrics those
looks fancy yeah so you saw it you saw
some of the performance section in
lighthouse which is something we deeply
deeply care about and many of you
probably care about it too but what's
basic performance is actually really
hard and it's hard to maintain
performance someone submits below
request or a developer comes in and
changes something you don't know if your
app is still going to have that level of
performance that it once had so there's
some metrics out there right you
probably have heard of things like
window.onload and Dom content loaded
these are performance metrics
traditional old-school metrics are these
good things we should be thinking about
in in 2017 Brendan well I mean it really
depends so you know maybe Windows I'll
move fires about when your page is ready
but maybe you know you have a
server-side render page and you bring in
a bunch of JavaScript and all mode is
actually triggering the handlers that
initialize your page and it's going to
be another few
after that two pages ready so it's hard
to say whether window dot onload really
reflects you know when your site load
again what build complex you don't know
if you should care about it yeah wrap
what about so addy osmani always tells
me like reduce the size of your
JavaScript bundle right especially for
mobile you want to parse less code you
want to load less things is this
something good or bad that we should be
considering well it's it's generally
great advice the more JavaScript you
pull down the longer takes the parson
eval on the other hand sometimes it's a
trade-off sometimes you want to go for a
little size increase for like a much
larger performance increase maybe you're
bringing down server-side render to
assets or maybe your pre computing
something that would take a long time to
do on a phone so maybe a little bit size
increase isn't necessarily a bad thing
it's hard enough it's hard to make the
choice it's definitely harder to know so
one thing we're focused on in lighthouse
is really raising the elevation of these
user performance user centric metrics
such as first paint first contentful
paint first meaningful paint and a new
one called time to interactive these are
really about the user's experience not
just like window.onload are your images
loaded are your scripts loaded it's
about what the user perceives during
this lifecycle page load so let's walk
through these in context you want to
take a sure yeah so so yeah so sure you
press Enter you know you start
navigating your page and first paint is
really when the first pixel changes on
the screen that could be you know a
background color that could be something
like this just like some vague structure
next up is first content full paint and
that's when the actual first content is
drawn to screen it might not be the most
important content but something is
actually you know appeared in the DOM
and been painted to the screen so next
up is first meaningful paint and that's
an attempt to actually measure what
actually matters to the user so maybe
that's the content of a story maybe
that's a you know the major the search
box it's the kind of primary element of
the page something that really captures
like hey as a user I'm looking at this
and saying like okay this is actually
what I came to the site for so next up
is visually ready and then time to
interactive so just because something's
painted on the screen doesn't mean it's
actually usable so we've all been to
sites where you know everything's ready
to go and then you try and do anything
and nothing
happens because javascript is actually
spinning the background or something
still loaded typing the input and then
it nukes temecula it just minutes it and
then you want to smash the screen
sometime the interactive tries to
measure that if saying like okay
everything's loaded but now I'm going to
look at kind of a bunch of activity
that's going on and when that calms down
when it's actually able to respond to
user input that's when time to
interacted fires and then finally you
know you're finished fully loaded that
ready to go yeah cool and so this puts
the performance part of the lighthouse
report into a little more perspective
you can see all those metrics are kind
of put into context with the page load
and you can see as that as the page
loads you know really early on that page
has the full layout of the page but try
interactive doesn't fire for quite a
while and I was terrific okay I'm script
bundle yeah it's pretty rough we also
have targets for each of these where you
we think you should be hitting so that's
really important to answering what the
metric is that you should be targeting
okay so let's say I'm a developer right
I want to integrate with lighthouse
right maybe I'm already tracking
performance metrics and I want to kind
of zest in my performance metrics with
those awesome metrics that we just
talked about that lighthouse is giving
you yes bill fill and should be gave a
great talk yesterday web performance
something something very long title um
and they talked a lot about how you know
these are great metrics it's really
useful to be user centered and think
about the user experience but you know
your site better than you know any you
know heuristic does and so if you can go
out and measure the exact moment that
your hero elements ready then you should
absolutely do it yeah so we can do that
by writing a custom audit bugs into
lighthouse okay so before we do this
let's just like get this other way
probably the most boring part of the
presentation which is a little bit of
terminology and architecture that okay
Brendan yeah you get to do the barn but
I decide the boring part okay so in
order to understand how lighthouse works
you kind of under have to understand how
things are set up the first is we're
just just a bunch of node code and
that's the lighthouse portion at the top
there on top of that we actually just
interface with Chrome and the chrome dev
tools protocol it's a really awesome set
of API is essentially anything that dev
tools can do the API can do as well so
super-powerful and this is how we're
going to interface with Chrome and write
a custom audit okay so we have this
lighthouse runner that's for the kind of
controller for for lighthouse and in
this there's three different things the
first is gatherers gatherers are
basically just things that collect
information from the page so in some
cases we actually inject JavaScript on
the page to evaluate something and
that's what the gatherers are doing and
as you saw in Brendan's demo lighthouse
actually reloads the page a couple of
different times and that's why we have a
couple different gatherer passes here
because we have to do things like cut
off the network make sure your service
worker actually serve something offline
just a bunch of other stuff like that
that we need separate runs form so
gatherers interface with chrome through
this little kind of shim that we created
called the driver and that talks to dev
tools protocol so we're built on the
kind of stack of giants everything below
is your stencils protocol is pretty
amazing you can basically do anything
you want in Chrome down to the dev tools
protocol which means that lighthouse can
do anything you'd with me to do
lighthouse fires up it connects to
Chrome it opens a chrome and then starts
running the page and testing things so
when gatherers are done they return
artifacts artifacts then are handed off
to an audit an audit is just basically
just a pass or fail check or something
that applies scoring so in the report
you see scores and you see a check in a
and an X if you did bad those are what
audits are doing they're returning and
evaluating these things that hands off
just a big JSON blob of all the data and
then we go into report generation and so
report is basically just categorizing
these things here's the progressive
WebEx session here's the accessibility
section so on and so forth so gathering
auditing and report generation and that
gets you a lighthouse report alright
pretty simple so with that we're all on
the same page we just write a custom
audit so yeah this isn't something that
we emphasized a lot before this but
actually since the beginning we've
written lighthouse to be super
extensible and you could write a plug-in
really easily because in many ways
lighthouse is just like a really nice
test runner with a bunch of functions
already built for those tests and to
make you know difficult things pretty
easy so as Eric was saying those
three steps and we're going to do all
three of these to write our own thing so
this is that demo page I switch to the
demo straight you want to show the the
metric that were oh yeah yeah so yeah so
let's switch over yeah we get nice the
developer this page is actually already
thinking about that formant they already
feel really guilty that it takes six
seconds for that search box to start
working and so they did the basics that
they could start with and they just log
they're logging that how long it takes
to do that and so we can actually open
up dev tools here and go over to the
console and you can see that they've
they're logging this and the console
Donegan's just so they can feel guilt
every time the page loads five seconds
not very fast for a search box and
they're also saving it to a global
variable just that you know they could
send this anywhere they can sit at the
analytics or something like that we're
going to do the simplest possible thing
and just set it to global variable name
site metrics and in site metrics is the
property name searchable time so it's
the time it takes to get to searchable
state it's you know about 5,000
milliseconds okay so we know that that
global variable is in the page and we
want to use lighthouse to retrieve that
so let's switch back over to the slides
and so so step one we need to gather
that global variable so in my house
every gather extends from a gatherer
base class and that just sets things up
for you and then there's sort of
lifecycle methods which correspond to
during a page load when you want to run
gatherer code so the first stage is
called before pass and that's before the
page loads it runs and it can set things
up or set some sort of throttling up or
something like that but in this case we
don't care we just want that global
variable so instead we go to after path
so after path fire fires after the page
is fully loaded everything's settled
down nothing seems to be loading anymore
lighthouse calls after path from us and
in this case all we're going to do is
get the driver which talks to the
debugger protocol and then there's a
bunch of helper methods on there to make
a lot of things easy and one of them is
evaluate async and evaluate a sink just
runs this JavaScript snippet in the
context of the page and then returns
whatever that result is so that's that
same variable that we saw in the cons
damage that variable in fact
exactly the string that we ran in the
dev tools console window dot site
metrics and just like in the console
it's going to return that object with
property searchable time so in this case
we're just going to return the result of
that and lighthouse will take that and
bundle it up as our as our artifact from
this gather and it'll just use the same
name as the gathered site metric
together that'll be the name of the
artifact okay so now let's go on to the
next stage and actually audit our result
okay so just like gathers every audit
extends from the audit base class and
then I don't need a little more
bookkeeping they have this meta object
which tells lighthouse kind of what to
do with this how to categorize it when
it puts into a report it tells like what
helps text what description to use to
tell your users like you know how to fix
this or something like that
but the most important thing is this
required artifacts there and that's how
the white house hey I'm going to need
the artifact from the gather stage name
site metrics gatherer so every audit has
an audit method and that's called with
our artifacts and in the artifacts is
our site metrics gather artifacts and
just like in the dev tools console
there's a property main searchable time
we're going to get that searchable time
and then our audit there at the bottom
is just is it less than four four
seconds and if it's below four seconds
we pass if it's above four seconds we
fail and we get a big red X in our light
house report and that's not it
super simple and you just chose four
seconds because hey why not well it
seems like a you know reasonable thing
like come on your social I better again
four should have an input before four
seconds so the last thing you do is is
make a configuration file for lighthouse
to tell it how to find the gather how to
find the audit and how to run them so
just like something like eeeh Slynt you
can extend from the the default
lighthouse run and that just tells it
hey run all the normal passes and audits
and gathers that you normally do so that
my my gather my audit can be in the same
context the same report as all the rest
so as Eric was saying we have this
concept of passes this is the number of
times that we reload the page and we
want to say let's put our gather our
site metrics gather into the default
path the first pass is lighthouse
once at our load audit to the list of
audits that lighthouse runs in the
default configuration and then finally
let's make a category in the report just
for our site we're going to call it my
site metrics because that's the best
name we apparently can come up with or
the presentation in our descriptive and
we're going to say hey give it a have
this audit in there and if there was
more audits you know they would be
averaged together and you can have at a
nice weight so again nice weight average
okay so we have a we have a pre-recorded
video so we just for this thing you can
do a Arn start that you can see what
it's running its lighthouse it passes
the config pass to it and the URL it's
running it's running so this is running
lighthouse with all the stuff that
normal light how a default but then if
we scroll all the way down the bottom
you can see my site metrics amazing and
you can see that six seconds for this
run and it totally failed though that we
got a zero on my site metrics and now
you can say like oh well we really need
to do better so this was great we can
run any audit we want that we can write
and have it available for our site
particularly for our site yep and so we
can know when we're doing terrible but
if only there was a way oh wait oh yeah
look there's a nice slide for the camara
but if only there was a way that we
could we get automate it so that I don't
have to run my house every time I could
just have a you know machine check it
for me that would be the ideal we can do
that or we can do that thank you
yeah we can do that that's not a problem
okay all right so you can use lighthouse
programmatically and people often kind
of forget about this they come to us and
they say hey can you add this feature to
lighthouse or can you add this audit
we're like or just node you can write a
program that uses lighthouse any way you
want
so lighthouse is just one require
statement away always keep that in mind
so a cool example of this
we'll just write a couple lines of code
and show you how to use lighthouse from
from note or some for some JavaScript
the first thing you do is require
lighthouse that's no big deal
we have this chrome launcher that's part
of lighthouses code base and that
basically just is the thing that
launches chrome with a debugger port
open
it does things like fine chrome on your
machines flex canary or stable channel
it in turns off some background
processes so that it is a little cleaner
right now trying to download dictionary
you know items or something yeah turns
out some chrome features that you don't
need when you're running lighthouse so
we're just using that we're just gonna
import that and launch Chrome that way
so I'm going to write a little helper
method called launch chrome and run
lighthouse and I'm going to use async in
a wait but you can totally use promises
if you want I just wanted saying yeah
it's hot you're like from the future
their future yeah but it's really it
keeps the code a little cleaner so this
method is just going to take the URL
that we want to test this is the page we
want to test it's going to take a Flags
object we want to pass any flags to
lighthouse and also a placeholder for
the configuration file if we have the
custom config that Brendan just showed
you how to write so in this method the
first thing you do no surprise is just
launched chrome chrome watch out launch
is the method you call and that returns
a promise and then when chrome selects
the port we basically just stash that
port and we're going to forward that on
to lighthouse so chrome is launched
found it set it up for us and then we
actually just run lighthouse and this is
also going to return a promise
and when lighthouse returns we give it
the URL and it's going to give us a
bunch of JSON so we'll just forward on
the URL the flags and it config to
lighthouse once we have the results
we're good to go we can kill Chrome and
now basically shut chrome down using
chrome kill and then we'll return the
results to the caller the way you use
this method you just call launch chrome
and run lighthouse you give it the URL
you want to test so example.com in this
case and we're specifying that we want
the result in JSON rather than the
default HTML file you get and then you
can use the results anyway you want so
that way you can test against it using
your CI or or whatever you want so all
in all like twelve lines of code not not
too hard to use lighthouse
programmatically and that's exactly what
we're doing if you've joined us over at
the the mobile web sandbox during the
show and apologize for the live
streamers you haven't had that we do
have a nice little video of the big
lighthouse over in the sandbox area it's
just using lighthouse in node and it's
using the hue lights API to control the
lights based on the score you get when
you run a
well so quick demo this this is the big
lighthouse where I put in a URL I think
it was like chromestatus.com or
something
in chrome status the PWA does pretty
well and it changes the color of the
light screen come over come over and try
your site and you can get a very
satisfying green glow or you know or red
or not that forelock line to show you
there's some surprises to improve so you
want to check out the code that's on
github under that URL there for the big
lighthouse another thing people often
want to do is you know integrate with
github and pull requests and Travis
right we're a lot of us are doing a
development work on there and so you can
do that as well using lighthouse you
basically want this little beacon of
light following you wherever you go
right and you're on you at Lighthouse
watching your back watching your better
little lighthouse on you good job or so
you want to know if somebody sends you a
pull request if your performance or your
lighthouse score is going to drop and so
we have a demo this as a proof of
concept this is totally doable what I
have here is a pull request on the Left
I don't know what does don't care
because lighthouse is going to help me
on the right Travis is just going to do
its normal thing it's going to build
this pull request run my linting scripts
run my golf stuff so as that's happening
we'll just see that log output go
through we'll check out and see what
this pull request does we'll look at the
changes let's pop over and see so
there's like there's a script tag it's
like loading jQuery which that's okay
yes but there's like this delay thing
and like the second thing and like it
was later than seconds yeah it seems
like an ostrich aníbal yeah so let's
let lighthouse decide I don't know if
it's good or bad but let's let's
determine that through through magic so
we're building the PR and what's going
to happen here is that after this has
done our little helper script is
basically going to send these changes
the pull request changes to my staging
server and deploy it to a staging URL
and the lighthouse is going to go test
that URL return the results and then
modify the pull request so if we do that
you can see this little helper script
called run lighthouse is testing the URL
and I've set a minimum score of 96 I
want to get a 96 or above in order to
pass this pull request and eventually
when all this stuff comes back
lighthouse will finish auditing the pull
request changes and tell me that
this is not a good change hashtag I
promise this is not going to hurt your
performance is not true a lot out so
I've got a 93 out of 96 and I wanted a
96 thanks lighthouse thanks lighthouse
yeah so this is really kind of very
simple to set up we have some example
code if you want to check that out at
the top there again it's just normal
Travis so do everything you're normally
doing like building your scripts and
linting and all that good stuff and then
the magic comes in after success and so
I have a little shell script that
deploys the pull request to App Engine
but you know if you're using firebase or
some other server then you can choose
how to deploy your own stuff and then
there's this example run lighthouse
JavaScript file and that basically just
fires off lighthouse tests it on a
headless version of Chrome in the cloud
and then returns the score I'm passing
to environment variables here the score
that I want to achieve and the URL that
I want to test and in this case it's
that staging server URL on App Engine so
that's how you use lighthouse and get
that little light everywhere on github
and Travis another thing that just
actually happened was chrome launched
headless mode in that guy likes it in
chrome 59 so brand-new stuff but very
cool for automated testing if you fire
up Chrome from the command line you can
pass the - - headless flag and that'll
start chrome essentially without chrome
so it's great for headless testing
Travis automated environments where you
don't need a full UI of chrome you just
want to do some browser testing you can
do some cool stuff from the command line
you can take a screenshot you can create
a PDF so that's your cup of tea you can
dump the Dom so essentially just kind of
curl the page and get the the HTML of
the page there's also a command line
flag for setting the window size which
is kind of convenient if you want to
scale down to a mobile device for
instance so if you want to use headless
Chrome with lighthouse you can totally
do that we talked about the chrome
launcher module that we have in the
lighthouse source you basically just
create the launcher and when you launch
it you pass it an additional flag called
chrome flags and these are just normal
chrome flags so anything you want to to
launch Chrome with you can pass it there
and we'll just pass the - - headless
flag so really easy use lighthouse with
with headless chrome yeah yeah all right
so that's a lot of stuff I'm kind of
tired I'm a little sleepy from lunch oh
that that line is Johnny and it's not
roaring yeah he's not scared you guys
 yawning yeah so with that let's
just kind of recap what we talked about
before we close out here basically if
you're building on the web this is your
web app okay you don't you'll want to be
that guy definitely want to use
lighthouse tests continuously test
integrate it's really really awesome
we're trying to make lighthouse as
friendly and user friendly as possible
don't forget about this useful tool that
could have helped you not do that do you
want to remind sir yeah like everywhere
that you can run my house lighthouse is
available as a Chrome extension and go
install at Chrome Web Store
super easy easy to use easy to just like
drop in anytime lighthouse is available
as a node module and CLI tool we just
shipped the newest version of lighthouse
to NPM so if you want to try out the
newest version and file apps of bugs for
us that'd be great
and there's a bunch of command-line
flexor that we didn't talk about that
you can yeah to tweak again you know
block specific resources you can change
the throttling you can do all sorts of
customization that you wouldn't be able
to do with the extension one thing we
didn't talk about is webpagetest
so webpagetest is a obviously a super
popular tool for that people use to test
the websites it has a great way to you
know share reports after you're done
with them so web page sets actually has
lighthouse
integrated into it if you go down you
can see there's a lighthouse checkbox
there you click that and then at the top
of your report your lighthouse report
score will appear and you can click that
and see the full lighthouse report
available super easy to share or you
know available right now actually and
then as a couple of people have
mentioned throughout IO it's available
now in chrome dev tools in canary right
now you can go try it out and see what
your score is anytime as long as you you
have canary installed okay so that's
where we are right now Eric what's next
I don't know what is next what what is
next our slides I have some slides so
one thing we want to do is kind of be
wherever wherever developers are so
another place that you often go to is
HTTP archive and they have a slew of
data on the web they run against like I
don't know tens of thousands hundred
thousands your URLs and basically have
all this interesting data and surface
that publicly they're considering
integrating with White House so pretty
soon hopefully you'll be able to see how
many URLs out there are progressive web
apps what are their accessibility scores
and the performance scores and best
practice scores and so that's what they
were pretty excited about because then
you can see kind of the shape of the web
over time another one I want to give a
shout out to is calibre which is an
awesome online performance testing tool
and they're integrating with lighthouse
you can actually get lighthouse results
in this tool and you can see their their
scores PWA best practices same
lighthouse stuff so they're consuming
lighthouse and then you can actually
track your performance over time which
really awesome UI for that on the
roadmap for lighthouse itself there's
just a ton of stuff we want to do that
we haven't had time to do yet a lot of
new audits we can we could test anything
really and we'd love to have your help
actually contribute some of those audits
j/s code coverage whether you're you
know you're not using CSS selectors or
not SEO best practices there's a lot of
things you have to like think about in
order to work with crawlers UX right you
know are you popping up an interstitial
can you scroll the page at 60fps these
are really good things like we can just
automate using lighthouse and tell you
if you're doing them well or telling you
if you can improve security and some
other ones and there's also a bunch of
stuff we want to do on a core team as
well so what happens after page load for
single page apps maybe you have an app
behind a login screen maybe there's some
things you want to test after the page
loads and use lighthouse for that faster
auditing just make the whole process
faster as we add more stuff obviously
it's going to get slower so we want to
make it as fast as possible
more integrations and also making it a
lot easier for for folks to contribute
Brendon showed you today how to create a
custom audit but we can make that
probably even easier so the good stuff
is I'm going to throw this up for just a
brief moment if you want to get
lighthouse and NPM you can npm install
lighthouse we have extensive
documentation for reference material for
all of the audits that we have up on
developers.google.com
and if you want to write your own audit
to work with lighthouse you can check
out the dev tools protocol reference
which is really good it's got all the
the api's there that you can learn how
to actually use the dev tools protocol
crazy amount of information you can do
or get from the browser and a crazy
number of things you can't do to the
browser yeah you're also some on the in
the github repo it's like the custom
auto thing went too fast we have some
great recipes in there so that you can
copy and paste it to get started with
scripting my house and doing your own
thing yeah very cool so Brendan and I
are the ones talking you day about
lighthouse but I do want to give a quick
shout-out to the rest of the lighthouse
keepers we have some people that are
working internally at Google on this on
the dev tools team on developer
relations but also we have some folks in
the community that are helping us build
lighthouse so it's not just a Google
project we have a ton of help from the
outside too so hopefully you can come in
and help us out build some stuff so
shout out the lighthouse keepers and
with that my name is Eric bidelman this
is Brendan Kenny and don't forget about
for underscores that's really important
thanks guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>