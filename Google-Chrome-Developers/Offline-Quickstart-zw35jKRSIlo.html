<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Offline Quickstart | Coder Coacher - Coaching Coders</title><meta content="Offline Quickstart - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Offline Quickstart</b></h2><h5 class="post__date">2017-04-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/zw35jKRSIlo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">one of the main features of progressive
Web Apps is their ability to work even
when offline we're going to walk through
an example of converting a static site
for offline use then you get to do it
yourself but let's take a step back and
ask why do this as Sam mentioned at the
start most of the growth in Internet
traffic comes from mobile first and in
some cases mobile only connections this
is often in regions where Internet
connectivity is sparse expensive or just
unreliable if you can cache the files
appropriately users can still have
something under any conditions it's also
much faster to get files from the cache
giving your page native like performance
so how can we make an existing site work
offline you could depend on the browser
cache but it fails if the browser is
offline you might use the older app
cache but it has trouble with file
updates and redirections the
serviceworker was designed to address
these problems you need to write a
script that does two things
fetches and stores static assets via the
cache API and then intercepts fetch
events inside the serviceworker and
retrieves the file from the cache but
first you need to enable the
serviceworker it's exposed on windowed
navigator and the best test is to use
the in keyword to check for the property
call serviceworker dot register and
passing the name of the serviceworker
script this returns a promise that
resolves when the serviceworker is ready
or rejects it if it fails we won't use
the contents of the registration here
but you normally want to save it to
support features like push notifications
let's turn our attention to the script
inside the serviceworker
we'll start by downloading and storing
the site's files in the cache the top of
serviceworker j/s defines a cache name
and a list of paths to cache notice this
we're caching dot that's the path of the
current directory we're also caching
index.html since you can get to the home
page either way you need to cache both
paths
we're also caching the site's CSS file
notice you can list the file path or
even a complete URL and the cache API
will find it
we're going to add those files to the
cache but first we need a bit of
boilerplate code the serviceworker will
emit an install event after registration
the keyword self refers to the
serviceworker when called inside a
serviceworker script and window when
called outside so we listen for the
install of it on self to start building
the cache remember that the
serviceworker can quit when it's not
busy calling event dot wait until keeps
it alive while we build the cache call
caches dot open to create a new named
cache it returns a promise then call a
doll on the cache to automatically fetch
and add the files note that you may want
to catch and log any errors in case
there's a problem with your file list
now that we have the files in the cache
we need the code to retrieve them we're
going to do this by listening for the
fetch event here's our fetch handler
again we're installing the listener on
self the browser calls this for each
file under the service workers control
we get the request and look for it in
the cache if the file is found response
will be a fetch response object in this
case the logical or operator written as
two vertical bars evaluates the value on
the left hand side and returns it if
it's not null otherwise if it is null we
call fetch to get the file from the
network in other words we try the cache
first and if it fails we fall back to
the network calling event dot respond
with returns the result now it's your
turn go to the offline QuickStart lab in
there we'll recreate the code we looked
at here when you're done you'll have a
site that works offline in browsers that
support serviceworker if you're an
instructor this final slide links to
more information on fetch if you're a
student these links can be found in your
textbook you may want to use these while
you're working on the lab and there's
one last thing a few more steps to make
your app more polished you may want to
pause the video now and do the lab if
not let's forge on in this extra credit
section we'll touch on a couple of
things to make your app even better the
first technique is making your app
installable on mobile devices you can
add a manifest file named manifest.json
in the root directory of your app
this lets you specify an icon for the
homescreen a name for the application
and even customize the color of the
browser chrome note that at the time of
this recording this only works on blink
based browsers such as chrome and opera
Mozilla and Apple offers similar options
using an install file or meta tags see
their documentation for details the
textbook will have the latest techniques
now let's improve how we handle the
cache in our original example shown here
we cached a few files and retrieved the
rest from the network can we do better
let's cache any files that we discover
are missing from the cache in this
example we've replaced the fetch
operation with a custom fetch and cache
function here's the function we fetch
the file open the cache store the file
and return the response notice the call
to response clone each response object
can be consumed only once so we make a
copy to store in the cache and that's it
you've now seen the heart of an offline
enabled app we'll go into more
sophisticated techniques later but you
could use this approach today to offline
enable your sites and simple apps finish
the lab if you need to experiment on
your own code and come back for the next
lesson I'll see you soon
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>