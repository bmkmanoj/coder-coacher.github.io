<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Accordion: Live Code Session - Supercharged | Coder Coacher - Coaching Coders</title><meta content="Accordion: Live Code Session - Supercharged - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Google-Chrome-Developers/">Google Chrome Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Accordion: Live Code Session - Supercharged</b></h2><h5 class="post__date">2016-07-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/P2glQ0fz7DM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so usual rules apply I want to be super
clear on this bit as well these are
prototypes we build prototypes in this
show we're not trying to build
production code it's a very important
distinction because what we're not doing
is dealing with every aspect of building
these components like accessibility
we're going to try and do a little bit
of that today
make sure that's at least decent and in
a really good solid foundation we're
primarily focusing on the performance
aspects and just trying to get a solid
foundation and think about these prawns
in the right way but if you're going to
take this code onto production you do
have more work to do you do need to
think about some of the things you will
be judged best now you won't buy him
maybe by others I know anyway so I
actually I wrote all these components on
my first home pages that okay I use in
production and my thought would be great
idea to animate min height or Mac site I
think that means on every frame the
whole text inside the box would be real
layout and I just I just thought that's
the best I can do on that so I just
shipped it and we're gonna do better
today right no I don't know we'll find
out right we're gonna find out okay
let's dive in some codes you've heard me
waffling on long in long enough of
course as usual if you want to involve
yourself you can get on the chat with
Irma he'll be around making sure that
there are links posted and everything
else right to the code I have an HTML
page set here I made myself a couple of
notes on things that I wanted to
remember on my way through and one of
them being lorem ipsum lorem ipsum i cuz
what i want to make sure is that one of
these panels has got a lot of content oh
yeah because we're gonna have to account
for the fact is very easy isn't it to
ignore you know nor your long content
and Spiller yes all my content will be
no longer than 30 characters or
something right well there are custom
elements I guess so on SC accordion why
not supercharged accordion whoo close
that off and I guess we need a bunch of
so I'm doing the whole custom components
custom element approach again we're
making UI elements making our own
components feels like custom elements is
there is a good fit for that but if
eventually they should be usable again
what we're producing is not really
supposed to be were used at yeah right
eventually you want to ask the solid
file is hopefully a solid foundation so
you could take that on if you want to do
so and
ian has a bunch of pains or like tubs
with paintball common SC pain I suppose
let's say I want a bunch of those and
each one let's give that oh so he's got
to have the header so you can click on
like one two three four whatever so I'll
tell you what we'll make it a button and
we'll just do this for now so we're
gonna have like let's say three of those
to begin with we can add more later on
if we want so now I made myself some
notes each of these from a if you've
never seen it by the way folks there is
this on the w3c there is this Aria
authoring practices doc 1.1 and on the
left-hand side I mean if you've not seen
this before Rob Dodson talks about this
in his accessibility talks I don't
yeah from i/o and also from the
progressive web app summit in Amsterdam
and also it comes up in the Udacity
course that Alice Boxhall and Rob Dodson
did so if you're not caught either of
those or all three of those I guess two
talks and of course those are there
they're available for you you should
definitely go and check them out I'm
working my way through the it's a lot of
effort into the Udacity course so it's
really high quality high quality course
that you should take the time to watch
because you know accessibility is
important yes and one of the things that
came up in from Rob was that there's
this document anyway and in here is this
thing about an accordion and it'll tell
you what's expected like all the
keyboard interactions and stuff and they
have this huge list of all the common
components that you usually encounter on
when doing web site and it tells you
what you have to pay attention to when
you want to make these individual
components accessible
yeah cool so alongside the other stuff
that we're gonna try and do I'm just
gonna try and make sure that we do at
least cover off some of the basics of
what one might expect at least like
keyboard controls and tapping and so
forth on my way through but I think
Rob's gonna try and pick up where we
leave off and make sure that you know
it's all just having made you deity
chorus he has much more knowledge
intricacies yes he does right so one of
the things is we need a role and the
role that we want apparently I think for
this is a tab list each one of these is
gonna have a role of tab panel
and then inside each one of these
buttons we're gonna say that's a roll of
tab I think I think I think yeah okay so
I guess each one of those needs the same
deal and also the tough panels you know
why not let's do that and I'm gonna have
to give them a tab index as well so
apparently if you just want it's shot in
the tab water you just have tab index of
zero not right zero one so it means it's
something that is not focusable will now
be focusable correct because by itself
and SC pain is just nothing - I'm gonna
put onto the button because that would
make that would actually be terrible
wouldn't it that should be terrible
let's find out what happens let's leave
it out for now and just see what happens
right so let's get into some styling
just because I found it very confusing
these roles tabla step panel and tab are
three have three different meanings
attached to them so the tab list is the
list of all the tabs just think of the
tab bar in the editor the tabs are these
tablet app panelists the content that is
associated with one tab and that's why
we have three roles at first I thought
they would be really redundant but it
kind of makes sense to have these
distinctions yeah I mean again Rob would
be robbed or Alice would be the right
people to talk about this I assume it's
because of the well the screen readers
make of yeah these roles basically when
they're looking through this anyway I'm
going to wrap this fact one on dudes on
we got two different different part of
the document but basically you can see
I'm setting up myself some content
inside but I'm gonna move it good old
lorem ipsum hey it works in this context
so I'm sticking to it so Dave this is
again I Emmett that people said I should
learn yeah every time every time I'll
it's still not doing no it turns out I
actually have other things on my plate
that prevent me from doing that right
now all right
this is some content builder why not
okay in minds off Condit yeah okay well
this is some more content then yes
vastly different from panel one there
got a cover our eyes abilities okay so
by default
let's do only
gonna need some styles as well so let's
drop that into the top no really cause
style sheet okay href equals styles dot
CSS I mean I shouldn't I mean I mean I
mean I mean come on I could have come up
with something better than styles dot
CSS but I'm sticking to it now all right
fine
so Styles dot CSS CSS well okay let's do
body let's say display let's flex
direction column why not and then we'll
do what we're gonna do
let's do be a line items and justify if
this works I'm gonna be so happy I can I
mean I'm always guessing with this stuff
yeah well this is not some it you can
usually just remember very well I'm
event myself but it looks like it's
actually kind of done the right heading
okay so let's now let's see SC accordion
we're gonna do with see reality we'll do
with hundred percent and you max with
all over you being responsive I know
right I'm trying to get it like I said
trying to give a solid foundation so we
were already starting to lock some of
this in you see what I'm trying to do is
I'm trying to style this so that if we
didn't have JavaScript this this content
would stack up one on top of the other
and I think that's I think they call it
progressive enhancement you did soom
nothing and then you progress I don't I
know I'm sorry dude
fine good right so SC pain I see pain we
will say so T what this box shadow
box shadow box shadow box okay not not
no not three pixels four pixels on GBA
should give us a nice level yeah for now
justify contents and sent it oh you know
what it'll probably be if we do like
high one with our use vh n VW there fine
100 H it shouldn't change visually but
it's just like yeah semantics yes yes I
am okay great thank you okay don't I
sweet woman here so I'm gonna I'm gonna
upgrade to just the t-shirt folks
alright feel better already
do the crazy knuckle cracking thing
which I'm sure everybody just we just
got a question what is up with the SC
elements oh cool so you have to with a
custom element you have to have a dash
in there so you need like X - something
X - accordion se stands for supercharged
cuz it's cost them where like why not go
full custom and drop landing everywhere
but the reason I think originally was
behind the - it's that you can avoid
conflicting with the native elements so
names with alle - are reserved for
native elements for the browser and
everything else is userland cool so
there you go that's why we do FC FC ICU
that's not even 18 pound hey hey there
you go oh yeah no you can do that
because it's the shorthand so it will
expand that anyway people want a padding
on the accordion
no no they do wait wait you I want it -
I mean I'm looking at it going that's
awful table will also do while we're
here we'll do a border radius of two
picks and three pixels wide okay three
pixels that's what happens when it's
active and we'll do overflow:hidden
and then we'll do max height 600 pixels
and you might be wondering what I'm
doing I don't know I'm kidding I'm
kidding and kidding right here's the
thing the default styling for the
accordion I think we only want to do the
max height thing and the overflow:hidden
these too when we're sure we're going to
be able to build it with JavaScript so
let's do like SC accordion enhanced or
something like that and we'll set that
like that so without it it should just
kind of flow whatever height of the is
the content which is fine if we can't
build this what we can do is we can just
chuck in a bit of inline JavaScript here
script and I'm gonna again this will be
something you'd probably do a little
more neat and tidy but I'm gonna do it
in line because I don't want to wait for
a network request for this to complete
so I'm going to say document dot query
selector that dot set attribute
they're cute enhanced and then an empty
string and all being well is there's no
real visual change by the look of it
well you do have an enhanced at should
be there okay so that's a good start
okay so the back onto the actual styling
of these things to the SC pain we got
anything for the head we have a button
which has a roll so we can say yep we
could say button tap like that we can
use that maybe yeah probably was it's
like yeah it's roll roll equals you're
quite right so i just by the way a
future I think is very nice obscene that
you can select by attribute or even at
human value very underused and probably
could save a few classes here and there
and their JavaScript because you don't
need to set classes yes more like a
thing a board a non so a question a few
times which I think I can address yes
this time around we're using visual code
we use the last time too did we yeah
yeah no I switch between from item to
visual studio code last time I'm just
fairly relaxed about which editor I use
because I could press quiche and those
characters appear really yeah I think
the only things I need typically in my
editor are yes lint which is brilliant
yeah I need syntax highlighting for es
2015-2016 stuff and a fair understanding
of you know what that's going to imply
and then I think beyond that I don't
really use much else I know a lot of
people need things like autoprefixer and
other things as well which is exactly
what totally tooling tips is for the
side plug towards the the other chaps
addy and Matt they do a whole show on
the kind of things and things you cannot
your it is me I keeping it I'm keeping
it simple because I a man who likes to
keep things very simple don't say
anything so Matt I know you're fighting
all right okay so this is kind of
starting to add up a little bit better
right let's have a look at the SC pain
car you zoomed out on the main panel
though or it's just the text tiny sorry
at the in the browser in the browser
because I assume the buttons are
probably gonna be hard to read on the
street yeah yeah so what I'll do is I'll
bump all that up I was just trying just
trying to get there just trying to get
something I'm just thinking you know a
team on the chat hello team hello team
if you have questions write them in the
chat or or Twitter or any way you think
you want to Connick sent me an email
might be a little too late
yeah yeah it's not gonna check his
emails a chat the chat is better yeah
and I'll see if I can get incorporated
here and distract him even more I'm
getting buried that no you know well it
depends on whether you consider you're
getting better at it because you're good
at doing yeah thanks good good good to
know you've got my back right now you
see we got this overflow:hidden and so
that's gonna stop me from actually
scrolling the content and actually
anyway these panels are stacking up so
me we've got to fix all that right so
let's do that I think I'm gonna jump
that up to 48 pixels when do that we're
gonna say font size mmm we'll say
background and then my car hopefully
that's okay right
I think we're starting to get to the
point where we can actually add in some
some JavaScript I think right which is
good this is good again you the juicy
part now yeah so in the event that for
example let's just double check that
that's doing its thing in the event that
settings disable JavaScript we don't
have JavaScript the content starting to
just stack up okay
this tip we can get the panel by
pressing f1 Oh every time there's always
something new to learn do what you can
do this gone who did
okay all right so with the javascript
disabled you see the content stacked up
with it enabled we're starting to
actually add on and enhance so let's now
actually get into some more stuff
through with that so let's make our SC
accordion accordion KS so JSC e which is
my shortcut here
I know it's so good for me so let's see
accordion I'm up to SC accordion and
that's all you need for a custom element
by the way these few lines a class that
derives from HTML element and a register
element call ya and you're done and I
answer this question this in the chapter
I will say it again there's a polyfill
that it's like four point five kilobytes
gzip that basically allows you to do
this kind of JavaScript coding even in
IE 9 or 8 I want to say like very far
back mhm it's a very tiny polyfill and
basically gives you a very uniform
platform to work with to do custom
elements it's great I love it because I
get a lot of things that come normally
when you do this kind of code before
this you would do you pass in some kind
of target element and you do like this
dot target dot query selector or
whatever now you just say this dot crew
select it's kind of merges and the job
the lifecycle callbacks and all yes it's
very clean so one of the things I feel
like I want to do here let's see I think
what we want to do is we want to do a
little bit of figuring out where the
elements need to be on screen so for
example if an element is expanded all
the other panels should be you know
either above or below so we kind of need
to
so actually what we're gonna have to do
is we're gonna need a list of all the
pains yeah anyway right yeah so this dot
query selector oh yes let's just start
with that I guess and so SC pain would
be the thing this dot
pains why not so we're gonna grab the
pains when we attach the pains let's say
we want to do this dot mm mm calculate
geometry so that's really nerdy way to
call though whatever let's let's stick
with it for yet it is more descriptive
than bounding playing direct yeah that's
a funny funny name for something okay
here what we want to do is we want to
say this dot pains for each just good
question correct are all in created but
not an attached is what can does not
work like it's a generic way because it
created it so this is a test yet right
it's a it's a node list so it should be
that one find out let's find out let's
find out I mean it will work if it's in
the document but if it create according
dynamically in grade and according then
attach it to the Dom or then attach the
pains and then attach them all right
let's move it
there's tough pains just set it up that
okay okay that's also going to work
right so in the calculate gamma trees
we're gonna say pain index so if oh dear
alright let's think about what we want
to do here if if the pain gets attribute
area expanded so I'm gonna put this
expanded attribute on the pain that is
expanded yeah okay so I'm gonna start
with the first pain expanded alright so
that's what I'm doing if it's expanded
we're gonna have to now what do we need
to know we need to know the height of
right so let's see this dot header
height equals this dot pains zero right
so we need to now we need an early
escape if this dot pains dot length is
zero
just return we can't do anything here
right so that we're gonna ask for the
first pains let's see so we could
actually all let's do this okay so while
we we're jumping a lot today let's see
pain pain yes
Oh HS that's not going to do it renamed
so so what I want here is I want an SC
pain and this is going to apply to all
the pains inside of the accordion okay
so here's a question yeah why did you
call it a tribute area experiment and
not data expanded it's a proper area
attribute that a screen reader would
understand I understand at least
apparently in the context of a tap yes a
tablet or an accordion I think it tells
the screen reader and I think you might
need to use Aria hidden for the other
ones possibly we don't quite know yeah
we're working on this and in the same
way as we work on our performance tough
when we try and understand up it same
goes for the you know security
accessibility you just you know how to
structure a code we're all all a journey
and it also spaces to be explored what
else basically said tabs versus spaces
no you getting into that he'll be the
pun quick quick quiz on the chat tabs or
spaces which is better
oh yeah note go okay while they're doing
that I'm gonna be over here so what I
think we want to do is let's say we want
leave those where they are for now I'm
gonna say get header and I'm gonna say
if this
this that had equals this dot query
selector button role equals tab and then
I'm gonna say return this and in fact
while I'm here because I'm almost
certain I'm gonna need it content okay
we're getting there
singing while you code that's what
apparently spaces is leaving with six
votes was seven votes versus taps with
zero votes we obviously have a web
audience right here we obviously have a
consistent audience which is you know
good yeah no fights yet that's good we
shouldn't have done no stay that
studying alright so we're gonna ask for
the first pain we're gonna actually ask
for its header and then we're gonna ask
for that offset height so you can see
what I've done here is I've asked for
this header which is going to call into
the getter here which is going to query
selector into the to find the button so
it's just a kind of way of just
providing a little bit of an interface
to that header element that should be
inside the pain but we need to make sure
now that we actually have those two
scripts source equals will do the pain
first because so if you register an
element will the browser go and update
all the existing ones immediately I
think yes I believe so I think they
start off life as an HTML unknown
element this will be again this will be
a question for someone like Eric
bidelman true or Rob Dodson again who
both are very very very knowledgeable
about these things but my understanding
is if we couldn't starts off life it's
gonna the browser's gonna see se pain
and se accordion go HTML on unknown
element until the JavaScript kicks in
and we're calling document.register
element SE pain telling it what it is
and he goes oh cool let's do the word
let's do all that work now I'm just kind
of waiting he behaves roughly like a div
right it's just spam I think a span I'm
he's more like a spam because I don't
think it's display:block I think it's in
line I think he's in line so you're like
a spam than a div
I think okay so we can go so we know the
header height that let's just say let's
do this okay now let's leave it where it
is for now because it will see if we
need it later so we're asking for the
header height which we asked for wants
let me just see if that works so today
we'll run the debugger and local header
height is 48 which is correct because
that's that's what I specified here in
so that's that's working as intended
right so what we need to do is the
available height so this is the
available height to the the contents of
the accordion is this stock pains so how
many pains we've got dot length so yeah
that's that times by the header height
and then we want we're going to actually
ask for this little basic math to the
rescue yeah
I'm only good at it so it's the the
overall height of the element drop
another debugger statement to nationally
and again also by the way a nice feature
I just recently learned where you just
type debugger semicolon in your code
chrome will just stop and jump yeah
after the inspector like into the
JavaScript debugging mode even though
you didn't even have it enabled I think
it's a great feature showing up I did
save it right so I should have available
height weird there's no a second but
it's not showing it's not updated my
code yet I wonder whether I just need to
do that
how about disabling cache or something
maybe let's try that disable cache yes
so the available height is 456 pixels
because we've got three panels each of
which has that header one two three yeah
and then the available height is gonna
be that 456 pixels so what we want to do
is we kind of want to set the body
content of each of those elements to be
that 456 pixels it's a very strange
thing that I
look like I'm doing here but it should
all work out in the end so in which case
I'll tell you what we want to do is
we're gonna say that with that and we'll
say overflow overflow why scroll okay so
we can scroll that because what we're
going to define is I think this is long
one here it's going to have its height
truncated and then it's going to want to
scroll scroll that inside so that should
be it should be the right thing there so
what we want to do is let's start this
here we're going to say so what we do is
we'd say pane pane style dot top
no no translate dude how was it
transformed okay okay okay
translate this because I'm thinking
these things through or something this
dot had a height times by the index and
then a pixel thing on the end so for
that to work
the accordion itself is gonna have to be
positioned relative relative and the
panes are gonna have to be positioned
absolute inside that oh you get to all
position at the top and then only work
with transforms there we go there we go
so panel one panel to know I wonder why
why why let's have a look I was
expecting all three to be stacked up
there one and then panel two and then
why is that panel three down there yeah
let's find out do you have an idea oh
that's a no from Surma
wait did you have the pixels outside the
parentheses probably yes that'd be what
is that work good difference oh do you
know why because you want them to be top
zero probably I even said that no no
they're all yes now no transform
translate y so that should be is that
top zero this is always the fun bit is
yeah so why is that pain a seaplane
does it have position top zero though
the top of the earth no that's what I
was wondering is why oh it's because I
put that on the button on the button all
right all pains all pain should be like
so but only when enhanced right yeah
okay you're right so we can do that okay
now that's disappeared well that's not
what I expected ship it yes that's
perfect
okay max height so let's just change it
to height 600 oh yeah of course it
doesn't have high anymore yeah it's so
pretty now it looks really really broken
so what we'll do is we will also say
with 100 let's see if that helps okay so
one two and three doing their thing
which is good don't worry too much about
the overlapping text no no no we're
gonna get to that don't worry we're
gonna get to it so that is all looking
okay I think let's see so we got the
first panel is their second panel is
there and the third panel is there so
that's good now we need to make sure
that each of the accordion heights okay
so then we say pain dot I was right I
need the content so I made another Gator
here for the content you can see that
here where I'm just asking for the
content so a pain doc content dot style
dot height equals
this dot available height in pixels like
so so that we don't mean that these
should all get truncated down which is
fine now what we need to do is we need
to basically in rather this is the kind
of the the offset for each one but we
need to kind of bump the non x1 splendid
ones out of the way
so this one is panel one is expanded
when its content is hidden by panel two
and panel three so we get every one we
want them below the selected one should
be moved down yes we want to basically
move them all down by the available
height right so so that's where this
comes in handy we can say so okay I
think what we're probably going to do is
we'll say let base y equals zero and
we'll do base y plus that so by rights
that wouldn't change anything but if you
hit the one that's expanded base Y
becomes the available height that didn't
work work we have bugs
whose step by step okay
aria-expanded gain attribute hmm okay so
let's go through step by step ball so
none of them think they've got this area
expanded attribute which is unexpected
since I think it's the function running
at all oh yeah I took you like the
others yeah exactly so it's just I'm
just gonna write the penny I'll just do
that yeah so they're gonna metalworking
SC pain you seem to be there till you
can do is well you can do like dollar 0
attribute machine just do paint on you
cuz in scope got attribute yeah re
Thanks she says no I know why I
remembered from Rupp Dodson's talk where
he said the area attributes are really
like that we actually explicitly need to
set equals true in the markup otherwise
the browser will just ignore it
cool all right IRA expanded equals true
you see if that works
yeah no wait resume there we go there we
go nice wait something nice and also
well done Rob Dodson you know putting up
thanks for teaching me the college sir
right so with that we've that done
interesting so we are so now that bright
the panel one is expanded panels two and
three are out of the West yes sir so
real so this this is starting to feel
like something we'd want to actually say
is let's do interaction no there we go
just a bit of a divider line just
between those panels just feel a little
better
how's everybody doing on the chat
they're saying they're learning things
they're learning things they're cheating
our goal man yeah oh load somebody said
add a border bottom between each button
yeah I did that and we came up with yeah
it's good okay all right so here's what
I also want to do as well as I want to
add I'm gonna to focus state here as
well to the button because I think it's
helpful to know not only that the panel
is expanded we can see that slightly the
default for the browser is to put like
this usually bluish outline yellow
around it but I suppose what I'm doing
here is I'm just sort of yeah I'm doing
that too it just so that it's like very
clear which which of the panels is
hopefully gonna have focus in a moment
and you can see also I'm actually
getting tab focus here as well which is
good that's what we want right so now
the question becomes how do we actually
then animate these things seems like a
thing we want to do let me call Paul
Lewis animate transforms and not
positions
wow it's like having another mates that
just to the side okay good
what I think we want to do let's just
say let's do that and we're gonna say
move panels I'm doing this what I'm
doing is I'm moving the the bit that
moved the panel's out to its own
function because I think I'm gonna want
to do that in a mat okay cuz that's the
work that's the works here's something
you see that little flash when I first
refresh and if you saw this it's not
doing it now it did it just a moment ago
there there yes your progressive
enhancement is yeah so exactly so we
should probably account for that and
just say if we've managed to set the
attribute of enhanced okay we should
probably actually set display to non and
then what we'll do is when we get
something where it says say something
like active will set display to block
now you might just say visibility hidden
here actually I think I might do that
today visibility hidden and then
visibility:visible because we don't want
that flash and so now what we have to do
is actually and I can take advantage of
this as well because what I can well
let's just one thing at a time Paul one
thing at a time
freed when we've attached it we're gonna
say this dot class list dot add no it's
not it's not it's not a class set
attribute very tribute it was active so
when we see that now all being well we
should never see that flash it's gonna
be invisible but it'll still take up its
layout so we won't cause a reef reflow
or anything like that right that's good
so that's actually interesting questions
somebody's asking why visibility and not
opacity zero no you could do opacity
zero and if this was a primed element so
I talked about this bunch in my
yeah the side nav one and I talked about
it that's the progressive web app some
in
Amsterdam if you've got an element that
is prime doesn't you're expecting this
thing to be on screen immediately or
could be on screen then using opacity
zero and will change transform stuff is
like it's the right call the difference
is now that when we are switching from
non active to active the browser's
actually to add it to the DOM and render
a Bob with opacity it would already be
rendered yeah so you got to paint it
anyway so in this case like we see that
in when I switch on paint flashing there
you can see that you can see that it
flashes green on screen there because
it's going to paint it either way
whether we do the opacity zero and the
I'm fed in it's a large part of this is
basically gonna depend on the app that
you're building and also how long you
think it's going to take for those
definitions to arrive for those custom
elements if you think it's gonna take a
while for them to arrive you might be
better just you know switching the whole
thing off bearing in mind that I
actually have some styles that are in
this case if I use the opacity zero I'd
still have style changes to make as in
paint changes that would happen when the
definitions came in so even if you're
past the T zero you'd still have to
repaint it and then then fade it in so
I'm just toggling the visibility you
could there's loads of ways you could
play this okay right so now what we need
to actually do is when you click on one
of those buttons we want it to kind of
shift so let's see what we can do there
created callback that's actually a
pretty good thing let's do this what
we'll do no we want to attached I think
we'll do attach to call back attach to
call back yes you do pop yes I do
okay this dot dot ID event listener
listener click another thing that I was
taught by Rob Dodson in his talk I think
is that because we're using a button for
our header and not something else like
an h1 we will get keyboard handling for
free so the click handler will fire even
though somebody is pressing the enter
key on it this is good what you
something you would have to do manually
if you were using a button I'm gonna do
a custom event
because I think that's quite good fun so
there's the type argh which is the
string so what are we going to call it
will call it panel change and then we
need to tell it that it bubbles up so
it's gonna happen on one of the panes
and we're gonna have the accordion catch
it's gonna we're going to delegate
handling out to the accordion itself so
we'll save bubbles cunning tech bubbles
bubbles so we're gonna say this bubbles
up knitting is not happy with me go go
and we don't need that event actually so
we'll just do a custom event and then
dispatch event I think so dispatch event
no it should be window or maybe it's
this let's try this nice about yeah
dispatching event customer hopefully
that will work let's find out what we'll
do is we will have panel change so let's
do this oh I was wrong I'm not keeping
score so this dot add event listener
panel change and then say this dot
change okay so on the panel change we
will do bind over right we'll see I'll
probably do actually I probably probably
good call so we're going to add this
event listener and we'd probably need it
you know remove event listeners but
let's just do this so when we do that
and we click we're firing the debugger
nice so we actually just send a custom
event
yeah it exists before on the platform
and we made it so we made our own
customer event over here called panel
change we set that have a bubble up from
the pain all the way through to the you
know upwards and we just kind of
intercept that at the accordion level by
adding an event listener for panel
change and that is going to work out
really well for us so now we know let's
see so we can have a look at fact back
here we will have
so of course yeah there isn't any so
when we do and just say put the stake
them back in so I click on one of these
and the event is the custom event and
the target for that is the pain itself
which is actually very very useful be
cars so we can say event target dot set
attribute aria-expanded to true like so
maybe you have to do it like that
probably have to do it like that so we
said that and we can say let's say this
dot query selector all actually we can
just do this dot pains we've already got
them list up pains for each and we'll
say pain I just want to say these these
for each map and reduce are my most
favorite things about es2015 this is
good so this filter I really like filter
find Map Reduce once you get to use them
you know I found I had to use in PI a
lot before I kind of yeah that's what
they clicked I don't want to miss many
map his map which ones map again makes
it okay eventually yeah I got them and
for me you know just I don't want to go
back right so for each pain we're gonna
say remove attribute aria-expanded so
they're just removing it from all the
elements just putting it onto the one
that the whichever one was actually
clicked and then after that we can say
request an animation frame we want to we
want to wait because we're going to make
some visual changes to the transform
here so request animation frame and then
we can just say this move panels
so are we doing in requestanimationframe
because we basically need to wait for
the browser to be aware of the change of
the attribute more or less so might work
out fine but I feel like we're making a
visual change and I think I always just
want a default - I'm making a visual
change that should be in a
requestanimationframe if I'm having
multiple there's a good habit yes this
is a habitual thing for me at this
particular point all being well
something would happen but I don't know
that it did so let's have a look out why
so when tapping on this so re-expanded
true or expanded true or expanded true
so so it is swapping the area expanded
into what we can also do while we're
here is we can also say we can do aria
bad attribute hidden true so we could
say that these pals are definitely
hidden and then the one that we want to
work with let's just say Const target
equals that we all say target that and
then targets that and then I still
wonder why it is you gotta spell
debugger correctly for this to work okay
that's working there okay it's not
firing we have an error though we do up
an error pain dad attribute set
attribute is what it really should be so
that's that okay so we'll go back there
fire you okay so that's not firing
that's interesting hmm unexpected so
this don't move ponens is now you should
probably put parentheses behind move
peasant actual make it a call and not
just a reference to a function that'll
be what it is folks yeah not the
debugger statement well done Nick there
you go all right let's see what happens
now
I think that also looked like it went
wrong that's yeah I think so let's find
out
so panel - yeah so panel - huh it's a
penalty penalty so yeah so that one
didn't actually push down where we
expected it to do wait those two it's
just basically it's sitting over the top
of so we got one two we expect that that
trans translate why they're not to be 96
weeks we'd be like 500 or something so
for whatever reason the that get
attribute didn't actually that's because
I'm here because I did I actually did
that right let's try that again there we
go there we go
panel - so this is already really really
close to what you were yeah ain't your
chief so now the last thing then just
kind of need to do here is to set the
background color to be white because you
can see here the on all three yeah
they're overlapping so that's good so if
you want that visual effect go for it so
you can see here I can actually tab as
well so that's actually doing its job
which is cool what we could also do
let's see oh yeah well the major things
no it's not actually animating about to
stop you and be like Paul we are talking
about UI and animations and this is this
is me just - Paul you idiot right when
it's active when the accordion is active
we know that we've in theory got
everything set up well I'd say that
let's go on have a look at the code when
it's attached we do all the blah blah
blah we move the panels and we then we
set the this attribute to active what
I'm gonna do is I'm just gonna hide that
behind the requestanimationframe because
what I want to happen in fact I'm going
to do this do it twice but we'll find
out what's going to happen is we're
going to make all these changes
particularly moving the panels with the
transform I'm about to switch on
transitions on transforms but I want
them moved first so that we don't see
any initial slide of the page
if I'll let me just show you so that
means we're gonna basically put the the
animation to transfer the yeah the
transition only when active when I said
yeah I'm going to do that now just so
that you can see what I mean so when the
accordion is active we're going to say
it tell an SC pain that oh babe pain
that we'd like it to transition on
transform and we'd like to take not by 3
seconds come and do the qbb do you like
so you see when I first do that there
unload we already have real information
with you one initial which just looks it
just smacks of oh I quickly got this
together I don't know it just doesn't
feel right which is why what I was
saying was what I'd like to do is I'd
like to move them first and then switch
on the animation so we can hopefully do
that by just hiding it behind here so
that means new parents will be called
will be take we'll take care of it
positioning the panels yes and then we
will add transitions so now you can see
we've actually got a functioning
accordion we can scroll up and down in
between the panels we can do so we can
tap around what I actually feel like
I've wanted to do those I wanted to
press up and down left and right on the
keyboards and I think that's something
we could add hopefully pretty quickly
here I have a question on the side why
we use overflow why or a scroll and on
auto and I think auto would be the
better choice actually well it depends
so overflow why scroll is going to put
the scroll bar there the whole time on
so what you won't see it here when I've
got a trackpad so here you won't see it
on travel you only see it when I
actually scroll then it fades away and
disappears on a device where you've got
a mouse plugged in often you to see that
the scroll bar just there yes overflow
why scroll right so what do you have
right now right yeah and it but it will
leave a little appearance isten see of
all my panels have scroll bars whether
or not they need at the point you'd have
overflow why scroll if you're happy for
it to just only appear on demand that's
when you use auto so it's a very much a
so it's about a question it's a choice
but both work and I guess
yeah yeah both work in my situation I
feel like I just want the scrollbar
there to be like this just has a
scrollbar if you had a chat with your
design or if you are a designer and
you're like no no scroll bars are only
there on demand
okay well overflow why order for you and
there's no problem there whatever makes
sense for the thing you're building as
usual right so with that said I was
saying I wanted to press kind of up and
down because we're you know we're doing
fine we have time to spare so we can do
this dot add eventlistener
listener key down with key down yeah key
down you can do on input input is very
strange but I think input is only
defined on input elements you know okay
all right how are you how are you with
your your your key codes
I always just consort them and press the
key that I need which one I mean we have
in the newer API so we actually have
string identifier so you can say key
underscore here okey I know score arrow
up or whatever but even then that is one
very well-supported and I still don't
remember the name so just yeah okay
let's do that let's do that way console
dot log PT e dot key code I think this
is this is how I would normally do it
anyway I'll just be like okay I need to
know really end up pulling the switch
case anyway mmm you down that didn't
work hang on set focus on one of the
taps maybe maybe maybe it's that is the
accordion the thing get tapped one of
them no okay that's what it is
did not focus right so up is 38 down is
40 I hope everybody's paying attention
remember those highways tomorrow pop no
pop quiz in about 10 seconds when I go
what was up up is 38 down is 40 left is
37 and right is 39 up 38 okay so it's
basically starting 37 38 with those we
want those charting left and going new
clockwise that makes no sense whatsoever
don't worry about that switch I'm going
to switch and if we see switch and
see case 37 or case 38 and if you ever
write a switch case do people a favor
and put a comment next than what keys
those are so yeah I was gonna do them or
do fancy get everything yes
so key up 38 key left 37 okay key right
key down key remember anybody remember
what key right was somebody said up is
63 and I think they're wrong then that's
not true don't don't make life harder
for us we all right by tomorrow I was 39
it's left and then clockwise that's okay
all right so case let's do that
starting folks you don't know but it is
incredibly warm in this room it's very
very very warm right now there's the
things we go through for you it's it's a
we've got a lot of love in this room
right now key up all right let's do a
key up so this makes it so much more
easy see and you see when you say K yoke
or key left and then that we have added
this to the platform there is the I
think it's called dot key which is a
string and then if I were just switch
that says escape or key up but it's not
widely supported and I don't remember
what the strings are as well yeah there
I can breathe so always is it complain
because it doesn't have a default
expected default case well okay then
fine default nothing break do nothing so
key right and down okay so what we want
to do first of all is like we need to
figure out which one is the currently
expanded item so we can do this dot
query selector and we can say SC pain
which is aria-expanded yeah that would
that would be the thing and what we'd
want to do as we say so we will do let
index equals down thinking thinking
thinking I'm thinking find in underscore
pains yeah but I can't because it's it's
a I can do okay a raid up from so we
have to convert the the node list over
to a thing and then we just say index of
yeah that it's totally what I meant
that's is that really what you meant
roughly okay
so right now find somehow returned an
index but maybe it doesn't so then what
we want to do is you would want to say
index minus minus index plus plus that's
what we want to do there and I think
outside of that we want to say if index
is less than zero index equals 0 else if
index is greater than or equal to this
dot pains I was already doing on the
chat pretty good yeah some people say
they are sitting in rooms just as hard
as hours so I doubt it I'm actually
melting shave imagine if I had hair I
mean how are you kind of looking look
ridiculous I would look I'd actually
looked ridiculous with her if that were
possible I looked more ridiculous with
her anyway
so if we hit the end of the array we're
just going to set that to this dot pains
dot length minus one and then what we
want to do is off by one and then what
we want to do you know we're gonna do
we're gonna have to find that again so
so let's just do const why is that
indented like that oh it is it's in the
it's in the it's right right fine fine
editor is right how dare it okay
Payne's array now whatever it'll be
probably dot faint index function on
array is no there is there is there is
it doesn't return the index though it
returns the item itself that it found so
it you'd be like like Payne's array
would be no be it'll be like let on item
equals Payne's array and then you do dot
find then you give it like and then
whatever criterion you want like P dot
nobody is also apparently Frank index Oh
another function oh I apologize to
whomever said that you want to check
that out on yes I'll quickly go to check
to see if it's actually in yeah but
that's okay so man find index so what's
that gonna return organs are callback
you commit a comment I'm just gonna
leave it as is it's not gonna be broken
what I'm gonna feel but thank you for
teaching me something on me I appreciate
we're all learning things here today
this is why we do the show
alright so we have our pains array we're
going to find on that's expanded we're
going to find its index we're gonna
increment the index we're going to lock
it so that doesn't doesn't go out at the
side and now we want to find the the new
one is going to be pains array index
right this is the new one and then what
we want to do is you want to call this
stop on panel change and we want to do
that with it but pedal change it takes
an even I know well it only it takes
something with the target so we can just
so you know we can just kind of pretend
to be an event and just make it work
yeah like that so all being well that's
strange isn't it well the focus stilts
that you have to call a yellow called
dot focus I guess yeah that's right
you're right I don't want to do that I
actually just want to call you're right
I just want to say pains array dot click
could actually without header focus
I don't ya know I want to find I think
oh yeah we ever just in theory
ooh that's interesting why isn't doing
that if it is greater than or equal to
the pain stop length should have been
okay with that it's just interesting you
won't let me go past one so it's not
happy it was paying stock length
interesting but that should be index
zero one two oh it's that
well
interesting oh of course
oh I don't get it I don't right you
ready for it
yes enlighten me I see this is gonna be
gonna be messy let's think about a
better way
okay so index is basically being reset
each time it starts from the currently
expanded item we don't necessarily want
the selected item yeah so what we want
to do is on the panel change your query
for dot selected or don't focus they
call on focus focus yes you're right you
could you could do the SC pain dot
that's kind of messy active elements on
document or something okay there yeah
you're right but then you'd have to find
that the the containing parent and then
jump to the next player I mean you could
but you're now very brittle because if
that if that structure of your Dom
changes for some reason you're going to
be in a in a funny funny place how's it
going mark somebody said we should
should just do modular there yeah you
can do that definitely can do that but
you would be wrapping around and we
don't we don't necessarily want to wrap
around we might want to just lock to the
end or look to the start so modulo
definitely if you want to cycle round if
it's longer it might actually be good to
wrap around but for now we're going to
keep it yeah so I feel like yeah you
were right what we can do is we can at
least ask for let's see button roll tab
okay I mean we could do SC pane so I'm
just debating this now okay you know
equals tab : focus should work great we
can do that but I just I just want to
make sure okay I'm sorry which way do
you want to do this I would just query
for SC pane space the role equals to
Maryland focus would you just do like
I think I've done this before should we
find out right seed hang on you've got
this here Const selected oh wait
item equals that and that's gonna focus
yeah
focus or focused focus yeah should be
robust wait yeah mister look in the
start and you used it there okay so with
that selected item is the button that's
a lot worked so then we can say selected
item dot parent node right yeah okay see
if that works
you turning the button into an area
right now my aren't you know basically
so we're finding the currently focused
header I feel like that's brittle but
okay we're probably do better but for
now yeah you're right this is prototype
land Paul prototype London live in the
proto okay so we're gonna let the index
be that we're gonna lock it in we're
going to basically if it goes past the
end of the window which is fine we're
gonna do that there we go I think I
think so fairly confident we are working
as intended and if the person was
pointing out that you could do though so
you just do index modulo equals this dot
pains got length this would be another
way to do it so that you basically cycle
round like that yeah which would be
curly is what we have like a lot of
items yeah and actually let's just see
if that works now let's just what we can
do is let's add in a bunch of other
items here while you can add in one more
because this yeah I don't living on the
edge
oh no no I'm really not not today
alright we running long time you can see
it it's working fine with multiple
panels multiple panes and hopefully
folks have enjoyed seeing has worked
through some of those fun bits and
pieces right we did something we did we
did we did we'll push the code as usual
thank you so much for joining us don't
forget you can subscribe somewhere I are
gonna take a bit of a break now over the
summer period just exactly it's just too
warm in here it is too warm so we're
actually gonna try and enjoy the Sun
which is not becoming for the typical
developer I fear but whatever I mean he
likes the Sun I don't like the Sun
together we'll probably making a pretty
average anyway yeah thank you very much
for joining us and we will catch you
probably later in the year
see you then
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>