<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Pi hiding in prime regularities | Coder Coacher - Coaching Coders</title><meta content="Pi hiding in prime regularities - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/3Blue1Brown/">3Blue1Brown</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Pi hiding in prime regularities</b></h2><h5 class="post__date">2017-05-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/NaL_Cb42WyY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is a video I've been excited to
make for a while now the story here
braids together prime numbers complex
numbers and pi in a very pleasing trio
quite often in modern math especially
that which flirts with the Riemann
zeta-function
these three seemingly unrelated objects
show up in unison and I want to give you
a little peek at one instance where this
happens one of the few that doesn't
require too heavy a technical background
that's not to say that this is easy in
fact this is probably one of the most
intricate videos I've ever done but the
culmination is worth it what we'll end
up with is a formula for pi a certain
alternating infinite sum this formula is
actually written on the mug that I'm
drinking coffee from right now as I
write this and a fun but almost
certainly apocryphal story is that the
beauty of this formula is what inspired
live nets to quit being a lawyer and
instead pursue math now whenever you see
PI show up in math there's always going
to be a circle hiding somewhere
sometimes very sneakily so the goal here
is not just to discover this sum but to
really understand the circle hiding
behind it you see there is another way
that you can prove the same result that
you and I are going to spend some
meaningful time building up to but with
just a few lines of calculus and this is
one of those proofs that leaves you
thinking
okay I suppose that's true but not
really getting a sense for why or for
where the hidden circle is on the path
that you and I will take though what
you'll see is that the fundamental truth
behind this sum and the circle that it
hides is a certain regularity in the way
that prime numbers behave when you put
them inside the complex numbers to start
the story imagine yourself with nothing
more than a pencil some paper and a
desire to find a formula for computing
pi there are countless ways that you
could approach this but as a broad
outline for the plotline here you'll
start by asking how many lattice points
of the plane sit inside a big circle and
then that question is going to lead to
asking about how to express numbers as
the sum of two squares which in turn is
going to lead us to factoring integers
inside the complex plane
from there we'll bring in this special
function named KY which is going to give
us a formula for pi that at first seems
to involve a crazy complicated pattern
dependent on the distribution of primes
but a slight shift in perspective
is going to simplify it dramatically and
expose the ultimate gold nugget it's a
lot but good math takes time and we'll
take it step by step
when I say lattice point what I mean is
a point a B on the plane where a and B
are both integers a spot where the grid
lines here cross if you draw a circle
centered at the origin let's say with
radius 10 how many lattice points would
you guess are inside that circle well
there's one lattice point for each unit
of area so the answer should be
approximately equal to the area of the
circle PI R squared which in this case
is PI times 10 squared and if it was a
really big circle like radius 1 million
you would expect this to be a much more
accurate estimate in the sense that the
percent error between the estimate PI R
squared and the actual count of lattice
points should get smaller what we're
going to try to do is find a second way
to answer the same question how many
lattice points are inside the circle
because that can lead to another way to
express the area of a circle and hence
another way to express PI and so you
play and you wonder and maybe especially
if you just watched a certain calculus
video you might try looking through
every possible ring that a lattice point
could sit on now if you think about it
for each one of these lattice points a B
its distance from the origin is the
square root of a squared plus B squared
and since a and B are both integers a
squared plus B squared is also some
integer so you only have to consider
rings whose radii are the square roots
of some whole number a radius of 0 just
gives you that single origin point if
you look at the radius 1 that hits for
different lattice points radius square
root of 2 well that also hits four
lattice points radius square root of 3
doesn't actually hit anything where root
of 4 again hits four lattice points a
radius square root of 5 actually hits 8
lattice points and what we want is a
systematic way to count how many lattice
points are on a given one of these rings
a given distance from the origin and
then to tally them Allah and if you
pause and try this for a moment what
you'll find is that the pattern seems
really chaotic just very hard to find
order under here and that's a good sign
that some very interesting math is about
to come into play in fact as you'll see
this pattern is rooted in the
distribution of primes as an example
let's look at the ring with radius
square root of 25 it hits the point five
zero since five squared plus zero
squared is 25 it also hits 4 3 since 4
squared plus 3 squared gives 25 and
likewise it hits 3 4 and also 0 5 and
what's really happening here is that
you're counting how many pairs of
integers a B have the property that a
squared plus B squared equals 25 and
looking at the circle it looks like
there's a total of 12 of them as another
example take a look at the ring with
radius square root 11 it doesn't hit any
lattice points and that corresponds to
the fact that you cannot find two
integers whose squares add up to 11 try
it
now many times in math when you see a
question that has to do with the 2d
plane it can be surprisingly fruitful to
just ask what it looks like when you
think of this plane as the set of all
complex numbers so instead of thinking
of this lattice point here as the pair
of integer coordinates 3 4 instead think
of it as the single complex number 3
plus 4i that way another way to think
about the sum of the squares of its
coordinates 3 squared plus 4 squared is
to multiply this number by 3 minus 4i
this is called it's complex conjugate
it's what you get by reflecting over the
real axis replacing eye with negative
eye and this might seem like a strange
step if you don't have much of a history
with complex numbers but describing this
distance as a product can be
unexpectedly useful it turns our
question into a factoring problem which
is ultimately why patterns among prime
numbers are going to come into play
algebraically this relation is
straightforward enough to verify you get
a 3 squared and then the 3 times minus
4i cancels out with the 4i times 3 and
then you have negative 4i squared which
because I squared is negative 1 becomes
plus 4 squared this is also quite nice
to see geometrically and if you're a
little rusty with how complex
multiplication works I do have another
video that goes more into detail about
why complex multiplication looks the way
that it does the way you might think
about a case like this is that the
number 3 plus 4i has a magnitude of 5
and some angle off of the horizontal and
what it means to multiply it by 3 minus
4i is to rotate by that same angle in
the opposite direction pointing it on
the positive real axis and then to
stretch out by a factor of 5 which in
this case lands you on the output 25 the
square of the magnitude
the collection of all of these lattice
points a plus bi where a and B are
integers has a special name
they're called the Gaussian integers
named after Martin Sheen geometrically
you'll still be asking the same question
how many of these lattice points
Gaussian integers are a given distance
away from the origin like square root of
25 but we'll be phrasing it in a
slightly more algebraic way how many
Gaussian integers have the property that
multiplying by their complex conjugate
gives you 25
this might seem needlessly complex but
it's the key to understanding the
seemingly random pattern for how many
lattice points are a given distance away
from the origin to see why we first need
to understand how numbers factor inside
the Gaussian integers as a refresher
among ordinary integers every number can
be factored as some unique collection of
prime numbers for example 2250 can be
factored as 2 times 3 squared times 5
cubed and there is no other collection
of prime numbers that also multiplies to
make 2,250 unless you let negative
numbers into the picture in which case
you could just make some of the Prime's
in this factorization negative so really
within the integers factorization is not
perfectly unique it's almost unique with
the exception that you can get a
different looking product by multiplying
some of the factors by negative 1 the
reason I bring that up is that factoring
works very similarly inside the Gaussian
integers some numbers like 5 can be
factored into smaller Gaussian integers
which in this case is 2 plus I times 2
minus I this Gaussian integer here 2
plus I cannot be factored into anything
smaller so we call it a Gaussian Prime
again this factorization is almost
unique but this time not only can you
multiply each one of those factors by
negative 1 to get a factorization that
looks different
you can also be extra sneaky and
multiply one of these factors by eye and
then the other one by negative eye this
will give you a different way to factor
five into two distinct Gaussian Prime's
but other than the things that you can
get by multiplying some of these factors
by negative one or I or negative I
factorization within the Gaussian
integers is unique and if you can figure
out how ordinary prime numbers factor
inside the Gaussian integers that'll be
enough to tell us how any other natural
number factors inside these Gaussian
integers and so here we pull in a
crucial and pretty surprising fact prime
numbers that are one above a multiple of
four like five or 13 or 17 these guys
can always be factored into exactly two
distinct Gaussian Prime's this
corresponds with the fact that rings
with a radius equal to the square root
of one of these prime numbers always hit
some lattice points in fact they always
hit exactly eight lattice points as
you'll see in just a moment on the other
hand prime numbers that are three above
a multiple for like three or seven or
eleven these guys cannot be factored
further inside the Gaussian integers not
only are they Prime's in the normal
numbers but they're also Gaussian
Prime's unsplit able even when I is in
the picture and this corresponds with
the fact that a ring whose radius is the
square root of one of those Prime's will
never hit any lattice points and this
pattern right here is the regularity
within prime numbers that we're going to
ultimately exploit and in a later video
I might explain why on earth this is
true why a prime numbers remainder when
divided by four has anything to do with
whether or not it factors inside the
Gaussian integers or said differently
whether or not it can be expressed as
the sum of two squares but here and now
we'll just have to take it as a given
the prime number two by the way is a
little special because it does factor
you can write it as one plus I times one
minus I but these two Gaussian Prime's
are a 90 degree rotation away from each
other so you can multiply one of them by
I to get the other and that fact is
going to make us want to treat the prime
number two a little bit differently for
where all of the stuff is going so just
keep that in the back of your mind
remember our goal here is to count how
many lattice points are a given distance
away from the origin and doing this
systematically for all distances square
root of n can lead us to a formula for
pi and counting the number of lattice
points with a given magnitude like
square root of 25 is the same as asking
how many Gaussian integers have the
special property that multiplying them
by their complex conjugate gives you 25
so here's the recipe for finding all
Gaussian integers that have this
property
step one factor twenty-five which inside
the ordinary integers looks like five
squared but since five factors even
further as two plus I times 2 minus I 25
breaks down as these for Gaussian
Prime's step 2 organize these into two
different columns with conjugate pairs
sitting right next to each other and
once you do that multiply what's in each
column and you'll come out with two
different Gaussian integers on the
bottom and because everything on the
right is a conjugate with everything on
the left what comes out is going to be a
complex conjugate pair which multiplies
to 25 picking an arbitrary standard
let's say that the product from that
left column is the output of our recipe
now notice there are three choices for
how you can divvy up the primes that can
affect this output pictured right here
both copies of 2 plus I are in the left
column and that gives us the product 3
plus 4i you could also have chosen to
have only one copy of 2 plus I in this
left column in which case the product
would be 5 or you could have both copies
of 2 plus I in that right column in
which case the output of our recipe
would have been 3 minus
for I and those three possible outputs
are all different lattice points on a
circle with radius square root of 25 but
why does this recipe not yet capture all
12 of the lattice points remember how I
mentioned that a factorization into
Gaussian Prime's can look different if
you multiply some of them by I or
negative 1 negative I in this case you
could write the factorization of 25
differently maybe splitting up one of
those 5s as negative 1 plus 2 I times
negative 1 minus 2i and if you do that
running through the same recipe it can
affect the result you'll get a different
product out of that left column but the
only effect that this is going to have
is to multiply that total output by I or
negative 1 or negative I so as a final
step for our recipe let's say that you
have to make one of 4 choices take that
product from the left column and choose
to multiply it by 1 I negative 1 or
negative I corresponding to rotations
that are some multiple of 90 degrees
that will account for all 12 different
ways of constructing a Gaussian integer
whose product with its own conjugate is
25 this process is a little complicated
so I think the best way to get a feel
for it is to just try it out with more
examples let's say instead we were
looking at 125 which is 5 cubed in that
case we would have 4 different choices
for how to divvy up the prime conjugate
pairs into these 2 columns you can
either have 0 copies of 2 plus I in the
left column one copy in there 2 copies
in there
or all three of them in that left column
those four choices multiplied by the
final four choices of multiplying the
product from the left column by one or
by I or negative 1 or negative I would
suggest that there are a total of 16
lattice points a distance square root of
125 away from the origin and indeed if
you draw that circle out and count what
you'll find is that it hits exactly 16
lattice points but what if you introduce
a factor like 3 which doesn't break down
as the product of two conjugate Gaussian
Prime's
well that really MUX up the whole system
when you're divvying up the primes
between the two columns there's no way
that you can split up this 3 no matter
where you put it it leaves the columns
imbalanced and what that means is that
when you take the product of all of the
numbers in each column you're not going
to end up with a conjugate pair so for a
number like this 3 times 5 cubed which
is 375 there's actually no lattice point
that you'll hit no Gaussian integer
whose product with its own conjugate
gives you 375 however if you introduce a
second factor of 3 then you have an
option you can throw one 3 in the left
column and the other 3 in the right
column since 3 is its own complex
conjugate this leaves things balanced in
the sense that the products of the left
and right columns will indeed be a
complex conjugate pair but it doesn't
add any new options they're still going
to be a total of 4 choices for how to
divvy up those factors of 5 multiplied
by the final 4 choices of multiplying by
1 eye negative 1 or negative I so just
like the square root of 125 circle this
guy is also going to end up hitting
exactly 16 lattice points
let's just sum up where we are when
you're counting up how many lattice
points lie on a circle with a radius
square root of n the first step is to
factor N and 4 prime numbers like 5 or
13 or 17 which factor further into a
complex conjugate pair of Gaussian
Prime's the number of choices they give
you will always be one more than the
exponent that shows up with that factor
on the other hand 4 prime factors like 3
or 7 or 11 which are already Gaussian
Prime's and cannot be split if they show
up with an even power you have one and
only one choice with what to do with
them but if it's an odd exponent you're
screwed and you just have zero choices
and always no matter what you have those
final four choices at the end by the way
I do think that this process right here
is the most complicated part of the
video it took me a couple times to think
through that yes this is a valid way to
count lattice points so don't be shy if
you want to pause and scribble things
down to get a feel for it the one last
thing to mention about this recipe is
how factors of two affect the count if
your number is even then that factor of
two breaks down as 1 plus I times 1
minus I so you can divvy up that complex
conjugate pair between the two columns
and at first it might look like this
doubles your options depending on how
you choose to place those two Gaussian
Prime's between the columns
however since multiplying one of these
guys by I gives you the other one when
you swap them between the columns the
effect that that has on the output from
the left column is to just multiply it
by I or by negative I so that's actually
redundant with the final step where we
take the product of this left column and
choose to multiply it either by one I
negative 1 or negative I what this means
is that a factor of 2 or any power of 2
doesn't actually change the count at all
it doesn't hurt but it doesn't help for
example a circle with radius square root
of 5 hits 8 lattice points and if you
grow that radius to square root of 10
then you also hit eight lattice points
and square root of 20 also hits eight
lattice points as does square root of 40
factors of two just don't make a
difference now what's about to happen is
number theory at its best we have this
complicated recipe telling us how many
lattice points sit on a circle with
radius square root of n and it depends
on the prime factorization of n to turn
this into something simpler something we
can actually deal with we're going to
exploit the regularity of Prime's that
those which are one above a multiple of
four split in two distinct Gaussian
prime factors while those that are three
above a multiple of four cannot be split
to do this let's introduce a simple
function one which I'll label with the
Greek letter Chi for inputs that are one
above a multiple of four the output of
Chi is just one if it takes in an input
three above a multiple of four then the
output of chi is negative one and then
on all even numbers it gives zero so if
you evaluate Chi on the natural numbers
it gives this very nice cyclic pattern
one zero negative 1 zero and then repeat
indefinitely and this cyclic function
Chi has a very special property it's
what's called a multiplicative function
if you evaluate it on two different
numbers and multiply the results like
Chi of three times Chi of five it's the
same as if you evaluate Chi on the
product of those two numbers in this
case Chi of 15
likewise Chi of five times Chi of 5 is
equal to Chi of 25 and no matter what
two natural numbers you put in there
this property will hold go ahead try it
if you want so for our central question
of counting lattice points in this way
that involves factoring a number what
I'm going to do is write down the number
of choices we have but using Chi in what
it first seems like a much more
complicated way but this has the benefit
of treating all prime factors equally
for each prime power like five cubed
what you write down is Chi of 1 plus Chi
of five plus Chi of five squared plus
Chi of five cubed you add up the value
of Chi on all the powers of this prime
up to the one that shows up inside the
factorization in this case since 5 is
one above a multiple of four all of
these are just one so this sum comes out
to be four which reflects the fact that
a factor of five cubed gives you four
options for how to divvy up the two
Gaussian prime factors between the
columns for a factor like three to the
fourth what you write down looks totally
similar Chi have one plus Chi of three
on and on up to Chi of three to the
fourth but in this case since Chi of
three is negative one this sum
oscillates it goes 1 minus 1 plus 1
minus 1 plus 1 and if it's an even power
like 4 in this case the total sum comes
out to be one which encapsulates the
fact that there is only one choice for
what to do with those unsplit of all
threes but if it's an odd power that sum
comes out to zero indicating that you're
screwed you can't place that unsplit of
all 3 when you do this for a power of 2
what it looks like is 1 plus 0 plus 0
plus 0 on and on since Chi is always 0
on even numbers and this reflects the
fact that a factor of 2 doesn't help but
it doesn't hurt you always have just one
option for what to do with it and as
always we keep a 4 in front to indicate
that final choice of multiplying by 1
i- 1 or negative i we're getting close
to the culmination now things are
starting to look organized so take a
moment pause and ponder make sure
everything feels good up to this point
take the number 45 as an example this
guy factors as 3 squared times 5 so the
expression for the total number of
lattice points is 4 times pi of 1 plus
Chi of 3 plus Chi of 3 squared times pi
of 1 plus Chi of 5 you can think about
this as 4 times the 1 choice for what to
do with the threes times 2 choices for
how to divvy up the Gaussian prime
factors of 5
it might seem like expanding out this
sum is really complicated because it
involves all possible combinations of
these prime factors and it kind of is
however because Chi is multiplicative
each one of those combinations
corresponds to a divisor of 45 I mean in
this case what we get is 4 times Chi of
1 plus Chi of 3 plus Chi of 5 plus Chi
of 9 plus Chi of 15 plus Chi of 45 and
what you'll notice is that this covers
every number that divides evenly into 45
once and only once and it works like
this for any number there's nothing
special about 45 and that to me is
pretty interesting and I think wholly
unexpected this question of counting the
number of lattice points a distance
square root of n away from the origin
involves adding up the value of this
relatively simple function over all the
divisors of n to bring it all together
remember why we're doing this the total
number of lattice points inside a big
circle with radius R should be about pi
times R squared but on the other hand we
can count those same lattice points by
looking through all of the numbers n
between 0 and R squared and Counting how
many lattice points are a distance
square root of n from the origin let's
go ahead and just ignore that origin dot
with radius 0 it doesn't really follow
the pattern of the rest and one little
dot isn't going to make a difference as
we let our grow towards infinity now
from all of this Gaussian integer and
factoring and Chi function stuff that
we've been doing the answer for each n
looks like adding up the value of chi on
every divisor of n and then multiplying
by 4 and for now let's just take that 4
and put it in the corner and remember to
bring it back later
at first adding up the values for each
one of these rows seems super random
right
I mean numbers with a lot of factors
have a lot of divisors where as prime
numbers will always only have two
divisors so it initially seems like you
would have to have perfect knowledge of
the distribution of primes to get
anything useful out of this but if
instead you organize these into columns
the puzzle starts to fit together how
many numbers between 1 and R squared
have 1 as a divisor well all of them so
our sum should include R squared times
Chi of 1 how many of them have two as a
divisor well about half of them so that
would account for about R squared over 2
times Chi of 2 about a third of these
rows have Chi of 3 so we can put in R
squared divided by 3 times Chi of 3 and
keep in mind we're being approximate
since R squared might not perfectly
divide 2 or 3 but as R grows towards
infinity this approximation will get
better and when you keep going like this
you get a pretty organized expression
for the total number of lattice points
and if you factor out that R squared and
then bring back the 4 that needs to be
multiplied in what it means is that the
total number of lattice points inside
this big circle is approximately 4 times
R squared times this sum and because Chi
is 0 on every even number and it
oscillates between 1 and negative 1 for
odd numbers this sum looks like 1 minus
1/3 plus 1/5 minus 1 7 and so on and
this is exactly what we wanted what we
have here is an alternate expression for
the total number of lattice points
inside a big circle which we know should
be around pi times R squared and the
bigger R is the more accurate both of
these estimates are so the percent error
between the left hand side and the right
hand side can get arbitrarily small so
divide out by that R squared and this
gives us an infinite sum that should
converge to PI and keep in mind I just
think this is really cool
the
reason that this sum came out to be so
simple requiring relatively low
information to describe ultimately stems
from the regular pattern and how prime
numbers factor inside the Gaussian
integers if you're curious there are two
main branches of number theory algebraic
number theory and analytic number theory
very loosely speaking the former deals
with new number systems things like
these Gaussian integers that you and I
looked at and a lot more and the latter
deals with things like the Riemann zeta
function or its cousins called L
functions which involve multiplicative
functions like this central character
Chi from our story and the paths that we
just walked is a little glimpse at where
those two fields intersect and both of
these are pretty heavy-duty fields with
a lot of active research and unsolved
problems so if all this feels like
something that takes time to mentally
digest like there's more patterns to be
uncovered and understood it's because it
is and there are so you are all
demonstrably the kind of people who
watch in depth math videos in your free
time and I know that some sub portion of
you are software engineers or at least
soon-to-be software engineers so before
you go there's a little recruiting that
I'd like to do this video is sponsored
by remix which is a planning platform
for public transit they enable cities to
find the most efficient and
cost-effective ways to serve communities
and the demographics that they want and
if you think about it for a moment doing
that well can involve some seriously
interesting optimization problems and
indeed they're looking for
mathematically oriented programmers who
can tackle problems involving a variety
of optimization techniques so that as
one of their engineers phrased it to me
they can trick the universe into letting
them create quality schedules if you
want to work with some smart people on
interesting problems take a look at
their site and their careers page which
I've linked on the screen and in the
description</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>