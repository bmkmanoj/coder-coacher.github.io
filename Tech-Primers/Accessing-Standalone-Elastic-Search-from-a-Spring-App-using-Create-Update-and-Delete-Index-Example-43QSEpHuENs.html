<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Accessing Standalone Elastic Search from a Spring App using Create, Update and Delete Index Example | Coder Coacher - Coaching Coders</title><meta content="Accessing Standalone Elastic Search from a Spring App using Create, Update and Delete Index Example - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Tech-Primers/">Tech Primers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Accessing Standalone Elastic Search from a Spring App using Create, Update and Delete Index Example</b></h2><h5 class="post__date">2017-05-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/43QSEpHuENs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to take primers in this
particular video we are going to see how
to use the elasticsearch so in my
previous video if you notice I would
have used a last six search along with
spring data so that it comes up as a
single instance inside a spring boot
application so basically a elasticsearch
instance is wrapped inside a spring good
application using spring data but in
this particular example we are going to
use how to use the raw elastic search
which is running as a subject process so
how can we access the data from that
process indirectly using the rest
endpoint so there is something called
transport client which elastic itself
provides as a jar dependency so we are
going to see how to use that from a
spring buta plication to call an
external elastic search server so
basically I have a spring board
application which is running so from
this particular application I am going
to call a elastic instance which is
already running there in a different
port so we are going to insert update
and delete the data so let's get started
so what I have done is I have already
downloaded the elastic search instance I
have just downloaded the elastic search
and then I have extracted in a in a
folder for so that we can start so
meanwhile before we create the project
let's go ahead and start that right so I
have a I have a terminal here so if you
notice here I am already there in the
elastic search folder so I'm inside the
bin so I just need to start the elastic
search this way so I am just starting
the elastic search server so what
happens is then this particular server
comes up it comes up in two different
ports so one specifically for accessing
for the HTTP client one is for the
transport client so if I quickly go and
do a localhost colon 9 to double zero so
this is where the elasticsearch HTTP
server will be running and that will be
another port which will be
nine three double zero so this is where
the transport client will be running so
let's see let's check that after the
elasticsearch instance is up but that is
coming up meanwhile let's go and create
our skeleton right for our springboard
application so so I am going to create a
chrome tech primers and say elastic I am
going to name this particular
application is elastic standalone
elastic example okay so I'm going to
just use this bring them so I am NOT
going to use anything extra they are
going to add elastic dependency
separately if you put a elastic here
this is going to bring this print data
elastic if you see here elastic fusional
is including a string data let's not do
that let's add that separately so let's
go ahead and create this project okay
save it in downloads okay it has got
onboard let me unzip the project so that
we can open any intelligent the project
is unzipped let me go on open and
IntelliJ
so what did we name my project plastic
gentlemen elastic example yeah okay
let's open that in the integer you'll
just maximize it so if we note this here
has it come up let's go to the URL and
check if it has come up yeah the
elasticsearch instance has come up if
you notice here if I hit the local
Lowe's nine to double zero it is giving
me a response so this is basically
telling us that elasticsearch instance
which is which we started separately has
come up okay now let's go to the 9:30
double zero 45 into a refresh I won't be
able to do anything because that is that
is not allowed to do HTTP requests
however that part also is running okay
so using that port we are going to
connect and pull the data because if you
want to do any rest call you can use
this directly if you are creating
resting points and if you are creating
JSON directly then you can use this nine
to double zero but if you are using the
transport client which the elasticsearch
queue so if I open the documentation of
elasticsearch they are giving something
called a transport client okay so if we
can use that and then we can easily get
data without even having to do restraint
work so internally it uses some similar
communication layer to get that from the
elastic layer from the elastic search
okay so the project has come up in
intelligence so let's go ahead and
create some rest endpoint right so using
spring MVC so basically one of my viewer
here requested to create a spring MVC
application which will directly connect
to the elastic search and get the rate
and so for that purpose I am going to
create and show him using a string boat
or a spring MVC rest endpoint okay
someone is doing MVC so I'm going to
create a restaurant one I'll just create
it as the resource okay I'm just going
to say user for source just for our
simplicity okay so we this is going to
be a rest controller so I'm going to
mark it as a rest controller it's going
to be running at user slash slash shoes
okay
this is what the standpoint is going to
be so what I'm going to say is I'm going
to expose something called wanna say
object for now so Kate first I will say
insert right okay so in that case we can
just blindly insert some data and I'll
just work it okay so here I will say get
okay just for our sake so what we are
doing going to do here is we need to now
use the transport client to access the
elastic search engine so for that what
we need to do is we need to add elastic
search dependency into our project so
right now we don't have any elastic
source dependency so we need to add the
elastic search dependency so what I am
doing here is I have created some live
live templates in intelligent so that I
do not have to type everything again so
I have created some live templates so if
i am using some shortcuts or something
like this don't get amazed - so it's a
live template so basically i have just
used in this particular core piece of
information and then i just or it as a
template so that i can't we use it
across so you can also try when you're
typing something which which you use
very often so you can create that as a
live template so if i select this right
i can do something like this so i can go
and save as a template and then you can
give some name to it so that you can use
it next time okay so that's what I have
done so what we are doing here is we are
going to add a dependency to
elasticsearch account the thing over
jailer sticks elastics also spring boat
already has some elastic size dependency
I am just putting that out with the
version number 5 or 0.0 okay so the the
transport client version which I am
going to use is Phi dot 0 dot 0 and also
let's add a property called the elastic
search short version saying Phi dot 0
dot so you know so this is what string
will be using spring both will be using
to get this particular guy so the main
elasticsearch dependency okay then we
need to add the log4j dependency so the
log for c2 we need to add so I am using
the spring boot 1.5 version so I need to
use log4j 2 dots
if you're using a lower version of
spring boat say 1.4 then you have to use
2.6 door 2 because there is a breaking
change inside the log4j into Roger so it
is better to use spring boat 1.5 with
Tuluksak okay so we have added the
dependency for our project now let's go
and start writing the client code right
so what I have done is I have created
again same rest template I have created
a live template okay so water we have
done here is we are creating a transport
client okay this transport client is
basically nothing but provided by
elasticsearch okay so we are using this
transport client to create a
communication layer between our
application and the port 9-3 doubles it
okay so basically this is creating a
client a client connection between the
server which is there in nine to double
zero so I think it will last for that we
just say method signature okay so what
we are doing in the first line is we are
just creating a client okay we are
creating client occurs and using the
clients of course they are going to
inject some data so what I am doing is I
am going to say prepare index so what
this will do is this will create an
index for look at this is going to
create an index using a called employee
and the type will be ID and then my
index will be one so I am just saying
that insert the data into employee / ID
plus one so if I go to the URL here if I
type that employees / ID / 1 I am NOT
going to get any data if you see here
found is false so basically there is no
data inside elasticsearch for that
particular index type and the value okay
so what I am going to do here is I'm
going to create an index and for T data
which is here so basically I am creating
a JSON builder and I am saying name is
AJ salary is third tool to 100 and then
team name is development okay and then
finally I am just getting that response
back so what I what we can do is we can
just print some response right so we can
even send some response back so what I'm
going to do is I'm going to say response
dot gate
that was all dot tostring okay this is
going to be string the spot so if we hit
this particular western point it is
going to create a index with this client
and it is going to give the response for
us so let's go ahead and start the
process right okay so if you see here
this particular application will be
running in a different foot and the
elastic search is already running in yet
nine to double zero so we are having a
standard on elastic search instance and
we are accessing that from a client so
this can be a normal Java application or
a springboard application or any any
other application so I am just showing
it in a spring boat application so that
you can relate it to the latest and the
greatest of it is out there okay so if
you see here the application is come up
in the port 8080 so let's go ahead and
hit 8080 but also we created the rest
endpoint it uses rest class uses and
also we have the kit so as a part of get
this is going to create our new index
get the values which we provide two
adjacent using the JSON builder okay if
you see here the response which we got
some the gate is created because that is
what we asked our rest endpoint to
return okay basically it created a
client and using the client it created
an index so let's go to elastic source
and see that index right if you notice
here previously it was showing is found
as false now if you see here the found
is showing is true and the source is
returning what is there inside the
elastic search ins so we have name
salary and team name that is what we
injected here right that is what we
injected here that is what got injected
automatically so if you want to get the
complete data so you can even do
response to a ket source get resolved I
think it is inside get resolved not sure
so you can do that and get the response
so basically I can I can do a get get
response actually there is a different
code for that so let us write so this is
whatever response which we wrote right
now it's just for creating an index rate
however we want to let's say only view
the
users so I'm going to say I'm going to
create a new restrain point so I'm going
to just save you for our purpose right
so I'm just going to say false train
come on Jake okay okay this is going to
return us so what I'm going to do is I'm
going to use the template again okay so
this is the code which we need you so
basically you need the client so let's
move the client to we need to clear the
client wait so let's move a client to
the constructor
okay so move the clan code to the
concept or select we can use the same
client across the RS temple so what we
have done is created a have created a
new endpoint called view so that we can
get the response back for whatever ID we
give okay so we can even pass the ID so
let's say I pass the ITIL right so I'm
going to do a path variable you can I'm
just going to use that so that we can do
it
okay so what we are doing here is very
using the client to do repair kit if you
notice when we create the index we see
the preparer index and now we are using
prepare gate so once we do a prepare
that we get an object of type get
response and using the get response we
can do a gate source to get the whole
object back okay so basically this will
return the JSON message so I am just
going to say get response dot gate
source
okay this should return as our response
back so so previously when we did when
we did a create using the gate what we
did is we had we got the created
response right so in cure okay once
again okay let this come up you so what
we did here is we are now using the map
to get that whatever response we got so
previously we did a create we got only
the response basically we just got the
result and then we saw with a little
skaters or not now we are going to get
the complete JSON message from the get
response object okay the process server
is up from so let's go and hit the rest
and points of water butter standpoint
user slash what was it view / ID right
so I'm going to save you slash one so if
you notice here I just gave you / one
and I I see only two JSON message so
basically we got the direct source
information which is there inside this
lesson point I got only that so if you
not notice that spring sorry the
elasticsearch gives additional
information we don't require that and we
are going to pull only the source
information which is what we have done
here okay so
basically we are accessing elasticsearch
stand-alone instance via a spring MVC
application spring board spring MVC
application okay using the transport
client which elasticsearch force okay
that's what we have done yet so next
what we can do is we can update our
weather we can update our data right so
I want to just update some data into the
existing restrain point okay let's say I
am going to say update so I am going to
say update so I also have a template for
it
so this is the code which we will be
using for the update okay so we need to
create a updates request so this is also
coming in from elasticsearch you can see
ok you need to create an update request
and in the updates of course we have to
set the index which is our employee and
what is its type which is ID and what
are the ID which we need to update ok so
we can even give the ID we can even pass
the ID actually so what I will do I will
just pass the ID so that we can update
whatever we need okay I'm just passing
by ID so we can pass the we can add so I
am just updating the value of gender
male ok into that particular ID so far
now I'll just pass one only because we
have only one data so in future I can I
think I every modify this let's modify
this ID
I just modify this as insert I'll just
enter the same name for our reference
but I will just insert new ID so that we
can see ok so what I will do is I'll
earn a ticket so this we have already
created one we have already created we
are now not going to use one but later
if you want to use one we can use it
because oo in the operator standpoint
what we have done is we have done so ok
so we created an update request with the
new JSON which we want to add basically
this will append the data into the
existing jason so if you see a through
our existing jason the
we have here gender male that will
append into this particular in English
but in that particular source okay so on
the command to do that is client on
update and you have to pass the update
request okay and if you want to get the
data back again you do a get so we get a
update like a response so we just need
the status so I am just going to return
the status so I'm not going to do
anything here is here in fact I can do a
return here okay
I'm just going to return the status and
ends I will say exception okay so status
is just data size is to go to string
this should find you should be fine so
we have a cent point called update now
using that update we are going to update
a particular field basically we are
going to append a particular field
inside the existing JSON skeleton okay
so I just started my application let's
see so the application is up so before
we updating it let us see the view again
so the view is are still the same so I'm
going to do an update for one so this is
going to add main for us I am just going
to say update one so the response give
as okay the status is okay now let's go
to the view and see what data it has got
inserted okay we notice here the gender
got inserted so this is now using the
update if you notice here I just added
some logs also maybe some a studio trade
so another out so if you notice here oh
you can see that so basically using the
update request we have used the
transport client and we have updated the
existing schema to add some additional
data into the elasticsearch instance
okay so that is how you do an update so
what we have seen till now is we have
used the insert to insert we have done a
view to view what is there and we are
now gonna update so finally let's do
what Ellie tried say delete symbol add
an ID
in order for you to believe
so for tonight also I have a template so
use that delete response so if I see
that when the code which deletes it
so that it deletes the data from that
instance so what I'm gonna do is I'm
going to use the ID so from that
employee so we are going to delete that
particular employee ID okay and we are
going to finally do get result and then
give that result and gate result if you
notice is a is of type result so this
can be knowledge the data is data if the
data is not there so we lower torque to
string and we can return this just move
this down so the deleted straightforward
so you just call the prepare delayed
function inside the transport client
vetti index and the type along with the
data which we want to into delete okay
so in this in our case we are going to
reality I think this billing is wrong
here okay so we are going to delete D ID
1 okay let me restart the application so
that we can perform a delete
let the application come up okay this is
up right now let's go to the if you want
if you see the view is this same way I
will go to the elastic search and see
you show you say if you see a elastic
search business how it looks and this is
how our first endpoint okay now what
we're going to do is we are going to do
a delete right we are going to say
delete I'm going to say delete one so
this if you notice here the response is
deleted it did it very quickly and if I
do the rest endpoint there is nothing to
turn right because nothing is coming so
if i refresh this particular you are if
you notice the elastic source is not
returning me anything because there is
nothing we have deleted it now what I'm
going to do is I'm going to insert one
so we added a one new restrain portlet :
so I'm going to insert one so if you
notice here it has created so now if I
do a view yeah it has got created let's
go to my wrist inform which I create if
I do view yeah I have it now if I do an
update this is going to update my data
so if you say it so saying okay and if I
go it should say male yeah gender male
if i refresh in elastic search that is
also returning adding and that also has
the data called gender male okay finally
I want to delete this I just say delete
it's deleted okay and this should not
return anything and this will not have
any data as well okay so that is how you
do create update and delete using a
standalone instance so we start the
standalone instance if you notice here
this is the standalone instance so if
you see there are lots of logs it has
been it has created its node right now
it is running in my local machine right
so it is having only one node but you
can create our host it in a separate
server and then you can use use it
across okay so what we have done here
inside the code is we have added
dependencies for the elastic search if
you notice in the form we have higher
dependencies to the elastic search
instance we have added dependency to the
elastic search client which is called
the transport client so we have to add
the transport client jar then we are the
necessary log4j which is required by
elastic search to make our application
so
then what we do is the Creator client so
what I have done is our address in the
constructor so when this particular
controller is initiated so this
particular client will be created and
the client is using the transport
address of localhost within nine three
double zero four so as I said earlier
elasticsearch will start with two
different ports nine - double zero for
HTTP request and nine three double zero
for socket echoes okay so we are going
to use the transfer redress for socket
address so this particular chart
dependency uses the socket to get the
data it doesn't use HTTP okay so in
order to insert the data we have to use
the proper index and then we have to
pass the index information and also the
JSON message and then finally you can
get the result out of it so in order to
just view the information you can do a
prepare gate with the same index
information and then you get that and
then you say get source it will give
only the source information from the
plastic search instance to update we
have to create an update request and
then give that update echoes to the
client or update and that will be
updating the complete doesn't gap dating
or injecting basically the new field
inside the existing JSON message
basically it's updating your message
okay finally delete operation so today's
operation can be done using to prepare
delete of T transport kind so we have to
pass the index type and ID so that is
how you do it
okay so that is how you access a
standalone application from a spring MVC
application okay so this is how it is so
if you have any doubts or queries you
can drop in a comment below I will just
push the score into github and you can
use the same code
I'll give the link of the github
repository in the description below
basically to go to github.com slash tech
primers you can see all the repositories
of all the examples I have created in
these videos so you will see lots of
repositories actually so if you notice
when the github a link so you can go
there and download this particular code
as well so if you notice I have 20
repository so you can download these
examples and try it out the only thing
is you have to start your elasticsearch
instance but elasticsearch is the open
source so you can go and download it
from the elastic search website also
they have good documentation I also
the documentation on trial data and that
is how I was successful so that's what
this particular video if you have any
doubts or if you want to may to cover
any particular topic drop that in the
comments below so I will try to do that
for example this particular video i have
done based on a user's situation I'll
try to do it if I am able to do it okay
that's just for this particular video
see you again in the next video thank
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>