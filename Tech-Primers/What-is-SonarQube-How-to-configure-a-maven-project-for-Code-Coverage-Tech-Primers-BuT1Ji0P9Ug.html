<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>What is SonarQube? How to configure a maven project for Code Coverage | Tech Primers | Coder Coacher - Coaching Coders</title><meta content="What is SonarQube? How to configure a maven project for Code Coverage | Tech Primers - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Tech-Primers/">Tech Primers</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>What is SonarQube? How to configure a maven project for Code Coverage | Tech Primers</b></h2><h5 class="post__date">2017-09-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/BuT1Ji0P9Ug" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">maintaining the quality of your code
bases is a tougher job when you have too
many code bases in your project so not
Cube helps us in tracking all these in a
common place let's see how we can
configure sonarqube and bring up a
sonarqube instance and push our project
stats into sonar let's get started
sonarqube is an open-source continuous
code quality integration tool with which
we can identify code vulnerabilities the
bugs and the code quality in the code
base
so what sonarqube does different things
it can track all the repositories at a
common place you can have a profile set
in sonarqube and based on that profile
your code basis will be scanned and then
your vulnerabilities will be identified
so you can add more world more profiles
or more roles into the profile based on
the code or the technology which you
have written for example for Java you
might have a different role for
JavaScript you have a different rule you
can control all these at a common place
so you don't have to worry about that at
the code base level so you have a
central place where you have this
configure all these code pieces are just
pushing the sonarqube was just pushing
the analyst analysis into the sonarqube
based on the rules which are there in
the sonarqube so that is what sonarqube
does right
recently what sonar has done is if you
had to use sonar cube like maybe four or
five years back they did not have a
open-source version basically they do
not have an online version right now
they have an online version there is an
option called use online if you click on
that it goes to sonar cloud dot IO where
you can have your open source corner
project configured for free not only for
free and you can publish your stats into
that particular sonar instance so
previously they did not have it but
right now they are providing their sonar
cube instance for us so we don't have to
worry about managing the sonar in our
infrastructure so if you are working on
any open source projects you can rely on
these sonar cloud for free
because they are providing it for free
the only thing is your corpus is out
open anyway if you are having a sooner
open source project we are going to have
it open right so you can use sonar cloud
in that case there you can publish your
project so if you notice here these are
different projects published by
different open source contributors
across the world where they have their
projects configured and they check how
much is the coverage of the project how
reliable their product is and stuff like
that for example let's search for a Java
language project makes you for example
three point
three K projects are there literally so
if you notice here let's pick up a
failed one right so we can go to the
sonar in stress and this is exactly the
sonar instance which we will be
configuring now locally but the one
which we see right now it is in the
cloud so you can drill down the bugs so
if you see here there are three bugs you
can drill down to this particular file
and see what is that which is the line
which is causing this particular bug and
if you notice here you can see this file
say this right this is as this is a bug
it just make Bukka transient or
serializable so this is these are just
bug tracking tool which is available
online the sound cloud right so let's go
ahead and configure this locally so
click on the download button when you
click on the download button you have
two different versions of the sonar cube
Phi dot 6.6 and 6.5 I tried using the
6.5 version but there is some bug which
is out there which is open which got
recently introduced and I think sonar
team is working on that so I am not
showing the demo with a 6.5 version so
I'm going to use these five or six or
six version so I have downloaded this
and kept it in the yeah so this is where
the version is
right so there's the folder structure
for this one our q5 dot 6.6 right so you
have a con folder there you have two
files the wrapper conf which is the like
the JVM arguments for your sooner
instance and also these owner properties
so no other properties has the port
information and the database information
with which the sonarqube can connect to
so as you know since I was telling that
sonar cube can collect information from
different code bases these can be stored
in memory these can be stored in the
database so you can configure that here
so the properties for that is all here
so you can notice that you can ease use
a JDBC you can use the my sequel
database or you can use any other SQL
server and stuff like that and you could
configure the ports here as well the
port number so by default e sonar cube
runs in the port 9000 ok so I'm going to
bring up sonarqube locally in my laptop
so we are in the console der right so we
have the folder called bin inside bin
you have different versions of this one
are in the same package
so right now since I am having a Mac
version of the laptop so I'm going to
use in Mac Universal 64 if you are
having Windows you can use windows x86
64 or 32 based on the 30 day Twitter or
the 64-bit ocean of your OS so I'm
having Mac OSX 64 bit so you need to run
this one are not essage so I'm going to
run this one or not SH you can either
use start stop or restart I'm going to
use start so that this one our instance
get kicked in right so if you notice
here the sonar is getting initiated
let's go through the you are and right
so the place where this one our instance
is hosted is 9000 port so let's give a
few seconds for sonarqube to come up
right it's just taking a while to come
up meanwhile what we can do is we can
open our IntelliJ
so that we can write some piece of code
so that we can use it to camp right so
for example I have already created a
small maven project
okay it's just a simple maven project
the only difference between this project
and the typical maven integration is I
have added two things here so I have
added a plugin here alright so I have
added a plug-in called maven sonar
plugin so the group ID for that is over
cheese owner sourced or scan or dot
maven the artifact rating is sonar maven
plugin and the version is 3.3 dot zero
dot six zero three okay this is the only
thing which I have added I have not
added anything else it's just the Ju no
dependencies nothing else oh these are
not even liquid so and there is a maven
compiler plugin which is like by default
you will have to have it and these
repositories are just the maven
repositories which I have I just added
it so that I can show it with the
Jenkins upload so so that as a part of
Jen kits how can we upload these sonar
starts into the sonar cube which I can
show it in the next video but for this
particular video I will just show how to
upload these results into the so not you
right so I'm going to give a project
group ID name right I'm going to just
change it so that we can use it for our
reference so I'm going to use sonar cube
don't let's say Primus Summa okay
and our group ID will be so another
example so this is what I'm going to
change it's gonna be jar and I have some
dummy file which I used okay so this is
the Java class which I have let me add
some more stuff here let me add some
class
Nate I have added some stuff you okay no
so let me add some food
also I'll add something like member
mumbo equal to 10 if number equal to
equal to zero okay see some of the
vulnerabilities even IntelliJ can
identify if you notice the IntelliJ is
highlighting some of these right so I'm
assigning the variable which I have got
here and I'm checking it for 0 which is
always false these kind of things I see
em here system 100 so all these are like
errors or vulnerabilities and if you see
in sonar lint sonar lint has already
identify these in the previous video we
saw what a sonar plant right so this is
going to do the same thing which one our
cube is going to do okay so which is now
giving us in IntelliJ itself but however
if you want to push this into the sonar
cube what we have to do is we have to
run this task called sooner
: sonar so once we added this particular
plug-in right the sonar may we'll plug
in this particular plugin once we add
this plug-in in your maven you have a
new task called sonar : sonar so if you
run this particular task this is going
to do the normal maven clean Insull so
let me do a maven clean install along
with this right so I'll just select this
so I'm going to run DS right
so let me run a maven clean and install
first so that we know our tests are done
and stuff like that right so I have some
tests also there it's don't doing
anything but just that there is a test
so let this run and then we can run the
sonar columns on our tasks
right the build is successful as you see
here so I'm just running the sonar :
sonar now let's see what is happening
I don't know
so if you notice your there are some
logs which are saying that the sonar is
getting run so see this right this is
the task the indy plugin so sonar maven
plugin and sonar is the task it is now
going through our code bases it is all
loading some plugins it is all getting
some rules so if you notice here it has
identified that our sonar cube version
is Phi dot 6.6 this is because by
default this one or maven plug-in uses
the localhost 9000 port to check what is
it so more instance if our sonar
instance is down right this would have
failed because it is retrieving this
version at the runtime so at this
particular time it is just querying and
getting the version number right if you
want to configure that you can add it in
the form example you can configure what
what is the URL of your sonar instance
so if you have a external sonar hosted
somewhere outside you can do that so for
example this one our cloud right if you
are using sonar cloud then you can
configure that particular version with
the URL of this remark on the right and
also it is identified it as identify
queries our working directory borders
the varies our base directory it is
going through all the files it is
scanning and it has generated some code
coverage report and all those stuff so
basically it is saying there is only one
file it is analyzed and finally it is
all uploading the results to this
particular location ok this is the URL
where it is uploaded so let's go to the
dashboard and this is the same URL as
the dashboard let's go to the dashboard
and see right so let me refresh the
dashboard if you notice here there's
this particular project name we had
given us test I think that is why it is
showing us test and if you notice inside
it shows up the name of the project so
like you're doing nationís ok it's
almost the same thing so here what you
can see is you can see the different
stats which are out there there are five
issues so let's go to the issues if I go
to the issue it shows the file which are
having issues so the first issue is in
the this particular line what is the
issue
it says replace this usage of system
without our system browser
so so not is saying that okay don't use
system but alternate println anywhere
used lockers to lock that next one is
remove this private unused test result
right
so IntelliJ I also suggested this but
Sona also does that and this is the
major violation next one is again the
introduction of new variable in story
using the medieval so yeah so instead of
reusing the parameter baby open write
whatever we have here create a new
variable that's what this is and also
this statement will never get hit right
replace this usage I think that's a
marker to notify but if you notice this
is the same narrow which we got for the
system right so this is how sonar can
identify bugs and then you can go to the
single page for example if you see here
I have different products configure and
all these results are posted here and
this is our project right
it can also identify see it shows how
much time does it take to fix these bugs
it says 32 minutes it just comes up with
a number right based on the number of
violations which we have how much time
does it take and it also shows the lines
of code if you see here this is a Java
project and the lines of code are 19 it
shows up for every project as well right
you can configure all these rules I was
mentioning late there are some rules you
can configure those rules in the place
called rules here so these are the
different rules which are available for
each language so for example Java if you
click on Java these are the different
rules which are out there you can go and
enable or disable this rule or you can
change this as a blocker or you can you
can identify what you can modify from
here it writes so this is the rule so
you can create a rule and then upload
these rules into this 1rq or you can
control them here the rule section
itself you can have different profiles
so you can have different profiles for
example say this right these are
different profile so these are different
profiles which you can create so for
example I created a test profile you can
have your own bugs or their rules which
are available there by default sonar has
254 active roles
75 bucks 2100 buddy and 159 forcing
courts means you can activate or
evade them based on your requirement in
your firm so that is what most of the
firm does there could be some coding
practices inside some form there could
be none in some form so depending on
their availability or the preference
they can configure that in this one R
cube and if you want to locally run your
sonar you can better use sonar lint like
how how I show right you can use sonar
lint if you want to check your quality
of the code before even proceeding to
commit anything onto your repository you
can use sonar Linda this is pretty good
in terms of identifying how your code
code smells right so that is how you can
use sonar cube and this is how you can't
figure sonar Q and we saw how to push as
well so you have to use the plugin maven
sonar plugin so now I'm even plugin
that's it nothing else you don't have to
do anything else if you have your
external sonar instance you can
configure that the configuration
information is available in the
documentation here so if I go to the
community and I say documentation so the
documentation is a pretty good and if
you search for anything in the internet
you can find out so see this right you
have different plugins see for example
this analyzing whatever whatever I
showed you it's all there here so you
can use this particular profile option
to configure the sonar sonar port number
you are all important but so for example
see this right there's the Settings dot
XML which you could configure in your
maven so that you can configure this one
or post there directly with the port
number you don't have to worry about
that in your code base so if you have a
common maven configure that in your
maven so let's say you are using maven
in your gin case host in that Jenkins
host maven you can configure this
particular host so that it is used for
all the projects in your Jenkins host
right and say maybe this is the whole
the run the task so we just ran it using
IntelliJ right the sonar : sana this is
nothing but the command line option for
the same right if you want to exclude
some files from the sonar analysis you
can set these properties called so not
exclusion and you can provide those
folders
all the packages so our women exclude
them from here from their analysis right
and there's the same plugin which we saw
right so that is it what else do I need
to think that is what I wanted to show
just thinking if there is anything so
let's see there is no code coverage
which is shown up right now right so so
there is no code coverage which is shown
up right now in our stack so if you see
in the stand there is no code coverage
which shows afraid it is not showing the
lines covered in the file it's just
showing the bugs it is not showing you
how much how many lines are covered
right in the test case so what we can do
is we can use the year jacoco plugin so
Java code coverage plug-in to configure
that as well so you just need to add one
more plug-in that's it apart from that
you don't have to do anything so let's
go and add that right so that is plug-in
yeah it is the cocoa maven plugin let's
get the dependencies added so I don't
know where they have mentioned that here
hopefully if they have it in their wiki
we can get it or I will have to get it
from the internet
so let me check
let's use 0.7 dot nine right
right
so let's import this once you import it
you see there is an option called jacoco
no so once you include it a Jacko
coupling you can see a jack of co-option
now in order to publish these code
coverage reports on to sonar what we
have to do is we have to run this Jack
OCO plug-in as well right so I'm just
going to say prepare reagent and also
there are some options to generate the
report out there I don't know if I can
show that right now but let me see if I
can at least get the a report on the
unit yeah if I click on this report what
this does is it generates at are both
out of your code base right
skipping Jacko produce a machine
education data file so that means there
is no file which got generated so what
we can do is we can just - well Nathan
you can run these reports along with you
so now I'm going to run these let's see
what happens
so the delete failed because something
is stuck why is it stuck did we do
anything in the command from nothing
right I think install is not working the
code the package for the project did not
assign a file to the build artifact
let's go clean install separately to be
and then I will show you the jacoco repo
this one up so that is the task right
which yeah maven clean jacoco in
Australia that is the one right so let's
just run that next right so if you
notice here I am running this on our
cube and the jacoco report so what
happens here is the jacoco maven plugin
first gets triggered and it generates
the files the jacoco files and those
Chikako files are uploaded to Sonali
ok those Jacko Co files have the
information about the core quality if
you notice here these two lines are the
ones which will get other files right so
let's see if these files got created
right in the target phone
enopp they don't have them here so looks
like the jackal co plug-in is not
creating those files so let's see let's
run these a for generations right Adam F
report generates it or repair agent
dries it
I'm not sure why that is not generator
see it says skipping the report right on
oye
maybe do we have to use a different
version starting from Java okay let's
use the older version with I'm not sure
if that is going to create an issue but
okay let's run this separately so that
so let's prepare agent Scott Caan this
should generate our sonar for you but
why are being said target okay so this
should relate the jackal co dot exec
file and then that should be uploaded to
sonar
so let's generate this so I'm not sure
if it will get general because even I am
running it for the first time here in my
laptop so the compilation will start er
compilation succeeded share for plug-in
you started right right okay it's a
successful so let's go to the target
folder and see if the Jaco co dot exec
got created yep
the jacket wot exact on tweeter so this
is the file used by the sonar task so
let's run that sonar task right so when
you run the sonars enough the sonar
maven plugin it automatically identifies
the jacoco dot exact file and it uploads
that into this on our queues instance so
that way we can identify the code
coverage per line so if you write some
test cases it can see line by line
coverage of the name of the file so yep
see this right it has analyzed these two
file and it should be available in our
sonar cube instance let's refresh this
page it should show up the coverage
husband yep
it is showing up see this red not
covered by unity so this is the coverage
which shows zero personal coverage let's
write one quick test to check if the
coverage is working right so what I will
do is
I just write a quick test that we need
the J not plugging the dependency there
is no you have the scope is just but we
already have a test case here okay fine
we have some test case here let's time
so we're at song
so what I'm doing there is and just
creating a new instance of okay just for
identifying the code coverage without
getting detected I just wrote a small
test which is just creating the app and
then it is just triggering the app dot
show method which we just wrote now okay
I'm just going to run the same stuff
here I'm going to run the Mable peel
clean package with the java chicago
plugin which is nothing but java code
coverage share maven plugin this will
run the jacoco plugin which will create
a jacket off file and that file needs to
be uploaded to soon ah right so that is
what we are going to do here so
initially as a part of the maven task we
can run this in fact we can Club them
together but I just prefer running it
separately so that we can see if there's
a bit failure right okay so the jaco
co-generation got completed now let's
run the sonar upload so this will now
upload the it will just create the sonar
stats and then upload into these sonar
cube instance so that is what is
happening right now so once this is
uploaded we should be able to see the
code coverage again which we saw
so let me refresh this file yep if you
notice here the code is the code
coverage is green for this particular
function because we wrote a test case
for it so that the sonar says okay this
particular piece of method or the line
is covered already by unit test
scheduled for the rest all or not
covered right that is what you can see
from so market so this is pretty good
when you have lot lots of projects you
can go through the projects you can see
we said there are seven Portsmouth's and
you can see the code coverage as well so
if you see here the coverage is 21
percentage so and what how many unit
tests are there is only one unit test
right and if you add new code it all
done automatically shows how much is the
coverage so these are just the dips
which are there here right so this is
how you use a sonarqube to configure
your project this is how you can run it
you can set up locally if you want to
try out so not cube you can set it up
locally give it a try
it is pretty useful for identifying the
code smells in your code and if you want
to get a quick result you can use sonar
inland from IntelliJ so I just made
another another video on that you can
check that all right so that's it for
this particular video hope you guys
understood and got it useful meet again
in the next video thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>