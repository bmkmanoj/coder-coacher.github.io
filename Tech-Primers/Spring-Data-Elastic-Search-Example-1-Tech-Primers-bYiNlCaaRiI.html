<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Spring Data Elastic Search Example #1 | Tech Primers | Coder Coacher - Coaching Coders</title><meta content="Spring Data Elastic Search Example #1 | Tech Primers - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Tech-Primers/">Tech Primers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Spring Data Elastic Search Example #1 | Tech Primers</b></h2><h5 class="post__date">2017-03-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/bYiNlCaaRiI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is AJ for tech primer in this
session we are going to see what a
string data elasticsearch and with an
example so previously in my sessions we
would have seen this print data rest and
spring data JPA so if you have not
looked at it you can take a look at it
so in this particular session we are
going to see these ping data
elasticsearch let us go through the
starter spring got i/o and create the
application from there so I have this
created a group an artifact with the
dependencies for web analytics so web is
going to expose our spring code
application via the first endpoint and
also elastic source is going to give us
the elasticsearch dependencies which we
need for building a spring data elastic
search module so if you are not aware
about elastic source or elastic search
is a search engine which is built out of
Lucine so it stores the data in the form
of JSON messages JSON format so if you
you can easily a query and search for
the data using the HTTP calls so spring
data is going to have a wrapper around
this elastic search and then it makes
our life simple in terms of querying and
loading the data from elastic so that is
what we are going to see now so if you
click on the generate project it
generates the project I already
generated the project so let's go
through and start so this is the just a
dummy project which spring creates so it
doesn't add anything else apart from the
dependency so it adds the elastic search
on the web which we have added so let's
go and create our packages which we need
so for these we need to have loader so
what we are going to do is we are going
to load the data into the elastic search
first right so we need to create some
loaders let's say you need the classes
loaders all also we need some config
file it's not a config file it is a
config Java file so we'll I will show
you what it is so let's name it elastic
configuration
so these are some configurations which
we need while loading the elastic search
also we need the repositories so
repositories Rd are similar to the JPA
repositories but here we will create a
elasticsearch repository and also
finally we need a so-so
for exposing us a 10-point so let's
create that source now let's name it as
Vertigo's okay so for the search results
I am going to audit a tit with rest
controller so this will become like a
resting point also I am going to give
the request mapping as read such slash
search and then we will have other
methods
so let's come to that later so first
let's go through the configuration so
for elasticsearch configuration so first
let us annotate with configuration and
then be how to annotate it with elastic
enable elastic repositories so once you
say in a ballistic repositories you have
to add the base packages so what is the
base base package for us so if you see
here the base package for us would be
this repository but so we need to give
the package structure for the repository
so that when the Springwood comes up it
automatically scan the repository and
identifies that it's a lastik such
repository so let's do take per image or
elastic dot repository okay so this is
going to scan through the files and the
repository folder and create a
repository for the elastic search so
once that is done so what we need to do
is we need a beam for node builder so
node builder is something which
elasticsearch provides which is bring
data provides so we are going to say
we're just going to create that node
builder beam
why is it blinking at us
ah you didn't give the open closing
closes okay so now the next one would be
a nasty search operation so let's meet
on a secret operation so what we are
going to do here we are going to create
a temporary file okay so final dot
create temporary files create term file
so I am going to give the temp location
rate 8 a.m. class realistic ok and also
I am going to give some date so that a
folder structure has a unique name so I
need a nano time system does not open so
what I have done here is upgraded a temp
file why is it showing my daughter ok
should shows around will try catch so
after this let me pull this out
okay after this I'm going to create a
setting so I already have this setting
so I don't have to retype so if you let
me it got quickly and pasted
okay so these these are the things which
are required for elasticsearch to
kick-start so let's okay so what what
happens here is they are going to create
an elastic with default default
configuration so these used to be in the
XML previously so with the springboard
we have now moved to the Java way of
defining things right so for example
here I'm saying that HTTP is enabled
how many shots do I have temporarily I
have put one shot and then we I have
mentioned what is the path for the
directory where elastic should be st. so
the elastic search is going to be saved
in the local repository so it's not
going to have any in memory database or
something it's going to store everything
inside the files so so that is the path
which we have created here at a temple
acting so that is what we are doing here
same way we are going to create
something called elastic search template
so that spring data so this is specific
to spring that I can see this elastic
search template is what spring date I
will do so for example see here elastic
system template is under spring came
back so spring framework is going to use
that so the settings are the node
builders are coming from the elastic
search in itself which elastic elastic
search exposed as a jar so now I think
we can go to the repository and create a
repository so let's say I'm going to
create a user suppository okay so it's
my interface so it's going to return
something called elastic repository
there are things with repository so we
are going to add the entity called users
and then let say the Prime the digital
unique values by air is long so this
model needs to be created so let's
create this model so I'm going to create
a model photos so when you create a
model we have to honor it with document
so this is specific to the elastic so
chickity here the document model is
specific to elastic so inside the
document model we have to give
all the index names so for example here
let's say we want the index name as user
and we need to mention the type so type
also can be used and also we can also
discharge through shards we have
mentioned there is only one shard
initially when we when we did it in the
configuration if you see here the shard
is not something like a shared partition
which is there in the elastic so I am
giving only one funnel because we don't
have huge data and then we are going to
mention all the fields which we need so
so let's say I'm going to give private
long ID private key name so I have the
name team name and also I'll mention be
salary okay now I will generate e-coat
required so let's create a dummy
constructor for the GPA and then we let
create a constructor with all these
field and also we need to get as and
setter so let's generate them as well
Metacritic raters and setters okay it's
all done now let's go to very loaded so
loaders let's annotate it with
components so that injector so inside
the loader I am having a post construct
so this post constructor will be
executed whenever this particular this
post construct method will be executed
whenever this loaders is completed okay
so what we are going to do here is so we
are going to inject the repository which
we created the users suppository which
is plugged into the elasticsearch and
also we are going to insert a new object
which is called elastic search
operations so this is where we are going
to put all the mappings so before we
even post the data into the elastic
search we need to create a mapping so
that is what we are going to do here so
you see here under operations we are
going to say that ok we are going to add
mappings for users or class so users or
classes or model right so that
particular
model needs to be created right the
mapping for that needs to be created so
that is what this particular line does
so the operations were put mapping
creates a mapping for these user now we
are going to so let's say I add a log so
I have a log saying loading data so now
let's say I am going to use the
repository to load the data okay so in
order to load the data we need some data
let's give some temporary data here so
before that just say loading completed
so let's create this method so we need
to give the list of users so that they
can be loaded okay so I'll create a
temporary list of users data so let say
the talking go you go sequel to you I
think what we can do you George dot add
of you we need to now give the name for
let's say a J image a so one two three
long and I am saying that my team name
is accounting and also I say that my
salary is tilt of them so that goes
along okay so now let's say I create
some three more data with my friend's
name so I say if in a department look at
least one veto
okay let it be three so now we need to
return the list of users so this is now
returned and we are going to save it so
what this code this Lotus is going to do
is it's going to create a mapping for
the users and once the mapping is
created it's going to load the data into
the repository so the repository is
nothing but the elastic so so this is
going to load the data into the elastic
search
okay now that now we know that they have
loaded and this will be happening Wendy
spring boot application starts because
we have annotated this particular class
with components so this class will be
created instance of this class will be
created when the application boots up
and also they have added a post
construct so as a part of this post
concept so when in this particular class
is getting loaded the final stage would
be that loading of this particular
method we can also add a transactional
annotation so that this particular
method its transaction so if something
fails it can't hold back so that is just
the transactional notation okay now
let's go and add the resources so now we
need to find the data right so using
there s endpoint we are going to hit the
rest endpoint and this is going to find
the data from the elastic search so
there it is literally going to search
the data so how do we search so we can
now inject the repository which we had
created by which we loaded the data
right so using the same repository we
can get the data so now what do we need
so we need to write a rest endpoint so I
say I need a name right so let's say I
am going to search by name so initially
let's say I am going to search by name I
am going to give this so it will be
getting a list of users for that
particular name can be lists right can
be users as well but let's do it okay so
I'm going to say search name so path
variable final string text okay so now
what I'm going to do here is I'm going
to use the repository to do a find by
name so if you are other about the
spring jb8
this is out the repository to work so
you can search by a particular field so
this gets translated into literary like
a query saying select a stick from a
particular table their name equal to so
on so that is what this gets translated
into same way spring is following the
same
type inside the elastic search string
that elastic sister so this particular
method doesn't take this but we can
create that into the interface which we
have done so what happens is on the fly
this gets converted into a query which
elastic search can understand and search
by the field called name under the users
entity or the user's model so that is
what happens okay now in this using this
particular lesson point we are going to
search by the name so let's add a few
more let's say we want to search by
salary right so I just say I have a
different end pointer you say I want to
search myself and also the sculpting is
long all right I say find boys salary
and then I pass these LT so now I need
to create it but that same thing it's
done ok now let's go to the next one we
need again one more with something
called all so let's say let's written
all the data I need to mean ok so let's
watch all the data so what we are going
to do we don't have any arguments yet so
we are going to church all the data so
we there is there is a method called
find all ok that's going to return
everything for us but that's how I
travel so what we are going to do is we
are going to tell you the local variable
sirs so what we are going to do is we
are going to edit this particular I
trouble you can do for each and then you
say users agony is lambdas here so let's
say I create a left here of users okay
I'm going to create greater relative
users users list let me name to this
list okay to that users list I am going
to add the user here okay and then
finally I'm going to return the users
guilt so this can be converted into a
lambda expression so this is the matter
reference so whatever argument I get I
directly add into the list here so I can
convert it like this in Java it so this
is the methods of sensor so I'm using
that here we are using the variable
references in fact this is a variable
title you are using variable to
sensitivity so this is going to return
all the sources also I think that is it
so we have a read controller so this is
going to expose the rest endpoints for
us to search and we are loading the data
using the loader which is what we are
doing here we are just loading temporary
data we have the elastic search
configuration which the elastic search
request for bootstrapping the
application so when it comes up also we
have the model it is going to use which
we are going to use like a view and
that's it so let's start the application
we'll go to the elastic so it's demo and
then I say run so this is going to start
the application now Kay meanwhile let's
go to the postman rest client so I have
postman here so the endpoint would be
should he be localhost colon 8080 this
slash search so that is how it will come
right now it will not return anything
yeah it's going to give for not for not
for so yeah there is an error what is
the error so there is error indeed the
loaders requesting will be booked the
due form okay
so what we form you okay so spring data
I think we have to change our to
template so this should be 2 into the
squall to be elastic template start
de lodo sorting order wedding of this
patient we should give me gold
let's see okay there's a belong loader a
clear exception and one able to
initialize the model so it's not able to
create a directory let's see why is that
I think this is something here lets me
be please the whole thing which is there
here okay
so just replace the whole bunch here
because that's what was working
previously when I tried but
unfortunately right now it's not working
but it's fine
so it's just the predefined settings
which we give that's it when we load the
elasticsearch so these are the settings
for the elasticsearch to bootstrap okay
if you see here there is some exception
but that is coming because elasticsearch
is using some jar which is not there
coming as a part of string booth for
that is either this coming so this is
again failed why to undo this tool
logging the boat maybe fail to start the
boat may be already in use okay so maybe
the boat is you already knew so let's
change the port number
we can actually stop the application
because you had already started okay
stall here let me stop this so that we
can access it from here so let me read
on to the application which was running
was the one which I had previously
tested it with but yeah I just stopped
this one also that we can use our
application whatever the creators right
now this should come up yeah it has come
up so if you see here to chat up the ad
port so let's go to de smell in Haiti
defin poncho the resin point which we
had was that they alright so this is
going to return all the data so if you
do a rest clash on so if you see here
these are the data which we loaded into
elasticsearch so that is what we are
getting now so let's say if I want to
search by a name I am going to say in
name slash litter again it's going to
return that particular name same way if
I search by a particular person you are
going to give same way if I put a
particular solitary single 12000 so it's
going to return the data is also this
this is how elastic search in the spring
data searches into the elastic search
using the repositories which finger to
provide so these are greater by spring
data so whatever we have here the
elastic search repository this is
created by spring data so which is
making our life simpler right so you
just say search by the find by the name
and it's going to searching the elastic
search so but but this this does not
solve the problem of searching across
names so that I think we will cover in
the next session that's it for this
particular video but if you want to see
how to build a custom query which can
search across entity so right now if you
see we have loaded only one entity or
only one index so in the next session I
will show you to load how to load into
two different indexes or three different
indexes and then first across these
indexes using a custom query builder so
I will show that in the next video one
of them thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>