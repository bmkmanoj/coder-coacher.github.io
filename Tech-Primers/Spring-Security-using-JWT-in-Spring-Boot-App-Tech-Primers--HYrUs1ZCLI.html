<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Spring Security using JWT in Spring Boot App | Tech Primers | Coder Coacher - Coaching Coders</title><meta content="Spring Security using JWT in Spring Boot App | Tech Primers - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Tech-Primers/">Tech Primers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Spring Security using JWT in Spring Boot App | Tech Primers</b></h2><h5 class="post__date">2017-08-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/-HYrUs1ZCLI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">press the bell icon on the YouTube app
and never miss any update from tech
primers welcome protect timers in this
particular video we are going to see how
to create a springboard application with
spring security enabled which is going
to use the Java bug tokens so this is
going to be a basic example of some of
their tokens so I'm not gonna use any
database to validate - username password
or something like that what I'm gonna do
is I'm going to use a simple Jade
ability token I'm going to generate a
token using a resistant point and that
token I am going to set it as a infinite
expiration time and then we are going to
use that token to do subsequent records
so that our application is able to
validate these tokens and then allow the
user to view the rest endpoint that's
what we are going to see in this
particular video so I will be making
more such videos on JWT with complex use
cases if you want me to do any video on
specific use cases with Jade ability
spring security and spring boot do let
me know in the comment section below
before that lets go and check how we can
integrate Jade ability in the spring
security into a springboard application
so as usual we are starting off with
start of spring dot IO so I'm going to
create a spring board application so I'm
just going to say complex primal
security I'll make this as spring food
security or I'll just make it as JW te
security so that it's more clear that
it's specific to GWT and also I'm going
to add the dependencies for spring web
and security I also need the JWT
dependency so we can add that separately
because pling doesn't have that here in
this website okay so I just generated
the project let me unzip this and then
let me open it in IntelliJ
so the project court unzip cooking open
an ontology
you
so if you are not familiar with what is
JWT you can take a look at my video
which I have made on JSON web tokens so
so that you can know what is jadibooti
and while JWT is used okay
so project is open as I said the
dependencies which we have mentioned the
gap and the security we also need the
dependency for the JSON web token so I'm
going to say JSON web token dependency
so the dependencies I don't know I'll
just say input so that the project is
important so without any further delay
let's go and create some classes right
so as a initial start I am just going to
create a basic controller so I'm going
to create a controller and then we will
add more files there okay I'm going to
create a controller package so that we
can have specific functionalities in the
package okay
so I'm going to call this as a hello
controller because I'm just gonna say
hello world as an example right so I'm
gonna have a complex example here so
this is going to be a spring MVC project
so I'm going to add the rest controller
and I'm going to say request mapping
then I'm gonna say rest slash hello okay
and for now I'm gonna say get mapping
so I'm going to return hello world here
right so this is we're just going to
return hello world when I hit the red
slash hello okay so that is the
controller so if we're going into the
other internals of GWT we need to create
some web configuration right so we're
not enable security for this application
we need to create some grub
configuration so I'm going to create a
package called conflict so this is the
package which is going to have the
conflicts for our application so I'm
going to create a Java class inside that
so let's name that class as JWT security
conflict right and this is going to be a
configuration right so I am going to
rotate it with conflict we need to
enable the web configuration so I'm
gonna say enable web config and also
once I enable web config I'm also going
to enable the global web security for
the method method level security so I am
going to say enable global method
security and I'm going to say pre-post
enable as true by default it is false I
am just enabling it as true so that you
can have annotations Aarthi different
method levels or you can have method
level and method level Security's are
the controls access controls okay so our
annotations are done now we need to
override sorry basically this particular
configuration file needs to be extended
from the web security configure a doctor
so that is the class which spring boot
uses to bootstrap it so whichever class
it executes this spring security
configurator that will be bootstrap
automatically and all the implementation
whatever we have done here will be
overwritten bethey that default web
security which we have configured so
with this we have already done in the
other LDAP and the my sequel database
security configurations of a springboard
application here we are going to use JWT
so same same way we are using the web
security
configure adapter
okay so the major difference between
that and here is we need to use the Jade
ability filters instead of the LDAP
filters or something like that because
by default spring provided end up
filters but here we are going to create
a custom filter so what I'm going to do
is I'm going to create some custom
filter so called the J gene ability
authentication token filter so what I'm
going to do is I'm going to say jet
ability authentication token filter okay
this is just so we can create this class
later so I'm not going to create it now
so what do we need to do in this class
is we need to provide e we need to
provide it I'm going to create this
class we created okay so let me create
this so that I don't get a compilation
all right so I'm going to create these
classes under security so that we have
everything under security okay
good so the class is now created the
authentication token filter the JWT
authentication token filter is created
now we need to set the authentication
manager to this particular class so
because we need to have a custom
authentication manager which is what we
will be creating so we need to create an
authentication manager that for that
purpose so I'm going to create an
authentication manager from education
manager so authentication manager is
provided by spring so what I'm going to
say is I'm going to say create a custom
authentication manager for me
ok for that what we need to do is we
need to override this authentication
provider manager so we need to override
the provider manager ok with the custom
authentication provider so this
particular thing which if you notice it
is expecting a string so I'm going to
say is or I can use the connections it
just ok and I'm going to say give me an
authentication provider right so we need
to create a authentication provider in
that case right so I need to provide an
authentication provider so what I'm
going to do is I'm going to create an
authentication provider for that so I'm
going to say authentication provider so
like how we created the hell critter
field so how like how we created a
authentication filter here we need to
provide the authentication provider as
well so I am going to name that has JW
authentication provider ok and let's go
and create this class as well under the
security let's come and take care of
those classes later but I think it will
throw an error for now so I'm going to
create
dedication provider interface yeah chill
interface so I'm just added that so if
you notice here there is no error so
I've created a proper authentication
manager with our custom authentication
provider so we can write our reputation
in the custom authentication provider
okay and these are injected as the
manager into this filter so this filter
is now going to have methods like set
authentication manager so I'm going to
provide the authentication manager here
alright and let's create this method
okay what's authentication manager is
done we can add a custom success filter
so we can add a custom
certification success and luck right so
you can add a customer success handler
so that you can redirect the request to
this particular Handler and do some
processing if you need it right so in
this case I'm going to create a JWT
success handler okay I'm just going to
create this class also in the security
and this method is wealth you okay so
what we have done is we have created a
filter and to the filter we have
assigned the authentication filter
manager and the authentication success
handler now we just need to return this
particular filter okay that is so we've
created a connection manager there you
get a filter now we need to configure
the hour they should be security filters
right so I'm going to override the
configure method which is giving HTTPS
security yeah so this particular method
I'm going to override so I'm going to
use the HTTP I'm going to disable the
cross-site Dufferin so I'm gonna say
disable it okay because we don't need it
and I'm gonna say authorize all of my
requests so I'm gonna say authorize the
request and I can filter out requests
here I you can do a matches here what
I'm going to do is I'm going to say
authorize all my requests right you can
do that or for example if I need to
match only specifically cause you can do
specific requests so for example in our
case we can say slash starter slash rest
so if you have something with the rest
okay I need to authenticate to that okay
and then I can say authenticate it so
which basically means all the requests
which are having slash this slash right
those will be authenticated the rest all
will not be authenticated okay
and what else we need so we need to have
some exception handling so what we are
going to do is be if let's say the URL
is not authenticated so where should
data quest go right so we can add some
entry points here so there is something
called authentication entry point so
this is nothing but another class where
you can use it for redirecting the error
messages so we can say enter point okay
I need to create the object for that
here so what I will do is I'll just
create a field and then inject it
okay so we can create this as a GWT or
complication entry point or create a
class under security is right okay so
the authentic the entry point is now
created and what else we need so why is
it showing indication point oh it needs
a yeah I need to works do I think its
interface again so they say implement
and then I'll implement a method called
comments okay so right now I don't need
anything okay so I'm just saying nothing
okay I don't need to have any exception
handling as such so I am not doing
anything we can modify that later but I
will show you when to do that right so
once this is done we need to maintain
our session right so I'm going to make
the session stateless so that we don't
have to worry about the states in this
session so I'm going to create a policy
so I'm going to say create my policy as
stateless all right so on I'm saying
HTTP security that okay don't make my
sessions stateful so I am saying
stateless
then finally we need to add our filters
right so whatever filter we created here
we didn't use it here so we need to add
a filter we just say add before okay I'm
going to say add the filter before our
username password authentication filter
which we used to have by default in
spring so I'm going to use this filter
and I'm going to say username password
authentication filter right so before
this particular filter just load my
filter that's what I'm saying here
alright so I think that is it so what
else we need we also need to have the
cache controls for the headers so we
need to say where should I be you know
what it is what cache control so we this
will add some default headers to thee
requests
so for strong parameter so what does it
say
so it is saying that patient to
authentication
it should be of type filter right yeah
okay so I think in the filter I need to
have a spring of type filter yeah that I
can go and modify now I think we can we
have great at the config so we can go
and create the filter now right so let's
go to the filter and then add the
necessary implementation so this filter
needs to be I think it should be an
abstract class oh it's a it's an
abstract authentication processing token
there is that processing filter so yeah
this is the abstract class which we are
going to implement right so yeah we have
implement at this guy now
right yeah
the error has gone from the config
project here so we need to implement
those methods and I don't need these as
a method here right so I just need them
to do something
because these are not required these
should be coming in from I think you
need a super constructor yeah right you
need a processing URL so what I'm gonna
do is I'm gonna say have all the URLs
which are going to be coming in right so
I'm gonna pass in a URL here I'm gonna
say slash star star right but this is
going to have this particular filter is
going to be hit for every URL which is
having slash star star so which is
basically everyone right okay so now
there is a method called attempt
authentication so he this is the place
where we need to authorize our request
so this is where we will be handling our
request and then validating it so this
is where the tokens will be used here
all right so what we can do is we can
now take care of this later because this
is we have not implemented the token yet
right so this is the place where we
decode the token and then we will be
doing it so let's look at that later
so whatever classes we have created we
have it at an entry point right so now
we can put the entry point so in the
entry point we have to give some error
message right so what we can do here is
if the particular request fails I'm
going to say in the HTTP server response
send an error right so send an error
saying the user is not authorized
so for user is not authorized I can say
dot or not authorized or it's a response
ID so you have lots of errors here
I'll say I'm not the right it's gonna be
for not one yeah so and once it is on
authorized you can just send some
message not so fast
okay I'm gonna send a message hang on a
thread that's it so that is what we need
in entry points what this is where thee
the failure messages are handled so if
there is a failure with the message
which came in so it gives this
particular error so now let's go to the
provider so the provider is where all
our major processing takes care because
this is where we are going to
authenticate the class right so here
what I'm gonna do in the support so if
the support is going to return the
boolean so I'm going to check if the
type if that particular class is of type
whatever we have here the JW
authentication tokens right the daughter
indication token is what we need so we
need to create a we can create a class
called Jerry ability authentication
token so I am going to create education
jokin you can tell you what is that
right and I'm going to say is assignable
for the particular class which basically
means is it an implementation of this
particular class which we are getting
right so and that's it right okay
and we need to create this particular
class isn't it
so this is the token class which will be
used by the other classes too as a model
okay so this is nothing but a model so
I'm going to create this under
model okay and this class is not a
direct model it is going to use the
username password authentication token
so if you notice here there is already a
class again we have to implement these
right so we have to create a constructor
okay so we can create some I think we
don't need these many right we you don't
need this particular constructor so what
we are going to do here is we are going
to store the token in this particular
file so I'm going to say private string
token so this is where I'm going to
store the token right
and I need to add this token trick now
you'll just say add constructor so I
don't need these two variables okay so
I'm gonna say none because we why
default it expects me to give those
credentials and stuff I'm saying that
okay I don't need it and I will just
create some getters and setters for that
right and there will be this gate
credentials and get principal method
which we have to override by default
it's going to return the same thing but
I'm going to override and then say don't
return me anything so I'm going to
override these two I'm gonna say don't
return me anything so it's not there
also I'm gonna say now so don't return
me anything because I they already I if
you notice here we have already passed
null here because I don't want to have
the credentials here as I said earlier
this is just going to be a simple
example so I don't want to make it
complicated
right so we have created the token here
now let's come back to our
authentication provider so in the
authentication provider we have taken
care of this particular class but we
need to take care of the other one right
the authenticate method so what we are
doing to do here in the authenticate
method is
I think in the authentication provider
we should not implement I don't know why
this of indicate method came into
picture so I think I need to use the
user details because you have details
already has some implementation right so
there should be some yeah I think I can
use the abstract user detailed
authentication provider because that has
some basic implementations I don't have
to directly use the interface so what
I'm going to do here is instead of this
particular in stir in trophy's I'm going
to use the abstract user details
authentication provider so that it gives
me some flexibility do not have this
method right and it gives me some other
method right yeah
it gives me two method so I am NOT going
to touch this additional authentication
checks if you need any additional
authentication checks you can add it but
I am NOT going to touch that instead
there is something called retrieve user
okay so this is what we need so this is
the method which will be called when
there is a user here so for example this
is going to be a user name
okay this is going to be the password
token so this is the token if you notice
here we just handled so we created a
Jain ability token of type username
password token and that is what we need
here so we are going to use that
particular token here right so what we
are going to do is we are going to use
this token right and we are going to
convert this into our type J ability
token because that is what we receive so
we are going to convert this particular
token here right so we are going to
convert this into jadibooti you're going
to say token equal to JWT right okay so
we hold on that okay from this token we
need to get the string token because
that is what we need right this token we
just created a token out of it right so
and just new in the name this was JWT
token and I'm going to create the string
token and I'm gonna use a GWT token dot
get that is going to be your model right
so we just have that dog get token now
this token is now stored inside the
string token now we need to validate
this particular token whether it is
whether it is correct or not right so
every time when the request comes the
user name comes basically and also the
token comes the token user name is not
required most of the time like in in our
case we are not going to use it so we
get the token for every request and that
token we got it here as a string we just
extracted it as a string now we need to
validate this token so what we need to
do is we need to write a validator so
what I'm going to do is we're gonna I'm
gonna write a parrot Aitor
let me write a quick query data right
I'm going to write it here say component
right
in this validator we are going to parse
the what are we going to parse here so
we are going to say in you going to do
this and just do it she all right this
is going to be a component and annotate
it with component and I'm going
okay I'm gonna use the validator to
validate token right so I I'm gonna say
validate right I'm going to pass the
tokenism and let's create this method in
this battery and what we need to pass is
some object right I'm not going to say
what object let's create that object
right so we got the token from the token
how do we now arrive at the arrive at
the user details because if that is what
they that is what we need at that layer
right so this is why we added this a
form dependency so we added this
dependency here right
Oh what example the system is slow right
if you go to the bomb protection well we
added this a IO dot JSON web token right
so this dependency is what gone is going
to help us in this particular case so we
are going to create something called as
claims so claims if you notice your are
coming from the JSON web tokens okay I'm
just going to create a claim okay I'm
just going to create a claim so in order
to create a claim there is some there
are there are some utility called JWT
yes if you notice here there is
something called parser there is
something called a builder so in our
case we are going to pass the token so
we are going to use the parser
so the token is this JWT is going to
parse the jane ability message so if you
notice here this is how the Jade ability
message looks like right Java token
looks like so we are going to pass this
particular message that is what this
particular utility is going to help us
with so I'm going to say paths and and
I'm going to create a I'm going to use
the key so we need to use a secret key
right so we need to have a secret key
which the the care who created it and
the guy who is going to pass it knows
right
and this particular secret is what will
be having here so I'm going to have the
secret as let's say this is going to be
a string that and I'm going to have the
secret as let's say YouTube okay so this
can be configured so for now I'm hard
coding it but you can you have to use
this secret to create generate and you
can you can use the secret to parse so
in this case we are parsing in other
case we I will show you how to generate
as well so I'm going to say parse right
we are going to say parts and we I need
to parse what the token that is what we
are doing here right
and we need to convert that into the
claims so we need the body of the
message right so whatever whatever js0
booty we pass we have header payload and
stuff we need the body which is nothing
but the payload so that is maybe data
get body
so this claims will have no the body in
fact we can rhenium into this into body
because it's just a body right and
inside the body we will have the
messages so for example in the body we
will get the subject we can we can get
the subject
okay so what I will do is I will create
a JWT user okay a POJO so what I'm going
to do is I'm just going to create this
particular under model okay so we can
say JWT user equal to new JWT user and
GWT user dot
set of this particular subject is going
to be our username so I'm going to say
it has username
right so this is going to be our
username this method doesn't exist let's
create a setter yeah right the next one
would be the ID we can set the ID in
their own so ID could be like long let's
say let's take a long value so I'm going
to say he said ID and I'm going to say
body dot get off user ID right and this
is going to return as a string right so
from the string we need to convert it
into a long value so what we can do is
long don't know
okay we'll be getting the set ID and
then that's great that's a tidy as a
setter okay we have done that
now finally we need the roll so from the
JSON message from the token we are going
to get all these three so the token is
going to have these three encoded okay
so I'm gonna say is it's a toy okay and
it's going to be a string so I'm going
to say body toward get get off roll okay
I'll just get rid setter as well now
what do we need we need to return this J
to be user that's it right so that is
what we need so we will say what type of
fuse are willing to rooted I'll say J is
about the user okay that's all we need
so if you notice here what we did is we
used the Jade ability library to create
some claims so if we use a secret called
YouTube we assumed that from the user
the user would have created the token
using this particular secret and we are
decoding with a same secret you can have
multiple Secrets for multiple the token
so you can have different see a
different ones okay
and we are getting extracting the user
ID role on the user name from the token
and then we are setting it in our model
and then we are just sending that model
so that in this particular place so we
have that particular model here so
I'll have the Jade ability user here so
we just created that model because we
can use that model here just to like
send it around right we can use that in
this particular provider so what I'm
going to do is I'm going to check now if
this particular JWT user is going to
exist or not because what could have
happened is if the if there is no
durability token right so this could
have thrown an exception right so what
I'm going to do here is I'm going to
create a create this outside here and
then gonna say this is gonna have a
try/catch
right so yeah so if there is an
exception it will just print okay so I'm
just printing that exception so if there
is no exception then it if there's an
exception it'll be null so I need to
check this as an Altoid so I'm just
saying if it is null then throw me some
exception right so I'm gonna say through
new runtime exception for now I'm just
gonna throw some phantom exception or
you can even create some custom
exceptions if you are willing to okay
and then just say jet ability token is
not linked okay that is what we need
here now from what we got we have the
rules from this particular user we have
the rolls right so we need to we need to
send the object of type user details
right if you notice in the first spring
security I would have created a model
and then I would have overwritten the
user it is we have to do the same thing
here so what I'm going to do is I'm
going to create a new object called j TT
user details right so i'm going to
create something like that
so before that what we can do is we can
get the grant we can get the granted
authority created so I'm going to grant
authority
okay because we have the roles already
there right so I'm gonna say Authority
utens okay from the authority UCLES
there is comma-separated whatever and
then I'm going to give the JWT use a dot
Cutrone
I think I didn't create this a guitars
at all right let's go and clean some
guitars did the greatest No so okay I
have the gate roll fine
so I've got the grants as well so this
also needs to be now used right
so what I will do is I will just pass
the username
what is the username the username will
be JWT told you nobody user don't get
user name comma GWT or gate ID right and
finally beneath e Authority and also we
need the token so I'm ghost Kono's in
the token as well to this particular guy
right and this encloses with semicolon
just say return this time remove this
and now we are going to create this
particular POJO under the model right
and this is going to implement the user
detail so if you notice here
automatically this got picked up so I'm
going to say use the same
just say enter okay now we need to
implement this particular guy so I'm
going to say implement right
now the problem is we need to implement
these as well so I have done that here
I'm gonna say private string username
we need the whole the right sorry this
is not gonna be role this is going to be
the token the long ID and finally the
grants for making say authorities when I
tell you this this is going to be a
collection right because it's can be
anything this is going to be of type
authority
cool okay now I'm going to use this
variables which we have used here this
dot username equal to using this dot ID
equal to ID they stop tokens one two
they start Authority is equal to grant
okay so we have done this now I'm going
to create the getters and setters for
the methods we created right
okay cool so we have created the getters
and setters we have the easier okay so
we have some methods which we over wrote
right so we have to know already Smith
and so here there is a username so I'm
going to pass the username as username
here right so apart from that I think we
don't need this password because we are
not having any password alright and is
the akan expire Apple true is the akan
not locked truth right this is going to
be true is credential managed by dr true
and is enabled true here right
cool I think we don't need anything else
so we don't need this as well right
you can have the password though and
anyway couldn't think that is it we
don't need anything else right we don't
need these settles because we are using
the Constructors to inject the value so
we don't need these of us can remove
them some necessity right we are the
catalyst and we have things here so what
does it must be either abstract or why
some did get implemented okay maybe we
can things to be good yeah okay cool
yeah maybe this is necessary right so
where were we we created the yeah we are
here so we have created some
user details the JZ ability user details
so what we have done in this particular
class is we in the provider as we
created evaluator we validated the token
and then we have now identified what is
the JW user which code decoded and from
the TD Pollard value we created the
grants and then we are assigning to
assigning it to the string user details
which spring can use to validate ok
that's what we have done here
so what else we have done so we have
created the entry point we agree to the
provider and now we need to go to the
token filter okay so the token filter is
where he will be filtering out the URLs
and then we will handling stuff right so
what we are going to do here is we are
going to use the header the request and
then we are going to do something here
let's see what you're going to do so
from the header what I am going to do is
I'm going to extract some information
from the header right from the request
from there should appear a quiz you can
do a get Heather ok from the header you
can get a header information so we need
to configure what header we can sit so
what I'm going to do is I'm going to set
this header as let's say token
ok and if they're in the header if I
pass this as a token then that token
will be off so for example let's say I
am going to pass this as authorization
right I'm going to pass this the
authorization so from the authorization
I'm gonna get this header from the
authorization I'll be getting the header
right
that is the value so if the header is
non right so what do we need to do if
the header is none or if
header let's say start so I'm gonna use
the token as a prerequisite so I'm gonna
start the value of the authorization as
token and then I give the token so I'm
gonna say if it is not starting with the
token then throw me an exception saying
okay these guys are incorrect so I'm
gonna say throw new runtime exception
jet ability token is missing right
because the token is not a right I'm
gonna say it is missing okay okay now
what I'm going to do is now I need to
get the value after the token right so I
need to do some substring here so we got
the token we cut the header sorry you go
the header and now I'm gonna do a
substring and then we need to get the
value from the header here how many
other 3 plus 2 5 6 so we need to gain 6
right from such thing we are getting the
value so the token is now received so
whatever we have is here is the token
and this is fair we will be creating the
JWT token authentication token and then
sending it back so we are going to say
token cutie
okay and this is the token which we need
to send it so what we are going to do is
we are going to say good authentication
manager so we are getting the
authentication manager and then we are
authenticating it using this particular
request right so using this particular
token we are just wanting like adding it
and this is the method if you notice
here this particular method is what we
overrode here where we received the so
here is that here right well not yet
that decade where is the Authenticator
is over a decade to decade fine I can't
see it okay
one is this through authentication
filter is now throwing in error saying
it needs to be has a protected access
why is it protected axis should be
public right okay now what is this again
Protectorate okay this needs to be the
success under needs to be handled so we
need to write that next so what we can
do is we can write the success and the
meanwhile we can do the we can complete
this filter so we haven't completed the
filter yet so we have added the Adam to
authenticate and then we have triggered
the authentication so this will be
triggered this token will be now
triggered now we need to override one
more method right so there is something
called successful authentication yeah so
on successful authentication what we are
going to do is we are going to say
proceed with the next chain because we
have a different filter right so we are
saying that go to the next filter so
that we don't have to block any requests
here so I'm going to say the question
responds oh yeah after the
it will proceed to the next airplane
filters okay so we are just overriding
that here that's it nothing else now we
can go to the success handler this
success handler what we can do is we
have to overwrite the sorry we have to
implement it from the authentication
successful Handler indication yeah so
this is and again there is something
called answer or successful
authentication so I'm not bothered about
anything we can just add a success will
be authenticated I'm not gonna do
anything but you can do lots of stuff
here after successful authentication if
you want to have any hooks there you can
have it to be successful and that's it
so I think we have everything ready only
thing I want to add it here is in the
tokenizer days here I'm gonna add again
this clash whatever because I want to
authenticate only the filters which are
having that particular you are right
that's it okay what else do we need so
we have already use it retail you know
but yeah now the major part is we
haven't created the token generator
right so what I'm going to do is I'm
going to add one more risk controller
which is going to be like a token
generator right I'm going to create a
token controller I'm going to say risk
controller and just mapping
when I just turn a token and I'm just
saying generated token form right right
so I am going to just pass the username
here so that we can see how the tokens
are generated so I'm going to return the
token here itself so what I'm going to
do is I'm going to return this arrest in
point so whoever hits this rest endpoint
with the same token with a username this
is going to generate and you'd open and
then give it this is a path variable so
like how we created the validator where
we use the claims so we have to use a
similar thing here so we have to use the
generator here so what I can do is I can
create a class called JWT
generator token generator basically I
can just say generator
so let's create this class under
security right so I'm gonna create since
I didn't a generator will just say
generate and I'm gonna pass the username
all right that's all I need so I need to
pass the ID in the role as well so what
what on what I'm gonna do is we have
this object right yeah we have this
particular object right so we can use
the same object so we can use the same
JWT user to create a user ID user name
ID and role so what I'm gonna do I'm
gonna make this as a post so that you
can pass this object so I'm going to say
give a token don't send me anything and
just say it as quest body and I'll just
say this particular object right so I'm
going to use this JWT user and then send
it here directly okay and this is going
to return again a string which is going
to be a token okay so we got the user
here and inside the user we have the
username all those stuff right so we
need to create the claims here same way
like how we created in the validator we
have to create the claims so we need to
create a claim is saying claims and in
this particular case we are going to use
the Builder so previously we use the
parser we can use a builder and if you
want to have the token valid for only a
particular period of time you can say
set expiration and give the particular
period so that at that particular time
the token will be expired so for now I'm
going to have an infinite token so I'm
not going to have any expiration to it
so I'm just saying that use the claims
to set claim I think we have to create a
claims here so I think this we can move
then we need to create a claim rate so
in order to create a claim there is a
option for JWT a store claims so this
will create a claim and we need to add
the values into it right previously we
got the values extracted the values from
the claim now we need to set the values
into it so I'm just going to say user or
gate using it so this is what we did in
the well data site so we got the value
from the body and then put it inside
username got the user ID and then put it
inside ID and then roll inside forever
so what I'm going to do is I'm going to
do the same thing here so I'm gonna put
I'm just I just had the I just got claim
here so I'm going to change output you
can set user ID come on
what is that jadibooti user dot gate
ready this vector D is it too long it's
alone so what I'm gonna do a string then
the next one will be the roll so what we
need to do is say WP you don't get wrong
so that is already a string so that's
fine
so we now created a claim and from the
using this claim so if you notice the
other I ok to the game K so I using the
skin I'm just creating a builder and
just using that in this it claim here
and then I need to sign this right so I
need to use some sign of algorithm so
I'm going to say sign with signature
algorithm I'm going to use a HS fight 1
right so I'm going to use it as fight 1
so this is another hashing algorithm so
that happened I pick off algorithm you
can use any algorithm I'm gonna use the
dashing I've gone and you need to pass
the secret now so the secret which we
had here is YouTube right that is what
we added there
and then we are making it compact so we
don't want a very big token so I'm just
going to say it as compact so this
secret is nothing but the secret which
we had in the validator right so if you
see here there is a secret here so it's
the same secret so in the generator
whatever secret we give the same is what
we are using the validator to extract or
validate information ok and then we are
going to return this guy it so we don't
have to do with this so this is going to
return this particular function is going
to return the JSON web token ok for us
so that we can get that particular token
and then use it so the user is going to
hit the token generator so the user is
going to hit this particular resistant
point ok they are going to hit the token
with a post providing the user name ID
in the hole and then they will be
getting the token back using that token
they can use the hello this particular
hello controller where we said in the
config that whatever has rest slash
authenticate that right that's what made
it here so I think I'm done with all the
code changes let's quickly do one on a
roll to say everything is done all these
are models so these should be fine I
don't have brought over them so this
entry point we have to auto wire we have
to sorry basically they add a component
is injected so come on I've already done
it landed I am not very good in the
token philtrum token printer anyway I am
doing the create right here yeah I'm
doing a new so I don't have to auto why
that add a component to that generator
anyway I am doing a new generator so I
don't have to do that there is what so I
don't need a no instead I can do company
making this concept all good so that's a
really successful handle success and it
should be fine that also be able to new
in the new in here
yeah new so we should be good so we
don't need a validator yeah build a
training component that's it and the
other stuffs are the property files so
I'm gonna what I'm going to do is I'm
going to add some default port so right
now I in my machine the 8080 is used by
Jenkins which I installed some time back
I'm not using it but still it is having
the both by default configured so I'm
going to say so for equal to eight zero
eight three four eight four maybe I just
wanted some port which I can use it for
running this application so that's what
I have done here and let's add some
application Yama so we need some basic
configuration there for spring security
so what we are going to do is we are
going to enable the spring security so
we are going to say management right
security enabled true so this will
enable spring security and also we are
enabling the spring resources change so
what I'm going to do is I'm going to say
spring resources chain enabled so that's
it so we don't need anything else apart
from there we should be good ok so let's
go and quickly start the application and
then we'll move up to something I hope I
have done it so there are too many code
changes but III haven't remembered
everything I then whatever I could so
let's see if there is any error we will
try to give up it I think I have no over
here
and if you're starting down another one
gone and this means they come find out
to use all eight okay if we start again
the jelly
Okin controller defined in what does it
say open dances or some of the being in
application from a cycle okay okay so it
is saying that there is a cycle inside
okay so the token I'm injecting the
generator or should I should I use
generate idea why you did it okay
so I think it did a controller in itself
that's why it didn't came along so this
should now work hopefully so I have the
postman client as well so let's see
kunos colon 8080 for whatever you are
yeah looks like a server is up without
any interruption so I have 8080 so what
I'm going to do is I'm going to use the
browser to hit the hello rest endpoint
so this should return us some error
saying that okay the user is not
authorized but if you notice here we are
allowing it right so that means there is
a problem there is a problem in the
filter maybe not oh no way so I think
here what I'll do is a little choice
because I think we are not everybody to
go in that is what happened but this
should filter us let's see what happens
or I would have screwed up somewhere in
this particular expanded
I guess under check if this works it
still doesn't work then yeah the JWT
token is missing yeah I think there was
a that was a problem so if you notice
here what this guy is saying is the JWT
token is missing so this is nothing but
the check which we added here the right
where is actually the entry point oh no
not in the entry point yeah in the JWT
authentication token filter so here the
server is now expecting the token to be
sent if the token is not since it says
that okay the token is missing so you
cannot do anything right so if I hit the
toca understand point I think I should
get the same error yeah I think I'm
getting the same error here right yeah
so basically all the urls are getting
filtered here but I don't need that so
that is why I've had this particular
slash but looks like that rest lash is
not working so maybe I can try this
because I want the token to be a now the
slash token should be a load so that I
can create the token right so it should
be followed for everyone without having
to add any authorization in the header
right so the server is up again yeah if
you notice here now it is saying that
gate is not supported that means the
token is allowed but same way the rest -
hello should not be allowed yep still we
are getting the same error so that means
the rest slash hello is now secured and
token is not secured so let's go and do
it quickly
so let's go to quickly create the token
here so M goes I'm just being token for
post and I'm not adding anything ended
up in the body
I need a just e
so what do I need to send I need to send
this JWT user right yeah I need to use
the name ID in the role right so what
I'll do is I'll just say username nice
feet up ID I'll just mention it as 1 2 3
working so what else you know like they
say admin for now so we are not checking
anything for specific to the road in
this particular example we're just
trying to create a token from the soil
the token gets created we can use that
token to use it right so if I did a post
what did it say unsupported media type
you should type in video not supported I
think I know how to add something else I
think I made it as next I just made it
as Jason's mother so how many test
Jason's they should return me something
but if you notice here the Gatien if you
see some error why is it showing in
error if there is a comma there is a L
okay I shouldn't have I shouldn't have
put any because in Java we have him and
if you notice here we got a successful
response this successful response looks
like something big read you will notice
here there are three segments to it but
four signals has some message and then
there dot second segment has some once
again then the dot and then the third
segment again is slightly bigger so this
is nothing but the JWT if you notice
here this is how a JWT looks like a Java
a JSON web token looks like this okay so
successfully we got this particular
token now we can use this token to send
the rest endpoint right so what I do is
I'll just add the same hello
localhost:8080 for / rest / hello now
I'll do a get and see it should not
allow me so if you notice here we got
the error saying JWT miss token is
missing however now
in the header if I am if I'm adding this
authorization right polarization right
that is what we added as a key in the
provider here in the token filtering the
token filter we added authorization as
the header right and then we added the
value as tokens right so I'm going to
add the same thing here I'm adding
authorization and in the value I'm gonna
say tokens face that whole big JWT
message okay so we generated the token
using the user name and user name which
we provided and we are now using that
value which got generated and then we
are going to hit the rest endpoint yep
if you notice you may receive hello
world so if we don't send this
particular header if I remove this one
same they are getting same JWT token is
missing but if I enable the sunset it is
now successfully returning the message
so if let's say I'm giving some wrong
value here right accidentally let's say
I give um value if you notice your
ability to finish it incorrectly the
signal so previously we got is missing
now it is saying incorrect since the
other trick which we had where we are
validating whether the token is perfect
so now it is saying incorrect if I
provide the right one right if I throw a
direct one it says hello what if I don't
provide this it says JW token is missing
okay so this is how you can use your
spring boat application so what are
using capability for I'll just summarize
what we did that code is too much I
don't know how much time it took for the
whole video but I just summarize what we
did so as a part of the security
configuration we added the
authentication manager we created an
authentication provider and then
injected that authentication custom
authentication provider into the manager
and we connected
authentication filter the token filter
which can filter out and check whether
the token is there or not whether
basically this can handle or validate
the tokens that is why we are using this
filter and we can add some success
wonders and then we can
see whether the record responses success
or not then we can control our HTTP
security URLs based on some URL regex
patterns and then say only these should
be matched only these can be authorized
and if there is an exception we are
redirecting it to a authentication entry
point where we can just say what is
happening so for example we show that
the token is incorrect
so oughta make an exception I mean when
we handle that it would open is
incorrect
and also we have managed the assessment
stateless so we mention that this will
be stateless the filter whatever we
created here we just started here into
the HTTPS and then finally we made the
headers as cache frontal okay so that is
about the configuration so coming back
to the controller so we just added a
twist controller which is having this
flash hello nothing else okay
beat create a token controller which is
having a token generator so the token
generator is going to generate our token
so inside the generator we created some
claims which is coming from the JSON web
token library we created a claim way to
user name user ID in the role which we
passed so in the postman if you see the
first message which we gave it so that
is what we pass we gave our username as
Peter we gave the ideas one for thing I
gave you role exactly this way that is
what was coming here and then we are
putting and creating a JSON message here
so this is what creates a JSON token
using me which is fight well algorithm
and using the secret key called YouTube
so this is a secret key which we are not
passing it here but the server already
knows it right that is why this
particular secret means what call it
here okay so that is what we did in the
token controller so the token for all
the generator that open and gave it
using that generator token we hit the
hello controller the rest national right
now we created some models for the entry
point and big for the entry point if
there is a error we just said if it is
not it won't be authorized for the
provider authentication provider be
added some validation here so we created
a delegator GWT validate using the same
library we are a deacon of de tokenizing
basically that cold Jason
touken is now extracted basically you're
passing it using the same secret key
which we had for YouTube and then we are
getting the message for the user name ID
and roll okay so that is how we know
that okay the user is correct okay so we
got that message we validated and if the
user is present so once a user is
present what we do is we just send that
to the spring security frameworks the
security framework which is inside
spring it is going to have the usual
beeping so that is why we created this
Jade able to use a retains here and then
we gave it back okay so that is how Jade
ability is integrated into spring
security inside a spring but up location
so this particular project I will be
uploading it into github right now so
you can the I'll leave that link for the
github link in the description below
just check that out and then try it out
and also I forgot to mention that we had
added some properties here so just basic
ones right so just to check that out and
then try it out you don't need any
database or anything to try this you can
just follow this I'll just add a readme
here so that you can follow that okay so
that's it for this particular video so
if you want to make make me any specific
topic drop that in the comment section
below or if you want me to modify this
whole example of GWT into something
better for example database integration
or something do let me know in the
comment section below I will make a
subsequent video for that I hope you
liked the video if you haven't subscribe
to the channel go ahead and subscribe to
it if you liked the video go ahead and
like it we do get in the next video
thank you very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>