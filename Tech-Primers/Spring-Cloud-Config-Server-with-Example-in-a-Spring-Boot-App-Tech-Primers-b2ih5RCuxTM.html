<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Spring Cloud Config Server with Example in a Spring Boot App | Tech Primers | Coder Coacher - Coaching Coders</title><meta content="Spring Cloud Config Server with Example in a Spring Boot App | Tech Primers - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Tech-Primers/">Tech Primers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Spring Cloud Config Server with Example in a Spring Boot App | Tech Primers</b></h2><h5 class="post__date">2017-08-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/b2ih5RCuxTM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to tech primers how does it feel
when you don't have to restart as a
process when you do a conflict change
when you do a conflict change or a
conflict change inside your project you
do not have to deploy that into your
production machine or your UAT machine
how does this feel like right so there
are frameworks for that that is what we
are going to say in this particular
video so in this particular video we are
going to use spring cloud config server
and then see how we can do config
deployment without even having to
restart your process but your changes
should be picked up on the fly right so
that is what we are going to see so in
order to do that we need to understand
how the config server works right so
spring has something called spring cloud
config server so in order to use that
particular framework we have to follow
this architecture with the same pattern
so we need to return a configuration
client basically that is going to be a
springboard application and that will be
communicating with a config server from
the config server it needs to redirect
to the github repository so what what is
going to happen is from the conflict
line we are going to access the
properties from a github but opposite ok
so literally it can be a get to our ISP
interpose Italy which we can configure
ok I am going to show you a example of
how to access it from a github
repository
ok so basically the conflict client is
going to be a springboard application
the config server is going to be a
spring cloud context server library
inside a springboard application so that
is also a springboard application but I
am going to add some spring cloud config
server dependencies ok and the contact
length is going to have the conflict
line dependency and these are now going
to access a property file from the gates
opposite so this could be a github
repository or your s paint repository or
anything so I am going to have a I'm
going to create a git repository locally
and then I am going to access that from
the context over ok so if I change
something inside the app name the
property he should get reflected right
how does it get reflected
so they created this flow but let's say
we are going to change something in the
great repository
how does the process know it so if if it
is like every time the client has to go
to the server and get the data that is a
performance shake right so what are the
sprinkler team have done is they have
created the server and the Gator Pro+ so
this will be loaded only once okay so
the config server is going to load only
one so the clown cake line will not go
to the server every time okay so in
order to bypass that if you want to
refresh the latest change from the
properties you can change the git
repository and how do we refresh that
right so in order to do that so the user
has to put the flow is like user
comments the changes into the app name
drug property hood then the user has to
trigger these Refresh option on the
client so when the user triggers the
reflect the Refresh option on the client
the client is now going to go to the
server and ask for new information from
the git repository so basically it is
going to rebook the configuration and it
is going to research the properties so
that the client will have the latest
property so if you notice here we have
not Rea deployed anything we just change
the property filed without even having
to restart the application but this will
not work for every type of scenario
because there could be some property
file which for example database
connections you cannot change the
database connections like these right so
you can have application specific
properties indicate repository and then
we can go and change them okay so that
is what we are going to design now so we
need to create two different processes
so let's go ahead and create them so
let's go to the typical spring
initializer right so I'm going I'm there
already so I'm going to say config okay
and I'm going to say config server
calculate the config server first so for
the config server we need the
dependencies of only the config server
okay so that is the only thing which we
request we don't need anything else for
the config server right so I'll just
create the this hits the generate option
so this is going to get generate a
context of for me I have created it now
I need a contact client as bonded so I
am going to create a conflict client
basically both our springboard
applications that is why we are visiting
initializes
so the next thing which I need is the
dependencies so I need to expose the
rest endpoint so that we can query anthe
so I need spring MVC so I have another
this thing tip the next one we need is
the config client so there is something
called conflict rank so I am going to
add contact line and also we need the
actuator endpoint so actuators are some
rest endpoints created by spring both
automatically ok so for example there is
fish which we saw here right this
refresh is going to be created by
actuator automatically so we just need
to add the dependency and the spring
code creates that automatically for us
so let's go to and generate the project
ok done so we have both the config
server and the conflict line created let
me unzip them wait so both are unzip so
let me open that in the you could
delegated contact client right I'm
opening the conflict line and also I
will open the in Maximizer and parallely
I'll open the config server
you
right okay so both have got open let's
go to the server first okay so if you
see the diagram what we have created the
server needs to communicate with a git
repository so what I'm going to do is
this git repository I'm going to create
the server itself so I'm going to have
this property is inside this itself and
I'm just pointed to that git repository
from this is so when the server comes up
it points to that particular gate trip
oh it's just the directory you are okay
so what I'm going to do is I'm going to
go to the class if we go to the forum
example we can see that only one
dependency is there which is nothing but
a string cloud config server in order
for a spring to enable a spring config
server we need to add an annotation so
spring is opinionated right so we need
always annotations for spring book to
function something order so we are going
to enable only the config server and
that is it we are not going to do
anything else so I'm going to say start
this particular process in the port
number eight nine eight zero okay and
what I'm going to do is I'm going to
create something called bootstraps of
properties so we have never created both
structured property sets both standard
properties is the file which is going to
get loaded before all the properties are
loaded or before all the configurations
are loaded okay this is required because
we need to add the configure server
detail that is why we need it so what
I'm going to do is I'm going to give the
path of this particular folder so you
see here this folder is a home slash
download slash config server and I have
given this path ok that is all I need so
I need to convert this config server
into a git repository let's do that
later but that is all be needing the
server side so our server is ready
almost ok let's go to the client side so
in the client side we have to do
something similar right before that we
will create a rest endpoint in the
client side right so what I will do is I
will just create a message resource okay
I just need some message spread which
I'm going to create a rest controller
because we need to expose this as the
rest endpoint so that we can see whether
the properties are loaded
and this URL I'll just say rest okay
okay and then I'm going to say get
mapping go to a message so I am just
having a return path called res slash
message okay and I'm going to return a
string okay and this message is going to
be a variable which is coming from the
git repository so basically this is
going to be a field right it's going to
be a property so how do we load
properties in spring is we to a add
value right and what we do is we do this
right we load the message okay by
default what I will do is I'll just say
84 hello okay so that this particular
message is printed so when the process
comes up it doesn't say or else it will
say that okay I'm not able to find this
property and then it will say it right
so I'm just saying that load this as a
default property for this message and
just friends okay so what I'm going to
I'm going to add the bootstraps or
property is next okay similar to how we
added in the server project we need to
add the booster property so the for the
bootstrap properties this needs a
different set of properties what we need
is we need an application name because
that is the name with which it is going
to identify the property file so from
the gate supposedly we need we need to
configure this fine we need to create
this file called pick lines or
properties so that the server is going
to get and pick it up okay and also we
have to configure thee the cloud server
you are so this is going to be the
server's URL so we have given the port
number as what two supports number eight
nine eight zero so I am give using the
same here and for now I'm disabling the
security so I'm just saying management
of security wrote enable and false okay
so both our client and the server is
almost ready
however we haven't created that kids
repository right whatever this guy is
pointing this the server side is
pointing to what I will do I will just
convert this whole project itself into a
get get report so for that I need to do
a git init okay once I do a git init I
need to
add this particular file called so I
will create this file first here I'm
going to create the property file right
I need to create the conflict line
that's the name with which we have
created these properties right there is
the config line thing so I need to so I
need to create this conflict or client
and now I need to commit this time so in
the configure client what I will do is I
will just say message equal to what
message do I say hi viewers right I'm
going to do that and I am going to
commit this file okay now five got
committed and this is particularly a git
repository if you see here I can do
whatever I said this is just a small
intro positive which we created and this
is the path they have already given
inside this particular file right that's
it so let's start the server on the
client so I am going to start the server
okay and the next one is I'm going to
start a client from the client side we
are done with the changes we exist
exposed to one question point to just
bring their property that's it
we are not doing anything fancy here if
I go to the diagram which we had here we
have created this client with the rest
endpoint saying message and that
particular message is coming from the
git repository which we created and the
config server is going to be a string
cloud config server which is pointing to
this particular git repository with the
property file which we change okay this
is all done so let's see if it is all
working first so the server is up right
so what is almost up yeah the cell is up
let's see if the client is also
the client did not come up because I
think the poor there is a port class let
me do a server on port equal to eight
nine eight one okay I'll just give a
port number here
so was that we had eight nine eight zero
so I'm just making this is eight may
take one suggest we can start us in a
different book okay if you notice here
it has already had a log here
fetching conflict on the server this it
has already fished some config and if
you notice here it is the saying that
the config name is conflict line and it
has got something right so let's see if
it is up yeah this server is the signed
is also up so let's hit the rest
endpoint eight nine eight one slash this
slash message so that is the message
which we wanted it so if you notice here
we actually got the response and the
response is nothing but default which is
nothing but the default hello
so yep so the default hello came right
so restless machines because the default
hello which is nothing but the default
matches which is out there where is that
yeah so we have added that so in order
to if you notice your this did not bring
anything from the server right so
because it brought the default methods
active and also have the client get the
request from the server we need to add
an attention called refresh go ok so
this is going to pull the message from
the server side okay if I restart this
client with this change so this is going
to take me to the new value which we
have had it so in the server if you
notice they we created a pal called
client or properties but I think we
didn't commit it right did we commit
here I think we have to commit acquit
and committed
I need to get a guitar contact client or
property and then just say commit okay I
commit at the file so this should be
good so now we have committed the file
so this file change should now get
picked up by these so okay let's go
ahead and quickly check it I don't know
if I committed before I think I didn't
commit before where this also started so
let me restart the contact line so I
have added a research scope so this
refers cope should now be able to handle
that refresh option so if I want to
refresh our change ticket repository at
any point of time I should be able to
use this get repose get I should be
using this annotation called refresh
cook this is going to refresh my config
okay from the server side right let's go
to the browser and refresh it so now
this should return yeah you notice here
there is now returning the hi viewers
okay that's what we did right so we are
at the hi viewers now if you notice in
this diagram we are done with this part
it is now taking the change from the
caterer post and showing it here now
what I am going to do is I'm going to
change this get report and if you notice
that it will not change okay so I'm
going to say hi YouTube viewers okay and
I'm going to commit this way okay I've
committed this file
okay if I hear first this option so if
you notice here the message is not
changing right so if you see the diagram
which I had created I said that in order
to reflect a new change you have to do a
refresh option right so that is what we
are going to do now okay we have to hit
the Refresh option with a post okay so
you cannot do that also so what I'm
going to do I am going to do it from the
postman so I will copy the URL here and
the endpoints for that is Rufus so / -
fish so that is what the actuator is -
so I said right there is a dependency
which we added called as actuator so
that is going to expose this discussion
point string boat identifies us there is
a config server dependency and the
actuator will automatically route this
refresh to the context of okay so I will
just say post what we need to do is we
need to just sender empty like a dummy
message without any body okay I'm just
going to hit the same refresh option
so this is going to hit the server if
you notice here I got a response saying
convict client or version so this has a
contact line revision and whatever
message I added it is there I mean the
variable names the property needs so it
says that these two are there okay which
is good now let's go and refresh this
page and I expect this particular page
to have the new message if you notice
here yeah they got the YouTube viewers
okay so you notice right what I did I
went and change this con config kind of
property and basically this is the kid
repository so this is a local git
repository so whenever I change it and
committed it it was not reflecting but
when when I hit as a fresh option when I
gave a post of the Refresh option to the
client and then I when I refreshed it
got updated so that is how the config
server works okay so you have a client
and a server server will get the changes
from the git repository only when you do
a refresh so first time it goes and gets
it so the first time when the client
comes up the client asks the server
server goes to the git repository and
gets it only one but then the client is
up right the client is up and running
and you change something in the app name
then you have to do a refresh to get
that reflector okay that is what we do
so this is the concept of Springs louder
big server so conflict over is generally
a concept which people are using now in
the micro-services design pattern there
you have different micro services and
they can connect to a single config
server and there's configure config
server can be connected to multiple git
repositories and you change the git
repository the micro service is
reflecting the new property size so you
don't have to even have to do a
production release on the actual running
apps it automatically gets the
properties via the config server from
the git repository or an instant deposit
okay so this is how we use a spring
cloud config server and I'll be
uploading this code into the kid have
repository so you can get the sample
from there and then use it for yourself
you can try that for you sir okay just
change the path of the Gator git
repository so I have mentioned that it
is in my username slash download slash
something it might be different for you
you can use yours wherever you have
saved the property that git repository
whatever file we can iterate the
property file ok so that's it for this
particular video hope you liked it
Moochie again in the next video thank
you very much
and</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>