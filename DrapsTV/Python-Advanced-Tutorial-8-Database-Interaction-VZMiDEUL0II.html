<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Python Advanced Tutorial 8 - Database Interaction | Coder Coacher - Coaching Coders</title><meta content="Python Advanced Tutorial 8 - Database Interaction - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/DrapsTV/">DrapsTV</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Python Advanced Tutorial 8 - Database Interaction</b></h2><h5 class="post__date">2014-06-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/VZMiDEUL0II" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to Python advanced 8 database
interaction in this video we'll be
looking at database interaction with
Python every video will have all
slideshows and code available in the
description some quick preamble as this
tutorial is all about interacting with
the database knowing SQL or at least a
basic understanding of SQL and how
databases work is necessary if you want
to follow along if you want to work with
databases I highly recommend learning
SQL and how it works ok so what is
database interaction interaction with
the database is the connecting to and
querying of a database this could be
inserting new data creating new tables
deleting data modifying data or just
viewing data these databases can be on
web servers the local machine or even
database files use the SQL language to
talk to databases and we can use Python
to send those commands this is great for
programs that need to store lots data
scripts that manage or clean up
databases and scripts to back up the
database and there's many more but for
now Python supports a wide range of
databases Python has written a standard
for how a database module should
communicate with the database this means
that all the different modules that talk
to a certain database all have the same
methods some of the supported databases
are things like MySQL Microsoft SQL
Server Oracle SQLite and many more let's
quickly have a look at the main methods
we use for database interaction firstly
the connect method this is the first
method we use when we want to talk to a
database the connect method is usually
the only method that will have
differences from other modules sometimes
this method will take an address a user
and a password sometimes it will take an
address a user password and database
name and other times it will learn just
take the database name next is the curse
cursor method this method will return a
new curse object that allows the
executing of queries and holds the
temporary data we then have the execute
method which belongs to the cursor
object and execute a single SQL
statement fetch one method also belongs
to the curse
grabbing the first row of data that
isn't in the current query result again
the fetch Matt fetch all method like the
fetch one method return however it
returns a list of lists of the current
query result the commit method belongs
to the connection object and it saves
any changes made to the database in the
preceding queries the rollback method
rolls back any temporary changes made in
the preceding queries pretty much the
opposite of the commitment method we
then have close which put or also
belongs to the connection map object and
it safely closes the connection finally
we have the execute mini and execute
script these methods execute multiple
queries on the database one is parameter
based and the other is single script
we'll have a look at this in one of the
examples okay let's get ourselves set up
we're going to use SQLite as it comes
with Linux and it's simple to install
and use SQLite stores all of its
contents in a single file okay
so I'll come across to Ubuntu now to
install SQL Lite you do a sudo apt-get
install and it's SQLite 3 and that will
find it and it will install it and I've
already got it installed so it told me
that already installed ok so once it's
installed we can quickly create a
database by running SQL Lite 3 so SQLite
3 and then the name of the database so
we'll call it tests tests dot DB and
that will open up SQLite with a
temporary file of tests DB now we can
make it
save the file if we run in a SQL
statement so let's just check the
version so select SQL Lite underscore
version and then we put some brackets on
the end and then we end up with a
semicolon and this will return the
version of SQL Lite that we're currently
currently running okay now we can exit
out
SQLite by typing dot exit and that will
exit it out and then we can look at our
directory so LS dash LA and that will
show us up show up the new database we
just created called test dB okay so
we're now set up let's jump on to some
code now so let's create a basic program
that just prints out the version of the
SQLite database and we'll call it
database test pi so I'll come back over
to Ubuntu and let's create our Python
file so phim and we'll call it data base
test the test dot pi okay
now inside L program will define our
main function
so we want to import SQL Lite 3 and
we're going to define our main so def
mean okay so in our main we're going to
create our connection so we'll call our
connection con and we'll make that equal
to SQL Lite 3 dot connect and then we're
going to pass in the name of the
database so test dot DB is the file name
okay now we need to create a cursor
object and this class object will
execute our statements for us so we'll
call it cur or you could call it cursor
equals con so our connection dot cursor
so that'll get a cursor a new cursor
object for our current connection we can
then use our cursor to execute statement
circular execute and we'll pass the pain
SQL statement so I'll do select hand
we'll do SQLite
underscore the gin and we'll end our
statement okay now we've sent our query
off to the database our cursor will
currently hold the result of that query
so to get the result you need to create
a new variable so call it data and that
equals the cursor dot fetch one
so that'll fetch the first row in the
results and we can print that out so
print and we'll do the SQL height
version and we'll add on the data
so that'll print out the current version
and now we'll close off our connection
so con close and that's our main written
so we'll write out if now so if name is
equal to main then we're going to run
main yep okay so we'll save this and
we'll give it a run so python database
test dot pay and whoop or an error whoo
it's trying to print out something that
it can't so I put string around that
are around the data let's write quit
that hand we'll try running again and
there we go we get SQLite version is
three point seven point nine okay so
that's our first program done okay so
let's modify our database test pay to
create a table of pets and their prices
we'll use some exception handling to
make sure that we don't break our
database okay so come back to Ubuntu
again and we're going to modify our
database to test okay so in our database
we are going to in our main we're going
to add a try
so we're going to do try and this will
do this will handle all our connections
so inside our try we're going to have
all of our printing out and such
happening and then in our catch
well our accept whoops except we're
going to catch any SQLite three dot
errors and any other errors as II okay
and now inside our except if there's a
connection open so if con we're going to
con dot roll back so this will roll back
any changes that has been made because
if there's an error we don't want to do
half of the changes if it didn't work
and now finally so after the accept
finally we're going to if con so if the
connection is still open we're going to
close the connection okay so now let's
let's go into our try now now
we're going to remove our print
statement for the version because we
don't need the version anymore and we
can leave all of our cursor and now
connects because they work and we're
just going to add some more execute
statements so first we're going to
create a table so create table and we'll
pull the table pets and that will take
an ID which we it will be an int it will
take a name which will be text and it
will take a price which will be an int
okay so that's our create table done
let's execute some more commands so curd
execute and we will use double quotes
this time because we're going to need to
use single quotes and we'll insert into
pets into the table pets the values one
and we're going to put in cat and we'll
make it 400 400 okay now let's add in a
few more things so turn execute and
we'll insert into pets the values and
we'll put in two and we'll put in a dog
and the dog can be 600 okay so how we
could add more but what we'll do is
we'll just add only two this time and
we'll use the cone
dot commit so you want to commit all the
changes that we've made now we can use
our cursor again so k dot execute and
we'll just check that everything's been
added incorrectly and we select star
from pets which means it will select
everything at kin from pets and then
instead of just using fetch one what
we'll do is we'll use fetch all so we'll
grab all of the data that was found in
the query and we'll use a for for loop
so for row in data we're going to print
the row okay so this is our exception
handling so if there's any errors while
creating the table or inserting data
into pets it will roll back any of the
changes and we could also add a print
statement here so we could do efforts
rollback we could print out knowing
there was a problem with the SQL okay
now if we say this we can run it so
python database test and as you can see
it's created a table and it's added in
two items cat and dog and for 400 and
600 and Preds being able to select that
and print it out okay cool so that works
so let's go back to the slides now let's
look at making multiple queries the
Python database standard allows us to
make multiple queries using the methods
execute script which takes a string of
queries separated with the semicolon
which if you've worked with SQL before
will be quite familiar
we are also provided with the execute
many method which takes a terpil of
turtles to a lab to allow us to use as
data in a
template okay so let's modify our code
again this time we'll insert all of the
data using one query we'll also add some
extra data in using the execute menu
method we so just so we can see how it's
used
okay so I'll come back over T bun too
and we'll modify our program again and
this time we're going to change our
execute statement and we'll make it
execute script so this will execute a
script and what we'll do is we'll use
triple quotes to make our string
continue until hits another triple quote
and we'll put that ending after the dog
is entered so two triple quotes there
and we're going to remove our execute
statements so we can remove these and
we'll just tab it back in and we need to
remove all of our ended brackets and put
semicolons instead and once we've
removed all doubt function names you
should get something that looks similar
to this
now we have all of our data being added
in just the one script and it creates
the table as well we'll also add a
statement at the start so we'll knock
our create table down and we'll add a
statement at the start here that's drop
table if exists pets so because we've
already created the table we don't want
to have an error where it tries to
create the table again when it already
exists so we'll drop the table if it
exists now let's add some more data in
but this time we'll use a tuple of
tuples so we'll create a table called
pets and we'll make that equal to 8
Apple and we'll make the data
three and a rabbit and we'll make the
rabbit 202 four and we'll make that a
bird and we'll make the bird sixty and
we'll add one more in and we'll make it
a five and make it a goat and we'll make
the goat 500 okay and we'll close off
that Apple now we've got at our pool of
data we can use the curt execute many
method which takes a template SQL so we
can use insert into pets values and then
inside our values brackets we can do
question mark for the first placeholder
comma question mark for the second place
order and question mark again for the
third place order and we can close that
template off then as a second parameter
we can pass in pets and this will
execute many statements using all of the
values and pets and now we can commit
and we'll select all and we'll fetch all
and then we'll print the data back up so
let's save this and we'll have a look at
adding how it adds multiples the more
things into our database and we'll try
running it again and this time we get
all of our data has been added and we
get cat dog rabbit bird and go and
they've all been added to the one table
so that's a useful tool using the
execute mini and storing all of your
data in a table okay so come back to the
slides here
so notes to keep in mind is that most
databases have their own module however
this code should work on all of them
only the connect method might change
when executing statements avoid using
the percent operator for inserting
variables into your strings as it can be
abused rather just put the string into a
single tuple and use the optional
parameter for the parameter
parameterised queries I hope you now
have an understanding of how to talk to
databases using Python feel free to
leave any questions in the comments and
I'll do my best to answer them next
we're going to cover C extensions thanks
for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>