<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hacking With Python #6 - NMAP Port Scanner | Coder Coacher - Coaching Coders</title><meta content="Hacking With Python #6 - NMAP Port Scanner - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/DrapsTV/">DrapsTV</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hacking With Python #6 - NMAP Port Scanner</b></h2><h5 class="post__date">2013-12-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/7SrN4OPg_pM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to hacking with Python 6 and
Matt port scanner every video of all
slideshows and code available in the
description if you're watching this
without a basic understanding of Python
you'll struggle to follow along you can
watch my Python beginner series to get
you up to speed in this video we'll be
covering how to integrate nmap into our
Python program to use a more advanced
method of scanning to be specific the
acknowledgments can and that works just
like our basic scanner however it works
on a lower level closer to the hardware
first request is made to the host and a
port then it waits for an acknowledgment
if one is received the connection is
aborted because the port must be open
for an acknowledgement to be sent back
the Python nmap module makes it super
easy to interact with the nmap program
allowing us to run a scan giving us the
output back nicely in dictionaries if
you're interested in confident with
reading C++ and understand how our
network protocols work I highly
recommend downloading the nmap source
code and reading how it works it's great
the link will be in the description now
because we are integrating with nmap we
need to make sure we have it installed
before we try to use it if you're
running backtrack or Kali Linux then you
already have net and map installed if
you're still new new to Linux and using
Ubuntu that's fine I can install it with
one command so the command we're going
to be using is sudo apt-get install and
map so what this does is it uses a Super
User to get a package and install it
into our system and then the last aim is
nmap which is the package we want to get
ok so let's jump across to Ubuntu here
and we're going to do sudo apt-get
install and then nmap and when we
execute this it'll go off and it will
try and find nmap and it will install it
for us
now I'm already up to date so it's just
checked whether though that I had the
latest version and I did so I didn't
have to install it ok and now because
we're going to be
the Python and map module it can be
quite hard to get your hands on or
harder to install for new users to Linux
so what we're going to do is when I
install the Python setup tools which
makes it super easy to install modules
so what we're going to do is we're going
to get the Python setup tools package so
we're going to use sudo apt-get again
now we're going to install Python -
setup tools and this will go off and
fetch setup tools and install it for us
and I'm already up to the latest version
so it said it's the newest version
doesn't need app installed okay now
we're going to use the pseudo easy
underscore install command which is from
the setup tools package which allows us
to go off and find Python modules super
easy so we're going to easy install
Python - and map and that's going to go
off and get the Python and map module
and I'm already at the latest version so
it hasn't needed to download it and
install it okay so once that's all
downloaded installed we're ready to
start coding so we're going to have two
main functions and that is the OP the
main function and the nmap scan function
our main will happily op passing and
will run out and map scan okay so we're
going to create a Python Python file
called n map scanner and I've already
got one created so we'll just go from
that but you can use the code from our
basic port scanner and just copy and
edit it if you wish or you can
alternatively get the code that's in the
description okay so I'm going to open up
my file so it's going to be n map
scanner dot pay and as you can see I've
got a lot of the code from the basic
port scanner I've just removed the two
functions at the top the port scan
function and the cons gain function
and I've also removed the socket and the
threading and our two imports are going
to be opt pass and we're also going to
import our end map now so import n map
okay so you know for our con scan
function what we're going to do is we're
going to change this we're going to make
it out nmap scan function okay so in our
map scan function this is where we're
going to handle n map and handle that
scam so let's create an object called n
scan and that's going to equal to n map
dot port scanner okay now what we're
going to do is win the scan so we do our
n scan dot scan and we're going to scan
the target host which is what we pass in
from our function so target host and the
target port okay and now what we're
going to do is we're going to get the
information back from the scan so then
I'll put the information into a variable
called state and state is going to be
equal to n scan square brackets n square
n scan square brackets target host close
square brackets open square brackets and
the protocol is TCP close square
brackets and open some more square
brackets
and the port in target port and our last
square brackets are going to have state
as we want to fetch the state okay now
what we can do is we can print out the
results so print
I'll make it look nice put star and
we'll add the target host and it was a
TCP scan on the target port and we want
to attach space between the port and
then the state okay so now all you have
to do is edit our main so if you've
copied all the paths or information that
should all be the same we just have to
change our ports can call so rather than
calling port scan we're going to be
calling nmap scan for each of the ports
so let's do four for target for target
port in target ports and then we're
going to call out n map scan and we're
going to pass in the target host and the
target port let me close that off okay
and that's our program done so we've
written our map a scan function and then
we pass in all of our targets okay so
let's save this and let's try running it
so python and map scanner dot pi and
then our host address i'll pass in my
server so 192.168.1.3 - and then the
port is six four seven three eight
and we can scan that and should come
back with whether the port is open or
closed should be in the keyword hmm as
it seemed to hang my controls at that
try running it again so not working
there we go okay so we got that the TCP
port six four seven three eight is open
on the dot seven two server what we can
also do is we can try scanning our
router so our router is usually the
first address in your address space so
for me it's 10.1 and we can try scanning
the port 80 so that's the web port so if
your router has a web interface that
will be on port 80 so we scan what 80
hopefully that should work it may be
chugging a bit because I'm on a VM there
we go so it's come back and it said okay
there's there's a port open on port 80
so my my router does have a web
interface and we can also try port 21
which is the telnet port and that's also
open okay so that's our nmap port
scanner so yeah this this concludes our
and map port scanner you can modify this
code to scan for as many ports as you
like if you don't figure if you don't
remember all this you can easily come
back and read watch the video to
consolidate all the information if you
have any questions and can't find the
answer after a quick Google search feel
free to leave it in the comments next
we'll be looking at building an SSH
botnet
thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>