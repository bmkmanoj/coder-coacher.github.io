<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hacking With Python #13 - Finding Meta Data in Images | Coder Coacher - Coaching Coders</title><meta content="Hacking With Python #13 - Finding Meta Data in Images - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/DrapsTV/">DrapsTV</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hacking With Python #13 - Finding Meta Data in Images</b></h2><h5 class="post__date">2014-11-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hY4WuX_KqUQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to hacking with Python 13
finding metadata and images in this
video we'll be looking at extracting
metadata from images as well as looking
at using the GPS data we extract on
Google Maps I'll be assuming you already
have a basic understanding of Python
every video of all slideshows anchor it
available in the description so what is
metadata metadata is data about other
data in the example we're looking at
today it's information about an image
the metadata in images is called exif
data for exchangeable image file format
is a standard for how to digital cameras
can store image and sound files exif
data is stored in tag value pads it's
important to note that the only
supported formats currently is JPEG TIFF
and WAV files the kind of information
stored in exif data varies between
devices if it's stored with a DSLR
camera it may not store GPS information
but a smartphone might store it some
examples of data that we can find in
images is GPS info the name of the
camera owner the date the original image
was taken or even the type of device
taking the image there is more tags and
the streamer needs to list in this video
I just want to take a second to talk
about the GPS info tag not all devices
will store GPS data but it stores the
exact GPS coordinates in latitude and
longitude the information is stored in a
format of degrees minutes and seconds if
you want to use this information with
the Google Maps we must turn the corners
into decimal degrees okay so how will
the program work
we'll use the Python imaging library
pill to open the image file will then
extract the EXIF tags from the image
once we have the dictionary of tags
we'll either print them to console or
output them to file depending on what
the user specifies when running the
program ok on to our program
if you don't know python imaging library
installed you can use easy install or
pip to install pill put a link in the
description the to image files that I'm
going to be using will be in the slides
encouraged folder ok so let's get on to
writing it ok so let's jump over to
Ubuntu and
let's call the file extract meter data
pi okay
so we're going to need to import a few
things first so import we're going to
import the arc path module so we can
make our program more friendly for the
console use and we're going to import
some things from the Python imaging
library so from PIL import image class
okay from pol again dot X if tags we're
going to import the tags list okay so
now that we've grabbed our imports let's
define our get metadata function so def
get meter data and we're going to take
an image name and an out boolean which
will be whether we output it the screen
or whether we output it the file
okay so inside our function we're going
to set up a try and inside our inside I
try we're going to set up our dictionary
to hold all of our tags so we'll call it
meta data equals an empty dictionary now
we need to open up our image file so
let's create a variable called image
file and that's going to equal the image
class dot open and we're going to open
the image name that we pass into this
function okay now let's print that
screen so we know we're at we are going
to say getting me da da da
okay now let's grab the info outside of
the out of the image so info equals the
image file dot underscore get exif
so we're going to call it get get X if
method in the image file okay so now we
have the info we're going to check that
it's there so if info then we're going
to print out that we found metadata okay
so we found metadata let's start
grabbing it out of the info dictionary
so for the tag value in info dot items
so we're going to go through the
dictionary and grab the tag values and
now we need to change the tag into a
human readable format so the tag name is
going to equal the tags list dot get
we're going to get the tag tag but
learns to be good comma so we're going
to translate it into a human readable
tag name okay so now let's save into our
dictionary our metadata dictionary we're
going to save the tag name so the human
readable tag name I'm going to set its
value to the value of tag all right now
let's quickly write an if not out so if
the user doesn't want to output it to
file we're going to output it to screen
so through our print tag name and value
here okay so now after our for loop is
done let's write another F to output to
file if the output is selected so if out
then we're going to print
outputting to file okay so with open and
we're going to open up the art file in
write mode as f we're going to run
through our dictionary so for tag name
value in meta data dot items we are
going to F dot right and we're going to
write out the string of a tag name plus
a backslash t for tab and we'll do
another plus mode tab down a line and
we're going to add this string of value
onto the end plus eight backslash n for
a new line all right so let's say I
write down and we just need to write our
except for our try so back out here
we're going to accept so if there's an
error we're going to print out that it
failed all right so that's our get
metadata function done so let's define
our main so def may go inside of our
main we're going to set up our parser so
passer equals hog pass
argument parser now we want to set up
our parser to have two arguments so pass
up dot add underscore argument
and we're going to have the image
argument which is going to be the image
filename and we'll set the help up or
name of an image file all right
now we need to add our output option so
parser dot ad underscore argument and
we're going to use the dash dash output
and it's going to have the shortcut of -
oh now set up the help so help people's
and we'll do dump data how to file
alright now let's get our extract our
eggs from the passive so x equals parser
dot pass underscore args and now that we
have our eggs we can do an if eggs dot
image so if the image is there where
you're going to get meta data and we're
going to pass in the args dot image and
the eggs dot output all right now we'll
write an else so else we'll print out
the parser usage so print parser dot
usage all right now let's write out if
mean so if underscore has got a name I'm
just going to score equal to and let's
go underscore main then we're going to
run main all right so this is our
program done if we haven't made any
errors it should work so if I just look
at this current directory I've got two
images I've got data jpg and I got data
2-door JPEG so let's try running our
program so python
extract meta data dot PI and I'll give
it the data GP jpg and let's use the
dash over to output it to file and we'll
call the filename data.txt now we run
this we get getting metadata found
metadata outputting to file okay so
let's let's have a look at that file so
data dot txt and as you can see we've
got a bunch of different data in here so
we've got the the light source the
resolutions copyright of the name who
took it
what kind of camera he has got bunch of
other like time that the image was taken
so the years of comment so it has his
name in their copyright got his the
artist name here so got a bunch of other
information exposure time file source
the exes exit version and all sorts of
stuff so let's just quickly jump over
and have a look at this images so we can
see that this image is just a small
image of some fireworks okay so we can
quit out of this now now let's try
running it on our other image so we'll
remove the output this time we will just
output at the console so let's do data
to and as you can see we get a bunch of
output data so here we've got small
resolutions flash see there's no use
comment look at the time the original is
taken and we got some other stuff we got
what kind of camera was the Canon make
the model of the Canon was the eos 300d
digital the orientation was one so it
was a wasn't a portrait of the landscape
and we've got also got
this GPS info here so rootless gps info
which has the version of the GPS info
then we have the North the North
coordinates which is latitude and then
we've got our latitude coordinates here
and degrees minutes seconds and we got
our East which is our longitude so we've
got one twenty one twenty nine nine
eight four and now degrees minutes
seconds and we've also got some other
information here's just it was edited in
Adobe Photoshop and yet for the frame
resolutions whether the flash was used
etc okay so we've got these coordinates
now
but we want to know exactly where this
picture is taken so we can have a look
at this picture and if you've been there
before or you know what Shanghai looks
like this is Shanghai we can we need to
start translating these coordinates
these on Google Maps so so we can make
this work
we're going to create another program to
translate our coordinates here into just
decimal degrees so let's create another
program serve them and we'll call it
translate GPS dot pi and inside our
translate GPS we're going to import put
right import arc pass now we're going to
set up our parser we're not living in a
bottle with a main function because this
is just going to be a utility file for
us so parser equals hug pass dot
argument pass off and then our parser
dot add underscore argument and we're
going to take the latitude
and the help is going to be the going to
say latitude values in trees comma
minutes comma seconds close off the
courts there now we're going to do
another parser ad underscore argument
this is going to be for our longitude so
long and a help for our one is going to
be longitude values in degrees minutes
seconds all right so now let's grab our
args out of the pasture so x equals
parser dot pass underscore eggs okay so
we've got our eggs let's write out if so
if eggs dot flat and eggs dot long we're
going to set our lap to equal eggs dot
lat dot split we're going to split by a
b comma and our lawn similarly it's
going to be eggs lon dot split I'm going
to split with comma also okay now we
need to start calculating our decimal
degrees so D flat for decimal that it's
going to equal the int of lat
zero plus the int
lat one at one close that end off
divided by sixty point zero plus the int
of lat 2 divided by whoops 3600 100 K so
that I calculate our that will convert
our degrees minutes seconds into decimal
latitude okay now we need to do our D
long it's going to equal the int of lon
0 and it's going to follow the exact
same format is above the int of lon 1/60
point o plus int of lon two divided by
3600 point 0 now you make sure you have
the point 0 though because in Python 2
it all try and do a floor in division if
we don't have that point 0 there
okay so now we've calculated our delight
in our deal on we're going to add put
them to screen so print we need a prude
deal at and comma D long okay that's
right out else so if they don't put in
the right arguments then we're going to
print parser dot usage all right so this
is our utility function program done and
let's try it out so Python translate GPS
took GPS so pi
and we need to give it the coordinates
so as you can see up here we've got the
3114 and 3000 yeah 3077 so you don't
have to worry about this second half is
just indicating that it's degrees
minutes and then seconds so we're going
to do the 31 comma no space you 14 comma
no space and 3077 now we can do a space
and we're going to do the longitude so
this was 1 2 1 comma 2 9 comma 9 8 4 now
we run this we get our coordinate output
so we can now highlight this right click
copy now if we come over to our Google
Maps here so Maps Google comm we can
input our longitude and latitude and hit
go and that'll go off and search for us
and we see we get this little pinpoint
coordinates just off the coast here
looking right at Shanghai cool so as we
can pull up our image we did before and
does that seem to match does it seem
like they're on the water I think it
does looking straight at Shanghai cool
so yeah hopefully that was cool now if
we come back over to slide show this
concludes our tutorial for extracting
metadata info if you have any questions
leave it in the comments and I'll try my
best to answer too clearly as possible
our next topic we'll be looking at is
editing and removing metadata from
images thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>