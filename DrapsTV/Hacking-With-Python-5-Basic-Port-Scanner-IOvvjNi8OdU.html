<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hacking With Python #5 - Basic Port Scanner | Coder Coacher - Coaching Coders</title><meta content="Hacking With Python #5 - Basic Port Scanner - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/DrapsTV/">DrapsTV</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hacking With Python #5 - Basic Port Scanner</b></h2><h5 class="post__date">2013-11-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/IOvvjNi8OdU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to hacking with Python five
basic port scanner every video have all
slideshows and code available in the
description if you're watching this
without a basic understanding of Python
you'll struggle to follow along you can
watch my Python beginner series to get
you up to speed in this video we'll be
covering how to create a full connect
scan port scanner in Python from the
ground up so how it works
first we try and find the host once
found we try and connect and send some
data to the specified port if the port
is open we'll receive an acknowledgment
and connect if it's closed
we won't receive anything in the
connection times out this will be more
obvious when we write it also because
we're using threading again we'll need
to use a semaphore this time because our
thread will be outputting to the screen
a semaphore is basically a lock we will
use it to lock each thread while it uses
the print function so no two threads try
to print at the same time generating
some pretty funky output because we're
dealing with network and we're also
building programs you can potentially
give to other people will do some error
checking and handling okay so let's get
started we're going to create a Python
file called port scan pi okay so come
across to my Ubuntu U and we'll start
writing so we're going to use we're
going to have three functions will have
our con scan which is going to connect
and scan and we're going to have port
scan which is going to run out click on
scan function I'm also going to have our
main function
okay so let's create our files port scan
dot py okay now we're going to import op
pass so import
Haupt pass as always and from socket
we're going to import import start so
everything and from threading threading
we're going to import star as well
because we're also going to use
semaphores and we're going to create
create a global variable so we're gonna
call it screen lock and this is going to
be a semaphore so simmer for so that's
with capital S and inside the brackets
here I'm going to set the value to 1
because we only want one thread to be
out of print at once ok now we're going
to define our Kong scan function okay so
DEF CON scan and we're going to take the
target host and we're also going to take
target port okay now we're gonna try and
create a socket so con SKT the socket
equals socket open up to brackets and
we're going to use the AF I net and
we're going to have a socket stream so
sock underscore stream and now let's try
and connect to our host so con socket
dot connect open brackets and now we'll
get a open bracket again and when I give
our target host and our target port
and close double brackets and now we're
going to send some data to it so con
suck it dot send open and we'll just
send hello and put backslash R and
backslash n okay now we're going to grab
the result so results equals cons akut
dot receive 100 okay so now if we've
made it this far then it means we've
connected to the port so what we'll do
is win a screen lock screen lock dot
choir choir choir and there's no
parameters going to that and then we're
going to print out to print and put a
little plus sign oops plus sign show
that port is open and then close quotes
plus turn the port into a string so STR
and I put target port close that and add
on to TCP open and close that off and
that's our connecting try our connect
done
so we'll do write our exact except now
so accept so if this fails we're going
to screen lock and we're going to
acquire again so choir and now we're
going to use the print function to print
open quote negative sign this time
because it didn't work and pretty much
the same as the line above so string
let's go
target port plus but this time in these
quotes we're going to do TCP closed
because it's it failed to connect and
then we're going to write a finally
statement so finally so this will always
run no matter what and we're going to go
with the screen lock screen lock dot
release so this will let go of the
screen lock so other threads can use
they do they need it and now we're going
to close out socket so con socket dot
close and that's our con scan function
written so that'll deal with all the
connecting to the hosts and see if the
ports open or closed now let's write our
port scan function so def port scan and
we're going to take a target first and
we're going to take a target ports so
you can notice that this is more than
one ports and we're going to write
another try try and we are trying to get
the target IP so target IP equals get
host by name and then we're going to
pass in the target host if that doesn't
work going to accept and we're going to
print out print negative sign
cannot resolve and then we'll add in the
host so it is to your target host and
then we'll do unknown hosts so it can't
find the host that we're trying to
connect to unknown Hurst okay and then
we're going to return because we can't
find it so we don't want to continue now
we're going to write another try and
this time we're going to try and get the
target name so the target name equals
get Hurst by address to addr and then
we're going to put the target IP in
their target IP and we're going to print
go to the backslash n make this look
nice Open bracket plus scan results for
and then we're going to add the target
name so target the name and we grab the
first that will prime it will try and
return a list okay and now if that
doesn't work so except then we're going
to print a similar to a previous line
but instead of target name we're going
to do the target IP so scan results for
and this time we're whoops we're adding
the target IP I forgot a plus on the
previous line instead that in quick plus
okay now because we don't want this to
try and connect for ages we'll set a
default timeout so set default it's
about right D fold D yep default time
out and we'll put one and then for
target port in target ports create a
thread so T equals thread and our target
function is con scan and our args
arguments is the target host and an
integer of the target port and I'm all
that we are and then we want to start
thread so T dot start and that's our
pots again function written now it's all
the pledge to do is our main so def main
and this is where we add all our parser
options so that the user can customize
what computer they want to scan so we
create our parser parser equals
opt Pass dot option passer and put out
usage in here usage usage is sent Prague
and then we're going to do dash H and
that will be a target host first and
what else we're gonna do well put a
backslash here so plus backslash go down
to the next line and open up codes again
and we'll do a dash p for the ports and
we'll do target for and then we'll fish
that up so that's our usage now let's
add our options
so parser dot add let's go option and
we're going to have the capital H so the
dash H and that is also going to go to
the dest destination of target host and
it's also going to be type of string and
separate the line and the help is going
to be a specify target host
and then we'll close that up and its
head out another option I pass ad let's
go up chin and we're going to take Dutch
P this time and the desk for that will
be target port and it's going to be type
string as well I string and separate the
line
help-help is equal to specify target
port I'll open up some square brackets
so ports separated by a comma and close
that off
okay now let's check to make sure that
the user has actually imported some
stuff so options hogs and equal the
parser dot pass let's go args and then
if options dot target host is equal to
none or options dot target port is equal
to none then what we want to do is print
this usage so print parser dot usage
and exit else we're going to set target
host to equal options
target host and target ports equals T
string options
target port and we're going to split
that up so split and we're going to
split on the comma so that way if they
enter in more than one port we split it
into a list and then after that we run
our port scan so what skin and we pass
in our target host and our target ports
and that's our main done so we write out
if if underscore underscore name
underscore underscore is equal to and
it's going to score main underscore
underscore then we run main okay so
let's give us a whirl hopefully I'm so
many typos okay now I've got a server
running on my network but you could
possibly try connecting to your router
it may possibly be open or if you've got
any servers running on your network you
can try connecting to one of the ports
that you know it know are open okay so
I'm going to run my port scan so - port
scan dot py and - capital H and my
server is on 192.168 10.72 and the port
that I have open up so - P is
6t 4738 and hopefully this works so we
run that birds up tries to find the host
once he founds the host okay found the
host and the TCP port is open on that
server if I try connecting to that
server again but this time on port 80 so
if there's a web server on that on my
server it would say that the port is
open but I don't have a web server
running so it should be closed so finds
the host and then on the scan and port
80 is closed so that's good because I
don't want that to be open cool so that
that'll worked smoothly okay so this
concludes our basic pod scanner there's
an annotation on screening that will
take you to an additional video in which
we modify this program to add a feature
to scan ranges of ports if you don't
remember all this you can easily come
back and rewatch this video to
consolidate all the information if you
have any questions you can leave them in
the comments and I'll do my best to
answer them in the next video we'll be
implementing a port scanner using n map
and the N map module for Python so
thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>