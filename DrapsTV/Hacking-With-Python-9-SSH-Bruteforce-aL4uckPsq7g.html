<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hacking With Python #9 - SSH Bruteforce | Coder Coacher - Coaching Coders</title><meta content="Hacking With Python #9 - SSH Bruteforce - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/DrapsTV/">DrapsTV</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hacking With Python #9 - SSH Bruteforce</b></h2><h5 class="post__date">2014-07-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/aL4uckPsq7g" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to hacking with Python 9 ssh
brute-force every video have all
slideshows and card available in the
description i'll be assuming you already
have an ssh server installed to test on
if you don't have a server to test on
and don't know how to set up a local one
on ubuntu follow the instructions in the
hacking with python ssh botnet video so
quickly
what is SSH SSH stands for secure shell
this is because it allows for remote
shell or command line operation it is
secure because it is encrypted unlike
its predecessor telnet SSH is an
interesting topic to read about and if
you get some time to read about it it
may interest you so how will it work
just like the botnet we are going to use
the P expect library with the px SSH
module to connect to the SSH server we
will iterate through the lines in our
dictionary and test them by attempting
to connect to the server timeouts or
sync errors will try and when we find
the correct password the connection will
be accepted and will print out the
password and then give a prompt to the
user the current version of px SSH is
still has an annoying bug in it it works
on some machines and doesn't on others
so I've uploaded a fixed version of the
module for us to use in the slides
folder you can find it in the
description download the PX SSH by file
and make sure to put it in the same
folder as your code file ok let's jump
straight into it let's call our program
SSH brute PI remember to make sure the
PS px SSH file is in the same directory
as our code file ok so let's jump over
to Ubuntu and we'll start writing our
code so we want to them and we're going
to call it SSH brute dot pi okay now
once we're in we're going to import our
px SSH so import px SSH and we're going
to import
argh pass so ugh pass is just like ah
pass except it's it's made a lot more
friendly and easier to use import time
okay
now let's write our connect function a
connect function is going to take a host
a user and a password so def Connect and
we're gonna have a host user and a
password okay now we're going to create
a variable called fails so we'll call it
fails and this is set to zero and this
is going to be for how many fails just
in case the ssh server is blocking our
connection so we'll set that to zero so
we're going to try and we're going to
create a PX ssh session so we'll call
that s so s equals p x
ssh dot p x ssh and that doesn't take
any arguments now we want to lock try
login so s login and we're going to pass
in the host user and the password now if
it succeeds it's going to go on to the
next line so we're going to print out
password found and then we'll output the
password that we tried password and then
we're going to return the connection so
s now we're going to write our accept
and in our accept we're going to catch
exceptions so exception and we're going
to call e
okay so if our sales is greater than
five we're going to print out put some
exclamation marks show that something's
something's gone wrong
too many socket timeouts okay and if
that happens we're going to exit because
we're never going to get through look I
haven't closed my screen correctly we're
going to exit out of the program
okay so L if so else if we get read
underscore non-blocking in string of e
the exception then we're going to
increment fails so fails
plus equals one and then we're going to
sleep sleep for a set for a few seconds
so time dot sleep five and then we're
going to return another try
so connect host user password and
that'll recursively keep trying to
connect until the fails reaches okay so
we're going to make another else--if so
L if and this is a synchronized error
which SSH will return with so if sync
run is synchronize with rid channel
yeah prompt in string of e then move on
to time dot sleep and will only sleep
for one and then we're going to try
again to return connect host use a
password then if none of this works
then what we're going to do is we're
going to return none so if it's another
exceptions or in other words we're just
going to connect except timed out then
we're just going to return none okay def
main so our main function and we're
going to create our hog pass passer so
pass up equals AG pass dot hog youment
passer and we're going to make out
Parsa don't add underscore argument and
the argument we're going to take first
is host and the help for that is going
to be specify target host and we'll add
pasa dot add argument and we're going to
take the user help specify target
user and one more and this one is going
to be the dictionary file we'll call it
file help equals specify password look
password file okay now we can get our
augs so create a variable called args
and make the equal to parcel dot pass
underscore args
okay now that oh that will create our
parser which will take everything that
needs so now we'll do an if check to
make sure that we've got got all of the
information that we need from the
command line so if args host and Oggs
dot user and args dot file then we're
going to continue with that program so
with open arms file so the dictionary is
the file you are the user enters in
read-only as in file we're going to go
through a for loop so for line in in
file and in our for loop we're going to
get our password so our password equal
to line dot strip am I going to strip
back slice our backslash n okay now we
want to print out they were testing a
new password so type out tests testing
and we'll add the book add the string of
password
just in case it's numbers okay now we
want to try it and get our connection so
we'll call it con for the connection is
equal to connect and we're going to try
and connect to our hosts eggs dot user
and we're going to use password okay now
if con so if we do get a connection
we're going to print it out
let's Sh
connected issue commands Q or you to
quit so that way the user knows that
they've made a connection and they know
how to quit so now we'll grab a command
from the user so the command equals raw
underscore input and we're just going to
give them an arrow prompt now while
command does not equal lower case Q and
command does not equal up case Q we're
going to send the command so con dot
send line and then the command we want
to send and then Con dot prompt so it's
going to wait for the prompt back and
then we want to print out con dot d for
so everything before the prompt okay now
we want to get a new command so command
equals raw underscore input and we'll
give them an arrow prompt again
cool now we'll go back to our first if
so if the arguments host user and file
aren't included else we're going to
print the parser dot usage and then we
can exit okay and that's our main
written so let's write our episode
underscored name and it's gotten score
is equal to underscore underscore main
then we're going to run main okay now
hopefully if I haven't made any mistakes
this should work so I'll save this now
if we have a look at the current
directory so LS la we've got my
dictionary file so I call it did text
and I've got my PX SSH hi
and we've got our SSH brute PI so if I
just quickly open up my deck so dict txt
I've got one two three four five
password
welcome admin login Pokemon and Ubuntu
and Ubuntu is the actual password for
the SSH user okay so I'll exit out of
this and we'll give our program a shot
so I've Python and our SSH root dot pi
and it's going to take a user so well
it's going to take a host first sorry so
127.0.0.1 because I want to connect to
the SSH server but on this machine the
user is Ubuntu as you can see over on
the left my user is Ubuntu and we also
needed a passwords file server Dix txt
however run this little seed starts
testing the first password and you'll
notice that it pops up here asking that
it want to connect but that's just
Ubuntu doing what it does and we'll see
in a second that my
SSH server is realized that somebody's
trying to brute-force fit in the default
configuration so you could not grab
keyboard a malicious client may be
eavesdropping on your session so you can
see also see here that it's found the
password which was Ubuntu after testing
it and it's returned to stop a prompt so
I could type LS here and it will give
back a list of directories in my home
directory and if we want to quit we can
just type lowercase Q or uppercase Q and
we'll quit back out of the program cool
so that all worked we'll come back to
the slides this concludes our SSH
brute-force program try adding threads
or merging it with the botnet if you
have any questions leave it in the
comments and I'll try my best to answer
it the next topic will be looking at
what the next topics I should say are
mechanical soup and scrappy thanks for
watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>