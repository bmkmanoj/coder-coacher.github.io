<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>XSS Tutorial #4 - Malicious Attacks | Coder Coacher - Coaching Coders</title><meta content="XSS Tutorial #4 - Malicious Attacks - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/DrapsTV/">DrapsTV</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>XSS Tutorial #4 - Malicious Attacks</b></h2><h5 class="post__date">2015-01-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Iu3QtMy9cpg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to XSS tutorial number four
malicious attacks in this video we will
be looking at a couple of attacks that
we can practice on our test site every
video have all slideshows and code
available in the description the focus
for this video is undoing so we're going
to look at two common malicious attacks
with cross-site scripting first we'll
look at stealing cookies then we'll move
on to making a forced action on a target
page with a reflected attack with the
skills we learn here you can craft many
different kinds of cross-site scripting
attacks it's important to remember how
abundant cookies are on the web these
days most if not all websites you log in
to have a remember me functionality
meaning they give you a cookie with a
session slash auth code if we were to
steal that or code with a cookie attack
on a website where the user needs to be
logged in to see the page we can steal
that cookie and use their auth code to
pretend to be them if we visit the
website and all of a sudden we have
their auth code the website will believe
that we are that user alright let's try
out stealing some cookies using the code
we learned in the previous two tutorials
we can slightly modify it and easily set
up a cookie stealing system you can
download the new index.php and new
Cookie Monster dot PHP files in the
slides and files folder in the
description alright let's get right onto
it so if I come over to the new web page
that I've got set up so we've got a
couple of new buttons we've got the new
cookie the output the output cookie and
we've got a little name field here which
we'll use later so as as before we can
create comments and we need to generate
a cookie so to actually be able to steal
one we need to have one first so if we
click new cookie we'll get the auth Toki
is a cookie is set and we can click the
output cookie and we can see what it
looks like so this is currently stored
in our session so you know web browser
alright so if we wanted to steal it we
need somewhere to send it to
so we're forcibly going to send their
cookie to us so it's worth having a look
at the Cookie Monster dot PHP that we
download as this is going to be the page
that we send it to so this could be
allocate
anywhere on the web and we can link to
it so if we open that up in notepad plus
plus you can see it's only got 17s lines
and a few whitespace in there so it
could definitely be a lot smaller and
we've just got in between the PHP tags
we've got if there is a cookie then the
files stolen cookies txt we're going to
put into that file the cookie and add
new line onto the end and append to the
file so any new cookie requests that we
get given we're just going to save the
cookie into a file and then for the
actual HTML that the user sees they just
get a title saying that there's a
problem and a big heading in the middle
saying oh no something went wrong all
right so it's not super super difficult
there are just some basic PHP code and
what we need to do is steal it so what
we can do is our full redirect that we
did in the last tool we can use a
similar thing except we pass the cookie
over at the same time so let's create a
comment and we'll do something like cool
s kamesh mark and then we'll open up our
script tags so script and then inside
here we'll do our window location equals
in quotes HTTP colon forward slash
forward slash and we'll do localhost so
this computer and we're going to do the
XSS /for and instead of giving it a
different website we're going to be
giving it the Cookie Monster dot PHP so
cookie monster dot PHP and we're going
to pass through a get variable so we're
going to use question mark and the get
variable is cookie so that cookie
variable equals and now we're going to
close up our link here now we're going
to use the plus and we're going to plus
on these is cookie so we're going to
plus and then we're going to escape so
you want to escape the any characters
that might be in the cookie that might
cause the problems and we're going to
grab the d cookie so
humint dot cookie and then we can close
off our script so we're going to send
the cookie through as a get variable on
the end of our link now we can comment
this and will redirect us and then you
go oh no something went wrong and you
can see up into in the the URL here that
we have the Alt key and the cookie so if
someone was observant they'd see that
and then be like oh no I think my
cookies just been stolen but most people
wouldn't actually know what that means
all right so we'll go back and we'll
actually clear the table because we
don't want this is redirect to get us
every time so we'll just clear the table
for now how much add a basic comment in
there saying hi all right now what will
happen is inside this folder here I've
got the stolen cookies txt which is the
file that dumps the cookie earth keys
into so we open this up I actually open
it up in notepad plus plus so I can zoom
on it and you can see that it's pasted
in the auth key so the auth key is 2 8 9
F 3 6 2 C 3 B blah blah blah cool so
let's see if that's actually what it is
so we go Apple cookie we can see that
it's 2 8 9 F 3 6 so is that correct
that was so they successfully stole the
cookie cool now a full the redirect
might not be the kind of strategy you
want to go for because a full redirect
is going to make obviously the person
that owns the website or people who are
admins at the website quite aware of
what's going on as they're currently
being redirected to another website so
we might want to do something like a
hover attack so we might not we won't
use the script tag this time and we'll
just create a link so we'll be like hey
check out this YouTube video
and then we'll do an a tag so we're
going to create a link href and inside
here we're going to do the HTTP I'll do
ya HTTP colon forward slash forward
slash www.youtube.com/watch and then
we'll close off our quotes for the href
and now we're going to use a special
attribute called onmouseover so on
mouse-over equals and now we're going to
enter in our JavaScript here so inside
here we're going to do the window drop
location and pretty much the same thing
that we just wrote so window location
equals and then we're going to do in
single quotes HTTP colon forward slash
forward slash localhost /x SS forward
slash for forward slash key monster dot
PHP and then as our cookie get variable
with after the question mark it's going
to equal close quotes adding on the
escaped escaped document dot cookie all
right now we'll close off the courts
there and close off the a tag and then
we'll put it in the youtube link so HTTP
colon forward slash forward slash
www.youtube.com/watch and we could have
our watch link in here but we won't
bother with that it takes too long to
type out and then we ndele a tag so
forward slash a cool so we've added a
link in so if we now comment on this
we'll see that we get this comment added
in here so check out this YouTube video
and it has a link to YouTube now over to
generate a new cookie this time
we've got this off-key can you cookie
set so in output and we can see it's a
bit different this time it's 8 6 Fe and
if we mouse over this linked as if we're
going to click on it get all of a sudden
redirects us to that page I don't know
if something went wrong and you can see
that it passed through our cookie again
now we can go back and generate a new
cookie and we want to click on this link
again and or no redirect this again so
that's a good way to trick people into
doing because they might even just be
scrolling down and all of a sudden
they're the mouse goes over the top of
the link alright so let's have a look at
that file again so we're going to open
up the stolen cookies and we can see
we've got now starting to get this
collection of auth keys it is pretty
useful so we have a link set on our site
you may be able to capture quite a few
earth keys cool close that off and we'll
clear the table okay let's move on to a
reflected attack no doubt you've heard a
story of someone clicking a link or
having something scammed from their
online account chances are that that was
done with some sort of reflected attack
it may surprise you how much we can
force someone's hand on a website with
JavaScript ok
let's construct an attack that when the
person clicks on a link to our to test
out there ok let's construct an attack
that when a person clicks on a link to
our test website it forces them to make
a comment like XSS is great before they
can even have a chance to say no it's
going to be a rather long link but
nothing it nothing a link it it's going
to be a rather long link but nothing a
link shortening service couldn't fix all
right so we'll come over to our web page
here and what we want to do is we want a
user to write a comment out here like
XSS is great and then we want them to
click on the comment button
okay so to do this we need to know what
this box is called and the form to
submit so if we open up an inspect
element we can see that this whole form
here if we mouse over is called ID is
post and this text area that we want
them to write in is a name called
comment so it doesn't have an ID so we
have to do a little bit a little bit
different to fill it out that'll still
work the same all right so we needed to
get the comment write it in and then we
need to submit the form by clicking the
submit or using the submit function all
right so we know that this is called
comment the name is comment and this is
going to be through the post form okay
so let's start constructing it we'll
just use this this area here to start
typing it out so it's going to be a link
to this page and we're going to use this
input field skip input field as our
attack vector so just like in our how
tutorial two we're going to do some
non-persistent attacks so it's going to
be through this name thing so let's do
Fred and if we hit submit on this we get
at the top we get it comes through and a
name equals Fred okay so we're going to
use this link and we're going to
construct it with it come up here and
I'm going to copy this link come down
here and we're going to paste it in and
instead of well we could leave Fred
there and as you can see it says pops up
up here saying hey there Fred welcome
okay because this appears before our our
window that we want them to talk into we
need to add a little bit of extra code
into our function so we're going to add
our script tags in as always script and
we're going to use window dot onload and
what this is going to do is it's going
to wait until the whole page
just finished loading so that way we can
manipulate anything on the page and
that's going to equal a function so we
need to create a function for like later
use so it's going to be a function and
then we open up our curly braces and
we're going to use the Dom documents and
we're going to get elements so document
dot get element elements so we're going
to get elements by name so we're going
to get the elements that use the name
attribute as we need to get that comment
field so inside there we're going to get
the comment name so anything that has
comment and I know that that's the only
one on the page so it's the zero with
comment section and inside that we're
going to do the inner HTML so we're
going to modify what's inside it and
that's going to equal our string of XSS
is we'll do XSS is fun exclamation I
will close that off now we're going to
do the semicolon because this is our and
we're going to end that line of code now
we're going to write our second line of
code which is going to submit the form
so we are going to use the document
again dot get element this time so we'll
just get get element by ID and we're
going to get it by the ID of post okay
and now from that post we're going to
dot submit so we're going to submit the
form and we'll put a semicolon on the
end and close up our curly brace and now
we've closed up our function so we can
close off our script tag so /script
close all right so that's our link done
so we can now copy and paste this into
say an instant chat or a email or
something and have somebody click it so
if I remove this from here so we can
come up to the top here and paste in our
new link
and as you can see it's quite a long
link and if we hit go we'll notice that
it comes here and it says new record
created successfully and we've made a
comment so that went so quickly I didn't
even get to see it and you know we could
know if another person comes and visits
you know we'll get a second comment
going access is fun and it happens so
quickly that you don't even get to see
it happen
cool so that's a reflected XSS forced
comment cool we just use a Dom object to
modify the contents of a loaded web page
using this technique you could change
the payment section of a site and change
where the forum sends the credit card
information to something along the lines
of document get element by ID the forum
action and then do a new link to where
you want to process all that information
so that might be something like my evil
site comm forward slash process dot PHP
alright that's it for this video
unfortunately getting XSS to work isn't
always this easy the next thing we'll be
looking at is bypassing basic filters if
you have any questions leave it in the
comments and I'll try to answer it as
best as possible don't forget to
subscribe thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>