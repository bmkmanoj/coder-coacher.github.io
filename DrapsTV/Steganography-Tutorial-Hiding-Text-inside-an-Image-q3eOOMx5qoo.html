<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Steganography Tutorial - Hiding Text inside an Image | Coder Coacher - Coaching Coders</title><meta content="Steganography Tutorial - Hiding Text inside an Image - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/DrapsTV/">DrapsTV</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Steganography Tutorial - Hiding Text inside an Image</b></h2><h5 class="post__date">2014-03-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/q3eOOMx5qoo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to an odds and ends video on
hiding text and images the slideshow and
code are available in the description
this video is an example of some
steganography and images that we talked
about in the discussion video on the
same topic if you get to what to watch
the discussion video on steganography
then I highly recommend it if you're
interested in hiding things in plain
sight the annotation on screen will take
you there if you haven't worked with
Python code before this may be a little
hard to follow along however only a
basic understanding is really required
to follow along so what is this program
well it's a Python program that hides
information in pictures specifically
this one is set up to deal with dot PNG
files and the program allows for hiding
and retrieving of text inside a picture
and quickly how does it work so the
short description of how that how it
works is that it loads an image and then
looks at each pixels hexadecimal value
our program then turns text into bits
and stores the information as the blue
color channel where the hex is lowest
value is between 0 and 5 the information
is then stored in binary in each
available pixel after the message is
stored a delimiter is added to the end
to determine where the text ends when
retrieving we pull all the 0 and 1 hex
values from the image until the
delimiter is found then turn the binary
into a string
ok so let's create our program called
hide py will use several functions for
manipulating our data so IGBT x hex to
RGB string to pin and bend a string and
we'll have for operation functions the
encourage decode hide and retrieve ok so
I'll come over to you Bunty and you see
I've got a picture here to use which is
just picture dot PNG and there's nothing
exciting it's just a picture saying
congrats you track them as if this from
one of the hacking and passing videos
okay so let's start coding we're going
to create our file so dim hide dot P Y
okay
now we're going to need a few things a
few libraries so we're going to need to
be able to use images so we're going to
use the Python image library so from PIL
set Python image library import image if
you're running this on Windows then you
may have to download the library's full
python image library but I believe it
comes with Linux and Mac distributions
okay we're going to import bin ASCII to
the binary ASCII library and we're also
going to import off puss so opt pass
okay so let's start creating our utility
functions so def hex - oh sorry
RGB text we're going to do first RGB -
hex so we're going to turn our gb color
values into hex color values it's going
to take an R G and a B value okay now
we're going to return the hex value so
turn and add a hash on to the front and
we're going to turn to hex
so that's colon 0 to X and they're their
curly braces and we're going to do 3
times 4 e to the hello values through 2x
and colon 0 to X curly brace and then
we're going to format that with the RGB
values so format our G and B okay that's
our LGBTQ X function done now we're
going to define our hex to RGB so hex to
RGB and that's going to take a hex code
and we are going to return a tuple and
map the odd and the hex code so the hex
code we passed in and we're going to
take away the hash at the front and then
we're going to decode that to hex from
hex okay so that's going to return our
RG and B in a purple okay now we're
going to create a string to binary
utility function so STR to pin to binary
and that's going to take a message to
turn into binary okay
so we'll create a variable called binary
and that's going to equal bin so the bin
function is from our bin ASCII library
int bin ASCII dot hex Liffe i don't exa
Phi the message and that's in base 16
okay now we're going to return our
binary so turn binary but we're gonna
strip the first two characters from it
because it adds a 0b at the front which
we don't really want to be storing okay
so we'll add the zero B back in when we
go to turn it from binary real screen so
we'll create our utility function for
binary to string now so the binary
string and that will take a binary
parameter and we're going to construct
our message variable
it's going to equal bin ascii so we're
going from binary back to ask you this
time and then we're going to unhex the
fire and my unhex allah fiying the value
that we place into here so 2 % x so now
we're going to pass into the function
really the % x is int of 0b oops
Zerbe so adding that 0b n R is stripped
off earlier plus the binary that we
passed in that space too
okay so we run hexyl applied it back
into a string and now we're going to
return it so return message okay now now
that we've done our utility functions
let's start with out proper functions so
we'll do a depth in code so this is
going to turn our hex code of the color
of the pixel and we're going to place a
digit in it if we can so the digit value
is two digit two placing the whether it
be 0 or 1 okay so if the color pixel so
the hex code we have minus 1 so the very
last digit in the hex code is in the
list
0 1
two three four or five then we're going
to save some data in there so we go to
set hex code to equal hex code minus one
so let's colon minus one because we want
to replace the very last digit so minus
one plus the digit that we're replacing
okay now we're going to return our hex
code to return hex code puts hex code
and if that fails so if we can't store
it in the side this pixel then we're
going to return none so return none okay
so that's how in code function done
let's write our decode function now so
decode and that's going to take a hex
code so we're going to decode a hex code
okay so if our hex code that we pass in
and the last digit in that hex code is
either
so if hex code one in the list zero or
one then we're going to pull the data
out so return
the hex code - one to the digit that's
inside the hex code else we're going to
return none total turn none okay so
that's our decode function done so now
that we've done all of our main
functions that we need to use we're
going to write our hide and retrieve
functions okay
so let's define our hide function first
because we need to be out of high before
we can retrieve so it's a hide function
and that's going to take a file name so
the file name of the image and the
message to store inside the image now
we're going to create an object of open
image so call that image IMG image
equals image dot open so using the image
library now so image dot open file name
so the file name of the image and then
we're going to need to get some binary
to store inside it so binary equals
string str2 bin and that's the message
that we passed in and we're going to
plus on the delimiter so that we know
where the message ends so that's going
to be 15 ones and a 0 so 1 2 3 4 5 6 7 8
9 10 11 12 13 14 15 0 okay so now that
we've added our dilemma onto the binary
we can check to make sure that our image
is actually editable so image if image
sorry top mode in RGB a
then we're going to say that we can edit
it and we'll just make sure we convert
the image just to make sure that it's in
correct format image convert to RGB a
and we're going to grab data data s so
data's is going to be the image data so
image dot get data so that's going to
return all of the pixels inside the
image now let's create a list called new
data and that's going to be all of our
new pixel all of our new pixel data and
we'll create a digit variable which will
be the current digit that we're up to in
our binary and we'll set that to 0 to
start with so that's the digital world
cup tip and we'll create a variable
called temp make that equal to nothing
okay so for item so an item is going to
be each pixel of our image so it's for
item in data's so for each pixel in the
image
if digit is less than the length of the
binary then we're going to store try and
store data so new pics equals in code so
we're going to incurred our new pixel
data and that'll be RGB two hex so we're
going to turn the RGB value of the
deterrent pixel into a hex value to
encode and we're going to pass in the
item 0 for the R value item 1 for the
green value item 2 for the blue value
and that's our LGBT text and then we're
going to give it the binary that we want
to store so binary and then the current
digit they were up to story okay so that
turn you pics a new pixel down so if our
new pics
so if our new pics is equal to none so
it failed then the new data we want to
store inside our new in our new image
that we're creating append so that we
just want to store the current pixel we
don't want to change it at all else if
we do successfully in code then we want
to create our new pixel and save it into
the new pixel data so now our G and B
values is equal to hex to RGB so that
function we made earlier and that's the
new pics that we just created and now
we're going to set our new data oops our
new data so append our RGB values that
we just created to our G B and we'll
give it the Alpha to power five and then
we'll increase the digits that we're up
to so digit plus equals one okay now
we'll do a else for that if so else if
we're if we're currently on a digit past
the length of the binary we're trying to
store then we're just going to append to
the new image so new data dot append
we're just going to append at the
current pixel that we're up to because
we don't need to change it okay so once
we've once we've created a new image
gonna set our image dot put data
and our new data we've created so we're
going to create our new image and then
we're going to image dot Save so we're
going to save our new image over the
file name that we had before so file
name and it's in format PNG and then
we're going to return that we've
successfully completed completed blue if
for some reason we fail though so if the
image mode isn't correct then we're
going to return that the incorrect image
mode was detected so in correct image
mode couldn't hide okay so that's how
hide function done now we'll create our
retrieve function which will look very
similar because we've got to open up our
image file and grab a little pixel data
so our tree function so Rhett are sub
tree and a file name to retrieve from
it's a file name and we'll create our
image objects so mg equals image dot
open and the file name and we'll create
our variable for the binary that we want
to store so binary equals nothing in the
moment because you haven't retrieved any
if how image mode in high GBA so red
green blue alpha then we want to set our
image to equal image dot convert to RGB
a just to make sure
our data is so again we're going to grab
all of the pixel data so data is equals
image dot get data okay so now we're
gonna iterate through all of our pixels
so for item again in data's we're going
to grab eight digit from the current
pixel so digit equals decode
so our decode function that we wrote
earlier and we're going to pass in the
RGB to hex of item 0 for the red item 1
for the green and item 2 for the blue
and we're going to decode that and
return back a digit so if digit is equal
to none so we didn't find any of our
data inside that pixel we're going to
pass the current current loop and go on
to the next pixel else if we did find
pixel data then we're going to add it to
our binary so binary equals binary plus
digit we found ok now we're going to
write a check to see if we found our
delimiter so if our binary and minus 16
to the end of our binary so if the last
16 characters of our binary is equal to
at delimiter so 1 2 3 4 5 6 7 8 9 10 11
12 13 14 15 0 is is found at the end of
our current binary that means we've hit
our delimiter and we've finished our
message so we can print out success
so we've found our message and then
we're going to return the binary to
string to a binary string method and
we're going to pass back the binary so
the binary and we want to give them we
want to return everything but the
delimiter so minus 16 so call it minus
16 so that'll turn our binary into a
string and pass it back so as a message
okay so now that we've done that we'll
we'll make our edge cases so if we reach
the end of the for loop and we haven't
hit the delimiter then what we're going
to do is we're just going to return the
binary to string of the binary so that's
that's if say the message goes much
longer than the image size then that way
we just return all of what was still
inside the image that we found but if we
don't have the correct image mode then
we're going to return the does the
incorrect
image mode so return incorrect image
mode couldn't retrieve okay so that's
our retrieve function done now what we
need to do is our main function and
we're done
so def main and we'll create our passer
so our opt bus so passer equals up oops
oops pass spacer I'll pass dot option
passer and our option pass our usage is
going to be usage % Krug
we'll break up and do a new line plus
rate alright and it's going to be -
efore in code or / - d and the target
file target file we want to store in
okay now we'll add our options
so our parser dot ad underscore option
and we're going to give it - e as our
first option which would be to hide so
deaths equals hide and that's going to
be type string so it's going to be the
file name so type string
backslash down the next line and the
help for out the out encoding option so
our help is equal to target picture
target picture path to hide text okay
set out first option done will write out
another one clip parser dot ad
underscore option D - D sorry - D and
the test is retrieve so re the ret are
and the type is also a string string and
XS down the next line I'll help you can
be very similar target picture path oops
forgot a quote target picture path to
hide text
okay to retrieve text so this one's tree
v' retrieve text okay
let's our pass it on
will do options eggs equals parser dot
pass underscore eggs and now we'll do
our checks so if they want to they want
to hide so if options hide does not
equal none then we're going to let them
hide so we'll set a variable called text
to equal raw underscore input input so
this will get a message from the user so
enter a message to hide so that will get
a message from the user to hide in the
in the image and then we're going to
print the result of the hide function
and we're going to pass in options hide
so the file name and the text to hide
that we just got the user and they'll
print out whatever hide returns so
whether it was a completed or incorrect
image mode couldn't hide okay so we're
going to have an else--if now so L if
the options dot retrieve does not equal
null none does not equal none then we're
going to print the result of retrieve
and the options dot retrieve so that's
the file name for the way I want to
retrieve from else if they get that
wrong and they can't they enter in a
file name or they forget to add an
option then we're going to print the
usage so print pasa
oops five my friend print parser dot
usage and then we exit if they get it
wrong so we don't want to go you don't
want to keep a program running okay now
will write out if I'm just going to
score name underscore score is equal to
underscore the underscore understood God
I'm just going to scope main underscore
nesco then we're going to run main ok so
that should be our program finished I'm
going to write quit this hopefully I
didn't get any errors I probably did it
just tend to happen okay so let's try
running it so python hi dot py and we
want to encode into that picture file
that I had earlier so it was called
picture dot PNG so let's try this enter
a message to hide hello my name is traps
exclamation mark and completed cool so
we didn't get any errors in our hide
function let's try receiving well
quickly we'll have a look at the image
see if we can see anything that looks
suspicious
but I definitely can't see anything
can you I think I can and we'll try
retrieving from it now so instead of hi
in encode we're going to D so decode
from our image and we get back success
hello my name is drops cool so it all
work properly that's that's good I
thought I was going to get an error okay
I'm back to a slideshow okay um so this
concludes our hide program I hope you
learned something interesting that you
could now muck around with yourself yeah
the Kurds code will be in the
description inside the slides folder if
you have any questions leave it in the
comments and I'll try and answer it as
best as possible and thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>