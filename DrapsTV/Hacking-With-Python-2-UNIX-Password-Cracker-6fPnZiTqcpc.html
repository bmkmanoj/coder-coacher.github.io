<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Hacking With Python #2 - UNIX Password Cracker | Coder Coacher - Coaching Coders</title><meta content="Hacking With Python #2 - UNIX Password Cracker - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/DrapsTV/">DrapsTV</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Hacking With Python #2 - UNIX Password Cracker</b></h2><h5 class="post__date">2013-11-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6fPnZiTqcpc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to hacking with Python to UNIX
password cracker every video will have
all slideshows files and code available
in the description first of all some
preamble you must have a basic
understanding of Python otherwise this
will probably be pretty confusing my
Python beginner series should be enough
to get you up and running this program
requires a UNIX platform like Linux as
will be using the UNIX script library if
you are adamant on using Windows you'll
have to find a part of the crypt library
to follow along so how does the unit
tracker work well UNIX systems used to
store all the users information in a
password file in a directory which was
accessible by all users the file
contained the usernames passwords the
user ID on the system and the home
directory the passwords in the file were
encrypted using the UNIX crypt function
so they couldn't be read by human eyes
there are two key parts to the crypt
function being the key and the salt the
salt is the most important part the UNIX
increased air encryption system stores
the salt used atom in the hash algorithm
as the first two characters of the
hashed key meaning it was possible to
know what algorithm was used this means
we can take the salt from the hashed
password and encrypt our words from our
dictionary and see the results match if
it does we found the correct password so
let's start creating our program be sure
to grab the password text file and the
dictionary text file from the link in
the description as our program will use
these words in the dictionary to try and
match it with the hash passwords so
let's set up our program we're going to
need a main function and a test pass
function so if we have a look in my
directory here I have a ditch the
dictionary text file and I have the
passwords text file okay so if we open
up the password such hex file password
texts we are see that there's two users
on the system victim which has an
encrypted password with the salt KB and
it also has their home directory and
such and we have the route which has the
salt of FG in it scripted password
okay so I'll exit out of this and now
let's start creating our program so then
I'm gonna call at program crack dot py
and we're going to need the Crypt module
so I'll import that so I be encrypted
imported the encrypt file module and now
define our test pass function
so our test pass function is going to
test the current password that we have
from the passwords file against all the
dictionary words so the dictionary file
has a bunch of words in it and it'll go
through every one of them and see if it
matches the current password so test
pass function and we're going to need
two parameters so crypt pass which is
the current encrypted part I hash
password that needs to be found and the
dictionary the dictionary name okay so
we need the salt from the encrypted
password which is the first two
characters so create a variable called
salt and we get the two first two
characters from the crypt passed
variable crypt pass zero to two and
we'll open up our dictionary files dick
file open and open D name
in read-only mode and for each word in
ticked file read lines we're going to
strip any new lines so word equals word
dot strip backslash n so there's any new
lines at the end of our word will strip
it because we don't need it you just
need the word itself and then we're
going to create an encrypted word from
the dictionary so crypt word so we're
going to encrypt the current word that
we're looking at so we use the crypt
module so crypt dot crypt and in that in
crypt function it takes two parameters
which is the word and the salt so salt
determines the algorithm to encrypt it
with and now that we've encrypted our
word let's check if it equals the user's
password
so if crypt word oops
if crypt word is equal to other crypt
pass then then we want to print out that
we found the password so do a little
icon here do a little plus icon that
some people want found password and then
we'll print out the word because we want
to know what it is though word and do a
backslash n at the end it'd look nice
and be returned because we don't need to
keep checking for passwords cuz they've
already found it
turn and now
back after our for loop if it goes
through the hole for loop and doesn't
find a password then we want to print
out that it fail so negative icon quotes
so password not fam will do backs
actually on that as well and move
overturn and now let's define our main
function
so just main and you need to open up our
pacifier our passwords files call it
variable pass file and we'll open the
passwords dot txt in read-only mode and
then for each line in that in pass file
read lines we're going to check if
there's any columns in the line so if is
a colon in line then then we want to
actually try and decrypt a password so
grab the user so if you remember from
our passwords file the user is the first
thing in in on each line so user equals
line dot split so you split to split up
that one line and we're going to split
it by the colon character if you have a
look at the passwords dot txt file
you'll notice that each new item is
split by a colon and because it's the
first thing it's the 0 with item inside
the file
okay and now we're going to need to grab
the encrypted password so crypt pass is
equal to line splits splitting by the
colon and this time we're grabbing the
second thing so the first element you
know it's the second thing there is the
first one is the second and then we're
going to strip any spaces as we don't
want spaces in our enough string so
strip strip and stripping any spaces
okay so now we've got our crypt pass and
we've got a user will print out star in
this one cracking password for and then
we'll put our user on the end user so
cracking password for this user and then
we call our test pass functions test
pass and we pass through our crypt pass
and we also pass through our dictionary
file so the dictionary dot txt and then
we're done so that our main function
written so well if so if I'm school name
school equal to main then we run main
okay so there we go we've got our
program written so let's say this and
let's try running it so python
crack got py and oh we've got an error
okay so what was the error ah it up
yeah bad see that script supposed to be
strip they're here so word got word that
word equals word strip rather than
script screwed up there now take that
again and we'll try running it again and
there we go
so cracking passwords the victim found
password pokemon and cracking password
for brute found password admin ok so yeh
it works but to use this every time we
need to open up the code and change the
file locations every time that we can
fix this by allowing us to enter the
file names as arguments when we run the
program with applause so adding opt pass
our pass is a Python library that allows
us to pass in arguments from the command
line with ease it also provides a usage
if the users enter the wrong information
so let's add option passing to make our
program more dynamic we come back to our
program
we'll open it up again we're going to
start using another module so we're
using opt pass so import opt pass and
note the different spelling of passed
its PA our se ok now we don't need to
touch our test pass because that doesn't
have anything different in it it's
always going to be passed a dictionary
and the file however app started our
program we're going to need to
initialize our parser to make sure we
grab all the arguments from the command
line
so let's create our parser so PARC
equals opt pass dot option Parsa that's
all right thanks oh yeah
and then we need to write our usage so
usage usage and put our sent program so
we'll grab our program name and put plus
and we're going to have a dash F and
that's going to be our password file
password file and we're gonna have a
dash D this will be our dictionary by
Ofsted dictionary and then we'll close
that off so created a parser
so let's set up our options so parser
dot add in the score option option and
we want a dash F option to be for our
password file and destination variable
that we want to put it in so dest equals
P name and what type of diet and data
we're expecting so type is equal to
string and we also need the help
so if they mock up we can give them help
so help schools specify password file
that seems like it's decent enough and
add our dictionary option so parser add
option
and we're passing in with a - D this
time and the desk will make that equal
to well I'll make that D name so we
don't have to change anything else D
name and that's going to be also type
string and the help this time B specify
dictionary file okay now now that we've
got our options
we'll grab out our our our parameters
from the program so the options is args
and want to make that equal to the dot
pass
I'm just got args so we're passing the
arguments from our program into the
parser okay we'll do an if to make sure
the users actually input options so
options dot P name equal to none or if
options dot d name is equal to none then
we're going to print the usage print
print
Parsa dot usage so this will print out a
nice little usage to the command line
and we'll exit this we don't want the
program keep going up after there is no
password or dictionary file specified
but if they do and to stop in we have an
else clause which will set P name two
options dot B name and D name tools
options dot d name and this is created
up to variables so this will be our
passwords file which is P name and
dictionary file which is D name so we go
back down to the rest of our program and
we change our past file line so instead
of putting in passwords or text we just
put in P name and we scroll down to test
pass instead of passing in dictionary
text you pass in D name D name and there
we've created made our program a lot
more dynamic and we'll now to check that
out so right quit now if we try and run
our Python crack
it'll specify the usage for us so the
usage first program is - F then a
password file and then - D and the
dictionary file so let's try running it
again this time we'll pass in our
passwords files of passwords dot txt you
need to add the - F firstly - F and the
passwords text if we try to do that
it'll spit of how to spit out an error
again does it also need the dictionary
file if we do - D and then Dictionary
dot txt we get the program to run
so that means we can pass in any
passwords file and we can pass in any
dictionary and the program will run and
we don't have to change our program at
all okay this concludes our UNIX
password cracker
don't fear if you don't remember all of
this you can easily come back and
re-watch this video to consolidate all
of the information if you have any
questions and you can't find the answer
after a quick Google search feel free to
leave it in the comments next we'll be
writing a zip cracker using the same
style of brute-force attack thanks for
watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>