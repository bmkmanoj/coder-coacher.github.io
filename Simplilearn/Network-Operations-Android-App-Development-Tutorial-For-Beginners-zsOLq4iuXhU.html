<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Network Operations | Android App Development Tutorial For Beginners | Coder Coacher - Coaching Coders</title><meta content="Network Operations | Android App Development Tutorial For Beginners - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Simplilearn/">Simplilearn</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Network Operations | Android App Development Tutorial For Beginners</b></h2><h5 class="post__date">2016-05-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/zsOLq4iuXhU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome to lesson two in this
lesson we will discuss network
operations by the end of this lesson
you'll learn to explain connecting to
network demonstrate managing network
usage demonstrate parsing XML data we
will now see some important concepts of
how applications connect to the network
and send and receive information over
the Internet we use HTTP protocol to
illustrate how an application sends and
receives data via the network remember
that HTTP stands for hypertext Transfer
Protocol and it is the foundation for
exchanging data between computers
connected over a network HTTP uses a
client-server architecture in which a
client sends requests by sending an HTTP
packet and the server responds with
results HTTP uses a Uniform Resource
locator scheme commonly known as URL to
locate a resource on the Internet an
example of the URL is HTTP colon
backslash backslash WW simply learn comm
backslash as we have seen earlier the
first step in building an application is
to declare permissions to use the
network the application should check if
the network connection is available so
that the user can be told to enable
network connection via device settings
in the code you see here we are trying
to obtain an instance of the
connectivity manager by calling the get
system service we use the connectivity
manager instance so that various network
operations can be performed such as
checking if the device is connected to
the network
next we perform the network operations
on separate threads network operations
involve unpredictable delays hence it's
recommended that you always perform them
on separate threads other than the UI
thread which is the main thread there
are many ways to accomplish this a
simple method is to create separate
helper threads and perform all network
operations inside the helper threads
alternative method is to use a sync task
in this we create new threads to perform
network operations from the UI thread a
sync task class provides an easy way to
perform network operations on a
background thread and publish results on
the UI thread we should create a
subclass that extends a sync task and
then implement the following methods due
in background method is the one that our
class must implement here it takes
parameters to perform the operation
for example URL to connect to in this
method we have to add code to perform
specific information Android executes
this method on the background thread the
other important methods provided by a
sync task are on post execute in which
Android system is called from UI thread
any user interface updates based on
network operations can be prepared here
a sync task also provides on pre execute
and on progress update methods which are
executed on the main thread these
methods can be used to display a
progress bar and progress while the
background operation is executing we
will now see some important concepts of
how applications connect to the network
and send and receive information over
the Internet we use HTTP protocol to
illustrate how an application sends and
receives data via the network
remember that HTTP stands for hypertext
Transfer Protocol and it is the
foundation for exchanging data between
computers connected over a network
sending a request and receiving a
response we will now see how to send a
request to a remote server and receive a
response using HTTP URL connection class
here are the important steps the first
step is to create an object of HTTP URL
connection class using the URL then set
timeout parameters for connection and to
read timeouts here we specify how long
to wait before giving up the connection
if we know that the network is slow for
some reason we can increase the time the
next step is to set the HTTP request
method g-e-t
is the most popular HTTP
Qwest method there are other HTTP
request methods that can be used
depending on the requirement then call
the connect method connect is a blocking
call and returns after the response is
received or timeout happens before
receiving the response the next step is
to receive response input stream here an
application can consume the input stream
the next step is to convert the input
stream to a usable data type input
stream is a stream of bytes it could be
a stream of string or bitmap image the
application should convert the input
stream to the appropriate format for
consumption we will review a demo
application and understand how to find
out the network availability in an
android application there are two
scenarios scenario one we want to ensure
the network connection is available
before beginning a task if the
connection is available proceed with a
task but if the connection is not
available notify the user in this task
we provide a reference to connectivity
manager instance and check the network
status
scenario two we want to be notified of
the network connection or disconnection
events during runtime so that
appropriate actions can be taken for
example if a download is in progress and
the network connection is lost we have
to reset some states clean up partially
downloaded data and inform the user
about the download failure
Android system broadcast intents about
the network events we have to implement
a broadcast receiver and register it in
the activity to receive event
notifications demo introduction to
demonstrate how to detect network
availability before beginning a task we
will add a button to the activity to
check the network status and display a
network status message on a toast
to demonstrate how to receive Network
events at run time we will implement a
broadcast receiver and register it with
intent filter
connectivity manager connectivity
underscore action our broadcast receiver
receives intents about the network
events we check for the network status
and display the status on a toast
for a demo we control the network
connectivity of the Android emulator
using terminal commands we connect to
the Android emulator using telnet
application linking the local host and
emulator port usually the emulators port
number is displayed on the application
title bar the command gsm data off
disables gsm data connection and the
application shows network not available
the command gsm data on enables gsm data
connection and the application shows gsm
data available it cannot be demonstrated
on the emulator as Wi-Fi is not
available on it however the code to
check the Wi-Fi connection is
implemented let's look at the code
activity underscore main dot XML
provides the layout definition for the
main activity the activity uses a linear
layout container in vertical orientation
inside the linear layout we use two
different linear layouts first linear
layout whose layout weight is set to 8
occupies 80% of the parent height and
contains a textview that displays the
static message press network status
button to find the network connectivity
status next linear layout whose layout
weight is set to 2 occupies 20% of
parent height and contains the network
status button on show network status is
the callback handler that will be called
when the button is pressed we will go to
the mainactivity.java file in the
oncreate method we obtain a reference to
the connectivity manager by calling get
system service and passing context
connectivity underscore service this
connectivity manager reference is used
to check the network status in rest of
the application let's look at the
network status button event handler on
show network status implementation
connection managers get active network
info returns the network info object
which provides a status a network
interface is connected returns a boolean
indicating the connection status if the
network info object is non null and is
connected returns true we display
network available
else we Display Network not available
to receive Network events at runtime we
created a broadcast receiver the network
receiver class extends broadcast
receiver an instance of network receiver
is registered in the oncreate method
along with the intent filter
connectivity service dot connectivity
underscore action network receivers on
receive method is called when a network
related event occurs such as network
disconnected in the on receive method we
obtain the network info reference and
display the message on a toast we can
obtain the network info object for
specific network interface in the code
we pass connectivity manager type
underscore Wi-Fi to get network info
method is connected method on this
object returns a boolean indicating the
Wi-Fi interface status
similarly passing connectivity manager
dot type underscore mobile to the get
network info returns the network info
object for mobile network interface
based on the connectivity flags obtained
we display the status message on toast
let's execute the project and review the
results we can click on the network
status button to find the connectivity
status network available message is
shown on the toast emulator network
connection is altered using telnet
emulator commands GSM data off turns off
the network connectivity
now clicking the network status displays
network not available on the toast this
can be used to check the network status
before starting a task that depends on
the network availability also toggling
the network status on the terminal
causes the network status to be
displayed on the toast without any user
interaction on the handheld this can be
utilized to determine the network
connection events at runtime and take
appropriate actions that's about it
we just reviewed a demo application and
understood how to find out the network
availability in an android application
now we will understand how to use the
HTTP URL connection class to send
Network requests to a remote server and
also understand how to receive and
handle the network response as we
learned earlier network operations must
be performed on the background threads
as these operations involve
unpredictable delays performing these
tasks on the main thread may hamper the
user experience of the application in
this demo we will also learn about async
task class which provides a simple
interface to perform operations on
background threads async task
internally handles background thread
creation it provides interfaces to
execute methods on the main thread to
report progress and task completion for
this demo we will use the HTTP colon
backslash backslash lorem pixel comm
website after the website URL we can
specify the width and height in number
of pixels of the image and the website
responds with a random image of the
requested size for example the requested
HTTP colon backslash backslash lorem
pixel comm backslash 640 backslash 480
will return an image of width 640 pixels
and a height 480 pixels press refresh
image button on the browser and another
random picture of the requested size is
returned in this example the URL is the
network request and the response is the
image returned by the website we will
understand how to perform such requests
using HTTP URL connection and how to
process the response the demo
application contain
an imageview to display the downloaded
image and a refresh button to initiate a
network request clicking on the Refresh
image button causes the new image to be
downloaded and displayed on the screen
let's look at how to implement this
application let's look at the layout
elements of our activity we need a
button to begin the HTTP URL connection
request and an image view to display the
results received for our network request
activity underscore main dot XML
provides a layout for our activity we
have a vertically oriented linear
activity first view is an image view
whose ID is result image view this view
will be used to display the image
returned by the network request the next
object is the button whose ID is refresh
button and callback method on refresh
image the layout height of both objects
is set to zero DP a layout weight of
nine for image view and one for button
causes the image view to occupy 90% of a
container height and button to occupy
10% of container height next we shall
review the oncreate method of the main
activity let's open mainactivity.java
file in oncreate method we obtain a
reference to network manager instance by
calling the get system service method
and passing context connectivity
underscore service as a parameter this
reference is stored in the eMCON MGR
member variable this reference will be
used later to detect the network status
before performing a network request next
we obtain a reference to the image view
object on the main layout this will be
used to update the image content later
after processing the result received
from the network request next we scroll
down in the same file and review the
download image task download image task
class extends async task async task is
defined by three generic types the first
generic type is params the type of
parameter sent to the async task on
execution method we have defined this as
string type and we pass the URL of the
network request using this string type
the
second generic-type is progress the type
of progress units sent during background
operation we don't use this parameter so
we set it to void type the third generic
type is result the type of the result of
the background computation which in our
case is bitmap type containing the image
that is downloaded from the result of
the network request async task class
declares an abstract method due in
background which must be defined by the
derived class as the name of the methods
suggest async class ensures that this
method will be executed on a background
thread it is inside due in background
that the HTTP URL connection object is
created and the network request
performed inside do in background we
call the download image method and pass
the string referring to the website
which is in turn passed to the async
task execute method in download image
method we convert the string object
referring to the website HTTP colon
backslash backslash lorem pixel comm
backslash 640 backslash 480 into a URL
object from the URL object we create an
HTTP URL connection object we set some
timeout parameters connection timeout is
set to 5000 milliseconds if no response
is returned within this time a URL
connection failure will occur
similarly read timeout of two thousand
five hundred milliseconds is set which
is the maximum time to wait for the
input stream read operation to complete
these timeout parameters should be
chosen based on the network speed the
HTTP request method is set to get for
more information on HTTP request methods
refer to documentation available on
www.hsn.com
we set up an input stream to read the
URL connection response bitmapfactory
class provides a method to decode an
input stream of data into a bitmap
object so we call decode stream and pass
the input stream obtained from URL
connection response which returns the
bitmap object HTTP URL connection
methods throw malformed URL exception if
the URL is incorrect
the input stream operation may throw IO
exception
therefore these exceptions are handled
in the catch block finally the method
returns the bitmap object which will in
turn be passed to the on post execute
method async task executes the
onpostexecute method in the UI thread
any UI changes are implemented in this
method in our case we have to set the
bitmap object that we just downloaded as
a Content image for the image view on
the main activity finally we will review
the on refresh image callback method
this method is called by the Android
system when the Refresh image button on
the main activity is touched in this
method we check if the network
connection is available using the
connectivity manager instance if an
active connection is available a new
download image task is created and the
execute method is called passing the URL
download image task performs network
request on the background thread
converts the received response into a
bitmap and updates the image view with
the new bitmap on the UI thread if the
network connection is not available
Network not available message is
displayed on a toast
next open the androidmanifest.xml file
in the application manifest file we have
declared permission to access and joy'
permission internet to allow the
application to perform network request
and android app permission access
underscored Network underscore state to
allow access to information about
networks let us execute the project
every press of refresh image button
sends a network request to receive a new
image and the new image is displayed on
the image view now you can see that the
demo is in action which is a result of
what we just learned
in this section we will look at how to
design android applications that provide
user control over the usage of network
resources access to the Internet and
hence the data may incur cost users may
incur higher telecom related expenses if
they cross data limits when using mobile
data however it may be comparatively
cheaper with Wi-Fi if your application
uses lot of background data it is
essential that the user has control over
permitting certain operations for
example syncing photos only when
connected to Wi-Fi another option is to
not use Internet data if you will need
to activate roaming as we have seen
earlier the first step in building an
application is to declare permissions to
use the network Android permissions
internet allows applications to open
network sockets Android permissions
access underscore network underscore
state allows applications to access
information about the network you have
to add appropriate intent filters in the
manifest file to detect changes in the
internet connection if you declare the
intent filter Android dot intent dot
action dot manage underscore Network
underscore usage it tells the Android
system that you allow users to control
data usage your application will be
listed in the data usage section of
device settings the next step in
providing such fine control to the user
to monitor and control data usage by the
application is to verify the type of
internet connection as you can see in
the code snippet here we use
connectivity manager which we discussed
earlier to detect the network connection
type then we should receive a network in
full object corresponding to each
network interface in this case the code
type underscore Wi-Fi and type
underscore mobile dot is connected
returns a boolean that indicates if the
corresponding network interface is
enabled it is a good practice to check
if internet connection is available if
the application detects that Internet is
not available it can prompt the user to
enable connection get active network
info call on active interface returns if
the internet connection is available is
connected handles flaky mobile day
connections and roaming options of the
network next key step is to implement a
preference activity you can create a
preference activity where user can
choose which network connection to use
you also have to implement on shared
preference change listener to keep track
of preference changes whenever a user
preference changes Android will notify
the application about the change we
should add manage underscore network
underscore usage intent action in the
application manifest for preference
activity the Android system adds this
application in the data usage section
under device settings it is shown using
a red arrow in the adjacent screenshot
it is necessary that your application
should keep track of connection changes
it is not enough to check for internet
connection availability when the
application begins the application
should also notify the user of any
disruption in the connection for this
create a broadcast receiver subclass
that will be notified when the
connection or preference changes
register the broadcast receiver only
when activity is an active state
unregister when activity is paused in
this demo application we will review the
methods to control and manage network
bandwidth usage the usage of network
operations on a gsm network may incur
higher charges to the user therefore it
is a good practice to provide
customization options to the user in the
application to restrict network
operations while connected to mobile
data if the device is connected to Wi-Fi
network restrictions may not apply an
easier way to provide such customization
is to add a preference activity we will
call this a settings activity settings
activity will be invoked from the
settings action on the main activities
action bar apart from providing network
control options we can also provide
quick access to our application settings
activity from Android system settings
data usage menu for this demo we will
use HTTP colon backslash backslash lorem
pixel comm website after the website URL
we can specify the width and height in
the number of pixels of the image
and website responds with a random image
of the requested size for example
request HTTP colon backslash backslash
lorem pixel comm backslash 640 backslash
480 will return an image of width 640
pixels and height 480 pixels press
refresh image button on the browser and
another random picture of the requested
size is returned in this example the URL
is a network request and the response is
the image returned by the website for
the current demo application we have
implemented a settings activity which
can be launched by selecting settings
action from main activities action bar
on the settings activity we have the
preference item called
allowed Network types selecting this
item shows you a list of radio button
options to select there are three values
to choose from selecting any Network
means no network restrictions network
operations can be performed irrespective
of the type of current active network
touching the refresh image button on the
main activity refreshes the image on the
main activity
selecting only Wi-Fi would allow network
operations only when the active network
type is Wi-Fi touching refresh image
shows the message data allowed only on
Wi-Fi network the emulator emulates
mobile data only even though the host
computer is on a wireless network
selecting no data would not allow any
network operations when this option is
selected touching refresh image shows
the message data disabled by user we use
a combination of user preference network
availability and type to decide if the
network request can be performed next
let's go to the system settings
data usage scroll down to find our
application URL con demo we can see how
much background and foreground data is
consumed by our application foreground
data is the data consumed when an
activity of the application is active
background data is the data consumed
when none of the activities of the
application are active for example
network operations performed by
background services this page has an app
Settings button touch this button and
our applications settings activity is
launched the user can monitor the data
consumed by the application and quickly
change the settings if needed
let's review the code to understand how
to implement these features the layout
for the main activity is used from
previous demo we have an image view to
display the downloaded image and the
refresh button to initiate the network
request activity underscore main XML
provides a layout for our activity we
have a vertically oriented linear layout
the first view is an image view with the
result image view ID this view will be
used to display the image returned by
the network request the next object is
the button the ID is refresh button and
callback method on refresh image let's
open menu XML file which is located
inside the resource folder named menu
menu XML contains an action item and its
title is settings and ID is action
underscore settings the applications
settings activity is implemented in the
settings activity Java lets open
settings activity Java and review the
code note that the settings activity
class extends preference activity and it
also implements shared preferences dot
on shared preference change listener
preference activity is the base class
for showing a list of preferences to the
user its view content is provided by a
special XML file this XML file defines a
hierarchy of preferences the activity
content is provided by calling the add
preferences from resource method and
passing the XML file containing
preference items in this demo it is
dot XML dot preferences we will review
the XML file shortly shared preferences
dot on shared preference change listener
defines an interface method on shared
preference changed which will be called
whenever the user changes any preference
item value we will simply print the new
value to the logcat however there is
another way to access preference values
from the main activity which we shall
review later in the onresume lifecycle
method we register the on shared
preference change listener and
unregister it in the on pause method
preference XML is the file that defines
the preference items from the settings
activity it is located in the XML
resource folder let's open preferences
dot XML we have only one preference item
which belongs to the type list
preference chosen network type is the
key to access the user selected value
when we want to check the preference
value in Java code the title of the
preference item is allowed Network type
let's switch over to the emulator and
settings activity to correlate these
when the user selects allowed network
type a preference fragment displays the
available options to choose this is
defined by entries and entry values
attributes entries is the user readable
array of strings entry values is the
value corresponding to each element of
the entries array which is used in the
code to check the user preference let's
open a raid XML in the values resource
folder to review the entries and entry
values of the preference item this file
contains definitions of two arrays that
are referred to in the Preferences XML
file if the user chooses the any network
option the preference item stores any as
the chosen value similarly if the user
chooses stop data on the settings
activity preference item stores none as
the value the next step is declare the
settings activity in the application
manifest let's open the
androidmanifest.xml file and scroll down
we have declared the settings activity
here we have added a special intent
action manage underscore network
underscore usage
this action will launch the settings
activity when the app settings button is
touched in the data usage screen of
system settings now that we have seen
the settings activity and how its
contents are provided let's move on to
the main activity Java in the oncreate
method of the main activity we obtain a
reference to the network manager
instance by calling the get system
service method and passing context
connectivity underscore service as a
parameter this reference is stored in
the EM comm manager member variable this
reference will be used to detect the
network status before performing a
network request next we obtain a
reference to the image view object on
the main layout this will be used to
update the image content later after
processing the result received from the
network request in the on start
lifecycle method we obtain a reference
to user preferences by calling the
preference manager dot get default
shared preferences method this is the
reference to the entire application
preference object in our demo it will
contain only the chosen Network type
then obtain the preferred network value
by calling preferences dot get sting and
passing the preference key when such a
key does not exist in the preferences
default values are returned in the
second parameter of the get string
method the user preference values will
be used along with network status and
type to decide if a network operation
should be performed
next we implemented on create options
menu the action bar items are created by
calling menu inflators inflate method
and passing the menu XML ID on option
item selected is called when the user
selects an action bar item menu item
passed to the method contains the ID of
the action bar item in our case we check
if the user pressed the Settings action
and start the Settings activity after
the user changes the Preferences on the
settings activity press the back button
to get back to the main activity the
next method is the on refresh image
method which will be called when the
user touches the refresh image button on
the main activity in this method we
first check the users network preference
and then the active network type before
performing the network operation if
the user is chosen any then we check if
the network connection is available
irrespective of whether it is mobile or
Wi-Fi if an active connection is
available we execute the download image
async task the previous demo explains
async task in detail if the user is
chosen Wi-Fi only we check if the active
network type is Wi-Fi and only then
execute the download image task
otherwise display data aloud only on
Wi-Fi network message if the user is
chosen stop data then display data
disabled by user message
let's execute the project and test the
application on the emulator
choose only Wi-Fi go back to the main
activity touch refresh image as Wi-Fi is
not available on the emulator it
emulates mobile type network hence it
displays data allowed only on Wi-Fi
network choosing stop data disables
network operations then refresh image
displays data disabled by user message
now we know how to provide customization
options to the user in the application
to control and manage network operations
XML stands for extensible markup
language XML is a popular format for
sharing data on the Internet websites
that frequently update their content
such as new sites or blogs often provide
an XML feed to inform external programs
of content changes uploading and parsing
XML data is a common task for network
connected apps XML is a markup language
much like HTML but it does not use
predefined tags and is self descriptive
XML does not contain presentation
information an example of a bookstore
packaging books information in XML is
shown on the screen
information in XML is contained between
a start tag and an end tag an element
can contain nested elements between a
start underscore tag and an end
underscore tag in this example the title
contains the text element that is a
title of the book whereas the book
element contains multiple elements
containing different information about a
book knowledge of how information is
contained in XML is key to parsing XML
to extract data there are several XML
parsing libraries available XML pull
parser is one of the efficient classes
and we use XML pull parser in this
section XML pull parser supports XML
namespaces in our example we are not
using namespace and we pass null
whenever namespace string is required
the first step in XML parsing is to know
what tags are present in the XML and
decide which tags to parse in the
example XML shown Wall Street Journal
Technology XML feed contains greater
than item less than tag for every news
item in some complex xml's tags can be
nested deep to group information it is
very important that you know the tags in
the XML and how they are nested in this
example greater than channel less than
channel is a root element it contains
several greater than item less than
elements each greater than item less
than element contains several tags such
as title link description and so on
next step is to instantiate the parser
and provide the input stream containing
XML data parser next tag skips all white
spaces in the document or stream until
it encounters a start underscore tag or
end underscore tag in the example first
start underscore tag is our SS we can
check this by calling parser dot require
and passing the token that we expect if
the expected token is not present
indicates the XML is corrupt and an
exception is thrown we know from the
example XML that channel element is the
one containing news items we skip until
start underscore tag channel encountered
likewise we can go deeper into the
elements until we find the element that
we are interested to parse the element
that we want to parse may contain a text
information in the example title element
contains the title of the article in
text we can extract this by calling
parser get text after we have reached
the start underscore tag of the element
similarly an element may contain
attributed information that is media
colon content element contains a URL
type attributes to read such information
call get attribute value and pass the
attribute we want to read another
possibility is that the element contains
nested elements in such case we parse
until the start underscore tag of child
element and call its read method
create a read method for each of the
tags for example create read item read
title read link and read description
check if the start underscore tag is the
element you want to read for example if
you encounter a start underscore tag and
if it is item get event type is another
useful method to check what the last
token type that was read is read the
element depending on if it is text and
attributed value or a nested element
store the information in a suitable data
structure if you are not interested in
reading greater than media : content
less than tag it can be skipped
you can skip reading elements until the
end underscore tag for the element is
encountered if the element to be skipped
contains nested elements we can keep
track of the depth of nesting when we
reach depth 0 we know that we have
skipped the element completely you can
skip tags if you don't want to read you
have to implement a skip open bracket
close bracket function that will
completely skip the element it might be
the case that the tag you want to skip
may contain nested elements you have to
implement code such that you take care
of depth of nesting and keep parsing the
XML until the end tag is encountered at
depth 0 by this way
the application is future-proof that is
if a new tag element is added to the XML
the application will not break append
the data read from XML file into an
appropriate data structure such as a
list
after completing parsing an application
can consume the data such as updating
the user interface the following
application demonstrates how to download
XML data from the network and parse the
XML data using the XML pull parser XML
is a very popular format to exchange
data over network the first task is to
perform a network request to receive the
XML data from the internet and then
parse this received XML data and display
it in an appropriate view for this demo
we have chosen the Wall Street Journal
portals technology field which is an XML
containing technology news item with
lots of attributes values and tags let's
review the XML data format in a browser
open www SJ comm and scroll all the way
to the bottom of the website
generally RSS feeds of the website will
be listed at the bottom
let's select technology what's news the
Chrome browser formats the XML document
tree for easy reading if you are using
some other browser you may need to
install some XML Reader plugins or
add-ons these feeds provide the news
items in a well packaged XML format it
is very important to know the structure
of the XML file and decide which tags
are important for us to parse before
writing code to parse the XML data let's
examine the XML format let's zoom in to
make the text more legible the RSS is
the root element of the document it's
only child element is Channel we can see
it contains various attributes of the
channel if we scroll down further we see
news items arranged inside item element
this is what we are interested in for
the scope of this demo however
application developers may decide to
parse and display other information
based on the need let's review other
tags inside each item tag title element
contains the articles title greed
contains the ID of the image for this
article we will ignore this for the demo
link element contains the actual URL for
the entire article on the Wall Street
Journal's website when the user selects
this article the URL to the article can
be opened in a browser for the full news
article however we will ignore the link
element to keep the demo restricted to
parsing the XML file description element
contains a brief description of the news
article there are various other elements
for each article which we will ignore
for the scope of demo further scrolling
down we can see each news article has
the same hierarchy of title link
description and so on scroll all the way
to the bottom of the page we see that
back slash channel which is the end tag
of the channel element that marks the
end of the document we have to parse the
XML document until we encounter the
channel end tag let's check out the demo
application on emulator we can see that
the application is downloaded the XML
parsed it and display the information on
the main activity inside a scrollable
view let's review the code activity
underscore main
Cemil provides a layout for the
mainactivity we have a vertically
oriented linear layout the textview that
is located at the top of the linear
layout displays the text Wall Street
Journal technology news next we have
added the scroll view the scroll view
contains a linear layout and it's ID is
container view we will be adding parsed
news article views into this container
view as they are a larger number of news
articles which causes the height of the
container view to expand beyond the
screen size the scroll view allows
vertical swipe or fling gesture to
reveal more articles let's open News
underscore item XML file this has a
linear layout containing two text views
first the text view will hold the title
of the news article it's text appearance
attribute is set to large next the text
view will hold the description its text
appearance attribute is set to small we
instantiate a new view object from News
underscore item that XML set the title
and description and add it to the main
activities container view let's open
mainactivity.java in the oncreate method
we obtain the reference to the
connectivity manager object and store it
in the member variable eMCON manager
this will be used to check the network
availability status later in the
application next we obtain the reference
to the container view by calling find
view by ID and passing the container
layouts resource ID this is stored in
the member variable named M container
layout after parsing the XML file
article views will be added to the
container view as sub views scroll down
to reveal on start method implementation
in the on start lifecycle method we
check if the network connectivity exists
and then call the load news page method
which does the bulk of the operations if
the network connection does not exist
the load default message method is
invoked which displays a message
internet connection is not available
scrolling down further we can see that
load news page is instantiating download
News tasks and calling the execute
method
scrolling down reveals the
implementation of download news tasks
class
download news tasks class is an async
task whose parameters types are as
follows the first parameter is string
which contains the URL of the news feed
we do not have any progress updates and
hence have set the second parameter type
to void after downloading the XML and
parsing it we convert news articles into
a list of articles
hence the third parameter type of async
task is the list of type simply XML
parser news item async task has been
explained in detail in earlier demos due
in background which is executed on the
background thread by async task calls
the download XML method and passes the
string containing XML feed URL scroll
down to see the implementation of the
download XML method download XML
instantiates an HTTP URL connection
object and invokes the network operation
the network operation extracts and
returns the input stream containing the
XML data let's roll back this input
stream is passed to the create news
items from XML method
scroll down to the implementation of
create news items from XML create news
items from XML instantiates our simply
xml parser class to parse the XML data
and convert it to a list of news
articles simply XML parsers parse method
is the entry point to begin the XML
parsing go back to the on post execute
method for every news article in the
list create a linear layout from News
underscore item XML set the title and
description of the article and add it to
the container view in a loop we saw
earlier that this container view was
inside a scrollview so when all news
articles are converted and added to the
view they will appear on the main
activity next let's open simply XML
parser Java to understand how the XML
data was parsed and converted to news
items list we have declared a news item
class to hold the news article
it has member variables title link and
description and all of type string each
object of this class holds one news item
as and when the XML stream is parsed and
news item extracted it will be stored as
a news item type object and added to the
list the parse method which takes the
input stream as a parameter is the entry
point to the simply XML parser
here we instantiate XML pull parser and
begin the parse operation the news feed
XML does not use namespaces and hence we
set the namespaces flag to false then we
set the input stream to the XML pull
parser parser next tag will begin
parsing and stops when it encounters the
next tag as we are at the start of
parsing operation the read next open
bracket close bracket method will stop
when it encounters the first XML tag
which is RSS for the current XML we are
reading the read XML method performs the
actual parsing of the news feed and adds
each news item into the list scroll down
to review read XML method the parser dot
require method test if the parser has
reached start underscore tag matching
the element RSS if not it throws an
exception this ensures that we do not
end up inside an indefinite State we
have used the parser dot require method
to ensure we're in the right parsing
state throughout this class we call
parser next open bracket close bracket
in a loop until we find the next start
tag let's go back to the browser and see
that after RSS the next element we would
encounter is Channel we have to continue
parsing until we encounter the start
underscore tag matching channel parser
dot require method ensures that we have
arrived at the channel element inside
channel element there are a lot of other
elements but we are interested only in
the element named item we continue to
parse the input stream until we
encounter the end tag backslash channel
parser get name returned the name of the
current element if it matches item then
we call read item method which in turn
returns the news item object added to
the news items list at this point any
other element is skipped by the parser
the Skip method ensures that the entire
element is skipped for example if we
encounter the element copyright the Skip
method ensures that all the day
till backslash copyright n tag including
the end tag is skipped let's scroll down
and review the implementation of skip
method we expect the skip method be
called when the parser has just parsed a
start tag otherwise illegal State
exception is thrown this is important
because we should know which element we
are skipping we ignore all data until we
encounter the end tag for the element
being skipped the skip method also takes
care of skipping nested elements by
tracking the depth of nested child
elements let's scroll up and go back to
read xml method we understood how to
skip unwanted xml elements
let's scroll down and review the read
item method which parses news item
elements parser dot require method
checks if the read item method is called
when the parser is at the start tag of
item element initialize temporary
variables for title link and description
again the item element is parsed inside
a loop which terminates on reaching the
back slash item end tag if the current
element name is title then we call read
title which parses the title element and
returns the string containing the news
item title similarly read link parses
the link element and read description
parses the description element scrolling
down further reveals the implementation
of these methods in the read title
method check if the parser is indeed at
the start tag of title element by
calling parser dot require we know that
the title element does not contain any
child elements and only the title text
we need not parse it in a loop instead
read text will parse the data between
title start tag and end tag read link
and read description are also
implemented in a similar way next let's
scroll further down to review the read
text method in this method we ensure
that the type of data is of text type
parser dot get text method returns the
string parser dot next tag advances the
parser to the next tag when all the
loops end we would have parsed the
entire XML stream and converted it to
the list of news items to recap we
continue parsing until we encounter the
XML element that we want to parse this
element may have nested child elements
we skip any element that we do not wish
to parse we have implemented separate
read methods to parse only those
elements that we are interested in thus
the entire XML file is parsed and
converted to a list of news articles
which are converted to text views and
added to the main container view let's
execute the project and see the results
on the emulator
now you can see that the demo is in
action which is a result of what we just
learned
let us summarize the topics covered in
this lesson in this lesson we explain
the process involved in connecting to a
network we learnt how to send a request
and receive a response we described URL
connection and saw a demo on using the
URL connection we explained the key
steps involved in managing network usage
and demonstrated the same we define XML
data describing parsing XML and lastly
demonstrated parsing XML data this
concludes the lesson on network
operations
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>