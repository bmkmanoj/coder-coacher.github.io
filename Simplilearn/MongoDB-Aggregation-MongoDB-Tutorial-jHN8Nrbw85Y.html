<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>MongoDB Aggregation | MongoDB Tutorial | Coder Coacher - Coaching Coders</title><meta content="MongoDB Aggregation | MongoDB Tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Simplilearn/">Simplilearn</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>MongoDB Aggregation | MongoDB Tutorial</b></h2><h5 class="post__date">2016-02-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/jHN8Nrbw85Y" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">aggregation process data fits and return
calculated results it is run on the
Mongolian stands to simplify application
codes and limit resource requirements
following other characteristics or
aggregation uses collections of
documents is an input and return results
in the form of one or more documents is
based on data processing pipelines
documents pass-through multistage
pipelines and gets transformed into an
aggregated results the more basic
pipeline state in the aggregation
framework provides filters that
functions like queries the pipeline
operations group and sought documents by
defined field or fields the pipeline
uses native operations within MongoDB to
allow efficient data aggregation and is
the favored method for data aggregation
so mama DB also would provide out of
occiput for MapReduce as well but again
that is not a favorable or recommended
approach by MongoDB to use the
aggregation so they have the aggregation
framework which will does most of the
tasks this example please understand
what is happening over here there is a
orders collection and I am running an
aggregate pipeline on top of that the
orders collection how does it look like
see on the left hand side you have a
customer ID we have a mount we have a
status you can see there are two
customer ID is a one two three there are
three customer ID is a one two three and
there is one customer ID be two one two
so what happens is first of all the data
goes through the match pipeline the
match pipeline and what is our dollar
match the dollar match is give the
status as a let's get me only those
records who has the status as a so we
come to know from looking at the orders
collection that only the first three
documents will come only the first three
documents will come in the yellow match
and that what's happened so we have two
documents from a one two three and one
document for B word one after going
through the data from the
match pipeline what happens the Raider
goes to the group pipeline what happens
with group pipeline I'm grouping by
customer ID and I am making a Nellie a
skull total in total is the key and what
will the total have total will have a
sum of amount and what is the amount the
amount we have a key in the documents in
the orders collection see what is
happening is the customer ID is grouped
and the amount gets plus the total we
have 750 and again to total we have 200
there was no aggregation supposed to be
done so again this is very important
from MongoDB the creation point of view
the pipeline operator and index is very
great command in MongoDB functions on a
single collection and logically passes
the collection through the aggregation
pipeline we can use with all the match
dollar limit dollar skips faces to
optimize the aggregate operations you
may require only a subset of data from a
collection to perform an aggregation
operation therefore use the dollar max
the limit in dollar scripts pages to
filter the documents once they are
filter that I can actually group them up
the dollar match operation scans and
select only the matching documents in a
collection when placed at the beginning
of a pipeline placing the dollar match
pipeline stage followed by a dollar
short stage at the beginning of the
pipeline in equivalent to a single query
with a sort and can use an index step
place dollar match operators at the
beginning of the Python is possible
because that we make all the Saints
dollar matches with a query again I want
all the countries which are India and
again once I've got that I can put a
group operation on top of them to group
things up so the different stages you
know through which it passes again as I
talked about first one is it all a
project what happens the dollar project
is like a view add new fields or removes
existing fields and the restructure is
document in the stream it returns one
output document for each input document
provided what the dollar match will do
dollar match is like where filters the
document stream allows only matching
documents to pass into the next page for
example document it returns one output
document if there
match our little if no match is fought
now a group is like the grew by groups
document business specified identified
expression and apply logic known as
accumulator expression to compute the
output document now the sort again
rearranges the order of the documents
frame using specified hotkeys provides
one output document for each and per
document so again we have some more as
well again as I told you dollar skip
will skip the number of documents and
passes the remaining documents without
any modifications to the pipeline
returns either 0 documents for the first
in documents or one document dollar
limit what will the dollar limit do
dollar limit will pass the first n
number of documents without any
modification to the pipeline returns
either one document for the first in
documents or 0 documents after the first
in document so again the taller sort the
dollar skip the dollar limit works
exactly the same way how they work in
the find and then we have dollar unwind
if we have an array and we really want
to unwind every element in ternary we
use a dollar unwind so that is what we
construct an array filled in the input
documents to return a document for each
element if I have something called
hobbies
tea tea badminton so that won't be an
array it will be three different
elements of different keys that is
fragmented tea tea and volleyball search
in the aggregation example which you see
over here so the aggregation operation
given below returns all the states with
total population greater than ten
million so that again is the same slide
which you know the the same link which
has sent you this example is from the
same documentation page so please see on
the slide what is being shown so what I
am doing
so zip codes is a collection I'm putting
an aggregate pipeline on top of that I
am grouping in on the state and when I
am saying you group it in the state and
calculate the total population and give
the sum of the total population so again
if I remain on the first query for some
more time again be with me I am going
slow very slow bb-dub codes at aggregate
zip code is the collection
I put an aggregation framework on top of
that
the area starts in the round bracket
there is an array inside the array
they will come different pipelines the
first weapon which came is dollar group
in the dollar group I specified the ID
with which I'm gonna group by state and
I'm going to give the aggregating
function which is total population is
the key or irelia's and I am telling
total population will be divided by
calculating a sum of all the population
to reference the population and using
dollar pop and again I am doing a dollar
match that gave me only those states
which are having a total population of
greater than some 10 millions so very
clear this thing should become that how
this query is running so in this
operation the dollar group stage does
the following group the documents of the
zip code collection by the state field
calculates the total population field
for each state returns an output
document for each unique state so the
aggregation operation given below
returns usernames sorted by the month of
the joining so again what we have over
here is so DB dot users not aggregate
dollar project man join again it is
dollar month : dollar joined and again
we have the name is dollar underscore ID
and under squared is 0 and again we can
just sort it with the month underscore
joint so in both the examples would have
cleared you how the group by actually
happens in MongoDB</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>