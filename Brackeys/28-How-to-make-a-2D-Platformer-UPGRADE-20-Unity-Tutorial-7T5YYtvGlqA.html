<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>28. How to make a 2D Platformer - UPGRADE 2.0 - Unity Tutorial | Coder Coacher - Coaching Coders</title><meta content="28. How to make a 2D Platformer - UPGRADE 2.0 - Unity Tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Brackeys/">Brackeys</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>28. How to make a 2D Platformer - UPGRADE 2.0 - Unity Tutorial</b></h2><h5 class="post__date">2016-04-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/7T5YYtvGlqA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">thanks for tuning in at brakus hello I
want to welcome to this video on making
it to the platformer course today we are
going to be expanding upon our upgrade
menu we're going to be adding in the
idea of money now a way to kind of spend
that money I don't know how far we'll go
with implementing the actual stat
upgrades but we should definitely have a
more interactive upgrade menu when we
are done so that's going to be super fun
also of course want to apologize that
it's taking me so long to put out a new
video but I've been sick I caught the
flu and I actually still am a little bit
so if you see me coughing it's nothing
serious but it's not completely gone
either so let's just dig right into
today's video and forget all about flus
and yeah so you can see I've left the
project exactly as it was in the last
video and the first thing that I noticed
when I turned off the camera is that
when we maximize the game here you can
see that the astronaut snaps to the left
and that looks super done really so
let's start out by anchoring him to the
center and by the way the shortcut that
I'm using to maximize a game or a window
is just shift space it's super useful
you can maximize any window and unity by
just pressing shift space while hovering
the mouse over it a shortcut that many
people don't know so now under the UI
overlay and then under the upgrade menu
we can find our astronaut and we simply
want to change this anchor here from the
left to the center there we go so now
when we maximize the game everything
looks much better cool so the first
thing that I want to do here is just go
ahead and disable this upgrade menu this
way we can choose whether or not it
needs to be enabled by simply pressing
some kind of upgrade button and in our
case I want that to be you and just to
make sure that the user knows what
button to press let's just add a simple
text instruction down here so in order
to get some text let's just duplicate
this lives counter it has the correct
style with little footsteps in the
shadow and we can just just remove that
script then we can maybe change the
position of this woops I selected the
wrong one and this is going to be
upgrade menu notice tooltip press view
for upgrade menu here we go and we can
simply move that down here and we can
Center that text and we want it to be a
lot bigger actually and we want this to
say press and then we can use some ITF
rich text format in here as you've maybe
seen in HTML programming or stuff like
that and the I here stands for you can
see here the I stands for italic and
that will just kind of tilt our text a
bit and that's cool when doing stuff
like on this year so when we want to
notify the user that it's the you button
instead of using quotes or something
else you can also do B for bold if you
think that's cool it's just fine but I
like the italic style so press you to
open the upgrade menu there we go and we
actually need these two this to be even
larger and we can drag this down here so
it's at the very bottom and we could
maybe yeah make sure that centered
everywhere and anchor to the bottom
there we go and you can see what that
looks like in the game and currently it
looks horrible I also want to size down
on this text and yeah maybe we should do
something like 14 I think that's fine
just a very tiny notice down here that
that is something you can indeed do we
might want to yeah angry that to the top
here there we go and I think that looks
just fine and what you can do is make
this text flash sometimes or maybe
disable it when once the users actually
upgraded something you can just put an
animation here I'm not going to bother
with this since we have a lot to do so
yeah I'm just going to skip over it and
just leave it there it's not like it's
obstructing the screen in any kind of
way so that's just fine and then let's
go inside of our key
Master Script double-click to open this
up in Visual Studio monodevelop whatever
you're using and in here we will simply
add some kind of method for enabling and
disabling the Update menu so first off
we need a reference just like we have a
reference to our game over UI and this
is going to be a serialized field and
it's going to store a private game
object and it's going to be called our
grade menu then all we need is some kind
of method on here and I think we're
going to check for this in the update
method here so you can simply say if
input that get key down and the key we
want to check for in my case at least
here is the U button you can choose any
key that you want you can also add it as
variable that might be better but since
we have a lot on our plate let's just
hard code it for now
you know the good practices and you
should definitely be doing then I'm just
here to show you some new stuff so and
what we can do in here this may be
called some kind of method or we could
just hard-coded in here I'm just going
to make a quick private void which is
going to toggle the upgrade menu
something like that and that's all we
are going to call right here awesome so
what we then want to say is we want to
say that our upgrade menu dot set active
so we can enable a disable here false is
disabled and sure is of course enabled
and we don't want to give it either
false or true instead we want to set it
to the opposite of what is it currently
is there for the tackle and we can get
its current active state by using
upgrade menu dot active self you need to
use active self because active is
currently deprecated so and in order to
make it the opposite of that we simply
put a what's this time and assign here
an exclamation mark that's right so that
will inverse whatever operation we have
going cool
and what we can then do is maybe
we need some kind of way to notify other
scripts that the upgrade menu is now
active because we don't want to pause
the game because we have animations
going and we want the UI to update and
all that but we definitely wit want some
things to stop happening for example we
don't want to shoot while the upgrade
menus up we don't want to be able to
move we don't want our enemies to chase
us and there can be more stuff coming
maybe you don't want the spawner to
spawn anything you can think about these
things on your own it's definitely up to
you how how much of this stuff you want
to change you can also just leave the
game running that's completely fine a
lot of games do that I just want to
disable a few things I want to disable
player movement play a shooting and the
fact that enemies chasers I think if we
disable those three things it's going to
be just fine good so in order to do that
excuse me
all we need to do is create what is
called a delegate and I don't think
we've discussed delegates in this series
before so here we go so first off I want
to write private delegate void I'm going
to call this upgrade menu callback and
it's not going to take actually we're
going to take in a boolean which is the
active state so that's going to be
called active so what is a delegate a
delegate is basic basically a way for us
to create a a type here that will store
a bunch of references to functions so
that we can call this delegate or invoke
it and it will call all of the different
functions that are registered to that
delegate so basically it allows us to
without having in knowing anything about
any functions call some kind of event
that will trigger a bunch of things in
other scripts that have subscribed to
that event and
a bunch of ways to do this one is using
delegates and others using actions a
third one is using what is called events
but I'm just going to go the old school
dedicate here and this is the syntax so
here we kind of create our type we
create a delegate void it doesn't return
anything and all of these methods that
are subscribed to this will have a
boolean stay saying whether or not it's
active as an argument and then we create
this specific instance of this delegate
I am going to make this public actually
and that's going to be of course a
public operate menu callback just as
when we create an anomaly class before
declared create the type and then we
create the instance here and this is
going to be called on upgrade menu on
talked a lot great menu maybe yeah
that's better on toggle upgrade menu and
we simply close that off so the cool
thing about this here is that down here
when we talk of this we can then say
that we want on toggle upgrade menu to
invoke all of the methods that have
subscribed to this event and I will show
you how you can register all subscribe
to this event in a second but for now we
need to pass in whether or not the
upgrade menu is actually active and we
do this by sibling putting in maybe the
awkward menu dot act itself so if our
upgrade menu is active we put that in as
an argument this will go up here and
tell this variable here to call all of
the methods that have subscribed
themselves to this delegate
now let's take a look at actually
subscribing methods to the delegate
because this will currently not do a
thing so what we can do is we can go
ahead and find our player maybe this is
a good place to start here let's double
click on our player and you can see here
that I've typed beforehand require
component type of platform to the user
control and this is because I want to
simply set or disable this compare
because it's one allows us to control
the player and therefore I want to be
able to disable it and what we can then
do is we can create some kind of method
that should be called whenever the
upgrade menu toggle is or whenever the
upgrade menu is toggled so we are going
to create maybe a void here code on
upgrade menu target you can call this
whatever you want as long as you take in
as an argument the full active state and
all we need to do here is yeah well we
can do a few things here so here we will
handle what happens when the upgrade
menu is toggled but we need to sync or
link this method here subscribe this
method to the delegate we just created
in the game master which is this one so
what do we do we simply go up here under
the start method this is a good place to
do it you only need to do this once then
we go game master ATM to get the
instance of our game master dot and then
we find the on circle upgrade menu and
then we add on to that we use plus
equals on upgrade menu Targo now this
method down here will be called when
this delicate is invoked so that it's
that easy and it's super cool because we
can we can add as many methods on here
as we want to so we can do that from
other scripts and we will be doing that
from other scripts excuse me
good so what we can do here is simply
say that we want to get a reference to
this platform to the user control so we
will say get component platform to the
user control dot enabled equals active
so if the or actually we want this to be
the opposite of active so if our our
update menu is active we don't want our
platform to the user control to be
active
if it if it isn't active if we've closed
it down again then we want to be able to
move so we want this to be to be true
good so that's perfect and we also want
to do the same to our weapon we don't
want to be able to shoot while the main
menu is up so therefore we can maybe
store this in the temporary variable
we'll call this the weapon and we'll
find this in the children hierarchy so
gate component in children and we'll
find the weapon and we simply want to
check if it's null because we don't have
any way of knowing if it's not or not so
if it's if weapon is not equal to null
well then we simply want to set weapon
dot enabled equal to the opposite of
active there we go so that should work
just fine and we can now go ahead and
actually test this out just to make the
testing clearer I'm going to go ahead
and just change the Alpha on the
background here so we can see what's
going on in the background so let's go
ahead and hit play
and I'm now going to you can see I can
shoot and move I'm going to bring up the
update menu whoops is an unassigned
variable and that's in our GM that's
because we haven't actually dragged in
the upgrade menu there we go that should
hopefully do that and now we can try
again here's there again I can shoot and
move oppress you I can't move and I
cannot shoot you can see my arm still
moves but that's fine with me we could
go ahead and disable that too and that's
maybe something you want to do for your
game but I don't think it really matters
here and you can see here we are free to
press the different buttons so that's
perfect however our enemies are still
moving so just to make sure that we
won't be killed while in the upgrade
menu I'm going to stop that from
happening
so let's find our enemy prief or
actually just let's just find our enemy
script here and in this I simply want to
require the component type of enemy AI
because this sits on the enemy object I
just want to make sure
that it sits on the enemy object and we
are going to do the exact same thing
here so we can just copy from the player
we have this on upgrade menu toggle here
where we define what happens when the
upgrade menu is toggled and instead of
all of this we can simply say that
getcomponent
enemy AI dot enabled is the opposite of
active and that's perfect and now we of
course need to subscribe or add this to
our delegate and we do that by saying
game master TM taught on toggle upgrade
menu plus equals on upgrade menu toggle
there we go and this means that again
from one single place we are now
invoking two different methods and we
can add as many as we want so now when I
hit you and I'm just going to wait for a
few enemies you can see that they slowly
stop so that's perfect
again you can be more detailed about
this and make them stop in an instant
and you can make the countdown stop to
you that won't stop at the moment and
you can do all of that stuff I'm just
showing you the basic idea of how to
implement this stuff so that's perfect
then we can now bring up the background
again because we don't want to see
anything but the upgrade menu at least
not in this game good so let me just
check the time here let's see how far we
are we're actually pretty far ahead
already but I did promise you that we
would implement some kind of money so
let's go ahead and do that just very
quickly so first off I want to find our
game master here open that up and I want
to add a new static variable so we're
going to have here a public static
integer which is going to be our money
and I also want to make a serialize
field and there's going to be a private
integer which is our starting money so I
want us to be able to change this in the
hierarchy and therefore we need to find
our start method I'm right where we set
our remaining
secret to max lives we can also set our
money to the start in money there we go
and that's just perfect so now we have a
static variable that stores our current
money yeah and what we can then do is we
can go in the under our player info and
once again I want to duplicate this a
live counter and I want to simply drag
this down here I want to change this to
money counter I want to change the text
here to money and we'll just default
that to 15 here and that's all good then
we can delete the lives counter here
actually I'm just going to open it up
and copy everything in here just so we
can use that as a base because they're
going to be very similar these two count
these two scripts and we're going to
call this the money calendar you money
calendar UI instead just like that easy
peasy and now we can open up the script
in Visual Studio come on come on unity
work with me here there we go and that
we can just duplicate the other script
in here and we of course want to change
the class name to money counter UI and
we want to change this variable name
here - money money count money amount I
don't know maybe we should just do money
text like that and we want this to be
money and it should just take instead of
the remaining lives it's going to take
game master drug money to string there
we go so it's it will simply pull that
in the update method and it's not going
to take required too much performance
when you think as long as you are on a
desktop or in the web browser if you're
on mobile you might want to make that
into an some kind of code
team that will check at a fixed rate or
maybe you can use a delicate to update
it whatever you want to do so now when
we play we should see this changing to
not serial we should see changing to a
hundred let's find out game master
object our starting money is actually
zero so that's perfect things are
working we can apply this prefab and now
we should see changing to 100 here there
we go so that's perfect and the very
last thing that I want to do is just
begin the upgrade menu script maybe
actually new I think it's a good idea to
wait with your upgrade manuscript to the
next video so what we have here is a
working idea of money we have some kind
of dismay of displaying our money we
have a way of opening and closing our
upgrade menu and this is now working
what we want to do in the next video is
have a way of loading in our stats
updating the stats and spending money
actually one last thing that I want to
do is I want to also add some kind of
money display here so we'll take our
money counter and paste it in here just
above the background would be nice and
we can move it over here and make some
room for it
Center it and scale it up something like
that I actually want this to be a bit
smaller 30 maybe looks just fine yeah oh
and we of course want to anchor this to
the top
probably yeah now we go so now we have
our money displayed in the upgrade menu
as well that's pretty important if you
want to keep track of kind of how much
money view god while purchasing stuff so
that is perfect and we can close that
and minimize that I'm going to match the
mindscape the game here and just see if
everything is working and if it is that
is going to conclude this video so we
can see we can jump around the money has
Update
I'm not going to press you here and we
can press the different upgrade buttons
and we can press you again and it's
going to close off so that is just
perfect you will notice that a enemy
actually died when while I had the
upgrade menu open and that's because his
physics didn't stop him from hitting me
while the upgrade menu was open so if
that's something you want to fix you can
definitely just disable the rigidbody
along with the enemy AI I definitely
recommend you do that or maybe
temporarily turn him kinematic or
something like that and we actually have
another error here so what we simply
want to do is he has been destroyed then
we simply want to check if getcomponent
enemy AI oh I see so if this is not
equal to null the object of type enemy
has destroyed but just trying to access
it your script should either check if it
is no you should not destroy the object
I see there we go so we can maybe check
if this is equal to null this is kind of
weird let's try this can it be null and
then call through a delegate this is
some kind of edge case let's try it
yeah that's weird
oh okay I know what's going on we want
to stop subscribing whenever we kill
this object yeah that's what we want to
do so we want to remove this from from
the delegate when we die yeah perfect
okay so we'll simply say that void on
destroy think that is something I I know
that on this this enabled is definitely
implemented so let's just try this and
then we want to remove it from here so
minus equals it's a good thing I noticed
this in the video don't have to clean it
up in the next one I've been trying to
wrap this up like three times it's
embarrassing let's keep going um let's
see here so when we kill an enemy no I'm
still doing it let's find out if this is
even being called here so uh let's just
throw a debug statement there we go I'm
sure we'll notice that if this doesn't
work I'm just gonna have to take a
minute to figure it out what's going on
here so okay so that is actually being
cold and I can see that oh no it's
working
that is weird behavior maybe I didn't
save it properly before if I delete this
now I might not have saved this let's
try this out one last time just to see I
might have been too impatient I didn't
understand why it wasn't working so
hopefully it does now so now there are
no errors if I destroy those guys yeah
so that's perfect that's just for good
or your sake do that under the player as
well so if this player is destroyed we
also want to remove that from the
delegate so jam that on target upgrade
menu - equal that good say that clear
that things are working now I can do my
outro so thanks for watching guys we'll
fix the rest of the upgrade menu in the
next video I'm looking forward to that
so yeah that that was all I'll see you
guys in the next video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>