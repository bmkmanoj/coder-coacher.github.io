<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>20. How to make a 2D Platformer - ENEMY ATTACK - Unity Tutorial | Coder Coacher - Coaching Coders</title><meta content="20. How to make a 2D Platformer - ENEMY ATTACK - Unity Tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Brackeys/">Brackeys</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>20. How to make a 2D Platformer - ENEMY ATTACK - Unity Tutorial</b></h2><h5 class="post__date">2015-08-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/BePP-jtrs9U" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">thanks for tuning in at brakus hello and
welcome to video number 20 in the how to
make a 2d platformer course in today's
video we're going to be touching on a
lot of different subjects but overall we
are going to finally make our enemy
damage our player and when he hits him
we also going to make the enemy explode
so that means that we will need to also
make the battle status indicator
actually work with our player to display
his current health and his max health
and yeah so we'll set that up cool but
before we get started I quickly want to
mention that I've introduced uploaded a
huge update to UPA toolkit if you don't
know what it is it's a pixel art editor
I've made so you can create pixel art
inside of the unity engine and a new
version has just been introduced which
comes with blend mode modes a bunch of
layer controls you can see here you can
now log layers lesap and opacity slider
you can duplicate and merge layers and
all that kind of cool stuff so if you
want to quickly make some sprites for
your game I suggest you download that
cool so without further ado let's head
into unity and you can see that the
scene is exactly as we left it out the
last time and the first thing we'll be
doing here is jumping into the player
script so let's go ahead and go under
scripts let's find the player script
here and this script of course sits on
the player himself and let's just zoom
in a bit on this and I basically just
want to expand a bit on this player
stats class so the first thing we're
going to be doing here is much like when
we introduced the status indicator to
our enemy we'll be changing this idea of
a health to instead include a max health
and a current health so we'll say that
max health equals 100
then we'll make a private integer and if
this is new to you you can just go back
and watch the latest video or the last
video and then we'll have a private int
storing our current health and we'll
also have an accessor for that a getter
and a setter which is a public int
current health without the underscore
and that's not going to have a default
value instead we're going to if I can
format this correctly give it a getter
and whenever we get this value we simply
want to return the current health
private variable and a setter whenever
we set this we simply want to say that
current health should equal math clamp
and the value that we want to clamp is
on the value that is passed or that is
passed in that it's set equal to and
then the minimum which is zero and the
maximum which is going to be our maximum
health so this this will just ensure
that whenever we set our health equal to
something that it doesn't go below zero
or above our maximum health amount cool
and then we want to quickly make a
public method and called in it and that
will simply set our current health
current health equal to our max health
it's that simple and you can either set
the private variable here or the non
private the accessor I suggest using the
X X accessor so that if we've messed
something up with the max health it will
let us know cool and you can see if we
just open up our enemy script here that
this isn't pretty much an exact
duplicate so far of the enemy stats
class so now that that's done I simply
want to rename this player stats to
stats because it sits under the player
object and I think that the naming is
clear enough already and woops that's
from when I was testing some stuff out
simply ignore that
and then down here in our damage player
we want to change player stats like
health to stat stud our current health
and we want to do the same here stat
stat current health and yeah now that
should actually be working next up we
want to integrate our status indicator
so remember we created this status
indicator script that basically allows
us to set the health on some GUI objects
and it's pretty easy to expand upon so
basically what we'll do here is we'll
create this could be a public because we
want to change it inside the unity
editor but actually I want to keep this
private and then just make it accessible
by marking it as a serialized field so
this needs to be a private status
indicator and we'll just call it status
indicator the small s and inside of our
start function make a start method here
we'll just check if status indicator
whoops status indicator is equal to null
and if it is we'll just throw an error
here under enemy we did the exact same
thing except we made the status
indicator optional and I think we'll
force it on to be on the player so if
it's not we'll just print out an error
message that says no status indicator
referenced on player CO and inside of
the start method we want to do one more
thing and that is in it our stats so
we'll just call the init method there
cool then inside of our damage player oh
actually we have to do one more thing if
it's not equal to null then we want to
set our GUI so we'll call the set status
indicator set health and that takes in
our current health amount so that's stat
stat
health and our maximum health so that's
that that max health awesome and we
simply want to cover this and do the
same every time we have damaged the
player cool
so that should actually integrate any
status indicator into our player object
and now all we have to do is go under
our player here and actually make the
GUI for that and for now I think we
should simply copy the status indicator
from our enemy into our player object
and reset the transform woops
wow that made it huge had simply wanted
to reset the position there we go and
then move it up a bit on the Y something
like that so it just floats above the
player something like 0.7 cool and now
we can simply select the player and drag
in our status indicator and that should
update everything so now when now we
play the game we should see our status
indicator updating to our current health
and our max of then we can test this by
going onto our player stats and changing
our max health to something like 120 and
just see if that updates and indeed it
says 120 of you don't believe me I'll
just fullscreen this maximize on play
there you go says 120 there but
currently our enemy isn't damaging us
and we simply are able able to kill him
so let's make that a bit harder also I
want to go into the enemy here and
simply disable that debug that lock
under the weapon I mean I find that kind
of annoying cool so how do we change
this well basically we have this central
enemy component and all I want to do
here is now we are going to make our
enemy damage our player on impact so
let's double-click on the enemy
and let's go under the and let's just
check out the script and basically I
want to create a method void called on
coalition enter to be and I know that
we've used the ontriggerenter before I
don't know if we've used the on
coalition enter basically unity will
make sure that if you spell this exactly
as I've done it that every time we
collide with another object this method
will be called so basically we can
collect information about what we've
collided with by saying that we it
should pass in and a parameter called
coalition to D and we can simply name
this collider info or call info and what
we can then do is we can grab the player
component of that glider info and then
we can check if that if the player
component is equal to null if that
simply isn't a player component well
then we probably haven't hit a player
and therefore we don't need to do
anything but if there is a player
component then we can call the damaged
player method so first let's just call
this player component underscore player
and set it equal to Collider in fro
collider.com ponent of type player then
we check if there is a player component
so if on the scroll player is not equal
to null then we can say player dot and
then we can say damaged player and we
can input a damaged amount so but in
order to input an amount we need to have
a variable and let's add that into our
enemy's stats so let's just make a
public integer called damage and we
don't really need a get set for that we
will however give it a default amount of
let's say um 40
cool so now down here all we need to do
is simply say stats dad damaged a little
passing the damage that this enemy does
awesome and that's basically as far as I
can see that's all we need to do so far
in order to damage our player so if we
hit the maximize on play and start
playing here we should see that the
moment our enemy collides with it as our
health should go down and indeed it did
so let's try that again
there you see cool but currently nothing
happens to our enemy it will just stay
then maybe move a little bit and maybe
hit the player a few more times but the
effect isn't really that epic so what we
need to do here is we need to simply
kill off our enemy the second that it
has killed our player so if the it is
our player we've hit we damage the
player and we then simply damage the
enemy by like a very big number just
type in a bunch of nines here we could
also just call the kill enemy if that's
what you wanted to do on the game master
object but I like doing it through the
damaged enemy method because then we can
add sounds or whatever custom logic in
here without having to do it separately
cool so we simply damage our enemy so
now whenever he hits our player he will
self-destruct cool so that's basically
the foundation of what I wanted to do
today but I also really would like if
our player or if our enemy Suffolk's
exploded in a by spawning a particle
system and also if our camera if we
apply the camera shake every time that
happened so in order to do this all we
need to do is go into our scripts oops
scripts
and find our game master object because
this is responsible for killing off both
the player and the enemy so this is kind
of the place we need to be in order to
add this functionality and you can see
that currently we are simply using this
public static void call kill enemy which
just destroys our enemy object but I
would like a local uh method a non
static method that sits on the GM object
so that we can use some variables such
as using some particles of reference to
those and also have reference to our
camera shake so in order to do this we
basically need to call a local method an
instance method through this static
method so first off let's add some
variables the first one is going to be a
public and that when we are going to add
a transform and we're going to call this
enemy death particles we also need a
public camera shake remember we created
that in an earlier video and we'll
simply call this camera shake and I
think I'll bring this up because we
might use this in several contexts so
I'll just bring it up here because it
doesn't necessarily have anything to do
with our enemy dying and basically all
we need to do here is create that local
method and I think I'll just create it
under the static one and it's just going
to be a public void and I'll do
underscore kill enemy to really signify
that this is local and not static and
then we simply want to pass in the enemy
as a parameter and I like I've
introduced this naming convention of
using an underscore when you ever you're
passing passing in an argument and so we
can move this destroy enemy game object
down here and then here we simply want
to say
a GM dot our kill enemy oops
GM dad underscore kill enemy there we go
and if we want to stick with the same
naming convention here let's do an
underscore in the respawn play - there
we go
and of course when we are calling this
we need to pass in the enemy and down
here we need this to be underscore enemy
so now we've set up the system where we
have this static method that we can
easily call and that calls the local
method that we'll be able to access
these instance parameters awesome so
basically now what we can do is we can
instantiate our enemy death particles at
the position of our enemies so enemy dot
underscore enemy dot transform dot
position and just with zero rotation so
we'll just do quaternion dot identity
awesome and also we can apply some
camera shake so we'll just do camera
shake dot shake and we want to shake a
certain amount depending on the enemy I
think it could be cool if like big
enemies died in this huge explosion and
smaller enemies died in another one
actually we should make several separate
death particles depending on the enemy
that would be way cooler so let's just
remove that and just keep the camera
shake here and then let's go into the
enemy here and let's give him a death
particle you could do this under enemy
stats or you could just do it here I
think I'll just do it here instead of
going through the stats but we simply
need to add a public transform called
death particles like this and do the
same in and inside the enemy stats we
need to add a
public float with the shake amount I
will default that to 0.1 and a public
float with the shake length will also
default that to 0.1 put in an F there
and that should be all we need then
instead side the start method will
simply check if our death particles is
equal to null then debug dialog error no
death particles referenced on any cool
so now inside of a game master all we
need to do is called camera shake that
shake and will input the underscore
enemy dot whoops enemy dot stats
actually I don't want this inside of the
stats I think this should be inside of D
of the gist enemy class so let's go back
here
enemy dot shake amount and the enemy
dark shake length and here instead of
the enemy death particles will simply
make that specific by calling it through
the enemy so we'll just get the depth
particles there so now we can have
separate shaker mounts shag lengths and
death particles for every enemy that we
create now the only thing I want to do
here lastly is just a check where we say
void start I just want to check if
camera shake is equal to null then we
want to complain that no camera shake
reference
in game master cool that should be every
all the code that we need to do find out
at least let's look at the alien
spaceship and see that we now have an
spot for the death particles a shag
amount and a shake length so now I want
to go ahead and create a particle system
that we can spawn whenever we die so in
order to do this let's right-click in
the hierarchy let's go under and let's
just select particle system let's focus
in on this on the scene let's reset the
transform and let's move it up a bit so
we have some space where we can play
around with it let's set the duration to
2 and the start lifetime to 2 let's go
into emission and change the rate to
zero let's go on the shape change the
type or the shape to sphere and let's
change the radius to something like 0.2
and we want to emit in a random
direction let's now add a burst here of
about 30 particles you can see that
currently they just go out in this very
huge sphere like formation so let's
change the start speed to be random
between two constants that's going to be
between our 10 and 20 and you can see
that's kind of a lot right now but what
we also want to do is we want to limit
the velocity over lifetime we want to
dampen it by 0.1 and we want to set the
speed to be equal to a curve that starts
at 1 and then whoops and then goes down
to like about 0.5 and you can see that
this gives a pretty cool explosion look
where everything just very quickly slows
down you kind of course adjust how much
you want it to slow down this might be
better actually
cool so now that we have that in place
we could actually I want to damp this a
lot more let's do Siro point - that
looks pretty nice and this is all about
just adjusting the values to what you
want to see this looks fine for now we
can then add a gravity modifier so if we
give this as gravity scale of 1 I think
that's a bit too much let's try
something like 0.3 still a bit too much
for my taste I think 0.15 might be good
yeah that looks pretty awesome cool then
next up we can go ahead go ahead and
create a cool-looking material for this
so let's right-click in the project go
in the material and rename this to
additive and I will change the shader
from standard to particles additive and
as the texture will select the default
particle for now you can of course use
any kind of texture and be nerdy about
this there are also a lot of cool
looking free particles on the internet
or a lot of good assets at the unity
asset store if you wanted to really get
serious with your particle systems but
then we want to drag this into the
renderer material so actually apply that
you can see that already looks it makes
it look a lot cooler then we can go
under the size over lifetime and just
make this shrink down not too much just
shrink a little bit that looks pretty
good let's also randomize the start size
so make that rent number two to between
two constants and I want that to be
between maybe one point five and one
which looks pretty good and next up I
want to go under the color over lifetime
and make sure that they very quickly
fade in and slowly fade out that looks
much better also we can maybe change the
start color here to a very yellowish
color very bright and then the end color
to something more red so it will like
fade like sparks that looks actually
pretty nice we might limit the ah the
velocity even more strides Eero point
three point Q I don't know you can play
around with this as much as you want I
mean it's really just about messing
around with the values until you get
something that looks right you can play
around with how many you want to
actually emit but I think we are just
going to use this for now and we'll call
these alien spaceship odd death
particles and we'll drag them under the
prefabs folder there we go delete them
from our scene and also make sure to
select the prefab and uncheck looping
and then we can simply select our alien
spaceship and drag in the particles
there and also I just remembered that if
we go under our GM object we want to
tell it to actually kill this off after
a certain amount of time so let's just
quickly do that let's store this firstly
in a
as a game object I will just call this
clone equals into ng blah blah blah as a
game object and then we simply want to
call destroy clone after five seconds
see if that works
cool and now that we are actually ready
to play oops no camera shake referenced
in game master it's very nice that we
actually made it
give us error messages like that because
they are very important and once your
game gets bigger so we'll simply find
our final camera shaking and drag it in
let's try that again
and you can see our enemy explodes and
our camera shakes and this will also
work if we kill him by shooting him so
that looks very nice so now we finally
have a game where our opponents can
damages and where we can kill off our
opponents and it doesn't look horrible
so let's hit apply on the TM object
apply on the spaceship and apply on the
player and just for fun let's drag
around some spaceships duplicate these
and see them in action three two one
cool so that was the ending of this
video I hope you enjoyed it and I'll see
you in next one</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>