<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How many AI Agents can Unity handle? | Coder Coacher - Coaching Coders</title><meta content="How many AI Agents can Unity handle? - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Brackeys/">Brackeys</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How many AI Agents can Unity handle?</b></h2><h5 class="post__date">2018-03-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/G9Otw12OUvE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I think one of the coolest things in
computer programming is AI in particular
AI that can be taught how to navigate
and move around a 3d world
I love playing around with path finding
and setting up challenges for my little
agents to solve in this video i'll be
putting nudity's building AI solution to
the test let's see how it does so first
I set out to build a maze for my testing
to take placing after having looked at a
bunch of different maze layouts I
decided to go with a classic
a traditional pac-man level after
finishing my model in blender I set up a
basic nav mesh using the new nav mesh
tools which are available on github I
then created a few agents with standard
settings as well as a simple script to
control them all that did was to tell
the agents to move to the same location
on the other side of the maze using the
shortest possible path to no surprise
the test ran smooth however because of
the grid like nature of the maze some
agents could run straight through so
quickly modified the level to avoid this
now it was time to start adding in more
agents here's a test with just over 200
still everything was smooth but I found
it hard to keep track of each agents
position so tried adding random colors
to make them different from each other
from looking at it I noticed a few
things first the agents tend to clump
together it seems that even though each
of the agents are said to continuously
look for better paths the queue up
instead of altering their route which
ultimately slows them down second it
looked to me like the agents in the back
was first to reach their destination
where's the agents in the front took a
while to get going to confirm this
I colored each row differently and just
as I thought the yellow agents in the
back were much faster but they also
seemed to start first it looked like for
some reason the agents were starting
one-by-one from the back to the front a
quick look at the documentation provided
an explanation for this behavior when
setting an agent's destination that
agent will start calculating a path in
the background
once a path is found the agent will
start moving so the agents were probably
moving one by one because the navmesh
system only calculates so many paths at
once to confirm this I wrote a quick
script that would update the color of
each agent depending on its current path
status and indeed the agents would turn
green and start moving as soon as a path
was no longer
now of course I wanted to add more
agents but as soon as I got near 400
things started to slow down so I opened
up the profiler to try and find the
culprit and to my surprise 75 percent of
CPU usage was currently being spent on
rendering while actually updating the AI
was only taking around 6% to make the
agents render more effectively I gave
them all the same material and enable
GPU instancing I also made sure to
disable vsync under the graphic settings
and voila CPU overhead went from over 60
milliseconds to only 6 next I wanted to
make all the agents start at the same
time to do this I wrote a custom script
that would loop over all the agents and
calculate a path for each one then once
all agents had a valid path I would
apply them all at once the result was a
smooth simulation of 400 agents but that
wasn't enough
I wanted more so I expanded the maze and
bumped it up to a thousand then 5000 at
this point my computer was starting to
slow down but before moving on I wanted
to try making some modifications to the
maze to see how the agents would react
so tried adding a wall with a hole in
the center I also tried adding a
secondary hole to the side as expected
to split the army into those close to
the side and those closer to the center
now of course 5,000 agents are plenty to
do lots of testing with but as I always
try to tell people when they want to get
into game development the most important
thing is to have fun so I made the maze
even bigger I also downloaded a
framerate counter from the asset store
and started tweaking settings to see if
anything which make this simulation run
smoother I created this spreadsheet to
keep track of my findings as expected
all settings related to baking the
navmesh had no effect on runtime
performance so I quickly moved on to the
18 component itself here tried messing
around with a bunch of settings but the
only thing that really had an impact was
obstacle avoidance turning this off of
course meant that the agents wouldn't
avoid each other but it did improve my
framerate by about 40% I also tried the
different obstacle avoidance qualities
but was surprised to see that the
different was no more than a couple of
frames at this point I just wanted to
squeeze as much performance out of unity
as possible so I tried configuring
rendering settings and even playing
around with custom path findings
illusions such as a star I was impressed
to find out that unit is built in
navmesh tools were still the fastest way
to go however I will say that this might
just be due to my limited knowledge of a
star finally by building the game I
managed to get the simulation running at
27 FPS and so it was time time for ten
thousand a I agents of course the
simulation wasn't smooth
in fact even as a standalone build it
was only running at around 10 frames per
second but still it was wonderful to
witness this swarm of
computer-controlled robots mindlessly
moving through the maze now I decided
that 10000 might finally be enough but
that doesn't mean that wasn't room for
more fun so I created an army then an
army of cacti finally I thought what
would be more suiting to end the day
than hundreds of wild running horses I
know how about hundreds of wild running
horses riding towards the sunset
perfect
thanks of the awesome patreon supporters
who donated in February and a special
thanks to encode we trust
Patrick McKinley Diego kike Frank
Tristan town donggyun Murphy Oh infinity
PPR yo Rio myrrh and soft tune sighs mom
eat turkeys Kirk face on Murphy beard or
die
DoubleTap 45 James P J delay Superman
the great John ProGuard
Dennis Sullivan Jason Latino Alex wicked
ski beyond Photo Club Sweetland swell
enough gin
Sasha hafsteinn Sunni Arabs and Gregory
Pierce James Rogers Robert Boone Durman
Rob fan and Erasmus you guys Rock</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>