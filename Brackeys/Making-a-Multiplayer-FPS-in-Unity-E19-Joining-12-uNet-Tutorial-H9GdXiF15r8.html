<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Making a Multiplayer FPS in Unity (E19. Joining 1/2) - uNet Tutorial | Coder Coacher - Coaching Coders</title><meta content="Making a Multiplayer FPS in Unity (E19. Joining 1/2) - uNet Tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Brackeys/">Brackeys</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Making a Multiplayer FPS in Unity (E19. Joining 1/2) - uNet Tutorial</b></h2><h5 class="post__date">2016-07-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/H9GdXiF15r8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">programming stuff thanks for tuning in
at brakus hello everyone and welcome to
this video on making a multiplayer FPS
in unity
today we're going to be creating a
server browser that will list all of the
currently available rooms along with the
name of the room and the amounts of
players currently in that game so that's
going to be really fun also thank you so
much for helping us reach level 1 on the
patreon page the first goal has been met
and that means that I can now guarantee
two videos every single week that I'm
going to be uploading at least for now
Sundays and Wednesdays and of course
this schedule might change in the future
but two videos a week
should be it so that's going to be
really really exciting also if you want
to get over there the patreon page is of
course very much still running and I
hope to get a lot further the next goal
is live streams where we can do some
exciting Q&amp;amp;A stuff I can help you out
with your games and answer questions and
also we can do some live development
that would be really fun also on that
goal is maybe a game math series so kind
of math essentials for game developers
that's another thing I really want to
create so if you want to see those
things head on over to the patreon page
and yeah without further ado let's get
started so you can see I'm here in unity
and basically what we did in the last
video once we set up this host game UI
and what we can do now is simply
duplicate this object and then we'll
rename this to join game and we can take
this join game object and simply move it
over by clicking and dragging holding
down shift to only move it in one axis
and we can now open this up and go and
rename this to join game title and then
I'll change the text as well so this is
going to be joined game and we can
remove the input field here but we can
also reuse the create room button so
this is now going to be our refresh
button and it simply of course going to
refresh our server list and we can maybe
disable our on click event for now and
to preferred height to something like 40
just to make it a bit less in-your-face
and then we can change the text itself
here to say refresh perfect and in
between the join game title and the
button is where I want a scroll view
that will contain all of the different
room list items so let's right click on
the join game here go in the UI and then
scroll view and we can now now drag this
out and drag it back in to position it
correctly and we want it to be there
under the join game title and then we
can go in here and add a component and
this is going to be a layout element and
we want to go and do preferred height
and set this to something like 400 and
the great thing about a preferred height
is that it's going to try and remain at
400 no matter what we do unless it runs
out of space and then it will shrink
itself to fit
so that's do a really great way to think
about these preferred values instead of
just setting a minimum in which case it
will just go without the confines of the
screen and look super weird so it will
just get cut off
cool so inside of this scroll view we
are of course going to have a bunch of
different server list item objects
sitting there and we want the scroll
view to take care of stuff like fitting
everything in here and allowing us to
scroll down if we need to for so that's
going to do all of that but scroll views
can be a bit funky and a bit confusing
at time so I'll try and explain this
carefully so we have a scroll scroll
view itself here and this is going to be
our server list or maybe we should call
it our room list and then scroll view
and under the scroll view we basically
have three different things we have to
scroll bars a horizontal and a vertical
and a viewport which contains all of our
stuff so this contains our actual
content and the content object is all of
the things that we want to display
within our
scrollview and we basically want to
parent all of our list items to this
content our object and what I want to do
is I want to have this content object
resize itself to fit the size of all of
our list items combined and we'll do
that in just a second but first what we
can do is we can disable our house
horizontal scrolling on the scroll rect
component and that means we can also
simply remove our horizontal scrollbar
and that just cleans up this our scroll
view just a bit then what we can do is
we can find our content object and we
can add a new component to this call it
vertical layer group I'm really a big
fan of vertical layout groups as you can
see and that means that we can just
right-click our content go on the UI and
make a new button and then maybe just
drag this out and drag it back in and
you can see that our button has now been
positioned automatically however I don't
want this button to just scale out to be
some kind of huge size I want this to
have a fixed size and I want our content
to scale to that size so what I'll do is
go under button add component layout
element choose the preferred height of
let's say 30 is good I think
and we'll also go under the content and
disable child force expand on the height
so that now has fixed that problem
however our content is not yet resized
so all we need to do here is add a
component called content size video and
that will if we choose vertical fit
preferred size scale it to the preferred
size of our elements that are parented
to this content object so if i duplicate
this button to make another one you can
see that our content now resizes to fit
that button as well and I can go ahead
and do this a bunch of times and you can
see that we now get this on I scrollbar
feature enabled and if I hit play here
everything will resize to look nice
however this scrollbar sometimes can add
a bit act a bit funky and all we need to
do now is go ahead and find our vertical
scroll
bar and we you can see it's for some
reason it's set our height to zero so
we'll just bump up our height here and
then we can take this object and we can
move it to the top and then we can drag
it all the way down to size it there and
then we want it to scale with the height
here so I'm going to select scaling on
the height and this is on this is the
one here so now we should be able to hit
play and you can see that I can now drag
down here to see all of the different
buttons and I can also drag on the
object itself and I'm just going to go
ahead and get rid of this I network
manager network manager Hut there so
just disable the runtime GUI for now so
you can see that now that just works now
and it's even hidden even has this nice
elasticity to it it's it's kind of nice
to use great so let's delete some of
these buttons here and just focus on the
first one and I'm going to rename this
to our room list item this is going to
be a single room item and it's going to
have the name of our room the amount of
players in that room and some kind of
way of telling the player to click it if
you want to join it so the first thing
that I want to do is kind of send our
text to the left here and then just
bring it out just a tad from the side
and this is going to be the room name
and then it's going to say like this
maybe two out of six and that's going to
be of course the amount of players
you're gonna have that as a separate
text object I'm just going to have it in
one and then I'm going to rename let's
just keep that as text that's fine and
then we can duplicate this text object
and we can call this one the click to
join text and all I want to do here is
simply move it over something like here
and then I want to have this snap to the
right there we go and move it out just a
bit and this is the click and I'm going
to put this in parenthesis actually
click to join and we want to make this a
lot smaller something like maybe twelve
and I want to make this italic as well
so that looks pretty nice then it shows
that on all of the buttons so that the
player is sure that he just needs to
click the thing to get in there
so that's great and we can now take this
here and turn it in to a prefab by
dragging it into our project panel I'm
just going to drag it out here as long
as I'm working with it and then we'll
sort it in to the prefabs folder later
good so that was actually the essential
UI we need except one small thing and
that is something that is kind of
optional but that I would really like to
have so we can now delete this room list
item and that is some kind of status
text object that shows us well we are
currently loading all of this stuff or
we are currently joining a game whatever
so when we're not displaying all of the
servers that the user can choose I want
to have some kind of feedback for the
user showing what is currently going on
so to do this what I want to do is go
under our actually let's just do this
from without the scroll view where maybe
we can put it inside of the scroll view
but not inside of the content so just
something like here and we can put a UI
object here and it's just going to be a
plain text object and I want to snap
this to the left corner here of the left
corner and have it sit somewhere around
here with the font size of 16 a color of
completely white and this is going to
say maybe loading dot dot or something
like that so that's really easy to use
and I'm just going to remove the text
here so it's nothing by default unless
something is happening and this is going
to be our status text so that's perfect
and now we can go ahead and hook some of
these up to a script so the first thing
that I kind of want to do is have a
joint game a central script for joining
a single game and we could have this sit
on the network manager but we are not
going to need the join game on script in
other scenes and
and that's why I thought that it would
maybe just have its it easy on the joint
game do I object or maybe on a separate
object in the hierarchy so let's go
ahead and create an empty here and we
set the transform on this and we can go
ahead and call this one ah let's just
call this one join game and it's going
to have a script that as well says join
game so that all looks fine and dandy
and what we can then do is maybe open up
the script in Visual Studio and this is
going to be a fairly long one I can see
by the timing that I might have to split
this video up into two but we'll just go
ahead and get started with this anyway
so we are here in Visual Studio alright
and first off we're going to be needing
a bunch of namespaces we're going to be
using unity engine of course and then
unity engine dot UI because we want to
be messing around with some text objects
then we want to use system dot
collections dot generic because we're
going to be using generic lists then we
want to be using unity engine dot
networking we are going to be using some
networking functions and then finally
unity engine dot networking dot match
because we are going to be using match
info or in match description is what
it's called to be more specific so
that's perfect and what we want to do is
first of all set up some kind of
reference to our network manager so this
is just going to be a private network
manager called network manager and we
are going to set this in the start
method where we're going to say network
manager equals network manager dot
singleton and then we want to check if
network manager dot matchmaker is equal
to a null well then we want to say
network manager dot is it create match
or are its start matchmaker
so start matchmaker there we go just to
make sure that the matchmaker is
actually set up before using it so we
did this in the host game script as well
right
so you can just duplicate that code if
you want to then next up we are going to
what the very first thing that we want
to do is basically just refresh our list
and this is also the very central
function that we are going to have is
some kind of refresh our room list or
you could simply just call it refresh
whatever you want to do here I'm going
to call this refresh room list just to
be as specific we're naming my method as
impossible and of course we need a list
of rooms to refresh so I'm going to have
a list here and it's going to store a
series of game objects you could also
make these transforms but I'm just going
to do game object and this is going to
be a room list and it's going to be
equal to a new list of game objects
there we go okay and that's the first
thing that we want to create here we're
going to have more variables people do
them those in a second and we're going
to have a pour a public void and we want
this to be public call refresh room list
we want this to be public because we
want to call it from a UI button so
that's therefore we needed to be public
because when we drag it into the on
click event we need to be able to see it
good so on the actual refreshing here is
actually fairly simple we are going to
go to our network manager so find our
network manager here go on to the
matchmaker and then we want to list some
matches and this takes in a series of
arguments we are going to have this dot
page number and this is if you have
multiple pages I'm just going to say
zero then we want the page size and in
our case this is going to be 20 so we'll
just list the first 20 elements and then
we'll have a match name filter this is
for searching we don't want to do that
and then we want a call back back method
and this is a method that will be cold
as soon as it's found a list of matches
and we are going to make one cold on
match list we're going to make this
ourselves and then we want our status
text so
we need a reference to our status object
so we'll go up here and we'll make a
public actually let's make this a
serialized field so a serialized field
private on text object then we'll call
this one our status and we'll go down
here and we'll say status dot text
equals and we are now loading some
elements in here and then in the on
match list we can set this back to
nothing because then we have indeed
succeeded in loading these and are now
displaying them so we'll create a void
and I actually believe this is this has
to be public so on match list and this
is going to take in a list match
response and we're going to call this
the match list and what can we do with
this well first off we want to set
status that text equal to nothing and
then we want to say if match list is
equal to null well then we haven't found
any matches whatsoever it's not that
only that we haven't found any matches
it's that we weren't successful in
retrieving a match list and then there's
definitely something wrong here so maybe
we should in that case that our status
takes to couldn't get matches something
like that
or you couldn't get room lists something
like that would be fine and then we can
go in and simply return because then we
basically can't do anything so this is
only this is probably only going to
happen when you have some kind of
connectivity issue and then it's
something that the user should resolve
so next up we go into our clear all of
the rooms that are currently in our list
so we want to call some kind of clear
room list method and let's just go down
and make this right away and this can be
private so we're going to make a clear
room list and it's not going to take in
any arguments whatsoever and what we
want to do here is loop through all of
the elements in our room list so for int
I
is less than room list dot count and
then we want to of course destroy that
object so you want to destroy room list
I and that's already a game object so we
don't need to do anything here so we'll
just remove that object from our we'll
have all of the objects object sit on
your content and in our case we'll just
remove that object right away and then
we want to clear our list so then we can
go room list dot clear because just
because we remove the object that is
referenced in that list that doesn't
mean that the reference is removed from
the list we need to do that separately
and we do that by calling this function
here so just remember to do that great
so now that we've lived through all of
that and removed all of the elements we
can go ahead and now add in some new
ones and in this case we are going to
loop through this match list response
and what is the match lit match list
respond well it's a JSON response full
list match request and that makes that
that means that it's basically just pure
data containing stuff like the name of
the matches how many matches and all of
that stuff so it's just a list of pure
data that we can convert into something
that we can use inside of c-sharp and in
our case we are going to convert some of
this stuff into actual objects and I'm
going to show you how to do that so
basically what we'll do here is we'll
say for each match description because
this match list actually just has a
series of matched descriptions just
single match info objects and we're
going to call each of these match in
match list dot matches there we go and
then we can say and so for each match
that we found we can go ahead and make a
new
object so we'll make a game object here
and we'll call this the room list item
game object and set that equal to a new
object that we will instantiate here and
in order to do that we need a prefab to
instantiate so what do we want to
instantiate well we want to have up here
another serialize field and this is
going to be a private game object and
this is going to be called the room list
item prefab and there we go so that's
what we want to instantiate here and we
don't need to set any position because
we'll have our content or our scroll
view set that for us so that's fine and
all we want to do is simply parent it to
that scroll view so we'll have to have a
reference to the scroll view itself so
we'll have a civilized field here and
that's going to be a private transform
and this is going to be called
maybe room our list parent and all we
want to do down here is now that we've
created this on list item we want to
parent it to our room list parent so we
will simply go room list item geo
transform sit parent to our room list
parent there we go and next up I think
we'll just skip this next step just for
now I think because what we want to do
here is now have a component sit on the
game object that will take care of
setting up the name slash amount of
users as well as setting up a callback
function hang in here that will join the
game okay so basically what this means
is we need to have some kind of way of
setting the name equal to the match
setting the amount of users that are in
the room and we also need a way to know
that if we press that button it's going
to join the correct room so we need a
way of knowing what room to connect to
when a button is pressed and we do that
using a callback function and we'll
create all that in a second so the video
got kind of long and I had to split it
up into two parts we covered a bunch of
stuff in the second one so click the
screen now to be taking there as soon as
it's ready and I'll see you there so I'm
going to start mentioning patreon
supporters the following month after
they donate so that there won't be any
difference from donating at the
beginning of the month to the end of the
month this way everyone will get a full
month of mentions and yeah everyone will
be happy so just wait for the next month
and you will see your name here so
thanks for watching and I'll see you
soon</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>