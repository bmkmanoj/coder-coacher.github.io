<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>19. Unity Tutorial, ENEMIES V2 - MAKE A GAME | Coder Coacher - Coaching Coders</title><meta content="19. Unity Tutorial, ENEMIES V2 - MAKE A GAME - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Brackeys/">Brackeys</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>19. Unity Tutorial, ENEMIES V2 - MAKE A GAME</b></h2><h5 class="post__date">2015-02-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Lah76V16cGI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">thanks for tuning in at brakus hello and
welcome to video number 19 in make a
game a cool series on making a video
game in unity so in today's video we're
going to continue where we left off last
time by making some enemies and I've
made a list of what we're going to go
over today I hope that we can do most of
this stuff we might not be able to do
all of it so I might have to split this
up into several episodes but we'll have
to see with that we'll just go as
quickly as we can so first off we're
going to add some velocity to our player
whenever we jump on the enemy's head so
just like in mario we will jump back up
again
then we're going to add some particles
whenever the enemy dies we're going to
be doing a bit of restructuring in the
way that we have things set up right now
for example I would like the game
manager to manage the level restarting
and all that instead of having that
function inside of the ball health
script then we're also going to kill the
player whenever he doesn't manage to
jump on top of the enemy so when he
collides with the sides and we're going
to fix some bugs most prominently the
we are going to do something with moving
our camera update script into a later
update function instead and I'm going to
show you what that does cool so that is
the list of things that we are going to
do today and then in a future video we
are going to add a cool model against at
sameen Ivan is going to take care of
making that and we're also going to add
some animations to that model cool so
let's get started with the first point
here adding velocity to our player as
always if you have any questions
throughout this video or something that
just won't work you can just head over
to forum drag is calm and I among many
other developers so just ready to answer
your questions there I mean I very
rarely see a threat go unanswered cool
so let's move into unity
as you can see the scene is exactly as
we left it off the last time I've just
gone ahead and moved the checkpoint over
a bit because before it was right above
our enemy and so when I died I kept
falling on top of the enemy so I'm
simply going to move it over here just
to where we start in the beginning cool
so what I'm going to do here is first
off we need to have a look at how our
enemies is currently set up so we have
these this trigger box down here which
takes care of the the killing of our
player and we have this trigger box up
here which takes care of the enemy dying
so that's called the hitbox and the
other one is called the kill box and as
you can see the hitbox currently has a
script called iron hit and if we open
that up it simply calls a function on
the enemy called die and that takes care
of the enemy dying but what we want to
do here is whenever our enemy dies we
want to also have some kind of access to
our player so wet so that we can apply
some kind of upwards force to him
because right now if we have a look at
our enemy script right here that is on
the enemy Center then you can see that
we are currently just destroying the
game object we don't have any reference
to our actual player inside of this so
what we can do is we can simply make a
variable for that so we can make a bar
player and we can make it up type
transform or game object that's up to
you I'm simply going to make it off type
transform and then inside of this
function we can simply type player dot
rigidbody actually let's make this
variable up here of type rigidbody so we
don't even have to access the rigidbody
down here because the way we apply
forces in unity is using a the rigidbody
component which if you remember is what
makes this act as a physics object in
game
and then we can access different
functions and parameters inside of this
rigid body by doing the dot and you can
see that we can add some force we can
and and that force you can tweak quite a
bit we can add torque for rotational
force and then we have a bunch of
different parameters we could add a
force here but what adding a force means
is that you are applying basically a
push in a direction but if you're
already traveling with a certain
velocity in the opposite direction the
force won't be too visible and that's
basically what we're doing here because
the ball is going to be falling down so
it's going to be falling with a certain
velocity on the y axis and once we add
the force we basically have to compete
with that already ongoing velocity so we
have to trick our force or we have to
kind of tweak our force to such a degree
that we can kind of predict with what
force we are coming in and then apply
maybe double that in the other direction
but if we then fall from a very high
point then we come in with a lot of
force
it might not act as we wanted to so what
we're going to do instead is we're
simply going to directly change the
velocity that our ball is moving at so
to do that we do rigidbody velocity and
then we access the Y component dot Y and
you can just do it like this in
JavaScript it's a little bit more tricky
and c-sharp but it's really not not that
hard either and we can equal this to
whatever value we want and let's store
this value as a variable two so we can
tweak it however we want so we're going
to do a bar and this is going to be cold
maybe what are we going to call this a
bounce amount maybe and we can equal
this to let's say 10 F by default I
don't really have an understanding of
how much this is going to be very simply
going to do that and equal it to bounce
around now we can save this we can hit
back into unity and select the enemy
Center now you can see that we can drag
a player onto here so that's what we're
going to do I'm going to drag our ball
onto that and what you can see now that
once we jump on top of this this is
hopefully going to work please work
oops I hit it wrong there as you can see
I still have to tweak the colliders bit
oops this is definitely not working so
we are apparently getting some kind of
error and I don't really know why this
is causing us to crash it looks like my
version of unity simply closed down
there so I'm just going to check up on
this Center and I'll see you in one sec
okay so I'm back it looks like the
crashing of unity wasn't actually
because of our script but I can see now
that I had apparently forgot to turn
Dropbox sinking off and if you're using
Dropbox to sync your projects you should
really remember to do so because it can
mess with the temporary files then the
unity creates a long way however we did
have an error in our script and you can
see that it throws one here and it's
because if we open up the script here
you can see that we are trying to access
access a rigidbody on the enemy century
we of course need to do player dot read
your body down velocity for this to work
so now when we play again remember to
assign the players who are important you
can see that if I jump here
I really need to learn how to time these
we're going to try that one more time so
if I jump on top of the box here
you can see that we jump up in the air
so we have that kind of bounce effect
that is so called in the Mario games and
of course you can tweak how much you
want the ball to jump as of it as an
effect of that cool so that was the
first thing on our list that was adding
velocity to our player one thing I do
want to check however is that we can
maintain this a connection to the player
even though our player dies for some
reason so if we restart here you can see
that it's very important that our ball
is still is still connected here and
that brings us to the next error it's
one that I found here when messing
around with the script here if we just
jump off the edge here right away you
can see that we fall down and I think
the R is the reason why is if we go into
our checkpoint script simply double
click it here
you can see that we are making this
reached point and then we are first
setting it to something new whenever we
actually collide with a checkpoint so
and by default when making a variable up
here this is going to be equal to zero
comma zero comma zero so vector threes
instead initiate with a default value of
zero point zero point zero and if we
make an empty object and set the
position to zero comma zero comma zero
you can see that it puts this right here
which is where we then respawn so a
solution to this is to find your
checkpoint like I did here and just move
it over and that's the easiest way which
has showed you before as I just kind of
wanted to show you that but one thing
you can also do is you can set this to a
default value of some kind so we can say
that this should equal vector three and
inside of this we can then put maybe 0
comma 2 comma 0
and that's going to just put us with two
units up in the air
really sure see game over
yes indeed it is so that's completely up
to you if that's something you want to
do I'm simply going to put our
checkpoint over here and also just leave
this as a security measure cool so now
that we have our jumping added here we
can remove that from the list and we can
go on to maybe the most fun part I think
which is adding particles whenever our
enemy dies so to make this look more
cool we can also add some sounds in the
future but I think that comes with a
model and animation and all that so for
now we're simply going to do some
graphics and this particle system here
we are going to create from scratch so
let's go under game object particle
system you can see that ads run right in
let's drag this under enemies center
then reset the transform just so we can
see how this looks over here and then
drag it out again because we don't want
it to be a child of the enemy center and
then what we can do is we can maybe move
this up a bit so actually let's not
rotate this let's instead change the
emission in here and the shape in here
so I don't want this to emit in a cone
currently it's you can see it going out
in this cone kind of shape instead let's
try out with a sphere so it just goes in
all directions or you can maybe do a
hemisphere as you can see it's just like
this half circle that we've extended out
now we can rotate this so it goes
upwards looks better and actually I'm
just going to go with the sphere I think
that's going to be just fine and what we
are going to do is you can make this
emit from shield but I think that this
emitting from any direction is fine um
how are we going to make this a smaller
point something like that and then we
can have you can put on random direction
I think this is going to look just fine
we are how are we going to change the
emission rate so we're going to put that
zero and then instead do a is a bursting
system so we're going to add a burst
here and we're going to bump up the
amount of particles to maybe something
like sixty and I'm going to bump down
the duration that this lasts for it to
loop faster so we can see it so I'm
going to bound that bump that down to
three actually I'm going to do two and
then we want to change the lifetime of
this particles to something like maybe
one or two I'm just going to do one you
can see this already looks much better
and then what we can do is we can change
the speed from constant to a random
between two constants and we can maybe
do between how to narrow one and eight
let's try that so that it isn't so it's
a bit more randomly scattered is what
I'm trying to say and then we can maybe
bump down this size a bit and maybe even
make that random as well so we're going
to do a random between two constants and
we can do zero point two and actually
I'm just going to do one here looks
pretty nice we can see it from the game
view also how it looks currently it
looks a bit random maybe this is a bit
too small we can do 0.5 instead I like
that much better then we can maybe add a
bit of gravity this is up to you if you
want the particles to travel down I'm
actually not too fun of this whenever
you're doing particle systems like this
it's just a bunch of tweaking you just
need to try out all the different
parameters see what works for you in
your particular situation there's really
no rule for making these particle
systems looks awesome it's always just a
lot of messing around so and I of course
expect you to go through this much more
thoroughly than I do
I just very quickly try to show you what
the different parameters does and then
do and then you can you can make
something cool out of that
so what we're also going to do is we're
going to do color over lifetime and size
over lifetime so first on the size
matter here we are going to make them
shrink down over their lifetime by some
amount this is this looks pretty good I
think and then color over lifetime we
want the Alpha value which is this up
here to simply just fade out and only
want that to happen in the last
percentage here so I'm going to put an
extra note here so that it only has this
short fade-out time and then what we can
do is we can change these particles from
the current look to an additive look and
that that's pretty nice
so we can make a material for them
actually we already have this glow
particle so I can just duplicate that
and make this into maybe enemy death
particle and then we can select the
particle system again we can go on the
render and we can drag the enemy death
particle in here and then we can change
the color a bit maybe we can make this
more red actually let's just make this a
solid white color maybe with a bit of
alpha transparency and then inside of
the color of a lifetime is where we want
to really change this so we can maybe
make it start out red and then we can
give it maybe a more yellow color over
here we want it to look pretty cool kind
of like we just collected something that
we really want so just give this
rewarding field to the player and again
this is not going to be pretty in this
video because I have a lot of stuff that
I want to show you so the last thing we
could do over here is limit velocity
over lifetime and what this is going to
do is really give us that explosion kind
of look where it's going to move really
fast in the beginning and then damp and
slowly slow down so we get this sense of
it emitting from one point and then just
slowing down into space and to do this
we are going to change the diamond
amount down
or what I think I'm going to leave that
at something like 0.24 and then maybe
bump up the speed a bit I think that
looks pretty cool actually we can do a
curve when it comes to the speed here to
make them kind of slowed down as you can
see and I think that this actually takes
actually exactly what we want and then
maybe we can change the start speed up
here instead of doing eight I want to do
maybe 20 so we really get this explosion
kind of look I actually think that looks
pretty awesome and I think we're just
going to go with this for now we can
also head back later and change it if we
don't like it so we are simply going to
call these enemy death particles and
we'll make them in to a prefab by
dragging them into the prefabs folder so
we have them here and remember to turn
off looping that's really important
because it's just going to several
bursts and and look really stupid hmm
excuse me right cool so let's delete
that from the scene and instead let's do
some instantiation through the script so
let's open up the enemy script and in
the die function we want to first off
have a variable for the particles so I'm
going to do bar death particles and
these are just going to be of type
transform so we can easily instantiate
them and then right before we destroy
the game object with them they're going
to do instantiate and in here we're
going to do death particles comma and
then the position which is just going to
be our transform that position come a
transform dot rotation say that out head
back into unity you can see that we have
a slot for death particles let's find
them in our prefabs folder drag them in
and now when we hit play if I can manage
on this guy's head try and sign this
awesome we have some cool lurking
particles and it's really that easy and
you can just go into this object and
tweak it however you want
cool so now that we have that in place
we can go ahead and move on to the next
part on or the next bullet point or not
list which is some restructuring so
currently what I want to do is I want to
kill the player through a script but
currently if we go into the poll and
look at the ball health script we can
see that this is actually where we do
our level restarting and I think it's a
little weird to have the restarting of
the level all helping in happening
inside of the ball so what we are going
to do instead is we are going to follow
me here whoops it's not on purpose we're
going to go into our game object or game
master script is what I mean and have a
function in here for restarting the
level so inside of our ball health
script we can take our restart level
function just delete that with control X
and copy it over here with control V and
then we can go in and find our the place
where we restart our level and then
instead of simply doing restart level we
are going to do game master dot restart
level but in order for us to access it
in here we need this to be a static
function and that's not really what we
are interested in so what we are going
to do instead in here is simply use a
game object defined statement and this
is going to work just fine
you could also make actually let's just
do that
we'll do a a variable up here so we can
call this game master but do that with a
small G a non capital G don't restart
level because what we can then do up
here is we can make available called
game master of type transform so now we
have a a reference to that actually
let's do F type game object
like that no no let's do if type
gamemaster circuit if I if I am
confusing you here because then we can
drag in the script directly cool then we
can copy over the audio clip over here
so we can play some audio from this
point and down here we don't want the
transform that position instead we want
to change the position of our player but
I'm going to show you how that's done in
a sec then what we're also going to do
is delete this is restarting from the
function there go back into our player
health script and say that if we are
restarting or if we are not restarting
we are then going to set this restarting
to true and then down here we are going
to set it to false again is restarting
equals false this is not by means
necessary but it's it's good practice
and cool so what we basically have here
is a setup where if we head back into
unity it's hopefully not going to
complain no and if we then select our
ball you can see that under our ball
health we have a reference to our game
master so we simply want to drag our GM
object into that one and we are sure
that the GM object is always going to be
in the scene and what this will do is it
will call the restart level function on
the GM object then we go back in here
this function is called this is going to
play a sound which we have right here
it's going to wait for a certain amount
of seconds for the sound to finish and
then we want to change the position of
our player but currently we are changing
the position of our game master script
and that's not really something we're
interested in so instead let's establish
some kind of connection to our player
and a way to do this is simply create a
variable where we then reference the
player so let's start out by doing that
we're going to make a variable and I
actually want to do that up here because
I think it's quite
important and we're going to call this
player and we're going to do of type
transform now when we save this hit back
into the GM object you can see that we
have a player slot up here so we want to
drag a ball in there and we want to drag
our game over sound which I can find
over here on the audio want to drag that
under the game over sound then what we
can do in here is instead of saying
transformed up position we're simply
going to say player type position now
when we hit play and we jump over here
actually we're not calling the restart
function in here but if we jump down you
can see that our restarting whoops
there's no audio such source of course
we need to add an audio source on the
game master object here so what we can
do is simply go under audio audio source
and we're going to disable play on awake
make sure a loop is disabled we can
check out maybe the sound setting here
so volume is just set to one so we're
just going to do the same over here and
we can even set the game over clip just
so we know what this audio source is for
we're also doing that inside of the
script but now we have it so now let's
try to play jump down and see if I reach
that start level function is working it
is but wow it freaked out there for some
reason it went totally crazy I think it
might be because we are trying to
restart the game multiple times so to
fix this we are going to have a global
variable here static var and this is
going to be a a boolean and we're going
to call this is restarting and we're
going to set this to false by default
and this then in here we're going to say
is restarting equals true and then down
here we're going to set it back to false
I know I just delete
this but I wanted to show you that we
need to make it a static variable
because then inside of the ball health
script we can get rid of all of this we
can get rid of the variable up here and
then instead of saying is restarting we
simply do game master that is restarting
you could also do with a non capital G
here because we actually have a
reference to the game master but because
it this is a static variable we can also
reference it without having a variable
for that that's kind of a hard
distinction just follow me right now I
know some of this restructuring can be a
bit confusing also because I'm always
doing these very clear definitions of
the static variable and the public
variable and those things are very
separate but can be very nicely
intertwined if you if you know how they
work so if those still confuse you just
follow me if not then well done you now
understand a lot more about the scope of
these scripts and and what can be
accessed in and what cannot so let's try
to play here again let's jump down ok
let's see if this works and indeed it
does you will however we see that the
camera does a little bit of twitching
and that is also on the list here so you
can see that I have this camera laid up
date that I want to change we can kill
off the restructuring here I think I
think we are done with that but right
now what happens is inside of our camera
if I open that up we have a script
called camera control and if we open
that up in monodevelop you will see that
in our update function we are setting
our position but if for instance we go
into our game master script and change
the player position through script like
this this might not get to update before
the
the the ball is is positioned on the
screen in its new position so what
happens is that we get this kind of
weird twitching effect so we need to
make sure that we update this position
here after anything else so after we've
done the ball calculations and all that
then we want to change the position of
the camera and then we want to draw the
frame if we change the position of our
camera first then change the position of
our ball and then draw the frame our
ball will not be in the center of the
screen so to do this unity has already
made a convenience function for us
called late update and this is exactly
the same as the update function only it
is called right after all the other game
objects update functions so once we
change that and jump down here you will
see that our tweet witching effect has
disappeared and this will become more
apparent when we kill off the ball using
the hid box
so now let's remove that let's remove
fixed box whisker because I think we've
done that too and now it's time for
killing off the player so if we head
into the enemy Center here go under kill
box you can see that we currently have
no script attached so let's hit add
component new script loop new script and
let's call this kill on hit and let's
double click that to open it up in
monodevelop and what we're going to do
is we're going to delete these two
functions and instead make a function on
trigger enter as we've done before open
this up with some brackets and what we
want to do in here is basically to to
call the restart function or I'm sorry
yeah to call the restart function
whenever something hits this so what we
do
maybe we should call this restart on
enter
that's up to you you can always
refractor that any way you want to but
what we want to do in here is simply get
a reference to the game master script
and then call the respond function so
let's make a reference call this var and
name it game master just like we did in
the last script and this is also going
to be of type game object and then we
simply do game master dot restart level
like that and if restart level is not
okay what did we call it okay of course
this can be game object this should be a
game master like that and then we can
restart the level please yes awesome
so under the game master variable that
we now have here we simply drag in the
GM object and we should be able to hit
play so let's try it out we play go over
here try to hit this box Oh
and indeed we restart it's really that
simple
I'm simply going to turn back on my
audio here so I can have a listen and
see if the audio is playing here the
music is playing we roll into our enemy
it says game over and we respawn so that
is basically for everything we can we
can have a fit into one tutorial today
let's see how long this has been running
yeah I mind East need to split this up
but thanks so much for watching it's
it's amazing if you made it all the way
to the end here so congrats if you have
and yeah that's basically all I have to
show you I can't wait till we can do
some model implementation and really get
some cool looking graphics in here
that's going to be so much fun
so thanks for watching and
see you in the next video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>