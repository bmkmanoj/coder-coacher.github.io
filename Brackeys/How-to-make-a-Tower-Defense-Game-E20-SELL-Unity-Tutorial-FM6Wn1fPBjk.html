<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to make a Tower Defense Game (E20 SELL) - Unity Tutorial | Coder Coacher - Coaching Coders</title><meta content="How to make a Tower Defense Game (E20 SELL) - Unity Tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Brackeys/">Brackeys</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to make a Tower Defense Game (E20 SELL) - Unity Tutorial</b></h2><h5 class="post__date">2016-11-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FM6Wn1fPBjk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">thanks for tuning in at brakus hello
everyone and welcome to this video on
creating a tower defense game in unity
today we are going to be adding some
functionality for selling turrets two
videos ago we are made some
functionality for selecting turrets on
the map and a node you I would put up
pop-up with two different buttons one
for upgrading the turret and one for
selling it and in the last video we made
all the functionality for upgrading the
third than this one we are going to be
making the stuff that will allow us to
remove the turret off a map and in
return get some sum of money we'll also
be adding the upgraded versions of the
missile launcher and the laser beam err
because then the last one we only set up
an upgraded version of our standard turn
so without further ado let's just jump
right into it so as you can see I'm here
in unity and what I want to begin with
is just adding these upgraded versions
so we can totally close off our upgrade
system you can see currently if we hit
play here and create a standard we can
easily upgrade that but if we do the
same with our missile launcher it says
that the upgrade price is zero and it's
just going to disappear off the map with
a null reference exception because we
haven't referenced an upgraded object so
let's go into a prefabs folder here
let's find our missile launcher and it's
hit ctrl D to duplicate that and let's
call this one missile launcher upgraded
I'll grade it and let's drag this into
our map and we can just kind of style
this differently and give it some
different properties over here so the
first thing that I want to do is bump up
the scale to 1.2 on all the axes and
then I want to up the range to something
like 40 the fire rate to something like
point 4 and everything else we're just
going to leave as is you can also
include a new missile if you wanted to
fire something that looks a bit
different you might want to make it
bigger or totally red or do something
like that but I think we're just going
to keep this as as is for now and the
next thing that I wanted to do with this
is change the materials a tiny bit to
just kind of recolor it and make it
really clear that it's now a new
separate thing so in order to do this I
actually don't want to change any of the
materials
I just want to flip this material here
for the tip and on this material here
for the head so you can see over here we
have a primary and a secondary material
and then they are currently under your
imports and then missile launcher and
materials you can see I played around
with having an upgraded folder here
we're just going to delete that and
basically I just want to drag our
primary into the first slot instead of
the second one and our secondary into
the second slot instead of the first one
and that is just switched the two and
it's maybe this may be kind of a hack
but I think it looks fairly decent
especially if we zoom out a little it
makes it really really clear that
something else is going on with the
start so let's just hit apply on that
and remove this and now we can go into
our shop which is on the overlay canvas
and then shop and in here we have the
sharp script which has a missile
launcher and all the data for that and
here we need to reference our new prefab
that we just made the missile launcher
upgraded along with adding a cost and
that's going to be something like 150
you could easily automate the cost too
but just be a percentage of the original
cost but I like to have more control so
now we can go in here
hit play select our missile launcher
build it and we can now easily upgrade
it as well and that just works awesome
and I basically just want to do the same
thing for the missile launcher so let's
take our missile on or the laser beam er
so let's duplicate our laser beam er and
let's do underscore upgraded once again
let's move the center scene so we can
easily see our edits and let's change
the range here to something like 30 and
this also change the damage over time to
say 40 and the slow mount to something
like 0.8 I want this to be really notice
it noticeably better then we can hit
apply on that and I also kind of want to
bump up the size of this laser here so
let's just change the start with on from
0.3 to 0.4 and do the same on the end
width just to make that a tiny bit
bigger and also we can make the turret
itself bigger so let's do a scale of 0.1
point two again on all the axes and we
can also go under the impact effect and
just edit this a tiny bit so if we focus
on it you can see what that looks like
and it's a really nice effect we can go
on to glow and change the start size to
be between three and four instead of two
and three and just bump up the range on
the light to something like fifteen
instead of ten come and that's pretty
much all we need to edit for this I
believe so we can just hit apply now and
again remove it off the map and then we
can find our shop and reference it so in
here under a laser beam er we want the
upgrade cost to be somewhere around 200
maybe even 250 actually I think I'm
gonna go for 250 and let's take our
upgraded prefab the laser beam are
created here and put it in there so now
when we have play we should be able to
able to upgrade this as well so that's a
spawn in a laser beam er and hit upgrade
and you can see that indeed that works
just fine however I want to recolor this
a tiny bit so let's just take our
upgraded here have a look at it and
instead of again modifying the original
materials this time I want to basically
just find our laser beam err is this
floating this is for some reason
floating so I think the fact that we
scaled this up made it float a tiny bit
I said what we'll do is just take these
elements here the base and the pot to
rotate and I think we'll just move those
down a bit something like that just to
make sure that it will stay on the node
even though we've sized it up so now we
can go on our imports and then you can
see I've already created I'm at a folder
for this earlier but let's just delete
that let's duplicate the entire
materials folder and let's call this one
materials upgraded and now we can go
ahead and swap all of these out so let's
go under the base first and we change
the bolts here and the base through the
new base then we can take our head and
change the pipe the main turret and the
third accent
there we go and currently we can't
notice the difference but now we can go
in and actually change these materials
and it will only affect this version I'm
pretty much all I want to do is take the
pipe here and make this screen and I
want them to be a very bright saturated
green something like that and I also
want to kind of go in and change the
bolts here to be green as well I think
that could be a pretty cool little
detail something like that and I might
want to change the accent even so let's
find our turret accent and let's just
try this in green as well I actually
really like that it's it's more simple
but it's very noticeable noticeably
different so let's hit apply and let's
remove this and remember you don't have
to just change the materials or just
change the properties you can change
anything about the turret you can change
the bullet the prefab that spawned
anything about the effects and you can
even make a totally new model with
different animation and put that in
there instead because we're just hot
swapping out a game object so now let's
just try this on one last time and see
that all of our turrets are working so
let's do one of each and let's just try
and upgrade them
that looks nice okay so they all look
really awesome in their new upgraded
versions cool so next up is the selling
part so what do we wanna do here well so
far on each node on each node we have a
node script and inside of this script we
have functionality for set arm for we
have callbacks that register when our
mouse is hovering over it we have
callbacks that register when and let me
just close down all of this stuff when
we click on it and we have different
stuff that happens when we do so we have
something called build turret a method
that builds a new turret we have another
one that upgrades the current turret and
in line with these functions lit let's
add a new one called Marcel turret and
what we want to do in here is of course
destroy the current or add on some
amount of money
and maybe also some kind of effect so
let's start by adding on some money so
let's go into play your stats and let's
do dot money and it's add onto this some
amount of the cost so I think here we're
just gonna automate it you can go in and
put a sell amount for each individual
turret but I think for now we'll just
take half of the purchase price so we're
going to ignore upgrades and we're going
to ignore everything else about the
turret the amount that itself sells for
is just going to be half what we
originally bought it for so well and
that is of course stored inside of our
turret blueprint so this is our current
turret I mean just do chart blueprint
cost and then multiply that with say 0.5
but we might want to get the cost or the
amount that we can sell something for
multiple places and we don't want this
point 5 to be height coded because then
we would have to go through and remember
where we wrote this code and change it
in each place so what we'll do instead
is add a small helper function to our
tart blueprint that returns the arm sell
amount what the how much money the chart
can be sold for so let's find our turf
blueprint here and open it up and in
here we're just going to add a quick
little function this is going to be a
public and it's not going to be void
because we want to return something we
want to return an integer with the
amount and this is going to be something
like get sell amount and all we do is
take our cost and and we return our cost
multiplied with some value and let's
just take half of it so in our case we
can just divide by 2 so that's pretty
much all we need to do we just cut our
cost in health in half and this way we
can easily just in here change how we
calculate this and it's going to update
in all places where we simply go to
print dot get cost oops get sell amount
there we go awesome so what we can then
do is of course destroy the turret so we
have a reference to it as
right here we're just going to destroy
that we're also going to set our tart
blueprint equal to null and that is
pretty much it and then we can spawn a
cool effect but we can take care of that
in a second let's just figure out if
this is working so this function should
indeed work now but we of course to need
to call it somewhere as well and we need
to call it in the same place that we are
calling our upgrade turret and that is
through our node uy so I know UI here is
what pops up whenever we select a turd
it has this canvas with the different UI
elements for upgrading and selling so
what we do is edit this node UI and in
here we just want to add on a new my
method just like we have the public
board upgrade we also want called sell
and we just go to target dot sell turret
and the target is what we are currently
are we currently have selected and then
we go build manager dot instance
deselect node because after selling the
turret we want to deselect any kind of
nodes that we might have selected just
the same way that we have build our
upgrade men method it's the exact same
thing except instead of calling upgrade
turret we're calling sell turn so now we
just need to hook this up to a button
and we do that by going through our
canvas finding the button on the buttons
the sell button here and adding a new
onclick event that references our know
do I wear our script is and calls on
that script calls the cell function that
we just created so now everything should
be nicely hooked up and that there that
right there is the strength of the way
that we've built this system because
we've build it in such a clear way where
our UI elements all reference this
central UI script that is then able to
or that then keeps track of what we
currently have selected and is able to
call methods on that node because we are
using this very modular way of building
it it's so easy to add new functionality
to modify notes in different ways so now
we can hit app play here and hopefully
we should be able to now build any kind
of turd and sell it I'm indeed we are
and you can see here that I spent 350 I
click here and I sell and right now it
says sell 450 that's not true it's going
to sell for 350 divided by 2 and you can
see indeed it does that so all we need
to do now is just update that amount so
we're not updating the cell cost here
and that's going to be the sell amount
here we're not updating this UI element
you can see all we need to do is go in
here and modify this to say something
like 125 in case we are selling the
missile launcher or whatever so what we
do in order to get that working is just
reference it inside of our node UI and
update it when we set a new target the
exact same way that we do with our
upgrade cost so we just create a public
text here and this is going to be the
sell amount and we'll reference that in
the inspector and then down here we go
sell amount dot text equals and we'll
put a dollar sign here just for
fanciness and plus target dot type Boop
turret blueprint dot and remember to use
the method here so we'll use get sell
amount and this is where our little
helper method here comes in handy
because now we've already implemented
this sell amount in two different places
and so we would already have two
different places that we would have to
update our code instead of just this
central one cool so that should indeed
update that and everything should be
working so let's try this out so let's
find our node UI script let's drag our
mount here the text object right into
that field and that's a plate and now
let's build one of each turret and let's
select them so this one here sells for
175
there's 425 and this 450 and we can sell
them for those appropriate amounts you
can see our money went back up
awesome so the last thing that I wanted
to do was just create some kind of sale
not animation I wanted to create some
kind of so effect so in order to do this
let's use an effect that we are already
have and let's create the effect and
then implement it in code or the other
way around let's do the coding thing
first so in order to do this all we need
to do is find the place in our node
where we saw the chart and you can see
we've already made a comment here so we
want to do the exact same thing as when
we are instantiated and effect up here
when building it so let's just duplicate
that code and all we're doing is
instantiating build manager dot and then
instead of build effect we want to have
a new reference called a sell effect and
we'll create that in a second and we get
the build position which is also the
sell position which is the central point
for our turret we have a catonian dot
identity which is just a rotation of
none and then we destroy that effect
after five seconds so let's now go and
that's basically all we need to do here
so let's just go into our build manager
and we'll find that in our scripts
folder here the build manager and let's
add just another public game object here
so public game object and this is going
to be our sale effect call so that was
all we needed to do in code so now we
can just build this inside a unity so
let's go into prefabs and let's base
this around our build effective rename
this one to sell effect and create a new
prefab out of it and let's have a look
at our particles here so these particles
are let's turn on looping here and let's
simulate these particles are floating
upwards and since it's kind of a semi
positive thing that is happening it is
something kind of intangible on the fact
that you are getting coins
um let's have the same effect but now
let's color it differently so it's
clearly our coins or some kind of money
or gold that is floating upwards so
let's create a new materials for this
and it's instead of let's just actually
duplicate the build effect
let's call this one the sell effect and
inside of our particles we then want to
reference that sell effect so under the
renderer dragon these sell effect under
the material field and we can now select
this material and we can make Eid kind
of orange yellowish we want no metallic
Ness we wanna kind of bump up the
smoothness and it actually it wanna
saturate this more something something
like that looks pretty nice it's just no
metallic Ness that's my kid and let's
also give it a tiny bit of emission
because when we give it some emission
it's going to have this very nice glowy
feel and it's not actually going to
illuminate the map it's just going to
give us this nice color on the material
and it's give it an emission of say 0.3
so let's see what that looks like I
think that's a pretty nice combination
between reacting to the light in our
scene and actually emitting shadows as
well and then still having that glory
glowy field I kinda also want to add
some particle effect that is thrown to
the ground because our turret is
currently just D materializing and just
disappearing in an instant let's create
the illusion that some parts of the
turrets are that it's being split up
into parts and falling down so in order
to do that let's use another effect that
we already have lying around and we
could maybe use um the bullet would be a
pretty good one we could also use one
for destroying enemies so we have the
enemy death effect here and I think this
can very easily be modified to suit our
needs so of course we don't want this to
be a prefab a prefab right now and so I
believe that we could just hit revert
here nope um how is it that we
disconnect this from being a prefab I
actually never really do this so it's
kind of you know what we'll do we'll
just trick this so delete that and then
we can go in here and we can create a
new object and we can just paste that
component in there and it won't have an
effect on the prefab there we go so
let's reset the transform on that and
this one is going to be on kind of the
debris and let's simulate this that
already looks pretty good let's put on
looping here so we can see what's going
on and of course we want this to have a
different material as well because this
one is made for our enemies and that is
pretty clear
and that's actually maybe also bump down
the emission a tiny bit to be between 10
and 15 I think that's enough actually no
let's just go full particle overboard so
this is the debris and let's find a
material that matches here so we could
actually just go ahead and use one of
the materials on that we use on our
turrets and then in fact I think we
should just do that so that's going to
import on the D standard let's find our
materials here and let's find our main
color this gray tended a tiny bit blue
color and let's drag that in there and
see how that looks so I think that looks
pretty good it definitely gives the
impression that there's some kind of
debris lying around so now let's try and
hit let's select these particle systems
and turn off blooping that's a pretty
important part let's try and hit play
let's try and hit apply and there's now
delete this prefab and let's also
reference it so inside of our game
master is where I'll build manager sits
and now we just need to drag in our new
searle effect so effect into the empty
slot and yeah let's try and hit play and
let's try and sell something so I
actually really like the effect we have
going on here it's it's really subtle
but it's just that's something there and
it feels nice I do think however that I
want to modify it a tiny bit more before
we close up here so let's find our sell
effect here the debris I'm not totally
satisfied with this I want to move it up
a bit first of all that's okay and then
we can take and edit the shape here a
tiny bit I want to maybe do this in
hemisphere shape and I want to rotate
this by negative 90 so kind of shoots
upward side a little bit and I maybe
also want to add a tiny bit of speed so
something like between 1 and 5 that's a
bit better just to give it a bit of
bounciness like that that's a bit better
and then let's also modify the material
for this so let's create a separate one
changed my mind so let's create a
separate one create material and this is
going to be our sell effect and this is
going to be the debris and this is going
to be our sell effect which is going to
be our gold so this is going to be our
gold there we go let's take our debris
and drag it into the renderer to replace
here there we go let's simulate and
pause so we can see what's going on here
and let's adjust this so a bit of
metallic miss me down with the
smoothness and then we're going to need
some blue tinted kind of greyish colour
something like that is pretty nice I
think the other one was simply too black
so let's try and hit apply on that hit
play see what this feels like so let's
try and sell that and I actually really
like this effect now that's perfect it
might even be a tiny bit on too bright
so let's just try and do that and now I
won't fiddle with this anymore
I guess it makes for a bad video if I
just sit here adjusting settings so
we'll take our game over script and our
node UI and drag that under these
scripts and we'll have one last view of
what this effect looks like and yeah
I hope you enjoyed this video I
definitely do think that these features
the UI here's some selling and some
upgrading are very central to almost any
tower defense game so it feels nice to
have them in here and if you have any
other suggestions as to what I might
cover definitely leave them in the
description or in the comment section
down below because this was pretty much
all of the really central stuff that I
wanted to cover so yeah let me know what
you guys want to see and without further
ado I will see you in the next
video thanks to all of the awesome
patreon supporters who donated in
October and a special thanks to Sultan I
should've
Faceman mattify and James Calhoun become
a supporter at patreon.com slash
brackets Wow</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>