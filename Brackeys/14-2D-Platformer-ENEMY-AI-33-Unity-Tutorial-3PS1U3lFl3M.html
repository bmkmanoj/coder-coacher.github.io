<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>14. 2D Platformer - ENEMY AI 3/3 - Unity Tutorial | Coder Coacher - Coaching Coders</title><meta content="14. 2D Platformer - ENEMY AI 3/3 - Unity Tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Brackeys/">Brackeys</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>14. 2D Platformer - ENEMY AI 3/3 - Unity Tutorial</b></h2><h5 class="post__date">2015-01-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/3PS1U3lFl3M" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">thanks for tuning in at brakus I think
that was pre basically the hardest part
of wrapping your head around this so
what we are going to do here is we're
going to create a current so we are
going to right start co-routine and
we're going to call the function in here
that we're going to write in just a sec
and this function is going to be called
update path because we want to sometimes
update our path let's say that our
player moves we want our enemies to
update their path depending on the place
we've moved to but what we don't want to
do is do this every single time we draw
our frame because that will just hold
that was just unnecessarily cluttered
the CPU and it's going to be really
annoying because we are going to have
all this enemy means constantly drawing
paths and it's really not necessary no
one will notice if we only do this let's
say twice every second so what we can do
with this is we can create a cover of
teen or an I enumerate a function that
will update every odd let's say two
times a second it's simply going to
create a new path for us so we're going
to create a new I enumerator ie new
array tour why is this not showing up am
i doing something wrong we're going to
call this update path it's not going to
take any arguments and inside of this
here once I knew manator when I
enumerate and I'm working oh is this
part of system start collections using
system dot collections
it probably is yes it is okay so we
needed the system that collections
namespace I'm sorry I was wrong now
let's continue so under the update path
function we can check if our target is
equal to zero or no because if it is we
don't want to update our path it's just
going to result in an error and it's
going to be really ugly again here is
where we might want to do some kind of
searching so insert a player search here
by the way if you create a to-do mark
like this actually right out to do with
capital and then a colon monodevelop
will know and you can actually go
through all of you to do point so if I
go under view I believe tasks or shifty
you can see that all of my to-do marks
are right here in our current project
and you can simply navigate to them
that's pretty cool a to-do list list is
sometimes better but it it's it works
now we can simply return and we just
want to return nothing but because this
is an enumerator we have to type in some
kind of pull value and we'll simply type
in false that's going to work just fine
and then what we can do down here now we
know we have a target and we know we
want to update the path we can start a
new path so we can say Seeger dot start
path and we can basically do all the
same as we did up here Samson can copy
that down there that's basically the
same thing we want to do I just wanted
to update the path the instant that the
start function was what's called cool
actually what I want to do I know I keep
on regretting everything I do here but I
think we'll just delete this and we'll
handle it in the karate no yes
we'll make sure to do it up here because
I don't know how quick the disco routine
will be called and it might be called
after the fixedupdate which might result
in an error will keep things real and
and just start the path up here then
what we can do is we can with wait for a
certain amount of seconds so he'll
return new wait for seconds and we're
going to put in the update delay or
update rate and we're going to of course
say 1 / update rate like this so as the
more we increase our update rate the
smaller the wait time is going to be and
that off with a semicolon and then we
can simply call this function again so
it's just going to loop so we're going
to say start co-routine update path with
no argument so it's just going to
basically call itself every 7 seconds
that's awesome we actually have quite a
bit of our code done now we only need
one more function it is the largest
function that we have left but it's now
that we are going to actually see some
moving
so let's collapse or start that collapse
our update path and our own path
complete if you haven't turned
collapsing off I recommend you do it in
the monodevelop settings it makes
writing code much more organized and
similar to to view the code and then
we're going to create a void and we're
going to call this fixed update and this
is important that you call it exactly
fixed update and the fixed update is
quite like update but instead of
updating for every frame drawn it has
this fixed update rate as the name
suggests that is awesome for doing
physics calculations so if you want to
move something using physics do it
inside a fixed update not update
every time cool so I think my plan came
across there and we of course again
going to check if our target is equal to
null I think at this point we can just
copy the check from up here there and
then we are going to maybe insert some
kind of look at function here so another
to do in here where we can write always
look at player this is something that
you want some enemies to do probably not
this one because we've construct I've
constructed him this way to kind of
always be floating with at this angle
but some enemies like maybe missiles you
probably want to point towards the
player it's not something we're going to
put in in related with you great what we
can then do is check if our path is
equal to null because if we don't have a
path we basically just want to return
here we don't have anything to move
after then we can check if our current
Waypoint is greater than or equal to
path dot vector path dot count just
right after me for now then if our path
is ended we're going to return just
there's no reason to change the path
that is ended and then if it's not we're
going to debug that logout and a path
reached period semicolon
and we're then going to set our path is
ended equal to true and then we're going
to return so what we're doing here is
we're basically saying that if we've
reached our final point a waypoint these
returns the path that vector path
returns the all of the waypoints as an
array and we are simply checking if we
the current Waypoint that we are at is
bigger than or equal to the total amount
of waypoints in that list array I should
say and if it is it means that we've
reached the end so if the path is
already ready been set to have ended
we're going to simply return and if it
hasn't we're going to debug out that we
have restart int and then set path to
send it to two and then return cool and
then what we can do is we can down here
set path is oops path is ended equal to
false so if we don't get this code block
we are simply going to set that path
this end is equals false now we want to
check the direction to the next Waypoint
because we're going to need some kind of
direction in order to move our rigidbody
also I'm going to select the current
time okay yeah so moving along quickly
so we want to find the direction to our
next Waypoint and the way we do this
first off let's make a comment direction
to the next Waypoint very nice then
we're going to do vector three deer this
is going to store our direction then we
input our path dot vector path remember
this is the list of waypoints we input
the index of our current Waypoint to get
the web Waypoint that we are currently
chasing we are then going to subtract
our transform type position this is
going to give us the
rection so if you have one position
which is this is going to return us this
is going to return us the position of I
the Waypoint we are currently chasing
and we subtract that I current position
we are going to get a direction that's
super awesome when working with vectors
and and these two blade or is a triplet
too late' oh I don't remember this but
working with these three-dimensional
numbers if you subtract the two you're
going to get the direction between the
two and what we can do with this is we
can wrap this in the parenthesis and
then we can say dad normalized to get
the normalized vector meaning that the
vector that this will be sold in has a
total length of one that's pretty
mathematical if you don't know much
about vectors please just write it out
as I've done here I don't really have
time to go in to all of the math behind
this but just know that this is just an
awesome way to get the direction from
one place to another then we can simply
multiply our direction with our speed
and we are going to finally multiply
that with our time dot fixed Delta time
there and and then a semicolon cool
Amram notice that this is fixed Delta
time not Delta time because we're doing
it in the fixed update function so that
will give us a speed that is a second
bound or a time bound not bound to the
update steps in fixedupdate
cool what we want to do now is actually
move the AI because now we have a
direction we made sure that our path is
correct and we have a target and we
update the target and everything now we
simply have to move in the correct
direction and this is ridiculously
simple you are probably going to laugh
because this is the simplest of all even
though you should think that this would
actually be kind of hard so this is
where we move the AI and we are simply
going to write our
to get our rigidbody dad add force
because we want to add some kind of
force to it and then we're going to give
it the direction which is steer and the
force mode which we selected in the
beginning simply called F mode semicolon
now our rigidbody will move in the
direction of the next Waypoint and then
down here what we want to do and this is
the simple say the last thing we are
going to do is simply check if we are
close enough to the next Waypoint and if
we are we want to proceed to follow and
the next Waypoint so we're simply going
to check if break 2/3 that distance
we're going to give it a point a and
point B point a is going to be our
position and point B is going to be the
path that vector path and then import
our current very point so the Waypoint
we are currently chasing current
Waypoint here
and we check if that distance let's
store this in a separate variable just
to make this clean you shouldn't we so
we make this here a float just equals
that and then we simply check if this is
less than and then we give it our next
Waypoint distance that we defined if it
is and then we want to increment our
current very point we want to shift our
focus to the next Waypoint and then we
turn it's at the end of the function but
it's just good practice because that's
what we want to do cool that was it that
was the script if you've made this far I
am amazed you are a true hardcore coder
I'm very impressed
if you made it through all of this for
encoding and I hope that you will enjoy
the end result as much as I will and
let's hit save on this and sit back into
unity let's hope we don't get any errors
we do but that's okay we can fit quickly
fix these
a return keyword must be followed by any
expression yes so in here we are in the
fixedupdate so simply delete the false
there that's only needed inside of the I
numerator not in a void we don't want to
return anything there and that cleared
up the errors now let's select our alien
spaceship make sure our enemy AI script
is added in here make sure we add our
player as to target because we don't
have any target searching yet the update
rate is going to be fine at to the speed
I think I'm going to leave that at 300
set the force mode to force and in the
beginning and the next Waypoint distance
let's just try it at 3 now when we hit
play hopefully it's going to search for
a player and try to hit him so now we
have AI you will however notice a couple
of things first off he is kind of drunk
in his steering is not too accurate
that's a very easy fix no coding
required and also right now he just
moved through the apt obstacles so we
want to do two things here first off you
can change the mass in order to make him
less drunk sort of say but what we want
to do instead is bump up what is called
the linear drag and this will make sure
that his position is not as floaty it's
awesome for missiles to have a low
linear drag but this guy actually knows
what he's doing so may be a linear drag
of two is better then I'm going to bump
up the speed to about 600 and I'm also
going to put him at a fixed angle so if
he bumps into something is not going to
rotate again that's not something you
want with a missile that's fine that it
rotates but with this we want a fixed
angle and then under add component what
we can do is simply add in a Collider so
physics 2d and I'm going to give him a
circle Collider which we can just adjust
it actually looks pretty good and what
we can do now is simply hit play and
enjoy the end result you can see him
chasing us there oops
didn't mean to fall down so you can see
him chasing us and he will do so
correctly if you have gizmos turned on
here and if we uncollapse the seeker
script you can actually see him drawing
a path to us so you can see how
accurately this system actually works
and just how nice it is that it doesn't
update every single frame it updates
more than plenty frequently as is right
now so I'm going to set the speed a bit
higher I think I'm going to go all the
way up to 8,000 yeah that's that's a bit
nicer and now we actually have a cool
moving enemy in our game so that was
basically it for this part of the enemy
AI course or tutorial I should say
excuse me so I hope you enjoyed this and
congratulations for making it this far
I know a Rai can be hard to wrap your
head around in the beginning but if you
made it to this point you are pretty
good to go
so I think that in the next following
videos we are probably going to expand
on this to maybe make some shooting
enemies maybe make them take damage
maybe make them rotate towards the
player there's plenty of stuff to do so
but this was the absolute core and yeah
thanks for watching and I'll see you in
the next video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>