<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>17. Unity Tutorial, DOORS - Create a Survival Game | Coder Coacher - Coaching Coders</title><meta content="17. Unity Tutorial, DOORS - Create a Survival Game - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Brackeys/">Brackeys</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>17. Unity Tutorial, DOORS - Create a Survival Game</b></h2><h5 class="post__date">2013-05-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/7fkID1uzUJo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone and welcome to the 17th
video in our survival game series done
by brackets I'm the CEO Frankie's and in
this video we are finally going to take
a look at scripting doors
so I door functionality opening and
closing and also some GUI that will ask
the player whether or not he want to
open the door or and until what key the
player needs to press also how to delay
functionality using the yield wait for
seconds some more on that and keep in
mind throughout this video that this
technique can be applied to pretty much
anything that you want to open and close
or move based on player input so that
could be chests lastic larger gates and
you get the point
all right so as always I've opened up
unity and you can see that a few things
has changed first of all I have gone
ahead and made a wall and a door I
muddled them inside of Maya and they are
not perfect there are some mistakes here
and there but it was just a quick model
to get to get something to work with and
they will of course be included in the
updated version of the assets pack so if
we go into the imports folder here you
can see that I have the door which is
which includes both objects and I have
set the scale factor to 0.5 and then I
have the door UV the door UV with a
normal map so that the light will
reflect even prettier and a door wall UV
and a normal map for that also so if we
take a look at how I've set it up in
side of unity we have a game object
called the house piece in which we have
both the house door and the house of all
anat and on them we
have two materials on the door we have
one called door UV and this is just a
bump diffuse so that we can apply the
normal map to it and that's why we have
the house wall bump diffuse and applied
normal map okay so that's it for
importing it into unity and getting it
set up like I have here now let's go
ahead and actually make the door so here
we have the house tour and let's go
ahead and hit the add component new
script and also a lot of you have asked
what if we don't have the add component
button the add component button was
added in unit c4 so all of the four
versions will have the add component but
if you don't you can either go ahead and
update unity or go to the components up
here or right click down here and then
hit create and then JavaScript and then
drag it on
all right so how store add component new
scripts and we're going to call this M
Doyle logic going to be a type
JavaScript create an ADD double-click to
open it up in monodevelop
and just waiting for it to open so I
think we are there cool now we are going
to keep the function update for later
but the function start we can go ahead
and delete and just space out the
bracket keys in the function update cool
so let's start with a variable no
actually let's start with a
ontriggerenter so new function then call
this on trigger enter all the capitals
and we want to store some information
we've talked about how these works in
earlier tutorials so I'm just going to
go through
really quickly so we are called you're
going to call the information the
collider and it's going to be a type
collider and inside of this we are going
to type if the collider dot tack is
equal to player then we want something
to happen and let's just write a debug
log and then we can write working so
this code will make sure that if we
apply it to a trigger Collider it will
check if something enters it will then
store some information on what entered
and in this if statement it will check
if what if the the object that entered
has a tag called player so if the object
is the player and if it is the player it
will just type working in the console
window so to let us know that it
actually worked
but one thing we don't want this apply
to the actual house door we want it
applied to a trigger so I'll just go
ahead and remove the component and if I
just go ahead and hit play and run over
here and keep on running you will notice
that I can run right through the door so
we want to create some colliders for
this house wall
I think I will use a mesh Collider you
could also create a lot of different box
colliders to make sure that you get
accurate collision if you want to know
more about how collision works inside of
unity and how you can make great
collision without being too harsh on the
computer then you can go and watch our
mastering collisions turret for now I'm
just going to hit add component physics
mesh Collider
so now we can interact with this
correctly and the door mmm I'll just go
ahead and create a box Collider for the
door so physics box Collider and let's
just tweak this a little bit so we could
go ahead and just disable the house wall
and let's have a look so we can treat
trick the century settings and the size
of it scale it down a little on the Y
maybe a little more actually let's drag
it down a bit and so the sides it looks
fine but let's tweak the Z oh now the ax
to about there and position it goalie in
the X also so that actually looks really
fine I'm just going to push it down a
little more cool so as you can see it
isn't perfect but it will do and I'm
sure it will do so now let's re-enable
the house wall and when we hit play and
run over to the door
we can't run through it and the same
thing happens with the wall awesome now
let's go ahead and make what will
actually trigger a player a be triggered
by oh I play so let's go ahead and
create a new empty game object so game
object create empty drag it under the
house door just so we can Center it on
the door so censor the position and the
rotation and one one one on the scale oh
oh
I selected the wrong object I selected
our enemy
that was not on purpose or game object
create mt drag it under the house store
0 0 0 0 1 1 1 cool
now let's position it the right way so
let's set all of these set that one to
century and this one to global actually
a local and we can make sure it's
centered on the door about there and now
we want to create a Collider for it so
add component physics box Collider and
this could be any type of Collider you
want now we can just go ahead and scale
it so we'll make it about as high as the
door and as wide maybe a little wider
actually and on the X here you're going
to scale it quite a bit because this
won't actually open the door this will
just enable the player to open the door
so we want him to be able to do it from
quite a distance and let's rename this
to house house door trigger and to see
if the trigger is placed well we can go
ahead and hit play now without enabling
the is trigger and therefore we can see
when we collide with it so from here you
are going to be able to open the door
that looks fine I actually well yeah
that works fine so let's just go with
that
and let's remember to check the is
trigger this is very important let's
also remember to select the player and
tag him as player if you haven't done
that already now we can go ahead and
take a look at the script so this should
be working now because we have tacked
the player and we have set the object
when a trigger so now we can go ahead
and drag on the doll logic
all right so let's play let's hit play
and when we enter we can see that
working is being called in the console
cool now let's add to the script so
we're going to do some we are going to
make a variable which is going to be
private because we don't want to
actually change it in the in the inside
of unity cut it and we're going to call
it draw GUI and by default it's going to
be equal to false then we are going to
wait a second with implementing this
first we're going to make the actual GOI
so let's type a new function and GUI or
GUI is what we use whenever we want
something to be drawn on the screen so
we use it for 2d elements so in this
case we're going to use it for making
some text actually a text label so we
are going to have a box around it
now do I elements can only be made
through scripting inside of a function
called on GUI and make sure you type it
exactly like this with the capital
letters now inside of this we are going
to type GUI dot box and then open up a
parentheses react for rectangle open up
another parentheses and then we are
going to need four values the first two
values will determine where on the
screen it needs to be drawn so that
would be first on the width on the X
where we needed to be on the x-axis and
then on the y so first
just go ahead and type em 10 comma 10
and then we'll define how long it should
be and then I want to be 102 by 22 that
works with the text we are going to be
entering then end up the parentheses
comma and we're going to type press e to
open like that and end everything up and
end it with a semicolon now let's see
how they look this looks so let's hit
play and you can see that it's getting
drawn in the upper left-hand corner but
we wanted to be more like in the center
of the screen you can have it wherever
you want I'm going to D capital S do in
the open and I'm gonna make sure that
this is drawn in the center of the
x-value and this is done by using the
screen dot with the screen dot with
assembly how long is the screen and
you're going to make sure that it's half
way so we are going to time say times
0.5 you could also divide by two then we
are going to make sure that we calculate
in the actual width of our of our label
so we are going to minus with half of
our width so we are going to minus 51
now let's see if this works it's in the
center of the x-axis now let's move it a
little down on the Y let's just type 200
hit play I'm pretty satisfied with man
great now let's make sure that this only
appears whenever we are inside of the
range where we can open the door so this
will be done using our draw GUI so
inside of this ontriggerenter
we're going to type to our GUI equals
true and now we're going to go inside of
a function on GUI and type F draw GUI
sequel to true and then make some
brackets around our GUI dot box and this
will make sure that the GUI is only
drawn when the draw GUI is equal to true
and it will be true
once we enter the range so now let's hit
play walk over here and you can see that
now the GUI is strong but watch what's
happened what happens when we leave the
sound it's still getting drawn so now
let's make sure that it will that the
draw too I will turn turn false whenever
we leave the trigger so create a new
function called on trigger exit and it's
also going to store the collider
information you can store it the exact
same way and inside of here
you're going to type if the collided
attack is equal to player so it's going
to be exactly the same you can just go
ahead and duplicate what we made up here
so if the collided at tag is equal to
play then we want the draw GUI to be
false
remember this needs to be on trigger
exits all right so when we go into unity
now the GUI is drawn as long as we stay
in the collider and when we leave the
trigger it's not the draught UI turns
false and it won't be drawn great so
that's it for enabling the enabling and
disabling the GUI now let's make a new
function
and this one is going to be the function
update so we have it up here if if drawn
to you I is equal to true and input that
get key down key code dot e then open up
the brackets then change door state so
what we are doing here is we are saying
that if the draw Gy is equal to true so
if we are inside of the trigger and the
player presses the e button then we want
to change the door state meaning that we
wanted to open or close now because I've
written it this way the changed or state
and then open closed parenthesis and a
semicolon that means that I want to
create this inside of a separate
function called changed or stayed you
could also create this here and the yet
again you couldn't and I'm going to show
you why now let's type function change
door state the parenthesis and the
brackets inside of this you're going to
type let just hold on a moment we're
going to type if door is closed so here
we're going to need a new variable so
let's go up to the top and create a new
variable so this is also going to be a
private bar
and this is going to allow us to
determine whether or not the door is
closed or not so door is closed and it's
going to equal be equal to true by
default so if door is closed is equal to
true then we want something to happen
and this is where you can insert your
own logic I'm going to give you an
example of how I would do it so I would
say the door dot animation dot crossfade
and then open or whatever your animation
is called
so this requires that you make an actual
animation and the reason for why I write
the door is because we are going to have
to actually reference the house door
because we have this house trigger and
if we just animate this it's not going
to be visible in game and actually let's
go ahead and drag out this this house
tour trigger under the house piece so
that it won't be influenced by the
position of our doll so when we animate
the door we want to reference it from
the trigger so let's go back into
monodevelop
and create our last variable this one is
not going to be private because we want
to apply it in unity it's going to be
called var the door this is going to be
a type transform now we can just go into
unity wait for the script to update oh I
can see we have an error door dot
animation the crossfade so crossfade is
not a member of unity animation
think I've spelled it wrong might be
crossfade yeah I spelled it one run and
so we're going to do it like that
remember to cover the light dear now we
have no errors and we can see a variable
called the door appear in our script now
we can just drag on the house door and
that is it great so now let's write out
the rest of the logic and then we can
create the animations you could after
the door animation starts playing also
make it play a sound so we could do the
door dot audio dot play one shot this
would play what every audio source you
attach to the door so inside of this
door here we could we could apply a
audio component so we could drag drag on
a door squeaking or like an old wooden
sound effect or something like that but
for now I'm just going to go ahead and
not do that so I'm just going to comment
it out like this now let's move on door
is closed will then be equal to forth
false because now we have opened the
door the animation has started playing
and the audio has started playing so the
door is no longer closed now we want to
wait a couple of seconds and then we
want the door to close automatically and
this is the reason why we are doing it
in a separate function other than just
to keep it keep the script looking clean
it's because we want to use what is
called a yield you're going to type
yield space wait for seconds
oops wait four seconds and inside of the
parentheses you're going to type hmm
let's say three a yield statement cannot
be used inside of the function update
that's just the nature of it and the
reason why is because in the function
update it is called every time the
computer draws a frame and so if the
function update is slowed the computer
would stop drawing frames so you cannot
yield in the function update you have to
call a separate function to yield sweet
now let's yield the three seconds then
say the door dot animation dot crossfade
and then close you could also use the
open animation again and then just
reverse it though that's a little bit
more difficult then we could again
insert some audio we could say the door
dot audio dot play one shot like this
but I'll just start play but again this
wooden wouldn't really do anything
except at the odd tensity to it so you
can you could leave it there you can use
it it's up to you so I'll just leave
that commented and then door is closed
equals true because now the door has
closed again let's see if this works
hit play go over to the door and now we
should press E
now keep in mind that we have still not
added an animation so let's go ahead and
make that first so I'll just quickly
save to make sure that we don't lose all
of this work now I want to select the
door go to window animation and press
the record then ask me to add an
animation component which we will do
you're going to go and save it under the
animations folder call this open and
save now I've prepared the story for
actually for making this animation and
I've done that by making sure that the
pivot point of the anchor point is in
the right side actually down here to be
more specific and this way when I go up
here and change the pivot point to pivot
and not Center I can just rotate it
along the y-axis and it will work fine
as a door animation so let's go under
the rotation Y hit add key then go move
forward about a half a second and
animate the door and you can make it
open whatever you want the way you want
and you can also choose how much I'm
just going to write a prefix value of 90
or minus 90 actually minus 90 great so
now if we hit play the door will open we
can also make it fade a little bit by
selecting the keyframe of the start and
headflat
selecting the keyframe at the end and
hit flat now it should smooth them out
the animation of it awesome now let's
create the close animation the same way
so go to the registers open here and
create a new clip again we're going to
go under the animations folder
we're just going to call this close and
I'm just quickly going to make it the
same way so this time we'll start at
minus 90 we'll move forward and then
whoops didn't start at minus 90 so we
are going to start at minus 90 then go
forward a half a second and then go back
to zero and I'm going to select all of
the keyframes and flatten them like that
like that so when we hit play we can see
the door closing again now let's hit the
stop record and see if this works
play and we can see that the door opens
all by itself that's because we have the
animation set to play automatically so
select the house door and disable the
play automatically and now we should see
it working so I hit play walk to the
door it says press e to open we press E
and we can now move through and the door
will close automatically behind our back
so that's it for making a door open and
closed I hope you enjoyed the video and
I'll see you in the next one</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>