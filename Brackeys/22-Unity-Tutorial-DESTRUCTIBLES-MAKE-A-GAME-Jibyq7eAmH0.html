<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>22. Unity Tutorial, DESTRUCTIBLES - MAKE A GAME | Coder Coacher - Coaching Coders</title><meta content="22. Unity Tutorial, DESTRUCTIBLES - MAKE A GAME - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Brackeys/">Brackeys</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>22. Unity Tutorial, DESTRUCTIBLES - MAKE A GAME</b></h2><h5 class="post__date">2015-06-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Jibyq7eAmH0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">thanks for tuning in at brakus hello
everyone and welcome to video number 22
in make a game a cool series on making a
video game in unity in today's video
we're going to take a look at something
really awesome which is destructible
objects so objects that will fracture
into multiple pieces and then have
physics applied once we interact with
them in a certain way and how we're
going to be implementing this today is
by making our player destruct whenever
he's killed killed by an enemy we're
also going to fix a tiny bug which makes
it possible for us to kind of get
multiple game overs which is kind of
annoying awesome so that's the schedule
for today and without further ado let's
just get right into it you will note
however that at some point we're going
to be using blender in this tutorial
that's not because you are going to need
blender in any way I will of course be
providing the model but I thought it
would be pretty quick and easy to show
you how you can actually do this
yourself
cool so first off let's fix this
multiple game over back and I'll just
see if I can kind of get it to do it as
we speak here so I'm just going to turn
on the volume on my monitors and
hopefully that won't be too disturbing
here but
there you go we got two game overs and
it loads the scene two times so in order
to fix this we actually already have all
of the logic in place we simply need to
do an if statement inside of our kill on
hit script so double click that to open
it up in monodevelop and also we'll also
open up the game master script just so
we can have a look at what's going on so
remember we made this static variable
called is restarting and we kind of
managed this inside of our restart level
our method well now it's time to put it
to use so inside of our kill on hit will
only call the game master restart level
if game master and remember this needs
to be capital letters because when
accessing a static variable and not the
instance dad is restarting this equal to
false so if we are not currently
restarting well then we can just go
ahead and restart the level code so and
basically we can just save that out
remove these and close our monodevelop
and then now when we hit play and roll
over and I'll just turn on the sound
here
it will only do it once we can go ahead
and move on to the exciting part of
today's tutorial which is distracting
the player on impact so in order to do
this I actually want to kind of redo our
ball object because currently we are
just using the default unity sphere
instead I want to construct the sphere
very easily in blender and then I want
to kind of fracture it into multiple
different pieces and then inside of
unity we can spawn these pieces give
them some physics and you won't be able
to see that we are actually swapping out
the original sphere with a new one
hopefully at least that's the dream so I
hope that this is going to be looking
really cool so what we are actually
going to do is simply opening up blender
so blenders are free modeling a piece of
modeling software oh yeah I forgot to
mention if you have any questions go to
farm table register calm but blender is
a free modeling software and it's a
completely open-source so if you want to
be a part of it it's called the blender
foundation but if we just go to
blender.org you can download the version
that I'm using here which is version 2.7
4 that's the most recent stable stable
build and you can download an installer
here and it's of course also for mac and
linux so it's it's very multi-platform
and it's actually their really great
tool it's it's definitely capable of
much more than we're going to be using
it today so let's just open up blender
and you will be met by this starting
screen and once you get in here we are
going to right click on the camera here
and on the Sun and finally on the cube
while holding down shift to select all
of them and then we're going to hit X
and then click delete in order to remove
those objects when you're just starting
out in blender you will notice that if
you hold down your middle mouse button
you can pan or you can kind of pivot
around the center point if you then hold
down alt while doing or shift while
doing so you can
you can drag and you can just scroll to
zoom or control and middle Mouse
so that's kind of the basics of
navigating and we're not gonna be doing
any of that
basically so in order to get started
here we're just going to have hit shift
a that will allow you to add a mesh
object and we're going to add the UV
sphere then we can assume closer in on
this and the number of segments that you
want the sphere to be and simply how
many subdivisions it's up to you you can
just choose the one that you want whoops
and I'm just going to go with the
default of 32 segments also we want to
change the shading on this from flat to
smooth in order for this to look like a
proper sphere so let's just you can
round out the surface then up in the
right hand panel here we have basically
the hierarchy and inside of this I
believe in blender is called the graph
real but new it's probably not the
outliner is what it's called I'm not a
very rapid blender user excuse me so we
are simply going to rain rename this to
bowl and what we are going to do now is
we're going to kind of UV unwrap this
and basically what that means is that we
can to take all of these faces and
points called vertices inside of the 3d
view and we're going to lay it out on a
flat plane so we can put a texture onto
that and that's kind of a whole science
and some people find it really difficult
including myself but we are just going
to do a very simple automatic unwrap and
it's going to look pretty great so in
order to do this what you want to do is
you want to go up here where it's
default and change to UV editing then we
can hit tab to go into edit mode or you
can change it down here then we're going
to hit view in order to unwrap this but
we're going to select the automatic
sphere projection and this is going to
give us a
really bad unwrapped I'm not going to
lie there are so many ways to unwrap a
sphere and some probably most are much
better than this one but in order to
just get on with the tutorial this is
going to be just fine especially because
we are only going to be viewing this
sphere from one angle and it's only
going to rotate along one axis so that's
going to be just fine and now we can
actually add a texture to it when we are
back in unity if you don't do this
you'll probably just get a single color
because all of the points just maps to
one point on a texture and that's going
to equal only one color now this will
actually overlay a texture cool so I
just hit tab again to go out of edit
mode and we can go back into the default
view now we want to do you kind of do a
fracture on this object and that uses a
plugin that can be enabled from the user
preferences so push ctrl alt U or go to
file user preferences and in here you
can change all kinds of things in
blender we're going to be using the cell
fracture so you can either search for
cell or fracture and simply enable
enable it here make sure that you have
the version that I'm using or a more
current one in order to get this plugin
cool so what we are going to do now is
go over here on the left hand side and
just hover over it and a new button will
appear called the self fracture button
now in here we can simply click that and
it's going to open up a whole other
panel with a bunch of settings basically
we want to limit and the amount of
objects we get to 15 because that's
going to be plenty and you can't do more
but remember that we're going to have
rigidbody objects with mesh colliders on
each of these so you the more you do the
more taxing on the computer that should
be pretty self-explanatory also we're
going to bump up the noise to one just
to get some randomness in there and on
that we can just leave the settings s's
and hit OK now basically it will look
like nothing as chain
except for in the outliner where we can
now see 15 cell okay it only the twelve
but we can see twelve cell objects but
we can't really see them if we click on
them in side of our perspective view
here so what we inside the viewport so
what we're going to do is we're going to
change over to the layer that these are
on because if you look down here you can
see that we have objects on two layers
so this is the first layer and that's
just our Bowl and this is the second
layer where all of our fractured bits
are and if we just right-click on one of
these and drag it out you can see that
we now have these solid pieces that the
cube is split been split into so that's
awesome that's basically all we need to
do inside of blender the waste the rest
we can manage in unity so now let's go
to file let's say this and the real cool
thing about blender is that it
integrates extremely well with unity
because we can just save the blend file
we don't even need to export to any FBX
or anything like that we can simply save
it as a blend so I'm just going to
navigate to my unity full folder here my
unity project which is make a game go
and do assets let's put it under models
and let's rename this to player or bulb
blend that's pretty much up to you I'm
just going to do player blend and let's
save as a blender file now we can simply
minimize this go back into unity
come on unity there we go and unity is
probably going to recognize that it has
a new model and there it actually
imported really quickly what I want to
do you can see that it automatically
creates this materials folder I actually
want to go into the import settings and
just remove that I don't want to import
any materials all of these settings you
should pretty much be able to leave
except we're going to change the scale
factor to 0.55 and that's a magic number
but when I was playing around that
seemed to look pretty close to the
object that we have here now let's hit
apply on that going to the rig
like none hit apply and do the same
thing with animations ok that's disabled
with the rig that makes sense so now we
can simply remove this materials folder
because well it's unnecessary to have it
there and you will notice now that if we
close down blender you can simply double
click this at any moment and it will
open up in blender and you can make
changes save and it will update inside
of unity so it's really really easy to
do that cool so let's drag this player
object into our scene and it actually
looks like it's a bit too small now but
what I want to do is simply find the
ball object here because that has a bit
different scale so if we drag it onto
the ball object it actually looks a bit
too big so let's try 0.5 instead I like
to change all of my scaling in here I
think it makes it easier yeah and then
that's actually pretty on point cool so
on the ball object itself we're going to
disable its mesh renderer so we can
folks focus on the player object here
and I'm going to go ahead and rename
that to graphics then under the graphics
we're going to have this ball object but
I also want to add an empty object and
we're going to reset the transform on
this and this is just going to store all
of the ball pieces so we're just going
to leave all pieces or fragments or
whatever you want to call that and drag
the ball cell onto that and yes we want
to just loose the connection we can get
that back at any point so now that we
have all the bold pieces here we can see
all the cells and first off let's just
disable the bold pieces and select the
ball here and find the proper material
so we'll just get the ball wood one and
you can see that the unwrap is quite
decent I mean it it gets really tired up
here but from the side here it looks
kind of alright so inside of our
graphics we want to kind of change this
we can but I think if we see it from out
here it's going to look just the same
basically so I think we're pretty
satisfied with that you can of course
just do a quick Google search on a
sphere a UV mapping in blender but this
is going to work for now so the bowl
here is simply going to store a mesh
renderer and I was thinking that we
maybe want to move all the far rigid but
we are going to keep our rigidbody logic
here and the same with the sphere
Collider then we're just going to
disable that and disable this graphic
here and then enable the bold pieces so
once we have that in place we can
disable that and enable the bold pieces
instead and you can see that they also
need a material to be applied so we are
simply going to select all of the pieces
and you can multi edit like this and now
select the ball wood material and it's
going to look just like the non
fractured one but with all of these
pieces then in here we can simply add a
rigidbody component and we are going to
set it to use gravity and all the
default settings there and a mesh
Collider
however we however we want these mesh
colliders to interact with other image
colliders we want them to interact with
each other and in order to make them do
that we need to check the convex and
that's simply a simplified version of
the mesh Collider but they will now
interact with each other and you can see
this is only 5th pieces if we had a
hundred pieces here the calculations
would be crazy and fairly unnecessary so
now that we have those I think it's fair
that if we just if we just test this out
so I'm simply going to click is
kinematic on the rigid body so that it
stays in place and disable the sphere
Collider on that and we should be able
to just see what this looks like
in game and you can see how cool that
effect is when it fractures and all
these pieces go flying now you can of
course add some force to these but I
kinda like the
just calm a fracture there why they just
fall to the ground awesome
so let's rien a below or uncheck is
kinematic on the rigid body and
re-enable the sphere Collider there then
let's disable the ball pieces and enable
the ball and let's now update this
prefab cool so now we're going to be
creating a script that will actually
trigger this logic on the ball and the
question is where we want to kind of sit
the script and so if we find the script
that currently kills us the kill on hit
here you can see that it has this
restart level functionality which has a
short delay well I think that we should
just use this and then maybe find a
reference to our Bowl it's kind of what
I've thinking I'm thinking here so if we
go into here and in the function we can
type a Collider and we're just going to
call this hole info for collision info
or Collider info and then we can say if
Col info dot and for some reason the
auto-completion in monodevelop YZ is
being really annoying with me today and
that's kind of so I'll just hope that I
can now bring this but let's see we have
the ball tagged as players so we can say
if Colada info tag sequel to player then
we want to find some stuff on the player
the the question here is basically we
can handle all of the logic in here or
we could have a script that sits on the
ball here that basically handles
everything for us and then we can simply
call the destruct method on that script
and I think that's what we are going to
do so we're simply going to keep this
for now simply comment this out and say
get the destruct component call the
destruct destruct method cool so now we
know what to implement here and then we
can go ahead and simply create a c-sharp
script on the ball and we are simply
going to call this self-destruct or is
destructible it's that better it's
probably better so destructible but this
is going to be pretty specific to the
player right now but I think you should
be able to tweak this in order to make
other objects destructible I mean this
is just the kind of logic that will
trigger the destruction we've kind of
already made the destruction itself so
we can delete the using system that
collections namespace that's not
something we're going to be using and
then we can make a public void that will
do stuff for us here so we're going to
make a public void and we're just going
to call this destruct and/or not public
lord I am so used to see sharp for some
reason I created a c-sharp script here
I'm sorry that's just kind of automatic
from now homier of the series I in
c-sharp okay so we're going to do self
destruct and this is going to be of type
JavaScript and again we want this to be
constructible in JavaScript there we go
so sorry
cool so let's load this up and yeah so
in here and we are simply going to make
a function and we are going to call this
destruct for some reason I just can't
build that correctly and inside of this
we basically want to disable the
rigidbody we want to disable the
collider we want to enable the pieces
and we want to disable the whole ball
model
so that's kind of a lot of references
that we need first off we need a
rigidbody and we simply cannot call this
gab really just going to call this rigid
body like this we need a reference to
whoops again the c-sharp that's crazy
okay we need a vibrated body of type
rigid body like this and we also need a
bar and this is going to be the
reference to our collider and currently
we are using a sphere Collider so we
need a bar sphere Collider or var
Collider of type sphere Collider we also
need a I think it's rigidbody just with
a non-capital yes it is
we also need a reference to our pieces
so a VAR pieces type transform and bar
and whole ball of type transform cool
hopefully I caught that right now in the
destruct method and we need to do
rigidbody dot and I believe it's just is
kinematic and we're going to set that to
false or to true I mean then in here we
are going to say Collider dot enabled
equals false we are going to save pieces
dot set active and we're going to set
them as false or as true now and we're
going to set whole ball dot set active
false okay that's that definitely some
errors in that also we have an
unexpected token that's because again I
wrote this as C sharp so this is going
to be our Collider info and it's going
to be of type Collider there we go so
let's check this so we have an ambiguous
reference rigidbody destructible so why
is this imperious let's see rigidbody 10
is kinematic and that should be or oh
that's because it automatically declares
the rigidbody so this is just going to
be Paul Richard party and it's going to
be the same to Collider so Paul Collider
and the set active is not a member of
transform then it's a member of game
object let's see how we went with that
and we have no errors so that's amazing
sometimes when auto completion doesn't
work you just question everything you do
cool so let's see if this actually works
and of course we're going to have to set
up a bunch of references so on a ball
here we'll simply drag in the rigidbody
the drag in the sphere Collider we drag
in the ball pieces and the whole ball ok
so now let's actually implement this
into our kill on hit on script so first
we want to get the destruct distractible
component and in order to do this we'll
make a new variable we call this
destructible but with a small D and then
we'll simply say that it's going to be
of type destructible and we're going to
set it equal to get component or our
call info dot get component and we are
going to get the component destructible
and simply covered in here because it's
it's not going to tell you if it's wrong
and till you run it and then we're going
to cast the
as a destructible so we are basically
gonna tell 'add that the component that
we want to get is of type destructible
so that's kind of a clumsy way to do it
but it works and then in here we simply
want to tell it that we let the method
that we want to call is called destruct
so we are simply going to call the
destruct method so we get a reference
and we call the method that's a very
normal way of calling public functions
cool so now that we've kind of saved
that out we should be able to head back
into unity now and this is going to work
a pretty nicely actually it's going to
work just fine just until we respawn so
have a look if we play here and we roll
over we should dissolve and we do but
when we respawn we respond in a bunch of
pieces so that's kind of not what we are
looking for so basically what we want to
do here is we want to kind of we or
undistracted sums and in order to do
this there are a bunch of things that we
can actually do we want a method that
will kind of enable all of these
components again and we also want a way
of kind of resetting up all pieces so
instead of keeping track of their
positions and resetting them what I want
to do is I simply want to make the ball
pieces a separate object that we can
then spawn in so we are simply going to
re-enable this and we are going to kind
of drag it out here and we are going to
lose the prefab connection then I want
to apply this ball and then I want to
make the bold pieces into a separate
prefab and I'm just going to drag that
into the prefabs folder and I want to
reset the position on those so now that
we have that going for us we can just
leave
the bold pieces and we want them to
scale with our ball here so we'll see if
they do that when we instantiate them in
so what we can do here is we can find
our ball
we can go into our destructible script
and in here we want to instead of
setting active some pieces we want to
spawn them in so first off we want a
reference to the place that we are going
to spawn them in and that's going to be
of type transform and we'll simply go on
going to call this the pieces parent
then next up we want a wire pieces
prefab and that's also going to be of
type transform this way we can simply
instantiate and what we want to
instantiate are the pieces prefab and
where is the pieces parent dad position
and pieces parent dot rotation and then
we can parent the pieces onto that so
we're going to set the pieces ok we want
the reference first here so we are going
to make a var and this is going to be
the clone that's kind of standard
calling it the clone in unity and then
we want to do clone dad and we're going
to set parent equal to the pieces parent
and this is probably going to complain
about a that we need some casting no it
actually does that for us in JavaScript
so hallelujah cool so the pieces parent
here we want to just right
records and the piece is prefab we want
to find that in our family I'm
navigating there and dragging the ball
pieces prefab now we can apply this ball
and we should see this working just as
we did before and so it's not going to
fix the back there and indeed they do
actually scale down so what we can do in
order to kind of fix that is we can just
fix the way that we have scaling set up
at the moment so if we find our models
find a player object and just drag it up
here we can simply should simply be able
to take the scale factor here and find a
a scale factor that reminds a lot of
groups of course want to set the scale
here to 1 1 and 1 and that actually
looks pretty good I think so let's just
make sure that our sphere Collider is
actually good on that so zero point
seven this one we're going to go with I
think so now that we have that set up we
can simply delete off the player here
and now that should be completely synced
now we don't have this weird scaling
issue and that's why I like taking care
of any scaling inside of the scale
factor so now when we play here bump
into him
you can see that it smoothly transitions
on that so the next thing that we are
going to do is we need to reset the bowl
so we need to remove the pieces and we
could keep the pieces there and never
actually parent it now that's none
that's interesting so let's just not
parent this at all
but we want to keep the position and all
that so it's not going to go back with
our player so if we try this and hit him
the piece of pieces will stay there and
they are independent of the rest here
and they can actually be there for as
long as we want so I think we're going
to destroy them after a certain amount
of seconds but it's pretty fun that they
are therefore kind of for a little bit
so let's destroy the clone here and we
might need to do that game object on
that one I'm not sure we're going to
find out and we're going to destroy them
after that say ten seconds let's just
give it a while so if we play here we'll
find out if game object will do game
over and a yeah indeed so incensed
against these will disappear cool
so oops nope ah destroying the transform
component is not allowed so we actually
need to do that game object oops game
objects on that one
so let's a play here this is going to be
a pretty long video I might need to cut
it up we'll see over so there and we
should actually see these destroying now
I'm just gonna make sure we'll just wait
the ten seconds and yeah indeed they do
disappear cool so what we want to do on
the bowl is we want to read in able this
rigid body and we want to re-enable on
the or we kind of set the is kinematic
to false again I'll rename will build
the sphere Collider and the ball here so
I suggest that inside the game mastery
where we already have a reference to a
ball we can simply call a method so
we'll just do a function D destroy or
distract and then in here we'll just
basically reverse this code so we're
going to set rigid body that is
kinematic to false which is going to
enable click lighting we are not going
to do anything with this prefab and
we're going to set the whole ball dot
set active to true
and now inside of our game master object
and excuse me if I'm going a bit fast
here but the video is getting kinda long
inside of this what we can do is we can
simply find the player here when we are
restarting the level down here when
we've setting the position to the latest
latest checkpoint we can just do player
or again we're just going to do
basically the same that we did in here
so we can just copy this if you want to
be really effective so we can just get
the destructible component and whoops we
are going to get it from we're going to
get it from the player here and the main
a coldie not the destruct but the d
destruct so I think this should actually
work and if you go ahead and bump into
this guy we fall into pieces our ball
will appear and again it's the same Bowl
we didn't have to spawn in a separate
prefab and now there are these fun
pieces to play around with it and they
will disappear so it's not unreasonable
the amount of pieces but they are there
and of course if you're not satisfied
with the pieces here I made them kind of
quickly you can just go back in to
blender and tweak them I mean it's as
simple as double-clicking the file so
excuse I excused the video being so long
but I think that it was a pretty fun
thing to do and yeah just play around
with it I hope you enjoyed the video and
I'll see you in the next one</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>