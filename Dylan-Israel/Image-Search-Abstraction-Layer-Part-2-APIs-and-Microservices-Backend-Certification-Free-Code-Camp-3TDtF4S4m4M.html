<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Image Search Abstraction Layer Part 2: APIs and Microservices Backend Certification Free Code Camp | Coder Coacher - Coaching Coders</title><meta content="Image Search Abstraction Layer Part 2: APIs and Microservices Backend Certification Free Code Camp - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Dylan-Israel/">Dylan Israel</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Image Search Abstraction Layer Part 2: APIs and Microservices Backend Certification Free Code Camp</b></h2><h5 class="post__date">2017-04-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/3TDtF4S4m4M" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright guys so last time we did a lot
of stuff the next thing that we're going
to do is we're going to go ahead and get
all the search terms from the database
so that we can have that endpoint made
so that's going to be apt-get so we're
in create a location to return that data
or the route rather and that's going to
be slash API slash recent search recent
searches and then in here we're going to
have our call back which will be the
request the response and next and all we
have to do in here to complete this last
section now it's at the most recent
searches so if you want to go ahead and
do that I got kind of tired I assumed
the project but shouldn't be too hard to
figure it out but to get all the
responses we do search term dot find and
you can see right here we have some
brackets those those would normally be
the parameter so we wanted to find one
where the parameter matched everything
we're just looking for basically an
empty object so it's in return the mall
and we have this air or data so the air
is if there's an air and the data is
basically what we're getting back and in
here you'll see that we are just going
to go ahead and read a song back Aida
now if we go to here we should go ahead
and get the entire collection database
we make sure my node server is running
so it is wait this is our cool so now if
we go to API slash recent searches of it
you'll see we get a whole bunch of
things test data test test these are you
know they all say test it just goes
there blog website test test one you can
see we get all our search values we're
basically getting all the recent
searches
and so we're getting all of our search
values back piece like these and
additional data their ideas when they
were created when they research and
things like that so we did that part
next thing that we need to do is we just
need to go ahead and and do our Bing
call where we're actually going to use
that being API we set up way back win
with our API key and all that to
actually get the image data so the first
thing that we want to do here we want to
do is is we want to do Bing images now
if you looked at the Bing the node let's
go to actually bring that up so node
that being API if you looked at the NPM
package data you'll see that we how we
set it up but also this is web search
but if we just want to do image search
we call that Bing object that we created
or required and then dot images and this
then this pass in the search term right
here and then the number of results we
want to see the number of results to get
in this case it maxes out at 50 so we're
only going to be able to have have the
user go off set of four or five and skip
skip the first three results so like if
you don't want to get the first three
main ones it's cool so like how we're
going to set up our logic is we're going
to bring images and then we're going to
pass in our search term right here and
then from here we're going to pass in
this top and then a skip and what we're
going to do is we're going to create
some variables with some if our else
statement so this gets a little wonky
math way but this is one way I thought
of doing it there's probably a cleaner
way I didn't see anything in the
documentation to note it let's say you
wanted to skip the first page you would
multiply let's say this is 1 by 10 and
this by 2 so you get 20 results and
you'd skip the first 10 that's how we
ended up doing it all right so let's
just get it to work first
before we start worrying about the
results so let's do being got images and
remember we we just looked at
documentation so we're going to pass it
in our search term here and then we're
going to pass it an object and the top
we want the first ten and then that's
enough for now
and then we're going to have this
function looks like syllabus this
function here that is air the air and
then I have this rest here like this
because we are getting a an issue where
when we try to JSON it out our response
here this was originally like like this
for a response it doesn't really matter
what you name this book so I just change
it to res and then the body the body is
actually where all the data is getting
returned from our in from our being
images is going to be located so let's
go ahead and just take a look at that
right now if we do read saw JSON the
body and you can see how much data
actually comes back to get an idea of
what we're going to do max
in this case oh who is the URL API slash
image search slash search Val so we'll
go back here and our offsets not going
to do anything right now but we don't
even need that that's optional so if we
go to test it'll take second but you can
see we get a whole bunch what's the type
these are images you get this page load
URL the redirect link but what we really
care about is this value array right
here this value array is where all our
items are so there's there's a whole
bunch with our web search URL our
thumbnail URL our content URL our host
page URL and our name so this is going
to be the data we're going to return the
web search URL we're going to return the
name the thumbnail URL and then the host
page URL that's the four pieces of the
data
we're going to do return for that so
before we worry about the offset and
jumping pages let's just go ahead and
return that data the easiest way of
doing it in my opinion hangout is just
create a little array called Bing data
and what we want to do is we want to go
ahead and add 10 items to the array so
we're going to have this for loop just
for VAR eyes it goes 0 and remember
we're always going to have 10 so we
don't have to really set this to a
variable or anything like that you could
it probably be better but if you know
you're never going to change that number
or you're always going to want to return
10 you can go ahead hard coded like so
but what we want to do is we want to
take being data and we want to push some
values onto it and these values are just
basically the json key value pairs that
we got from our big data set here which
remember this whole thing is the body so
it'd be body this is the body and then B
dot value and then the item that we're
iterating on plus the name of the
property so let's go ahead and do that
the first thing we're going to do is URL
and this is going to be body dot value
and we're going to pass it in the eye
because we're iterating through it dot
web search URL and the next thing we're
going to do a snippet which is body
value I thought name and the next thing
we're going to do is thumbnail which is
body value
I thumbnail no capital element thumbnail
URL and finally last but not least we
have context which is audio Dalek value
item we're iterating on dot host page
display URL alright and then finally we
want to just go ahead when this for loop
is over want to res dot JSON that data
well in a response we want to return in
JSON format we want to turn the data
right so let's make sure that that is
working so if everything is good we
should get whatever word we put in here
let's say we do Pokemon so we get the
URL and we'll just click this so this
comes from this site here the thumb NIT
what's this thumbnail URL so book about
school so we're getting the data
properly right um that's that's it
besides that we just need to set up the
offset parameter this is where the math
part gets built in clunky just because
the district goats love that just just
because of math alright so let's put a
note here save to your search term
collection capital team alright so next
thing we're going to have here is some
values to see if offset does anything so
offset is remember our offset value here
that is a query from the query string so
it does offset exists that's the first
thing we want to check and we're also
going to have this variable here called
var search offset and you'll see in a
second why this is created but
essentially what we're going to do is
we're in our top remember our top
controls how many displays then we're
going to have a skip value here which is
going to be 10
times that offset their times our offset
our offset query string and then we're
going to have our top which needs to
increase as well right so that's going
to be 10 times search offset now the
reason that we can't just have this like
this without any logic that we're going
to type out is if this is 1 and this is
1 these are going to cancel each other
out so it always has to be one more but
if this doesn't exist or it's 0 this
still needs to be 1 and so on and so
forth so there's just some basic logic
and even me talking over it now I know I
can write better logic than what I did
but we'll go ahead and showcase this but
the first thing we're going to check is
those offset exists so we just do this
like if offset now the next thing I'll
do is if offset there's another
initiative if offsets exactly equal to 1
we want to set offset equal to 0 so that
we don't skip any remember so because
you can't skip the first page offset by
1 means you're on the first page based
off our logic right so you can't skip
the first page so this is going to be
set to 0 while we're going to go ahead
and set search offset equal to 1 and
after that all we have to do is put
another else if statement here basically
saying if that's not true if offset is
greater than 1 go ahead and set search
offset equal to offset plus 1 so let's
just go over this real quick in our
first thing here we just have a multiple
here to get more than 1 items the second
skip is how many to skip and skip should
always be 10 less a multiple of 1 less
or a total of 10 less than the amount
that we're returning and so this is just
a little bit of logic to make sure
that it does that basically and it can
be written better and I know it but uh
but this is one of those things where I
did a video about refactoring and if I
was going to refactor my code this is
one of the sections I would do it in
let's go ahead and make sure everything
works so we did Pokemon so now if we did
offset and remember this is the well go
ahead and click the thumbnail so that
you can actually see that change and
will actually click - just in case for
some weird reason we hit two of the same
values so if we do offset is equal to
two we should be in the half twenty
results and we're going to skip the
first ten but we should still get the
total value of X so this was our first
picture and we'll check real quick
you'll see we have a new picture and
we'll do the same thing for the second
picture this is our second picture which
is not equal this so based off that we
can kind of assume that it's working we
could do more detective work but that's
basically the image search abstraction
layer on free code camps API and
micro-services section the one thing I
the one thing I would say about this is
I think the instructions were poorly
written and even though even though I
consider the backend a little bit more
advanced I think that's where a lot of
people probably were having issues if
they're kind of knew this or they
decided go in the backend before they
learn front-end development but all in
all I enjoyed it it was a fairly easy
task as long as you understood that you
had to use an API to do it I hope you
guys enjoyed this I'm going to continue
working my way through the backend
projects as always thank you for the
support don't forget to join our
Facebook group code tech and caffeine
the link is in the description below and
if you want to support me you can at
patreon.com slash coding tutorials 360
stay motivated you guys keep working
hard I appreciate you all and I'll see
you in the next video hey guys thanks
for watching the video if you're
interested in coding boot camp check out
dev Mountain comm where housing is
included in your price of tuition and
don't forget to Like comment subscribe
and share and support me on patreon I'll
see you guys the next
oh thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>