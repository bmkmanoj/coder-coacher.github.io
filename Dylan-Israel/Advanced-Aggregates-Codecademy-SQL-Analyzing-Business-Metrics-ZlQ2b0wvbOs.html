<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Advanced Aggregates: Codecademy SQL Analyzing Business Metrics | Coder Coacher - Coaching Coders</title><meta content="Advanced Aggregates: Codecademy SQL Analyzing Business Metrics - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Dylan-Israel/">Dylan Israel</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Advanced Aggregates: Codecademy SQL Analyzing Business Metrics</b></h2><h5 class="post__date">2015-12-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ZlQ2b0wvbOs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">code everything alright guys we are back
in code CAD me they're doing a preview
of one their record new courses SQL
analyzing business metrics so this is
something I know a little bit about not
necessarily with SQL but um being a
content creator on YouTube
you get very addicted to analytics and
all analytics are are your YouTube
subscribers views what what percentage
it's basically just a bunch of
statistics regarding your channel and
the way that's done is through a
database and you know giving it in a
format that's a little easier with
charts and stuff like that so it's very
important to businesses and anybody
trying to look at the numbers to see
what we can do better so that's kind of
what it's gonna be going on here so
we're starting unit 1 advanced
aggregates advanced aggregates let's sit
here so this is asking us to familiarize
our stuff so let's go ahead and jump
right in so it's asking us to select
when we use the star that means all from
our orders orders is our database by the
ID and limit it to 100 or rather it's
like 100 rows so you select all from
orders o order by
and we're saying order it by the ID so
see how it's sorted by here cool so this
is our hundred things of data not the
only way we're sorting it right now is
by the ID so the order lists individual
food so now we want to select from order
items and order it by the idea limit by
so let's see what it what data we end up
getting from here so we're gonna select
all from order underscore items database
or table excuse me order by ID and limit
that to 100 then when we run this and of
course make sure you spell order
correctly order items or dear I'm sorry
I'm sorry right
select all from order underscore items
order by ID limit 100 oh and of course
check out your previous line you can you
only want to be querying it one time
otherwise you're gonna be at least in
our results here we're going to look
excuse me game over occult I get two
queries and we only have one place to
output them right here so let's move on
so we want to use the date function the
cast time stamps and ordered at to date
it's like alright so let's delete this
first query here and whereas I select
date ordered underscore at order timer
Scrat so selected dates order that from
our orders table and then order by one
and limit
limit 100 let's run that so you can see
that it's ordering it it's ordering the
dates here
the dates they've been ordered at excuse
me
the order dat is the date and then we're
organizing it in the date function date
date pattern so group and count orders
by their dates alright so again at this
point we're slowly beginning the hang of
it
comma count one from orders order by one
group by one order by one by one we're
not gonna have a limit so let's take off
this limit and then we want to group one
typically you'll be able to understand
what's going on in your query after you
run it and you say okay so what's going
on with this count in this case we're
counting everyone that the dates are
ordered at on the same date so we don't
have any repeats as you see as we go
down here so in this case only one thing
was ordered on the 9th on the 11th five
things were one thing on the 12th but we
don't have oh nine oh nine oh nine
that's what's kind of going on here all
right we can make a few change to our
daily count query to get the revenue so
now you can see that we're kind of oh
let's count our revenue in this period
of time compared with the previous
period of time and now we can see the
growth or we can see the increase and
you know make decisions about your
business so that's kind of what the
importance of is all this so we got a
lot of coder here so we're going to
select the date oops
date of order brat and then we are going
to go around the sum of the amount times
are paid I'm not sure what that two
point means quite yet orders and then we
want to join order underscore items on
orders dot ID equal to orders for items
dot order underscore ID
last ones a long one hemming group by
one and order by one now let's see here
some the daily revenue
well we typed it all out let's just copy
paste it in there see what happens
um I believe it doesn't matter if we
type it all in one line so I probably
just messed up on systole okay so this
to here when we are rounding it means
that we're rounding it to two digits
cool so if it's just a zero it's not
gonna round it away or point five but no
more than two so at the small change
tell us how much we're making per day
bye ain't for any single dish what's
today they're having to taking kale
smoothies so select date order that
around some from orders are in order and
I had one orders ID
use a where clause oh and then last but
not least we're gonna add where so we're
gonna say we're basically this is kind
of I think of it as an if so where if
the items dot name is equal to Cal
smoothly we added
yeah
moving on uh this one was a pretty low
typical day as thousands of rivers ooh
but a small percentage was that's coming
from kale smoothies okay or you can get
the percent of revenue each other I mean
you know total revenue each item so this
case let's put this in here so we're
gonna select the name and so we know
what we're pricing so we can see that in
the same category then we're gonna round
it to two places for the total sum of
the amount paid and we're gonna do this
from our order items table and then
we're gonna group it by name and order
by two descending let's see what that
two descending is so descending is
greatest de les I'm not sure what the
order by two is let's see if it they say
next one
so sort the items in the second column
to show the products in order of their
contribution to the revenue all right
that's what the order by 2 is so in this
case select the name then the amount
then round this the amount to two places
except we only want around it to 1 and
then we are going to select slash I
select the sum of the amount which were
paid from order for items for all
100 point out oh my - PCT so from your
honor why she was sitting so let's take
a look at this see if I got this Christ
- select name don't paid I'm gonna take
off one of that slash like some I'll
select some amount paid for okay let's
go ahead around that and see what
happens so cool that worked and now we
have the percent of each product
represents so duh the grilled cheese is
21.6% so this is if you just think about
it for a second so sum the sum of the
amount paid from order items times one
hundred percent and to the second place
but we're dividing our original sum so
we're just this is just basically the
divided by the total amount so that's
that's kind of what's going on here it
just looks a little more complicated
when you write it all out as a SQL query
alright so we'll build our home
categories using a case statement we can
list out each product and decide its
group out of category column to the okay
so I'm just gonna there's a lot here so
I'm just going to ctrl C it in here and
trying to explain it so it's saying
select all and for the case using a case
statement so this is how we can set up
the switching of values they're setting
up a values so in case name when it's
kale smoothie then add the smoothie
category when it's orange juice add it
to the drink category or when it's soda
drink BLT sandwich and then you know
chicken parm dinner else just put other
and then do this from our order items
table and then order it by the ID so
it's going to be ordered by ID and then
you can see it goes through here and the
automatic setting up of our new cat
Gouri area or if category was already in
there oh and as category so this is
where we establish that it goes in a
category column pretty cool
now then use the name generated category
column in a previous revenue group to
group by so in this category and then we
want to round 1.0 times the sum of the
amount is 100 to the second decimal and
then we won't have that as a percent so
when we run this you'll see that now it
has to total four sitting here but we
didn't finish it so we're only getting
one ID and everything's gonna mess up
here let's see I so SB CT from ordered
items order by two descending this
oops I may have crashed it for winners
oops I did this on end just category I
should not have done that I forgot a
part of what it was though you're trying
to do here so I'm gonna refresh this
page I think I may have just crash the
page it's gonna just refresh it hope
that we didn't break it
there's chemistry
so
in this category so we're ending it with
the category rank and then we're so we
had all this week guys already we have
around 1.0 times the sum of the amount
paid so the total sum and then divide it
by the sum of everything from order
items times 400 display that's a PCT
percent captain
and then whatever fight to your so this
is kinda what's going on here is just
again it looks really complicated it's
just a lot of syntax that we're going to
learn but it's it's very intuitive and
more easier
my secret bases and eventually if you
just repeat these lines select all table
so in this case we're going to select
the name
very linguist is
sure if this is how many
Isis is the co orders
the distinct order ideas ID number they
have and
$6.99 okay
in a way we're getting
by soaring to
now we want to
collectively
see how this works great so this is when
you put as as we're giving the column
name we reorder rate and we're selecting
that data from order items and joining
order items order underscore items on
order ID and this is the reorder rate
cool so a lot of stuff going on in this
first introductory course but if I had
to break it down what you need to know
this is the bare minimum you need to
know select all from table and then that
is the bare minimum what's next next we
want to get that this basic statement
from from our we want to get this this
is step one what step two where column
or something whatever million comments
you just keep on expanding and then
divide by it and then how do I divide by
sentence and eventually one can see how
they're you know just continue with
getting better and eventually will be
taken up crazy little things like this
hope you guys found this little
walkthrough helpful I really love that
they're doing this QL sort of courses
because there's not a lot of great
resources out there to practice</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>