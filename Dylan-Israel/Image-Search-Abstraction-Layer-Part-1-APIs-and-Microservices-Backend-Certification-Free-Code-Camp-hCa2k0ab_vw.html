<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Image Search Abstraction Layer Part 1: APIs and Microservices Backend Certification Free Code Camp | Coder Coacher - Coaching Coders</title><meta content="Image Search Abstraction Layer Part 1: APIs and Microservices Backend Certification Free Code Camp - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Dylan-Israel/">Dylan Israel</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Image Search Abstraction Layer Part 1: APIs and Microservices Backend Certification Free Code Camp</b></h2><h5 class="post__date">2017-04-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hCa2k0ab_vw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright guys we are back in free code
camp in the API and microservice back in
certification we're doing the image
search abstraction layer and what we're
basically building is a return call that
does a couple things one is say we
search for something like Lowell cats
space funny
this he returned back some information
this URL snippet it's gonna return back
about 10 of them that's the gist of it
the other thing is is we want to be able
to go to the second page so we have this
offset and this basically says hey if we
want to go to page two and not get the
first 10 results we want to get 10
through 20 we can offset it and then the
last thing is we want to be able to see
the most recently searched string so
what what if people have been searching
for that's basically what we want to see
and that's what we're gonna do now we're
going to use for our Search API and I
think that's where a lot of the
confusion about this comes this there's
no mention of getting an API to actually
do this but you have to use an API to to
do this and we ended up using the bing
web search API because there's a nice
node package that made this really easy
but in order for you to do it and I'll
have this link in the description below
you're gonna need to sign up for a free
account and get your your API key in
order to be using this but you don't
have to use Bing it's just what I used I
think it was pretty pretty clear from
the project but with that being stated
let's go ahead and jump into the project
we're gonna start with a brand new
folder here go ahead and create your
your folder we're gonna we're gonna call
this to new folder image search
and then for me YouTube that cool and in
here we're going to have a server j/s
file this will be our note file and
we're gonna install some dependencies
we're gonna stall all the ones we're
going to use right now first well first
thing first we have to install NPM so
NPM in it so NPM is going to sell we're
gonna be this projects going to be this
projects going to be I using Express
it's going to be using Korres is going
to be using body parser it's going to be
using the Mongoose and MongoDB but those
oh and then the Bing API as well so
let's go ahead and install Express and
painless all got our slave expressed
make this fullscreen as well corks
presses installed you're gonna be honest
all gosh I save pores and we're gonna
NPM install that's a save body - parser
and then NPM install - save Mongoose and
last but not least we're going to be
installing the no - Bing - Apia no de -
be ing - API right when this is done any
moment now
there goes and npm install' - i say if
node we got away with
- being - yeah cool alright now that
those are all getting installed in our
server file what we need to do is add
our requirements so we're gonna get our
requirements and instantiate something
basically so we're gonna require Express
I'm just going to go ahead and copy and
paste this in here so we require Express
then we are gonna create our Express app
instantiate our express up with our app
variable here and then we're gonna do
the same thing for Korres for body
parser for Mongoose all we're doing is
we only thing different here is we've
created an app here then where the next
thing we're gonna do is we're gonna
stand sheet basically just say that hey
our Express app is gonna use body parser
Jason and it's also going to have access
to course now the one I am going to type
out is slightly different is our Bink
we're gonna go ahead and hat create a
Bing variable and we're just gonna
require the library that we put in there
but this one's slightly different
because it takes in a API key as well
so we're a required node - Bing - API
now on top of that what we're gonna do
is we're gonna have our ACC key which is
the second parameter here it's an object
that takes ACC key and then it's gonna
take in the string of your API key
you're gonna have to get this from the
being web search api that's which one i
use cool and if you're interested in the
documentation for node being api that'll
be in the description below as well a
lot of good links there so that you can
you know if you just need a little bit
of guidance so you don't want the whole
thing built out you can do that as well
so alright now that we kind of stance
rated what we're gonna be doing here
let's go ahead and listen for
app make sure everything's going well so
we do ab dot listen and we're gonna have
this thing called process I am V dot
port this is basically you gonna check
the port for when we go on Heroku if it
exists right now it doesn't so we're
gonna have or its port 3000 so that we
can work locally we're then going to
have our callback function here and all
we're gonna do is console dot log server
is running or whatever you want to put
to see that everything's going well it's
gonna control let's go ahead and launch
our note I'm using node Mon I highly
encourage you to get that installed as
well and so if everything is going we
should get school our server is running
we set up everything now the first thing
to to kind of do is you want to get
comfortable with with creating a get
call so we want to actually be able to
pass in our data for our gate College so
if you look at the URL here it goes API
image search then it takes in a search
parameter then it takes in this query
this optional query string right here
called offset so let's go ahead and set
up our our get call so that we can do
exactly that we won't worry about the
logic too much we got to break it down
piece by piece by piece so we're gonna
do how do I want to what is the comment
a get call with required and not
required branch to do a search you can
probably write this a little bit better
so we're gonna do is apt-get and we're
gonna pass in a string here which is
going to be slash API slash image search
and then we're going to have this slash
optional value which in my in my case I
just call it search val and then we're
gonna have this asterisk
what this asterisk is gonna be basically
will allow us to add as many additional
query strings that we want after this
whether they exist or they don't that's
what this asterisk is doing and then
we're gonna do our standard response a
request or next callback function in
which things are going to to be working
now how do we get the search val out of
out of there well it's pretty simple
we're going to have this VAR then these
carrots this is just some Sevilla six
stuff in future videos I'm going to
continue to try and prove my my es6
notation so if you have any questions
just put them in the comments below or
do a little bit of research and
hopefully we can both get better at es6
as as time goes on so we're gonna get
the search valve requirements here we're
not actually doing anything with it but
this will actually get this value and
then we also want a value called offset
so far offset don't forget my curly
braces here offset it's going to be
equal to and the only difference here
between this is a per amp but we won't
do a query so we have this query string
so we're gonna wreck dot query now let's
go ahead and check to make sure
everything's working I like to go piece
by piece right so we want to rest on
JSON and then we'll pass an object here
and it'll have something like we can
just go ahead and put search Val
, offset alright now we need to go to
this in the browser this location and
we'll go to local host local host mm /
API so we should have in this one it's
tests so the valley we should get back
is test and offset is equal to 2 in our
JSON can that match ident and I don't
undefined or null so let's just go ahead
and go back here and see what happened
API / image search flash test
interesting interesting
all right so we're having a little bit
of difficulty here
so which one is I saying can't we find a
result
so let's look back at our notes here
search Val offset
all right we'll try it one more time
servers running so should be API / image
search so we're still getting the same
thing
while we're at it let's go ahead and
test this out we want to see what is
actually getting console locked a little
bit of debugging right there's better
ways to debug this but a little bit I
think it's good to kind of show these
errors to see how if you were to get
stuck how you go about it our server is
up and running and what we're gonna try
and do is see which one of these values
is going back is undefined in our
application here oh I see what I did
rock so this is supposed to be request
and this is supposed to be response I
just looked at it right now so
everything should be good now
well let's crash it for another reason
oh this needs to go arrest alright cool
so now everything's gonna work you won't
believe how many times I put the
requested response in the wrong order so
you'll see now we're able to get the
test value and we're also able to get
our query string offset to here all
right cool Wow
how do we proceed from there well the
next thing that we're gonna do is we're
going to actually create a search term
remember before we move on to actually
getting this data what we need to do is
we need to store this search term here
and how we're gonna do that is we're
going to do that with MongoDB and
Mongoose the first thing that we should
do is we should actually go ahead and
create this new folder called models and
in models we're going to basically have
our template which is going to be the
going to be the schema for how we want
that database how we want that document
our mongoose document to look so in this
case or how the structure should be
right when you're building out like a
database you're saying this is going to
be a string this is gonna be the name of
it
this is this values gonna be a date and
you know how we expect that to go this
is a pretty basic one so I just have two
values in it we'll go ahead and name
this search term Jas and in here we're
gonna require two things we're gonna
need to require Mongoose and we're also
going to not require two things Susan
we're gonna have two things we need to
set up here which is the first one being
Mongoose and then the second one being
schema that is from Mongoose
so now that we have that let me go ahead
and copy and paste this comment in here
and again all the source code will be up
on github if I ever get around uploading
it but I hope it will be by the time I
released this video so you guys can have
access to it if you have any questions
ok so we've we've kind of instantiated
those two things what we need to do now
is create our model this is going to be
it's going to put this is gonna be kind
of the setup of the document in a
perfect world right so I call it I
typically just call it the same name as
the file except I throw the word schema
on the end this is gonna be a new schema
and then schema takes in a single
parameter and that is an object and here
we kind of find things so in our search
fowl and notice that you I have a
correlation between this search valve
and this to save yourself headache you
don't have to do this but try named
things the same thing to kind of show
that they're correlated it'll really
just make your life a whole lot easier
so this is gonna be a string and then
the only other thing that I add here I
don't actually do anything with it but
it's at the most recent I got kind of
lazy lazy and just returned to get call
for all the search strings but let's say
I I do a part 3 to this this is gonna
probably be two parts or I do an
additional part what I would want is a
date object here so I could compare it
to see when it was created this will
just be a new date in there another
thing that we could do that I typically
was told to do is add a timestamp so
that you can see when it was created as
well so we'll do that as well so but
this is our this is our database at the
end there are our our data object
because we're not actually storing
anything from being all we're doing is
an API call and returning the data that
we want from it and the only thing in
the database among is that we're
actually storing is this search found
this search date and that'll be what
we're searching with so last but not
least we have to do is we have to
basically export our model class and you
got to do that we want to our model
class basically connects our collection
which is going to be search terms
J s and our art our schema and our
document type so and let's go ahead and
create that gift Kant's model class is
equal to Mon B stock model and in here
we're gonna pass an search term and
again you notice I named most of these
things pretty similar you'll see you'll
see like through schema on this cuz I
think there's a little bit of confusion
as to what you're passing in here
everything search term but once a string
and so because we need access to this in
a different file when you go ahead and
do module dot exports our model class
and we have our entire document setup
now cool before we move forward why
don't we just go ahead and save a
document to the database and we need to
create our search term we have to
connect we have to require the directory
and we have to connect to Mongoose so we
have to require the schema it's what
it's the first part so let's go ahead
and do that so we're gonna do a conce
and what you'll see again like similar
things search term is equal to require
and in here we're gonna put the location
of this file right here which is dot
slash model slash search term so we're
basically required this we're basically
importing this right here the schema and
the next thing that we need to do is we
just need to go ahead and connect to the
manga the Mongoose server which is our
database and in here we have this
ah DMV . Mongo DB underscore uri this is
so that if we ever moved to Heroku or
there's a port there that we can go
ahead and use that or a database we're
going to use that or locally we can go
ahead and pass in MongoDB s-- : / /
localhost and then the collection we're
trying to connect to which in this case
is MongoDB localhost search terms you'll
notice that there's an S on to this
Mongoose will by default at mclaurel
eyes this because it's a collect the
collection search term has multiple
things in it I guess this is kind of
logics one of those weird things with
fungus now how do we save this search
term let's see what's going on here oh
so we actually have to launch our
Mongoose server if you haven't already
and typically you'll want to close node
before you do this so let's go ahead and
open up our folder go to wherever your
Mongoose setting is and we'll launch
that so here is where - located which is
leaf Program Files and Mongo DB server
3.4 Ben Mongo D I'll go
all right now that this is launched
let's go ahead and launch this again
hopefully we won't have any errors this
time servers running everything is good
cool so we're going to save to the
database the way that we do that's
pretty straightforward we're gonna
create a data object here we just call
it VAR data and set it equal to a new
you know and remember we set up that
schema called search term it's gonna be
a new search term and you're gonna want
to make sure that your attribute search
valence search date are what you're
setting otherwise it's not gonna know
where you're trying to put this sort of
information so we're gonna have search
Val and then we're gonna search date and
this is just gonna be a new date it's
gonna be the date the moment that it was
instantiated so it's right what is it
2:00 or 4:00 p.m. right now it's
basically gonna be that and from here
what we want to do it's just called data
save remember this is our data object
that we're creating just a day did not
save and if there's an air go ahead and
do this so we're saying if there is an
air what we want to do is res dot send
air saving to database although we do
win it normally from the assignment
return a JSON at this point I think it's
important to kind of show that
everything's working so we're gonna read
that JSON this data and so what should
happen when we get this image search
search value is we should get an object
back that has a search Val in a search
State and I believe may be a primary ID
as well so for you to do the same exact
thing here wait a second wait for it Oh
and a crash
so we did something that broke things
unhandled arrogant I don't believe so
all right hmm
let me just copy this over and make sure
I don't have a syntax mistake and here
we are going to res dot JSON and we're
going to put works :
JSON works : works and we're actually
going to I think it's hitting this one
first so we're gonna comment that out I
think that's what was happening there so
when go back to here you'll see that we
actually hit this and let's go ahead and
pass in our our data object which in
this case is data let's see the creation
of it essentially cool so we get this
updated at we could just create it at we
get this underscore V and we get this
this is kind of the primary key but we
also get our search as well as the new
date which is accurate so you can see
that the MongoDB and Mongoose is working
correctly
now in the next video what we're gonna
do guys is we're going to take our code
and with what we have we're going to get
rid of this line and we're gonna connect
to the Bing API and we're gonna then
create a another get call which actually
will return all of the search terms on a
different route so as always guys thank
you for watching sorry about the little
stutter steps in there this stuff gets a
little bit you know how it is with bugs
and things like that I do my best to try
and make it not bug free but air free as
we go I appreciate you guys for watching
if you want to join our Facebook group
coat and caffeine the link is in the
description below and if you want to
support me and you like these videos and
you like this channel you can of
patreon.com slash coding tutorials 360
I'll see you guys in the next video
thank you for watching
hey guys thanks for watching the video
if you're interested in coding boot camp
check out dev Mountain com where housing
is included in your price of tuition and
don't forget to Like comment subscribe
and share and support me on patreon I'll
see you guys in the next video thanks
for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>