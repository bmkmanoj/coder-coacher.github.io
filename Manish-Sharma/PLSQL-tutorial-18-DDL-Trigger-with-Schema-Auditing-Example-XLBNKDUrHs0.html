<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PL/SQL tutorial 18: DDL Trigger with Schema Auditing Example | Coder Coacher - Coaching Coders</title><meta content="PL/SQL tutorial 18: DDL Trigger with Schema Auditing Example - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Manish-Sharma/">Manish Sharma</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PL/SQL tutorial 18: DDL Trigger with Schema Auditing Example</b></h2><h5 class="post__date">2015-12-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/XLBNKDUrHs0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's up Internet i am manish from
rebellionrider.com till so far we have
seen plenty of examples of DML triggers
and i think now we should move ahead and
start learning DDL triggers as discussed
in PL sequel tutorial 14 that DDL
triggers are those triggers which are
created over DDL statements today in
this tutorial we will learn how to
create and use a DDL trigger with the
help of easy to understand examples i
would suggest you to watch the PL sequel
tutorial 14 where i explain the concepts
related theory without further ado let's
start the tutorial using DDL triggers
you can track changes to the database
which means that you can keep an eye on
when a schema objects such as table
triggers index or anything is creative
altered or drop and by whom let's start
this tutorial right now I am connected
to the database using HR schema and I
will create a trigger which will help me
in tracking all the changes happening to
this schema such as when an object is
being created altered or dropped and by
whom
for this first we need a table in which
this trigger will store all the
information let's create this table
first but before that let's close this
script output and clear the screen -
better
table schema audit created let us close
this script output so that you can see
this whole create table command great so
here is our table with the name schema
underscore on it which has five columns
first column will hold the date when DDL
is executed second column will hold the
name of the user who executed the DDL
and created alter or drop an object
while column three will hold the type of
object created alter or drop such as
table trigger index view or sequence
column four will tell you the object
name and last column will show you the
type of DDL statement executed this is
very simple table for the demonstration
now we will write the trigger which will
track the changes to this schema to
which I am connected right now which is
HR so let's do it but before that let's
clear the screen so that you all can see
the code more clearly that screen clean
and clear
here is our trigger let's discuss the
detail part of this trigger first which
is the first two lines the name of this
trigger is HR underscore audit
underscore ter which is completely user
defined and this trigger will fire after
every DDL statement executed on the
schema in which it's created in this
case that is schema is H our second line
shows as I just said that this trigger
will fire after every DDL statement
executed in the HR schema in case if you
want your trigger to execute only for
any specific DDL statement for example
suppose you want your trigger to fire
only for truncate d real then simply
replace this keyword DDL with truncate
or if you want your trigger to fire for
create an altered DDL statement then
replace DDL keyword with create or alter
then your trigger will fire only for
create an altered EDL but in my case I
want my trigger to fire for all kind of
details so I am good with keyword detail
here now come to the second part of the
trigger which is the working part here
we have our execution section inside
which we have an insert statement this
insert statement will insert a row into
the schema underscore audit table which
we just created
whenever someone executes a DDL in HR
schema so let's see how we are inserting
respective values into the table schema
audit first function cyst it will insert
the date when DDL is executed second
function using which we are taking the
user name who executed the DDL is sis
underscore contacts which usually takes
three parameters in which two are
mandatory first one is namespace and the
second one is parameter in our case
namespace is user env which is an oracle
built-in namespace associated with the
current session and the current user is
a parameter whose value will get written
in simple words both these arguments
together will return the current session
username who executed the DDL next three
statements are Oracle system event
attributes which written some
information regarding the events that
fire the triggers such as the first
system event attribute is Ora underscore
D ICD underscore obj underscore type
which will return type of object on
which TDD operation occurred for example
in case of table creation that object
will be the table the second attribute
is aura underscore di CD underscore obj
underscore name which returns the name
of the object given by the user for
example suppose you created a table by
the name of rebellion Rider then the
table will be the type of object and
name of the table rebellion Rider will
be the object name third attribute aura
underscores this event will tell you
which DDL event or DDL statement was
executed such as in case of table
creation it will be created or if you
truncate the table then the DDL will be
truncate don't worry once we execute and
test this trigger you will better
understand whatever I just said so let's
execute and compile this trigger trigger
compiled successfully now let's take
this trigger on a power test run
let's close this a script output and
clear this screen great now first let me
show you that that table schema
underscore audit is empty no rows
returned now let's create a dummy table
and see whether it records this event
into schema underscore audit table or
not just a simple dummy table with the
name rebellion Rider created now check
the schema underscore audit table and
see if we have the audit entry there or
not and here it is object table with the
name rebellion writer using Create dbl
by user HR is created on this particular
date let's insert some rows into the
stable and then truncate it to check
whether this trigger works for truncate
DDL or not I just inserted two rows into
the table rebellion writer let's quickly
check we now have two rows here so let's
truncate an empty this table rebellion
Rider done now check the schema
underscore audit table so we have an
entry for truncate detail also what if
we drop this table rebellion writer
let's try the
table dropped again
let's check this scheme underscore audit
table and see whether we have this entry
or not let's check this scheme
underscore audit table all the auditing
entries are here that's how using DDL
trigger can help you keep track on the
changes in your schema and secure it but
this trigger will only work for a
specific schema in which it is created
and will not work on any other user if
you want to learn that or you want to
know how to keep track on the changes in
your whole database using DDL trigger
then visit my blog and find the pre-code
code for database auditing using TTL
trigger hope you enjoyed watching please
visit the blog for more in-depth
knowledge and also find the code which
we created here in this tutorial if you
liked this video then please give it a
thumbs up and share it on your social
with your friends you can also follow me
on my Twitter for regular updates thanks
for watching see you soon with another
tutorial till then take care this is
manish from rebellionrider</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>