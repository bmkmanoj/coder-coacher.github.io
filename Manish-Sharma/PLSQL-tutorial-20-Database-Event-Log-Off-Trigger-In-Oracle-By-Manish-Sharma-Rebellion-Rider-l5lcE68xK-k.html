<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PL/SQL tutorial 20: Database Event 'Log Off' Trigger In Oracle By Manish Sharma Rebellion Rider | Coder Coacher - Coaching Coders</title><meta content="PL/SQL tutorial 20: Database Event 'Log Off' Trigger In Oracle By Manish Sharma Rebellion Rider - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Manish-Sharma/">Manish Sharma</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PL/SQL tutorial 20: Database Event 'Log Off' Trigger In Oracle By Manish Sharma Rebellion Rider</b></h2><h5 class="post__date">2016-01-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/l5lcE68xK-k" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's up Internet I'm manish from
rebellionrider.com and i am back once
again with another PL sequel tutorial
today in this tutorial we will continue
with the database event triggers and
learn how to create a database event log
of trigger but before moving ahead I
highly suggest you to watch the previous
tutorial where we discussed all the
necessary theories on database event
triggers in detail as well as saw the
creation process of database log on
trigger that being said let's start
today's tutorial
unlike logon database event trigger
which fires after a valid logon attempt
by a user on the database log of
triggers executes before the user log
off from the database let's see how to
create a log of database event trigger
for the demonstration I will use the
same table
HR underscore eevn t underscore on it
which we created in the last tutorial as
you can see this table has 5 columns
that will hold the type of event along
with the logon and log of date and time
also this table already has some data
from the previous tutorial I think we
should empty this table so that we can
take a better look at the output from
our log of Freder which we will write
next great now we are good to go next I
will write a trigger which will execute
just before the user in which it is
created logs off from the database in
our case that user will be the HR user
but before that let's close this script
output panel and this query result also
and clear the screen
great so let's write the trigger
so here is our trigger code is pretty
similar to the log on trigger except
that this trigger will execute before
the log of event and work for the schema
in which it is created the keyword on
schema makes this trigger a schema level
trigger which only works for a specific
schema in our case that is key why is HR
after successful compilation this
trigger will insert log of detail into
the underlying HR underscore Eevee and
the underscore audit table every time
user HR logs off from the system let's
execute trigger compiled successfully
let's check the table HR underscore Eve
ent underscore audit for the detail
entry no rows returned because HR user
hasn't logged off from the database here
so let's first disconnect the HR user
and connect again and then check the
table
here is the entry as desired this
signifies that our trigger is working
properly though the trigger is compiled
successfully but this trigger is bound
to work only for the user in which it is
created what if we want to keep track of
all the log of activities of all the
user of the database in order to achieve
this we need to write a database level
system event trigger and for that we
first need to log on to the database
using a high privilege user such as this
and here we are next we need to create
the same table which we created earlier
to hold the data let's quickly create
one
the table structure is pretty similar to
the one which we created in the last
tutorial except that this time I added
an extra column username with the help
of which we can clearly identify the
details and avoid the confusion grid as
well sometimes my OCD kicks in at right
time anyways let's move ahead so now the
ground is all set it's time to write the
log of database even trigger for all the
users of the database this trigger will
be very similar to the one which we just
wrote with some small changes so let's
write the trigger but before that let's
compile this create table statement and
create the table 3 now let's clear the
screen okay all that now let's write the
trigger
here it is code is very similar to the
previous one
except that this time this trigger will
execute for all the users of the
database this we are making sure by
using keyword database instead of schema
in the second line of the trigger unlike
the previous trigger this makes this
trigger a database level system event
trigger which has database wide scope
and if you have noticed in this trigger
we also used an attribute user using
this we are inserting the name of the
user who logged off from the database
apart from these my new changes
everything is the same you can visit my
website and check the blog on the same
topic for more details so let's execute
this trigger trigger compiled
successfully amazing next time any user
logs off from the system this trigger
will save its entry into the underlying
table we can check that by logging HR
user off from the database and see
whether we will get any entries in this
table or not this worksheet is connected
to the database using HR user let's
confirm yep it is indeed HR now let's
log off we are disconnected now now
let's come to the worksheet where we are
connected to the database using sis user
here we are now let's check our DB
underscore evey and the underscore audit
table
okay here is the entry for our HR user
that's it hope you enjoyed this tutorial
if so then you know what you have to do
yes that's right here did thumbs up
button also share this PL sequel
tutorial with your friends on your
social media or by any means you find
convenient thank you for watching I will
catch up with you soon this is your
friend manish from rebellionrider.com
signing off for today</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>