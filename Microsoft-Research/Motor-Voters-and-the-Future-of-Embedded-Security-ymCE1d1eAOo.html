<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Motor, Voters, and the Future of Embedded Security | Coder Coacher - Coaching Coders</title><meta content="Motor, Voters, and the Future of Embedded Security - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Microsoft-Research/">Microsoft Research</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Motor, Voters, and the Future of Embedded Security</b></h2><h5 class="post__date">2016-08-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ymCE1d1eAOo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">each year Microsoft Research hosts
hundreds of influential speakers from
around the world including leading
scientists renowned experts in
technology book authors and leading
academics and makes videos of these
lectures freely available
hello everyone it's my group harder to
introduce different check away he's a
PhD candidate from UC San Diego he has
to work on some cool stuff about car
security compromising a vote voting
machine and develop techniques for
return oriented programming so today he
will talk to us about his work thank you
so I was waiting said I am Steve check
away and today I'm going to talk about
some of my research on electronic voting
machines and on the security of modern
automobiles when we think of computers
we tend to think of laptops desktops and
servers but the truth is the vast
majority of processors in use today are
embedded invisibly in devices that we
don't normally think of as computers
these range from the trivial like a
greeting card which will play some
sounds or flash some lights when you
open it up to far more complex things
like planes and trains there's a very
good reason that we have put software
controlled systems in these various
devices turns out that it is far simpler
to design test and deploy a software
based system than it is to design test
and deploy an equivalent hardware based
system and this is true if whether or
not the hardware is an electronic
circuit or a piece of mechanical
hardware one consequence of the ease of
software development is that we see that
many of the systems that which were
formerly purely mechanical systems have
been replaced by software controlled
systems some examples include things
like elevators slot machines and nearly
all forms of modern transportation now
once we have replaced mechanical systems
with software controlled systems it's
almost a natural next step to consider
adding some form of external
connectivity to these devices this can
be for monitoring or controlling the
devices and it can take the form of
several different things it can be any
of the standard
third wireless communication standards
or can be as simple as just taking a USB
device USB stick plugging it into the
device downloading the data and then
physically walking that USB stick over
to another computer or device to use the
data so before I talk about the security
of these embedded devices I want to talk
very briefly about the security of pcs
so back at the dawn of time when
personal computers were coming into
vogue the software that was running
these was extremely buggy and computers
were very vulnerable to attack and I
claim that it doesn't matter or it
didn't matter at the time and there are
two basic reasons for this the first is
that there was not an easy way for an
attacker to contact a bunch of computers
to take them over at the same time he
had to target one computer at a time and
the second is it wasn't really much
incentive to do this there wasn't a lot
to be gained aside from notoriety for
attacking computers now this starts to
change in the late 90s and early 2000s
becomes much more popular when now we
have our attackers have the ability to
communicate with and potentially
compromise a bunch of computers at the
same time now still not really a big
deal because there wasn't a lot of
incentive to actually do this now that
changes once people realize that they
can make money by compromising computers
and for example turning them into
zombies as part of a botnet and so
really what we see is that financially
motivated crime is a real driver behind
exploiting pcs so when we move from a
computer to a device that is able to
manipulate the physical world the stakes
for a vulnerable system can be quite a
bit higher so some of the things that
people have done in the past are looking
at the security of embedded systems has
ranged from looking at toy robots in the
home which can be used to spy on the
occupants of the home to a teenager and
Poland
who was able to take control of the
trains in his city and actually caused
several collisions fortunately nobody
was seriously injured as a result of
this to Stuxnet which took over uranium
enrichment centrifuges in Iran and
finally researchers have shown that they
can take control remotely of implantable
medical devices such as pacemakers and
even in theory kill the people with the
devices now computer security broadly
speaking is about making the world a
better place and so to this end there
are sort of three thrusts of research
that go on in the security community the
first of these is the measurement of
existing attacks so here researchers
examine what's going on they look at the
internet they see the worms and viruses
and malware that are being propagated
and measure the effects of them
basically see what's out there and what
it is that the evildoers are actually
doing with these the second one is to
try to stay one step ahead of the
miscreants and develop new attacks
against existing systems or to develop
attacks against new systems that people
hadn't previously considered now both of
these feed into the third thrust which
is defense so the measurement of
existing attacks and the development of
new attacks enables researchers to
design strong defenses against these
attacks to protect people in the future
now these are all three important areas
but for the rest of this talk I'm just
going to focus on one of these on
development of new attacks against
systems so first I want to talk about
what happens when we replace mechanical
voting with software-controlled voting
and then I'm going to spend a little bit
of time and talk about how I can
remotely take over your computer or your
car and then finally I will conclude so
partly in response to the voting debacle
in florida in two thousand Congress
passed the help america vote act or hava
which had as one of its goals the
replacement of the old
punch card and lover style voting
machines with something newer many
jurisdictions opted to replace their old
machines with paperless direct recording
electronic voting machines or dr ease so
let's take a look at how these work here
now diri czar these they can range in
size from the size of a small tablet to
these large 200-pound behemoths that
have to be wheeled around but in any
case there's a bit of a logistical
problem here in that on the day of the
election the voting machines need to be
in place at the the polling places so
the precinct so that the voters can come
in and vote but since these are so large
and cumbersome in some cases what
happens is the voting machines are
delivered a several days before the
election takes place and then they just
sit around basically unguarded so this
particular picture was taken by
princeton professor ed Felton who has
made it his hobby to travel around
Princeton in the days leading up to an
election and take pictures of voting
machines that are left unattended ok now
on the day of the election the poll
workers set up the machines and then the
voters come in and they cast their votes
using whatever the the interface is for
that particular machine either
interacting with a touchscreen or as in
here pushing the button that is next to
the preferred candidates name so after
they cast the or push the cast vote
button the voting machine stores their
vote in its internal memory now at the
end of the election what you would like
to happen is you would like to collect
all of these machines aggregate all of
the votes together and then figure out
who won the election but if you think
about the problem with delivering the
machines to the polling place you can
see that we have the same problem
collecting them all so what happens is
the votes are actually in stored on a
results cartridge so this is about the
size of a paperback book for this one
and these are what are collected at the
end of the day so after the polls close
the poll workers go around they remove
all of these cartridges and
them back to the county headquarters
where the votes are aggregated and the
winner is is declared so in response to
the fact that we now have software that
is controlling our elections a number of
researchers have taken a look at the
security of the voting machines that are
running the election so this is just a
small sampling but basically every
serious study of a voting machine has
revealed significant technical flaws
these have ranged from being able to
violate the ballot secrecy so if you can
watch the order in which voters cast
their vote then after the fact you can
recover how each voter voted to being
able to change all of the votes on a
particular voting machine or changing
all of the votes countywide and even in
at least one case being able to infect
one machine and have it spread virally
to all of the other voting machines over
the course of the next couple of
elections so you might be thinking all
right we know that voting machines are
insecure so why am I up here talking
about them well the truth is that not
everyone agrees with that assessment so
the local election officials and the
voting machine vendors have been highly
critical of the of these studies they
have said things like giving attackers
access to source code is unrealistic and
any system that has for which source
code is given can be attacked these
studies are unrealistic here we're
providing source code these are extreme
circumstances that the hackers have the
source code the operating manuals
unlimited access they have only slightly
limited access they have unusual access
to the machines the attacks are highly
improbable you can see sort of a trend
here that the people doing the study had
too much access they were given source
code or other insider knowledge that a
real attacker wouldn't have and in fact
here is my favorite of the quotes I
think my 9 and 12 year old kids could
find ways to break into the voting
equipment if they had unfettered access
so I hope that this is not the case
if it turns out that you really do need
some sort of insider access to be able
to attack the voting machine then these
responses are a fairly strong indictment
of the previous studies of voting
machines so to that end I along with
researchers at UC San Diego and
Princeton Center for information
technology policy set out to study a
voting machine for which we had
absolutely no insider access the machine
we chose to study was the Sequoia ABC
advantage which is in fairly wide use
used in a number of different states and
now it has several key features that
made this a good machine to study from
from our point of view the first is that
it has a very simple design so any flaws
that are found in the voting machine
must be flaws in the software or
hardware that was designed by the the
company and intended to be running on
this voting machine this is in contrast
to some of the other studies which
relied on windows is auto run feature
for example to load malicious code onto
these voting machines as I mentioned we
had no insider access all we had was a
voting machine which was purchased by
princeton professor and repelled from a
government surplus site there was no
authentication required anybody could
have purchased these he he bought a lot
of five machines for a total price of 82
dollars plus nine hundred dollars in
shipping to princeton but anybody could
have done this and then it turns out
that this particular voting machine has
a it was was designed with security in
mind which seems to be not the norm for
voting machines and other embedded
devices in particular this machine has a
pretty strong defense against code
injection which I will tell you about so
as what is a probably a review for many
of you here is how code injection
normally works there is a program that
is running our games running in memory
that the attacker wishes to exploit and
the processor maintains a piece of state
called the program counter or
instruction pointer we
points at the next instruction to be
executed so the attackers task is
twofold first it causes his own
malicious code to be loaded somewhere
else in memory and then second changes
the program counter to point from the
legitimate program to the malicious
program now one way that this can be
done is a pretty easy one it's a buffer
overflow on the stack which allows the
attacker to both inject new code and
change the program counter at the same
time on an embedded system the situation
is pretty similar there's one change
which is it frequently the program that
is running on the embedded system is the
only one that's going to be running and
so rather than being loaded from disk it
is stored in a read-only memory chip
which is attached to the motherboard and
always mapped into the address space
here the attackers job is basically the
same first load the malicious code
somewhere into memory now we can't load
it into the ROM without actually
replacing the ROM but that's okay the
processor is perfectly willing to
execute code loaded anywhere in the x qn
e wherein the address space so the
attacker just loads his code into the
RAM and then as before he causes the
program counter to change from pointing
at the ROM into pointing at his
malicious code on the sequoia ABC
advantage the situation is markedly
different so first there it does have
this ROM ram distinction where the
legitimate program is in the lower half
of the address space in the roms and the
top half the address space is for ram
but what difference is that the ABC
advantage has a piece of hardware such
that if the processor ever attempts to
fetch an instruction from ram it raises
what's called a non mass cable interrupt
which basically causes the processor to
branch to a known location where it
executes a small piece of code in this
case it prints out an error message and
then goes into an infinite loop waiting
for the machine
to be turned off so if we think about
what this means the attacker cannot
change any of the instructions in ROM
without actually replacing the ROM and
the attacker cannot cause any
instructions in RAM to be executed so
there is no way for the attacker to
actually run any code that is injected
into the machine and so this was the
fundamental assumption that the
designers of the voting machine made
when they designed this namely if you
can't inject code then the only program
that's running is the legitimate voting
program and so everything should be fine
now this assumption is false so return
oriented programming is a technique that
was designed to allow arbitrary attacker
control turn complete behavior without
any code injection so basically the way
this works is the program has some
sequence of instructions in it and the
attacker looks through them and find
some sequence that performs or finds a
bunch of sequences each of which
performs some discreet action that is
useful and so what I mean by a discreet
action is something like adding the
contents of two registers together or
storing the contents of a register into
memory now if the attacker can arrange
for these sequences of code to be
executed in the appropriate order then
he can cause any behavior that he wants
so the details are technical and I'd be
happy to talk about them after the talk
but the upshot is that if the attacker
is able to gain control of the function
call stack then he can induce any
behavior he wants in this program now
necessarily because we're relying on the
instructions that exist in the
legitimate program the return oriented
attack is specific to the particular
program and the processor on which the
program is running so return oriented
programming was designed and is mostly
used in the context of exploiting pcs
now pcs tend to have software defenses
against code injection Microsoft for
example calls it
data execution prevention or depth which
basically says that any page of memory
can be writable or it can be executable
but never both at the same time and so
the way rompe is basically used is you
write a small raat program that turns
off the software defenses against code
injection and then performs the standard
code injection attack now this doesn't
work on the ABC advantage be precisely
because of this hardware there's no way
to turn this defense off the consequence
of this is that the that if an attacker
wishes to actually attack the voting
machine has to write the entire program
or the entire exploit in this return
oriented style and so this is in fact
what I did I wanted to design a an
exploit which when loaded on to the
machine would steal votes it would shift
votes from one candidate to another
candidate now to make this problem sort
of tractable so I didn't have to sit
down and write down a bunch of
individual addresses that I would be
writing on to the stack I designed a
very simple assembly like language and a
compiler for it that would translate a
relatively high level specification of
this vote stealing and it would
translate it into the return oriented
style so let's see how this attack would
actually happen so the first thing that
happens is the attacker would need to
gain physical access to the voting
machine so this was pretty easy as I
mentioned at the near the beginning of
the talk these voting machines are left
unattended in the days before the
election so the night before the
attacker would go to the Machine pick
three very simple locks they're so
simple that even I can pick them and I'm
terrible at lock picking anyone with
skill could do it in a couple of seconds
max so then having gained access to the
machine you open up the back panel and
get at where the operator panel is and
where the results cartridge would be
stored the attacker has previously
loaded this vote stealing program
into a file in the results cartridge or
into one into a cartridge that's
actually an auxiliary cartridge it's
very similar to results cartridge the
difference is unimportant but the point
is that the voting machine has two slots
in it one for the results cartridge and
one for the auxiliary cartridge now in
normal use the auxiliary cartridge is
left empty so there's no problem there
all the attacker has to do is insert his
cartridge into the auxiliary port then
the attacker navigates a couple of menus
on the voting machines display and
triggers a bug that causes a very simple
buffer overflow on the stack and this is
what initiates the whole vote stealing
program so there's a rather complicated
multistage exploit that goes on here but
at this point from the attackers point
of view he's basically done all he has
to do now is wait for the handy
instructions that are provided on the
operator panel namely remove the exploit
cartridge from the voting machine and
then turn the power on the machine off
so it turns out that the power on this
voting machine is under software control
so there is a power knob but is merely
advisory the soft the legitimate
software notices when the power knob has
been turned to the off position and
that's when it decides to depower the
motherboard so what happens instead once
the vote stealing program is installed
is it sits around and waits for the knob
to be turned to off and as soon as it
detects that this is the case it powers
off all of its peripherals but sits
around and keeps running so the attacker
closes up the voting machine and moves
on to the next one or leaves the polling
place the attacker is now done at this
point yeah is the machine why do you
need such a sophisticated attack if
you're just
to trace to the non masculine or outline
or for that matter just swap out the
wrong with your own your own attack run
that's right you're absolutely right
that an attacker could replace the ROM
or to cut the trace for the for the non
Maskull interrupt so there are two
reasons that one wouldn't want to do
this the the first is that this would
leave some physical evidence that the
attack is that some attack has occurred
the the board would be damaged maybe you
could do this in such a way that the
people wouldn't notice or they would
think it was just something had happened
to scrape against it and caused the
damage replacing the ROM could really be
detected all they would have to do is
remove the ROM stick it in a rom reader
and realize hey this isn't the right
thing the second reason that one
wouldn't do this is that there are a
variety of tamper evident seals that
protect the the internals of the machine
so you can open it up but you can't get
at the roms without defeating a number
of security seals so people have showed
in the past that it's not too hard to
defeat them using a variety of household
objects like hair dryers but by doing a
purely software attack you don't have
this problem you don't have to defeat
any seals and there's no telltale sign
left behind but you're absolutely right
that that could happen yeah Jewellery
Quarter it's kind of convenient yes it
is pretty consistent is that is that a
common feature of these
I mean that in some ways I guess they
need to be extensible but it seems like
a huge backdoor in terms of letting
people you know put new code or whatever
new stuff into the yeah right well it
was designed my my understanding is one
of the things that you can do with this
is you can aggregate the vote totals I
create the votes from a bunch of
machines on to a single one you put the
results cartridge in the results
cartridge part and you put a vote
aggregating cartridge in the auxiliary
port and then you tell it to you know
add the votes and so it's a
functionality issue but yeah you're
right that it seems like perhaps not a
good design choice or that it should be
secured for sure so the next day the
poll workers come in and they go and
they set up the voting machine and they
turn the power knob on and now the vote
stealing program has been sitting around
running this entire time and so it
detects that the the knob has been
turned on and now it performs all of the
standard startup sequences it plays all
of the sounds it prints out all of the
messages and takes the normal amount of
time this machine takes to start up and
get into the election mode so there's
really no indication that anything out
of the ordinary is going on then the
election runs basically is normal the
voters come in and cast their votes and
then at the end of the day the polls are
closed and it's only at this point that
something different from the legitimate
program happens namely votes are shifted
from one candidate to another candidate
so here on this particular machine three
votes were cast for George Washington I
know this because I was the one who cast
all three of them and after I closed the
polls and printed out the the results
tape here you can see that two votes
have been shifted from George Washington
to Benedict Arnold and so here he is the
winner at least on this particular
voting machine so let's take a step back
here and ask what went wrong with the
the security of this voting machine now
the obvious thing to say as well there
was this buffer overflow that enabled me
to begin this return oriented
attack but I don't think that that's the
interesting thing we've known about
return sorry we've known about buffer
overflows for quite a number of years
and we know how to defend against them
so really the only thing that's
interesting about the fact that there's
a buffer overflow is that people are
still writing code with buffer overflows
even though we do know how to defeat
them really for me the more interesting
thing is that they had this security
assumption and they relied on it to
defend the voting machine against attack
namely they were assuming that if they
could prevent bad code than they could
prevent bad behavior and it turns out
that this was just not true and moreover
when the machine was designed no one
knew about return oriented programming
and so this defense was actually a
pretty good one it was pretty strong my
understanding is that the military
actually uses something quite similar on
the control systems for their weapons
but what this meant is that once return
oriented programming was invented the
these voting machines were simply not
secure anymore and so they didn't remain
secure for their entire service life and
finally as we were talking about there's
no real way to detect that this attack
happened after the fact if I had
replaced some roms then we could tell
that these roms had been replaced but
since this was a software-only attack
there was no evidence left behind yeah
this locks no you don't leave the
cartridge in the slot so once that
message pops up says remove the result
or remove the exploit cartridge and then
turn off the machine so you take it out
and turn off the machine and then you're
all set yeah normal it was and in fact
it does yes so after it's done it erases
all of its memory and then erases all of
the the code that it had written into
memory and returns to the legitimate
program so easy of defense will be i
unplug the power for every emotion
volte machine and on the working day I
plug in the power make sure it's a clean
so that's a that's a great point and in
fact we would expect that the voting
machines wouldn't be plugged in until it
came time to actually run the election
so it turns out that since these voting
machines need to work even if there's a
power outage the each machine has a
rather large car battery in it which the
brochure for the machine claims allows
voting for up to 18 hours without power
so the the code will remain resident
unless you remove the battery and unplug
the machine and in fact even in that
case the RAM is battery backed and so it
it will remain so you would have to
remove everything pull out all of the
batteries and then go through the entire
setup procedure to do it so if you'll
pardon the pun let's shift gears a
little bit and talk about how I can take
control of your car from a distance so
these two statements up here or rather
obvious statements but I think they need
to be said because they're important the
first is that cars are these cyber
physical systems by which I mean we have
software controlling the physical world
and second any vulnerabilities in the
software that is controlling these
systems is potentially life-threatening
so these are these are important the
code in them needs to be correct for
cars to be safe up until the late 1970s
cars were basically purely mechanical
devices our fuel efficiency and
environmental concerns led to the
introduction of emission control systems
in the form of engine control computers
now these computers proved so successful
that they sparked a proliferation of
computers in the car and so now almost
everything in the car is under computer
control from heating and lights to the
airbags to the transmission to the
engine to the brakes basically every
thing in your car is controlled by a
computer at this point I used to like to
say that
basically the parking brake was the last
holdout but now I have ridden in cars
where the parking brake is a button that
you press so at this point everything is
under computer control now you might
notice that several of these computers
need to talk to each other the remote
keyless entry system needs to talk to
the body controller so that when i push
the unlock button on my key fob the
remote control door lock receiver will
send a message to the body controller
saying unlock the doors and then the
body controller does it so to avoid a
potential n squared communication
problem the designers of these of the
internal architecture for cars have
designed them around a few shared
networks so each computer communicates
with one or more shared buses so at the
same time this is happening sort of the
last of the holdouts of the mechanical
systems is replaced with a software
control system so the accelerator pedal
is no longer connected directly to the
throttle instead it is simply are there
there are simply sensors in the pedal
that detect how far it is depressed and
then the engine controller detects how
far the pedal has been depressed and
then it is responsible for controlling
how much fuel to mix with air how far to
open the throttle etc okay so while all
of this is going on the cars have gained
a significant number of external
connectivity so this is range from
things like ipod and USB connectors on
the radio to a number of wireless
channels such as in some cars they're
adding Wi-Fi cars have bluetooth so that
they can communicate with your cell
phone and act basically as a hands-free
headset there is a telematics unit in
most cars these days which is basically
a smartphone so it is a cell phone
paired with a moderately powerful
computer which has a phone number that
can be which can be dialed and in
addition it can make an internet
connection it can make like a 3g
internet connection
and finally looking forward there are
going to be app stores so we will have
third-party code running on the
telematics unit now I think this is a
terrible idea and it sounds like many of
the engineers in the automotive industry
agree that this is a terrible idea
however from what I'm told from these by
these engineers the marketing people
love their app stores and so this is
coming there's no there's no stopping it
we will have app stores on cars already
there so car so oh ok yeah I've seen ads
for like Pandora integrating with some
cars so yeah alright so now before I
tell you all of the things that an
attacker could do to a car i want to
give sort of a motivating example here
now here we have arranged for wireless
access to this cars internal network so
which car is this well while doing this
study we which was a collaborative
effort between researchers at the
university of washington and UC san
diego we purchased a pair of identical
make and model late-model 2009 i guess
automobiles that are sort of their
generic they're not anything high-end or
special you know they're thirty thousand
dollar range there hundreds of thousands
of these on the road today so here we
can see my co-author grad student turned
stuntman Alexei and he is going to be
driving the University of Washington car
down a unused runway in Blaine and when
he gives the signal we are going to
disable his brakes and you'll be able to
hear him try to break so i will point it
out when it happens but it makes sort of
a grinding sound 10
send the packet at three to 10 I cannot
break let me try and seller eight sets
are 11 sound that was him trying to
break okay now i'm a 28 i still can't
break so i don't know if you caught it
but that contained my favorite line i
cannot break let me try accelerating so
the video continues on for another 30
seconds or so but you might notice at
the end of the runway is not too far off
in the end it turns out the parking
brake in this case is a so mechanical
one and that's enough to stop the car
okay so it turns out that basically
anything that is under computer control
which is everything in the car is under
attack or control if the attacker is
able to gain access to the cars internal
networks so this is just a short list of
things we can turn the engine on and off
we saw the the brakes they can be
completely disabled like in the video or
they can be selectively enabled so you
can say lock one particular break the
instrument panel is just under software
control so if you tell it you're going
140 miles an hour in park as far as it's
concerned you're going 140 miles an hour
in park all of the the horns actually
there's a there's an amusing story about
the horn which you should ask me about
after the talk the the heating the
lights the heating it turns out you can
turn up so high that it is really
extremely unpleasant to be inside the
car so you can turn it up much higher
than the control on the dash will allow
but basically everything is under
attacker control here and in fact the
attacker can do more so each of these
computers which are called ECU's in the
industry can be reprogrammed by the
other computers in the car so if you can
take control of any of those computers
then you can reprogram all of them and
therefore control absolutely everything
and so this is sort of the the
assumption that was made by the
designers of the the car namely that you
need some form of physical access in
order to be able to temple where
tamper with the computer systems now if
this is true then it's a it's a pretty
reasonable sort of assumption because if
I have physical access to your car then
I can do all of the sorts of things that
Hollywood has been telling us we can do
to car is if we have access to them for
the past 30 years so I don't need to
play around with your computer system I
can cut your brake lines or do all of
those sorts of things however as you
might imagine this assumption is false
so we can consider attackers who have a
variety of different capabilities so the
first one I want to mention is are the
attackers who have an indirect physical
access to the car now what I mean by
this is that the adversary does not
himself have direct physical access to
the car but he does have access to some
device which has access to the car so
there are a bunch of examples of these
sorts of things the corner here you can
see a standard diagnostic tool that a
mechanic would plug directly into your
car these are frequently on these are
frequently wireless devices themselves
and so the attacker could take control
of the device and now can take control
of all of the cars that that it plugs
into there are third-party radios which
plug into the car any malicious radio
could take control of the car there are
third-party tools that plug directly
into the federally mandated onboard
diagnostic part so here is one Autobot
which is a popular one I mentioned that
radios have ipod USB connectors they can
play a variety of digital file formats
including WMA and mp3 and electric
vehicles communicate with their charging
stations as they're being charged so the
point here is really that any one of
these devices that is connected to the
car extends the attack surface of the
car to that of the device the second
category of attackers one can consider
are those who are able to send
short-range wireless communication
signal so here something up to say a
hundred meters or less now there are a
variety
of these in the car I mentioned
previously that some cars can pair with
your cell phone by a bluetooth for
hands-free calling remote keyless entry
has at least two wireless communication
channels some cars have Wi-Fi access
points in them using the the telematics
unit as it's a gateway to the internet
there are sensors that are federally
mandated sensors that spin around inside
your car's tires and periodically about
once a second or so report the pressure
of the tire tour receiver in the car and
looking forward people are developing
vehicle to vehicle networks where cars
will be able to communicate with each
other as they're driving down the road
the final category of attackers one can
consider are those who can send
long-range wireless signals so this is
at a distance of miles or even at a
global scale so cars have a variety can
receive a variety of digital radio
signals including satellite radio and HD
radio and even the radio data system
which is this which is the signal that's
broadcast along with FM that allows your
radio to display artists and track
information as you're listening to the
radio now in addition to this there are
the telematics units which have cell
phones and so can be accessed worldwide
and then can create internet connections
and so they can they can be accessed by
that as well so of all of these
potential attack vectors we looked at
four of them in depth we looked at the
manufacturer standard diagnostic tool
the standard radio media player that is
in the car looked at the Bluetooth and
the cellular communication and the
telematics unit and the point is that
every one of these led to a complete car
compromise so all of these were
vulnerable and we could do in
compromising any of them using
compromising car using any of these
vectors we could control the entire car
including things like the brakes and all
of the things that I mentioned
earlier so I want to talk about two of
these very briefly the first of them is
the media player so the cars radio what
you do is you basically you insert a CD
into the radio and then that will cause
it to take over the radio there are two
ways that this can be done the first is
that the radio contains some vestigial
code that the manufacturers weren't even
aware existed until we told them that
I'll that was put there by the the
supplier for the radio for reflashing
the radio quickly and easily so what you
do is you take a standard ISO 9660
formatted CD with a particular file and
directory structure and you stick it
into your radio a rather cryptic message
is displayed and if you push the wrong
button and there's no indication what
the right or wrong button to push here
is but if you push the wrong button it
will reflash your radio and so you can
basically overwrite all of the radios
firmware the second attack that we
developed was that it exploited a flaw
in the radios parsing of WMA files so
there is an undocumented header in a WMA
file that that this code was Miss
parsing so in the end we were able to
construct a WMA file that would play
fine when played on a computer but when
burned to a CD and insert it into the
radio would take control of the radio so
you might be thinking yep questions
define these
but these exploits so to finding finding
the various vulnerabilities and to
exploit them we spent a lot of time
looking at the firmware in ida pro so my
co-author Carl and I for example spent a
bunch of time looking at the radios for
a wire we extracted the firmware from it
and then just disassembled it and I was
looking at where it was parsing the ISO
9660 file system and we found this
reflashing capability in it and then a
little bit later Carl was looking
through the WMA parsing code and
discovered that there was this
vulnerability that led to an extremely
tricky buffer overflow to exploit which
caused him to normally what would happen
is it would just crash the radio when
you tried I had this tendency to brick
all of the radios that I poked at I have
a whole stack of dead radio somewhere
eventually what he ended up doing was
writing a debugger that would run on the
radio so we would reflash it using the
first attack vector and then use the the
debugger and we repurposed an unused
serial port and then we just SAT there
with the debugger poking at values in
memory until we could figure out what
the right thing that we should overwrite
was it was a was an intense two weeks I
think looking at the radio I mean
obviously people attack computers all
the time but you know this kind of
pretty specialized I mean presumably
every radio is different with this kind
of stuff whereas upright and it's you
know there's a hundred different you
know low low disability brands it is it
I mean is it just you or you want to
separate look at these things right so
there there's a big community of people
who look at the computers in their car I
don't think that they have looked at
radios before usually what they're
trying to do is the tuning community
community they are trying to make their
cars perform better so they will change
values and tables to cause more fuel to
mixer there etc and so they just try to
get the most performance out of their
car that they can I not aware of other
people looking at the trying to attack
cars okay so that was the radio the the
next one that I want to talk about is
the telematics unit so this is a diagram
of the networking stack for the
telematics unit so it has this 3g
internet connection on top of which it
runs point-to-point protocol SSL and
then finally on top on top of that is
the higher level telematics
functionality so because it has this ssl
this seemed like a pretty poor candidate
to attack unless we wanted to to attempt
to defeat ssl which i did not however if
you look at a coverage map for 3g in the
u.s. you can see that there are huge
regions where you simply cannot get 3g
internet now since this since these
telematics units need to be able to work
even when they don't have 3g internet
connection it turns out that there is a
second parallel communication stack that
you might notice does not have any sort
of SSL so this is really just ace a
frequency shift keying software modem
that runs over the voice channel of the
of the telematics unit so it sounds
quite a bit like a dial-up modem if you
listen to the if you play the the
waveforms and so this is what we decided
to attack because this looks a lot
better now it turns out that the people
who wrote the code for the software
modem which is a standard air bik witty
modem or different people
in those who wrote the telematics code
and it turned out that they had
mismatched assumptions namely our BIC
whaty was designed with the ability to
send rather large packets of data at a
time whereas the rest of the telematics
code knew that it was only going to be
sending short packets of data and it was
only expecting to receive short packets
of data and so it allocated a
correspondingly short buffer on its
stack however it was perfectly happy to
trust the data that was coming in over
the phone and it would copy the entire
long packet of memory into its short
buffer thus overriding the the stack as
it turned out so this led to our TAC
it's pretty simple basically there are
two parts you call the car and second
you transmit your malicious payload now
there are two ways that you could go
about doing this one you can implement
the entire modem protocol and are ya
implement the modem protocol and so you
have this two-way communication with the
telematics unit after you have called it
up but it turns out that we don't
actually care what the response is from
the the modem so we can just assume that
it's going to send us the expected
response and so all you have to do is
record your half of the conversation as
an mp3 and then just play the mp3 into
the phone so here's a picture of Carl
playing from his ipod playing this
exploit song directly into a conference
telephone and actually taking control of
the car that is just outside the picture
so now once you have taken control of
the car it turns out that you can use
many of the other wireless access points
or not access ones but wireless vectors
to control the car after you have
compromised it so one in particular that
was extremely handy is that we can use
the telematics units 3g internet
connection and so we would take control
of it using any of these methods and
then you just create an internet
connection and
what we did was we wrote a pretty simple
IRC chat client that would connect to
our server whenever the car was turned
on and then it would sit around and wait
for commands to be sent to it and then
it would perform whatever action we told
it to do so here at the top you can see
the University of Washington car joins
the channel a little bit farther down
the UCSD car joins the channel and
finally at the bottom Carl commands both
cars to simultaneously perform a
particular action the action that he
chose was to have it send a a packet on
its internal network this particular
packet just caused a chime to happen in
both cars simultaneously but you can
imagine that it could it could have done
anything you want it in fact it's very
easy to get a shell on the device using
the DCC chat feature of IRC yeah so we
had the same the same car so that the
point of this was to determine if the
vulnerabilities that we found were
specific to a particular instance or to
a family of cars and and turns out that
they were all for the most part of a
family person are the results across
makes an office
that's a great question we don't know
the answer we only looked at one there
are sort of two competing factors here
one there are many different suppliers
of components so in different model
years you can have a vastly different
component your telematics see and it
could be implemented by a completely
different company using a different
architecture with no shared software
however these suppliers do provide parts
too many manufacturers and these can be
used across various models so one hand
you have this diversity on the other
they tend to reuse the components across
multiple cars so how applicable it is we
don't know for sure so now that we have
this capability to take control of cars
and then to control them after we've
taken taking them over natural question
is what is it that someone might want to
do with these capabilities so it's easy
to talk about things like terrorism you
know we're going to have all of the cars
stopped working all at once so we're
going to lock their brakes or something
like that but I'm not a terrorist and so
this is a little bit outside my area of
expertise I'm a computer scientist and
one thing that we have some some
knowledge of is financially motivated
crime so let's consider car theft as a
computer scientist sure we study people
who who are financially motivated and
they commit crimes using computers this
is that's part of the the first thrust
of the computer security research so the
old way to do car theft is you send your
guy out with a slim jim and he breaks
into the car and then Hotwire's it and
drives it away but we don't have to do
that we can be we can be smarter about
it in fact we can even sell car theft as
a service if you wish so here's how this
would work the first thing you do is you
compromise the car and so you would
probably want to compromise a bunch of
cars but you can do it any any of the
methods that I described here say call
the car and you take control of it next
you can locate the car using the GPS
that's in the car so once you know where
the car is and
you know what kind of car it is because
you know what the vin is and so that's
you know that tells you am I am I going
to steal a car that I care about so yeah
how do you call karma calling a phone
number I'll calling the car see cosine
do something so you you the question if
I understood was how do you call the car
or you just dial the phone number so you
know the phone number of that car you
know the phone number of the driver of
the car so that's a great question how
do you get the phone number of the car
so in our case we cheated we push the
button and said what's our number and it
told us in reality you would need to be
able to find the numbers for the car so
one thing that we thought might be the
case is that they would be sort of
allocated sequentially and in a block
but the University of Washington car has
a 206 area code the car in San Diego has
a san diego area code so that's probably
not the case so you would probably need
someone who had access to the database
of the cars Mr Colley or you can just
word out you're absolutely right you
would choose the ones in your area that
you wanted to attack yeah absolutely so
yeah so obviously you pay all this money
for these keys well I'm trying to clean
sitter and you especially encrypted it's
only somebody with the key can start
your car is that can you buy a second
clue that's coming right up okay great
so after you have located the car you
send your guy out who he's going to go
steal it when he arrives you unlock the
doors start the engine and bypass all of
the anti-theft measures which allow you
to say shift into drive and then you
just drive the car away and so we
implemented this whole attack and here
Carl has been informed where the car is
and so he is going to walk out to it
when he gets there the car stealing
program will be run which will cause the
doors to unlock the engine will start
which you can't hear because a you
double buff or seattle bus drives by but
trust me it starts now while he's
putting on his seatbelt the anti-theft
measures are being bypassed you can see
there's no key in the ignition and he
can just shift into drive and drive the
car away okay so so that's car theft one
might consider doing something a bit
more or a bit different rather so here
cars to have in addition to GPS they
have microphones inside the cabin so
that you can use the car as the the
hands-free headset essentially and so we
can use the car to listen to what's
going on inside of it here's how this
proceeds you start as before by
compromising the car using any of the
methods you want then you can just have
the car continuously report its GPS
coordinates so i used a twitter clone so
that the car would just tweet its
location every 15 seconds or so then you
listen for audio or you rather you
listen for voices in the cabin so just
using standard voice detection and then
compress the audio and stream it off to
a to another server so we implemented
this as well but the video that we
produced was a perhaps a bit too cute to
show in this setting so i will skip it
so let's take a step back here and ask
what went wrong with the car so there
are two things that i think are really
important that happened here first is
that cars have had a real lack of
adversarial pressure no one to the best
of our knowledge is attacking cars and
so the manufacturers haven't had any
incentive to design security mechanisms
for the car the second reason is that
the cars are these they're not built by
the manufacturers themselves so they
don't have the capability to produce all
all of the components that go into the
car instead what they do is they design
specifications for each of the computers
in the car and then they third-party
suppliers bid on contracts for the to
build the components to the
specification presumably the lowest cost
bidder wins and they produce the
component which is returned to the
manufacturer essentially as a black box
widget so the car companies have no idea
what goes on inside there inside these
components unless they do the same sorts
of analyses that we did which they don't
do because they didn't have any reason
to do so and so this leads to a couple
of problems one is that you have these
incorrect assumptions between various
suppliers so the telematics code for
example was it had a different
assumption than the modem code had and
in fact almost every bug or every
vulnerability that we found in the car
fell at one of the boundaries of these
components so this has some
ramifications for other industries such
as the airline industry which builds
planes basically the same way that cars
are built by having third-party
suppliers produce a bunch of the
components and finally as with the
voting machine there's really no
forensic evidence left after the fact
that this occurred so we developed a tax
that would simply erase themselves from
memory as soon as they were complete
there's no audit log left that could be
found even if the car has a black box
that is recording traffic you may be
able to detect that an attack has
occurred if you say have happened to
have logged that that the command to
lock the brakes was issued right before
the attack happened but you wouldn't
really figure out when the car was
attacked you wouldn't know who did it or
how it was attacked so my interest in
looking at these is not to identify
specific vulnerabilities in these
embedded systems really I want to
understand how these vulnerabilities
arise in the first place so that's a
it's helpful to look at the the
commonalities between these two rather
different systems so in both cases the
car can are both cases these systems
contained a number of very simple
vulnerabilities like buffer overflows
using string copy or memory copy so what
this is telling us is that people are
still writing code poorly there they
haven't they're not doing the very
simple things to prevent the the most
basic of attacks but more than that even
when these systems are designed with
some security in mind they're not
designed with defense and depth in mind
so they have one mechanism that is going
to protect the car they're going to have
or the system they're going to have
you're requiring physical access to get
to the networks or they're going to have
you know the voting machine this
hardware that prevents code injection
and the assumption is that these
defenses won't be bypassed so when they
are there's no additional protection and
so if you think about the car for
example there's no reason that my taking
over the radio should ever let me take
control of the brakes it's that simply
shouldn't happen in both cases the
attacks were really undetectable there
was no way to tell after the effect
after the fact that an attack has
occurred and and finally it's it's
rather difficult to update the software
that is running on these computers so
you could imagine something like the
chrome model where basically whenever a
new update goes out everybody's browser
more or less is updated basically at the
same time in both of these cases this is
not the case the voting machine would
someone have to go through and replace
each ROM individually for the cars the
driver the owners of the cars would have
to take it to the dealership and then
they could update the software for each
individual car but many people don't
even go to dealerships they just take it
to their neighborhood mechanic who might
not have the ability to do this however
the case of the cars this is actually
starting to change with firmware over
the air so you can update your your
firmware remotely so this has its own
security implications but if this is
right then then perhaps this is starting
to be solved and so looking forward the
embedded systems community can really
learn a lot from the pc world when it
comes to security and so in particular
it can avoid making the same mistakes
that the PC world has made so these are
things like defending against simple
buffer overflows this is running your
code through standard tools that can
check statically that these sorts of
things can happen this is fuzzing your
own software to make sure that it
behaves correctly even in the presence
of input that you didn't expect so all
of these sorts of things they could
start doing immediately and it could
really make make their systems a lot
safer however I claim that the embedded
systems world can go quite a bit further
in terms of what they can do for
security so there are a number of
techniques that can defeat all of the
attacks that that we use because we just
needed the simplest thing possible and
in fact can provably defend against a
large class of attack so control flow
integrity developed your Microsoft could
be employed and that would prevent a
huge class of attacks now software
vendors have not have not implemented
these sorts of things and products
because they're not willing to take the
performance overhead as we were talking
about earlier so this means that even
though we know how to defend against all
sorts of attacks we simply don't but in
the embedded systems world you're
typically not on the bleeding edge of
performance and so if it takes say twice
as much computing power to implement cfi
well that's no real barrier you just buy
the next faster processor in the catalog
and the problem is more or less solved
for you ya hear anybody is a chain wants
to sell their thing at the lowest
right so if you be more processing to
get more security and your competitors
not I'm not doing that then he's going
to sell it for cheaper and you're going
to lose the bid right so isn't it
exactly the same ecosystem is the pc
ecosystem no because the well i guess it
depends whose perspective you're
thinking of if you're thinking of the
third party suppliers they perhaps don't
want to do this because they don't want
to they don't want to say well we can
build your part but it's going to cost
us you know an extra dollar per
component but if the manufacturers say
no you really need to do this all of
them if that's part of the specification
I mean in some sense you know if there
was a regulation said you had to do this
then people would pay the causes
probably same is true for PCs you know
if there was a regulation that said you
know you had to run this kind of
security measure everyone would just
bite the bullet of it you know you know
so is that is that it is that a
reasonable direction I think it well I
don't know if regulation is necessary
but i think that the manufacturers can
decide that they want to do this that
they want all of their suppliers to do
it so now the suppliers are already
having to implement this functionality
and since they want to use the same
components across multiple cars so they
want to be able to have they want to
sell to multiple manufacturers if they
already have this capability then I feel
like one manufacturer could take the
lead and say this is what you need to do
but I would hope that they would
actually get together and decide that
hey this is a this is an important
problem to solve could the the pc world
do this i think they could I don't know
that they will I don't know that they I
don't know want to say they don't care
enough but they don't they're not doing
this I I don't know at least it seems
like the the automotive industry has
decided that security is important to it
and so hopefully they will do things
like this yeah Josh perhaps the market
question is do you have any idea how
much we call
to actually put good security in each
car and then the question becomes when
consumers right so I don't know how much
it would cost after having done this
whole study we decided that basically
cars were insecure by design all of the
computers in the network are trusted and
there's no real way to get around that
so you have to basically throw this away
and start over with a new internal
computer architecture that is designed
with security and mud and the car
manufacturer that that we spoke to came
to the exactly the same conclusion and
in fact they have initiated a worldwide
effort to redesign their cars internal
architecture and so with security as a
focus they hired a bunch of people doing
security and so forth so substantial
liability car manufacturers know that
you can publish these results ah they
have hundreds millions hundreds of
millions of cars with these known
defects frightened and you published
lots of details about these defects so
they certainly know about them I wasn't
lawyer I would you know the drag these
papers in the corridor drag you into
court say you know you told them about
it they didn't do anything about it the
next generation of course that came out
the next year hit the same flaws in it
that's their fault well they're
definitely so the manufacturer we spoke
to was extremely responsive to us they
they wanted more information from us all
the time they they wanted to know what
is it they could fix immediately that
would make their cars better they wanted
to know specifics and they wanted
principles that would help them secure
the cars as is in at least one case we
told them about a flaw I think in the
telematics unit just in time for them to
get it fixed before they shipped the
next model year so they have taken this
very seriously they seem to be wanting
to to add security to their cars now is
this a liability issue I'm not a lawyer
so I don't want to speak to that yeah
I guess it's very related question which
is is there evidence this is actually
happening I'm not aware of any evidence
this is happening the only thing that I
know of that is really similar well
there was the the rental car company
with a disgruntled employee who did
something like disabled all of the the
cars using whatever third party thing
they had in their to disable cars but
I've been told that you can buy a device
that performs an attack fairly similar
or they will bypass the the anti-theft
measures in a car start the engine so
you can buy these things that you break
into the car you plug it into the
onboard diagnostic port and then it does
the rest for you so those exist whether
people are attacking cars remotely I
think the answer is probably not but I
don't know for sure and we were
certainly approached by a bunch of
government agencies and military
branches that wanted this technology so
some people are interested in it yeah is
it designed to networks one is only for
internal control and the other one is
completely
entertainment and right um yeah that's a
certainly a good idea this is what the
airline industry does to the best of my
knowledge they have a separate
infotainment network from the rest of
the avionics you could certainly do
something like that in fact the cars
that we looked at had two networks and
our initial hypothesis was that one of
them was the low security network and
the other was the high security network
just based on the computers that were on
the networks however after speaking with
their the engineers the car company we
found out this is not the case it was
purely a matter of meeting hard
real-time constraints and communication
so one could in fact could in fact
separate in many cases there are some
components that really do legitimately
need to talk to multiple networks and
these are the these are the places that
I think you should focus your security
so the telematics unit needs to be able
to monitor and control all of the
networks so it needs to sit on all of
them and so that's something where you
really need to put a lot of effort into
security all right so these were both
pretty big projects that I have worked
on and I've had a large number of
collaborators here who this these
projects would have been significantly
more difficult without them and with
that thank you very much yeah how old
the car should you buy so the thing to
keep in mind is that computers have made
cars much safer they are safer today
than they were so you should buy
whatever car you most enjoy driving
oh yes I do have a story about a horn so
at u-dub they were going through and
they were buzzing the cars internal
networks so they would target a computer
and they would just push the button on
the laptop that would send a random
packet of data and then they would
examine the physical state of the car to
figure out what had changed so this is
how we figured out how to lock the
brakes for example so while they were
fuzzing the computer that it was
responsible for honking the horn they
sent it the honk horn command by mistake
or rather they said we didn't know and
at the time we were unaware that it was
pretty easy to stop it you could send
one additional command which meant stop
performing all of these silly actions or
even just unplugged the computer and
inside 10 seconds it would stop doing
that but we didn't know this at the time
and so the horn just started blaring and
it got the attention of the university
police who came over and demanded to
know what they were doing and so you
know it got a group of grad students
sitting around a car that's just honking
and everybody's like this they said you
know we're doing research and the police
officer said on the horn and later
experiments we either disabled the horn
or rope I think at u-dub they just
replaced it with a small little speaker
that just made a little buzzed yeah and
related to that we disabled the airbag
if you were wondering so the
manufacturers were when they find out
what we did the first thing was like do
not play with the airbag it can kill you
this is not just so any other questions
electronic and sorted and sensor network
it in other words it seems like that
that's a very dangerous thing
just deployed airbag in the middle of
something driving down the road would be
pretty nasty yeah extremely um right
yeah I think you can but I don't know
what it was I don't I don't know how to
do it we certainly didn't do it there
was definitely something that would we
could spoof the fact that the air bag
had been deployed but that didn't
actually deploy it so it yes uh he
pulled the fuse so yeah we really didn't
want we had no interest in their bag
going off and actually I spent most of
my time in the passenger seat so even if
the driver side airbag went off no
problem Hey thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>