<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>LightSwitch OData Services | Coder Coacher - Coaching Coders</title><meta content="LightSwitch OData Services - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Microsoft-Research/">Microsoft Research</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>LightSwitch OData Services</b></h2><h5 class="post__date">2016-08-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/IH82qwbXG0c" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">each year microsoft research helps
hundreds of influential speakers from
around the world including leading
scientists renowned experts in
technology book authors and leading
academics and makes videos of these
lectures freely available
so um you heard things about our data
and the applications that been compliant
with all data and here's another one
that the will help you to you know make
it even easier for you to use o data on
and our presenters Carol we had to be
another pronounce each other's last name
yeah i'll let you introduce yourself hi
so um can everybody hear me okay my name
is carl Sidora and i'm on the visual
studio lights which team how many of you
have heard about visual studio flights
which i know some i remember from Eau de
tomita okay some people so um it's a
funny project visual studio lights which
started as a tool strictly for building
data centric applications on microsoft
platform and the primary goal was to
make developers as productive as
possible with this task that is we we
strive to eliminate as much of concepts
as possible as much of plumbing code is
possible and give you just an
environment where you focus on your
problem on your data and on your screens
and how this data needs to be presented
and the rest is left to the tool and to
the runtime and we shift our first
version in the middle of last year as an
add-on to visual studio 2008 and this
add-on allows you to build forms over
data applications that are architectural
III to your application you have the
server t or the data source and the
client and the client is a silverlight
application that can be
on inside the browser or can be armed
can be also deployed as a desktop
application and in the first version the
protocol between the client and the
service is proprietary I mean it has
been it's not really secret it has been
based on WCF ria services which is a
silverlight specific way of transferring
data between the surface tier and the
client but in the next version that is
going to ship with visual studio 2012
and that will be sort of delivered in
the same package as visual studio 2012
professional edition or above lights
which will be sort of built-in so um you
know if you install visual studio 2012
you'll be able to create light switch
projects and in this version we are
making a change and now the protocol
between the client application and the
service is odata and so every light
switch application will be an odata
producer and also can be a no data
consumer in the sense that you can
attach to an external data service and
expose it to your clients so I'm just
hoping that today we have some sort of a
conversation I'll show you what light
switch will be able to do when we ship
Visual Studio 2012 in terms of consuming
external data services or producing
odata services from say database sources
and you know I there are things that
light switch can do in terms of a data
and there are things that light switch
will not be able to do in this version
and so I'd like to hear maybe from you
also you know is it interesting what
should we focus for the next release
that yes
um so the question was will the metra
Lee release oh right um so the question
is whether metra apps will be using the
data as the default protocol um it's
it's hard to need to say I don't know
for sure but yeah it's not it's not like
prescribed that you know to get the
windows 8 logo whatever you have to use
odata that said I think that in emerging
pattern architectural pattern for you
know applications is that there is a
service layer and our clients and the
service layer is talking in terms of
some sort of a rest interface and if you
want a more sort of more sophisticated
query capabilities then Oh data is a
natural answer to that so in terms of
how light switch just just to give you a
quick context and there's a highlights
which development looks is you start
with the data source you can either
attach to an existing data source that
can be a database or an odata feed or
you can build your own and will generate
a database for you um you add some
information about this your data you
define entities and properties if it's
your own data source or maybe if it's an
attached data source you decorate it
with some validation information or
whatever and then you build on the
screens on top of that any run the
application start playing with it and
you know if you like it great if there
are some
other things that you want the lie
application to do and the runtime
doesn't provide it out of the box then
you start to refine the application now
in your case if you're just interested
in are producing the all data service
and not so much about the client
application well you just basically I to
rate you know here and maybe used the
client application as sort of a test bed
or use your own client if you have it ah
you don't have to you know invest a lot
in in the client but it's there if you
if you need it and then you know you
then you can iterate as I said and go
back and forth between the design time
and runtime and some of the UI changes
you can do even from within the runtime
so now I'll do a little demo and show
you how it how it really looks so this
is I have a build here that is oops let
me connect to this machine again because
resolution is not right I want to show
it in full screen so I have a bill that
is pretty recent so it might be a little
slow apologize for that um we are sort
of on the bleeding edge here so say I
want to create a new light switch
application and you light switch service
so I say final project and there is a
light switch known among other sort of
project types and the only choice that
you have to make up front is whether you
want to use visual basic or or C sharp
so let's create a c-sharp application
and then suppose that you have some data
like I got some data set describing
earthquake data from and so I will use
that
have imported that into a sequel
database so it's there waiting for us to
to consume so I could either start with
creating my own entities are attaching
to external data source in this case
I'll attach to this external data source
um and when you do that you can you can
choose either database odata service we
also handle SharePoint lists as data
sources and this this fourth option WCF
ria services sort of the throwback from
our previous version or you can you can
connect to a real service directly in
this case will choose the database I'll
use a local DB instance on my machine so
I have to use a spell to connect the
instance and I have this database here
the default name that the tool is giving
is not very nice old called it eq data
and I have just one table here by if you
had more tables or views or whatever you
could you know pick and choose what what
you want and so right now what we have
basically done is we sort of attached to
this data source and if we run this
application we haven't defined in you I
so the application will run but will not
show anything um actually I made in one
little mistake but the odata service
that is behind this up
location will work already and expose
the earthquake data I just need to
switch from a desktop app because right
now the application is by default we run
it as a desktop application and I what I
really want this I want this to be a web
application so that I can you know show
you the URLs and the traffic and
convince you that is this really Oh data
so I'll just it's as easy as just
flipping this radio button to produce a
web version of this application also the
UI of the client by the way is is
customizable so I can change the shell
type and theme and it will look a little
bit different and you can build your own
shelves but that's maybe not so
interesting right now so let's run it
again and notice that we are connecting
to a development web server that is
running on my local machine and so I can
copy this fragment of the URI which is
which is where the service is running
and then I can try to connect to the
surface from PowerPivot so
we called it eq data so the service is
eq data that service see SVC let's let's
test it and yeah it seems to really work
um so too we can just hit finish and at
this point the powerpivot will load all
the data and I have about 2,000 slightly
more than 2,000 rose and here is our
data right and so now it has been loaded
and you can use power people to do all
sorts of pivoting and analysis on that
data and you know we didn't write any
code to get this laid out of the
database and expose it as Oh data and
down if you look at our venerable
fiddler you will see that am I am I
actually capturing the traffic or not
I'm not not be capturing traffic right
now let's let's raise that
I think I have a filter set so if we go
back to our pizza and try to refresh
okay that won't work i'll show you later
in the browser so the bottom line is
it's very easy to get started any
questions so far okay yes
correct
right so the question is what about
authentication to the this equal so
right now I'm actually running the
development server and everything runs
in the sequel server integrated mode and
as as myself under my account so that's
why everything works and there is no
prompts if you deploy the application
then of course you need to have a
connection string in use you know either
the proper username and password or make
sure that your service is running under
an account that has rights the sequel
etc etc what lights which also has it
has a built-in notion of users roles and
permissions and it can for
authentication can use its own database
of users and roles and be the identity
provider sort of for for itself or it
can use windows authentication
integrated authentication so this is
shown on this page if you go to
application properties you know if you
see it you can you can say by default
the authentication is not enabled by you
can you can enable authentication say I
want to use windows authentication or
forms authentication which translate
into asp.net forms or HTTP basic for the
odata service and then you can define
permissions for users so think about
permissions are sort of an abstract
designation and in your application code
you can or in your service code you can
say you know if the current user has
this permission then I can do something
else don't do it right I'll show you how
how to do it later on so the first thing
that you can do with this
data is you can do some attach some
validation and what this validation can
do then is if you allow some updates to
your service validation code will be run
before any updates take place and you
will be able to catch any errors so for
example say we have this magnitude
property and say you you want to make
sure that the values Valley so I'm not a
you know geologist I don't know how what
is the highest possible value for
magnitude is it like 12 in Richter scale
or something like that I don't know but
you can say something like this you know
if so now we are sort of validating a
single record in this partial method so
you can say if this magnitude say is
greater than 12 right and you can say I
have an error and their message is
magnitude can be 0 to 12 or something
like that right can you guys see it or
should I maybe I should make it a little
bit bigger nice now in visual studio
that you can just enlarge the whole
thing without messing up with mom so
that's an example another example of
things that you can do is you can
control what happens when somebody tries
to read from your feed or add something
to it or delete so we have those methods
that we call access control methods that
are like can insert can read can update
so for example if you want
to make the whole feed not updatable you
can just say you know result from from
the can update on a particular entity
you can just say result of that method
is false and that will make it not
updateable just like that and you can
combine that with the permissions system
so if you go to the properties and say
okay I want whatever windows
authentication er you can then create
your own permission so you know say we
have can permission that we call can
update earth we gotta write this will be
defined in the application model and now
we can say this application i believe
user as permission and you can say
permission can up not all permissions
right and up update earthquake beta so
we say you know if this is true then
result is true which means go ahead with
the update else result is false so that
combined with the system or where you
can define users and roles and assign
permissions to roles and then put users
into certain roles or even you can use
windows groups to associate them with
ross gives you a lot
out of a flexibility because you don't
have to like write a call that says oh
if this user is in this role in that
role you just check for individual
permissions that are very specific to
what the user can or cannot do right so
another thing that is kind of
interesting is you can sort of filter
the data from the data sourcing spokes
only a subset of the data that you want
so for that we have another sort of
customization point in the whole
querying and updating pipeline which we
call entity underscore filter method and
so for example you could say I want to
only show data that is from some region
right so you can say if the earthquake
dot region is 33 or whatever then we
will apply that filter to the query that
filter actually gets applied to the
expression that goes against the data
source so it's not like you're filtering
stuff on the middle tier will actually
attach it to whatever where you send
through odata will sort of parse this
query attach this filter send everything
back to the data source the data source
will process the query efficiently and
then just send us the data that we want
and show you that this actually works I
will now add a screen I could do it in
the powerpivot too but i want to show
you you know how the client works when
it has something inside so we have a
bunch of templates that cover sort of
typical use cases and you can add your
own templates well just you know show a
grid of data the simplest possible thing
um so hit
five armed and now when the application
comes up we expect that the data will
only show the earthquakes in the region
33 if there are any I think there are
some in this data set
we get it for there we go as I say it's
a development vm it's a little bit well
this is not how the real thing works ok
so as you can see ah you know all the
data we got is you can or maybe cannot
see let me bump up the zoom a little bit
is from the region 33 and so the
interesting thing is that we give you a
bunch of stuff for free with with our
runtime so for example you know we have
paging built-in and that works
automatically and if you if you look at
the fiddler here you may not be able to
see it but we actually use the skip and
top operator on the odata service to
implement paging so it's not like our
client has some special knowledge it's
the query capabilities are built into
our odata service implementation so you
don't you don't have to do it manually
right that's thanks to the great job
that the WCF data services guys have
done which we are using another thing is
we have some filtering capabilities
building so for example if you want to
search for earthquakes that just
occurred on a particular day you can do
it um yeah I'm not sure what this didn't
work
but by default it searches only on the
string properties it doesn't search
numerical properties but you can
implement your own search queries so
let's do it next so we can say ok 44
this entity said I want to add a query
that query will be will be exposed as a
function import on the old data service
so again external clients can and call
it so for example we can have a query
that is like earthquakes by date right
and we can say ok we're going to filter
on time and the time will be between one
parameter and another parameter so add
two new parameters and we'll call it
start time and end time right and then
we can use that query to AH build
another screen that is like search data
screen
I've delete the previous screen because
will now have more capable screen that
will give us just what we want
see if we can get that work
okay so as you can see we actually use
we know that those search terms are date
so we actually have a nice calendar
control for that but don't use it here
because I'll be too much clicking and so
when you change one of the parameters
you get you know the query is
automatically executed but you could
change it and you could have a button
you know and when if you the user is
actually done specifying all the
parameters you could hit it and again if
you look at what the fiddler is doing is
now calling eq data SVC / earthquakes by
date so that's our our function that
that we just just defined without any
coding so finally I just wanted to show
you that these kinds of customizations
can be done not only to data that you
have in your database but also to some
external data feed as well so I'll just
connect to some feed on the data market
as your data market and and show you
that the experience is very similar in
fact exactly similar exactly the same so
we will add another data source and this
time we'll choose the old data service
um we don't have a nice picker for the
you're all so i'll have to just type it
in so it's a sure date api they the
market asier
I'll use the utility rates or this that
I happen to know and love but we could
use something else the data market is
using life ID by default to to identify
the user so I'll use that but they are
also using their own passwords or
account keys so I'll just use that and
then basically the rest works exactly
the same we download the metadata for
the service this case let's say I want
all the entities why not and then you
can open those entities in the designer
and start you know adding those
customizations and I adding validation
and that additional metadata information
so on so forth so that's a quick
overview of you know the demo what what
the light switch can do any any
questions or suggestions does it look
like you might be using that for your
data
so the question is can we publish those
applications to SharePoint yes the
answer is not in this version but this
is one of the things that we're working
on there's nothing I can announce just
yet but yeah that's one of the scenarios
that will definitely today you can
attach to data inside sure point but
it's sort of a standalone application
not really hosted in ensure point yes
right
um so the question is we are using
silverlight today for decline what about
HTML javascript client right so for the
next release of Visual Studio the client
option will so the only silver light
that said we are also working on an HTML
client so I again I don't have any
specific dates but this is sort of a
committed roadmap not something that we
are kind of just thinking about it's a
work in progress so I just want to
quickly show you you know this is this
is how light switch architecture looks
basically as I said there is client
middle here and the service and the
client is these are the parts that the
user is authoring the screens data and
the business logic for further a tender
screens and we have the shell data
service we build on top of a beta invite
on wucf data services and use currently
Silverlight for DUI in future HTML
Javascript and then we can deploy as a
desktop or the browser application a
similar picture is on the middle tier
where we have the business logic and
what we call operation pipelines and the
pipeline synergy the query pipeline or
the update pipeline that sits on top of
old data currently entity framework for
database access excuse me then we use
asp.net for a run time to host our
service and finally and some top sits on
top of is and I ended at ax in terms of
data sources that we can
talk to we have relational databases
available through entity framework
SharePoint Oh data and custom data
sources based on real library so that's
where the OData sort of this use again
we can we we always talk all data to the
client whether this is a light switch
client or third-party client our service
of course produces a service document
and produces a metadata so pretty much
any client can that understand so data
protocol can talk to it and then on the
service side we use o data to talk to
services as I was showing you with the
utility service or we can use entity
framework or aurea for other data
sources um so this is the first question
that I had you so in our next release
which will be the first release that has
0 data support in it we support a bunch
of o data features so we have almost all
intrinsic types we have two projections
relationships validation imperative for
declarative metadata and so on but
there's also quite a few all data
especially the data version 3 features
that we don't support or don't support
fully and they are listed here so things
like service operations we can produce
service operations but we really don't
consume them we just consume entity sets
if we attach to external data services
or we don't really handle complex types
and inheritance and or many many
relationships or
or geospatial types that are new feature
of odata v3 so given all that would be
the most interesting all data features
that you would like to see supported any
suggestions
okay what geospatial why is that okay
okay
right
okay so the name streams is a new
feature innovate iv3 which basically
allows you to um associate several
blob-like properties with the record
that's what it is basically so saying
you have a record and a bunch of images
attached to it right ah and usually you
want to retrieve record look at the
numeric data or whatever and then decide
if the images are interested on
interesting or not right um okay
right that's that's the idea so whether
you convert them so you know to some
extent you can you can do this today
through projections right you don't you
don't have to retrieve the whole record
but you know if you have a large blobs
of data you make one to totally store it
separately from your metadata right and
then this feature really helps hi but
thinking about you old enemy yeah
right
and then
but exactly so I thought that I'm going
to feature that a lot of and we're
tracking networking for the images from
satellite right
uh together with visual studio 2012
which is we don't know so you know once
we got the our implementation initial
implementation going we started to test
it with a bunch of feeds and we notice
that the level of implementation of the
old data protocol is actually varies
quite a bit because the spec doesn't
really say you know to be a no data feed
you have to implement this and that
right and light switch applications by
default try to give you some reasonable
experience for retrieving and editing
data so we implement the paging and
sorting and things like that and that
translates into specific functionality
that we expect from the OData fee so for
paging like we expect that hop and skip
operators query operators are
implemented for sorting you know order
by is implemented and so on so forth and
we find out that it's really really all
over the place so we are starting to
work on some sort of remedy that some
sort of capability vocabulary that you
would be able to associate with your
metadata and saying these are the
capabilities that defeat supports but
you would also like to you know be able
to test as many feeds
as possible so my question is did you
encounter a fee that was sort of looking
promising but then you run into trouble
maybe you can share your story and B if
there is a if you have a fee that you
would like to you know have us test then
by all means contact me ask question
right
right
right
right
right
re
right
if that's a great question i think if
mike if we start that at the community
will catch up and they will contribute
it's actually this is a one way that we
can get everybody to help
as you say by the way a very granular
profile what we have now is all the way
down to complete coke manual or have to
check for every we're looking both at
profile and also declining we'd love to
get feedback from you guys to the
features of them data on which are right
so in huge hey you're not speaking out
here you can always email us so at that
alias III yummy that's the alias that
we've been sending you everything about
this event and that will reach out all
of us and at Microsoft who's willing to
help and I hear from you otherwise yes
because which is the data feed from
process control and so there are
multiple standards but the OPC to point
over OPC three four know which actually
based on Microsoft proposed initial
standards are becoming somewhat de facto
standards for
and so my question would be provider or
our fees that comes from an OPC server
so that is easy to consume the process
control information back into cell
silver Knight has created by light
switch I'm in turn be really phenomenal
yesterday you spend a lot of time
transpiring there are third-party opt
driver right exactly in that case yeah
I'm not familiar with with that or any
or those standards for that matter but
it's a good question i took a not oh
I'll look it up email nicely as well so
we can follow up yeah so so my email is
by the way at the top and genre bar is
our architect and also very friendly guy
so please don't hesitate to email us
with questions or suggestions we we
always want to hear more from users
anyway that's that's all i had about to
say about light switch um any other
questions maybe or yeah otherwise you
can always catch up ok yeah Thank You
Carol thank you very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>