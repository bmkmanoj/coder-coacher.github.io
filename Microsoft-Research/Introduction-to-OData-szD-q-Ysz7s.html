<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Introduction to OData | Coder Coacher - Coaching Coders</title><meta content="Introduction to OData - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Microsoft-Research/">Microsoft Research</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Introduction to OData</b></h2><h5 class="post__date">2016-08-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/szD-q-Ysz7s" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">each year Microsoft Research hosts
hundreds of influential speakers from
around the world including leading
scientists renowned experts in
technology book authors and leading
academics and makes videos of these
lectures freely available
welcome everyone to a peck fest
tonight's talk is about OData and we're
very lucky to have mark here he's the
senior program manager here at Microsoft
um he's going to talk to us about OData
he's also going to give some great demos
and then this talk will be recorded and
you'll be able to view it again later if
you missed something don't worry about
you know hey I didn't get that one step
that he did because they'll all be
available on resonant you know what
right am I on
can people hear me test test all right
please let me know if you can't hear me
and I will warn you in advance that I've
had like four cups of coffee today and
I'm now drinking caffeinated water so if
I move too fast please slow me down we
are here to talk about Oh data Oh data
is a protocol for exposing data over the
Internet
so it's not directly related to any apps
but you need data in your app most
likely a node it is a really great way
to get data into your applications so
we're going to talk about both how to
expose odata services as well as how to
consume them inside of win8 apps and
other platforms as well I did steal a
deck that I use to present on Oda at
user groups so I may skip over some of
the content depending on how well we're
engaging so when I go visit these user
groups I posit a problem and that
problem is that data API is frequently
create more problems than solutions the
reason that they create more problems
than solutions is because there's so
much idiosyncrasy around data API so
every data API that's out there has kind
of its own look and feel and the really
big data API is like Facebook and
Twitter
they're called Fiat api's and other
api's they may follow restful principles
but by and large there is very little
consistency across the board so we're
going to talk about one possible
solution today to this to this problem
so I do have some assumptions going in
number one you know that
api's exists so hopefully you know that
you can access Twitter's data through an
API hopefully you know that you can
access Facebook's data through an API
most major websites that are out there
today are actually exposing some sort of
an API and then building their website
actually on top of that API - dog food
the API and make sure that it's
consumable by the general populace what
you guys probably want to do is be able
to bring that that data into your win
eight application number two you should
have basic familiarity with HTTP it XML
and JSON for the purposes of this room I
think just knowing that they exist is
probably enough and you should know that
rest exists you may not need to know
what it means right now because we're
gonna go through some of them so like I
said this is a really dense deck just so
that I know how fast to move through
some of this material this is just kind
of a quick poll how many people know
what the web is hopefully everybody good
thank you how many people are
comfortable with HTTP and XML and Jason
good at least half the room how many
people have a basic understanding of the
term rest Wow awesome and how many
people have actually created a data API
okay fewer oh all right fine
um in in the last one like there are
some people who are rest wonks and I say
that lovingly people who are rest wonks
we can have a conversation it's just
that this forum is probably not the
place for us to have the conversation
there are people who who really no rest
inside now who love Oh data and there
are people who really no rest inside
note that hate code data and they tend
to be polarized one way or the other I'd
love to have that conversation with you
if you fall into that category please
catch me afterwards so is there really a
problem let's start with the most basic
question is if so what is it so I want
to run through a really quick quiz here
with Facebook who thinks they know what
fields they'll get when you read a post
when you ask for a post back
picking guess if you don't know
get the username okay yep and probably a
time and maybe some other stuff but we
don't really know right until we
actually go look at the documentation
and this is part of what we get back
there's actually a lot more fields
attached to a post so on Facebook how do
you unlike a post the things I know how
to unlike folks I saw that one coming
okay all right so you have to send an
HTTP HTTP delete which that part makes
sense but you actually have to send it
to post ID slash likes because a light
doesn't have its own ID so you kind of
kind of know that the likes URL exists
and one or two more so with Twitter how
do I get a list of the users following
me I'll just kind of skip through and
say you you send a get to friendship
switch that part makes sense right like
like the actual request process makes
sense I don't know whether this is a bug
in there Docs or what but like this
person that came back Taylor Singletary
there's no connections so I don't I
don't know whether this is a bug into
Doc's a bug in their API or if that's
expected behavior and last but not least
how do I unfollow somebody you actually
send a post to friendship sliced slash
destroy I thought was kind of funny and
then you you get back this big response
that has all this data in it that I
don't know why you need that back if
you're sending a delete but so if you
don't know how to use these api's how do
you learn how to use these api's what's
the first thing you do
okay you're jumping ahead okay yeah
documentation right like so
theoretically they use dots and there's
Google up Docs and there's Twitter Docs
and there's Facebook Docs and github
Docs in Amazon Docs and Yelp Docs and so
on and so forth right there's many many
documentation sites out there so is
there a problem
yes developers don't like and don't use
documentation right they immediately try
to go somewhere else and my friend over
here was jumping the gun
so this OData magically cure the problem
no but it helps and we're gonna see how
so if developers don't go look at the
documentation what do they actually do
well they go pick up an SDK or they pick
up one of the council apps that helps
them to understand what the payloads
look like so in theory they they may use
an SDK if it exists so here's a number
of different SDKs that are out there the
developer consoles are actually really
cool the developer consoles help you to
understand exactly what the requests
should look like so that you can
formulate it properly if you're using
web client or something like that and
this is actually really helpful but it's
still a problem right like like you
would it would take you forever to go
through this and then to actually
replicate that in code and these api's
change all the time so SDKs are great
but here's the problem if your Twitter
if your Facebook if you're somebody else
you can probably get away with it if
you're a little service you probably
can't so what can you do and let's look
at the counter example to to what we
just looked at which is the confusion of
existing api's so if data api's were
like link instead i think you guys would
do much better on this quiz so with link
to objects what extension method or what
type of clause do you use to get
statuses in the last 24 hours
where exactly is that where this is what
what the thing might look like so how do
I do it with link to sequel
anyway how do I get the 50 most recent
statuses with with linked objects what 2
clauses do I need to use
50 most recent statuses take an order by
right and same way with link to sequel
right so the point here is that you guys
know that stuff because there's
consistency in the api's so uniformity
decreases the time necessary to learn an
API and it also decreases the amount of
time necessary to design an API so for
those few people who have actually been
through the process of creating a web
API
it takes a long time to figure out what
your URL structure should look like and
what HTTP methods you want to support
and what you're gonna do if you if
somebody is behind a firewall that
blocks get in put requests right there's
this thing called post tunneling that
you can use but if you're designing your
API from scratch you need to go through
all that stuff are you gonna support
Jason are you gonna support XML what
what are the payloads look like let's
get the quote it's a good quote though
yeah Jason we will see it in just a
minute but Jason is just a is the
JavaScript object notation it's a
JavaScript serialization format that is
much more pleasant to look at for humans
than XML it's also much more compact in
the wire typically
okay so we've established hopefully that
data API should have some level of
uniformity but you might be asking now
well isn't that what rest is for and so
we kind of need to run quickly through
what rest is so when Roy fielding the
guy who came up with the term rust talks
about rest this is what he means
resources should be uniquely addressable
application state on client-server is
kept separate resources should be
connected to each other via links right
hypermedia and this is a this is a
principle that you really really pushes
on hard in fact he says there should be
one entry point to the service and
everything else inside the service
should be discoverable from that one
entry point services should have a
uniform interface this is the one that
nobody really understands but typically
it's interpreted to mean the HTTP
methods so so you consistently use get
you consistently use delete you
consistently use put that type of stuff
and messages should be self descriptive
we can largely kind of discard this
slide because most of this stuff was
asserted in the thesis in what it looks
like in the real world is a little bit
different so what most people mean when
they say rust is that simplicity is
important and that resources are
identifiable that's kind of in a
nutshell what most people mean when they
say rust a lot of people want to try to
attach the concept of JSON but those
those things have yet to gain enough
momentum to be widely accepted so kind
of slowing down for a second and
recapping we've established there's lots
of different web api is out there most
of them follow their own little format
and that own little format isn't all
that useful to your application because
you either have to use an SDK to consume
it and that SDK has a proprietary thing
attached to it right you got to use that
SDK in a particular way or you've got to
go bare bones and use web client and
attach to the service that
all right so why is it rust enough so if
if we think that rest is out there for
building services and in rest is this
thing that people point to is the the
epitome of a good service why isn't
enough well most importantly the
conventions are insufficiently
prescriptive rest does not say a lot of
things it says a few things and what it
says it says well but there are a lot of
things that it doesn't say it doesn't
talk about URL structure so how do you
want your URLs to look it doesn't talk
about things like search it doesn't talk
about things like how to use methods
consistently right so how do you create
a new resource rest actually doesn't
define that in services that that are
just restful services require
significant documentation so most of
those services that we pointed out
earlier the the Facebook API in the
Google API is most of those claimed to
be restful services some people will
argue about whether or not they're
restful but they still very pretty
dramatically and also importantly we
talked about this briefly but we don't
account for things like search ordering
paging things like that all right
skipping forward let's get to some
interesting stuff so what's good about
conventions conventions enable you to
move faster right so we talked about
link we talked about how you guys
immediately know how to use some link
providers because you're familiar with
links so you know how to use link to
sequel you know how use link to EF you
know how to use linked objects you know
how to use an hibernates link provider
you know how to use the scenes like
provider just because you're familiar
with link overall you can also enable
generic tooling to produce and consume
services so our vector the data movement
vector actually dynamically generates a
data services and similarly on the
client side we can can generate code
that makes it easier to consume odata
services we'll see some of why in just a
little bit here you can build frameworks
that allow you to codify interact
what this means is that we know how to
delete something right so we can build a
framework that enables you to delete
certain objects oh this last point is
actually really interesting it's just
that I'm gonna make you wait to get to
it so conventions enable a more compact
payload we can actually see a 90 percent
savings over our XML format just because
of some of the things that we can guess
on the wire and I'll come back to this
in a little bit so how is OData better
than rest let's skip forward a little
bit we have some conventions right an
overview of the conventions so there are
three main categories of conventions in
an odata service there are some
well-known endpoints so one place where
you entry enter the service and
theoretically for that that hypothetical
hypermedia client they can navigate the
entire service from the entry point this
will work the data model is exposed in
most or all outdated services at an
endpoint called dollar metadata this
this endpoint helps you to understand
what the what the model looks like right
and that XML that's exposed at that
endpoint allows you to generate code
that the client can more easily use and
we provide a consistent model for
batching requests and creating change
sets so all odata services do batching
in the same way we have a really
powerful set of URL conventions for
filtering and paging and we have payload
conventions that you'll see so service
document this is what the service
document looks like this is the entry
point right so we talked about the three
well-known endpoints this is one of the
three this is the entry point this tells
you what you have available so in this
particular case this is a service called
Suppan and we have two sets of things
available to us we've got sue ponds and
users and the URLs unsurprisingly are
coupons and users for those they could
be different that's why they're separate
fields there we'll see some of this in
just a second here - in the browser
dollar metadata goes out and it actually
describes the entire service so this is
a snippet of what it looks like the
actual service kind of goes on for some
some extent but this is describing an
entity called soup on a soup on is
identified by its ID which is an int 32
and it's also got these other fields
attached to it so let's take a quick
break there and actually jump over to
visual studio maybe and see kind of what
this means in the real world if I open
up start an idea actually
okay so this is service that you can't
see very well this is a service that
I've just recently started building it
it's called tripping it's gonna be a
combination of TripIt and interest so
that you can flag trips that you like
and so on and so forth but right now
it's mainly got some airport in
information in it that we're gonna use
in a different demo down the road but we
can see that this is the main entry
point to the service and this is the
this is the atom representation for it
if we want to see the JSON
representation for it it's actually a
little bit easier to see in Chrome
don't tell anybody I'm using Chrome the
main reason that it's easier to see in
chrome is because ie doesn't natively
handle the JSON data type so it asks you
what you want to do with it and we'll
blow this one up too so just by
appending
dollar format equals adjacent to the URL
we're able to get back to JSON format
instead of the XML format it's actually
the atom pub for Matt but we can also go
out and see the dollar metadata for it
which describes the entire service and
all the different entities in it so far
so good
everybody with me there any questions so
far
what do you mean
if I want to have a directed graph
representation of something and send
that back
this or that
so the question was if the data only a
hierarchical can I have a directed graph
so so let me maybe explained it a little
bit about some of the some of the
modeling concepts we'll get to some of
this later too but there are two primary
types there's there's an entity type
right and a complex type and they're
used to create structure for the service
overall it right now in O 2 V 3 entity
types can inherit from other entity
types so you've got type inheritance and
so on and so forth
complex types will be able to do that in
in OData v4 which is coming up at the
end of this year and they can have
relationships to each other so entity
types especially have a much stronger
way to be related to other entities in a
means that allows you to bring back only
some of the entities unless you
specifically ask for they're related to
entities so if you've got a graph of
people who have friends right if you
just asked for people all you're gonna
get back are people you have to
specifically ask for people and their
friends or friends of their friends in
order to get back a more complex query
make sense no well so entity types and
navigation properties are available
right now and have been for for all the
versions of OData it's the the new thing
in v4 is inheritance and complex types
it hopefully some of that will make a
little bit more sense as we make more
progress through the slide deck okay let
me get back to the slide deck hopefully
so looking at some of the URL
conventions there are three main parts
to an odete URL and this will be useful
as we start to look at some of the other
parts of OD to services so there's a
service route in with WCF data services
which is one of Microsoft's main stacks
for building odata services that will
typically end with something called my
my service SVC that doesn't have to be
that way but out of the box that's kind
of the way that it is then there will be
some component that is a path to
someplace in the service so we talked
about the fact that when you go to the
service route you see a set of sets
right you see all the different things
that you can access so in this
particular service we can access a set
called employees and then in this case
we're casting it to a to managers and
we're doing some other additional stuff
with it and then finally there's the
query string portion of the URL so three
main parts to the URL overall the URL
path so that that center part right
we're gonna not talk about the service
route all that is is kind of where we
got where we start the URL path has a
few different parts to it right it can
have an entity set which is always the
entry point or frequently the entry
point I can have key segments that are
attached to entity sets that helps us to
identify a particular user and so we can
actually replicate this in in the
browser in just a second let me get to
the slide and then we can have like
navigation segments in this particular
case we're navigating we're starting at
the entity set for users we're finding
the particular user with ID
joon-ha we're going to the person that
referred him we're going to the person
that referred that person we're going to
their billing address and we're finally
going to the city so let's actually take
a look at that in the browser
if we can find it me there is my mouse
it's
okay
okay so here we are at the root of the
service right and if we go to users and
we get a list of all the different users
okay let's do this in JSON format just
for kicks dollar format equals Jason
alright so we've got all the different
users that are available there's only
three in this particular case we're
gonna find a particular user with ID
joon-ha then we can append additional
path segments to navigate so we can see
who referred Jun how and happens to be
how Chinn we can see who referred how
chin that was pilar ackerman we can
already kind of see the address here
there's a particular reason for that
that we'll get to later billing address
and I'm just going to jump straight to
city so we can jump all the way down to
a particular place in the service so
that so we've got the service route we
just get you into the ot2 service
overall we've got the path that gets you
through the service to a particular
place and then we have the query string
and there's there's one other thing that
we should call out here so you can
actually do typecast so we talked about
entity type inheritance in the service
and this is a typecast to a particular
type so the query string allows you to
do other special things you can do
filtering you can do paging you can do
ordering you can do all sorts of
different stuff with the query string
and we're gonna spend a little bit of
time on some of the URL conventions that
are out there so with dollar filter you
can do a few different things you can do
a very simple property match so you can
say hey I want all the users where the
display name is Hao Chen and there's a
series of logical operators you can do
equals not equals greater than
that are equally less than less than or
equal etcetera etc etc and more
importantly you can do and or not which
allow you to combine different types of
filter statements together there's
arithmetic operator is string operators
and other functions as well you can do
any all this was new and OData v3 but we
can do things like hey show me all the
soup bonds where one of the ingredients
contains the word garlic and we can
create compound conditions and they can
be arbitrarily complex literally up the
limits of what your service is willing
to accept or the limits of a URL length
overall which is pretty big questions
unfiltered before we move on
order by is very similar to filter we
can do simple ordering where we're
ordering by the display name we can do
more advanced ordering in this
particular case we're selecting users
but we're ordering by the user ID of the
person that referred them and since the
the user ID of the person that referred
them isn't actually coming back like
that the payload as you get it would
look nonsensical it wouldn't appear that
there was any ordering to it but is that
it actually is ordered and then multiple
filled ordering of course and more
complex types of things we can do
descending ordering etc etc no surprises
right things that you would expect to be
able to do with an API you can do
client-side paging with pop and skip
these work exactly the way that you
expect them to the way that they do in
sequel server
there's also another type of paging so
client-side paging is all well and good
but as a service if you're returning
multiple billion rows worth of data you
can't trust the client to use top and
skip appropriately and so you need to
implement servers server driven paging
server driven paging is the same as
client-side paging it's just that it
uses a next link as is kind of this
opaque token for how to get the next
page worth of results so you can enforce
paging and good Oda clients are expected
to understand what a next page link
looks like
select and expand select is column
filtering it is not protections so you
can't do math in there you can't assign
new names to things that may eventually
come in but right now it's definitely
just column filtering you can also
include related entities so we talked
about kind of this graph concept you
don't want to get back your entire
database by default in a query and so by
default a query is scoped to a
particular entity type or something like
that expand allows you to bring back
related entities as well and then
eventually near the end of this year
we'll actually be able to do much more
advanced queries where we can actually
ask for users and their orders where the
totals greater than a thousand and you
know the top top ten most recently
shipped orders where the totals greater
than a thousand we can't do that quite
yet yeah in fact so yes so that's a
great distinction to make so there's the
protocol right which is the OData
protocol and then there's our
implementations and stacks they expose
odata services we have WCF data services
and web api we'll talk more about those
in just a little bit so both of those
are built on a core set of libraries
called Oda to Lib and OD tulip actually
already internally has support for a lot
of the new expand syntax it's just it's
not a valid part of v3 so we actually we
implemented the core libraries late
enough that it was easier to implement
the v4 syntax and translate the v3
syntax to the v4 syntax or expand if
that makes sense
and most importantly you can combine
these URL conventions so you can come up
with a complex query like this where you
know you want the third and fourth
soupÃ§on where any of the ingredients is
garlic and etcetera etcetera etc now if
we take a big step back here and kind of
go back to the beginning of the
presentation where we postulated the
data API is create headaches and you
don't know how to use them what we've
solved here is the ability for people to
walk up to any odata service and
intuitively know how to use it just
because they know what hood it is like
so as soon as you learn Oh data on
service a you can approach service B and
easily start using it you know how to do
filtering you know how to do ordering
you don't have to learn all sorts of new
conventions for creating new entities or
deleting new entities or deleting
existing entities we'll move through the
payload conventions really quickly and
get to the demos hopefully so success
and error codes are are standardized the
overall formats are standardized we'll
look at them in just a second here
nuances right like what does patch mean
should we use patch should we use merge
what does a null payload look like so
the JSON format is the one that we
recommend the JSON form it's super
friendly to JavaScript especially the
new JSON format there is a legacy JSON
format that if anybody knows about they
should just keep their mouths shut the
new format is ninety percent more
compact than atom pub if you gzip it
it's still 30% more compact and it looks
like a custom API so if you were to go
out and design a custom API from scratch
you'd wind up with something looking
like this
we looked at a few of those payloads
right so if we kind of come back to
Chrome maybe maybe right so it looks and
feels very natural maybe not that one
but we go back a few pages right it
looks very natural in how you would
actually use a service
there's very little Odetta gunk - it
looks like this there is also an atom
format the atom format was one of the
original formats in OData it's still
around because there are atom parsers in
almost every single language out there
so even if we don't have a rich OData
client in a particular language if
there's an atom parser then you can do a
lot of stuff natively with that response
looks ugly but there it is and you know
kind of well can we do with with od2
services I'm so kind of getting out
there on the edge so great we can define
basic entities we can do crud what else
can we do so there's there's these
things called actions and functions that
allow you to do non crud operations
again this is something that's not
standardized in rest
there's no conventions for it but it has
conventions for how to do actions and
functions and the only difference
between actions and functions is one is
side effecting and one's not we have to
find conventions for a patch in deep
insert deep insert means if I want to
create a customer and an order and and
put them into the database together how
do I do that something called
containment if you don't know what
containment is maybe you know what the
aggregate root pattern is if you don't
know it either those are then probably
this feature doesn't matter to you and
vocabularies are an extensibility
mechanism so vocabularies allow you to
put custom information into any kind of
a payload whether that's dollar metadata
or whether that's the actual payload and
this is something as your uses to extend
error messages right they provide more
detailed error information with
annotations and other people are using
annotations to apply permissions to
feeds so if you don't get a property
back like is it because the property
didn't exist is it because the property
was empty or is it because you didn't
have read permissions to the property so
you can use annotations to deal with
those types of scenarios
all right let's see if there's anything
else important yeah let's let's fly
through this and we'll get into demos so
back to this slide let's say that you
buy the basic argument right you need
some sort of a standard for your data
API what else should you know before you
jump on the OData bandwagon I am a very
realistic developer I I've only been at
Microsoft for two years
and I remember what it was like to be
not at Microsoft so I want to be
realistic with OData so Odin isn't
always the best fit right if you've got
some really unusual service that's
really really heavily RPC oriented right
so you're rebooting VMs or something
like that then maybe oh data wouldn't be
the best fit okay but it is a great fit
for flexible data oriented api's in
general it's not good for bulk data
transfer at least it didn't used to be
with the new JSON format it's a lot
better but still probably if the only
thing you're doing is transferring a
table of a billion rows from sequel
server to excel TDS is a much better
protocol for doing that sort of thing
and API is there that are dramatically
different in shape from the back end
it's sometimes hard to do to do a no
data this has gotten much easier with
the advent of web api WCF data services
was a little bit more tied to the
backend o data doesn't support all
queries so we don't currently support
aggregation there is an extension to o
dated before that supports aggregation
but you can't ask for customers that
have at least two orders right now you
can't support filtering expansions right
now you get back all the orders if you
ask for the orders again this is
something that's fixed in OD 2 before
and we we have limited support for graph
style queries you can ask for a friend
of a friend but there's limitations
around it in the limitation is mainly
kind of what what we saw briefly here so
if I go to users Jun how I can say hello
a formula equals Jason and
teller expand equals referred by right
and that'll bring back the person that
referred to now who's is referred by
right here but then I got to ask for
comma referred by a slash referred by in
order to get the person that refer it
done right there's not there's not a
simple way to say hey I want all the
people that referred this particular
person out to four levels again this is
something that's fixed inside of OD -
before we made a lot of progress in Oda
- before so it is not a panacea and then
there's some people out there this is
this is a post by a guy called myths
demos bellow if you're familiar with him
he wrote service stack
smart smart guy hates OData absolutely
hate soda and I think his criticism is
unwarranted but I mean again being
realistic if you go out there and search
about OData you're gonna find both
criticisms and phrases on the plus side
Oh data is becoming a standard and it's
not just Microsoft participating in the
standard we're going through Oh ASA in
ultimately ISO the ETA for Oasis is
November of this year and we're in a
standardization body with IBM with CA
with sa p and many other big companies
as well skip skip skip Microsoft's
investing heavily yeah yes yeah so
Microsoft clearly cares about oh did it
right oh did it started here and we have
huge inroads already inside of Microsoft
so if you're trying to consume Microsoft
data sharepoint already exposes o data
many parts of a sure exposed Oh data
dynamics exposes OData there odata
services interesting just because
they've got they've got such a flexible
backend and you can define your own
types and everything like that so
they're auditing services pretty
interesting and this is just the tip of
the iceberg it says that because
there are parts of Microsoft that I
can't talk about that are doing OD to
services and it's not available publicly
so sequel doesn't expose Oded and
natively and I don't think they're all
that interested in exposing Oded and
natively mainly because it's so easy to
bootstrap and Oded a service on top of
sequel server and there's there's two
really really easy ways to do that
entity framework works really really
well with WCF data services currently
and it's super easy to put together in
entity framework model that just kind of
reflects on your database generate all
your types and then expose that through
an odata service and it literally takes
all of about fifteen sixteen lines where
the code now if you actually want to go
through and secure things properly in
stuff then you need more code but it's
just that it's so easy to do it on top
of sequel server already that I don't
think they're interested in exposing a
native OD to endpoint that makes sense
okay all right
s AP is super heavily invested in Poe
data if I had to name one other company
that was most involved in in the Oasis
TC the Technical Committee it's by far s
ap they've contributed as much or more
to the audio data spec as we have okay
so the rest of what I have to show are
our demos we can take a break we've been
going for 40 minutes and it's been
really really dense content I get that
are you guys ready for a break do you
want a break you want to just jump into
demos
question so you mentioned the enemy
framework ahead where does the
authentication come in are being able to
that's a great question you have this
public data that everyone can see
everything a notice five foot Barbara
where is that where I mean the first
thing I do in your Sprague's we're sure
you can strand it to the integer ID the
token yeah so um so oh data the protocol
doesn't specify what you're supposed to
use to authenticate the service and it
does that for a very specific reason
primarily because authentication changes
so fast right and there's so many other
standards out there for authentication
so we expect that the auditor protocol
will work nicely with authentication but
most authentication is driven by headers
on an HTTP request realistically right
so if you've got an OAuth flow then you
go out you get your token and then you
stick that token on to one of your
headers right if you've got forms
authentication it's very similar except
for it's in a cookie etc etc etc so what
we expect you to do is we expect you to
authenticate the service however you
want to and then use appropriate
authorization within the service and
hopefully our frameworks make it easy
for you to do that
so inside of either Web API or WCF data
services you can just ask for the HTTP
context identity or whatever request
identity whatever the property is that
actually has the identity on it and if
you use Windows or something like that
then then it's just sitting there and
and you have access to the identity we
have examples of people using this in
production for both Web API services as
well as WCF data services so we know
that it works
we've even got examples of people who
are doing like row level authentication
right they're doing they're restricting
the rows that come back based upon
user's identity in there are specific
ways to do that with WCF data services
and web api as well
anything else other questions before we
look at demos all right well um let's
start with some client-side demos
because we've been doing a lot of really
serious stuff maybe if I can get out of
PowerPoint sorry I'm working with a
really low resident resolution monitor
here so doing the best that I can in my
computer doesn't like it when I changed
my display mode all right so let's start
here so this is a particular solution
that I that I put together that it's
just called Suppan you probably can't
see this solution Explorer over here
very well I wish I'd put want to cause
something to crash if I do too much
let's try to do magnifier and I have no
idea how to use magnifier actually okay
just look at that all right so we have a
Windows Store application in here and we
have a service as well what we're gonna
look at first is kind of the Windows
Store application so you can see that
there's there's a service reference here
that we just created by doing you know
right-click add Service reference so I
can actually go take that service
reference and just choose to update it
but let's actually look at the
application running then we'll go
through the process of adding the
service reference and kind of explain
what's happening throughout the service
so let's see if we can get out of
magnifier and I'm just gonna debug this
application
and it's amazing it's wonderful we can
navigate all these soup bones soup on is
my brilliant idea to retire from
Microsoft it's going to be a clone of
Groupon except for we here we sell hot
soup and bread apparently so yeah we can
navigate back and forth full kind of
Windows 8 interactivity you can even do
search I want to do chowder I want to
look in Suppan I've got the ability to
go out and search various types of soup
outs as well
no big surprise especially if you've
already written Windows 8 application to
do that we just use the service
reference which we'll look at in just a
second and then literally all I did was
kind of modify the sample data context
if I can find that in here somewhere it
is possible to see
I am NOT able to read what's on my
solution Explorer so um thank you yeah
thank you no it's not under coming it's
under a separate folder called sample
data source pending well here they can
just control t-to it so this is a class
that comes stock with your Windows 8
application out of the box it's part of
the project template right so literally
all I did was do some modifications in
line here I used the types that were
generated with it had service reference
and then I just made some very minor
modifications to this I made a few
modifications as possible because I was
I was posting a blog post about this and
I wanted to make the minimum set of
modifications so one thing that I did
need to do at the time was I had to add
some extension methods at the bottom
here for for doing things asynchronously
we have since released a set of portable
libraries that will work inside of
Windows Store apps Windows Phone apps
etc etc etc and those already have the
async methods built into them so let's
just well it's at a service reference to
a different solution so if I just go add
service reference it's literally just
kind of the same way that you had any
existing soap service reference of etc
so I'm going to add a service reference
to OD to that I'm sorry services that
Oda org slash OData slash put it at a
service I click go
I get the service here I can actually
see the entity types underneath it
advertisements categories products
suppliers and then I can assign a
namespace and it'll actually create the
context for me and cochin everything
similarly there's an application called
link pad so if i go it's my downloads
late plat actually uses our client
internally and it will also do code gen
so if I choose to add a connection here
and I choose you know WCF data services
next it is defo do that org slash uh
data data SVC and will tell it to use
the JSON format because that one's
better I'll say okay it goes out it
generates proxies for all the things and
then I can do things like advertise ever
advertised mints take two
and it'll go out and get the top two
advertisements now our client actually
ships internally with a full-fledged
link provider so it actually will take
your link query tree and translate it to
an au data URL and if you want to go see
what that odete URL looks like if you if
you haven't gone out and read the URI
conventions then you can actually go
look at the request log here and it will
tell you exactly what query was
necessary in order to get those things
so this is the same client that's used
in all of our dotnet stacks you can use
it inside of Windows Store apps you can
use it inside of Windows Phone apps etc
so far so good any questions this makes
it really easy to consume data from
SharePoint
I'm talking about the service side
specifically let's see how easy it is to
actually create a couple services so
this is the first solution that I'm
gonna agree I'm actually going to create
the two solutions together because it
used to be that it took my machine a
long time to create the Web API solution
I'm not sure why but we're just going to
start with that with an empty web
application for WCF data services and so
we've just called it Tobi CFDs demo I
will expand the code or make the code
bigger when we actually see the code
we'll say ok I'm going to start the
other one creating as well just because
so this will be our Web API demo this
one I'm using the asp.net MVC for
template and I've just called it Web API
demo I'm just gonna let that go and
we'll kind of go back to the other one
Oh we'll just pick up the Web API
template here okay so WCF data services
we have the ability to actually go out
and choose add other new items and we
want a WCF data service which is down at
the bottom we'll leave it called up CF
data service one SVC
make this a little bit bigger all right
and literally to get going with WCF data
services all you have to do is give it a
context so we're gonna say call it
actually we'll call it user's context
that did not work right
cheat to create the context and all this
context needs to have is iqueryable
stuff so public iqueryable user users
get it set and it will create the user
class blip in tidy set we get public
string name it set we'll just create a
couple of these to actually pick up
again no magic happening here we're just
creating sample data and we'll say name
okay so all we've done is create a
little bit of sample data to give us
something to look at and now we need to
actually look at what this data service
configuration is is allowing us to do so
we need to be able to expose our entity
set so we can do that with config data
set entity set access rule and in this
particular case since it's a demo I'm
just gonna say all entity sets and I can
change this from all read to a variety
of different things right I've got all
I'll read all right read multiple read
single etc right now we'll just leave it
I'll read this is not what you would
want to use for normal authentication
it's just kind of a basic entity set
level access and you can set your max
protocol version that's probably not
important for most people if we have
five this
and wait and wait wait
uh yeah it does it's always loading
symbols I'm sorry I was working with
symbols earlier today so we're going to
wait just a minute here but it is still
working it will load the symbols
eventually so there are three there are
three main types of providers with WCF
data services there is the reflection
provider which is what we just used we
can go users right and we can say we
want to ask for that in the JSON format
we met close Jason okay we can ask for
just the top one etc etc so WCF data
surfaces kind of comes with three
providers out of the box it comes with a
reflection provider which is what we
just use the reflection providers good
for exposing arbitrary data sources so
if your data sources coming from the
scene or something like that as long as
you have a link provider to hand the
query off to and you're good to go and
you can use the probe looks like some
provider the entity framework provider
makes it really really easy to use
entity framework to use that instead of
the reflection provider you literally
just kind of pass a DB context here
instead of this custom context that I
created and then you know since DB set
is inherits from iqueryable it all works
properly and then there's a custom
provider if you have something more
advanced that you need to do that you
can use to expose any one of a number of
things and some of our some of our more
advanced partners use the custom
provider in order to expose things that
don't necessarily have tight definitions
right so so I had to create the user
type in order to use the reflection
provider because it's reflecting over
the types if you don't have types or
you're dealing with unsee eyes data or
something like that then the custom
provider is where you want to go any
questions on wucf data services it
releases approximately every six weeks
although we're in a moratorium right now
but over the past couple years we've
released every six weeks or so Web API
is the other way to create audio
services this one is a little bit more
involved to get started but it is
important to see
so let's start with this we'll just call
this users controller so we're gonna do
three things with Web API we need to
create a controller that can handle the
requests we need to set up the routing
convention and we need to build a model
that what whether it be I can use four
dollar metadata so the first thing we're
gonna do is is create the controller
because we happen to be sitting there on
the right page so we're gonna say entity
set controller
I'm gonna try and create this if I can
see it know what I wanted let's just
create it manually
okay so we'll just kind of create the
same shape that we did before and now
our entity second trailer is happy we
need to get rid of some of the stuff
that came in this in the prefab class
that was sitting here and the way that
the entity set controller works is it
uses the generic types that you pass to
it in order to define method signatures
so we can go override and we can
override get find it we want to override
get and in this particular case need to
return something actually I'm just
okay and we'll just need to what's up
okay so we're not actually gonna get
this one any data and we need to do this
as queryable okay so literally all we've
done in our entity set controllers say
hey look you can get back all the
entities if you want to be able to get
back into these bikie and stuff like
that then there are other methods that
you need to override so we say overrides
override get entity by key right you
return something here particular case we
return null so again three steps we need
to implement an entity set controller
we've done that we need to go setup our
route so we do that inside of Web API
config so we don't need this one anymore
oops I guess let's make that bigger
because I can't see it either so we
don't need the default HTTP route
anymore
because we're not using just regular web
api we're just using the OData part of
it web api so we're gonna say map Oh
data route and we need to give it a
route name say Oh data I need to give it
a route prefix
just say API and we need to give it a
model so we said that we had to build
that model somehow Web API has a class
built in it makes it much easier to
build your model overall so we can do oh
data invention model builder
we need to convince you to build a there
we go model builder and this guy just
has some nice fluent API on top of it to
be able to do things like the model
builder dot and be set user will call it
users boy we gotta get the right one
that one okay so all we've done here is
we've we've built a model we said
there's one entity set of type user
called users and here we'll call users -
just for kicks and now we need to give
that model to the OData route so we're
going to say model builder get EDM
all right and we cross our fingers I
should be able to load this guy up and
I'm actually just going to do this one
in Chrome immediately I'm good it's
loading symbols anyway
all right and we need to go to API
because that was our route prefix is
thinking
while that's loading are there any
questions about Web API you guys
familiar with asp.net how many people
have used asp.net in production systems
okay a lot of people have used web API
yeah couple all right so here's our
service
and we can ask for users although it
won't get anything back because we
didn't have any data in there so four
out four so all of that said we've got
two stacks WCF data services and web api
we've got clients for dotnet desktop
we've got clients for Silverlight we've
got clients for Windows Store Windows
Phone and we've got clients built into
Excel so I'm going to try one more demo
here and this is the one that may fail
spectacularly we'll see so one of the
things that you can do with with audio
services is spatial queries and so if I
can find my spatial query here
maybe it's in
Wow
so I'm going to
localhost okay so I will have to use the
magnifier here to help you understand
what's going on but what we've actually
done is we've asked for the five most
remote airports from where we are right
now so one of the types that OData
supports is a space a spatial type and
hopefully you can see that we've chosen
to order by the distance from here I'm
sorry from here which is negative 122
comma 47 to the particular location
where the airport is is located and
because we've sorted by that descending
it picks up the farthest airports from
where we are physically if we were to go
modify that and say so right now we've
got airports that are showing up in
Mauritius or more ETS or however you
pronounce that whereas if I remove the
descending then of course I get the
close airports right Boeing Field and
SeaTac and everything else so we can go
find the five closest airports doesn't
like Java Script somewhere
so if we want to consume that inside of
Excel we can actually use that data to
print out a pretty map how many people
have used power query how many people
know that power query exists you've got
two people that know the park where
exists all right good this is a cool
application so you can just go out to to
Microsoft's download site and download
power query it is super cool I would
trust me with the power query tab in
Excel here and I'm gonna say from other
sources and I've got a big prominent
OData feed now I've also got on the data
tab I can go from other sources and I
can go to from Odin to feed these are
two different providers so the one
that's sitting here has actually been in
Excel since PowerPivot 2010 it came in
with PowerPivot 2010 and it it supports
a lot of stuff it doesn't support the
same shaping that we're gonna see inside
of power query so I would recommend if
you have the ability to use power query
rather than this provider for OData if
we go over to power query then we can
say from the sources and we're gonna say
this guy will go pick up that URL that
we were just looking at for airports
and let's get our magnifier running
again
okay so this is what we have available
to us so what we could name the queer if
you want to and you can actually share
the queries out and so on and so forth
over on this side we get all the way
over to this side you'll see that
there's this little steps thing that
shows up and we'll come back and look at
that in just a minute here but what we
want to do is we want to shape this data
a little bit it's pretty good but it's
not exactly what we want we can see that
we've got this the three-letter code and
the four-letter code whatever those are
we've got the name of the airport we've
got this thing called the city that says
a record and we've got these locations
here that are kind of in a format that
aren't very easy to use right now so
let's see if we can fix this up some so
we're going to ask for some specific
information back from city and as we
expand that out now we've literally gone
and done and expand on the on the Oh
data query and it's bringing back that
data in addition come over
if we go to location we want to fix this
up because the data doesn't look like we
want it to so we're going to right-click
and we're going to replace values and
we're going to replace s re D equals so
we're just gonna trim off the start date
on the end and then we're gonna split
that that column up I'm gonna say 4 3 2
6 semicolon point and so we're just
gonna replace that leading text with
nothing we're gonna replace the trailing
text with nothing and then we're gonna
split the column on space
and then we're gonna rename those
longitude/latitude and we'll rename this
one just for kicks
cousin tree all right so now if I go
back over to my steps we can see that
it's actually put together the steps for
me Wow and I can see that I can go in
and modify any of those steps the really
cool part about this is it allows the
entire query pipeline to be refreshable
so we started from it Oded if your feed
that was already fairly smart and if we
chosen to filter these rows by by
something like the the country equals
United States or something like that
then that would all actually be built
into the OData query itself and then we
can kind of build on top of that with
things that Oda
doesn't necessarily support like
renaming columns and flattening things
out okay so we are going to try and
click OK in this we're done rather gonna
dump that data into Excel and we can
just use it there if we want to if we
wanted to go into power pivot we can go
in and use it there as well but what
we're going to do is we're actually
going to insert a map
and I think here's where we'll kill the
magnifier that gives us a globe that we
can use so we need to we need to
identify some information for actually
mapping this stuff so I'm going to pick
up longitude and latitude and you might
not be able to see it but it's actually
map itself just because it's got the
right names so I'm gonna pick country as
well and just so that you can see when
it doesn't map right hi I'll pick City
dot region and it doesn't know what to
map it to so it maps it to city because
it started with city so I'm gonna
actually pick state province for that
I'm gonna click map it and the first
thing that we'll do so out of the box we
kind of get these placements for all the
different airports the first thing that
we're going to do is kind of take a look
at the name and we'll put that
underneath height right now it doesn't
really do anything interesting other
than draw a lot of red bars but if we
actually change our mapping type to
country it will start to draw bars that
are varying height based upon the number
of airports in a particular country and
so if we go over to Europe we can figure
out which country has the most airports
based on the size of the bar it happens
to be friends right if there was any
question about that then we can actually
go click on France and see 112 and
Germany is 73 it looks like we can
change the view to a heatmap
etc etc we can also this is one of my
favorite things to do even though it
doesn't look all that good you can also
see the actual locations of all the
different airports around the world and
kind of what their name and stuff like
that and you can actually search this
control for certain locations so you can
punch in city names or other things like
that so if you want to find the closest
airport to a particular city then you
can go out and find that stuff
so the moral of the story is that Oda
has really rich support across the board
both on the server side and on the
client side things that we didn't talk
about as far as ecosystem are concerned
are JavaScript so we produce a
JavaScript library as well it's called
beta Jas and there is another company
called
I'm gonna drop link on their name but
they produce a stack called J data that
is really very cool for working with
odata services as well as a number of
other data types we are working on a C++
client there are existing clients for
Java and iOS although we're working on
improving the client for Java and the
one for iOS needs attention but yeah
it's a fairly robust ecosystem it's a
great way to bring data into your
existing apps so with that I've been
talking for an hour and 15 minutes
almost non-stop I'm sure it's really
overwhelming what questions do we have
at this point or have I completely
overwhelmed
Google's stance understands and it's a
great question so so Mike Amundsen the
guy who wrote restful Web Services a
while back or at least was involved with
it and is writing the upcoming restful
Web API calls those Fayette Web API is I
can mention that briefly at the start
and the reason that he calls them that
is because they have the ability to
decree that their API is going to look a
particular way right so they do what's
best for them and that's understandable
right I don't not trying to criticize
that I'm just pointing out that they're
doing what's best for them more
importantly they're their web BP has
changed all the time Facebook actually
has a 90 day breaking change policy
so they'll guarantee that your
application will work for the next 90
days but not necessarily beyond that and
so they'll give you a 90 day warning for
when they're gonna change their API and
they may not keep the legacy API around
the types of changes about at all or the
types of changes that we're making for
api's also
that's a big question so sorry I should
probably be repeating the questions for
the for the recording the original
question was you know what about Google
and Twitter and what's their stance
towards towards the data would similar
changes break and OData client well it
depends on it depends on the OData
client whether or not you did code gen
and things like that so if you have a
strongly typed idea to service and
you've done code gen our client will
will tend to handle that in certain
cases as long as you've done the right
things in our client
there are probably clients who wouldn't
handle it as gracefully but oda like one
of the things one of the features of it
that we didn't necessarily cover are
these things called open types which
means that you don't even have to
declare what the properties are on your
type and so especially as we move into
the v4 timeframe it's expected that
clients will be receptive of things that
aren't necessarily described inside of
dollar metadata but that said you know
the OData protocol has really strong
guidelines around how to version your
services and what to do and things like
that so typically what we would expect
is if you're really doing breaking
changes inside your service you should
version your service and bring up a
different end point there's no magic
solution blog you mentioned
good starting point okay so we should
probably do we have I assume that
there's some sort of a deal for this
group I and I can follow up with links
there
oh is it there is a deal I will try to
communicate this via email as well but
we have a blog on MSDN called a story a
team currently it's still kind of a
legacy name for for what deputy of data
services was and then OD data org is the
first place that we always point people
we're trying to put more attention into
that site right now but it it has all
sorts of information about the protocol
itself is not focused on Microsoft's
implementations because it's designed to
be the protocols website as opposed to
Microsoft's implementations for WCF data
services stuff you go to our team blog
which is you know blogs miss Tian comm
WAC Astoria team asp.net maintains their
own blog so that's we're going to go for
the OData stuff for them in the OData
org for everything else
if you have multiple organizations so
there is not a way to formulate a single
web query that will that will work
across multiple services just because
the queries are routed at a particular
place but certainly you can either you
can do one of two things number one you
can mash up the data in a in a client
like we just saw in data Explorer I'm
sorry I'm sorry
you used to be called data explorer
power query power curt makes it really
easy to mash up those data sources or
you can do that actually at a service
service side so you can have a service
that's set up like a proxy that matches
up those two services together for your
clients remember what I just talked to
you about is it makes sense for single
server not to support than 60 lines of
code that's the type of scenario right
there with you
one to mash up to four days sources
otherwise they're trying to do data
analytics
yep I get it so so if sequel server has
other things to worry about too right
like they would they would need to think
about plumbing their permissions through
that odata service and how do they do
that and stuff so so as far as like
sequel server is concerned it's probably
not a sixteen line solution sure like
I'm talking strictly permissions right
like sequel service position is not
gonna be will allow it will make it
really easy for you to bring up and owed
it ahead that bypasses all the other
restrictions on your data right that's
just it's not something that they're
going to do if they were going to expose
a notice service and make it a turnkey
you right-click here and expose oded
ahead over your database then they would
need to do more work in order to plumb
their permissions that are set in the
database all the way so if you're using
SSIS I know at one point in time they
were working on an OData source I'm not
sure what the status of that is
but I can check on it and follow up and
and certainly would not be all that
difficult to kind of write your own
I mean I've written my shares of SSIS
components so I can imagine that it it
probably wouldn't be more than a day or
two is worth of effort even to make it
generic right
yes
all right well my my alias is here my
alias is my staff oh I'm sure it's
attached to just something but I'll try
to get it back up on the slides if you
do have other questions or your team is
working on services please reach out and
I'm happy to help you diagnose whether
not put it as the right school for you
that was the demo failure that I was
trying to prevent just by the way I
literally have oh yeah I have a file on
my desktop called demo fail maybe see it
right here just just in case my demo
crashed
I had it backed up in place where I
could show but yeah my Ilyas is my staff
oh I'll see if I can bring it up here
what people are leaving but you have any
other questions please
Oh</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>