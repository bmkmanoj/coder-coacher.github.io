<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Checking App Behavior Against App Descriptions | Coder Coacher - Coaching Coders</title><meta content="Checking App Behavior Against App Descriptions - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Microsoft-Research/">Microsoft Research</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Checking App Behavior Against App Descriptions</b></h2><h5 class="post__date">2016-07-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/RjnjK1EdLwM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">each year microsoft research helps
hundreds of influential speakers from
around the world including leading
scientists renowned experts in
technology book authors and leading
academics and makes videos of these
lectures freely available
you
so thank you all for coming it's my
pleasure to welcome back Angie Estella
he actually had visited us many times
like he spent time here as the second
visiting faculty of him two or three
times now and today's here only for one
day but to give her some background in
case you don't know NGOs he is professor
at solent university in Germany and he's
also a cm Pharaoh he organized many
conferences is very very known and
respected in for food and today he's
going to talk to us about his latest
research on app store on every yep thank
you very much time and then well we
don't have the PA on but um but I hope
you can hear me all right yes not that
many in the room today but it's going to
be it's going to be maybe a bit more
interactive so feel free to interrupt
with questions any time you like so this
is a this is an this is our first
investigation into a field called eps
store mining where we are looking into
applications as you find them in common
stores in our case the google play store
from which holds all the android
applications and we're looking at very
general question here and that is
whether an application does what it
claims to do which of course is well
this is in all generally to it's sort of
the very fundamental questions of
computer one of the very fundamental
question of computer science and yes we
had we definitely had some fun doing
that and let me tell you a bit about
what app behavior here means what apt
descriptions mean and what the checking
process is let me motivate you with a
simple AB as we found it in the google
play store this is london restaurants
london restaurants with the screenshot
and this is the full description as you
see it as a regular user because when
you want to download it it's free it's
free and offers a lot I'd gives you a
full list of restaurants and pubs in
London together
the type of food and you can search for
specific kinds of food near you and
whatnot so it offers offers all the
usual or the usual stuff for classical
travel and food applications the
interesting thing about this app is that
on top of what it claims to do which is
which it actually delivers it also does
it also gives you a couple of extras in
particular this application accesses
your account information so including
your mobile phone number and your device
ID and sends all of this out to some
unknown server so and of course none of
this behavior is made explicit somewhere
in the mid explicit somewhere in the
description you could think that an
application that goes and takes your
mobile phone number and sends this
around for arbitrary usages is malicious
in the first place but that's actually
not true because the question what makes
an application malicious very much
depends on the context there's
applications say like whatsapp for
instance which is a very popular or
possibly the most popular instant
messaging application on Android and on
mobile phones which happily does this
just as well in order to function the
very very first time you start this
whatsapp application it actually
actually actually takes your entire
phone book and sends the entire phone
book back to the wats app server in
order to check whether any one of your
contacts with that phone number is
already registered with with the world
with with the wats up service so the
simple fact that an application sends
out private information does not make it
malicious in the first place the
question simply is liquid a question the
question is more whether the behavior
comes as a surprise to the regular user
or whether does not come as a surprise
to the regular loser so we could say if
an application does something which is
covered which happens somewhere in the
background and in particular which is
unedited
any of these behaviors this is the end
that this is what we're looking for this
is what we as regular users would be
surprised so and this is something which
is particularly true for this london
restaurants application because london
restaurants this is a travel application
travel and mapping and while the travel
and map application would for instance
happily access your current location
that's pretty normal for mapping
applications accessing your mobile phone
number is not part of what a travel
application actually has to do and
therefore accessing such account
information and sending it around is
abnormal in this particular in this
particular category which is different
from the messaging category so what we
do in this some so what we do in this
work is as follows we have set up a wave
set up a tool a tool chain which is
named shebada which is which stands for
checking application behavior against
descriptions of applications shebada is
also a French word anyone know anyone in
friendship is also French word denoting
a specific rhythm in jazz I think
there's a son Jeb badda-badda
badda-badda this is a famous chef french
film musical from the 60s and no made
from a man and a woman 61 I think and
this is where this specific rhythm comes
from so you're interested in French jazz
you recognize sure but I the last time I
gave this truck there were two people in
France who noticed that and to be
immediately burst into laughter so
apparently it strikes a chord so okay
good we've had enough funds now good so
this is this sir whatever this is what
we're doing in shebada here we are
taking a number of apps we are
collecting a large number of
applications we are grouping these we
are identifying the topics that these
applications deal with in their
description and then we cluster them
according to the topics according to the
topics that
dealt with in their description and from
that within each cluster once we have
found that we have a number of
applications that all are that you have
a number of applications that all say
belong say to travel and mapping and map
themes then we look at the api's these
individual apps are accessing api's as
proxies for their behavior and from that
we look for outliers if there is any
application in there in that cluster
which has a different API which excess
excess is different ap is then the other
apps in that cluster then we identify
one to identify it as an outlier so this
is and this is what I'm going this is
what I'm going to show you today in the
stock including the outlier detection
and I think of each topic as an
adjective any number of which can we
apply to a particular app I'll come to
that and I'll come to that in a second
I'll identify the individual steps and
then we'll kind of then I'll be happy to
get back to your question let's go and
let's go a bit and check the individual
steps in here the first thing we did is
well in order to do that you need a
collection of apps which is what we did
so we spent a total of four months
running a script that would download
apps from the google play store we
checked the other 30 category checked
all the 30 categories in the google play
store would download the top 150 apps as
well as their meter data which is the
description the rating user comments and
all that which is something we did last
winter in last spring we only looked at
free applications because well for
simple reason my upper university cannot
afford to pay for plenty of a plurality
of expensive apps so it's just the top
free apps this gave us a collection of
32,000 apps actually have to run this
script for quite some time because if
you download more
and a few dozen application today Google
is going to block you out because they
would reasonably assume that your that
you simply go into debt you that you
taking on a regular customer and we
actually made a data package which
contains all the meter data of all these
apps and this is available on the
website i'll come back to that and I
come back I'll come back to that at the
end of my talk so this was our this was
our collection of applications and this
is what we wanted to and this is what we
wanted to analyze and this is where we
wanted to these these are the apps we
wanted to learn which descriptions
normally correspond to which behavior
next thing is so you will get all these
with we get all these natural language
descriptions of applications so what you
need to do next is you need to do some
natural language pre-processing on this
for instance you have to get rid of stop
words these are words that commonly
occur in English language such as you
for instance you didn't care for you to
kill you care for that and you also have
to normalize the individual words for
instance to improve rolls into singulars
and likewise such that you get a vector
of all apps so this is what this looks
like so see you are in all these stop
words would be all these common stop
words would be removed and this then
gives you a vector of words that
describes what they a pic and what the
application is what the application is
doing and these are the words then
within each within each description that
characterize the behavior of the
application on this on these sets of on
these sets of stem words in description
we would first eliminate all the
applications who descriptions were well
close to being empty which actually
actually eliminated a third of all
applications because they were literally
close to no description at all in there
which is something I find surprising but
apparently people download these apps
even the even though they have no
description and then we use the standard
top a standard technique for topic
analysis
which is called a latent dirichlet
allocation lda which would take these
which would take these words and group
them and group them according to you can
group them into topics that frequently
occur together so you take the word that
we can go together and you reply lda to
put them into 30 groups and this is a
standard technique so for all the
natural language processing we didn't
invent anything new because we are well
we are we're not exactly natural
language processing scientists so we
stick to stick to all the standard
techniques as well as we always do when
we are venturing in different when we
are venturing different areas these are
the individual topics that we came up
with so so we had 30 topics overall we
gave them individual words but these are
the most representative words in there
so here's galaxy nexus where we can you
can identify the bread names in here
device screen effect install customize
so these is a cluster there's a cluster
of topics that all relate to
personalization gain video package a
game game video page sheet link and so
on this is for games and cheat sheets
slot machine money poker currency market
casino calling finance this is all
related to money and so on so we had a
total of weight a total of thirty topics
from top from top to bottom that all
relate to various aspects of various
aspects of topics and in individual
application would address yes
yes there are categories like this yes
yes the applicant the applications
actually already come with categories
less right there's a librarian which
does that but there's two things for one
thing for one thing we would have a we
would do we would we would find clusters
that you would not normally find in a
store for instance we had it and we had
it went ads topic in there which is we
had applications that from their
description make clear we have plenty of
ads so that's clear because we have
words like a notification policy share
airpush advertise or this is in there
but in a regular store I very much doubt
that you would find a category of ads
because normally well this would imply
that you as a user would specifically
search for that category which normally
you don't know I'm not too aware of this
so so I wanted to I wanted to have
something that what we actually needed
something that would abstract away from
the categories found in the store the
second reason for that is that the
categories as we found them in the store
did not suit or purpose very well but
I'll come to this later in the
evaluation yep could be yes if you have
something like Angry Birds maybe we
immediately can identify what's what's
about Angry Birds an angry birds is
inductive what's happening with the
screen here oh here we go touch screen
to make money two more
maybe text yes enough of the context
information to identify what episode yes
that's right we can in there in the
longer run you can you can also imagine
that if you have some sort of brand
names like Angry Birds for instance you
could actually say Bing the whole thing
and then check for reviews and check for
additional information about what would
be commonly ever become what will be
commonly associated with that yes yes
yeah this yes they Google can do that
because what they do is they know they
know which applications are downloaded
by individual users and so they can
recommend individual apps to you based
on the download history they will tell
you people who downloaded this
application and also downloaded these
other applications this information we
did not have so all we had with the
description we would not know the
individual purchase history of
individual customers site right now
similar apps are all kind of similar
functionality I I very much assume that
Google employs a number of librarians
who actually like actually take care of
provisioning this store and organizing
it I'm given the results we have this is
not always clear that Google has that
because we found because I'll come to
that in a second but in but in principle
yes you would assume that a well-kept
App Store would have a number of people
who actually take care of filling the
shelves and organizing them but but what
we found at the google play store was
that google apparently does not vary
care so much about what is what they
actually offering in there okay and for
the London restaurant application so
every application would have could could
could address multiple topics for the
google for the London restaurant
application this would end up in
navigation and travel
this was the this is the first topic
it's also about food and recipes and
it's about channel so this is the so
this is what we what we get now for
every application we have a set of
topics that this application at that
this some application addresses next
thing in here is we would go and we
would cluster these applications will
cluster these applications according to
the topics they they deal with because
applications would deal with multiple
topics and the idea here is we wanted to
have groups of applications that are
similar according to the descriptions
and for this we used again as standard
techniques the k-means technique to
identify such clusters and 4k means you
need a number K in order to identify the
number of clusters and there again we
use the standard techniques the
so-called elements silhouette to
identify the best number of clusters and
the clusters again we have 32 clusters
in here the clusters are very much in
line with the individual topics so if
your most dominant topic for instance
was puzzle and card games we would have
an appropriate would have an appropriate
cluster for that we have a cluster of
applications memory puzzles for music
music videos religious wallpapers it was
it was a category was a cluster which I
was not aware of but apparently there's
hundreds of applications that do nothing
but display your display your favorite
this is display your favorite religious
symbol somewhere or customize your
screen in order door or the reflector so
all of this is in here we also have we
also have adult photo and adult
wallpapers for those of you who
interested this is am happy to report
that this was joint work with this was
John work with Alessandro gorla hilaria
tava kia and Florian ghost alessandra
and hilaria were in charge of looking
into all the individual applications and
check for misclassifications and they in
the end these two girls were the ones
who checked out all the individual adult
applications we had plenty of laughter
from
the room and we as men would you want to
know anything about what they saw so yes
you get well you get the full breadth of
human activities reflected in these
applications okay so these are now 32
clusters and now in each of these
clusters we would have individual we
would have would have a set of
applications for instance the
personalized cluster these are the
individual words as they occur and as
they occur in the descriptions of the
personalized classes or the personalized
cluster is about themes and launchers
and lockers and choosing and design and
whatnot okay and this is very different
from say the travel cluster the travel
cluster would be about maps and
information and searching and travel of
course so these and and it did in and
this is how you can see already from the
word clouds that the applications in
each of these clusters are very
different from each other so now comes
next in turn a comes next part for the
applications in each cluster we wanted
to identify wanted to identify outliers
as it comes to behavior and as a proxy
for the behavior we simply looked at
static API usage which is which is
unfortunately not too difficult because
each APK this is the binary form of this
is the binary form of Android
applications you could simply you could
use a simple static analysis to check
which external api's are being used and
however we did not look into all ap is
that were being used saved all the
string API calls and whatnot this is not
very interesting we only consider those
api's which are sensitive which means
that they would be governed by a
specific android.permission.read that
the application if the application wants
to use one of these sensitive API is it
specifically has to declare so in
it's in its manifest so if you if an
application wants to access the location
it has to ask for a specific permission
and this would also in principle be
asked be presented to the user when the
user wants to install the whole thing so
the user has to explicitly grant the
permission to have the app Hughes its
use its his or her current location so
for on restaurants the api's being used
look like these so these are all the
sensitive api's that are being used so
from the sensitive API as you can
already see well it accesses web pages
it accesses well it does you are it
accesses servers by a URL it used the
notification manager it checks whether
weifare where the Wi-Fi is on whether
the network is connected so all of these
are sensitive api's and these sensitive
api's are governed by a set of
permissions these are the appropriate
permissions and you can see in here so
it needs to exit the Lisa access the
Wi-Fi state network stayed it needs to
access the current home state and among
others it also needs to get access to
your account well that's what it claims
that that's what it claims it needs and
if you now if you know look at all the
api's that are being used at travel
class or specifically all the
permissions that are being used in here
you see that these are also pretty much
printed these are also very
characteristic for the individual for
the interval episo all the application
then travel cluster typically need to
access your current location your
precise current location which is
obvious and they also need access to the
Internet this is what makes a travel
application whereas a personalized
cluster has means to access the external
storage it works over the network it is
able to turn on and off individual
components this is what makes it
personalization and so you can see that
not only do these clusters very much
differ by their descriptions but they're
also very much differ by the AP is that
are they but by the api's and the
permissions that they commonly need
and so this is what we have now for each
application in our cluster we can check
the individual AP is that are being used
in there and outcomes next part we check
for outliers in we check for outliers
within each of these clusters so again
here's a travel cluster with all the
permissions of API is used and this is
generalized over all applications in it
cluster and now let's take a look into
london restaurants this is one of the
applications in a cluster and you can
see that there definitely is a
difference in here because london
restaurants uses this uses api's which
are related to the get accounts
permission which are api's which are not
used by any other application in the
travel cluster which means that this is
an outlier and these three API calls
which are in bold in here are precisely
those API calls which are unusual for
this which are unusual for that cluster
so the question is how can we identify
so how can we identify such outliers
automatically for this purpose we used
with the so-called one class support
vector machine which is a variant of the
well-known support vector machines which
are commonly used for classifying but in
this case we use in a week we use it for
different purpose namely for identifying
outliers for each APK we put in a vector
of for each APK in the cluster we put in
a vector of the sensitive api's and the
number of call sites for that api and
what the OC as the M does is like any
SVM it creates a plane well n
dimensional plane that tries to get as
near as near and it tries to get as near
to the individual applications as
possible and then you can identify the
distance between that plane and the
individual applications and from the
distance you can then identify well
here's an application with
is far away from the norm which is an
outlier which is different in its
features and therefore this is a likely
and therefore this is a likely outlier
in here so and this is also precisely
what OCS then would identify in here
london restaurants would be properly
identified as an outlier because through
by its usage of AP is it would simply
differ from the norm so and this is list
it this is what your body gets you in
the end of all these step all these
steps are all these steps are fully
automatic i should say in the end what
did give what it gives you is a list a
ranked list of outliers with respect to
the API usage within each of these
clusters so the question is does this
make any sense so what are what are the
outliers that yet but what about our the
outline would what do the outliers look
like that you actually get there this
was this was fun work because because
you get to see a lot of apps this way so
what we did was a simple thing and in
each of our 32 clusters we identified
the top 5 outliers and then we looked at
them we identified them which we checked
what they would actually do and how this
would how this would correspond to the
to the description and I can tell right
away that twenty six percent of all
these outliers showed behavior that a
used sensitive api's be was not
advertised and see acts against the
interest of its users such as for
instance accessing sensitive information
propagating this without being
advertised in any place we used the app
we started the app we ran the app we
used the key with the standard debugging
techniques in order to identify which
information was accessed where it went
so this was a bit of this was a bit of
standard well sent you say safely so
good thing was that the
applications were not malware Percy so
they didn't use any sophisticated
obfuscation techniques to to disguise
their behavior so far so good so by
using standard techniques debugger and
checking which api's are being used we
could very quickly find out what they're
actually doing yeah i'll be getting i'll
be getting fed in a second Christmas
question so a lot of these apps are
interactive apps I was wondering how you
got these traces automatically we would
have somewhat fun for the evaluation
this was a this was manual work so we
actually interacted we actually
interacted with them and we checked
whether they whether what we get in the
outlier description but this actually
made any sense their faces nope it's so
far so far what we did is all automatic
a and B it runs away we are checking API
usage aesthetically so all of the
assault of this does not require
execution but in fact we strongly we
assume that in the long run a simple
static analysis of api's will not
suffice so we're looking into more
fine-grained stuff and I'll come to that
in a second and you also had a question
or let's just proceed a moment yep we
don't have the source code number
we simply with we simply know that it
declares that that it that it has well
it has a dynamic link to the API so
that's what it is number two it uses
their probability it requires the
appropriate permission to use that very
API so the API use it is not there by
accident because because otherwise they
wouldn't have to declare the sensitive
information too so these are this is
this but of course we don't know whether
the API is actually ever being called
that's it's yep you can think you can
think of herbs things think of a think
of a binary which is dynamically linked
and you have an external reference to
some external reference to some API and
this is precisely what by identifying
yes to see how many calls to the agave
we know your number we know the number
of concepts because you can do simple
binary analysis to identify the number
of God the number of jumps into that you
look at the bytecode just
straightforward nothing nothing more
complicated and if you ask me whether
the number of course site is needed or
not I would love to tell you that but I
don't know we simply started with the
number of call sites and that's what we
had in the beginning no but if you want
to access the sensitive API you have to
declare this in the manifest by
requesting the appropriate permission a
user's January as far as I say click OK
to even the most click click OK even
when installing the most outrageous even
when asked you the most outrageous
behavior so so we have a wealth of
experience with malware there's an angry
birds game you started it asked we want
really want you to we want you the
ability to send SMS and you wonder why
do you need to send SMS well because
that's how we finance ourselves see if
you like the game after a couple of
games you can send an SMS and to some
premium number this is why we need that
only for that of course what the f
it really does it starts out churning
out premium SMS the very moment you
started so yeah well not always easy
okay let's come to some of our let's
Colette's come to our stuff and what we
found in there first and foremost
outliers we found plenty of applications
that use ad frameworks there's a
plumbing and air push this is well many
of these well many of these free apps
finance themselves through ads so far so
good what's interesting though is these
ad frameworks give you as a developer
the higher percentage of revenue if you
allow your app to access more sensitive
information meaning that meaning that
the more sensitive information your app
accesses the higher the more money you
get from your ads oh no no no that's
that's that's simply because they gain
more information about you which is
which is which witch is which is more
marketable so if they not only know so
so if they if you just send an ad to
some anonymous user you know you get a
small share but if they know where you
are if they know who you are if they
know what's your mobile phone numbers
such that they can send text messages or
whatnot yes you get a you get a higher
amount of money that's the that's the
sad reality of let's just said reality
of ads it games that's what we found in
here we also had strange behavior in
there we had what would you have a you
know game for instance what was that the
you know game requires access to your
microphone and explicitly asked so so we
read there's there's no future there
there's no feature in the game which
actually does that but maybe maybe baby
baby this is targeted to some head of
state we don't know you install you know
on your turn
the physical reactions go see yellow uno
yeah that's right that's right that's
perfect you're fine um I is Angelo's by
14 I have in my notes in here one second
oh here we go wonderful chaya what what
what else do we have yeah wicked wicked
is the official application for them no
sorry em I was confused wicked is the
application for the musical this is what
this is the one that accesses your
microphone you know needs your location
possibly in order to figure out whether
you're sitting in front or on which side
of the chair you're sitting I'm not sure
about that here who yahoo mail where's
yahoo mail is able is also able to send
text messages well it asks for test
message and apparently it can send them
but of course this is this is this is
not advertised anywhere messages to
verify yes yes that's right that's
that's right but then you would you
would have at some point during your
user interaction or in the description
you would have some methods and notice
that tells you that this is actually the
case nothing of that found in these apps
um no no we didn't say we didn't see in
selling but it explicit explicitly
requested the the permission to send out
SMS messages uh I have no idea why I
have no idea why why this is a bitter
okay we all set applications that didn't
fall into the right clusters a
SoundCloud is an example this is an
application where you can actually
record audio and send this around and
this ended up in a sharing up in a
sharing cluster however recording audio
is uncommon for sharing for for sharing
application this actually means that
soundcloud actually is a mix of
somewhere between audio and sharing and
well it had to fit into one of our
clusters so that's obviously room for
improvement we also had an applique
Shin called a hamster life which ended
up in religious wallpapers and probably
triggered for every became an outlier in
there we have no idea what this is the
case and here's here's my favorite
example this is mr. Will stud poker this
ended up in the this ended up in the
game and money cluster and it was the
only application in that whole cluster
that would not display ads and since it
would not display ads it was immediately
identified as an outlier so so so what
you see in there outliers does not mean
it's good or bad it simply means it's
uncommon it shows uncommon behavior and
well if it does not show ads then this
is uncommon behavior features are to the
spm your is it just the AP is just the
AP on the set of a pianist yes and and
this stud poker game does not access the
internet and we bought what you normally
need for a for a for a for excess
application had exactly exactly yeah
yeah that's the thing so yes so so you
can also have outliers in these clusters
which were which are simply uncommon
behavior but in this case actually it's
one good behavior and a whole set of bad
behavior isn't there speaking of bad
behaviors we also did a second one of
evaluation and that's even more fun we
also took a set of known malicious
android applications and checked whether
these applications checked how these
applications would end up whether they
would end up as outliers or not so for
this what we did is we trained there
which range between the ocm OCS vm now
as a classifier on ninety percent of our
benign apps which we downloaded from the
store which was fine and then we had 173
known malware apps in which we use the
OCS vm as a classifier and then we
wanted to see how these benign apps as
well as our known malware apps would be
classified and this is the this is what
we got out here so these are all these
of all these of course our average
numbers over multiple runs and multiple
splits so from our malicious apps now
from of malicious apps the majority vast
majority was also predicted as malicious
smaller part was predicted as benign and
are benign apps a large majority was
awesome predicted it was also properly
predicted as benign in percentages
eighty-four percent of our benign apps
for cocoa work correctly predicted as
such and fifty-six percent of our
malicious apps were also properly
predicted as such and this is a and of
course if you do have some if you have a
malware scanner on your android app the
r you will get much better results but
then such a malware scanner actually
checks against patterns of malware that
are already known okay so it has a
history that it can check against
whereas we can take an arbitrary app
which nobody has ever seen before and
the description and it's api's and find
out that what it claims to do does not
correspond to what it actually what it
actually does in terms of API usage so
this as a as a sole detector of malware
this would not be enough but if you
combine this say if you combine this
with patterns of known malware if you
bring this together this can be an
excellent this can be an excellent
combination checking against new apps
which nobody knows anything about just
checking what they would they claim to
do and what they actually do here again
this is the correct classification with
clusters we also check the individual
components of our chabad approach so
this is without clusters you see that
without clusters the detection rate of
malicious apps immediately goes down so
all of this clustering according to
descriptions actually actually is needed
and also you ask beforehand the google
play store also has categories that's
right which is what we did too and we
checked for the categories given from
the google play store and you can see
that our clusters also are better than
what we find in the google play so also
we require less because well we don't
have we don't actually need and he said
sure any such categorization in the
first place so this is what this is this
is what we get in our what we got in our
second what this is what we got in our
second evaluation so we can improve or
even enable malware detection which is
good we're better than the given
categories and we don't require any any
prior knowledge about what makes malware
or not yes where did you get this comes
from a standard paper I think your name
is Android malware dissected where
researchers I think this was one or two
years ago where they brought together as
a collection of malware which they made
available for download which was the
precise at which we used in there
however we only looked at those malware
we only look at those applications for
which we could actually find a
description including copies of Angry
Birds where we actually looked up the
official description from the Play Store
for angry birds to associate that this
with the name so this was relating to
the question you earlier so you find
something that's called angry birds APK
okay and so we associated this with the
description of angry birds from the
google play store and use this as a and
use this as a classification for the
malware okay and then what you would
find that is so if this APK would be
would be nothing like Angry Birds
nothing at all would not even look like
a game at all it would immediately be
flagged as an outlier but even if it
would even it will fall into the correct
cluster based on its description and
then again we would identify well it
does a couple of things differently from
the other game and again would be
flagged as an outline and that's I'm not
saying that this is going to be the
ultimate totally malware detection it
won't be but if you have something
that's totally new and have nothing else
but the description and its behavior
this can help this is this disick this
can help you a lot identifying well the
worst offenders in the first place okay
a bit of a current work and we're
running out of time this is where as I
said we're not experts in natural
language processing we can do much
better than that one can look one can
make use of ontologies
one can make look one can make use of
what's the plural of thesaurus it's T
sorry Oh a synonym dictionary okay that
may be easier that's things we can do we
can we can also go and create explicit
mappings between topics and behavior
figuring out here's a topic and these
are the api's that are recombinations or
APR that would be associated with the
topic we can look for much better
features of individual of individual
applications information flow would be
information flow is our number one
candidate we heavily investing into that
and also checking whether any of this
behavior is actually it's actually
authorized by the user something like a
dialog pops up asking we'd like in order
to continue play please allow us to send
this text messages to this premium
number which is going to charge you by
so much are you okay with that yes no at
this point when you say yes and all the
information is there whoops perfectly
legitimate at some point but this is
also something we don't see at this
point okay this is part of this part of
looking into the information flow
problem with these problems within with
these letter points is as you already
pointed out if you do if you do if you
want to do all this by static analysis
you run into problems because yeah
including some of the apps we found and
definitely malware does that you have
plenty of features that make a static
analysis very hard I mean as soon as I
set up and interpret and an interpreter
of your own of a language of your own or
evil subset of language of your own your
static analysis essentially stops
working yourself we'll also have
instances of code that gets side-loaded
that gets created on the fly or that is
just normally obfuscator so all of this
will make your life hard if you do
static and symbolic analysis and in
practice this means that oh yeah
image on the slide as a sound recorder
application circles what about a sound
recorder application that also spies on
you so it is a genuine purpose for using
an API but also as ah yes well the thing
is that if the sound recorder does what
it says it says I'm recording sound and
don't install this only install this on
your own device never install this on
someone else's devices well we we can
only tell whether it does what it claims
to do and what not and then that's it
but we can only tell you before him this
is what it claims to do and does this
will or it won't but watch what you may
use you make of it is not something we
can we can check afterwards yep a remote
code remote code simply means there's
some sort of behavior which happens on
the server which you don't know you see
send some you evoke some service on some
server the result comes back and you
have no idea what's happening what
what's happened there what so much of
your analysis is based not necessarily
what's in Blanco
manifest yes because the manifest tells
you capabilities new application request
was and if it doesn't ask for that
capability and it's not able to call a
certain that's right yes are they able
to call those api's using any of these
tricks or just google somehow prevent
this because they do dynamic monitoring
to make sure Google does some dynamic
monitoring yes but Google doesn't
dynamic monitoring they have an
application in place which is called
bouncer which actually will actually
clicks randomly around on the
application in order to see what it's
what is then what is that make you doing
but if you wanted to set up any covered
behavior in your app the simplest thing
to do is to check the network you're in
and if your network is Google's network
you behave just perfectly and as soon as
you leave the Google Network that's when
you can that's when you would start your
your bad behavior yes we are having a
sport no no no no no that's not true
what they had to have to ask for that
but but what what you would normally
find is they would come up with some
legitimate use for using these apps if
you wanted an application to spy on you
for instance okay say so using a sound
recorder you would you would claim that
your application has this cool feature
of voice command okay say and now new
industries control your character by
voice command and of course then you
need to enable the microphone and the
thing is once you have that this only
happens once during installation so
there's no dynamic check afterwards with
with iOS this is different so the very
first time you access an API that's when
you've been asked whether you want to
use them very much you use a microphone
and then this would be a bit different
because you would be asked the
application would ask you in context
okay so you would start you would say in
your settings enable voice commands and
then you would get a dialogue from the
operating system asking you whether you
want the application to but they want to
enable the application to access your
microphone which means only at only at
this point would actually be but
actually be able
to do that and in Google this is
different because well you get a geek
give all these that you give give all
these permissions at the moment you
install this and you may even forget
about them afterwards so not all is well
and not all it not not all is well in
these categories and the fun part is but
all these mobile devices are all these
wonderful sensors and all this sensitive
information and well they will soon be
able to access your heart rate and your
pulse and your blood pressure and
whatnot your fingerprint yes that's true
all that so yes so there's this convert
with that sometimes an application in a
particular domain may use some some
sensor or something care whatever and
that's actually something that is able
to differentiate that happens other
people so like you know maybe some
location because it's like Oh fine
people really close to you that what if
a wound over to look at your top five
outliers did you did you check back with
the actual apt description it's not the
LTA summarization factors we checked
with it we checked with you so so you
know what universe one of the outliers
where we found while it excesses where
it can access your location but we would
not be able to tell whether this was
against your interest or not so these
twenty six percent were only with was
only stuff where we found that differs
explicitly against your interest there's
another second category I think which is
another fourteen percent or so what we
found well it accesses your data but
we're not able to tell whether this is a
feature or but this is a feature or
something that is directed against you
okay so this is this the second case the
third category was simply false
positives which is well if something
something that's unavoidable with the
sort of analysis I'll just like to come
to a close so this isn't so we're so we
will so figuring out the relationship
between what's happening on the screen
and what's happening in the code is
becoming increasingly difficult with
static analysis alone so what we're
doing here is we are investing heavily
in we're investing heavily in test case
generation which allows us to interact
with the application on this level and
then check what happens on the and then
check what happens on the code level and
then use this whole thing to guide our
to guide our do to guide the test
generation and in the interest of time
oh yeah we can go just hear what we're
using here is that what you're using is
techniques called search based testing
which is evolutionary algorithms which
start with a population of random inputs
which evolved these inputs mutating them
towards the specific fitness goals and
even if you have a very simple way to
measure the fitness these algorithms
algorithms will be effective which means
that you don't have to deploy your full
fledged symbolic analysis on dalvik code
but to audit all it takes for instance
could be a simple measurement which code
is being executed which not and we are
looking into various fitness goals in
here branch coverage API coverage
meaning that we can guide test
generation towards specific api's for
instance sensitive api's we can guide
test generation toward specific
information flows which is very
interesting and all of these Fitness
functions are very easy to set up I mean
it takes them how long does it take it
takes about two to three weeks to set up
an individual fitness function and then
you will have your tell you generate
your generic test generator adapted to
the specific runtime feature that you
want to look at and this is a demo we
had this year at the exhibit fair this
is one of this is our this our robot
which happily clicks along on on this
code on Android tablet so we are well
able very well able at these on this
date to very try to identify individual
interaction elements to click on them
then to Gunton to guide the entire
process at this point when we showed the
whole thing we only had a handful of
applications on this one on which this
will work reliably but by the end of
this year we're going to expand this to
the full roster of applications we're
having right now in our set and then we
will be able to look at all these then
features too by the way at the booth
plenty of people came along and ask hey
we have a robot that's cool but why
don't you draw but but can't you do this
and software as well we said yes we can
do this in software it's it's a ten to a
hundred times faster we can do a hundred
times in parallel and we can put it all
into a black box which I would which I
will put up here and we'll be happy
humming around but it turns out that a
black box that humming around doesn't
make a good demo so we had so so this
robot was this robot was before soon i
subtract it yeah sure sure I could just
I should just hire I just just set up a
cooperation with some Chinese University
where they have plenty of cheap work
labor that's what we okay and this is
the this is what we actually this is
this is there the overall theme what
what we're looking into so for hundreds
of thousands of applications possibly
the totality of all applications they
are we want to be able to gather their
descriptions the meter data but also
gather static features gather dynamic
features as many as we can and then find
out what's common in there what's
uncommon in there and particular learn
the common behavior such that we can
more easily identify what would be a
surprise for future for future users and
given that we now have these wonderfully
populated these wonderfully populated
stores hint microsoft also has them i
think and given that so far the field of
mother the field givens it less so far
when we in research mind individual
projects we looked at the version
history which is fine which is very
detail but we only had access to overall
a handful two handfuls of projects this
is fine because we get all the detail
detail development information but with
this you get an entire new axis where
you can look at hundreds of thousands of
applications and see what's common in
these applications not so much the
development history but what about how
they behave and but how they behave and
what users can reasonably expect from
them and with that I'd like to closer at
shown you are
shibata approach which identifies
outliers based on descriptions and api's
which identify such outlines reliably
plenty of key findings and a full data
set to a two hundred megabyte excel file
to be downloaded with all the middle
Demeter data and there oh that's it
thank you for attention and happy to
take more questions location that mostly
makes benign use of your personal data
but occasionally misuse it right
and there's I mean your approach will
not be able to catch it yes you do you
think there's a need for application
developers to actually food that they're
making only benign use of one's personal
data Charlie come all the stairs well
they could do it the thing is that it
won't be easy to tell what is benign and
what is not benign this is the this is
this is going to vary tremendously from
between users also between social
contexts I remember when Apple came up
with the app store in Germany there was
lots of outrage because Apple would
censor any application that would show a
nipple for instance which in Europe is
not that much of an issue of course it
is in the US and so would you so and the
question is if an application does that
would it be considered malicious would
it be considered benign this very much
depends on your cultural context so so
sorry services so something your email
yes
we are should declare that yes so so
normally so normally i would assume that
there would be that so what I'd like to
have is that for every sensitive
information and application excesses
there should be some part of you there
should be some some explicit declaration
and expression of what it does and why
it does that and you can think of this
as a simple form of consumer protection
okay so this is that's something I'd
like to see in our app stores I don't
care I i I'd actually don't care that
much whether an application is it is
benign or not because this is where this
is very hard to tell I just wanted to
just want to make it sure just what just
want to make sure that if an applique 12
in particular for free applications okay
which is where where where it's obvious
that they have two other day they have
to come up with some revenue model in
order to finance development but but it
has to be evident to users what these
applications do and there an end the
risk that come with it and this is
something we don't see in the in the
Google store at all there's essentially
no regulation at all so and I'm also not
sure what consumer protection agencies
think of they think of what's being
offered there right now it's Wild West
that's our sea and from what I see is
that many of the outliers that we have
identified have been taken down by
Google since in in the meantime not
because of our topic but actually
because users complain that's a fine
policy but I would very much prefer if
such actions took place before use the
star to complain about what about the
damage that's being done so that that's
what that's what I'm aiming for not so
much coming up with better definitions
of benign and militias but protecting
users against what they can be against
surprises they can find in there in da
stores and if you protect them against
surprise as well as a side effect you
also get rid of many of the malware
problems which is a good thing
hard I mean there's a lot here but I'm
not occur out the hard time
understanding what it is actually a few
what is actionable in what you will
build because there is a lot here right
so and I meant you know there is a lot
of literature now I detection but in
some sense it's like analyzing PHP
applications you know any time you look
at what you find something yes a do bar
is at this point further hi yes it's not
really exactly meloetta didn't know
about I think the hard problem that is
fundamentally unsolved actually was a
paper presented last week and tries to
address it is understand the content
which is to say if there is a disclosure
for instance of some sort is that
intentional boys are not an ultimate
this you point the corner cases where
it's not so obvious now how to present
the purpose of a particular disclosure
to user usable security has no every
possible paper yes I read about it has
only negative results yes hi so I mean
frankly had various attempts to have
these really fine grained permissions
just made it so that it's impossible for
these yes nope Kaplan what would there's
a lot here and certainly you know
outlier detection is you know profitable
or not
phrases yes but it's not like you know
given the false positive rates in a
sense it's not a solid tool right you
don't feel represent a good massage so
so what is actionable I guess so for me
there's two things in 4 first first it
first the approach is actionable in the
sense that if you do have if you do have
an application which you know nothing
about you can check it you can find out
that it does things that are unusual in
the first place which is not enough to
which witch is which might not be enough
to kick it out of some f store instantly
but certainly it is something which
should prioritize your scrutiny efforts
on this one okay if you say that here we
have yet another wallpaper app and it
does nothing unusual okay just get it
through okay so you can just can use it
for triaging the second thing is and
when you're talking about usable
security I think that if you indeed go
and present users these long sets of
permissions and what they imply or worse
or worse description of information flow
within applications here's the source
here's the saying here's another source
is another sink and here's 134 possible
mappings which one of these are okay and
which ones are not totally out of the
question I mean even we as experts will
have a hard time understanding that but
what I think and we're not there yet but
what I think is if you can leverage the
common knowledge about applications and
the expectations that are encoded in
there then you can say here's angry
birds too it's the same as angry birds
and is the same as any action game
you've ever seen as it comes to security
so this is safe that would be a thing so
so a so if you can rather than coming up
with the entire set of things if you can
simply point out the differences between
how this particular app is different
from everything you've seen so far or
what it enables ever the things the
things that make this unusual and if you
have a way to catch this if you have a
way to grasp it will I think there's a
chain
in there to make these to make usable
security much more incremental than it
is today what the other purposes I would
agree with you as a filter s of
Louisville head of some sort I think
it's always useful data but as far as
exposing to the end user and users think
that more commissions is better do more
with more permissions yes the scores a
t-bird students they do they won't get
installed an operation then they're not
install another soul it's it's it's all
on that face in all or nothing way yes
an invitation-only installation time
yeah your visit iphone user different
very different very different for
iphones yes informations on the whole
for me when I I know it's right that's
right that's still easy to UM so so what
I'm so this is this a very first attempt
actually to extract such common behavior
from applications I don't think it's
going to be a I don't think it will be a
solution to the malware problem or to
privacy issues in anytime soon but but
it's good but but I think it but better
by death but I think we're in a good
direction here so I know where is it
turned slightly misused in this company
privacy violation occupations and what
privacy violating is unclear because
intent is fundamental
great and so this is kind of a bit of a
circular definition but this one is that
if people knew this was in the system
that you can gain by oh yes it regularly
yes with any traces you can you could do
some of your sticking on that Larry yeah
yeah everybody out yeah but but but then
then Ventus is well known if you
advertise your house for sales for
instance and you say this is in a
district of the town which is known for
its vibrant nightlife whatever okay you
could find euphemisms for whatever is
going on the outlier is getting these
address yes far these phrases then what
you do is generate a thousand apps oh
yes grace yes we're cool even though
they're not actually downloaded mm-hmm
that's that's right once you're going to
have such a system in place you may be
able to gain but then this is this true
but but then what you do next is you
would actually wouldn't do this for the
totality of all apps that are offered
but you would do this only for a before
apps that are actually being used and
then coming up with a thousand apps that
are there only for all for generating
new common behavior wouldn't help you so
but of course this is all in malware
this is always an arms race in is at
some point you can't be something you
can wear something different they go
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>