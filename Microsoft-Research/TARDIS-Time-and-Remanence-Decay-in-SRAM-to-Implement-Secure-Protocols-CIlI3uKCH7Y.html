<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>TARDIS: Time and Remanence Decay in SRAM to Implement Secure Protocols | Coder Coacher - Coaching Coders</title><meta content="TARDIS: Time and Remanence Decay in SRAM to Implement Secure Protocols - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Microsoft-Research/">Microsoft Research</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>TARDIS: Time and Remanence Decay in SRAM to Implement Secure Protocols</b></h2><h5 class="post__date">2016-07-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/CIlI3uKCH7Y" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">each year microsoft research helps
hundreds of influential speakers from
around the world including leading
scientists renowned experts in
technology book authors and leading
academics and makes videos of these
lectures freely available
you
hi we are very happy to have with us
Kevon foo who's a associate professor at
University of Massachusetts Amherst and
bassoon joining you know if Michigan at
Ann Arbor Kevin is very well known for
his work on security of medical devices
he's won the TR under 35 research award
he's yeah he's been telling us about
implementing secure protocols on
embedded devices all right thanks for
the introduction I think this might make
maybe perhaps my fifth talk here I think
I do this average about once every one
and a half years so it's good to be back
again it's always a pleasure so this is
a in case you here mumbling or voices in
the background a mirror Ramadi is on the
skype line so he's joining us and his
booming voice is over the speaker system
he's the lead student on this project
his name is in bold here he'll be
presenting this at usenix security next
week so if I make any mistakes he may
pipe up are you are you still there a
mere okay anyhow I'm sure he'll be back
anyhow so what I'd like to present today
are actually two talks depending upon
how much time we have it was one hour is
that correct one hour so I'm going to
talk first of all about interesting
things to do with SRAM so SRAM is a kind
of memory that's found on pretty much
every kind of digital logic in the
universe it's how we implement l1 caches
it's it's how some microcontrollers
implement the RAM and we're going to use
SRAM to do some unusual things when
energy is one of our constraining
factors okay so and this is a joint with
a mirror at umass master a or she goes
by Nagin who was an intern here last
year in g g lose group a dan holcombe a
PhD student at Berkeley a Jacob sorber a
new professor now at Clemson Wayne
Burleson who's a VLSI design engineer at
UMass ok so what's the motivation here
there are a lot of devices out there
that don't have access to a trustworthy
clock
one large class of devices that fall
into this camp would be battery list
devices anyone use the orca card okay
I'm almost everyone here has an orca
card for transportation payments and as
you can imagine there's no battery in
there and because of that lack of
battery it doesn't know what time it is
so there's no notion of time while the
card is being powered up to do a payment
and know how it knows how much time is
elapsing during a transaction but it has
no idea how much time has elapsed
between transactions this is also true
for passports employee ID badge is like
this one they know exactly how much time
is elapsed when you're using it but
they're completely ignorant about time
because time is fleeting but we need to
keep control all right I'm going to try
to insert as many 80s and 70s references
as possible in this talk so what do they
have in common again no long-running
clocks and the adversary controls the
power and the time whoever is powering
up the device gets to choose when to
shut it down and these devices hold
information that you probably don't want
to leak it could be private information
and so this has led to a number of
security vulnerabilities by researchers
across the globe I'll just highlight a
couple I'd be difficult to enumerate
them all but there was one recent paper
on dismantling the Mifare classic this
is a contactless smart card it was used
I believe there are billions of them in
circulation at the time and it's a
payment card mainly for transportation
and they found that using a brute force
attack they could extract all the
information to effectively clone the
card this attack has been replicated in
other contexts the London Oyster card
which i hope is working successfully now
with the Olympics and there's just more
and more papers coming out as the
industry fixes the card somebody finds a
new flaw typically exploiting this
encryption Oracle because you can query
the tag basically an infinite number of
times you can extract all sorts of
information and the card is really none
the wiser it doesn't know how to rate
limit because it doesn't have a sense of
time at best it can just set a counter
and say well I've been queried a lot
and oh don't forget San Francisco okay
alright so moving on to slide for this
all basically boils down to brute force
attacks affecting these time unaware
devices this could be side channels
power analysis DPA for instance
pioneered by a Paul coaches group simple
reverse engineering sometimes if you
don't know what the algorithm is as
implemented if you query the tag
sufficiently number of times you can
start to deduce what the algorithm is
and then just plain old brute force
guessing keys and the problem is there's
no speed limit today so we're going to
try to stop that using our time machine
we call the TARDIS in our threat model
what we consider are what's called semi
invasive attacks this is a term I think
it's more familiar with the chcesz
community the cryptographic hardware an
embedded systems community what this
means is the adversary can interact with
the card from the outside but we're not
going to consider an adversary who is
able to for instance physically drill
into the tag or inject ion beams but we
are going to worry about outside attacks
like heating up the card and cooling
down the card okay so give you some more
quantitative information on just what's
going on when people attack these
systems here are rum five example papers
and just how many queries it took each
of these attacks to break the security
of the system and by break I mean have
enough information to clone a card so
that he arranged in simplicity to more
complexity shamira broke the uhf
password these are supply chain RFID
tags it only took two hundred queries to
be able to brute-force guess the
password takes about two seconds if you
work up to some of the more interesting
things over 10 years ago Ian Goldberg
and I think David Wagner had reverse
engineered some things in the GSM SIM
cards and phones and were able to
duplicate those sim cards using about
150,000 queries if you do 115,000
queries you could extract enough
information to duplicate a sim card
and these problems are appearing again
and again again so our contribution here
is a way to restore a some sense of
timekeeping and we're going to do that
based on SRAM DK these are the decay of
one of the most common circuit elements
found in digital logic and we're going
to exploit how this digital logic
behaves over time when you remove power
to create clocks or clock like devices
so I'm not an EE this is going to be the
most EE slide of the whole talk I think
my rule is only one transistor / talk I
apologize therefore here so this is an
SRM sell each SRAM cell is consists of
approximately four transistors and has
two other transistors to do some of the
control logic but as far as you need to
know for this talk a SRAM cell is a
cylinder and they didn't teach you that
in a VLSI design so an SRAM cell is a
cylinder and it contains either a binary
0 or 1 this is the atomic unit as far as
most computer scientists are concerned
now when you remove power from this
digital logic it starts to decay and it
goes away and it enters sort of an
unknown state and then when you power
back up it's going to power back up to
one of two different things you can
probably guess it'll either power up
uninitialized as a one or it'll power up
uninitialized as a zero the interesting
thing about SRAM is it tends to most of
the bits tend to be physically random in
their initialization and how they
initialize after being powered off not
all of them but the vast majority of the
bits behave in that way we're going to
try to exploit that to create
timekeeping so luckily our computers
today have more than one s for himself
so if you have a large collection of
SRAM say 240 bytes is what we use you
can start to do some interesting
statistics and you can count for
instance after your system boots back up
and you would like to know if you'd like
to know how much time has elapsed during
that downtime because that's what the
adversary is trying to exploit to trick
you you just count the number of SRM
cells and you look at their values and
you see how they differ from the values
that you initialize
stand by counting them you can begin to
essentially did reckon how much time has
elapsed so to give you an example we
took a photograph of a different TARDIS
and we put it into our SRAM memory and
then we would power down the system in
this case we powered it down after 150
190-200 10 seconds and then see what the
picture looked liked after we powered it
back up so these are real experiments
here happens to be on an msp430
microcontroller and we split the picture
up actually into four pieces because it
didn't fit into our memory so this is
actually for pictures assembled into one
but after a hundred fifty seconds you
can see there's a little bit pixelation
the the memory is starting to degrade
again we powered it off we powered it
back on the TARDIS was still there but
it was beginning to D materialized 190
seconds you get some significant
degradation of the image and at two
hundred ten seconds it looks to me
almost statistically random question the
question is where we're using bitmaps or
JPEGs hey Amir do you happen to recall
what we were using time yeah hey Amir do
you happen to recall it was it a JPEG I
don't have you I'll do anymore oh okay
but we translated it into bitmap I
believe I'll have to double check on
that yeah so what you can do though with
the image is you can start to go
backwards if you take an image you can
try to guess how much time is elapsed so
for instance if you see this pixelated
image and you kind of put it next to all
your different sample points you can
kind of guess well you know what it's
sort of in between the 190 in the 210 so
I'm going to guess that we were off for
between 190 and 210 seconds based upon
that memory decay so that's the
intuition of the mechanism we're going
to use to create these trustworthy local
clocks that are unpowered no batteries
necessary it's just running off the
power that's remaining after you turn
the system off okay
it is very temperature dependent and
I'll be getting into our temperature
chamber measurements these properties
change over long periods of time like if
you repeat this experiment a year later
would you with these units on the x-axis
be the same so I don't have so the
question is do with these results change
over time and i believe the industry has
a term for that mbti i believe is the
term essentially the degradation of
circuits over time and exposure to heat
in theory there should be some
degradation we haven't seen any and SRAM
as far as I know is is more resilient
than say flash memory flash memory does
wear out SRAM doesn't have that type of
wear out property so we haven't seen any
but there could be some alright so let
me go over the tardis algorithm and how
we try to dead reckon guess time on our
device so we initialize SRAM we in our
particular implementation we reserve
about 240 bytes of the SRAM to do this
and we happen to just initialize it all
to one you could choose all zeros if
you'd like you could choose a picture of
your favorite cartoon character whatever
you like to do but we chose all ones to
simplify our algorithm now when the
power turns off the SRAM cells begin to
decay so when we power back up we just
compute that decay we count the number
of bits but as was asked as pointed out
just a second ago you know what about
the effect of temperature temperature
will affect how many bits are decaying
when you have time as a factor so we
need to compensate for temperature and
the way we do that is rather simple so
after we boot back up we compute the
SRAM decay and then to in order to use
essentially the right curve that is the
right interpolation results we measure
the temperature it turns out most
microcontrollers have onboard thermal
sensors so it can measure its own
temperature and if it remember the
computers that don't have a temperature
sensor they're almost everything out
there is actually a temperature sensor
it turns out it can it can behave like
one so we measure that temperature and
that way we can figure out which
curve to use in estimating the time
delay after we do that measurement we
initialize the SRAM again to a known
condition so that we can prepare for the
next power off of course there is a very
definite temperature range and in our
case we're using a very simple algorithm
but you could use a lookup table based
on different temperature measurements
for profiling your chip if you want to
be really fancy you could use curve
fitting right now we haven't found it
necessary to do any kind of fancy like
closed form solutions for computing how
much time is elapsed based on
temperature and and hopefully you'll see
why in a moment we didn't choose that
pathway which states you initialize so
for example if you initialize to all
ones that get better results or worse
and duval zeros well I'll get into that
data a little bit but it hasn't affected
the statistical properties what it does
affect is what's known as leakage
current so it essentially speeds
everything up oh so what are the other
factors influencing the decay of SRAM
there is temperature but there's also
capacitor size it turns out as I was as
I was explaining over lunch to Stuart if
you think back has has anyone taken an
eee sort of 101 course probably probably
most people were required to if you took
okay you may have recalled things like
seven and equivalent and all that fun
stuff basically you can represent any
circuit as a series of the fundamental
discrete parts one of those discrete
parts being a capacitor and it turns out
all circuits have some nonzero
capacitance and we're going to exploit
that but there's also variation across
chips so we'll explore that a little bit
I don't have time today well at least I
wasn't planning to talk about SRAM size
on its impact so as to the questions
about the thermal set up this is how we
ran the experiments I think the pictures
are pretty clear up there slide 13 what
we have is a what's called a thermal
chamber an environmental chamber and
this allows us to precisely set the
temperature surrounding the chip that
we're doing the test on and we have our
infrared thermometer up there to help us
gauge the temperature which is a fairly
precise thermometer and then we're using
what's called the Texas
instruments msp430 as our experiment
chip it's a microcontroller and it has
on chip SRAM and then over there we have
a DAC the DAC is helping us to precisely
control when we turn on and off the
power so in other words this is our
program will power supply right here so
we can get ground truth in other words
over them how much time is actually
elapsed so to give you a feeling of just
what kinds of time can you measure using
just SRAM DK here's a rough chart i'll
show you some more detailed data points
in a moment but what you'll find is
they're basically three phases of time i
like to think of the tardis as an
hourglass so in stage one you've just
lost power and so all the bits are
intact and if you were to power back up
very quickly you would expect to see all
the bits there but there's a magic
threshold for this particular case in
this particular temperature in this
particular capacitor it happened to be
around 150 seconds at that point is when
SRAM cells began to decay but not all
instantaneously they all decayed at
different points in time so that's when
you enter the second stage where you can
get some more precision in terms of how
much time is elapsed but it's a
relatively short sliver of time and for
that reason at the moment we're not
exploiting that sliver at the moment
we're only exploiting the tardis to give
us one bit of time has the hourglass
expired or not and that's what stage 3
is so at stage 3 in this case around two
hundred thirty seconds that's when all
of the SRAM cells have decayed and so we
have no way to distinguish whether it's
been 250 or 400 we just know it's been
more than two hundred thirty seconds at
that point in time just like an
hourglass okay and again this was with
them at room temperature and using a 10
microfarad capacitor which is relatively
common for smart card applications okay
so how about capacitor sighs we tried
all sorts of different capacitors to try
to see how that would affect it
turns out really temperature and in
capacitor size these are all proxies to
what we're actually measuring the real
causal effect is what's the current
voltage on the voltage supply and the
capacitor is going to give us a
different voltage depending upon its
capacitance so with no capacitor at all
we're typically able to get on the order
of just measured in seconds of time for
security applications we have found that
to be sufficient because it allows us to
stop these queries you know what
previously could have been thousands of
queries per second so we can slow them
down to one per second using this timer
but if you're on a smart card you're
likely going to see actually a built-in
capacitor because it's got a store its
energy somewhere when it's harvesting
energy from RF you'll typically see it
around 10 micro farad's then you can get
up two minutes on some more advanced
sensor devices like Josh Smith over at
u-dub had a wisp sensor with a super cap
and the super cap was about 10 mil
affair heads I believe and there you can
get a timer that last many many days
without actually i think the power the
timer is just working off the leakage of
your SRAM okay so here's some more
detailed measurements about temperature
and so each one of these data points is
a measurement where we had to run that
thermal chamber get it to a precise
temperature measure it to make sure it
actually was that temperature and then
and then use the DAC to power it up for
the precise amount of time for that
particular measurement and as you can
see in all cases even when you crank it
up to 50 degrees C with no capacitor
whatsoever you still get a measurable
delay that is to say you don't need a
capacitor in order to get any kind of
interesting measurements so here we're
down at a fraction of a second when
we've heated it up to 50 but at room
temperature it's we're getting about
where are we looks like we're getting up
to about 2 seconds at room temperature
with no capacitor at all a question so
does that continue to scale or beyond 50
c does
oh the question is does it begin to
scale with temperature the interesting
thing is I forgotten the exact
temperature when the chip fails you can
continue to heat it but at some point
you've just destroyed your chip so we
take advantage of that in our adversary
model because you can't go to infinite
temperature you can try to go to
absolute zero luckily we don't need to
worry about freezing attacks here
freezing actually helps us it slows the
timer down hard I believe Amir do you
recall what the maximum temperature of
without causing permanent damage to the
msp430 i think it was i think it was on
the order of like 200 degrees Celsius it
the spec sheet says 120 if i'm not
mistaken okay question in the back well
maybe I me something you said so why is
the wash is talking at fifty seventy
percent oh so oh the why is the y-axis
stopping at fifty percent that's
actually a good question SRAM they're
too kind there are two large classes of
memory SRAM and DRAM an SRAM bits DK to
have effectively statistically random so
you're going to see fifty percent zero
bits and fifty percent one bits and that
means decay even though you said all of
your bits to one now if you were to ask
me that question and if I were Alex
Halderman I'd give you a different
answer because he did work on dear am a
couple years ago I think reminisce decay
and DRAM and DRAM is the external memory
so SRAM think of it as l1 l2 cache a
dram think of it as the SIM cards you
buy at the shopping store whatever those
have capacitors rather than transistors
to save the digital state and they do go
to zero all of them so here we have to
distinguish from random makes it a
little bit harder question in front so
is there is it feasible to trip the are
the is the thermostat close enough the
thermistor close enough ncpa that you
could have the thermostat read 50 while
the chip itself is a good lot yesterday
was it for me alright so the question is
effectively is the temperature sensor
kit can the adversary trick the
temperature sensor or trick the CPU
without tricking the temperature sensor
because of maybe distance between the
two physical components I don't have an
answer to that other than I know from
thermodynamics that you're not going to
have instantaneous heating the chip
itself the silicon is small enough that
it's hard to see with the visible I the
packaging is large it's mainly just the
leads going to the pins but the actual
silicon is only 3000 logic eight
equivalents and if you think about how
small transistors get today 3000 logic
gates is in a very small area so I don't
have evidence I I would love to meet
someone from the thermodynamics
community to help me give you a formula
but my gut suspicion is would be really
hard to heat one part from a micron away
from another that's my suspicion there
may be a way using a non semi invasive
attack like ion beams or some very
targeted radiation I suppose but that's
outside of our threat model we're trying
to up the ante here we're trying to take
an existing card that has known
vulnerabilities and make it harder to
break ok ok hey you can do this on all
sorts of different temperatures and
you're going to always see a curve the
temperatures basically changing that
magic inflection point where the decay
starts so as you heat up your memory the
timer will run out more quickly so
you'll have shorter timers but the
timers are all nonzero and that's our
goal here to get something greater than
zero for a timer from a security
perspective there's also naturally some
chip variation all of our tests were
done on the msp430 however we did see
variation even between individual chips
is difficult to control the temperature
perfectly we only had about a two degree
precision on our thermal chamber it's
it's designed actually have a much
larger range but we weren't allowed to
install liquid nitrogen tanks in my
lab so we can only basically do heating
but as you can see there is some slight
variation the important thing to note is
the shape of the curve is always the
same so in this way we could train on
one chip and then use that for the other
chip and still have some relatively good
precision I'm going to start with and
amisha configuration and you probably
want okay so the question is since the
natural decay is to the statistically
random case what if you initialize
memory to statistically random given the
mission right so well we kind of ignore
that I mean the way we get around that
is we initialize memory to a known
pattern so that way we can do a delta
basically XOR and then count and we know
the closer we get to fifty percent the
closer we are to an expired timer there
may I would imagine there could be some
fancier algorithms to try to squeeze
more information it'd be really
interesting to see if we could do better
than this there's some you can actually
profile each individual SRAM cell I'm
not sure if you're going to be able to
exploit that extra information to get
much more than a small constant factor
better but maybe you can about four I
think it was about four percent a small
percentage of the bits always come up as
zero or always come up as a one because
of slight mismatches between the lengths
of wire and the way the transistors are
connected you might be able to do
something interesting there but
identifying those bits since they're
only small percentage might not be worth
it it's more code space ok so we
implemented this on our favorite
platform of choice the UMass mu its
computational RFID tag that we've
manufactured in our lab if it's based on
the Intel wisp or I guess the u-dub wisp
is what it's now called but we augmented
it with a slightly beefier processor so
we call it the move we also augmented it
with these little piezo elements so it
can make little buzzing sounds sort of
tonal things so we did this in order to
try to test the theory of code we make a
squealing RFID credit card that's
squealed when you queried it too much
because naturally if somebody's quitting
your credit card in your wallet you know
100 times the second that probably is
not normal unless you're a really fast
shopper so in this particular device we
measured the execution time and we found
that we could get about a 12 second
timer with a standard deviation of about
point 1 seconds so if you query it
faster than once every 12 seconds we're
able to then make the tag beep and it
acts as an audible alert to say
something fishy's up in your wallet it
doesn't solve the problem but at least
makes the the wallets bearer
more aware of their surroundings and we
have some other applications that are in
our our full paper such as EE passports
and other battery list devices so going
back to the table again here's that
original table from the beginning of the
talk about how many queries it took to
break these various systems ranging from
car immobilization to payment cards and
you can see they range from about two
seconds to eight hours and so if you
assume an eight-second tardes to slow
down each query then it moves to a much
more interesting minutes to days so in
some cases you're actually seeing a
hundred x increase in the amount of time
the adversary needs to spend to get
those same number of queries taken so
this doesn't solve the security problem
but it significantly raises the bar to
the adversary such that there's more
chance the adversary will get noticed or
exposed and it also comes at no physical
cost there's no change to the circuit
here this is just a software update to
the existing program running on the
device okay but there are ways to attack
the TARDIS and the two the two most
obvious ways at least us were cooling
and heating because everything is about
temperature here because we're semi
invasive those are the main attacks we
worry about the good news is for cooling
and heating the thermal sensor seems to
to make it much harder to mount these
attacks especially if you're talking
about one second timers being able to
heat and cool a tag very quickly within
a single second we think would be
difficult there is this other attack we
haven't solved we call it the the pulse
attack this is where you're pulsing
heating cooling heating cooling heating
cooling heating cooling and it's an
attempt to wear down that timer but then
by the time the sensor reads the
measurement its back to the normal
temperature and so it's none the wiser
that not enough time has elapsed this
probably would affect timers that are on
the orders of minutes to days where you
can actually do a pulse but for a timer
on the order of a second ah I would like
to learn more but I'm
not aware of any way to heat up a tag
with that kind of precision sub-second
precision there may be a way but I'm not
have aware of one that I could just
carry in my back pocket lathe what
lasers so possibly the problem though
even with a laser don't forget it's not
about precision of aim once you heat it
how long does it take for it to cool
back down again yeah so yes you could
use a laser to try to heat things up in
fact we have found that just running the
card heats it up by 2 degrees centigrade
for each trial and we had to wait I'm
here do you remember how long we had to
wait between trials to get the the card
to cool itself down might have lost him
but I think it was on the order hello I
think it was the thermal chamber it took
about was like 12 men had soup for it to
cool back stat all yeah so just trying
to compensate for its own computation
took about two minutes to cool it back
down if I'd be surprised if you get like
a liquid nitrogen or piece of ice to
cool it back down in less than one tenth
of a second given that it has this
plastic housing but again we're talking
about a semi invasive attacks if you're
going to bring in sergey score bora from
the UK from was it Ross Anderson's lab
he can do anything he can extract AES
keys from stones where he's outside of
our adversary model here we're just
trying to increase the difficulty and in
the amount of time it takes yeah
did you talk about exactly the defense
mechanism like so for example what would
you do like do you actually keep a
countering memory or do you measure how
random the pintle cop look like when you
get power back what was the actually the
details of the defense here so so the
actual algorithm is in the paper but
I'll just be the high level picture the
high level pictures we look to see if
enough bits of decayed and well I think
I mentioned in the beginning we don't
use a closed form solution in our
implementation we could try to do you
know find a polynomial that represents
that lovely curve but because most of
these devices are closer in spirit to
rfid tags the desktop computers there's
not a lot of CPU available to do that
kind of computation for instance we
don't have Hardware multiply on our
platform so instead we chose the the
more simplistic approach of just look it
up with a very small number of data
points this gets us a 1-bit timer
essentially so we know how much time
will elapse for a given temperature
whether it's expired there's a lot more
you can do if you have more CPU or if
you have more space hey now with the
pulsing attack I do think it's a real
problem but we're relying on physical
limitations for those short timers the
laws of thermodynamics and how quickly
you can heat and cool and you can also
if you if you really cared you could buy
these things called thermal fuses in
fact I believe for some fips 140-2 use
to detect if you maliciously took your
CPU and froze it it will cause the chip
to fail if you do funky things with
temperature but we're trying to stay
away from modifying the circuit because
that costs money you're coming over
Vincent if it's below or above below
threshold we're going to you just say no
I'm not going
to answer your question exactly exactly
we could be safer to alternate the leg
heavy outfits g20 even 81 it seems like
you might have an electromagnetic pulse
type attack where there's some way just
attacked it once in all of the SRAM and
if you're worried about that attack then
often interesting hero 101 is the way to
go so the suggestion here is instead of
using the 1 1111 pattern use alternating
ones and zeros to defend against EMP
attack that may cause all the bits bits
to flip to in one direction that's what
you're saying yeah yeah it sounds like
that would be a no cost from an
implementation standpoint so why not but
I I'm not familiar enough with the EMP
to know how resistant to be sounds cool
yeah an EMP proof TARDIS that would be
great ok alright moving on ok so the
main application I talked about today
was defending against brute force sort
of treating smart cards as encryption
Oracle's but there are other
applications you can begin to imagine
where this timer might help we're not
sure but we're it's uh areas we'd like
to explore so being able to implement
timeouts and authentication protocols
especially with RFID tags RFID tags
don't know how much time has elapsed
before it gave a challenge to a reader
now it might actually be able to
implement a sense of time where it says
hey you had too much time to think on
that one maybe you cracked it so try
again maybe you could also implement
things like temporary ownership if you
think back to the resurrecting duckling
problem this may be a way to bring in oh
I'm sorry looks from the look on your
face not everybody is aware of what the
resurrecting duckling problem is so let
me tell you what it is I'm sorry I'm
going to forget the student's name but I
know is from Ross Anderson's group was
it Richard Clayton ok but a number of
years ago they propose the following
solution how does a a new duckling know
who is his or her
well when you are born you look around
and the first thing you see is your mom
and so that's how they said that's the
resurrecting duckling problem so the way
they're going to solve it is when you
lose all state the first person you see
well that's your owner or that's who has
the authentication controls of you and
so in some sense rfid tags are this way
whoever first sets the password is the
owner all right there's also the double
tap and pass back attack where this
might be able to help this is um where
somebody's double charging your credit
card now you might actually be able to
know if somebody's double charging it
more pass back this is when somebody
behind you is sort of doing this and you
think they're being friendly but they're
they're actually just getting your RFID
payment card on the non-security front
there could be some interesting
applications with ultra low power
sensors so sensors today may implement
what's known as a real-time clock this
is a clock like we normally think of
clocks it's always ticking the problem
is you're paying for each clock tick
even when you're sleeping and so if you
were to replace that real-time clock
with something like the TARDIS now you
wouldn't actually have to draw any power
while you're sleeping and so this may
replenish the energy that you've been
wasting on a clock that you're not using
the disadvantages you end up with a
coarse-grained clock as opposed to you
know something that has micro second
granularity but for some sensor
applications you might not need that
kind of precision and I already
mentioned the e-passport some there's
some interesting crypto research mainly
in the 1990s I saw there was a recent
paper by silly olviden and others at
Harvard on time release crypto it's not
directly related but it may actually
trivialize the problem because it cut it
allows you to sort of insert a known
quantity of time into computations so in
time release cryptography the problem
was how do you make sure someone cannot
open a message for a given amount of
time and most of the solutions have to
do with proofs of work or computation
the problem is people have different
computing powers and so the constant
factors were tremendously large in
between what Alice or Bob might be able
to compute in there for one might be
able to cheat the system but okay moving
on there's quite a bit of related work
in this space in particular with data
remnants
the most interesting work would have
been this data retention and SRAM so
Peter Gutman at usenix security in 1996
and Sergei over in the UK did quite a
bit of research on just how long does
SRAM hold its contents and they have
quite a bit of temperature data on how
long the SRAM holds its contents and
actually their work inspired some of our
ideas we combine this with the ferns
approach here at the bottom Dan Holcomb
one of the students on the on the paper
had created what's called a puff a
physically in cloneable function based
upon SRAM DK it turns out some of the
bits always come up as one some of its
always come up with zero and he was able
to identify individual chips just by how
the SRAM powers itself up and so that
was sort of our inspiration for the
TARDIS and thinking how else can we use
SRAM to do interesting things Alex
Halderman had a very interesting paper
in 2008 it use next security where he
was showed how you could recover the
contents of DRAM even if you take that
that ram module physically out of the
laptop you keep it frozen and you
physically take it out a laptop plug it
into a new laptop you power it up and
guess what it still contains the same
bits you set that was on DRAM again a
different kind of memory technology but
it's similar in spirit and that it's all
about remnants decay there plenty of
other clocks you might consider using
Lamport clocks from the 70s you could
try using that but again here we're
mostly about trying to install some kind
of physical notion of time in into the
computation all right so to conclude
basically four points of which I hope
you take home at least one the TARDIS
uses the remanence decay of SRAM in
order to estimate time we use it as a
1-bit timer although you could try to
use it for more than one bit depending
upon your application the TARDIS makes
brute force attacks harder it doesn't
eliminate them but it does make the
attacks harder in that it takes more
time the beauty is that it's pure
software there's literally no change at
all to the hardware so a manufacturer
who creates a smart card could literally
just update their firmware with this
very small algorithm
in order to have a sense of time to
defeat these very simple Oracle
encryption attacks and the other
interesting thing at least to me
philosophically is this is one of the
few cases I'm aware of where we use
remanence DK for good most security and
privacy researchers think remanence DK
is bad because it means privacy leaks
you can violate privacy but here we're
using it to actually improve the
security of our system so let's see it's
220 I forgotten how long we have until
two-thirty okay so I think I'll take
questions now I do have some other
material I'd be glad to talk about that
has to do with other interesting things
you can do with SRAM in order to make
puffs but I can talk about that later as
I see the crowd thinning out but I see
we have a question in the back awesome
all the best route you need for this
thing next were the smallest amount of
SRAM in a mirror please correct me if
I'm wrong we found is 240 bites but one
of the students Dan Holcomb told me that
he could get something useful with as
little as one bite is that correct with
your recollection Amir are you still
there we used 240 by its spots you can
do with much much lower memory or strong
memory yeah and actually maybe I'll have
a follow-up question to your question
the natural question to ask after that
is well does more SRAM help does it give
you a more precise timer and that's what
I would have thought it does help with
more precision but it comes at a really
big cost because every additional SRAM
cell you have increases your leakage
current and what this effectively does
is it drains your your energy faster so
you actually get shorter clocks if you
have more SRM so there's a sweet spot
where you need just enough SRAM to get
the precision you need but not too much
because then your timer is going to be
really short okay question
the pepper if you forget it any form of
prominent storage with their um the
platforms we target do have permanent
storage so i talked with smart card
manufacturers and like the guy who
invented the java card and they tell me
yeah there's non-volatile memory on
there in ours we happen to have nor
flash memory I forgotten how much it's
something on the order like 10k I think
nails small non-volatile memory is
extremely expensive to add to a device
it would be nice not to have any and it
would reduce costs SRAM is a relatively
large chunk of circuit this is why your
l1 cache is limited you're not going to
have gigabytes today of l1 cache because
it would take up too much space on the
die I'm so that's one of the limitations
in terms of the you wanted to implement
a timer if you just did some operation
that you know it takes a second on the
device City and kept track of how
parking cutting that be enough
um some number of digits well let's see
yes but can you do this when you're
powered off but you keep track of how
far you've gotten next I need power if
you say okay I was creepy slit did you
afford okay i need to do 60 more before
audience is there a way you can use
non-volatile memory to make it more
interesting timer so actually that's how
it's done today so manufacturers do
invest in small amounts of non-volatile
memory to store counters they're called
transaction counters so I forget if it
was visa or mastercard but one of them
has a transaction counter and after you
have I think the card we tested this was
five years ago after you do ten thousand
transactions it just stops and you have
to get a new card I call that a denial
of service attack great counter crisis
exactly what was just so so counters can
give you a physical total limit if you
think about integrating over all time
but the nice thing about the timer is
now you can have this card work sort of
infinitely long but for any given period
of time you can you can bound how many
queries happen in a given period of time
at a counter alone is not going to be
able to do a time-bound proposing with
income at the rate also not just to kill
her along right we combine the two not
come by like he's so I mean the solution
is different than TARDIS if i understand
correctly and hear ya is you know what
the time is a somehow we start computing
referring the computation that's very
predictable how long will take and it
has a regular periods where your
snapshot the state of that application
can you blow if you've done three rounds
of that application then it took to this
long if you sort of lift this much all
right except the processor is not
running when the power is I'm so it's
solving a different problem i guess so
you just say that would time that would
tell you how much up time you've had it
can tell you up time and so you can say
i'm only going to rate limit you have to
give me this much up time before I'm how
is that different from a transaction
counter
you maybe that's more floating point
that's more probabilistic the minimal
amount of time between the country
transaction number
so depending on principles you want to
watch on implement this I'm going to
argue to guess passwords wrong passwords
belonging one wrong passwords every 10
seconds but forever where's the counter
will basically say after three wrong
guesses we're done I'm not talking to
any more and that's how it's done today
I trying French passwords right this
would basically say a little rain limit
like you said just say you you slow down
as well destroy a passport that's are
you can just destroy a sport remotely
well actually have a picture think I
have a slide on the French passport no
not here sorry i don't have the French
passport right here but the French
passport the way it works is after you
make until you've made a correct query
it introduces an artificial delay in its
response time but it doesn't have a way
to reset the delay so it will continue
to delay you forever until you get a
correct answer so that's how they
implement it today there's no sort of
back off notion there's no notion of
time it was another way you could do
this is well suppose you suppose missed
or some entity with a lot of bandwidth
who's willing to answer questions in the
forum what time is it and it would sign
up if you had such an entity and all
your readers were online you could you
could you could rake you don't think I
don't they have the service okay well
that service exists then when you could
do how do you know that well okay you
keep tracking the last time that you
were asked to charge or whatever and
then anybody who and any time somebody
asks you to do something else they have
to prove that the current time is they
tell you what the current time isn't has
to be 12 seconds more
I think there may be a little bit of a
sort of circular argument though so that
the proposal is you use a trusted third
party to give you a sign time saying it
is this time here's the signature but
don't forget you need to guarantee
freshness of the signature and how do
you guarantee freshness of a signature
you have a clock but there is no clock
to be able to guarantee the present yeah
I see so if the adversary can guess you
haven't used your card in the last 12
days you can start with 12 days ago any
play yeah so it's a real catch-22 and
ultimately what it comes down to and
like Ross Anderson Bruce Schneier talk
about this ultimately you need a
trustworthy clock at some point you just
need physical security and here we're
trying to give you some physical
security with a physical clock that
comes at no cost in other words you've
already paid for it because you're
already draining your battery and we're
going to use that drain or excuse me
draining your capacitor we're using that
drain as a way to measure just like a
water clock wood or an hourglass okay
but I guess I'll stop there be happy to
take any other questions offline or if
you want to know more puffs I've got
more material on that so thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>