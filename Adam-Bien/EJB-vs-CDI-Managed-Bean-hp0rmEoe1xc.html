<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>EJB vs. CDI Managed Bean | Coder Coacher - Coaching Coders</title><meta content="EJB vs. CDI Managed Bean - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Bien/">Adam Bien</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>EJB vs. CDI Managed Bean</b></h2><h5 class="post__date">2013-01-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hp0rmEoe1xc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi this is Adam bean and today I would
like to discuss the difference in
performance or overhead between ejbs and
CDI managed beans or poachers so this is
actually one of the most frequent ask
questions should I use ejbs
or should I rather go with pojos because
of the overhead so to try that actually
this question is really hard to answer
because it depends on your application
server and implementation but it is
easier to measure than discuss or what I
already found were endless meetings were
participants try to discuss the
questions without actually any result so
I would like to start with a simple
servlet / let's performance gate slow
calm a beam overhead and this is just a
regular Java 6 servlet so we have that
and then I would like to use a a class
called
managed bean CDI managed bean and this
CDI managed bean is going to be injected
to the servlet so what we should do we
should just create a method string some
output and return the output return
output
Plus system just concatenating current
are Milly's to go sure that the output
isn't cached for instance so and I would
like to inject the CDI managed pin see
the I managed bean CDI managed pin to
the servlet I checked so here we have it
pins XML is already generated so we've
generated by NetBeans so and what I
would like to do is to use the output
here and this would be being some output
so there's lots of stuff which is
actually not used like just to remove to
add so simples html5 application so
let's try that run and now it will start
the database and GlassFish and we'll try
to deploy the application to the server
and then start the browser so it takes a
while because there's a cold start of
the application server of GlassFish and
yeah now it's deployed as you can see
seems to work so this is the ori we need
so now to generate some load we need a
tool and tool I built is light fish so
it monitors the performance and what I
also did I pre-installed light fish and
light fish is a an agent which runs an
application server monitors GlassFish
and cut thus the performance metrics so
it should already run so let's try that
8080 slash nine fish
and as you can see the application
server runs for one minute and I can
start the monitoring but I'm not ready
it what I also need a performance or a
load generator stress test generator and
what I do I would use I would use Jamie
town so I just start a start to that and
would like to pre-record a test so I
would like to to create some load so a
thread group and I would say number of
threads let's go with 10 threads forever
and drum per hour periods is 1/6 now
it's five seconds or two threads or
seconds a second and then I would like
to create a a listener sorry a sampler
and this has to be an HTTP request and
what we have we have to pass here and we
have the server name is localhost the
pot number was 8080 get is okay and the
path is this and to verify whether it
actually works properly I would like to
use a to install a listener and the
summary report is just fine because I'm
only interested in the error rate
whether it actually works so let's start
the test start no and I would like to to
measure the error rate as you can see
zero errors we get about I would say 20
K not no transactions but 20 K requests
per seconds there actually no
transactions right now so which is
actually amazing so I will just stop
that create your results
and then start light fish right view so
what I would like to do first is to
start the monitoring so now it gathers
the matrix and they are pushed over a
long polling to a client and I will just
like to start the client which is done
right view so this is a small Java fix
application and we have heap size
transactions this is actually the light
fish transaction so every two second to
store something in a database we have
Paranormal Activity so we have here the
number of errors which is three errors
for some reason we have one business
thread and we have no commits per second
in the world X per second and we have
two sessions and some applications
deployed it should be over had some
internal GlassFish apps and delight fish
so now restart a test so I would like to
start the test run start no and this is
a little bit faster because right now
the hot spot optimization was able to
optimize the bytecode and we can just
monitor the performance of course no
commits per seconds we see cute
connections to the cluster is actually
busy we have about six six busy threats
and no transaction so they are actually
again there are just internal
transactions and we have about 90
threads count and Peaks rest counts
above 100 and heap size looks great so
there seems like no memories we have
about 200 megabyte rem so 20k
transactions per second not know sorry
requests per second so just I would like
to shut down shut down the threats
clear their results and then introduced
on egb so I would like to change that so
we have I would just rename that copy
paste I would call this a real EJB so
the real DJ be this on the GB and so it
has this transactional and the
performance gate servlet uses the real
egb instead of the managed P so now the
application was redeployed
and now let's restart the test so I
would like to
Oh charity is not able to stop the test
okay it's not a big deal and we will
save the test plan as did you be
overhead and just restart jmeter EJB
overhead and then just restart jmeter so
so we should have yeah everything looks
fine and we just repeat the test so run
start and Simon reports so we see the
performance let's go to the GlassFish
and what we see we have a number of
transactions right we have two
transactions per second right now
paranormal activity is very similar to
be forgers no no no a big difference
performance we get several thousand
transactions per seconds right now and
there are two transactions and let's
look at the performance so we have about
14k now through transactions per seconds
and I assume it will be about 15k or
something and actually this test is not
a real test because in real life you
will need a transactions to access the
identity managers they will have to
start the transaction somehow and also
keep in mind that the ejbs that the EJB
is pulled by the container and the CDI
managed bean is not so or this was
actually the best case now it is because
it's dependent scope with requests coped
it would be recreated on each request so
what we give right now
the egb are of course a little bit
slower than see the I managed bean but
we get still amazing performance so we
have about 15,000 transactions per
seconds comparing to about 20 ka
requests per seconds and yeah this is
the egb overhead so
and usually if you are building Java
Java apps you would be usually very
happy with 20k transactions per second
per node and the performance performance
problems occur usually if you access the
database and not trying to optimize eg
B's versus CDI management so thanks for
watching and see one of my upcoming
conferences workshops or real-world
projects so thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>