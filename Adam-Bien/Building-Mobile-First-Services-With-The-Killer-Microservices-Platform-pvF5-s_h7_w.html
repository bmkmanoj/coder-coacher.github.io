<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building &quot;Mobile First&quot; Services With The Killer Microservices Platform | Coder Coacher - Coaching Coders</title><meta content="Building &quot;Mobile First&quot; Services With The Killer Microservices Platform - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Bien/">Adam Bien</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building &quot;Mobile First&quot; Services With The Killer Microservices Platform</b></h2><h5 class="post__date">2016-10-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/pvF5-s_h7_w" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I am world session live streaming
session from from actually Munich and
the session the name is building mobile
first services and this is actually what
I had to do in the in recent projects
because most of the devices were mobile
devices and I would like to give you a
very short introduction or how we did it
and why we did it and 2 into 2 to
explain behind the scenes what actually
happened so um about me I'm broking as a
java ee ee and JavaScript developer
since 1995 I started with HTML and Java
at the same time and stick with that and
so I've write a block is more or less a
notepad so I've read my thoughts if I
find something interesting which
interests me i just posted three times a
year i organized workshop with munich
airport so if you like come to munich
and there is a spamming list mailing
list a hex news with a meter information
like for instance i post about such
events like this one and there are some
online courses so if you have two
questions there is one once a month at 6
p.m. CET I answer questions is exactly
the same infrastructure like this so I
got the questions the whole month and an
answer them at once so is that the
course of Munich Airport some books some
online courses and now let's start with
the content and so I spent some time in
Romania in cluj and I just wanted to
explain something and I I searched for
an example and of course i started with
Dracula and what happened was the
developers told me they hate Dracula and
I say okay what we should build and it
told me something with horan car would
be would be nice or Palin calves are
okay then let's build that so this is my
last slide so let's go to d by the way
you can ask me questions via Twitter or
use the ircd building chance so I'm if
use Twitter use hash tag air hags or IM
well so i will try to read it if not i
will stick after the session a while and
will
answer the questions then okay so let's
start with with the back end so what I
wanted to to do to create briefly a
service and later deploy it on Doc and
explain what happens behind the scenes
and why it's mobile first and why the
platform rockso horan car I think this
is the right service and then I will I
create to create the application called
horan car boundary SP spirit resource
spirits resource let's do that so and
what we could do in the usual way we
could create here I class and call this
class whore inca on it and this class
could be just just contain I don't know
probably strength i think is T and near
strength is okay just and let's say
something else name or brand probably
there are different brands and not that
expert was holding kya just just learned
that is very important for developers so
and what I also need a default
constructor I would delete the class
later it's just introduction we only
have half an hour so we have to speed it
up xso type and let's say field so this
is nothing new this is daily builds so
can happen so like this and i would like
to import that and it should work so we
have spirits resource and i would say to
you are the whoring car
I actually don't know what a pluralist I
hope whoring cos if not you should
change that and but i was still return a
horn can get doesn't matter return new
foreign car so brand is let's say you
don't need Dracula so let's say the drag
and of course strength at least 42 so
I'm so now run it and I would like to
choose an application server don't worry
about this is like a lightweight process
which works which runs behind bo this is
the wrong one a lightweight process
which works behind the scenes so I
actually wanted exactly this was the
wrong one this one a new one so let's
see what the drugs so run I have too
many servers on so now it booted
resources and I hope whore in cars nice
so this is the whole Incas exposed of
course what we learnt mobile first and
no mobile client is interested in XML so
what we could do of course we could say
okay but what you could do because we
have a killer platform we could say
except application / Jason so
application / Jason so I forgot just the
tick here so and i get is Jason Jason
but hence we know we are using we just
working with mobile clients and they are
absolutely not interesting interested in
in in XML and furthermore the holding
car class does not provide me a lot of
functionality so it's just it's just
static java class m or aesthetically
type java class which may even cause
some trouble in future we do something
different so
what I would prefer is to go with that
just expose JSON object and the JSON
object returns is created just like this
it's not like this create object builder
add let's just go with name it was the
drow cool brand a brand is okay i think
as brand Dracula's perfect and strength
strength 42 so build so now now we only
have Jason there is no xml anymore so if
I just would rerun it you see we got
Jason but what we got now the total
flexibility and this is what we actually
do we start in the fresh project just
with Jason Jason and no one asked for
xml because most of the clients html5
you know react angular native Android or
or iOS they just expect Jason's or XML
is not that useful anymore so I'm the
next finding is if you start with with
your project what happens to you the the
UI developers wanted would like to to
implement it your UI faster then you
actually can implement the business
logic so I'm there's some nice heck so
what we do over and over again so I
create usually adjacent file I call the
test and I create here some test data
and this can be whatever like let's say
whore in car pauline car and there was
something else touring car something
like this I forgot this all let's keep
this and and this isn't as Jason so I
would just do would like to build that
and instead of doing this I would just
lead that and go with Jason right and
what you could do right now I could say
try input stream
stream equals this get class getresource
a stream and test Jason I think it
should work like this so and what we can
do inside return so some imports Jason
dot create Rida I think stream dodge
reader a perfect and so we need some so
why not is imported this IO exception so
yeah just throw the exception so looks
like this Oh perfect and I would just
run it so I run this and what should
happen is the following we should see
here whoring car what was it resources
whoring cus to still the old one so we
just are I need to rebuild that and and
run it so the point is the point is you
can very quickly deliver test data from
a local folder so instead of thinking
you know just building the objects of on
over and get over and over again we get
the adjacent object by scraping our
website or getting in front of sequel
database or whatever and we can very
quickly build the fondant so um exactly
so start failed so i actually wanted to
start the other one so run where is it
what perfect so on this one and one and
one
so it's just too fast so resources
whoring cos whoring kappa lincoln this
time from my local file so if I I don't
know another let's say whiskey is not
exactly I think your stuff but so in
this whiskey so this is actually what we
do in the first iterations so we just
you know provide a basic infrastructure
from the back end and at the same time I
tend to write some tests so just write
quickly and test this is java
application and I call it whore in car
st for st and then jacks or adapt so i
will just add some dependencies and how
it usually works is I will just check
the folder boundary is perfect and then
say okay new where's my test journey
test class this is the package and the
name was p spirits resource IT and this
is my integration tests which is
actually a system test in it client and
what happens here is my basic test
whether the service actually is working
and this always happens so in my case so
a client builder dot new client and I
get the client here and client gets
target and the target was the URI what's
the Ori and then this is the target ad
test and fetch spirits spirits this is
the next step actually why because if
you start with the JavaScript client and
and arrow happens you have to be sure
that the service is actually working and
this can be easily done with a test
client and what I would do I would like
to say request get and what we get back
is the response and this has to be 200
that response get status is to unload
and so that on test ad perfect even
works unusual for the first time Reed
entity and what I would like to have it
jason array this this is the answer or
actually spirits sorry spirits assert
that or so we could it doesn't matter
you know it doesn't matter so I would
just put just make a very quick test
assert not null or assert false this
should be enough it's not about testing
this talk so this empty should be enough
and just to show you that it actually
something comes back I will just add a
system out print line so let's see what
happens is still green and what we get
here here some content whoring couple
Inca whiskey seems to work so and this
is the second step it is more more
important than unitized integration test
because this is also the entry point if
you're building other microservices this
is actually the stop which will
communicate with the other side so let's
see whether we have any questions
questions here head young villain go ask
me let's cool the development
environment how much does it cost so it
is actually free and is very productive
so how can you should check that so it
is really nice so any other questions
just about my environment no questions
okay
then go for it so uh by the way the IDE
is called NetBeans and has also comes
with nice dhaka support so what we did
it we build a service called haweenka we
started with naive assumption that no
other mobile clients are going to expose
XML but or consume XML but I think we
are more interested in Jason so we
created and Jason mocks which are were
served from local file system and we
wrote a system test to be sure that it
actually or actually what what happens
done in real world so I just go to the
whoring kst and now I can check that
phase save integration tests from the
command line whether this is actually
working or not and this is particularly
important because the next step is to
make it run on Jenkins in a pipeline and
automated and automate the whole process
okay so nice but let's say we would like
to run it in Dhaka so how to do that or
like it is really beneficial to run it
in Dhaka so um to explain you first so
there is a project on github actually
can show you this github get up Adam be
in docklands and you will find lots of
images here and these images are also
pushed to dhaka hop and what's what's
interesting with the images here what's
interesting I didn't mention but i
usually i'm using java ee and the java
ee has a unique a unique quality and the
unique quality is and there is
deployment so what means deployment
deployment means you can you can deploy
your micro service your war to the
application servant they are separated
and this is particularly useful if you
have Dockers or what it means my dacha
environment i will switch to NetBeans
again it's organized that way that the
java image just installs the operating
system which is sent to a 7 and java
from that inherits the application
server image which in my case is pyara
whitefly Tommy
websphere liberty profile weblogic it
does not matter so this installs the
application server ones and now comes
the interesting part the actual image is
back here pyara pink is tiny what it
just does it it it adds the actual war
so what it means if you build several
times a day your your dacha image is
tiny because the payara or the
application servers are strictly
separated and they are built only once
and they sit sit only once on your hard
disk so they don't they don't have you
know to be copied over and over again
okay so let's see how it fits feels live
so doc a file so there's a nice report
for docker where is my other and docker
file so i'm actually yeah dhaka file
finish and from let's decide we would
like to use the payara application
server the only thing i have to do is to
do the following and say a copy so i get
nice code completion but copy and what I
know hence we have Java EE and maven
that the name of the war has to be hard
in cod war and the I can push it to
deployment dirt this should be enough
nice so um I have it then try to build
this so maven clean install and now we
can say dhaka built minus t minus t IM
world horror in car dot built
so um as you can see so we build the
whole image and it took at I guess one
half seconds at most darker images and
you will see at the top of the image you
have a IM world horan car and you can
see 14 seconds ago but the total size is
sixty six hundred fifty megabytes you
can sake how it's possible to build to
build you know six hundred megabytes in
14 seconds or in one second and the
truth is this is the virtual size so
this is the total size this is not
actually the size of the image so if you
go to Dhaka history I am world horror
income you will see that what we
actually built is five kilobyte pic and
the payara was one hundred forty
megabytes was build once half year ago
so it took one minute but half year ago
and it was not built over again so what
it means there's actually a new pyara
version 163 and I will create a new
image so i will build it again and then
you know until the next release I just
built my war and this is actually the
unique feature of of application service
because we have these separations if you
would build you know your fetch are you
will your jar you will be built over and
over again and regardless how big the
big attached are the slower the
deployment and the soda deployment the
less product if you are ok so i think i
hope it's self-evident this is really
nice so let's see whether they are any
questions so no question here so exactly
no questions here so the chat is also
very lazy so if you have no questions
very good so i can show you more stuff
now we would like to start the foreign
kine dhoka dhoka run minnows d indie
touch mode minus p and now let check a
port I hope this port is open this is
always a little bit problematic let's
call it horror income and the name of
the image I think was I and World horan
coming
okay this is actually a good sign
already so let's see so the service
service is started and now what we what
I would try to do is to access the
server it was part 84 84 I hope 8484
nice horan car was resources and I think
please spirits split rids not found
horan car resources spirit was it
spirits what was it whoring cos so horan
cuts and we have whoring cast from dhaka
so um and now the interesting question
is or the interesting feature what you
actually can do now you can put your
micro services to a doctor network which
is really convenient because what I do
frequently for instance and we have an
elastic search image for no sequel
database or yeah no sequel database or
postgres so what we can do then you can
start to know I a database or a no
sequel database which is not visible
from outside but all your microservices
can access the database just using the
container name and this is really
convenient we actually do it in two
projects right now exactly in this way
so um the time is almost over but the
other speaker took longer so I can we
can also i'll make a little bit longer
so then the next trick code you can do
to dhaka has health checks which are
really convenient so instead of doing
this we could just say i would like to
inherit from pyara pink so and what it
basically means i can run it again and
sorry i can build it again this is what
i would like to do so build- t I am
altering car so it was rebuilt again and
now I would like to kill her in car and
also remove my whoring car sorry read
of my whole income okay so run it and
the cool story is what we see here we
actually not see here now what we see
here is the service up for two seconds
and the health is starting so this was
not available before so i would just
rerun it as you can see the state is
healthy right now so what we got hashtag
so how this is implemented well it's
very simple so there is the payara image
the pyre a pink image here comes with a
health check functionality and this has
check functionality pinks and another
war which provides health check
information every 15 seconds and if this
fails the service the the state of the
service becomes unhealthy and let's try
that so let's try to break the
application service not that easy so doc
r minus r XX minus IT and the name was
whoring carp and what i would like to do
is be in bash so now i'm in the doc
image and domains how to deploy and as
you can see there's the whole inca
deployed and a pink deployed so i would
just lead the pink so remove pink and
this should be enough the house dhaka
inspect stalker in fact touring car
so now if we scroll a little bit up you
can see this are this are the checks and
you see failing streak once so the check
failed already once so do it again do it
again failing streak two and a third
time is we change the status so we will
just so as you can see now our service
is unhealthy so we get it out of the box
with application servers so nice is also
do not think instead of pyara I could of
course use white fly pink sorry I'm
wrong here so where was my image horan
car here this is my image set of pyara
pink I could of course rely on white lie
and then make it run on white fly so
let's do that build and i will just name
it differently whoring car WF white lie
so spill it again and run part 85 85
whoring car white flight and name has
the other be different white wine so now
with a little bit of luck we should see
it running on white fly and we have your
Wi-Fi and then are 85 85 was a thing the
port 85 85 and this is great because
this is default default behavior from
from one so any questions
no questions here no questions in the
chat let's just check the tag I am world
those are no patients here so what's
wrong with you
so if not then big big big thank you for
you enjoy the IM world and if you like
come to the airport munich and what I
used was stock java 7 with Daka I using
all my projects and we deliver contents
for react angularjs we use we still use
jsf front ends it works really nice and
it's extremely proactive so I'm thank
you for watching and see you an upcoming
conference is Java is a group or a hex
Munich so thank you and bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>