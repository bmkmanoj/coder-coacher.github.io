<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Java EE, Thin WARs And The Docker Image Size | Coder Coacher - Coaching Coders</title><meta content="Java EE, Thin WARs And The Docker Image Size - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Bien/">Adam Bien</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Java EE, Thin WARs And The Docker Image Size</b></h2><h5 class="post__date">2016-07-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hoqJdH87e7g" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello my name is Alan Bennett today I
would like to look at the size of docker
images in context of Java EE so the
question is is Java usable and how big
the docker images actually are to make
it the most possible real-world way what
I'm going to do i will use the docklands
project this is a github projects from
from github from from a repository the
quay and why real world because I use
similar structure in in most of my
microservice java ee projects so how it
looks like usually the first image is
like the debates absolute based
operating system image in this
particular case is a minimalistic Java 8
image based on CentOS 7 and then I will
we have usually like a base application
server image this is a white fly in this
particular case and this white light
image downloads the the white fly from
the internet and and and then installs
that and this is based on the Java image
and then the very last image is the sign
example image is the whitefly pink and
the white flight pink is just creates a
new war a new micro service based on the
white flag image and this is actually
what happens all the time we build such
images I don't know 50 times a day so
for each commit we have such a image and
the question is how big is such I image
and it's Java is suitable for micro
services so to answer the question what
I did I will modify the pink project
several times and and create for each
modification and image and what we also
have here I created a small script copy
to whitefly pink and this scripts
performs maven clean install so let's
execute that and then copies the war so
it's just very low-tech to the 2d
project and then in the next window I'm
here in the white light pink image this
is what I
show it right now as you can see this
pink war was was created right now and
there is a build script and this build
script creates new image so now build
this and now it's built we can build it
again you can see is fairly fast now
let's see what happened behind the
scenes darker images as you can see here
it it was built 10 seconds ago this is
Sadie shay and the the virtual disk size
is 700 megabytes which is incredible of
course because let's change this i would
say health 42 now let's rebuild the
whole thing then come back here and say
copy to white sleeping so it will use
maven to build a war and now i will
build this but instead of using that i
will just look into this bill chest as
you can see i use that so instant
overriding of this to emulate our
tagging and commit process i will create
a docker image with a new version
version to build again darker images and
what you can see three seconds ago and
another 700 mix so what it actually
means if we build it 10 times we get
seven gigs and after half a day i would
have to buy another hard disk the
question is is it really that this case
and there is an interesting command
which answers this and i will go into
the command so what i will do i would go
here and say okay dhaka history show me
what actually happens white flag pink
first so and what you can see here this
is the Desai's a minute ago two weeks
ago something happens does the old
history of all my middle images as you
can see 10 month ago I built once this
Java image 4 month ago I was used to one
image build one image for white for
I and something happens two weeks ago
and then about one minute ago I built
the our application and this is actually
just the 9k now interestingly so let's
let's do it again with diversion to and
what we can see here this is the only
change is the uppermost layer as you can
see the the DD hash number here they are
different this is this is minute ago
this is a minute ago everything else
remain the same so um also it looks a
lot here the virtual size image the
funny story is the smaller the war the
more you can build because each version
costs me having Java EE and and thin
wars around 10k if I would use bigger
Wars or fed jars each build each image
will contain the whole infrastructure
plus your application so it will be
significantly larger so application
servers are not only suitable for micro
services what's funny enough they are
probably the best possible choice
because they came they come with very
strict separation between infrastructure
and the application service images
because we have the deployment model
which is unique for application servers
if I will bundle it with in arm i would
say in a fetch our fashion and this
fetch our would includes all libraries
dependencies and the app and the image
will be of course significantly larger
so i thank you for watching see you at
ax TV you have any questions or even
infections in munich airport and in
upcoming conferences projects or or on
twitter so thank you for watching and
bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>