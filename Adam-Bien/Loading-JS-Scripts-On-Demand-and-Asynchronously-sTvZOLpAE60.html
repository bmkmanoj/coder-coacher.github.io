<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Loading JS Scripts On Demand and Asynchronously | Coder Coacher - Coaching Coders</title><meta content="Loading JS Scripts On Demand and Asynchronously - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Bien/">Adam Bien</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Loading JS Scripts On Demand and Asynchronously</b></h2><h5 class="post__date">2018-02-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/sTvZOLpAE60" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Adam bean and today I would
like to load dynamically a JavaScript
script so let's try this so what I only
have is an empty html5 file with a
referenced fgs script which is empty so
I would like to start with a class
called screwed loader and in the
constructor I would like to pass the
script name so script script or the
source of the script and then I would
like to remember this a script equals
script and I would also like to have a
script element and create that document
create element and script then I would
like to have the head element located
here and I will use a first query
selector for that and now I need to head
and then load a function load should
load the script and I would like to
return a promise return new promise with
reject and and resolve and reject these
are key conventions and then the body of
the function C so this is the promises
the implementation of the function here
and what I would like to do is to say
okay this script element equals not
equals rather than source equals this
dot script so now the script is going to
be loaded and what I would like to do is
to capture this onload event and this is
going to invoke resolve with the
parameter and then this script element
on error
will invoke the reject function and then
finally in order to make it work we will
have to add the element to the hand to
the head so this had this had
appendchild and we would like to append
the script element so now let's create a
script let's call it dynamic and let's
put it hello world or load it
dynamically so and now I can just
instantiate the class and it should work
so let's try this new script loader with
the name is dynamic dynamic yes and then
I would like to call the method the load
and in case it is loaded now I would
like to just print out the event and in
case it's there is a problem so this is
then and in case of an error I would
like also to print out the error so
let's try this log error so and as you
can see we have now loaded dynamically
which is from the script so the script
was loaded we have this print output
console hood lock which happened which
is exactly this is the event here and if
I just misspelled that you see we get
another event so we can just use the
error log instead so now it's red so we
have the problem here and of course it
could be completely dynamic so to
demonstrate you this I would just add a
button
and load and then we can just fetch the
button and create on clickhandler
so let's do this so then let's do the
following document create a query
selector button and just use that and
now we have the onclick handler button
on click and now I can do something with
it and what we can do is the following
so we just rewrite it a bit so instead
of doing that I can actually say Const
loader equals in your script loader and
then and then do this loader dot here
so now nothing happens but if I push the
button this script is loaded so loader
loader dot load and now it works we get
the error because it's misspelled
dynamic and now it works once and the
interesting part is what happens behind
the scenes is the following so if we
take a look at the elements so it
actually adds a new script tag here and
this is the indi head script here so
I've just reload the page again so if I
push the button watch this in the head
it will add a new script element which
causes the loading of the script thank
you for watching and see you in upcoming
conferences or exit Munich Airport so
thank you and bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>