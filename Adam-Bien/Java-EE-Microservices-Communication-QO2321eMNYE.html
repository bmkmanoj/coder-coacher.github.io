<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Java EE Microservices Communication | Coder Coacher - Coaching Coders</title><meta content="Java EE Microservices Communication - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Bien/">Adam Bien</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Java EE Microservices Communication</b></h2><h5 class="post__date">2016-09-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/QO2321eMNYE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello my name is Adam beam and today I
would like to show you how to make Java
EE microservices talk to each other and
to show you this I would just like to
create two ordinary simple Java EE maven
projects and I will start with a coffee
project so I call it coffee and the
coffee project is just a plain old
simple maven project and then but I
actually this template for all my
commercial project as well so I would
like to create a resource called coffee
coffee resource and this is just coffee
it's a yeah coffee path and let's call
it dark roast okay now we have the
coffee and what we also need I will just
create right away a docker file in the
root of the project and I will just go
to other doctor file and this coffee is
supposed to run on a hex Wi-Fi and I
would like to copy the file and this is
our not a maven project so I know that
it should reside in target coffee dot
war and I would like to copy this image
into deployment or so and and what's in
a hex whitefly well I created a github
project called Docklands and there is a
white fly image which is ready to use
and it in turrets from the Java image so
this is you if you run it it will
install white 510 so okay so we have
that and now I could try
to create an image so let's see how hard
it is so coffee so without any script
what I can do right now I can say create
a maven project and then if it's created
initiate an MA even built with the name
ax coffee and this is the current
current folder this is where the
dockerfile resides so I run it so at
first it builds so and this is what it
took so it created it created the the
the war and and created a not a not a
not an image because it is an error this
is too much so just again so now it
created it built in 0.7 seconds the
maven project and created the coffee war
so what's interesting this if we go here
and just look at the size the coffee war
is 3 K and therefore it is very fast so
Java EE and docker play really well
because with Java wieder the application
server has to build only once and then
we just built you know several times a
day or even several hundred times a day
it's a war and the war is a thin war
very thin war because we don't need any
additional libraries in order to make
our applications work so ok so we have
that and we have the coffee and then we
need of course the developer so we
create a developer
it's the same story the same archetype
again and call it developer and the
developer would like to drink coffee or
to it at least to talk to the coffee
service so we can say come X and I will
call it developer resource and this is
path get and now I would like in the
method in it to establish the connection
with the other microservice and to do
this I would like to use a client build
up and you see jax-rs client which
creates a new client and here say this
client then the client would like to
talk to an OD and the problem is what is
the OD so let's try it out so I go to
coffee and like to launch the coffee
so docker run - d this is background or
detach mode - P and I will expose the
porters 8080 the name of the image is
coffee and then ax
coffee now it's launched so and let's
see whether it actually works curl HTTP
localhost:8080
this is the pot exposed here 80 80 80
and then the name is coffee of the war
resources is the entry point and coffee
it's the name of the path so it works
and let's see whether we get some more
information as you can see it's the
white flight service so this is the
Orion so it just copied it over here and
now it looks right but it won't work and
the reason is there is no local house in
Dhaka so if there is of course dr. Rosen
talk about is the doctor contain itself
so we have two two independent processes
which have to talk to each other so
luckily in Dhaka what I could redo I
could just use the name and the name is
coffee I think so this is Tony Mia and
this is coffee so now it should work so
what we can do is say return developer
drinks drinks coffee
and to be correct I would say meteor
type explain okay now do the same I will
go here and say developer new arthur
dockerfile i could just create it with a
with touch there is nothing special with
the file and this time I would like to
inherit from payara image and the payara
is like you see is this GlassFish server
with commercial support available so and
it's also on github so I would like to
copy target developer dot war to
deployment there so again if I go here
there is in Docklands there's of course
also a payara image a payara image
payara payara and this is the image
which is here and it installs payara for
you so i can just reuse it so okay so we
have two pi r image and now what i could
do i just switch to developer and build
the image maven install dark i build - t
ya hex developer and the current folder
so and the image is completely built so
now there is no error so we get an image
and now let's make them communicate with
each other so it what you can do with
Daka you can create a
a network and I will call it right now
the coffee network so Daka network
create and I'd call it coffee Dhaka
Network LS and we see here ax Java one
network and what we also have the coffee
network so the coffee already runs
outside the network but what we can do
we can say we can edit so you can say
docker Network connect a hex and on ax
coffee it's another name of the network
and coffee is the name of the container
oh you have coffee with three with three
e's so then we can do it differently
darker kill coffee okay remove coffee
and now correct that and launch it
within the network so I would do the
same right now run so and now let's
correct that so it's coffee with one E
and hence we relaunch it in the network
I will remove the port mapping so what
it basically means the coffee becomes
unavailable to the outside world only
containers within the network and talk
to coffee and then there's a nice
command called not net coffee
it means launch the coffee image in the
coffee Network so hopefully it will work
and it works dr. PS it works and now
let's try Dakka Dakka our network
inspect coffee and we have the Dhaka
Network here with the name coffee and
there is one container participating in
the network called coffee so now go to
the container called developer or to the
image called or service my cursor is
called developer and now we can launch
the developer to just reuse that it's
the same doctor on coffee - d and the
name is developer and the name of the
image is also developer so this would
work the problem is this container would
be inaccessible so to correct that I
would like to expose this network with
the port 80 80 80 80 and just try it so
it works and the nice story is I expose
the port 8080 also there is another
container also running on port 8080 but
the other container didn't expose the
port so now let's see docker inspect
coffee so now we have two images
participating are within the network so
how do this - e localhost 8080 developer
developer as you can see we got a
response from payara which obviously is
a badass fish and the response is
developer drinks dark roast so what we
did we create from scratch to Java II
projects using maven create docker
images and connected them the connected
created a user-defined akka Network and
connected both images with each other so
thank you for watching if you're
interesting give more in more Java micro
services watching my online course
called Java EE micro services and see
you an upcoming conferences projects or
even your hacks in Munich so thank you
for watching and bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>