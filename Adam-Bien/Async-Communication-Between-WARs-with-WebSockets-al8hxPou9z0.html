<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Async Communication Between WARs with WebSockets | Coder Coacher - Coaching Coders</title><meta content="Async Communication Between WARs with WebSockets - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Adam-Bien/">Adam Bien</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Async Communication Between WARs with WebSockets</b></h2><h5 class="post__date">2017-02-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/al8hxPou9z0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello my name is Anna bina today like to
show you how to communicate with
WebSockets between wars so let's start
with the client part which is harder and
I would like to launch with the standard
maiden archetype and I would like to
call it thicker so it was just a
reference to the java 7 api so it's
simplistic so I have that and then let's
start with the ticker and so and package
take boundary check out so and this
should be a single because I would like
to be eagerly initialized and the method
connect should be invoked during the
face so and now we have client endpoint
config dot and dot and by the way this
new is always do drunk dot builder start
to create so don't build so unusual
syntax what it means the builder is
created with this method and then the
client endpoint config is created with
the build method methods of the building
sense so usually the usual bill that
would be with new this is unusual and we
need to contain a provider it's a method
get an order get back is the WebSocket
container so just shorten this to
container and we have that so what
happens here so we have the container
just initialized and now we can
communicate with the other side
so what usually happens I would like to
have a thicker end point put in control
just going to be ttk end point take an
end point and this will extend the end
point so and what I would like to
remember is this session this is
important and what I can do with this
session I can register a message handler
and this is also a little bit unusual
because what you would like to do is you
would like to create and of the message
handler rather than a handler which is
able to process whole messages of type
string and this message will be passed
here so what we created like a message
listener and let's just it's okay
message I will call this last message
last message and add it here
so last message last message last
message so I have it and get last
message so I have it so this is fine
I could also send messages but this
actually not required as or what will
happen or what should happen is at the
startup this would be registered and if
the session opens it it will register so
listener and we will receive hopefully
messages and of course what it could do
we can make it a little bit nicer and do
something like this and to return a
option of string so we have that
so tick has done what we need we need
the we need the weather service so and
the weather
we have come Alex where the boundary
forecast so with the forecasts and this
is going to be and let's call it nicer
not forecast forecast endpoint it's not
a resource rather than an end point and
end point and this is going to be server
endpoint with the Ori forecasts and we
have a method on open or open shorter
and the annotation is on open on open
and this is going to be this session
wrong session always happens to me
it has to beat the WebSocket session so
and now I can remember the sockets de
WebSockets so it opened and there will
be of course a method sent
weather forecasts and this is fairly
easy this session can't basic remote dot
sent text message so this is done it's
opened and this session is sent of
course if this session money call is not
and this session it's open so it's just
to be open and not not so we can send
messages and now we can do something
more evolved singleton again start up
and of course a ticker which is going to
be a schedule and they should fire every
always in the hour every minute but
every other second every other two
seconds so we have that and here I would
say this send weather forecast micro
clouds new term micro clouds system
current amelie so we have that and this
is invoked here so it looks nice so we
will initiate that at startup ok
it looks nice so what we could do and by
the way I would say we just have a
ticker here so I would like to start
that
let's see what happens is called start
of the server so it takes longer and it
has started it looks good
ok and we have here the output so
something seems to happen so now we can
proceed with our actual ticker so this
looks nice but having the container in
place we would like to say container
that connect to server and we can do
that and the path so what I would like
to do is I would like to create our
control ticket endpoint and I would like
to remember that ticket endpoints or
ticket endpoint new-new take care ok
take care of course new ticker was
ticker new ticker endpoint okay this
ticker equals that okay we have that so
done so we have two ticker and then
connect to server we use the endpoint
instance client endpoint and Ori path so
this is nice
so we can use the endpoint which is
going to be the ticker and this and the
path is going to be new new Ori and it
should be ws for WebSockets localhost
8080 deport the the name is weather
and there is no resulting nothing and
the endpoint is forecasts so it has to
be forecasts okay
looks good and of course we need to
catch some exceptions and I will just
use the multi catch keep that okay nice
huh so uh what happens now our ticket
endpoint will receive the messages and
we could even fetch the message here so
we could fetch the message for later but
it's actually not necessary so if we
start it will hopefully connect and
receive the communication
so let's done that
and let's see what happens so we have
message micro clouds and they both
communicate so this service weather
generates the messages so if we look at
that there's a forecast endpoint so
every two seconds
a message is sent using sender weather
forecast so if this session is closed
not closed
it's just sent so this is simple so the
initiator part so if you will
client so there's actually no real
client they are both peer-to-peer
communication actually but the initiator
of the it's a little bit harder to
implement because what we will have to
do is we'll have to bootstrap the
container which can be well hidden in in
in a startup startup singleton and the
container can be injected from outside
and what we have here container connect
to server so we connected thicken with
the endpoint and the URI and the ticker
endpoint resistant messages what we of
course could do with Java we could fire
event SIA and completely decoupled us
from the friendly endpoints so client to
client work communication now I have an
example for the micro services workshop
at Munich Airport I will show to the
entities as well if you like to attend
attend so see you at Eric's
micro services performance and
architecture workshops in Munich Airport
conferences upcoming talks so there are
lots of conferences going on or even
project so thank you for watching and
bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>