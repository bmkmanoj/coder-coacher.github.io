<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to connect to Microsoft SQL Server database using NodeJs | Coder Coacher - Coaching Coders</title><meta content="How to connect to Microsoft SQL Server database using NodeJs - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Tech-CBT/">Tech CBT</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to connect to Microsoft SQL Server database using NodeJs</b></h2><h5 class="post__date">2015-08-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/MLcXfRH1YzE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">in this video we are going to see on how
to connect to Microsoft sequence our
database using node.js while there are
many ways to connect to sequel server
the top two most frequently used node
packages are ms node SQL directly from
microsoft and ms SQL so let us take a
quick look at both of these two from NPM
J's point of view so let me go to NPM
J's calm and let us see the first
package that is ms node SQL so this is
one of the packages which can be used to
directly connect to Microsoft sequel
server database so let us search for
that one and first of all you can see it
is it directly it is directly from
Microsoft so which means as long as you
have this one you should not be having
any kind of problems
so let us open this and the
prerequisites are something very much
problematic in order to have all of
those particular features so for example
of course we need to have no Jazz no
matter what and there are couple more
other things which are essential in
order to have this particular package to
be running on your machine so you need
to have node jib and Python C++ and some
others so if you actually install all of
these then certainly we can say that is
going to be Windows based development so
which means this ms node SQL will be
working if and only if you deploy your
node.js application on Windows
environment so that is some kind of a
drawback whenever you would like to use
this one however if you would like to
have the fullest potential of sequel
server to be used then this is the way
to go there is one more package which is
frequently used rather than this
Microsoft one which is M
this is from a third-party developer so
you can see this is an easy-to-use ms
SQL database connector for node.js so
the moment I open it so you can see just
last day itself there are thousand
downloads and you know there have been
quite a few number of downloads every
month or every week so looks like you
know this is going to be much more
stable version in order to use sequence
our database connectivity
apart from Microsoft whatever whatever
it has published so it has got several
samples here on how to work on how to
connect the sequel server using various
ways and at the same time how to use
requests connections transactions and
everything including how to call stored
rocks all that stuff is already
available in the form of documentation
so we are not going to cover all of
those in this session however we are
just going to see on how to connect to
the sequel server and get a table of
information and there is one more
important thing this ms SQL
behind-the-scenes can use other drivers
in order to connect a sequel server
which includes tedious microsoft driver
itself and no tedious if nothing is
configured behind the scenes eg use
tedious as the main sequel server driver
in order to connect to sequence our
database but let us close this and start
working on the things before you connect
a sequel server there are a couple of
configuration things we need to ensure
that those are in place the first thing
is that the database should be always
running obviously so let us quickly
check the services that MSC
so this is the instance I am going to
connect to that is that okay let me
order by name so this is the instance I
am going to connect to in this session
so you can see sequel server and the
instance name is SQL to k14 and make
sure that this is started so you can see
this is running at the moment so you can
stop or restart or whatever you would
like to do and at the same time this
should also be on sequel server browser
should be running its equals our 2k14
should be running and it is better to
have sequel server agent to be running
as well so after making sure that all of
these three are running we'll we should
also ensure the adder the tcp/ip
settings are in place so you can go to
sequel server 2014 configuration manager
and once you open this make sure that in
the protocols for the instance you are
using you need to ensure that tcp/ip is
always enabled and of course all of
these services are running here so in
this case we do not use integration
services but it is better to have this
service to be always running apart from
that these two are must so on top of
that we should always have what I say
the client protocols and everything else
to be always running so in this case the
server the client may not be necessary
until and unless you go for Microsoft
sequel supporting but the protocols for
the server itself should have DCPI be
enabled if for some reason this is
disabled and if you make it enabled you
have to restart your services so if you
change from disabled to enabled it will
not be taking players immediately so
those settings will be taking place if
and only if again you restart all of
your sequel server services here so make
sure that you just right click here and
restart and right click here and restart
if you happen to modify tcp/ip from
disabled to enabled status so that is
pretty much whatever you might be really
worrying about when it connecting to
sequel server ensure that tcp/ip is
enabled and ensure that the services are
always on so in this case in order to
makes things simple I am actually
working with sample DB so I just created
a new database in this SQL 2k1 for
instance this is a very simple database
which will have only two tables and out
of that the EMP table essentially will
have four columns and six rows so this
is the table we are trying to retrieve
using node.js application itself
now that everything is available in
place so let us start with Visual Studio
and start creating a new application
from the scratch so a new project make
sure that a Java Script nodejs
and blank node.js console application so
in this case I would like to say a
sample sequel connection application
whatever you would like to call it as so
I just press ok ok so we have this
console dot log so we don't need this
stuff so the first thing as I mentioned
I would like to use ms SQL package
instead of using ms node SQL so
right-click your NPM and say install new
packages and in this ms SQL is the one I
would like to use so you can see I
select this install package make sure
that it is packaged it is adding to
package store Jason I install it ok that
one got installed click close and you
should be able to see ms sqm right there
so now that we have everything in place
now the first thing is that we need to
have that particular module of the
package to be imported so using ms SQL
so I require it and this particular
package whatever you are imported is
going to be made available as part of
SQL now and in order to connect to
sequel server we need to have certain
kind of connection related parameters to
be defined for example to which server
you would like to connect to which
database you would like to connect using
what username password code number and
all of that stuff so I would like to
have all of those in an Java Script
object so I would like to call the Java
Script object as DB config and as part
of that DB config I would like to say
the first thing is that server to which
server I would like to connect to so in
this case I would like to say localhost
SQL 2k14 so you can also provide any
kind of IP address here like 127 dot 0
dot 0 dot 1 which is nothing but the
local system but if your sequel server
is installed somewhere else you can
provide the IP address of that
particular server and this is the
instance name so I gave double slash
here as because that is the escaping for
the single slash so in order to escape
the single slash I need to provide two
slashes so after providing the server we
need to provide the database to which
you would like to connect to in this
case the database name is sample DB so I
go in here and I am going to say a
sample DB so once I have these two I
need to provide a username under which I
would like to connect though so in this
case as it is my local machine yes he is
my username and the password in this
case is SQL 2 0 1 4 and on top of that
the port number also you can provide say
1 4 3 3 which is nothing but the default
port number I may have so this is pretty
much similar to connection string which
will be usually made available as part
of asp.net or any other application in
general but usually even from node.js
perspective these are supposed to be
read from some config or settings or
something which we are going to cover in
next session but for now let us hard
code all of those details and our goal
is to get connected to sequel server as
soon as possible and now I would like to
have a function called get EMP so this
is the function I would like to execute
and this function responsibility is to
connect to the sequel server execute a
select statement get all the results and
display on the console at the server
itself I am NOT consuming this nodejs
application at the moment this is the
application right now connects to sequel
server which is the information and
shows everything directly on to the
console itself so in order to execute
this all I am going to say is
get the MP at the end so now we need to
have our sequence our connection to be
made so the first thing is that we need
to have the connection object to be
created and as you know all our mssql
related package related instance is made
available as part of sequin and I am
going to use the same and there exists a
class called connection and it will be
accepting a particular configuration and
in this case our configuration is made
available as part of DB config so I can
make use of that one and at the same
time if you would like to have any kind
of call back after connection has been
made or if you are having any errors or
something of that sort then you know we
can also provide the callback here so
for now I do not want to provide
anything so the connection object is
running in so once the connection object
is ready I need to have the request
object again as I mentioned this is just
creating an instance of a connection
button PR not connected to the sequel
server yet so you are you have not
connected yet in order to connect you
need to use connect method which we are
going to use in a bit but for now this
particular statement whatever you are
going to see here is not really
connecting to this equals our database
it is just creating an instance in order
to connect later on so for now it is not
connecting now similar to connection
object I would like to have a request
object to be created so which will also
be available as part of SQL and using
the same connection so the quest
object-- takes the connection object
into the account and it will try to
request based on whatever the options we
will be providing now once we have
connection instance and requested
instance created now I can say
connection dot Connect so now you can
see I have that particular method which
essentially tries to connect to the
database right now
so in this case if I have any kind of
error it is going to be made available
as part of error object if not whatever
the statements available here are going
to be executed not if not but this
function is going to be executed
regardless so which means whether the
connection has been failed or the
connection is successful so regardless
it is going to be executing this
particular function so I can just say if
error then I can just simply say
something like console dot log error and
I can say return so if I have if I come
across any kind of connection related
errors you know it is just going to
check if the error object is already in
place if so just display that error and
return without really requesting
anything else but if it is not error
which means how successfully connected
to the sequel server then I am going to
use my request object in order to
execute a sequel statement so the
simplest way is requested quality and as
part of the query the first thing is
that I need to provide a select
statement so in this case I am going to
use select start from EMP so as you can
see right from here I have select and
all the columns from the EMP table so
that is the EMP table so I am going to
use the same thing here and now this is
going to give us a call back as you can
see and this callback will have two
parameters error and record set so as
far as this one if you are having any
problems with this statement or for some
reason sequencer is unable to execute
this statement you are going to have a
error object made available to you so if
there is no error and if this select
statement is successful it is going to
return all the rows into this particular
variable so it could be called as data
or record set or whatever you would like
to call
but for now I just wanted to call to
Ezra courtside
so again if there is any problem all I
would like to say is that display that
error to the console and else I need to
actually display the result back to the
console itself so I would like to say
console dot log and display everything
whatever I get through record set so
once I have what I would like to say
connection goes so this is pretty
important so you open the connection the
moment you say connect and you need to
close the connection whenever you are
done with your request so in this case
if you have an error it is going to
display the error and at the same time
you are still closing the connection if
there is no error you are still getting
the record set and at the same time you
are closing the connection so this is
pretty important so if you don't close
the connection every time you open the
connection and it will always be open
until and unless someone closes it and
you will be running out of now you're
running out of the concurrent
connections so this is pretty important
you need to close it once you are done
with your particular request so this is
just the function and at the same plane
the same function is going to be
executed as part of this one so I just
save everything and hopefully this gets
connected to our server and gives us the
result and there we go so we have all
the information right in place so we
have one two three four five six rows
and those are nothing but the six rows
available right here so if I would like
to modify any of those roles for example
I go in here and the first one I make
des 10,000 and I close this node
application and I execute it
and you can say I got 10,000 right here
okay so let me get back to my thing and
make sure that it is switched back to my
previous value switch which three for
three thousand four hundred okay
so now let us check if errors are
anything are working fine so let us let
me give you a MP two to two which is not
available so let me try this is what you
find so I execute it and you can see
there was an error and it says invalid
object name EMP two two two and it gives
all the necessary information there and
that is how I can have the error to be
defined and shown right in front of the
console itself and as I mentioned
whether or not you receive the error or
the data you are always closing the
connection but imagine the connection
itself is unable to connect so for
example I provide something like ei so
this instance is not available so just
let us try to connect with that instance
and there you can see port for this one
is not found on that particular server
so we got all that message - so this is
pretty much on how you can connect to
sequel server but at the same time you
can also do the same whatever you did
here in a promise oriental manner so
which means when connection is
successful then to something when quarry
is done then do something if there is a
problem use a catch so instead of using
this method I can also have another way
to accomplish the same so let us use
another way so I am going to say please
connect first and if connection is
successful or unsuccessful then sorry
then is always successful so you can see
it returns a promise object then I can
say something like this
so which means if connection is
successful then execute this particular
function if it is not successful then I
can use catch which essentially gives me
the error so in this case I can have an
error in this fashion so I can handle
the error right here so let us do this
in separate lines so that we can easily
understand and how the things are
working okay now you can see I have
connection that connector so if the
connection is successful then this then
part will be executed which means this
callback function gets executed if the
connection is successful this callback
gets executed if the connection is
unsuccessful so if it is unsuccessful
all I would like to use is consulted log
and just throw the error back to the
user so if the connection is successful
then I would like to have the request to
be utilized so I would like to have my
request object which was created earlier
I just wanted to create it right there
and then I would like to use request dot
quarry and I can say select star from
EMP and even this can also be used with
the promise object like I can say then
so which means if it has been
successfully executing that particular
query then executes my particular
function if not then again I can have a
catch which gives an error object right
there so I can use a boat so let me
again
make this in it available fashion so now
what I'm saying is that if this query
select start from EMP successful then
execute this function if this is not
successful then execute this function
again as part of the error all I would
like to say is that just throw this one
out and once everything is done in this
case I as I caught the result I need to
have that particular connection that
resulted to be shown to the user so in
either case once that particular query
has been successfully executed and shown
to the user and in the data we still
need to close the connection so that
needs to be done right here and also
right here make sure that you cannot use
it here as because this is asynchronous
so this whole execution is asynchronous
which means it might take two seconds in
order to get it executed so while it may
take two minutes or two seconds to
execute this will not wait it will be
going simply equal to the next statement
which essentially tries to close the
connection so you cannot do that
so now that we have another way let us
test if this is working fine okay record
set is not defined as because it throws
the record set right here
okay so let me check it and now we have
all the rows right there so imagine now
I am providing something and just press
that and you can see it is giving EMP a
is not available and similarly if I
provide something like a year here for
the username for which it will not be
able to connect to the database and now
you can see connection error and it says
login failed for that particular
username I provided so we have
everything in place so you can use in
either of these two approaches so you
can use the promise visitor programming
methodology or you can directly use the
existing asynchronous way of how it is
providing so you can be just using the
callback methods only without really
depending on the promise object but if
you are working the promise object then
you have the flexibility like then and
catch sorry then and catch and send let
then and catch so this is pretty much on
how you can connect to sequel server
using mssql package as part of node.js
in my next video we are going to see on
how to have rest based operations using
node.js that is pure node.js and all
those rest operations will be working
again a sequence our database itself</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>