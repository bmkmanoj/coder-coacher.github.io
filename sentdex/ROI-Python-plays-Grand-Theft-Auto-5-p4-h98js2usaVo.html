<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>ROI - Python plays Grand Theft Auto 5 p.4 | Coder Coacher - Coaching Coders</title><meta content="ROI - Python plays Grand Theft Auto 5 p.4 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>ROI - Python plays Grand Theft Auto 5 p.4</b></h2><h5 class="post__date">2017-04-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/h98js2usaVo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everybody and welcome to yet
another Python plays Grand Theft Auto
video in this video we're going to
continue working on getting Python to
kind of recognize its environment and
see where it's going and all that we are
now beginning to enter the uncharted
previously by me waters and it's going
to get hairy so let's go ahead and start
so what we have here is a script that
doesn't fit all the way on this screen
that's okay basically we've got the
simple processing of the image it's just
gathering edges we do have this count
down I'm actually going to get rid of
the count down we really only need that
for if we're putting input in and I'll
just remove the input for now just
that'll be way down the line when we
actually have some sort of AI that can
do something for us so my goal with
where we're going right now is to either
create an AI that can drive already
based on some simple rules that we set
with open CV that can hopefully at least
drive on it you know just straight it'll
basically know turning and stuff like
that node going through intersections
just kind of drive along a road like
this and hopefully navigate the turn-up
ahead okay that's just like the starting
goal and then from there we can either
continue adding rules or what would be
even more ideal in my mind is that we
can use open CV to at least detect when
when the vehicle is probably where it
should be and then also have a degree of
confidence so as we kind of go through
what we're doing what we're going to
eventually do is try to detect lines
which will be the lanes now the more
lines kind of that we detect and the
longer those lines are the more
confidence we can have that they are
lanes the other thing we're going to do
is change the region of interest that
we're even looking for lines that way
like we don't get this light pole here
and it's not a light poles electric pole
or the electric lines for that matter so
we're going to also add that in so
eventually we can probably come up with
a high degree of confidence
many times when we are within lanes and
then we can take that data save that
data and use that to Train even just a
simple neural network or even some sort
of reinforcement learning network where
if you're in between the lanes that's
good you know something like that so
let's go ahead and get started so the
first thing we're going to do is we're
going to deal with region of interest
and we open this all up drag this over
what's come on man so I drew this
beautiful picture and this is just to
kind of depict the region of interest
concept please go away
hoping for that thing down there to go
went away for a moment okay so this is
just kind of like okay yeah we got it we
start at zero zero which is actually at
the top left of the screen and it goes
down 600 600 tall and then 800 wide so
zero zero is actually at the top left so
it can get kind of confusing but our
goal is to do a region of interest that
is this like red box and to do that
we'll start as you're like our vertices
are down here at the bottom I'm doing
the typical I point at the screen even
though you can't see that I'm pointing
on the screen anyway so so you've got
the vertices at the bottom that's 0 600
0 400 200 200 600 200 and 400 800 600 I
can be kind of hard to visualize so I
drew this picture for you just so you
can get a better idea it's obviously not
too great scale but hopefully that gives
you an idea of the region of interest
that way because basically obviously
you're not going to care about any lines
above the horizon we don't care about
lines in the sky I hope so if we're
driving so really we're just we're just
curious about almost a triangle but it's
not really going to be a triangle per se
I think this is probably the best ish
region of interest it's not going to
capture everything but hopefully it'll
be a pretty good start and it'll
definitely cut out a lot of stuff that
we don't want so um so that's just a
really quick example of a region of
interest now let's go ahead and create a
function for region of interest so let
me make sure it's on screen that keeps
again I need to show the the grand theft
auto stuff long
coding and it's not necessary so the
region to find ROI and ROI for this
basically what we do is we're going to
pass into image that we want to apply it
to and then vertices whatever the
vertices and then they do an ROI
basically you start with a mass but
it'll just be totally empty so just will
just you NP 0 so just a huge array empty
zeros like and then we passed the image
so it'll be just zeros of the shape
basically of whatever our image that we
pass is so then what we're going to say
is we're going to say CB to fill poly
capital P we're going to fill that mask
by the vertices and we're going to fill
those in at a full value of 255 then
what we're going to do is we're going to
say mask is equal to cv q dot bitwise
rather bitwise and the image and mask so
link mask fill the mask and then now
only the mask part are basically only
the region of interest is left and then
we return masked I did link to them
before flight I'll pull them up one more
time the opencv tutorials on Python
program and that will probably help you
if the whole masking thing is it can get
kind of confusing where is it but there
we go
OpenCV you can go to PI number Internet
and just search OpenCV and find the
series although it's not on the screen
but after you do a search you can scroll
down and it shows you like whole
playlist you can click on that and come
down here and so you can kind of figure
out how to do so because you can do a
lot of really cool stuff with OpenCV
masking is kind of one of those things
and then kind of overlaying things and
stuff like that anyway so that's our
region of interest and now what we're
going to go ahead and do is we can
her mast so then what we can do is we
can say basically the the the processed
image could be the ROI so for example we
can say processed image image equals ROI
against processed image and then the
vertices so let's go ahead and define
our vertices so I defined them well I
had them on that image but I actually
found some better one so I'm going to
use the other one
I tweaked it a few times and this is
going to depend on what game you're
playing or what vehicle you're even in
and stuff but I found these are pretty
good for the little scooter that we're
on so knees right I'm out with me NP
array
do ten five hundred ten three hundred
three hundred to three hundred two
hundred five hundred two hundred eight
hundred three hundred making sure it
doesn't go over my face or my face
doesn't go over it roughly and then
finally eight hundred five hundred now
one thing to note is this just kind of
creates that part of the image but one
thing you could do is let me edit this
in paint taking forever okay
i right-click five hours ago man let's
go okay so this is our region of
interest that we just did we tweaked a
few things but still the same shape one
interesting thing you could think about
doing is rather than just simply
connecting these through just from here
to here one thing you could do actually
is kind of do something like this maybe
or even deeper like getting into there
and cutting out all this because chances
are this stuff is not important either
or at least a lot of it in there or even
possibly just cutting out like this here
because we have a little bit of the bite
like the mirrors and stuff right all
this stuff is kind of in the way and so
like it's going to detect this line and
stuff like that and so you might want to
consider doing that um I'm not going to
worry about it I don't think it'll be
too big of an issue but depending again
on what your view looks like you might
want to consider cutting out even more
okay so that's our region of interest
let's go ahead and run this and see how
badly we typo'd actually we need a pass
here pass the actual vertices okay now
we'll see how badly we tangoed move this
out of the way run it yeah of course I
know I understand that okay only two oh
did we not okay we need to so the in the
numpy array conversion I just like kind
of passed a list almost what we need to
do is please show up on screen perfect
we need to encase this actually
officially let's do brackets rather than
okay cool take two son
CV to fill Polly's I have no idea what
the hell this error is saying and why is
it on D okay okay let's see where are we
cv to fill Polly mask vertices in PI R a
this all appears to be kosher to me I'm
not immediately seeing what our problem
is and this error is absolutely useless
it's on Phil Pali check vector looking
back at our list here okay 600 days
later vertices here needs to be encased
in brackets that is the worst error I've
ever seen for that to be the that was
the mistake and that's the error I got
let's see this changes it now so no
that's crazy
that's like the worst error message I've
ever seen dang it I can't get out of
this okay
we have our region and all that
oh also you all might not have this
problem but for some reason when I run
this the actual output window right this
window is not the same size even though
it should it should be right the same as
this this GTA window or it's supposed to
be but it's not right so what I found
to fix that strangely enough is not to
use it but if I import PI auto good we
the window stays the same size so in the
subsequent videos I'm going to import PI
out of GUI because it's more convenient
it's better for the video as I record
and stuff that it's the same size anyway
okay so we've got the region of interest
here um that took a little bit longer
than I was hoping to but hopefully you
guys have it all
now someone needs to send the opencv
people a strongly worded email about the
error maybe maybe we'll make a pull
request on the github and improve the
error here because that was that's
brutal
okay so anyway I think I'm going to cut
it here and in the next tutorial now
that we have this region of interest we
are going to use the hue lines function
with or the hue lines algorithm with
OpenCV and attempt to find all of the
lines in an image and then from there we
can use a little bit of logic to almost
certainly figure out which lines are the
main lines of the image especially now
that we got rid of the telephone pole
thing or not the telephone pole thank I
said that last time but the electric
line or maybe there's a telephone pole I
don't really know anyway yeah so in the
next one we're going to use the hue
lines algorithm and we'll see how that
goes and hopefully eventually get
something that detects the lanes and
hopefully we won't hit anymore
absolutely disgusting errors so I will
see you all in the next video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>