<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Python for Spreadsheets and CSV File manipulation - Part 2 Row Manipulation | Coder Coacher - Coaching Coders</title><meta content="Python for Spreadsheets and CSV File manipulation - Part 2 Row Manipulation - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Python for Spreadsheets and CSV File manipulation - Part 2 Row Manipulation</b></h2><h5 class="post__date">2013-10-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/PxtPxx1TJ2U" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome to the second part of
CSV manipulation within Python where we
left off I was just showing you guys the
basically syntax of reading in a CSV
file with num pies and load text how to
display it now let's actually talk about
how to modify the data and so we're
going to add a column and we're going to
have that column based on another column
or another sorry another bit of data in
that same row in another column rather
so let's do that and then also we'll be
able to finish up with how to save it
and then probably in another video we'll
talk about deletion of com our columns
rather and then maybe like some
multiplication or something or some
other rows something else to throw in
there just for some more examples so
with that I'm gonna go ahead and delete
this line here and to show you guys an
example of how we might go about saving
the line so actually we can leave it
here you would print out and this
actually is already in a string so you
would just do this Plus that and so when
we run this we'll be able to see that
when we call me it splits it out with a
comma and it looks good so if we were to
save this to a file it would be good so
we're going to get into that now I'm
close this and I'm going to delete this
line now so to run through the entire
text file basically what we're going to
go ahead and do is use a counter and a
for loop you could also use a while loop
most people use a while loop with a
counter but I'm going to switch it up
for you guys number say X equals 0 and
then we're going to say for each day in
date so with a for loop this is just
defining variable basically what we want
to do well we're going to make a save
line and save line is going to be equal
to each day plus a a comma plus the rate
with the X so x is going to start at 0
because the first element in
is giving the index of zero plus another
comma plus ARB X plus more commas and
then let's go ahead and if you remember
how we did like the addition of
something we could go so if we want to
say we want to do ARB X and then we just
want to do simple plus three to that
thing right well this is first of all a
string so we need to convert our X to an
int to do that mathematical equation but
then we have to convert it back to a
string so we can include it in this save
string so convert this again all the way
around after three convert that to a
string now at the end of this line we're
going to do a plus and then a backslash
N and close the quotes make sure it's a
backslash n not a forward end so oh the
slash that's over your Enter key and let
me just scroll over a little bit okay so
that's our save line now we're going to
specify save file save file is going to
be equal to open and then we're just
going to make a name this file doesn't
exist it will be created though dot CSV
and the program itself will create it
and we're going to open this with the
intention for a which means a pen next
we're going to do save file dot write
and what do we want to write what we
want write that save line luckily that
save line has a new line at the end
that's what backslash n does so I don't
have to worry about it making new lines
it will do that automatically but keep
in mind at the end of the file you have
an empty line so just keep that in mind
so when you run through that data keep
in mind if you're throwing an error for
some reason this product as you have
that empty one continuing right along
what we're going to do is save file dot
close and then we're going to X plus
equals one don't forget that part and
that will add one to X so as we run
through everything so let's save that
and let's run that and I have to call
main and it's done it should be pretty
instantaneous we don't have that many
lot so new CSV let's edit it with
notepad plus plus sure enough
here's the original and now we've added
this other column which is basically
column three plus six and you can see it
goes all the way down and it's
conditional much like it would be within
a spreadsheet only we can apply it much
much quicker with programming so what if
we wanted to take that a little bit
further and oh just just for the record
we do have an empty line here now there
might be better ways to do this but the
way that you can do like fix this
problem so say you want to continue
editing the spreadsheet if you want to
go edit this and load this within numpy
it would error because of this row here
so let's say that you don't like that
now if you're really picky and you want
that line gone I'm going to go ahead and
delete my new CSV dot CSV file if you're
really picking you want that gone what
we can do is you can say for each date
in date and then just make it an array
that spans to the negative first element
in date so this will ignore the last
line in date yet run through the entire
for loop subsequently what we can do is
after the for loop we can then say we
can basically like let's just copy and
paste all of this so we'll come down
here and paste and this stuff is uh not
aligned perfectly so I'll do that and
now what we do is it replace each day
with a date and then negative 1x will
still apply because it will add 1 to X
everything else applies except we'll get
rid of the new line at the end of this
file so we'll do that now if you save
this and we'll run it and we run main we
now have new CSV edit that with your
notepad and you scroll down and there is
no blank line there so if you're like
one of those people that doesn't want
the blank line or if you're going to
late
like manipulate the file and stuff or
you just want to be a nice little person
when sharing your files or something you
can do this and adds a little bit of a
few extra lines to the code but it's a
way of getting rid of the last line
there's a few other ways to get rid of
the last line but you're pretty much
using this many lines of code anyways to
do it so you might as well just include
it in your main loop so with that I'm
going to conclude this video as always
thanks for watching thanks for your your
subscriptions and until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>