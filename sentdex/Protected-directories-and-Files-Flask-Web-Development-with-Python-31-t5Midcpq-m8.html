<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Protected directories and Files - Flask Web Development with Python 31 | Coder Coacher - Coaching Coders</title><meta content="Protected directories and Files - Flask Web Development with Python 31 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Protected directories and Files - Flask Web Development with Python 31</b></h2><h5 class="post__date">2015-12-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/t5Midcpq-m8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to
another flask web development tutorial
in this video what we're going to be
talking about is how as a developer we
can create a directory where the
contents that directory are protected in
some form so as it stands right now you
could have like a page right that's for
example what we covered long ago was a
login required decorator a page that
requires the user to log in but so far
we haven't really discussed how you
could possibly create a file that
required a user to log in or required a
user to be say in the case of Python
programming net a plus equals one
subscriber to download okay so that's
what we're gonna be talking about today
because if you just put files in the
static directory that directory is
completely public so when someone goes
there goes to your website they can go
to your website slash static and they
have access to all of those files
there's really nothing you can do about
that
so what we're going to be talking about
is what you can do how you can make your
own little hidden directory so with that
let's go ahead and get started the first
thing we're going to do is we're gonna
open up the unit dot pine and at the
very top here where we're importing a
bunch of stuff from flask we're gonna
import one more thing and that is send
underscore from underscore directory and
let me make my text a bit bigger for
everyone okay
so sent from directory directory and now
what we want to do is just find us a
nice spot to begin I'm just gonna look
for that juju man yeah and here's where
we're gonna start writing some new code
so first of all we need a protected URL
path so what we're going to do is let's
just we'll write this afresh so app dot
root and the root for this will be
protected and then what we're gonna have
is a path here so path and then :
filenames so this should look pretty
familiar these are is a URL converter so
what this means is we're gonna require
the first part of the path is protected
after that we're just collecting
whatever the path is and then we're
going to perform some kind of ninja
stuff here and you'll see what I mean in
a minute so then after that we this is a
protected right so we need to have some
sort of special requirement for this
path so what we're gonna use is a
wrapper and we'll go special underscore
requirement so right now obviously that
doesn't exist but we'll we'll create
that and we'll don't have a special
requirement soon enough now we'll define
protected and protected we'll have the
path right this path filename has to be
passed through and we're ready to
rhumble first let's go ahead and have a
try and except just in case we screw up
accept exception is e and then we'll
return just okay actually since this is
protected stuff let's just return a
redirect and the URL for main so that
would be the URL for the home page
basically now what we're going to do if
basically if special requirement is true
what we're gonna try to do is return a
send from directory and then we're going
to apply some wizardry here so the what
we're gonna call is we're gonna say oh I
believe we have OS imported let me go to
the top yes so we do have oh s imported
if you don't you'll need it
let's go back to work we're gonna say Oh
s dot path join and then we want to join
the app dot instance underscore path and
then empty quotes here comma filename
okay so let's make sure that closes off
correctly right so what's gonna happen
is it's going to take the filename
and it's going to basically the app up
here or a talent we told where where is
it did we do it
no we didn't do it okay okay we'll get
there
so what's gonna want what's gonna do is
reference non lost man it's gonna act
reference this instance path which we
have to add and from that instance path
it will go to the file name and so it'll
be like instance path plus the file name
and it will return whatever exists there
but we need the instance path so let's
go up to the very top here and where
you've defined app equals flask name we
need to add this instance path so just
do a comma and then instance underscore
path and that's gonna be evil to the
path to this protected directory which
doesn't exist so let's go ahead and make
one so new directory and I'm gonna call
this protected okay so the path to
protected is pretty simple we can come
in here and just click this but it's the
full path so VAR w w then your app name
app name and then protect so I'm just
gonna copy and paste that in there so
that is the instance path and then after
the instance path comes the other stuff
so let's go protected and so wooden hat
you don't have to call it protected you
can call this you could really call this
something else entirely
we've just happening to call this
protected but you can call this secret
okay and everything would work flying
because that's not a we're not using
this path at all we're using the this
path plus the instance path so just keep
that in mind that this doesn't have to
have the same name as that directory but
I'm gonna call it protected well we'll
call it secret just to show you that it
works so return yes so that's everything
we need to do basically up to there now
we need something to be secret so I've
got this super secret Python image let's
see let's bring that up you might not be
able to see it very well but it's it's
top secret okay
so I'll take that image and we'll throw
it up into here and now we're ready to
try and visit this now special
requirement let's see we're going to
need to create a special requirement
first before we can visit it because
that doesn't exist so now what we'll do
is we'll create that special requirement
wrapper so this is just like a login
required I don't know if we actually
wrote our own login required we did so
this basically is a lot how it works but
we'll just right around just because
we're like that but you could just use
the login required but this is the login
required kind of that's not the same as
what kind of what we're doing but anyway
so we're going to define special
underscore requirement and what we
passed there here is an F for a function
so wrappers do exist outside of flask
they do the same thing they just wrap
around another function so f there is
just for the function and basically what
we say here is at wraps F and then we
just go ahead and define the wrap which
takes args and wharves
so that's arguments and keyword
arguments and then what we're going to
say is try and then we're gonna have an
accept and if the exception is triggered
we return a redirect URL for and we'll
probably I think we'll just return the
dashboard every time and and then mmm
after that we return wrap and then now
let's actually build in this try so what
we're gonna say is where this one's
going to require the user to be Harrison
feel free to put your own name in here
if you don't have one and you're going
off of our files you can just sign up
really quick to the website and use
whatever username you sign up as so if
Harrison equals session username again
you this this if statement can be
anything you want right that's this is
the crux of this wrapper this is the
special requirement
right so if that's the case we return F
along with the args and kwargs I'm just
gonna copy and paste args and kwargs
from up here we return the function no
problem
otherwise what do we want to do we're
just gonna return redirect for dashboard
so anybody who tries to come here and
does not meet this requirement is going
to be sent to dashboard okay so there's
our wrapper that's basically everything
we need so we're ready to rumble now I
believe so let's save this and then
we're going to need to reload and we'll
come over to our website let's make sure
everything works hi sneaking suspicion
we were going to get that let's uh let's
go ahead and python unit dot pi got
invalid so we have a comma between args
and kwargs what hey mature alright we'll
try again let's just run it since we had
it okay so we should be all set let's
reload again bring back over fresh and I
think we called it secret I think I
changed that yes so we're calling it
secret so it would be secret and then it
was Python jpg and let's see it my
logged in I am not logged in right now
whoops I think I think I might've taken
this but I'm not sure let's try one more
time
secret Python jpg that is where I think
it's supposed to send me if I'm fallible
okay so at least that one it sent me
back to a dashboard we could flash
something like you're not allowed to see
this or something like that but let's go
ahead and login now we're logging in as
Harrison so that's fine we login and now
let's go to secret and then again python
jpg and sure enough there it is you
might get a reader well you won't get a
redirect I don't think if you did it in
the order I did it but what if like
right now you could do this you could go
back to your homepage logout and then
you might be able to get away with going
to secret python jpg right so this isn't
a flaw it's just that's called cache and
so what you want to do is shift f5 if
you're in
Chrome or something like that little
hard refresh and there you go that was
just your cache loading that URL for you
but you really cannot view that okay so
anyway that's pretty cool that's just a
way for you to kind of protect any any
files you want and because of the way
that we've done it this is a path that
can be any path and then we pull it
apart and and just get that file name
for you basically so you know you could
hide something and even further like I
got no super secret and we could put
that file in there again and I don't we
shouldn't have to refresh anything but
let's log in and we should that that
will be hidden that secret super secret
Python jpg and there it is again so that
allows you to kind of organize
everything exactly how you want and
again like I was telling you guys before
with the URL converters this is a
perfect example of how it can make one
function extremely powerful so anyways
that's it for this tutorial
if you have questions comments concerns
whatever feel free to leave them below
in the next tutorial we're going to be
talking about flask and jQuery that's
going to be a pretty interesting one
basically the whole idea behind that is
to make your your website a lot more
interactive so what jQuery is going to
let you do is an ajax basically both of
those but what's gonna let you do is
allow the user to kind of interact with
that webpage and let that webpage run
background operations and rila or not
reload i'm trying to update the page
basically in real time basically it
allows the user to not have to have the
page we're actually like refresh and
start them back at the top and scroll
down and stuff like that so it's a
really powerful if you if you use it it
can be really nice it makes the I guess
user interaction a lot more enjoyable so
anyways that's what we're recovering in
the next tutorial so stay tuned for that
otherwise thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>