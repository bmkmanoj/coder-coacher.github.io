<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Scikit Learn Machine Learning SVM Tutorial with Python p. 2 -  Example | Coder Coacher - Coaching Coders</title><meta content="Scikit Learn Machine Learning SVM Tutorial with Python p. 2 -  Example - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Scikit Learn Machine Learning SVM Tutorial with Python p. 2 -  Example</b></h2><h5 class="post__date">2014-12-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/KTeVOb8gaD4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on ready welcome to another
Python programming tutorial with machine
learning using scikit-learn in this
video we're going to be doing is
covering a real quick example of how
simple machine learning actually is and
just to illustrate that the bulk of your
task is actually not the machine
learning it is the acquisition and
structuring an organization of data but
that's not fun so the first thing we're
going to do is show an example so so
we're going to go ahead and remove these
imports because we're going to do it
slightly differently but for now the
first thing we're going to do is we need
to import matplotlib spy plot if you're
not familiar with matplotlib I have a
very actually couple very extensive
matplotlib tutorial videos so search on
my channel and you can find those they
should be on there just like the main
page even so anyway import matplotlib PI
plot as p LT for shorts the next thing
we're going to do is we're going to use
the defaults a scikit-learn data set so
scikit-learn comes with sample data sets
that we can actually just use so we're
going to go ahead and do from SK learn
import data sets and this has um you
know the iris data sets it's got numbers
and I think it has those Oregon if
you've ever like done any searching of
machine learning tutorials like the
example that people always use as I want
to say it's Oregon like Oregon house
prices like they did housing prices and
so the idea is you can use machine
learning to come up with a perfect
algorithm to pricing any house based on
you know various variables so I'm pretty
sure that ones in there too but for the
most part I've seen that people complain
about using these data sets and I think
the complaint is that even after you
learn how to use scikit-learn you have
no idea how to go out into the real
world and do machine learning because
you have to get the data somehow and
nobody provides you data
the format that you you really kind of
need it in so anyway especially if
you're going to label it as like what
we're going to be doing stocks and you
need to label that stock as buy buy buy
buy buy all the way up to where it's no
longer buying it to sell and sell so we
need to be able to label our data no
one's doing that for us so anyway from
scikit-learn
import data sets and then from SK learn
import SVM which is short for support
vector machine support vector machine is
a form of machine learning and basically
I can even show you guys what SVM is
going to do where is my trusty paint
there it is so SVM real simple you're
going to have SVM it's let's say you've
only got you know um one uh I mean I
always forget this word I don't know one
one variable let's say there's a special
word for it I'm blanking on the word
anyway so you got your axis here axis
here and you'll end up having a graph
and it's gonna have a bunch of plots on
it like this oops see just make it big
boom and boom boom boom boom boom boom
boom boom and you'll probably with SVM
generally you'll probably end up having
like labeled plots so it'd be like this
Wow you won't have a pot like that
anyway so SVM is going to come through
and it's gonna be like alright check it
you've got a group here well s fams
gonna do a better job that I'm doing
he's gonna be like you got a group there
and then uh they'll even come through a
little chunk align like they like the
loose do this SVM is gonna come through
and be like there's groups for you
because you labeled the groups so that's
what SVM does for you unsupervised
learning is basically like this just for
anyone who's curious remember we had all
these orange dots sent over here I think
we had green you know you just would
feed the data to the algorithm like this
and then the algorithm is expected to
just kind of figure out you know how to
divide these groups up
it doesn't really know anything about
the groups it's just going to kind of
divide them up like that
or something anyway that aside that's
basically the previous example is what
an SVM is going to do for you so we're
going to go ahead and import SVM and
what it's going to do is it's going to
divvy up numbers so we're gonna use the
digits data set and it's going to mmm
categorize zeroes 1 2 3 4 5 6 7 8 &amp;amp; 9 s
for us and then we're gonna shove a new
version through and it's going to have
to based on the previous examples kind
of guess for us what that number is so
um the the primary focus of machine
learning is kind of like a 2 to skip the
the I don't know experience gaining
aspect of learning so anywhere where you
you think that just kind of like seat
time or you know time and field would
gain a lot of experience for you you can
use machine learning to just gain all
that experience for you instantly so
that can help so anyway cuz like how do
you know what a 9 is versus an 8 or
versus a 4 especially how do you know
what the difference is well you've seen
like a million of them and chances are
you're going to say that a nine has a
closed top and a four does not have a
closed top or something like that and so
that's basically what the machine is
going to do after seeing a bunch of
examples this can be like well they all
have all this and some of them vary a
little bit but the difference between a
four and a nine is it's got you know oh
either a a straight line or a curved
line or some sort of line at the top
something like that anyway uh so we've
got that now we're going to go ahead
we're gonna say the digits this is for
the digits data set this just equals
data sets load underscore digits and
this comes with like a whole bunch of
data and you can look at the digits data
set if you want it is it's like labeled
and then you've got your example and
you've got basically like the not
necessarily pixels but basically what
makes up that digit saved in this so for
example we can say you've got all kinds
of stuff so we could say we can print
digits dot data and actually uh that's
not no parameters there so print digits
out data we can say we run that
just to see the output here okay so it's
a very long array but anyway this is
basically the array of data and you've
got data data and then you've got
basically like what number is it so we
can say digits not data and we can print
digits dot say target for example and
then we can even do um for example we
could say print digits dot
images and zero something like this okay
so this is basically the image of the
digit right here so this is just like an
example of a digit and so as you're
going to find too one of the more
difficult things for machine learning is
that we have to convert everything to
numbers right that's really the only way
that we can normalize data and then
after you convert everything to numbers
you'll find that typically people want
to convert everything to a zero or one
if possible or if there needs to be more
of an array a negative one to a positive
one you want to have all of your data
being that range and it's okay like if
your data is in a range from like
negative 3 to positive 3 or something
like that but you want basically all of
the data sets to follow that so you
wouldn't want like like for example
housing prices let's say you had to
normalize that you'd have to normalize
that data so like if you've got a house
you know you believe we're saying you've
got prices of houses for anywhere from
ten thousand to two hundred thousand
well we need to normalize that because
we've got you know that data we've got
square footage data number of bedrooms
data all that data is not really
normalized so we need to kind of like
normalize that put them all on the same
scale so from a negative 1 to a 1 right
where negative one is equal to 10,000
and then positive one is 200,000 for
let's say housing price stuff like that
so you do have to normalize the data
anyway digis images and now what we're
going to go ahead and do is we'll set up
our basically our classifier so this
basically is going to follow
the real simple tutorial that's
basically on psych it learns website so
if you've seen that then you'll probably
recognize some of this code so anyway
we're just going to use the same stuff
they did so they had CLF a classifier
and that equals SVM dot SVC and then you
can set gamma here we can you can set
this if you want and we'll kind of play
with gamma and a little bit to show you
that it matters but for now I just want
to show you how quickly we can do a
machine learning you know algorithm
there are also a built-in scikit-learn
there is a functionality to just
automatically get gamma for you and
it'll just come automatically pick the
best version of gamma using machine
learning so um you can use that as well
so even if you don't understand what
gamma is at this point that's totally
fine but we'll tweak it and you'll see
that it matters but anyway then we're
going to say X comma Y we're going to
unpack X comma Y as digits dot data and
basically what we want to do is we want
to say this is data all the way up : to
the last number and then we're going to
do digits dot target again all the class
number and what we're doing here is
we're basically storing all of the
answers okay so we have the the data and
then we've got the target of that data
and we're so and we're doing this all
the way up until the very last element
so this digits data contains a bunch of
examples so we can just print I don't
know what the length is but I'm pretty
sure is pretty large so digits dot data
print lame just I did so we have a total
of yeah 1797 examples of digits so zero
through nine I think it might be one
through nine I'm not sure if they have
zeros or not anyway so print lame so we
have that many examples so we're going
to load up 1796 of the examples and
we're going to use that as a learning
data so we're going to basically send
that through and show the machine
learning algorithm hey these are some
samples these are the examples this is
the value and then now what we want to
go ahead and do is we're going to test
you and we're going to test against the
last element the negative first element
and see if it gets it right right so
we've got the learning set and then
we're going to actually go and test it
against that so anyway so we've got this
whole testing set here so this will be
our test and then what we're going to do
is we're going to do a CL f dot bit and
then X Y and then now we're gonna
actually go ahead and call for a
prediction so we're gonna say print
um print I'm at a hard time here print
prediction : comma C left predicts and
then we're going to predict digits data
the negative first element so this will
be where we actually predict what is uh
what is the negative first element and
then we're gonna actually show it so
because we want to see like did the
Machine get it right so um so we're
going to do PLT dot m show so this will
show the image basically and we're going
to show the image of digits images minus
one so what is the actual image here um
and then here this was mostly just so we
can actually see the image so anyway see
map equals P LTCM gray underscore R and
then interpolation equals nearest but
again don't really worry about this this
is basically all this is doing is just
we're just showing ourselves the image
of the the digit that we're predicting
so you don't really need to understand
like what this is doing generally when
you show an image if it's a small image
and you kind of like blow it up on a mat
plot lip it sometimes it's actually
really hard to see the image because it
was originally very small and we've
zoomed in on this big plot and it's kind
of confusing to look at so anyway that's
what's going on there
PGM show and then finally we just called
PLT touch show real simple so we save
and run that and the prediction is that
this is a number
eight and as we can see in the image
it's most likely an eight it looks like
it goes like this it's kind of missing a
number here but the only thing that this
would even be close to is like a six or
something so so we're pretty content you
know it seems like it knew that number
so the next thing we can do is show like
another example so what if we did this
what if we change what if we change the
data set that we memorize all the way to
the negative ten okay so this will be
our training set now trains our machine
- what was it 1787 now examples then
it's gonna fit all those and fit is kind
of this term where again you have a pulp
the trusty old paint again and should
have left it up honestly but anyway
here's access one not straight access to
beautiful and you'll have you know a
bunch of a bunch of data plots here so
let's just say we've got one twos and
threes so we've got here's your wines
and then maybe you've got some twos here
and then you have some threes here and
fit what fit is doing is literally
fitting a line to the numbers so fit
goes through and he's like okay this is
basically how this data set goes right
and if you've ever heard the term
overfit here's how overfit works it's
going to go like this it's going to be
like okay so here is how the data set
works it's like this and then you know
the green is I don't know like like this
I can't tell that's even a green or blue
whoops some cover of that blue anyway
you get the idea
if you ever see like cuz with a low
number of variables you can kind of
actually see you can plot it right so if
you have up to three dimensions you can
plot that like on your computer and you
can see how is your fitment going and if
you see squiggly lines like this you are
overfitting and that's a very bad
algorithm and you should stop that right
away
um I'll save anyway so that's what's
doing what we're doing here is we're
fitting and then we're gonna go ahead
and run the prediction and then we're
showing it so so for example what if we
decide okay we're going to predict a
negative two element let's show the
negative two element save and run that
it's predicting it is a nine and sure
enough we can definitely tell that's a
nine
let's go ahead and do the negative third
element for example I don't even know
what that is eight maybe yes yeah it
says it's an eight as well it's kind of
fun that it pops up before the algorithm
before I can see what the algorithm says
zero and it is a zero so okay you get
the idea so it's obviously fairly
accurate but what if we change gamma to
let's do point one so we saw that was up
would leave a zero here zero gamma says
and with the changed gamma prediction is
a three
yikes let's try a negative two here
forget which one was that nine that nine
was obviously really clearly a nine so
here we got a nine it says we think
that's a three obviously quite wrong so
then so obviously then what if we did
like gamma is a negative or I mean point
zero zero zero one so basically dividing
it by ten here so let's try that now it
knows it's nine cool oh let's go
negative four again here
it figured out this is a zero cool so um
let's just do one more let's do negative
six
hopefully it says it's for yes so what's
what's happening with gamma is like
basically um when you have hopefully
this will be the last time I draw in
paint it's not going to be the last time
I draw on paint but basically a really
popular element of machine learning is
where you have um I wish I had a 3d plot
this is really helpful when you have
like a 3d graph but anyways when you
have a machine learning script we have
usually what looks to be like a little
you know curve like this it makes lips
not like that it's usually like this
right and the goal is to make it to this
right this this is our answer right here
and say we start we start right here and
to get to the answer it's kind of it's
called gradient descent basically a lot
of times it's kind of envisioned as
trying to get down a mountain so in here
we it's a 2d graph but in a lot of
senses it's more of a 3d or 40 or 80 or
15 D or even more 100 D but the idea is
how can we quickly get to the base of
this this mountain and so what gradient
descent is going to do is it's going to
calculate a bunch of examples and figure
out which example gets gets it you know
further down the hill basically so it's
going to continue hopping down the hill
and what you can do is you can either
make gamma or the actual gradient
descents usually it's referred to as so
I'm not sure gammas is what what is
happening right in this example because
usually it's referred to I believe is
alpha or like the learning rate and
basically it is wanting to get down the
hill and you can make the learning rate
really high so the jumps might be this
big right and so really if the jump is
that big you
landing to make basically one two three
four jumps to reach the base of the hill
so your machine learning algorithm would
be like lightning fast right it would
get there but the problem is what if our
jump is this big and we're just having a
field day here getting it so we know
with two jumps we're not quite there yet
and then what ends up happening is you
make a jump like this and you've passed
it and then now we're thinking oh my
gosh we've made a mistake right because
this was closer this is further so then
what would happen is it would jump right
back and then you could get like here
basically and it'd be like well shoot
we've made a huge mistake let's go back
and it would just keep going all the way
up here and then you will never reach
your example or your answer and so
that's a huge problem and but on the on
the flip side you can make your jumps
you know tiny right and just slowly move
down but it might take you like an hour
of processing just to get here right
eventually you will get to the correct
answer but the question is what is the
the proper amount of you know leap size
to get there quickly efficiently and
accurately so just keep that in mind so
it don't save here um so anyways uh
that's pretty much it as far as machine
learning is concerned obviously this
video you know took 20 minutes but as
you can see in this code it's really
simple code uh it doesn't take much once
you have digits data you've got the
target you fit it you predict you're
good to go
right it's really quick and easy to do
this and this machine learning what
we've done with fit CLF to fit this is
the training right so here's our data
set here's where we train the data and
we left the last ten for testing we
train the data here and just just four
concepts training is where you know the
scientist knows the answer and then the
computer also knows the answer and so
the computer is going to fit that data
based on the answer it knows then when
we actually test the data with the last
ten samples the computer does not know
the answer using the previous answers to
kind of come up with the best answer
then we're making our prediction here
and we found that if
was you know low enough uh we we got the
right answer every time gamma was too
high we messed up quite a bit so anyway
that's that it's really simple to do
machine learning as you can see we did
it in very few lines and for the most
part you will use someone else's
algorithm whether or not you're using it
what it's called
there's obviously with with Python
pythons really quick development
language and so a lot of people will use
it to kind of prototype you can also do
it people will use C or Java for machine
learning again you're not going to write
your own you're going to use someone
else's algorithm and there's also a
pretty popular machine learning a kind
of prototyping tool called octave and
you can do a lot of machine learning
there again it doesn't really quite
matter what you're using because in
general you're going to be spending most
of you time organizing your data set to
to work with machine learning so anyways
I'm gonna wrap up the video here in the
next video we'll be talking a little bit
more about well how what we're going to
do and our project is going to be
analyzing stock fundamental data to see
if we can figure out using machine
learning what are the important
fundamentals what kind of algorithm we
should invest based on see if there's
anything there for us so we're going to
have to be pulling a bunch of data
organizing that data and eventually
feeding it through a machine learning
algorithm and we'll talk a little bit
more to about how to pick a machine
learning algorithm that best suits your
task and actually a socket learn has a
wonderful little diagram for how to pick
which algorithm to use is really great
so I'll probably show that as well so
anyways that's it for this video if you
guys have any questions or comments if I
misspoke anywhere on this please let me
know otherwise as always thanks for
watching thanks for all the support
subscriptions and until next time to
easily follow along to the next part you
can either click on the link in the
video if you have annotations turned on
or you can follow via the playlist link
in the description</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>