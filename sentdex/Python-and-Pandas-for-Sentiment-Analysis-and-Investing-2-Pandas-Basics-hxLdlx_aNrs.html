<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Python and Pandas for Sentiment Analysis and Investing 2 - Pandas Basics | Coder Coacher - Coaching Coders</title><meta content="Python and Pandas for Sentiment Analysis and Investing 2 - Pandas Basics - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Python and Pandas for Sentiment Analysis and Investing 2 - Pandas Basics</b></h2><h5 class="post__date">2014-05-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hxLdlx_aNrs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright guys welcome to the second video
in the Python with sentiment analysis
finance and pandas tutorial video series
in this video we're going to be just
running through the quick basics of
pandas so by no means is this a you know
all-inclusive video for pandas just a
quick intro to get our feet wet so we
kind of get comfortable using pandas
before we move into using it for our
purposes so the first thing that we're
going to go ahead and do here is we're
going to need to make a few imports so
we're going to import date/time and this
is just actually more for working with
Yahoo Finance but we're going to need
that the other thing we're going to do
is we import pandas as PE and then we're
going to also import pandas i/o dot data
and then we're going to go from pandas
import data frame that's the type of
object that we're going to use here and
then import mat plot live dot type plot
as PLT and then finally from mat flat
and live import style if you have not if
you don't have a current version of
matplotlib that includes this style i
did just recently put out a video for
matplotlib in style hopefully I'll
remember to I'll put the link to that
video in the description we're just
doing that because it's just a really
quick way to make your mat plot live
graphs look decent without doing a lot
of coding work to get there I also do
have an entire series on working with
mat plot live and making it look good
and then also doing a bunch of you know
cool things with matplotlib so anyway if
you're looking for more stuff like that
I have a bunch of stuff like that in my
channel but anyway continuing on for
style if you're going to use style you
need either a new version of matplotlib
or you at least need the style folder
with the actual style in it that we're
going to use and again if you don't know
what I'm talking about
check the description for a link to that
video it's a video tutorial on how to
get this set up so we're going to say
style that I use and it's going to
ggplot also if you don't want to look up
how to do styles of matplotlib just
simply oops
just simply don't use you know style
don't
leave these two lines out of your code
and you're fine so anyways we're going
to do that now what we want to do first
is we need to get data from somewhere
the easiest way to do this is just to
grab data real quick for me on the
finance so let's just say let's we're
going to grab the S&amp;amp;P 500 so SP 500 is
our variable name and that's going to
equal PD PD IO data get underscore data
underscore Yahoo and we're going to put
in the symbol and for Yahoo the symbol
for the SP 500 is % 5e oops all caps e.g
SP c that's the symbol and then comma
and i'm just going to hit enter to just
kind of save space and so we don't go
out the screen we're going to say start
and that's going to be what is the start
time we want to use well starts going to
equal date time dot date time and here
you specify the date time here and
that's going to be 2000 and then the
month and the day so october 1st 2000
and then after that come down again and
then we're going to say end equals date
state time dot date time and here we're
going to use 2012 1 1 okay so that is
our SP 500 data so that's it for there
now let's go ahead and print SP 500 dot
head and what that's going to go ahead
and do for us is print out just the top
portion of our data so with that let's
go ahead and save that and we run it and
no Majin NPD what did we do import ok
for whatever reason I said import Panter
does dot PD I'm going to say as PD so
that's why we threw this error no module
name to PD let's try that one more time
there we go that's what we wanted so
here we can see the data that we got of
the S&amp;amp;P 500 okay so this is just
starting bit of data for the S&amp;amp;P 500 but
we have a lot more we just pread the
head which is prints the first you know
five bits of data so basically we know
what we're working with what we expect
ourselves to be working with okay so
that gives us head
now the next thing I might want to do
with data is we might want to save it to
like a CSV so here's how you can save
the data to a CSV you can say sp500 dot
to underscore csv and that's something
that's built into pandas and now you can
just say what what do you want to call
this file so we can call this sp500
underscore open high/low close
csv so that's going to save the data to
a CSV so when we run it we save it
there's our head there and if we come
down to where we are we should have this
as a CSV file so we open it up and here
is our file sure enough it starts on the
2nd of October comes all the way down
for a while scroll it down and we come
all the way down to 2011 December 30th
ok so that's our data there now what we
want to do is and obviously I guess a 1
you know January 1st probably weekend or
something that's why I didn't go over
there so that's that the next thing that
we can do though is we actually say we
want to work with this data so a lot of
times you're going to have an Excel
spreadsheet right that you want to work
with so maybe you downloaded that excel
spreadsheet so now let's say we don't
need to pull this data every time so I'm
going to go ahead and get rid of this
and now let's say we want to work with a
spreadsheet so we just made that
spreadsheet so we can say DF for data
frame so a lot of times when you're
reading someone else's code it's going
to look like this they're going to call
stuff DF and that's data frame so DF
equals period underscore CSV what is the
CSV we want to read what's going to
sp500 underscore ohlc dot CSV that's
what we saved it as and then we're going
to specify what the index column is now
the index is basically how do we want to
organize this data basically like what
is the main column of data so in our
case the main column we're going to say
is date so we're say index underscore
Col equals and it's going to equal date
okay so basically it's what the what's
on the first row of data and if you
don't have anything on the first row
data you could say index Col equals
zero and that would make the first
column that so anyway next all day and
then finally we want to do parse
underscore dates and that equal to true
what that's going to do is pandas is
going to parse the dates for us so if
you followed any my other plotting
tutorials where we have to you know
convert a timestamp into a matplotlib M
dates format or whatever it was just
very tedious and what this is going to
do for us is parse the dates for us and
so it's actually very good at parsing
dates and all kinds of formats so very
exciting to have that saves a lot of
time now again we can say print D F dot
head and we'll save and run that again
actually let me start a new windows so
we're not looking at old stuff so again
a new window and sure enough it looks
just like it looked before so we're
obviously working with the same data
here so close out of that now there's a
header now we can also do something like
this so we can say print DF dot index
okay and what that's going to do we'll
get rid of that one is print the index
so here is our index here so it's
basically just a really long list of
dates does that's what we said our index
was was date so that's that now we can
also just access a specific column kind
of like what we just did with index
because index column was our dates
column but we can also do something like
this so we could say time series 40s
equals we could say D F dot flow or not
dot close DF you know square brackets
and then close so that's basically if
you've ever worked like the JSON module
we're kind of accessing a part of this
array basically or data frame and we're
calling into the close column here so we
can say close and then we can even
specify say we want the last ten rows of
the close column so TS use that prints
yes run that and here is that data right
so this is the close column and it comes
with your index column so it's yes it's
giving us the index column as well
because that's
index so that's that now what else can
we do but we can also print article
columns whoops let me turn off my Sam we
can also print multiple columns so here
where we're doing clothes well you can
also say close and open okay so we can
do that oh hold on let's close out of
this what we do wrong here let's see oh
right all right so I try to put like a
simple listing here what we need to do
is this that should work for us now
let's try that one more time yeah okay
so what I was thinking we were doing is
we're putting basically multiple
parameters into there without giving it
a list so we had to do here is before
without the second round of square
brackets we were putting basically like
lists in here and really did the object
in there needs to be the list not a list
anyways um so that works so you need
close open you could all we could also
do hi here okay
save and run it and there you go so
that's a that's just real quickly one of
the nice things about pandas is you can
access specific columns without having
to do really weird split functions and
all this and it doesn't very fast a lot
faster than any split function would do
it so so that's an example of doing you
know accessing different columns and
stuff like that now the next thing that
I just want to show you guys is you can
also add columns and we can even do some
simple math with these columns so so an
example of this would be say we we could
say to specify a new column what we
would do is DF that's references or data
frame right so like right up here that's
our data frame so DF equals farms RDF
and then square brackets here and here
we can specify a new column so we could
say H minus L and this is high minus low
so kind of a popular volatility sort of
measurement is the high minus low you
know what is the price fluctuation for
that day
so DF high minus low and we're going to
say that equals D F dot high and this is
interesting that we're able to do this
right because we never because this is
taking on the form of kind of look at
objects within Python and this is
something that's cool about what pandas
does for us because no but you could
also say you don't have to say dot high
but you could say da high like that but
you can also get away with doing D F dot
high like that and that's really neat so
do you have to hide - and then D F dot
low and so this is going to be what's
the difference between the high and the
low price and it's going to define that
as a new column in our data frame and so
we can do that now we'll come down here
and we can say let's go ahead and just
print D F dot head just just to show us
the whole data set that it's together
now so we can save it run it and kind of
running out of space here but anyway
you've got database you know open high
low close volume adjusted clothes and
then high minus low and we actually have
this information right here for us we
made that really quick calculation based
on other parts of that row so that's an
example how we can do that now just like
you can add a column we can also get rid
of a column so we'll print the df/de
head and then we can say del DF
oops that will not define until the F
and H minus L and then we can print D F
dot head save that run it and again we
see here that you know in this one and
the top one we do have the H - L and
this one we've deleted that column
entirely so you can add columns we can
get rid of columns so the other thing we
can do is well is add say a moving
average okay so that's a really popular
thing that people like to do so we'll
leave high minus low I think will be PI
minus low there and so for example we
could say we'll say close equals dia adj
close
so that's our calling there that's what
we're does it closes and then we can say
ma equals PD rolling mean this is moving
average a rolling mean and then what do
we want to perform a rolling mean ah
well we want to perform it on close and
then what kind of moving average would
we want well this is daily data and
actually this is prime I guess it's
daily data um 50 so we'll say a 50
moving average okay and now what we can
do is print MA and then let's say the
last 10 rows of MA so this is the last
10 rows of that moving average now let's
get this and I guess what we can do now
is let's go ahead and we can start just
plotting this data up so let's do so
we've got an MA and we've got a close so
let's go ahead and do a x1 equals P LT
dot subplot and we're going to say this
is a 2 by 1 by 1
I'm sorry it's a a 2 by 1 and then it's
you know chart number one then what
we're going to do is a I want to plot
what do we want to plot well we want to
plot close and we're going to give it a
label of sp500 since the S&amp;amp;P 500 so
that's what we're going to do that now
we also want to plot let's say the
moving average okay so we can a x1 dot
plot MA label equals 50 MA okay and now
we can go ahead and add the legend to
this so PLT legend and now let's go
ahead and plot the high minus low okay
because some people use that as a signal
so let's go ahead and do that so now we
can say ax 2 equals P Ltd sub plot and
again this is me a 2 by 1 and it's going
to chart number 2 and now we're going to
do some
nice is because since it weighs to go
together we're going to say share x
equals ax 1 so this would make both of
the plots share the axes otherwise if
you start doing something in one subplot
the other one is not going to follow so
it's really easy to get your dates kind
of mixed up so share x equals ax 1 and
now let's go ahead and a X 2 dot plot
and we're going to plot D F H minus L
and we'll call vit will say label equals
h minus l PL t dot legend again for this
subplot and then PLT da okay and that
should give us a graph of the S&amp;amp;P 500
a 50 moving average of the S&amp;amp;P 500 and
the plotting of the high minus low how
much low might be a very messy plot but
we'll see so let's go ahead and save and
run it and again if you don't if you
didn't use style um that's ok this will
still show up it just won't look the
same as mine does ok so anyway we'll hit
OK in Val's index okay we figure out our
comma after this - okay run it again
okay no it's not bad ok so here is our
chart and I'll just fit it to our screen
here ok so again this is our SP 500
information ok and then this is our
moving average so the red line is the
actual S&amp;amp;P 500 this blue line is a
moving average basically a 15 ma of the
S&amp;amp;P 500 and then down here we have high
minus low which is indicative of
volatility and that's no surprise
because we have the most volatility here
and we can see it's very high here and
then we also have some volatility here
gets very extremely high there and yeah
ok so those are just some of the basics
of using pandas charting with some
pandas or modeling whatever obviously we
didn't get you know super in-depth but
we learned how to access columns access
specific columns access the whole thing
read from you know spreadsheets do some
simple math by you know doing the high
minus low for example
deleting columns adding columns but in
order yet say that and then obviously
charting the stuff up so those are some
of the very basic stuff we will be
getting a little bit more in depth into
this series and doing some other things
with pandas but anyway to do this
yourself would have been kind of a lot
of work we've been doing a lot of time
splitting up things and organizing
things whereas with pandas it's very
quick and easy you know it's very few
lines actually normally we would have
had quite a few more lines to make that
chart so anyways hopefully you guys
enjoyed if you have any questions or
comments feel free to leave those in the
comment section if you're having trouble
or whatever leave that below and I'll do
my best to help you out maybe someone
else could help you help you out as well
so that's going to conclude this video
in the next video we start actually
working with the data set that I had you
all download and we'll start actually
doing some analysis with that data so
stay tuned for that as always thanks for
watching thanks for let's pour in the
subscriptions and until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>