<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Live Graphs with Events - Data Visualization GUIs with Dash and Python p.4 | Coder Coacher - Coaching Coders</title><meta content="Live Graphs with Events - Data Visualization GUIs with Dash and Python p.4 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Live Graphs with Events - Data Visualization GUIs with Dash and Python p.4</b></h2><h5 class="post__date">2018-02-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/37Zj955LFT0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody and welcome to
part 4 of the data visualization
applications with Dash and python
tutorial series in this tutorial what
we're gonna be doing is covering live
graphs so up to this point we've covered
how to do a basic layout and sort of
graph and then even have like user input
changing what that graph is but many
times you're gonna want to actually have
a graph just automatically update
whether you're doing something like
reading from a sensor or maybe you're
doing some updates based on some
database values or whatever there's lots
of reasons to have a live graph so let's
go ahead and cover that example so first
burgers are gonna make some imports here
so we're gonna import - so it can use
stuff from - from - dot dependencies
we're gonna import output and events so
unlike before we were importing just
output an input this time to update live
we don't need any actual input instead
what we're gonna have is an event that
triggers some sort of function that as
if an input like an input but instead of
an input it's actually an event lots of
times actually an input if you're doing
like UI really anything like gooey stuff
a lot of times a user inputs called an
event so it's kind of an unfortunate
naming convention there but that's okay
we'll just continue on but just take a
note that if you're using your imports
from before that you need event event
there and then import - core components
as DCC and then import - HTML components
as HTML then we're gonna import plotly
so we can use stuff from prot plotly
we're gonna import random just for the
making of random data for us to graph
and then we're gonna import plotly dot
graph options as go for short graph
objects and then from collections we're
going to import de Q or de cute I don't
know how to pronounce it I'm gonna call
it dick you feel free to get me in the
section tell me how to properly
pronounce that if you want what did the
queue is is basically it's a container
that has a you can specify a max size so
you can basically think of it like a
list that you can say okay I want the
maximum size of this list to be 20
elements so when you try to insert the
twenty first two that basically was
going to do is is going to pop out that
zero element and then insert that new
element so it always keeps a maximum
length it doesn't have to be that length
it just has max so anyway X will be a
day queue with a max Len of 20 and then
we're also going to do the same thing
for a Y now we're gonna go ahead and X
dot append one y dot capital y dot
append one just so we have some initial
starting data now let's get to the
application itself app equals dash dot
dash and then we'll just throw dunder
name in there and then app dot layouts
basically we've seen this before so
we're gonna have a 80 ml dot div and
then inside here's where all of our
children will reside and that's going to
be a list and in there and in fact maybe
this would be better better than the way
I was gonna do that so we're gonna say
yeah I still don't like the way it's
done that let me do this wonder why it's
act in that way you just really want to
be a list right there okay
like I said styling the HTML from within
the from within Python can be a
challenge okay so anyways we're gonna
have DCC graph and this will be the
graph that we're hoping to be live now
we do need an idea if we're gonna be
updating this element because just keep
in mind that all the updating that's
gonna happen is gonna be done via
JavaScript and if you've ever worked
with JavaScript if you want to update
something you pretty much need an ID you
could get away using other things but
it'd be very sloppy okay so we're going
to use an ID for this so we're gonna say
live graph so we have the ID and then
we're also gonna pass an animate equals
true here and that's really all we need
if you recall you know the other thing
that we're gonna need is figure but
we'll get there in a moment
so DCC graph good
now what we're gonna do is also have an
interval interval now this is kind of an
interesting little element here what
we're gonna have is the interval and
you're gonna specify an ID for this
thing now maybe we'll check what this
looks like in the code I'm not sure
we'll actually be able to see it but
anyways this is how we're gonna trigger
an event to occur for us so we're gonna
give this the ID of graph - updates so
mmm this is going to be basically an
event that has the ID of graph - update
but it's an interval so what we're gonna
say is we're gonna we're gonna say the
interval that we want this event to
occur in milliseconds will say 1,000 so
every one every second or every 1000
milliseconds this interval is gonna run
with the ID of graph update so if you
recall from before when we did inputs
the input would have an ID and a value
but using that ID we you in the wrapper
that we pass with a decorator that's
what we need to trigger some function to
run so if if you're feeling comfortable
with the input and output stuff then you
should
probably know already where this is
going but we need to make first that
like that decorator so what we're gonna
say is at app callback and so we're
gonna make a call back here and we're
gonna say the output the output is this
live graph right we want to update this
live whatever has the ID of live graph
now this time though we don't want to
just update anything we want to update
figure so so again this graph won't
actually show anything until we pass
figure into it so just just for the
record I'm just gonna pay something in
real quick don't write this out but this
is what we're expecting when we graph
something so we DCC graph it gets an ID
which we must have and then a figure and
inside that figure which is the
dictionary we have data and then if you
want to you can pass layout and stuff
like that so keeping that in mind let me
just comment that out again you don't
have to write that I just want to show
it to you and bring it to your attention
okay so any call back here okay we've
defined our output now what we want to
do is the events so what we're gonna say
is events equals and this will be a list
of again the event type and then what
was the ID of that event
well it's graph - update so as you can
imagine there are other updates or I'm
sorry other events that you could come
up with it just so happens that the
event that we're making use of right now
is just this interval class basically
that just simply calls this ID every one
second but there are many other events
that we could use here this is just one
of them so event is of the ID graph
update and it's an interval and then
what we're going to do now is define the
actual function itself that's going to
run so we'll just define update graph
and again we can call this anything we
want because it's actually the wrapper
itself that is being called and if
you're familiar with decorator slash
wrappers
it kind of it's almost as if it's
encasing the function within so it
really doesn't matter what we call that
function it's the wrapper itself that's
going to get the trigger to then run the
function so once we have that what we
want to do since we're just using some
toy data is update data so I'm on a
global X and global Y so I mean you
might be squirming or whatever because
you're told Global's are the devil if it
makes you uncomfortable I'm sorry this
is just a toy example like I said
normally maybe you'd have an SQL query
here or something like that select for
all from limit 10 order by you know time
descending not in that order anyway
you'd have something that's updating
this data or maybe you're reading from a
sensor and then you're storing the data
somehow whatever I'm just going to do it
this way for the sake of simplicity and
then let's just add some data so we're
gonna 4x X is just our x-axis we're
going to just do X minus 1 plus 1 so
we'll just keep adding one to this X
element and then what we'll do is
something similar for Y but not quite
the same otherwise would be very boring
so it'll be the last Y element plus the
last Y element times random dot uniform
let's do negative zero point one two
zero point one cool
so that'll just kind of add a little bit
of randomness to how our data looks at
the end of this one so once we have that
now what we need to do is we want to
build data right we want to build this
bit out so what we're gonna say is that
data bit will be plotly dot and actually
I think we're going to use graphic yes
let's just use go here so data equals go
daunt scatter so it's a scatter plot and
then what we're going to say is x equals
list capital X y equals list capital y
let's not forget our commas there so you
can't pass it too
q here you have to pass a list so we're
just going to convert it the last second
to a list now what we want to do is
let's just give it a name
the hostess call it scatter and then
we're gonna get dude thank you and then
we're gonna give it a mode and we're
gonna say lines plus markers so in
plotly there is no like there's nothing
called a line graph it's just a scatter
graph that happens to have lines
connecting the scatter so that's your
line graph so lines plus markers gives
you a line graph so once we have that
basically now that's the data bit in
here right that's this but now what we
want is basically all of figure and
that's what we wanna stuff into this
graph right here right that's what we
want to end so now I'm just gonna return
this stuff so I'm gonna say return and
then what we're gonna return is a
dictionary right this right with this
first value being data so we're gonna
return
I think it's lowercase yeah data : and
then as you'll see it's a list of
elements so let's just do a list of the
elements with this x and y and types and
or not types but names and mode let's
say we want that to be a list so we're
just gonna list data okay so that's
covered so we've done this part right
now we need layout so let's go ahead and
pass the layout layout and layouts gonna
be a little different now what's the
reason why we have to do this is for
whatever odd reason when you animate a
graph with plotly it doesn't want to
like refresh the entire graph it only
refreshes the data points within the
graph now this becomes problematic when
you exceed whatever the starting axis
values were so let's say the axes went
from zero to ten what if you have
of 11 12 13 well as that graph updates
it just goes on right off the graph it
doesn't actually update so what we want
to do is we want to have this graph
update those things now if anyone from
plotly is listening which I doubt why is
it that way
don't make it that way but anyway go dot
layout like to me the the animate equals
true ought to have this basically run
every time instead we have to make it
run every time so that's what we're
going to do we're gonna say go dot
layout and then what we're gonna say is
we have two words going to set the
limitations for the x-axis and the
y-axis so we're gonna say x-axis equals
dicked and then range is going to equal
and then we give the you know the the
end the bottom and the Max or the
minimum and the max max X okay hopefully
that okay cool so now we need to do the
exact same thing for the y-axis so Y
axes min Y max Y now on some plotting mm
frameworks you would probably want to
add like a little bit of leeway on both
sides like I don't know 10 plus 10% or
5% just so you can fully see things I
feel like with plot Li you can still
clearly tell where things are so I'm not
going to add any more to that but just
know that sometimes you might have to do
something like that anyway okay so
that's everything right that's layout
it's the dictionary so that was every
that was like all of this right we're
returning figure because this outputs to
figure of live graph here boom that's
everything we need so I'm gonna go ahead
and get rid of this and now we just need
to run the app so what we'll do is just
do the if dunder name equals dunder main
app dot run server to bug equals true
awesome let's run it see what happens
invalid syntax looks like clearly like
we forgot to calm
let's try again whoops try to pull it
down anyway looks good so far let's
bring this over refresh
there's our empty graph okay and it's
updating now and as we can see the
x-axis is updating we haven't okay now
the y-axis is updated as well and we can
see the live graph has begun and then
once we get to 20 data points we'll see
the entire graph shifts as the min and
Max for the x axis begins to take effect
there we go and as the day queue just
gets rid of the initial stuff obviously
you could make some modifications here
and you know you don't have to have a
max Len of 20 you could have a max Len
of you know hundreds if you really
wanted so the other thing is you could
update much quicker or at least you
could attempt so we'll try a hundred
here just wait for it there goes it's
just gonna start over so interestingly
enough that doesn't appear I'm pretty
sure that interval is the same
it definitely reset itself but that
interval feels the same I wanted to show
you that it does actually go faster than
one second this is clearly still on one
second maybe we have to fully restart or
something like that I don't really feel
like doing that but even you can get
this to go a little faster but I feel
like sometimes it gets a little behind
itself and I don't really think
especially if you're reading sensor data
or anything from a database just make
sure that it's updating as quickly as it
seems to be reading in so I don't know
have any idea how the back end is
working with with - here
I just I've gotten the impression that
sometimes the data is baha or what's
being shown here is behind what it's
like cached or I don't know in the
pipeline to come out so I feel like it
probably does get delayed over time if
you make that update too quickly so
someone can feel free to test that but
just be wary that that might be a thing
anyway regardless that's it that's a
live graph and now up to this point we
have everything we need to build that
app I showed you before at least all of
our knowledge of - now we
gonna put it all together so the app
that I showed you in the beginning
basically reading vehicle sensor
information we're just gonna generate
dummy data just like this everyone can
follow along you don't have to hook it
up to your car or anything but something
like you know picking things from the
menu getting graphs to dynamically pop
up given which one we picked from the
drop-down showing you know dynamically
one which will fullscreen it or maybe
two so it's like half the screen or
three or if you add more than three
putting them on another row that kind of
stuff
hopefully just kind of bringing together
everything that we've learned up to this
point so if you have questions comments
concerns suggestions whatever feel free
to leave them below otherwise I will see
you in the next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>