<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Image Recognition and Python Part 9 | Coder Coacher - Coaching Coders</title><meta content="Image Recognition and Python Part 9 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Image Recognition and Python Part 9</b></h2><h5 class="post__date">2013-10-28</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ry9AzwTMwJQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is up everybody welcome to the 9th
image recognition tutorial video
it's just image recognition now we're
not really going to do any more
manipulation we've got this video and
maybe one or two other videos before I
wrap this up and in this video what we
want to do is well in the last one we
made the create examples which was kind
of like a making of a database for the
examples of the numbers 0 through 9 and
I guess we didn't really call that so
that's okay so I'm going to get rid of
that but now what we want to do is let's
go ahead and just remove all of this now
what we want to do is let's actually
make a function to take a current image
and then compare it to the database that
we just made right here with create
examples so that's what we're going to
do now so we're going to come down here
and we're going to define function we're
going to call this function what num is
this and in this function we're going to
have one parameter and that parameter is
going to be the file hat so what's the
path to the file that we're actually
talking about now the next thing that
we're going to do is we're going to say
matched array that's give me an empty
array for now but as we find matches
we're going to store it in matched array
so let me explain what we're actually
going to do here so what we're doing is
kind of like it's close to a neural
network but not really it's not actually
learning anything what it's going to do
is just compare it's much like pattern
recognition what's going to do is it's
going to compare pixel by pixel and ask
the question is this white or is it
black and is it similar to one of these
examples and so each time it's the same
thing it will store it so it's going to
take that combination basically what of
the nut are the colors that made up that
pixel so even if you had like three
colors or four colors that would do that
now keep in mind it will okay look it's
going to calculate a true or false
basically so a zero or a one we
0% or a 100% right as time goes on if
you wanted to make this a little better
you would engage in either a bit of
blurring so you would take the image and
move it left and right and then like say
you've got you know a a 255 255 255 you
would instead do you might put a value
on either side of that pixel right
because like what if the image is the
exact same image but it's shifted over
one pixel well this would honestly throw
this system for a bit of a loop so
either you can make a system that
centers the image just so by various
rules so we could either have its widest
part you know touching the edges of this
8x8 box or the tallest part et cetera so
you can do something like that but
really probably the better thing to do
is kind of make a smoothed out version
of the picture in numerical form and
then you could compare them but
depending on what you want to do that's
that's going to kind of dictate how you
go about doing it so basically all I
want to do here is to show you guys a
heavily thresholded comparison in
whether or not it even works in this
sense so we've got matched array and so
each time an object matches its going to
go into this matched array and what
we're going to do is match it to that
number but instead of explaining
everything to how this will work I'll
explain it when we get there the next
thing that we want to do is we want to
load up those examples so we'll just say
load exams and that's going to be equal
to open and what do we want to open we
want to open that num our X dot txt file
that we just made and we want to open
that with the intention to read and
let's go ahead and just read it into
memory now let's go ahead and you load
stuff capitalize that X load exams
equals and then we'll just modify this a
little bit we'll save load exams not
split my new line so basically it's just
reading each item as a liner each line
as an item basically this number a
examples so now next thing we want to do
is we want to eventually we're going to
kind of well 1 we're going to convert it
to a list so we can use it but then also
we're
going to eventually want to show this
visually but we'll get there so we want
to say I equals capital I nage open we
want to open that file path so that's
pretty familiar to you guys then we'll
do I am A plus MP dot R a I that's
familiar as well and finally I are I a
RL is going to be a a r dot to list and
again the rate like what we did with
load examples is we just use the exact
same variable right to modify the
original variable whereas here each time
we use something different we could say
maybe I like down here we could say I
equals I and P or AR I you know you
wouldn't have to change this but we do
want to versions because we're going to
use IR for something and we're also also
going to use I ate RL for something so
just keep that in mind that you could
change that up but that's why I didn't
use the exact same variable for down
here moving on we use in question this
is going to be a string version of I a
or L and the reason we want to do this
is we wouldn't have to do it this way
but since we're going to for the method
that we're going to use this will be
fine but again I guess I guess I'll
explain that when we get to it as well
since we're still just defining a bunch
of variables so now let's make a for
loop so what we're going to do is we're
going to say for each example in load
exams now at this point you can do one
of two things and well you can do one of
like infinity things but our our load
examples in the way that we stored it
let me just scroll up here for each
example that it found it wrote the line
and then ended with a new line so we're
going to have a blank line at the end of
our file and this is really common with
a lot of files that you're going to get
because this is how just the way people
do it ideally what you would do is you
would come down here
and you would have a trim function and
you would trim away that extra line but
pretty much no one ever does that for
you and so you might as well just get
used to not having someone do that but
what one thing you can do is for each
example exams you could say if when each
example greater than three right but
really it should be greater than pride
like even two or something but we'll
just leave it three it really ought to
be a very long length anyway you could
just do something like that and that way
you don't have to worry about blank
lines and then sometimes like screw up
lines and stuff like that so anyway
we'll just do that for now so the next
thing we want to do is we're going to
say split example equals each example
dot split and we're going to split by
that double colon that we made and just
in case anybody's not following right
after watching that last video I let me
bring up the file so in case you're not
coming straight off of that last video
this is the file and question so we have
the number and this just means like this
is the example so if you weren't using
like if you were doing letters you would
have like say this was for a J you would
have a ga here right or if it was for a
capital J a capital J right and so for
numbers you have that number there for
characters you just put the character
there right that makes the most sense
but then like if you have like a
person's face well you would just give
them like a number ID or just an ID then
it could it could you know that that
face could be Jeff or you could give it
you know face number five forty right so
just keep that in mind but anyway this
is the ID and it just so happens to be
the idea of exactly what it is and then
this is the creation of that ID so
anyway I'm going to close out of this
and save it now so anyway we split it so
then the what we're going to say is
we're going to say current num equals
split X and that's going to be zero so
the zero with element or the first
element and then we're going to say
current array so for that whole array of
that item is going to be split x1
and the next thing that we're going to
do is we want to get each pixel right
because we want to compare pixel to
pixel now again that's not the best way
to do it it will work especially if
you've got a good close-up you've got a
full you know you specify the parameters
we like that full size of the images
that you're comparing to as long as that
is the case this is totally fine but
later on say you're wanting to like for
facial recognition like for example in a
camera right when you're taking a
picture and it like put squares around
people's faces well everybody's face is
a different size sometimes the camera
might be really close or really far away
and in the end that's just a function
that normalizes everything and still
compares based on the same pattern so
you would have to do that right if you
were really in the business of doing
image recognition so I'm going to leave
that to you there may be a day where I
make a video series on how to do that
but mostly I just want to get the basics
of image recognition down and so anyway
the next thing we want to do is we're
just going to say each pics example so
each pixel in the example is going to
equal current array dot split and we're
going to do something again not the most
professional but since we're doing a
very basic tutorial we'll keep it as
basic as possible and this will keep us
from writing another function and we're
just going to split by closing brackets
, so let me bring up the file again and
explain why we why we're doing it this
way so here's our file again and as you
can see if we split it just simply by
comma we're going to split by here here
here here here and so on if we split by
a bracket comma however we will split it
you know here and then here and then
here but luckily the array itself right
like every array starts with bracket
bracket bracket and then first pixel
bracket close comma space you know that
you know what I'm saying so
y'all can't even answer me so I don't
know why I asked but anyways they're all
going to be that same and since we are
comparing only pixel to pixel this is a
fine way to do it but again if you've
ever wanted to expand this and make it a
little bit more dynamic and versatile
you would have to change this of course
so I recognize that but for now this
does the job and it keeps it very simple
so now the next thing
each pics and then we're going to call
this I kept well it doesn't matter you
can call it whatever you want but I'm
going to say each pics in question like
that equals in question got split and
again we're going to split course by the
same thing otherwise there would be no
matches so that's that now what I want
to do is make a a while loop to run
through all of the examples because we
never really know how many examples
we're going to have and you could write
a for loop in like a one-line function
and make it all fancy but to keep things
again very simple let's just make a
while loop with a counter so we're going
to say x equals zero because we always
start with the 0 with element in you're
right so then what we can do next is we
say well what while X is less than the
length of each pix example or you could
do the length of like each pics in
question it doesn't really matter but
for each pixel we're going to make this
little while loop and we're going to say
because in our case we have an 8 by 8 so
we know there's you know 64 pixels but
in the case of an even larger one so
there's no reason to say like you know
for each number in 0 to 63 you do this
doesn't really make much sense to do it
that way because we can do it this way
with just as many lines and actually
make it at least dynamic so we're not
the whole thing isn't poorly written
right so we're going to say that and
then we're going to say if each pix X or
each pix in the example with the X index
is the same so double equal sign
each pix in question with the X index so
if
they are identical we're gonna say
matched array dot append and what we're
going to append is the literal integer
value of current num because I natively
it'll read it in as a string since it's
all coming in as a string and then being
split up like it's a string so so then
what we'll do is we'll just match it to
the integer of the current number or
we're going to append that integer to
the array so now and that's this matched
array so now after we're all done there
and closing that if statement we want to
do X plus equals one so make sure that's
not under here otherwise your program
will be really finicky it'll actually
fail
so anyways coming down once you've done
that now let's just go ahead and not
under here but I think one more
overwrite so zona for if Len for each
let's see I think what we want to do
then is put this underneath our four so
once the for loop is completely
completely completed let me get it a
little bit uh we're going to go ahead
and let's print matched array and then
we're going to say uh well I'm probably
the easiest thing to do is yeah I don't
think we did it yeah up at the top of
your script what we're going to want to
do is import a this thing called counter
and it'll make this really nice array
and do exactly what we want to do so
just type in from collections import
counter now I believe this comes up with
your vanilla installation of Python I'm
not absolutely positive in fact let me
Google it really quick because there's a
lot I've been playing with Python for a
while net might not have come natively
once it anyway just wanted to make sure
that was truly the case and it should be
the case that it comes with your
installation coming back down now what
we want to do is we're say X even though
we have an X here that should be fine x
equals counter of matched
array and what counter is going to do is
is going to go through that array and
it's going to count because like
basically what's going to happen here is
ideally you're going to have like a
bunch of let's say you have you're
inputting a number three and your array
is working the way you want it to
chances are there's going to be a lot of
pixel this is a type of them you fix
that there's going to be a lot of pixels
in the in the three example like the
examples of the number three that are
going to be matches so there's going to
in this match to raid there should be a
bunch of threes so what counter is going
to do is for every every individual
quote-unquote type of element within
your array it's going to bunch it all
together and it's just going to give you
one version of it followed by a colon
it's really going to make like a
dictionary condom and it's going to be
like that number colon and then how many
times it was found in the array and then
what we can end up doing is graphing
that so but also you don't even have to
graph it it gives you your answer which
one is most closely related to what
we're doing right so x equals counter
whatever and then we can print X and
just for a simple simple simple example
let me bring over a Python module here
or any from collections import counter
ever going to say example equals one one
two six four two two six one good now
we're going to say a C for collections
equals counter x and then we'll sit C so
now what it's doing is it says for the
number one there are three examples for
the number two there are also three
examples for six there are two examples
and then we have in a number four and
there's only one example so it looks
very much like a dictionary by the same
standards you can do um you can do like
C and we want to know how many examples
of the number one
there are and then it outputs three so
that's just that's a little bit of how
how they work is basically a dictionary
so close this out and that's that so now
what we want to do I don't you know
we're not calling any function so what
we want to do is we're going to call
what num is this we're going to put in
that file Pat so I what this and the
file path is followed my directions
image is slash test dot P and G save
that and let me bring up that that image
real quick and actually I thought I
included a test image but I guess not
okay so what you want to do is open up
pain or whatever you have to make silly
images and just do make sure you do a
save as and save it in the images save
it as test a PNG or whatever you want to
and so the next thing what we want to do
is like let's actually make an example
so I'll just click on the blue pencil
here and you scroll this over and let's
make its doing number three since that's
pretty difficult so okay oh my gosh this
is a very bad three I'm not sure this is
gonna work but that'll be nice if it
does so anyways that's my three let's
just
I guess we'll leave it there whatever
anyway we'll see what happens so it's
honest save that it's test dot PNG we
move this over and hopefully we didn't
really check this for integrity or
anything but I guess we'll find out so
let's run this and see what we get and
we'll move this over and we can see here
that it didn't indeed to correctly pick
the right number now just as an aside
each it is there are you know it's an
eight by eight so there's 64 possible
matches per example and we have
basically a sixty-four whoa yo you got
64 pixels and then each number has a
total of 576 examples so like a
quote-unquote perfect match would be 576
so this scores a 427 out of 576 this
scored it 400 and so on so I would argue
that it must be better than surely 400
right so you might want to like
threshold at 400 anything that's worse
than a 400 match.you it's a high
probability that's wrong anything above
400 you're getting closer to the fact
that well then maybe this is correct
so anyway luckily with my horribly drawn
number three we were able to actually
have a match I didn't think that we
would get it with this nasty three but
somehow we did it so anyways um that's
that and it just just as a quick aside
to counter will always put like the
highest number first right so the most
matches was for number three the second
most was for number two and so on the
least matches was the number one with
only 309 so that's cool but everybody
likes to view things visually so in the
next video what I'm going to be showing
you guys is a visual representation of
this and then we'll actually run some
more examples with some awesome
hand-drawn numbers by me so anyways as
always thanks for watching thanks for
all the support of the subscriptions and
until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>