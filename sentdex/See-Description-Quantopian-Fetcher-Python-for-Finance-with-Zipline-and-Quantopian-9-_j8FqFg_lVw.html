<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>[See Description] Quantopian Fetcher - Python for Finance with Zipline and Quantopian 9 | Coder Coacher - Coaching Coders</title><meta content="[See Description] Quantopian Fetcher - Python for Finance with Zipline and Quantopian 9 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>[See Description] Quantopian Fetcher - Python for Finance with Zipline and Quantopian 9</b></h2><h5 class="post__date">2015-07-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_j8FqFg_lVw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody welcome to
the 9th Python for Finance tutorial
video in this video we're gonna be
talking about expanding the boundaries
we're actually going outside of the
quanto peon boundaries so up until this
point we have only covered things that
are included and are a part of quanto
peon as far as whether we're calculating
a moving average or if we are accessing
fundamental data or even the prices that
we're using are all part of quanto peon
but what if we want to reach outside of
quanto peon for some things so maybe we
have a source of signals or maybe we
want to use prices outside of quanto
peon what if we want to back test a
Bitcoin trading algorithm well at least
at the moment of me filming this
they don't have Bitcoin prices so you
could but you could import Bitcoin
prices and the way that we do this is
with the fetcher that quanto peon has
built for us so with the fetcher what we
can do is as long as our CSV is oriented
in kind of the way that the fetcher
wants we are able to access any CSV file
that's hosted on you know via a URL
basically and we can reference that pull
that in store that to a panda's data
frame and start accessing that data as
long as we also have obviously a date
column to reference so that's what we're
gonna be covering here and for this
tutorial we're going to be using the
cent Dex API so for those of you who
aren't familiar with syntax this is my
sentiment analysis website we've got
finance politics and some other stuff
but with finance we do sentiment
analysis and for example the question
that you might have is you know how good
is it like can we actually trade based
on the sentiment analysis of a company
and if so how do we do so like here
would be you know Bank of America this
blue line here is the sentiment and
we've got price and at least visually it
looks like in some places yeah
we would probably be beating the market
and in other places now maybe not we're
not really sure right especially because
there's more lines that we could add or
we get a short term which is like a
bunch of squigglies now we're just I
don't know coloring outside the lines
here so looking at a graph and looking
at patterns humans were really
seeing patterns and they're really good
at being like yeah that'll work or no
that won't work but usually we've tried
to fit things like we just really want
things to fit so the question is while
this may look visually fitting does it
work and so we're going to be using the
syntax API for this normally it is a
paid API but I have sample so will you
be using a sample of the API and this is
actually going to be all signals from
the inception of sent Dex all the way up
until just a few days prior to me
filming this so will we really get a
good feel for whether or not you know
these signals work but we'll be back
testing based on purely sentiment
signals so you could also back test
purely on any other signal so maybe
you've got some sort of signal
generation that you've got going on so
if you do feel free to instead of using
the send text signals use your own
signals try whatever you want but I'll
be showing you at least the format that
it should be in so you can do this and
if we go let's see to the syntax API so
right here what we can do is we can come
down to such as I API send XCOM and this
is the we offer a few different api's
this is the one for sentiment signals
you can get a sample so this will be the
sample sentiment signal so let's go
ahead and click on that and that should
bring up this for you so again we start
in 2012 this is October 14th that's
basically this is when centex was born
and the only company we tracked was
Apple at the time and then a few days
later I brought in Microsoft and Google
and then a few months later we started
bringing in basically every company in
the S&amp;amp;P 500 so this sample goes all the
way from you know that late 2012 all the
way to June 15th which is just a few
days ago I'll date the sample from time
to time but because I offer a paid API
I'm not going to keep this live updated
a lot of data and a lot of work and just
a lot of everything went into syntax so
I really can't just give it away for
free but at least the sample for the
purposes of this tutorial I can do and I
think it's cool so anyway that's what
we'll be doing so this is everyday 30
minutes prior to market open it
generates the last day's worth for
whatever
stocke is here so if a stock wasn't
updated within the last 24 hours it
won't show up here for this day
basically so every stock that was
updated within the last 24 hours
from 1300 GMT so this is 30 minutes
prior to market open for the New York
Stock Exchange it calculates the last 20
min of the last 24 hours of sentiment
so as we conceived on June 15th at 1330
minutes right before market open Cisco
was rated as a negative 3 so that's
pretty negative that's as negative as it
gets actually for Cisco so for us we
would want a short Cisco in that sense
so anyways there's that this goes from
negative 3 to a positive 6 the positives
I'm more interested in playing with I
think shorting is risky so I just the
shorting just has a negative 1 negative
2 or negative 3 or as positives go from
anything it's more expanded basically in
the range but a negative 3 is just as
powerful as a positive 6 keep that in
mind
so anyways we'll be we'll just write
something that bait that trades on the
extremes anyways we're trying not to get
too fancy but those are the signals that
we want to use and anyway we've got
dates here
so can we trade on this this information
so let's go ahead and get started so the
first thing that we can do is and
initialize this is where we have to
actually pass the the fetcher so for
example let's do a first we want to
define how much are we willing to invest
at any one time so we're gonna say
context daunt
investment underscore size this is going
to be equal to the context portfolio dot
cash divided by 10.0 so we're gonna
invest 10% of our portfolio at any one
time then what we're going to go ahead
and do is we're going to use a stop loss
here so we're gonna say context dot
stop underscore loss underscore PCT this
is a stop loss percent is going to be
zero point nine nine five okay so we'll
talk about that in a little bit but
basically we'll just use this number to
multiply the original value by and that
will be our stop loss number
then we have to use a new function here
that we haven't covered and that's gonna
be set symbol lookup date so this will
set the lookup date for specific symbols
and this is because as time has gone on
companies have entered and exited the
S&amp;amp;P 500 or actually the New York Stock
Exchange not the S&amp;amp;P 500 companies have
also entered and exited the SP 500 but
the New York Stock Exchange and so at
any one time maybe one company operates
the symbol of I don't know
CIN F and then a few years it goes out
and then maybe a year or two later a new
company comes in and takes that exact
same symbol so to account for this we
set a symbol lookup date and this is
where we specify a date that these this
date is the date of the symbol whatever
symbol we're looking up so if the
company doesn't exist at this time it's
not going to find it and if if it does
have a conflicting name it's gonna use
the name that was as of October 1st 2012
I'm using that time because that's
basically when sundeck started so scent
symbol lookup date done now we need to
fetch underscore the CSV and then in
here we put the CSV that we want to
bring in that's this CSV here so that's
sent Dexcom slash API slash finance
slash sentiment - signals slash
sample you can probably type it I should
put a link in the description I will
probably forget initially but remind me
and I'll put one there if I forget so
copy that come over here and in quotes
paste now with the CSV fetcher what we
can do is we can specify both a pre funk
and and after funk but we'll just do a
pre funk for now and what pre funk is
gonna do is this is basically prior to
doing anything else with the CSV so with
pre funk what we could do is we could
say we just say we want to run preview
for example so we can come over here and
we can define preview and then the
parameter here's the DF for the data
frame and then here we'll just do log
dot info and then we will
let's do logged out info DF dot head
okay something like that and that'll be
good enough so that'll just give us a
preview of whatever we just loaded okay
now the CSV fetcher can be kind of
confusing so let's go here into the help
Docs before we wrap up this first part
here and we're looking for fetchers
where are you fetcher there it is
fetcher and here is a good idea to kind
of pay attention to so you there's
basically two major formats you've got
Sam like a format for signals and you've
got a format for anything for a specific
company now they call it signals here
and but for signals I think that's for
like global signals there was really no
way that I could figure out to tie
signals to stocks
other than to use this version here with
a symbol so that's what I ended up doing
anyway so this is the version that we
have and you can see it looks very very
similar right we've got the the date the
ticker and the symbol or the signal
rather that's basically how this one's
structured so that's why I copied that
structure but you basically those two
structures to mimic so just keep that in
mind now I think what we'll do is we'll
leave it here and in fact let's try to
build this and make sure everything kind
of runs but we should get the preview at
least down here when that runs now
fetching the CSV depending on the size
of the CSV that's going to take like 30
seconds ish to pull it in like ours is
12 megabytes 12 13 megabytes right now
up something went wrong here runtime on
line 12 so we've got let's see let's go
ahead and put in a pass on this pre func
is preview let's return TF here that's
most likely our problem let's run that
one more time and see if that solved it
so we're passing basically the pre func
we pass through our data frame to the
preview and the preview should be yes
there we go the previews should be
returning us cancel this for now
should return the the head to our log
here but we just cancelled it for now
but and then return the data frame so we
can actually continue using it but we
weren't returning the data frame so
that's why we got an error anyway we'll
go ahead and stop it here and in the
next tutorial we'll talk about actually
building our logic and all that so stay
tuned for that if you have questions or
comments up to this point please feel
free to leave them below otherwise as
always thanks for watching thanks for
all the support and subscriptions until
next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>