<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Visualizing Strategy Metrics - Zipline Tutorial local backtesting and finance with Python p.2 | Coder Coacher - Coaching Coders</title><meta content="Visualizing Strategy Metrics - Zipline Tutorial local backtesting and finance with Python p.2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Visualizing Strategy Metrics - Zipline Tutorial local backtesting and finance with Python p.2</b></h2><h5 class="post__date">2018-05-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/GJJzsfJUiB8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody and welcome to
the second part of the zipline local
tutorial miniseries for back testing and
doing Finance with Pawnee thon in last
tutorial what we did was we just went
through the arduous process of getting
zipline running on our machine running
through a simple just by Apple strategy
and we got to this point where we ran
the strategy and we can see that it's
making some output and no matter which
way you run it you got we at least said
the output should go to strat pickle so
what do we do at this point so at least
now if you run it via the magic here you
do get the output saved to this apparent
data frame creates this table that I'm
telling you now is the data frame but
but this pryzen texaspeyton I just
missed it yeah there's other columns
here that we're just not seeing its
truncated it so anyway what can we do
what can we visualize what's here for us
already so the first thing that I'm
gonna go ahead and do is basically I've
already run this so I'm just filming
from the last part so if you need to
make sure you load the extension run the
algorithm again and all that I'm just
gonna continue on down here so what this
did at least in this the way that we ran
it this time I still have one more way
I'm going to show you guys how to run
things but I just figure information
overload overload so this saved our
strategy output to strata pickles so
what what could we do how could we read
from this well one option we have first
of all would be like let's go ahead and
import pandas as PD in fact let me see
about making this I don't make it too
crazy but I want it to be legible and
then let me go ahead and make some more
imports put this up towards the middle
so we're going to import pandas as PD
let's import matplotlib dot PI plot as
PLT from mat plot live let's go ahead
and import style and then we'll do a
style that use ggplot because we all
know in finance how beautiful your
charts are makes a huge difference
in your performance so the next thing
we're gonna say is I'm just gonna say
back test the F equals P d dot is it
what does it read pickle read pickle and
then specify the name of the pickle in
my case we output two strat dot pickle
so strat dot pickle so that reads in our
data frame and then we could do
something as simple as back test
underscore D F dots portfolio underscore
value dot plots
PLT dot show boom you can also plot in
line and then you don't have to call a
PL th show but I'm just always in the
habit of doing it this way so that's
what I'm gonna do it anyway
boom there's our performance awesome
looks like we do really well turns out
you do really well if you can just buy
10 shares of Apple every single day
without any respect to really anything
at all and you just have infinite money
anyway cool that did good
now you might be like well centex slow
down how did you know you could do
portfolio value well one option was you
could probably like look up here and be
like hmmm let's see if portfolio value
is even here I'm not seeing it but a lot
of times I'm just totally blind it might
be there anyway the way I knew about it
is what you could say is just now that
we've loaded back in that this data
frame and called it back test DF we can
just dot columns this bad boy and boom
so all of these things are things that
we can graph right now they're
automatically tracked except for AAPL we
added that so for example if there's
something else that you want to track in
your strategy as it goes besides all of
these columns right here if there is
something else just like on quanto peon
you can use the record function and
record it now on quanto peon there's a
limit of five i think you can only
record five things i'm not positive if
zipline locally is the same i would have
to imagine it's not but maybe it is I
don't know I would imagine you could
probably record infinite values though
but I really don't know the answer to
that someone feel free to comment below
if you know the answer we could just
record Apple a bunch I mean heck let's
just find it out
sorry for the live test but I'm actually
kind of curious because it's fairly
useful if you can record a bunch of
things at once okay cool
so that should run pretty quick yeah
nice so you can actually record a lot
more I'm pretty sure the limit on quanto
pian is is is five for record I kind of
want it I just want to confirm that I'm
sorry if you guys aren't really
interested I assume if you're watching
this you probably are at least somewhat
interested in this recording and
plotting variables up to five yeah so
quanto peein limits you to five zip line
doesn't which is good that only makes
sense I just want to just curious if
that followed through okay cool so
anyway I say kitten before we're dealing
with those so these are all the other
columns that you have if you want it to
when you were going you can do stuff you
can also just after the fact you could
make you can make calculations on this
data frame like you can define a new
column and you could say that new column
is equal to benchmark period return
minus algorithm period return or
something like that you can always do
stuff like that or really pry do
algorithm period minus benchmark period
but anyway yeah so like that would be
you can make those kind of like after
the fact calculations if you don't know
anything about pandas I'm sure I
mentioned this in the quanto peon series
but you can always just google pan or
well you google pandas if you want or
you go to Python program Internet just
type pandas up here and boom you'll find
this series so you just type pandas
search for that do the data analysis
with Python and pandas boom all the all
you could ever want to know about doing
stuff with pandas so anyway yeah so
that's one way that we can we can graph
things now the other thing is with doing
so like this is one way that we could do
visualization but there's another way
that we can actually do it so the other
way I just want to show briefly is I
think I might even just copy and paste
it really the way that I like doing it
so I think I'll just copy and paste it
from the text-based version so if you
want to do it this way you can do it
I'll explain why I don't really like it
but basically the only the only
difference is there's
analyze function here so this is just
kind of one of those built in front
functions that zipline looks for so you
could run analyze like that and again
we're just going to plot portfolio value
and then again we could run we could run
zipline again so I'll just come up where
is it
come up here copy paste oh did I run
this other I didn't run the other one
okay hold on
okay run that one run that one okay
hopefully this time it'll work how we
expect right so this time rather than
having to go to a separate little bid
and load back in the the the the pickle
this time it just all runs at the same
time and it outputs our data frame under
here if we want it to but in the analyze
function anything you put in here so if
you wanted to print out some values you
want to make some graphs you want to do
whatever you wanted to do you can do
that in the analyze function you could
upload your results to some sort of web
server you could anything you want to do
in the analyze function you can do it's
just gonna run at the very end it also
still is going to output to strata chol
so the reason why I don't really like
this is a lot of times when I'm done
with a performance I kind of tinker
around with the visualization of that
performance and in this case every time
you wanted to change every little thing
you'd have to run it again so for me at
least so far I've actually just been
doing it this way where I just output
and actually this is I'll show you the
the final way I typically run things but
yeah I tend to handle the visualization
as separate from the actual algorithm
itself but everyone's gonna probably be
a little different there so I just
wanted to show that so anyways that is
interacting now with the output that's
created via the performance of your
algorithm so from this point you should
be pretty comfortable doing anything
with zip line using the kind of the the
US markets at least via the quantal
bundle that you get from quanto peein
but i think a lot of people are really
more interested in using their own data
sets so in the next tutorial we're going
to talk about how you can basically
bring in your own data and then probably
it'll be one more tutorial after that
we'll talk about how you could
your own data for custom markets - so
anyways that's what we're going to be
doing in the coming tutorials if you
like the content Python program it slash
support questions comments concerns
suggestions whatever feel free to
leaving them below otherwise I will see
you in the next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>