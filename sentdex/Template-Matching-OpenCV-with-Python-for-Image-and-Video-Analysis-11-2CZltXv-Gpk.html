<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Template Matching - OpenCV with Python for Image and Video Analysis 11 | Coder Coacher - Coaching Coders</title><meta content="Template Matching - OpenCV with Python for Image and Video Analysis 11 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Template Matching - OpenCV with Python for Image and Video Analysis 11</b></h2><h5 class="post__date">2016-01-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2CZltXv-Gpk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to
another open CV with Python tutorial in
this tutorial we're gonna be talking
about template matching within open CVS
so basically the idea here is you've
gotten an image and you've got a
template like for example the images
that we're going to use are here the the
template here is that image to the right
those small image to the right and then
on the image that we're going to look
for this template in is on the left now
this is just one copy of multiple
slightly different versions of that
exact template right it's that port on
the raspberry pi's going all down so the
idea is first of all we're ideally we
would match every single one of those
but we're probably not going to get it
with template matching so but the idea
is if you if you had maybe one thing
that has like exact templates all the
time is gooeys so every time you use a
GUI chances are that the way it looks
every time like this file button always
looks like this every single time it
looks like that the X out button every
single time lucious like that so if your
problem is something that has a on just
you know you just need to make a perfect
match or a close match like an 80% match
then this is going to solve your
problems no problem so I've got those
two these two images here feel free to
take your own image and hopefully you
have like multiple objects that are very
very similar like almost identical if
you don't use this image this one this
is one of those times where it's
probably useful to use my images because
it is a good image but if you have one
that's like that where you've got
multiple copies of the same one yet only
one small image of that that template
that you can use just to see how many
you hit go for it so we'll start off by
importing cb2 and numpy is NP oh and if
you don't have those images I know I
keep saying it so I'm sure some people
come in like Midway all the code for all
these tutorials is posted on Python
programming net so if you're viewing
this video that means the code is live
on that
site go there and you can get these two
images from there if you need them so as
well as the code and all that so the
first thing we're going to do is we're
going to bring in basically our image in
our templates so first we're going to
bring in our image so we're going to say
image underscore really it's BGR let's
say image BG r equals C V 2 m Reed and
we're going to read in open CV - 10
plate
- matching - Python this is a long image
JVG feel free to rename that image is
something better and then image gray
equals CV to convert color we've really
done this quite a few times image BGR
and we convert that to CV to color owner
score BG r - gray then we load in our
template our template is equal to CB -
dot M Reed and then that whatever your
template happens to be mine is open CV
template for - matching jpg um and we're
going to load this in a 0 that should be
the default oh now wit comma height is
equal to template dot shape and this is
just a way to get the shape or the width
and height now um so we've got both
images here and what we're going to do
now is first we're going to have our
results so we're going to say the
results equals CB - dot match template
and we're going to match the template of
image gray template and then this is
just what we're going to use to make
that match basically TM coefficient or I
think it's CC o FF underscore normed so
that will make our match
Chiz and then we're going to say the
thresholds for this we'll use 0.8 for
now so like 80% and then the question is
location equals NP where and then where
the results is greater than or equal to
our threshold and then now we're going
to mark all these on the actual picture
so for the basically the point in zip
and this is for basically all of our
locations : : negative one we're going
to draw a rectangle so see v2 dot
rectangle and we're going to rectangle
and we're going to draw that on image
underscore BG are the point itself and
then we are going to basically this is
going to be some dynamic code here the
point 0 plus that width which is right
here so it's that the shape basically of
our template because we know the
template that we're using anyways and
the match in the image are going to be
about the same height so that and then
PT 1 plus the height and now we're going
to color that mark basically or that
rectangle will make it yellow and then
the line thickness there it will be a 2
and then when we're all said done we
will see V 2 dot M so we'll call this
detected and we'll show it on image BGR
and then when we're all done um well
yeah let's just go ahead and show what
we find up threshold threshold is the
typo threshold initially yes I sure did
two H's damn true
okay so here we have our matches right
we got one two three and four matches
which is pretty good because we had one
template that we were working off of so
as you can see these are slowly getting
smaller and then we got these that are
very much smaller and have less light
reflection at the tip of the
but what's going to happen what if we
want okay we lower the threshold right
like let's try to get some more well we
sure enough got more but then we wound
up getting a bunch of other stuff that
we didn't really want at all like what I
don't even know how that's related but
it apparently is related so so anyways
um you you you probably instead of
lowering your threshold every time
probably what you would do that would
work better so as you can see actually
these first four detected and then any
further basically detects out here in
the in the boondocks I don't know why
anyway um as you instead of lowering the
threshold a bunch like you might want to
threshold more of like 0.9 yeah and then
you would maybe take images like take an
image of this one here and call that a
Thresh or use that as a template rather
and so on like have multiple copies of a
template that way when you go to match
it you can be a little more um confident
in your matches that are made yet a
little more accurate because you'll get
more matches so anyway keep that in mind
because that might end up being a little
more useful now in the next tutorial or
me talking about is foreground
extraction in a slightly manual way so
if you kind of know what where your
foreground is you can just kind of
automatically detect what's in that
region what is actually the foreground
and what is not actually the foreground
based on based on a region that you kind
of specifies so that's we're going to be
talking about in the next tutorial
meanwhile if you have any questions
comments concerns whatever about this
tutorial feel free to leave them below
it's relatively straightforward though
basically we're just matching anything
that looks like this template right so
doesn't get too much easier than that
but anyways if you do have questions
comments whatever maybe I've I went over
something too fast leaving below
otherwise until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>