<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Finding more Alpha Factors - Algorithmic Trading with Python and Quantopian p. 10 | Coder Coacher - Coaching Coders</title><meta content="Finding more Alpha Factors - Algorithmic Trading with Python and Quantopian p. 10 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Finding more Alpha Factors - Algorithmic Trading with Python and Quantopian p. 10</b></h2><h5 class="post__date">2017-02-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/DzbAnZsmyc0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to
part 10 of our algorithm with Python and
quanto bian tutorial series in this
video we kind of in the previous video
we already kind of talked about what our
plan is here we are going to be looking
to see if we can find a few more alpha
factors that we can combine together so
let's get started so first of all I'm
gonna be starting blank I just made this
so I can scroll down easily also I'm
going to bump that up
I can even more space all right so it's
gonna be pretty much identical code to
what we had before I'm choosing to start
a new notebook purely because the other
notebook had a lot of example things and
just things I was showing you so it's
kind of cluttered whereas here this is
kind of something that I expect that you
could you can follow along and then on
your own you can really quickly and
easily change out alpha factors and test
them and then same thing with the
notebook when we go to combine them you
can have two notebooks you can have one
that just kind of looks through single
alphas and then another notebook that
you can quickly just paste in those
those single alphas that you liked and
then really check that new combined
alpha factor so anyways let's get
started so this one I'm just calling
well I called it alpha checker so this
just checks a single alpha so now we're
gonna do is first of all import all the
things that we need so we're going to
from quanto peon pipeline we're going to
import the pipeline and then from cuanto
peon dot research we're going to import
run pipeline and then we're gonna grab
that for a universe selection we're just
gonna stay super simple we're gonna say
from quant opium dots pipeline dot
filters we're going to import actually
dot Morningstar filters dot Morningstar
we're gonna import the Q 1500 us don't
forget you can also do Q 500 us which
would be even more liquid stock
suggested like if you're gonna do super
high frequency trading it's probably
wise to go with that anyway next we're
going to do is from corn toby in dot
pipeline dot data dot syntax we're going
to import sentiment we're not
we're not really gonna actually in fact
in this one we don't really need it but
we're gonna copy the code from here to a
new notebook anyway but we're going to
keep sentiment around because soon we're
going to be using it in a combination
factor so we'll just keep it there and
then we're gonna say from quanto point
opium pipeline dot data dot Morningstar
we're going to import some fundamentals
now in the documentation it does at
least make clear to find fundamentals
you just go to slash help slash
fundamentals but then from this point
it's a little unclear it's just
definitely not explicit how you're
supposed to use these from here so so
for example if you wanted to use asset
class something from asset
classification you would from that
morning start you import asset
underscore asset or under lower case
asset classification with an underscore
as the space so for example you would
say from there you're going to import
asset underscore classic classification
okay and then in asset classification
let's say you wanted to use something
let's just go with financial health
grade you would simply do you know asset
classification died financial health
grade and then if you wanted the latest
dot latest okay so there's that now the
other thing that I think I'm not sure if
I made it totally clear also when I use
that kind of alpha lens example one
thing I think isn't necessarily unless I
missed it
one thing that's not necessarily made
totally clear here is how should you go
about finding single alphas and also
alpha combination and I think kind of a
missing piece that a lot of people might
have is you want to be able to you want
to be able to explain to somebody why
you've used what you you you have used
and you don't want to say I tried 500
things and these two worked out right
you want to have like a good reason
behind it and I know that quant opine
has pushed that logic elsewhere I just
don't see it here this is a post for
alpha line so I totally understand it's
not there I'm just saying that in this
like breakdown that I keep
differencing it doesn't quite clarify
that one so you want to just have a good
reason now for me I like the idea of one
I like the idea of using fundamental
information to kind of predict future
performance of companies that doesn't
necessarily mean that the performance of
the company is always going to be
perfectly tied to the stock price but I
think it's at least going to be close so
so I already come with that reasoning
now also someone who runs their own
online businesses and sometimes I've
even sold physical things I know that
one thing that just makes business just
easier to be successful is having a good
profit margin there were times in my
life where I thought what you want to do
is pry something as cheap as possible to
get as many buyers right as Steve Jobs
would say price it cheap go for volume
although Steve Jobs even though he said
that Apple actually had great margins so
so okay so but anyway some people
actually listen to him and think that
okay let's get is really truly smaller
margins as possible so so for me my my
logic is that okay if you're a business
that has very large margins like profit
margins and stuff so like basically
let's say you buy a shirt for five
dollars and you can sell it for twenty
five dollars that's a huge profit margin
it's it's it's pretty hard to mess that
up okay but one way you can't mess that
up is by simply not having customers to
buy that overpriced shirt okay so if you
can't find somebody who's willing to buy
that shirt for let's say you've you know
because that's a huge margin but if you
don't have customers that are willing to
pay $25 for that shirt for whatever
reason then you're no good right so you
not only do you need a large margin you
need people to buy your stuff so the two
things I want to look at is I like the
idea of operation ratios income
statements good but to me this is too
late
like why the time you get the income
statement it's just too late unless you
can unless you can predict in advance
that the the return basically like for
the quarterly earnings or something
unless you can predict that the
quarterly earnings are not going to be
what people are expecting them to be
then you know that that's a useful
information but for the most part I
think al good a good thing to start with
is usually going to be operation ratios
so I may be looking for two things
margin and then with just anything that
that suggests to me that we've got
customers so for example we could go
with something like net margin we could
go with operation margin which I think
will go with probably operation margin I
don't know we'll keep looking and then
we'll go with revenue growth I like that
that's a good good measure I guess of
customers yeah so
so first let's let's start by checking
start by checking like revenue growth so
we'll come back to our research we've
got instead we're going to do operation
underscore margin operate is that
operation version present ratio there we
go I'm really stuck on I'm really stuck
on using the the margin stuff okay so
okay we've got this information so far
now what we're gonna do is actually
build that pipeline so we're gonna say
define make underscore pipeline and then
we're gonna say testing underscore
factor now that a couple things you
could you can name this something like
useful if you want but like I was saying
I kind of like the idea of using a
skeleton alpha checker to the point
where you can it just change what you
imported change the factor itself and
basically change nothing else and then
quickly get the use alpha lens and find
out information so so I just try to use
kind of a generic name there so testing
factor equals and then we're gonna go
with operation under Sport ratio
operation right I bet it's race yeah
ratio with an S and then make sure you
fix that up there if you did what I did
operation ratios dot revving
underscore group growth dot latest so
that's our factor now let's define the
universe that we're willing to consider
so we're gonna say the universe is equal
to the Q 15 1,500 us
don't forget the parentheses there I've
made that mistake a billion times and
we're testing factor dot not null so
just we're either the company we're both
the company's in the Q 1500 or the Q 500
don't forget that one exists and we have
a value for the operation ratio so we
want that now what we're going to do is
we're say testing underscore factor is
equal to testing underscore factor dot
rank and you could just leave this but
we're gonna say first of all we're gonna
have the mask of the universe universe
and then we're gonna say methods equals
we're gonna a bridge so this will this
will rank our revenue growth remember
what I said you need your to pass
through alpha lens and to work the way
you want it to you want to make sure
that the factor that you pass to alpha
lens is ranked from bad to good so in
the case of revenue growth that's good
right the the lower number is already
bad and the high number is already good
we don't have to flip anything I
wouldn't have to do standard deviation
from a mean or anything like that we're
happy so we'll keep that there just
noting that there are going to be some
factors you're gonna have to finagle a
little bit now we're gonna do pipe is
going to be equal to a pipeline object
the columns or just have one column here
for now we're gonna say we'll call it
literally testing an underscore factor
again so we don't have to like if we
change the the factor we'd have to go
and rename every little thing because
again this is for testing purposes so
the column will be testing factor
nothing new there we'll say the screen
is unique
and then return the pipe and then I like
to say like I just put it all in this
one cell basically result is able to run
run run there we go
run pipeline what pipeline do we want to
run and make pipeline don't forget your
parentheses then we're gonna say these
start start date is equal to and we'll
use this that same actually that would
be the other way around I see 2015
January 1st America that's how we like
to do our date start date is equal to
now 2016 oh one oh there we go alright
it's hard for me man so there we have
our result now all we're going to change
how we're going to do now is just result
that head so we can see if everything
looks as we would expect hopefully no
errors let's do it Oh keyword argument
oh okay I don't know how I made that
mistake end equals date let's try again
you're killing me did we not let C dot
rank methods test factor dot rank
I think that's valid why are you telling
me this
let's see testing factor equals and
we've already done testing factor there
what do you got method oh let's see
method I guess I should have read this
the air and method equals average
all right it's taking a while so I'm
assuming it's gonna work I'm gonna pause
this while we wait for this this can
kind of take a while so I'm just gonna
pause and then I'll redo so I suggest
you pause the video as well while you
wait okay and we are back we've got the
data here looks good now we're ready to
continue along we'll probably have
another pause here I'll explain why I
didn't put it all in one in a second so
now what we're gonna say is assets
equals and again don't forget you've got
you know date and then you've got you've
got two indexes here you've got date and
then the actual tickers for companies so
assets will be equal to result dot index
dot levels and you want the first tooth
which is actually the second dot unique
and then we're gonna say assets actually
pricing is going to be equal to get
pricing for what we want assets start
date and end date I'm just going to take
this copy paste and then change this
between 14 12:01 is fine and then
December or February first and then also
before we run that let's do one assets
just to make sure we've got a large
number here you wouldn't want to
suddenly factor this down to like 20
companies or something so we'll get the
length of the assets I'm gonna run this
and again this might take a while okay
I wonder if I'll be able to get through
this without any errors assets two
commas there for some reason try again
alright it's taking a while someone
assume it's gonna work also the reason I
split this up with this is for some
reason I don't know I'm still trying to
figure it out
sometimes the the notebook hangs and I
find that it hangs anytime if if you try
to combine too many very large
operations
it just it hangs and I don't know what
to do about that so I find that it's
best to split up any heavy lifting into
separate cells I don't know if there's
any truth to that maybe it's just taking
longer but I feel like like this takes
about a minute half this takes about a
minute and a half sometimes but I've
waited for like 10 or 15 minutes and
nothing
happen so I just split them up and I
don't have that problem so anyways I'm
gonna pause while we wait on this and
then we'll run alpha ones and see where
we are all right and we are back we've
got the pricing assets we've got 1734
assets that's quite a few one question
that might pop into your head as soon as
you see that number is wait a second it
shouldn't it be smaller than Q 1500 well
Q 1500 is a value that in theory should
be changing every night so so as
companies come in and out they'll still
be in our and our you know total result
for a whole year but it doesn't mean
each of those one thousand for sure
shouldn't be each of those one thousand
seven one three of our companies are in
our trading universe of every day okay
so so that's why that numbers large now
we're ready to run alpha 1 so let's go
ahead and import alpha lens and then we
are going to alpha lens dot
tears create factor tear sheet and we're
going to say the factor is going to be
results whatever our testing factor is
this is why we didn't want to have to
like rename them every time that would
have been really annoying
prices will be pricing will say
quantiles is equal to 3 or we could even
do two I'm trying to say which way I
want to go we can really run both this
is this one this operation isn't very
slow and then periods we could do like
let's do I'm kind of interested to see
like further out like let's do like
three five and there maybe like three
ten and thirty I'm curious to see a much
larger and this needs to be a to go
let's fix that
oh you cut my other one there we go
alright so you wouldn't get no errors
no attribute index let's see what do we
do factor price is pricing quantiles
periods where's their quantiles alpha
let's tears factor was a little testing
factor
terral's try to read this air this is
not a clear error oh you know we Dow mmm
okay let's see okay so what we really
forgot was the column so we should have
had fields equals you know like open
price I'm pretty sure that's what it is
I wonder if we this should probably be a
dataframe
let's find out whoops
if not we'll have to go back so I'm just
gonna I'm gonna just leave that there so
the next time I run this hopefully won't
have this issue and then we'll remove
this but we'll see oh it works okay so
alpha is looking good betas looking good
root alpha we'd like it to be higher but
that's one of our best alphas although
this is a much you know further out time
frame so but yeah so good looking alpha
information coefficient good it's higher
than 0.01 so very nice looking good
looking good so yeah we can see here
that you know probably we can separate
this out into two quantiles instead but
again here you can see these these ones
are this is looking like a good alpha
factor i must know so much about
business that's a lot of drawdown there
don't like that but yeah looking here
who yes I can't so like for example this
might actually combine really well with
sentiment because with the sentiment we
actually I think we started off really
weak and then we ended really strong and
then here you can see we're starting off
pretty strong and ending weak so those
two should mix pretty well I'm kind of
excited about trying these two and this
is weird
why would how would that be the case how
is that the case when you got this which
is clearly positive if you come down
here
this makes no sense to me why would this
be the case if someone has an answer to
that one let me know because this stuff
is very clearly positive what the hell
why would all of them go down at that
point and I said this is just saying the
same thing here that yellow is really
hard to see on my monitor that's so
weird because we did well but then here
this crap
there's got to be a bug or something
it's gotta be a bug but if this one it
someone let me know like who you can
click on it interesting anyway um you
know that's a bugger I'm missing
something because this otherwise looks
really good in these other charts if
someone knows what's up there let me
know I think I might I'm gonna have to
ask somebody about that one okay
so let's change quantiles of two though
I'm glad this worked so if you make that
mistake that way don't like pull the
prices again so that takes like 17 years
and while we wait on that I just look at
you I want to just check those other two
factors real quick everything else is
looking pretty good though we didn't
like changing these two just to
quantiles didn't really seem to kill us
come on that plot Lib
let's go oh yeah that's looking great oh
look at this this is so this is good
this looks really good why how is it
that we're messing up and like all these
good good good good good
what happened why is this go down okay
alright whatever I'm just now I'm gonna
go ahead and just assume something's
wrong there so whatever the show must go
on
so let me we're gonna remove this open
price and we're gonna remove fields here
we're going to test one more alpha and
then we'll we'll cut to a new another
video so it's probably getting pretty
long so the other operation ratio let's
what are we using
we're working on ok revenue growth
operation margin let's go with that
refers to the ratio of operating income
to revenue that's a really that's good
we'll go with that margin sounds good
operation margin so now we're gonna
check let's just note that we liked this
yes and then we're gonna change revenue
growth to operation underscore margin
and then I'm gonna run both of these I'm
gonna run the the pipeline and then why
is pricing still not did I for some
reason I must have removed this don't
forget fields equals open price and yeah
so I'm gonna run both of these so I'm
gonna pause and run the pipeline
information pricing information and then
I'll come back before we run alpha lens
so you do the same I'll see you in a few
minutes all right and we are back again
I already ran the pipeline and pricing
information now I'm just gonna run for
alpha limbs like I said this one's
usually pretty quick so just figure out
wait and come back to that
so basically hopefully hopefully we'll
just have an A+ alpha it would also be
interesting to see if if we can get
somewhere in between the kind of sent X
which kind of stunk at the beginning and
did really well at the end and then this
the other one which was the revenue
growth did really good theater at the
beginning and then kind of gave it all
back at the end so I kind of feel like
it's gonna be at least that one's gonna
be a good balance but this one looks
like it's very much like the sentiment
so alpha 0.05 pretty good beta is mu bit
is very close to being not what we want
but it's it's still in the bounds so
we'll go for it plus our other ones were
pretty much perfect so
I the information coefficient is within
what we want looks great
not as good as the other one but that's
okay we're hoping that basically by
combining a bunch of different factors
we can kind of start to eliminate these
issues but part of me is almost
wondering if we shouldn't combine this
one because I think the sentiment factor
was very similar to this in terms of the
returns but it might not be in the same
ways you probably not in this one but in
a coming video we'll talk about a better
way to compare alpha factors then just
look looking at the performance graph
because that's not good enough so I'll
talk about that later so I'll keep it in
just even though yeah it's basically
they're at least performance wise seems
to perform very similarly to the
sentiment but we'll test it this will be
great for us to kind of test and see and
in a future video why either this is
fine or this isn't anyway coming on down
we can see yet yet again this is this
this doesn't make any sense to me when
clearly here it's fine here it's 9:00
and then also up here it's fine but this
is saying no it's not what's going on
okay anyway cool so we're gonna say
we're happy with these these factors and
then and like I said look I've been
trying to do it just like let's try to
keep it as simple as possible and just
add like a few extra things at a time so
we're gonna definitely use this to for
sure check against sentiment in a later
video I've been meaning of been hoping
to kind of find something that will be
similar and this is pretty perfect so in
a future video we'll talk about how to
really check your alpha factors for
basically correlation but for now let's
say okay we're happy we're gonna go with
basically all of this yes to this this
and the sentiment so we're gonna go with
these
we're gonna go with revenue growth
operation margin and sentiment and the
question is when we combine all these
you know what what changes basically so
now in the next tutorial what we'll do
is we'll slightly modify this pipeline
to no longer be checking for one alpha
factor but actually checking the
combination of these alpha factors into
one alpha factor how do we do and then
we'll back tests and all that so that's
what you guys have to look forward to if
you have questions comments concerns
errors whatever let me know below
otherwise I will see you in the next
tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>