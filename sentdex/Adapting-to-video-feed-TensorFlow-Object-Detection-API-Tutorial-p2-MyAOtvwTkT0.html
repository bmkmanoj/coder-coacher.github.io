<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Adapting to video feed - TensorFlow Object Detection API Tutorial p.2 | Coder Coacher - Coaching Coders</title><meta content="Adapting to video feed - TensorFlow Object Detection API Tutorial p.2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Adapting to video feed - TensorFlow Object Detection API Tutorial p.2</b></h2><h5 class="post__date">2017-08-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/MyAOtvwTkT0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody and welcome
to part two of the tensor flow objects
detection API tutorial in this video
we're going to be showing you guys is
how we can do something a little more
custom than just loading in simple
images we can also load in video or what
I'm going to be doing here is using a
webcam if you are not familiar with
OpenCV which is what we're going to be
using you can just come to Python
program Annette search for OpenCV and
it'll be this series here and then
coming down to part two is where we're
actually going to be loading in from a
webcam source but you can also load in a
an actual like video file if you don't
have a webcam or whatever so anyway this
is just to show you how quick the video
detection actually is at least on a GPU
and then also how do you how to start to
adapt this code to something you might
actually want to use it with so anyway
minimizing this I'm going to come over
here and the first thing I want to do is
I'm going to convert that notebook to a
Python file so I'm just going to do
Jupiter notebook and if you want to keep
it in Jupiter by all means keep in
Jupiter and I just want to convert it
myself
where are you so if you want to convert
it file download as Python and then I'm
going to do underscore ver did good and
I'm actually I'll sit here
I'm going to edit this also if you need
to install OpenCV or whatever I'm you
can use that tutorial series so if you
don't have it already installed pause
this and go to the tutorial and make
sure you install cb2 okay so now I will
go ahead and do is first of all we need
to import CBT so we're going to do
import CD not an all capstone for cb2
and then we're going to say the capture
is C v2 dot video capture and if you
just have one webcam it would be 0 I'm
using one of my webcam to record me
right now so I'm actually going to use
my first it cam or my second webcam
basically so that's why I'm putting that
in there but if you're following along
and you have a webcam I would put in 0
so so now that we have that the other
thing we need to do is basically I'm
going to come down here and I'm just
going to get rid of this because that's
not what we're going to what I'm going
to use matplotlib anymore to show
anything and then also if there's
anything else we need to get rid of so
this matte pot lid line we don't need
that either so I'm just going to leave
that as well so that was the line just
give that was too quick it's like this
get ipython magic stuff just delete that
because that's not that's unnecessary as
well okay so once we've got the video
all we're going to do is we're going to
head down to that basically main loop
area so scrolling down into here like
basically this for loop is that main
loop area and what it was doing was
iterating through images in a directory
but instead we could actually just have
it iterate or not even iterate but just
go through the frames from a webcam or
iterate through frames in the video or
whatever so we're going to be using the
webcam so and so what I'm going to do is
I'm going to save Wow
true and then what are we going to do
well it rather than this this image
being image equals image that open and
then converting it to an umpire array
and all that I'm actually going to
delete this and we're just going to say
ret comma which is just return
information and then image underscore n
P equals cap dot read because this is
going to come back already as an umpire
we don't have to have to convert it so
once we've done that now we're ready to
just basically come down here and let's
actually visualize it so again the only
changes we're making is just right here
with the images I mean we could probably
delete all this stuff and this too but
I'm not going to really clean it up too
much but you could clean it up a little
bit more but these are just the simple
changes that we're going to need to make
just to get this to work
so let's actually show this so we're
going to do CV to M show and we're just
going to call it object protection you
can call the window this is what the
window name is you know whatever you
want and then we're going to do is CBT
re-size just to make sure it fits I'm
not sure I think this would display
based on like the default camera
resolution I don't really know what it
is I just know it's it's it's not a 16
by 9 aspect ratio so anyway I'm just
going to use 800 by 600 so it's not
distorted and it's not too large to show
on video and then what we're going to do
is we just throw in this little bit of
code basically this is weight key 25 and
0xff equals or 2 so what this is saying
is basically if we exit out the window
or rather actually if we just press the
if we just press Q will exit and
actually I think we can get away with
just having this weight key here but
we'll go ahead and use for the Q as well
so you can press cute it closed
basically what we're doing anyway cv to
not destroy all windows camelcase
if that's the case and then break and if
you don't have this code here for
whatever reason it's kind of surprising
to me I don't know exactly how that
works in the back end but basically if
you don't have this killed here it won't
actually keep iterating so it's kind of
weird because this is only here for if
you want to like break the entire like
running of this loop but if you don't
have this if check here
it just won't iterate so I'm not really
sure why that why that works that way
but it does someone can comment below
and educate me why that how that works
on OpenCV then
maybe it's really obvious I'm just
missing it anyway I hit run
well I pressed at five anyway and it's
just going to take a little bit for
everything to kind of load up it's got a
load into the model and get the GPU
version of sensor flow going but once it
does it'll pop up and then I can kind of
show you guys some examples of objects
being detected I'm gonna go ahead and
pause it while we wait it shouldn't take
too much longer but I won't waste any
base time yep it was just a second
longer but anyway here it is and it
looks like I did not camelcase wait key
what amateur this alright running again
pausing was some reason I swear it
oh my caps lock is on okay really camel
casing pausing again alright
so it is ready it's detecting a person
on top of my shelf they're not very good
and my dogs are barking lovely anyways
show must go on so okay it is running
and like I was saying before um you know
the frames per second it's not like it's
doing like 60 but it's probably like 15
to 20 which is actually pretty good for
like a running stream of detection and
with you know all the objects it's
detecting here I mean I know the least
here the list is 90 but I think actually
pull like the whole Coco like common
objects in context I think it's 300 but
I'm not positive it might be 90 but
anyways there's a lot of possible
objects well anyway just for an example
we've got person here which is correct
chair sometimes it calls it a couch yeah
but that means pretty close and I think
it just sees cushions but should be able
to do like a bottle mmm there we go
Oh apparently it's a wine glass it's a
bottle now anyway so you got a bottle um
probably do a phone my guess anyway yeah
cellphone so pretty cool anyway so
that's just one example adapting this
code to do something else something
other than just classifying images
because again to me classifying the
images isn't that exciting because we've
been able to do that with like the hog
plus SVM algorithm where as classifying
video at a decent frames per second is
a much a much more impressive task and
this does it really well and it's pretty
lightweight model and everything so this
is pretty cool
now I'm pressing Q in the future what
I'd like to do is I'll probably show
because I showed some code of basically
using this object detection algorithm to
basically create an aimbot and Grand
Theft Auto I'll probably do that but I
won't be including it in this series so
if you want to see that you can go to
the Python plays GTA series otherwise
the next thing I want to do in this
series is show how we can create our own
classifier or our own object basically
so there's a few things we could do we
could train our own object detection
algorithm completely and just train it
on one object or we can add this object
to an already pre-existing model or we
can use that models weights to at least
give us a head start on training a new
object so anyway that's the next thing
I'd like to cover with these this
attention law group detection API
because basically up to this point we
really haven't trained any model at all
we've just been using a pre trained
model which honestly there's so many
things we can do with that already but
there's still a little bit more that we
can get out of this object detection API
so I definitely want to show that as
well so anyways if you have any
questions comments concerns whatever
feel free to leave them below otherwise
I will see you in the next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>