<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Haar Cascade Object Detection Face &amp; Eye - OpenCV with Python for Image and Video Analysis 16 | Coder Coacher - Coaching Coders</title><meta content="Haar Cascade Object Detection Face &amp; Eye - OpenCV with Python for Image and Video Analysis 16 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Haar Cascade Object Detection Face &amp; Eye - OpenCV with Python for Image and Video Analysis 16</b></h2><h5 class="post__date">2016-01-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/88HdqNDQsEk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to
another open CV with Python tutorial in
this tutorial we're going to be talking
about object detection like face
detection or eye detection with open CV
and Python using har Cascades so to
start first we're going to just use some
hard Cascades in this tutorial I'll show
you how they work and then in the next
tutorial be quite a doozy
we'll talk about how to create hard
Cascades I'm going to try to get it all
in one video hopefully we won't take too
long but anyway onto this video I'll put
a link to this in the description if I
forget I really probably will forget to
put a link to this one in the
description let me know there will be a
link to the tutorial in the description
as well and then this link would be in
that tutorial now this is just a quick
kind of dump of various Cascades and the
way that these work these are hard
Cascades and the way they work is they
are massive XML files with a lot of
feature sets and these feature sets
correspond to a very specific type of
object in our case we might be looking
for a full-body this is a left eye so if
you had like a like a biometric scanner
you could scan for like the you could
find the left eye and then begin the
scan anyway got bodies you got faces
you've got lower bodies you've got a
profile face like a profile picture
probably or something right I Russian
plates there's also probably an American
plate somewhere around here at front
well I don't know anyway so you can find
most of these and even if you can't find
it in this little tiny list you can find
horror Cascades for all kinds of things
like faces smiles cars license plates
try think of some other really common
ones but stuff like that you can just
find but a lot of times you might have
an object you want to track that you
can't find and that's what we'll talk
about next time till then we'll grab the
eye and let's get the frontal face
default so these two files
go ahead and take these files download
them
just take note these are licensed to
Intel so make sure you understand the
license before you go using these you
know commercially and stuff so take
these two Cascades download them put
them in your in to download I'm you
going to probably you just go to raw
right click save as
okay save them to where you're working
both of these and then you're ready to
go and here I'm going to show you how
they work so to start you're going to
want to have numpy as MP and CV to
imported and now we're going to define
the two Cascades we're going to face
Cascade equals and this will just be the
loading of that cascade so it'll be CV
to cascade classifier classifier and
then we load in that cascade which was
har cascade underscore front sole
frontal underscore our exes on on short
frontal face underscore default dot H
XML HTML anyway a face cascade was that
and then now we're going to say to i
underscore cascade and that file uh was
let's see horror cascade i dot xml so
those are your two the two cascades that
you want make sure that horror cascade
was actually called yeah just har
cascade underscore i alright so those
are your two cascades they're loaded in
now let's go ahead and load in our
webcam so cap equal cv to that video
capture and as usual from the rest of
this series you'll probably use a zero
to bring in your camera feed i'm going
to use a one because my first camera is
being used
so there's your capture and then now
what we're going to do is we're going to
say wow true what do we want to do or
say ret image equals capped read we're
going to convert it to gray and
immediately solar is a gray equals cv to
convert color image cv 2 dots color
underscore BG r to gray now we're going
to say the faces here are going to equal
to face on our score cascade dot detect
multi scale and then we're going to
detect on gray and then we're going to
say we're knees one point three and five
we can talk about these probably later
just you can use these basically it's
going to be depending on the size of the
image you use and the likelihood that
you might find it in your image you
would you would change these up but
we're going to just use these figures
for now and we'll in the next tutorial
we'll probably get far more in depth
into that then so faces will be found
and then we're going to say for X Y
width height in faces we want to just
draw a rectangle so we're gonna say C v2
dot rectangle will draw it on the image
the starting point will be X Y the the
ending point of the rectangle will be X
plus W and then y plus h so to draw a
rectangle again you've got the starting
point then you've got the ending point
okay and so this is just how we're
calculating those points we're going to
make this a blue rectangle so 255 0 0
and the line width will be 2 and then um
we will we probably get away with just
drawing just that but what's going to
happen is in faces you probably want to
do like you don't want to find eyes
outside of a face right let's press bad
news Xena but but even even if even
thinking about it
and I will never be out of a face unless
it's an eyeball and in that case the
features that determine and I are not
going to recognize an eyeball most
likely because what
and I like your eyebrows will will come
into effect your eye lids and your
lashes and all that kind of stuff so
morbidity aside you're not going to find
eyes outside of the face so so but we
will find eyes hopefully within the
region of the image that the face is in
so we're going to define ROI gray is
going to be equal to gray and then
basically that the location of the face
so we're going to say Y : y plus h and
then X : X plus W so this is just that
region set starting point and then
ending point and then the starting point
again and that ending point and oh and
with region of image it's you know why
then an X naught X Y so we've got that
and an ROI color for later on when we
reimpose it basically it is pretty much
this exact thing only image not great
image okay then eyes will be equal to
probably donate that extra space eyes
will be equal to the ion or cascade dot
detect multi scale and we're going to
detect against roi ray for our eyes and
then we'll just use defaults for now so
we could in theory we might even get
away with defaults in the faces but we
might find too many faces I don't know
we'll see
and then 4e x e y e w eh so I X I Y I
with night in eyes we're going to now
just simply at this point we just have
to draw it so we will do C v2 dot
rectangle we're going to draw it on the
ROI color and then it starts at E x ey
and stretches out to eat X plus e W and
then e y plus a
eh don't do that anyway and then the
color will do is 0 255 0 and then the
line width will be a 2 and then outside
of this silly for loop let's do CV to M
show image and image and then we're
going to say K equals CB 2 dot weight
key 30 and 0xf whoops f f FK equals 27
break this is just so we can press the X
key cap dot release when that happens
and then see me to dot destroy all
windows and let's run this bad boy
syntax error
ah I did this the last time why do I
keep doing it anyway okay so we've got
this camera running now I have to look
at it but you're probably my mouth
gatling moved this over actually date I
can't really move it and then you see it
because it's hanging over anyway so like
your eyes will be detected and hopefully
your face is detected now if I take off
my glasses it probably works a whole lot
better
so the glasses are just going to cause
problems just because they're like one
more thing on your face and then my
mouth is apparently also an eye with
this cascade so anyway there's that but
I think that's pretty cool that you can
detect a face and as at least for me it
is extremely efficient for objects
detection does not take much computing
to do it right it's going to use like
the HAR cascade itself is very small
let's see the the cascade here the face
is pretty big because it's hard to find
faces but so it's but it's not even that
big right it's 900
in kilobytes okay so so yeah it doesn't
take much memory to really load those
into RAM and be like looking for those
so that's pretty cool like it's just so
they're just so small yet they're so
powerful for detecting things so
naturally you would be inclined to want
to make your own Cascades because
chances are maybe you want to track some
something else maybe you want to track a
phone or glasses or microphone or just
anything like how would you even get
started tracking something well it turns
out you can make your own whore Cascades
but horror cascade creation can be hard
anyway um if you laughed I appreciate it
so that's what we're gonna be talking
about in the next tutorial is how we can
go about creating our very own whore
Cascades which is actually quite the
process but you can get through it it
can be done and once you do that you can
track any object like that is so cool so
that's we're gonna be talking about in
the next tutorial if you have questions
comment concern whatever oh you know
what actually before I kick you guys off
let me just try the defaults on this
face detection that's not a bad it finds
a face and it's not finding faces all
over my house but later on when we do
our own cat I'll just found some weird
faces there when we do our own horror
Cascade classifier you'll see that it's
very important that you throw something
in there and it's probably because our
Cascade is not going to be the greatest
because to make really nice hard
Cascades you need a lot of RAM a lot of
CPU and a lot of time
none of which we're really going to have
an Ellicott short tutorial so ours won't
be the greatest so we've got to have
some some stringent rules on it anyway
questions comments lean below otherwise
as always thanks for watching thanks for
all the support subscriptions and until
next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>