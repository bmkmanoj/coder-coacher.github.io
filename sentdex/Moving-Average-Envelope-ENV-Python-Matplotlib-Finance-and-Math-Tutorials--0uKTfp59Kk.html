<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Moving Average Envelope (ENV) : Python Matplotlib Finance and Math Tutorials | Coder Coacher - Coaching Coders</title><meta content="Moving Average Envelope (ENV) : Python Matplotlib Finance and Math Tutorials - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Moving Average Envelope (ENV) : Python Matplotlib Finance and Math Tutorials</b></h2><h5 class="post__date">2013-12-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/-0uKTfp59Kk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">well everybody welcome to another Python
mathematics and Finance tutorial video
this video we're gonna be talking about
the moving average envelope this one's
pretty simple and simple enough to where
I can condense it all into one video so
first let me just show you guys this
envelope it looks a lot like maybe these
Keltner channels or Bollinger Bands so
let's take a look at let's look at
Toyota so here they are for Toyota it's
the actually being plotted here right on
price and so the idea of these is to you
know encapsulate price and you can find
when there's been you know like a
breakout like for example if we zoom in
to maybe this area here we can see where
price has broken out here and that's
obviously a very bullish indicator but
continues breaking out still bullish and
then finally here it breaks out now
we've got a bearish signal and again
bullish Bowl as well as bearish right so
these are actually pretty simple what
you're doing is you're just taking a
simple moving average and then you're
multiplying that simple moving or adding
you know maybe a quarter or even like a
quarter of a quarter times that simple
moving average you just plus that and
minus that to get the direction right so
that also it will adjust itself by
volatility right so like here you can
see it's you know not too volatile as
far as you know comparison it here is
how much price it's been swinging around
by right so the gap is much smaller here
than it is here it gets much wider so so
will automatically adjust and it's just
like I said it's like really really
simple and you can see it really comes
down here it gets really thin there and
then it comes back up again but anyway
very simple because it's just a simple
moving average and then you add like a
multiple of that simple moving average
to the simple moving average and boom
you've got yourself some channels so
yeah so let's go ahead and get into the
actual programming of this to do that
let's go to syntax calm the sample code
is in there's a link for it in the
description that should take you to here
just come up to the script and copy and
paste everything
scrip and then go to an empty Python
script and paste it in so I'll bring it
over here let me just fit it to scream
copy-paste and normally if you have been
following along everything gets done
right in here but for this video we're
not going to do that because we want to
plot it on that on the price right not
on that bottom axes so we're going to
come all the way up to basically here
and just hit enter like a bunch make
some space and then we're going to go
ahead and comment out these two lines
and because we've done that the legend
is going to like scream at us so do a
control F and in decimal box type in
legend and you'll find this little block
of code right here comment it all out so
it will go one two three and one two
three so now we don't have to worry
about those prices being shown all
that's going to come up now on that
middle axes is the candlestick next what
we want to do now is do this moving
average envelope so tab over a couple
times and we'll define env for envelope
and this is going to have two parameters
we're gonna pass through prices and a
time frame so whatever envelope time
frame we want it's gonna have it's gonna
generate three lines right so we need an
upper line equals empty a lower line
equals empty and then we want that
middle line and that'll be equal empty
as well for now then we're gonna be
using simple moving averages so I'm
gonna say SMAS
equals moving average whoops
prices time frame now moving average
we've already covered that in a previous
video so if you want to know more about
how calculated moving average check out
that video next get rid of that slash
next we want to say for each SMA in SMAS
what do we want to do well we're gonna
say upper line so ul s equals each SMA
plus and then in here you can put
whatever value you want 0.05 seems to
work pretty decent so we'll say 0.05
times each SMA so as you can imagine
that just adds a
little bit to the SMA right and that'll
kind of help us create these like gaps
right plus while it does that it's also
going to react to that simple moving
average depending on how much how fast
it's changing so that'll make the gap
either get wider or thinner and which is
also kind of an indication of volatility
change anyway next thing we want to do
is lower lines equals and this is going
to be the same thing only a minus so I'm
just going to copy and paste this line
and instead of adding you're subtracting
and then middle lines is just equal to
each SMA next we're going to say upper
line gotta pens upper lines lower line
dot append or lines and middle line up
and little eyes finally at the end once
we've exhausted this for loop what do we
want to do we want to return upper line
lower line middle line so that's that
now what we want to do is calm down
Twitter cool so now what we want to say
is upper line lower Lyme middle line
equals env right EMP and then prices
timeframe so we're gonna use close price
and a timeframe of ten so now all we
really need to do is a x1 dot plot and
we want to do date - SP : s is for a
starting point if you want to know more
about that check out the charting stocks
in python tutorial series
they upper line don't forget - SP : oops
- SP :
and in fact I'm just gonna copy and
paste X well in your mind we're gonna
copy and paste this whole function and
we want that line to be white
now I'm gonna copy and paste this whole
thing paste that twice bam bam and now
upper line cool lower line and then
middle line and that's really it we
should be able to plot this now I
believe
looks good let's do it here we go toast
octuple I'm trying of a stock we haven't
actually plotted yet it's like a
bajillion stocks and I just like you
never think of a reasonable let's do
just do it big for Big Lots alright so
obviously the lower indicator is empty
because that was kind of like the way we
left it so we could do other videos but
this one as we can see we did definitely
I really got it this one's obviously a
pretty volatile stock it's got a lot of
breaking out both on the top and the
bottom going on here quite the swinging
stock let me look at that
that's pretty interesting stock if you
could time those swings lots of money
made there anyway so that's Big Lots as
you can see that it did indeed work out
for us
got another one let's do got Google and
again so here's Google fit it over here
a lot of breaking out for Google as well
so if you happen to if you don't want to
see like so much like coz that's that's
really where the signal comes from is
where you have either a breakout on the
bottom or a breakout you know on the top
we're bearish and bullish breaking out
right so if you don't know you can
change that obviously about coming over
to your formula and say you wanted to
see like you only wanted like a little
like a solid breakout and that was the
only thing you'd be interested in you
would raise this number okay so let's
say 0.07 now now let's look at Google
again and see if we have just as many
our Big Lots probably another good one
to look at anyway you have a lot less
breaking out going on so if you wanted
to create like an algorithmic trading
system on this that said hey buy you
would get a lot less buy signals but
they'd probably be a little more solid
when it came to the buying signal itself
so like a good example of like the
trading system that people would build
off of this would be like right here
right so every time it breaks up out you
buy into it and then as soon as it comes
back in you would sell out of it and
then again you would have done the same
thing here but in
then you'd sold out right up here and
you know you would have made a decent
amount of profit there the real question
is did you make more profit on that
timeframe rather than just buying in
here and holding all the way till today
right and doing nothing so and probably
not you probably made more money holding
so anyway those are your moving average
envelopes pretty interesting very basic
and very easy to implement into any
basically any trading system and also as
far as like breakouts are concerned and
buying you know you could just strictly
calculate that upper line and every time
price exceeded that upper line that
would be a buy signal right and then you
would hold that until price got back
below that lower line sell signal and
you're good to go
so anyways that's going to conclude the
moving average envelope in fact that
kind of makes me want to save that idea
for later and maybe will will back test
the system of buying at you can use
machine learning to figure out the best
little line there or the best number to
multiply by anyway back test that idea
see how see if that actually works and
see if that does actually beat
buying and holding anyway ideas for the
future hopefully you guys enjoyed
hopefully you learned something new as
always thanks for watching thanks for
all the support and subscriptions until
the next video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>