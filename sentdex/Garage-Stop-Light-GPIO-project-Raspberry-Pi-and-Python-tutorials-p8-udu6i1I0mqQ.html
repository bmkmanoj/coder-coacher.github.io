<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Garage Stop Light GPIO project - Raspberry Pi and Python tutorials p.8 | Coder Coacher - Coaching Coders</title><meta content="Garage Stop Light GPIO project - Raspberry Pi and Python tutorials p.8 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Garage Stop Light GPIO project - Raspberry Pi and Python tutorials p.8</b></h2><h5 class="post__date">2017-04-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/udu6i1I0mqQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody and welcome
to part eight of the Raspberry Pi
tutorial video series in this tutorial
what we're gonna be doing is building a
garage stoplight putting together kind
of everything that we've learned up to
this point the idea of a garage
stoplight is to show green light when
you've got plenty of room to pull your
car forward in the garage and then turn
yellow if you approach kind of a fully
forward position and then red when you
should stop we're going to build this
with a Raspberry Pi and then we're just
going to use some distances we're not
actually going to use a real car of
course but you could if you wanted I
suppose so
first of all I've already kind of I've
already made all the connections we've
already done this once before we did
just an LED light we did just the
distance sensor now we're just combining
everything but should you want a diagram
I've made one for you it's beautiful
there it is there it is not a
professional wiring diagram but it's
easy enough I think to read so basically
everything you need should be here
double check my work compare it against
the actual you know Broadcom names
diagram and all that make sure I've done
everything right actually are those
going through the written version of
this tutorial I got an error with one of
the ground pins so can make a mistake so
double check my work okay so this is the
diagram that we're basically going to be
using here at the end of the day make
sure your grounds are correct
make sure your power is correct and then
do note that for example the trigger for
the business sensor is GPIO for the echo
is GPIO 18 the green light is 17 yellow
light is 27 and the red light is 22 and
then the grounds are in the various
ground positions again though make sure
you actually put it in a ground so
anyway move it along what we're going to
do to go from here is we're just going
to go ahead and just copy this and then
paste it and then we're going to just
rename it to garage light up pi
hopefully that worked yes there it is
little slow on the remote desktop I'm
doing this because we're going to kind
of make some changes to this file that I
really don't know how to do in the
editors sounds going to make fun of me
for Nano sure but I didn't know how to
do a block indent so yeah too bad so
anyway so what we're going to do first
is kind of modified this script so
lightly because basically what we want
to do is actually have a while loop
that's just constantly checking for
distances and then depending on whatever
that distance is adjust the lighting
accordingly so the first thing we're
going to do is at the top of this script
we're going to set warnings to false
GPIO dot set warnings to false and the
reason why we're going to do that is
because we are going to say GPIO clean
up now the reason why we're doing that
is because this is going to be in a
while true loop so we're going to break
the loop eventually and that's not going
so the pins will never get fully cleaned
up so we're just going to call cleanup
right away at the beginning of the
script we do want the set mode to be
GPIO BTM that's the same trigger echo
all the same and then starting basically
at this line here will we actually
output some information that's going to
be the beginning of the depth get
distance distance function and then
basically that is going to be the case
all the way we're going to remove this
cleanup because you want to be cleaning
up at every time because then if we
clean up at the end of this loop every
time we won't have the pin setups now a
theory you could actually reset up
everything and clear it every loop but
I'm not really seeing why that would be
a great idea so we're just going to have
that all over we could print the
distance I'm kind of torn whether or not
that's a good idea but I guess we could
print it out here that's fine and then
when we're done though let's return
distance now we're going to come down
here and then we could just do
Wow true we'll just say different equals
get distance and then let's do it time
not sleep 0.05 that should be more than
enough time to sleep but also give us
plenty of output from the sensor now
what we need to do is set up for the
actual colored pins so depending on what
the distance is we want to illuminate
one of the lights but not all of the
lights we could illuminate all the
lights if we wanted but we really just
want to do one at a time right now so
coming up to the top of the script we we
might do something like this like we
could say the green light is equal to
and if I recall that was pin 17 let's go
check though and make sure right so for
was for the distance sensor 17 is our
green light 27 would be the yellow and
22 will be the red so Green is 17 and
then we could we'll come down here and
then we could say define green light and
then we could do something like GPIO
output green and then GPIO dot hi all
right we can do something like that also
let's go ahead and set up that GPIO and
don't forget that so GPIO GPIO dot set
up green and green is a GPIO dot count
okay almost forgot to do that part
anyway we could do that and then we
could do that for each of the lights
right just output that color the problem
is that light would never turn off so
what we want to do is for each of the
lights we're going to say that one light
is on but then the other lights are off
so what we're going to do now is we're
going to go ahead and add in all the
other colors for the lights so we're
gonna have green yellow and red so we'll
come up here green yellow equals and
yellow was 27 red was 22 and then we're
going to set up the colors here so I'm
just going to copy that line paste pay
green yellow and red and then we're
going to say down here for green light
let's copy this paste paste and rather
than hi they're going to be low the
other ones and then this would be yellow
red and then we can take this function
copy paste paste so we've got all the
lights now so green light well we don't
have them but we're about two three
light yellow light red light so yellow
light this would be low yellow would be
high and then red would be low red light
would be green would be low but red
would be high okay then once we have
that now all we need to do is handle our
logic down here in this while loop so
while true we're grabbing the distance
but now what we also want to do is get
to here and then what we're going to
stay is basically if the distance if the
distance is let's just do greater than
or equal to and trying to think because
I've had this little box in front and
then I'm hoping to just be able to move
the box for for the illustrations anyway
I'm going to use nine so if the distance
is greater than or equal to nine three
we got plenty of space we're good to go
they're going to say oh if nine is
greater than distance but yet distance
is greater than six we're going to say
yellow light and then L if distance is
less than or equal to six red light
okay I think we're ready to run that so
let's go ahead and save that I'm not
sure if I want to run this in the remote
desktop because it's just so laggy like
look how long this is they feel like
move stuff
I guess we'll try and if this if this
lags for whatever reason I will just
we'll load up in the shell so f5 to run
okay invalid syntax what we got going on
oh this is so gross oh we forgot our
colons on the functions what a newb okay
well I doesn't fine but seriously Python
do we really need those : I mean come on
we're all about whitespace iPhone try
again oh my lord
okay is it possibly a underscores that I
forget the underscore maybe sit Oh No
step n warning all right let's try again
all right so we've got the distances
being printed out
okay so right now the light is red in
fact I can I think I can make this
better
all right so far enough back the light
is all green we're good to go
everything's happy and then yeah we move
the box forward yellow light and you can
even see the distances below and then
finally we get close enough and boom
it's red light all right pretty cool so
that's just a really quick example of
kind of tying a few of these things
together using some very basic sensors
like a distance sensor well basic sense
or like the distance sensor and then
just tying it with some LED lights
anyway that's it questions comments
leaving below otherwise I will see you
in another tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>