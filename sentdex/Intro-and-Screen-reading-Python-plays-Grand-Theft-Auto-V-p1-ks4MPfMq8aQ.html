<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Intro and Screen reading - Python plays Grand Theft Auto V p.1 | Coder Coacher - Coaching Coders</title><meta content="Intro and Screen reading - Python plays Grand Theft Auto V p.1 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Intro and Screen reading - Python plays Grand Theft Auto V p.1</b></h2><h5 class="post__date">2017-04-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ks4MPfMq8aQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody and welcome to
a Python plays gta5 tutorial series so
in the series what we're going to be
doing is just simply exploring the open
world of Grand Theft Auto with Python
seeing what we can come up with and what
we can do the truth is I really don't
know the only thing I've done for this
entire series is just make sure it's
possible so I wanted to make certain a
few things one thing is that we can just
process frames quickly enough so if we
can only process frames at like one or
two frames a second that's I'm not going
to be good enough to really do much at
all in this game so I was really kind of
hoping for at least a 10 plus frames per
second process rate especially if all
we're doing is trying to get the frames
into Python because then we're going to
inferi need to be running algorithms and
all kinds of stuff so that was one thing
I wanted to confirm the other thing I
wanted to confirm was that we could
actually control grand theft auto with
Python I was pretty sure we could just
use send keys or pry out a GUI but I
wasn't positive on that as long as we
could do those two things I knew that
okay we can actually do this project
so I have confirmed those two things in
advance otherwise really nothing else
has been confirmed so this is just going
to be a series of me me running through
and if you guys have suggestions or
improvements I'm all ears because this
is just going to be filmed as I go with
that I also created this github
repository most by the way just in case
you don't know you can go to github.com
slash Python programming and that's most
of python programming in its source code
also usually I put a source code on
Python programming net but I'm going to
put this repository here she's github
comm / centex / PI GTA 5 and here you
can find all the code step-by-step that
we do and the latest version although
right now I don't really have that up
there yet
just because we're just kind of
exploring at the moment so if you have
improvements or whatever you can you
know do a pull request submit your
changes or whatever so anyway yeah so
feel free to contribute your ideas and
all that and if they're good we'll just
incorporate them to the entire project
now with that most of the code here is
going to be just the first pass through
even the code that I've already tested
to make sure it works that's just kind
of like a really quick run-through
nothing's going to be very pretty this
is going to be messy and probably not
beginner-friendly in any way so anyway
let's go ahead and get started so what
I've done is we're going to use GTA 5
you don't have to use grand theft auto 5
you can use any other game the first few
first of all the method that we're using
to get the frames you can do with
in-game and the method that we're going
to use to send input you can probably do
with most games and then some games you
can even get by with just send keys or
something like that other than that you
can probably switch around where the
first kind of projects I want to try to
do is just do a self-driving car
what makes GTA 5 a really great
environment is that using mods we can
control the time of day the weather
traffic conditions everything it's
really cool sandbox environment that we
can very quickly manipulate
unfortunately right as I started to
record this I found that there was an
update to Grand Theft Auto and every
time that happens you have to get an
update to the mod so anyway I'm waiting
on that but we're not going to really
need them for this one anyway just
because this is just some of the first
few but just know in the future videos
I'll probably be using at least the
native trainer just to get started also
if you are going to fall on Grand Theft
Auto I am on just a little scooter the
reason for that is because there's no
like first-person view when you're
driving a car so I mean there is but
it's not the cars for like what I would
like is the cars first person not the
person's cockpit view this so we can
very clearly see the lanes whereas when
we're in the cockpit view as like a in
the first-person view you really can't
see the lanes it's really challenging in
that view and then you can go behind the
car and see the lanes I wasn't really
sure I liked that either so this is the
way I'm going to do it I'm just on the
scooter it's the scooter has full view
you could do a motorcycle but the
motorcycles just probably too fast for
for any person if you do it anyway ok
yeah so let's get let's go through like
the
method for actually pulling in the the
actual screen and all that so the first
thing that I wanted to do was I wanted
to research okay how do you actually
capture a screen with you know Python
and most likely an open CV because we're
going to use need to use open CV most
likely so with a little bit of googling
I found this page here and the solution
that was picked was this one so the
first thing we'll do is I'm just going
to copy and paste the solution just copy
that come here paste and so the first
thing we do is just run this solution
and see what happens
oh no module okay so the first thing
that we have is for whatever reason
image grab is part of pill so you would
do from the Python measuring the library
so from pill import image grab and if I
recall they've made another mistake
somewhere we'll run it again anyway yeah
un ta so that's kind of off the screen
but I should pull this over so here you
n ta it's being treated like a variables
I'm not really sure why I they've done
that they must not have run the code
before they submitted it okay so that
grabs my entire screen which is a 4k
monitor so that's a problem so we're
going to close this and well the first
thing that we can do is throw in the
size so image grab through image grab we
can pass a parameter here which is B box
so B box equals and then here we can
specify the location I'm going to do 0
4800 640 and we're doing 40 just to
handle for the title bar here so I'll
run that again this out of the way
here we go so there we have at least
something that looks good I'm gonna pull
this up now and the frames per second
aren't looking too hot for us so the
next step is to see if we can't speed up
the frames per second here so the first
question I wondered was like is it
possible that you know showing the
screen is what's taking a while so one
thing we can do is to simply cut that
out and then we can import time and then
we can say basically we say last wonders
for time equals time time and then while
true we'll just come down here for every
loop and we'll say end time or rather
what we can say is we can just do a
print so print loop took something
seconds dot format and the format will
be timed out time so the current time
minus the last time whatever that is and
then after we've done that we need to
update the last time so then we'll just
say last time equals time time let's run
that now so we can see that the loop is
still taking about a not a half a second
but we're coming up it's just not very
good so the next thing that we're going
to do is close this out and so it's
definitely not the show that's taking
like a lot of processing it's got to be
something else so I'm an uncomment this
and then we have to wonder and in fact
actually it looks leave that commented
out because the next thing we're going
to try to do is hand it like look like
if it's this reshape so let's this save
and run that okay and so this is so much
quicker so we can see that
the line that's being bad to us is this
reshape line so what if we try to just
pull make sure this is on screen sorry
cuz there's gonna be so many windows so
there's probably going to come a time
where I'm going to do something that's
off screen so I apologize but anyway
I'll do my best in source code will
always be up somewhere so I'm going to
uncomment out these lines and the window
that we want to show that in show is
actually just going to be the print
screen pill so we can just paste that in
let's run this okay so that's not an
umpire ray all right
so wants it to be an umpire ray but I do
again have to wonder is it the numpy
array that's taking time is it the pill
that get data is it the d-type possibley
or is it the reshape even so another
thing that we could do is we could just
get rid of the reshape so we could just
come up to here delete that let's keep
printscreen numpy paste that in let's
run it again okay in balancing test we
not closed something or to be closed too
much okay close too much interesting
shape okay so and it's also very very
slow okay so I'm going to close it
alright sure
okay so a couple problems there now the
next thing that we could try is okay
what if what if we just did rather than
pill like get data like that might be
just a different format the next
question is what if we just do numpy dot
array to print screen print screen
underscore pill
right and there we go so now the updates
we're getting more than 10 frames a
second that's oh the color is off looks
like that's weird this is red and this
is blue anyway yeah we can talk about
that in a moment but anyway okay so now
we have live updates and sure enough we
could just move this over and then we
could make sure this is sort of on
screen I'll just put it I guess here
it's a little large but it's okay so now
I can we can kind of look around now and
we can see that this has made a huge
huge improvement over what we had before
so that's great we can definitely work
with that obviously again the colors are
off but that's just because we're doing
like BGR to RGB it's just not not the
way you want it necessarily so now that
we've done that the next thing for us is
to see about simply up different clothes
what we were just working on did I just
do that darn it
let's see I think I want this and then I
pull this back up okay so the last thing
that we can do here for the image show
what we can do is we can actually
convert this to the proper colors so we
can say rather than NPR a print screen
pill we can do TV to convert color print
screen pill and then we convert that to
CB 2.2 Sun screen nice color underscore
BG are so blue green red to RGB okay and
I make sure that's all good good good
good
and also let's go ahead and just MP
whoops MP dot array let's just convert
the numpy array here let's call it
rather than print screen so let's just
call it screen and then down here we'll
just say screen cool save that run it so
this is going to be a challenge okay
there we go all right now it's the the
proper colors we can look around and
everything's good so this is a good
first step for us to know that okay yeah
we're getting a little over 10 ish
frames a second but probably very close
to 10 right now so that's good that we
can work with that and then hopefully
the extra processing that we do will
keep us somewhere near 10 because I'm
guessing the most constraining thing is
this huge array that we've got to like
pass through and do any conversions on
so like if you were going to feed this
through a neural network obviously
you're going to feed 800 by 600 through
an own net anyway so anyway
alright so let's step one of likely many
many steps but we've got
the screen are the the actual like yeah
visual data coming in in the next
tutorial what we're going to do is try
to do some typical OpenCV tasks for just
simplifying the image significantly and
then maybe even doing a little bit of
analysis and then also we still need to
actually send input to the actual screen
so that's we're going to do in the next
tutorial if you have questions comments
concerns suggestions improvements or
whatever let us know if you can help us
get a better frames per second that
would be wonderful I think the problem
though is that we're basically
processing these on the CPU because
obviously the actual game itself is on a
GPU but this whole open CV window is all
CPU generated so I'm not really sure
everyone I'm not sure who else is going
to get the same frames per second as me
so I apologize if no one else is getting
close anyway yeah so I will see you in
the next video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>