<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Scikit Learn Machine Learning Tutorial for investing with Python p. 13 | Coder Coacher - Coaching Coders</title><meta content="Scikit Learn Machine Learning Tutorial for investing with Python p. 13 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Scikit Learn Machine Learning Tutorial for investing with Python p. 13</b></h2><h5 class="post__date">2015-01-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/JQkM_m-ZZ6U" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everybody and welcome to another
the 13th tutorial video in our machine
learning with scikit-learn tutorial
series in this video what we're gonna be
talking about is actually applying
linear SVC to our our actual problem
here and see what we can figure out so
in this video we're also gonna only have
two features we're gonna use two
features rather we've got a lot of
features in the video just two features
will kind of go over some of the basics
here I don't think we'll find anything
too powerful with even these two
features because this can actually still
be done you know by very simple code
actually you don't even need machine
learning you can visualize it yourself
and see if there's anything there so
anyways let's go ahead and get started
so let's make some imports and so we're
gonna basically a few imports actually
so we're gonna import numpy as MP this
is to convert to an umpire array base so
that's it
import matplotlib pipe lot as PLT this
is to make plots gonna show it visually
from SK learn import SVM cuz that's what
we're using
then we're gonna do import pandas as PD
then we're gonna do from matplotlib
import style
now we're gonna have styled I use ggplot
IgG plot anyway in like five years
people probably watch this beam but I
don't get it anyway probably bunch of
people don't get it anyways that's just
to make our plot look kind of pretty so
now what we need to do is we're gonna
first build our kind of dataset so we're
gonna have two functions here the one
function is gonna actually run the
machine learning algorithm that if we
want it to and the other ones can
actually build the data set to feed it
through psych you learn so the second
learn has a very it's very particular
about the way you feed data through you
feed through data as X Y is target
capital X and then Y is target so let's
go ahead and define Bill
data set like that and here we're gonna
have a parameter called features and
that's gonna equal the following we're
gonna look for de ratio and our other
feature will be a trailing key /e cool
so that's our function and its
parameters and your name and parameters
now we're gonna say data underscore D F
and that's gonna equal
oops pant actually it's PD data frame
dot from underscore CSV and here you put
the name that CSV that we saved it to I
believe was just key underscore stat CSV
so that's our data frame next what we're
gonna say is capital X again I think the
purpose of capital has an X is just to
not be confusing because the variables
are X and y but X is actually your
coordinates and Y is actually your
target or the actual number you know
whatever the classification is that you
know so anyways x equals MP dot array so
the conversion of the array of data
underscore DF and that is features dot
values dot to list looks a little
confusing and you might kind of gloss
over what this line is doing so let's go
ahead and just kind of say what's
happening so when you say data features
what you're doing is you're basically
saying data try to think of how best I
feel like some people probably aren't
left behind so I want to describe this
fast enough but then some people
probably are very confused I don't want
to describe it so dated EF features it's
kind of like saying basically D ratio
it's basically saying you know the four
pandas dataframe I want these two
columns considered and then it converts
those two columns when you do dot values
it converts it to basically just those
values and then you say dot two lists
it converts it to a list and dot two
list converts it to a Python list which
um and in fact I'm curiously we might
not have to do dot two list
I'm actually kind of curious first time
we run this I'm gonna do this because
because actually what we're doing is
we're burning this to it to it you know
two-dimensional array so it's a it's a
list of lists and then we're converting
it to an empire a so I'm not really
actually sure dot two lists is necessary
for us so let's go we'll leave that
there for now and then if we need it
we'll bring out this comments again so
anyways
then I'm going to say y equals equals
the following and this is gonna equal
data underscore D F and it's gonna equal
the value of status and if you don't
remember what status was it was either
outperform or underperform now those are
words we need them to be numbers so Y is
equal to dated idea of status and with
with pandas dataframes you can run a
replace function on them it's just like
you would any other string if you wanted
or really anything else so we're gonna
do that here so we're gonna say dot
replace and we're gonna replace under
perform and we're gonna replace that
with a zero we're in sight hmm get out
of here and then we're gonna do dot
we're a place outperform with a 1 and
then we have the same dot values dot two
lists this one needs to be converted to
a literature also so let me let me just
do this dot values dot two lists and
that's it just a little quick thing set
this is one line it's long it's
appearing on my screen just fine but
what you another thing you could do
since we encase this in parentheses you
can do this enter enter enter
so that's your X that's why then we can
return capital X comma Y lowercase okay
so that builds our data and returns us a
data set that is acceptable to us now we
actually want to run analysis on and the
analysis is you know should be pretty
familiar to you guys so we'll do define
analysis
and analysis does the following and it
says X comma Y the equals build data set
so we already kind of know what's coming
on what's going on there basic all of
this code will be code you've you've
already seen us do simply you know with
our own data they make some space real
quick okay so X comma white was that CLF
is gonna equal SB m dot SVC our kernel
will be you guessed it linear we're
using linear spz I'm not sure what that
was and then C will be equal to 1.0 just
for default purposes see a left dot fit
and we fit our data easy easy
WD equals so since we're graphing it we
have to do this as you wouldn't even
need to do this if if we weren't really
graphing it but we're gonna graph it
soon we won't be graphing it but it's
always best initially I think to graph
it so you can see visually kind of what
is going on so W equals see a left
coefficient underscore 0 with element
there then we're gonna say a equals
negative W 0 with divided by that
weights 1 then want to say X x equals MP
dot Lynn space and here uh I'm just
gonna put in some custom code here
normally you you could just hard code
this I'm gonna go ahead and say minimum
of so the minimum value of capital X and
then this you know basically numpy magic
code 0 and then to the max of this
what did you just do to me alright
anyway so min to max and should close
this off I think yes then so that was X
X now Y y equals a times X X my CL f dot
intersect underscore the zeroeth divided
by the weights this is again not totally
necessary you understand what's going on
here at this point eventually we will
kind of go through some of this code
because these are things that actually
matter and if you want to customize your
code and actually do really advanced
stuff you do need to understand for now
just copy the code we're all purely
putting this in the tutorial just so we
can visualize what's going on so you
know don't worry too much about it
someone thinks they can explain it
really well feel free to leave a comment
below and tell us what you think's
happening anyway age zero goes BLT
whoops
PLT dot blots xx YY and then we're gonna
plot that as a no comment there black
dash line actually it's not okay okay
okay okay and then we're gonna say label
equals non-weighted then we're gonna go
ahead and plot our data so we're gonna
do PLT dot scatter and we're gonna
scatter basically this right here Wow
well not really
anyway scatter to that and this so
that's basically I just copy and paste
of this value so this is the zeroth
element of this x-ray basically to
everything and then this is the first
element of each element the first
element of each element in that X numpy
array so it's kind of like magical code
but I've actually until I got some
machine learning I never saw this code
in my life and that's actually really
useful code I would have used a for loop
hey it created a new list but no you
don't have to do that you can do this
this is a really cool code so for anyone
that's not still not following just I
think it's amazing
show you really quick so let's say x
equals a list of lists so it's a list of
lists and does something like this and
let's say your list is 1 3 1 5 and 1 7
okay so X basically this right here if
you said at like if we said X colon
comma space 0 like this it would be 3 1
it would be 1 1 1 right 0th element of
each element so this is an element the
zeroth element is 1 this is an element
does REO that man is 1 and so on I think
it's really cool I was really excited
when I found that code so hopefully some
of you guys are as excited as I am
moving on
so we scatter that and we're all set and
let's go ahead and just run a healty
touch show also it's somewhat helpful I
think when we have two forms of data to
go ahead and plot to label the data so
we'll label we'll just do we'll do it
right here so PLT dot y label then the y
label is gonna be the trailing p/e ratio
and then kill TI X label this label will
be our de ratio D ratio and then Kielty
out legend
we need an appeal to show and then now
we should just be able to call analysis
save that run that wait root cos capital
C my bad
capital C equals one point now let's try
this again hopefully we get a pretty
plot was a big data set actually now
that I think about it how long is it
gonna take
it's a lot of plots basically 500 times
to a thousand plots we're not a thousand
plus so maybe five hundred plots ish
let's see I guess I'd be actually more
than X we're plotting bit step of the
way
anyway it's a lot of nonsense so we'll
see how mistakes I don't recall it
digging this long when it has a bigger
amount of data most of this is actually
the plotting there you'll be surprised
how fast this this whole operation goes
without plotting I was hoping to show
that in this video
but this is taking a while analysis
would go I guess while we're waiting for
that I haven't some more code that I
wanted to do so while we're waiting for
that to show up I'm gonna go ahead and
run huh as I'm talking anyway ah okay so
we better little divide here and we're
like okay this means nothing here's and
oh so obviously this is a slightly
confusing we need to color this data I'm
not gonna wait for this to show up again
but you can't stay color equals y and it
will plot based on the value of y so
whether it was underperformer
overperform but we'll talk a little bit
more about that later I think it's not
totally necessary to plot this up again
I hate to do it again although what we
could do maybe is
yeah let's do this let's say data let's
do close this out and let me come up
here and let's just look at this we'll
do the data underscore DF equals data
underscore DF like this and then we'll
do all the way to the value or the I
don't know let's do the hundredth row
okay so this will run significantly
faster than the previous one and it does
okay so we're not really sure what these
two things are but we can divide them
and we do something like this we could
say right here C equals W or Y rather
and that's color equals y and it will
give it a unique color to the
underperformers and over performers as
you can see you can see this is mostly
reds but you've got a couple of Blues
and then down here it's probably equal
count reds and blues so we would say
this is pretty inconclusive most likely
so you know I think at this point I'm
not too interested in doing any
predictions or anything like that but in
the next video but we'll go ahead and do
is add more features so allow more
features to come into this we won't be
able to plot it that's okay
you know plotting it is just basically
useful so you can see kind of what's
happening now again here I think if we
test if we like ran this data and tested
this data I think we'd find that you
know comparing these two values is
worthless and again that's most likely
because anybody you don't need machine
learning to do this right you could
simply plot up the values yourself very
quick you don't even need to know how to
program you could just do it in Excel
and you can see visually with your eyes
that well there's really no group here I
don't really see any point and and
that'd be it right and so to me I don't
really see too much value in taking this
too much further with the only two
features the idea of machine learning is
to have many features so it's impossible
for us to graph it or draw it or even
kind of conceptualize it in our head I
mean I'm sure it's possible like some
people are capable of conceptualizing
you know 35 features in their head and
creating some sort of algorithm on their
own
maybe but I don't think that person
exists and I mean maybe they do but it
would take them a long time probably um
but most of us can't do that anyway so
just for a quick I believe this is our
out performers and these are our under
performers and so you can see trailing
p/e the price is significantly above I
would go so far as to say the reason for
this is trailing p/e is based on their
past performance right there trailing P
is how are they doing based on their
equity from before compared to their
price basically today so it only makes
sense that the people that are out
performing today have a significantly
high trailing price to equity ratio
right because basically what it's saying
is they're worth more than their
trailing equity okay so basically if you
ask me that is almost 100% going to be
the case that people are gonna have a
high trailing p/e if they are
outperforming it just has to be the case
right
pretty much anyways as long as in the
time period the market has gone up I
suppose but anyways enough that this is
not really that interesting to me and
it's cool to see it all graphed up and
colored and you know everybody loves
graphs but what's more interesting is
what's coming and that is the ANA
analyzation of you know 35 features and
seeing if there's anything there so
anyways stay tuned for that if you guys
have any questions or comments please
feel free to leave them below otherwise
as always thanks for watching thanks for
all the support the subscriptions and
the donations and until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>