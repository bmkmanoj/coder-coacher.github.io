<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Combining Alphas - Algorithmic Trading with Python and Quantopian p. 11 | Coder Coacher - Coaching Coders</title><meta content="Combining Alphas - Algorithmic Trading with Python and Quantopian p. 11 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Combining Alphas - Algorithmic Trading with Python and Quantopian p. 11</b></h2><h5 class="post__date">2017-02-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Sq2CJxFq4vY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to
part 11 of our algorithmic trading with
Python and quanto peon tutorial series
in this video what we're gonna be doing
is like we've found the factors we're
saying yeah we want to go with you know
revenue growth operation margin and also
sentiment so we talked about you know we
can basically build a nice skeleton here
where if we want to try something new
you just take this copy-paste and like
that's the only change you need to make
through the rest of this entire notebook
you run it you check the alpha so we
like that now we're ready to combine
alphas now I could just do it all in
this one but what I want to do is
actually create a new notebook that's
just a copy of this make those changes
that way you yourself have a single
alpha checker that's pretty simple and
then you also will have a multiple alpha
checker notebook that it'll just be
super simple you can just pass stuff in
to I'm sure there's like other ways you
could do this but I've this is the way
that I've done at least for now it just
makes my life easy for finding alphas
and combining them so for example let's
pull this down we'll go back and you can
just check this and we'll duplicate it
and then we'll open up this new one
alpha checker video we'll call this
alpha need to pull checker video perfect
all right so now what we're gonna do is
let's make some space here and basically
the what we have to do is first we're
gonna pull in these factors and then
we'll combine the factors in some way
we're going to use a pretty simple
method here but there's obviously a ton
of ways you could do this you could use
really complicated all the way up to
like machine learning to choose the
right you know weights for your factors
or you can do what we're gonna do here
so so so testing factor equals yes so
we're gonna just take this copy paste
and paste because we've got basically
three factors we're going to work with
so one two three and we're gonna start
with
basically we'll do operation ratios
operation margin
we've got revenue growth and then we've
got sentiment dot sentiments underscore
signal and make sure you don't forget
Lee is there and then now the universe
needs to be let's do this
and again copy one two three and this is
testing factor one two and three so it
needs to be in the Q 1500 u.s. it needs
to not have operation ratios no or I
mean operation marginal revenue growth
nil and it also must have a national
sentiment signal now testing factor
we're going to say is we can actually
leave we'll leave this line here now
we're gonna say we'll say before that as
well we'll say testing underscore factor
equals testing factor 1 plus 10 whoops
testing factor 2 actually
hmm we need to do we need to rank them
so actually what we'll do almost ran
into some trouble
so actually testing factor 1 1 and then
copy this paste paste to sorry I just
hit my mic that was noisy I apologize to
3 and as I'm doing this like the the
Python programmer in me is suggesting
that we do a for loop next time that
will better handle so we're not just
copying and pasting these lines so you'd
probably rather you'd have factors
equals and then you'd paste in these
factors and then for these factors you
would just iterate through a for loop
and then do the exact same thing down
here we're gonna have to definitely do
that next time we'll save it's like a
dictionary or something
if I come back to your hair oh I'll make
that change before we before we do this
again maybe for the the correlation
video maybe I'll do it there because
that would be a good idea anyway we'll
just leave it here for now so one two
three okay so now we're gonna say the
final testing underscore factor is going
to be equal to and then it's basically
these plus each other so this plus I'll
put a space here plus and then plus so
this will be three two and even this
could be a for loop oh man we are gonna
just we're gonna do really good soon so
because these are already ranked like
zero to 1,700 or so we could just add
them together and that should be totally
fine like that if that'll be a more than
adequate simple addition to them you
could add them together and divide by
three two if you wanted to do that but
you whatever we're just gonna add them
together so okay and then also just for
the record everything else stays the
same we can actually run this and test
this but since our next step will be to
go to a trading situation you could say
testing underscore quartiles is going to
be equal to testing underscore Factor
ranked and then again you could just
rank them in the same way like this and
they're really already ranked you might
even be able to just you might get away
with just just dot because we don't I
don't need that you press a quantiles
like that well I'd the rink later but in
theory they're already ranked I think
that should be fine we'll see we'll see
what happens but anyway we'll have to
fix that if that's a problem but I don't
think it's going to be a problem so
everything's nice and pretty aligned all
right why why are you doing that why
don't you line up for me that's not cool
why would I do this
why are you notice the music's pipe line
columns is something wrong I don't know
anyway let's strip mm-hmm I don't really
want this to not be like that but okay
we'll see if we get a syntax error
something's got to be wrong if we're
it's like lining incorrectly is this
lined up good good I feel like we've
gotta have it we'll find it if there is
one anyway shorts would be now testing
Quan tiles whoops actually no testing
quantiles EQ zero and then we'll think
the same thing again I'm not seeing it
but they're usually when you have this
issue you've messed something up I'm
just not seeing it okay
the show must go on well we'll wait for
the air anyway that will be part of our
strategy but now we're ready to test it
I'm just gonna look one more time
through here testing factor equals the
combinations of all of these fine not
know one two three one two three check
in all our one two three that's why we
would like a four loop this would
alleviate any sort of typos that could
have occurred there looks good let's run
it see you a syntax error really why is
this why is this not lined up for me hmm
I have no idea anyway while that's
running I'm going to pause it and
actually I'll do the assets as well like
I did last time so you can go ahead and
pause and then continue when this cell
is done and you also run this cell for
the prices so I'll see you guys in a few
minutes alrighty welcome back for some
reason I got hung up again I think I've
already mentioned what you do if you if
it hangs like if this process takes more
than five minutes it it's just hung up I
have no idea why but if that happens to
you
you can hit this back arrow oh well I
kind of want to stay here except for
made changes let me just do it this way
so you'd go back to your notebooks
regardless and then like this is the one
that's running you can check it and just
stop it just shut it down and restart it
up and that solves the problem usually
like that's what I just had to do here
and then it went through like under a
minute so I don't know why it must be
just somewhat buggy but anyway I've run
now the pipeline and the test and then
when I looked at this is why you just
always print out at least like the head
of your data frames because I noticed
that why is there only a shorts column
and not not the lost column and I
realize I've already fixed it but I had
it shorts shorts I'm sure plenty of you
guys saw that but change that to Long's
and fix that
anyway the assets are in now we have 522
basically that's just because that's all
that's available through syntax so
syntax limited well that's significantly
that pool and then let's run alpha lines
so again we're running on 310 in 30 days
out which we kind of saw that with
syntax it was maybe not so good that far
out but as you can see already alpha has
been improved significantly by the
combination of these factors our beta is
within the acceptable range very good
very good information coefficient has
also improved I'm pretty sure that's
better than any of those three I don't
know this one might not be but I I'm
pretty sure these I don't recall us
having anything of a point one even 30
days out that's a long time I don't
really think quanto peein wants you to
hold for 30 days but whatever cool I'm
scrolling on down
quanto Erik quantile one is bad quantile
two is good fantastic and look at these
blobs oh it's beautiful beautiful oh my
goodness yeah this is a huge improvement
by combining these factors in such a
stupidly simple way we literally just
add them up and then basically we had
cuz they're already ranked so in theory
it's like it added up in
that they're already ranked so we that's
why we'd have to do anything but yeah
beautiful
look at these it's like before we did
really kind of bad at first and then we
did really good and now we just kind of
neutral at first and then really good so
it'd be nice if we could find a factor
that's really good initially and then
gives it all back even though I mean we
already had one but recall that this
remember we've got basically two factors
that kind of suck for the first few
months and then do really well so we
might want to find another factor again
that's uncorrelated to the other factors
we have also this is a really we're
looking at only one year time frame so
really probably what you'll want to do
is look at a much larger time frame
before you start worrying about
correlations but anyway very good very
good very good I bet we're gonna get to
that so it's gonna happen in that split
graph let's see let's let's see what
happens no oh it's very good fascinating
fascinating okay then we get here and
well this one's real I love this look at
that look how how much better the
distribution is now on both of these
it's like it just stops being wrong at
some point here Oh fabulous fabulous
this is looking great what a great
improvement Pinchas combining some
factors we'll have for us and this looks
pretty good too
fantastic okay so we've combined all the
factors now the next step is one that
we're actually going to basically alpha
combination risk model we're just saying
okay leverage will just be one period
and then we're trying to have low
volatility and stuff like that but
really we're gonna we're gonna move to
step number five now which is portfolio
construction now we're gonna have a new
video for that one because with
portfolio construction we're going to
kind of jump ahead to a more complex
method of portfolio construction but I
actually think it's less complex and
hopefully I can drive that point home
but we're going to be using this new
hopefully won't change too much in the
future optimization API which uses
convex optimization
or you to pick your portfolio so so
actually that's what we're gonna be
using but I think normally using like
CVX PI or CVX oft it would have been
maybe a bit much but the the the
optimisation API is like stupid simple
and because of that stupid simplicity
and because it makes sense logically I
think it's a great starting point for
your portfolio construction and then
after that we just execute and then we
can also use you know PI folio to see
how he did and hopefully we have made
improvements or are starting algorithm
just by basically the change being
mainly combining alphas but possibly
adding this other change but we can we
can find that out too by by testing the
two okay that's what we're gonna do in
the next video so stay tuned for that if
you have questions comments concerns
whatever on this video let me know below
otherwise I will see you very shortly</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>