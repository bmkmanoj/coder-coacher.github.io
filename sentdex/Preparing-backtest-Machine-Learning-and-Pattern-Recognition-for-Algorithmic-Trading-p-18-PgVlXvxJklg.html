<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Preparing back-test: Machine Learning and Pattern Recognition for Algorithmic Trading p. 18 | Coder Coacher - Coaching Coders</title><meta content="Preparing back-test: Machine Learning and Pattern Recognition for Algorithmic Trading p. 18 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Preparing back-test: Machine Learning and Pattern Recognition for Algorithmic Trading p. 18</b></h2><h5 class="post__date">2013-10-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/PgVlXvxJklg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">you
hello everybody welcome to part 18 of
machine learning for the use of
algorithmic trading where we left off in
the last video I just bringing up more
variables and more problems with as we
continue on this journey together but we
left off with the idea that let's go
ahead and actually do some back testing
and see if it's really worth our time
because some of those hurdles coming up
we need to decide whether or not it's
worth our time and energy to continue so
let's begin building the back test the
first thing that we really want to do in
this back test is we don't need to be
displaying graph anymore so the first
thing we want to do is get rid of all
this graphing stuff so everywhere we see
something that's related to drawing your
graph we're just going to comment it out
so the first spot if pat pat found
equals one comment that next part or
well comment come at the figure part out
don't come at if pat found anyway um
come at that part out next comment out
this plot here comment out plot here
continue scrolling comment out coming
out comments out come in town comment
down and that should come out everything
because we're not calling um oops where
have I gone we're not calling graph FX
so we don't need to comment this stuff
out so that should be everything that
we're graphing now the next thing that
we want to do is we want to develop a
back test so to do the back test we need
a few things right we need to know are
we accurate or not and then also we need
to store that kind of like an array
right or keep track of it right do we
were we accurate or not yes or no and
then as time goes on how many samples
have we done and then but you know how
many times we accurate divided by how
many samples we have and boom you've got
yourself in a percentage accuracy so
let's begin building for that so looking
at this a few of the things that we
could stand to move are the following we
can move
I'm still thinking now we want average
law in there but we can take out let's
just take out pattern storage and we can
run that once all the way through so we
didn't have to do that every time if we
wanted we could take out and move a few
things instead of running it every time
that would kind of help processing time
I can't release out if I really want to
do that but if you did you can move some
of these things out to be global and
then so like if you did you know you
could run it like every day run and
compare pattern and store patterns but I
think what I'll probably do in the
future is maybe just have like a pattern
storage script that you just run it
every now and then stores all patterns
then you visit that those patterns but I
guess for now for the back tester we can
just leave this in here and let's just
build what we need for the back test so
a couple things let's make an accuracy
array and that'll be empty to start and
then let's make a samp's and that'll be
also empty to start of course and every
time there's runs we have another sample
so we'll just say down here samp's plus
equals one and so we know like how many
samples we actually ran through now the
next thing we want to do even though it
wouldn't really necessarily be trade
worthy but anyways next thing that we
want to do is come up to our actual
graphing I think the best way to do this
see it's going to be kind of hard
because here we need to do it for each
pattern and then down here we kind of
need this stuff in the order without
changing up a whole bunch of stuff so
we're going to kind of work around that
I guess and the first thing that we'll
do is we'll come over here indent and
then we'll say bread array that's going
to be empty array so pred array for
prediction sorry hit the Mike prediction
array and now what we'll do is as we
come down here if the color is so if
it's greater that means this color was
Green and for anybody that forgot so
positive or
prediction will be we'll just say that's
one for up right and then we'll come
down here oops
come down here and if the color is red
then we want to repent pred or a pen a
negative one point zero zero this way
when we do the averaging it will
automatically do decimals for us then
after that we want to do I guess we're
done there the next thing that we want
to do is after this for loop right now
we want to do um so in line with all of
this stuff we want to do some stuff so
first let me just delete octane Posada
phone line I guess yeah we'll just
delete this now what we'll do is let's
just to make sure that we actually are
on the right track well go ahead and
print the prediction array just so we
can see it visually because when you
start doing stuff like this you might
think you're expecting some something
specific in here and that way if
something is going wrong you can just
look at it and be like oh well that's
not what I wanted at all so now what we
will do is print prediction or make a
prediction average and again we're going
to use this lovely lovely function that
we've created for ourselves and come
back here prediction average equals
ready and we're going to use pred array
in the variables here so pret array and
put ray now so that'll be the average of
all the predictions so it'll either be
above zero or below zero as an average
right so now we'll say print prediction
average just to make sure we're on the
right track and then we'll say if
prediction prediction average is less
than 0 that means spring drop predicted
right subsequently let's print hat for
rack 29 so the
plot in the pattern where is that now
print real move keep in mind real
movement was present change from all
data that last point in the plot to the
actual outcome so what is so we've got
our prediction is to drop then we want
it to print the last point then we want
to print out what was the actual
movement so we can see visually whether
or not a drop actually occurred
subsequently if real movement is indeed
under pat for Rhett 29 congratulations
accuracy array append 100 you know 100%
accurate else accuracy or a hope and
several next up we ought to do the other
side of the equation so if prediction
average is greater than zero
print rise predicted yes now we want to
do the same thing and actually um let's
save ourselves our fingers and copy
paste and the only thing we really need
to change is the phone fact
so it's probably a good idea to go ahead
and check your accuracy and so if
prediction average is above zero that
does mean a rise and we just want to
print the variables just to make sure
we're doing it right and logically if
real movement actually does indeed is
indeed higher than that last plot so our
prediction turned out to be accurate we
want to say that specific extra
prediction was accurate continue so it
adds that to the accuracy right which we
just made down here is empty but it will
get populated with either 100's or
zeroes and now if we come down to the
bottom here this means under all of this
we can now say print and we say
back-tested
accuracy is
is comma string accuracy average plus a
little % because we're awesome oh and
then we'll say after comma samp's um
samples since that is exactly what they
are um okay I think that's it we might
have had a typo somewhere where you did
a lot of edits and stuff you always run
the risk we've been doing pretty good
lately so we're definitely coming up on
an error soon so anyway we'll run it and
I think we actually have that press
Enter ticking yeah we do that's another
thing we want to remove from our script
so we can actually run this and walk
away so because we'd kind of like to run
it for a while so pattern storage we
could buy delete that too but that's
okay I'm just kind of waiting for a
response one one rise predicted and
looks like it was good but we're not for
whatever reason entire process so I
guess it's a print enter back test
accuracy and accuracy average is not
defined I swear we define this Oh
let's see hold on okay I thought we had
to find it but I guess not so what we
need to do is another one of those sexy
lambda equations so let's go ahead and
take this and copy come over and we're
going to do accuracy average equals
paste and in here we actually want to be
accuracy array where is that here it is
accuracy array array and it's go ahead
and remove move on run this again let me
drag this down
and we wait suspense is killing you guys
okay with one sample we're so far 100%
accurate so I'm going to pause this for
a little bit and let it run through a
few okay well after 12 samples here
we're still running at 100% accuracy in
theory we should eventually hit
something that's incorrect but anyways
what I'll do here is I'm going to show
you guys now I've been running this back
test against a lot more data for a lot
more samples and I've got about one of
them is going very slow and only has 570
the other ones are about 900 samples and
at different intervals within so here is
an example of the accuracy is pretty
good everyone is at least over 50% so
that's always nice to see so anyway let
me pause this and I'll resume the video
over them all right this is eight
different scripts that were started at
different points I did I think it's like
35,000 lines in 37,000 lines in 40,000
lines in 42,000 lines and so on
so anyway this first one is through 915
different tests it's 57 percent accuracy
kind of a string of zeros lately it used
to be it started off very accurate and I
guess it's going south
this one has 76 percent accurate it had
a nice string of 100's there this one 72
74 64-58 88 and this one a freakin
awesome 98% Wow anyway so that's that
and it's on against you know about let's
see got nine hundred times a - about 400
since everyone's running really slow so
really about 6800 samples so far and we
have
so I guess I could run that math real
quick to posit water on that the average
accuracy here okay so our average
accuracy is seventy three point five so
that's pretty impressive if you ask me
I'm pretty happy about that accuracy so
anyway that's going to conclude a video
what is this eighteen hopefully you guys
have enjoyed the series so far it looks
like we've got a pretty good pattern
recognition with pre darn good accuracy
as far as friction in the future is
concerned as always thanks for watching
thanks for the support in the
subscriptions and until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>