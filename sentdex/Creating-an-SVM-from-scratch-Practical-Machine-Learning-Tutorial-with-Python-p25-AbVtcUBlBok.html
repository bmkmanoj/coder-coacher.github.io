<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Creating an SVM from scratch - Practical Machine Learning Tutorial with Python p.25 | Coder Coacher - Coaching Coders</title><meta content="Creating an SVM from scratch - Practical Machine Learning Tutorial with Python p.25 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Creating an SVM from scratch - Practical Machine Learning Tutorial with Python p.25</b></h2><h5 class="post__date">2016-05-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/AbVtcUBlBok" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody and welcome
to part 25 of our machine learning
tutorial series in this part we're
talking about specifically the support
vector machine up to this point we've
covered the theory and the logic for how
we're going to do it and now we're going
to go ahead and do it so we're not
really going to be talking much about
the theory and logic here so if you
missed that you probably should go back
and cover that so anyway let's go ahead
and get started first thing we're going
to get is we're going to go ahead and
import mat plot lived up pipe lot as PLT
we're going to go from matplotlib import
style style die use and we'll use ggplot
for this it really doesn't matter and
then actually we also need to import
numpy as MP and that's basically all we
need for a at the beginning here so now
we're going to start with just some
really simple basic data so let's go
ahead and make that we'll call it data
dict for now and it can be a dictionary
and the keys will be the class so
negative 1 is going to be the equivalent
of a numpy array of a list of lists and
then we're going to do the same thing
for a positive 1 class it'll be a list
of lists too so let's put a comma here
and so let's start adding some stuff
here so let's just say we got a 1 7 let
me just paste paste so we got 1 7 we'll
do it to 8 and we'll do 3 8 just
something really simple and then we'll
go ahead and enter this one and if I
were clog and just paste like this yeah
and then we'll do 5 1 let's do let's do
6 negative 1 so let's throw like a
negative in there just to show that and
then a 7 whoops 7 3 okay so very clearly
it should be pretty obvious where that
data is going on the graph if if not
don't that's not really that integral
once we trained it we'll we'll plot it
up and stuff
one always time doing that right now so
now what we're going to do is I guess
we'll probably we'll just leave that and
then we'll come down to the other stuff
the other parts like because like later
on we'll actually call stuff to run but
we don't really have anything besides
data dicks so let's go ahead and begin
building our our support vector machine
class so if you don't totally understand
object-oriented programming classes
don't really hopefully this will be a
simple enough class just understand that
the word self just allows us to use
variables and other methods within the
class and what the heck is a method a
method is basically it looks just like a
function and it acts like a function and
all that so just think of it that way if
you don't know much about object or in
your programming we definitely want to
do it though because we want our support
vector machine to be an object so we can
train it and then not have to retrain it
and like later we can do a prediction
and stuff like that or visualize or
whatever so that's why we want it to be
an object plus we want to save it with K
nearest neighbors it wasn't as valuable
to make it an object because every
prediction needed to basically be a
retrain right so wasn't really that
valuable there so anyway we're going to
call this a class support vector machine
and actually we probably should be
totally official support vector machine
there we go
now we're going to define our init and
again I guess I didn't explain in it
either but basically all the methods
within a class when you call a class to
run all the methods none of the methods
will run except for the init method this
is the initialization method so when you
first call support vector machine into
action the init method just will run so
anything you define under there is going
to happen and then the other stuff will
only happen if you specifically call
upon it so here we have self and then
we're going to set visualization equal
to true and what's going on here is self
just for self and then also
visualization we're going to have some
code that's going to allow us to either
graph the data or not but if we if we if
we want to be as hyper
as possible you wouldn't visualize it
but I just wanted to have it there
because visualizing it is you know like
we won't really know if it works unless
we can see it with our eyeballs so we're
going to visualize it so now we're going
to say is self dot visualization equals
visualization okay so that just says for
the entire class we're just setting that
value to whatever the user said and if
the user didn't say anything we're just
assuming it's true so we're going to
visualize stuff next we're going to do
self dot colors and we probably don't
need this one here we might put in the
visualization but for now I'll put it
here and this will be if we are
visualizing things this is what we want
and be so the class that is a1 will be
in red in the class that is a negative
one will be blue next what we're going
to say is if self dot visualization if
that's the case we were going to say
self dot Fink for figure equals P Ltd
figure and then we're going to say self
dot axes is self dot fig dot add
underscore subplot one one one so if you
don't know much about matplotlib I've
got a whole tutorial series on it so you
can check that out basically this is
just the actual figure to the whole
window almost and then this is a
specific subplot and then this is a one
by one grid and this is plot number one
there is only one but it's plot number
one if there was one if there was more
anyway anyway so there we've got that
and we want that for reasons you'll see
later on and we need to share that
across the entire method so anyway so
you've got the init and then what we're
going to need to do is eventually have
well what else do we need so we're
definitely going to need just think
about like with scikit-learn what do we
have we've got fit and predict for sure
so let's go ahead and just define fit
what we're going to have to have self
there just so we can share variables and
stuff but then what else are we going to
need and really it's more for standards
but anyway
what else are we going to need like what
are we doing when we do fit man well
we're passing data so we're going to
throw in data there and for now I'm just
going to say pass
we're going to do anything else and then
finally what is the other method that
we're really going to need well we're
definitely going to need a predict and
that's again going to take self in data
and prediction hmm let's go ahead and we
can actually fill out prediction for the
most part what is predict remember what
what the function is or the calculation
for the prediction is we have to we
basically the it'll be classification
equals something and if you recall it is
the sign of the X I and but for now
we'll just we'll just put X because we
can't really do a sub so easily in here
so X dot W plus B and it's whatever the
sign is of this equation right here so
so what would in Python how would how
might we do this right well first of all
for sign you could you have some sort of
like quick lambda function or something
that just says it is a set above zero or
below zero right so you could do
something like that but it turns out
numpy actually has a specific sign so
we're going to go ahead and just do that
NP dot sine of n P dot so remember this
is X dot W and what is a dot product do
it returns a scalar value so NP dot and
we're going to dot anything that we pass
and website actually let's see we did
predict self data let's say predict self
features that that makes a little more
sense so let's do MP dot and then we
would say we're going to dot the NP or a
features and then it's just in the in
the dot so this is the two things that
we're going to dot we've got the one
thing so far so we're going to have a
comma and then the other thing that
we're going to dot which will be self
dot W we don't have W yet we're going to
add that's the whole point of this
entire thing if you recall we'll get
there but
just remember that that's what is going
to be so it's just X W and then plus B
so again self dot B same story we don't
have those yet we need to optimize for
those but once we have them we'll be
able to do a prediction where do you
think we're going to get these values
when are we going to set those well
hopefully in the fitment right we can't
find those values until we do a fit
there for you of course you have to do a
fit first and just for the sake of
clarity it should be pretty clear by now
but fitment is trained okay basically
the same thing we're just going to use
fit because that's what scikit-learn
uses when they call it something so
anyways um we've got self W self B so
that's it that is your classification
and then basically you return
classification now we're also going to
graph and stuff like that but we'll just
leave this the way it is for now because
and we'll plot it when we get to the
visualization part and I think for now
I'll cut this here and then in the next
tutorial we'll probably build out the
entire fitment so we'll cover the entire
optimization and finding W and B but you
know the true crux of the support vector
machine now that we've got a decent
amount built so anyways that's it for
now if you have questions comments
concerns up to this point feel free to
let me know otherwise as always thanks
for watching thanks for all the support
and subscriptions and until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>