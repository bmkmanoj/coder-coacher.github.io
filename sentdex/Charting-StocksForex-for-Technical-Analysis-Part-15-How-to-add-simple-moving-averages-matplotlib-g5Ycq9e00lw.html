<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Charting Stocks/Forex for Technical Analysis Part 15 - How to add simple moving averages matplotlib | Coder Coacher - Coaching Coders</title><meta content="Charting Stocks/Forex for Technical Analysis Part 15 - How to add simple moving averages matplotlib - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Charting Stocks/Forex for Technical Analysis Part 15 - How to add simple moving averages matplotlib</b></h2><h5 class="post__date">2013-09-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/g5Ycq9e00lw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to the
15th video in the financial charting
with Python matplotlib video series this
is where we've left off we finished up
our candlestick chart it looks pretty
decent we added those shadows to it now
we got volume and all that so now that
we've basically completed the
candlestick chart it is time to move on
to another other forms of analysis so
probably the best step is moving to a
simple moving average next now Tesla is
kind of a poor stock to do it with just
because really Tesla's been doing
nothing but going up so it's kind of Inc
boring so so a stock I'd like to do is
at there is eBay because eBay has been
not only very volatile recently so if we
do do intraday data eBay has been pretty
bald over the last few months
also eBay has been decently volatile
over the past few years as well so we'll
do a bay and if you don't have a good
data set like I think when we did it we
pulled one year of data if you don't
have it the the stock price puller that
we made in the basically the first part
of the video or the video series anyways
I think it was on maybe to part two of
it is where we talked about how to pull
the data and it's what you want to do is
in this URL to visit five years is I
think too much I want to say we want to
do three years of data and let me just
lets the leaked Google and run Google
real quick just to be be certain that
three years is a good one so you want it
to every day you want at least one day
open I look close because more than I
think it's three it pulls kind of bad
it's not like bad data but it's like
every like two or three days or
something so that's no good so let's
open it up
yeah so we did three years I think so
besides the weekend that we're skipping
through you know we've got one day open
I love clothes so I'm not gonna be using
Google I'm gonna be using eBay but that
was just a quick example of our polar
script that we wrote
so anyone when you use eBay but you
could use Google as well if you want it
so with that let's go ahead and hop into
it so we're where we are at now let's
bring it up here is our eBay so it's
been rising like Tesla it just has
wiggled around a lot more than Tesla
look so it's a preferred in my opinion
at least when we're doing simple moving
averages I'd rather have been in Tesla
investing wise but anyway um let's see
so we want to add a simple moving
average to this now generally the most
popular moving averages are going to be
twenty six day and twelve day moving
averages since that's like the amount of
open time like half of a month of
trading you know time is twelve days and
the full month is really like twenty six
open days you know or something like
that so that's why those numbers are
used so that's what we're going to use
them for so yeah let's go ahead and get
started and add the moving averages
there we go
okay so the first thing we need to do
we're moving average is we need some
sort of function that's going to
calculate a moving average for us so for
that we're going to use a function
called moving average so we're going to
define moving average and this is going
to take two parameters it's going to
take values and window values is what
are we gonna like what kind of data are
we applying this to or yeah what kind of
data we're gonna apply this to a window
is like what is the window of this
moving average you know or you can think
of it like a time frame now the to add
these little like weights it's going to
be NP repeat
1.0 window and then divided by the
window then we're going to do the SMAS
for a simple moving averages equals NP
whereas the convolve function here and
we want to values weights and this is
kind of like smooth the line for you and
then what do we want afterwards what
since we want to you know we want to
return where I end up on a variable will
be return SMAS so it would be like a
list of stuff basically but it actually
it'll come out as a numpy array so
anyway that's how we're gonna do for the
moving average now the next thing we
want to do is in the graph data now I've
already told you what moving averages
we're going to use but let's say you
wanted to have something that was a
little bit more dynamic we're gonna put
these right in the parameter of our
graph data function so we're just going
to call it ma 1 and ma - so moving
average 1 moving average 2 now once
we've done this since we already know
what we want we're gonna scroll all the
way down the bottom and we're just gonna
put those in right so moving average one
is 12 moving average 2 is 26 so we're
gonna come back up again now that we've
done that back to our graph data
function and we don't really need to add
another axes because we're going to plot
this right on the same axis as the
candlestick is so that's no problem but
we still need to calculate the line so
and we need to do this like I guess
we'll do it right here just make some
space so the first thing that we want to
do is we'll just say a V a V one that's
gonna be average 1 equals moving average
and in the parameters the data that
we're going to use most of the time
people use like a closed or adjusted
clothes to generate their moving
averages so that's what we're going to
go ahead and do we'll use the closed P
and then what is the window that we want
to use well ma one which corresponds to
what we threw in the MA one variable
which is a 12 in this case back up here
then a b2 equals moving average and
again we're going to close this closed P
and this time we're going to use ma to
the next thing we want to define later
on when you apply a moving average like
say you've got five pieces of data and
you want to apply a three moving average
well those first few pieces of data you
don't have you don't have enough data to
generate that moving average so your
data can't start until that point so
what I like to do is just make a quick
variable called SP and which is short
for starting point the starting point is
going to be the length of data right and
in this case we'll just use date but you
can use like close P or anything dates
and then MA - that's our largest moving
average - 1 onward that is our starting
point in every array right because
that's how many pieces of data Explorer
assange amount of data and you have to
have exactly the same amount of data for
every line at least so anyways that's
that oops : EADS to go on the other side
of the warned still inside the brackets
don't don't put it outside like I just
did a second ago continuing on now we
want to go ahead and plot this so run
underneath candlestick I don't want that
much space but let's just make a little
bit of space so we can see our new star
since Candlestick is on a x1 that's what
we're gonna put this so it'll be X wind
up a lot and we're gonna plot date and
then the way that we do this is - SP :
so we didn't even tie date to that
moving average right we just applied the
moving average to the actual numbers
right and we just happen to know how
many there are and if we
line it right using this minus SP
function we don't actually have to pair
it with another function right and waste
even more processing so this is why
we're doing that and then a v1 and then
again - SP : right so now I'm just going
to copy and paste this so copy move it
down pace and the only thing we really
need to change is a b2 - SP :
so now that'll graph hopefully I think
we've done everything so let's go ahead
and graph able f5 it away and sure
enough here is our Christmas lights so
it looks like because we just have
plotted with like the you know default
colors basically and another thing I
noticed really quick is our chart pet
it's like on our volume here it kind of
shifted it up a little bit so we're
gonna have to fix up that in a minute
but as far as our moving average is
concerned let's zoom into some recent
data here you can see that actually our
simple moving average here is indeed
working right you can see that they're
they're working out so that's good so
we've got our simple moving averages now
the 26 and 12 day and so I think what
I'll do is I'll cut the video here and
in the next video first off we'll fix
this volume issue that's a real easy fix
and then we're also change up the colors
of these lines and also the line
thickness I think that'll be Oh then
we'll add a legend right because
originally it was ebay stock price it
was a candlestick chart so everybody
knew what they were looking at right
with a candlestick chart you know what
you're seeing when you look at one but
here people have no idea what are these
lines so we'll also add a legend the
labels and all that kind of stuff so so
yeah that's what we'll do in the next
video as always thanks for watching
thank you for your support your
subscriptions and until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>