<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Self-driving Car - Python plays Grand Theft Auto 5 p.7 | Coder Coacher - Coaching Coders</title><meta content="Self-driving Car - Python plays Grand Theft Auto 5 p.7 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Self-driving Car - Python plays Grand Theft Auto 5 p.7</b></h2><h5 class="post__date">2017-04-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/CLFp9D9-0Eo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody and welcome
to part 7 of our Python plays grand
theft auto tutorial series in this video
we're going to be doing is implementing
the kind of I guess first attempt at an
artificial intelligent ish driving
algorithm so so one thing I kind of
noticed in the last video was the
following let me just move this stuff
out of the way first so on our road you
know we have the two lanes and then if
we get too far over to one side the well
that now not buying any lines there we
go
well if it does find happen to find two
two lanes it finds our like two lines on
if we're too far over to the right or
too far over to the left it'll find both
lines on the same side right we could do
the same thing over here right it finds
both lines over there now okay so then I
started wondering well hmm what if our
algorithm is simply an algorithm that
looks for actually doesn't have to do
much at all once we find the lanes all
we really have to do is when we have
those two lanes always to do is ask do
those two lines have the same slope so
the idea is basically if the lines are
like both slopes are negative that means
they're to the left of us so we should
go right and if both slopes are positive
that means they're both to the right of
us and we should go left and beyond that
nothing else matters and so I want to
just try that really simple logic before
we try to get too far in depth with like
let's try the center of the screen all
this stuff what if that's if we can just
get away with that simple of a task so
the way we're going to do that is by
going through the code real quick let me
we'll make it a little larger so
everybody can see what's going on if you
don't have the
code this is code from the Verret you
know the previous tutorial but there's
the text-based version of the tutorial
and then also beyond github so you can
get the code from wherever you need to
now in this crazy rat's nest draw lines
function a basically down here here heat
somewhere where is it where's Lane what
okay here the ID basically Lane 1 in
lane 2 ID the IDs were the slopes so
actually that's all we need we're just
going to return those as well so we'll
do lane 1 book you can't see that lane 1
so in this return right we're returning
the two coordinates but also lane 1 ID
and lane 2 ID cool so we returned those
and then now where did we return here so
then that's actually slope 1 slope to
sunshine call it m1 m2 now this is a try
and except and historically all it did
was draw lines if it could find them but
as you've seen sometimes it doesn't find
them so we're going to have to just set
some defaults first i'ma say m1 equals 0
and M 2 equals 0 in this case that way
we'll have some defaults that won't
screw us up if for whatever reason we're
not finding anything but hopefully
that'll be fine then at the bottom we're
going to return process image original
image and then again we're going to
return M 1 and M 2 and then now down
here is where we can make our decisions
but first our decisions are going to be
go straight go left go right whatever
now this is all going to change
almost certainly but first let's just
let's just do something simple like so
we're going to define straight and that
will be press press key W now every time
you go straight straight means you're
definitely not turning ok so so so what
we're going to do every time we go
straight we're also going to release key
and I
I've not imported this or have we not
imported either of these hmm we have a
important you know we did play here so
press key also do comma release key okay
so press key W and then release key a
and then also release key deep so that's
if we want to go straight but then we
might also want to turn so I'm going to
paste paste and then I'm also going to
paste one more thing now we got left now
if we go left what key do we want to
press well we're going to press a and
then we want to release forward most
likely we might not actually want to
release forward but I'm just going to
throw that in there for now and then if
we want to go right we actually want to
press key D release a and release W and
then this one I'm going to call slowly
rolled and this means we want to slow
down so we're going to release all the
keys now okay so now we have the actual
driving directions the other thing we
want to do is we're going to do that
let's see for off for Ike in lists range
for and list a follicle and negative one
to count down free we're in I plus 1
times sleeve one so that'll give us nice
countdown before this thing starts now I
think it's process image right returned
this is prot yet so process image now
returns two more things so for in slow
to so that's here so we also are going
to take m1 m2 now finally after we show
everything
let's do
and also let's go ahead and I'm from the
side we might comment out this one and
just keep this one because this one has
the lines drawn on it that might help
improve frame rate now we're going to
ask if M 1 is less than 0 and M 2 is
less than 0 ie both slopes are negative
then we want to go right L if and 1 sure
it's on screen M 1 is greater than 0 and
M 2 is greater than 0 this is some great
AI oh my goodness I love it let's code
left and finally else we'll go straight
now I'm tempted
I can already imagine we're going to end
up going way too fast
and I don't know it is this is almost
certain to fail but at least give us a
slight idea of how this is going to work
so and the other thing we could do
actually is we could control the speed
and just let it control the term so I
might I might do that if we're running
into trouble but first let's just let's
just try it it's too exciting so I'm
good let's go let's go let's see what
happens here we go count down I'm ready
ok it's doing good
oh ok staying in the lane it's doing
maybe too much turning but it's still
going got a warning I'm not sure what
that just said so it's got the 2 so now
it's just turning and it's never going
forward I'll give it an aide there we go
and we're off
Oh too funny
go little scooter go yes oh yes oh man
this is actually working pretty like
it's not great but it's working
avoid does No now
navigating the turn is hard there we go
we're still we're still running I'm
wondering if maybe what we should do is
let it roll forward even when turning
and then also have some sort of
functionality for I'm just going to give
it a push now since taking too long
so I'll just in the in fact I'll just
keep holding forward and just see how it
does up oh we're freaking no we're done
[Laughter]
okay oh my gosh that's too great yeah
that's why we picked the slow vehicle
but yeah wow we are we still falling are
you kidding
oh man that's hilarious oh my gosh
alright take two so now what I'm going
to try to do is see if that was indeed
the problem like if if we can just kind
of modulate a speed not go so fast but I
think also part of the problem is every
time we take a turn we might want to
remember to make the turn and release
relatively quick I'm thinking like you
might not want to hold that turn for
very long so I just wonder if we should
throw a release key very quickly like if
we just want to tap that key real quick
but not hold it down because the problem
with GTA is like especially driving with
a keyboard is the terms are just so fast
and so violent it's just like a full-on
turn every time anyway that was actually
I'm pretty content with the logic and
how well we did it might have looked
pretty bad I mean probably killed
ourselves but I'm actually letting it
drive itself right now it does pretty
good on a straight turn dark
oh we made it haha wow we almost did not
make that turn though that would have
been dad you doing good I'm impressed
turn nice that's actually working pretty
well he's gonna get he's probably gonna
go off up here he's getting too fast
let's see how he does oh no no oh oh
yeah he's done it's over game over so we
got going a little too fast and I'm
trying to decide maybe what we should do
is like after so many straights like if
if we pressed go wow if you actually get
some stuff out of this it's kind of
moving but not enough but I bet if we
just go forward he'll he'll solve his
problems maybe maybe not
nope he's going back up the mountain
anyway I think what we could do is
possibly on log how many forwards we've
done and then maybe either one thing we
could do is rather than trying to slow
the speed we could turn more sharply
based on how fast we believe ourselves
to be going possibly I'm not really sure
I'm not really sure how we can know the
speed without some sort of mod to the
game and I was really hoping not have to
use mods to get other game data is
really hoping to be able to just do this
completely with just the AI there we go
back in back on track that's actually
pretty cool like I just had to barely
turn around I'm impressed
I noticed the probably looks horrible
but at the same time I'm uh I'm pretty
content with this yep I'm excited I
don't care what you guys yeah this is
cool so I can at least navigate this
very nice very nice felt very well done
frames are very slow though we're got
like to point basically to so almost
like fibre Leto we're gonna screw up
here oh we're done we're done yinz no
all right so uh we definitely have some
things to work on mainly it's just if it
gets too fast it doesn't take actions
quick enough so I'll have to think of a
good way to handle for that because if
we if we stayed a static speed it's
actually fine and we could just probably
maybe make it so we are only going to
press forward so many times in a row and
then like cut it back so maybe like it
like the last X moves or a forward
release the forward or something try to
think of how I would handle that to be
honest I wish I could think of something
good for that I don't know I'll think
more on that and try to try to get
something because really actually that's
how is performing pretty well until we
got going too fast so I'm pretty excited
about that that's pretty cool so though
if someone can come up with a better
lane finding function otherwise or to
just improve or frames-per-second in
general do please share or if you come
up with some different logic or
something like that please you can also
share that but I'm pretty impressed with
that
I might even just keep building on top
of that because the next thing that
we're going to have issue with is
traffic and intersections and then also
maybe I'll move us to another location
and see how well we work in another
location besides just this one because
we've kind of created everything for
this area anyway that's pretty exciting
our first self-driving scooter um that's
pretty cool I'm very excited about that
I wasn't I wasn't sure how long that was
going to wind up taking especially after
the last tutorial and then all of a
sudden it dawns on me hey what if you
just use whether the slopes of the two
lanes because we're almost always
finding two lane
it's just that sometimes it's like on
double size order cool I'm pumped I'm
pumped okay so anyways questions
comments concerns whatever feel free
leavin below otherwise I will see you in
another video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>