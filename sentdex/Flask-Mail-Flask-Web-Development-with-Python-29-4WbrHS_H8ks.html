<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Flask Mail  - Flask Web Development with Python 29 | Coder Coacher - Coaching Coders</title><meta content="Flask Mail  - Flask Web Development with Python 29 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Flask Mail  - Flask Web Development with Python 29</b></h2><h5 class="post__date">2015-11-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/4WbrHS_H8ks" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to
another flash tutorial video in this
video what we're really talking about is
flask mail
so flash mail is actually pretty
powerful for mailing within flash so
powerful that honestly I would probably
use it even if I didn't have a web
application I don't know of any other
mailing with Python service or module
that you can use that is as simple to
use as this yeah as powerful so this is
the link to it I'll try to remember to
put it in the description if I forget
you can either ask or you can just
Google flash - mail and it's definitely
something you should look at but we'll
kind of zoom through just the basic
sending an email doing you know subjects
text and HTML and the email just keep
that in mind - head there if you have
anything else you want to look for so
the first thing you have to do is you
got to install it so if you're
installing to the virtual someone ask a
question how does a how how does our
server know whether or not we're in the
virtual environment right like remember
we set up the virtual environment in the
beginning well for most of this tutorial
we haven't actually been using the
virtual environment I mean it's there if
you want to use it but we haven't really
been using it so you can either install
as a virtual environment if you want or
just to your server for me I've always
just used servers and I rare like if I'm
going to move a server I generally take
a snapshot of the server and then move
it so I've never really had the need for
a virtual environment but if you're
gonna host it to github or something
like that and you want people to just be
able to download it a virtual
environment can be a better option
so anyways moving along but but on
github there is a requirements so
someone copied it they could
automatically install the Python
libraries anyways anyway munna long so
you'll need to do you know your sudo pip
install flask - me like M&amp;amp;S caps or not
but yeah it does its capital F capital
em anyway install flash - male
last - male I already have it so this
won't really do anything but so you'll
get that and then you're ready to rumble
from this point so the first thing that
we'll do is we'll head to the init dot
pi and once that's up what you'll want
to do is SMTP lib I believe we were
using that to notify using an older
emailing tactic I have that one is just
really easy to send a quick email but
you can't really customize very much so
anyway just in case you were curious
what yes
you shouldn't have to import SMTP Lib if
you're not using my emailing thing so
we've got import SMTP Lib but then what
we're gonna want to do is we're going to
do from flask underscore mail import
mail and then we're also gonna wind up
needing message so import message as
well that's one thing I don't like about
this documentation if you go through
this documentation you see that you have
to import flask of course you've got to
import the mail and then they've got
mail app and then you get all the way
down here to sending messages and if you
forget to do the whole flask import
message you're gonna get an error that
message not defined the first time I
went through this I didn't realize that
the other thing that I didn't like is
let's see up here yeah when you define
mail here you can configure this in a
variety of ways but generally I'm at
least from what I've seen most people
configure it within their application so
this again throws people for a loop and
I'll explain why here in a second so
moving this out of the way you'll want
to do again from flash mail import the
mail and message next what we want to do
is underneath the definition of app
equals flask name what you're going to
want to have is some some configuration
now I've got this on the the sample to
sample code this tutorial text base
tutorial Python program at net so I'll
link to that in the description so I'm
just going to copy and paste because
there's really no not much point to
write all this out and
let me just explain it so debug is is
just set to true I'm fairly certain the
only thing that that is is basically if
the email fails for whatever reason the
air that will be displayed is the actual
error so on a live server you might not
want debug true because it might show
like if somebody's trying to figure
something out it will show them the
exact error and that's helpful for for
debugging right and that's also helpful
for for hacking into something so you
would want to set that eventually to
false if you're gonna use it in
production and just set it to true when
you're just simply trying to debug mail
server I have it set to the Gmail server
because I was going to I use a gmail
account and then also I you know using a
gmail account just seems to be the best
also Gmail rarely goes to spam as
opposed to a lot of other emails that
you might send automatically they'll
they wind up in spam very often mail
port 465 there is another one I forget
what the other one is it's like two six
maybe or five hundred some I don't know
you can look those up but 465 should
work no problem use SSL cool and then
here is where you would enter your
actual email address and your actual
password if you wanted you could use
encryption to encrypt this password and
then have your little key decrypt it
right as it went to sent really doesn't
matter it's just if you wanted to hide
it basically in your script you could do
that
after all of that you need to say mail
equals mail app you have to do this
definition after the configuration
otherwise you're gonna get some problems
now what you would want to do is come
down somewhere and start the mailing so
like if you wanted to mail let's say
we'll just copy this you would come down
here and paste and let's say let's just
call this send underscore mail and then
let's say the URL you were gonna visit
was send mail and basically you probably
you should have try and accept here
especially if you've got the bugging
exception
a turn stringy and what you're gonna try
to do is you're gonna try to send an
email and for example I think what I'll
do probably yeah I'm just gonna copy and
paste this again no real point in
wasting a bunch of time writing that out
and then return you got to return
something otherwise you're gonna get 500
error so we'll just say mail sent so a
lot of times you're gonna send mail and
you're gonna return an actual you know
HTML template so I'll talk about a real
example that I've been using anyway here
in a second
but at the very basic level this is all
you would need to do to send an email so
here you've got the the message right
the message is basically class okay so
yeah it's an object from a class and so
you've got message and you're just
saying that is eat the equivalent of the
message it's a message object from flask
mail this is the subject of the email
then you've got sender this would be who
it's coming from then you've got
recipients these are this could be just
a single recipient or you could put a
huge list of recipients in there
although if you put a massive list you
may wind up in spam and then this is the
body so this would be simple text right
so you can use like a new line to create
a new line but that's about as fancy as
you're gonna get as far as a you know
styling your email so when whenever
you're ready to send it just mail that
send message and if everything was
successful it'll say mail sent otherwise
you'll get a an exception now here's the
problem sometimes what you're gonna find
is the things just don't work out for
you so for example let's go to my
website using this let's say let's save
that come over here and let's restart
here sued there we go okay so then we'll
head to let me go to
is okay so I'm on the server and then if
we go slash send mail
well at least oh well I don't have the
right username and password in there but
you'll you'll get an error that looks an
awful lot like that okay so probably the
more popular here that you're gonna get
is not that your password is wrong but
you'll get in there that looks like this
let me just do this okay and it's gonna
be like hey you know please login to
your web browser blah blah blah learn
more at this link here okay so you'll go
to that and it'll basically be in like
some information on why you might not be
able to log in and that would be here so
this gives you a bunch of options you
can if you've got to a two-factor
authentication you need to set up an app
password which Google will tell you the
same thing but obviously that kind of
nullifies your 2fa okay I mean it's not
total it's it's a little more secure
than not having to FA but at the end of
the day you've got an app password that
circumvents two-factor authentication so
I would not use this on any email you
want to have to FA on next up you've got
this this just says sometimes if you
just sign into Google you can access the
app or you can basically run it through
your app again that's really never been
the case for me but you can try it then
also there's this you can turn off
display unlock CAPTCHA basically what I
understand this to be is Google realizes
as a program so it sends it it tries to
get it to solve a CAPTCHA and that's
like a security measure for your account
so people don't just brute-force your
account but in this case we don't want
that we don't want that cap checks we're
not solving that CAPTCHA so you want to
turn that off then next you have to
always allow less secure apps to access
the account that's always the case on
Gmail and then otherwise there's these
two things which have never been the
case now even if you do all of that you
might still be shut out of your account
and that's what's happening to me on
this
server and I think I don't know for sure
Google doesn't really tell you this but
my guess it has nothing to do with you
the email itself the Gmail because I use
the exact same Gmail on my other servers
and a problem but on this one I think
the problem is this is like this is a
you know it's just first of all it's
just an IP there's no domain that's
associated with it there's really no
there's nothing for like no reputation
to this server and I think that's why
Google is saying no and it's probably
for like anti-spam so obviously if you
can send emails via program spammers
that's what spammers want to do it's
really easy to sign up for a gmail so
this is kind of Gmail's way of making it
easy for legit people who sign up but
hard for programs sign up so anyway
that's that so if you're trying to do
this and for whatever reason it's not
working it might be your server try to
like maybe link a domain name to it a
lot of times as long as there's a domain
name it works but anyway that aside
moving along I'm going to show you the
code that I run with Python programming
net the actual code so let me get rid of
this line here and basically what what I
do is this would be from the forgot
password from Python program net-net so
basically what we send here is we need
to go over one more and that's coming
from here let me go there and should you
go to login and for whatever reason you
can't figure it out you go to forgot
password and you just fill in your user
name and it sends you an email with a
special link and stuff like that so the
way that works is here once everything
checks out if that username exists on
all of that
the center is going to be Python program
net at gmail.com the recipients will be
whatever that person's email address we
find that in the database and then we
come down here the message body is just
going to be this is this is if the user
does not because you'll notice there's a
body and an HTML body is for if if the
user for whatever reason is on
vice that can't read HTML so if they're
on like a really old-school phone or
something like that like if you're if
your clientele is like emerging markets
you might want to think about having
both of these otherwise you probably
don't need both but it's always good to
have them just in case and then after
that we've got message HTML this appears
to me to be the defaults no matter what
I always send these two and the one that
I've always seen is this what's neat
about the HTML is you probably seen as
time has gone on as a lot of companies
have very good looking emails I've got
pictures and it's they've got stylesheet
so I'm going with them and stuff and you
can do that too so sending this HTML it
renders this template mails reset
password' HTML and that HTML is actually
really really really really simple but
you can do some pretty advanced HTML but
this HTML is that I use is pretty simple
I'm just gonna paste it on in here like
that so it is it's just like any other
template you can pass variables to it
this one just uses paragraphs and it
also uses a dynamic link right so or a
link that you can actually click right
and so it's not like the most advanced
HTML but that's just a basic example of
yeah yep you can have it a template and
load simple HTML obviously if you go too
crazy you have too many images and stuff
I wouldn't rely on that because a lot of
like emails are gonna just naturally not
show the images and the user has to
select yes show images so I wouldn't
really rely too heavily on images but as
far as styling is concerned and divs and
all kinds of cool stuff you can make
your emails look look pretty darn cool
so anyways that's just a quick flask
email tutorial it's I think is like I
said it's like the best mailing that
I've ever found with with Python because
it's just so simple you've got your
subject you send receive your body HTML
and setting it up is as easy as this
right here right so super easy super
quick super reliable the only problems
I've had is the email just simply not
going through even though everything's
right and like I said I think that
really are
see you have to go through the other
options you will have to turn on less
secure apps and display unlock CAPTCHA
but if you go through all that and still
not work in its pride just your server
and it's the anti spam spam measures
from Google anyway other than that if
you guys are still having trouble or
whatever feel free to leave comment
below and I'll do my best to help you
out
in the next tutorial we're gonna be
talking about returning files so you
know we return templates all the time
but what if you have like some sort of
download button or something like that
where you want the user to be able to
download something or maybe you've got
like a PDF and you want to return a PDF
how would you actually do that so that's
what we're going to be talking about in
the next tutorial so stay tuned for that
otherwise thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>