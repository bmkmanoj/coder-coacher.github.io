<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Joining and Merging Dataframes - p.6 Data Analysis with Python and Pandas Tutorial | Coder Coacher - Coaching Coders</title><meta content="Joining and Merging Dataframes - p.6 Data Analysis with Python and Pandas Tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Joining and Merging Dataframes - p.6 Data Analysis with Python and Pandas Tutorial</b></h2><h5 class="post__date">2015-09-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/XMjSGGej9y8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to
part 6 of our data analysis with Python
and pandas tutorial series in this video
what we're going to be talking about is
two more forms of combining data frames
and that's going to be merging and
joining data frames now with merging and
joining the main difference between
these two they're basically going to do
kind of similar things but one will kind
of honor and index and the other one
doesn't care about your index so anyway
hopefully by the end of this you'll
understand which is which and why and
why you might use one over the other so
first I will put a link in the
description again we are going to use a
sample code that I've already kind of
pre written out copy paste if you're
coming from the previous video and you
already copy and pasted this and you're
thinking I don't need to do that again
you do I did change I believe the only
major thing change though is
unemployment here and I've just kind of
filled in some new values so if you want
to do that go for it anyway if you don't
have this check the link in the
description it'll lead you to the
text-based version this tutorial copy
and paste this information and you're
ready to rumble it's right at the top so
first of all we're going to cover is
merging so let's merge we're going to
just print out the results here so we're
going to do PD merge and we're going to
merge DF 1 and DF 2 and then when you
merge you say where you want to merge so
merging is going to kind of ignore the
whole notion of index so we're going to
merge on equals HPI we're printing out
that result so here you go
so we've merged on HPI and you'll notice
that first of all on HPI let's move this
down there are 1 2 3 4 HP is 1 2 3 4 ok
but we ended up with more than that now
if we come down here you'll see that
well we also see you know we've got this
other information here 2,000 5,000 6,000
2008 and what's happening here is we've
got some duplicated data now that's
obviously not very ideal so what is the
situation we're merging would be ideal
well here HPI has some shared
information between these two but then
there's also you got interest rate and
then you've got US GDP thousand so
there's also duplicated columns here so
you could ask well Harrison what if we
make this a list can we merge on
multiple columns well you sure can
they're little student in underscore
rate you can print that out whoo now we
don't have such bad data duplication
look at us so there you go you've got
HPI interest rate and then but we still
got this u.s. GDP thousands X&amp;amp;Y now of
course we can get rid of that by adding
US GDP thousands here but then why are
we merging these to it at all
this is DF 1 DF 2 and now we've lost
these the index entirely so that didn't
work out so an example of why you would
merge in reality is like let's say
you're running a website and you've got
users on that website and you've also
got forum or something like that so when
a user registers to your website you're
going to have to log their username
their password hash hopefully your
hashing and maybe an email okay so
that's in a user registration table in
your database and then you've got a
forum which might have liked the post
count joined a reputation on the forum
other posts and then maybe you've got a
user account information like their
settings and stuff like that okay you
could have all of that information in
one table but the problem is that table
would be huge especially including the
forum posts and stuff like that so
regular queries would be very slow
you wouldn't want all that information
in one table instead what you do is you
split them up make it nice and efficient
split them up and all those tables would
share the same single column of what
well username right that's how
everything is related all these other
tables are related to each other they're
related by user
so you would pull from all those tables
you could merge on username if at any
point you needed to access all the
information at once
unlikely but maybe you would for
whatever reason or maybe you're
migrating or what if what if that user
wants to change their username or
something like that you'd have to be
able to go through all of those tables
and make the changes or something so
anyway
merging would be an example there or
maybe maybe you didn't have all the
databases split up and then you want to
bring them together or you know stuff
like that you know there's all kinds of
reasons why you might want to merge but
anyway that's why you might merge in
some scenarios in our scenario we're
going to merge oh well we're not going
to merge well we're going to bring
things together based on the dates so
we're going to have housing price index
values for every states what did they
share in common a date index so we bring
them together now anyway that's your
merge and you can merge again yeah no
problem on multiple columns and after
you're done merging you could always you
could you could set the index value if
you want it so they would have their own
little index but that's kind of silly so
now we're going to go ahead and do is we
can do a join instead now we're going to
join DF 1 and DF 3 the problem with DF 1
and DF 3 is they not only share an index
already they also share a column of HPI
so so what we're going to do is we're
going to reset the index on DF 1 and DF
3 here so we're just going to say here
DF 1 dot set underscore index we're
going to set the index to HPI and then
we're going to say in place is going to
be equal to true we're going to take
that copy-paste put this DF 3 so now
they share an index by no columns okay
so it's kind of important with join so
now we're going to say join equals D f1
dot Giulini DF 3 and then we'll print
out joins
like that and now we've been joined by
this kind of this HPI index okay
now you should notice that again we've
got some data replication going on here
so not the most ideal scenario now what
if they had different indexes like for
example what if let's take let's just
remove d f2 for now and let's remove the
original indexes okay so you should have
information that looks kind of like this
and then what we're going to say is we
will I want those years back oh well
that's okay we're going to say will
replace HPI at the top here so they have
totally different
we'll say year here in a year here and
then we'll just empty this empty this
now this one I'll have 2001 2002 2003
and 2004 this one will have 2001 2003
skipping 2002 2004 and 2005 okay so now
this one misses 2004 that this one has
and this one's missing 2005 that this
one has what's going to happen it's
gonna be crazy
so so now what we're going to do is
we're going to go ahead and we're going
to delete all of this stuff here and now
we're going to save load equals PD dot
emerge and we're going to merge the F 1
and D F 3 and we're going to say we're
going to merge them on equals year now
let's go ahead and print print verb
save and run and you'll see we got at
least some stuff well let's go ahead and
set the index to two merged because it
merged on year but years like over here
but you'll also notice we're missing
both 2002 and 2005 that's because in the
default way things are merged but when
we'll talk about that in one moment
let's go ahead and do merge dot set
underscore index and we're going to set
it to what we were murdered on gar in
place equals true good to go okay so now
what we're going to talk about is how we
merge so if you're familiar with SQL you
can merge databases in SQL and for the
reasons I discussed earlier is why you
might merge databases or tables rather
and there's multiple ways that you can
do it so you have basically four choices
you've got left right outer and inner
left and right respond corresponds to
these right here this is left this is
right okay it's just like the side it's
on so DF one is your left DF three is
your right so if you merge on I'm sorry
if you merge how left like so who say
how equals left like this it's going to
merge based on EF ones keys which is
year here is our key here so it's going
to merge based on DF ones ears so want
you know two thousand one two three four
so we'll save and run that real quick
sure enough we did two thousand one two
three four it just so happens we don't
have any information on low-tier HP on
unemployment because for two thousand
and two because that's coming from DF
three right these two and this didn't
have values for 2002 okay so that's how
left-right would you need basically the
values from DF three so we should get
two thousand one three four and five but
we'll have some not in numbers for 2002
so that data just didn't exist
or rather 2005 sorry to tell you two
won't be there because that's one of the
keys of df1
now the next thing is you've got outer
and inner so outer joins on what's
called a union of the keys so basically
all of the keys will be represented here
so we'll say outer and so now you've got
a one two three four and five and just
some knotted numbers where there's no
data finally you have inner this is the
default this is where the keys intersect
basically so if there should be no not a
number data here well I mean there could
be if there was a not a number in this
data frame I suppose but basically every
one every you know key right for year
that both data frames share will be
represented here in our case we have no
not a number data in either data frames
so there should be no not a number data
but that doesn't mean that you could
merge on inner and never have known a
number so anyway so those are the
various ways that you can merge data
frames but again the main focus of
merging is to merge on a specific column
and the reason why you might do that is
is if you share a column and you're
trying to bring together two data sets
that share a column whereas if you're
trying to merge or bring together data
frames based on an index as you saw
before index is basically treated like
crap by concatenate and append that
neither of those really seem to care and
even merge merge doesn't seem to care
either about indexes whereas with join
indexes honored so in our case with say
we've got all these data frames that
have index values that are shared for
the date that will be honored and we
want that to be honored so we're
probably going to find ourselves using
join okay so those are the four main
ways of combining data frames with
pandas each has their own kind of reason
why you might use it and we try to just
cover some of the basics of why you
might use each one generally I find
myself mainly using like if you've got
data frames that have similar data
between them you're going to use a merge
or a join you would use merge when the
index does not matter to you join when
the index does matter to you you would
use concatenation or a pending when
usually to in long gates usually you can
concatenate and add columns with
concatenation but I rarely find myself
using qunk at for that but you might
find that you like that better or
something and then also appending to add
to the end now anyways that's it for the
combining in the next tutorial we're
going to be talking about pickling
before we get into actually creating
this data set I will actually we will
create the data set so before remember a
few videos ago I think video number 4
tutorial 4 we talked about you know we
at least spit out that list of tickers
basically that we would query quantal
for now we'll actually pull the data
frames we'll start joining the data
frames together and then we'll talk
about pickling so pickling is just where
we can kind of save our progress in the
script we can save any object in Python
basically so variables data frames and
all that kind of stuff fair game with
pickle so anyways that's what we're
gonna be doing in the next tutorial if
you have questions comments concerns
suggestions feel free to leave them
below otherwise as always thanks for
watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>