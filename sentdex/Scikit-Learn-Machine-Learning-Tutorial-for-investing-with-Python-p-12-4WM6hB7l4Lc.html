<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Scikit Learn Machine Learning Tutorial for investing with Python p. 12 | Coder Coacher - Coaching Coders</title><meta content="Scikit Learn Machine Learning Tutorial for investing with Python p. 12 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Scikit Learn Machine Learning Tutorial for investing with Python p. 12</b></h2><h5 class="post__date">2015-01-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/4WM6hB7l4Lc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">everybody and what's going on welcome to
the twelfth tutorial video in our
machine learning with scikit-learn for
investing with as an example tutorial
video in this video we're going to so in
the last video I showed you guys a
really basic example of just using
numbers and showing how we can use
linear SVM in this video we're going to
kind of add a little bit to our data so
so far we just have a de ratio we don't
really have anything else so I mean
we're gonna use difference I suppose but
I think now's as good a time as any to
go ahead and just add a bunch of other
you know bits of data that we might be
willing to track so with that let's go
ahead and get started so what I'm gonna
go ahead and do is I have this list I
don't really see any useful reason to
make you all type this list out with me
therefore I'm just going to copy and
paste it and you guys can
I'll put I'll put at least a list in the
description but I also eventually get
around to posting the entire sample code
anyway so you could get it there as well
but I'll put the list in the description
so you can follow along with everything
else but I just don't really see the
point of having everyone have to type
out this list so let's begin the first
copy and paste job will be right here
under key stats and in this gather
element right now it's just gathering
one thing and instead it's actually
should be a really large list so I'm
gonna go ahead and copy this list I'm
gonna do this and I'm gonna hit paste so
again check the description I'll put
this list in the description if I don't
somebody yell at me and I will put it in
there ASAP so this is the new list and
so as you can see we've added quite a
few new features we're trying to just
track basically everything that I
thought might be interesting if there's
more data that you'd like to add to this
list by all means go ahead and do it I
don't care so once you've done that we
have basically three places that we have
to have this stuff in theory gather and
columns could be almost exactly the same
but again columns has a little bit more
palms then gather and then finally again
down at the bottom basically like right
here is where we would append a bunch of
stuff so yeah anyway so once you done
gather the next thing that we're gonna
go ahead and update is going to be the
data frame definition so basically right
here I'm gonna again copy and paste
again it will be in the description so
please just check that so I'm gonna copy
highlight all this paste boom and the
main new elements here are basically
everything from here down
I also am changing de ratio or did I
change de ratio I think de ratio is the
only one that's called something
different than what it really is yeah
anyway uh continuing right along we're
gonna go ahead and come down here and
we'll leave this the way it is from 1 to
25 just to keep it short and simple
and then basically we'll come right down
here for the 4 file in each file element
here and all this remains but we're
gonna go ahead and first we're gonna add
four days see see if we have a gander
here no so now before we only had one
thing that we were gathering and now
we're kind of converting this into a
list right so that was our original
intention anyways but now I've got a
list of gather so we come down to here
and once we've defined source what we do
is we come down here a single try then
we're gonna do this and we're gonna say
the following we're gonna say value
underscore list equals it's an empty
list and then for each element in the
list we're going to append that value
and that the very end will append that
value to each column in the data frame
so we've got value list here and then
we're gonna say the following basically
so valueless and then we have for each
data so weeds bit of data in gather we
want to do the following so now we do
take this try that
ones that accept that try to this is so
that miss that missed this and basically
everything okay so basically for that
all the way up to see this try all the
way down to here so I went a little too
far now I can't find my mass there we
are
oh my gosh there oh it's so hard to see
it when I've highlighted okay so
whoops alright so for each data
basically this right here is what we
want
we'll hit tab to tab that over so we've
got that try try this
except this that should be fine and okay
so now we've done that basically what
we're gonna do here is we're gonna add
like a little bit more fancy regular
expression here because now our data if
we were to open it up for example let me
just do this bring this over here and
let's say I have mine and intra plus the
intra quarter or so I thought backups
intra quarter key stats and then let's
just pull one up really quick Oh Dan
here okay so here's some examples here
so just some things that might screw us
up right out of the gate we've got
things like bit like these like
superscript here three you've got things
like percentages here
that's a percentage B four billion M
four million that kind of stuff is gonna
mess us up and you could say well let's
just get rid of the bees and ends well
then we don't know is this a millions or
is this and billions and that matters so
anyway we have to handle basically all
of that and it's okay you could do like
an instance for be an instance for M an
instance for a percentage an instance
for subscript or superscript or
subscript or you can just do one line of
regular expression so um we're gonna go
ahead and do that so
what would go ahead and do I think
actually uh we were going to just go
ahead and keep you know some of this
original code but I'm just gonna do this
and we'll have except exception as E and
then basically what we'll do is value at
this point we'll just equal capital n
slash a because in this scenario you
know we couldn't find it for whatever
reason so we'll just call it not
available or it might even be not
available and then just before we forget
value underscore list dot append and we
append value so in this setting we're
depending that but now we're going to do
the actual what we're hoping will work
and that's this bit of data here so I'm
just gonna highlight that and hit delete
so this is gonna be a rather long
regular expression so put your reg X
hats on and let's begin so to begin
we're going to say try and we're gonna
say reg X and we're gonna see this reg x
equals R e dot escape and the reason why
we're doing escape is because the
following we want to be able to escape
each data I think yeah okay for each
data pretty slow I'm recording this
after Christmas Day had a very long a
lot of driving going on so my brain just
isn't really working so I apologize
anyways so read escape each data up here
and we have to do escape because of this
variable it could contain things like
for example short percentage right there
we have a percentage and other things
that will just wreak havoc so escape
each data and then we say plus and now
we're gonna input our regular expression
I putting this all on a new line I'm not
positive I should be able to but this
regular expression is gonna get kind of
long it's gonna go off the screen but I
guess we'll work with that so our
opening will add the closing just for
good good measure and now we're ready to
build a regular expression so if you
guys remember before we started with
you know some simple splitting and the
splitting was literally gathering what
are we gathering so we're gonna
basically handle that with oh well we
start with gather and we are here right
this is the original gather but then we
have all this nastiness like subscript
superscript percentages all this just
junk so we're gonna handle that with the
my favorite little regular expression
that I use all the time period asterisk
question mark which basically handles
for almost everything and doesn't handle
for the stuff you don't care about so I
just love that expression I hope you do
too so now after we handle for that
we're basically gonna handle for that
all the way up to until it finds the
following and so with regular
expressions you in case what you
actually want to discover inside
parentheses so within our parentheses
here we're going to be looking for
hopefully a digit that digit will be
anything from one digit long to eight
digits long and followed by a plausible
actually it should always have a decimal
the only time we may not have decimals
or the only time we pretty much will
never have decimals is I'm trying to see
if we have an example of I was gonna say
outstanding shares I'm not seeing out
saying shares here at a quick look but I
almost can guarantee you that they have
outstanding shares in that case you
won't most likely have a decimal but
we're not really worried about
outstanding shares the only thing we
would use outstanding shares for is to
gather the actual market value or I
can't think of the word market cap there
it is so if you're trying to figure out
market Cabot's outstanding shares times
prize boom market cap but we already
have that's actually listed so we don't
really need it anyways but moving on so
digits one to eight followed by a period
since a period is a regular expression
in itself we have to do a backslash
period followed by backslash d for digit
and now we're again looking for anything
one to eight in length subsequently
after that digit what do we have well
let's bring this bad boy over so we've
got you know our digits we just did that
we just did the period then we just did
the more digits followed by a possible B
a possible M and then also we might
actually see a percentage design so so
next we might after this digit we might
have a M possibly with the question mark
we might also have a B capital B
possibly so we have a question mark the
question mark signals zero or one
we better not find any more so M B and
that is it now we as I said we might
actually find a percentage sign but we
actually don't care about percentage the
percentage in itself is normalized so we
really don't care whether we say a
company has a trailing annual dividend
of 0.7 or 0.7 percent the very label of
trailing annual dividend insinuates it's
going to be a percentage so that's okay
same thing with return on assets we
already know that's basically always
reported in percentage form also our
actual machine learning need not know
whether that number is a percentage or
anything but it needs to know whether
that number is a billion or a million so
we have to obviously or not right so we
have to measure for that so moving right
along you might also have to measure for
a K if you're doing some stocks so you
can put a K in there question mark now
what about I don't see anything in this
list no but don't let me open up let's
look an apple really quick I bet I can
find one with Apple yeah okay so we
scroll over here we look at Apple we see
Apple has an operating cash flow not
available and a leveraged free cash flow
as not available
and a whole lot of other stuff that is
not available so we obviously need to
account for that if it's not available
basically none of this stuff is gonna
appear so we're either looking for this
or I'm gonna get rid of this K for now
I'm not gonna be handling those whatever
so we either want to find this within
our other again the parentheses in cases
everything you that you would want to
find right and everything outside of the
parentheses just kinds of hell
the regular expression locate that
whatever regular expression is in the
parentheses so for us we're either
looking for that or and we use a pipe
for the thought of or and we can say or
we are straight up looking for a capital
n /a for not available now now that we
close off our parentheses we're not
looking for anything anymore and what
did I say on the outside of the
parentheses we're looking for just the
stuff that surrounds the stuff that
we're looking in so we have to handle
for the percentage sign now so we had
the percentage question mark because we
might have one way minot but we won't
have two or three and then finally we
close off table data which is lowercase
TD so the closing tag for a table data
in HTML and that is it so so that's
basically all there is to it with that
regular expression I thought we would go
off the screen but we did not so bright
Bravo Bravo next we're gonna say the
value equals R e dot search we want to
search using the regular expression of
reg X which is right here mute my sound
so we're gonna search by ray X and what
do we want to search it on and that is
these source which is basically the
source code that we already have so we
do that and then we're gonna say the
value equals value dot group and then
one okay so that gives us our value now
we basically don't really care we used
to handle not available but we don't
need to because if it's not available
it's not available and that's fine with
us now but then we're gonna handle for
the bees so the billion and the million
so if Big E capital in value so if
there's a bee it's a billion that means
now value is going to be equal the
floats of value dot replace B whoops
capital B with nothing so we're just
kind of removing the bee from the
situation so it's the value of the float
of that times 1 billion so one one two
three
one two three that should be a million
one two three so that should be a
billion let's check that one last time
one billion million billion good okay
cool so then we're gonna say L if M in
value whoops we don't need that question
mark basically the same thing minus
three zeroes so one two three although
we need to replace the M so times 1
million and that's it now after all of
that we're gonna go ahead and say value
underscore list dot append value so we
append that value to our value list good
good good good all set and I think that
should be pretty much it for this oh the
only other thing we have to add is down
here at the very very bottom huh this DF
dot append again I'm gonna copy and
paste it I don't see any particular
value and making you all do the exact
same script here right so first let me
copy and paste it so it's DF dot append
actually there's a little bit of other
code we're gonna write real quick so
let's go and write that real cool so
we're gonna say if value on our score
list count and we're gonna count the
number of instances of not available and
initially we can say if that's greater
than zero pass and I'll let me talk
about that in a second
actually I better talk about it now
before I forget so what are we doing
here
we're saying if the value or if the
account the number of occurrences of not
available if that's greater than zero
and we want to just forget about it okay
so in this case we're going to toss out
that data and so in machine learning
when we do our features the kind of the
problem is what do you do with missing
data or data that you know to be corrupt
and so you can either kind of normalize
this data you can set the data equal to
the nor
or the average if you want you could
just toss it out some people value it as
say negative 909 something like that so
it's like clearly way off the charts and
you let the machine learning algorithm
recognize that as an outlier thus
ignoring the outlier so you do all kinds
of stuff so but for now we're gonna say
pass and then later on you might use you
might set a different value for this so
in the case of let's say the stock file
is non-existent or it's empty it's gonna
get not available not available
you know huge list of not available so
you can say if you know the amount if
the count if not available was higher
than 10 let's just toss it out we don't
want that anymore okay
for now I'm gonna set it to zero you can
do what you want later on I'll show you
kind of both things and we'll test
against you know what if we use it as 0
what if we use it as negative 9 9 9 what
if we use it as the average right so
it's just if we don't have a value we'll
just set as average and I'll be fine
stuff like that we'll handle for that as
we go on and we'll see if you know what
what kind of changes we get there
otherwise we're gonna say else and then
we're going to append basically
everything to this and I'm not totally
confident in this exception has mama I
think it does like way up here yeah this
is the mother try so we don't need to
touch that so we just need to tab this
over basically so I hit one tab there Oh
make some space here bring this back up
and now I'll make this data frame again
this will be in the description so
please don't feel like you gotta like
pause the video and type this I just
horribly mean of me but anyway this is
all the data and what we're doing
basically I mean these are all the
values that we were finding before you
should understand what's going on there
and then basically here at this point
onward is where we're appending based on
the VAT on the the list element because
the order of the list elements is the
same
order as this gather list which is this
so we just know that that's the value
okay so who knows long I'm tired but I
think we're done and we're ready to run
done and run baby okay now we don't
really need to remember we were saving
is gather you don't really need to do
that anymore
so I'm gonna delete these two lines PLT
dot show we don't need this code right
now to be running so all three there
that will comment it all out and then to
CSV and we'll call this CSV key
underscore stats CSV we'll save that and
let's run it and see how many errors we
get what if we don't get any errors guys
that would be just exceptional we didn't
get any errors but let's see if that
file is empty that's a pretty what hat
what have you done here there we go and
we are looking for key stats so this
would be mine that we just made now it's
go ahead it with notepad it looks like
we've got some some packaging here nice
and here it is fabulous
so really did work I thought for sure I
would mess up I'm so tired today okay so
here's our data and we've got all of our
columns here all of our possible ants
you know all the stuff here and then
here are all our values and you'll see
that basically everything here has a
value it's even off off my screen let me
pull it back onto this version anyways
see this is just a huge list of all of
those values and so now we can use these
we have you know like 30 or something
dimensions we have a lot of dimensions
of data so anyway you got 35 basically
so that's that we've got a huge list of
our features so to speak now and the
next thing that we want to do is
actually perform a machine
you know basically train and test and
see how accurate are we so if you recall
the the previous video from here this
part is actually really quick and simple
so we can actually run this test very
fast now I will just say I'm gonna cut
the video here but come up to the very
top P R where is it and Wow
where the list were we just don't here
it is okay one and seven 225 do 1 2 :
okay so before you start the next video
make sure this script has run all the
way and you have a large key stats file
that has just a bunch of rows with 0 not
available data again we will test for
all doing all sorts of things to not
available data so we'll kind of play
with that list index out of range now
this looks like my code interesting a
colon or a semi colon oh that looks like
mine I just did that as an error so this
was to get the stock price at the time
we might have to upgrade our valuation
or figuring out of what the stock price
is at the time I can't remember well how
we handled stock prices that were
invalid let's come back over here so
this is a each time that occurs it just
pops up I guess once says probably okay
I can't remember if this was an issue I
did I ran through this code already one
so my in I can remember that came up
anyway if it did I'll talk about in the
next video although we are already on
V's so it should be over in just a
second so let's just wait it out
you know let me look at the file and
make sure it's acceptable oh it looks
like okay we have we finished it's a
pretty large looking file a little
larger than the one I ran before
interesting anyway
so I ended up saving these as with not
available and without not available just
kind of testing them let's pull this up
really quick though to see if it looks
acceptable it does to me okay
anyway sorry thought it would be best to
check just to make sure anyway someone
close out of this cool and yeah in the
next video will actually believe it'll
be the next video we will yeah will do
linear SV SPC with our data and see what
the results are so anyways stay tuned
for that if you guys have any questions
or comments it's totally plausible I
didn't explain something maybe the best
on this video but just let me know below
if you've got suggestions for
improvement and all that as far as it
goes with like gathering data I really
don't see too much I mean this this part
of you know the the machine learning
doesn't need to be the best or the most
efficient or the prettiest code you just
need to get the data somehow but I'm
always open to suggestion how to improve
especially I don't like the sloppy code
of basically having almost the same list
three times that sucks so if anybody has
any suggestions for improvement there
that'd be great otherwise that's it as
always thanks for watching thanks for
all the support of the subscriptions
until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>