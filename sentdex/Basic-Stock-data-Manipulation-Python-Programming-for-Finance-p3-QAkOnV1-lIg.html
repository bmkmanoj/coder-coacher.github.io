<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Basic Stock data Manipulation - Python Programming for Finance p.3 | Coder Coacher - Coaching Coders</title><meta content="Basic Stock data Manipulation - Python Programming for Finance p.3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Basic Stock data Manipulation - Python Programming for Finance p.3</b></h2><h5 class="post__date">2017-01-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/QAkOnV1-lIg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to
part three of the Python for Finance
tutorial series in the previous
tutorials we've talked a little bit
about bringing in some data and also
visualizing that data and in this
tutorial we're going to talk a little
bit about manipulating that data and a
little bit more about visualizing that
data both of them are going to be pretty
much paramount through any data analysis
task you might be doing so the nice
thing about pandas is it comes kind of
prepackaged with a lot of op common
operations you might do on data and then
for the times when it actually doesn't
have whatever you need you can do what's
called mapping functions and map a
function to a column relatively easily
this isn't preferred because chances are
if there's one written for you in pandas
it's going to be way more efficient that
whatever you write but it's possible so
anyway we'll talk probably about an
applying and maps and stuff later on but
for now and it literally is mapping our
own functions we actually probably will
be mapping a function relatively quickly
but for now let's get started with some
manipulations so to create new columns
and pandas it's actually super simple so
in our case our data frame is called DF
we know we can reference columns with
these brackets but we can also make new
ones so let's make a new one called
100ma so this is going to be a 100
moving average you don't know what a
moving average is basically there's a
number and then a moving average right
so hundra moving average let's say it
takes today's price which is a 1 price
takes 99 of the prior days prices
creates an average of those that's
today's 100 moving average we do the
exact same thing tomorrow and the next
day and so on and so it's a moving
average it's just a way to kind of
smooth out price over time and people
will use them like when the 50 moving
average crosses over the 250 can signal
an uptrend or downtrend in price okay
so there we go we've got we've created a
new column while we've at least
specified in your column haven't really
done anything yet but we're going to say
that's equal to VF and then we're going
to use adjusted closed and then dot
rolling and then with dot rolling we
specify a window in this case we're
going to say ten actually a hundred
sorry 100 moving every
and then recites about me we without the
eye we should say it's also it can be a
sum and there's a few others but for now
we'll go with mean so now we do 100
moving average this is a little
different from the relatively recent
syntax for pandas so again if you are a
longtime user of pandas
that's probably different than what
you're used to
whoops okay so now there's about that we
could do print bf ahead we could look at
it just kind of see what we got going on
and we see we actually have the column
there but just a bunch of na ends which
means not a number so the reason for
this is just it's pretty simple we we're
trying to do a hundred moving average
but this data here right the for the
first 100 rows can't have that
calculation right so there's not 99 so
there's not a 100 basically data points
to work with but if we did say DF
cocktail that's when you should you
should see some information there right
so now it is populated because tail is
the end so there's a few things we can
do we can do we can drop an a so for
example in a data frame you could say DF
drop na and then in place equals true
anytime you see in place it's just
modifying that data frame in place as
opposed to having to say like DF equals
DF drop na okay so in this way we don't
have to redefine the data frame we can
do it all in place not every operation
is we can't do that with every operation
so now if we said DSR head we should see
it because the the ones that had not a
number we're just removed the entire row
is removed so our data actually starts
in 2010 11 17 and I forget when if we
didn't drop that but basically you lost
100 days right yeah so so that's one
option you can also fill in a with zero
or whatever or in this case what we're
going to do is says we're going to use
another parameter which is min
underscore periods and we're going to
say that equals zero
so it won't require any number of
periods to calculate this so we can see
on the first day it just it's that day's
price the second day is this in this and
then in this day and so on so we keep
going until hopefully eventually it
calculates one that's actually an
average strangely those all look
identical just kind of weird but at
least the tail is not the same I wonder
if it doesn't have 100 if it just goes
with zero those persons were weird they
weren't averages of like the first 5
adjusted close 16th I guess it was what
was that compare oh I was comparing to
just too close too close all right all
right ok I should probably drink some
coffee or something it's actually like 6
o'clock anyway ok so we've got that now
let's kind of look and visualize this
too so let me show another form of
visualization so in now before we use
just DF dot plot or D F column dot plot
but like I was saying that's actually an
attribute of the data frame but not all
things you can do in matplotlib can be
plotted that way also if you're trying
to figure out how to do something when
you're like googling it and you wind up
on Stack Overflow most of those
responses are going to be pure
matplotlib responses not matplotlib plus
pipe matplotlib plus panda's response
some are but not all of them so it's
useful to know how to do it how to graph
with both so here's an example of
graphing this information with just
basically matplotlib and then we're just
simply taking the values from pandas so
generally each matplotlib thing has a
figure and the figure contains all your
subplots so most of the time you just
have one so plot one graph right but if
you want to have Matt multiple graphs
you have multiple subplots these are
referred to as axes why I don't know
this is just common practice so I'm
going to continue doing it anyway any x1
equals and we're going to say
PLT dot spelled plot to grid if you want
to learn more about this I have a
tutorial specifically on subplots with
matplotlib so you can learn more I'll
try to explain it as best I can
as we run through it so the way this
function Morris is basically it's going
to take the first parameters in the grid
size this is a six by one that means six
rows one column then we're going to say
the starting point looks somehow brought
up calculator then we're going to say
the starting point we're going to say
for this one it's the first graph so
it's going to start at zero zero
basically a top corner then we're going
to say row span how many rows it is to
conspan this is 5 and then colspan
will say 1 then I'm going to copy just
paste a x2 does not start at 0 0 it
starts at 5 0 and only spans one one row
now what we can do is actually now that
we have any subplots actually kind of
generated we can graph to them so we can
say a X 1 dot spot and just just plot a
simple line and lines take X's and Y's
so what is the X data for a data frame
so X should be the date right well in
our case the data is the index we can
reference that index with just doing the
F dot index then let's say we want to
plot the adjusted clothes well we should
already know how to reference that 50s
adj there other parameters we can add
like line color and label and all these
kind of fancy things but for now we'll
just do this then we can do the same
thing let's just copy this paste and
actually I'll paste it one more time
this one we'll call 100 ma right we'll
have it graph 100 ma and then this one
will plot on ax 2 and this will be
volume PF volume and rather than just a
simple plot let's do a bar so now let's
do PLT I show look at we got ok cool so
this line here the blue line is the
moving average these are the the volume
but you'll notice like like what if we
zoom into like here you'll notice that
this chart down here didn't also zoom in
we'd have to also zoom it in but now
we're not sure everything's aligned so
one click edit we can make is on ax 2 we
can actually throw in one more parameter
we share x equals ax 1 so these twos
these two will have their own X axes
that won't actually be sharing an x-axis
drives me nuts
the wording that they use for share X
share y and those kinds of operations
are like flipped and it drives me nuts
but anyways you don't care
share X ax 1 let's run it one more time
and now when we zoom in on one we zoom
in on the other one okay makes a lot
more sense and then you can also move
around with this like arrow thing so you
click that and you can like drag it okay
cool
alright that's enough for now Wow I
guess I'm stuck just lagging or
something so in the next tutorial where
you're going to talk a little bit more
about some of the built-in manipulations
we're also going to make candlestick
graphs a lot of people in finance to
love their candlestick graphs just a
really nice way to condense a lot of
information into one graph so we'll talk
about that and we're going to basically
do it because it lets us talk about
resampling which is really useful in
pandas so anyway that's what we're going
to be doing in the next tutorial if you
have questions comments concerns
whatever leave them below otherwise I'll
see you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>