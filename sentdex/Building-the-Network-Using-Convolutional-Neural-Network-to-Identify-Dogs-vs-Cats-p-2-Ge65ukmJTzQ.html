<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building the Network - Using Convolutional Neural Network to Identify Dogs vs Cats p. 2 | Coder Coacher - Coaching Coders</title><meta content="Building the Network - Using Convolutional Neural Network to Identify Dogs vs Cats p. 2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building the Network - Using Convolutional Neural Network to Identify Dogs vs Cats p. 2</b></h2><h5 class="post__date">2017-02-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Ge65ukmJTzQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to
part two the cats versus dogs kind of
casual competition where we left off
we've begun kind of converting our data
to something more acceptable to our
convolutional neural network and now
we're going to do is write one more
functions pretty similar to the one that
we just wrote but it's going to be for
the acts for the for the testing data
and hopefully I remember to explain
something when we get there but anyway
let's go ahead let's do define whoops
what have I done I don't know what I
just did just fine process test and
really make sure we get space here
process test data and what we're going
to do here is testing data it's going to
actually be pretty similar to the other
one I would copy and paste but I'm kind
of fearful of messing it up there's
quite a few edits so do my for image in
TQ e m OS Alistair tester whatever it is
first of all the path will be same as
before actually OS top half dot join the
tester and whatever that image is then
we're going to say image num this is
actually this is the ID kind of of the
image so image dot split and if all this
isn't making sense why we're doing this
I will explain it momentarily or maybe
it'll make more sense to explain now so
so so the training data is what has the
25,000 images and these are labeled
images so it's you know dog one cat five
and so on all the way through so we have
we know the image is the features right
and then the label is dog or cat that's
our training data and when we train our
neural network we're going to train and
test the accuracy actually using the
training data so this could be kind of
confusing so using training data and in
fact what we will do is separate out pry
a salad or 500 of the training data and
actually that will be out of sample
training data or out of sample testing
data I guess but that's that's our
testing data just to test the accuracy
of the network but then there's the
actual competition
in test data that doesn't have labels
it's just images in their numbers so the
image number is basically the ID and
that's what we're going to submit we're
going to use the ID and then our
prediction and I'm pretty sure that a
prediction is a scale of dogness
basically so like what's the percentage
that your your model thinks it's a dog
yeah the predicted probability of the
image being a dog so anyway that's what
we're doing there so the test data here
is actually the Kaggle test data doesn't
have a label and so on so we're going to
resize it so image equals and again
actually how much going to do CPR east
side like this and then CB 2 dot in read
so resizing and read of something but
first I'm going to just go ahead let's
copy this tuple here copy hey and then
the M read that we're actually going to
be reading in is the path whatever that
is
so right here path and then this will be
CV to dot M read gray scale so it's kind
of running off the screen but it's
basically the same thing as we did up
here in fact I think if this is a good
uncle line we should just copy and paste
it when anybody told me to do that
anyway finally testing data is not a pen
we need basically in Dewey let's see
no yeah we didn't go this one okay
testing data dot append NP array of the
image itself and then we also want to
throw in that image numb because that's
the ID so later we can just iterate
through this make the predictions and
then we'll store it to a CSV at the very
end so we can submit it will just do NP
dot save there's no need for a shuffle
NP dot save save test data dot none time
gaining data and then finally we'll
return testing data now when it comes
time to Train anything I make sure I ran
everything else yep we can call one of
two things we can either say train data
equals create train data like so or if
you already have data you could say
train data equals NP down-low
train data duck any wife now
well you can't you wouldn't just say you
know if the file exists you could check
if the file existed by OS but the
promise we don't it doesn't need to just
exist needs to be of the exact same
dimensions as uh you know basically this
dimension so I'm just will just manually
change that we can't really program
anything in there okay so let's run it
see if we have any errors it should
start doing our processing of the yeah
the 25,000 damages so there it goes and
and this nice progress bar is thanks to
teach EDM super cool now while we're
waiting on that let me pull up Python
program at net ukp I'll just search TF
learn come here and this will be the
older one this is like the actual you
know handwritten code for a tensorflow
but we can actually take the TF learn
code basically from here so I'm good
just copy it like all of this copy and
I'm going to come over here and paste a
lot of code
a little bit this is going slow I
expected this done by the time we come
back we don't need the MS data but
everything else where you do need we
don't need it to define our X&amp;amp;Y data and
I'm going to actually we can redefine
this stuff later the continent itself
will not be a twenty you know the input
layer won't be 28 by 28 it's going to be
50 by 50 but we actually are using
variable for that so it's image sized by
his size the output layer is not 10 this
was for the M missed you know Hendren
digit classification so that had 10
examples we actually just have to its
dog or a cat then we have the learning
rate here we set it as 0.01 and +4
that's pretty low learning we're pretty
fast learning rate anyway we're going to
just set LR so we can change it later
and then we will say model equals
comment but we're going to first going
to cut the other one for now and then
you know I was hoping I just want to get
started talking on the next thing and
have this have an error and then we got
to go back and all that um the other
thing I will say is especially here so
let me do this too so I'm going to say
tensors tensors board derp equals log so
on like Linux and probably Mac this is
super simple it just automatically logs
to like slash temp but on Windows it
doesn't you got to be really yeah it can
be relative here but then when you go to
do the tensor tensor board call you have
to be very explicit and give it a name
for some reason I have no idea why but
if you're on Windows make sure you do
exactly what I do if you're on some
other operating system feel free to do
whatever the heck you want to do but on
Windows just word for word don't forget
the log there and then don't move it
over
and and then yet do what I do when we
call it tension board especially I
haven't covered tension board yet so
this will be prod this will be the first
time in that series that we've covered
talked about it okay so the train debt
is done this is our continent and
hopefully there's really no questions
here we have a pretty much already
covered how the continent works now what
we're going to do is actually go through
training the continent but I think I
think I'll save that for the next one
let's just run this make sure everything
is do ports and all that and if so I'll
continue on in the next the next video
that's good so the next video will
actually you know create our X&amp;amp;Y data
and our training and test data and
actually train the network and probably
make some tweaks so if you have any
questions comments concerns whatever up
to this point feel free leavin below
otherwise I'll see you in the very next
video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>