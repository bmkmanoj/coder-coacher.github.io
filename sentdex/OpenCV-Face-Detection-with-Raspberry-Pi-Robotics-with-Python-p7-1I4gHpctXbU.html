<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>OpenCV Face Detection with Raspberry Pi - Robotics with Python p.7 | Coder Coacher - Coaching Coders</title><meta content="OpenCV Face Detection with Raspberry Pi - Robotics with Python p.7 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>OpenCV Face Detection with Raspberry Pi - Robotics with Python p.7</b></h2><h5 class="post__date">2015-09-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/1I4gHpctXbU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody welcome to
another Raspberry Pi Python robotics and
of course go Pongo tutorial video in
this video we're going to be talking
about open CV with the Raspberry Pi so I
imagine some people may have actually
found this tutorial just simply
searching for a way to combine open CV
the Raspberry Pi in the Raspberry Pi
camera module because mainly open CV is
meant to work just with USB cameras but
we can use the Raspberry Pi camera so
we'll be talking about that open CV is
used for all sorts of image recognition
arguably it's mostly used in C but you
can also use Python for this also open
CV is relatively computationally
expensive but we can actually do it on
the PI and we can do it relatively fast
it takes a little bit to detect a face
but you'll see that it's actually it's
not it's not too bad so first of all in
order to work with open CV we have to
have open CV now this isn't going to be
any sort of crazy in-depth open CV
tutorial series I will end up putting
out more open CV tutorials because open
CV is really cool and it's just a
fascinating topic to do image
recognition with Python but this is just
a basic open CV kind of introduction as
well as how to do it on the Raspberry Pi
and all that but eventually we will
probably take it off the Raspberry Pi
and do open CV with you not your
ordinary webcam but also a little bit
more powerful computer so we can do more
cool stuff anyway first things first you
have to get open CV so you'll need to
follow some tutorial to get open CV we
could go through it or I could just
point you to a list that lists it out so
I'm just going to point you to a list
that lists it out warning one of these
steps is going to take about well if you
have a Raspberry Pi model B or B plus
it's going to take about nine to ten
hours one of these steps I'll show you
which one if you are on a Raspberry Pi 2
it'll take about 2.5 hours obviously if
you're on a really fast computer it's
not going to
longer but that long at all but anyway
I'll put all these links in the
description this one's really short
though
Mitch TechNet / Raspberry Pi OpenCV and
this just you can run through this list
of commands basically and the one that's
going to take really long is going to be
here right this is what's going to take
your longest I usually just ran this
overnight so if you're going to put it
on a PI just run it overnight now I'm
also going to put my image I think it's
like I think I'm on a 16 gigabyte SD
card but I'll put that up on Google
Drive and then that'll just be open and
anybody can just come in and download it
because if you mess up any part of this
little process and you're trying to get
it to work with your Raspberry Pi and
the go PI go and all that kind of stuff
together it can be kind of a pain you
want to do it yourself you can do it
here or if you just can't figure it out
you can always download from that Google
Drive either ways probably take you a
while I don't know what your download
speed from Google Drive is for 16
gigabytes but anyway moving along you
can either follow this instructional
here or you can just download my image
mount it with a like win disk imager or
whatever or whatever you're using to
mount images so there's that the next
thing would be this is the script I used
or I'm going to use for what we're about
to do this works with the Raspberry Pi
is camera module not this but as you
come down it was this script here most
I'm just giving an attribution here will
type this out you could just copy and
paste it but it's probably best well at
least read the the comments so you know
what's going on otherwise you're
probably just wasting your time copying
and pasting the other thing is whenever
you're doing any sort of object
detection we're going to do faces but
any sort of object detection the way
that this works is you you usually go to
when you train some sort of image
recognition system
you're going to train it or really any
machine learning at all but image
recognition often is actually has one
more step but mainly what you're going
to do is you're going to have a bunch of
images say of faces like we want to do
facial recognition so we have take a
bunch of images with faces and then we
say hey here's a bunch of images with
faces here's where they start sometimes
you might say the width and the height
but a lot of times this is where they
start and you feed it like ten thousand
images or something write that like that
and that's how you train it and then
later on you can use these face cascades
XML files and you can load those in and
then the facial detection it's going to
read this cascade look for anything
that's kind of closely related to
anything that might be what we call a
face so that's how we train it now a lot
of times you'll also have one more step
and you'll basically show it like ten
thousand pictures and you'll be like
these are all faces and then you'll show
it ten thousand pictures that have no
faces in them and and then that's how
you like one more step that usually goes
in or oftentimes goes in moving along oh
this file here this isn't really
included here you might have a download
here I don't know where it is but what
you can do is I'll link to this one as
well this is a this one's coming from
Intel and it's a massive in fact massif
this actually comes from his see if he's
got to get over something's I don't know
where I found this one either
no anyway this is the link to it it's
for from Sean she into new anyway but
the original source is actually Intel
and this is their entire thing so if you
do take this file and you know propagate
this file out just make sure you leave
the license agreement there otherwise
you can do what you want
moving along uh the last thing I hope
says I just I'll probably forget to
mention this later on but once once you
finish this tutorial you should come to
a sort of realization how easy it was to
make a machine recognize a human face
and and what we're going to do is have
our robot take an action
detects there is a human face and that
action is going to be to shoot the
missile okay so it's at that point you
probably started thinking about your
life and you know what it's going to be
like in the next 10 and 20 years well
good news is you can full facial
recognition systems doing things like
this with makeup and hair and all this
kind of stuff so it's kind of an
interesting offshoot I suppose of facial
recognition anti anti facial recognition
anyway I just thought I'd point that out
so once you have OpenCV and all that
you're ready to rumble um try to think
if there's anything else once you get
that far but I think I think we're all
set at this point but if you have any
problems like if you are trying to
install it all on your own without
downloading the image that I'll just
host plus a question below I went
through the entire install installation
process like twice or something so so
definitely hopefully I'll be able to
help you out there's like a lot of
there's like you know 15 ways that
people are doing OpenCV installations
and then some people are saying you
don't even have to build and make and
all that but I could not figure that one
out and then some people actually hosted
the made files so and I couldn't figure
out how to make those work either so I
just went the old-fashioned way build
and make and all that anyway once you
get that far we'll move this aside again
for anybody who is just now coming to
this series we've started this we've got
basically I mean winscp here this is
just my GUI file viewer if you're not on
Windows you can also use FileZilla for
this purpose and then also on remote
desktop tin I didn't end up upgrading my
raspbian here so we're remote remote
desktop tin this is with xrdp and then
once you install xrdp to your Raspberry
Pi you can go to your Start bar type in
remote desktop and connect to the IP
address so once you're in here you're
ready to go ahead and get started so
what we're going to do first is we're
going to go through
basically let's just take this file here
so this is our main file that we want so
again this is coming from this this
website here this our pot RPI home
blogspot.com again link will be in the
description take this all the way down
here we'll copy that we'll just step
this aside now and we're going to make a
new file here and in fact I pry well we
can do it here doesn't really matter
anything maybe I can't I don't know
there we go it was taken a while it'll
be too tedious to make a file here I'll
step it over here so now what we're
going to do is new file and I'll just
call this I'll call this actually open
CV ex1 PI okay cut and then I'll paste
all of this in here so what this is
doing is we need I owe this is send data
back and forth PI camera you should
already have it with your Raspberry Pi
CV - I believe that would be installed
in the tutorial here if not you would
want to make sure you installed that but
yeah I think it's in this thing anyway
and then numpy if you don't have the UM
PI you can do an install for numpy like
pip install not apply for example stream
as the comment says makes memory streams
you wouldn't necessarily have to save
the photo to a file but it can be useful
if you do so you can go back and read
that file and see that it detected your
face and not something else otherwise
you won't know then here this is how
we're just defining our Raspberry Pi
camera as the camera and then in here
you can give any specifications you want
so you can do something like this like
camera dot H flip equals true that's to
flip it horizontally you can do the flip
you can change brightness all kinds of
stuff we'll go ahead and leave
everything the way it is right now
though the dimensions you might want to
change for the resolution there but
that's fine for now this converts it to
an umpire array that's why we need numpy
that's how OpenCV basically works then
we create the opencv image
here this loads the face cascade and so
yeah let's go ahead and grab that file
too so again this will be in the
description but we mainly are wanting
this little file here and this is you
can call what you want I'm just going to
call it faces XML so I'm going to right
click new file and I'm just going to
call it faces XML it opens up an empty
closed out of those and ctrl a ctrl C
and then ctrl V for paste that might
take a second save it and now we should
have a faces XML in here we sure do
bring him back down the file I've been
working on that's right here we're going
to give the full path that is just do
this that's home PI desktop and then I'm
having this in go PI go local and then
the name of that was faces XML so now
for the face Cascade this is these are
basically examples of faces ok it's as
you can see this is the file and it's
this just this massive XML document just
many many tens of thousands of lines
then oh and will in this tutorial we're
just going to we're just trying to show
simple OpenCV example but definitely if
you're interested in open CV all like I
said I'll be creating a much more
in-depth open CV tutorial series and
we'll talk about how we can create our
own because you can find like let's say
you're trying to do license-plate
recognition there are tons of things for
license-plate recognition there are tons
of things for facial recognition just
datasets and XML files that you can have
but like let's say you're looking for I
don't know
Gio's chapstick okay if you're probably
have to take your own images of these EO
EO s chap sticks and create your own
data set so it's imperative that you
understand that create your own data set
but for now we'll let let that go
Korea convert the image to grayscale
this is just our the image recognitions
way of normalizing data we don't really
care if you're black white well we care
if you're black or white but Jen
only image recognitions pretty bad if
someone has a very similar facial
structure between a black person and
saying Hispanic person a lot of times
they will be scaled very similarly and
if they have a similar looking face it's
going to be identical as far as facial
recognition is concerned but that's the
best we have right now now there are 12
sigh I can't say that's not the best we
have but that is pretty much industry
standard but there are some image
recognition algorithms that do
incorporate far greater shading than
what we'll be doing anyway at least on
our raspberry pi you got to keep in mind
all the processing that's required here
so then faces basically we're looking
for faces in that loaded cascade file
and we're just basically trying to
detect a face if we have any similar
faces we're just printing out to console
hey we found this many faces hopefully
it'll just be one but I do have I've got
a picture hanging up there and for some
reason it's got like oh like some lumps
in the picture I guess it's like a
poster you know and it so it's not like
perfectly flat for some reason it picked
up a face there anyway
unless there's someone there I don't
think so but anyway if there is a face
the next thing that we do is we take the
the X the Y so X and Y is like the top
left and then we have to add the width
and the height draw you know out so we
take the X the Y the width and the
height of the face and we draw a
rectangle around it we color it boom
done and just for our viewing pleasure
we don't have to have done this but just
for us we are going to go ahead and save
that image to result dot jpg that way we
can see it right we want to see see this
image and see the face
so that's OpenCV example one I'll save
that and it's up there now let's go
ahead and open up our desktop where did
I there it is and now we are ready to
open up the terminal here and I don't
really think it's necessary for me to
make the text huge on this one sorry
guys
I'm going to seating it into desktop
maybe whoops there we go
desktop go pack go local and then we're
looking to run OpenCV example one so
Sudha
why shouldn't I don't need suit up for
this one so just do Python open see the
example one and I'll run that look at my
camera and hopefully the text to face
found a face will see if I found my face
or not let's open that result jpg up
sure enough it found my face back there
it's a little hard to see that a little
box there let's uh go back into the club
I think I closed the script let's open
that back up again by the way if you
don't python - there you can always go
to open with and then go to programming
choose python - and that'll that'll make
sure it opens up oh we're not writing
we're not modifying the script there
that's why it wasn't there we do
something like this like two to five
there and then come back over here rerun
and hopefully the text face again sure
enough found face bring that up and now
the fish is much more obvious with a
nice much more pretty square okay so
we've gotten that far now what well what
we could do is something a little more
devious so we could do something like
this like we could take this do pay and
this will be open CV underscore a x1 or
x2 dot pi
oh sure wise tell me that we'll try
again
interesting duplicate and we'll call
this open CV x 2.5 yes cool great up
okay
now this is basically identical the
first one now what we're looking for is
what fired I think tutorial five fires
at us right okay
so we've got these scripts here and I
want this one over and I'm looking for
this one so what we're going to want to
do now you have to bear with me here
this will be kind of a sloppy cut and
paste but we're going to bring in we
don't need tkinter really here but we do
want the go p-- i go and then just for
for distribution purposes I'll take this
here paste that up at top just so
everyone's getting their attribution and
then we'll copy all this basically let's
just copy this is copy this whole thing
except for this setup down here so copy
that we'll come over here paste and just
make sure we didn't open port go PI go
twice nope okay then what we'll do is we
set up USB cool so basically we want all
this we'll copy that and we can just
bring let's do just put that right here
paste we don't need to zero setup USB
that's fine stop it from doing anything
cool and then what we're gonna do is
remember up here this is where we've
found how we've all we have to do to
fire rockets is run this command so we
can copy that come on down here and then
where this is where we're asking about
you know were there any faces found so
we can say if
in phases greater than zero fire all
right so it's Happy's e2 to end the
humans so we can close this and that
should be it now I'm going to go ahead
this this process can sometimes take a
second so I'm just going to say raw
input and press ENTER to continue
and that just force us to press the
Enter key so we have control over our
demise I suppose and that's that so now
we're going to go back to the desktop
here and into our terminal and now
instead of C or the example one will run
example two hopefully without oh wait
prior to do sudo though maybe not looks
like oh yeah
so sudo python OpenCV ex2 pi will run
that hopefully we'll make our connection
press ENTER to continue so it was nice
knowing everybody here database oh I've
been shot okay let's just make sure it
did find us but I can tell with a little
thumbnail that it did find us indeed and
here's your proof our IP anyway okay so
that was kind of a long tutorial 20
minutes but actually for you that was
like a ten-hour tutorial because you
have to download open CV but it's really
rewarding I think when you finally get
it you draw that square around the face
that's really cool so hopefully everyone
is able to find their way to that spot
if you have any trouble getting to this
point do feel free to let me know
Raspberry Pi is not the fastest
processor in the world but it's actually
very impressive that we can do this with
the Raspberry Pi in that camera module
but like I said if you're interested in
more open CV definitely stay tuned I'm
going to be doing an open CV tutorial we
won't be doing it with the Raspberry Pi
in just simply because verify it is not
the
this device ever but if you're
interested in this kind of thing
definitely stay tuned and keep your eyes
peeled for that one I'll probably
annotate this video if and when that
series does come out and if I remember
anyways questions are comments below if
you're having trouble getting anywhere
to this point let me know if I forget to
put links in the description let me know
if I forget to host the image let me
know because if you can't figure any of
this out you can always just download
the image okay so anyway questions
comments concerns whatever issues in
below otherwise as always thanks for
watching things for all the support
subscriptions and until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>