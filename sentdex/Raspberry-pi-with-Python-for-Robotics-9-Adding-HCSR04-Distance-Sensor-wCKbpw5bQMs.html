<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Raspberry pi with Python for Robotics 9 - Adding HC-SR04 Distance Sensor | Coder Coacher - Coaching Coders</title><meta content="Raspberry pi with Python for Robotics 9 - Adding HC-SR04 Distance Sensor - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Raspberry pi with Python for Robotics 9 - Adding HC-SR04 Distance Sensor</b></h2><h5 class="post__date">2014-05-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/wCKbpw5bQMs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody welcome to
another robotics and Python and
Raspberry Pi tutorial video this video
and the subsequent few is gonna be
covering the addition of this distance
sensor this is the HC SRO 4 so by now my
Raspberry Pi car is using that anchor
for portable power to the PI and we've
got that edimax Wi-Fi dongle so our car
is now remote controllable via Wi-Fi and
could actually be controlled via the
internet in sant browser or via some
sort of phone app but now we want to add
a distance sensor to it so we can begin
to make the transition to an autonomous
robot so for me I'm more interested in
the software aspect than the hardware
aspect and I'm more interested in having
a robot be autonomous rather than remote
controllable
luckily along the path to autonomy we
can also just add in remote control
anyways so we have already done that but
my goal is more for more autonomy so for
that we want to start adding sensors one
of the easiest sensors is the sage CSR
o4 and so we're gonna be using that so
this is a distance sensor what it is is
this an ultrasonic sensor that uses
sonar to determine the distance of
objects from it much like bats do so
what it does is it's going to transmit
some sound and that sound is gonna
travel to an object so basically what
this is gonna do is say it shoots sound
out of here it's gonna travel to this
object bounce back and be received okay
and from here using the known constant
of the speed of sound the amount of time
it takes to occur we can use these
together and we can accurately measure
how far away an object is so some of you
guys might be thinking well what about
what about angles so right here if this
was a shoot to the spread board and back
that's a straight shot but what if it
was like this well the sound might
bounce here and it might actually miss
the sensor so because of this we have to
kind of take this into consideration so
from a bunch of tests
this sensor performs best at less than a
22 degree angle and anything over a 30
degree angle should really just be
distrusted so for this reason we can
bring more sensors on board and use the
lowest
since measurement as our distance okay
so we can bring more debt sensors
onboard and also we can pre-program that
that specific sensors spot right that
specific sensors placement on the car or
whatever we have and we use the lowest
one to determine which sensor is the
most accurate okay and so so we can do
that because if if the degree is higher
than thirty either what's gonna happen
is either it it just doesn't get a
signal back or when it finally does come
back it's a massive number like five
hundred nerves like let's say five
hundred centimeters cuz rainiest
centimeters so say an object was forty
five degrees away what's gonna happen is
say it was like this it's gonna bounce
off here come to me bounce back and then
bounce to the receiver so for this
reason it's unlikely that you'll get an
angle like with an angle it's not it's
unlikely that you'll get a false
positive that an object is too close but
you might certainly get false negatives
and actually an object is much closer
than we thought so enough on that let's
go ahead and break down this specific
sensor so as you can see the HCS ro4 has
basically four connections to it you've
got VCC trig which is trigger echo and
GND for ground VCC is basically the
power and this is a 5 volt sensor so you
were gonna need to send 5 volts to this
trigger is going to be triggered by an
output a GPIO output and that's going to
trigger the release of an ultrasonic
wave then echo echo is basically
receiving so that's going to be a GPIO
input so trigger you can basically
what's going to happen is you're gonna
trigger it mark the time at trigger and
then once you receive a signal back at
Echo you mark the time and then ground
just goes to ground now keep in mind
this is again 5 volts so the only main
the only issue that we're going to have
here is that the HC SRO 4 is 5 volts the
PI is 3.3 and so if this sends back a
high signal back to the GPIO input pin
on the Raspberry Pi we might have some
problems because that's going to be too
much for the PI and you could damage
your PI so obviously we don't want to do
that so
the items that we're gonna need are the
following we're gonna need two male two
female jumper wires and they're gonna
you're gonna want them to be a decent
length because it's gonna wire from our
PI to the breadboard check the
breadboard is basically I'm going to use
the breadboard you don't have to but I'm
going to use the breadboard to stick the
sensor into because the breadboard will
hold up our sensor quite nicely so the
breadboard will just go right on top of
our car luckily for me my breadboard
actually screws in perfectly to the
board these two screws fit perfectly
this breadboard didn't come with the kit
I just got extremely lucky otherwise
just use like double sided tape put
double-sided tape on here and stick it
on your pie or you could glue it if you
wanted but do something like that so
you're gonna need a breadboard obviously
the H csro for two male to female jumper
wires and then two male to male jumper
wires I ended up having to stick two
together just because my only male to
male jumper wire was really short so I
connected it to a female to male jumper
wire and just electrical taped it up and
then I have another red one so to mail
the male to male to female one
breadboard one HCS ro4 and finally
you're gonna need a 1 kilo ohm resistor
and that one kiloohm resistor is what
we're gonna add to the GPIO input right
so then we're gonna add that to the echo
so before we send it back to the PI it
goes through the resistor and that will
be enough so we don't overload our part
so enough on that how are we gonna wire
this so obviously the first thing we
have is this ground so you're gonna want
to put the ground in it and let me go
ahead and actually sense our Center my
sensor as best as possible so that and
if you don't know much about breadboards
the we're not gonna use any of these
sides but the the way a breadboard works
is it's like this usually you can see
it's numbered or lettered on the sides
and basically it works horizontally so
anything you connect like this like
we're connecting you know perpendicular
but anything here like this whole row is
all connected you can't see it because
we've got it
on here but they're all connected so
basically it's it's an easy way to make
a circuit without soldering or
soldiering so anything we put in line
here will be a part of this but it won't
interfere with these but of course you
could make the connection if you wanted
we're just going to choose not to so
anyway if we look back at our front VCC
is over here so this is where the power
is so for me I try to denote power with
red then we have trig is the next thing
then followed by echo so a trig will
make it Orange
so we'll plug that one and actually I'm
gonna plug him in at the very end here
just so they're all kind of uniformed
with each other just in case you wanted
to throw something else into that line
so red and then we'll plug the orange
for trigger you can use any colors you
want maybe maybe I'll plug it in I can't
get it to go in there we go right so
initially I have wired this up wrong and
I decided I better be upload it since
it's fairly it's a fairly big deal if
you wired up wrong and break your PI I
probably put in at least a few hours
with it wired up wrong and didn't have
any problems but it is possible to - to
break your PI this way or the way I had
done it anyways so I figured I better go
over it and special thanks to the sticky
Oh UK and Andrew Baggett for pointing it
out pretty stupid mistake anyway so what
I had done was basically the way the
breadboard works again is you have these
these holes right and they're all
connected horizontally and underneath
them the way that they work is there's
just a metal track and so when you plug
into the hole it connects everything but
what will happen is what I had done is I
connected this yellow pin on the same
side so on the same track and use the
resistor thinking that's gonna you know
resist the current or whatever and that
would solve our problem but what was
gonna happen or what did happen and
luckily I didn't get any trouble for
myself was it would the current is going
to take the path of least resistance
which would just be the track underneath
so the resistor was really doing nothing
besides direct
the current away from it basically so
that was worthless so instead what you
have to do is we can leave all the other
connections like we've got but we use
the resistor to bridge the gap here
because this gap the tracks don't follow
under it so we can use the resistor to
bridge the gap and then plug our yellow
input jumper wire into this track over
here using the resistor so the only path
possible is now through the resistor but
still a pretty important thing that you
have to take into consideration and not
plug things in if you're going to use a
resistor in the same track so anyways
that's that we can continue on with the
rest of the video
all right so here's the car go ahead and
just you know delicately take your pie
out and your h-bridge out so take pie
like so and the h-bridge
like so I guess I'll have to kind of
move the battery pack a little bit to
get this all to come out for us okay I
get the input pins on so once we've got
that out the next thing we want to do is
we want to begin plugging in the GPIO
input pins to our PI and then also we
want to plug in what we need to our H
bridge the H bridge plugs we're gonna
plug into that five volt and then we're
also gonna plug in to the ground on the
H bridge so yeah so then so now that
we've got those on here let me figure
out how am I missing one I guess I'll
put the breadboard here you've already
seen the breadboard so you'll just see
the wires coming off the screen I
suppose and there we go okay so first we
want to plug in let's go ahead and plug
in the input and output pins on our
Raspberry Pi
okay so let's begin so first we're gonna
plug in the orange wire and the orange
wire is corresponding to our trigger and
we're gonna plug that into GPIO pin 18
or pin 12 on the PI and that is
basically two pin gaps so it's the third
pin down from our ground on our PI so
right
and hold it up like this so you've got a
gap of two pens and then we plug in our
orange and that's for the trigger so
that's gonna be an output pin and then
the next one we have is our yellow pin
and that's our input pin and that's
going to be for echo and that one gets
plugged in basically with a gap below
GPIO pin 18 then you've got GPIO 23 so
that one goes right here there we go
okay so it should look like like this
let's see if I can get it to focus there
so we have here our five volt with one
gap then you've got ground then you've
got two pins and you've got your orange
and this is for the trigger one more pin
then you've got the yellow for Echo so
those are in now and now we have to
connect all of this to the h-bridge
because we're going to take our power
from the h-bridge because we've already
got our GPIO pin is already being
exhausted so we might as well just use
the same thing it's going to so for the
power here so my red chord we're gonna
plug this right in to the VCC on our age
bridge so for me that was we used a
green wire for that so let's see if this
stuff easier to see
okay so that would be if you had your
your thing facing me that's gonna be
right here right next to ground and then
after that we're gonna plug our ground
into this one so let's go ahead and do
that I'm just gonna loosen this one up a
little bit and we'll take our VCC which
is 5 volt and we're plugging that into
the 5 volt slot basically we're sharing
the slot with the 5 volt power that
we're grabbing from the PI anyways screw
that on let's go ahead fairly firmly you
don't want to kill it give every give
both of a decent tug make sure they're
in there good
mine are so now we're ready to plug in
the ground and that will be the black
wire here so again just kind of unscrew
your ground a little bit that's the
middle one and then fit your your other
ground in there
okay once you've got that one in there
give them both a nice tug make sure
they're both in there what sometimes
when you're sticking two in there one
might be snug but the other one might
not be so just make sure that they're in
there good so now we've got everything
hooked up and I'm gonna kind of put
everything back into my car no real
reason to leave everything strewn out
like this and just for anybody who is
curious the way that I've been doing it
is take the battery pack and I slide
that all the way to the back because
that will it fits nicely underneath
these like these won't hit your
batteries so I slide the battery pack
all the way into the back sometimes
apparently I can't today there we go
okay so that's all the way in the back
and then I try my best to just kind of
stuff both of these in here
this one's it's just a little bit harder
to do the pie in the h-bridge but
usually I can make it work the only
problem I've been having so far as with
the pie sometimes I lose the signal from
the edimax well which makes sense
because we're in casing this into a
metal box basically so you could put
your pie on top I like it when it's nice
and clean so I just want to put it on
there in the inside and my goal is
really autonomy not necessarily remote
control so it just kind of works out but
you can't put the pie on top I mean
there's nothing horribly wrong with that
and we will be putting the breadboard on
top at least so anyway I'm gonna pack
these in here real quick and then I'll
resume once I get everything in the car
all right so once you've got everything
put back together like I said my
breadboard just so happened to Lockleys
fit two screw holes here so that worked
out so we were able to get that on there
I've got everything wired up I'm just
threading the wires through the back
here and then also the power to the
anchor is here and that's pretty much it
as far as wiring it up goes just make
sure you haven't forgot your one kilohm
resistor for the GPIO input pin so we
don't break our PI and other than that
we are ready to begin to code this so
we're gonna continue on in the next
video
with setting up the pins and taking some
test measurements making sure our sensor
works and then from there we'll actually
start building this into the autonomy of
the Raspberry Pi cars so that's what you
guys have to look forward to if you have
any questions or comments feel free to
leave them below as always thanks for
watching thanks for all the support and
subscriptions and it still next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>