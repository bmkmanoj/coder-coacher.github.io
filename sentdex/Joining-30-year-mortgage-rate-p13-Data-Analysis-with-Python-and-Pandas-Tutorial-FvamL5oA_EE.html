<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Joining 30 year mortgage rate - p.13 Data Analysis with Python and Pandas Tutorial | Coder Coacher - Coaching Coders</title><meta content="Joining 30 year mortgage rate - p.13 Data Analysis with Python and Pandas Tutorial - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Joining 30 year mortgage rate - p.13 Data Analysis with Python and Pandas Tutorial</b></h2><h5 class="post__date">2015-10-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FvamL5oA_EE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody welcome to
part 13 of our data analysis with Python
and pandas tutorial series this part
we're gonna be doing is joining in some
new data so until now we've really only
brought in data from the housing price
index but the idea here was to see if we
could bring in other forms of data so in
this example we're gonna bring in the
30-year conventional mortgage and then
later on maybe we'll bring in even more
data probably in the next tutorial
things like them you know economy and
stuff like this and then after that we
can at least make our best attempt to
feed it through some sort of machine
learning algorithm and see if we can
make any sort of games that way so with
that let's go ahead and just hop right
into it we're going to use this 30-year
conventional mortgage from quantal which
is here you don't really need to go here
or anything like that if you don't want
you just type in the ticker that I type
in but this is the data here and so as
you can see this is the mortgage rate
and so we can see that as the mortgage
rate basically over time has gone down
and we can see this kind of hump in the
mortgage rate at least here I mean
that's that's such a huge interest rate
I like can you imagine having like a
30-year mortgage with an 18% interest
rate like oh my gosh I cannot imagine
buying a house at that point that's
incredible anyway moving this over first
of all we're going to go ahead and do is
we need to grab the data so just you
know wherever you want but like I'll
just code it in right here and what I'm
gonna say is define mortgage underscore
thirty-year now we could define a
function that pulls data from quantal so
like we could enhance Quon Dalls get
okay but we would have a lot of
conditional statements and stuff so this
just makes more sense to me for now but
I mean if you started pulling maybe
you're pulling like 50 or 60 data points
a lot of them are gonna have very
similar things that you've got to switch
around so at that point you know maybe
you make one function that does all the
polling but as you're going to see
different data sets you're going to
differ
things that we need to do to them
although some of them you might could
get away with just manipulating them in
the same way as you'll see in this
tutorial at least we kind of have to do
a little hacky way of fixing this data
set but you could apply that hacky thing
to all data sets I think I mean but
anyway moving on so yeah so now we're
going to do is D F let's actually mmm we
don't want that query don't we have
another quick yeah we have this one
let's let's at least start by taking
this because we're gonna have to do a
lot of the same thing so let's just copy
that come up here paste it's not F Mac
HPI USA what we want is actually F Mac
but so still Freddie Mac providing it to
us but we're looking for the mortgage
this is that conventional mortgage also
this one starts a little bit prior to
when we want it and so we're gonna go
ahead and do a trim start so we'll say
trim whoops trim underscore start equals
and we're going to do in quotes here
1975 - oh one - oh one here now this one
is bringing it over to show you returns
row called value or column called value
so we want to rename that column for
sure so as you can see some of them need
a column being renamed some of them
don't some of them have multiple columns
some of them don't and so on so it'd be
really hard to write a single function
this is still probably the easiest way
to go about it but again you're pulling
like 50 data points maybe not anyway so
actually we get back data a DF like
we'll get back value so what we'll do
here is just go we'll just do this value
for now so we'll just say DF value
equals value value so we're converting
this to a percent change and then what
we're going to do is we're going to go
ahead and print actually we'll just
return that data frame up there and then
for now we're come back to this stuff
I'm going to comment it out all three
and first we're just gonna say DF
equals this so copy that
yeah equals that and then I'm just gonna
print the F dot head so we can see the
data if we're working with got invalid
syntax forgot a comma done try again
okay so we pull the data sure enough
here we have it now what is different
between our data and the original data
well part of the problem here is that
first of all this says value we needed
to say something other than value but
also its sample that beginning of month
all our other data is sampled at end of
month so for example we can we don't
want to grab initial data but we can
grab this here and we can print HPI
underscored data that head so we'll run
that real quick still got to pull the
other data but that's okay so as you can
see here these are end of month okay so
what was well what would you initially
think well you probably initially be
like okay okay this is simple we'll just
resample but end of month since we just
have that one value it'll probably just
take that value and apply it to the end
of month and in theory that's not really
a bias at all because these were
actually moving this data to a later
date right so you're not worried about
bias if anything you're harming yourself
using this data later than you would
actually have it so okay so what we
might do is we come up here back to our
mortgage thirty-year and we might think
okay here's what we're gonna have to do
we are going to say dia equals D F dot
resample now we're gonna resample to the
month okay fine we try that and we got a
bunch of nada numbers okay now it's
probably because we don't have enough
data in that month to make a valid
calculation okay so then the next thing
is like okay well what would happen if
we did you know we were sampled by day
right it's a lower sample than what we
actually that we actually have okay so
you start off with zero and then we've
got all these not a number not a number
not a number because obviously we don't
have that actually instead of doing that
let's come down here pre like so a
little bit more okay so you actually
have your data points but mostly what as
you run through you're left with not a
numbers although we're not really being
given many first of the months but there
they are so then what would happen if
okay
we were sampled today what if we didn't
then D F equals D F dot would you sample
- oops - month let's try that one again
and wouldn't you know it we got some
data all right
that worked out had enough data
apparently to do it that way even though
in theory it was still doing that
calculation with one data point and a
bunch of odd numbers doesn't matter
there she is
awesome okay so we have that data there
and what kind of I mean I understand
that we kind of cheated slightly but
needless to say we we got the data so
now we're gonna do is let's go I want to
leave I mean I don't really think we
need the axes data anymore I mean we
might end up will probably come back to
graphing but I mean there's no reason to
always have it there if we're not using
it we don't need to print any data frame
here the mortgage thirty-year lets us
change that from saying DF we're gonna
say that's now M 30 I'm gonna just move
this down so we're gonna say M 30 equals
mortgage 30-year we've got the HPI data
here and we do have a way to calculate
that benchmark so let's go ahead and
make that one - it's grabbing all the
data basically HP i underscore bench
the equals and when I say that equals
HPI benchmarked okay so then the only
thing to keep in mind though is that
we've got em 30 and this is being given
the column of value
now we could replace value either either
in the code or even in this function but
it it really doesn't matter but it's
probably best to replace it in
spunctional--
so what we'll say is DF columns that
should this comes back with an index
don't forget quantal is just by default
gives us an index which is very great of
them to do most your datasets won't but
this one's going to do it for us so we
just have a single column so we say DF
at columns equals and then we're just
basically renaming this column to M 30
just so we know what it is so then what
we're going to do is we can take
basically we can join we can leave the
benchmark we can join the bench removing
whoever we want but we could say we can
say something like that state HPI
and M 30 we'll just call it something
like that equals HP i underscore data
join M 30 okay and then what we can do
is first of all that's we don't need to
print that out but we're fairly
confident it's gonna work so instead
what we'll do is we'll print let's print
H I'm just gonna copy this typing that
out print that dot correlation so first
that's just like the correlation of the
entire data frame of course so we'll
wait there it is okay so not see my 30
join em there
more age 30 years that we should have
the I would would have expected n 30 you
at the end got see if I'm just missing
it or what maybe it got truncated out
and we're just not seeing it
oh there it is okay so it is here
because it just slapped in I don't know
didn't do it we're not printing out
anywhere else are we grab initial data
we print it sorry I'm just goofing off
apparently oh okay I see what happened
okay so this was hidden from me at the
bottom here that's why it's not there so
cuz we enjoyed it it should go to the
very end that's why I was like looking
at the very end I'm like where is it
there it is okay so here we can see the
correlation of the 30-year mortgage rate
with the state housing price indexes
indices indexes I don't know
now we can see that mostly the column
that we're curious it with is this
specific column I mean we can kind of
look at some of the data here obviously
there's one that's negative 54 wow
that's a that's a pretty low negative
correlation I suppose we could say weak
but we can make fairly decent
assumptions here that the the 30-year
mortgage rate obviously would have an
effect on the housing prices right the
mortgage rate is either an incentive or
a disincentive to buy a house like that
you know we're just looking 18 percent
oh my gosh I'm not paying that rate over
30 years you can go out get out of here
now
so what we're curious about yeah we want
the correlation but we're also remain ly
interested in that in 30 row so
correlation and 30 but we just looked at
that so really what we're interested in
is maybe let's get to describe here so
we can get the minimum and stuff
obviously the maximum we don't really
that's going to be
itself right but here we can find out
that's odd
duh I swear we saw negative oh this is
the minimum so in theory the maximum
would be that probably negative 54 but
the maximum in this case is the 1.0
because of its correlation with itself
we could get rid of that row but
whatever or you could replace you could
do like where one anyway whatever so
here we have those basically the the you
know like the this is the 75th percent
and it's still in the low 70s but still
negative 70 that's very strong so I mean
no surprise to us but yes indeed the 30
year mortgages has a very strong
negative correlation to the prices again
we kind of we you know you
you can obviously assume that is going
to be the case but it's always good to
see how negatively correlated it is okay
so I think that's where we'll cut off
this this tutorial but the idea here is
you know once you get all this data and
get the figures first of all knowing
that the correlation values you could
probably write out a pretty decent ish
formula using the current HPI well I
guess setup set aside the current HPI
and you could say something like this
you could say okay well the HPI ought to
be you know something times you know the
30-year mortgage plus you know something
about the I don't know the market the
economy equals HPI and if the current
HPI is greater than that then you would
say okay we're worried about the market
or if it's less than that if the current
HPI is less than that and then maybe
you'd be like well there's going to be a
correction soon we should invest in the
housing market
now my best guess is probably the best
strategy is to still just just buy the
housing markets that diverge down from
the housing price index especially if
the housing price index is diverging up
at the same time as the other one is
diverge
down I think every time you have a
situation like that like if you're
starting to get past negative point 5
correlation between any housing price
index with the housing the overall US
housing price index make a buy there and
I bet that's where you you'll do very
well for yourself but we can test that
maybe later on this is mostly just
trying to get us familiar with doing
panda stuff but maybe we'll we'll throw
that in at the very end just to see if
I'd be a very good real estate investor
but after this what we'll do is we're
going to add a few more data points in
the next tutorial we're going to kind of
do that a little faster and then after
that we're gonna bring in scikit-learn
to do machine learning and we're gonna
see if we can apply just a really basic
machine learning algorithm to this data
and see if it does any good you know
going further but the idea there is just
to kind of show you guys that you can
work with data in the pants data frame
manipulate Beauvoir output that data to
an umpire a feed that through whatever
other data analysis library you happen
to have but scikit-learn is a really
powerful one and do some really really
cool stuff I don't really have too much
hope at least at this stage we would
probably want to collect a lot more data
and you want to collect data that was is
more like futuristic outlook probably
rather than the current HPI the current
economy and the current you know
whatever you might be better off looking
into futuristic projections like in the
economy you can usually get growth
estimations stuff like that you can
usually get employment estimations and
interest rate you know because people
trade you can look at interest rates
this is probably getting a little too
deep actually but you can people trade
contracts and stuff that are pretty
indicative of what people believe
interest rates will be in the future
okay so you can look at what people are
doing there to extrapolate to the now
what the futuristic outlook is at least
expected to be and we can work on that
so kind of like crowd sourced knowledge
anyway that aside we're trying not to
get too too crazy in the series but
anyways questions comments concerns
suggestions whatever feel free to leave
them below otherwise as always thanks
for watching thanks for all those porn
subscriptions until
next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>