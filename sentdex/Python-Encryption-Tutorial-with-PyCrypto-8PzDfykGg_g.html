<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Python Encryption Tutorial with PyCrypto | Coder Coacher - Coaching Coders</title><meta content="Python Encryption Tutorial with PyCrypto - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Python Encryption Tutorial with PyCrypto</b></h2><h5 class="post__date">2013-05-24</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/8PzDfykGg_g" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello and welcome to my tutorial on
encryption with Python someone made this
request for this video so I went ahead
and made it it's going to be a little
bit longer than most of the videos by a
little bit I mean a lot of it simply
because there's a lot of information to
pass on with this and I can't really
make it in chunks because it's kind of
needs to be all together so if you don't
like long tutorials I'm sorry encryption
isn't going to be for you anyway so to
start we're going to need some sort of
encryption software so you're not going
to encrypt yourself it's pretty complex
stuff so you'll want to get at least
some sort of import of for encrypting so
you'll want to go this is the website
for pi crypto which is probably the most
popular encryption tool with Python I
would just download the latest version
you just click here and you'll download
the tarball if you don't have I'm going
to really talk too much about this if
you don't have anything to extract the
tarball with you can use a program
called 7-zip it's like seven - zip or
something like that and that'll get the
files out and if you don't know how to
actually open up the or install the file
it's usually pretty easy let me open up
a command prompt hello I'm going to go
ahead and rerecord this I just noticed
in the video that my command prompt is
probably one of the worst color is
possible for seeing what's actually
being said soldiers changing here so
when you open up the command prompt now
again this is a command prompt not the
Python interpreter let's say you've got
the file on your desktop you use CD for
change directory and you'll choose
desktop like it's basically change
directory is something that you're
already in but you type out like the
full directory too if you want but
anyway that's just command prompt
lingo so now that you're on desktop I've
got my crypto on my desktop so I'm going
to say CD into PI crypto I've got like
it's like a file folder basically for PI
crypto what'd I do wrong
oh we didn't have the Y there I PI
crypto there we go
and so once you're in the PI crypt of
folder you should see like a bunch of
stuff in that folder like this is the
folder here you've got Bilbo all this
stuff and if you scroll down here's a
set up py that's the file that will
basically set up whatever install that
you want to do and so the way that you
do that is you type in Python set up set
up py and then install and I've already
installed it myself so I'm not going to
do it but then you would just hit enter
here and that will install PI crypto and
really other any other import that has
set up dot py in it once you've got it
installed and downloaded from here
generally you're gonna well first I'll
teach you how to do it but most you know
if you're encrypting something that's
because you're transferring it or you
may be storing it for yourself or
something but encryption and decryption
kind of go together and so I'm gonna
have to show you them both and what I'm
going to do is just kind of split them
up and I'll have an encryption file over
here and then the decryption file over
here that way you can kind of understand
what's going on so to start off once you
have PI crypto set up properly you'll
need to do this import you'll do from
are from crypto die cipher import a es
now there are various forms of
encryption AES is just kind of one of
the many forms and generally there's two
different types of legis encryption
processes
there's symmetric key algorithms and
this is where you have the same key for
encryption decryption which is what IES
has and there's also asymmetric key
algorithms where you have one key for
encrypting and that one key for
decrypting generally the more accepted
version of encryption is indeed AES and
that you want 128-bit encryption
just for the record we'll talk about
that that in just a moment as we get to
it but yeah
AES is probably the most popular
form of encryption anyways so that's
what we're going to use the next import
that you're going to need is base64
base64 is used for is actually encoding
and you don't want to get that confused
with encryption they're two very
different things
basically encodings for putting data in
a specific format so it can be
recognized by it's kind of like you know
you convert something to a string or
something like it needs to be in a
specific format to be read by something
that's what base64 is doing it's
encoding it kind of like encoding the
URL so it can be recognized it's it's
the same stuff so you'll need base64 for
encoding and then the third and final
import that we're going to need is
import OS and the reason for OS and what
we wanted OS for is for the function
called you random which is kind of
accepted producer of randomness that's
suitable for cryptology simple random
isn't really as it is accepted I mean
you could use it but people prefer you
random over that so moving right along
now we're going to define our encryption
function so say encryption and then
within here we're going to do we'll just
say our variable parameter rather is
going to be private info and so the
first thing that we want to specify is
lot size size and basically you can
choose between 16 24 and 32 for AES and
that's going to corresponds to bits like
these are bytes and then it corresponds
to bits so you could do 32 bytes for 256
bit encryption or you can do 16 bit or
16 bytes for 128 bits and so on so we're
going to do 16 bit or 16 bytes for 128
bit encryption which is the accepted
just as an aside if you're if you're
trying to learn how to do encryption
because you accept maybe like people's
credit card information online or
something like that you're kind of like
obligated to encrypt their data and the
basic
trying to think like the widely except
the one that the US government backs is
128-bit AES encryption so that's what I
suggest you use if you're liable for any
of the information that you're storing
but also the reason they support it is
because it's good just another side
basically a you can go as low as like a
32 bit encryption and basically with
today's computational power a decent
computer would have that key just by
brute force techniques only they can
have that key correct and probably like
less than an hour
so 32-bit keys are not very protective
at all the 64 bit key is getting closer
it would take probably like a few months
with a decent computer and that's only
if you know for if you ran through all
100% of the combinations like if you if
you don't have like it's highly highly
likely that you're not going to run
through a hundred percent of the
combinations before you find the correct
one but anyway with 128-bit this is
considered pretty safe at the moment
just because it would just take like
centuries with a bunch of computers to
crack it but obviously over time as
processors get better and better you're
going to need better encryption so
anyways moving right along after block
size the next thing you have to define
is padding this is the only thing that
really confuses me it's like some sort
of algorithm that you can use but you
can put like anything in your like you
can put like 9 and all this kind of
stuff like apparently like this opening
curly braces is like some sort of
algorithm if you understand that let me
know I don't really understand it myself
I just know that that's what people do
so that's what I'm doing and I guess the
reason you use padding at all is so it's
for sure like whatever your the values
that you encrypt are multiple the block
size and length so this is just like use
some sort of padding to ensure that that
is the case so it can actually be like
understood and decrypted later on so now
the next thing is
if I just pad and to do this we're going
to call lambda and our parameter for
lambda will just be C derives I'm sorry
lambda a parameter will be s and then
we're going to say S Plus block size
minus the length of s size times paddock
so what's happening here is we're
actually we're like we're actually gonna
pet this is the process to actually add
the data with our padding up here just
as a quick aside let me show you what
lambda is since if you're not familiar
with lambda you might not understand how
this works and so I've just brought up
the command prompt here oops
actually let's close that out I just
need to have Python up so if you're not
familiar with lambda let me just show
you what how lambda really works it's
kind of like a really really quick way
to embed a function in a function and
it's like a one-liner function it's just
really easy to do it so or really like a
function and a variable anyway so just
as a quick example let's say we want to
define our variable as addition equals
and then lambda and this is basically
the glam de is like notifying python
that we're about to do this really weird
thing and then kind of like a function
you have to define what your parameters
are but there's no parentheses so you do
like lambda X and then just like at the
end of a function you have to have a
colon and then you specify what you how
you want that function to work so we're
just going to say X plus 5 okay so hit
enter and now that's been defined so now
what you can do is you can say addition
and we'll do three so it should give us
eight and sure enough it gave us eight
and that's all thanks to this lambda now
the reason why it's actually used in
encryption is it kind of it's it's used
for abstraction of functions so that's
really the reason why you're using it
with in with with encryption basically
so moving right along now we're going to
define how we want this to be encoded
and so you're gonna just will call this
in code AES equals and I'm going to hit
up land again C and as basically to
correspond here we want to call base64
and again this is basic C for is for
encoding dot the 64 code and then so
that's what you're actually going to
encode and then you want to encode
whatever you know the C variable is or C
parameter rather C dot encrypt then we
want to equip the padded version of this
s variable basically or press parameter
and close that again and we'll go time
and I want to say okay yeah so we're
done there now what we need to do is
every basically every encryption has a
key and so now we need to generate this
key so we're going to call the key
secret and that's going to be equal to
OS you random which is what why we
imported OS up here you random and then
you have block size here block sides
and then just so we can actually see it
we'll want to say you know print
encryption key and secret and now what
we need to do is establish a cipher
object basically so to do that you're
nice I frequent AES and then secret
we've end this space here and then
finally we encode whatever our string is
going to be so encode double column
equals and code a es which is talking
about here and now our two variables
because our encode AES is lambda C comma
s so there's two parameters that were
given here so now you have to specify
the two parameters that you want so
you've got cipher and then private in
the boat and as you can see what's going
to do now is it's going to do cipher
it's going to encrypt the cipher and
then use or basically it's going to take
the cipher encrypt with the padded
version of s it's the basic the easiest
way I can say that which wasn't very
easy and then finally you can print out
encrypted string join on ax and then
encode it and now we have hopefully
explain to you how encryption works and
now let's see what it looks like for us
we'll call encryption
encouraged and then inside here is where
we're going to put a secret message that
is very sensitive want no one here we
did even the government hit enter and as
you can see here is our encryption key
and then this is the actual encrypted
info now just as an aside what you can
do later on is you can just say cipher
equals and then oh we misspelled the
string that's going to bother me anyway
you could say secret I'm sorry not
cipher
you could say secret equals so instead
of generating a new one this is how you
would generate a new key but instead of
doing that like say you've already
established a key that you like and
you've maybe memorized for yourself you
would just put this within there and
then you're obviously like this is non
ASCI coding which show you have to have
something up there but I'll show you
that just seconds we're going to need it
for the decryption anyways
let's run this one more time since
something like arrive there actually let
me close it so we don't get confused
so again encryption you see close it
okay and then here's our new encryption
key because again we generated a new one
but again you can't just generate new
encryption keys every time you need to
generate just one if you're sending the
data across somewhere you're going to
need just one encryption key and so like
both sources are going to need to know
it so anyone now over in decryption how
do we actually decrypt this stuff now
that we have the key anyways so Sam
imports as before I'm just going to copy
and paste them over and now we need to
define decryption and then if within the
parentheses we'll just say our parameter
is encrypted string colon padding we're
going to say the execs padding for sure
that's sane now we define decode the
code AES and then we have our lambda
function lambda C comma E and we're
going to do C decrypt using base64 dot B
64 decode because we're going to have to
decode the encode of this information
and then obviously the variable in there
is an email dot our strip and we're
going to be stripping away the padding
that we added before so
padding
now our encryption not sure why I've
done this encrypted screen let's see I
guess what I would want to do is you
suppose say the key equals and we'll
define our key now which is this and
once we run it it's going to tell me
I've got some funky coding and what to
put up here I don't really know what to
put up there just yet so we'll wait till
we get to that point because this is
clearly non ASCI characters so the next
thing we want is cipher equals a s dot
new and we're going to want to use the
key that we had before for the cipher
and decoded then is going to equal the
code AS so obviously we're referencing
up here cipher using that cipher that
we've just said and then we want to use
it on the encrypted string close and
finally print decoded so hopefully we've
not spelled anything wrong yeah sure
okay so we need to add this to the top
of the file hit OK but if you also just
hit edit my file to go right up there
for you so we'll use that save it we'll
run it we'll bring it over here and then
what we'll do we'll take this
information here and we'll say
decryption now we've already put this
key into here because this the Python
shell isn't going to automatic you would
have to have this coding in there
beforehand but what you could do is
instead of saving the key in here since
we already know it's going to be CP 1252
I'll show you guys in a second that you
could take key out and then put it in
this parameters here because obviously
not going to want the key to be in your
script like you'd want to save the key
anywhere so anyway I guess
you could have the key in there but
generally you probably wouldn't want to
if you want it to be super safe
you would probably probably want to be
pulling the key from another file that
possibly encrypted itself holds it in Oh
in cryptid string so we just need to
slap this misspelled encrypted string
right on in there hit enter and sure
enough it decrypts it into private
information that you do not want the
government to see and that's really it
that's all you have to do to do
encryption so anyway I hope you guys
enjoyed hope you maybe learn something
and until next</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>