<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Dynamically Graphing Terms for Sentiment - Data Visualization GUIs with Dash and Python p.10 | Coder Coacher - Coaching Coders</title><meta content="Dynamically Graphing Terms for Sentiment - Data Visualization GUIs with Dash and Python p.10 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Dynamically Graphing Terms for Sentiment - Data Visualization GUIs with Dash and Python p.10</b></h2><h5 class="post__date">2018-03-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/K6ixFSxZAX0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to
part 5 of our sentiment analysis live
graphing app and dash and Python series
in this tutorial what we're gonna do is
try to make this a little more of a user
friendly UI one it's very ugly but also
we just can't interact with it really
it's a live graph but there's really
absolutely no interaction unless someone
wants to come into the code and manually
modify that there which is unacceptable
so the first thing we want to do is like
we had with the stock app we just want
to have a can input field somewhere and
we can really put this anywhere for now
I'm just gonna slap it in the top I'm
really not gonna worry about layout
until maybe the very very end so until
that point this is probably going to be
a relatively ugly app we want to get the
functionality right and then we can kind
of try to make it look a little more
appealing so bear with me but yes so
said to do input basically all we want
to do is first of all we need to import
input and then we can add an input
pretty much anywhere but but these are
out you know these elements are going to
incur in the order that we do them and
don't forget again later on we can put
them in divs and use rows and grids and
stuff and make it pretty but for now I'm
just going to slap it right above the
graph and hopefully in line so where
this will be a DCCC dashboard component
input and then we're gonna say the ID
the ID here will be the sentiment term
and then we'll just say the value equals
try think if I can on I don't know we
could go with let's just go with Google
maybe or something or Twitter Twitter's
probably the most fitting will go with
Twitter so value will be Twitter and
then type will be 'text and then let's
not forget a comma here and not hit an
error because I'm hoping to just update
this without having to close anything
one viewer suggested to me that if you
want to kill the server introduce a
syntax error
you can you could do like a print this
not not in sublime no sir and then try
to run it and hit that syntax error and
then you wouldn't have to kill the
server that was the suggestion thus far
I think that has actually worked if you
want to like end the server without
having to go to task manager on Windows
other people have suggested use Linux or
probably Mac would work maybe better not
better than the Linux but better than
Windows but again I mostly use Windows
to record tutorials it's the best
platform for recording on besides me me
Mac I just I like Windows better anyway
enough on that what were we doing adding
an input so there's our input now what
we need to do is take in that input
through our callback so we've got the
output that goes to the live graph now
we also want to add input yes I found my
keyboard what we're gonna do this comes
in as a list and it's going to be
capital input and again just like before
don't confuse that this is you know
there's there's really kind of two
inputs there's - dependencies input and
then there's the actual - core component
input that is like the element D which
also sounds weird or feels weird because
it's really an HTML element and anyway
it kind of gets confusing I don't know
how to do it better I still am in love
with - but the naming gets confusing
sometimes at least to me I'm sure
everybody else is not confused so so
anyway the input the CIM component I
need like I said two mates or else this
would be the last one for today I think
equals sentiment term thank you
autocomplete and then with the input
basically we want to you know we get we
got the ideas sentiment term but then
what are we looking for well we're
looking for whatever was what's that
whatever is in the value of that so
we're gonna say the component underscore
property is the value so whatever
happens to be in there and that's the
input that we're after and again just
like before
don't forget your comma although it
should break
smoothly if we made that kind of an
error once we've got that that component
ID becomes the thing that are the value
that is the thing that we're gonna pass
and we're just going to pass that a
sentiment term through to our function
and now we can use sentiment term inside
our query now this becomes a problem
because in oh my guess is just updating
I don't know why it's going crazy there
why is it why is it pokin this out at us
why is that bleeding over it appears
that like that's bleeding over from the
from the Twitter stream I'm still
streaming the tweets that's interesting
am i right to believe that that's
pouring over into this one I don't know
how I don't know how this console works
and sublime so I'm gonna have to look
and see if it ever actually pops up
anyway interesting okay so the problem
is we're trying to read SQL and the
first parameter has to be that query so
the real temptation here would be to do
a dot format right when you look for
that like command but biggest rule of
any sort of development especially web
dev is don't trust your users even if
99,000 or 99.9999% of your users are
good well-mannered people it only takes
one person to drop your entire table
it's bleeding over why is it doing that
that's interesting doesn't seem right
why are we ever print it do I print it
here like I don't see any print or D F
dot head or anything why is it pop it
out over here it's got to be obvious and
I'm just missing it anyway it only takes
one person to drop your entire table so
we can't do that now luckily pandas does
come with a way to parameter
is the the input but can get kind of
annoying
here is the way to do it I'm just gonna
copy and paste it over
post so through a bunch of tinkering and
I found the docs for pandas and then I
had some help from a friend thanks
Daniel we figured it out and basically
we're gonna use this you can you know I
think it's like pepp 249 or something
you can use any of the the options there
we're just going to use this one but
basically what I was trying to do is do
like this and then the parameter was
just sentiment term instead what you
actually you have to do is just like
question mark and then build it this way
weird in my opinion but that's how it's
got to be done and that's how you can
watch out for SQL injection okay so now
based on whatever sentiment term is when
it comes in through that input why is
this happening it's driving me nuts
anyway based on whatever that input is
we can we can make our graph so let me
go ahead and let's save this and I don't
think it's gonna update without a
refresh is it running list index out of
range why are you at a range is it cuz
the default word why would it be out of
range dang it it's gonna kill my server
too is it actually dead no that was
temporary okay okay so the term right
now is Twitter now what's cool about
this is we can do all kinds of things
like for example each time we delete
something it's gonna refresh so this is
anything with you know Twi I can think
of a few words that start with T W so
alternatively like this is nothing so
this is actually just the raw the entire
Twitter just everything and as you can
see it's in those little chunks coming
through we can talk about how to smooth
that here in a second
but anyway another term would be like
guns so G u n for example and now we've
got gun sentiment which is fluctuating
around 0 looks like a lot of things are
flux
waiting around zero how about house
Trump doing today huh Trump is pot wait
okay it's catching up okay but he's
still positive okay so so that's a
perfect example of like how long did
that take like typing Trump it's like oh
it's got to go through every single one
I wish that wasn't required one option
could be to fill in the text form and
the input comes on the search button
click or something but another option is
like I said another user pointed out to
me how long and anime equals true takes
and how costly that is so what if we
change that to false and let's go back
here so the animates still happening so
I'm just gonna refresh and I think
hopefully at this point the antiochus
clearly animate isn't happening now
let's do G U and s it means as quick as
we type it in so interesting how gun
versus guns uh is it's a different time
range is this is a subsection so like
I'm pointing to my screen you guys can't
see that huh
anyway guns like I think maybe gun is a
guns uh should be a subsection of gun
but I'm not seeing the matching pattern
anyway so now what we're gonna do is one
issue is these time stamps they're a
pain in the boot to read so so one thing
we can do is fix that right away so we
can come down here and rather than
plotting D F dot UNIX type values we can
just convert this so we can create a
date column instead so we can say D F
date and that's equal to P D dots to
underscore date/time and then we're
gonna pass the column which will be DF
UNIX and if it was a true UNIX timestamp
we would say unit equals seconds but
it's not it's in milliseconds so we say
unit milliseconds and then what we're
gonna say is DF dot set underscore index
and where I set that index to date
naught capital D lowercase D and let's
do it
in plays equals true cool now
let's just do I think we can just say DF
dot index dot values here I think if
that's gonna fly or not find out soon no
let's try DF dot index because it might
not like the list form write DF dot
index what it wants so converting it to
a list probably made it like string is
my guess
and it really wants date/time values so
anyways now it's a date
cool so so what are some other things
that we could we could do so once we
have a date time index of proper
date/time index we can also do like
resampling so again going back to like
let's just say raw twitter sentiment
this is kind of ugly and like so
anything where we would want maybe more
history or where you've got something
with high volume you probably want to
grab more data but you don't want to
plot 10,000 rows of data instead you
want to apply it I don't know a thousand
or something like that so one way we can
smooth things out is we can once once
we've done the set index we can go and
we can do a DF equals D F dot re sample
and then we can re sample to let's say
one second and then again you can do how
equal sum or mean we'll do a mean so an
average and now it's much cleaner so
this is the this is that raw sentiment
that we were just watching for was
basically impossible to look at now okay
it's understandable I mean I actually
see the updates happening all right so
so that's super helpful okay
the only other thing I'd probably like
to add is maybe to our layout so in our
layout another thing that we can add
here is a title so we could say title
equals and then let's just say term
dot formats and then we'll just do
sentiment term so now we can actually
see what the term is although it's empty
in this case but we could type Trump
interestingly enough there's not enough
data on Trump I don't think so going to
the one second won't even connect Trump
what about uh USA no you know say the
same thing plus is good enough but USA
no so we would need more data so so
rather than let's say let's say first
for less common words rather than
resampling to one second we could say
300 milliseconds or should it be more
we're gonna see in a second trying to
think logically about that yes so it
should actually be a higher number so
maybe I don't know 30 seconds and then
let's try USA right
okay so then it's finally connected okay
so but depending on what kind of search
volume you're gonna look at you're
probably gonna want to vary these values
and stuff like that so you probably want
to stick with maybe milliseconds and
then how many milliseconds so for
example rather than 30 seconds you could
say you know 300 let's do 3,000
milliseconds would be 3 seconds or
30,000 so just pick one metric that you
wanted to stick with and then you could
make that metric some some some ratio
basically of however many data points
you did come up with in that return
because you want it to be dynamic
depending on which term or word you're
dealing with right because as you can
see if we're gonna use 30 seconds well
in 30 seconds we really get enough
tweets to fill an entire 30-second mark
you know or at least very close to fill
up that entire 1000 values so you
wouldn't want to use that with something
as high-volume as everything so so
anyways you probably make that somewhat
dynamic anyway moving forward I'm trying
to decide what I really want to add next
but one thing I think I want to do is
while it's cool to get live sentiment
for a specific term
one thing I think would be kind of cool
is to get let's do a thousand
milliseconds here there we go one thing
I think would be cool is to also get the
history so like you get live sentiment
up here but but our Twitter database
it's gonna keep growing and it'd be cool
to get a much larger history so doing
the live you really want to make a
pretty small query so it can run pretty
quickly but then you might be interested
to know you know over time with with
Google or or let's say yeah you're an
investor and you're interested in Google
for example which doesn't have too many
updates where is let's try let's see if
we can resample to let's do 100
milliseconds or we still have enough
Google data anyway
but let's say you were gonna do
something like Google or let's say USA
so we could type us Andy here and
obviously we don't have it connected yet
so probably maybe maybe I'll add that
the dynamic resample based on how much
data we have so that'll be one thing but
also have like a historical down here
and then the other thing I'm interested
in doing especially now that we're using
text blob is we can we can use we can
run this data through and start to find
out related terms like with USA or with
something like Trump right we can get
the related keywords to Trump I keep
forgetting if you would have to go down
or up it's a ten seconds you'd want to
resample for Trump there we go
still missing a connection but anyways
you know we have Trump and we have
positive cymet but one thing we can do
is we could say okay what are the
related terms so we could look for the
nouns
especially like proper nouns related to
Trump right and then we could determine
the sentiment for those proper nouns
right and then we could figure out like
okay what's what's Trump doing good what
do we like about Trump what's trunk
doing bad what do we dislike about Trump
right or is Trump doing anything good or
any
bad or whatever like you can find all
those things and does obviously doesn't
have to be Trump it could be any search
term that you type into there so
something like that I think will be kind
of cool to pull a much larger scaled
amount of sentiment and update that as
well and I'm also curious to see if you
know how well you can update different
parts of - I haven't even tried to do
something like that so I'm curious to
see how that'll go so anyways that's
what you guys have to look forward to if
you've got questions comments
suggestions whatever you feel free to
leave them below otherwise I'll see you
in another tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>