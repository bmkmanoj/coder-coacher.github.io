<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Database &amp; Migrations - Django Web Development with Python 8 | Coder Coacher - Coaching Coders</title><meta content="Database &amp; Migrations - Django Web Development with Python 8 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Database &amp; Migrations - Django Web Development with Python 8</b></h2><h5 class="post__date">2016-01-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hU5QSQt6yQc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello girls guys welcome to part 8 of
our django tutorial for web development
Python in this tutorial we're gonna be
talking about is migration so basically
if you recall every time we start an app
what's one of the first things we need
to start thinking about is install that
app and create like a URL spy to that
app when you create models the first
thing that should pop into your head is
we need to make migrations okay so
remember how is telling you that models
correspond to your database information
okay so this is your table columns data
types
what Django does is it separates you
almost entirely from actually writing
any SQL or any other database
information or language and so it it's
pretty high level so when that happens
sometimes things can seem a little too
magical or sorcery or something like
this but what it does is basically it
takes your model and in the backend it
reads whatever your database back-end is
and it automatically generates the SQL
required to make modifications insert to
your database make updates on even
deletes so so we're going to be talking
about here is how that really works okay
or at least how it works with you so um
so we're going to do is we're going to
close out of models and like I said we
need to do a migration so if you
remember way back when when we went to
go run the server and it's and it gave
us like a little bit of an error it
wasn't like a stopping air or anything
or a braking error it was just like a
notification like hey you've got a
migrations that you need to make and
that was because of the admins or the
admin app which you never create an
admin app but it does exist with all
Django well at least by the default so
if we go to my site and then my site and
settings you'll see that there's
actually quite a few apps here you've
got the admin app auth sessions messages
content type static files and so on so
you do have other apps that you you
probably didn't even create so you have
to run migrations anytime you've got
models and if we go back here you'll see
that we do have a DB SQLite three it's
only 30
kilobytes it's not really populated with
anything so there's really probably
nothing special there so what we're
going to do is we're going to make these
migrations so when we go to make
migrations we'll probably find that we
have two major migrations that we wind
up making one is for the models PI and
the other one's going to be for admin
unless you already migrated admin so if
we pop in to migrations you'll see
there's really nothing here besides an
init file that just says hey this is a
packet or basically that just says like
a treat me like a package otherwise
there's really no other migration let's
see personal has some migrations but my
site really doesn't have anything anyway
so each of your apps is going to have a
migrations that's specific to it so
we'll see here in a moment so let's go
ahead and we're going to run the server
so first as usual it's a Python manage
type I run server so python managed pi
run server and it actually didn't find
any issues i possibly run the migration
for the for the admin let's go ahead and
visit our website real quick so this is
our website everything is is sort of
running at least so first let me this
over whoops I didn't mean to do that
bring that back freaking window shake
you know oops I clicked on blog no such
table blog post of course because that
doesn't exist
so what first thing I want to do is like
let's go to slash admin and so far it
looks like admin actually does work
we're not going to be talking about
admin here but I didn't think I'd
actually set up admin on this specific
one that's okay let's go ahead and break
this and we're going to go and do
managed up hi
and first we're just going to just do a
Python manage up hi migrate run that uh
and so maybe we've already done yeah so
I guess I've already run the migrate but
hopefully like go ahead and do that just
so you get the admin one out of the way
so the next thing that we're gonna do is
so when you make my way when you do
migrations basically there's like two
major steps and probably it's always
best to do three major steps so the
first major step is going to be to go
Python managed up I may
migrations no space there so you make
your migrations and you'll see that okay
we made migrations at least four blog so
Jango goes through and sees okay there
was a change to the model spies since
last I knew of it and it creates this
migration and you can see it creates it
in zero zero zero one initial PI create
model post so let's go check that out
real quick before we move on so we go
into blog migrations sure enough there's
our migration let's go and look at it
real quick
and we can see that okay here's what
it's doing it is it says here's our
migration it's the initial migration no
dependencies here's the operations it's
going to run it's going to create this
model call it post fields remember I was
telling you before that Django is just
automatically going to create that ID
for you sure enough there it is otto
created primarykey maybe it just otto
increments on its own or something I
don't know anyway maybe that's what Otto
created is I'm not sure somewhere you
would expect to see Auto increment as
well but maybe Django just knows that or
something I don't know if someone knows
which of these parameters is the auto
increment or why maybe it's auto auto
created just doesn't sound right but
maybe because it's the primary key it's
auto incrementing because primary key
means is going to be unique but anyway
whatever so that's the initial top hi
cool that looks good to us normally I
would not really check the initial dot
like you can look at them if you want if
you want to look at your migrations I
want to really look at them the only
time you would do it is if you're trying
to actually like go back in time because
you'll save all these migrations so it's
like a constant state of your
application which is pretty cool so I'm
going to close out of here and so that's
the first thing we would do the other
thing you can do is like if you want to
make migrations for like a specific
application you can do something like
this like Python managed at PI make
migrations blog okay so you can do
something like that but this is going to
now now that we've already made that
migration before it just says no change
was detected don't worry about it okay
so now in theory we you can run a a
migrate right now and live changes will
occur too
database but first it might be wise to
see maybe what's going to happen when
you make the migration luckily you can
do this so with SQL there is no like
undo button okay so you can you can undo
with Django like the schema but if you
go deleting your database as far as I
know right now there's no like I mean
you can always make backups of course
but you got to be really careful anytime
your change in SQL around so what you
can do is you can say you can go back up
python managed up pi and then type SQL
migrate blog and then the actual
migration ID let's say so this one is 0
0 0 1 so we can say 0 0 0 1 hit enter
and this is going to give you the SQL
that will be run so this is a create
table the table name is blog post which
is pretty cool because it just
automatically takes post calls it blog
post with it anyway that's pretty cool
and ID that's automatically yeah see
where did you get that Auto increments
killing me how does it know that's some
Django magic anyway so it's your primary
key Auto increment it gets your title
which is calling a VAR car not null body
is a text data type not null date/time
so these data types here VAR car that's
a SQL data type a body text might even
be that's like this almost specific
SQLite data type you rarely would use
text I'm pretty sure in in MySQL and
then you've got date date time so as you
can see this normally you would write
this query but Django just writes it for
you based on your models and you might
ask well why am i using models then and
if you're not totally convinced up to
now when we get into the admin you're
going to realize why you why that why
you do models so if everything looks
good then you would go ahead and run
Python managed up high migrate ok apply
to all the migrations good render dumb
applied the blog initial migration ok we
don't see any errors let's go ahead and
hit up Python manage that pi
run server running the server let's go
ahead and visit our home page here
so here's our home page we click on blog
and nothing is there
well clicking on blog tells us that and
just the mere rendering of blog tells us
it visited the table it made the query
no errors everything happened as it was
supposed to what's missing here is there
is there are no blogs okay so so how do
we begin creating blogs well we could
make ourselves like a new blog a kind of
model or a new blog view where we can
like type up our blog and stuff like
this and that's what you would have to
do in most languages or most languages
most frameworks let's say but with
django django has a really powerful
admin that can access all of your models
and you can update your models and
change them and make new ones and stuff
like this so that's what we're gonna be
talking about in the next tutorial so
we'll be adding some blogs and that
would be basically the completion of our
blog application so pretty cool so if
you have questions comments concerns up
to this point if you can't get to this
page for whatever reason if you can't
like load your blog page there shouldn't
be anything there if there is stuff
there I'm not sure how that worked out
for you just more jingo magic I don't
know one of these days jingle write your
blogs for you but anyway if you can't
get this point ask questions below do my
best to help you out maybe some other
people can help you out otherwise as
always thanks for watching things for
all the support subscriptions and until
next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>