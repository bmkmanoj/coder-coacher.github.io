<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Pattern Finding and Storing: Machine Learning for Algorithmic Trading in Forex and Stocks Part 6 | Coder Coacher - Coaching Coders</title><meta content="Pattern Finding and Storing: Machine Learning for Algorithmic Trading in Forex and Stocks Part 6 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Pattern Finding and Storing: Machine Learning for Algorithmic Trading in Forex and Stocks Part 6</b></h2><h5 class="post__date">2013-10-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/vEu9OvHj8QE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">you
hello and welcome to these sixth part in
the tutorial series of machine learning
applied to stocks and Forex where we
left off we were making this pattern
finder basically and we printed it out
but we're not actually saving the
pattern or anything so now what we
actually want to do is begin saving this
pattern so what we want to do is come up
here and create an empty global array
and actually to empty global arrays
first one we want is pattern AR for
pattern array that'll be empty for now
and what this is going to do is as we
run pattern finder every pattern will
get stored into the pattern or right
subsequently the next thing we're going
to do is create a performance array and
everything
well after we as we make this pattern
while we're making this pattern we
actually we didn't save it to a variable
but we will we stored the outcome right
which was an average of in the future in
the next twenty to thirty points what
was the average price at the time and so
we're calling that the outcome right so
we're also going to store that to the
performance array and in these two
arrays each each value in the array will
have the same index number as its as its
partner now you might think well why
aren't we making a dictionary at this
and it would have been nice to make a
dictionary or you can make like a
multi-dimensional array or something
otherwise known as a dictionary and
usually but the issue is with the
dictionary what we really needed was the
key to be the pattern array because what
we're going to do is we're going to we
find a pattern we find a similar pattern
and then we wanted to compare that
pattern and see what the outcomes were
but the issue was you can't have an
array as the key and if you have no idea
what a dictionary is don't worry about
it I guess but for anybody that does
know in a dictionary is probably
wondering why we're not doing that so
you can have an array as the key to the
dictionary it would have to be the
performance value but you can't this is
the kicker you can't have an identical
key in the dictionary right you can have
identical values right you could have
different keys equal the same thing but
you can't have identical keys so when
you stick when you go to define that key
you would overwrite the most like the
other key and the problem with this is
you would be overriding possibly better
results like a more accurate pattern
might end up getting more overwritten
anyway it would be a huge mistake to do
it so we're not going to do that we're
just going to make two arrays so anyway
so that's that so those will be empty
for now and then what we need to do is
come down into our pattern storage here
or I mean our pattern finder rather and
in fact we should change this name to
storage because actually soon we'll
actually make a pattern finder and that
will make more sense to call it pattern
finder so we'll say this is pattern
storage that's what it's doing is its
storing patterns now the next thing that
we want to do is well that would be kind
of useful is up here
well it's can't decide if I want to do
it or not but usually in something like
this like in a machine-learning type of
script or a script that's doing a lot of
calculations you want to have processing
time so we'll just say a hat start time
equals time time so that will store
whatever time it is currently and then
at the very end of this script basically
we'll just come down well first of all
we don't need this anymore and then
we'll come down here one tab over nth
time will be also time time let's say it
enough Pat and and see Pat start time
Pat in time okay and then and then at
the end we'll subtract the two and then
then you can find out how long the
storage of patterns so this way you can
start to find in efficiencies in your
script now the next thing we might want
to do is we'll change this from a print
and we'll call this average outcome and
we should also encase this and try and
accept just in case and I'll talk about
that in a second the reason why we're
going to want to do this
is with our person we're going to be
doing a percent change of a percent
change and so this can give us
especially well I won't get into the
maths but well you can wind up with a
negative infinity percent change so
anyway what we're going to want to do is
accept exception E and then print string
E just in case we've type out or
something and then also the if if this
does happen we'll just say the average
outcome is zero but just throw that in
and try and accept just stick just to
keep ourselves same here now what we
want to do is remember how this
basically the average outcome created a
number right it said with the digit of
that outcome was well that's no good
right we need it to actually be a
percent change as well right so so again
we need to normalize everything so again
probably this is the most accurate
representation of using percent change
or a logarithm
but anyway so now we'll do future
outcome equals and our lovely percent
change formula will come into play here
and that's going to be current point
average outcome now with that keep in
mind the average outcome can be zero so
that gives us a possibility of a
division by zero and also all kinds of
interesting stuff so the other thing we
want to do is also consider the fact if
like let's let's uh let's just let's run
this round so let's save and this is our
start point and this is our ending point
right so what if we went from negative
10 to 10 right this is saying that if we
start from negative 10 and we go to 10
we went to we did negative to 100 no
that's not right right but the problem
is we're dividing by a negative 10 and
that division is actually meant to be
something that kind of sizes the
equation if
you really break down how the percent
change formula works so really what we
want to do is come over to our percent
change formula here and instead of
dividing by star point overall we
actually just need to divide by the
absolute value of star point so we'll
save that and let's run that again and
let me drag this back over again and now
if we do percent change let's we want to
confirm that 10 to 20 works what if we
did 10 to negative 20 negative 300 but
what if we did so that that also still
works if the negative is on the other
side of the equation but what if we did
negative 10 to 20 and that works as well
so positive 300 negative 300 100 so
everything still works
you just need those absolute value bars
or just well absolute value parentheses
in this case but it's basically what you
know absolute value bars does and
written that so we need that there as
well because we will have percent change
using a negative negative numbers when
we compare well not only future outcome
can have it but then also when we're
start comparing formula or comparing
patterns we're going to see it a lot now
the next thing we want is no longer do
we need to print all of this out there's
not really much point to it will keep
the make sure you keep the y plus equals
one though
now the next thing we need to do is if
we go
we need to append the pattern into this
pattern array but also we need something
that's like pattern right so Wow why is
less than X where we start with an empty
you know pattern alright and then what
we need to do is let's just copy this
print now come down here and what we
need to do is pattern dot append and we
need to start appending all this pattern
you obviously need to append it in the
row in the order right so pattern pen p1
and then we'll go ahead and in fact I'm
just going to delete this comment and
stuff
just to leave that pattern pampy one two
three four five six seven eight nine ten
and now let's fix this so two three four
five six seven eight nine ten so now
we've got a pattern appended one to ten
so it made an array so this pattern is
now an array of percent changes and now
all we need to do is do pattern array so
the array of patterns basically we want
to append pattern subsequently
performance array we want to append that
future outcome then Y plus equals one
let me bring this up a little bit and
separate those for ease of reading now
we've got Pat end time is time time cool
so just to make sure we've done
everything these lengths ought to be the
same so we'll print the length of
pattern array print the length of
performance array and then also we want
to print the time it took to store these
patterns so print pattern storage took
and then we do I already forgot what we
said
it'll be Pat end time - Pat start time
so Pat end time - Pat start time seconds
okay cool so we'll save that and let's
run this and make sure we are indeed
storing patterns and it will only store
all of the patterns found in one day but
I believe that was already like I forget
how long that this file is but it's a
pretty long file so should have quite a
few patterns let's run that no syntax
errors yet but let's see what else I
think we change the name of what pattern
storage now yes so we'll run pattern
store it store it and type store it cool
global name future you come so future
outcome fix that typo front of the game
up alt P for the last thing that we
tights run it seems like it might be
running this time okay cool so we found
60 1971 patterns 60 1971 outcomes to
those patterns and the storage of all of
those patterns and really the time it
took to run through this entire file
took to two point one two seconds so if
you were to use fresh data and run
through the month right that would be 30
days we take about a minute in theory to
do it all but probably actually a little
bit less but we can talk about that
later
so anyways sure enough looks like we've
stored all of these patterns we've done
it successfully so cool so our pattern
storage works and actually we could we
could test this and say pattern array 5
right so we see okay so this is the
pattern of percent change in rate 5 and
then pattern our performance array is
what we want performance array 5 what
was the outcome of that array and it's a
positive move so that would be a
positive already so that's going to
conclude this video on the pattern
storage function here in the next video
what we're going to be doing is creating
our pattern recognition so we're going
to look through well we're going to
store all the patterns we're going to
find the most recent pattern and then
we're going to find previous patterns
that are very similar to the current
pattern so I'm going to make another
function and it's going to be our actual
pattern recognition function so anyway
hopefully that sounds interesting to you
guys as always thanks for watching
thanks for the support subscriptions and
until next</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>