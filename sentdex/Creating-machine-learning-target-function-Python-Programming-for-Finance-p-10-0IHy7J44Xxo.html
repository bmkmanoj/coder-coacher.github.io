<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Creating machine learning target function - Python Programming for Finance p. 10 | Coder Coacher - Coaching Coders</title><meta content="Creating machine learning target function - Python Programming for Finance p. 10 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Creating machine learning target function - Python Programming for Finance p. 10</b></h2><h5 class="post__date">2017-01-23</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/0IHy7J44Xxo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome our 10
of our Python for Finance tutorial
series in this tutorial what were we
doing is writing the function that we're
going to map to our pandas dataframe is
we're gonna make a new column for the
target basically is this company a buy
sell or hold and we use that as the
basically the label for machine learning
where the feature sets are going to be
any percent change pricing information
for basically all companies so just for
the record I do a tutorial is based on
everything we're about to cover first of
all a for mapping utha project you just
go to python for internet type mapping
and sure enough Roseline mapping
functions for pandas there you have it
you can follow that or to learn more
about mapping functions otherwise you'll
see a quick live example here the other
thing will be args I'll show that in
just a moment so um now I'm going to go
ahead and do is kind of we need to have
that there for now and what I'm going to
say is we're going to create a new
functions we're going to call this vine
sell or hold it's conceivable we might
later have like just a spy cell just
that way that's a binary choice because
as we're all certain find out we're not
even we're not going to be very accurate
at all we're only going to be able to
generate a very slight edge over random
so buy sell hold and theory when we go
to test this our goal will be to be
better than 33% accurate and Amin and
then once you get accuracy it doesn't
matter because what happened what really
matters is in practice and we'll talk a
little bit more about this before we get
into back testing because just because
you might even have a strategy it's like
seventy percent accurate but when it
comes down to it the areas that's
inaccurate or what could cost you
everything so anyway you will get there
so this is going to take one parameter
and that one parameter is args which
actually lets us pass any number of
parameters if you want to learn more
about args you also could come in search
for type args and sure enough args and
kwargs right there and you can learn all
about our
and kwargs and how they work basically
just going to let us pass any number of
arguments and we can cut it it becomes
an iterable so immediately what we can
say is calls equals C for C in args and
the way this works is with mapping to
pandas what you'll do is you'll you've
got a function and this what it returns
it will go basically by row in your data
frame and you can either pass really
nothing or you can pass columns as
parameters if you'd like in to you can
pass other things as parameters too but
to work row by row it's interesting
because you can actually pass columns
themselves and it will take that road
that columns row value and you can
actually work with that so what we're
going to do is we're going to pass
tomorrow's price the next day's price
then XS rows and so on the whole week of
future percent changes we're going to
pass each of those and if any of those
again or over some value we choose in
our case we're going to go ahead and
make the requirement the 0.02 which
because our percent change we did not at
the end times by 100 that means 1 would
be 100 percent and you know 0.5 would be
50 percent so in this case 0.02 means 2
percent so if the stock price changes by
2 percent in in our case 7 days where
our ears will perk up or if it falls by
more than 2 percent we will want to get
out so what we're going to say is for
call in calls if the column is greater
than the requirement basically what
we're going to say is like at any point
in any of these columns its that column
if the value is greater than what the
requirement we're asking we're going to
return 1 otherwise again as well if that
call is less than the negative
requirement whoo we almost got ourselves
into trouble negative requirement we
return negative 1 otherwise if we get
through all the columns and we haven't
returned something yet because return
will basically cease the function we're
going to return 0
so in our case zero will be hold
negative 1 will be sell positive 1 will
be a bind so what's going to do is this
cuff has each of the columns and the
reason why we want to do it this way is
in meat like if we actually bought this
company if if it goes up two percent at
that point that's when we're going to
sell so if you're going to actually make
a strategy around this basically what
you would do is as soon as we got the
trigger that hey this is a company that
could plausibly rise two percent in the
next seven days okay we buy that company
we sell it or we put a position or an
offer for you know plus I don't know you
could be conservative well plus one
point five percent of the price we paid
and then also have a stop loss at
negative 2 percent or negative one point
five percent or something like that and
so our goal would be to hit that so as
long as that number gets hit first
before some other crash or something
then you're totally fine same thing
though with Falls like if since we're
going to be using a stop loss if the
price is going to fall more than two
percent before it rises two percent
we're not interested right now we would
want to invest after that two percent
fall and be happy with our 4 percent
rise so that's kind of what we want to
be thinking about here so so yeah so so
with that that's what we're going to
actually map to our columns and I think
I'm actually going to stop it here it's
just probably to take a while to go
through the actual next function and
it's going to actually map these columns
so anyways especially since I'm
releasing these in chunks that shouldn't
make anybody too angry so if you have
any questions comments concerns up to
this point a footprint even below
otherwise I'll see you in the next
tutorial where we actually map these to
the columns and at that point we'll
actually have our feature sets and our
labels and then probably the one more
after that we'll be actually seeing how
this runt so if you for that question
comes below see you next</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>