<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>A more interesting self-driving neural network model - Python plays GTA p.13 | Coder Coacher - Coaching Coders</title><meta content="A more interesting self-driving neural network model - Python plays GTA p.13 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>A more interesting self-driving neural network model - Python plays GTA p.13</b></h2><h5 class="post__date">2017-04-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/nWJZ4w0HKz8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Oh
you
[Laughter]
all right welcome to part 13 of our
grand theft auto self-driving car Python
tutorial series so what we have at the
moment is the latest version of the
self-driving car / motorcycle / whatever
so what I want to do is just kind of
show what I got to get up to this point
obviously this is not the best AI in the
world but you know it works so first of
all let me go ahead and put myself
somewhere useful again
let me grab another motorcycle
hopefully what it hits me pick this up
and we need to put on our helmet for
safety okay so let me pause this for now
and let's talk about what we got up to
this point so here is the attention
board for this basically I got three
hundred thousand training samples that's
this purple line here and that was done
oh I've got the screen in the way I made
it big let's see what can I do to get
rid of this maybe that there we go
so it's behind there and I just pulled
up a second screen basically that just
mirrors this one so I could make it a
little bigger so it's so tiny on my
actual screen anyway let me get rid of
that again on on tensor board now the
Purple Line is that is the main one the
blue line is the original just kind of
eight epochs of training that's just
going to show you how well it did again
just like usual the end of it seems to
do better but this one also has 300,000
training samples whereas this one this
blue line if I recall right had about a
hundred thousand training samples but
that I decided not let's go ahead and
shoot for the moon to about three
hundred thousand so even as we take away
smoothing we can see initially it was so
volatile but towards the end it really
started to smooth out so anyway and then
same thing lost was pretty volatile even
all the way up until the very very end
but smooth it out it did pretty good so
um so yeah so that's the training data I
will put a link in the description for
my training data I might also just host
the model the model took a really long
time to train it took about trying to
think maybe uh fifteen hours or I guess
that's not really a long time to be
honest but it took about fifteen hours
of just running this and that's on the
tight neck so so yeah and then if you
don't have a GPU that you can actually
train this way if like if you needed to
train it on your CPU and your RAM
yikes that would take a year so anyway
if you need the model cool you probably
could run this live on your CPU I don't
know if I'd want to but you probably
could
I could demo it I think you can do like
with I don't feel like doubling that
lives but but yeah you can force the you
know it's a run on the CPU but I can do
it anyway um so yeah so that's that
that's the data like I said I'll put
links in the description if I forget to
someone remind me because as of my
recording this I haven't uploaded
anything so I'll probably forget now to
the actual game as you can see the AI is
not perfect it still has a lot of little
things that we I want to fix mainly like
if we look here we can kind of see
although now it's not going to show but
let me let me just run this first one
moment just so I can show you so I have
it on pause so if I press key it'll
start hopefully running there goes so
same as before the middle one is to go
straight and then you've got left is the
zeroth element and right in the first
development and doing pretty good oh
that rock was relatively benign that one
was not is that clear I've also kind of
forced my guy to stay on so I can't be
ejected from the bike I'm also
invincible it's really annoying for
testing and training and such if you if
you just keep crashing and having to
reset and all that and turn the ball
volume down a little bit um okay so
anyways now that we've got some sample
data here so this would be how much you
want to turn left how much you want to
go straight and how much you want to go
right and kind of I was hoping to I
still don't have it yet but if we could
have paid control that's what we need
man it's what we need everybody put your
minds to it let's do it
that's the next thing I'm going to
personally be working on and so my
thought is that we can take these
outputs and actually have these outputs
set the pigs so in this case we'd be
almost a hundred percent turn turn left
for example but in some of these like
you would it be you'd be like here 73%
turn left
20% forward and then so much turn right
which we probably maybe subtract this
from
turn or just ignore this I don't know I
want to test it but anyways I'm thinking
we can do that with the data there's all
kinds of combinations and algorithms we
could run on it but that's what I think
we probably should do other than that
the other thing I've kind of changed
here is in the code I tried a few things
I try to slow it down and then I decided
there's no reason to slow down that's
not our problem so I haven't done that
basically what we're what I've got coded
here is just because I was finding that
it was maybe sometimes not pressing it
long enough and then other times it was
pressing it way too much
so I've forced a sort of sleep here so
basically it presses and it will sleep
for that time and hold that for 0.09
seconds again I feel like if we had paid
control this would handle for the the
reason why I'm doing this is because
every time we're turning we're turning
in a full 100% but also the training
data was me personally pressing the keys
right and I just I can't act as fast as
a machine can so that's the key to this
tea time now if we remove this sleep the
frames are actually really good still so
running off the GPU let me just give you
just an idea we'll output this hours or
run in the model already for some reason
I've noticed that the model after like
multiple starts and stops it stops
working and like it's clearly not
clearing the memory up which is really
frustrating but let's just run this
again now and hopefully it'll print out
the the sleeps but it's going to dry
probably like crap because we don't have
this sleep anymore I'm just I'm moving
it right now just for the record okay
I'm up it's off on its own now hopefully
not see here we go so I wonder if it's
just fail and then Python failed
interesting error retrieving driver
version permission denied could not open
driver passing so it's obviously like
like maybe in use or something like it
thinks it's being used no it's not but
I don't want to close the program but
I'm pretty sure it's going to close on
us just do this oh nice I didn't think I
could get away with that
anyway if someone knows what I need to
do they like clear out the memory or
something do let me know because this
this keeps happening is very irritating
wasn't happening to me earlier let's see
if it's worse this time
yeah you stop yourself please damn it oh
gosh
I really want this to not do this that
would be ideal if you stopped the wool
you know what hmm
okay well let me pause and get this to
work and then I will really continue
this pose okay I think we're good to go
all right so yeah so I'll press T now
and he's off okay this one has no sleep
so we can kind of see the difference
that's not too bad oh but he's releasing
the key immediately so he's not going to
make very good turns yeah he's kind of
trying to avoid this stuff but it's not
very good at it oh that seemed rock it
got us again anyway
I'm just I'm fixing it now it's like as
long as these little things aren't
updating at the bottom
it's me controlling it by the way so
anyway so now we can see Luke took 0.13
interesting it was even faster than I
thought oh so actually we're suddenly
getting about 10 frames a second fun in
it
I did have that be faster for me are we
doing the right
screengrab no dang it okay so that's
part of our problem right there so let's
go ahead and change this screen so it's
from I think it's grab screen so from
from black screen import oops I started
the AI great import grab underscore
screen
Green influence ground and then screen
should equal grab screen I'll exercise
somewhat that this thing so actually
let's just say equals grab screen in
fact we're going to have to stop this
anyways unfortunately and then it was
region
I think region equals so region equals
what is passing this cool okay so that
should be a lot quicker great and let me
run that real quick to make sure of
course I don't really want to run it in
here I guess if it works I'll just
switch over again or maybe I just want
to show up momentarily I kind of feel
like it's not going to work but we'll
see yeah see it's like hot stuff right
now although we probably press T let's
try again no no I just wants to die okay
okay so let me close that I don't still
have the other she'll open so I have no
idea why why it's not clearing it's
really irritating I wish I wish I knew
of a way to just force it to clear that
memory or something or whatever is
happening if somebody knows like let me
know anyway yeah let me pause it until I
can get it to run again okay and we are
back okay now with the new grab screen
function its 0.06 about ish percent T
again
this isn't actually the one I want I
like the one that sleeps better but
anyway okay so with you repaired grab
screen we can add we can process frames
that like you know more like 20 frames a
second or so so so yeah so that's that
let me think if there's anything else I
really want to cover on this exact
algorithm like I said I'll put it up and
and then kind of share my updates as I
go right now I've just got some turn
thresholds and stuff like that just to
kind of make sure that we're you know on
the right track as far as whether or not
we should actually take a turn if the
forward threshold is above 70 we're just
going to go forward otherwise as long as
the turn threshold suggestion is
basically above or the turn threshold is
behind 0.75 so like 75% certain that it
wants to take a turn then we'll take a
turn but we don't want to take a turn if
we're only like 60 percent or dinner or
something like that
let me bring back the sleep time save
that and probably this I don't even know
what we'll have to do to get this to
come back but anyway I just wanted to
show that it is at least 20 frames a
second ok and now for your viewing
pleasure let's just let this thing run
for a little bit it's not the best let's
see how it does so T so this doesn't end
well he's got to get out of this Lane
there we go mmm oh man
Oh oh my gosh I think he got just lucky
there but uh yeah really wants to eat
that media in there oh no oh oh you
don't want to be here
I think I'm not to get out of this one
change here is probably throw it for a
loop
but we'll see what goes right into the
rear end of that car
beautiful nope okay he's okay it's
probably gonna want to stay on this side
because the divider over there nope oh
gosh that was almost painful and I'm
sure that was on purpose
miss him
Thanks okay Oh what I think he's trying
to hit every vehicle on the road
literally just oh that was a mistake
that's not good whoo oh dear Oh
why are you in the oncoming traffic
get out of here poncho Oh questions
comments or even below</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>