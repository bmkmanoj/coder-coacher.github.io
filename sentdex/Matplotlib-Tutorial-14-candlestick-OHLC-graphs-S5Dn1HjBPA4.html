<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Matplotlib Tutorial 14 - candlestick OHLC graphs | Coder Coacher - Coaching Coders</title><meta content="Matplotlib Tutorial 14 - candlestick OHLC graphs - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Matplotlib Tutorial 14 - candlestick OHLC graphs</b></h2><h5 class="post__date">2015-07-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/S5Dn1HjBPA4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everybody and welcome to another
matplotlib tutorial video in this video
we're going to be building on the series
that we've been working on here and that
is how to do candlestick open high low
close graphs so with that let's just
dive right in
so first of all we're going to need to
import a couple more things from
matplotlib so we're gonna take this line
here and let's just cut that put it
together here it's always a good idea to
have the imports with the specific
module kind of together we're also going
to import matplotlib ticker as M ticker
and then we're gonna go from Matt plot
Matt oh my goodness Matt blue dot
finance we want to import candle stick
underscore ohlc
so that's gonna allow us to plot these
really fancy candlestick graphs if
you're not familiar with a candlestick
graph it's just a really nice concise
way to plot an open high low close and
direction all in like one little marker
things so it's really useful if you
don't know anything about candlestick
charts don't worry about it
it's really quick to make him so it's
won't cost you too much your time but
feel free to skip if you'd like so the
first thing that we want to do or really
the only thing we need to do when it
comes to candlesticks is to come on down
to let's basically where we grab our
data and in fact really all this stuff
like we can keep date and price but like
all this stuff here we don't need any of
it so I'm just going to like delete okay
so now we've got all of our information
date closed high-low open all that what
we want to do is we need to create a we
have to create a new kind of list so
what we're gonna do is we're gonna say
we're going to create a pretty crappy
counter but that's okay so we're gonna
say x equals 0 Y will be equal to the
Len of date and then we're gonna say
this new row say ohlc equals this empty
list and
we're going to say is Wow X is less than
Y we're gonna build this list up we're
gonna say append me equals and then it's
going to be date X open P X hi P X lo P
X close P X and then we'll also throw in
volume volume X okay so that's the line
that we're about to append and then
we'll go ahead and say Oh HLC dot append
and what do we want to append well we
want to append me then we're gonna say X
plus equals 1 so that should be decent
enough so then we've populated this with
date open high low close volume data and
then now we can plot that data super
quick and easy so to plot it what we do
is we're gonna use Candlestick ohlc it's
this kind of special little function
here so we'll take that function we'll
come on down here and what we're going
to do is Candlestick underscore ohlc
which we imported then you specify on to
what subplot are we gonna slap this bad
boy ax 1 then we're gonna say what is
the bad boy its ohlc
and then we specify will you really get
away with punches this that should be
good enough and then we'll talk about
some of the customization that you can
do so let's save and run that real quick
and we don't have label so that's what's
hitting us there and we also see shucky
darns we lost our dates so I have to
handle for that or matplotlib so now
these are candlesticks it's really hard
to see it you know they're like these
little lines basically but you can guys
see that when it goes up the
candlesticks are generally black and
when it goes down they're red we can
zoom in though we really get a good good
feel for these candlesticks but right
now there's just way too much data here
so let's change let's go up to the top
here instead of 10 years let's do I
don't know 1 M for one month let's see
how that looks
that's a little more reasonable so we'll
go with that for now
okay so we've got our candlesticks now
what can we do
from here well red and black well okay
but it doesn't make the most sense so
let's change those colors so the first
of all to do that what we can say is we
can say width we can change the width
this is the width of each little candle
we'll just do 0.6 for now and probably
the last 0.4 is probably best and then
we can specify color up equals something
and then color down equals something
these can be anything you could just say
color up is G and color down is red that
should should be fine
but we'll use this hex color thing again
and I like let's just pick color down
we'll say kind of like a lightish red so
we'll do this DB whatever copy that
move color down there and then let me
just pick a random little green ear this
one I'll do pound this seven seventy
eight seven nine and then DB 3 F 3 F
that'll do so now what we'll do is let's
run that see how we're doing with the
new width and stuff okay cool so that
makes a little more sense the drops are
red the rises are green the earth is on
its axis again we still have this date
problem so now what we do is let's close
out of this mat plot live you're killing
me smalls now we're gonna do is we're
gonna you know restart or a little
customization of a x1 and the way that
we do this is first of all we got rid of
that for darn it let's do a for label in
a X 1 dot whoops X 1 dot X axes get
underscore tick labels labels what do we
want to do well we want to label that
set underscore rotation to 45
should have left that but oh well next
what we're gonna do is we're gonna say
ax 1 well there's a couple things here
first let's just do the date conversion
I guess so X 1 dot x axis dot set
underscore major underscore for matter
we want to set that formatter to M dates
dot date formatter so remember earlier I
was saying how the
matplotlib dates are like some sort of
70,000 number a little wrong 700,000 but
as you can see that those were the x
axes labels so we have to convert though
is that 700,000 number that's a map plot
lib numpy conversion date number we want
to convert that using a date formatter
and we can now we can tell matplotlib
what's the format of the date we want so
you could literally say you could say I
want my date to be % year followed by a
parenthesis closing % month followed by
- % D ok you are totally permitted to do
that let's save and run it and sure
enough we can see 25 2015 close
parenthesis o 616 for example there
obviously that's really silly and absurd
I just want you guys to understand that
you can choose anything you want when
you're converting into and out of dates
you can do all kinds of fancy stuff but
let's go ahead and fix that now make
that a - let's be reasonable everybody
and now what we're gonna do like let's
go ahead and run that one real quick
and that's cool but let's say like we
want a little more granularity like we
have tons of space here let's use it
well you can actually specify the exact
number of like little markers that you
want and the way that you can do that is
by saying a X 1 dot X axes dot set
underscore major underscore locator and
you can set that to M ticker dot max NL
pay attention capital n capital n
capital L there locator and then here
you specify how many you want we want 10
give us 10 so we're asking for 10 here
now we've got our 10 little locator
things so let's zoom in here so you
should always have basically those ten
now sometimes it's going to trim those
sides it's just going to do that as a
favor to you but generally you'll have
as many as you want you could add more
or less like we could say X actually
let's say we want I don't know 5 okay so
let's do 5 so you can see it's trimmed 1
but we've got you know 1 2 3 4 and
like that so anyways and in some cases
that gives us three apparently but it
gives it kind of like a starting point I
suppose so we'll go with ten that seems
like a pretty good number to use now I
think that's it for this tutorial
in the next tutorial we're gonna be
talking all about making graphs pretty
because this graph it doesn't look
horrible but it does not look great and
the other thing I wouldn't mind doing -
let's go ahead and add a grid back let's
say X 1 dot grid true okay so anyways
yeah in the next tutorial what we'll
talk about is kind of making a graph
more appealing ok so there's a lot of
options here and in the previous
matplotlib series that I did we spent a
lot of time customizing our chart and
nowadays it's a lot easier to customize
your chart so that's one of the main
reasons I've decided to redo this series
is because that was taking a lot of time
but it's a lot easier nowadays so that's
what we're gonna be talking about in the
next tutorial so stay tuned for that
if you have any questions or comments
please do feel free to leave them below
otherwise as always thanks for watching
thanks for all the support and
subscriptions and until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>