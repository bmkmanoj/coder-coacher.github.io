<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>AI Agent Changes 0.01-0.03 - Python plays GTA p.16 | Coder Coacher - Coaching Coders</title><meta content="AI Agent Changes 0.01-0.03 - Python plays GTA p.16 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>AI Agent Changes 0.01-0.03 - Python plays GTA p.16</b></h2><h5 class="post__date">2017-06-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/aYMUYkk92NY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody and welcome
to part 16 of the Python plays Grand
Theft Auto and does itself diving I mean
self-driving car series so it has been a
minute since we last spoke I've been
incredibly busy but I have been working
really hard on Charles getting this AI
to improve as quickly as possible so I'm
going to try to cover all the changes
that have been made so far up to this
point it's going to be really hard but I
think I can probably do it make my sound
for some mesh advanced Skype and ruins
it so what I'm showing you right here is
actually version 0.03 in training I just
want to show it because I won't be able
to show it probably later on this it's
like tensor board with this many data
points is super likely to crash but yeah
this is training over time this is like
30 30 ish hours into training so
training is super slow and I've had a
lot of crashes I've all of these first
four crashes are from the Titan X
Maxwell
this crash here was actually I think
this was this morning before I started
recording I can't record while it's
training because it uses all the GPU but
actually this crash here was because the
power went out last night but anyway
yeah it's been crashing a lot and
unfortunately the original Titan X
Maxwell is I believe dead it's just
first it started off crashing every you
know maybe 12 hours and then all of a
sudden it just started crashing like
every 15 seconds and then finally it
crashed so bad if basically I couldn't
reinstall any graphics drivers to it
said it had no drivers at all only would
you know go to one screen rather than
all the screens that were connected I
tried to install me graphics driver I
tried I deleted all Nvidia stuff and
that seemed to work temporarily but then
it still kept crashing and on and on
when it works temporarily it was very
odd because then video wasn't even
installed on my computer like it's
nowhere to be found and like if I looked
up the the version of the graphics
driver
it said none this hole yeah I don't know
I don't know so right now I'm actually
running the GTX 1080 Ti and using that
for training I'll talk a little bit more
about that towards the end of the video
but yeah man down so unfortunate and
this one this is about a year old
actually the car is much older than a
year but I bought it on ebay so there is
no warranty to be had on this card boo
so now I wanted some changes so I found
lined a lot of the changes on just cyber
bio psy BER geo milk real code changes
besides the models are posted here but
it's just some general information that
you can kind of read through so some
information on 0.01 I'm just going to
since I already kind of covered 0.01 I
will just show this was the Alex net
model that I use it's a modified Alex
net
it's like 28 layers but yeah it's
basically Alex net just expanded a
little bit like this is expanded here
and here and then here but yeah that's
the model that wasn't shown at the time
so I just wanted to briefly show that
and just to remind everybody since it's
been so long this was a 160 by 120 pure
convolutional neural network saw
everything on a frame-by-frame basis
made decisions on frame by frame brace
basis irrespective of previous frames
and decisions moving forward obviously
we want memory in the form of recurrent
layers or anything to give it some sort
of memory unfortunately I have tried
with current layers I've tried motion
blurs optical flow and even multiple
frames on a continent I didn't think
that was actually gonna work but it
didn't work
surprised anyway I'm trying to live
stuff it doesn't really seem to improve
the network so I really I'd still a
research question more data
reinforcement learning which I'll talk
about in 0-1-0-3 and then granular
control which actually i have developed
i've even implemented it it just didn't
work super well but i actually i think
there's a lot of hope for that and i'll
talk about that in a little bit and show
some code for that
then came 0.02 major change for 0.02
actually two major changes one is that
we include now colors of RGB and then
the other change is the model change so
actually for 0.02 I trained both that
expanded Alec's net and Google's in
section view 3
now unfortunately Google inception of u3
the idea of that is that you get it's
already pre trained on imagenet and then
you take that and just train like the
last two or last one layer with last two
layers you train those and that's it so
it's like a pre trained model and you
just kind of train those on your own
data and it's like a really quick way to
do like kind of transference learning
basically and unfortunately I couldn't
find a checkpoint file for imagenet so
our well it is imagenet but it for
inception on imagenet so yeah so if you
know of one let me know where is that
file ok I thought that's the whole point
of Inception
but anyways I just trained the whole
thing I'm not a hundred percent certain
on exactly like the mathematics behind
what merge does so if someone has like
an a picture of what merge is doing let
me know because I know what merge does
with like arrays and I just wonder I
would assume that's exactly what's
happening here but I'm not really sure
why you would do that to a network other
than I really don't know I just don't
know so anyway I'm a little fuzzy on
that I just really I just did inception
just to see what would happen but what
ended up happening which was really
interesting was basically all the
training data was made on my main PC and
then Charles runs over here on this PC
so what ended up happening was I trained
both of these models and then I tested
them on this PC here the main PC which
is where I created the data and both
models performed equally like it was so
close so and I was like well I'll put it
on the Charles I'll put each one on the
Charles PC let them run for a few hours
and then make a decision and then ask
people what they thought too so I moved
them over to the Charles PC in
right away the expanded Aleks net model
just flops it won't move it doesn't do
anything and I don't know the
problem is um so that was really weird
and then the inception model did work
not as well but well so that's what I
stuck with I just stuck with inception
for that because it was the only one
that worked I'm so it's really weird
that they acted so differently same
resolution saying graphic settings I did
figure out well the headlights were
different one headlights were the xenon
headlights one were the regular but even
after switching those out no difference
so that I could tell so if we appear
that Inception is more robust than Alex
net or maybe Alex nez just simply like
way too finicky or something
- changing the data don't know I really
don't know why that happened so that's
definitely area for some research there
especially because the first Alex net
version didn't have that problem so
weird anyway moving along that's kind of
the big change was just going with the
inception model I'm gonna keep trying to
look into that one cuz I'm still really
interested to know what caused that
difference anyways if you kind of want
to read through a real summarized
version of what's going on and then same
thing for future versions I'll post 0.03
here when it comes through you can go to
psy ber cyber i/o for that information
also I the github so the github you'll
land on this page but you can go to
versions and see the code for all the
versions version 0.03 is already up it's
not trained yet but it's up if you look
at the code the big things that you guys
haven't seen in tutorial form has been
changes to collect data sort of train
model I suppose and then sort of test
model so I'll kind of talk about those
real briefly so the big changes are
these extra keys so in the past we
assumed we were always just going
forward and then really we just had a
and D for steering whereas now we allow
for a lot of the combinations like
forward left forward right brake left
brake right and so on
so those are the major changes there the
code is super dirty someone wants to
clean it up have at it really I'm just
I'm still very deep in just kind of a
development stage of all this so I'm
really not too too worried about it but
if you want to fix it or poke fun at it
have at it train model uh this is
actually like training it on the actual
data really nothing's changed they're
the only big big thing that you got to
watch out for is of course the output
layer where is output lets each model
dot fit oh it should be where we define
the model yeah here so Alex meant to
output is nine so as opposed to three
before now it's nine output for the
output layer so nine nodes then test
model same thing just the other keys
other controls that you could possibly
have that's really it okay so that was
that for 0.01 0.02 also has some motion
detection and in it I went I actually
found this online the link for the full
script is here but I really I really
chopped it down quite a bit just to be
to my needs but basically just measures
pixel changes it just I kind of like the
exact way that they did it and I felt
like some time figure dit out from them
I'll source them anyways so there's the
motion dot PI that I found from someone
else that just determines whether or not
we're stuck so it's kind of like a
fail-safe the other fail-safes I have
are from a user named Fry's Fri GHz they
gave they created to two major mods so
far one is the anti stuck mod which
basically if we don't move a certain
amount of distance in a certain amount
of time it determines we're stuck and it
teleports us to a new location so maybe
we're at the bottom the ocean or seconds
in one's backyard or we're just going
full-throttle into a wall and we're not
figuring it out so it will fix those
situations for us so super useful also
the newest mod is for automatically
setting waypoints which I will talk
about very shortly so there's that also
just you know huge suggestion all the
time is like can't we control speed
somehow well we can but it's challenge
to come up with the algorithm that will
do that I don't want to arbitrarily
limit
speed I want the network to pick the
speed so coming into VGA testing
basically what's going on here is V joy
is a way to emulate a generic controller
but Grand Theft Auto 5 requires an Xbox
360 controller no problem we can use
x360 c ii which will let you take your
generic controller and emulate an xbox
360 controller so what we can do is we
can tie in v joy 2 X 360 GE and boom we
can use Python to emulate an Xbox 360
controller I've done it I've developed
it I've got the scripts ready I've used
it in game I just can't come up with a
good algorithm to actually try it but
you can kind of see my sample algorithm
in the main dot pie basically which will
basically it just takes the outputs and
tries to figure out you know how far
left how far right should we go
also if you you can look at the main dot
pie file but also make sure you look at
V joyed up pie because I've wrote out
with some decent ish information here
for you basically here I've changed this
file and I sorts this file I did sources
file off to see if they have a license
though I have to put this license at the
top I should do that while I'm thinking
about it let's see if Landon
hmmm I don't see any but I'll have to
look for more into someone someone finds
out comment below this should have a
license on it I think it probably
probably had some license surely anyway
I'll come back to that anyway this is
the original V G dot pi but there this
is like the generic kind of outputs that
you can have and what I did was I marked
down like throttle is not throttle I
think that must be for like a throttle
pedal maybe or something
but really throttle is try to remember I
think it's the right trigger so W ax is
0 to Z rotation that's your actual
throttle and you've got your left
trigger this is your thumb Y like left
my left thumb X X Y so this would be
like for your steering this would be for
looking around these don't appear to
have any controls and then buttons here
are for like the a B X &amp;amp; Y ok so that's
that I've kind of commented out for that
I'll keep playing with it but I think
probably at least for like throttle
control we could take you know the W
output and the s output is it s yeah as
for brake take those two kind of because
they come out as a percentage basically
from the neural network take those
percentages subtract break from throttle
boom you got it you got a percentage
either a throttle if it's above 0 or if
it's below 0 that's a percentage to
brake so there's stuff like that that
you can continue to try and I'll keep
messing with it but for now I just
haven't really had too much time to play
with it but especially when I knew I was
going to change the model anyway there's
really not much point because like for
example 0.01 was totally raw 0.02 let's
go test model is not total raw output so
what's happening here is it's applying
an array to the output layers so
basically in your training data you have
to bounce the training data so in your
training data like 90 plus percentage of
your data is some form of go forward but
if you train a neural network on that
the neural network will realize ok so we
just always go forward and it'll just
very cool
we locally optimize to that and that's
not very good so would you want to use
balance data then we balance the data
the neural network itself still will not
it will predict out the real balance
right so you have to then apply another
but at least for my findings so far
you've got to apply an algorithm to the
output layer so super simple algorithm
but an algorithm nonetheless and this is
it so maybe if we tweak this a little
bit and then went back to the controller
um that could improve somehow just it's
just going to take a lot of trial and
error also huge requests terhew
suggestion has just been memory stuff I
tried it have done recurrent layers I've
done made continents I'm pretty sure I
brought that up when we were going
through just a huge research thing you
just got to keep trying it and it just
takes a lot of time especially with like
recurrent layers well that's a new model
we got to train the model each model
takes 24 plus hours just to kind of
validate to see if it's even going to
work so it just takes a lot of time it
just takes a lot of time so that's
leading me into what I believe will be
the end we make sure I've covered
everything I really wanted to cover yeah
so this series is extremely expensive so
personally I paid like $2,700 total for
this machine here I didn't have to I
wanted to it's not like a boohoo syntex
kind of situation yet but it's just an
expensive one to run and I don't
necessarily want to total I don't want
to shut down the stream because having
like a 24/7 live test has been super
useful I've gotten a lot of help in
stuff from people also the stream has
been the source of basically the only
reason I have a 1080p eye right now to
actually continue training this model
since the tight necks Maxwell died the
only reason I have that is because
through the stream donations so the
stream has been super useful to people
have seen things like for example no
keys was still going forward that was
kind of remnant from an older model but
that just no keys didn't make sense but
no keys works and these these later
models that was a mistake all kinds of
stuff people have really
helped with so I don't really want to
get rid of the eyes if I have to I will
take Charles offline and use him to
train I just I don't want to it's not
the way to go the problem is this series
is making like nothing on YouTube so
normally I don't really I don't have a
patreon I don't really need to ask for
support because the ad revenue is always
paid for it enough to where I just felt
kind of silly asking for money this
series is different the series is super
expensive it's costing a lot in
electricity just to run these things
24/7 I'm losing hardware as we speak
it's just it's a different kind of
series and unfortunately on YouTube it's
making no money which is unfortunate
because it's the best performing series
in every other way in terms of watch
time watch time percentage in terms
views over this like a time period
everything's great
yet the ad revenue is one twentieth of
my typical ad rate which is next to
nothing it's very bad and I think it's
just because it's self-driving cars in
grand theft auto but Glenn's athough is
the right environment like that's just
the right place for this um and I'm not
really sure there's no other game that I
don't think would you have a better ad
rate and then all like the kind of
pre-made models that to do self-driving
cars in aren't like grand theft auto in
the sense that it has so many variables
Grantha thought it was a huge challenge
so it's kind of a kind of a bummer
so anyways through the stream a lot of
people have donated
you can donate to support the project
through the stream all donations are
totally public all the things that I'm
buying from the donations are totally
public all contributions go 100 percent
towards like processing power so
electricity hard drives like Hardware
stuff graph graphics cards that kind of
stuff I'm not looking to supplement my
income at all 100% of contributions go
towards making this thing go as far as
we can take it so you can donate to the
stream you can come in stream support
Charles
also I set up a patreon account a lot of
people have suggested I create a patreon
for the channel I really don't have much
reason to have it for the entire channel
if you want to support Python
programming that meant in general you
can go to Python program at 2 + equals 1
and you can subscribe there from $9 a
month that supports the entire channel
if you want to support this specific
series I do have a patreon up if you
want support everything you can go to
plus equals 1 this but yeah for this
specific series the patreon again same
thing is on the twitch donations all the
contributions go towards processing
power basically and then yeah I think
that's it so yeah if you want to
contribute awesome if you don't want to
that's fine I'm going to take the series
as far as I can but it's just when
things are going to die on me that makes
it hard
also just training the models you know a
lot of the models I've trained you know
take 24 hours and then you realize that
it's not really working or like Alex net
I spent three days training that model
and then it doesn't work in practice it
were worse on one computer but not the
other computer so all kinds of stuff
like this it's just there's a lot so
much trial and error that more
processing power would be easier now
some people suggest cloud computing well
let me explain cloud computing cloud
computing is not safe money unless what
you're doing is very short-term so if
you're working on your like thesis and
you just need to train a model real
quick for like four or five days sure
cloud competing is great idea why buy
all that hardware but if you're running
something 24/7 or training something
24/7 it's not a good idea so to quickly
price out for you what happens when you
buy cloud GPUs what you're buying is aka
T which is old architecture it's not
even it's not ideal the 1080 TI I have
is better than the K the half K ad that
you'd buy in the cloud so a KA T is
actually 2 K 40s pretty much just glued
together as I was saying K 40s are old
it's old architecture it's old memory
it's just not what you want really
but regardless 1k 40
so a half a k80 is $700 a month in the
cloud an entire k80 which arguably now
that my technics maxwell is dead I've
got the 1080 in the tight max Pascal
running right now that would cost $1400
a month and then if I still had my max
well then hosting that for you know 24/7
would be twenty one hundred dollars a
month so it just doesn't make any sense
when a Titan or a 1080 T I even buy
brand-new for like 700 to 800 bucks I
opted for the overclocked from the
factory GPU just simply because after
trying to overclock like seven total
GPUs in my lifetime I've never had good
success I've always just had them die
every time not died like the Maxwell but
die is in like they don't hold like you
know it just it's very hard to balance
an overclock so you can overclock one to
two percent or something crazy whereas
like CPUs you can overclock CPUs like
somewhere between like 20 and 40 plus
percent and they're just so much easier
so it's kind of silly to in my opinion
to buy a factory overclocked CPU but for
GPUs I definitely valuable so I opted
for that but anyway anyway yeah if you
want to support you can like I said you
can do it either through donations on
Twitch which are logged and then also
for the specific series on patreon you
can become a patron or you can go
through plus equals one but plus equals
runs more general I do use that for
income I use that to pay like house
bills and car stuff and all that kind of
stuff but if you want to support this
exact series just in terms of like
hardware and just seeing how far we can
take it
patreon or twitch so anyways that's all
for now if you have questions comments
whatever feel free to leave them below
once version 0.03 is done I'll put that
up once we get into reinforcement
learning we'll be back to to the actual
coding tutorials I just didn't see much
point in covering the coding of all of
this stuff because it's basically
version 0.01 just with like a couple
lines change here in there so
silly other than that the other thing
that I think I forgot was deep dream I'd
really like to do deep dream at some
point sorry if I'm repeating myself I
already talked about this but basically
like what is the network kind of seeing
through deep dream it would be really
cool so that'll be something else that
I'm hoping to get out either by around
version 0.03 or enjoy point zero four
before like reinforcement learning or
after reinforcement learning somewhere
around there but yeah that's what you
guys have to look forward to sorry it's
been so long things have been crazy I
went to I went to Pike on why is that
Pike on I was like sitting in the
airport and suddenly like I pulled up
the stream and like up to this point the
stream had been getting like 20 viewers
at a time or something at most there's
like 200 people in there I'm like what's
going on and it was like some article on
Rock Paper Shotgun
and then like through the day like every
I think everyone just started seeing
that like journalists were seeing that
on Rock Paper Shotgun and then like
through that day it was like I can't
remember all of them like PC gamer
polygon kotuku or something like I had
never heard of them it was like like
times of PT on it the stream went
freakin nuts for a few days it was
brutal because I was out of town out of
pain anyway that was pretty that was
pretty crazy but with me I brought back
a cold and then for a brief moment it
looked like Linode was going to kick me
off my chair died
I'm actually on like this demon see this
chair yeah you could see like a kitchen
chair because my actual office chair is
like baroque it like just swivels all
over the place and just goes straight to
the floor now it doesn't like hold its
position so yeah it's been a it's been a
pretty hectic few weeks but hopefully
the updates will start coming more and
more frequently hopefully graphics cards
don't keep dying so anyway um someone
said you can put it in the oven which I
mean it kind of makes sense because
basically if if you have like some of
these solder points get weak or whatever
in theory you could maybe put it in the
oven and that would work but I mean
shoot I don't that's interesting one I
don't think I'm going to do that right
out of the gate but yeah I mean I keep
kind of trying to play with this one
because I mean
it's a huge bummer I'm going to really
miss having the extra 12 gigs of VRAM so
anyway that's all for now questions
comment below otherwise I will see you
in the next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>