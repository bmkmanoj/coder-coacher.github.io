<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Python and Pandas for Sentiment Analysis and Investing 8 - Strategy Function | Coder Coacher - Coaching Coders</title><meta content="Python and Pandas for Sentiment Analysis and Investing 8 - Strategy Function - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Python and Pandas for Sentiment Analysis and Investing 8 - Strategy Function</b></h2><h5 class="post__date">2014-05-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/eqmoQNQNZgo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody welcome to
another Python pandas sentiment analysis
in finance video in the last video what
we were working on was this automatic
moving average function where we
dynamically generated a moving average
calculation based on the number of
updates the company got now in this
video what we're going to do is we need
to formulate a strategy for our trading
so I think the one of the easier ways to
formulate a strategy is just to base it
on the moving average crossover so if
the shortest moving average is higher
than the second shortest is higher than
the third shortest is higher than the
longest or largest moving average then
that would be the most bullish situation
and then from there we could we would
have less bullish scenarios all the way
too bearish and then we would want to
sell so in the multiple of situation we
would want to buy for let's say by four
stocks in a slightly bullish situation
maybe we want to buy three and so on so
that's what we're going to do first and
then after we've done that if we've
created this function because we can't
really do this very easily and pandas we
can't make that kind of an operation
with pandas what we're going to do is
map that function toward pandas
dataframe and that's going to allow us
to be able to do this so with that let's
go ahead and get started so the first
thing that we're going to do here is we
need to create this strategy function so
i'm going to call this one defined count
underscore position and it's going to
have four parameters that's going to ma
1m a2 and a3 and ma for that we pass
through here this is going to ask a
bunch of questions if ma 1 is greater
than mu tubes grow that I'm a three and
then and so on all the way down in a few
different combinations we could get
really huge with like a whole bunch of
combinations but for now let's keep it
kind of simple now that said I don't
really see any educational value and
making you guys copy and paste well just
copy what I write because actually what
I'd rather have us do is just copy and
paste so writing all this out is kind of
pointless and a waste of my time in your
time and everyone's time so what we're
going to do is I'm just going to put in
a copy and paste this myself and then
I'm also going to copy and paste it in
the description of the video so that way
we don't have to waste a bunch of time
typing all this out there's no point
so I'll put that in this in the
description of the video so if it's not
there someone remind me and I will get
it added to the description as soon as
possible cuz I like to forget these
things so anyway so what this function
does is as we pass through the moving
averages it basically just asks what is
the case and if there is no case it just
returns a zero and but if there is a
case it returns you know these numbers
now eventually we might have a return
like none or something like that so it's
not a number but for now we'll just
leave in zero and anyway we just don't
have that many options here I'm really
thinking we approach to return none Oh
we'll see about that anyway um cuz
probable yeah well I will return none I
think for now and we'll see that might
cause problems down the road but we'll
have a return none if it's not one of
these because there's obviously a lot
more combinations than what was shown
and what we're going to end up doing
down the line is ask what's the
difference between the two numbers and
that's how many stock we need to move
anyway enough on that now that we've
created this function what we have to do
is we have to map this function tour
pandas dataframe so we're gonna use map
to do to do just that so once you so
once we've copy and pasted that we need
to come down a single stock auto moving
average and underneath d F equals DF
from starting point onward that's where
we need to map this because we can't ask
these questions without these numbers
right so before the starting point ma
for doesn't ease even like a legitimate
number so we have to do it after this
point so once we've come to that point
what we want to do is we're going to I
guess we can also we're gonna have like
a bunch of a bunch of columns here at
this point so let's go ahead and get rid
of the original moving average columns
is really no point for them right now so
we'll do del DF ma 100 and we'll go
ahead and delete the other threes
that paste paste paste 250 505,000 so
I'll have those deleted now and once
you've deleted those now we're ready to
actually map this function and the way
that we're going to do that is the
following so we do DF POS for position
and we're going to take equals mat and
for map we want to put in the function
that we're going to map so that's going
to be calc on a score a position and
then we have to do pommel and now we put
the parameters to dysfunction and that's
going to DF ma one all the way to MA for
so I'm going to highlight that copy
paste paste paste two three and four ok
so now that what that's going to do is
it's going to map the result or the
return of this function at each step of
the way to the column DF position so
that's all we do there and now just to
see that we did this will do print DF
all the way to number 100 basically and
for now let's not plot anything so I'm
just going to comment this stuff out
here let's go ahead and run that so
hopefully that'll give us a position
column that spits out the number that we
want and then none will just be not a
number so when we go to calculate any
difference it won't calculate any
difference so we won't trigger a sale or
a bi or anything like that so wait for
this to come up and probably after that
we'll probably do that next part in the
next video and here we do we do have our
output here so this is just what do we
do though yeah the first 100 rows and so
here oh well this sense it's there's so
many columns basically it's down here so
I'm a 1 2 3 4 and here we have not a
number on a number because this isn't
these you know this combination is not
one of the combinations that we chose
this is basically saying we want to be
at a negative 1 position all the way
through
at least for these hundred rows so so
that's what it didn't create this
calling forest and basically we can use
this column to actually start executing
a trade based on these stock prices here
right at these times and all that so I
as you can see we can start actually
we're getting closer and closer to being
able to backtest this strategy without
all the data that we need in this data
frame so anyways that's going to
conclude this video in the next video
what we're going to be doing is actually
calculating any difference and then from
that difference we will actually
calculate the necessity for a trade and
then when we do that we can use the
price at the time to calculate the
necessity for the trade or iming the
trade and then also we can calculate our
current the current amount of stocks
that we have how much those stocks are
worth in total how much cash we have and
how much that value that stocks is plus
how much cash we have and that gives us
growth okay so anyway what we're going
to go ahead and do is we'll continue
that in the next video if you guys have
any questions or comments feel free to
leave those below as always thanks for
watching things for all the support of
the subscriptions and until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>