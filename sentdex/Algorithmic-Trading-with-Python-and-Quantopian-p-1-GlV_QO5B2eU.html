<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Algorithmic Trading with Python and Quantopian p. 1 | Coder Coacher - Coaching Coders</title><meta content="Algorithmic Trading with Python and Quantopian p. 1 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Algorithmic Trading with Python and Quantopian p. 1</b></h2><h5 class="post__date">2017-01-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/GlV_QO5B2eU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody and welcome
to part 13 of our Python for Finance
tutorial series as well as kind of the
introduction to quanto bein so the
purpose of quanto peon is many-fold so
initially quanto peon in my eyes was
really just a back testing platform
which at the time was still super
valuable because first of all they
provide you stock pricing data down to
the minute for any company but then also
they were providing fundamental data on
companies again for free and also the
pricing data was for free and so you
were able to actually leverage data in
and do back testing on first of all just
data that was normal otherwise paid data
also the back tests themselves were
immensely useful because they visualize
trading as it happened for you they
tracked other statistics like alpha and
beta and Sharpe ratio and all these
kinds of things also it shows you your
transactions over time really simply and
anybody who's ever tried to code
something that just does that knows how
risky isn't had time to do them I mean
honestly to just do the back testing is
like thousands and thousands of hours in
my opinion so so yeah so there was that
now quanto can changed a lot over time
and I would call quant opium now more of
a like a research platform that you just
so happen to be able to alter back tests
on look so so it's kind now the other
thing you can do with quant opium so
first of all some people have expressed
concern that if you write a really good
strategy I'm going to be Annette quant
opium will steal it so first of all they
just wouldn't probably do that but also
quanto peon is actually interested in
working with anybody who comes up with a
good strategy so you can get capital
allocations from quant opium the target
is to pay you out ten percent I don't
know if that's negotiable at all but ten
percent is a pretty good starting point
it's a very low barrier to entry anyways
and what they want from you is a beta
between you know negative point three
and positive point three but if you
could be like zero beta that's like
that's good for them they're not so
interesting
have to beat the S&amp;amp;P 500 you need like
low volatility you need a very I guess
the best word maybe as diversified they
used to require that you long and short
companies but that's not a requirement
anymore
it appears but you it probably is kind
of just because you want to be able to
have a neutral beta so any way you can
get capital allocations from quanto bian
now they are going to somewhat like if
you try to get a capital allocation
others like handing out money so so if
you try to get a capital allocation
actually like a professional analyst is
going to look at your strategy in your
performance and the underlying kind of
statistics of your strategy and what's
interesting is it would appear to me
that probably exact same tools that that
strategist is using to our analyst
rather is looking to analyze your
strategy are available to you as well so
the bigger things that I just have kind
of caught my eye since I kind of just
started looking back into quanto bian is
alpha lens and PI folio probably alpha
lens which gives you access to things
that again would take you probably like
thousands of hours okay so so the the
tools that are being thrown at you here
are tools that you would probably get if
you were like an actual quant at you
know some big investment bank so you
have like tons of tools at your disposal
here so and trust me the whole point of
quanto peon is that they're trying to
find people who can make good strategies
and work for them because not only are
they looking to give you capital they
also have other people that want to give
them capital because they want to invest
in that business model so anyway that's
that the last thing I'll kind of say on
capital is just because maybe they
decline to give you capital doesn't mean
your strategy sucks it just means like
possibly almost certainly especially
because quant opiates been around for a
while there there's a high chance that
you your strategy is very similar to
someone else a strategy that already
exists so if that's the case they're not
going to just do another one that's
basically the same anyway living along
from there when you get it basically go
to quant opium make an account I will
just plant the community real quick so
go to
Ninian forums when you come here you can
immediately see like you know these
posts but then over here you'll see
these red things a little squiggly lines
or backtest this little thing is a
notebook so the backtest like for
example if I just open this one up real
quick there's some information on this
doesn't look like this is actually doing
anything I'm not really sure what it
does here this one does something so so
you can you know you can look at it's
embedded so you can check the risk
metrics and stuff and you can see the
source code that generated this but you
can also literally click clone algorithm
and it will take it and let you it'll
add it to your algorithms and you can
play with it so so yeah there's that now
anyway that's the community so you can
learn a lot of good things from the
community so definitely check that out
also will probably come here from time
to time but their actual documentation
for quant opium is really useful so
there's no way I could possibly cover
everything you can do with polenta being
a specialist quant opium has a lot of
what I would describe is like helper
functions that will just make your life
easier for doing specifically trading
strategy type stuff so to learn more
about what's available to you I would
just from time-to-time come over here
and just read like you'll have to read
word for word but just I would scroll
down this sidebar and look at words that
appear interesting to you so in fact I
was kind of interested on logging a
second ago because I was interested to
know if you could change it like you can
on Python normally with like the logging
I don't see it anyway another way too
much time on that anyway there Doc's are
great so definitely check those out too
and then we'll probably visit them when
I have some questions on things so the
next thing is basically where you're
probably spend most of your time here
it's going to be under my code notebooks
is as you mature that's probably where
you're going to spend most of your time
that's more like the research
environment part of quanto peon and then
algorithms is where you'll run back
tests but you can also sort of back test
code in notebooks so I'm going to click
on algorithms for now just so I can show
a really quick example of working with
one Tok
but pretty quickly we're going to
actually transition to working more so
in the notebooks section and I'll
explain why because we're going to start
with algorithms first and show some of
the pitfalls of starting here so anyways
we'll click on algorithms and when you
come here chances are you might have
some starting ones if you just created
your account maybe you've got some
already because you've already had an
account but if you don't have anything
here you can click clone sample
algorithm and you end up with three
Nannan I'd say that's a typo anyway so
you can look at these I think there may
be a little much for someone who's just
getting started so yeah you can kind of
look through them if you'd like but
we're going to write our own because I
think starting with like a totally clean
slate is the easiest way to understand
what each thing is doing so I'm gonna
actually delete these and hit a new
algorithm and I'm going to call this
pine ants 13 point open and true nice
long title and I'm going to just
highlight and delete everything I'm
going to move this out of the way and
I'm going to zoom in a little bit at
least and we're going to get started so
the first thing we're going to do is
we're going to create this initialize
function so it's fine initialize and
this just runs once when the script
starts up it takes one parameter which
is context context is a Python
dictionary that stores a bunch of
information on your strategy if you are
new to Python this is going to be hard
on you and if you're not new to Python
this will be just something you have to
understand but the quantou peein kind of
environment here is going to do some
things behind the scenes so context was
never defined nothing was imported we're
never going to call initialize we're
never going to call the next function we
write it's just going to happen and
actually these were at least in zip line
which is what quanto peein to my
knowledge is I'm pretty sure it's still
built on top of zip line was built on
top of and these were actually methods
into much larger class and you would be
stuff to run it but anyways some magic
is happening here and you don't have to
call these functions so anyway
if you're new to Python and you start
here and then you go to somewhere else
that's going to be really hard but
anyway just understand that happening
anyway context is a Python dictionary it
contains information on your your
portfolio basically it's about you so
your portfolio the performance things
like your your leverage your account
stuff like that that's contained in
context now we're going to add something
new to context we're gonna say context
AAPL so it's a dictionary we're defining
a new element basically in this
dictionary and we're going to take on it
to Apple is equal to Sid and now we're
going to search for a a PL and there's
apples we click it and suddenly it
becomes 24 seems kind of arbitrary if
not yes so it actually it kind of is
okay Sid to my knowledge is the jet
flying over star if you hear that
Sid is stock I D I'm pretty sure I'm
kind of making that up on the fly I'm
pretty I'm going to guess its stock ID
and what it does is basically over time
like Apple has been around for the
duration of I think pricing goes from
like 2001 to current and I'm pretty sure
apples been that ticker since 2001 at
the Apple of like 1999 or something so
anyway Apple has has held the the AAPL
ticker that whole time but other
companies have not other companies have
had tickers maybe they went out of
business and then another business came
in and actually was able to acquire that
ticker so tickers change over time but
the actual company name doesn't so you
can search with Sid and this is your way
of ensuring that you're actually
investing in the right company so you
could have also said like capital here
maybe yeah and still found Apple Inc
okay so we've got that now what we're
going to do is that's basically the end
of our initialized function for now I
mean normally you'd have other things in
here you might schedule from Shannon's
or something like that over now we're
just defining this single you know what
is Apple so now we're going to do is
really define a handle data function and
it's going to take context and
take data now data is your universe of
information so this is like your world
it's your environment okay
it's your universe so this is going to
contain things like stock prices now to
access it super simple we're say hist
for history equals data dot and you've
got a bunch of information here but
we're looking for history and then
already pops up to you it says okay
you've got asset fields bar account and
frequency
well the asset that we're interested in
is context a APL the fields fields is
like what kind of data like price volume
stuff like that we're interested in
price bar count how many fields of these
things are we interested in we're going
to say 50 and frequency is going to be
one D for one day you can also do one M
for one minute but we want day and then
we'll close this off and there's our
history so so we've got 50 periods of
one day data history prices for Apple
okay
so cool now that we've got that we're
going to generate some simple moving
averages if you do not if you're not
familiar with simple moving averages in
like a simple moving average crossover
strategy first of all we're going to
make any money with us but it's going to
be a good example so this is a stock of
some kind of I'm not sure whose stock
prices is but anyway there's a 20 ma and
a 50 ma
so the 20 n is the red line the 50 M is
the gold line or yellow or whatever and
basically the whole point of a simple
moving average crossover strategy is to
detect when a price might be trending
and invest in the trend so for example
wouldn't it be nice if you bought right
here any sold here or bought right here
I guess you would have sold here but
that's okay
bought right here and then sold up here
right wouldn't that be ideal or started
too short here and bought back here
wouldn't that be great okay so that's
kind of the whole point of simple moving
average crossover strategy let's see if
it actually works though so once we've
got that we loop to basically from
history generate the basically simple
moving averages so we're going to say
SMA underscore 50 and that's going
equal to 15 so I guess it might be
unclear what hist is so let's go ahead
and do a log gun info kissed dot okay so
history is a panda's data frame and
basically everything when you get data
least a lot of things we're going to
need a panda's data frame so if you know
how to work with pandas you'll know how
to work with this data if you don't know
how to work with pandas don't worry this
is your sort of for that class and
program the net data analysis it houses
pandas and you can learn all about
lovely pandas so anyway
pandas now we've got SMA 50 that's hiss
that means now we can do the SMA 20 that
can be hissed the last 20 days of the
history dot mean perfect so now with
this information we've got the simple
moving averages defined now we're ready
to actually place orders with that I
think I'm actually going to stop it here
and in the next tutorial we'll actually
place orders and kind of see you see
where we're at at that point because
we're going to learn or learn some good
good lessons in the next one so if you
have any questions comments concerns
whatever up to this point if anything
appears magical or black boxy or
whatever let me know also I guess what I
could do is let me zoom out and I can
just build this algorithm and also I
guess while we're building it I'll
explain what all this stuff is too I
thought I could pull this up let's do
this okay
so when you're in the screen you can hit
build algorithm and it's kind of like a
it'll just run it real quickly to the
side here and let's go to logs
hopefully we'll start getting them okay
so then you can cancel here if you want
I'm gonna set cancel and sure enough you
can see this is the log data in focused
so as you can see it isn't indeed in
chronological order so that you last
twenty would be the latest 20 days of
prices that's the only column here and
it's the average super simple so there's
our that now and you can pick two days
or the dates basically that you want to
test against this is how much money
you're playing with and then finally you
can hit run fullback test but we're not
trading right now so on
click that but normally you can click
that but you'll see that in the next
tutorial so anyways yeah questions
comments concerns below if anything is
not making sense to you at this point
let me know I'll do my best to help you
out otherwise I'll see you in the next
tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>