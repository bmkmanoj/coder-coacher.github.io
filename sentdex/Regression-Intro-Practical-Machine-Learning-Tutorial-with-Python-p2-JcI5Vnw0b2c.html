<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Regression Intro - Practical Machine Learning Tutorial with Python p.2 | Coder Coacher - Coaching Coders</title><meta content="Regression Intro - Practical Machine Learning Tutorial with Python p.2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Regression Intro - Practical Machine Learning Tutorial with Python p.2</b></h2><h5 class="post__date">2016-04-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/JcI5Vnw0b2c" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right so now we're at least going to
get started with setting up a simple
linear regression example the first
thing we need to make sure we have is
scikit-learn pandas and Kwan Dalls so
open up terminal command prompt whatever
and pip install SK learn pip install
Kwan dole and pip install pandas and
once you have all those you're good to
go so to install those go ahead and
pause the video and pick back up once
you have them okay so once you have
those let's go ahead and get started
with a simple example so we're starting
with regression and the idea of
regression is to take continuous data
and figure out a best fit line to that
data and basically what that just boils
down to is you're trying to like model
your data and the way that we do that
with regression is with at least simple
simple linear regression is with just a
straight line so the equation of a line
as we'll talk about more down the line
but as you might remember from school y
equals MX plus B so if you have X you
can figure out what Y is also if you
have M and B right so basically the
whole point of regression is to find out
what M and B is okay so for example a
lot of people use regression with stock
prices so that's what we're going to do
at least in this one and so the idea is
this is continuous data right so you've
got you know let's say months and months
of stock prices and each price is its
own kind of unique day but all the data
is kind of one data set together as
opposed to like with classification or
each group of data has its own unique
label so with machine learning basically
everything boils down at least with
supervised machine learning everything
boils down to features and labels and
features are like your attributes or in
this case the continuous data so let's
go ahead and get started and then we'll
talk a little bit more about features so
first of all let's go ahead and import
pandas as PD and then we're going to
import cuando with a capital Q and then
what we're going to say is the DF for
data frame equals cuando get and we'll
put in the ticker you can get these from
cuando so if you just go to
quano calm you can use a little search
and find stuff like if I said Google
stock we can probably find it and let's
see I'm trying to find we're using the
wiki data set let's just do free anyway
when you find it you can find all kinds
of different data sets here but we're
looking just simply for the wiki one I'm
not finding it I'm not gonna oh wait
here it is let's see maybe this will be
it anyway so you put pick up data set
you can come over here and you can
either just download or more importantly
here's the quantal code and then you
could click on like python and this is
the exact statement to get it if you
have an account you can make basically
unlimited requests free data if you
don't use an account like we're not
going to use an account here and we're
not going to use like an auth token if
you don't have an account I think it's
limited like 50 calls a day we're all
actually really only using cuándo
fairly short term here then may later on
but so you really don't need to create
an account but if you like quando you
might as well make an account at some
point so anyways
come on up I get and then wiki slash
Google was the ticker there so then we
can just simply print let's print the DF
head just so we can see what it is we're
working with and we'll see that
basically each column here is on a
feature so the open high low close these
are features so in machine learning you
can have all the features you want but
you want to have meaningful features
right features that actually have
something to do with your data so some
people are pretty avid believers in the
idea of like pattern recognition with
stock prices okay and that might be you
but do you need every single one of
these open high low close columns to do
pattern recognition no right also like
you'll note we've got open high low
close volume then adjusted and adjusted
is adjusted after things like stock
splits so a stock plate split maybe
you're a company you have ten stocks and
each stock is a thousand dollars a share
and you decide whom I want to lower my I
want my people to be able to buy shares
of my company for less than a thousand
dollars so you might say ok BAM every
shares now two shares so we have 20
total shares and the share price is $500
okay so you have adjusted prices to like
account for that so it doesn't look like
price went from $1000 of $500 so that's
what adjusted is so we're going to be
using those but again each one of these
is really related to the other one like
the correlation of these two columns is
super high right so would you use each
of these columns do the actors like the
next one really bring that much
meaningful data no but one thing to
always think about when you have
features and labels is maybe like what
about the relationship between those
columns so when we get into something
like deep learning and then some of the
other algorithms you can start to
discover relationships between
attributes but with regression just
simply no all right so so so so what you
want to do is you want to e that you
want to like simplify your data as much
as possible so you want as many
meaningful features as you can get but
useless features as we'll show kind of
through the series can really cause a
lot of trouble for your machine learning
classifiers especially the more simple
ones and supervised learning and so on
so anyways we'll close out of this and
let's go ahead and grab some features so
what we're going to say first is we're
going to kind of pare this down we're
just going to say data frame equals the
DF and then we are going to create a
long list basically of all of the
columns that we want to have so we're
going to take adjusted open and then I'm
just going to go ahead and copy this
copy okay so that's adjusted open and
then we're going to take open so high
low close and volume okay so now we have
just just these columns so we just kind
of recreated our data frame to just be
the open high low close and volume of
the adjusted ones so then like I was
saying some of these columns are
relatively worthless but they do have
some relationships so for example like
what what is interesting about high and
low is it's the
origin of high and low tells us a little
bit about volatility for the day also
the open price that's the starting price
for the day and its relationship to the
close price tells us did the price go up
if so by how much or did it go down if
so by how much and so on so the
relationship there is very valuable but
a simple linear regression is not going
to seek out that relationship it's just
going to work with whatever features you
feed through it so what we need to do is
is define those those special
relationships and then use those as our
features rather than redundant almost
prices that aren't going to really give
us any more than anything else very
useful so first let's do on the high -
the low percent so this is like the
percent volatility almost so we're going
to define a new column I'm going to call
HL underscore percent and then that is
going to be I'm having a hard time here
that's going to be equal to so percent
changes in this case it'll be the high -
the low / the low times 100 so for us
it'll be DF a DJ high - the DF a DJ
close and what's happening here is just
on a per row basis it just does this
column - this column so that column
divided by DF adjusted close whoops and
then times 100 you actually you can
either times it by 100 or not the
classifier really is not going to care
about that we're just doing that for
ourselves okay so that's the high minus
low percent and then now we actually
want just like the daily percent change
like they daily move so I'm just going
to copy that whole line paste and then
we're going to do we're going to call
this one percent underscore change and
that is equal to pretty much the same
thing I'm never going to change some
stuff so this one is so normally percent
change is new - the old / the old times
100 so that would be adjusted close -
adjusted open so new messy old / the old
times 100 or I'm sorry
the wrong way so yeah new - the old /
the old so this will be open times 100
so that's percent change actually I mean
you could have closed here and again the
classifier doesn't really care as long
as everything's kind of normalized but
yeah so this would this is either way it
would have been fine but this is the
actual rate you should do it anyways so
once we have that data we're going to
define a new data frame and we're
instead going to say so it's going to be
DF equals DF brackets brackets and then
now we define the only columns that we
really actually care about and so in our
case the columns that we care about are
is going to be adjusted close the
high/low percent the percent change and
then a volume is also somewhat useful to
have ok so volume is just you know how
many trades were occurred basically that
day so volume also is kind of related to
volatility so you could also make more
features with some sort of relationship
there but well we'll try to keep this
pretty simple so for now we'll just
print D F dot head and we'll wait just
to make sure everything worked out and
sure enough it did so we have all the
numbers that we're kind of interested in
so we've got our features and eventually
this will actually wind up being
possibly our label but we'll get to well
I guess think about before now in the
next tutorial
why features are the kind of attributes
that make up the label and the label is
hopefully some sort of prediction into
the future so we'll the adjusted clothes
will this column actually be a feature
or will it be a label as it stands right
now so think about that and the next
tutorial will pick it up and start
getting closer to actually making real
predictions with this data so if you
have any questions comments whatever
leaving below otherwise as always thanks
for watching thanks for all the support
subscriptions until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>