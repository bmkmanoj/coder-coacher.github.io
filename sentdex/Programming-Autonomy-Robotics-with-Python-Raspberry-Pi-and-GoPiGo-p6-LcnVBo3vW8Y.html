<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Programming Autonomy - Robotics with Python Raspberry Pi and GoPiGo p.6 | Coder Coacher - Coaching Coders</title><meta content="Programming Autonomy - Robotics with Python Raspberry Pi and GoPiGo p.6 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Programming Autonomy - Robotics with Python Raspberry Pi and GoPiGo p.6</b></h2><h5 class="post__date">2015-08-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/LcnVBo3vW8Y" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to
part 6 of our robotics with the
Raspberry Pi in the go p-- aegyo
tutorial series in this video we're
going to be talking about how we can
make this robot autonomous basically how
we can make it move around all on its
own without hopefully too much input
from us it's a little more complex we'll
just write a really simple script here
our robot won't be very smart and it's
highly likely to still run into walls
from time to time but it's better than
nothing so first things first what we're
going to do is I'll come over here I'll
duplicate this and we're just going to
make this tutorial 6 that PI and open
this up and what I'm going to go ahead
and do we don't need to canter anymore
and actually we won't even need the
desktop anymore since this will be
autonomous and get rid of that will keep
servo range and I'm gonna delete
basically everything else all the way
down that and actually we may not even
we don't even need server server range
cuz when I make pressing keys so now to
be autonomous basically I have to kind
of consider what we need this bot to do
well first of all to move around we
needed to be able to avoid objects now
we do have a camera on there but we're
going to kind of ignore the camera for
now and we're just going to use the
distance sensor so to avoid objects what
we can do is we can just keep pulling
this distance sensor and say you know
how much distance is there and then if
the distance is less than a certain
amount then we might want to turn or if
we can't turn maybe back up or something
like that
now since we have the servo what I'm
going to do is if we run at a distance
we'll have it look like left or right
and then if left or right whichever one
is a viable path ie it has more distance
than the minimum amount of distance then
we want we'll go that way and well and
if both directions have it then we can
just go in the one that has the most
distance right so that's the idea if you
don't have a servo
you can just kind of skip the servo part
I suppose but this was kind of like
requirement to have a servo but one
thing you could do is instead of a servo
you could just make the go PI go kind of
pivot left look how much distance pivot
right how much distance and then choose
that direction based on the pivot so
first of all we have to decide on a
minimum distance so min underscore
distance and I'm going to say the min
distance will be 70 so it'll be 70
centimeters anything less than 70
centimeters we want to stop and like
think about going in a different
direction also sleep will say is 1 so
every time we have a sleep we'll just
have to sleep for one second we'll see
how well that works so to do that we're
going to need to import time and then
we're also going to need to import will
import random just in case uh both are
decent also when we backup I think we'll
add a little bit of a randomness to so
anyway we'll start with this and now
we're going to create a new function
here we'll call this function autonomy
and autonomy first um we'll say no
underscore problem for now and we'll say
that equals true now what we could do is
something like this like we'll say wow
no problem what do we want to do so
basically what's going to happen is if
if we can't figure out a way out of a
situation we're going to just say
problem equals true and then we might
have to exit autonomy the robot will
shut down or something or it'll let us
take over control something like that
but for now well no problem what do we
want to do well first of all we're going
to grab the distance so we're gonna say
dist
equals US underscore dist and then for
pin number 15 and then we're going to
ask if the distance is greater than the
minimum distance then first let's go
ahead and print I will print out forward
is fine with me and then we'll say we'll
just just say the distance just so we
can see it in the console then what
we'll do is
let's go we'll just say forward like
this and in fact probably what we should
do since we're messing with the servo is
we should always like recenter the servo
so let's do while no problem let's just
set it right here will say servo we
haven't enabled the servo yet but we'll
get there
servo 70 time dot sleep not really good
now shoot yes will do
I hate to like always have it sleep one
second at servo but that's probably the
best time to you sleep and then we'll
just have it sleep so we set the server
to 70 sleep find distance good if the
distance is greater than min distance
forward is fine moves forward good and
then again time not sleep sleep and in
fact let's say sleep equals time sleep
one and then we don't have to keep
writing time dot sleep so sleep sleep
forward sleep good and then else this
means something is in the way so we'll
say print stuff is in the way and then
again we'll print the dist and then
we're going to say stop we want to stop
the whole operation servo that first
value is about twenty-eight I'm just
calling that twenty-eight because if our
original numbers was two times fourteen
twenty eight servo uh sleep and then
we'll say to go in the left direction
left derp is going to be equal to the US
distance fifteen and then sleep and then
we're set to servo to 112 which is right
and then we'll say so the right
direction and let's make some space here
so right derp is going to be equal to us
dist:15 again so we'll check it again
and then sleep and then we're gonna ask
uh we want to know if like which one's
the bigger distance so then we're going
to say and so if you don't have a servo
instead of servo 28 maybe you do a you
know ro rot left instead of that and
then rot lot right just keep in mind you
would want to rotate right more than you
rotated left because when you rotate it
left you started at Center you rotate it
left and then now you need to rotate all
the way back to Center and then right
but if you don't have a servo that's
kind of how you can go around that now
we ask if left underscore Durer is
greater than right underscore Durer and
left ER is also greater than the min
distance right because we need to make
sure just because it's greater there
might still be a wall right in front of
us it's just further away than it is in
the right distance but so if both of
those are the case then we'll print that
we choose left and then we'll go left
we'll sleep and that's that else or
actually we'll make this l if l if left
dur is less than the right dirt and the
right dirt is greater than min distance
and lowercase that D then we would print
we choose right and then we will just go
right right then we'll sleep and then
we're going to say it else
so this else will basically be triggered
if left and right are identical in
length I suppose but mainly it will be
triggered when the largest direction is
still less than the minimum distance
required so this will run basically when
the wall is just too close no matter if
we turned left or right so what we're
going to want to do here is go and
reverse so we would say print
and then we'll just say no good no good
option worse okay now this is going to
be a blind reverse because we don't have
a distance sensor on the back but the
reverse the backside of our robot is you
know the most durable anyways the front
side has the sensors and the camera so
that's the one we're most worried about
an servo the backside just has a battery
pack so who cares about the battery pack
right so let's just reverse we'll go
backwards and we'll go backward for
we'll just sleep for now so we'll go
backward for that same time then when we
go backwards if we just go backwards
we'll probably go backwards until
there's enough space forward then we'll
go forward and then we'll be like ah
there's no space it'll look both left
and right like that's too low go
backwards go for it it'll just keep
going forward and backward so we need to
change something so what we're going to
say is we're gonna say wrote choices and
then that's going to be either right
right or left right and then the what
we'll do is we'll say the rotation that
we choose will be wrought choices and
then the index value will be random dot
ran range between zero and two so the
outcome here would either be a 0 or a 1
so that will reference this list here
right this Python list and if it's 0
it'll reference the 0th element so it
would be right rotation if it's a 1
it'll reference the first death element
so left rotation okay that's just our
way of randomly choosing the rotation
and then we will execute the rotation
and then we will sleep ok then when
we're all done with all of this code
like wow no problem so we would be
basically to two indents out um well no
problem we're going to let's see
if the distance we go forward cool sleep
else let's come down I guess yeah we'll
just do two indents for now and then
stop and then we'll it'll restart again
basically so now coming down to the end
of our script we might end up pushing
this stop over one more but we'll leave
it there for now
now at the base of our script we're
going to do we'll start off the bot by
stopping it and then we'll enable the
servo and we'll just let the servo stay
on that'll be fine probably will set it
to 70 we're going to time dot sleep
let's do two sets let's do 3 seconds
just so the start starts kind of slow
autonomy and that's it autonomy is an
infinite loop right now we have nothing
that says it's a problem but what you
could do is if you backup every time you
go backwards you could add to a counter
or something and if it backs up and
never has enough space to move forward
ever again you can just say problem
equals true and then you're done it'll
just shut down or something so we'll go
ahead and save that and let's try to run
that right now it's on a little mount
but let's try to run that and see what
we what we get at the moment so you
actually won't need your your desktop
anymore we can just come over into our
shell and make sure it's active it is so
now we're going to run tutorial six so
sudo python tutorial tutorial 6pi cool
we'll run that let's just make sure it
works I see it at least thinking forward
is fine with me but it doesn't want to
run forward at the moment I think
probably what's happening is the stop so
let's yeah let's cut that run it really
quick so it's probably moving those
keyboard interrupt and let me
let's do okay so stop shift over stop
one more so it should be three tabs over
save that one more time
rerun it we need some sleeves after the
servos uh so forward is fine let's
scroll up here let me look real quick so
servo oh we do have sleeps okay I guess
it's just angry because it keeps hitting
70 maybe I probably should disable the
servo but choose left keeps running left
let's see love plus it servo sleep right
sleep yeah the servo choosing like left
and right it's still it's like not
wanting to to sleep for like the full
amount of time if I go these backs up
but then it doesn't want to seem to do
anything else
ah and then now we just died oh we
called sleep uh parentheses let's fix
that no good option reverse it's just
too fast so set the servo to sleep sleep
equals time not sleep one I don't think
it's actually for some reason I don't
think it's actually executing the sleep
there but let's go ahead and run this
again okay so it resets itself looks
left hit right apparently uh she's
moving forward let me get in front of it
wants to back up and then it freezes
again let's see did we do another spot
where we called sleep and then that we
sure did
let's uh let's do this whole H sleep
replace with sleep replace all save
rerun that again
Hey
that thing is crazy oh my gosh okay um
sorry that's pretty funny let's rerun it
and then break it and that's just to put
it to sleep for a second and so we've
got time got sleep three let's take all
of the sleeps copy let's just do sleep
and roll just replace it with time that
sleep one replace all and that's kind of
a problem time does sleep leave the
three there and probably at the top
would be another one that screws up now
looking through here time to sleep one
one one one one one one
good save let's rerun this thing again
so it gets that direction gets the other
direction no good option reverses and
then goes forward
although the reverse was really short
that was a pretty good reverse okay so
uh so now we're hopefully working and at
this point we can unplug it from the
micro USB and let me just go ahead and
turn it off real quick unplug it from
the micro USB turn on the battery pack
and we can see how well it works the
only thing I want to change is no good
option in Reverse instead of reversing
for only one second I'm going to reverse
for two seconds there and we'll close
this out and let's let's see how it does
on the floor
all right so not the most flawless out
of the gate but except for that burst
crash actually had no other problems I
was pretty surprised how close it
actually ends up getting to the wall we
worked for a 70 centimeter minimum
distance but by the time everything
catches up it'll end up within like an
inch of the wall so that was pretty
impressive
and just a lucky guess I suppose on my
behalf choosing 70 so many ways that's
like the beginning of autonomy obviously
that's a really basic script it's not
really that great but we can be you know
we can work on that a little bit as time
goes on
the next thing I want us to go ahead and
do is talk about how we can access what
the robot sees and actually truly give
the robot vision because at the moment
the robot doesn't actually really have
vision we have a camera module on there
but that's only really for us there the
robot right now has no idea what that
information means or what to do with it
so our next step is to start talking
about how you actually can handle visual
data with your robot because we've done
the whole distance sensor and all that
and that's pretty cool but being able to
work with the camera data is really
useful so for that there's a module
called OpenCV and that's what we're
going to be talking about in the next
tutorial so stay tuned for that</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>