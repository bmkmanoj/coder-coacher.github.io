<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Flask Tutorial Web Development with Python 19 - user login system | Coder Coacher - Coaching Coders</title><meta content="Flask Tutorial Web Development with Python 19 - user login system - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Flask Tutorial Web Development with Python 19 - user login system</b></h2><h5 class="post__date">2015-04-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/n2hLIfLHhOk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everybody and welcome to part 19
of our practical flash tutorial series
in this video we're going to now go back
to our login and wrap that up and finish
that in this video and then we'll have a
full registration and login process so
that's pretty cool because that's
actually kind of a user systems one of
the more difficult things that you'll
have to build other than that other
stuff gets much more easy and much more
enjoyable so anyways let's go ahead and
hop into it so we're going to go into
init that PI and find our login page
which is right here now hopefully I
don't forget but I might forget to cover
it but there's also as you'll find out
as you've seen hopefully I'll remember
maybe after this one will cover it but
after you login you shouldn't be able to
log in again right so after you login
first of all you would get rid of login
and you would replace login with a
logout button or you might display the
username something like that but you
would also if someone was to go to the
login screen anyways or the login page
it wouldn't lead them here to login it
would say you're already logged in
something like that and I'll show you
guys how we can use the various
decorators but login required will be
the decorator that we'll use to protect
pages so you can actually require login
you can actually require a lot of stuff
so you can protect like admin pages you
can also protect pages that require the
user to be a subscriber so if you have
like some sort of paywall or something
like that you can use this methodology
here to actually protect against or
protect pages and only give them to
someone who's a a subscriber or an admin
right acp pages that kind of stuff so
let's finish the login so first of all
uh we can leave the if request method
equals post that's totally fine pretty
much the rest of the stuff here we can
also leave this if well let's just click
here let's just gut this thing
so if the request method is post what do
we want to do so first of all if it is
post well first let's do okay up here
before we get to the if we're going to
try a see and common equals connection
this should not fail because we've
tested that before but just in case it
did we would handle that then we get to
the if request method equals post what
do we want to do so first of all we are
going to say that uh the see we are
getting get posed okay so the data we're
going to be looking for some data so we
want to run really quick C dot X oops
see that X Q and then the query that we
want to execute is select all from users
where username equals a percent add s
okay that's the end of the query and
then what we'll what is percent s well
percent s is worked again we have to
Ford it because we are checking the
database for this username and what is
the username it's whatever the person
attempted to type in that box so we'll
Ford it and then we do request dot form
username like so okay and then uh ticket
that username we can just do data equals
C fetch one uh and then the second index
there and that would be the username or
actually I'm sorry that's the that's
going to be the hashed password of that
username so we're selecting everything
from the table users where the username
is equal to the thwarted value of
whatever the username was that that
person passed through the resulting data
that were interested in really is Sita
fetch one
these second index which is actually the
third value which is their password so
we had username email password so that's
going to be the password or at least a
hash so then what we can ask is like our
previous script with movie if sha-256
underscore crypt dot verify if that's
the case remember this returns boolean
true/false request form password so here
we're hashing the password that they've
entered so we're comparing this compare
what to the hash data so data is the
hash of that password so we're verifying
that those are starting from equivalent
equivalent starting data basically uh if
that is the case okay we can then say a
couple of things one is session logged
in uh equals true and then we can also
say the session username is equal to
request up form username and then we
could also flash something like you are
now logged in and we can then do return
redirects and then I would just redirect
them to URL for dashboard like we did
before - Bora and this is where you
could also add other things to their
sessions so you can say session um I
don't know if you've had admins you can
say session admin equals true or session
rank two equal or rank equals two or
stuff like that you can add all kinds of
stuff to their session and store it in
the session cookie flash you're now
logged in we are returned the redirect
now if they posted but this doesn't
check out and they've entered the wrong
password so then we would just say
error equals um invalid credentials try
again and then we did do we made a
connection and all that so we don't want
to go ahead and do GC collect then we're
going to return render template and this
template here will be login dot HTML and
coming on down oh and then air water
here error equals error after that we've
done our try l we just we left off this
stuff here so so yeah this will work
here okay that should be the login page
so let's go ahead and save that hope
that that works refresh apache there
let's open up oops from button do this
or website list it loads for now we'll
go ahead to head to dashboard we'll go
to login page let's just do five and
fifty-five check that I'm not seeing any
air oops so we should see an error there
though I'm not quite sure why we're not
let's do um I made an account sent Dex
and gave it the password five so we are
logging in we don't have a logout and
then here's an example
now we're letting ourselves log back in
where is our invalid credentials let's
try Centex real quick and then with the
wrong password and we get invalid
credentials let's go to our in it so
this so if this returns nothing so if
the username just doesn't even exist
we're not getting anything from it so
data equals C so you could add something
like this um
if Len or light was it if int data
wasn't that the thing that we use for
registration yeah int X so let's take
this will come up here and then we can
basically say if int X is equal to zero
let's try that let's say error 'invalid
credentials credentials try again it's
usually best to treat um either like if
even if the user say you've got a couple
of instances right one is the username
might not exist and the other one is the
username exists but that's the incorrect
password you can treat them differently
you can say incorrect password try again
and then if if the user named mannor
doesn't exist you could say that
username you know we didn't find that
username in our system but I think it's
better to leave them all as saying
invalid credentials because then the
person doesn't really know like if
they're trying to hack they don't really
know is the username the problem or is
the password the problem so let's
restart real quick and let's see if
we're able to get away with what we just
attempted there so let's just refresh a
couple times go to login
ba-ba-ba-ba we're still not getting our
what the hell invalid credentials try
again
if X
this might maybe this is what's failing
here right okay I know what's happening
well I think anyways because we're
username because this is probably
resulting in empty set so fetch one two
is probably what's failing so maybe you
could do and then that's resulting in
this exception and in fact here here
here's what we can do them so that's
resulting in any exception and then we
can just basically say any exception
that happens on this page error equals
that and let's try this one last time
will confirm submission there we go so
invalid credentials try it okay okay so
now that's basically our login system
I'm not really sure what else to cover
regarding that other than with a proper
user system you can also change password
so or you can change password or you can
also do forget password and you get like
new new little password sent to your
email you log in you have to change your
password that kind of stuff we can do
something like that to uh might cover
that way later on down the road but I
figure I kind of think like for a basic
website you do nowadays you need a login
system so I still I do consider user
logins a basic thing that you need to
cover and I suppose once you have user
login you should have a way to change
password you should have a way to you
know some sort of forget password thing
or something like that but I think
that's a little more advanced then I
want to cover at least in these initial
videos so we've done that and now I
think the next tutorial will probably
cover login required or at least
something that handles the fact like if
the users already logged in they should
see this should be a logout button and
signup should be gone right so if
they're already logged in you get rid of
these buttons and you replace it with
probably like a logout button and then
if they are already logged in the login
page shouldn't load it should just be an
empty error should say like you're
already logged in something like that so
we want to use that and then we could
also use that to protect pages that same
methodology any ways to protect
subscription pages and all kinds of fun
stuff
so anyways that's what you guys have to
look forward to if you have any
questions or comments up to this point
please feel free to leave them below
otherwise as always thank you for
watching thanks for all this for the
subscriptions in it so next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>