<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Scikit Learn Machine Learning Tutorial for investing with Python p. 19 | Coder Coacher - Coaching Coders</title><meta content="Scikit Learn Machine Learning Tutorial for investing with Python p. 19 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Scikit Learn Machine Learning Tutorial for investing with Python p. 19</b></h2><h5 class="post__date">2015-01-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/1dk9NO2M41E" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys what's going on welcome to the
19th machine learning with Python
scikit-learn tutorial video in this
video we're going to actually test based
on the data that we just built in the
previous video so to do that we're going
to use back the same code pretty much
back from tutorial number 15 so that's
this code here if you don't have it for
whatever reason it should be posted up
on Python programming dotnet eventually
you should probably save you know the
testing or the training and testing
script as one version and then the data
building script or data creation
whatever as in other scripts but so
anyways I'm gonna go ahead and just copy
and paste the information from may be
apparently not
I guess copy and paste doesn't work
anymore copy oh my goodness what is
happening Oh what okay alright maybe
there maybe this the script has a bunch
of space at the end it must yeah okay
that's cool thanks guys all right so
here's our script and we basically just
need to make a couple of changes first
of all we I'm just gonna delete that so
right now we're running off of the file
key stats dot CSV but if you guys
remember we were doing key stats
underscore ACC for accurate ACC
performance and then all we'll do with
na first and then we and then we could
run it here but we're gonna get an issue
with not a number values so the next
thing we want to do is you could do this
either before or after the re-index it
really doesn't matter but we'll just do
it right after and we're gonna say data
underscore DF equals data underscore D F
dot replace and we're going to replace
anything with not available so up until
this point we've actually done no not
available and in fact let's go ahead
let's throw and no not available first
and so for now we're just gonna replace
a n so any na ends basically means not a
number
and that's panda specific stuff so it
may be not a number or was literally n/a
for the value something like that so we
were turned not a number now so when we
do D F dot replace you have to decide
what you're gonna do with not available
data so I thought we would do no n/a
just to get around this but let's do
will do with n/a for now uh-huh
and so you have to decide what you want
to do with this data so what a lot of
people will do or what some people will
do is they just simply will not include
any data that is missing some people
will take the data and replace it with a
zero and then some people will take the
data and replace it with some sort of
astronomically outlying number so for
example they might say and so we'll run
another dot replace so not a number
we'll replace with zero and then in
theory some people might do you know not
available and they replace that with
negative nine nine nine nine nine okay
Lu something like that and if your
script or if your machine learning
algorithm can handle for outliers and
just learn to ignore the outliers this
is kind of a way of creating outliers
now what you'll want to do at the end of
the day is kind of test with both so for
now let's say not a number is zero not
available to zero so a good kind of
starting point for that so we're running
with not available data so these are the
changes that we the only changes that we
need to make I believe are made so let's
go ahead and run that and see how that
works for us I bring this over so we've
got nine thousand rows of data
and our accuracy here is fifty three
point eight which is actually a
substantially lower than I usually see
let's write one more time
Mike's expectations when running based
on this leg this information was that it
you know fifty percent is is what you
should expect just simply because this
isn't really what we're doing here is
such a basic test but no we continue it
we're getting about fifty three percent
accuracy interesting when I did this
myself I swear it was like sixty just
run out one last time but two of these
in this area's somewhat defining okay so
now I got like 35 okay so now let's go
ahead and we'll take away we'll do know
and save and run that one so with with
error including the not available data
or wait wait okay yeah so this is no not
available data so fifty-six accuracy
fifty-three accuracy relatively close
numbers here so clearly we're seeing
that the inclusion of not available data
at least when we're setting the value to
equal zero is relatively insignificant
but now that what if we change not a
number to negative nine nine nine and
not available to negative nine nine nine
so this is no na you can see that our
accuracy probably remains slightly
unchanged let's run it again so
somewhere in the you know lower 50s and
then of course this one just gave us a
sixty percent let's try it again
mid-50s and this is where I can't
remember if it was no it is yes that's
no na so basically this is Knoll at the
moment but now let's do with not
available
and also what is our I forget what our
testing sizes but yeah it's a thousand
that's a pretty decent size actually on
the data so including the the not
available data now we're seeing about a
fifty three so again that's not really
much different than the numbers that we
had seen before setting it at zero run
it again this one kind of takes a while
you can only imagine that you know this
is why people want to really make their
machine learning pretty efficient
because we only have nine thousand rows
of data which it's kind of borderline on
what you want to do you know once you
pass about ten thousand that's when you
might want to think about doing
something else but we're only waiting
just a few seconds so I guess it's not a
huge deal but anyway uh so at this point
you know you can do either negative 999
or you can do zero I'm gonna replace it
with zero I think that's better but you
can do whatever you want
changing those two numbers doesn't have
any major effect on this particular
example so feel free to you know
whatever you want to do and then
whenever you're kind of doing it on your
own you just have to make the value
judgment you know negative the negative
numbers are especially negative 999 in
terms of our data set so we do we do
normalize the data with pre-processing
scale and so in theory a negative 999
will be a massive outlier and it won't
really should be kind of ignored by the
algorithm so that's kind of some
justification there although the not
available in my opinion is just at least
for now probably best set at zero but
you can set it however you want
so now we have this accuracy that is at
least above 50 I mean every time we run
it were slightly more accurate than then
just pure you know random guess okay so
somewhere between four and nine percent
right now more accurate so from this
point you know what what do we do well
with machine learning well first of all
if you just think of like gambling in
general a lot of people treat trading
like gamble
and the idea is to make a tiny margin
and just do it over and over overtime so
a 54% margin or at least a 54 percent
chance of being correct if you were to
do a million trades what you're doing
you're just fine right but the problem
with investing and trading that people
often forget is it's actually not about
accuracy so you can be 80% accurate in
your in your trading but if you're 80%
accurate and you make a dollar every
time you're accurate but in your 20%
inaccurate but you lose $100 every time
you're inaccurate you're you're in the
negatives right so if your accuracy is
only just barely accurate in terms of
how much money you make from that trade
and your inaccuracy is just super
detrimental it's not good so when it
comes to something like investing our
question is okay we see our accuracy our
accuracy is above 50% that's a good sign
but actually even below 50% would not be
a necessarily a bad sign because what if
you know because we're basically
training this algorithm to find
outperforming companies so in theory the
companies hopefully that we are
incorrect about say we're incorrect we
say that they would be an app performer
but for whatever reason they weren't in
theory or our hope is that those
incorrect companies just slightly
underperform the market it's nothing
major and we're hoping that the the
companies that we were incorrect about
that maybe did outperform the market but
we thought they underperformed maybe
they didn't it doesn't really matter
what those companies do because we're
not involved with those companies would
have been great if we could have been
but it doesn't really matter what
matters is the underperforming companies
that we chose to invest in how bad was
it right that's what we need to know and
then also obviously that's in relation
to the winners that we picked how good
did they do and we need to kind of
figure out how we do so from here what
we want to do is we want to back test it
and we actually have all of the data
that we need to run a backtest and
really we're back testing in theory
because we're testing the strategy right
here so we've already built the loop to
back test we have all of the data for
the current value in the one year from
now value it totally fits into
are not only our algorithm but also our
plans would be to buy and hold for a
year and then and then reassess so
that's what we're gonna do although in
the next video of course but yes so the
next video we're gonna back test this
and see you know let's just say we each
trade we put in ten thousand dollars
into a stock hold it for a year how did
we do and that's it we'll do a real
simple back test so we're not going to
have any logic in there that says hey we
held it for a year and like let's hold
it for another year we'll just assume we
sold it and then we'll rebuy if it's a
good position we're not really
accounting for trade cost that shouldn't
be a big issue with this because we are
buying a holding for an entire year here
so you know we we can account for trade
cost maybe like down the road or
something but this is not really a
highly frequently traded you know
strategy alright we're one trade / we're
raising holding every trade for one year
fixed so obviously that's another issue
is ideally you would have some sort of
not necessarily stop-loss in the sense
of stop-loss in price but stop-loss in
fundamentals so if the fundamentals got
to a point where you were like yeah
that's really bad you know some sort of
like a stop-loss trigger and get rid of
the company so anyway the next thing
we're gonna do real simple basic back
test just to see are we've and are we in
the green yet and if we're not how can
we kind of tweak this to get into the
green and if we are in the green great
so anyways that's what we what you guys
have to look forward to if you have any
questions or comments on this particular
video feel free to leave them below all
the wise as always thanks for watching
thanks for all the support and
subscriptions and the donations an add
to next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>