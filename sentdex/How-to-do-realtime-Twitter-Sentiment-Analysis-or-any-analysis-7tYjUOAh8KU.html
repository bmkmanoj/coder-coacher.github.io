<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to do real-time Twitter Sentiment Analysis (or any analysis) | Coder Coacher - Coaching Coders</title><meta content="How to do real-time Twitter Sentiment Analysis (or any analysis) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to do real-time Twitter Sentiment Analysis (or any analysis)</b></h2><h5 class="post__date">2013-12-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/7tYjUOAh8KU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everybody what's going on welcome
to another Python tutorial video in this
video we're going to be talking about
how to do real-time analysis in this
video we're going to be doing this with
sentiment analysis as an example and
we'll be using this centex API on tweets
for this and while I use the Centex API
as an example you can do this with any
API or you can even do it with your own
custom function so even though I'm using
our API you can do it with whatever you
want using an identical structure
because yeah I've had a lot of people
ask me about you know doing Twitter
analysis and they're almost always
wanting to they're coming from my you
know Twitter streaming tutorial they're
saving it to a CSV like I showed you
guys how to do and then they're wanting
to do analysis on that CSV and um and
this is kind of problematic for a few
reasons one is you might as well
streamline it with with the actual
stream and just do the analysis as it
comes in because either way you're going
to be using computing time and either
your pausing the the Twitter stream and
then doing the analysis cuz it's gonna
be really hard to catch up anyways if
you're constantly streaming and then
constantly trying to do analysis on the
stream because the stream is actually
pretty quick if you have a decent
internet connection so it's kind of
problematic for that reason you might as
well stay as efficient as possible but
also number two you're not allowed to
store tweets for more than 24 hours if
you do you're violating the Terms of
Service that you accepted so you can't
do that anyway it's sprite so with those
two things in mind let's go ahead and
get started so first what we want to do
is we want to grab the starting code
from the previous Twitter API tutorial
video if you've not done those tutorial
videos especially the first one then you
can learn about it by watching the video
I'm going to link you guys to the sample
code from those videos if you want to
learn about it there's a video right
above the sample code you can watch that
video if you want to learn more about
the API so anyway go to that link and
whenever you do try to drag it over you
should land yourself on a page like this
one so this is the video you could watch
that
for the twitter api and then here is the
sample code in case you lost yours rural
condensed version you'll obviously if
you are still planning on not watching
the beginning video and you've not done
anything like this before you'll
obviously need your own consumer key
secret access token and access secret or
authentication token and authentic I
forget what they call it but a token and
a secret you're going to need your own
and again if you want to figure out how
to get them and you don't know how watch
the video or go to dev comment and
figure it out so anyways otherwise for
everyone that's followed along just go
ahead and copy this code and paste it
into an empty you know script so the
next thing that we want to do now is we
need to make a few changes to
incorporate what we're going to do next
so again with with what we're doing here
I'm going to use the sent Dex API you
could use anyone's API or a custom
function if you're going to use a custom
function then you're not going to need
to import URL Lib or URL Lib too but
since I'm using an API I'm going to
import URL Lib so I'm going to do that
URL Lib and then in the centex API for
anyone who is interested it's not a free
API it is a paid API and if you want to
know more about it just go to semtex
comm and there's a link in the nav bar
for the API so anyway that's that so
then the other thing we're going to need
at least if you're going to use
someone's API or our API you're going to
need the off so for me I'm going to call
it sent Dex off and just as a quick
aside for anybody who is using an API
and they have an auth don't make your
variable off because auth is used in
twee pea even though you haven't defined
anything as well you define off down
here so it's going to it's going to
conflict so so you can't do that right
so just make sure you're not conflicting
anything so for me I'm going to call it
sent Dex off because I have a sin tax
auth token here and I'm going to leave
that blank for now and these you can try
them if you want but they don't work so
that's that so anyway and I'll fill
those in before we actually
the end and in fact let me go ahead and
just make the space here so just make
sure you import URL Lib if you're using
someone's off that requires URL encoding
and then make sure you add in whatever
your auth is for that API or if it's our
API adding that off there so now like I
said you won't have to use our API you
can use anyone's API or your own
function so in that case let's make a
function so what function do we want to
pass the tweets through because we're
down here this is where the tweet comes
out and data it's not the tweet they
actually it comes out as a the entire
JSON output we'll deal with that in a
second but what do we want to pass the
tweet through well we want to pass that
through a function so we're going to say
define maybe make sure I didn't type
define already okay define and for me
I'm just going to call it sentiment
analysis and this function is going to
take one parameter and that's going to
be text so this function is going to do
something so the text that we pass
through so in this case we have to do
URL encoding with the syntax API and
with most API is you're going to need to
use encoding if you're sending through a
text mostly for the spaces right so you
can't normally you can't send in a
string of text with spaces it needs to
be encoded and like for example a space
and with URL encoding as a percent 20
right so anyway I'm gonna say encoded
text equals URL Lib Kuo text and then
I'm going to do the API underscore call
equals and that's going to be HTTP colon
slash slash syntax calm slash API slash
API dot PHP question mark for variable
text equals what then we append here
encoded text plus what was the auth so
an auth equals and then plus for me it's
sent X off but for you you know whatever
if you're using an API and obviously if
you're not using an API and you've
written your own custom function these
two lines would be you know you won't
even have those but then you know but it
let's say you were running your
custom function let's say your function
is very basic and it returns analysis of
how long is the tweet so you would just
say you know x equals Len text right
that would be your function and then
what you're going to end up doing is I'm
going to delete this now and the output
from this API calls into URL
look URL live dot URL open and it's
going to open this API call and then
it's going to read the result which is
just a numerical result but basically
after you've written your whole function
like this is my function right this is
what's going to take the text and
convert it to a sentiment analysis
numerical value right so whatever your
function is like maybe you're counting
the length maybe you're just counting
the number of times they mention
something that's what you do so far and
then at the end of the function just
have it return output whatever whatever
you want at that function to return you
just say that down here now we'll come
down to our listener and since I made a
bunch of space let me get rid of this
space I just want to have a bunch of
space from up there now obviously you
don't have to do that the only reason
I'm doing that is so I can edit in my
you know my little secret codes here and
run it in real time with you guys so
anyway um next what we want to do
oops too many space I'm just trying to
Center this a little bit so next what we
want to do is once we've once we've you
know put in our function write our
function that does whatever we want you
know Twitter analysis for now we come
down to the listener and here at least
for us you can use a JSON module I
always just kind of split it up I'm just
silly like that so let's say the tweet
equals data dot split and it's a split
function here and what we split it by is
it comes out text calling double quotes
and then close close a single quotation
and then we want the second part of that
or the first if element there and then
again we want to split again this time
we're splitting by double quote comma
quote source and then the zeroeth
element so it's the zero element so it's
basically this with everything this goes
to the left and this splits and goes to
the right in case that's confusing you
can also use the JSON module if you if
you're comfortable with that otherwise
just copy exactly what I did and this
will return the tweet to you so once
we've done that we don't need to print
data anymore and so we've got the tweet
now what do we want to do well we wanted
to do some sort of analysis on that
tweet right and we made this function
that performs analysis on the text
that's passed through so we want to pass
what the tweet right through that
function so the next thing that we would
do is we would say at least for us we're
doing sentiment analysis so I'm going to
say sentiment rating equals sentiment
analysis so it's calling this function
and then what what a you know texts do I
want to pass through it well I want to
pass through tweet right so I want to
perform this function on tweet so what
it's going to do is every tweet I pass
through here is going to do the API it's
going to call the API it's going to
output whatever the sentiment reading is
from our API return that output and
assign it to this variable right here so
we've done that now that's really all we
would all we need to do the rest the
rest is you know you save it to a file
or something like that or a database so
since the database is a little more
confusing I'm just going to save it to a
file since there's less steps involved
so I'm going to say now save me and this
is going to be the line that we save is
going to equal tweet since we want to
have the tweet then we're going to do a
plus and we're going to use a double
colon as a delimiter and the reason we
want to use a double colon instead of
something like a like a comma is because
people oftentimes are gonna have a comma
in their actual tweet so you wouldn't
want to use a delimiter as a comma for
that reason anyway so then plus then we
want to have our sentiment rating so
it'll be the tweet colon colon and
Neyman colons right the reason why we're
using a double colon is people use
colons in their tweets to write
so anyways plus sentiment rating and
then plus since we're saving it to a
file we're just going to have a new line
at the end of everything so then we
actually want to save it to a file
source
say output equals open and I'm just
going to save this to out coops output
dot CSV with the intention to append and
then output dot write save me and output
dot close you obviously don't need to
close there if you don't want to
sometimes when the operations are fast
enough I've had Python trip over it so
in theory it's shown it with a pen but
you still can't be doing multiple writes
so sometimes it goes so quick
it probably won't with the Twitter
stream but I always just add that there
just for safety especially since we're
opening it every time anyways you might
as well just close it every time so
anyway we need to append or add that and
after that once you've done all that you
should have you should be complete right
so what I'm going to go ahead and do now
is come back up here I'm going to add
you know put my consumer key in my sent
text authorization and we'll actually
run this we can see the output and then
we can also open up this output dot CSV
file so let me go ahead and append or
editing all my stuff real quick alright
so I've edited all my stuff you should
too if you haven't already and now let's
go ahead and run it so we'll run it and
for whatever reason it's taking a while
to connect I have like you know a bunch
of streams so maybe that's the issue are
we not oh we're not actually printing
out the tweet that's why so let me just
run it for a few minutes here sorry I
thought I was printing out to tweet I
guess we left that out so we were
printing data and then I deleted it and
I should have just changed it to tweet
but it is saving to our output file we
really only need to do it for a little
bit so I'm going to go ahead and
actually break this for anyone that
doesn't know to keyboard interrupt just
hit ctrl C and that will break the
script so now uh now that we've done
that let's check out the output file so
the output file should just be in the
same directory as your script so here's
my script here and so we can open up the
output so just edit with notepad or
whatever you've got and so here is our
output here let me condense it so
everything fits
uh so so as you can see here we've got
the lines here um we've opened up space
for children 18 K displays have gathered
I don't know car crisis I'm not sure
what the car crisis is but negative to
sentiment let's find one that's bad um
collision involving one car one casualty
negative for obviously we didn't like
the search term was car so so obviously
a lot of car crashes this guy misses his
car um here's a negative one up
my car screwed everything are up
my car screwed everything up for me damn
negative six yeah you know messing up
your car is not a good idea buddy um see
and is anybody actually positive about
their car couldn't get his car started
no no no no no I just don't really see
anybody's happy about their car
it's very sad guys let's be a zeros
let's see is there look who we got a
positive two but this 11 year old boy
who stopped traffic to rescue a dog hit
by a car so that was positive anyway
um that pretty much covers it hopefully
that helps some of you guys out even
like I said even if you're not using the
Centex API or even an API at all you can
just you can pass it through any
function here you know you don't have to
even use an API you could have the
function doing all of the sentiment
alysus within this function just return
whatever output you're looking for and
save it now naturally like I said you
you probably shouldn't be saving the
tweet to your is that
again you're not allowed to store tweets
for more than 24 hours so just keep that
in mind if you did follow follow along
you wouldn't uh you still you can't be
saving tweet for more than 24 hours so
just keep that in mind so you know like
for like some of the stuff that we do
sometimes we use like named entity
recognition so if we find the named
entity we'll save the named entity in
the sentiment with that named entity
and you know that's totally allowed and
so you can do stuff like that
but obviously again you just can't save
the full tweet but anyway so hopefully
you guys enjoyed hopefully that helps
some of you guys out that are trying to
figure out how you can perform analysis
in real time you just pass it through a
function so over that was helpful for
you guys as always thanks for watching
thanks for all the support and
subscriptions and until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>