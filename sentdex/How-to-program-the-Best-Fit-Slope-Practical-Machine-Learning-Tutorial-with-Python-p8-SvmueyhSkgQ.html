<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to program the Best Fit Slope - Practical Machine Learning Tutorial with Python p.8 | Coder Coacher - Coaching Coders</title><meta content="How to program the Best Fit Slope - Practical Machine Learning Tutorial with Python p.8 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to program the Best Fit Slope - Practical Machine Learning Tutorial with Python p.8</b></h2><h5 class="post__date">2016-04-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/SvmueyhSkgQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody and welcome
to part eight of our machine learning
tutorial series in this part we're going
to start working on creating a simple
linear regression algorithm from scratch
in Python so to start we know that the
definition of the line is y equals MX
plus B and so we know that X will figure
out just simply because that's on the
x-axis but we know we need to know M and
B and M is going to be our best fit
slope and then B is that y-intercept so
first we're going to calculate for M the
slope and I'll pull up the equation
again just as a reminder so that's just
M equals the mean of the X values times
the mean of the Y values minus the mean
of the X is times the Y's all of that is
divided over the mean of the X's to the
power of two minus the mean of all of
the X's to the power of two okay easy
enough so now we're going to be
translating that in to Python code so
the first thing that we're going to do
is from statistics we're going to import
the mean or mean and then we're going to
import numpy as NP so you should be able
to guess why we're bringing in mean
there was there's quite a few uses of
mean there also just for the record the
regression line like a regression line
is just take a straight line so you know
for example an example might be just
pull up an image here right like this is
some data points and then you've got
this straight red line that's your
regression line that's also your best
fit line and you might even hear people
call it the Y hat line if you're talking
to a statistician anyway now we're going
to define some simple values you can get
to the point where you're using real
data but I think the easiest thing to do
is to just define some simple some
simple data so we're
say X's 1 2 3 4 5 &amp;amp; 6 yeah and then some
Y's will say R 5 4 6 5 6 &amp;amp; 7
you don't have to do this part but we're
going to visualize this data real quick
so import mat plot lived up pipe lot as
PLT and I'm just going to we're not
going to make it pretty or anything I'm
just going to say PLT dot plot x is wise
Kilty dot show just so we can see the
data we're working with here okay so
this is the data of course we just made
it a line so let's make it a scatter
plot okay so that's the data that we're
working with it's just a simple scatter
plot but you can probably see already
this is positively correlated data and
you could probably think of a line might
be something like this you know drawing
up anyway um so that's our data and I'm
gonna move this over okay
now I'm going to get rid of showing the
graph now we we know that what we kind
of need to do is if you recall in the
previous examples our data was not
actually a Python list it wasn't a
Python array because it doesn't exist
and said it was an empire right so we're
going to change this to numpy array and
you just can put that around in like
parentheses like that so that's just
like basically converting this to our
numpy array and then we're going to also
change the data type so we're gonna say
d type or actually we're not changing it
this will be the default but MP dot
float64 and we're mainly doing this
because we're probably going to be
revisiting linear regression and it'll
be in a time where the data type
actually matters for now you can or you
don't have to put the data type there
we're just being very explicit there
with thee with the data type so so now
we want to get the best fit slope so
let's say we're going to define a
function that generated the best fit
slope okay so best fit slope and we know
we passed the X's and Y's through and
then eventually we want to get to the
point where we return M and then we
would just be like M
whoops M equals best fit slope of the
X's and Y's right we're done right but
anyway that's a that's a nice a skeleton
function there so the first order of
business is we do the mean of the XS
times the mean of the Y's right so mean
x times the mean of the Y's so how do we
calculate that well we can start off by
saying M equals now this is not complete
of course but we're going to say M
equals and at first it's the mean of the
X's multiplied by the mean of the Y's ok
so so far so good
what was that next step meaning the XS
times the means wise and then it's minus
the mean of the X's times the Y's so now
what we need to do is add that so the
mean of the X's times the mean of the
Y's so that's one variation or like one
of the I hate to say variables one of
the parts so then what we're going to do
is we're going to put more parentheses
space you don't have to add the space
there that's definitely not Pepe t' just
making it easier to read because this is
kind of going to be a long one anyway -
and that was the mean of the x's times
the Y's right okay so now going back to
our function here it is we have done the
entire top of this fraction basically so
now we need to do the next layer so the
next thing that we're going to do is
coming back to the code we're going to
add a third parenthesis here so I'm
going to add another parenthesis at a
space you've got this space or these
parenthesis parenthesis I'm going to add
a space I'll slash so this is our
division sign and then I'm going to hit
enter and the reason why I'm able to hit
enter is because of this parenthesis
here okay so anyways that's why we're
encasing all this in a
just for the record so now going back to
the bottom we've got we need to do the
mean of the X's ^ - okay so how might we
do that well the first of all let's
consider what the power of two actually
is the power of two is basically the
like let's say is mean the X's ^ -
that's the mean of the X's times the
mean of the x's okay so in Python
there's a few different things that we
can do you can do something like let's
do this and you could say a lot of times
you can do mean of the X's ^ - like that
but let's run that really quick and
we'll see that we get this unsupported
operand for the data type we're using
okay another option can be x times and
it looks like that one is acceptable
another option is me the X's literally
times the mean of the x's okay
both of those will give you what you're
looking for now finally it was the mean
of the XS squared minus the x's square
or the mean of the X's squared so for us
to do that and that was - right so this
is all one so at this point we're going
to go - mean of the and this is the mean
of the XS squared so this could be you
could a lot of times you can get away
with this but I don't think because of
our data type we'll do that
yeah so or actually or ha - typo Oh -
amateur anyway all right so that's not
going to work out for us so another
option will be like that like x times 2
okay that's acceptable and then there's
of course X's like this okay so you can
do whichever one you makes you feel
better in sleep better at night
regardless there are is our M and then
we can even go and print out M okay so M
minus fifteen point two six is what
we're getting here so let me see here
what did I not content with that let's
see that does close all that off slash
line so I'm getting myself confused now
so let's see let me make sure we close
this off break so I don't think that
should be what we're getting there um
that's about right and then we wanted
this mean of because this whole thing
needs to be divided by this whole thing
so the mean of the X is like this let's
run that one more time that looks to be
more along the lines of what I'm looking
for okay so so welcome to the world of
PEMDAS alright this is the order of
operations right parenthesis exponents
multiplication division addition
subtraction so if you want to get around
the order of operations you need to use
parentheses correctly I was my issue was
that we were dividing we were trying to
do what we needed to do was divide by
this minus this like both those things
together but instead division was
occurring before subtraction so we were
actually dividing doing this divided by
this and then subtracting this from the
final answer which was why we were
getting such a large negative number
there
okay so again this is just this is the
slope of a line so a negative 15 slope
is its first of all negative 15 is kind
of weird Oh
printing out pen does
it's weird to have a negative slope to
the line where you have clearly a
positively correlated data but anyways
so we have our RM and now we need just
one more thing and that is our B and so
that's what we're going to be working on
in the next tutorial is calculating B
and the ones we have that we can do
linear regression
so anyways stay tuned in the next video
if you've got questions comments
concerns whatever up to this point
please feel free to leave them below
otherwise as always thanks for watching
thanks for all the support subscriptions
in until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>