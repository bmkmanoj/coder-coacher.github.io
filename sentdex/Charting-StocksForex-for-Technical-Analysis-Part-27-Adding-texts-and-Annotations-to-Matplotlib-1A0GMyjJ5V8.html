<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Charting Stocks/Forex for Technical Analysis Part 27 - Adding texts and Annotations to Matplotlib | Coder Coacher - Coaching Coders</title><meta content="Charting Stocks/Forex for Technical Analysis Part 27 - Adding texts and Annotations to Matplotlib - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Charting Stocks/Forex for Technical Analysis Part 27 - Adding texts and Annotations to Matplotlib</b></h2><h5 class="post__date">2013-10-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/1A0GMyjJ5V8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody welcome to
the 27th Python stock charting tutorial
I got a request to show how you could
add text and a marker to a chart so you
could show maybe when specific news had
come out something that affects the
price there and that's a great request
so here's how we're going to do it turns
out there's actually a bunch of ways
that we can do this but actually
matplotlib has a pretty nice built in
annotation function and I think is gonna
be our best option it's got a marker
it's got text and you need even has a
little bit of logic that just adds that
perfect finishing touch for us so that's
what we're going to be using and let's
go ahead and get into it this is where
we left off so if you you know run this
and get to hear desks that's what we
want to apply it we tell it what we want
to apply and we get the chart now what
we want to do is maybe add a bit of
texts here and be like oh something
happened here or something happened here
right so how do we do that so let's
close out of this and what we're gonna
want to do I think the best time to do
this would be at the very end so I guess
we'll just do it right here this has to
be before you know show but otherwise
that it's nothing too important and
where do we obviously want this stuff
well we want it on let me bring it up
again real quick I'll leave in the
background this time just in case I need
it again but we want it on this axis
right because this is just the MACD this
is the RSI this is the price chart and
so like we we want on the annotation to
be on this chart so that if you recall
is actually our axes one and ax 1 v is
the volume on ax is 1 so the way that
we're going to do this is if you were to
add text for example you would do ax 1
of text but for annotate it's really
complicated it would it's gonna be
annotate I know you guys didn't not see
that coming
and the first parameter in here is going
to be what is the test
that we're actually gonna put in here so
let's just say big news that's our
that's what happened and then the next
parameter is where do you want this you
know like what are the coordinates for
this so I'm not gonna show you guys how
to systematically get the coordinates I
mean if someone really really wants me
to I could do the video but I'm not
going to do that unless someone who
really really wants me to because
basically all you're gonna have to do is
let's say the let's say the news came
out on October 24th 2012 you all you
would do is find out what the index
value is of October 24 2012 like what
number and the date array is that and
then you would use that and then you
would use that exact same number on the
next way so if that's not making any
sense basically you would have this date
and then whatever value of that array
that date is in that's what you would
put in here but for now let's just make
up a number we'll say 5 10 and then
obviously a v1 same thing the index of
clock time so those are the coordinates
the next thing that we're the next
parameter is gonna be about the text now
that's like what we're marking and then
we look from there where is the text so
this next parameter will be XY text and
it's a little more confusing but
basically it's like where that text is
going to be like place from that point
so let me just give an example real
quick so we're gonna use 0.8 and 0.8 you
know I will just come back to this
afterwards but it's kind of like where
that text is after that marker so you
kind of move it away from the marker
right so you want to want it right on
that marker so anyway I will come back
to that so you can understand it better
if you don't already so you've got X Y
text then you've got text chords equals
and this is a little confusing but
basically what it is is just like what
system are you gonna use to define your
coordinate
and so we're going to use something
called AK sees fraction and what this
basically means is zero zero zero zero
means the lower left of the axis and
that wouldn't you know so the top right
would be one one so but there's a bunch
there's like figure points figure pixels
figure fraction axes points axial their
axes pixels and like data or something
like that so anyway just you could look
that up if you want it but just use axis
fraction and just know that zero zero
means the bottom left one one means top
right so the next thing that we have is
arrow properties so arrow rocks and this
is going to equal dit and then you can
specify face color in our example I
think we should use white and and then
the default line is pretty phat so we'll
say shrink actually let's put this down
a little bit arrow prop stick face color
white and shrink equal 0.05
next up font size like what's the font
size of whatever our text is we're gonna
say font size equals 11x let's make it
14 and then color equals white the
default would be black and we won't see
it next thing is now these are this is
where I kind of the logic comes in you
have horizontal alignment so do you want
horizontally it on the right or the left
the text on the right or the left of
your arrow and you can you can say what
you want but if data is in the way it
won't put it over there so or maybe if
the edge of the axes is in the way it
won't put it over there so it uses a
little bit of logic just so you don't do
something stupid but as long as you're
not asking it to do something absurd
it'll it'll abide by what you say and
then vertical same thing you can say put
it on the bottom of the top I'm gonna
say top and and that's it I know there
we go I didn't see it to highlight it
but yeah it's the closing bracket so
let's save that and let's run that see
what we screwed up oh I forgot we never
closed that other plot that's why it
yelled at me anyway a v1 all right set a
v1 is not this is capital a v1 run it
again I'm gonna yell yep anyway Yahoo
man I'm just all about horizontal
alignment there's all about the
screw-ups here it's go yell at me again
there it is right again hopefully no
typos yeah okay so here's our chart now
as you can see we've got the air of big
news and it turns out there probably was
some good news around this time because
BAM with the stock nice timing on our
arrow there so anyway that's just the
basics you obviously could pick
different colors and stuff you can make
this a different color in this a
different color but that's the basics
about adding the marker to the chart and
again if you if you wanted to do this
automatically you would just look for
the index value of the date of that news
look for that number in the list and
then just throw that number here and
here and then that would give it give
you what you wanted but the kind of the
back end it'd be doing like news and all
that kind of stuff is fairly large so
and everyone's got different news
sources and all that stuff but yeah it
is possible it's especially easy if you
connect to like an RSS feed something
like that and then you can just like
automatically store all these like the
dates and stuff and just automatically
throw it up there and just say like what
the title of the article was or
something so anyway a lot of cool stuff
you can do with having annotations on
your charts a lot of people like to do
it
that almost forgot to throw in the
examples of XY text how that works just
in case y'all don't understand yet so
8/8 currently throws eyes here right and
so if you remember this is one one up
here this would be zero zero so if we
say 0.5 that's you know basically plug
right in the middle so our text will go
into the middle so let's run
Yahoo again and there you see it's
basically in the middle now because we
chose you know 0.5 0.5 so anyway that's
that's how the wide text or XY text
works as always thanks for your support
your subscriptions thanks for watching
and until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>