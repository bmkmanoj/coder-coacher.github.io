<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Installation - Zipline Tutorial local backtesting and finance with Python p.1 | Coder Coacher - Coaching Coders</title><meta content="Installation - Zipline Tutorial local backtesting and finance with Python p.1 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Installation - Zipline Tutorial local backtesting and finance with Python p.1</b></h2><h5 class="post__date">2018-04-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/J4LTIixReMA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody and welcome to
a miniseries of the ins and outs of
getting zip line to run locally on your
own machine if you don't know what zip
line is it's just arguably the best back
tester in any programming language at
least that's open source and available
to you so zip line is the backend that
runs on quanto peein for example and
that's why I'm just gonna put this at
the end of that series at least for now
so the idea of running zip line locally
is you can do a lot of more custom
things with it so maybe you want to do
different markets maybe you want to do
the Australian market or you want to do
the Japanese markets or whatever you
might also want to do Bitcoin or who
knows what you want to back test you can
do that on zip line if you run it
locally but getting it running and all
that is kind of a pain in the butt so
that's what I'm here for so I'm going to
be doing this tutorial on zip line 1.2
and I'm going to be using Python 3.5 zip
line only supports to 7 and 3.5 right
now I believe the the main hindrance for
3.5 is because the zip line also
requires pandas 0.18 which doesn't have
a build that I can tell for 3 6 or 3/7
so I think that's the only requirement
or the only constraint to why we need
3.5 but keep that in mind if you're not
on 3.5 or 2.7 you'll have to download
that hit that too but anyways so I'm
gonna be using 3.5 and all that so if
only it was this simple it is not a pip
install if you have Conda it might be
that simple with just a Conda install
quanto peon zip line haven't tried it
what I have done is I've installed it on
both Windows and Linux and I'm gonna
share that process with you so you don't
need Conda if you want by all means go
ahead and try to use the condo way if
you already have Conda
great go for it I just don't use Conda
so what we're gonna do to start is talk
about what you need to do so I've
basically broken it down both in Ubuntu
and Windows on a boon - it's actually
pretty darn simple get your C libraries
mainly numpy scythe on get set up tools
and then you can
boom get zipline from there pretty
simple if you just spun up the server is
a few more extra commands like if you
haven't actually installed you know
these are just your typical you know
anytime you install Python you want to
do the Python dev get pip and all that
otherwise it's all the same on Windows
you have entered hard mode but still not
not really the hardest thing once you
got the idea so in order to do it
basically I'll put the link to this in
the description I highly recommend just
come here these are links you can just
click on them and it takes you exactly
to the package and then download the
python 3.5 version right so right here
this would be what I'm looking for
64-bit Python 3 5 download scythe on
then do that for all of these C
libraries the only two that I didn't put
links to is empirical and context Lib
that's just because they don't have like
a quick a quick link to them you just
type it in just do a ctrl F or whatever
in download does they're not really
organized by specific version just
download it use the wheel I can't
remember if you can pip install these
you might be able to even just regular
pip install but anything that uses see
basically you're not gonna get away with
it
so beyond that once you get these these
are those C libraries the next step I
would suggest you do is go ahead and do
a pip install - - upgrade pandas exactly
version 0.1 8.0 I think point 1 will
also work but just do this this is the
one that I've used next what you're
gonna want to do is just do a pip
install for zip line I didn't really
pull that out but I would definitely
just do just a regular pip install zip
line so you want to do this to get all
the other dependencies besides these C
dependencies eventually when you do that
pip install zip line it is gonna fail
and that's totally ok that's part of the
plan you just wanted to do it so you
could get all the other dependencies
that you needed that we're non-si
dependencies but it's gonna start
failing on like B calls and LRU dict and
all that and that's totally fine it's
what you wanted once you've installed
Bentley basically once you've installed
these C libraries once you've just run a
regular pip install zip line once you've
done that go ahead and
download zip line from here so I'll just
type dip line go ahead and download the
you know again Python 3.5 on 64-bit
download zip line and then you're gonna
want to run a pip install no
dependencies zip line because you
already downloaded the other ones and
you're just gonna fail when you try to
talk those so anyway yeah just run a
Python and pip install zip line 1.2 and
I just wanted to refresh my installation
make sure we're all on the same page
hopefully this doesn't fail fails 4b
calls why is it failing 4b calls
actually did I oh because this one my
copy didn't have no depths anyway let me
go back and pip install - - no Deb's
hopefully then download anything that's
gonna conflict it's gonna be annoying
anyway okay so boom that's what you need
to do install the zip line did something
go wrong for you let me know down below
do my best to help you out but pretty
much you're just gonna be probably
either missing packages or something
like that but yeah you should be able to
actually know depp's installs a zip line
instantly the real test is if you can
open up Python so I'm just going to do C
Python 35 Python Python if I can type
today and then just do a quick import
zip line and make sure you don't hit any
errors if you hit an error I mean it's
almost certain that it's like a module
not found error go and install that
module okay the only one that you need
to install a specific version of is
gonna be pandas make sure it's pandas
zero point one eight point zero and you
just you do that by just doing a 1/8
double equals and then the version
number that you want if you already have
pandas do a dash dash upgrade okay once
you've done that once you've tested your
install you're ready to get going to use
zipline for now we're just going to use
the quanto peon bundle because it just
makes it easy to get up and running
immediately but we will be using our own
data soon enough so don't worry about
that but actually what I'm going to go
ahead and do real quick is make this
text a bit bigger so everybody can see
it clearly on video hopefully not run
over my face there we go
okay so actually I kind of want to steal
commands to I'd highly recommend you
just go to the text-based version for
running all these commands but yeah so
the first thing that we're going to do
is we want to ingest that quanto peon
bundle so I'm going to quit out of here
and then I'm going to just type into
here zipline ingest - b4 bundle quanto
quanto peon - quand elle and this should
grab you the quand elle bundle cannot
okay so that mean oh I'm on PI oh shoot
because I've done mm-hmm
okay that's fine so zipline should be
installed into your scripts so what I
need to do actually because I've I've
put zipline into Python 3 6 because I
wanted really badly to either put it on
3 6 or 37 but I failed so on 3 7 all so
there's like no LRU dict and I think
something else anyway so I'm going to
specify the full path to zipline so when
you install zip line it's gonna put a
zip line dot exe in your scripts just
like with PIP if sometimes PIP is not
pointing where you want it to go just
use the full path to whichever PIP you
want it's not the end of the world or
you can do Python - M PIP anyway but in
this case I want to specify the full
path to our zip line which is C Python
35 it'll be in scripts and then it's
just zip line dot exe in your script so
zip line should be fine in just quanto
being quantal if that was your first
installation a zip line though you
probably have the right pointer there
you probably don't need the full path so
what we're gonna do here is ingest this
data looks beautiful on this gigantic
screen that that really helped anyway
while we're waiting on that let me pull
this over and just take note that I'll
give the full path again python 35
scripts so zip line and go ahead and
just run zip line - - help
so this zip line command here basically
has a whole bunch of options that you
have but basically you can load in
bundles you can clean you can ingest
some data and you can run so the other
thing that I would say is do zip line
well leave the help there and then we'll
just do run so this is when you actually
want to go
algorithm you can also there's a whole
bunch of commands there I don't
personally find myself using the command
line interface here but just know it
exists and sometimes if you look up for
help on tutorials or whatever there's
like three major ways that you can run
your algorithms so and they all have the
same parameters it's just sometimes a
dash will be replaced with an underscore
or whatever just take note that there's
this is one of the ways that you might
see people showing you how you could do
something and this might not be the way
that you learned from me so now I'm just
gonna show you that it exists okay so
the next thing that we're going to do is
I personally find that using notebooks
makes the most sense with quanto peon or
zipline because of quanto peon so I'm
gonna use my a Jupiter notebook you by
all means you don't have to when we run
algorithms you can run them this way you
can use data which is what we're gonna
use later I don't really see it but it's
probably in here somewhere if it's not
mmm interesting it may not even be here
right I'm sure can you run an algorithm
with custom oh yeah no data freak
interesting you might actually be forced
to do it this way anyway
that's okay cuz everyone's gonna do
exactly what I do so if you don't have
it go ahead and pip install Jupiter
because we're gonna be using Jupiter
notebooks once you've got Jupiter
notebooks go ahead and just type Jupiter
notebook if you couldn't see that's Ju
py ter so pip install that otherwise run
Jupiter space notebook and that'll open
up a new window for you into here so
once you've got that the next step that
we're going to go ahead and do is just
will go new Python three and it looks
good actually it's I'm just gonna pull
this up so I know what I'm going off my
screen so anytime you're in a Jupiter
notebook you just kind of want to let
let it know that you're using zip line
and you want to use the zip line module
so supplying tutorial
and you'll use this kind of the magic
soloed extension zipline and that's just
gonna load in zipline for us now we're
going to do the simple Apple buy
strategy this is the one that you see
all the time so basically in quanto peon
you usually have like you know you had
your initialize function here context
was being passed to it and for now we'll
just pass on initialize and then define
handle data this one took both context
and data for every day as it iterated
through and then what we could do is we
could do something like order and we
could say order the whatever you know
symbol for Apple a people there we go
nope order Apple let's order 10 shares
of Apple let's say and then we could
also record things we could say APL
equals and we could use data current to
get the current price for example so we
could against a symbol a APL unless you
did it current symbol yeah and then
we're looking for the specific field
that is price so you could do that on
quanto peon right and by the way I'm
just gonna keep referencing quant opium
because I'm kind of assuming anybody
following along here is followed the
quanto peon series so if you want to
learn how to build strategies and stuff
like that go to the quanto peon series
because that's a using zip line this
series right here this little mini
series is purely for installing and
running zip line locally from there
you're kind of expected to just follow
the quanto peon series because it's
identical syntax the only difference is
what I'm about to show you is you you're
not gonna get away with undefined
functions and variables right so before
other than context and data all right so
so with with this one of the functions
that we're using is order well we have
an imported order so we have to import
these things so from zipline API we want
to import order what's another one well
record
whoops record we never imported that
also symbol so order
whore in symbol all need to be specially
imported again context and data those
are getting past kind of in the backend
via this extension so you don't need to
define those but like everything else
you have to define just like a regular
Python program so keep that in mind
let's do pet bait huh nice ok so that's
your your your strategy for today so now
there are three ways like I said I'm
going to show you two real quick ways
for you to run the strategy one way is
if you saved this let's say you saved
this file as Apple back test dot PI I'm
just gonna copy and paste this in you
could open up a command prompt and you
could run the following zip line as long
as that points to the right version run
you would specify the bundle of data
that you want to use which in this case
we're going to use quanto P and quanto
because we just pulled it the file F
that we want to run Apple back test dot
pi so this right here would be what
contains Apple is it in the file name
back test pie Apple back to stop by or
I'm sorry is it yeah elbow vex has done
by ok start dates simple date format
their end date and then the output is
like this performance output that you're
going to see in a moment and we just
save that to a pickle by Apple out
pickle ok so that's one way you could
run it but again I'm not gonna be using
this way I'm gonna be using the Jupiter
notebooks so actually the way that I'm
gonna run it is again with some magic
here we're just gonna say zipline and
it's gonna be pretty much the same so
bundle is going to be the quanto peon
quando bundle we're gonna say start is
2008 1 1 so Jan 1st 2008 and will be
2012 1 1 and then we're gonna say the
output is I don't know strat dot pickle
or something it whatever you put here
issues to pickle that you can load in
it's a panda's data frame pickled okay
so now we can actually just run this
shift-enter that's how you run all the
cells by the way so this is just going
to trade daily on the quant opium bundle
use
the Apple so basically what we get here
is the data frame that is our
performance output I'm gonna be calling
that perfect from now on if you hit an
error here one of the things that they
just fixed head to the the text based
version of this tutorial and check out
the understanding the benchmarking
process and how to overcome errors that
creep in so before they were using the
Google Finance API that stopped working
and they've just replaced it with
another API that at any point could stop
working so if you need to fix that we
can fix that relatively easily
anyway it's working for now so awesome
maybe it'll keep working and maybe they
kind of fixed one of the other issues I
had with that but anyways so hopefully
if you got to this point congratulations
you've run at least you've installed
zipline you've run a really basic
strategy at least on their data and then
you've got this as your return of course
this is probably not exactly what you're
hoping for so in the next tutorial I'm
going to show you guys how we can go
about visualizing our results and kind
of begin working with the output that we
get from zipline because just like
there's many ways to run it there's many
ways you can work with the data from
here so that's it for now questions
comments concerns whatever feel free to
leave them below if you're enjoying this
content you can support it at Python
programming net slash support this is my
full-time job so if you think I'm doing
a good job support it all my income
basically comes from this so yeah anyway
that's it see you in the next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>