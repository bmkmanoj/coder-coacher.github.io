<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Scikit Learn Machine Learning Tutorial for investing with Python p. 15 | Coder Coacher - Coaching Coders</title><meta content="Scikit Learn Machine Learning Tutorial for investing with Python p. 15 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Scikit Learn Machine Learning Tutorial for investing with Python p. 15</b></h2><h5 class="post__date">2015-01-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/qc0MHtfHCVE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey guys what is going on welcome to the
15th machine learning tutorial video in
this video what we're gonna be talking
about is kind of shuffling up our data
so if we look at our information here
this is the the directory that we're
using in here in key stats and basically
what our what our program is doing is
it's running through each of these
stocks one by one to create this data
frame so it starts with a and goes all
the way down and blah blah blah and the
issue that we're having so for say
analysis here when we go to test is so
we're saying test sizes of thousands so
when we go to train this data on this
row when we go to Train this data we're
saying we want to Train you know to the
minus 1000th value well that basically
means that what we're doing is we're
training say from a to maybe let's say
down to here NVDA which I think is in
video so we're training on these stocks
and then we're testing on these stocks
so we're training on stocks that aren't
quite the same now in some respects
that's a good idea right you would train
on other companies and see if the kind
of insights that you make on other
companies are applicable to the insights
on completely fresh companies that we've
never even tested on so to some degree
that kind of makes sense to do it that
way but to another degree it doesn't
what we're actually trying to do is
we're testing against S&amp;amp;P 500 companies
period so we don't necessarily want to
test on specific tests on different
companies that were than what we trained
on we're really just trying to test
against just randomized or shuffled
sp500 data because we're not really
we're not like we're not taking it any
further than we're just saying S&amp;amp;P 500
companies so I suppose there's a bit of
a philosophical debate that could be had
as far as what's the better methodology
but I would say this is actually
a slightly flawed method of you know
training on these and then just testing
on this handful of companies when in
theory what we ought to do is kind of
shuffle everything after we've valued
everything so after we built the data
set basically and calculated you know
underperform at for them we would want
to shuffle up that data a little bit cuz
right now it's organized basically by
like not only is it organized to by
company like this like say a to this our
data is also somewhat organized by year
so it goes from newest to oldest and all
that so just for a bunch of reasons it
it can be useful to shuffle the data so
that's what we're going to be covering
in this video so the first question is
you know how might we actually do this
so what I'm gonna go ahead and do is
come down here and we're gonna comment
out the calling of analysis and we're
gonna create a new function just to make
sure our shuffling works because we want
to do is shuffle the robes but we want
to have the column data shuffle with the
rows right so we want all that data to
be the same because all we care about is
row by row and we basically each feature
is the entire row of data so that's what
we're trying to shuffle so we're gonna
do define randomizing will do empty
parameters and we're just gonna create a
quick data frame so we're just a data
frame equals PD data frame and this will
be a data frame and we're just gonna
have data 1 and data 1 is gonna be a
range 5 and then we're gonna have D 2
for data 2 and again this will just be a
range of 5 so now we can print out this
DF just to kind of seed
so now we'll call randomizing apparently
it took a long time let's see
what did we do wrong here okay yeah so
do you want it's a dictionary basically
so do you want : and then D 2 : range
okay so here we have a nicely organized
0 1 2 3 4 0 1 2 3 4 this is obviously
our index and then our columns so now
we're gonna do is we're going to say
we're gonna say DF 2 equals D F 3 index
and we're gonna re index based on a
random permutation of the index because
as you can see the index was just 0 1 2
3 4 so we can do that by going n P dot
random dot permutation and we're gonna
say a permutation of the DF dot index so
now we can print DF 2 and one moment
let's see what we've done here DF 2 what
do you guys think is the odds of that
one let's let's try one more time I'm
just not buying it wow that was so crazy
we didn't look it change anything but it
just so happened to be the random head
there in a permutation so the first time
through was the identical okay sure
anyway so the second example is an
example of a permutation I mean a random
permutation can indeed be the identical
version but anyway let's run that one
more time and yeah so we're seeing
different stuff Wow that was pretty
funny
I was like really I didn't like rename
it or print DF still still randoms
anyway so that's a randomizing function
in any way you can see basically though
the index always equals the data and the
columns okay so that's what we're
looking for we just want to make sure
that that's what we're doing so now
really we just need this command right
here and we have to basically input that
into our main function up here so build
data set
and then before you call what X the
capital X equals just like right up here
is where we're gonna call the next bit
so it'll be data underscore DF equals
data underscore D F dot re index and we
can reindex the same ways before NPR and
MDOT permutation and then it's a
permutation of the data DF dot index and
that should be it
so now we can do is we're basically done
with this randomizing we just wanted to
build a quick and simple function to
make sure our logic there was gonna work
and now we'll go to analysis and we'll
run our analysis and we see our accuracy
is 67% and we can actually we'll come
back up here and let's just actually
comment that out and let's see if
there's any major difference so we
should probably run it a few times so
this will be it's interesting that we
get the exact same accuracy every time
you should actually have some degree of
variation to your accuracy but it
doesn't look like we do so anyway let's
uncomment this out real quick it's so
weird that the other one has absolutely
no no degree of accuracy every time you
train and test there's highly likely to
be a degree of randomness there we'll
actually see that further on down the
road and there may be an actual issue in
our code as to why we aren't having any
degree of because obviously this is
random right but even even not shuffling
it I would imagine would get you some
randomness but not seeing any anyway
with the shuffle apparently our actual
accuracy has gone up quite a bit and
that's probably because we are no longer
training and testing on completely
different subjects we have a much better
data set here anyway so we're looking at
about you know the mid Sigma to upper
60s so that's that's actually pretty
good for for what we have here and
that's
accuracy based on
and whether or not it was an
underperformer outperform so accuracy
doesn't necessarily mean you would be
you know you would make 10% on every
investment right that's not true so
accuracy does not equal profit from
trading so we'll talk about that a
little bit more in detail later on so
actually we'll build a back testing
program to actually test this in in
reality say you were investing based on
this strategy so anyways that's it for
this video I just wanted to show you
guys shuffling up the data a little bit
because I think that makes it a bit more
accurate although some people may choose
to go ahead and remain not shuffling
this so you test on different companies
but what you also might want to think
about doing if you are gonna do that is
you would actually want to shuffle by
company then because right now it's
going in alphabetical order so what you
would probably want to do if you're
wanting to test on different companies
is well we've already built the back
tester but you would want to era we've
already built sorry the data building
but what you would want to do is in that
script where we have stock list it's a
list of names shuffle those names and
then you could you could do something
like that that way your training and
testing on different companies entirely
if that's what you want to do but right
now basically what you really truly want
to avoid is training and testing on the
exact same data that's what you're
trying to avoid it doesn't really matter
if it's the same company but you can
test and train on different companies
just to see as you can see we were close
to sixty percent accurate but obviously
training and testing on a shuffled up
data sets a little more accurate and
since we're potentially investing in the
same companies as we're training on I
think it just makes more sense to train
on them but anyways tweets their own so
that's it for this video if you guys
have any questions or comments on this
tutorial video please feel free to leave
them below otherwise as always thanks
for watching thanks for all the support
and subscriptions in the donations and
until</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>