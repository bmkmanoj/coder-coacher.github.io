<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Raspberry pi with Python for Robotics 10 - Programming Distance Sensor HC-SR04 | Coder Coacher - Coaching Coders</title><meta content="Raspberry pi with Python for Robotics 10 - Programming Distance Sensor HC-SR04 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Raspberry pi with Python for Robotics 10 - Programming Distance Sensor HC-SR04</b></h2><h5 class="post__date">2014-05-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/HutxiWnX26w" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody welcome to
another Python with raspberry pi
robotics video here we're going to be
taking one step closer towards the
welcoming of our new robot overlords
anyway what we're going to be doing here
is creating a program to sense distance
using our new ultrasonic sensor if you
missed how we hooked it up check out the
previous video in the playlist the link
to that is in the description so let's
go ahead and get started so first of all
once you log into your pi you'll just
you'll find yourself here let's go ahead
and CD into our robotics directory once
we're in there let's go ahead and just
make a new file and we're going to call
this sensor so sudo nano sensor dot pi
now we need to program our sensor
scripts so we're going to only need to
imports here one we're going to import
RPI dot GPIO as usual and we'll import
that as GPIO then we're going to need to
import time and time is going to be used
for a couple of different things one
will be literally as a wait time but
then also to measure the time between
the signals that we send so now what we
want to do is we need to define our
function and I'm just going to call this
function distance and then in distance
we're only going to have one parameter
and I'm going to call that measure and
in here is where the user can specify
whether they want centimeters or inches
and I'm going to set the default to be
centimeters so moving on with our
function 1 2 3 4 what we want to do now
is we want to set the mode for our pins
so if you don't know when you set the
mode basically it just it's whether or
not you want to use the GPIO pin number
or the actual like pin number on the
board so I like to use the board number
so we're going to say GPIO dot set mode
GPIO dots all caps board
next up we need to start off our pins
and specify what they're going to be so
we need to do the two set up so GPIO dot
set up and we hooked up pin 12 as our
output pin to the trigger so GPIO dots
out and then GPIO dot set up pin 16 and
this is going to be our echo pin and
that is a GPIO dot input pin and that's
pretty much all we need to set up so now
we'll come over here and we want to make
sure the GPI output before we start
doing anything just in case it already
had a value let's make sure it doesn't
have a value and we're going to say GPIO
die output 12 false just to make sure
now after we've done that we're positive
what we're going to say basically what
we do is we're going to listen on our
input pin which is 16 and as long as
there is no signal then um if it if
there's no signal or it's false
we're going to take the timestamps so
what we'll do is Wow GPIO dot input oops
while GPIO dot input 16 equals zero so
it's false basically 1 2 3 4 5 6 7 8
we're going to say no cig equals time
time so while that's the case no signal
is time time and as soon as it is the
case for while GPIO input 16 equals 1 1
2 3 4 5 6 8 sig for signal equals time
time so now we're going to have 2
timestamps one's going to be signal and
the other ones will be no signal
so then what we'll do is come down here
1:54 TL for time length equals sig - no
sick so that's going to be how much time
went by now we can calculate the
distance using because we know the speed
of sound is a constant so we can use
that to calculate actual distance so to
do that though we do we did specify the
measurement so we're gonna ask the
question if measure in equals cm then
the following calculation is used one
two three four five six seven eight then
the distance will equal to2 by zero
point zero zero zero zero so four zeroes
five eight and that will return distance
in centimeters
next one two three four LF measure
equals in4 inches then one two three
four five six seven eight
distance equals TL divided by zero point
one two three one four eight so three
zeros one four eight and that will
return us a distance in inches else in
case the person is an idiot and didn't
write it write print we just want to
have it print out improper choice of
measurement in or cm okay and that's all
we need to do for that function oh well
we want one more thing looking for a if
this is the case distance equals none
now what we want to do is run a GPIO
clean up GPIO dots clean up and then
finally we want to actually have this
function return whatever the distance is
now that's just all we need for the
function but let's go ahead and actually
call this function so let's just print
distance
distance in centimeters so let's exit
that save yes good right and now let's
go ahead and do part
sudo python sensor pi and we get a
return of five centimeters which looks
to be about correct I place that box in
front of the sensor so what we can do
now is we can move the box closer and we
can run it again and now we get one
point seven which is again pretty
accurate I would say and then also just
to show you guys if we do like here
let's say that's not a totally straight
box but let's run it we get five point
eight nine also just for kicks let me
show you will run it one more time and
you each time you run it you might
actually get a slightly different value
so some people might run two or three of
these just to see and then average them
together something like that alright so
we've got our sensor working and now
we're ready to move on with the next
part so I'm going to continue on in the
next part we'll actually add some of
this code to our robot car and then we
can actually start to make our robot car
autonomous in the sense that if it gets
too close to a wall it will reverse
maybe something like that so anyways
that's what you have to look forward to
thanks for watching if you have any
questions or comments feel free to leave
them below in the comments section and
thank you for your support your
subscriptions until the next video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>