<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>[See Description] Building Machine Learning Framework - Python for Finance 14 | Coder Coacher - Coaching Coders</title><meta content="[See Description] Building Machine Learning Framework - Python for Finance 14 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>[See Description] Building Machine Learning Framework - Python for Finance 14</b></h2><h5 class="post__date">2015-07-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/SqLcTkzaz0Y" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody welcome to
part 14 of our finance with Python
tutorial series in this video we're
gonna be talking about is including
machine learning into this kind of basic
long short strategy we're we're pretty
much just going to impose machine
learning as another requisites to
getting in or out of a company and
that's basically it so first of all
let's go ahead and we need to import a
few things so let's go ahead and do that
so we'll just come down here and we're
gonna bring in first of all we don't
need date/time pie to you I think those
are just there from when I created like
a new strategy so let's do all the SK
Lauren imports so first we're gonna have
from SK learn dots and we can use first
let's use the linear underscore model
and this will be we're going to import
logistic regression logistic regression
so this is a type of classifier with
scikit-learn so for example for all of
these let me just search for a quick
logistic regression for all of these you
can do you can look up exactly what
they're doing with scikit-learn first of
all so let me pull up that here so this
is an example of all of the parameters
here so this is SK learn linear model
logistic regression these are all the
parameters so it's useful to know a
little bit about logistic regression
when you're gonna go ahead and use it
but for now we'll use the default it
turns out the defaults are usually
pretty good for our cases it's probably
not gonna be the greatest we won't
I don't think we'll kill ourselves with
it but but you would you pry if you're
interested in machine learning it would
behoove you to read through these and
then also learn a little bit more about
logistic regression but anyway we'll
bring in logistic regression we're also
going to bring in from SK learn dot SVM
which is support vector machines we can
import SVC
linear SVC and then we'll do new SVC and
then let's go ahead we can bring in I'm
not sure we'll actually use all of these
we might we'll see anyway we'll do from
SK learned ensemble sample imports and
this one is the random forest forest
classifier some someone specifically
requested that one so what we'll use
that as well we it fits in with pricing
data I suppose and then what we'll do is
let's bring in also from SK learn we're
going to import pre-processing although
we may or not may not need to use that
and then finally we're going to go from
collections import DQ and counter the
queue is a container what it's gonna let
us do is it we can say hey this is a
container we want it to be like 500 long
and we could contain things within it
although actually we probably even need
the queue for this one because we'll use
history instead and we'll go through
histories so I think I'll just get rid
of the queue and this will be fine
so now we're going to go ahead and do is
will we keep basically all of these ETFs
that we're going to be into and then
let's add a couple more so first we'll
say context dot his store historic Col
underscore bars and this will be like
how many historical bars should we
consider at a time and that'll make
sense when we get into handle data it'll
make a little more sense and then we're
gonna have context dot feature
underscore window and that will be equal
to 10 so way machine learning works
especially with scikit-learn but really
across the board machine learning for
the most part at least supervised
machine learning you're gonna have
features and labels you've got features
and then the labels that apply and you
train based on those features and labels
and then you have your current set of
features you feed it through and you ask
it to predict what it thinks the label
is based on the training that it just
did so so what we'll do is we'll go
through the last hundred bars of data
basically so the last hundred days
of data and we'll take slices of ten day
windows of data and for each slice what
we're gonna do is we'll train that slice
and then we'll say okay what happened
where did the price go from this point
if the price went up that's great that's
a buy if price fell that's a sell as our
label so that's what we'll do there and
then what we're gonna do is we're gonna
come in down a handle data now and we'll
go ahead and get rid of this we can keep
all of this stuff and we'll keep
tracking these records so if you don't
have those you might want to add them
it's useful especially the leverage just
always put left wrench in there I've
learned that you got to have that so
first of all what we're gonna do is
we're gonna say prices and we haven't
covered history yet so congratulations
here we go with history what history
allows us to do is query
quanto peon for historical data now you
can do closed price you can do a minute
price day price and I think there's
other ones I can't remember what the
other ones are but minute and day
obviously if we're working with daily
bars you can't query minute data so if
you want minute data you have to be
using minute bars but otherwise you
should be fine but we're not really
interested in minute trading at the
moment anyways we might eventually
convert this to minute trading but if
you're trading in a minute you're gonna
run up a lot of trade if he is probably
so what we're gonna avoid that for now
we'll just do it because you'll see this
strategy has we've actually already seen
the backtest does a lot of trading so we
don't really want to compound that so
anyway history and then we want a
history for what well we want historical
bars basically so we're gonna say bar
underscore count is going to be equal to
context that historical underscore bars
so that's going to be the amount of bars
of history that we want is gonna be a
hundred bars the frequency is another
parameter but for us we're interested in
one day so I pretty much just the
default you may or might I don't even
need to pass that and then field we're
interested in price so you could you
could query for volume open high/low
close so like say you're doing
a strategy that measures high minus low
for volatility let's say you could query
like that kind of stuff so what this is
gonna do is for is every day it's gonna
run this right here and it's gonna what
this is going to do history returns the
current price and then the previous X
amount of bars minus one basically so
when we're doing a hundred we're doing
the bar count of a hundred here so what
it's saying is today's price and then 99
prices ago it's gonna store that into a
data frame of prices so from here that's
basically all we need in this before we
get into this for loop because we
basically want to do this for each each
company and so and actually so what
we'll probably well this should be fine
because what's gonna do is it'll be
prices and it should return a panda's
data frame that has columns for each of
these ETFs so you could also put it in
here I think but I'm pretty sure it
would still return a massive data frames
that'd be a really waste of processing
in this case so for stock in the context
I stocks so that's these so for each of
those what do we want to do well we'll
assign the moving averages that's no
problem and then we're gonna say the
start bar because what we're going to do
is we're going to iterate through this
list as we create our features so we're
gonna say the start bar is equal to
context feature underscore window so
that's this so we have to start at the
tenth point to get the previous nine ten
points right so that's how we're going
to start there and then we're gonna say
we're going to convert prices we want to
convert those last hundred days of
prices to a list so we're going to say
price underscore list equals prices for
that stock so again this returns a
panda's data frame where the columns are
equal to these little equities here so
each column is that no so stock will
reference that specific stocks column
and then we do dot two
list and this is how you can convert a
pandas dataframes column to a list of
values and that's all it is it's just a
list of closing prices basically so once
we've done that we're ready to start
building our features in our labels so
capital X for now will equal the empty
set and capital or I mean lowercase Y
will equal sorry not an empty set empty
list and then what we're ready to do is
to iterate through the prices to
populate each of these so at every day
we're gonna take the last 10 days of
prices and then say what is today's
price is it higher or lower than the
previous price if that's the case we're
good to go
that's a buy let's say okay so that's
what we're going to do here so we'll
pick this up in the next tutorial if you
have any questions or comments up to
this point as far as how we're doing any
of this stuff or how we're getting
prices with history anything like that
let me know below otherwise as always
thanks for watching thanks for all the
support and subscriptions and until the
next video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>