<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Matplotlib Tutorial 21 - adding more indicator data to our charts | Coder Coacher - Coaching Coders</title><meta content="Matplotlib Tutorial 21 - adding more indicator data to our charts - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Matplotlib Tutorial 21 - adding more indicator data to our charts</b></h2><h5 class="post__date">2015-07-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/e53tmzo-U3g" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everybody and welcome to part 21
of our matplotlib tutorial series in
this video we're gonna do is create a
couple of functions that will give us
some more data to plot so we don't
really have anything on that axis 1 or
axis 3 so we're gonna write a couple of
quick functions to generate some sort of
useful data to place on those on those
axes so first we're gonna do a moving
average and so we'll plot that moving
average I think on axes 3 and then we'll
plot one more and we'll probably just do
high minus low or something for axis 1
so the first thing that we'll do is
we'll come up here and we'll define a
new function and we're just going to
call this function moving average and
moving average is gonna take two
parameters it'll take values and then
window so a moving average is for those
of you don't know it's basically it's
exactly how it sounds you'll every any
given point let's say you're using a 20
moving average you'll start at a point
you'll have that point and then 19
points prior so it adds up to 20 and
then you calculate the average of those
20 points boom that's the 20 moving
average at that point then you move on
to the next point
from that point 19 points prior Keckley
the average and you keep going and so
way of calculating kind of trends so
people use it with stocks to calculate
trends and then usually they have like
two moving averages like a fast and a
slow one and when the fast one crosses
above the slow one people like to invest
and then when it crosses below the slow
one people like to either sell their
position or even short companies stuff
like that so anyways it's through a
simple indicator real quick to write the
function to do it so let's go ahead and
get started so first of all we're gonna
say the weights weights will be equal to
NP dot repeat and we repeat with 1.0 and
then window and then we divide it by the
window and then we're gonna do SMAS
equals NP do we have I think we're all
ready yet we are important NP convolve
and then we're gonna do this two values
weights and only include valid data so
we'll talk about that in a moment as
well and then we return
the SMAS so that's a moving average
function if you don't know about numpy
can vulvar and numpy repeat don't worry
about it we just wanted to write a quick
function to create a moving average and
that's really it now what I want us to
do is we're gonna create one more
function actually let's handle for the
moving average first and then we'll
handle the next function so now we're
just gonna make up some numbers here
we're gonna say we've got an MA one is
gonna be equal to something and MA two
is gonna be equal to something you can
pick what you want right now we're
working on one month data let's change
that to let's do let's do ten-year data
and the moving average one we'll do a
ten and moving average to will do a
thirty I suppose now so now we've got
the definition of how to calculate a
moving average and stuff now we actually
have to calculate the moving average so
we'll come down here this is kind of
where we're calculating data and stuff
like this is the area for data
calculation so let's go ahead and retain
that area and we'll just come over here
and let's do let's say M a1 is equal to
moving average and we want to calculate
the moving average against the closed
price and using the window of whatever M
a1 was we just like just define that a
moment ago so let's copy this paste and
replace this with a2 and this with it
too and now we have two moving averages
finally we need to calculate a starting
point we'll talk about that
that'll apply more as we move on but for
now let's just say start whoops not all
caps though start equals the length of
the date of MA - so that's like the
number minus 1 onward so the reason why
we're doing this is when we calculate
moving averages we're gonna like the
moving average is just the number and we
want to plot that number with the
applicable date but we're gonna have
less moving averages than we do updates
because wait like two
let's say a 20 moving average you need
20 data points so on day number 5 we
simply cannot calculate a 20 moving
average so we won't have data for that
so we need to have a starting point for
the date in order to do this by that
same token you can ply it like the like
we have a 10 and a 30 for example like
the ma 2 is our largest moving average
you could plot the 10 moving average and
then 20 days later you could plot the 30
day moving average but that would be
kind of messy it's best if everything
starts together so we're gonna use start
for that reason just as a note this this
series is mainly intended for matplotlib
customizations so if you're not
following along stock investing and all
that kind of stuff really honestly don't
worry about it same token for if you're
not following along like with the
converter here don't worry about it and
the moving average don't worry about it
that's not the purpose of this series
feel free to ask questions like if you
want to learn more go for it I'm all for
supporting that but if you're not
following along about the purpose of a
moving average or how it's calculated
and all that really honestly it's not
necessary for the consumption of this
specific topic of matplotlib so anyway
and the reason why we're covering it
again is just just to have some data
there and so that's kind of why we're
going through it really quick because we
just want to have sample data so there
we've calculated our moving averages and
all that and so now what we want to do
is we're going to put the moving
averages on axes 3 so this is where
we're doing all that stuff to ax 2 and
then now and in fact even though this
was a this is a comment just in case
like people start I'm gonna replace this
with ax 2 and then should have one right
here yeah ax 2 but yeah I'm just gonna
fix that so now we're gonna come down
here and then ax 3 oh my goodness there
we go
X 3 dot plot and then we're gonna plot
date and in fact I'm gonna I'm gonna
forget to do that start thing just so I
can show you the error that comes up
because you'll see this error a lot in
your programming with mat plot lib and
you're gonna not know what to do
probably at the first time you see it
x3 type plot that and then a x3 dot plot
date ma - so let's run that and wait for
our air oh we've got an invalid syntax
error instead this is the Len of a
rights okay so no colon is required
there so this is the length of date ma 2
- 1 :
there we go okay so this error here x
and y must have the first but the same
first dimension the first dimension is
the length of the list so what this
error means is that you have these x and
y or of not not of the same length so
right so for every X you need a Y right
and so if they're not of the same length
if you see that error one of these two
pieces of data has a different length so
what you can do is you can come here and
you can print you know Len date and then
Len ma-1 okay so you can see okay well
what's the difference between these two
oh look at that one is 522 and the other
one is 513 so that's what's causing our
problem so sometimes they'll be like
subtle differences like that or one of
them will be length like one thing I
don't wanna be like 500 and you'll have
some sort of logic error in your code or
something but you'll have to discern
what's causing that in our case this is
a 10 moving average so we're losing 10
points around 3 I guess 9 but 10 points
basically and so we have to handle for
that and that's why we're why we've
coded in this start point okay so the
way that we do that and use that start
is the following so instead of just date
we do date - the start point :
and so it's like - start onward so then
we'll take this copy paste paste paste
so now let's save and run that
and now we get the moving averages so
it's a little harder to see kind of this
and this price is kind of in our way so
we can kind of modify this a little bit
but for now yeah we've got like the
moving average here we've got the price
and all that we can tinker with these
and a little bit
also we've lost date here we have the
original date but we're using these old
dates we'll get to that no problem let's
add one more quick function before we
move on and that new function is going
to be just an easy high minus low so
we'll come to the very top here and
we'll add another function here and it's
going to be defined high underscore -
underscore low and then we pass the
highs and the lows through this and then
this function just returns pies - lows
and then what we do is we can use list
mapping for this if you don't know what
list mapping is you don't really have to
worry too much about it but for an
example we could define highs as being
like 11 12 15 14 13
and then lows equals 5 6 to 8 that's yep
7 whatever I lied so now what we can do
is we can say H underscore L for high
minus low equals high underscore -
underscore low and then that is or
actually I'm sorry so how much level
equal list of convert that there so it's
the list value of the mapping of high
minus low and then we pass the values so
we would pass highs lows right so we
just redefined highs lows here so what
it does is it applies this function to
each element along the way this is a
really quick way of applying kind of a
function the other way you could like
use a for loop to iterate through it or
something like that but anyway we can
now print high minus low and now that's
the the aunt the answer here is right 11
minus 5 is 6 12 minus 6 is 6
and 15 minus 2 is 13 and so on so that's
how we're able to do that and now we can
actually calculate this for our graphing
purposes and so this will be an ax 1 so
this is where we're calculating the data
so we can calculate that data real quick
we can say H underscore L equals the
list of the map of hi - whoops
high - low and then the values here are
the high prices so it's high P and then
low P and that will return a list of
high - low values then we can plot that
by going a X 1 dot plot underscore date
and then we're gonna say we want to plot
date the date followed by the high -
love with the plotting style of a line
because it does those little dashes okay
so now we can save and run that and now
at the top we've got a new little
function here that's the high my SLO we
clearly have too many data points so
let's close this and we're gonna change
this instead of ten years let's do let's
do one year see if that looks a little
better it's a little more reasonable
we'll stick with one year for now so now
we've got data in all of the axes that
we want now comes the part where we're
gonna customize this we're going to fix
all these little jumbled up data points
we're gonna fix these dates we're gonna
fix this over here we'll fix this stuff
here and then also like when we zoom in
to a specific point for example we're
zooming and only on this point but not
the other points
right on our charts so we'll fix that as
well so we got a lot of work ahead of us
but at least we've got data now again if
you don't really follow how we did all
the data points it's ok I just wanted to
have some data here we could have also
plotted random data for all that matters
it's a little more useful it'll plot
something that's useful so anyway that's
it for this tutorial if you have
questions or comments even on the stuff
that's not necessarily that you know
please do feel free to ask about them
I'm happy to share otherwise as always
thanks for watching things for all the
support and subscriptions and until next
time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>