<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Regression forecasting and predicting - Practical Machine Learning Tutorial with Python p.5 | Coder Coacher - Coaching Coders</title><meta content="Regression forecasting and predicting - Practical Machine Learning Tutorial with Python p.5 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Regression forecasting and predicting - Practical Machine Learning Tutorial with Python p.5</b></h2><h5 class="post__date">2016-04-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/QLVMqwpOLPk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to the
fifth machine learning and fourth
regression tutorial in this tutorial
we're going to be building on the last
one where we created this linear
regression algorithm we found that it's
got great accuracy and all that and now
we're ready to actually predict like out
into the unknown right so it turns out
we actually already do have some unknown
data simply because we're forecasting
out this shift right which was about 30
days so we can actually work with that
so what we're going to do is where we
define our our X's let's do the
following let's actually cut this come
down here paste and we're going to take
this drop in a cut-and-paste and now I
am reminded why I was doing that
negative forecast out so so what we're
going to do is x equals x to the
negative 4 cast out um
colt let's see negative 4 cast out to
the point of negative 4 cast out and
then we're going to say we're going to
do X underscore Lately equals x to the
minus 4 cast out comp : and then we're
going to drop the missing data when we
go to create the labels this way we have
both our X's and our X lately defined so
the X lately basically is the stuff that
we're going to actually predict against
so we have the X's and then we just need
to figure out what the M and the B is
right for y equals MX plus B we get the
answer for y we've done linear
regression so so we're going to do it
against these lately X's that we
actually don't have a y-value for which
is why we were not training or testing
on that data so now we have our X lately
so the next thing that we're going to go
ahead and do is basically we
down here and actually it's going to run
this really quick just to make sure
we're still actually getting the
accuracy we don't have an incorrect
number of values okay now we don't so
we're good so we've got 96% accuracy
awesome so we'll come down we'll comment
this out we don't really need that
anymore and now to predict stuff what
you would do is and also make sure we
scale see so what we need to do is take
this almost made a mistake there and
this now let's run that one more time I
make sure I didn't screw anything up
good ok so now we're going to do is
we're going to come down here and we
need to predict based on the X data so
the way that we can do this once you
have a classifier doing a prediction is
actually super easy so we're going to
say forecast set equals CL f dot
predicts and then here you can actually
pass a single value or you can pass like
an array of values to predict make a
prediction per value in that array and
that's what we're going to do right
we've got this heat this 30 days of data
basically right here so uh X lately
rather so 30 days here okay so it's the
last 30 days so X lately we want to
create that with X lately so then we
have our forecast set so now we can do
we can print forecast set forecast set
confidence and forecast out just so we
know how many days were forecasting out
here this up bo confidence
do we or accurate I'm sorry yeah so I
changed this I usually use confidence so
accuracy try again
pull this up and yes so there we go so
we've got our predicted values so these
are the basically the next 30 days of
unknown values for us that's like these
are just straight up the stock prices
which
is actually pretty cool because we you
know like that whole scaling part is
also playing a major role here it's
still outputting you know stock prices
that are of decent value to us anyway I
think it's cool
so so these are the next 30 days of
prices so then let's say you wanted to
graph that so what we're going to do is
we're going to come up to the top and
again we're going to just blast through
wrapping this if you're confused or
whatever I have Matt plot Lib tutorials
so you can check those out if you want
to learn more about graphing but
otherwise we're going to import and in
fact we'll just add date time here date
time and then we're going to import Matt
plot plug lib pie plot as p LT from Matt
plot lib import style and then we're
going to say styled I use GG plot so
it's just to plot stuff this is how to
make it look decent this is how to
specify which decent looking thing you
want so now what we're going to say is
we're come down we'll just come down
here and we're going to say DF forecast
equals NP and this just specifies that
that entire column is just full of not a
number data and you'll see why in a
moment but we'll actually put some
information there shortly
now we need to find out what the last
date was this might not be the bestest
way to do something like this but this
is how we're going to actually plot this
on on the the graph so to say last date
equals DF Kyle oak whoops negative 1 so
this is the very last date we'll get the
name of that and then we're going to say
the last UNIX value is equal to last
date time stamp and then one day this is
how many seconds are in a day so you can
just do the math there if you want but
it's 86,400 and then the next unix would
be like the next day right and these are
we know these are daily prices so we're
just going to we're kind of hard coding
this part
it just so we can create a graph but
last UNIX plus one day so when you do a
prediction the prediction has no idea
like what date that is that's like four
all right so remember when you're doing
machine learning x and y does not
correspond to like necessarily the axes
on a graph in this case it doesn't X or
the features y is the label it just so
happens the label is the price so Y it
is correct what is X correct no because
the date is not a feature so that's
that's why we're kind of having to work
around here because we actually don't
have the date values I have lost my
mouse I have no idea where my mouse is
there we go anyway next unix okay so now
we've got the dates and now we need to
actually populate the data frame with
the the new dates and the forecast
values so the way we're going to do that
is we're going to say for I in forecast
set next date equals date time date time
dot from timestamp next UNIX and then
we're just going to say next
UNIX plus equals that value of one day
so one day and then DF dot loke and then
next date whoops
next date equals and then we're going to
do like a one-liner for loop here so
we're gonna say MPN for something we
don't care about in range of the Len of
DF columns
let's see range minus 1 and then plus I
so what we're doing is we're iterating
through the forecast set taking each
forecast and day and then setting those
as the values in the data frame
basically making the features the future
feature is not a number okay and then
the last line just takes all of the
first columns sets them to
numbers and then the final column is
whatever I is which is the forecast in
this case so now we're going to go ahead
and do is we're going to say DF adj dot
close dot plot and then we're going to
say DF forecast for cast dot plot and
then we're going to do PLT legend we'll
put that in the fourth location that's
just like the bottom right and then
we're gonna say PL TX label and we'll
say that's the date
PLT dot y label that is your price and
then finally PLT - oh okay so we zoom
through that hopefully that for loop is
going to work out we'll find out shortly
see I've got a graph here yes ok so this
is our actual graph of the data pull
this up and as you can see this is this
is the known data here and then over
here is our predicted data so let me
zoom into that spot right so this is
like the future prediction here the
forecast okay um so it's just like a
really quick way to visualize the data
and really the complex part the reason
why we had all this nasty to crap in
here was just simply so you can have
dates on the axes because that's how I
am I wanted to have the dates there so
anyway but yeah so that's how you can
actually forecast out the data and
actually do a prediction but the crux of
doing a prediction with scikit-learn is
right here and just remember you can
pass a single value or you could pass an
array of values and it will just output
in the same order the array of values
and then from there we just used logic
to know that each because each
investment is a day writer each price
report was it one day so then that just
means that each forecast was like one
day later right so we just kind of used
our brains for that one
so anyway and I guess the other thing to
think about DFL oak just in case I'm not
sure we ever actually covered that in
pandas but what happens there is
basically dot lok is going to be
referencing the index for the data frame
so when you do DF not lok next date
basically what that's saying is that
next date is a date stamp right and that
next day is um the index of the data
frame so maybe it would help just let's
see print do you have to ahead so if
you're not if you're not confused at
this point feel free to care down to the
next video where we'll be talking about
pickling but if you are confused about
that for loop I just want to explain
that for loop just so everyone no one's
like what the hell
so anyways so yeah so here write the
date is the index so when we say dfx
date we're saying the index and if that
index doesn't exist it's going to create
it and if it did exist it would just
replace it okay then we're saying NPM
for underscore in range lang DF columns
minus one what the heck is that what
that is is just a list of values that
are MP nan so basically we're saying
it's MP nan for a just a high percent
change but all this stuff is just not a
number right because this is into the
future we don't have information on that
data okay then coming back down here
then we're saying plus I remember I is
the forecast right right I in forecast
set so then we're just saying so
basically is just this list plus one
value so it's like this huge list
well not huge it's just these this many
columns right well then we just add
forecasts at the very end so that's just
our super hacky way of doing the
following I said to head there but
probably would've been more useful to
say tail and so you can see the end of
this data frame how yet these are all
those NP Nan's
and then finally just forecasts okay so
that's all that is sorry if that was a
little confusing hopefully the
explanation worked if not feel free to
ask question or whatever I'll be happy
to clarify it now
then there's actually one more thing I
want to show you all before we dive into
regression
and actually write a regression
algorithm all on our own and that's
pickling and the reason why you'd want
to pickle is imagine you have rather
than training a classifier on this you
know relatively small data set we just
had daily values for the last few years
but you know if you save this to a file
you know it's probably like you know 500
kilobytes or something who knows but
let's say you had like intraday data and
you've got like two gigabytes worth of
data that's going to take a while to
train the classifier on that data so
wouldn't it be nice if every time you
wanted to make a prediction so just
consider making a prediction using
future data consider every time you
wanted to make a prediction that you
would have to train the classifier is
that not just crazy sounding so yes
that's crazy sounding so in the next
tutorial we're going to be talking about
pickling which will let you save your
classifier and then just quickly load it
in without any training time so
definitely very useful with machine
learning classifiers so anyways that's
what we'll be talking about the next
video questions comments leave them
below otherwise as always thanks for
watching thanks for all the support and
subscriptions and until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>