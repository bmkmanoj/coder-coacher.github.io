<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Matplotlib Tutorial 8 - getting data from the internet | Coder Coacher - Coaching Coders</title><meta content="Matplotlib Tutorial 8 - getting data from the internet - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Matplotlib Tutorial 8 - getting data from the internet</b></h2><h5 class="post__date">2015-07-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/IbUa1tTT-7k" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everybody and welcome to part
eight of our data visualization with
Python with matplotlib tutorial series
in this video we're going to be talking
about how we get data from the internet
so what we're going to go ahead and do
first is we'll get rid of this this kind
of commented out code you might you can
save that for your own records if you
want but we're going to start building
just with numpy so first of all we want
to like you know pull some information
offline so how do we actually go about
that well first of all you know sources
of data online are very vast you've got
places like quando and i'm pulling up
all the places that we'll talk about
here you got quando and and then all
kinds of api's like google has AP is and
yahoo has AP is and even like wikipedia
has AP eyes for stuff but we're going to
focus on well we're not going to use
quantal actually in this in this series
probably but this is a really useful
place to gather information but we're
going to use Yahoo Finance's API so this
just for the record but though like you
can look up the quotes here then you can
find the link to the quotes but we'll
end up just writing it in and I'll give
you a straight link but we'll be using
Yahoo Finance's API to get stock prices
so what we're gonna do first is let's
start by first of all to get that data
we'll get rid of this plotting stuff and
we'll do let's let's create a function
out of this so we're going to define
graph underscore data and we're gonna
graph data for a specific stock so this
is kind of the same sort of code one
building something pretty similar to
what I've built in the past where you
can just type in the stocks name and
it'll graph that so for now we'll push
this over and then we'll have down here
we'll call graph data and then we'll
pass through a stock for now let's do
let's do Tesla so TSLA it's for the
electric cars so graph data stock and so
what we're going to start with is first
we need the stock price you are
I'll stock price URL is going to be this
will be HTTP colon slash slash and I
think I will just have us I'll put the
link in the description it's pretty
certain I'll forget to put the link in
the description so if I forget someone
do please remind me and I will put the
link in the description as soon as
possible but here is the link I don't
want to waste time typing it out but
basically this is the Finance API this
is where we input the dynamic stock
whatever that happens to be and then we
have chart data and this is the other
this is one variable and this is another
variable we're just hard coding it but
this is like ten years of data that we
want one thing to note if you decide to
go up on your own little tangent here
and you decide to change this to things
like one day when you're using anything
greater I think than ten days the prices
you get or the date stamps are in like
real like legible date stamps or at
least somewhat legible but if you get
down below ten days you're going to get
unix time we'll cover how to handle unix
time but just understand if you try to
get ahead of me you're going to be like
uh unconverted data and that's why so
anyways moving right along stock price
URL good got it next we're going to say
the source code of that URL is going to
be equal to and we are going to have to
incorporate URL live for this one so
let's bring in actually a few things on
top of this so let's go ahead and import
URL Lib and then we're also going to do
import Matt plot Lib dates as M dates so
map hot lib has its own little date
converter called M dates or date
handling called M dates so we're going
to utilize that anyway source code is
equal to URL Lib dot request URL open
and then we want to open this stock
price URL and then we want to read and
anytime you read stuff in Python 3
you'll you can just add the decode there
we're going to end up decoding it
anyways this may not actually be useful
but we'll put that
anyway then we're going to say stock
data is going to be an empty list and
then we're going to say the split source
equals the source code dot split by a
new line so the first thing that we can
go ahead and do is we can actually visit
this URL to like see what we're working
with here so let's take that copy paste
that and I'm going to replace that you
know quote stock with Tesla
so that pulls up this okay so this is
the return that we get now Tesla hasn't
been around for ten years so we don't
get ten years of data but we get like
basically five years really really close
five years actually anyway uh so here's
our data and basically we can see
there's some useless data up here but
then as once we get down here this is
all just stock prices okay so that's
what we're really what we're after and
here this is the year 2010 this is the
month oh six this is the day the 29th
and then you've got open well actually
you've got closed
Yahoo Finance orders is funky but you've
got close the high of that day the low
of that day the open of that day and
then the volume of that day so volume is
how many shares of that company were
traded so our source code is going to
look basically just like this now we're
splitting that source code by newline
then what we need to do is we kind of
want to filter out all this junk okay so
the way that I've done this in the past
is to first of all check to see if the
length of that line split by comma so
that's splitting by a comma you should
have one element two three four five six
okay you should have six elements when
you split by comma but and then the only
other line that has six elements when
split by comma is this line right this
has there's one element two three four
five and six
so we also just want to just hard code
the filtering out of that line and other
than that we should have all pricing
data so we write a quick for loop to
basically handle for that so what we're
going to say is for whoops not in all
caps for line in split source what do we
want to do well we're going to say split
line
equals each or actually water set line
split line equals line dot split and we
split by comma and then what we're going
to do is if Len of the split line so
this is where we're asking if it's equal
to six it's got to be exactly six if
it's less than six
we don't want it it's more than six we
don't want it so great if that's the
case great and then we also just want to
get rid of that line as like values date
close hi-low I just use use values so if
the term values is not in the line what
do we want to do well we're going to say
stock data dot append and we append that
line so now we have the line of data
that's basically the years stamp like
this we've got basically this data right
and this will be you know a long line
and then there will be that's the list
element then here's a second element the
third and onward so now we've got that
the next thing that we want to do is we
need to kind of use numpy to read this
data into variables so this data goes as
date closed price and I usually do close
P because close has a meaning so does
open for example so we have close a high
P low P open P and then we have volume
and we say that we're going to unpack to
those as we showed before is equal to NP
dot load txt and the text that we're
loading the text is just this variable
right so you can load all kinds of stuff
with load text it's not just text we
load stock underscore data I want to
start inserting commas or I mean of
course I'm gonna have commas I'm gonna
start inserting new lines here so we
don't run off the screen but stock data
then our delimiter is equal to a comma
then unpack needs to be equal to true
and then finally add a new thing and
that's converters and we're going to say
converters is equal to and you use a
dictionary for the
and you say zero so that we want to
convert the zeroth element that would be
date because date right now is just this
weird format okay so matplotlib is just
not going to recognize that so we
convert that and then we're going to say
in Python - this is relatively simple we
use M dates and stuff and we can convert
this and it works but in Python 3 it's
still for some reason does not want to
be decoded right so we have to run our
own quick little function that's ok so
the converters is going to be we're
going to convert the zeroth element
using the function of bytes pide to num
and then we specify what the structure
of this data is basically and so there's
all kinds of symbols in date/time
conversion I'm just going to show a few
here but usually at the end of the day
you use the following okay you've got %
a % Y is like a full year so 2015 for
example and then you've got % lowercase
Y this would be a partial year so you
might have 15 right then you've got a
sub year % M equals the number month
% D would be the number day and then
you've got % H which is equal to hours %
H M would be minutes and then you've got
% s capital yes and that is seconds ok
so just keep that in mind that there's
those you can look up more if you want
but these are the ones that we're going
to basically need we actually aren't
going to be even using hours minutes
seconds here so in here the structure of
this is a percent capital y followed
immediately by a percent lowercase M
followed immediately by a percent
lowercase D so that would be % y % d %
are actually percent m so
right and then % D if someone had a date
that was like let's say the date was
1206 2014 let's say so month day year
you would have this would be structured
as percent M then a - then percent D a -
and a percent capital y okay so when
people add dashes in there you you can
add them in as well so anyways now we've
got the converters now we just need to
make that conversion function so we'll
go ahead and I think we'll store that
conversion function for the next
tutorial and then we'll work on actually
graphing this data as well in the next
tutorial we should be able to get this
information pulled and graphed with in
one more tutorials so anyways that's
what we got for now if you have any
questions or comments up to this point
please do feel free to leave them below
otherwise as always thanks for watching
things for all the support and
subscriptions and until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>