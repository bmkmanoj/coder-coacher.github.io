<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Charting Stocks part 30 - Graphing intra-day stock prices unix time stamps in Python | Coder Coacher - Coaching Coders</title><meta content="Charting Stocks part 30 - Graphing intra-day stock prices unix time stamps in Python - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Charting Stocks part 30 - Graphing intra-day stock prices unix time stamps in Python</b></h2><h5 class="post__date">2013-11-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Y9nTh5WeB90" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is up everybody welcome to another
Python matplotlib
live updating charts tutorial as I said
I wanted to take this current example
that we have that's just graphing data
from the sample text and while that is
graphing it live that sample text is
pretty boring data to graph live so now
what I want to do is step up those
charts from the previous Python and
charting tutorial series and we're going
to make those charts even better now I
know you were thinking that you thought
that wasn't even possible but here we go
live charts so the first thing we need
to do with those live charts is change
how we're reading the data right so if
we come down let me bring over the API
here if you recall we were reading one
day open high/low close or in some cases
more than one day like here it's three
day open high/low close since this
example is 10 years but it is in you
know here's the year 2003 the month and
the day right here but if we bring this
down to more like let's say one day and
load that up now all of a sudden it's
changed right it's not from year 13
you know 83 month 506 and this is in
unix time and then you've got the
actually I guess it gets closed high-low
open volume but anyway then you've got
the exact same data right and so really
the only thing we need to change is this
right here and because also if you guys
recall we're using the moving averages
and we're doing a MACD and some other
stuff and like both both of those like a
moving average and the MACD you don't
really have to change anything there
because the those are using like it's
like a it's a time frame right so even
even on the one day or the one day was
just happen to be each data point was
one day
and in this scenario each data point is
a minute so either way you're looking at
in this case it would be you know before
using 20 and 200 then it would be 20
minutes 200 minutes if you're using the
MACD since it's 26 12 and 9 26 minutes
12 minutes 9 minutes versus 26 days and
so on so we don't have to edit any of
that the only thing we need to do is fix
up the conversion of this unix timestamp
and well that might sound a little bit
confusing it's actually it's not too bad
we'll be able to do it so what I'm going
to do is just take out we're going to
leave live graphs for now and let me
pull up I'm just going to move it over
to the side and we're going to pull up
the old version of the the analysis so
I'll show you that in a second okay so
this is the end of the Python charting
tutorial series let's run it make sure
everything's tied correctly so as you
recall stocked apply and then let's just
say we want to plot Apple pulls Apple
and pops up a nice beautiful chart for
Apple and now our goal is to make this
exact same chart work with intraday data
not only intraday data but also we're
going to make this update live which is
going to be pretty awesome you'll see
this updating live so let me close out
of this and although just keep in mind
it's one minute live data but if you had
other live data you could pass it
through as well so this is what we want
to edit now we don't need this variable
here and let me go through here real
quick and delete any comments that we
don't need all right so to fix this what
we all we really have to do is come down
here and here's where we are pulling the
stock and you can see just fit just for
the record I try to make the text as big
as possible on these little interpreters
so and make the window big enough so it
can be really nicely viewed in HD but
sometimes obviously the lines get too
long so you just have to bear with me
there if anybody ever wants me to like
post the full line just ask and I post
any of these like really really long
lines but anyway
eventually I'll put this these this code
up on my side I just haven't gotten
around to it yet so let's see this one
so all we need to edit here is just
we'll change this to one day and then
we'll come over here and the only other
thing that we need to change up is that
unix timestamp so what we're going to do
is is we can already see that we've
actually to check the length of the line
right we did that check here and to
check it we split it up so it's already
been split up so we can do something
there and then the only other check was
for values and that's still the same
case here cuz we're looking for
something with six things so if we split
this up by comma this is one oops one
two three four five six seven so that's
okay it's not going to give us any
trouble the only one that will give us
trouble is this one here so it's one two
three four five six and then we just
doing a check to see if values is in
there and if it is we just ignore it
so if value is not in each line then we
do something right so now what we want
to do is we're going to make some space
here and the variable we need to fix in
every occasion when you split by comma
is going to be the zeroeth element or
the first element in the array or the
list so that's the element we want to
change so we'll come down here and we're
going to say fix me those would be the
fix me variable equals split line zero
and then what we're going to do is we
can't do anything yet because in some of
the cases or at least in one case every
pole split line zero is actually going
to be a value there right so that's no
good but if it's not value so values
isn't in that line then what we're going
to do is we're going to make a fixed
variable and that's going to equal and
this is going to be one of those long
lines that if you guys need me to I can
paste it in but just follow along with
me so fixed is going to equal and what
we're going to use is we're going to do
some kind of fancy footwork here and
we're going to use a replace function
and in every instance where we find
split line zero when it's not values
we're going to replace whatever that
is dynamically with a converted date
stamp of that dynamic thing so pretty
pretty interesting stuff just follow
along and I'll explain as we go so fixed
is going to be each line dot replace so
each line so what it's going to do is is
going to read each of these lines right
here right and then dot replace what do
we want to replace we want to place
anything that looks like fix me so in
this case it'll be split line zero so
anything that looks like the first
element in each line so the UNIX
timestamp so basically we're dealing
with a UNIX timestamp so anytime it
finds that uh and we want to replace
that with what and we're going to
replace that with string and I believe
we have a date time let me make sure
your scroll up real quick yeah we do
have date time and we got time so we
don't need to import anything else come
back down here so fix me comma string
date time dot date time and then from
time stamp and then we want to convert
fix me right now fix me is in uh it's in
string form so we need to convert it to
an integer so fix me so just throw that
in there and outside of the let's see
let me make sure we're okay so make sure
you got two parentheses there and then
dot s T are F T IME
so string from time is what that means
and then now in these parentheses you
want to specify the format that you want
it to come out as so in our case the
format that we want it to come out as is
going to be a percent uppercase Y for a
full year - % M so the two digit little
number of the month
- percent day same thing two digit
number of the day percent capital H for
the hours : percent capital M minutes :
percent capital s 4 seconds and let us
that is our you should
and with 3 parentheses I'm going to
delete one and add it just to make sure
it is correct and as long as it
highlights the whole thing like that
you've closed off everything ok so now
that we've done that let me come down
here and come over and now that we've
done that fixed now instead of stock
file append each line we want to append
fixed so that fixes that line now the
only other thing that we need to do I
believe is change the converter here
right so here it's accessing stock file
and it's converting something to that M
dates format strip date to none and this
was the old format remember that ugly
yahoo format now the new format is very
pretty and sexy so we're going to copy
this this format above that we just
wrote and paste it right in there and
that will fix that now it's totally
possible we've missed something or made
a typo but I think that will add graph
our one day data that we're looking for
so let's go ahead and save it and run it
and see what happens so stock to plot
let's pull up Apple and okay so we got
Apple it probably looks like hell for
you guys and so you got this right now
keep in mind it's one-day data plot it
on and what's happening is we have a lot
higher granularity now so the width of
our width of our candlesticks is too big
so let's let's go fix that real quick
yeah let's see candlestick right here so
right now we're operating with a point
six width candlestick let's change that
to let's do it needs to be way smaller
so let's do one zero zero zero five
let's try that that should that should
fix it up for us so AAPL let's see what
we got now okay here we got much better
so just for the record it won't always
it shouldn't always look like that in
fact let me pull in let's put I had a
three day but today is November 4th and
market has only been open for one hour
so that's why we only have this much
data because one keep in mind
data is going to be delayed by like 15
to 20 minutes from like real-time data
but also it's it's one minute open
high/low close and we've only been open
for an hour so it comes like right now
we've just got one two three four five
six seven eight nine 10 11 2016 16
unless I counted wrong so that's about
right and market like I said a marksman
over for an hour and the data is
significantly too late usually so keep
that in mind but what about what I'm
going to do now is let's let's pull up a
three day since this is actually we're
positive that the chart is working but
just to be sure let me pull up three day
and it might not be one minute open high
low close but be close
I think I'll be five minutes I think
it's usually what they do and this will
this will bring us to another point okay
so this is the three day open high low
close data so we can see that it is
indeed working although you see like
this massive like nastiness there I did
get a comment or question or request in
one of my videos for how to get rid of
time series data that like get rid of
this like straight line right so this is
market closed over the entire week and
so that's pretty bad right so I got a
request for that and don't worry we will
be showing ended how to get rid of that
stuff eventually here so um so our chart
is working and it just looks kind of
crummy right now so we don't have too
much market data but we will get there I
do want to get to the next video to show
you guys how to turn this chart now into
a live chart and then I'll make it live
and like run it for a while and speed it
up and show you guys the live updates
just because like one minute updates is
a long thing to wait wait for so anyway
so that's that that's how we how we can
change the chart obviously we haven't
done anything alive but it that's how to
change the chart to using a more higher
granularity data that's maybe coming
through as a UNIX timestamp but you can
also use this little conversion method
so like depending on what kind of
information you're taking in it's
probably in a UNIX timestamp or a date
stamp so you know you only
really need to either convert you know
down here or if it's in a UNIX stamp you
can convert the fix me stuff but that
this charting application really should
work with any time series data at all
that's coming in at least open high low
close volume so the next thing that we
want to do then is cut off the video
here and in the next video we're going
to implement the live updating
functionality to this chart pretty
simple addition there and so that's that
so hopefully you guys are all caught up
if you have any issues or something has
gone wrong leave a comment below let me
know what's going on and I'll do my best
to help you out otherwise stay tuned the
next video as always thanks for watching
thanks for the support the subscriptions
and until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>