<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Scikit Learn Machine Learning  for investing Tutorial with Python p. 4 | Coder Coacher - Coaching Coders</title><meta content="Scikit Learn Machine Learning  for investing Tutorial with Python p. 4 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Scikit Learn Machine Learning  for investing Tutorial with Python p. 4</b></h2><h5 class="post__date">2014-12-24</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/rAdAVcS4aL0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">look buddy what is going on welcome to
part 4 of our scikit-learn with Python
and machine learning for investing
tutorial series in this video what we
doing is learning how to parse the data
so a lot of times your data is going to
be found online and you're going to need
to know how to get that data out and
from the internet and you know store it
somewhere on your computer other times
you might get a data set from somebody
but that data is not you know it usually
comes with more data than you want and
you kind of want to restructure that day
and all that so now we're going to be
talking about here we're going to be
actually acquiring the data and then
while in the next video we'll talk about
how we're going to structure that data
so it's going to get started the first
thing that we want to have is in fact
let me show you guys again this is
assuming you guys have downloaded the
package here so python programming
dotnet and then we're going to go slash
downloads slash intra capital q for
quarter dot zip hit enter and that will
download this file here this 243
megabyte file I'm going to cancel it so
if you haven't downloaded that you need
to go ahead and get that and then
extract that whatever my C Drive is very
small so I've actually might it's not
being stored on my C Drive I've got it
stored on one of my other drives so I
have mine stored at least for the
purposes here X backups int recorder and
that's where where this is and then
we're going to be concerning ourselves
with for now debt-to-equity so we're
going to kind of analyze the
debt-to-equity ratio and use machine
learning to see if there's any sort of
insights that we can gather about
debt-to-equity
compared to stock price compared to the
market so the idea is can we look at
just debt-to-equity
and figure out what companies to invest
in based on their debt to equity and
based on whether or not historically
that debt to equity ratio is the ratio
of companies that tend to beat the
market in earnings honestly I don't
expect that we'll find anything very
insightful with that singular feature at
that feature being debt to equity and
eventually we want to add lots of
features so we have all kinds of stats
so let me open up key stats and let's
just look at look at Apple and we'll
open up from 2003 although they might
not even have a debt to equity actually
yeah they do okay so Apple back in 2003
this was the stats and again what I've
done for you guys is I pulled basically
these are historical web pages so this
is from 2003 January 20th this is what
you would have gotten if you parsed
Yahoo at that time so these are the HTML
web pages and we can you know control
you to view the source or you can always
do like right click view page source and
this is the source in here so it's just
like parsing the website we just aren't
actually connecting to the Yahoo servers
overloading their servers so here we
have the page and we're interested in
debt to equity which is right here so
this is just simply the ratio of the
total amount of debt to the total amount
of equity what does that come to
so for Apple back in oh three when Apple
was a very good company to invest in
their debt to equity ratio with 0.072 so
almost a watch right so that's that's
pretty good you know you would want and
in fact this this really means that they
have more equity than they have dead
right
fast forward to say 2013 however on was
that August something here's the HTML
again we'll scroll down and we have debt
to equity now we can see that this
company is much great much more greatly
in
deaded having a hard time with that one
anyway they have a lot more freaking
debt right so that's they've got almost
14 times the debt that they do equity so
this company is obviously much more
leveraged than they were they were in
2003 and the question is of course are
they an okay investment right now and so
this obviously has like a lot of
inherent issues and this is why using
only one feature is very dangerous
because as I mentioned before tech
companies generally have a lot of debt
and they also have very little equity or
right and so they have these two things
that kind of work against you know the
them in these statistics and really
eventually what we want to get ourselves
to is measuring all kinds of things as
well as putting them in their
appropriate sector so what is the
normalized debt to equity ratio because
like we're talking about before we need
to normalize all this data and the ideal
normalization is you know normalize it
on a scale that's negative one to one so
the scale of negative one to one for
tech companies you know the the value or
the figure that we apply to say the debt
to equity ratio may be different for a
tech company as opposed to a bank okay
so what I mean by that is generally
let's say we've got debt to equity ratio
a negative one would be they've got you
know below let's say below one debt to
equity so that means that their equity
is higher than their debt so that would
be say we'll make that negative one okay
so if they have anything under point
zero one debt to equity ratio that's a
negative one and then you know a
positive one would be let's say twelve
debt you know so it's like twelve times
their equity that would be negative one
well that's okay for say maybe Apple
because that's a that's kind of a range
that they go in between so it's good for
like a tech company but for a bank or a
mining corporation that's not a good
a good range right to say that that
would you know that's the conversion so
what I mean by conversion is is we would
take their debt to equity and we would
prop we would multiply let's say this is
you know thirteen point seven five we
say anything above twelve you know is
like a twelve is equal to negative one
so we would say twelve or I'm sorry
twelve is equal to one in our case so we
would say twelve is to one as thirteen
point seven five is to X right and we
would solve for x and that would give us
a number most like it would be greater
than one of course and that would be our
algorithm for determining the range here
of debt to equity but we wouldn't use
that exact same algorithm for like a
mining company okay so if that's all
really confusing to you that's just sit
tight for now but anyway we're going to
pull this data and we're just going to
pull one one feature at the moment but
soon we'll pull many features because
that's where machine learning is going
to shine the brightest is when we can
kind of compare you know fifty five zero
features over the course of a decade to
really kind of get some useful insights
so first we need to pull the data so the
first package we need is pandas we're
going to use pandas for kind of the
manipulation of data sets pandas is
really great for manipulating if you
think in your head of like spreadsheets
it's really useful and handy for
manipulating spreadsheet like data or
even database data right a database is
really a big spreadsheet so we're going
to use pandas for that you can either go
to pandas PI data org or again if you
are on Windows I would just use this
website here download um the binary for
you also I believe we already suggested
to download numpy get it pretty
surprising just add eight util grab PI
TZ and by now you should have set up
tools and you should also have
matplotlib so cool so we need pandas and
that's it for modules that you need so
if you need to pause the video get
pandas and when you have pandas
downloaded and installed check to make
sure you have it correct by doing
just a simple import pandas and we're
going to import as PD for a script so
deport pandas SPD save and run it with
is f5 just depends on what IDE you're
using it's not you don't get an error
you're ready to continue so let's go
ahead and start pulling this data so
import pandas as PD then we're going to
go ahead and import OS then we're going
to import time and then we're gonna do a
from date/time import date/time and I
might forget but we're gonna use m'kay
time as well I'll just do time about
m'kay time it should be just fine but
we'll get there we're going to use that
because the way I've saved and stored
these files this hat data the file is
that you know the name of the file is
the date it goes year month yeah your
month day hours minutes seconds so we
have to like convert that so don't worry
I'll show you guys how to do that so
first what we'll do is we'll say path
and path is going to be the path to you
know this took 2-inch recorder rather so
mine is X backups inch reporter so your
path might be different you may not have
an extra for your X Files x colon slash
backups backups intra order so again
that's the path from mine your path is
likely different so just put the path to
whatever so this this way every time we
met we reference path from here on out
our code will be identical now what
we're going to do is we want to pull
from key stats so we're going to make
this new function and it's going to call
it we're gonna call it defined key
underscore and actually key like this
stats and then we're going to say for
now gather and gather is going to be
what data are we trying to gather and
this is going to be the name of the
entry in the table so if we bring this
over we're trying to gather total debt
to equity this right here without the
colon so copy that and paste it right
there
so total space debt equity mrq perfect :
that's our definition
that's our starting default parameter
for example and now we're going to say
these stats under section stats path
like this equals 1/2 plus slash do not
use a backslash use backslash you better
use one more backslash so forward slash
underscore key uh stats camelcase like
that so that's just rough what if I done
okay that's just referencing right roar
since we use path we're here and then
we're reference that we're saying the
stats path is in here right and then we
have all these files so that's our stats
path now we're going to have stock lists
and what we're trying to get here is the
list of stocks so each of these
directories is a stock right so we've
got all these S&amp;amp;P 500 stocks and all of
them have just just you know all this
decade worth of data in them so we're
going to say here
stock underscore list equals and then
we're going to say X 0 for X in OS walk
stats path what that does is it's going
to gather um just this name here
basically and it's going to get them all
for the entire directory content so let
me just show you we're going to print
stock lists and then we'll go ahead and
run key stats what's key stats ok and
this contains basically a huge list of
all of the the directories here so it's
just a big big list so that's that now
what we can do to run through this list
is we're gonna say print stock
underscore list ok let's comment that
out we don't really want to keep
printing that out and now we're going to
do is we're gonna say for each
underscore dur in stock underscore
list 1 :
the real we're doing that is initially
it lists out in fact let's just let's
print this one more time just didn't see
it cuz there's so much mirror go all the
way to the top it lists the root
directory here right this is where we
are so we don't want that that's not one
of the directories so anyway for each
der in stock list 1 : : um we're gonna
take each underscore file equals Oh s
list der each Dirar
so what are we doing here let's go ahead
and just print each file for anyone who
is lost I'm gonna go and do a time not
sleep 15 so we don't get like a billion
okay so this is listing out all the
directories of that first directory so
for a okay okay and so that's where we
are now so we have all of the file names
so each file and that's all the file
names um then we're going to say uh each
let's see for each Durer each file now
what we say if Len of each underscore
file is greater than 0 so basically like
if we happen to have something there
it's conceivable that some one of these
are a few of these companies have
literally nothing in there maybe there
was no data or maybe the data was
incorrectly gathered something like that
who knows then we're going to say cool
then we're gonna run this for loop so
we'll say for file in each file so each
of those files because if you remember
the output was just a bunch of those
HTML files um now we're ready to begin
to pull a bunch of data on these files
so first of all our date stamp is in the
file name so date stamp equals date/time
dot strip time and that's STRP time it's
not fully strip I don't know why they
did that to us but they did
strip time and we restrict the time from
file so file is here right each of those
files in file and now you specify how
that the kind of a structure of that
date stamp in that file and that was
percent capital blocks it was a full
year then it was percent lower case m
percent lower case D then percent
capital H percent capital and percent
capital s and then followed by of dot
HTML so this is just kind of like the
date syntax I guess I'm not trying to
think of the proper word to call like
percent y % m someone can comment below
what the actual official terminology for
this special nomenclature but this
basically means a full year a number day
or a number month rather a numbered day
oops it's like this percent D number day
and then number hours minutes seconds
and then it was dot HTML just other
stuff so guys ads are dates damn now
what we're going to do is we're going to
say the UNIX um UNIX time in equals time
dot MK time of the date underscore stamp
dot time to bowl so now let's go ahead
and print unix time and actually this
print date stamp and the unix time just
to make sure time dot sleep fifteen save
and run that and here we have two
thousand for january thirtieth the
nineteenth our first minute seconds and
then you've got the unix timestamp here
close out of this oops okay so i've got
the time well well actually at this
point we have the stock name and the
time stamp for the data that we're about
to collect this video is hitting 18
minutes here so i'm going to go ahead
and cut off the video here and in the
next video we'll actually dig into
to the file itself to parse out the
value that we're interested in which in
this case is total debt to equity mrq so
anyways that's what we're doing in the
next video if you have any questions or
comments up to this point please feel
free to leave them below otherwise as
always thanks for watching thanks for
all the support and subscriptions until
next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>