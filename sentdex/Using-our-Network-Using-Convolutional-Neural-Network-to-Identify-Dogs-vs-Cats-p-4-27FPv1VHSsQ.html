<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Using our Network - Using Convolutional Neural Network to Identify Dogs vs Cats p. 4 | Coder Coacher - Coaching Coders</title><meta content="Using our Network - Using Convolutional Neural Network to Identify Dogs vs Cats p. 4 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Using our Network - Using Convolutional Neural Network to Identify Dogs vs Cats p. 4</b></h2><h5 class="post__date">2017-02-22</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/27FPv1VHSsQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to
part 4 of our cats vs. dogs cattle
competition example with a convolutional
neural network classifying dogs versus
cats so up this point we've trained a
neural network we've got about 85%
accuracy and let's say we're content
with that we don't think we've done any
overfitting and all that we're ready to
take the next step so the next step
basically is to take the testing data
output some predictions and submit that
to Kaggle and see how we did before we
do that we only have so many I think
we've got five submissions a day on
Kaggle so you don't want to waste a
submission before you're pretty
confident that you're you're doing it
right so the first thing that we're
going to do is we're actually just going
to output some of the images and see
what the what the classifier classifies
them as so to begin let's go ahead and
import mat plot live dot type lot as PLT
now we're going to go ahead and do is
basically you can either do test data
equals process test data if you if you
don't have it yet but if you don't have
this file yet and then if you already
had it if you already have it then you
could just say test data equals MP dot
load test data dot numpy we don't have
yet so we still need to run that first
now we're going to do is dig equals P
Ltd figure and now we're going to do is
basically iterate through the first 12
testing data's and plot them up on a
figure and then also just put as the
title with the classification so we're
going to say for num data in enumerate
test underscore data up to number 12
basically recall that cat is cat will be
1 0 and dogness is 0 1
so now we rest a is basically recalling
the process here in test data the
testing data is an array of basically a
list of basically the image as a zeroth
element and the first s is the image
number basically the ID of that image
and we need that when we go to submit to
cattle so we're going to say image num
equals data 1 and then image underscore
data equals data 0 then we're going to
do why rule save dot add underscore
subplot this would be a 3 by 4 slope
subplot grid and the number will be
basically num num plus 1 so it's a 3 by
4 and then the number itself is whatever
the number plus 1 so as we iterate
through here num will actually start at
0 whereas subplot start at subplot
number 1 so we have to add 1 now we're
going to say or rain in G equals image
data and then we're going to say the
actual data here is image underscore
data dot reshape image size by image
size by 1 so that's just to make
tensorflow happy now when I say model
out so to use the actual model once
you've got one in memory you just do
model dot per day now you do have to
have the model itself in memory needs to
be the exact model that you use so in
general you'll do a model dot load but
you can only do a model dot load once
you've defined the model and that's why
typically I'll have a a CNN model dot pi
or something that just contains whatever
the model actually is so model that
predicts and then the prediction takes a
list in this case we're just passing one
thing so we're just gonna say C data and
then it returns a list of predictions in
this case it's only going to be one
prediction with zeroes elements the one
we're interested in now what we're going
to say is if and peeta
Arg max
of model out if that is equal to 1 ie
the first element well that would be a
dog so if that's the case we're going to
say the string label equals dot else
will just say string label label equals
cat now we're going to do a y dot in
show we're going to show the original
image because it wants to stay you know
50 by 50 not 50 by 50 about 1 the
original image and then we're going to
say team at people's gray we're doing
this bitch just simply because yes we
converted to grayscale but still when
you plot it up on I met plot lib it's
going to give it all kinds of
psychedelic colors even though it is
grayscale but it doesn't know that now
we're going to do PLC dot title the
title will be the string label and then
now the ticks kind of will get in our
way we just don't need them so we're
going to get rid of them so we're gonna
say Y which is our subplot which can be
kind of confusing but access dot
x-axis dot set visible to pulse and then
we ready the same thing to the y-axis
copy paste wine grapes now PLT dot show
ok and let's run it and then while
that's doing that let's uncomment this
out and then comment that so next time
if we run it again we don't have to redo
that
great so here we have our
classifications here dog that looks
correct cat that looks correct dog damn
pretty shot cat but it is pretty hotel
dog dog cat cat dog a cat looking dog
that's definitely dog cat cat okay
so we actually pretty good only one was
was incorrect so let's say we are indeed
happy with that so what can we do well
we can just quickly do with open let's
open a submission mission filed on CSV
we'll open that with the intention to
write as f there might be a better way
to do what I'm doing here but that's
okay that's not right
we're going to write ID label newline so
when we do this line it's going to just
overwrite the whole file with just this
data and then we're going to do a
another with open so with open and in
fact I'm just going to copy this paste
and now rather than write we're going to
append so with open that as F fine now
we're going to do for data in TQ DM of
test data again if you don't want to see
the progress bar just remove TC DM now
we're going to come up here and I am
going to I'm going to take all of this
copy come down here paste have this over
once bring this back we don't need why
we've got model out and actually what
we're interested in is the first step
element basically is model out because
that would be the dogness so model out
will be an array like this and it'll
probably like so Allah and then well it
would be like 7 something like that
point seven okay yeah anyway something
like that actually these boxes
anyway something like something like
that and we actually the prediction is
how much how likely is this a dog
specifically so so what we're going to
say now is just F dot right and we are
going to run something which is the ID
comma and then the actual value and then
a new one
so dot format image num and then the
second value would be model out and then
the first develoment and then we're just
going to continue doing that until that
mission file is complete let's run that
and it is beautifully we're ready pull
it up and we'll see how we did if you
follow me on Twitter you probably
already know how we did
cool so we should be done I'm sure not
so let's see if I've got the submission
file here there we go
so here we go and this is just basically
how much how likely is it that we have a
dog cool so as we can see here we don't
have perfect you know ninety nine or
zero which is kind of good because we're
not going to get penalized too much on
if we are wrong were and so on but if if
we're never sure about anything we're
also going to be penalized a lot there
too but if you have a really strong
network you can all it can almost work
in your not in your favor with a log
lash format that we have anyway let's
see how we did so we're going to come
over here and I'm going to upload the
submission file and actually I pretty
sure we it's probably set by now yeah
okay so we upload this real quick
oops there we go okay so I've got it
uploaded I'll just say Victoria video
example make submission at first it
wasn't happy with my file alright so um
how it's actually made it improvement
over my previous score I think it was
but definitely an older score I thought
I had been better than this anyway
so we're right at about 700 in this rank
of not too many people just over a
thousand people so probably what we want
to do is I mean first of all you know
85% accuracy is not exactly the greatest
so we probably want to work on our
little continent a little bit more but
anyways that's hopefully a really quick
example of creating convolutional neural
network on actual data and also just
kind of how to use can I go a little bit
more anyway if you have any questions
comments concerns whatever feel free to
leave them below I'll do my best to help
you out otherwise I will see you all in
another video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>