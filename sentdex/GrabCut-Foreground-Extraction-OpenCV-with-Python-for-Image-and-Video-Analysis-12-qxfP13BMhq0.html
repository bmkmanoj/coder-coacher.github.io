<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GrabCut Foreground Extraction - OpenCV with Python for Image and Video Analysis 12 | Coder Coacher - Coaching Coders</title><meta content="GrabCut Foreground Extraction - OpenCV with Python for Image and Video Analysis 12 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>GrabCut Foreground Extraction - OpenCV with Python for Image and Video Analysis 12</b></h2><h5 class="post__date">2016-01-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/qxfP13BMhq0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to
another open CV with Python tutorial in
this tutorial we're talking about is a
slightly manual version of foreground
extraction it's not necessarily manual
but I suppose foreground extraction in a
region of the image basically so let's
go ahead and just get started and
hopefully it will come to light for this
tutorial we're going to use an image I'm
going to use this image here it's me
staring off thinking about world peace
and how we can come to it and so that's
the image I'm going to use if you need
to copy that image as usual go to Python
program unite find this tutorial and all
the documents will be there so along
with CV to an umpire's NP we're going to
import map plot lib dot pi plot as PLT
now we're going to specify the image the
image is cv to emerita and the image
name again is pretty long one OpenCV
python foreground extraction tutorial
jpg feel free to shorten that if you
want mask is going to be NP de zeros of
the image shape and then NP you went
eight for the datatype okay then we're
going to have a background bottle and a
foreground model both of these are going
to be basically the exact same thing NP
zeros one six five and then we're going
to have an umpire float here MP dot flow
whoops
sixty-four that's our background model
that we'll use and then our foreground
model good and then the rect this is
going to be the rectangle that we are
going to use for my image if you're
using your own image you'll want to find
the rectangle that in cases what you
envision to be the foreground of
whatever your image is next what we're
going to want to do is what's called
grab cut so what grab cuts going to
allow you to do is basically
grab the grab and cut a certain region
basically so anyway cv to grab cut
capital C there's camp casing image mass
and rect background model foreground
model will work with five there and then
C v2 dot G C scrap cut in it with ret
then we're going to have mask two is
going to be equal to NP wherever it is
the case that the mask equals to or the
mask equals 0 and then 0 1 and then as
type un Tate okay and what's happening
here is this either 0 or 2 that's where
the mass 2 is the other options would be
1 in 3 basically then we're going to say
the image now is equal the image times
the mask 2 and then some fancy slicing
going on here : comma colon comma n P
dot new axes and then we will do P LTM
show image
PLT color bar and then p LT dot show
this will just show like a color range
for us this will actually show the image
and what we should get is basically just
my head and the front here correct so
the crux of this obviously there's a lot
of stuff going on here
and the in the original image again was
this image okay so so we we extracted
the head in theory we could start like a
video feed and constantly do this but
obviously we know we slice some of my
hair off here and stuff like that
so it's not exactly perfect but it is
pretty good at detecting the foreground
in the background and what would happen
basically on any image you can use all
of this code is just something you would
keep pretty much identical right the
only difference that you need to make is
in this rectangle so what if we made the
rectangle um let's see we've got a about
300 by 500 image here or well 500 wide
300 tall so what if we said um I'm
trying to think of a good one here uh
zero zero
um let's do the 300 and 300 let's try
that okay okay so so even in this case
you can still kind of get well it's not
really the greatest but generally in the
front you've got this not like the red
is in the front the Blues in the
background you could probably continue
um like the rect let's say 300 500 let's
see if it'll slow and if we bring it in
probably what it would do is remove the
entire background like if we brought it
in a little bit hopefully maybe we did
50 50 300 500 possibly yeah so now we've
got my body right and like my chair that
I'm sitting in there's another chair in
the background and that so even if you
don't have like a perfect cut of like
just a head and you just kind of bring
it in slightly it will probably work
just fine so keep that in mind it's
actually even though it's cut it's grab
cut is kind of a manual process you
could probably take width and height of
your image add 10% to the X the Y and
then go to 10% or go to 90% of the XY
and that would probably be a dynamic way
to kind of automatically just kind of
remove the
background in a sort of green-screen
type fashion
now obviously might not work every
single time but it would probably work
most of the time decently so anyways
that's it with more of a manual
foreground extraction will actually end
up covering another form of foreground
extraction would be a little different
than this one was but we'll talk about
that probably not the next tutorial but
the one after that in the next tutorial
what we're going to be talking about is
corner detection which can be used for a
variety of things for computers for life
re-rendering three-dimensional objects
can be used for tracking motion in a
video and stuff like that so anyways
that's we're going to talk on the next
tutorial if you have questions comments
concerns whatever leave them below
otherwise as always thanks for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>