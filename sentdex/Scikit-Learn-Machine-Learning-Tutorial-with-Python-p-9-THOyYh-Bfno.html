<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Scikit Learn Machine Learning Tutorial with Python p. 9 | Coder Coacher - Coaching Coders</title><meta content="Scikit Learn Machine Learning Tutorial with Python p. 9 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Scikit Learn Machine Learning Tutorial with Python p. 9</b></h2><h5 class="post__date">2014-12-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/THOyYh-Bfno" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to the
9th machine learning with Python and SK
learn tutorial video in this video we'll
just be tuning on the next one inning
and what we're gonna do is we're going
to plot up different or well actually
were going to calculate for difference
and then we use difference to kind of
visualize and show how debt-to-equity
ratio has an effect on a company whether
they underperform or outperform
so with that in mind let's go ahead and
get started we're gonna plot this up
first of all so let's do the following
so first we're gonna do from time import
m'kay time we may not need that actually
but we'll pull up now now we're gonna
import Matt plot lib from Ashley let's
do import Matt plot lib Matt lot live
dot P plots as PL T and then we do from
ash this Duke from Matt plot live import
style and then we're gonna do styled I
use I'm gonna use anything we want I
tend to use GG plot but I'm gonna do
dark background for now dark background
for now everybody who does you know
trading and investing likes to have dark
backgrounds so we use dark background
next we're going to import our e for
regular expressions because we're gonna
need them probably I kind of know
already in advanced so the first thing
we want to do is we're going to come up
to our data frame and just after SP 500
change add a comma and we're add one
more column here and that is going to be
different so again in the future we'll
be able to you know if we had a huge
data set say maybe all of the stocks in
the entire you know stock market of the
United States at the end of the day we
could actually have you know all of this
stuff could be knocked out and maybe
this as well an in theory ticker
well at least on our testing set or not
artistic said I'm sorry are you know
labeling set basically so anyways our
training set moving on ah difference so
we're gonna plot that up and difference
is going to be basically this minus this
and if it's positive that means the
company did good outperformed and if
it's negative the company did not
outperform so now we want to do is we'll
come down to basically let's go to the
very bottom first and we'll just add you
know comma and then we'll just say
difference is equal to stock underscore
P underscore change minus SP 500
underscore P underscore change
let me just code that in right now so
that's our difference now let's say we
wanted to actually you know plot that so
we've got difference there and basically
I'm trying to think about we want this
one tab over so once this entire
operation is complete we can run it
before we do the save
we're going to say the following so
remember we added ticker up here this
ticker list now we're gonna use that
we're gonna say for each underscore
ticker in ticker list what do we want to
do again we're going to use try and
except again I'm going to use it as a
form of logic and kind of a fail-safe to
make sure our program runs sorry
pass on the exception and our tribe will
be very simple it'll be basically we
want to apply it where we're gonna plot
each stock on the graph is kind of our
goal but we can kind of you'll see what
I mean we'll get there so plot
underscore DF equals data frame and then
we've got DF ticker so basically where
the ticker is identical to each
underscore tick
so that we're kind of redefining the
data frame we want to plot with and then
we're going to set the index to be date
just simply because pandas is pretty
good at plotting automatically with
dates so we'll say plot underscore D F
equals plot on our score DF dot set
underscore index and we're gonna set the
index to date and then we can basically
plot this so we're gonna say plot
underscore DF and we basically want to
apply whoops want to plot difference and
then we do dots plots and we plot as
label equals each underscore ticker and
then we'll do PLT dot legend and that
should be it do we not have a oh I guess
we're gonna call PLT up show outside of
that try and accept guilty dot show save
and run that I did 25 there we go okay
so we've got this lovely graph here and
basically this graph shows you know a
bunch of the company performances so the
companies that are up here you know
above the zero mark are successful right
they they beat the market and the
companies that are down here are
unsuccessful they did not beat the
market now this is what I was talking
about first of all we have data that
spans all the way to about 2013 we can
see most of the companies seem to be
making it to about the 2009 mark and
they cut off but we can see Apple here
um and it's serious outperforming stops
at 2006 ish we've got this line whatever
company it is stops here and a company
stopping here as well anyway we're
clearly not getting something here now
there's only a few point of failures and
all of the point of failures pretty much
logically need to link to our you know
example sheets here so here's an example
you know these right because the data
that we're getting from Quan Dell is
normalized data so it's unlikely that
we're missing a poll better so if we're
missing anything we're missing
everything
on that data set but on this day set
it's likely that over the course of a
decade yahoo finance changes something
in their code so here basically we could
we could start you know throwing in you
know trying accepts so for example we
could come up basically to the very very
top here and we're looking for value so
this value here so we could try for
example you throw a try here and we can
throw an exception except except as e
and then we're gonna print the string
version of e will hit at times sleep of
fifteen seconds every time we hit an
exception there all right
so could not convert string to floats so
not available that's okay we don't
really care about that because we were
kind of purposely skipping the non
available ones so let's go ahead and
comment let's comment that out real
quick say if we're getting anything else
here okay right so for the most part it
you know the not available x' are you
know the major thing that we're hitting
but we're also hitting a list index out
of range so what we could do at this
point is we could say you know we're
printing the list indexes out of range
that's fine but then we can take it a
step further we can also print the
ticker
so what ticker is this happening on and
then we can actually print each no print
file okay
so we'll save a run that one more time
and we can ignore some of these other
ones but we can come over here let's
close out the graph and we can see you
know we're accepting the not available
right so there's no data there but then
we can see okay list index out of range
on Apple over two thousand and six and
then we can see it happens basically
that's it for Apple but we're seeing the
exact file that's happening on so we
could pull up you know we could say okay
it's happening on Apple so we could come
you know to our data set here come down
to Apple and we even get we get the
month and all that so the actual file
name so in 2006
looks like February 3rd so we can come
down in 2006 this one right here is
where it's happening and this is
happening on the polling of the debt to
equity ratio right right we're because
we're pulling value as that so so let's
go ahead we look here and we're scroll
down and we see okay well it has you
know total debt to equity and has a
value there it's just the value is 0 so
let's go ahead and copy total debt to
equity view the source find and we come
here and we see okay there it is there's
our value and immediately I I know that
before this was one big jumbled mess now
it appears they've cleaned it up so let
me scroll in a little bit for you guys
and we see that actually what we have
here is you know in our code we're
saying that the value is found at gather
so the name that we were you know debt
to equity mrq and then we were finding
that also within after that it was slash
data table ball table data one okay that
looks right so like right here basically
we've got total debt to equity so gather
and then we had slash table data and
then we have new bit of table data right
and what we're seeing though in the
source code here is that after slash
table data it's on to a new line whereas
in the previous data it was not like
that so we could look here for example
source code this isn't the same one but
you can see they don't they don't start
a new line there they've been adding new
lines in this code and that's kind of
problematic for us and that's what's
that's what's causing our problem in
this case so what could we do well if if
this fails right so if try value equals
you know this well we can run an
exception we can still save exception is
e
but will not print anything and now will
say value is almost identical to this
one we'll copy that will come out here
and we'll paste and we'll say it's
basically the same thing the only
difference is after this slash table
beta before the new table data some
coder decided he wanted to clean up the
code so he added a bunch of new lines
congratulations
so now it says it's got a new line to it
and and that's it so that's that's where
that has changed so we can save that and
now we can run this really quick wait
for it and we can see here that you know
some of the data has got longer we
solved this yellow line that's stopping
and really this one it's stopping as
well I guess yeah we're still having
something yelling at us there let's add
this time sleep Wow well that's gonna
hit us on the non availables as well
right okay so basically I ran that to
prove though that we're not failing at
this point so this is at least hopefully
not I suppose this failed right here we
would have a problem so actually this is
hitting something else now anyway moving
moving on from that we do know that this
was causing a problem so we'll leave
that for now with that new line added to
it and now what we want to do is we're
gonna come down to stock price so that's
this right here so on the next question
so because we know in the sp500 stuff it
can't be happening or we're pretty
confident it's not happening there so
then we could come down here to stock
price and we're gonna add a try and
accept here as well so let's add a try
tab this over accept and then exception
e and then heck we can even well I guess
yeah
and that's Python 2.7
as and then we print stringy then we'll
print ticker then we'll print file I
think yes okay
save and run that ah we should have had
a sleep yeah anyway first of all you can
see one that has helped us and long gate
all of these lines but we are missing
difference right so I hope this pass a
few a few of our problems and come on to
another one
you know another you know stock price
for example so we know we're on the
right track and we can see here that
what's what's occurring is this
exception here that we're throwing and
it says that we have this basically
remaining data or X if you recall we
split the data so we're splitting data
and we can see that this this has
occurred on the stock name of a EP as an
example so so we get and that's
happening like a all across the board on
all of these and the other thing that we
can see right out of the gate is it's a
little bit different for each stock
right this this is right here is custom
right so a es corresponds to a es and a
FL corresponds to a FL it's kind of a
problem if we're gonna be using
splitting so let's go ahead and copy
that example though and we'll come over
here and we know now that we need a
problem is this this little bit of code
here and this is why we're going to be
using regular expressions so so now we
try stock price equals this okay and we
know right away that's gonna that fails
because we're trying to convert it to a
float where we absolutely cannot convert
that to a float so if that fails we'll
come down here and we'll say okay that's
fine we're now going to say stock price
does not equal float which is equals you
know this for now and then we're gonna
go ahead and say okay well instead now
stock price equals stock underscore
price and we're gonna say start price
now equals research and we're gonna
search with the regular expression
basically we're just going to search for
numbers right so so we search for
/d for a digit and we want any amount of
digits one in length to let's say I
don't know eight in length so in theory
like Berkshire a could be here although
bursar a would be no bursar a would know
cuz we have if it does you know this
would be fine anyways moving on so digit
1 to 8 and then we might have a period
and a period is a regular expression so
you have to backsplash to escape it so a
period followed by a digits and again
really it's probably one of four
actually is probably one to two but
we'll have one to eight just in case
they ever decide to do you know some
sort of massive decimals although nobody
goes past four for US dollars anyway is
read a search so we're searching the
stock price as this regular expression
and we're hoping this will X you know
spit out a stock price and then the
stock price stock underscore price shall
equal the floats version of stock
underscore price group and we want one
now let's go ahead and print stock price
let's have a quick time dot sweet fifty
just to see hopefully we'll get
something spat out at us at some point
apparently not Oh in it in it graph for
us let's see uh what where we have gone
run let's try it one more try except I
suppose paste
I accept exception as he ring string e
and time to sleep Victor let's see what
we get there
oh okay so yeah right right we resort
reason is regular expression to search
for something but you have to say like
where are you searching for that and
we're searching for that within stock
price let's try one more time okay so
you can see it found a stock price
wonderful so we're gonna leave this
exception here there's actually one more
exception in theory that we could hit
because eventually Yahoo moved to a
real-time ticker so we have to handle
for that but this should actually do for
now although we will eventually hit an
error I'm not seeing us hitting that
error but they do move to it and anyway
we've now hit you know much larger set
here we can see that indeed our data you
know is kind of you know sporadic but it
is getting plots all the way now to 2013
and Apple for the massive out
performance okay so cool stop pros I'm
actually kind of surprised we haven't
hit the other exception here I guess it
really doesn't matter because we're
searching for that price within it but I
don't think it's under these anyway I'm
almost positive that we should hit a hit
one of these exceptions later I'll leave
the exception there so when we hit it we
know we've hit it and we'll just leave
that for now so now all we have let me
see if there's anything else I wanted to
cover before we move on because it's
kind of one of the bonuses to being able
to visualize your data set is you can
kind of see where you've gone wrong it's
really easy or as the computer is a
little worse at realize
that something is wrong Oh apparently
maybe this is us hitting one of that
error one of those errors well are you
here it is but we ran it already once
and we didn't hit the error I don't
understand
surprise let's travel over time right
listen index out of range okay so we did
have to hit that other error
that's so weird I swear we coated this
and then we ran and we didn't hit there
uh okay so now we have a final trine
except basically which is right here so
we're hitting this exception and now we
want to have basically one more so this
is what I mean I sometimes use try and
accept as logic I don't care how you're
gonna go about gathering your data it's
generally gonna be an ugly mess if your
data set is an ugly mess it's gonna be
an ugly mess you know compiling
everything let's go ahead and compile
this stuff real quick
and so we're hitting this error this is
our final error and they've moved to a
real-time ticker most likely boat well
here's what we can do we can go ahead
and we can print stock price string e
ticker file let's let's run that out
really quick so we can get an example
file here so we've got a in 2013 come
over here key stats a it's 2013 Oh 5:14
so basically this one will come over
here scroll on down till we find what
looks to be a stock price this looks to
be the stock price copy you find paste
and indeed our issue here is we're
hitting this new you know time real-time
ticker and then we're coming into the
stock price
so we need to account for that so let me
minimize this close this and here so now
we've hit this exception and we will do
the following let's just say stop price
equals let's take this one it here so
we'll copy this copy come down here
paste and now stock price can't equal
the float of that so delete that and
then now we want to search for this
real-time ticker nonsense
so coming over here it's kind of hard to
see in the video I'm sure but basically
we're going to grab this right here so
the span class equals time real I assume
RT and then I don't like Q stands for
but it's probably a real time ticker of
some sort so we copy that come over here
we're gonna say it's on the left hand
side of this now and then on the other
side of that is just a span like a
closing span tag so let's just add a
closing span tag there oops span now we
print stock price equals let's come down
here now okay uh now we can run the
exact same regular expression on the
code that we did before so that was like
right here right so so we run this so
copy that code come down here paste that
code print latest so let's face it our
latest exception we saw this sleep here
so we'll see that this code hopefully
has worked let's do it let's run that
right so for example we got so this is
running on an exception just for the
record and we knew that this except when
the control see real quick
we knew this exception before was
pulling coming on this exact file right
here so we're still printing out the
exception that was
but just understand that we're looking
at you know the solution to that
exception but that was the exception
that was the price we were trying to
hunt for and that is indeed the price it
found so now we can come over here let's
go ahead and you know comment out some
of these prints and sleep now let's go
ahead and save and run that man this
video is getting long sorry guys
so we do still have some listed index
out of range though that list index out
of range is mm the probably for them not
available anyway so we look at our data
now and let me make this big here and
basically you know we should have you
know some data basically every year so
let's go ahead and look at this real
quick so it looks like you've got a few
data sets but looks like we're kind of
coming through the year basically 2009
to 2011 without any major plots
happening there but that might be the
the not available stuff
let me check really quick before we move
on right I'm aware of the list index
being out of range thank you good sirs I
just want to make sure it's not so it
could be this list index out of range or
something well that's not gonna be that
one so the only other thing we could
have a list index out of range on is
this right here I suppose this could
come out of range in fact let's see if
that's what's happening before we go any
further these are the most this is
probably the most embedded try and
except I've ever had try except
exception as the range that to let us
know which one we're on file take let's
run that okay so we're not hitting an
exception anymore on stock price are we
pretty exception anywhere else like
maybe we're printing it right we are
printing it here but this is for value
and it might be the case we just don't
have a value but let's go ahead and hit
it time sleep 15 right okay so we are
hitting an exception on the acquisition
of this data let's go ahead and look at
this data really quick so for example we
have at an apple from the year 2006 so
let me pull that up check that out Apple
2006 Oh 203 okay and that's happening on
the debt to equity ratio
which in theory we should be hitting so
let's go ahead and debt to equity Mr Q
so basically right here is where we
should be hitting that data we should be
getting a zero there and we're not
that's in 2006 okay so let's look at
this really quick right so it says I
think this is width that's throwing us
for a loop here but that might because I
resumed in actually means Umair okay
well why would that that shouldn't
matter dad yeah so 75% this video is
running too long I'm not thinking
straight
so we could add a width 75% to handle
that we could also add or use a regular
expression here and can't believe this
is hitting us now so okay so except so
let's listen case this innatron except
real quick so try that and then tab this
over try that except let's just copy
paste
and then now we've got so we had gather
oh wait you know what oh man
I am totally just tripping out now so
that was never a problem so we had
debt-to-equity and then it was to this
table column basically so total debt to
equity colon slash table data new line
and then it came to be this data right
here and I see no difference there so
one split and then it ends on table data
so I'm not quite sure why it's missing
this data actually
okay so now we're hitting it on a
different file maybe it o is just
hitting that exception it's totally
possible and just this is getting too
long and my brain is dying on me
so skokie stats a 2009 Oh 802
I'm hoping this just says not available
but I don't think it would
debt-to-equity well at least this one's
is not available
AAA in 2009 o3
check that one okay again debt-to-equity
is not available there
let's check Apple and then I'll call
that a day he's dead Apple 2007 Oh to a
nine and again not available so okay um
okay I think I'm content now with these
numbers and for now I guess we'll just
leave this here we'll stop we'll just
add this as a pass and this okay so
anyways that's it with this one in the
next video we'll be talking about
plotting up difference and kind of
moving into actually training on this
data and actually running some machine
learning on this data so anyways that's
it for this video if you have any
questions or comments please feel free
to leave them below otherwise as always
thanks for watching things for all the
support of subscriptions and it's he'll
next up</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>