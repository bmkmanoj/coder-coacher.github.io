<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to do Automated Bitcoin Algo Trading via BTC-e Trade API | Coder Coacher - Coaching Coders</title><meta content="How to do Automated Bitcoin Algo Trading via BTC-e Trade API - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to do Automated Bitcoin Algo Trading via BTC-e Trade API</b></h2><h5 class="post__date">2014-05-06</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/iXGnNPL89Wo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">you
what is going on everybody welcome to
another Python tutorial covering how to
utilize the trade api's on Bitcoin
exchanges to trade Bitcoin this tutorial
is going to cover btc-e specifically but
the idea of working with a trade API is
really the same across all exchanges for
the most part there are some subtle
differences but for the most part
they're all identical this tutorial is
just going to cover communication with
the API and show automated trade
execution as an example I don't intend
to go into any sort of trading logic or
anything like that I don't want to
cannibalize my own trading fund that I
run so we're just going to be
communicating with the API here so with
btc-e to learn more about the API what
you're going to want to do is you need
to visit btc-e comm and this is pretty
much what it looks like if you don't
have an account already sign up when
you're done signing up login and then
check your email and validate your
account you just need to be logged in
whenever you go to validate it so
whenever you get into btc-e anyway
scroll down to the very bottom there's
Trade API click on that and this is
their documentation for their trade API
the documentation isn't like spectacular
but it does the job it tells you exactly
like what the parameters are here so
you've got transaction history trade
industry order list all this kind of
stuff execute a trade cancel order and
so on so you have everything here that
you need to do and they even have
examples here in Python there's Java see
all that so you can check those out too
if you're confused also just leave a
comment below if you don't get something
or if you had a question that's fine too
now I just want to say that I'm not
doing this tutorial to endorse btc-e in
any way they could easily run off
tomorrow with your money btc-e just
happens to be one of the easiest api's
to work with and it has no limitations
that i've found anyway and creating an
account with btc-e is extremely simple
it takes like 30 seconds so anybody can
do it so that just makes it a lot nicer
to use also another warning is trading
Bitcoin on btc-e is the real deal and
carries obvious risks so there's very
low barrier to entry here you just need
some Bitcoin which you can buy or you
need to transfer some dollars or
something and buy some Bitcoin but
there's almost no barrier to entry and
so this can kind of catch people
off-guard I mean we are trading real
money here so you kind of want to be
careful about this kind of stuff right
and there are places like cripsy and
coin MKT where you can try to fake
Bitcoin and even like coin MKT and
cripsy they both have an API that you
can work with like automated trading
strategies as well and trade fake
bitcoins so definitely think about that
before you go trading real Bitcoin so
anyway this video is here purely for
educational purposes what you choose to
do with it actually is going to be your
choice do not blame me for losing your
money it will only be your fault and
don't continue watching if you don't
think it's your fault so anyway first
like I said we're going to need a btc-e
account once you have an account the
first thing that you should do is go
over to profile come down here to
security and create a key and this is
going to set up a two-factor
authentication for you what that is
going to do is protect your account from
somebody getting your account
information and taking your Bitcoin
there's no recovery so this is again
there's low barrier to entry with
Bitcoin but also Bitcoin is not
necessarily anonymous but it's
pseudonymous and I've not heard of a
single case if anybody recovering lost a
Bitcoin
due to theft so keep that in mind and
you should definitely set up two-factor
authentication if you're in from if all
your Bitcoin is just like one username
and password away that's a really bad
idea for the purpose of this tutorial
I'm actually not going to set up a key
simply because this is just a throwaway
account by the time you're viewing this
video this account will be cleaned out
anyways so that's that also to factor
auth is not going to slow you down with
the trade API nor does the trade API
inherently put you out any more risk
through the API you can only execute
trades you can't make it withdrawal so
somebody can't just take all your
Bitcoin but what they can do is they can
make trades within the current margin at
the time and slowly siphon money out of
your account there
no API call limit on btc-e so you can
make thousands of these trades a minute
and someone could wipe out your account
that way so for that reason it is pretty
important to still protect your API
information just is slightly harder for
somebody to steal your funds once you've
done that you're ready to start training
so to trade you're going to want to come
down here to the API key and go ahead
and click that and when you get there
you'll probably see something like this
you have no API keys so what we want to
do is actually make an API key so we'll
come down here I'm going to call mine
tutorial doesn't really matter hit
create you've got an API key now right
now the API key is worthless it's not
going to do anything for you you need to
check both of these boxes info and trade
and then go ahead hit save and if at any
point you're done with your API or
you're not going to use it I highly
suggest you uncheck these and hit save
or hit disable and that will basically
delete your key a so the key can't even
be used anymore
this way someone cannot do what I was
just explaining before where they just
do margin sales back and forth forfeit
the point two percent and steal all your
money that way so keep that in mind and
once we have the key in the secret now
we're ready to start creating our
program so head over to Python I'm going
to be coding this in two seven I'll try
to explain some of the key differences
between this and Python 3 but you might
have to do further porting so the first
thing that we want is we need HTTP Lib
so we're going to import HTTP live and
if you're on Python 3 that's going to be
HTTP client and if you wanted to
continue following along it would you
would do HTTP client as HTTP HTTP Lib
that was a mouthful next we want to
import URL Lib then we're going to
import JSON because everything that's
reported back to us is in JSON format so
we can break it up like that a lot
easier next we want to import hash live
because we are going to be encrypting
some of this stuff now we want to import
a CH Mac to work with hash Lib and then
finally we want to import time this one
is not as necessary but uh
the reason we're going to import time is
we're going to use the current timestamp
as a notes I'll explain that in just a
minute when we get to
so now once we've got that we're just
going to declare a couple variables here
and that's going to be API key equals
something and API secret equals
something now we want to come over here
and let's just copy and paste these two
things so copy paste and copy paste good
so now we've got the API key and the API
secret all set so from there we're
pretty much done here I'll just come
over to finances
the only thing we're going to use this
account now for is just to actually
visually see that our trades have been
done so as you can see currently I've
got zero point zero zero three four
dollars and almost three Bitcoin in this
account so we'll come back to him later
now we're ready to start coding so first
I say we just code something real basic
and we're just going to make a trade
function so this function is basically
going to be used any time we want to
execute a trade where an I call the
trade function and we'll pass the
parameters that we want to pass so first
let's go ahead and defined trade and
then we're going to have some parameters
for the function well it'd be kind of
wise for these parameters to be pretty
much the parameters that we feed the
btc-e through the API so if we come back
over to btc-e scroll down hit trade API
scroll down to trade we can see these
are the parameters right here that we
have to feed we've got pair and that's
going to be what are you trading like
BTC USD litecoin a Bitcoin and so on
then you've got type that's going to be
a buyer a sell rate is at what rate do
you want to buy or sell bitcoins so
let's say you want to sell point five
Bitcoin you don't sell point five
Bitcoin times the current rate let's say
the current rate was 500 dollars per
Bitcoin you want it put 250 here if you
were trying to sell 0.5 Bitcoin you
would put 500 there that's the that's
the rate at which you want to sell your
Bitcoin and then amount is how many
Bitcoin do you want to sell so for the
parameters the only thing I'm going to
hard-code is going to be the pair I
don't really see I'm not trading
anything else myself if you're thinking
you might want to trade other things you
could leave that as a parameter to the
function but I'm not going to add that
so we just want to
type rate and amount so coming back over
to our code trade we're going to have
basically do we want this to be a buy or
a sell so I'm going to denote that as
Bors like that like B or s then we're
going to have X rate so that's the the
transfer rate like are they the
transaction rate that we want so we want
to sell point five Bitcoin at five
hundred thirty each so five thirty would
go here next how much so hm4 how much
Bitcoin do we want to sell and that's it
so now we need to get to the next thing
so if we come back over to the API and
scroll to the top we can see what's
required when we send in our HTTP
headers and that's going to be a key and
assign or signature really is what it is
but there is they call it sign and then
we can also see here where we access the
trade API so it's through HTTP BTC
e-comm tapi so trade API or tappy
whatever you want to call it so when you
send it information you're sending it in
via post everything is being sent in via
post even when you're getting
information like get info you're still
posting information you're and then you
receive it back you get a server
response in JSON but everything you're
posting so uh so that's that and we need
to pack that into the header no problem
and the only thing that we have left to
consider here is I'm looking for where
it's going to say known so I don't say C
nonsense because we'll do a search there
we go all requests must include a
special notes if you don't know what a
notes is basically a notes is a unique
usually number but it can be anything
like so it just has to be something
unique so generally what people do is
they have an incrementing notes so they
send in a one then a two then a 3 then a
four and then just keep adding one to
what they send in and here we can see
that it must be greater than zero and
that's it
so what a lot of people will do is use
the Tynes timestamp so they'll just
print out the timestamp usually a
timestamp goes up maybe two so decimals
people do the timestamp times 100 but
the problem is btc-e won't recognize a
number greater than two point one four
seven billion so that becomes an issue
so either you can operate with a text
file and just add one to it or something
or you can do it I'm going to do here
and then it allow us to make up to say
ten trades a second if you wanted to
make more you could do that as well and
this method will allow us this will work
for the next almost decade like seven
and a half years or something so notes
is going to be first of all we want time
time and time that time just prints out
the UNIX timestamp okay
so just just for kicks in just in case
just so everyone understands what I'm
doing I'll first write it out here so
first we're going to have and I'll start
with print so time that time is going to
print a timestamp so when we save and
run this we get the current timestamp
one three nine eight blah blah blah blah
so now our problem is this number is too
big if we multiply it by 100 but if we
take away uh you know these first few
starting numbers it'll be just fine for
us to multiply it by 100 and then we can
make trades you know ten trades a second
and be okay so what can we do well we
can just subtract so time that time -
something like one three nine eight six
- one two three
so four ones okay so now when we print
time time we get a much smaller number
right we get twelve thousand and then a
long decimal no problem so the next
thing that we'd want to do for this is
we want to round this so let's round it
off and we're going to round it off to
one decimal place and then let's
multiply it by ten so hopefully that'll
give us what we're looking for okay so
now it gives us a whole number although
it's still giving us the decimal so the
final thing that we'll do is convert it
to int now in Python three that won't
work as well for you you'll want to
shave off that decimal some other way
but anyway now we have a full int
perfect it's giving us a much smaller
number to work with so that's good so
right now we're at 126 but like say we
did this and then we sleep let's say
time sleep for half a second and then we
needed a new notes and we run this
you'll see that we do we get a new notes
right half a second was equal to five
here so anyway that's our notes if you
don't understand it feel free to ask
below
but hopefully that's clear enough for
everybody to understand why we're doing
this the way we're doing it so notes is
going to equal that now the only thing
we want to do is we'll put this in our
function however hey wow it's not here
anymore
there we go thank goodness for ctrl Z
there we go okay so the first thing we
define is the notes so the next thing
that we want to do is we need to set up
our parameters that we're going to pack
into our header so to do that we're
going to call it parms and that's going
to equal these curly braces and since
this is a trade the method that we want
to use is going to be trade okay now if
it was something else you would say say
you wanted to get info method would be
get info okay so that's kind of how you
can do the rest of these so I'm just
going to show trade for example but you
can use this exact same code pretty much
for all of the methods that you can use
or commands that you can use so method
is that pair like I said this is going
to be BTC USD or whatever like I said
I'm just gonna hard-coded in there we're
not gonna I'm not gonna have it
trading like litecoin or anything like
that so that's what I'm just gonna hard
code that in but if you were thinking
we're gonna trade other things besides
just the Bitcoin USD ratio you might
want to throw in you know a pair pair
into your parameters but I don't
so anyway pair is going to be BTC USD
then we're going to have a type and if
you recall type as either is it a buy or
a sell so that's easy we're going to use
our buy or s then what do we have we
have rate so what at what rate do we
want to buy or sell at so that's going
to be X rate or transaction right and
then we have the amount so amount an
amount corresponds to hm4 how much and
then finally we have to send in our
notes so nonce
no it's no problem okay so that's our
parameters real simple stuff so now what
we need to do is we want to encode this
to our URL so we're going to say parms
equals URL Lib URL live die
URL encode parms
like that then we'll come down make some
more space and for Python 3 that would
be URL Lib dot parse dot URL in code
next what we need to do is we want to
create a new H Mac of this and if you
don't know what an H Mac is H Mac is
like it's just the name for the result
of a hash function used with a message
plus a secret key so firstly we'll call
its hash I guess hash equals H Mac dot
new and what are we going to use well
we're going to use our API secret plus
what and that's going to be or how are
we going to have sorry how are we going
to hash our API secret right because we
don't want to actually like our API
secret it's like your private key you
don't want to transmit your private key
you only want to transmit your public
key and if you're going to transmit your
private key it needs to be encrypted so
API secret is going to be digest mod
equals hash Lib dot sha-512 serene music
ah 512 to hash our API secret and then
we're going to use hash update and we're
to update with farms and now we're going
to make our signature and that's going
to be equal to hash hex digest done now
what we need to do is we have to
actually create the headers and if you
recall you have to send in just you know
your typical header and then we also
needed to add a key element to it and
assign element to it so first headers
equals and oops those curly braces here
and first we want the content - type
content type that's going to be just the
default content-type so application /xw
form - URL encoded and then comma come
down here now key key is going to be the
API key and then pay attention that's
the public key right that's the that's
the one that we don't need to do any you
know funny business with and then if it
loops forgot my comma comma and then we
want to add our signature and BCE asks
that we call it sign and we're going to
sign it with our signature and that's it
with our headers now we're ready to
actually establish a connection so con
for connection equals HTTP Lib HTTP
connection and who do we want to make
this secure connection with well we
obviously want to connect with btc-e
comm now come down here and we'll do con
dot request and are we going to make a
post or a get request well we're going
to make a post as we know and after that
are basically what do we where are we
posting to so we've already got BTC comm
so what comes after that what was tapi
for trade api and then we're going to
post our parms headers and now we're
done so that makes the request so we
through this we could run this and it
would actually execute a trade for us so
just as a quick example I can say trade
and we want to do a sell how many let's
see what was it sell x-ray and then how
much so let's say right now bitcoins
like 420 or something so let's say we
want to sell 300 just to get a quick
sell actually let's try it sell for 700
600 so we don't actually get a sell 600
and then how much should we want to sell
we'll just sell 0.01 the minimum to sell
just as a quick aside to when you're
working with btc-e and some of the other
exchanges if you wanted to sell point
zero one you can't send in like this you
have to put the zero in front of the
decimal
although
is it's going to give you an error and
it's really annoying so now let's go
ahead and save and run this we'll see if
we have any errors and we didn't get any
errors so we assumed that it worked
let's check btc-e and see if it worked
out for us so let me get rid of notes
there there we go hit refresh and well
let's go to finance trade history we've
got a few sit in a way that's trade
history my bad ok so we've got nothing
sitting in our order history so we're
not quite sure what is going on so the
next thing that we want to do is we
actually want to pull some information
from this because for whatever reason
this didn't go through probably a typo
somewhere but I guess we'll find out so
the next thing that we want to do is we
want to what's going to happen when we
make this request we're going to get a
response back from the server we're
going to get to respond well to things
from the response that we care about one
did we actually make a connection is the
API online and then to what was the
information that the API fed to us so
we're going to say response the equals
con get response and then we want a
print and we want to print it response
response dot status and then response
dot reason so status is going to give us
I forget which or which one it is I
think I think it'll be ok 200 so status
is OK response will be at 200 I think
but I might I might have that in reverse
but basically ok 200 means you made a
good connection and you got you know
code 200 meaning you did good now the
next thing that we want is we also have
um the information fed back to us the
JSON that gets fed back to us so we're
going to say RESP equals JSON load
response and we'll go ahead and print
the full response so we'll save that and
let's run it again and this is giving us
an as if we are successfully making this
trade
which is interesting I swear the last
one failed on us huh well this one is
showing up I'm not quite sure
maybe the API was down for a second or
not sure that's why you want to get the
response back because what you can do
from here is he like this returns a
bunch of information to us one it
returns indeed the 200 and okay so we
made the connection if it doesn't return
a 200 okay you'd want to have some sort
of fallback in your script that handles
this right because if you thought you
executed a trade you need to know did it
actually execute or not so that's why
you want to take that back and then also
you get a return and you get basically
what happened already
so remains with your offer we still have
0.0 and left we've received nothing we
have order ID that's pretty important
and then after that it tells us
information about our account so we get
information on how many funds we have
how much Bitcoin we have and everything
else although we have really nothing and
then finally at the bottom of this we
have success you know zero or one or
like zero false one true so now what I
want to show you guys is at least an
example on how how might you pull one
bit of data out of here like you might
want to know okay what was the order ID
so later on you could maybe cancel the
order or whatever so let's say you want
to know what the order ID was so let's
move this stuff out of the way go over
here and instead of printing this up
here okay so we print response now what
we could do is we could say something
like order ID equals RESP and because of
the JSON module we're going to say rasp
and then what would be the first element
that we'd want to consider will that be
returned you can ignore the the this
right here the Unicode so return and
then after return well we only have one
more degree here that's going to be
order ID and then so only to return your
order ID it'll spit out the order ID for
us or it should so we come down here
order ID equals response
returned and then we want order
underscore ID and then we can print
order ID like that we can save it run it
and we bring this down and now you can
see it printed out the order ID for us
right so that that number is this number
here okay so you could also have it
print out you know you could do return
funds USD so we could say instead of
order ID let's just copy-paste USD
return funds oops
USD like that and make sure that's
exactly what it says okay so and then
instead of pro ready print USD save and
run it and sure enough it prints out how
much you know dollars that we have after
we execute this trade okay so that's it
that's all you have to do to work with
the trade api's they're extremely simple
to use but again I will just forewarn
you that even though they're very simple
you it's the real deal and you can lose
money with this stuff also again I don't
necessarily endorse BTC e-comm of the
Bitcoin exchanges okay you know it's
it's been around for a while but really
all these Bitcoin exchanges are pretty
shaky in my in my opinion so anyway I
play with this stuff at your own risk I
just wanted to show you guys got a lot
of requests for something like this so
anyways if you have any questions or
comments feel free to leave those below
hopefully you guys enjoy it as always
thanks for watching thanks for all the
support in the subscriptions and until
next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>