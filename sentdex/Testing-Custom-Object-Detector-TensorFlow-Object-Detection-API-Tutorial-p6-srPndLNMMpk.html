<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Testing Custom Object Detector - TensorFlow Object Detection API Tutorial p.6 | Coder Coacher - Coaching Coders</title><meta content="Testing Custom Object Detector - TensorFlow Object Detection API Tutorial p.6 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Testing Custom Object Detector - TensorFlow Object Detection API Tutorial p.6</b></h2><h5 class="post__date">2017-08-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/srPndLNMMpk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody welcome to
part 6 of the tensor flow object
detection API and tracking a custom
object tutorial in this tutorial we are
going to export the inference graph and
also just test it and see how good do we
do this is actually the second time I'm
recording this first time it was
storming outside and I just didn't want
you guys to be scared of like the
tornado and when the cow came through
and stuff like that so anyway it's gonna
rerecord it and so some of this stuff
might be already done but the stuff that
matters hopefully oh I'll still go
through step by step so this was the
ending graph and let me just make it
bigger so as you can see I mean it
pretty much came down to you know one
really quick like within like 2000 ish
steps it was down to a loss of about one
or under and going to relative here you
can see here it took the whole thing was
about two hours but really even before
the first hour it kind of settled that
one so you probably could have stopped
there but even after that point like
really zoom out it's still slowly going
down it's just the bulk of the learning
just simply is done at this point so
anyway it's arguable whether or not we
would really need to needed to have
trained especially like this last like
half hour like probably not
so anyways actually a lot less training
time that I initially quoted I was
required but nonetheless and especially
steps rather because way less steps were
required anyway let's go ahead and see
how we did so normally once you have a
model that's already trained you just
load in that model via the check point
you do a dot predict and you're done but
not in this case so so what you have to
do is export the inference graph and
then you use that to to do the object
detection and and we're just going to do
it via the notebook basically that came
with the API so to export it we just
need a checkpoint file it'll load it in
and it loaded and then we can save the
the frozen inference graphs so what I'm
going to do is
we'll just minimize this for now because
I already know I'm gonna have to re
export that that path but anyway so so
the way that we're gonna we're gonna use
this script this export inference graft
up PI script I'm gonna go ahead and just
open it up just to show you plus it has
I think some pre-written
example for calling this script and it
does so right here so we're gonna just
I'm just going to copy this and then I'm
gonna go file new and that's the under
the example usage that should be pretty
clear on the video actually so now I'm
going to do is just kind of modify this
so first of all should be Python 3
export inference graph PI I really I'm
not sure why the dot PI isn't there
under what circumstance would that work
just without the dot PI someone let me
know if that's just a typo on their
behalf er there's a scenario where that
would ever work anyway input type image'
tensor that stays the same the path to
the the configuration file that would be
I think it was in training so it should
be training and then slash this config
I'm just gonna click rename here just so
I can copy it there and then change this
to training and then trained checkpoint
prefix path to model this or trained
model so again this would be in training
training and then model that checkpoint
and then it'll have like a dash in a
number and it would be that you know
based on the number of steps so in our
case the latest one is sixty eight
seventy five make sure that you have all
three so if you like cut the training
while it was saving it might have only
saved like one or two of these files
make sure you have all three otherwise
you're not gonna it's gonna give you an
error if you don't have all three just
go the next one down but I have all
three sixty eight seven five so six
eight seven five and then output
directory just where do we want to
export this so I'm just going to export
it to Mac
and she's graph so just make a new
directory it will you don't have to so
it'll just make a new directory and
it'll throw our inference graph in there
all right so we're ready to run this but
I already know that I'm gonna get an
error but I'm gonna go ahead and hit
that error just because you guys might
hit it too so okay we'll just start a
new terminal change directory desktop
models object then we're gonna go ahead
and just run this but like I said we're
gonna hit in here and before we don't
hit in here right so it's just this no
module names and that's nonsense so what
we need to do is go ahead and export so
you can come to this the you know the
tensorflow slash models come on down to
object detection installation it might
have actually been able to type this out
faster than this come on and we need to
export this path again probably should
just save it to profile but whatever
last time guys last time all right let's
export that inference graph this time
for real wait what
oh we were in the wrong directory okay
so we need to execute this and from the
models directory now change directory
back into object detection up up up
rerun that command now three times a
charm here we go
come on okay so it's gonna load up
tensorflow
kind of make the graph and then save the
graph basically so great done so now
that that's done we can check make sure
it went there but hopefully it did so
object detection we love mac and cheese
inference graph boom there it is we've
got some new checkpoint information if
we want to load from this point now but
basically we really want this frozen
inference graph dot PD file all right
from this point what we want to do is
let's go ahead and run the object
detection tutorial open Naboo so let's
go ahead and we don't need to have
tensor board anymore do the other one
where's the other one give me this yeah
cool Jupiter notebook and we're gonna
load up this one the object detection
tutorial and we're gonna make some
slight changes so first of all coming
down to variables the model name has
changed it is no longer this it's going
to be basically the directory that
contains that inference graph so
mac-and-cheese graph so I'm just gonna
hit rename here just copy it boom we're
going to just delete this line because
it's no longer necessary we're also
gonna delete this line no longer
necessary and this line stays the same
now because that file was indeed saved
let me confirm but as frozen inference
graph yes correct
and then path to labels these are our
actual labels that it's gonna it's gonna
annotate on the actual image in our case
I don't think it was in data I'm pretty
sure it was in training
that's probably my mistake just but let
me make sure it doesn't really matter
but I probably should have put it in
data just to be consistent but anyway
it's in training slash object -
detection so we'll change that you
actually probably wouldn't need to do
that you could have left it here it
would just label them as people I think
I'm not sure anyway
object - detection
it's just basically what what's the
label name though anyway none classes
one download model we're not we don't
need to download any models so I'm just
gonna delete all of that and then it
load in the graph everything stays the
same and then the only other change I'm
gonna make is down here in this like
image paths because right now it's gonna
load up the image of like the the two
dogs and the beach so instead what I'm
going to go ahead and do is we're gonna
go from three to seven now this is
something I didn't revert so I'm just
gonna bring up what I did so in this
test images directory before you just
have image one oops anyway yeah of this
dog and the beach so what I did is I
added in some more images so images
three four five six and I didn't I guess
I didn't rename this one anyway I'll
rename this from image seven so I
grabbed these images and just copied
them from the where are you there we go
images images and then test ok so these
ones shouldn't have been fit against so
I just grabbed some of them from our
testing data and just copied them in and
then just renamed them and since I found
that extra one I'm actually gonna
arrange this to eight and at this point
we should be ready to test this thing so
let's go ahead and sell and then run all
and then let's scroll up see if we hit
any errors along the way looking good
looking good looking good
detection know why that one took so long
just to load in the image just for image
pads that's weird anyway okay here are
our detection so as you can see we
detect some macaroni there some accurate
well I'm sorry macaroni and cheese there
and we just have some mac and cheese
there and then we detect some mac and
cheese there and then again we detect
some more mac and cheese there so oh and
then some more mac and cheese there
alright so that's it for creating your
own custom image
your own custom object detection the
only thing I'm slightly skeptical about
is these percentages 99 99 100 99 did I
possibly make a mistake I might have
made a mistake and I'm pretty sure those
weren't in our data that would be tested
against I mean that would be trained I
just cannot believe that accuracy that's
all
I'm a little skeptical when we have such
high accuracies let's I'm hoping for one
that I didn't take this one doesn't look
familiar but I'm not positive I'm just
kind Carius kind of curious
I really don't know because I tried to
take quite a few of them we could we
could do like a very small image or
something of mac and cheese I don't know
I just don't totally trust when you have
such a huge accuracy but I'm pretty sure
I didn't violate any rules let's go
ahead let's see wow that's a huge one
it's six thousand by four thousand
pixels oh my god Wow I didn't this one's
definitely not in the training data
though so I'm kind of curious like I
kind of want to take this image and it
also has two macaroni and cheeses
listen I'm pretty sure that's not in
there I've seen so much macaroni and
cheese in the last couple days everybody
it's been a lot of mac and cheese I know
one of them had a had two mac and cheese
in him
I think this one's in there.put like it
would just be such a big image I don't
think I took an image that large in my
real actual training data
let's go ahead and save that one we're
gonna save that one into into that
directory see it was on desktop object
detection images oops wrong one
why is there M oh oh we are in the wrong
one models than object detection
just call it a image eight are you doing
this to me it's such a large image but
we'll see I have to resize it but I
don't think so I think we'll get away
with it
so let's actually let's just do like six
to nine hopefully that image isn't too
big we friend
it might be too big no no here we go
look at those tiny boxes oh my gosh so
definitely probably too big I wish I can
see the percentages but it's still
detected those ones even so and I'm
pretty sure this image was not included
in any of the training data like I said
I've seen so much mac and cheese so
anyways I've seen some stuff okay well
anyway I'm gonna go ahead and take that
as victory I just think those
percentages are really high but then
again I mean mac and cheese I suppose is
a relatively easy thing to to detect I
just find those to be skeptical but
anyway that's it let me go let me know
how you guys fare we thought your custom
objects let me know what you guys ended
up doing and all that if you have
questions comments concerns something
isn't working out for you let me know
below otherwise as always thank you for
watching things for all the support
subscriptions and I will see you in
another tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>