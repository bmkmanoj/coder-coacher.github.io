<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Gathering Images for Haar Cascade - OpenCV with Python for Image and Video Analysis 18 | Coder Coacher - Coaching Coders</title><meta content="Gathering Images for Haar Cascade - OpenCV with Python for Image and Video Analysis 18 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Gathering Images for Haar Cascade - OpenCV with Python for Image and Video Analysis 18</b></h2><h5 class="post__date">2016-01-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/z_6fPS5tDNU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to
another open CV with Python tutorial in
this tutorial we're building be building
off the last tutorial where we are
learning how to create our own hard
cascade files which is a pretty big task
to do but we're going to figure it out
so in the last tutorial we set up our
server we're ready to run open CV and
stuff like that but first we need to get
the images so as I was saying before we
need to grab thousands ideally negative
images and even double that of positive
images our goal here we're going to get
about 2,000 negative images we're going
to train against that or we're going to
create samples of positive images based
on those negative images so I have about
2,000 positives and then we'll just
simply training with a thousand of the
negatives so but first we have to get
those negatives so the way that we're
going to do that is we're going to come
back to our script and this is a script
I'm writing on my main computer that has
Python 3 and OpenCV at the time of my
film in this tutorial I could not get
Python 3 and open CV 3.0 to work
correctly on Linux so I'm not doing it
now you can get open CV and Python 2 on
Linux no problem so if you're doing that
just understand that the code I'm
writing here is Python 3 code
the main difference will just be URL Lib
okay I'm going to be using Python 3
version of URL Lib ok so the code is a
little different so just note the
differences so let's go ahead an get
started so what we're going to do is
we're going to import URL Lib request to
make our requests import CV 2 for open
CV import numpy as NP and import OS what
we're going to do is we're going to
write a script these are the two links
will go to this link and this link what
we're going to do is we're going to go
visit this link we're going to split
these URLs by newline basically we're
going to go to the URL download the
image the images are varying size we
need them all to be the same size 100 by
100 so we're going to download the image
open the image and open CV resize the
image and open CV convert it to gray
not necessarily in that order and then
save the image okay
so that's what we're going to do to both
of these links so let's go ahead and
start that code so we're going to define
store raw images and we're going to say
neg images link equals and we'll just
take one of these links as usual this
tutorials link to in the description of
the video
so go to this the tutorial that's linked
in this video and you can get these two
links or find your own these are
negative links therefore you can get
anything except images of watches so
feel free to pick your own links it
really shouldn't matter so we'll go
ahead and if it does matter by the way
all the files that we're going to be
generating by running the script I'll
host on my website so just in case for
whatever reason let's say you don't want
to get a giant server to pull the images
I've got your back but I would not
suggest you just pulled it like the
whole point I hope like if you just want
to download har cascades and just get to
run at core cascades you really can stop
the video you can just download horror
cascades somewhere you just may not be
able to find what you want I assume
everyone following here once actually
learn how to do it so you should follow
along and do it
so anyways copy that link will paste
that one and then we'll do the other one
afterwards then what we're going to say
R is the neg images actually image URLs
megamans URLs equals URL Lib request dot
you were all open so we're going to open
the neg images link then we're going to
read it and decode it because of you
know bytes and then we're going to start
we're going to want to iterate through
these but first we're going to say if
not OS path dot exists neg so if that
path doesn't exist I eat we don't have a
directory called negative let's go ahead
and make it so OS make ders and in the
future if you wanted to convert I'm kind
of like leaving these scripts
open to conversion to include positive
images if you want to do that you can
build off these really easily so just
keep that in mind so if that if that
directory doesn't exist we're going to
make it now we're going to start we're
going to say pick num equals one so
we're going to start saving we're going
to iterate through the pictures and save
them and then we're just going to use
this as a simple counter moving up so
the pictures are named something decent
and then as I told you guys in the
previous video we have to have a
description file that just gives the the
location of all these files so pic num
is one and then we're going to say for I
in neg image URLs dot split by newline
so those are the URLs that we just
visited here you split them by newline
and bam you've got the URL what we want
to do is try something or accept because
a lot of these are going to fail so
accept exception as e and we'll just
print string e but we're going to try
first let's print the link that we're
visiting then we're going to do URL Lib
request URL retrieve this will be
different on Python to retrieve that URL
and then where are we saving that
retrieval to well we're going to save it
to neg / plus the string pick number
pick num plus dot jpg so we're saving
that raw image this is both color and
various sizes for the most part they're
all about 500 wide 300 tall but a lot
but many will be different so we're
saving that raw image now if only we
knew of some way to modify images all
right it's an open CV tutorial so what
we're going to do is where as that image
equals CB - dot M read so I'm going to
read that image that we just saved right
back in read that image and we're going
to read it in as CV - M read dot or M
read underscore grayscale so BAM gray
scaled image now we want to resize that
so remember say resized image and again
we can do this with open CV equals CV
tre sighs what are we resizing the image
to what size 100 by 100
these are negatives if you're pulling
positive images it depends if you're
pulling positive images to later just
use as dupe as things to run with create
samples so increase create samples will
do if you have like one image like for
us we've got that image of the watch if
I can pull it up I'm not sure which one
it's under I think it's this one yeah
we've got that image of that watch
what's going to do is it's going to take
that watch and just like superimpose it
on our images of 100 by 100 and it will
like tilt the watch in different angles
and put it in different places on the
image so that will if since we have
2,000 negative images in theory if we
had maybe we've got 2,000 negative
images so one positive image will be
applied to 2,000 negative images that
means we will have about 2,000 positive
images and then we'll train against just
1000 of the negatives what you could do
is you can have two pictures of a
positive and then use create samples
once create samples twice and now you
actually have 4000 create samples you
can do this 10 times and have you know a
ton of them based on maybe 5 manually
edited pictures so keep that in mind so
if you do it that way there will be
different size initially like 50 by 50
but if you are pulling them from image
net to just simply manually label where
that image is you'd probably leave the
positive images as 100 by 100 okay so so
anyways that's our resized image now
we're just going to go ahead and save it
so see v2 dot M right and we save
basically the exact same location so
basically here we M right right back
there and then what are we writing there
while we're riding the resized image
finally we do pic underscore num plus
equals 1 and then we call this URL to
run
we'll run that and then this is the
directory I'm working in right now so
let's run it make sure how many errors
at least and this will this will take
even if it works correctly this was
going to take yes there we go um this
will take a while probably 15 minutes
maybe it just depends I suppose but here
the pictures are they're coming in
slowly but surely and we can see that
sure enough they are being resized to
100 by 100 and grayscale than all of
that so we're pulling in the images and
when all of this is done with this one
this link here we're going to
subsequently pull in the other link so
we're going to grab two different links
here so the other link is that link so
when this is all done what you're going
to want to do is update pic num to be
the latest numbers like let's say that
link was done and all we have is all the
way to 17 before you run this new URL
you would say pick num equals uh
actually 18 so you don't overwrite that
image and then you'll continue along
you'll probably have like nine hundred
or something like this you'll put in
nine hundred for that starting pic
number or 901 let's say if you had a
perfect 909 oh one and run that next URL
you could actually make this very
dynamic and say like you know if no file
exists in the directory pic gnome equals
one else pic num equals largest number
in directories something like this you
could do that but um this is such a we
don't we don't really need this to be
that fancy but if you want to make it
that fancy go for it so anyways I'm
going to pause the video here and I'm
just going to say again run this URL and
then when this one is all done
run this URL so you'll have had those
two URLs and don't forget to update pic
num otherwise you're going to overwrite
your other images okay so I'm going to
leave you guys to that I hope you guys
can be ok without parental supervision
if then in the next tutorial we're going
to be talking about ugly images so let's
see if we got any ugly images not yet we
don't have any uglies I'm surprised um
you'll have some that are like colored
but I promise they're not actually
like if we probably holding this back up
again well it's just caching I think
let's do that here we go hey I'm smarter
than you computer so anyway um yeah so
go ahead and download that it'll take
probably like I said 15-20 minutes
something like that and you should be
you should have about 2000 if I recall
right it'll be about 1964
so anyways um that's that questions
comments concerns leave them below
otherwise stay tuned to the next video
we'll get rid of the ugly pictures will
create our description files and then
we'll probably end that one while we're
uploading the pictures to the server
because that will take probably 20-30
minutes to so anyways that's that as
always thanks for watching thanks for
all the support subscriptions till next
time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>