<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Schedule Function - Algorithmic Trading with Python and Quantopian p. 3 | Coder Coacher - Coaching Coders</title><meta content="Schedule Function - Algorithmic Trading with Python and Quantopian p. 3 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Schedule Function - Algorithmic Trading with Python and Quantopian p. 3</b></h2><h5 class="post__date">2017-01-30</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/8HG1DGDKpPM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's up everybody welcome to part 15
of our Python for Finance tutorial
series as well as part 3 of the quanto
peon section of that series in the last
tutorial we learned how to kind of get a
hold of power leverage and make sure
what that wasn't getting out of hand and
now in this tutorial what we're going to
cover is the schedule function because
in the last one we saw despite getting
control of our leverage we were still
making like way too many trades in a day
we really just want to make like one
trade a day and with this especially
when we're addressing basically simple
moving average crossover of one day this
is one example of something you might
want to do just like once a day but with
the schedule function what that allows
you to do is schedule functions to occur
daily weekly monthly yearly you know
like whatever you need they can let you
I'm not positive on the yearly so well I
take that back I'm not a hundred percent
on that but anyway it lets you schedule
functions so what we're going to do is
work on that so now we're going to do is
we're literally just going to write
sheduled underscore function and begin
scheduled function again like some of
the other magical things like get open
orders it just simply exists okay it's
like again from quanto being import
asterisk that's what we're going to
pretend we've done so we can see the
parameters here a function you need a
date rule a time rule and half days
equals true or half days if you want the
half days is like sometimes the market
will just close early so for example you
might you might think that you're going
to because what you can do with a time
rule is you can you can offset things so
you can offset market closed by two
hours and you might think that's always
going to be you know still afternoon
right
but on the half day that's not true so
maybe you're thinking okay I want to
trade at 1:00 p.m. Eastern every time so
I'm going to do such-and-such or
whatever but on half days you won't be
trading at that same exact time so you
might not want to trade during half days
that's just me making up a scenario I
don't know anyway I can't imagine too
many other scenarios where half days
wouldn't matter that much to you but
anyways it's there if you need it
obviously somebody needed it
anyway schedule function you just pick
whatever function you want scheduled so
in this case say for example we want to
have a function that runs daily and or
just a function that runs and does
something at all like we're going to
call this one to find MOOC we'll call it
ma cross over handling okay and let's
say this function does something right
this function will not run like handle
data is just known by quanto pian to be
a function that is going to run every
day or every period rather and in this
case actually it's every minute it may
cross over handling however that's a
custom one that's our own so it's not
going to run that automatically we have
to call it into it to to run so that's
the way we do that is with scheduled
function because it's not like a regular
Python program like if you just did like
this and you called it down here I don't
even know what's going to happen but
it's not going to run this function
every day it's probably it would even in
Python terms it would only run at once
so anyway the way we're going to do is
with scheduled function so the function
we're going to schedule is ma cross over
handling and then we've got date rules
so date underscore rules this is when do
you want this to run so you've got these
choices like I guess I was right you
can't run it yearly so daily weekly
either week start or weekend that's
awesome month start or month end we're
going to do every day and what we're not
going to pass me parameters but you can
do offsets here I'm pretty sure now
we're also going to add time rules so
time underscore rules and let's see if
this is going to yeah okay so just just
so I can have proper space because I'm
like all zoomed in here you don't need
to enter down here but anyways time
rules dot and we want to do you have two
options market open and market closed
we're going to say market open and then
and then you have an offset here so this
is like an offset so default is one
minute after the market open so I'm
going to say hours equals one so this
would be one hour after the market opens
if you do market closed hours one would
be one hour before the close okay so one
of them is after the time one of them is
like before the time like it's not going
to hours one you don't have to do like
market closed hours minus one it goes
the other way anyway
at least I'm pretty sure on them now
okay so it's going to call any crossover
handling to happen every day at market
open one hour after so one hour after
market open cool so now we're ready to
build this function now this function
basically is going to do everything that
handle data does and handle data
actually becomes irrelevant at this
point because we're going to just take
everything from it so I'm just going to
highlight everything cut and paste and
we're just going to delete handle data
do we need it anymore but you can see
here we're referencing context and we're
also referencing data so we need to make
sure that we're passing context data
into here otherwise we've got everything
we need now one major bonus that we're
going to see here is that this is going
to run way faster than than before I'm
going to build it just to check first in
taxes sure enough what do you say line
seven does not close this off or
something no I did here right there's no
reason this has gotten also what let's
see is it not okay so we have we did not
close this off man that's it when I
zoomed out it actually gave me a pretty
shirt like line five was separated
anyway let's check again and we'll hit
less here okay so you guys see it's like
we're just zooming by I'm gonna go ahead
and cancel and we'll run the full back
that's just so we can see our daily
trades but you can see it's going much
faster because now it's just it's
calculating those SMAS it's looking at
prices really one time a day rather than
every minute which is making a huge
difference in our performance because
not every strategy needs to check every
minute okay so okay so yeah we've got we
we've done much better coming back down
to the
transactions these should be 2 million
yeah about two million two million
because every time again Lord explained
it so cool and this one's a little
larger just simply because we've made
we've made money okay so cool
so that is enough for just a simple
strategy the backtester and you again
you can look at all kinds of stuff like
your transaction details your positions
any log output I don't how we do
are we still logging something to rid of
logging me no no we're still watching PC
history anyway actually just delete that
okay so we're doing all that so yeah so
so that's the schedule function that's
all the strategy kind of stuff a real
basic strategy a nice back test but
really the back test I mean the back
test is seeming to suggest that this
might actually be a good strategy and we
could even try it on like a different
company so so like let's do rather than
Apple let's do a Bey cool and I think
that other back test is actually running
let's see if I can cancel it let's
delete wonder if it's in progress and
you hit delete if it stops the progress
I don't know it's a mystery of life feel
so so let's run this one let's see how
we do this was an even we're not doing
so hot hahaha like oh all right
my 47% okay we're not a Bay did in that
time to eBay lose 47% you could you
could part of your custom data it could
be the percent change for the actual
company you can also even change your
benchmark I let's see if I can find
benchmark in here real quick bench or
setting a custom benchmark set bench pot
great I think I wonder if I can just do
CID but symbol let's go to the algorithm
here initialize boom this shouldn't be a
below well symbol that's unfortunate I
wonder if we can pass a CID rather than
this because I think symbol something
returns a CID
let's try that let's see for to see if
we can do that looks good so the
benchmark is eBay and this is our
algorithm so as you can see eBay is
doing eBay is like just fine I mean it's
not doing the greatest but oh yeah we're
still horrible okay so obviously is not
good for all of the companies okay so
anyways that's enough for now in the
coming tutorials we're actually going to
leave the algorithms behind for now and
we're going to play in the notebook
environment which is arguably really the
place you you should start in when
you're starting a strategy I just still
kind of think algorithms is good to get
your feet just a little wet on the whole
kind of platform and then yeah use time
to probably dive into notebooks because
once you get to this point okay now
you're going to really start thinking
about developing a strategy and the way
that you're going to do that is most
likely through notebooks so anyways
that's what you have to look forward to
if you have any questions comments
concerns whatever anything black box
magical whatever let me know below I'll
do my best to help you out otherwise I
will see you in another tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>