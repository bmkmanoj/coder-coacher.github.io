<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>More stock manipulations - Python Programming for Finance p.4 | Coder Coacher - Coaching Coders</title><meta content="More stock manipulations - Python Programming for Finance p.4 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>More stock manipulations - Python Programming for Finance p.4</b></h2><h5 class="post__date">2017-01-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/19yyasfGLhk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to
part 4 of our Python for Finance
tutorial what we're going to talk about
in this tutorial is really sampling our
data since it's a really useful
operation that we can do with pandas
also because of resample we can also
create a candlestick all in one tutorial
so it'd be great so what we're going to
do is like in the previous tutorial we
did this nice manipulation of this
column that's great but for now I'm
going to comment it out also we're not
going to graph this information we are
going to keep the axes because that's
relatively useful now and then we're not
going to do the head for now actually
we'll just delete that so the first
thing we're going to do is do a resample
the idea of a resample with pandas is
you can take some information and
resample it too you could resample it
down but it won't work but you can also
resemble it greater so for example let's
say you have sensors that collect data
about the temperature and humidity of
your servers and they just kind of
randomly collect data or probably a
better term or a better idea okay in
your role in your business you want to
count how many people walk through a
doorway this is very random right the
people that might walk through and your
real curiosity is like how many people
come through an hour okay but you've got
data that comes through maybe every
minute or every two minutes sometimes or
three minutes or whatever but you really
care about that hourly number what you
could do if you had a data frame that
just contain columns of people walking
through you could resample it you can
resample it to one hour of data so it
would take all the data resample it to
one hour if you use a resample sum it
would add them all up and it would tell
you okay every hour of this how many
people you get with stock information we
have currently daily data but we're
going to resample it to ten day data so
if you have huge data that you don't
need to be huge for example if this was
like tick data that was like millisecond
data and we didn't need to be working
with millisecond data we could resample
that data to one day data like we have
or ten day data or just minute data so
you have a ton of options here so let's
go ahead and do that so we need though
there's kind of two things that we're
going to do here
generally when you resample you're
probably going to make a new data frame
so first let's use EF underscore ohlc
this will be its own data frame I'm
going to say this is equal to gf adj
close for just a closed dot resample and
in here just like with rolling you put a
window basically so we're going to go
with 10 B for 10 days we could do 10 min
we could do 6 min let me do any number
we want and you could there's all kind
you could do a weekly bi-weekly monthly
at the beginning of the month the end of
the month all kinds of stuff but for now
we'll just resemble the 10 days come in
here you could say you want to get the
mean the average value over 10 days so
this is not the same as a rolling right
10 day it's this isn't a 10 moving
average because it's not a moving
average it's just like every 10 days it
takes the mean so it's actually going to
significantly shrink the size of the
data set so you could you mean you could
do some the total value or an RKO review
a Chelsea for open high/low close and
this will create data that is open high
low close yes we are starting with open
high low close data yes
Tesla I've never had a stock split so in
theory we could have skipped this step
but a lot of companies do have stock
splits and you won't be able to use that
data you're gonna have to create your
own based on the adjusted closed so
there you have that now we're going to
say is we're out to do this with volumes
so DF dot or DF underscore volume is
going to be equal to DF volume and then
again we're going to resample behind 10
days and in this case we'll use some you
probably can use mean I think some makes
a little more sense so I'm going to use
some because that's the true volume not
the average of all I am over 10 days
you'll probably really want the true
volume now let's go ahead and print DF
underscore ohlc just so we can see what
we're dealing with
we are not going to run PLT last show
for that and let's go ahead and run that
so there you have it it's open high low
close based on every 10 days of data in
dated the index in our case we actually
don't want that to be the case because
we are going to use Matt plot libs kamas
pick away Chelsea while I'm thinking
about it let's go ahead and plot that
because I'm going to forget so from
matplotlib dots finding out we're going
to import candlestick hunters for ohlc
and then we're also going to import
import matplotlib and no methyl about
dates as M dates for matplotlib dates
because Matt will live does not use big
time dates for whatever nonsensical
reason they use these like it's like
700,000 it's not you next time it's I
don't know that's no idea I've no idea
why they use N tape unfortunate so ok so
we've got the head now what calcic ohlc
wants from us is actually not just
simply o h LC it wants dates and end
dates format dates open high/low close
so it wants all those things so the way
that we're going to do that or generate
that is like you can get all of the
contents of a data frame which is pi
just by doing like DF values but that
will not give you the column headers or
the index so the first thing we want to
do is reset the index for DFO HLC so
that state is now column so the way we
do that is let's see B I think you can
actually do to you I can't remember if
this will happen in place or not reset
index let's try it in place equals true
and then print this head
let's see that works sure enough it does
so we can modify that in place cool okay
so we've got date now we need to convert
it to end dates so the way we're going
to do that is we're going to say DF just
copy the base date is going to be equal
to this map and in this case we're not
we're not doing a fancy mapping of any
functions so like we're not trying to
pass any parameters so this is going to
work just dot map and then pass em dates
dates to numb so this will convert our
date/time object to a silly M date
number which will be like like I said
like 700,000 okay so for example let's
now that we've seen I know they've done
the conversion just so you can see what
I'm talking about right great 733 952
that's a date - Matt what Lib okay so
now what we're going to do is we've got
the columns here for the axes are like
all the calls they're the axes we don't
need to print this we are going to do X
1 dot x axis our underscores date that
will basically take these end dates day
to number basically the end dates and
display them as beautiful dates
thanks Matt plot lib so we've got that
now what we're going to do is do
candlestick ohlc
what axes x1 and then what's the data bf
underscore ohlc values and then we're
going to say width equals 2 that's just
how thick are the little candle sticks
themselves color up equals G for green I
think the default is black up red down
but this will make green up red down and
then since we have x2 we're going to put
volume on it but rather than doing the
bar we're going to do X 2 dot fill
underscore between and we're going to
fill between basically DF underscore
volume' dot index that's your ex and
unfortunately we also have to do this
whole map
nonsense so let's just copy this and
copy DF volumes index dot map
so that's your X and then based and then
what are we going to what's going to be
your Y data basically so what and then
between what so DF underscore did we do
Bonney
yeah we did right here with some DF
volume dot values and then zero and that
will that will fill this is your X this
is your Y and it will fill from zero to
the Y just a little easier to see things
I think this way okay let's see if we
get a result
no did I forget I probably forgot I
click uh let's see well we got fill
between ah this this needs to close here
and then okay let's try this again
great so now we've got this beautiful
open high low close candlestick graph so
the idea of candlestick graphs is they
kind of condense Direction open high low
and close data all in like one pretty
simple line so so here we can see like
for example this is the low point this
is your open or it could be in this case
this would be open this is closed
because the price went up but in this
case this was open this was closed this
was also the high this was the low
closed above below so once you get used
to reading them they're pretty useful
because they're just so condensed yet
have so much information to them and a
lot of people like to read the charts
not someone who buys into that but they
are very descriptive nonetheless and as
you can see we've got this nice fill
between rather than the bars it's a lot
easier to see that let's zoomed in
anyway that got if you have questions
comments concerns whatever do feel free
to leave them below otherwise we're
going to be getting into
more kind of complex manipulations and
eventually adding much more data to what
we've got because right now we're
dealing with just one stock but our end
goal is actually to bring in all of the
sp500 combine them all into one data
frame and start actually running
something that's going to give us kind
of a relationship of all these companies
so that's what we're going to be doing
these coming tutorials
if you have questions comments concerns
whatever filling below otherwise I will
see you in the next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>