<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Python and Pandas for Sentiment Analysis and Investing 9 - Mapping Function to Dataframe | Coder Coacher - Coaching Coders</title><meta content="Python and Pandas for Sentiment Analysis and Investing 9 - Mapping Function to Dataframe - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Python and Pandas for Sentiment Analysis and Investing 9 - Mapping Function to Dataframe</b></h2><h5 class="post__date">2014-05-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/NukLa-RSIfM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">it's going on everybody welcome to
another Python pandas finance and
sentiment analysis tutorial video in the
last video what we did was we created
this cow position function we mapped
that through pandas basically to our
column of DF position to generate the
position we wanted ourselves to be in at
a time and now in this video we're going
to talk about what we can't what we're
going to do from there and before we get
into it I thought it would be a good
idea to go ahead and run through what
each of these positions looks like on a
chart basically so so I have the images
here so this would be a purchase one
scenario so at this point we would want
to purchase one because it's obviously
training up a little bit but we're still
below the 5,000 moving average line
these are just arbitrary choices that
I've made so we haven't done any
computerization of like why this was a
good strategy if for any reason it's
just numbers I just kind of made up so
we're saying this is a buy one stock
scenario we won't want to hold to have
one stop at this point when it crosses
over the window smallest moving average
crosses over the 5,000 moving average
here with a largest moving average so
we've got in this like in this scenario
we've got ma for greater than ma one
greater than ma to greater than me3 in
this scenario we've got ma one greater
than ma for greater than ma to greater
than M 83 in this scenario we want to
buy two stocks like we'd want to have
our position twice with two stocks
moving on this would be a scenario sorry
it's kind of small I can zoom in but it
blurs this up but this would be a
scenario where we'd want to buy three
now not at this point but at this point
in the circle right at the point here
this would actually buy forum will show
that in a second so this would be a
scenario where we want to buy three
stocks and then here is a scenario where
we would buy four and this is where the
smallest moving average is above the
second smallest but the third and then
above the fourth okay and that's bye for
now this would be a scenario where we
would sell for where that's basically
flipped right so the smallest moving
average is all the way down followed by
the second fall by the third
followed by the fourth so this would be
a cell for stocks position this would be
a cell three position where the 500 is
still coming down so or the you know the
third smallest moving average is still
coming down hasn't crossed over the
fourth just yet but it's looking pretty
bearish at the moment this would be a
cell to position basically at this point
here where we've crossed over then we're
coming down but we just haven't crossed
over the largest moving average yet but
once we do we were going to start
getting scared right so this is a cell
to position and then sell one position
everything's above the 5,000 of them you
know the largest moving average but
we're decreasing and it's probably you
know going to truck continued shining
down so this is a cell one position okay
cuz we're still you know higher than the
long-term moving average but we're
looking not so positive so again these
are just kind of arbitrary choices later
on down the road we could pick either
add more variations because this
obviously is not all of the variations
that we could come across so we can
either add more variations we can also
pay attention to what's the stock price
at a time it would also pay attention
what the actual sentiment valuation is
are we above zero are we below zero and
so on so anyway that's what all of these
mean okay now the next thing that we
want to do is we have our position at
the time but what if we r you know we
can't just say each time it says
negative one um in our output let's see
if I close that output or not now I did
but it says you know let's say position
it says negative one well each time it
says negative one we can't just keep
selling stocks and if it says 110 no no
no we can just keep buying stock some
time or attention intention is instead
what we mean to say is we'd like to be
in a position where we're just minus one
stock so how can we do that well the way
we can you or do this is we have this DF
position column now we can have a DF
change column and change is going to be
what was the change between the previous
that the current value in the previous
value and if there is a change that's
the amount of stock that we need to
trade right now so DF change is going to
equal DF
positions pious position dot dip okay so
we can use this difference command to do
that so let's go ahead and save and run
that and I think it takes like probably
20 seconds or something like that to
show up for us we're not plotting or
anything so we want to worry about that
but then what we can do a change is when
we see that change we can reference
what's the current price at the moment
what's the time all of that and then we
can actually execute in theory execute a
trade now obviously here we've got
negative 1 and good morning good morning
all the way down and no change okay so
we're not really seeing if our changes
really working I'll try to well not to
200 let's try 100 to 200 maybe we'll see
a change in there if not those how to
take my word for it will eventually see
a change but we're just might not see
one now and then after this this is
basically the last thing we're doing in
this video and then in the next video
we'll carry on with actually you know
creating a back tester on the strategy
so so there is just no change because we
have no no position in any of these
changes not a number as well so anyway
sorry can't see evidence of a change but
I assure you it will be there um so
that's going to conclude this video in
the next video we're going to be doing
you know taking this further and
actually starting to create the strategy
where there's actually back testing of a
trade occurring here so anyways if you
guys have any questions or comments up
to this point feel free to leave those
in the section below as always thanks
for watching thanks for all the support
of the subscriptions and until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>