<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to program the Commodity Channel Index (CCI) in Python | Coder Coacher - Coaching Coders</title><meta content="How to program the Commodity Channel Index (CCI) in Python - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to program the Commodity Channel Index (CCI) in Python</b></h2><h5 class="post__date">2013-12-01</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_fcnSMEkA9c" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on guys welcome to the
second part of the CCI or commodity
channel index tutorial miniseries within
our Python mathematics and finance
indicators series where we left off and
we're talking about what the CCI was now
it's actually program that's in the
Python if you have those first like
eight lines from the previous videos
when we go to calculate just copy and
paste those and otherwise you want to
type with me also if you don't have the
sample data text check the link in the
description get that sample data copy
and paste that into a notepad file and
save it in the same directory as a
script with that let's go on and
continue so first we want to import
numpy as np1 import time now sample data
is gonna be our first variable here and
that's going to be equal open and the
file we want to open sample data dot
text so whatever you save that sample
data as that's what you would open and
we want to open that with the intention
to read and now we're going to go ahead
and read that in the memory split data
equals sample data dot split by new line
then finally date closed p open or
actually it's close hi p lo p open p
volume equals MP lo text what text do we
wanna load that's going to be split data
the delimiter is a comma and finally
unpacked is gonna equal true
so we can unpack it into the variables
like this now when you get in the actual
coding so everybody that had been copy
and pasted waiting here we go actually a
lot we need one more thing we want to
get that moving average function so go
to there is also the link in description
for the sample code go to that link go
to the sample code real quick let me
just drag it over here so here's that
page right scroll down to the moving
average function let's do like a nice
little copy and paste of that so we
don't have to go through that I do have
a tutorial series on the calculation of
that if anyone is interested now the
next thing
is going to define see see I see you see
I and it's gonna have the following
parameters we're gonna just throw
everything into it even though we don't
need the open price Bowl just pass it
anyway so to say DC h l oh the TF and
SMA so these are gonna be you know
through this variables when we date
close high-low open volume and then time
frame that's going to be the time frame
of our CCI and then the SMA that we want
to use when we do the simple moving
average now we're gonna come down here
and we're gonna say tip prices that's
gonna be the typical prices array so
we're gonna end up doing before we
calculate CC eyes get all the numbers
that we need and then we'll actually do
the formula that's typical prices then
we've got MD and that's going to be the
mean deviation array so MD a R equals
empty right now finally the CCI will be
an empty array we will populate that
hopefully eventually so then we're gonna
do one of those typical while loops and
when we say x equals zero and then Wow X
is less than the length of pretty much
anything we'll just throw random H in
there and buy anything I mean anything
from here to anyway so that's that so
well X is less than the length of the
height so let's say TP so typical price
is gonna equal and this is the
calculation for typical price it was H
plus L plus the close price divided by
three but we also need to use the X
variable so throw in the X's on the HLN
seat so that's done and then we're gonna
say tip prices dot append TP and then
finally X plus equals one so that'll run
through and get us a typical prices
array now what do we want to do well we
need that simple moving average of the
typical prices so I'm going to say SMA
TP now that that typical prices array is
completely filled
so SMA TP so that's a simple moving
average TP that's going to equal
moving average and then it always goes
values windows so tip prices and then
what window do we want to use we want to
use SMA that we defined up here and
moving averages that function we just
copy and pasted from the sample code now
the next thing we want to do is just for
a little bit of a check will print Len
SMA TP and then we're going to say tip
prices now equals tip prices from the
nineteenth part of that array on and
that's because we perform and actually
it's because we're going to perform that
simple moving average but instead of
doing that one we don't actually need it
at all but I'm gonna say SMA - 1 :
because in the in theory the 19th part
of the array is really the 20th or
actually it's a list all right guys I
just called it that anyway that'll be
the more the the more professional way
to do this so people really can't change
because in my head the SMA is gonna be a
20 so that's why I did 19 them but
that'll make it dynamic truly anyway
continuing on after we do that we want
to print the lenten not in all caps
friend land of tip prices so I'll just
hopefully line up and they'll be the
equal length and in fact we can go ahead
and call this so let's go and call I
think was Laura kcci all right no an
uppercase B's yeah CCI Brian and we
ordered the prams that way so I can just
do it really easily like so copy and it
was time frame SMA just for the record
so time frame usually you're doing CCI
like 14 is a pretty popular one so 14
and then the SMA or we're going to use
this 20 so a print bling print blend
let's go ahead and run this and just see
if we get proper length
I'm sure enough we do they line up and
stuff is the whole point of that so
we're ready to continue on with our code
now the next thing we want to do is run
another while loop and we want to do the
whole mean deviation and to do the mean
deviation we're gonna get the simple
moving average of that line and then the
current typical price and then that the
deviation is what's the difference
between the SMA of that and the actual
current value
that's your deviation so that's the next
thing we want to do so now what we're
going to go ahead and do is we're going
to say y equals time frame and the
reason we're doing that is because we
have to start at the fourteenth point
because it's not only main deviation
it's like the sum of the mean deviation
so we have to start the 14th point so we
can actually look 14 points back right
or if we were using a different CCI
measurement we would you know if we're
using the CCI 20 be 20 points back and
so on so we just have to do that so now
what we're gonna do is wow Y is less
than the length of whatever SMA TP is we
could also use typical price is what do
we want to do well we're gonna say the
consideration typical prices equals tip
prices from the Y minus the time frame
variable to Y whatever that is so that's
the array that we're going to consider
if typical prices and then the
consideration SMA TP is gonna be the
exact same thing y minus TF : y so then
we're gonna basically sum up the
differences of each part of that array
and then that would be your mean
deviation for that single point so now
once we've done this we're gonna say em
DS equals zero because we're gonna make
these mean deviations right then we're
going to get to Z equals zero
make another while loop so while Z is
less than the length of each either use
consideration TP or consideration SMA TP
well it's less than the length of that
her and let me
having to scroll down curve and Issa
current mean deviation equals the
absolute value because we're only we're
not looking for negatives here we're
looking for how far what is the
difference so it's always going to be a
positive number so consideration TP Z
whatever is the element is at the moment
- consideration SMA TP z element then
we're going to say NDS plus equals
current eeks we're looking for the sum
of those mean deviations then we're
going to say Z plus equals 1
once we're completed with that while
loop there we've got the sum and now we
need to append it to our MD array which
I believe we did define already do it
yeah it's right above you so MD array
got a pen
M DS so now I've got an MD array and now
if you recall we're still within this Y
wow loop so now we've got the mean
deviations and once we've completed or
once we've done the appendage there we
do y plus equals 1 so we can actually
finish out that array finally we're all
done let's print out the length of MD
array and just see that that's the
proper length that we want in theory it
should be the 14th you know 14 points
shorter than the other two arrays so in
that case what we want to do is say tip
prices now equals tip prices 14 :
and then SMA SMA TP equals s ma TP 14 :
then we'll also print blend tip prices
and we'll also print a line smatv so now
the last three digits this thing spits
out ought to be of the exact same length
so let's find out and assume we did get
a 787 but now it's telling me
consideration SMA TP is not
oh yeah alright anyway I can search an
smatv equals why didn't anybody tell me
this when I was doing SMA TP interesting
air their ring for anyway so sure enough
eighty seven minus 14 equals 73 and then
the last three numbers are indeed
identical so we're all set so and we can
also while we're thinking about it we
can comment out these since we don't
really need them anymore same thing here
there's no reason to be printing them
out we've confirmed our question so now
what do we need to do well we actually
have to perform the calculation right so
we've got all the the numbers that we
need to do this calculation now let's
actually do the calculation so now that
we've exhausted we've got x y&amp;amp;z
exhausted we look back to using X again
we're gonna make it X x equals zero and
we're gonna say wow X X is less than the
length of and we could use really SMA TP
tip prices MBA whatever you wanted so
I'm just gonna throw in SMA TP now while
that's less than the length of that
we're gonna say CC is so equals so like
whatever you know CCI variables are
going to equal not variables values tip
prices xx minus s ma T P xx just in case
let me bring back up a little tutorial
slide for the calculation so what we're
doing right now is this calculation here
right
it is TP minus the SMA of TP for
whatever time frame which we've already
calculated so tip prices - the SMA TP
we've got that all set then we're going
to divide that by point zero one five
times the mean deviation which we've
also already calculated so it's gonna be
this divided by zero point zero one five
times the MD
xx value so they'll give us Cece eyes
finally you were gonna say CCI dot
append Cece eyes let's just make sure by
scrolling up to the top that that is
what yes
lower case e CI MDR a CC eyes and then
xx plus equals one and now we are ready
we're gonna go ahead and let's print
blend CCI analyst print land day 33 :
and then also won't since we're in
theory done with this we're gonna return
date 33 : &amp;amp; CCI 33 : the reason why
we're using that is our movements here
is basically a 20 plus a 14 so what do
we have the 34 but the 34th true element
in an array or look bike by counting
starting at 1 would actually be the 33rd
element Rex we start at 0 so we're using
33 : there and actually that's also same
thing with our other thing that we did
so really it shouldn't be 33 we should
program it as TF + s ma : so let's do
that
yep + sm 8 Wow I'm sure we can get away
with this but I'm pretty sure this will
work
yep let's save that run that and see if
we can do that yeah we actually got away
with that awesome
so 73 73 awesome awesome awesome so now
we're actually ready to go ahead and
chart this bad boy and and actually
before before I leave let's go ahead and
print CCI and make sure these numbers
are 80% within the range of negative 100
to 100 it's supposed to be like 70 to
80% of the value should be within that
range
let's see what these are not the numbers
that we want you probably did the mean
daeviation wrong let's go look back at
our mean deviation calculation yeah so
instead of dependent yeah
so the mean deviation is what we did
wrong and that's why we're getting lower
digits than we want so the mean
deviation right now is this massive mean
deviation right because we added all the
mean deviations we're supposed to get
the mean or we added all the deviations
we're supposed to get the mean deviation
so at the end of this you would really
need to do TF so we would need to say
instead and the it's hard because I
don't want to change all of our
variables right now but really this MD
would be this okay anyway I guess we I
don't think we've used the MD like pure
MD so I guess we'll do that
MD evils MDS / timeframe and then
instead of appending MDS we need to
append MD save that and let's rerun this
and hopefully now we have the correct
digits yeah this looks a lot better okay
so most of the digits are within the
negative 100 to the 100 range obviously
there are some that are way out of that
range like 290 we've got 155 but for the
most part we don't and this would be
obviously overbought over baat Oh robots
still over bot okay where is our 290
yeah that's what it's saying anyway so
now that that's better good thing that I
decided to go ahead and print it out
before moving under the graph otherwise
we would have had to revisit the code
anyway so the code is now done that's
how we can calculate CCI within Python
in the next video we're going to be
doing is actually putting it in our
charting application in charting it in
Python so as always thanks for watching
thanks for your support your
subscriptions and it's all next</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>