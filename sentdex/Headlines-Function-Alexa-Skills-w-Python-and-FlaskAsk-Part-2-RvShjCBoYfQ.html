<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Headlines Function - Alexa Skills w/ Python and Flask-Ask Part 2 | Coder Coacher - Coaching Coders</title><meta content="Headlines Function - Alexa Skills w/ Python and Flask-Ask Part 2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Headlines Function - Alexa Skills w/ Python and Flask-Ask Part 2</b></h2><h5 class="post__date">2016-11-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/RvShjCBoYfQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to the
second lexus skills with python Falasca
tutorial video in this video what we're
going to be talking about is adding just
our Python logic that whatever we want
the app actually to do because basically
at this point what we've done is we've
configured basically how our app is to
work basically we've got the skeleton
kind of structure but we need this
basically this get headlines function so
in this video we're gonna build the get
headlines function and then the next
video we're actually going to apply the
skill itself so let's get started so in
get headlines we're gonna start with a
user pass dict
and in here we're gonna have three
parameters basically it'll just be user
and then user will be something I'm just
gonna put user name but this should be a
string and in fact let me just do that
to make it totally clear should be your
user name in string form then we'll have
passwd that will be a string of your
password I'm just not going to put it up
on video for me and then finally you're
going to have a PA not in caps API type
and we're gonna say this will be JSON
cool now we're going to have our session
that's going to be a request dot session
then we're gonna do update the header
secesh cess header dot actually headers
update and we need to update the user
agent this is a fairly foreign to me I'm
not quite sure why they need this but
basically reddit requests of you to
update the header or the user agent
specifically in the headers basically to
just be anything but a legitimate user
agent or something I don't really know
if anybody knows the rule of the day you
didn't put anything I could say I am
testing Alexa here okay
and then for my username so I said Alexa
anyway so you can you can just you just
have to change it so it's it's
interesting but if you don't change it
you're gonna get shut out
so hey whatever sets that post we're
actually gonna log in now so we're gonna
log in HTTP colon slash slash W then we
go ready comm slash API slash login and
then the data that we're gonna post is
the user I passed it beautiful
okay so we've logged in and we're gonna
sleep now because the reddit API is
apparently sensitive to many requests so
we're just sleep for a random one second
so you will notice the one second for
sure and how long it takes your app to
actually you know do something so then
we're gonna say URL equals now whatever
you want to visit I'm gonna visit the
world news so reddit.com slash world
news and we want to inject Jason form
and when we say the limit equals 10 so
once you get the first 10 headlines you
could do more if you want it and again
you can change world news to anything
you want
never say HTML equals s time yet URL so
that's our HTML now we're gonna grab the
data where say Jason load JSON load s
for a load string and what we were the
string basically were a load is HTML
content and because it's were all on
Python 3 right we have to decode
Internet data basically utf-8 and you
have to encode when you want to send
data now what we're going to do next is
we're gonna say titles equals and we're
going to do a one-liner for loop if you
don't know what list comprehension I do
have a tutorial on that as well it's not
essential that you understand it for
this tutorial but I'm going to use it
just because I like them and I think
it's cleaner so what we're gonna run is
you need to
like a type you need code you need
decode again this is just to clean up
any like fancy characters that pythons
gonna get angry about we're gonna apply
this to the listing the data of that
listing and when we get done first of
all I will still write out this in a
regular for loop also will print out the
data itself I'm just gonna write it out
first and then you can see what we're
doing but basically it's JSON you can
treat JSON just like you treat a
dictionary so we're referencing from a
listing element which hasn't been
identified just yet but we'll get there
the data from that and then also title
so each element each listing information
has a bunch of information we're looking
at the into the data of that listing and
then we just were grabbing the title of
that listing so and we're applying into
code to that then it's for listing in
data because we'll get the entire data
data and then it has children key in it
and that's the loop now if we were to
write this loop and regular Python terms
it would be like this for the listing in
data we're going to say this and really
we would say maybe titles equals empty
list and then you would say titles dot
append and you depend this that's what
this one one this these three lines is
basically what this one line is doing so
there's that we've got the titles now
we've got titles but they're it's a list
of strings we want this to just be one
string so what we can do instead is say
titles V equals and then we'll just use
a join so dot join and then I for I in
titles so again what this is going to do
is join all these strings together and
their separator will be dot space okay
so we've got titles and now will we
hi Tolls okay great so we'll save that
and now just to test it let's go ahead
and we're just going to straight up run
this here so let's just say titles
equals get headlines we want to make
sure this works and then we'll print
titles now what I'm gonna do is I'm out
move this over and I'm gonna fill in my
information real quick just to test this
looks good running it let's see if we
get any errors or anything goes wrong
remember it will always wait at least a
second and then otherwise you're waiting
on read it one thing to keep in mind is
reddit reddit does go down generally
around like I don't know 5 to 6 p.m.
Eastern reddit can sometimes just crash
so in this specific app just from the
load of how many people are using it so
this specific app in general would
probably do good with some sort of try
and accept that waited for only a
certain amount of time and then was like
ok forget it let's try again later or
something or just automatically recent
in a request or something otherwise your
your skill will timeout if something
takes too long the skill will actually
timeout which can be either a good thing
or annoying anyway here we have it it's
a nice it's purely a string and we're
ready to have Alexa read this to us in
her beautiful voice so what we're gonna
do now is save this so this is now our
code make sure you get rid of let me
just clear my username your password
just clear this out you don't actually
want titles get headlines and titles to
be running anymore we just simply wanted
to test it there so we'll clean this up
and we are pretty much ready so in the
next video what we're gonna do is
actually run this and basically act like
we're a server with hendrik we're going
to set up on the developer amazon.com
and all that and we'll actually run and
test this on our Alexa device so that's
what you have to look forward to if you
have any questions comments concerns
whatever up to this point feel free to
leave them below otherwise I will see
you in the next tutorial
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>