<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Image arithmetics and Logic - OpenCV with Python for Image and Video Analysis 5 | Coder Coacher - Coaching Coders</title><meta content="Image arithmetics and Logic - OpenCV with Python for Image and Video Analysis 5 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Image arithmetics and Logic - OpenCV with Python for Image and Video Analysis 5</b></h2><h5 class="post__date">2015-12-20</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_gfNpJmWIug" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what's going on everybody welcome to
part 5 of our open CV with Python
tutorial series in this tutorial we're
going to be talking about is simple
image arithmetics as well as logical
operations so especially the logical
operations part is going to be following
us pretty much through the rest of this
series so it's really important and
really useful the image arithmetic is
also pretty useful especially if you're
trying to analyze two images like
overlay to each other and stuff like
that so for this tutorial I want to be
using three total pictures the first two
will be these two pictures here now two
things one all code from this tutorial
as well as the text-based versions of
these tutorials are posted on Python
program at net by the time you're seeing
the video both are up so you can go to
Python program at net there's a link in
the description for the specific
tutorial head there and you can get all
the pictures that I use but I do suggest
that you use your own pictures just
because it's more interesting if you're
using your own pictures I think but
anyway I'll be using these two pictures
for these first two pictures just make
sure they are of identical size
subsequently I will use this picture
this one does not need to be of
identical size to these two it just
needs to be smaller than ideally like a
fourth or less so anyway let's go ahead
and get started so the first thing of
course is open an import CV to import
numpy as NP and then we're going to load
in these two images so image 1 is going
to be equal to cv 2m read and this image
for me at least is called 3d -
matplotlib dot PNG and then I'm just
going to copy this paste image 2 and
image 2 is main logo dot PNG now um I'm
sorry aha it's not Emma go not yet
anyways we're going to do a main SVM
image dot PNG so these are these two
images here okay so logos in same size
identical size images okay
so on
there are multiple ways that we can look
at both of these images at the exact
same time in the exact same space or
region of image and think that we could
do that first would be a simple addition
operation so we could literally say ad
equals image 1 plus image 2 then we can
say cv 2 in show and we'll call it ad
and we'll show ad see v2 dot weight key
0 and then finally see what you've got
destroy all windows ok so I'll show
these and here's our first
representation as we can see not really
um like we can see both images neither
image has lost any opaqueness they're
both as solid as they were ever but
we've got all these yellow here we've
got a serious issue going on so not
probably the most ideal but both did
hat retain their opaqueness next there
is an addition operation that is
actually built into OpenCV so what I'm
going to do is comment that one out and
we're going to make a new one we're just
an ad equals C v2 dot ad and then we're
going to add image 1 and image 2 so we
add the two images and we see that we've
got a pretty white it out in so what
actually happened there well this one
this version of ad added all of the
pixel values together so taking from the
text-based tutorial I kind of broke this
down and basically like let's say the
first pixel had this value second pixel
was this value that means adding them
together it was 155 + 52 11 + 170 79
plus 200 equals this value well the
maximum we can have is 255 so really
it's translated at 205 255 255 which is
very bright so hence if we've got 2
pixel values added together a grid and
255 we get just you know bright white
which is what has happened here
so again probably not the most ideal um
there are a few things you could do you
could like divide them by 2 or something
like this like you can try to
/ - and then add them together and then
you would get an interesting picture not
sure you can do it straight up in the
function like like that no but you could
do that you can do that by loading in
the image first dividing all the values
by two or something but anyway moving
along so those are the two ways to add
the first ones sort of useful second one
I don't think I'll ever use it but you
can if you needed to now we have another
method and this one's probably the more
useful one but it's not adding but it's
using weights so we're going to say
weighted equals and then what we're
going to say is CV to add weighted and
then the values here first will be image
one and then what is the weight of image
one basically these are going to add up
to one so image one has a weight of
point six or 60% and then image two will
have a way to zero point four and then
finally have a gamma value which we're
going to leave gamma alone save and run
that problem already I know I saw that
coming my Enter key f5 was faster than
my brain that time okay so that you get
this imagine both have like they're the
rope Agnes is affected here but both
images are there we haven't really lost
values of either image so closing out of
that those are your options as far as
adding images together and kind of
imposing them over each other
identically but there is one more method
for kind of imposing images on other
images and that's with the region of
images that I showed you before if you
recall we kind of copy and pasted now
along with that instead of showing you
the exact same thing that I've shows you
before we're going to add the logical
operations to this tutorial try to
follow along if you have questions ask
them below but we will kind of revisit
these logical operations because they
are a major part so we'll keep waited
just kind of in the code I suppose we're
not going to be showing it anymore and
in fact let's just delete that we don't
need that code so now we're going to do
is image two is going to be that main
low
go dot PNG so for me it's a little
Python logo and we're going to impose
that on this image but we're not just
going to use region image like we did
before so we're going to impose on this
image but what we'd like to do is
actually give this image a transparent
ish background let's say and impose it
so the white is just removed from the
image okay so the way that we can do
that is we will first do a threshold so
if we threshold this image uh basically
like we'll get I'll explain what a
threshold is when we get there but it
makes you probably already know what a
threshold is anyway so first of all I
want to put the logo in the top right
corner or top left corner rather and so
first what we'll do is we'll say Rose
holes and then we'll have channels
channels equals image to shape so image
two is that logo so then subsequently
the region of image or the ROI is going
to be equal to image 1 this is the
region of that image image 1 and then
we'll start at 0 to the rose and then 0
to the columns so this is just how many
rows in there how many columns are there
we're not using channels at the moment
that's a shape of image 2 and then
that's how we're defining the region of
image of the image one that we're about
to take up so it has to again be the
identical size now we want to create a
mask of the logo and then we're going to
convert it so a mask generally will be
the initial conversion to greyscale so
we're going to say image 2 grey equals
CB to convert color and we're going to
convert the color mm of image 2 to CV to
color underscore BG are to gray okay
this just creates a great out version
over Python logo okay we could show it
but I'm not going to probably shut right
now now we're going to apply a threshold
so the threshold will be ret mask we're
not really going to use that ret value
but the mask will be our threshold
an equals c v2 dot Thresh hold threshold
where are we going to apply the
threshold to image to gray what will be
the threshold value is anything that
crosses over the 220 number and then on
the maximum value will be 255
I'll explain these numbers again in a
moment and then this threshold that
we're you see me to Thresh underscore
binary underscore inversion okay so this
is just a binary threshold either it's 0
or 1 if this is our threshold value
basically so if the pixel value is above
a 220 it will be converted to a 255
which is basically your your white and
then if it's if it's below 220 its
converted to black then what we're going
to do actually is end up flipping that
around because this is inverse so let's
go ahead and see beat you in show mask
oops I wouldn't give it a name mask mask
okay so there you go so the Python
lookbooks python python hugger right now
is white and then a black background and
then so so it's at least identified
those areas but keep in mind we still
have the original Python logo okay so we
still have em - this one is actually
called mask so then later on we can take
all of these exact values and say we
want those values from the original
image and that's what we want to show
okay so that's kind of the idea of how
this works so in show mask I'm not going
to show the mask anymore so I'm going to
comment that out for now
so Brett mask blah blah now we're going
to say is mask underscore in
and this is going to be the invisible
part so this will be CV to bitwise
underscore not mask so the parts where
there is no mass be kinda like the black
area of our mask now we're going to
reference the blacked-out area for the
logo of our region of the region of
image on image 1 so we're going to say
image 1 uh Nurse Corps background equals
CB 2 bitwise okay let me I'll have the
prime news plane bit was bitwise is a
lose its low-level logical operation
that you can perform for this tutorial
and really everything for the most part
that you're going to do with open CV you
really just need to understand that it's
just like the Python logical operations
it just has bitwise in front of it
they're a little bit more in depth and
than the Python ones but there's for
much lower level it's like for C C
language and stuff that's kind of where
it comes from so you've got bitwise not
this just means we're not masks and
we're not masks is basically a value
which would in our case 255 bitwise and
will be where the two are equal you've
got bitwise or where it would be um this
or is really more of an and/or operation
so like if like in pythons
or is this or okay so pythons or you can
have both values be true and it runs or
one value be true and it runs with
bitwise or that's true but then also
bitwise has an X or and then with the
XOR bit wise if one is true that's yeah
that like would run but if two are true
if both operations are true it won't run
XOR means only one of these okay
so just keep that in mind we're not even
going to be using X or at least not in
the foreseeable future I don't think so
don't worry about X or just kind of
think these are operations very similar
to pythons logic so um so image one
square background is equal to bitwise
and and this will be the ROI and then
the region of image there and the mask
will be the mask that was the inverse
basically then we'll revisit this again
when we're all done I think go through
it one more time then image to
underscore foreground is equal to C v2
dot bitwise underscore and and then we
use image to image - and then the mask
equals the mask and then we're going to
say DST equals CB to ad and then we're
going to literally add image 1 in the
background in image 2 whoops
image to the foreground and then we're
going to say image 1 and then that
region of image remember uh that was
basically up here so we can pretty much
take this
so we'll say image 1 equals the DST you
it would just defined now we're going to
show a CV to em show and since we've
redefined image 1 I think we're already
- yep we're definitely ready to it res
and then we're going to show image 1
will still wait key 0 and all that okay
so there it is after a lot of code but
not too bad the image so again what
happens here is and in fact what we can
do it's kind of nice is you know in
Python you can you can every step of the
way you can print and use that as a form
of debugging uh what you can do actually
is like we could in show um let's just
finish up quite a few things here so you
can image show the
like mask invisible part we can M show
the image 1bg we can M show image to
foreground and we can even image show
DST cool so we show all those hopefully
right but we can't see but it's really
open to to retain our thing here man
really chaps my hide
let's close this so fine so basically
what ends up happening I'll just pull
them anyways whoops is we take our
original image okay which is basically
this image it's very hard to move these
around and then move this one out of the
way and what's ended what's what we end
up doing is we threshold of the image
which actually we don't have an image
for but we thresholded it to the point
where the background is black and the
logo is white then we inversed it
basically to this and then we asked
OpenCV okay what we want to use is
actually where it's not the shoot where
it's not the case there let me pull that
back up and then we went to the region
of image to draw the actual logo and
then what we ended up doing to is
actually grabbing the original values
for this logo and then also adding the
basically this was like nothing in the
background there because we are we
gathered what the background of this
image was by threshold on it and then we
added to this image the original image
the background of the original svm image
so you can even see that in this image
it's over here kind of in the corner we
added that to it and then we took this
region of image and just imposed it on
the original image so it kind of gives
me effect that it was it's a transparent
background okay so that's kind of
confusing and probably what I would
suggest is to like you can do it this
way and then maybe try to start with an
image
black background and do the same thing
and get it to show up on this image
without any background and I think
that'll be a good kind of challenge for
you guys that'll probably be a challenge
on the actual tutorial so anyways um
that's that if you have questions or
need something to be clarified feel free
to ask below otherwise and the next
tutorial we're going to start talking a
lot more about thresholds because
thresholds are used to even further
simplify an image as we did in this case
right when we took the original Python
logo and then added a threshold to it we
went from having three colors to two
colors and then actually we remove the
background and actually wound up with
one color and then we get the location
of that color we get the original colors
at the very very end we add the
background and all that to it so
thresholds are actually really common to
use because it will help us further
simplify images and also understand
where edges are and all that so anyways
that's we're going to talk about the
next tutorial so stay tuned for that
otherwise as always thanks for watching
thanks for all the support and
subscriptions and it's till next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>