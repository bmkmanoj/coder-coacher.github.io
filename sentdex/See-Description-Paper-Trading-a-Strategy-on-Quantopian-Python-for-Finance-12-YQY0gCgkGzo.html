<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>[See Description] Paper Trading a Strategy on Quantopian - Python for Finance 12 | Coder Coacher - Coaching Coders</title><meta content="[See Description] Paper Trading a Strategy on Quantopian - Python for Finance 12 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>[See Description] Paper Trading a Strategy on Quantopian - Python for Finance 12</b></h2><h5 class="post__date">2015-07-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/YQY0gCgkGzo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody welcome to
the 12th python for finance tutorial
with quanto peon slash zipline
in this tutorial we're talking about
taking the next steps with our algorithm
so we're going to be moving off the sent
decks kind of stuff simply because the
rather cruel of me I think to do an
entire series based on data that people
may not have access to so we're going to
be reverting back to creating our own
strategy on quanto peon that doesn't
mean we're necessarily going to leave
the fetcher behind one of the web
services that you can use the fetcher
with would be like quand elle comm which
we've used in the past but they offer an
api to all kinds of data and a lot of
that data is finance data so we can
reference that and use that and a reason
why we might use that is for example
with fundamental data you can't use we
haven't covered it yet but there's a way
to reference a price history at any
given point without manually saving it
and you use literally this function
called history in quanto pium but
fundamental data does not come with a
history capability yet anyways they
might but they might not that's a third
party provider and I'm guessing for some
reason they don't feel comfortable
giving that maybe because people might
figure out ways to download that data
anyway but quanto peon has a lot of
fundamental data that we can actually
access for free and use it like history
so I don't know if I said quanto Peter
quantal I get them mixed up a lot anyway
- Mitch Quon in their names
anyway so we might use fetcher for
something like that but anyway we're
going to move away from that for now and
come back to our original script here
which was from part 8 if you don't have
the code I will try to copy and paste it
in the description if YouTube says I
can't do that
I'll put a link to it in the description
or something at the end of all the
series I do post all the sample code
with text versions of the tutorials I'm
not really holding out or anything on
anybody but it just it takes a long time
to write up the tutorials so I usually
just save that
at the very end so anyways we'll take
the code from part eight here we'll copy
that and we'll just paste it right in
here so the next step to moving on with
quanto peein you know you can do daily
back tests and you really can just use
quanto peon simply as a back testing
platform and that's it but one of the
really cool things that quanto peon can
also do for you is help you pay per
trade a strategy and actually trade
forward without risking any money but
really trade forward and then I'll help
you kind of alleviate a lot of
cherry-picking or maybe bias and
overfitting that you've done so getting
to that point requires you to run a
minute back test and running a minute
back test can be as simple as clicking
the down arrow and choosing minute and
then running like this strategy we could
do that the only difference is at every
minute this would be evaluated this
doesn't change the moving average is
always going to be for days they don't
currently support
I don't think doing it in minute form
although you could save this the pricing
data and perform your own minute moving
averages so if you wanted to I suppose
you could do that anyway so the question
is okay let's say we have a strategy
like this that we really just want it to
trade once a day but we want to run it
against minute data how could we
possibly do that well one way that you
could do that is with just a rebalance
right so you could come down and you
could have a scheduled underscore
function and we could say the function
we want to schedule is rebalance even
though rebalance is really gonna be a
method I don't know that's one thing
that bothers me a lot about Kanto pian
maybe I'm wrong but everything all this
is a method this is a method but their
methods but they're not in the context
of a class so it's really easy to call
them functions but the very fact that
we're passing context and all this stuff
through them tells me in not defining it
tells me everything here is a method and
it should be a method exists and zip
line their methods of this trading
algorithm class but we're calling them
function it just really bothers me
sometimes anyway we've got rebalance and
then we're gonna have date rule equal to
date underscore rules dot and we're
going to have this run every day and
then we would have you know a time rule
and that would just be equal to tie
underscore rules and then let's say we
run it market open wham bam thank you
ma'am
done also in here you can put an offset
as far as how many minutes you would
want it like at market open five minutes
later you can put offsets in there
that's kind of cool anyway there we go
we schedule a function then we could
just do something as simple as define
rebalance Pass context pass data : and
then take this stuff here cut paste it
here and then under handle data just
pass and that's really all you should
have to do then you can run minute data
let's go ahead and put this up a little
further in the history and run that
minute build the algorithm ok so a few
things to talk about as we are talking
about moving into live first of all on
live data say your paper trading live
initialize is being run once a day so
keep that in mind so if you are say
tracking history a lot of people will
you know track you know context dot I
don't know if you're doing machine
learning for example you might have
features and then you'll have labels
let's say and you're packing that in
well you might actually find that every
day this is getting emptied out because
people will do context features equals
and then maybe they'll have an empty
dict and but what happens when you're
trading this using live data is
initialize is gonna run literally once
every day right at Martin before market
open the other thing to keep in mind is
with the CSV fetcher they want you to
one you can't change prior data in the
CSV fetch so the fetch will run every
day but if you can't change any of the
prior data okay so you have to literally
append any changes to the end of that
CSV let's say so over time that CSV will
just get longer and longer and longer
hopefully that will change eventually
but that's just the way it is right now
so keep that in mind also that CSV needs
to be updated by midnight EST so again
for someone like me with like say this
tech stuff we'd really like that to be
updated by you know maybe 30 minutes
prior to market open or something like
closer to market open but that's what we
have right now so we deal with it but
again for back testing we can back test
30 minutes prior to market open we just
can't paper trade yet doing that so keep
that in mind now as we saw here okay so
we ran this this little logic here and
we actually be pretty good most likely
just simply because the market mostly
fell but and we we did better the market
because of that so that's our strategy
if we were gonna go with maybe a
strategy that trades on maybe once a day
and we don't want it to trade multiple
times a day that's how you can do it but
I think moving forward will probably cut
that out and paste it back in here
whoops I don't even know what just
happened
cut that out there paste there we go and
we'll probably do something with
rebalance eventually so we just leave it
there I can foresee us using it at least
at some point but for now we're not
going to use it but what we're gonna end
up doing is kind of building more on
this strategy or maybe we'll make our
own strategy that doesn't use this but I
do like the idea of using at least some
sort of two moving averages to maybe
dictate where the market is so are we in
a rising market or a falling market it
can be useful there and then you
basically change your strategy based on
those parameters you can also add a
third moving average and and that can
help you actually kind of identify a
rising market falling market and a
sideways market and then depending on
what type of market you're in you you
trade a different strategy so that's
kind of I think one of the better ways
to go especially if you're working on
purely like technical analysis types of
types of strategies but really even
investing or shorting it's really risky
to short in a rising market okay but
it's kind of silly to not short in a
falling market okay
so then your next question would be okay
well once I've got the strategy that I
want
what do I need to do to take that
strategy into a like live testing or
forward trading with either paper trade
or even like realistic trading situation
so what we can do is instead of running
it here let's cancel this back test from
happening and instead let's go ahead and
run a minute back test again so let's
just do the last like few days whoa what
has happened anyway there we go okay and
run that and then all you have to do is
run a full back test so we can click run
there and once this has completed this
little button here will become
illuminated so we will be able to
actually click on it but we have to wait
first for the strategy to actually come
to completion here okay so our
strategy's complete look at us we are a
market beating strategy and our Sharpe
ratio is five point three three and our
max drawdown zero point seven awesome
anyway that's just because we did a
really short time period but anyways
once it's done you'll see that we have
the option for live trading the
algorithm
great we'll choose quanto pian for now
we'll give ourselves some more money
there and deploy and then it'll take a
second for it to all start up but then
you eventually have this trading
strategy live I actually have another
one that I've been running and it's this
exact strategy actually I've just been
using it as a benchmark kind of and here
we go so this is the strategy here it's
been running for a few days now in times
it actually beats the market and then
we're kind of matching the market at the
moment but it's actually a pretty
interesting strategy and it also seems
to smooth out the market a little bit
and we've kind of seen that actually in
the historical back test I don't think
it performs very well in a pure trending
market and we've seen that it's that's
just not the case that it's not going to
beat the market in that setting but is
if there are fluctuations it will smooth
them out so but it's actually kind of a
nice start to the strategy to build
something around so we might end up
building on top of this haven't really
totally decided but I kind of like the
idea of trading either
upmarket or a down market per stock and
then or in our case we're trading these
ETFs but anyway so then you when you're
trading live you get something like this
and you can kind of see your algorithm
and its progress in a live paper trading
manner so it's a lot like what you would
see if you're trading your algorithm
truly live so anyways that's it for this
tutorial if you have any questions or
comments up to this point please feel
free to leave them below otherwise as
always thanks for watching thanks for
all the support and subscriptions and
until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>