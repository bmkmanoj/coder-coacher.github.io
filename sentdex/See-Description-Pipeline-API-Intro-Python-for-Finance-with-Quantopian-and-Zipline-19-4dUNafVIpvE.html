<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>[See Description] Pipeline API Intro - Python for Finance with Quantopian and Zipline 19 | Coder Coacher - Coaching Coders</title><meta content="[See Description] Pipeline API Intro - Python for Finance with Quantopian and Zipline 19 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>[See Description] Pipeline API Intro - Python for Finance with Quantopian and Zipline 19</b></h2><h5 class="post__date">2016-03-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/4dUNafVIpvE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody welcome to
part 19 of our quanto pian tutorial
series in this video in the subsequent
videos what we're gonna be talking about
is the pipeline API which was released
back in October of 2015
yeah you have the pipeline API is to
give you a lot more power when it comes
to figuring out which of the maximum 500
companies that you can reference in real
time regarding their prices which of the
you know let's say eight thousand plus
companies at any given time do you do
you want to reference so in the past you
really only have very crude means of
figuring out what those five hundred
companies were gonna be generally I went
by market cap or something like that you
could do some basic fundamental stuff or
whatever but for the most part getting
yourself to those 500 companies was
oftentimes very arbitrary you weren't
able to use as much as you should as far
as logic is concerned so with the
pipeline API you can begin to apply a
lot more logic to the entirety of
possible companies before you Whittle
them down to the 500 maximum that you
still can only reference in real time so
I think the best way to understand that
is to actually just go through it but
first I'm going to explain a just a few
things so the pipeline API is referenced
in their documentation you can come here
and learn about the pipeline API a bit
more the only thing I'll bring up before
we even get started is when you
reference a dataset within pipeline a
dataset is a capital D capital s
datasets I can't think of a better name
but the name is also slightly
unfortunate because it's actually it's
there is no data within the dataset so
you have to apply a factor or a filter
really a factor to get data from the
data set and then use a filter to filter
down the data set so there is no data by
default in the data set you must apply a
factor
first to get data from the data set so
just remember that because that was that
drove me nuts for a little bit anyway so
that's pipeline here are factors so
pipeline has two major things factors
and filters a factor returns a
numerically valued output as opposed to
a filter which is going to return
boolean valued outputs so you use
factors to do like your calculations and
stuff like that and then you use a
filter to hopefully get that number of
companies down to 500 companies then
we'll come over to the next one
built-in factors these are a bunch of
built-in factors that you can use so
you've got the latest value latest is
just the latest value drawdown relative
strength index simple moving average the
volume weighted average price weighted
average value returns ball one finally
you can also create custom factors so if
all the built-in factors do not serve
you well you can create a custom factor
this sample of this is actually under
sample algorithms it's not under the
pipeline API in the documentation okay
let's dive in I'm gonna delete
everything here this is a brand new
algorithm and to get started the first
things that we need to do is import the
necessary libraries so the first thing
that we have to do is from quanto P and
pipeline we have to import as you might
guess the pipeline next what we need to
do is from quanto P dot algorithm we're
gonna import at at pipeline as well as a
pipeline output attach pipeline is how
you attach datasets pipeline output is
actually how you the return from
pipeline output is a data frame so
whatever you assign to the value of the
return for pipeline output is the thing
that you get to manipulate as you would
in the handled data function slash
method so coming down the next
we're gonna do is we're gonna do from
quanto peon oops I never finished
algorithm algorithm from quanto peon
pipe blind date a built-in import US
equity pricing so the reference press
prices via the pipeline you have to use
this data set here and there are a few
built-in data sets with the pipeline and
then finally we're going to say from
quant opium dots
factors we want to import simple moving
average so this is we're going to use
one of the built-in factors and that's
just going to be a simple moving average
as you might be able to guess we're
gonna apply the simple moving average to
the built in data which is US equity
pricing great so what we're going to do
now is we're going to define our
initialize I'm gonna call them functions
I think from here on out I'm not really
sure what they're supposed to be from
zip line they're their methods I thought
it's been a while since I really looked
in but I'll call them functions from
here on out
so anyways define initialize context is
what we pass through this is all part of
what we've talked about before and then
we're going to define our pipe is equal
to the pipe line so it's just a pipe
line object then we're gonna attach
underscore a pipe line we're going to
attach to pipe and this one the name of
this pipe is just pipe line tutorial
call it whatever the heck you want so
then in our initialize we're going to
begin with defining basically some
factors that we want to be a part and
then we will add these to our pipes so
for example we're gonna say we're going
to create a 50 moving average and a 200
moving average okay
so the 50 moving average will be simple
moving average I'm just going to copy
that paste and then here you say the
inputs will be equal to and this would
be a list we just have one element but
still need to be a list this will be us
equity
actually I bet if you started typing
this I'm used to working in Idol so I
don't really have the autocomplete but
anyway you should I'm surprised didn't
autocomplete that anyway I'll try for
more autocompletes later anyway inputs
US equity pricing dot close and then you
say the window lane will be 50 wish I
could get I'm kind of zoomed in so the
text is big and I can't move this over
anymore
sorry then we're just gonna take this
copy paste and then this one is actually
just gonna get 200 okay once we're all
done there what we're actually looking
for in this case is we're gonna be
looking for just companies to go long so
what is a the typically the way that you
go long on a company using moving
averages well you're looking for where
the 50 moving average is above the 200
okay so the 50 moving average reacts
faster to price changes 200 slower so 50
above 200 great so we are looking
literally for the 50 to 200 ma ratio so
for example you could do something like
this we can take pipe dot add and then
underscore 50 ma / underscore 200 ma and
then we're gonna call this the MA ratio
you could also assign it to a new value
you can also add to this pipeline
literally 200 ma stuff like that but you
can also perform rudimentary
calculations as you apply it to the
pipeline so there you go finally we're
gonna do a screen here so basically this
will be like a filter for us so set
underscore wasn't one of the options
anyway pipe dot set screen we're looking
for where the where ma Wells to
underscore 50 ma / the 200 ma is greater
than 1.0 you could also probably get
away with never mind anyway
moving along what we're gonna do is
that's all we actually have to do in our
initialize
so now we're going to come down and
we're gonna say define before trading
start as usual you pass context and data
here context is the stuff that is
related to you personally in your
portfolio and all that data contains
again the data that is in the entire
universe of companies so now what we're
going to say is output equals pipeline
output remember what I said pipeline
output does so that is going to give us
a data frame that is the output from
this attach pipeline so that will be a
data frame that contains ma ratio where
the index of that data frame is the
actual equities is the equity itself so
before trading start does that then what
we're gonna say is we're gonna say
context up my underscore universe so
we're just making a new one here
universe equals output sort we're going
to sort by MA ratio we want to sort
ascending normally is defaulted so dot
sort is a pandas dataframe operation
here so remember this is now a data
frame so to do anything we can do to a
data frame so when you sort by default
it will sort in ascending order we
actually want to sort in descending we
want the strongest ma ratio so ascending
will actually be equal to false and then
we're gonna say dot I Lok and this just
yet this is a way for you to slice a
data frame by row right because normally
if you try it if you did not use this
and you've said like this you would be
trying to reference a specific column
basically so anyway dots I and we're
going to take the first 300 values now
we're going to update underscore
universe and we're going to say the
context mine universe oops my underscore
universe
and the universe of data is actually
going to be the index of this here so
remember this is a data frame your
universe is a list of equities so a list
of equities with an index I'm sorry I'm
confusing myself now the output is a
data frame with an index that is
equities but the actual values of the
data frame are these ma ratios whereas
the universe wants to just be equities
so the way that we're populating our
universe before trading start so every
day is by context my universe index it
would be easy to forget that dot index
okay so now what we're gonna do is we're
going to we'll just we'll just build it
will work on handle data the next
tutorial but we'll just do something
simple here so define handle data and
then again with handle data you pass
context and data if you can put an
investor to type in by now there we go
and and we're gonna do log info and then
we'll do a new line plus the string
value of context dots my universe my
universe dot head and that should be
good enough so we'll just log that and
make sure we're getting something from
this algorithm so we'll go ahead and
build here let's see what we get or if
we get an error or something like that
if we don't get an error well proceed to
the next one actually build a strategy
within the handle data cool okay so
cancel the back test sure enough here
what we have is recall context up my
universe is literally the equal is what
we assigned are defined as the output
only sorted in the first 300 so as you
can see here the the top ticker for us
in this case was you are re I'm not even
sure what that company is in all honesty
but anyway that exists I don't recognize
any of these diggers
but that's the whole point is these are
probably stocks that you would never
have referenced in the past so many ways
no errors we're correctly referencing
the data so now we're actually ready to
build a strategy that references ma
ratio and the only reason we were able
to get to this point is via the pipeline
API without the pipeline API it just you
wouldn't been able to reference all
those companies in the first place and
generate the MA ratio okay so if you
have questions comments concerns
whatever up to this point feel free to
leave them below otherwise as always
thanks for watching thanks for the
support and subscriptions and until next
time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>