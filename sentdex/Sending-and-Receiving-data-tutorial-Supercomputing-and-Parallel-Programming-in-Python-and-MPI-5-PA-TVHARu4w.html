<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Sending and Receiving data tutorial - Supercomputing and Parallel Programming in Python and MPI 5 | Coder Coacher - Coaching Coders</title><meta content="Sending and Receiving data tutorial - Supercomputing and Parallel Programming in Python and MPI 5 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/sentdex/">sentdex</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Sending and Receiving data tutorial - Supercomputing and Parallel Programming in Python and MPI 5</b></h2><h5 class="post__date">2014-03-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/PA-TVHARu4w" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">what is going on everybody welcome to
the fifth video in parallel programming
and supercomputing in this video and
actually in the last video but we did
was we just learned a couple more
commands and just did some simple math
just to show that it was possible in
this video we're gonna learn one more
command and then we're actually gonna
send and receive data so that's the most
exciting part so far is we will finally
pass a message that's exciting anyway
besides just printing out stuff I
suppose so again as usual from and pi4
PI import MPI then we're new comm equals
MPI comm underscore world if you wonder
why I type this every time it's just a
good idea to get comfortable with it if
you don't want to type it every time
that's fine but I suggest you do anyway
rank equals Condor ank sighs again we've
will calm down sighs and this time we're
gonna learn a new one and that's gonna
be named and what this is gonna return
is the name of the processor so master
zero zero one node zero zero two in my
case if you haven't changed your host
name then obviously you're gonna be
Raspberry Pi but if you did change it
you will get whatever name it is so MPI
dots get with a capital G underscore
processor underscore name and that will
return the name now what we're gonna do
is we're gonna make a message and we're
gonna cause message shared shared is
gonna equal rank plus one times five
just something nice and simple pretty
much now we're gonna say is if rank
equals zero so a nice conditional that
we've already seen we're gonna say data
equals shared and now we're gonna send
this data so we're gonna say calm dot
send and what do we want to send we want
to send data what is the destination so
dest and that's gonna equal the rank of
where you want it to go in our case
that's one we want to send it to node
one now if you remember what
mentioning in the last video was size
and we can use this to conditionally do
some stuff size is a good way to
condition or to conditionally configure
the destination so right now we're hard
coding the destination whereas what you
could do is you can combine rank and
size together so the destination could
be size - rank let's say so you could do
something like that so you can share
stuff that's really basic and obviously
you would run into a problem when the
destination is 0 - or size - 0 for
example but that would be master known
to master node and generally that is
kind of you know people would use the
master node and you can also format that
out but but anyway to send a message
through you can do something really
really simple like that or you a lot of
people would have a better algorithm
than that but just to spark your
imagination of how you might might use
that next up you would say so if rank is
0 send that data to that destination
there's also another command that we
might hit on later and that's the tag
command and you can tag it with
something say oh this is you know
message X but we're not gonna get into
that for now so anyways condescend and
then let's just print out some stuff
we're gonna say from rank rank we are
actually we sent data okay next we're
gonna say L if rank equals one data the
equal hoops data single people their
data equals comm dot re Seavey's for
receive and where do I want to receive
this from well we're receiving it from
source 0 so obviously rank 0 master node
data is this and it's sending that data
to node 1 which is a worker node and if
when this worker node runs this script
it's gonna realize it's Rank 1 data is
gonna be com dot receive source 0 and
then we're gonna say print
on node rank we received data okay so uh
here we go we're gonna save this and
again I'm gonna move this to both pies
now SCP five so minimize this up arrow
and I'm gonna change mine to five again
if you're not changing your file name
obviously I don't have to hit enter and
we run so from rank zero
we sent a five on node one we received
five so so again it was just ranked plus
one times five so obviously that five
makes a whole lot since and so now you
can see how we've shared this data
between the ranks and as you can see not
only have we just shared data we
actually shared a slightly a bit of an
object because we shared whatever data
is stored so we sent data over and then
data represents whatever it represented
here so you've sent that stuff over
we've stored it in the same named
variable and we were able to obviously
spit out that exact identical variable
so that's gonna conclude this video and
really your first example of truly
sending a message over MPI and receiving
it and all that and then starting to use
it obviously in this case we just
printed it out but hopefully you can
start to see where this might become
beneficial and just for kicks though
what if we did something like this what
if we flip these around so we'll say one
zero so in this case and then
destination zero one so here we're gonna
say if we're Rank 1 what do we want to
do data is equal to this so this time
it'll be Rank 1 plus one times five so
ten then it's gonna send that to
destination zero which is the master
node and then L if you are the master
odhh receive this data right so let's
save that and again I'm gonna move this
over and again and let's just run this
one more time and then again it says
from rank one we sent ten on node zero
we received ten so again it it was
willing to wait so we can run this a few
times and it could be assumed that maybe
every now and then something is quicker
than the other thing especially rank
zero right
node zero in theory should be quicker
than node 1 because node 0 is just
trying to receive a message whereas node
1 is actually trying to calculate
something and send it so you would
expect that it's totally possible that
that node 0 wouldn't have got it in time
the other way and then we flipped it so
where node 1 actually you know does this
first and it still obviously works so I
just wanted to bring that up but there
are there will be times when you're like
you're waiting for something to occur so
for example let us do let's say let's
let's just flip this around again so I'm
just going to ctrl Z ok so now let's
import time and now Frank is 0 we're
waiting - I'm sorry and the initial one
was we were sending or we were sending
data to Rank 1 right from 0 so now what
we what we can do instead is let's say
let's just throw before we do this let's
time sleep like 5 seconds we'll save
that and now let's move that over again
close this running okay so now you can
see that both nodes like it literally
what it's gonna do is it's going to wait
for that data so it's gonna wait to
receive that data so it's not like it's
going immediately through everything so
there are gonna be some times when order
is somewhat important but that's mostly
for like the logistics of sending and
receiving stuff and at the rate of
calculation but when it comes to
actually needing to know like well this
code has to be you know the send and
receive has to be calculated first in
time for that receive for there to be
anything to be received and all that if
there's nothing there it's just gonna
it's gonna sit there and like wait so
anyway just keep that in mind and then
also this one's becoming a little longer
than I intended but let me do this so
what if we did something like this from
rank we sent data and we move the sleep
to after that so now let's save and let
me move this file again so now it will
have sent that data before it begins
it's a little wait time so this and you
can see that what from rank 0 we sent
the 5 we got the 5 on node 1 and
obviously we had the sleeper and that's
why it took a while for this whole
process to end but again it was
everything was done in time and this is
a really great representation of
processing that's happening still over
here even though rank 1 is is reporting
stuff even though this one's over here
sleeping it's not running so each each
node is really is running this separate
script on each other and we're seeing
the output at the same time so anyway I
just wanted to show you guys a little
bit of that how we can add some stuff to
it to get a better understanding of how
this process actually works feel free to
play around a little bit with it there's
a lot of interesting stuff and so
I'm kind of curious now actually about
something I wonder if like I wonder if
you took rent if you say you know we
were on a run on three nodes which would
revert back to the master node as a
worker node and you did something like
this again to it and made a sleeper if
it would continue running the script or
not I'm really curious I don't know if I
want to add that so maybe I'll add it
just just for kicks so let's say we'll
come down here and we'll send this data
to two nodes this one will come to two I
am just really curious sorry guys
because I haven't actually tried this
one yet
so now we'll say Ella Frank equals two
we'll take that okay cool
so now in theory when we run this even
though we've got quote unquote three
nodes like I said to you guys like you
could do this with like making up kind
of like a pseudo node when we run this
we're gonna say number of processors
three and it's gonna revert to and we
never used our name variable let's go
ahead and put our name variable in there
just just for kicks to just so you can
see again what which one we're using so
node number three ranked two should be
master again so it'll just cycle through
so anyways let's just save this and I'm
just curious if this sleep will affect
here in theory I would assume it would
but I'm curious now so let's run that
this video isn't gonna be too long come
down here up arrow
come over here well first let's just
test this against yeah let's see
Oh invalid rank because we specified
rank three ranks so we have no choice
but to say number of processors three
okay that is too cool okay so that's
interesting because python is singular
threaded and it looks to me like we have
passed that single thread I'll have to
use this on one of my more powerful
computers and see if in a single script
you can use
pi2 to surpass that so I've never silent
heard anybody say that they've done that
so you can use like your full CPU
usually you use like threading or
something like that maybe in the back
end it's threading but if you don't know
what I'm why I'm so happy about this is
on the master here and here as you can
see these are two master nodes and on
our script here this rank 0 which is a
master node as a command to sleep for
five seconds that's why it hangs at the
end for a few seconds meanwhile rank 2
is a master node so right here master
zero zero one so while this was sleeping
running some code in sleep time this one
still outputted the 5 I am thoroughly
impressed that's interesting that is too
cool I'm pretty excited about that I'll
have to try that with like a bigger
example I'm not really sure if that is
if I'm being fooled by something here
but it sure looks like you've got
threading going on when that's the case
anyways that's pretty exciting I'll have
to play around with that on my main
computer so hopefully you guys enjoyed I
actually enjoyed this video pretty
pretty well so hopefully you guys did
too
anyways that's gonna glue this video as
always thanks for watching thanks for
all the support and subscriptions and
until next time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>