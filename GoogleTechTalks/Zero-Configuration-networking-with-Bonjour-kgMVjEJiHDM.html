<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Zero Configuration networking with Bonjour | Coder Coacher - Coaching Coders</title><meta content="Zero Configuration networking with Bonjour - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Zero Configuration networking with Bonjour</b></h2><h5 class="post__date">2007-10-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/kgMVjEJiHDM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is George treasure he got his
undergraduate degree at Cambridge and
then we were inflicted with him at
Stanford and and then he had networking
at apple and he invented zero
configuration networking and of course
marketing people
I got
I like to start off by asking for quick
show of hands who here has hired me give
presentations about Bonjour zeroconf
before okay just just two or three
that's good so I won't be boring too
many people then I want to remind
everybody here that this is the first of
the googletechtalks that is going to be
recorded and published on google video
on the public internet so your feet are
free to ask any questions you like but
don't ask any questions that relate to
proprietary secret google projects that
you know on the public to know about yet
so I'm Stuart Cheshire as Anna said and
zero configuration networking is
something I've been working on for
almost ten years now really as a result
of the frustration i had with networking
devices computer devices that were just
too hard to use and it wasn't such a
hard problem to solve I just got tired
of waiting for somebody else to do it
and decided I was going to have to do it
myself I want to thank Tim O'Reilly
who's been a huge supporter of this and
we recognized that the potential here
and persuaded me to write a book about
it which is coming out next month it's
already appearing on Amazon we don't
have a cover picture yet so we don't all
the animals going to be I mentioned that
because it's the question everybody
always asks me know I don't know what
the animal is yet but he's been a huge
supporter and as done a lot of work
evangelizing this so the goal here is
that I want network devices to be like
buying a table lamp you plug it in you
turn it on it works right nobody ever
has a table lamp that doesn't work
because they didn't configure the subnet
mask correctly it's it's just insanity
and appletalk did this 20 years ago so
we know it technically possible it's
just that the IP community didn't care
about his abuse like that I mean to be
honest if you are running a UNIX machine
10 years ago you have bigger problems
than worrying whether you got your
subnet mask right
there were other things to configure
than that so what do we mean by zeroconf
what I'm going to be talking about today
I expect right now immediately will be a
sort of academic interest to this crowd
I expect most of you here out of
curiosity because what Google does today
with Gmail and frugal and web search is
very resolutely at the grand scale of
networking of big data centers and
global scale networking and I really
inhabit the complete opposite end of the
spectrum where it's literally it's as
simple as two laptops plugged together
with an ethernet cable and they want to
communicate and the wide area networking
right now with with the excitement about
the web i think is being served pretty
well but it's the local area stuff
that's being badly neglected so we're
interested in a couple of laptops maybe
Nathan at hub and a printer maybe some
wireless networking and of course we'd
like to scale this up as far as
practical but but we're not trying to
compete with today's managed
infrastructure networks because when you
get to a network of 100 machines or
thousand machines you start to need some
kind of policy and management and we're
not trying to compete with that the kind
of things were aiming at and I brought
some demo gear along here one of the fun
things about this is that whenever
companies make zeroconf products quite
often that they give me one for testing
and we do a bit of debugging and then I
end up putting it in my demo bag for
afterwards and everything here except
one is actually not an apple product
which is the other thing that makes me
really excited is we could do appletalk
all over again at Apple and nobody would
really care but getting a message out to
the broader community is what's
important so a lot of these things are
low-cost very limited memory slow
processes and that means we need a
simple solution and many people have
recognized the difficulty of ease of use
in IP networking but the problem is they
couldn't rein in our ambition to throw
in every
feature they could think of and you
ended up with something that was
unimplemented I mean sure you could
implement on a desktop PC with a
gigabyte of ram and a gigahertz
processor but in simpler devices even if
you could make the code fit the
complexity of debugging it just turns
out to crush this when you're building a
network protocol the way to succeed is
just uncompromising simplicity because
if you can have an ecosystem of
thousands of devices the opportunities
for mistakes an incompatibility just
mushroom so you have to start off with
some think that's absolutely simple if
you hope to succeed to solve that
problem this is the design principle I
learnt at IETF meetings that a protocol
is complete not when there's nothing
left to add but when there's nothing
left to remove and that's actually that
quote predates network by a long time
that's a quote from a Frenchman I think
called Saint soupery and it was a quote
about aircraft design and you'll see
that we're an aircraft it definitely
makes sense that it's complete when you
can't think of anything else to remove
one question but I still have to ask
after nearly 10 years or question I have
to answer is why I p and I've laid out a
goal right now of what we want to do in
terms of ease of use and there are many
ways we could solve that and the way
that I believe is the right ways IP so
if we look back 20 years in the history
of wide area networking and most people
in this room are probably too young to
heed and remember this there are many
many competing standards for wide area
networking and the good news is they all
died and they're all obsolete largely
forgotten and tcp/ip is one in the same
area 20 years ago you look at what you
had on your personal computer you had
all these different connectors and the
good news is that those all have died
and faded into obsolescence but the
problem today is you look at the back of
your computer now and it's still
bristling with all these incompatible
connectors and communication
technologies or for local area
communication and whether we as a
networking community as an engineer a
community
doing about this problem we're making
even more different incompatible ways of
connecting things so my belief is that
in the wide area we can all see the
benefits now of adopting a single
standard technology that everybody
supports and the benefits of doing that
in the local area should be clear and
I'll take a step even further and say
the local area protocol should actually
be the same one that we've adopted for
the wide area and some people in this
room are probably thinking he's crazy
that's dupid you know why would you want
to be setting up all that configuration
and the little thought experiment here
is well if we could make high p so it
didn't need configuration maybe it could
do the job that we do today with things
like USB so what do we need to do to do
easy networking with IP well all this is
very straightforward and very obvious
and if you walk out of this talk today
saying none of that was very clever that
was really obvious then you got the
point because that is really as the
message I want to get across it really
is straightforward and obvious so to do
IP network inc you need an IP address
you know if you do much network until
you have an address so that's the first
problem to solve once you have an
address you can communicate but human
beings don't really want to be typing in
numbers so we want naming and the third
thing we want is the ability to browse
the network and discover what's there
and traditionally today lan IP network
we don't have very good browsing but
appletalk did and we want to get back to
that level of ease of use that we had on
small networks with Apple talk so very
simple solution here because we want the
simplest most reliable most easy to
implement solutions and again a lot of
the inspiration comes from the way
appletalk used to work pick a random
address send an ARP request if nobody
answers that request then you say hey no
one's using this address it's mine
that's how you are Kate self-assigned
link local addresses
in IP after many years of wrangling and
debate in the IETF we published the RFC
for that this year so that's now an ITF
standard and it's very straightforward
these addresses are only good on the
local link nobody on the outside the
planet can use that to talk to you but
if all you need to do is print a
document from here to there an address
on the local link may be perfectly
adequate for what you need this first
showed up in Windows 98 and Mac OS 85 so
this has been around for five years now
and people are probably familiar with
these 169 dot 254 addresses and normally
when people see them they curse and kick
the computer because the network's
broken and it's understanding
understandable why people would think
that because you're kind of seeing one
leg of a three-legged stool and until
the other two legs are in place having a
random IP address doesn't seem to buy
you very much ipv6 already has linked
local addressing what we're doing here
is not competing with ipv6 we we fully
support ipv6 but we also recognize that
many days devices still only to ipv4
Maxton v6 linux does v6 even windows
does v6 now but many of the lower-cost
devices that we want to be able to
communicate work don't so now we've got
a bunch of random addresses so in
principle the devices can communicate
but you don't to be shouting IP
addresses across the room and typing
them in so we want naming now we're
following the same principle before of
simplicity just as before we wanted the
simplest way to get my period rest when
we didn't have a DHCP server we're now
looking for the simplest way to do
naming when we don't have a DNS server
so we use the same DNS query syntax the
same packet format the same naming and
record types but we multicast it to
every machine on the local link and each
device runs little responder that's
listening for those requests and when it
sees a DNS query for its name it says
hey that's me and it gives a standard
DNS response and from the point of view
of
a DNS client a resolver clients it
barely has to know what has even gone on
here because it sent its dns query to
this address to 2400 251 which happens
to be a multicast address but the dns
client doesn't really need to understand
what that means and then you get a
response coming back it has the answer
in that you're looking for so it looks
very much like a normal dns query but
without the server on the network now
there are some rules that have to be
followed here the devices have to call
cooperate with each other if they both
want the same name then they both can't
have it and the some conflict resolution
that goes on that but from the point of
view of the query ER is more or less a
standard query and that gives you now
the ability to use conventional style
host names in your web browser on the
command line you can ssh to my computer
local and all of those places that you
would normally use host names today you
can now use dot local host names and
just like with the link local addressing
we can't off a chunk of the IP address
space and said anything starting 169 dot
254 is defined to be linked local scope
only with no global significance we did
the conceptually similar thing with the
DNS name space where we carved off a
subtree of the DNS name space and said
that anything that falls under dot local
is by definition local significance only
and the upside of that is that anybody
can use one of these names you don't
have to pay for thirty-five dollars zero
or register it with anybody the downside
is that privilege that you have is also
afforded to everybody else as well so
you have to you know you trade off the
central authority in the money for the
requirement to at least collaborate and
cooperate with the peers around you and
not be hostile in a hostile environment
this is not the solution you'd want
multicast DNS showed up in mac OS 92 in
mac OS 10 nicta a research organization
australia wrote the version for linux as
an NS which plugin and in bonjour for
windows from apple we have a name
service provider plugin that implements
dot local
look up as well so that's good we've got
back to sort of feature parity with what
people expect of internet networking
which is IP addresses names that you
type in but you have to know the name
and you have to type it correctly if you
missed a pet it doesn't work and nobody
really tells you why and/or suggests
what you should have done so what we
want to do is even go beyond that to
just browse and discover what's on the
network without having to know in
advance and I'm not claiming that were
the first people to think of this the
list of attempts to do discovery
protocols over IP just goes on I think
every permutation of resource and
service and discovery and location in
all possible orders that's been used and
when they ran out of those acronyms they
made up other ones and why did they fail
well I think they all couldn't resist
the urge to keep making things more
complicated and when you're building one
side in one client and one server you
can put them on a test Network and test
them and debug them but when you're
developing a standard that's going to be
used by thousands of devices many of
which will never appear on the same
network until that happens in some
customers home the the matrix for
exhaustive testing of all combinations
becomes impossible and if you can't do
exhaustive testing your only assurance
that it's going to work is to keep the
protocol so simple that there's almost
no way to make it go wrong and there's
always ways to make things go wrong but
you have to ruthlessly eliminate every
possible opportunity for things to be
misinterpreted or implemented
differently and it's a bit sad because
we're not inventing this for the first
time we actually have apple talk to copy
that sets an example of how this can be
done so I don't dwell too much on the
failures let's talk about what we've
done so in this whole presentation if
there's one thing that I would say is is
not the obvious part it's this and that
was the insight that we've already
agreed that devices are going to need
link-local addressing and they're going
to need some kind of naming so
because DNS is the answer for that
having the greed that these little
devices have got to have those two bits
of code in them maybe we don't need a
complete third body of code for doing
discovery maybe we can actually
repurpose some of that code that they
have to have any way and that was the
breakthrough realizing that we can do
service discovery using the semantics of
DNS queries and we don't need to invent
a new protocol and then we can run that
DNS over the multicast DNS support that
we've already created and the insight
here is that we can put together some
existing properties of DNS that are not
new they just haven't been used in this
way before and one of those is that a
DNS query can return multiple answers if
you have a multihomed host you do a
queer you get more than one IP address
this as normal another function of DNS
is PTR records there normally is for
mapping addresses to names but in fact
it's a pointer it's a link from
somewhere in the name hierarchy to
somewhere else in the name hierarchy so
we can use those and the third property
of DNS is something called SRV records
which have been around for about five
years they're not new they're supported
by bind date and bind nine and what an
SRV record does is it doesn't just give
you the hosts were service runs it gives
you the port number and that just fixes
little oversight in the way DNS was
structured the reason you can't run more
than one web server easily on a machine
is because they can't both have port 80
and this hard coding that a particular
service always has to be on a particular
port we're just because the directory
service doesn't have any report to use
when you type WWE google com into your
browser it tells you the IP address of
google coms web server but it doesn't
tell you the port number to connect so
you end up pulling this number out of
the air in think you know what must be
80 well if the directory service can
tell you that number you then remove
that limitation and you can run any
number of instances of any service type
on a single machine and they're not
fighting over the same well-known port
so that is the framework of DNS service
discovery and using those operations we
provide three
api functions you can register the
existence of a service that you're
offering clients can browse to find all
the named instances of a particular
service type that they know how to use
and then at the time of actually using a
service you resolve that name to the
address and port number because in a
world of dhcp link local addressing
addresses are not stable names are
relatively persistence and stable but
addresses could change day to day minute
to minute so that's why the service
discovery doesn't find addresses it
finds names and then at time of use you
resolve the name to an address so I'll
run through a quick example a printing
client knows how to speak the IPP
printing protocol so it asks a question
of the network effectively saying I
speak IPP who out there knows how to
talk my language who's willing to talk
to me and editions this query on the
network in this case it's dot local
which means multicast on the local
network but because this is a standard
DNS query that could be google com and
it would be a unicast dns query to the
name server to ask the same question the
answer we get back is in this case we've
got for example records structured like
that and the first layer of each of
these records is the user friendly name
DNS host names are traditionally letters
digits hyphen is no upper case no spaces
the DNS protocol itself doesn't have
that limitation it's a convention for
host names that you have to type on the
command line and given that you don't
type these things on the command line
we're free of that restriction so any
utf-8 kanji whatever characters you want
are fully supported and they go in the
DNS practices utf-8 appletalk you used
to have a structured namespace with name
type and zone and we have a similar
thing here we have the first label is
the user-visible name the second two
labels define the service type in other
words the application protocol that this
service uses and then the rest of the
DNS name is the domain where that
service is being advertised
a bit more on service types is warranted
a lot of service discovery protocols
that have been done before are organized
around device discovery because as a
human being that's the way you naturally
think about things initially is finally
the bits of hardware on the network you
know I want to connect to a printer but
you think if the printers being this
physical thing from the point of view of
your software it doesn't care about
plastic and metal it cares about
entities on the network that speak a
protocol that here too understands and
if this is an apple talk printer that
doesn't do IP well then it's not a
printer as far as I'm concerned because
I can't talk to it so don't find me
printers find me things that I can talk
to and a print service might be offered
by a computer that's got a USB cable to
a printer so the notion of what really
is a printer and what's not a printer is
a little bit slippery but the notion of
what implements the IPP protocol is much
better defined there is a list of these
registered service types and it's up to
about 250 registered application
protocols that are advertised and
browsed for using DNS service discovery
or bonjour as Apple likes to call it I
mentioned resolving I'll quickly cover
that so let's say we want to use the
sales printer and that has been set as
our default printer but every day when
we print the IP address could have
changed so at print time we do this
query we ask for the SRV record and we
ask for the txt record and the SRV
record tells us that it's on ports 631
and a host called my printer dot local
and by the magic of DNS it can put extra
helpful information in the reply that
you didn't ask for if it thinks you're
going to need it so with one round trip
to the printer we get this information
we know the address we know the ports
and the txt record contains additional
name value pairs in this case it tells
us that this printer supports the
PostScript page description language a
real txt record for printer is about
half okay long and tells you whether it
does color and double-sided and stapling
and all the attributes of the printer
the full support for this third leg of
zero configuration networking appeared
in Mac OS 10.2 and it's open source and
it's real open source in spirit not just
in name the CBS server we have is public
day-to-day anytime and the engineer at
apple checks in code you see it in the
public CVS server so you see things in
the CBS server before they actually
shipped with iOS 10 systems the code is
intentionally written to be very very
portable so it runs on POSIX systems
like Linux like Solaris like FreeBSD it
runs on Windows it runs on windows ce e
runs on vxworks little embedded devices
and there's a simple adaptation layer so
the core code needs to send packets
receive packets set timers for future
events and if you want to run this on a
different operating system or different
environments you just have to implement
that adaptation lab one of the things
that plagued appletalk was a reputation
for chattiness and that was somewhat
deserved somewhat not deserve but we
want to avoid doing that so one of the
things that does differentiate multicast
DNS from Apple talk is very very
aggressive techniques to limit the chat
ennis on the network there's opportunity
opportunistic caching of everything that
the responder sees in case you want to
know about that later when you do a
query you list the answers you already
know because in apple talk you would
query for the list of laser itís and
you might get 20 responses but because
Packers get lost Yuri transmitted the
query and you get the same 20 responses
again over and over again in multicast
DNS we have a way of listing the known
answers so that all those guys don't
answer a second time when it gives the
machines you missed the first time round
a chance to answer without being stomped
on when you've got a lot of machines on
the network you could get in the
situation where the fast ones
always a beat the slow ones and then the
slow machines are the ones whose packets
get lost when the queues overflow so you
can get systemic failure where the slow
device is always being missed so
actually suppressing the ones you know
about and given the slow ones a chance
to answer is very important we have
super question suppression safe eyebrows
for printers and then you want to print
you don't have to do the same query
because it's already in your cash lots
of other techniques we don't clear the
network at a steady rate we do
exponential back-off so if you leave the
printer browser running it'll back off
to one query per hour so it's very light
load on the network now if you're
querying once per hour and you plug in a
printer you want to know about you want
to wait an hour for the next retry and
we don't have refresh buttons and things
in the user interface because that would
just be horrible so when a new service
comes on the network it announces its
presence so that it shows up immediately
in browsing clients and then those
announcements have a similar exponential
back-off so lots of things like that
with the long TTL in the cash you can
you run the risk of having stale
services remain after somebody's turn
the printer off it's still showing up in
the list so one way to solve that is to
have a short time to live so things
expire quickly but that costs you in
terms of network bandwidth so we took a
different approach where we we let
things stay in the cache but when you
try to use them and the connection fails
we use that as a hint to feed back to
the cash management algorithm to say you
know I think this thing that you told me
about is actually gone can you check
again for me and then taking that even
further the other clients on the network
witness your failure to use the service
and your attempt to reconfirm its
existence and they update their caches
as well so typically what happens if
somebody doesn't plug the printer is you
try to print you fail you look back in
the list and it's gone you now have a
mental model of what happened you say oh
somebody must have turn the printer off
the truth is they turn it off half an
hour ago but the point is you have a
mental model that doesn't make you
frustrated if you tried to print and
file and you look back in the browser
and it's still there or then you start
getting annoyed with the compute
so this is kind of self-healing
everybody else on the network gets their
list updated so any one person go
through this and everybody else gets the
benefit there's a question back there
the question was how the other clients
get their list updated and the answer is
that as well as send inquiries by
multicast we sent answers by multicast
as well so all clients a party to the
exchange that's going on they see the
crew as they see the answers when they
see the answers they cashed them when
they see a query that doesn't yield an
answer they were expecting to see for
that query then that gives them a hint
that that data in their cash is probably
false and ought to be purged so this is
where I will show a bit of my demo
hardware and I know today that Google
Google's main business model right now
is in the wide area services but I
predict that in the future with the way
Google is getting so many business areas
right now your focus is getting
information to a web browser on a
desktop computer but that's really just
the tip of the iceberg and when we start
looking at video and images and music
and wanting to get this data to all
kinds of devices all around the house to
the television to the hifi to little
tablets that you carry around soup
things we might not have thought yet
then the ability to seamlessly throw all
this stuff together and have itself all
guys and self configure it is going to
be critical for those products to
succeed and many attempts to do things
like that today things that plug into
your hi-fi and play music I've just been
horribly horribly difficult to use and
if you look at the reviews in magazines
and on the web of these things the
journalists are absolutely scathing I've
seen reviews where a journey spent an
afternoon struggling spent an afternoon
struggling to get a particular music
player to work and then just gave up and
the review was not that he was hard to
use but he couldn't make it work and
he'd send it back so let's see
you and we start off with one of my
favorite things this is a little network
camera made by access and while the
other reasons that this is on my
favorite things is that it also does
power over ethernet so no power brick
you just plug it in and I run Safari and
this thing runs linux ah ok let's do
so this thing should be booting up now
there you go and one of the reasons that
USB popular is because you just plug it
in and it works and for low power
devices you don't need a power brick and
now I know that USB is entrenched and
they don't expect that to change but in
sort of some fantasy academic parallel
universe if we've done this about 10
years ago then maybe we wouldn't even
need USB for many of these things today
because 0 provides the plug and play for
this power over ethernet provides the
power you've now got something that is
every bit as easy to use as USB except
the cables can be a hundred meters long
and the speeds can be a gigabit per
second so you've got something much much
more capable than USB without
sacrificing the ease of use so i plug
this in I have no dhcp server I don't
know what its IP addresses I don't care
what its IP addresses I don't care what
its name is because Safari just found
that we have a network camera access to
11 and what Safari did there was when I
clicked on the Bonjour list it did the
browsing operation I talked about it
said wat out on the network speaks HTTP
and the camera said I do so Safari
displayed the name and now when I double
click here
now if any of you have spent the
afternoon it normally takes to get a
network camera working you'll appreciate
what i just did here those of you who
haven't I kind of looking at me saying I
don't get what was so special about that
when you plug it and it worked I mean of
course that's what it's supposed to do
isn't it and you like that that is what
it's supposed to do and it's just tragic
today that so many devices don't now you
know sticking video in a web page is
kind of convenient because the web
browser has become the kind of universal
user interface for devices today if it
doesn't have a screen in the keyboard
the web browser is how you configure it
20 years ago the universal interface was
the serial port in the vt100 terminal
and would move beyond that but but we do
have this problem that without zeroconf
you don't know what address to type in
which leads us to this crazy situation
where things shipped from the factory
with certain hard-coded addresses and
then the manual tell us what the address
is and if that address is not on your
subnet you have to reconfigure your
machines networking settings before you
can communicate with it and if you are
trying to read the instructions on the
company's website what you've now just
lost your connection to the website so
you can't see the next page of the
instructions and if you plug two of
these things and they can't both have
the same address it's this is just
clearly so much better but video on the
web is it's a pragmatic thing but the
other thing I was very excited about
this camera doing is it's a camera it's
a network device so it doesn't just
offer HTTP service it also offers RTP
streaming video / UDP and quicktime
player in QuickTime 7 actually browsers
for we go openurl and pull down this
menu it finds RTP sources on the network
and what we're now saying is video not
wrapped inside an HTML HTTP wrapper but
just warn
RTP video streaming of UDP packets and
any application protocol you have can be
advertised using for short using DNS
self-discovery and clients can browse
for that yeah the core programming
energy why get it right every time well
the question is how you find the second
camera well you give the cameras names
if I'm actually a question right and
then even though the address has changed
the names are persistent so you look it
up by name and and and that's how you
find I mean it first second third tenth
whatever it is you that the identities
have names like files in the file system
does that when this device it ships from
the factory with a default name but
through the web interface you can then
configure it to choose the name that you
want so out of the box it calls itself
access to 11 what you would do is a
typical user if you have more than one
of these if you are sort of building a
security system for your house you would
call them garage garden front porch you
would give them user meaningful names
and the web UI is an ideal way to do
that that's very convenient question
before device the question is what
happens if you have to plugged in before
device advertises its name it does a
query and if something answers that
query then it appends dash two on the
end of the name so out of the box if you
plug 10 of these em they become access
two three four five six seven eight nine
ten but if you have that many your first
step is typically to rename some of them
now you don't have to if if you've got
to and you've got access and access to
and you know which one is which then
access to maybe a perfectly fine name
for you so there's no obligation free to
change it but there's that option if
you'd like to give it a user meaningful
name question at the back there
the the question is about the race
condition if two devices do it at the
same time and the at the end I'll show
the URL but there's a URL zeroconf torg
which has links to all the documents and
specifications and the other related
websites but that when two devices query
they see each other's queries and seeing
another simultaneous query for your name
is also treated as a conflict that is
resolved with a tiebreaking algorithm
yes is it just an extension of USB I
would say it's a lot more than just USB
because you can have many more devices
you're not limited to six feet of cable
because this is IP it's agnostic to the
to the underlying communication hardware
so it can be Ethernet it can be eighty
two dots 11 wireless it can be IP over
firewire in future it can be whatever
new things to Hardware guys invent and
that's the great benefit of using IP is
that whenever a new piece of hardware
comes out it inherits this huge wealth
of IP based application software that's
already been written you bring out
something like bluetooth which is
emulating the serial port it's not an
Ethernet style packet interface it's a
virtual serial cable well Apple had to
write the bluetooth file exchange tool
and doesn't the world have enough file
exchange tools already you know we have
ftp NFS we have samba we have apple
share we I mean we have SCP right which
this is infant list of what we need is
we could actually use our your spot on
that that the same is true of printing
protocols that we definitely need a good
IP printing protocol there let's let's
let's let's do it once and get it right
and not have to keep reinventing the
whale that's that's my point i think we
agree on that so before we run out of
time let me quickly run through some of
the other stuff i have here so one of
the things i told you was you can do
this wide area as well as dot local so
if i turn on my wireless interface here
and in the in the board or preference
pane i have added my home domains
jashow.org in my list of default
browsing domains and what this just did
here was unknown to safari it did a call
saying i want to browse for network
services of type HTTP and the code
behind the scenes to the dns query for
HTTP tcp jashow.org and these are just
some example ones that I sort of put for
illustrative purposes none of these
advertised services are actually coming
from my house which is one of the things
I wanted to illustrate so I can you can
include references to any hostname and
port and service you want so we can we
can double click that and it's going to
take us off to the BBC website but any
organization can advertise static
services like this just by typing the
lines in the DNS file so you know when
you stay in the hyatt hotel they could
advertise some static pages all about
the hotel there they have that
television channel that tells you by the
restaurants and the gym and the three
important things well they could do
those
the thing where they have a web page
about the hotel san jose airport could
have a web page announcing flight
departure times and because it's so
location-based they can actually fill
that with advertising for the bookshop
in the coffee place because they know
you're sitting in the airport waiting an
hour for a plane to catch so maybe you
want a coffee so there's lots of
opportunities there when we have a way
to communicate with the users in the
days of unix machines there was a
message of the day when you log on and
now with laptops and dhcp and wireless
we've lost that kind of message of the
day ability to communicate with the
people are connecting to the network the
question is how far happens the internet
is this going obviously it's not
querying every name server in the world
what it's doing is if the DHCP offer
contains a domain then it will query
that domain and the user can also
manually add domains as I did to
manually augment that automatic search
list so if we look through the Pacus
never here when I ran Safari you would
have seen a query go to google com
because i'm assuming google com was in
the dhcp packet and if google chrome's
name service that i have nothing for you
then nothing gets displayed but that's
that's the bootstrap mechanism how the
client knows which domain to query so
actually I bring that web page up again
because I can use that to show another
little example if you ever try to use a
network printer you'll probably have
experienced the grief with that it's as
bad as a network camera so let's
i'm going to i'm actually going to
delete this printer because i want to
show you um this is interesting i'm
actually finding all of google's panchal
printers in this building let's actually
want to i'm going to delete that okay so
that's more like the configuration a
user would get out of the box they've
got their new computer and they don't
have a printer and they want to print
something and this is the little apple
airport express base station it looks
like a power brick for some you know
sexy Apple product and it is a power
brick but it's also a wireless base
station and a print server and the music
server in the same housing I'll plug it
into here so you can see it
you know before you do that maybe I'll
show you one of the other things it does
i'll show you the music as well I think
I'm okay I do now actually have one of
these still in the wrapping today but
one of the things I like to do is get
somebody to time me actually take the
shrimp Rock shrink wrap off the box and
getting it out plunked in so this is
factory default I haven't set it up I
plugged it in and
well else I'll try yeah well it
shouldn't block the ability of this too
I think you maybe I think maybe FCC
regulations about the unlicensed
spectrum is unlicensed for a reason but
um well it doesn't look like something
is blocking the wireless but i'll do
i'll do it over ethernet instead
so I'm sure most of you here have seen
itunes and I know it it was just a bit
slow i think so in itunes i just pulled
down this menu here i select the new
sound output device I click Play and
normally this takes me about 90 seconds
including in the cellophane off the box
and wrapping it all and if any of you
have tried to set up some of that the
upnp hide media players you'll know it
takes you more than 90 seconds from
shrink-wrap to having music coming out
so that's the music side of it let's go
back to the print tank so we still have
no printer selected I felt the is it
plugged interested let's connect the
cable so click the printer into the USB
port and we'll see now what else do I
have to do do I need to run some Wizards
some set up a system do I need to reboot
anything nope so as soon as that
finishes booting up
under Bonjour apprentice there's my
printer I click print so that is the add
to the Box experience now in this case
I'm using a USB printer plugged into an
airport base station but if you buy any
network prints are made in the last
couple of years from pretty much any
printer company HP lexmark canon brother
xerox i'm probably missing some they
have native bonjour support they
advertise themselves they show up in the
print menu and if they have web
configuration pages then they show up in
Safari so in the the question is the
question is about drivers and this
actually comes back to like the question
earlier about file transfer protocols
what the world desperately needs is a
good network printing protocol over IP
and that's kind of a lower berth Bonjour
the idea of Bonjour is that it's a
foundation to let people build
application protocols now i am working
with the printing team at apple and we
are trying to work on that but but i
make a distinction that that's not
bonjour that's a printing protocol what
happens right now is because of the
printer makers want to differentiate
their products they all have a different
driver with different features and
different color matching and and I think
they feel but if there was just a
standard protocol for printing then they
wouldn't be able to innovate that the
real answer might be that we need
printers to support some basic protocol
for guests printing somebody comes to
your house and they just want to print a
document and they didn't care about
perfect color matching they just want
you know that they want to print out you
know the Google Maps driving direction
so they can get home and it doesn't have
to be color correct but at the same time
the printer makers can make drivers that
you can install if you if you do want to
use the extra optional features that
that I think is the answer that
PostScript is a good answer on but post
group doesn't appear in low-end printers
if you go when I go to conferences and
ITF meetings and things like that
you know I just look in the print dialog
and all high-end printers do post grips
and post group is post groups and I can
print typically at night yeah meeting
what you're printing is 80-column
monospaced text it's not exactly the
most challenging print job this is the
Roku San rich I think this is ninety
nine dollars now this sort of works the
other way around instead of the Mac
pushing music to this you kind of attach
this to your high fights go to the
remote control and its display
afterwards people are welcome to come
and talk to me and we can play with some
of these things here's one of the newer
axis cameras that's even smaller this
runs Linux you can tell that to this and
run emacs and edit the configuration
files and things some more print service
here's a parallel port one here's the
little USB one this one is smaller than
its own power brick which is a pretty
cool I mean if anything is just like
crying out for power over ethernet it's
got to be this right this is USB in one
side Ethernet the other side this is a
print server this is one of my favorites
this is a serial port to ethernet
converter and they love this in the data
centers where you've got all these this
old rackmount equipment with serial
ports on it and and you at running these
waterfalls of serial cables everywhere
to go to some terminal concentrator or
something well with these you just click
them into the ethernet on the appetite
el net service that shows up in those
who've you got max around here may not
have seen this in terminal but if you go
connect to server then you get this to a
browsing window and here at here
three-wish well here here are some
machines here at Google there are
advertising themselves a telnet so it's
now I still need a username and a
password to connect to them and Rose is
my machine at home because with the wide
area browsing it's showing up there as
well so so this thing shows up in there
in the telnet list in terminal but the
reason I love this is we had one of our
Bonjour presentations at Apple now it
early saying how the code is only 100 k
and in this era of multi megabyte
bloated applications I'm feeling pretty
smug about that and the guy says no you
don't understand this has got 16 k of
flash memory and all of that 9 k is the
HTML pages of the web UI that I serve up
and in the remaining 7k I've got
ethernet driver up IP UDP TCP dhcp
client DNS client telnet server web
server and you have 700 bites left to do
Bonjour so forget my source code we go
to the whiteboard we kind of brainstorm
the absolute most kind implementation we
could think of that might not have all
the optional efficiency features but
would generate the right packets and he
did it and this is called the site
player and they figured cycler com
that's where they sell these and this
this is a Bonjour device and it may not
be the most sophisticated Bonjour device
in the world but he did it in 800 bytes
so so that was pretty cool it is now
twelve o'clock so those of you who've
got other meetings to go to I won't be
offended if you take off but I'm happy
to stay here and answer any more
questions all right let's take on
yes why is to download 14 megabytes um
for windows how does something about
windows in stores and when you localize
it for 26 languages you know you end up
with lots of duplicate copies of the
code there and it should be more like
about 1 megabyte but I personally don't
know how to fix that if there are some
people with Windows expertise that now
too slim neck and stall it down that
would be good question over here I'm I
familiar with the valley yes over here
is a GPL open source implementation of
the bonjour protocols and it's
absolutely great and not as good as mind
of course but but actually the rate
they're going and the rate that IDing
new features and fixing bugs you know
they could well over take apples
implementation that they're really good
guys and they they they know the
protocols inside out and we talked to
them on a regular basis because I they
find timing errors that we haven't raced
conditions and ambiguities and we're
working together with them can you brush
from Firefox well that was actually one
of the things that I was hoping to talk
about today because I summary from
Firefox works at Google yes we have we
have bonjour browsing in safari with the
exposure for windows plugin we have it
in internet explorer but firefox is
clearly the dominant force in web
browsers today and may not numerically
eclipse internet explorer in terms of
impact that it's having and the fact
that it runs on mac and windows on linux
means that it's something that i really
really want to get a volatile browsing
venue into firefox
default route services are now get from
your obviously can you advertise a
default route on the that the answer I
have to that is really trying not to
compete with existing technologies that
work well and a home gateway with a DHCP
server in it is a perfectly fine way for
clients to get an address and get a
configuration get the name server
address and all the other information it
needs so at the addressing level we're
not competing with dhcp link-local
addressing is the safety net for when
dhcp isn't there the multicast dns and
the service discovery are useful and
still applicable even if you do have a
dhcp address but the addressing is there
as the fullback for dhcp not not as a
competing replacement for it the
question is about the belt local TLD and
I could do a whole hour long talk about
IETF politics here but there was a lot
of controversy in the IETF the DNS
extensions working group felt that local
namespaces were a bad idea they thought
that RFC 1918 that defines the net10 and
the other private address basis was a
bad idea and they said that DNS would
not make the same mistake that I've seen
1918 had made now their view is that
every device in the world needs a
globally unique name nat is evil private
addresses are evil the point of the
internet is that everything is reachable
from everything else and I completely
agree with that goal that's a wonderful
goal that that's what the internet
should be and things like NAT do really
interfere with the ability to make good
products things like ichat AV
for the video conferencing has to go to
extraordinary lengths to try to work
around the problems that that creates
and even then it doesn't work all the
time so I have low sympathy from for
their point of view where I disagree
with them is in order to just print this
page my printer did not need a global
unique globally addressable dns name
that i pay 35 dolls the original calm
for and and that was where we disagreed
and they and they said well don't use IP
use USB write it so it's always
demeaning to the grand IP to be used for
such a mundane local communication tasks
unless a protocol should do that and
nearly it was it was to poke you of the
DNS extensions working group to define
the standards for how DNS work and they
they advocated that responsibility and
said sort of let chaos reign and that's
a problem note that the reality is that
with over printers and the cameras and
the max and module for windows and
everything doing dot local and Linux as
well nobody is going to allocate local
right now because it would just cause
chaos but I wish it hadn't turned out
that way you know I wish we could have
done it more with the support of the ITF
community do you have a certification
program yes if you go to in fact I was
going to oh it's my hips that's my
that's my final slide the zero
comfortable website is good place with
links to the other ones Apple's
public-facing web site is apple com /
Bonjour the developer related
information is developer.apple.com /
Bonjour and that's where you'll find the
conformance test so if any one of these
devices wants to put the vault or logo
on the
Jing they have to run that conformance
test there's no cost for that licensing
program it's purely Apple wanting to
maintain the standards so that when you
as a customer see deposit or logo on a
printer you know that it really means
something and it's not going to be a
frustrating experience because Bonjour
needs to stand for more than just sort
of a checklist feature you know yes we
implement this and this and this but
it's turned off by default well if it's
turned off by default in the factory
then it's not providing any benefit to
the user so we have some requirements
like out of the box the printers got to
show up and if you do all those things
then you get to use the logo all right
i'll take one last question there i
actually i don't know all of them
anymore this thing is sort of a mushroom
so big that i don't actually know
everything that's going on anymore if I
he is the best one I know Arthur van't
hoff of November and java fame did a
complete java implementation of
multicast dns novelle did one entirely
in c-sharp I there are others I've heard
of that that that aren't really complete
avahi is the one that i know of that
really does challenge apples in terms of
its completeness and it's a robustness
all right well thank you all for coming
Oh</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>