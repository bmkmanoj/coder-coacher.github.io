<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Mitigating Web-based Malware Attacks | Coder Coacher - Coaching Coders</title><meta content="Mitigating Web-based Malware Attacks - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Mitigating Web-based Malware Attacks</b></h2><h5 class="post__date">2009-08-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ndEgEDRMKbs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">today I am pleased to welcome back near
this money back to Google for those who
haven't had the pleasure working with
him he's one of the leading experts in
web security he has strong ties to both
academia and industry he's previously
worked here at Google and a place is
like Kokomo and at Stanford he's written
numerous papers and he's one of the lead
authors or actually billion author of
his book foundations of security which
I'm sure many of you have recently Neal
co-founded a giant in order to help
address issues of sites been compromised
and hosting malware and potentially
being blacklisted and obvious is the
subject of news talk today so with that
let's welcome Neal thank you David for
that wonderful introduction first of all
let me just say that it absolutely warms
my heart to be you know back here
visiting Google and seeing a lot of
familiar faces and amazingly amazingly
talented colleagues you know during my
during the time that I spent here at
Google both as an engineer and as a
product manager I was very fortunate and
glad to had the experience to work with
many of you to help help
you know secure various parts of the web
I think that over the years Google has
just done an absolutely amazing job in
helping provide online services
providing them in a way that maintains
and provides security as well as privacy
and my hope is that together we can
continue to keep the internet a very
safe place to both work and play online
and so you know in my in my talk today I
will tell you a little bit about some of
the things going on in in in the
web-based malware world one thing that I
wanted to get just a quick sense of
prior to you know getting into a more
deep discussion is how many of you are
from a security or security related team
here at Google okay so about half and
then the other half are not and I was
told that we also have folks
the talk remotely as well as I think
that the pote this talk may be posted on
YouTube as well so I will be describing
some background in introduction so for
those of you that are already you know
familiar with some of the things I'm
going to be introduct in introducing you
know please be patient so that we can
you know make sure that everyone's uh
you know together but you know with that
let me let me start by just giving a
quick synopsis of of what what of what
they say it's about and a little bit
about its history so I had the pleasure
of you know working at Google for just
over three years until September 2008 in
- in October 2008 I co-founded day
siient together with with with two
additional colleagues and we we as a
company we're about you know nine months
old at this time at the time I'm giving
this particular talk we let's see raised
just over 2 million dollars in seed
round funding by December of 2008 we
were very lucky to have received
investment from some folks that have
been very influential both in the web
security world as well as in the web
world so for instance Stratton's clavos
these the former CEO of Verisign is one
of our key investors in addition on how
many of you use a Twitter yeah so some
of you use Twitter good
so Mike maples who's one of the key
investors and Twitter is also an
investor in day siient and Eric venema
who's the former CEO at three-column
Corporation is also an investor so we
were very glad to raise on you know seed
round financing I in the midst of an
economy that was you know falling apart
in many ways I one of the reasons that
that we were able to do so is because
we're focusing on helping various web
based businesses deal with cybercrime
and malware attacks and for those of you
that have been tracking the trends there
has just been you know a lot of
a lot of pain due to these kinds of
things so it's we're very glad that
we're off the ground and we're looking
forward to continuing to you know work
and collaborate with with search engines
with browsers with browser companies etc
to keep the internet a secure safe and
safe place so let me just give a quick
outline of some of the things that I'll
discuss over the next I think maybe 40
minutes or so my hope is that we'll have
some time to have some good discussion
afterwards I'll first talk about how
there's been a fundamental shift in the
way that malware's get been getting
distributed on the Internet
I'll then talk about a particular kind
of malware called web based malware and
I'll talk about you know some trends
there I'll talk about how some of these
web based malware issues can be
mitigated as part of that I'll tell you
a little bit about des cience web
anti-malware platform and then at the
end my hope is that we can chat a little
bit about how we can work together as a
community to keep the web a good place
to do Commerce and collaborate so to
just review what's happened say over the
past couple decades there's been some
pretty major shifts in how malware or
malicious software has gone distributed
you know before even the internet was
around so so malware initially used to
get distributed you know via floppy
disks but you know in the in the late
90s mid 2000s most malware and viruses
would get distributed by email
attachments so so basically it would
spread in kind of a peer-to-peer fashion
where you know the virus would send an
email it would attach itself to the
email when somebody opened it it would
email itself to a buddy in the address
book so that was one class of worms
another class of worms was of the type
where it would work to find some
vulnerability in say your Windows
operating system and then exploit that
vulnerability such that once the
vulnerability was exploited in the
binary infected one machine it would
then infect other machines on the same
local area network so that was that was
kind of the next phase from the late
nine
to mid-2000s and things like you know
Code Red and nimda spread in that kind
of fashion what's been happening since
the mid-2000s to to present day is that
there's been a couple shifts so one
shift is that while in the past most
worms and viruses used to use to get
built by people that just wanted to
spread it for the sake of it build the
name for themselves there's been many
more financial motivations to spread
this kind of malicious software and as a
result it's more critical that the bad
guys get distribution so one way that
they've been distributing it fairly
aggressively is by compromising websites
infecting those websites in such a way
so that when users simply visit pages on
the website that a computer will
automatically get taken by the malware
or the or the virus just by visiting the
webpage so so this kind of drive-by
download activity is pretty you know
pretty pretty unfortunate but you know
we we need to do something about it and
I think that you know Google was one of
the first to take a very aggressive
stance to web pages sending drive-by
downloads so Niels Provos
and the anti-malware team here at Google
have done a great job in in in flagging
search results and flagging websites
where where they'll come up by these
issues so that's that's a little bit
about the evolution of malware what
we've seen in in in terms of some other
statistics from from mid 2000 onwards is
if we look at the amount of emails that
are that say have infected attachments
one thing we can see from this graph on
the left is that there has been a pretty
significant decline in viruses and now
we're spreading that way so in 2005 it
you you know approximately just over two
percent of emails would be infected with
it with malicious attachments and that
number has come down significantly on
the other hand the amount of malware and
viruses that have spread via malware
infecting by what by by infecting web
pages has grown quite significantly so
this graph here on the right comes to us
with some data from Sophos and Microsoft
and what it illustrates is that back in
say 2006 there were approximately 5,000
infected pages getting getting
discovered per day but as of 2008 that
number climbed to just about 30,000 so
there's been a 600 percent increase in
there and this is just one dataset given
them here at Google I thought it might
be more than worthwhile to decide some
of the data that's been that's been
aggregated here at Google so Google
maintains a list of flagged sites and
list of sites that may be infected with
malware and if you look at the number of
entries on that list that that list of
entries has grown by by over 70% just in
just in the past few months in the first
safe six months of this year if you if
you go back to say October of last year
it's actually been an over 100 percent
increase and part of the reason that
this this has been taking place is
because the bad guys have just leveraged
more and more and more automation
there's also been new types of attacks
so the bad guys to spread their malware
what they'll what they'll very often do
is they will query search engines like
like Google like Yahoo like MSN and they
will do searches to find vulnerable
software on websites and they will then
launch automated attacks against those
vulnerable say web applications on those
websites there's other ways that these
things have been spreading as well so
I'll talk a little bit about Gumble or
I'll talk a little bit about attacks
based on FTP credentials so this this
activity has been getting bad and it's
been getting worse and so what's um you
know what does this look like in terms
of across the web so it used to be the
case that typically large web sites
needed to worry about getting attacked
right so it used to be the case that the
bad guys wanted a lot of traffic with
with each infections that they conducted
and
so what we've seen though is that
there's been a significant trend where
lots of medium and small-sized sites are
getting attacked as well so to put this
and to make this a little bit more
quantitative how many of you in the
audience are familiar with longtail
curves okay so so a good number of you
so a long tail curve of course is a
curve in which you know 90 plus or a
large percentage of the area under the
curve comes from the you know the the
the effectively the long tail on the x
axis right so it used to be the case
that maybe just the largest websites
that got the most traffic would get
infected
but because the bad guys want a lot of
distribution they're also taking
advantage of longtail phenomena so on
the right side what we see here in in
this graph is it's a graph of a million
websites that are ranked ordered from
left right from most popular to least
popular and the y-axis shows how many of
those websites are infected so there
were about you know a million such
websites that went into this particular
graph and they were bucketed in in
buckets of 10,000 H and the key thing to
notice is that if you if you look at it
there are if you look at the top half
million you'll notice that there are
probably a little bit more infections
than say in the bottom half million but
you know if you were to draw a line it
would be a little bit slanted it
wouldn't be so far from from straight
what that says is that for the sites
that were smaller they are getting
attacked almost as frequently and so
that's indicative of that's also
indicative of the way that the bad guys
are spreading the malware in the sense
that if there's a vulnerable web
application let's say there's a
vulnerable blogging package out there
they don't care whether that blogging
package is running on a popular or a
less popular site they will go ahead and
advantage of a vulnerability to spread
their infection so that's just a little
bit of data about the problem and and
how bad it is and the brain
but one question is well why why is this
happening why are so many websites
getting infected and and one of the
other problems here is that there's just
so many different attack vectors so on
when when I was here at Google and you
know was working on the foundations of
security book and helping various teams
at Google secure their web applications
there were a variety of vulnerabilities
in web applications like sequel
injection like cross-site scripting
cross-site request forgery etc and and
those vulnerabilities can be used that
they were traditionally used to steal
data from websites or safe steal a
user's cookies but what the attacker
just started doing is said hang well we
don't want to steal the data as much
what we'll do is we will plant we will
think about it of those vulnerabilities
to actually say insert data into the
database or inject some code say
somewhere on the filesystem of the web
server and once that's done the code
that they inject can be used to initiate
say drive-by downloads and I'll give
examples of such code but basically
vulnerable applications are one attack
vector that can be taken advantage of to
to spread malware other classes include
user generated content so for instance
if there might be a site where a lot of
users are posting comments if you know
someone say even post the link to
something malicious write to a malicious
executable you could imagine that you
know if it's socially engineered
properly it might encourage a lot of
people to download it so user generated
content can be can be one one such
vector user-generated content combined
with the vulnerable web applications can
be even more dangerous so if bad guys
can inject script as as what happened
with with various attacks in the past
like like the attack against MySpace
back in 2005 then basically they in that
particular attack that the bad guy was
able to set up a profile page that you
know infected other profile pages every
time users visited it and they were able
to spread to over 1 million
within just a few hours so vulnerable
web applications combined with
user-generated content can be pretty bad
now one might say well why don't we just
secure our web applications why don't we
build them securely or why don't we you
know correct all the vulnerabilities and
that that is definitely a good step but
I think another thing to realize is that
the way that a number of infections to
take place these days is that the bad
guys can just you know compromise or
find the FTP credentials for for the web
site once that takes place then the bad
guys can upload anything they want to
the web site and have total control over
it it doesn't matter that the code was
completely secure the bad guys can still
leverage the web site there's also been
cases where web servers have
vulnerability on you know is servers
have vulnerabilities Apache servers have
owner abilities web administrator's very
often don't patch their web servers as
often as one might like and so that
that's another left another area for
attack so it's you know and then there's
things like Network vulnerabilities you
can also have cases where you know the
web site can be completely secured to an
extent you know you might have an
e-commerce site that say in addition to
generating ecommerce revenue might have
say ads on the page and you know will
everything that they're doing on their
own might be secure but if let's say a
bad guy uploads and add into the ad
network that they're using to populate
the ads on their page right the bad guy
gets stolen credit card number or uses
that to upload an ad and then those
malicious ads that can show and can also
be used to initiate drive-by downloads
as well as other nefarious types of
activities so so here you have a case
where you know a publisher say a web
publisher is doing everything right and
they they maybe even be you know using a
you know a decent ad network you know
but but but their site can still get
infected and their site can still affect
users now I one of the things that have
been amazingly glad to see is that
Google has also been taking a very
aggressive approach to dealing with
malvert heisting or
or malicious ads and has yeah has a lot
of initiatives to help address that and
I think that you know the more the more
such defenses are put in place the
better there's also been cases where
where websites especially you know small
smaller time websites or even
medium-sized websites where they don't
necessarily have the IQ structure to
build everything themselves they might
use for instance a traffic counter to
account user hits or whatnot and you
know the traffic counter that they use
on their website can can effectively get
taken or get infected and once that
happens then it can in fact all the
pages on their site that use that
traffic counter so there's just a lot of
vectors here it's it's in some cases
very difficult to prevent attacks and
sometimes you just need to be able to
detect and recover from the attacks when
they happen so that's that that's an
important theme I think it's it's good
to do as much prevention as possible but
it's important also to have measures in
place that have detect and and contain
attacks so you know because because of
this difficult to prevent and because of
the fact that the attackers are
constantly coming up with new creative
ways to to cause trouble for the rest of
us I I think you know Niels Provos and
and Moe he banned Panos said said it
very well in their cybercrime paper that
appeared in the ACM queue they said it
is it is difficult to be completely safe
against drive-by downloads and I think
the that's true not only of drive-by
downloads but other types of web attacks
as well so that's um a number of the
different ways that websites can get
infected you know at ASEAN we've been
we've been tracking you know quite a
number of these types of web-based
infections and we have been putting
together an infection library and so
there's a couple different cases ways in
which bad guys can inject malicious
content to a webpage one way to inject
it is to inject a inject an iframe and
iframe is an HTML feature that can be
used to render invisible frames into a
web page and they have many many
legitimate uses you know one of the
things that's great about the web is
that you know one web Cape web page can
bring in
Martin from all kinds of other other
places and over over the past couple of
years we've seen a lot of you know
mashups and web 2.0 functionality which
which makes a lot of great use of this
functionality unfortunately if a bad guy
can inject an iframe into a page and get
content sourced in from another site
then what that what what that content
can do is do things where it can say
finger print what kind of browser the
user is using what kind of operating
system are they using and figure out
exactly what exploit to feed to feed
that particular user so that they can
take their machine just by viewing the
page so so iframe injection is one such
type of injection injections can also
take place by by inserting unauthorized
JavaScript into pages and Ja the
JavaScript can do all kinds of things in
some cases the JavaScript can render
iframes in other cases the JavaScript
can invoke flash or it can use various
you know ActiveX controls or you know or
other Microsoft you know types of
features not to say that anything is
wrong with you know Microsoft in
particular it's just that there's a lot
of software that's on computer so the
JavaScript could also take advantage of
say Adobe PDF vulnerabilities or whatnot
so JavaScript injection is the second
type of injection a third type of
injection is an injection where the bad
guy takes advantage of functionality of
a web server and injects some code which
I'll show an example of in the next
slide where what they could do for the
web server is make sure to direct users
that access that web server to another
web server of the attackers choice for
either any request that comes to that
web server or even just say some
requests so this graph here shows a show
some data from from from day ciients
infection library where we looked at a
whole bunch of infected web pages and
web sites and just cataloged how many
distinct types of iframes javascript and
or redirect attacks you know we're
taking place on that set of web sites
and what we found is that you know we've
catalogued over you know ten to eleven
thousand
uni unique types of infections what we
see is that it's a it's it's about equal
between the iframes and the JavaScript
and there is you know very few such you
know distinct redirect attacks so so to
provide more technical explanation of or
to provide some technical examples right
I just on this slide put a put a couple
examples one where an iframe is injected
into a website this particular iframe
sources in some content from a server in
China called a beach house name probably
not a legitimate server and what you
know you might ask well you know if
there's stuff getting rendered you stop
getting injected into the web pages how
come how come users don't see it well
what the bad guys do is that in some
cases they'll set the width and or the
height of the iframe to say zero in
other cases as exists with this
particular piece of code it says that
the the style that the iframe should be
rendered in should be should be hidden
so that you know users don't see it and
sometimes even when the webmaster looks
at the page unless they look at the code
and go through every line of it it's
hard to see it you know there's there's
also examples of these types of things
in the ghost in the browser paper that
Niels Provos and company put out you
know but these are just some more
examples so to give an example of a
JavaScript injection the second bullet
here shows some JavaScript code which is
obfuscated and when this code runs it
will basically produce additional
JavaScript which sources in some content
from you know these these IP addresses
so a couple points about this kind of
infection so so firstly one might ask
well why would anybody you know any
webmaster that sees this kind of code on
their page think it's think it's
legitimate well if you look at various
types of web visits and you just look
what's going on the web there's more and
more JavaScript that's getting used on
the web and so if you look at things
like a PayPal buy button or whatnot
there's just tons of you know hex and
coded stuff and so a webmaster may very
easily you know get confused and think
this is legitimate another phenomenon
that you see is that very often the
person that bills
website is also not the person that's
responsible for maintaining it so when
the bad guys do some of their injections
in some cases what they'll do is they'll
insert additional JavaScript comments
say oh the Yahoo counter starts here or
whatnot well of course of course there
there may even be no such thing as a
yahoo counter but the person that's
maintaining the webpage may or may not
know that and may hesitate to to take
that coat off right away which basically
gives the attacker time to have his coat
on there longer while more and more
users downloaded so that's one point
about these JavaScript injections
another point is that if you look at the
script that gets rendered by evaluating
this JavaScript you'll notice that for
instance it has some some IP addresses
in it you know in general you know
having direct references to IP addresses
probably is not a good thing and in this
particular case it could very well be
machines that the attacker has
compromised on a botnet and where what
they do is they'll run a web server on
that machine so that that compromised
machine can serve malware drive-by
downloads and/or other other other bad
stuff from these particular IP addresses
so that's an example of you know
injected JavaScript code a third example
is a type of injection which is which is
a little bit different where what the
bad guys will do is they'll take
advantage of an Apache module called mod
rewrite which is installed on many many
patchy web servers to basically allow
the webmaster to rewrite URLs to either
make them easier to index by a search
engine or for just various other
purposes in this particular case once
this code gets injected into a file
called HT access on the web server what
it will do is when users visit the
website if they if their browser came to
the website where they refer from Google
or AOL or MSN basically if the user was
say only searching on Google AOL or MSN
and gets redirected to this site will it
say ok well instead of serving the the
user the actual content employed this
rewrite rule so that whatever it doesn't
matter whatever you are supposed to
serve them before
are you will instead sir than this URL
HTTP 8 9.2 8.1 3.2 or what not and that
that URL is basically hosting some
malicious code so that's an example of a
web based malware infection these kinds
of web based malware infections have
been getting pretty significant just
earlier this year there was a
significant infection called gum blur
that that started to take shape in late
April 2000 of this year
well 2009 and the way it work was was
interesting it would it was basically a
combination of you know a number of
different types of malware one type of
malware would when it's on the user's PC
it would log all the users keystrokes
and if that user say logged into a
website via FTP or whatnot it would log
all of the passwords that were - used to
access the website it would send all of
those passwords to the bot master the
the bot master machines would then
automatically conduct attacks against
that site whose credentials were just
stolen and auto inject more drive-by
download code into into those web pages
what would happen at that point is
because the the the malware code was now
on more web pages more people would end
up having the drive-bys happened to
their machines and you know it basically
created a positive feedback loop where
the attacker just had you know this
botnet and said of infected pages grow
and grow and grow and grow it basically
took over eighty thousand sites in you
know in a very short time period so so
basically the add the bad guys are using
automatic scaling of attacks the the
code on this page is actually some of
the Gumbel or code some of the things to
note about this code and note about
gumball is one of the things that
gumball was doing is it was infecting
each different website with with
completely different code kind of
polymorphic code so one could say well
you know this should be easy I should
just look on my web pages and I should
look for you know certain types of code
and even if the code looks like this
maybe I can write a regular expression
that can capture what it looks like but
the problem is of course you know such
an approach could just be a
dreamily extremely fragile so that's not
going to work looking for signatures is
also not going to work because the
attacker can just change things way too
easily it's very important when looking
at such infected pages to look at the
behavior of the page what is the thing
actually doing what could actually get
executed question so the question could
this could this attack be on for static
HTML or dynamic HTML as well and it
could be both it could be either right
so for instance one could inject this
kind of code into a database that is
used to say drive ecommerce on a side or
draw up a vlogging package on a site and
so the pages can be completely
dynamically generated in fact one trend
is if the attacker can inject such code
and save to the header or the footer of
the page they'll basically take every
page on the site so that's a bit about
goong-bok so because of this and so so
it's I think imperative that you know we
work together as a community to make
sure that the web stay is a safe place
to to do business in and so as a result
there's been a lot of great initiatives
here here at Google the the anti-malware
team has done a wonderful job of
protecting users against these kind of
threats not only in Google search
results but also in you know in just
regular browsing activity so you know I
had mentioned I had mentioned you know
the the ghost in the browser paper and
that's a great paper to read if you want
to learn more about what Google is doing
but basically and certainly we have the
experts in the audience here one thing
to note about what's going on here is
that you know Google is after it crawls
web pages and indexes them they are
scanning such pages for infections and
there's a you know an awesome system
that's in place to do that
and when it finds something what it does
is it will when it shows search results
it will mark those search results it
will flag them by saying this site may
harm your computer so that is
that is one initiative that's taking
place to protect users and and it's you
know I think Google pretty much led the
charge here in in in many ways so
there's also been a number of other
quote-unquote you know black lists or
flag lists that mark pages and warn
users away from from scary web pages in
other way so for instance know there's a
you know effort called Norton safe web
and it also looks for drive-by downloads
and fishings but actually the before I
get into too much detail let me let me
first just mention some of the
advantages about the way Google is doing
things when Google Flags drive-by
downloads on pages it's it's it's a
binary this page is infected or it is
not and they do it in a very pure
truthful way meaning if a web page is
visited and a malicious binary comes
down there are no if ands or buts
question about whether or not this page
is malicious they're also very careful
about how they go about marking web
pages as infected so that said there's a
number of other initiatives here which
not only which seek to not only kind of
flag the you know that type of behavior
but flag other behavior that's kind of a
bit more in the gray area and there's
various trade-offs pros and cons of
doing that so so let me let me chat a
little bit about that so Norton safe web
is one such one such website so users
can go to Norton safe where I've been
type in a domain and see if you know see
if that web page might harm to a
computer there's also a tool bar that
they can download that will warn them of
such things in the regular browsing
activity on so you know so they also
look for other things like spyware
viruses worms dialers browser changes
hard on and even just software that's
hard to uninstall and so because of the
fact that they're looking for you know
much more thing and there's much more
gray about what's going on they not only
you know mark some sites as red warning
this is scary they mark
some sites as yellow caution basically
signifying the users that this may be in
the gray area they mark some sites is
safe they mark some sites as untested
make it fils ID advisor you know similar
a similar thing at work where they are
tracking for a variety of other things
notice that what what everyone's
checking for is is just a little bit
different and I'll give some stats on
how that practically plays out so so so
with McAfee site advisor they also have
you know such such labels how does this
manifest itself in terms of user
experience so when a user say you know
visits Google if they do a search and
they find that there's a and there's a
there's a infected webpage and the
result then Google will will tell them
this site may harm your computer my guys
my guess is you guys all know this
Google of course all also shares that
list of infected websites with popular
browsers like Firefox and Chrome and if
one was to arrive at such a site not
just when they're searching but just
through regular browsing they will see
you know this red screen of death saying
this is a reported attack site Internet
Explorer and Norton also I've been doing
such things so so Microsoft in the most
recent release of Internet Explorer 8
basically also included anti-malware
protections and if one ends up at a
infected web page and Internet Explorer
they see a screen like the one here on
the bottom left and you know Norton has
a number of things as well too that show
this in a user interface you could
imagine that if you end up at a infected
web site in you're running an anti-virus
product you will you will see some kind
of warning come up so that's what's
happening I I chatted a little bit about
the fact that these um that these lists
are all looking for for slightly
different things and so on this slide I
have a couple different graphs so we we
ran an experiment at ACN where we took a
bunch of domains and we we looked them
up on on various such lists and we
looked at well how many were flagged by
Google how many flat were flagged
how many were flagged by McAfee and what
we can see is that you know different
numbers of things were flagged Google
flagged you know the smallest number of
things but keep in mind that Google is
you know very conservative comparatively
with regards to what they mark bad you
know Norton and McAfee you know will
flag things that are kind of also the
more in the gray area and and and things
that are saying you know not just
drive-by downloads to provide some more
stats across the set of sites that were
that were that were listed on one or
more of these lists overall 57% of those
had a red label a warning label and
associated with them and 43% of them had
a quatrain label associated with them
you know and then and then the numbers
came out for for google norton mcafee
and you know so it's also interesting to
compute an intersection amongst these
lists and one of the key things to know
from this Venn diagram it's not exactly
to scale but it's it's about right one
thing to notice from these this diagram
is that there was a very very small
overlap actually between all three lists
under 1% of the domains you know we're
in common in between all of these three
lists so this this basically has it has
a couple implications one implication is
that Oh question we got the list of
domains from yeah from from from Alexa
actually yeah it was basically a list of
popular domains on the internet and when
we sampled 10,000 of them I'm sorry was
that
Oh Oh
so the question is how did we establish
any ground truth actually we didn't
attempt to come to any ground truth we
just looked at intersection between the
lists that's all that we did right so
this is just that this is just the list
of sites that are blacklisted yeah okay
so sweating out it tells us a couple of
things it tells us that users like like
for a webmaster to keep up with all of
these different lists can be can be
challenging and so that's why they say
and one of the one of the first things
that we made available in terms of
services on our website is is is is a
service which will check sites against
all of these lists you know for free and
just email them you know if they ever
appear on any of the lists so that
that's that's one thing the other thing
is that there's various definitions of
of what's bad right and everyone has a
has a different definition of what's bad
right now and as an industry it would be
great to you know come to you know some
convergence on on what's back so in any
case that's that's got some data we
actually just issued a blog post about
this particular item this particular
experiment this morning on de science
blog so feel free to check it out so
because there's been a number of because
you know when a webmaster has something
bad happened to their site it's
important for them to be tools and
Google also took the charge here and was
the first to in their Webmaster Tools
when when people have problems with
their sites they they can go to Google's
webmaster tools and if their site say is
infected with malware the the first
thing that they're told on the webmaster
tools dashboard is that you know the
site made distributing amount may be
distributing malware and you know gives
them sample URLs and you know it's
absolutely absolutely you know very
useful for for site owners you know I
we've been
developing a set of technology and a set
of initial products to also help
webmasters and help web hosting
providers deal with these problems at
scale so I think what I what I'll do is
I'll tell you a little bit about what's
what they think is doing in the space so
our company just came out of stealth
mode about a month and a half ago and
our the initial set of products that
that we offer are shown here we offer to
help both webmasters and web host and
providers we offer them diagnostic and
monitoring services where you know let's
say that that a site you know wants to
check whether or not they're there
flagged on any of these lists they can
do that or if they are happen to be
infected we can give them you know
diagnostic information about what's
what's taking place we provide
monitoring and alerting services so that
they can get scanned on a regular basis
so that's a little bit about you know
what's available on the diagnostic one
monitoring front another thing I'll show
you demos of these things another thing
that we made available is that we we've
been in discussions with with lots of
customers and listening to their pain
points and also thinking about it from
an engineering standpoint about what can
we do to help them so a lot of the a lot
of the cleanup activity that's been
taking place thus far has has often been
very manual right on you know whether
they're you know revolves of what tools
that the webmaster or the web hosting
providers are using and so we felt it
would be important to also make
available remediation tools such that if
and when a site gets infected
there can be an automated response so if
you think about what happens with the
desktop antivirus what happens with
desktop antivirus is that if your
machine site gets infected then there is
you know antivirus software in place
which will not only identify the
infection but will attempt to quarantine
the malicious file so that you can
effectively continue your work and we
would like to bring the same model I
think it's important to bring you know a
similar model to to the world of the web
and to websites so instead of when a
website gets infected just you know
telling them about the infection and
then giving them some information so
that
a newly resolved it it might be really
good to have a system in place so that
the infection gets automatically
quarantined and the webserver doesn't
serve any malicious code and I'll show
you an example of how that works and
then perhaps we'll get chat about you
know some ways that that we could we
could potentially work together so so to
just give you a you know after now that
I've told you a little bit about what we
the some of the initial products we've
brought to market and after our initial
partial ones we were just very glad that
the products were very well received we
got a lot of attention in the media
which we which is great you know and and
we basically are excited about
developing more and more to help to help
the community so
maota bout what's been what's been done
thus far let me tell you a little bit
about how how how desi ins system works
the goal here is to bring kind of the
life cycle of malware protection to most
web sites so by life cycle I mean that
we need to not only say monitor a
customer's web server but we also need
to quarantine the malicious code on that
web server so so basically the way our
system works is we have a crawler that
will take the first step and discover
all the resources and URLs on the system
that information that set of URLs is fed
to a set of content analyzers the
content analyzers as you guys are all
familiar with web pages are just
becoming more and more complicated and
so it you know if web pages are just
HTML that would be one thing but if
there's all kinds of things on web pages
that can execute and run and you don't
need to be clicked on and such things
then it's important to make sure that
one can dynamically behaviorally look at
what's going on there so so basically
that's what the content analyzers do
that information is fed off to a set of
malware analyzers that we'll look at you
know a whole bunch of you know features
of the web page and what's going on and
figure out is there is there something
bad going on here has it been infected
that information is shown to say
webmasters through a user interface but
that information also gets sent to a web
server module that we install either on
the customer's web server directly or on
the web hosting providers platform such
that if and when
infection happens these quarantining
instructions sent to the webserver tell
the webserver how to not only identify
but eliminate the malicious code on the
website so given that overall
architecture let me let me show you how
it works so and so I'm showing you
screenshots let me if the demo gods are
with us and if the internet connectivity
works let me just show you how it works
in real life so if you come to the de
science website one thing you can see is
that we provide some diagnostic tools
right so I'll enter a letter site called
say the jumpy comm and hit diagnose and
what it'll do is it will well looks like
our internet connectivity went away
let's see if we can get it back ok good
so once we enter the well once we enter
the domain our our service starts doing
a quick scan of the website it's
determined that the website is
blacklisted and infected and it's now
scanning the website to find the
malicious code and it says that it's
found the malicious code it's founded on
this particular URL on the home page and
once you know once we click once it
gives the report we can click it and it
will show show the exact code snippet
from the site that's that's infected the
other thing to keep in mind is that this
is the diagnostic service we also have
various monitoring services such that if
and when a website gets infected or well
folks and sign up for the monitoring
service and we'll do a daily or more
frequent scan of their site and if and
when the site gets infected then
basically we'll send them an email
saying that in this particular case a
site called the new pods comm may be
infected it's not blacklisted yet on you
know on Google on Firefox on Safeway up
on site advisor but if the infections
around long enough it wouldn't be
surprising if if that indeed does happen
so so one can click here for a report
and I'll just go ahead go to the report
the report is over here so the new pods
comm is infected it's at a risk of
getting blacklisted the reason it's at a
risk of getting blacklisted is because
there are two and
pages that have been found on the site
there's and there were two infected
pages if we would like we could see we
could see a little bit more detail about
the infection so it tells it tells us
that this the infection that's found is
an iframe too bad domain.com if we click
on that it will take you off today CNS
infection library where it gives you
just a little bit more information it
says you know this is a malicious iframe
you know the code length is 37 bytes of
course this is a very very simple
example that I'm using just for the
purpose of this demo 99.9% of the code
that we find is much more complicated
than this and you know over time you
know we're going to be adding more and
more to that infection library but in
the case once the once the once the site
owner receives the report saying that
the site is infected we now want to
resolve it and we want to resolve in as
automated automated of a fashion as
possible so what exists in the lower
part of the report is as before the URLs
that are infected and the pieces of
malicious code but there's also this box
that says protect my users from these
infected webpages and if the if the
webmaster clicks this box and click
update then what our back-end servers do
is they will establish an ssl connection
with the customers web server connect to
the web server module that we provided
them with send over kourin cleaning
instructions to that web server
propagate those containing instructions
across all the web server processes and
the web servers running on that site and
and and and eliminate the infection so
so let me just let me just you know step
back for a second and you know shut off
the protections so let's say that the
the site in question here is this canoe
pods comm site it is a blog the blog
owner you know may have some articles
that they pose people can post comments
etc they may put ads on the side and
earn their revenue from it but basically
this this blog is infected so on this
page is as an iframe that was injected
into the site through a three the user
comment and one of the things to notice
is that well we actually see the iframe
of course
this was a real attack we wouldn't see
the iframe it would be invisible but the
second thing is that well in this case
the actual drive-by download is also not
coming to my machine because I didn't
want to affect my machine but the idea
is that you know this page is infected
if say you know Google's crawl over to
come along or Norton safe web or to
discover the side or McAfee side advise
our way to discover the site then then
this this page could get blacklisted and
would become inaccessible to two users
to prevent that from happening when the
site does get infected we send the user
this report and if they click this
protect my users from these infected web
pages box and click update and you know
the SSL connection happens the
quarantine instructions get sent over
etc you know if we if we simulate say
being another user coming to coming to
the blog by hitting load then once the
quarantine instructions have been
propagated let's see if they've been
propagated yes they have so the page
gets served exactly as is except the
malicious code has been stripped out of
the page so that the website can
continue operating as such you know
without without being impacted by the
infection and so that's you know one of
the technologies that dayand has built
and is working with a number of web
hosting providers and flowing on their
platform so that we can bring end to end
web anti-malware protections to to
websites so that's the that's the demo
let me switch back let's see here okay
so you guys got to saw the real thing so
what some of the work that we've done to
date a question
I'm sorry so the question is if we were
able to identify the snippet why not
just take out the snippet right that's
exactly what we did on in the previous
example right no we did not disable the
access to that particular webpage that
webpage got served it just got served
without the malicious code on it
exactly um now now that said you know we
also have the technical ability to say
just block the page right so that the
malware wouldn't get served that that's
you know that's that's doable as well
and so so you know we've had you know
various requests from customers we've
we've had different customers requests
different things blocking versus
quarantining but the key point is we can
do the corn keening which is the more
complicated thing to do technically and
we're glad that we're able to make that
technology available the other thing is
that in the example that I showed you we
masked received a report and had to
click a checkbox some customers have
basically asked us hey we'd like you
just automatically quarantine the
infection right and then maybe just let
me know you did that afterwards and
we're happy to do that too and it really
depends upon you know what kind of
company it is and there are web servers
and and what processes they have in
place on the business side so you know
to date we've been glad that we've been
able to help thousands of websites we've
been doing we've been doing so through a
variety of ways we you know Google
helped help create this organization
called stop bad org and provides them
with a lot of data and stop bad word or
created a community called bad word
Buster's org we've been interacting with
um you know sites that have been
infected through bad word Buster's org
sending them free reports you know
helping them with their malware problems
we've also noticed that you know some of
the moderators of the these communities
have also you know been using our tools
from time to time to help not only on
the battler busters org forum but also
on the google webmaster forums so so
we're very happy to have made these
things available in addition we've been
working with a number of web hosting
providers so for instance a web hosting
provider you know they don't want
infected domains on there
on their platform and so in the work
that we've been doing with web hosting
providers we we we can do things like
you know scan all their domains we in
many cases work with them to deploy our
quarantine technology on the web server
which is available both for Apache and
IAS by the way we also you know and I
think there's been some some good
interactions to date so there's been you
know you know cases from time to time
where you know one is one has worked
together with with other folks in the
community to say get list of infected
sites and you know help help out the web
hosting provider and we'd like to do
this at scale because we want to protect
large portions of the internet in one
shop we've also been doing this through
a whole bunch of third-party affiliates
so there's various you know web design
companies that that build websites for a
living and we are excited about you know
working with those types of folks so
that they can just bring our malware
monitoring services to their to their
customers and certainly for both of
these for both of these types of folks
web hosting providers as well as
third-party affiliates you know we're
also happy to provide them with free
blacklist monitoring across not only the
Google blacklist but the you know the
McAfee site advisor and the norton safe
webs etc so we've been offering a you
know a set of things you know to the
community quick scans blacklist
monitoring informational resources you
know the folks that we work with have
had very good things to say about us
thus far and we're just very excited
about continuing to please them and help
them with their with their malware
problems um that said I think that
there's a number of collaboration
opportunities in front of us so I you
know my hope is that this talk is the is
the start of a dialogue and a start of a
discussion where we can figure out how
we can work together as a community so
for instance um you know one of the
reasons that the bad guys often get
ahead is because they happily share
attack techniques and data all the time
right in some cases they buy and sell
free salt from each other in other cases
they actually just just exchange the
information and I think that you know
on the good-guy side we should also do
more and more data sharing if it makes
sense to say create a a close-knit
Rusted consortium of sites or and/or
companies to do this that might be good
but for instance if I look at if I look
at you know what are the sets of things
that say Google detects versus what's
the set of things that they see and
detects and what's the set of things
that Norton and Nick effete attack these
are all you know um you know overlapping
Venn diagrams I don't ever expect that
there'll be you know and in some cases
they're non overlapping right and
different percentages are non
overtopping
I don't expect that you know there will
ever be one oh you know completely
overlapping circle for everybody but you
know I think it might make sense to make
sure that you know just given the data
that we saw before what it looks like
there's a lot of differences between
what people are looking for coming
closer together on that so so my hope is
that there there might be some way to
share information say about gray area
attacks new attack classes attack types
sites that may be you know infected but
not malicious we're not quite sure if
the what the code is actually bad that's
one area of opportunity for
collaboration other areas of opportunity
are you know we've we've created this
this quarantining technology for web
servers and we've also created a number
of other tools and one question in my
mind is would there be a way to make
make some of these things available via
open source communities so for instance
if some of you were interested in
working on open source projects on the
side please come to me afterwards and or
send me an email my contact information
is here and you know let's figure out
how we can make make some of these tools
available open source finally you know
we have we have connections to Stanford
you know Dan Bonet at Stanford professor
and Bonet there is a adviser or a
company and so we have a connection with
Stanford we have some affiliations with
some other universities I know Google
also has connections with a lot of
universities and I think that academia
has a lot to bring to the table with
regards to not only data sharing but
also analysis and whatnot so I guess
with that I wanted to just leave it open
for you know discussion for ways to
collaborate I look forward to working
together you know with Google with with
other search engines with with you know
browser companies we
with various folks as a community so
that we can make sure that the internet
stays a great place to communicate
collaborate conduct commerce over on and
keep keep the web now we're free with
that thank you for your time and I'm
happy to take maybe one or two questions
and for folks that would be interesting
to us more you can you can also come up
afterwards okay I think what we'll do is
maybe let's just go directly off line
since we might be a little bit over on
time but oh actually one question yes go
go ahead one question
so the question is you know is that
snippet always so well contained that
you can just take it out of the webpage
and make everything work and certainly
we expect that over time the attacks
will become more more complicated but
even then so you know there's a lot of
ways that infections happen you know and
in in most of the cases we're able to
you know quarantine the code you know
the bad guys will get more and more
sophisticated it's an arms race so we'll
have become more sophisticated - there's
by the way other types of attacks where
the bad guy says well the heck with
infecting any of the web pages I'm just
gonna take control over the domain name
right and so so basically you know
whenever we possibly can we will we will
quarantine if we can't quarantine we
will at least block the infected web
page from going out basically you know
the more techniques that we have at our
disposal the better that we can do as
the attackers also continue to us
escalate
one more question that I think will
break
okay so the question is how complicated
is it to scan a webpage and should we
just make it part of the browser or or a
part of Apache okay um so so scanning
web pages for malware is very hard
there's a lot of different things that
can go wrong and I think that you know
building as many browser side defenses
as we can would be a good idea and to an
extent with with you know Google
providing say that information to
Firefox and Chrome that's a great step
in that direction it's a very quick
check that a browser can do but I think
we need to keep those checks quick
because browsers already have so much
stuff that they already need to do with
regards to what kinds of protections
that can be put into a server my guess
is that over time more and more
protections can be put into servers and
that's that's you know a good area to go
down but basically you know the scanning
itself you know is very complicated and
it can sometimes involve you know multi
multi level you know interpreting
content multi level you know looking at
not you know plugins looking at also
just things that could go wrong and the
OS around the browser you know so it's
just it just it's just probably too much
to do like in the browser so so in any
case um I I think you know with that
we'll we'll leave I'll be happy to take
questions offline but I hope everyone
you know came in and learned at least
one thing they didn't know before thanks
once again for your time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>