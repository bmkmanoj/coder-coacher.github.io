<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Drive-By Pharming and Other WebApp Bummers | Coder Coacher - Coaching Coders</title><meta content="Drive-By Pharming and Other WebApp Bummers - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Drive-By Pharming and Other WebApp Bummers</b></h2><h5 class="post__date">2007-10-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/kF5QtDRZU9w" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Bill daswani I am an engineer
here at Google and today I am
particularly proud to be introducing our
speaker sits term sits damn he's
interning here at Google he his advisor
at Indiana University is Marcus Jacobson
in a very short time he's made a variety
of contributions he is contributed to a
book that his advisor wrote he has a
paper on click fraud coming out at
usenix security he's had previous
publications at the world wide web
conference so we're very lucky to have
him he's gonna be talking about draw by
farming today in this talk it would be
preferable actually will be required
that you do not ask any google sensitive
questions as the talk will be made
available publicly on google video but
without any further ado Sid stem drive
by farming thank you thanks for the more
than generous introduction I'm not used
to that being a lowly grad student i
often get introduced as this is marcus's
student Sid so having a little bit extra
after my name was pretty nice anyway I'm
here today to talk about this drive by
farming attack that maybe some of you
have heard about or read about or you're
just interested in the name because it
sounds like some guys with guns driving
past a farm but i also want to talk
about some other related types of web
application what i'm calling bummers
they're not really exploits for web
applications they're more of just
confusing someone who's using the web
and doesn't really know what's going on
so I'm going to talk a little bit first
about identity theft because that
motivates the drive by farming attack in
its entirety since this attack is all
about stealing people's information and
then I'm going to go on and describe how
technology especially web technology can
be abused to do things like drive by
farming and then I'll show you exactly
what drive by farming is how it works
it's really not that complex but it's
nasty and and then we'll go from there
throughout this talk if anybody wants to
add
comments or anything just go right ahead
let me know I'll answer questions as we
go along it's not really a formal
discussion I'd like to have a little bit
of participation with you guys
especially when we get to the
countermeasures part or we're trying to
stop stuff like this is this not an easy
solution so identity theft comes in many
forms and online right now the most
popular form of identity theft is
fishing people will send out emails
saying hi I'm your bank in this case I
got this email from fifth third bank who
is my bank and it says we're performing
some software upgrades and you need to
click here and confirm your user ID and
password so it looks a little shady to
me because they never asked for my
password but what's even better is when
I click this link i go to a website
that's like free mp3s com / something
but the phishing emails go out to tons
and tons of people and a lot of people
will fall victim to this because this
looks like a legitimate email from my
bank it looks very good unless you look
at the text that's that's hidden down at
the bottom where it says things like
follow these the cycle would start again
aylesbury beseech well we'll have to
okay so this is spam and this is how
it's trying to get around the spam
filters which real Bank emails don't so
that's kind of ironic but anyway you get
an email like this it takes you to a web
page this is a different organization
but this is a fishing web page where
they're asking for my full name my ID my
password my credit card number its
expiration date my ATMs pin my email
I've seen others that go on your social
security number your passport number
your date of birth your mother's maiden
name etc etc and this is identity theft
at its finest this is taking it right
from the source and there's other ways
to steal people's identity well actually
one funny thing about this this page
itself it was it was copied from a page
that looked almost exactly like this-
these last many fields but this page
when shrunk looked like crap looked
absolutely terrible so apparently they
didn't put enough effort in to make it
resizable but
another type of identity theft stems
from crime where crime where is like
evil software that does nasty things
unexpected things on people's machines
and then whoever made the crime where
benefits financially usually for example
session hijackers these are things that
affect your browser when you're browsing
the web they look for URLs and when a
URL comes up that the hijackers
interested in it redirects you to an
evil copy of that website instead of a
legitimate one or session scrapers which
will skim off passwords as you enter
them in legitimate sites this includes
data Steelers rootkits I don't really
want to get into everything that crime
where is this is covered very well in
the past but this doesn't include things
like adware that just pops up ads or
like a code red worm or something like
that these aren't really crimeware
because they're not stealing your
information and benefiting like
organized crime would if you're
interested in crime wave for more
information you can see aunty fishing
org they have lots of information and
then we get into farming farming has
many definitions one of the definitions
just happens to be very similar to
fishing thus the pH I suppose and the
basic idea of farming is you manipulate
DNS records in order to bring people's
traffic to you instead of two legitimate
servers so I will somehow i don't know
manipulate DNS records so that everybody
who types in secure bank calm ends up at
my copy of the website instead of the
real secure bank this is sufficiently
harder than actually fishing because
you're not just sending out emails
erecting a website at some random place
and hoping people are stupid instead
you're actually screwing with the
infrastructure so this is a lot nastier
because people will look in there you
will URL bar when they're at a fishing
site and they'll see secure bank calm
and if they're really unlucky they'll
have a secure connection to secure bank
calm and no one's the wiser farming
isn't as prevalent as fishing but it has
a much higher yield more people will
fall victim to this because a lot of the
hints that
you're being fish just aren't there
there's many ways to do this yes is
there any data on how much farming has
happened this is hard to collect because
people don't notice it I don't know of
any good hard data but anyway this is
traditionally done in many low-level
ways such as with IP prefix hijacking
which is hard well it's definitely
harder than this drive-by farming
technique that I'm going to talk about
so all of this identity theft stuff is
somewhat complex but it gets a lot
easier when we have technologies that
are widely used and easily abused like
browsers everybody uses a web browser
well everybody on the internet uses a
web browser here are three popular ones
we've got Safari and internet explorer
and firefox there are others opera that
tons of mobile browsers but they're all
slightly different they'll implement
standards differently sometimes there
aren't standards to implement so they
implement technologies differently
they're all complex they're all
feature-rich except arguably links is
not very complex or feature-rich but
they have things like cascading style
sheets JavaScript plugins like activex
signed applets flash all of these
complex little pieces of the browser
make it a really nasty beast to deal
with when it comes to safety security
and privacy so for example you can make
an activex control or assign java or
unsigned java applet that will detect
your or the hosts internal IP address so
you're on the internet with your
computer you're behind a NAT firewall so
nobody in the outside world can see your
IP but they can serve you a Java applet
that will detect your IP and send it
home this is an example of something
that shouldn't be able to be done but it
is so let's talk about some other things
we can do with browsers on first I'd
like to plug a project I did a while ago
because I think this is a cool project
browser history snooping there's a lot
of different ways to get somebody's web
browsing history without their
permission none of them are really
elegant some of them are platform
dependent this method that we developed
uses cast cascading style sheets and
HTML nothing else and it determines what
you do you use for banking the gist of
this is it goes down a long list of URLs
and based on whether or not your
browser's visited them your browser
sends a note back to our server and so
we can see which which you are as URLs
of this list you visited and then we can
tell you for example you've been to bank
of america so we can conclude that
you've banked with bank of america
that's kind of a leap of faith just
because you've been to the website that
you bank with them but we can check to
see if you've been to bank of america
calm / my account / logout and then we
can know that that computer at least
that browser somebody who uses it banks
with bank of america this isn't a
vulnerability this is an abuse of simple
features and standards that are commonly
used you want links to look different
based on whether you visited them or not
so if you have a long list you can see
some are purple some are blue you've all
seen that that's useful it's incredibly
useful you also want to be able to load
using cascading style sheets you want to
be able to load images from remote
servers so you can set the background of
something or so you can do on mouseover
change the background to this image
that's all this uses anyway so we can go
on and on about this if you want to try
it on yourself you can go to browser
dash recon dot info and see if you're
vulnerable and send it to your friends
so we can see if they're vulnerable now
this is the beast that everybody's
talking about around here is cross-site
scripting cross-site scripting is mean
but necessary right I want to be able to
embed on my webpage a script from google
com that tracks the people who visit my
page so that I can go to Google's
analytics set up a big construct of
amazing stuff if you
visited it go there and track my users
using the google analytics interface in
order to do this I have to do cross-site
scripting and now it's not always called
that I mean this looks like cross-site
scripting attacks you know it's evil the
thing is I'm embedding a script from a
different website on to mine this time
it's intentional so it's not an attack
per se but if somebody is able to embed
a script on my site without my
permission then it's an attack if you
can put a script on somebody's website
you can do a lot of nasty things so this
is hot research right now the gray and
black hat hacking communities are really
interested in finding cross-site
scripting vulnerabilities everywhere if
you come across any web application
security blogs you'll probably see a ton
of this in there who I found this one I
found this one they pop up all over most
of them don't have huge data loss
results but they could if somebody
really wanted to take over a website I
like to say that right now hackers are
having a cross-site scripting party and
it will be going to cross-site request
forgery next what this is it's like the
evil cousin of cross-site scripting
basically what happens is on my site
which you may not trust I cause a
request to go to a third party site
without your knowledge for example
here's a web page you can go to if you
want since damn calm / netflix netflix
CSRF HTML if you go to this website and
you're logged into netflix it will cause
for requests that ad for movies to your
cute you don't see any of this all it
does is I have a blurb that says these
movies have been added to your queue
click here to check it also attempts to
add me as your friend on netflix so I
can see what movies you've watched I'm
not sure if that works because nobody
really knows about this site yet we'll
find out the basic idea is there's some
confused deputy your browser is making
requests on your behalf and your it's
doing things without your permission and
this is harder to accomplish because
instead of putting untrusted script on a
trusted website which was cross-site
scripting you're now putting
somewhat trusted URLs onto an untrusted
website and you have to lure people
there if you combine these two you can
do a lot of nasty stuff so anyway check
this out if you're interested cross-site
request forgery is mostly what I'm going
to talk about today one thing you can do
with cross-site request forgery is scan
a network see which hosts are alive so
say this this computer right here goes
to the devil web server and requests a
web page the web page is transferred on
to will call this the victims browser
and the victims browser then checks a
whole bunch of urls to see if they are
alive 192 168 0 dot 1 192 168 0 2 and
there's a trick you can use with
javascript in order to catch errors to
see which of the hosts that you tested
were alive now this is a great scanning
technique because given a starting IP
you can scan an entire subnet and find
out where the router is most home
networks only have a few computers and a
router yes yes yeah when I say alive I I
mean is running a service on the port
that's being scanned most often that's
port 80 or a web server most routers run
a web server most home wireless
networking routers definitely run a web
server so this is where it's really
interesting if I can write that applet
that I told you about before that
activex control that will detect this
computer's IP some local non public IP I
can then enumerate through other IPS on
the same subnet and see which one is the
router so here we've done internal
network detection and also internal
network detection of the router so not
only do I know how to get at the router
but I know how to get at the router from
the inside and this is important for
manipulating settings so what why does
this matter if you're scanning a host
network there may be printers there you
can compromise there may be all sorts of
things I'm going to concentrate on the
router because I think this is the
easiest to compromise and has the most
dire consequences so here's how it works
this how
scanning here's some code if you really
want to know what it does it's a for
loop that adds htmlentities onto a web
page and as it adds them the HTML source
attribute in these tags is accessed it's
adding a whole lot of script references
saying access the script at this IP
access the script at this IP and of
course there's not going to be a script
there but we're going to get one of two
errors back either the air is going to
say timed out could not find host or the
error is going to say that's not a
script if it says that's not a script
the host is alive and it's probably
serving web pages so here's a little
abuse of standard JavaScript now this
can be fine tuned by first detecting the
IP you can scan as many subnets as you
want and this can all be done in the
background and the results can be sent
back to the server who's hosting this
script now some people disable
JavaScript not many but some people do
so here's a way to do it without
JavaScript you serve up about a lot of
these you have an alternating sequence
of image and link tags the link tag
serve as a barrier to say stop rendering
stuff until everything up to now is
complete right well everything up to the
link tag is complete so what happens is
the image gets requested and while
you're waiting for the time out this
link gets requested to this server after
a duration that your server is set to
allow you send back a result to this
link tag and then it goes on to the next
image and you can use this to kind of
infirmity majid etc anyway this was not
my work but you can you can find it at a
URL that's really tiny here or you can
ask me for the URL after the show or
look for javascript free host scanning
yes
so how would this respond to browsers
that prefetch images it's this is
totally implementation based this relies
on the fact that when the browser
browser renders sequentially from the
top to the bottom this relies on that it
also relies on the fact that when a link
tags encountered that must be rendered
now before anything else can go on after
it if that changes and there's forward
fetching of images not interlaced with
these link tags then this won't work but
then of course you know go back to this
most people use JavaScript anyway so
host scanning is mostly unnecessary will
find 4dr by farming but you can use this
to find where the router is if you
really want so let's talk about we've
talked about the browser problems let's
talk about router problems I don't have
anything against linksys but they have
lots of nice images on their website
that i could use so here are some
problems with browsers first of all a
lot of browsers have a web interface
this is my first gripe browsers argue
your browser's excuse me routers have a
web interface for administration
arguably they shouldn't arguably there
should be some other completely separate
way of administering your home router
that has nothing to do with a web
browser because web browsers are complex
and they can be attacked etc etc yeah ok
so this is the the lesson that I'm
trying to just I don't know preach if
you will here's why a lot of routers are
thrown together sloppily and have very
generic code on them so that any forms
submitted on the router that may be in
post submission format can also be
submitted as a get request this means
you don't need a form on a page and a
submit button to get it to work you can
simply make a URL and cause a cross-site
request forgery so no person has to be
present to submit settings to this
router also default passwords are very
very common not many people actually
change the administrators password when
they get the router home and you all
probably do because you're interested in
this type of security so I'm preaching
to the choir here but
a lot of people don't they take the
router out of the box they plug it in it
works so they say I'm not screwing with
it it's a good philosophy you have this
black box that magically gets you on the
Internet okay but in this case it's not
a good idea right because default
passwords since they're the same across
many many many routers they can be guest
quite easily now additionally this is
less common but a lot of browsers will
serve images without requiring any sort
of authentication so if you request an
image off of certain models of browsers
without ever authenticating to the
certain models of routers without
authenticating to the router it'll serve
it to you as soon as you request a web
page though not an image it'll require
you to authenticate that's strange
behavior to me i would think that
everything would require the
authentication on a router and it seems
to me that would be the simplest policy
but in practice this isn't always so and
lastly all all these routers behave
quite predictably their mass produced
their mass distributed their wildly
popular so there's a small set of
configurations for username password
URLs and it can be guessed easily and
i'll talk about the details of doing
that in a minute but first let's talk
about what this drive by farming attack
that i've mentioned a few times actually
is what is it okay so here we have a
setup where we have two dns servers we
have an evil one and a good one we have
the internet service providers gateway
all your traffic goes through your
internet service provider somehow and we
have your home network or the victim's
home network not yours because you're
not victims so inside this home network
we consider its sovereign space this is
your house nobody should be able to
invade this the router is configurable
only from the inside if you try and
configure it from the outside it'll just
I don't know give you the finger and say
go away but in order to get at any web
servers like this is also a web server
you first have to find out where it is
you type in a name say evil calm maybe
not yet maybe right now yes you type in
a name evil calm in your browser and
your browser asks your host who asked
your router who asks your gateway what
the corresponding IP address is and it
goes to the ISPs DNS server since that's
what your router was told to use and it
comes all the way back and it says evil
calm is one dot one dot one dot one not
not likely but it fits on the slide so
now this is used in future browser
requests to access things at a volcom it
just goes directly to the web server to
get the data and DNS is a convenience if
you're not familiar with it talk to me
afterwards I'll fill you in but the
whole idea here is that look up can't be
trusted here's a different scenario you
have the DNS for evil calm as one dot
one dot one dot one and now you go to
the website evil calm you send the
request out the request goes to your ISP
the ISP sends the request to the web
server comes all the way back to you and
there's some evil JavaScript on this web
page the evil javascript is inside your
home network it runs on your computer as
you and reconfigures your router at high
level that's exactly what this attack
does users across site request forgery
to change settings on your router or on
the victims router excuse me none of you
because you're not victims so then any
future dns lookups are routed to the
other DNS server because if the evil
code is able to change the router evil
code can say use the evil date dns
server so now every single website is
wherever this evil person wants it to be
now you go to secure bank calm and its
really evil secure bank calm or you go
to google.com and it sends you yahoo or
something it's whatever this attacker
wants you to do and this is why it's a
problem most people won't notice they
see a web page that looks right
unless of course you redirect it to
yahoo then maybe something's wrong it's
like wait a minute this is not right but
if he's only changing the values the DNS
lookup values for banks for example and
he has a good good looking copy of every
bank sitting sitting around somewhere he
can fool you because you look at the URL
bar and it says I'm at secure bank calm
but you're really at evil secure bank
calm it's just hiding the fact from you
notice I haven't done anything low-level
no IP prefix hijacking I haven't screwed
with DNS cache is I haven't done
anything that sounds scary all I have
done is this evil person is served up a
little bit of JavaScript first thing the
JavaScript does is it takes these forms
that are present in router configuration
dialogues and it changes them from a
post submission to a get submission so
now there's a URL that when that URL is
access the router changes its state this
is this is pre arranged by the attacker
a good attacker is going to put maybe
300 of these on a webpage that are going
to cover a lot of different models a lot
of different you know firmware versions
all the most popular ones of course or
at least the most popular with people
who don't change their passwords and so
these three hundred requests can go by
silently under the rug well somebody's
reading a paragraph or two of text they
look kind of like this actually and in
fact the browser thinks they're images
so it sees no problem with requesting an
image from a third party site even if
it's an internal IP address in this case
i'm specifying administrator as an HTTP
user name and a blank is the password
now a lot of people have noticed this
doesn't work in all browsers works in
firefox internet explorer is going to
forbid you from doing this you can't
specify a username there's other ways to
do this you could do this in flash will
let you specify a username you can do
this with an activex control but then
it'll probably complain at you the best
thing you can do
is rely on the user to have not closed
their browser since they administered
the password but wait these these are
the people who don't do administration
right but maybe they use the same
password for everything so there's a lot
of different things to take into
consideration but consider the fact that
people are somewhat savvy and they're
using a browser that lets them do this
which is bad so this happens this
request is sent off and if it fails it
fails no big deal your router's not
going to lock you out from trying again
and one of the 300 is bound to work now
you may be asking me but aren't you get
error dialog saying I couldn't load this
image I couldn't load this image won't
there be broken images on the page a
clever web programmer can hide all this
handling the air is just like I
described you the host scanning before
they can make the images so small you
don't see them or hide them in an
invisible frame so in the end really all
this attack is this drive by farming
attack it's a long list of cross-site
request forgery the kenner cannot be
generated by JavaScript it doesn't
matter but the idea is I'm intelligently
doing a dictionary attack on a router
and as I'm doing this I'm finding one
URL that's going to work for me from a
fairly small set of URLs that I need to
test ok so it's a simple attack sounds
pretty realistic what does this boil
down to well we did some number
crunching and about half a people use
use a default password on the router
which is interesting this was an
informal study obviously you can't ask
people if they have excuse me do you
have a bad security practices yes I do
no but you can do some tests to find out
if you're interested in this study I can
point you there also it turns out that
what is it ninety-five percent of people
have javascript enabled in their browser
so we're estimating that about out
forty-eight percent of people could fall
victim to this attack that's millions
and millions of routers
okay does it work on all the routers
that's the next question you should be
asking well I tested it on these three
these are just three models of routers
we know it works very well on these
routers and Firefox no problem IE kind
of works but okay it's got to work out
more routers because there are lots of
models of netgear that have very similar
configuration screens there are lots of
models linksys that have very similar
configuration screens there are lots of
other models the routers that we didn't
test so luckily after well we issued a
press release with Symantec about this
problem to get the word out tell people
to change their passwords and
interestingly enough at about the same
time Cisco releases a security response
kind of thing saying hey everybody
there's this information about a farming
attack yes our routers are vulnerable
you should change your password here's
the list of routers that are vulnerable
and they published a list of 77 routers
this is really Noble they're trying to
alert their users that you need to make
sure your password is hard to guess and
they got all the crap for having
vulnerable routers poor guys I feel bad
for him and they're trying to help
people protect themselves so they're all
sorts Cisco and out 77 what about the
other manufacturers there are all sorts
of routers out there vulnerable and I
see this as a huge problem because if
you can compromise a lot of routers dns
entries you have the ability to also
turn on other settings like remote
administration or you can upload new
firmware onto the routers and what does
that lead to well hmm that leads to a
router zombie network now we have all of
these bots that are up all the time
normally when you think about a bot
network you think about a bunch of
compromise pcs of people who don't know
anything about spyware adware bot
networks and viruses and you think about
pcs being controlled by one central
location well now we have routers
routers that almost never go down
routers
that are up when people are not home
routers that don't change their ip's
ever and if you can control those well
there's something in that and of course
it would be worse if these zombie
routers actually sought out brains right
because then we'd have some doomsday
scenario where routers are then turning
into the attackers themselves and
spamming people with emails saying check
out this cool website where people click
on the link and go to a compromised
router and then their router gets
compromised and then their router is now
a new new thing and we have this viral
spread this ok so this hasn't happened I
don't anticipate it happening anytime
soon but people are worried about an
epidemic spread of things like this and
it should be taken seriously when people
have mismanaged routers there is a
possible doomsday scenario and of course
you know a press release that says
everybody's screwed we need we need to
protect everybody's routers is going to
get a lot of publicity and here's a
little bit of what we learned from it
the top to show you a couple of
newspaper headlines or electronic
publication headlines because they
probably weren't print newspapers new
drive-by attack taking over home routers
change your router password now it was
somewhat sensationalized but they got
the message across a lot of people were
confused because of the name drive by
farming they're outside my house no
they're not outside your house this is
not drive by in the sense of a shooting
this is drive by in a sense of drive by
infection there are a lot of websites
out there where you go to the website it
attempts to install a virus or malware
something on your computer that's drive
by downloading this is similar to that
maybe we should have named it something
else router hijacking inside attacker
but most people got the idea and my
favorite responses came actually from
slashdot because people I don't know
you're familiar / to have people post
interesting replies to stories on
slashdot like will chase our farmers
with our flaming torches and pitchforks
with ph's placed appropriately or drive
by farming this is the way
drive by farm one drive by farm to stop
park three milk cows for feed chickens
five slot pigs stack hay seven profit so
debatably the name was not the best name
that we could have picked but got the
message out and we got publicity so it
worked in fact people like the name so
much that one unknown person registered
drive by dash farming calm there's
nothing else here there's no links some
advertisements they're probably making a
little bit of money off of it probably
hoping we wanted to buy it from them but
anyway yeah people know about it that's
what's important everybody should set a
non-standard administration password on
the router for now well we work on a
better solution to the problem but this
attack really isn't limited to routers
alright there's other devices that use
networks like your home network for
example there's this new product coming
out I think tomorrow called the iphone
that has a web browser on it well we
don't know much about the iphone yet
other than it will have a full browser
web two point O widgets and some
mysterious mysterious operating system
OS 10 apparently but on a phone maybe so
the question is can we attack the phone
itself using the browser and I don't
know the answer but I think the answer
is probably yes if Apple's done they're
good good job with security and locking
down Safari which doesn't seem to be the
case on Windows they will have done a
good job and protected the phone and
we'll have this instead of the evil
attack horn phone from hell anyway so
the lesson is we need to be prepared for
new stuff we need to think about what
we're doing and so let's start by
thinking about what types of
countermeasures to drive by farming may
exist and here's where I would actually
like some input if anybody has an idea
of how to stop this other than making
people change their passwords pipe in or
raise your hand or I can prime you I'll
prime you okay let's start with people
what can we do to people to make them
not vulnerable to this we can teach them
we can teach them about web security and
they can get a degree in it and I'm a
cynic of the user education because
we're going to come up with new stuff
and we'll have to teach them about the
new stuff and at that point teaching
becomes full time for everybody we could
teach them about DNS so they don't well
no actually that might not solve the
problem what else could we do that we
what could we do with people that would
help solve this problem don't let them
use computers yes we have a Luddite in
the audience okay well let's move on and
people are maybe not the solution oh yes
you exactly okay what if what if you
force them to set a password before the
routers usable we'll talk about that in
a second but let's let's talk about
browsers that's actually a great idea
what could we do with browser is to
prevent this sign all web pages with
keys that are trusted by central
authority I don't like that idea okay I
don't think browsers are the place to
solve it either now we get to the router
right what can we do with the router we
can we can make a non-standard password
we can make it hard to guess I've heard
a lot of suggestions I've heard set the
serial number to be the password and
router so you need to actually be within
proximity of the router to understand it
debatably that's not a good idea because
there may be ways to get the serial
number also the serial number is
probably in a small space it's also been
suggested that people will need to set a
password just as you mentioned before
they can use the router for the internet
and I think if there were two companies
selling routers and one of them required
this and the other one did not and allow
default passwords every would buy
everyone would buy the ones where you
don't have to set a password simply
because when you bring it home you plug
it in it works but that would solve the
problem if all we routers did that what
else could we do we could implement the
administration console properly so it
doesn't accept get requests don't use
HTTP to administer it
Apple does this with their their
wireless base stations you need to use
the special application or SNMP to
administer it so naturally those routers
are not vulnerable to this attack it's
also been suggested that a random
password is made up printed on a sticker
put on the router and shipped to them
and that's the default password for the
router interesting idea so it boils down
to something unpredictable yes sure so
the question is would the wood the wood
disallowing get requests on routers
actually solved the problem maybe
probably not like you said we could put
a form on a web page fool someone into
filling out the values 10 dot 231 dot 4
dots 6 or you can do other things to
capture keystrokes and put them in an
order or put a bunch of hidden fields
with stuff you want and get them to
click on a button that would work too or
you could assemble a post request in a
flash file and submit it to the router
does there yeah you're right I don't
think it would solve the problem but it
would definitely help yes so you
answered your own question you could add
a CAPTCHA to all configuration
submissions so that before this
configuration is allowed on the router
it has to be backed up by some sort of
second factor like CAPTCHA but people
yeah they see captures all the time like
you mentioned and we'll just fill it in
in fact people will fill in CAPTCHAs so
frequently that I'm sure spammers are
using captures from other sites on their
website to solve them for hacking
purposes but anyway so maybe that's
that's not solvable only on the router
can it be solved on the Internet service
provider can we have the ISPs take care
of this we could have the ISPs disallow
any DNS traffic except for the ones
going to their servers their servers go
down their network goes down
it's not a good idea also some people
don't like their dns servers that their
service provider offers because it's not
complete so they use opendns or
something like that but this is an idea
and if ISPs are interested in closing
down pieces of their service they're
more than welcome to but I don't think
that's that's the problem you can also
block ports do all sorts of crazy stuff
for the ISP but I think people will
resist this if you start blocking things
I think they will tend to want their
freedom and go to a different isp I
think all of this really boils down to
one word boundaries we need to
understand all of these technologies and
where they overlap we need to understand
the cross in boundaries like the same
origin policy that prohibits website a
from talking to pages from web site B
that's a good policy we need to
understand it better when we're
implementing a browser and we need to
actually implement it clearly distinctly
and properly there's other policies that
need to be understood as well access
control why can my browser submit
requests to my router doesn't seem like
an easy technical solution but we need
to understand why my browser can submit
requests for me if we get this wrong
then context boundaries closed down and
we end up with the mess that we have on
the web right now that's websites that
can kind of talk to other websites in an
unspecified kind of frenzy and this this
leads to cross-site scripting this leads
to cross-site request forgery and this
leads to abuses of technologies that
everybody uses and I mean we see a lot
of companies going the right step google
is taking the right step they're
defining boundaries especially with
api's properly security is being taken
very seriously here especially with
respect to cross-site scripting and I
think it's a start but we need to keep
keep track of this and everyday work and
make sure that these boundaries aren't
easily violated that's all I have
any residual questions yes has nothing
to do with it they're just by far the
most common drive by farming can be
pretty much accomplished on any router
that's HTTP configurable oh and not
protected yes okay so the question is a
lot of banks use certificates that are
signed by a certificate authority so
that when you go to the website the
browser can authenticate the server and
if by farming someone is taken to an
illegitimate version of the site where
the certificate is not signed by the
authority does this still work will they
really be fooled and the answer to that
question is not all that clear because
they're a bunch of different ways to
implement a site the first thing you can
do is forbid a CH TDPS connections
obviously that will filter out a lot of
people who only want to bank over HTTPS
like I would not go to that site the
second thing you can do and a lot of a
lot of websites actually encourage this
use is you can rely on a bad use of
secure post a lot of websites will
provide a non secure connection at first
so they can load really quickly and then
it will post when you submit your
username and password it will post to a
secure web server okay so if that's the
behavior on the bank then somebody can
spoof that and just never post to a
secure web server another option is to
provide an unsigned certificate and
arguably people will accept anything you
give them so you will still be able to
compromise a large number of accounts
right so yeah how many people would
notice that they ended up at an HTTP
connection instead of an HTTPS I don't
know many who would the people who
aren't security conscious about their
router probably are the same who
wouldn't notice anything about
certificates because they seem more
obscure to me than router security yes
ok so the comment is that browsers could
forbid you from entering secure
information and websites that are not
authorized sure if we had a proper
public key infrastructure this could be
may be implemented in browsers but
whoo-hoo whitelists websites you trust
verisign ok well then we have a policy
debate instead of an implementation
debate but ok the comment is what if it
fails closed so that if the certificate
isn't authenticated it just doesn't let
you access the site I think that would
really take off a lot of people who use
their own cas it would take off a lot of
people who use self-signed certificates
for testing not necessarily uh it's it's
a little bit of extra work in order to
get all of your clients to add a CA to
their browser my university has a CA of
their own and I have to add it to my
browser to get rid of those do you want
to accept the certificate dialogues that
ticks me off to no end but I trust my
University
right right so that for people who
didn't hear that to come the comment was
it just moves the problem from from
actually just automatically allowing
somebody access to convincing them to
allow access because ultimately users
should have control over who they trust
so if you can fish them then you can
farm them okay thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>