<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How To Break Web Software - A look at security... | Coder Coacher - Coaching Coders</title><meta content="How To Break Web Software - A look at security... - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How To Break Web Software - A look at security...</b></h2><h5 class="post__date">2007-10-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ZgW2B2gKZVw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I
we can get started just a little bit
early
books so a couple things first thank you
all for coming this these talks are
sometimes done on short notice so I
appreciate you all keeping up on your
email thanks to Mike for for doing the
presentation thank you to hike and the
QA managers for supplying the books
google put in an order for 150 of the
books in order to get everybody thinking
about web software and insecurity for
the talk today mike has agreed to have
the talk videotaped and we're going to
put it up on google video externally so
questions are okay but if you have any
questions at the end that are of a
confidential nature just wait until we
finish videotaping and then you can ask
questions and at about noon or so we
lose this spot and we're going to head
over to lunch so although it hasn't been
done officially or anything you're very
welcome to join us for that okay thanks
very much mike Andrews I'm sorry well
thanks for inviting us up here and
thanks Harry for the great quote on the
front of the book I'm sure it's you know
more than double the amount of
readership of it and everything so let
me just introduce myself very quickly
i'm mike Andrews I'm a senior consultant
at found stone which is a professional
services company mostly what we do is we
do security testing and then kind of
things I lead up the web testing so I
lead up the application web services
valuations and that and also i teach
ultimate web hacking classes so that's
sort of my background and before that I
was a professor at University and before
that as you can tell by the X and I was
from the UK so I please don't hold that
against me too much as you guys are
obviously aware by setting history here
we're living in a web utopia now pretty
much everything is now becoming on the
web and if you look back in just its
early history November 1992 there were
23 web servers out there in the world
everybody knew where they where they
were everybody knew where to go and get
there you know their physics pong so if
they went to a particular server to get
that today
april to april 2006 it's about 80
million host names out there when you
look at the survey from a company called
netcraft now i actually think that maybe
that numbers a little bit low especially
with you know the the number of pages
that you guys index now over 8 million
pages it might be a little bit low but
these are this just goes to show even if
these even these these figures isn't
completely accurate it just goes to show
how much things are growing so the
growth for the internet or the or the
World Wide Web the initial idea was you
know geeks sharing physics documents and
a little bit before that it was
effectively an online phone book whereas
nowadays you've got you know 6.5 billion
people on the worldwide web according to
you know internet statistics
everything's on everything's on the web
now from the phone books and stuff like
that to your email companies trading on
the trading on the web you've got
companies that just solely exist on the
web they don't have any other any other
kind of any other kind of outlet you
know amazon amazon is a good one they
have no physical book stores or anything
yet they ship physical goods so this
kind of stuff has changed a lot over the
years and now what we've got is we've
obviously got the next the next big push
of that web two point O which it's a bit
of an odd saying the next next
generation of things but you know a good
picture now thats as thousand words and
everything that's one half of the
picture all these companies out here you
guys will probably recognize a few of
them in there you know there's bloggers
in there is rightly theirs gmail on the
other page there's a there's a whole
bunch more that you recognize but you'll
see that what's happening is more and
more applications are going onto the web
it's not just information out there now
if what is actually using it as a
delivery platform and as a way of
pushing software not just statically
browsing pages and things like that so
obviously we're talking about security
we're talking about you know how to
break web software and stuff like that
so what is the state of play out there
so I did just before I come along I went
and had a look at two days worth of
vulnerabilities from security focus you
guys must know this site it's a
it's a pretty well-known website that
basically you know lists the
vulnerabilities as they occur in a place
where you can where you can track them
and see what's going on and just by
scrolling down you can see that you know
there's a fair few web vulnerabilities
and things like that another good place
to go to see the kind of the kind of
what's happening out there on the web in
terms of security is the web app Sikh
community and the and the
vulnerabilities yeah sorry guys I can't
scroll up any more than that but you can
see the kind of things that are going on
all the time so what is what is
generally the state of play out there
the state of play something like this
forty five percent of the web at of the
vulnerabilities that I looked at over
monday and tuesday would to do with the
web in some way in fact the monday and
choose these statistics are a little bit
skewed slightly because there was a fair
few vulnerabilities that are released
for internet explorer which made the
appt portion the a percentage go up and
also there a good few vulnerabilities
released for the for the linux kernel
which pushes the OS up a little bit more
now that's that's pretty uncommon in
terms of the statistics where's if you
look at things like that lib which one's
an Aries is library so things like you
know Network libraries and stuff like
that there's a lot less vulnerabilities
being released on you know being
notified on these arm day on day but if
you go back just ten years ago the
number of vulnerabilities that would
have been on you know networks tax and
stuff like that would be huge proportion
back a bit further five years ago it
would be the OS vulnerabilities would be
a lot bigger then it was application
vulnerabilities were a lot bigger and
there you'll see that you know WebRunner
abilities are taking up more and more of
a slice of the pie so what are these
vulnerabilities that are out there well
they look something like this this isn't
it this isn't unusual although that the
stats are a little bit skewed to do with
a platform the actual vulnerabilities
are seem to be pretty pretty standard
with this cross-site scripting be in the
biggest the biggest cause of
vulnerabilities out there the biggest
cause of reporting them SQL injection
used to be the one that was the biggest
although people are getting more and
more in tune with what SQL injection
means and why it's a bad thing and how
they protect against this so that slice
of the pie is going down slowly it's
being replaced by cross-site scripting
cross-site scripting will start to be
addressed and it's one of the big things
that I'll talk about here so that will
get smaller what do I think the next
things are going to start becoming more
of an issue things like authentication
authentication takes a very tiny slice
of the pie mostly because the attackers
or hackers or whatever you want to call
them go for the most easy thing that
they can do and cross-site scripting is
shooting fish in a barrel with a lot of
applications authentication floors and
stuff like that might take a little bit
more effort so what they're going to do
is they're going to look at them later
so over time some of these portions will
start going down a little bit more and
some of them will start to grow this is
just a quick snapshot in time so what
the hell happened here we were doing
pretty well with the dressing all the
vulnerabilities in the network stack and
now addressing vulnerabilities in
operating systems and addressing
vulnerabilities in applications why is
web in such a bad state the idea is we
should get better each time there should
be less and less and less what happened
well HTTP which is also known as you fbp
does anyone know what that acronym
stands for no one out there
yeah pretty much the amount of stuff
that's being transported over HTTP just
because it bypasses proxies and bypasses
firewalls and gets inside the net it
gets inside the the the security is just
so that's in the security industry
sometimes we like to call HTTP the
universal file will bypass protocol
protocol because generally what happens
is it is your application and your
network and your internal assets are
built like a fortress all the sensitive
information everything is on the inside
it's in the keep you try and make sure
that it's all nice and secure see big
build nice big strong walls around it
and hopefully you guys have heard of you
know defense in depth what happens is
you build more walls around it and on
this example you build another wall
again and then put a nice big ditch and
fill it with water and put guards on the
tower what does HTTP do in terms of the
networking nowadays well it blows big
holes in the wall so anyone can just
walk straight past and also you know
even though you might have guards on the
walls or shoot arrows that people that
they don't want that may be wearing the
wrong color the wrong color jersey or
something like that that they're known
enemies wrapping stuff up in SSL
basically encrypts it and if it's
encrypted to the source the guards don't
know what's coming through they can't
analyze it because it's encrypted so
this is one of the this is one of the
issues web apps are becoming a more and
more of a target because of where they
are and because they're inside and they
can bypass through a lot of the security
controls so cela quick look at some of
what the security controls are there are
four different things so security
controls for the network we've got fire
Wars as we said before we've got
intrusion detection devices the guard
standing on the towers looking and
saying okay is that a friend or foe do
we let the middle do we let them in or
not we've got vulnerability scans under
ability scanners that look for known
issues non configuration problems
patches patch levels and things like
that and we've got certain procedures to
help hardened network devices and
network servers and things like that
we've also got VPNs to segregate traffic
from different play
and all that kind of stuff in software
we've got access control lists not only
on files now you know files of who can
read who can read things but also on the
actual code you know we've got sand
boxes that code running so that you know
even if the code is Miss B it is not
well behaved it can't escape that
sandbox and it can't do anything really
bad also you know we've got things of
staying up and what kind of permissions
is that code allowed to allowed to do we
started to get you know reasonable ways
of buffer overflow protection everybody
knows about buffer overflows now the
amount of them that are out there I
started to go down it's only probably
taken us 30 years after overflows was
known as a major problem and there was a
paper written about it in 1970 and so
now we're starting to address it so
we've got some lead time on these on
these things we've got least privilege
so we know you know not to run a web
server as root not to run critical
services as local system and things like
that and we've also got libraries and
frameworks that are out there that have
they have some level of quality that we
know of we know that you know they've
been reviewed to a particular level we
know that they're less runnable to
things so we use them more because and
reuses good in software engineering but
also it gives us some control over
security because the quality of the code
is known this is where we've got your
networks and networks and traditional
software well we got on web software
anyone yeah you know it's not quite this
bad there are things out there but
there's nothing you know that's the
that's the de facto standard of of
things there's no you know really
well-known framework that everyone
programs onto the web for and SQL
injection and cross-site scripting don't
happen on that because it's known to go
through particular functions that's
triple these or all these kind of things
so what's happened is we found out that
the web's different the web's different
from networking and is different from
traditional software and what happened
is as we did the paradigm shift from the
you know the fat client
model of everything sitting on your
local machine and processing it there to
processing it going back actually from
the game from the the mini or the
mainframe to the local machine do neural
processing there and slowly removing
stuff back again some kind of amnesia
set in and we forgot all the things that
we learnt before so we underestimated
the target the web servers would become
web server is a great target for
attackers for a number of reasons first
of all is they they're in this really
odd position in the in the network
topology their semi trusted machines
because you have to publish data to them
and stuff like that but you have to have
anonymous users access them at the same
time so then two security things that
are against each other also generally
web servers are are very high-powered
machines with a nice big fat network
pipe and if attacker wants to use it for
even you know denial of service against
something else or a worm it's a great
target if they can get control over that
then they've got a much more powerful
machine than they could possibly get any
other ways we also rushed into
development and we forgot a lot of the
things that we learned from previous
development you know we've got perhaps
this you know the rapid prototype in and
the end of the year on the seven months
on the web is effectively a year in real
life and all them kind of great you know
let's let's push things forward but we
lost track of some of the things that we
were doing previously in networks and in
software in the quality and the and the
checking and stuff like that so we've
forgotten a lot of the lessons we forgot
a lot of the software engineering
lessons we also forgot that the web's
different in that it's a different
environment there are different issues
than there are there's a lot less
there's a lot less control that you have
on how things operate in the web there's
different kind of attacks you know
buffer overflow attacks on the on the
web are very very small in terms of in
terms of you know by application
percentages of underbelly percentages
so all our things that we did learn were
thrown out the window and we didn't
start to address the new things that
were out there sometimes I wonder that
we actually got as far as we did we're
just hanging on there by the fingernails
some people say I don't think it's quite
that bad but it could be a hell of a lot
better so the web was never really
designed to be secure it was designed
for geeks sharing physic documents was
designed to be static just information
gathering it wasn't ever designed to be
a platform to run architectures off it
certainly wasn't designed for a platform
to run a multi-billion dollar business
off of so what kind of things are in
there that are against security are
security concerns with the actual design
of the web and things that we have to
overcome one of the ones one of the big
ones is that we intermix code and data
all the time on the web it's like having
a signal channel on a control channel if
signals can stuck it in misinterpreted
as control then all of a sudden you can
make free telephone calls if it's on a
telco network the same it's exactly the
same that happens with buffer overflows
the stack is considered to be data but
there's code in there in return
addresses and if you can push enough
data onto their that overwrites the
return address and it becomes code that
helps to control and that's how you can
overtake this exactly the same with the
web having JavaScript embedded into HTML
markup is this is the same kind of thing
we also have no control over the client
because the web being so open which is a
good thing means anyone can develop on
it also means that anybody can write
their own we're back and can also their
own web client and can also you know do
command directly to a web server using
telnet or netcat or something like that
anything that you sit on the client you
can completely not trust that it will be
that will behave correctly and that's
one of the assumptions that people have
another big problem with with with web
in terms of security is there's no state
you have to add stay on to or onto it
doesn't come there as part of you know
web infrastructure so if you take things
like when someone authenticate against
the authentication against the against a
system you want to know who that person
is so they can track what their
permissions are every time they access a
resource or something like that you have
to have that state of who that person is
and what they're allowed to do follow
them with them all the time it's an
extra thing you have to keep you have to
you have to keep considering and also
what we've done is a lot of these issues
the ones above that we're talking about
we've effectively patched them we've
added something on top that sort of
address is it maybe not quite so things
like for state we've added cookies
cookies help us with state things like
authentication htb basic and actually we
digest for authentication soon for that
to stop data from being from from being
viewed and man-in-the-middle attacks
you've got SSL and stuff like that
they've all things have been added on
top of the web on top of things and one
of the managers that I like to do is you
can't patch for security you have to add
it in the very very beginning so we've
got these we've got these technological
problems we've also got the educational
problems and the and the learning
problems is that the learning curve of
writing stuff of the web isn't that
steep really if you're doing more
complicated stuff then then thing yet
but anybody can publish a page or can
put a shopping cart up online and things
like that so the writers of web apps are
becoming are becoming you know they're
not what I would call the hard core
developers that were writing the
applications previously you have things
like you know pre-built shopping carts
for mum and pop shopping stores which
they go and they see a book and they go
out ecommerce ecommerce for dummies
there's some stuff in it some code in
the back of that I'll just copy it out
i'll put it on to my site and everything
must be just fine and they wonder at the
end of the end of the at the end of the
month why they actually get a credit
card bill because someone's been messing
around with their systems before I wrote
the book sometimes I was a little bit
reluctant about writing stuff and
getting it out because you have the
thing of you know I know this stuff
everybody else out there must know it as
well so I went to my local barnes &amp;amp;
noble and i went through some of the
books that were on there to do with web
programming and I was pretty horrified
they're out of current remember how many
I looked at but there was something like
thirty four books that I went through
that the code actually had security
flaws in them in there so as I went
through and thought oh someone's
learning how to how to do something then
this code is teaching them how to do it
and it's teaching them how to do it
wrong and they have no idea so you've
got there you got there so you've got
the writers you've also got the
attackers and the attackers the skill
for attackers on web apps aren't nearly
the same as the skills to attack you
know normal web apps normal apps if
you've got things like a buffer overflow
actually craft an exploit for a buffer
overflow it's pretty difficult there's
some serious hoops that you have to go
through to actually find a buffer
overflow on some applications you have
to do you know reverse engineering or
really understand the underlying you
know the instructions that you have that
the processor executes and how things go
from there as I see on some of these
it's not difficult some of the attacks
on web apps are not difficult at all so
what happens when you get hacked well
sometimes you don't know about it into
it's too late how many of you guys have
heard of card systems they were a credit
card processing company they were like
so say for instance wasn't one of their
clients who say for instance mean I
McDonald's uses credit cards it goes
this this place it verifies the
transactions passes them on they had
their database stolen of all of their
credit card numbers and people's
people's data from that through an SQL
injection vulnerability was the was the
talk Harvard Business School unheard of
them being attacked our business school
has an online like an application thing
where you put your application in so
that where you where you put you know
what your SATs scores and your essay and
things like that and it goes off and it
gets reviewed and it comes back and it
says you know welcome you've been
accepted to harvard business school or
no sorry go to one of the other schools
what they found me one of the one of the
guys that was going through that fair
that he went to the application and he
saw ID equals 1 2 3 4 they thought so
what do I chair what happens if I change
that to 1 2 3 5 all of a sudden he was
viewing someone else's at someone else's
application the unfortunate part of that
was I believe that that application
hadn't finished yet hadn't finished
going for all he's processing so it
hadn't got an approval or a rejection
and so therefore all of the comments
were on that as well and I hope that
wasn't saying you know this this
applicants are more on and shouldn't be
and so one of my favorite ones is the
Paris Hilton hack if you heard about
that there's a lot of weather with how
this happened or not but anyway Paris
Hilton got her cell phone hacked and a
lot of pictures were released out onto
the web including some of her friends
phone numbers who also had to go and
change their phone numbers because they
were getting harassed and stumble like
that how did it happen well what
happened was one of the one of the one
of the stories is that you've got what
happens if you forget your you're
logging what happens you get your
password we need some systems say it is
me let me get back in and let me change
your password and so what lot of them do
is they say what's the secret question
and a secret question was anyone what's
your pet's name and so with the marvels
of you guys so I blame you guys for
having her system hacked how did Paris
Hilton get hacked well she answered
what's her dog's name and there we go
that was it they were in so it's all
your fault so that's what happens
sometimes sometimes though it's just
good old-fashioned graffiti I see that
you guys are great fans of graffiti so
you think you might appreciate these
according artists interest industry of
America looks exactly like their normal
homepage apart from piracy can be
beneficial to the music industry adult
entertainment now wonder where that
links off to inside the RIAA with Eric
Cartman and I doubt that he's a very
good
spokesman for the riaa and my absolute
favorite where can I find information on
giant monkeys another one doesn't look
too bad until you notice that it's
actually al Jazeera's home page you'll
see that these are starting getting less
and less subtle a lot less subtle so
let's have a look at you know what is a
what is a security bug let's let's start
off from the very very beginning so a
security bug is a mixture of one of its
combination of three things of a
combination of an asset a vulnerability
and attacker if you guys back in you
know back in high school you about you
know what is what is fire made out of
firing oxygen heat and a fuel source if
you want the fire to go out you remove
any side of the triangle when the fire
goes out yeah so if you've got these big
you know oil fires ready there any team
comes along what do they do they spray
water on it no because you're probably
not going to get the temperature down
enough to do anything different what I
do they set an explosive off next to the
pipe which sucks all the air out of it
and then you just got a stream of stream
oil you have to be really careful around
but the fire has gone out it's the same
for a security bug you got an asset a
vulnerability and attacker we start off
looking at the assets if there's no
asset and who cares whether a
vulnerability whether there's a
vulnerability or an attacker can get in
there because there's nothing for them
to steal attackers you can say that you
know attackers may not be you can't get
rid of them completely but some
companies like to think that like to say
for a risk a risk assessment point of
view that internal once we're inside of
our firewall there's no attackers will
forget for the moment that some stats
say that seventy percent of attacks
against the system come from the people
inside the firewall I know the lunatics
are already in the asylum don't worry
about the people on the outside because
they're still doing enough damage but
some people say that based upon a risk
assessment point of view will trust all
the people inside and if you
application is only accessible to inside
that side of the triangle gone we don't
have to worry about it anymore that's
two sides we've managed to knock out the
third side the vulnerabilities is the
difficult one to make sure your sister
your software has no vulnerabilities
whatsoever is a particularly difficult
thing to do let's have a look at where
security bugs hide now couple of you
guys were saying you know like the
previous book that I did and it'd be
nice to take James's credit but now I
didn't write the other book that went
along with this series is even James or
Hugh Thompson wrote it but software is
part of two things it's part of how it's
designed and how it's implemented be
nice to think that these two circles
overlap completely in that how you
design things and how your programmers
write them are completely the same and
unfortunately that's not the case
functional bugs usually lie in this part
of the of the diagram what they are is
they're things that you've designed but
the programmers haven't implemented them
correctly so they're things like you
know doing two plus two equals five the
design was it was supposed to add things
up correctly but it didn't funk that the
security bugs on the other hand are in
this part of the diagram what they are
was the system is designed to do a
particular thing the program is coded to
do that particular thing but it does
something extra as well so let's say for
instance we've got our media player
media player is supposed to play
encrypted content we might also do
though is to help it with buffering and
for performance it might store it might
download the stuff and unencrypted it
and store it in a temporary file and
then play from the temporary file
according to the functionality it works
just fine but there's these extra little
side effect that there's this temporary
file which has them it will be
unencrypted data in it so this is where
these are kind of security bugs life so
how do you look for them whereabouts do
you look well where is with functional
bugs functional bugs can lie anywhere in
the software if we've security bugs
we've got some kind of head start in
that because of the triangle they're
only going to exist in certain places so
what fast aren't done
so I've created this security frame
consisting of in a configuration
authentication authorization using a
session management data validation data
protection error exception had an
auditing logging these are the kind of
places where we found security bugs
generally lie now depending upon the
type of software you can generate
checklists to go through you can say
okay so for instance authentication
check that you can't do direct accesses
so you know if I know that if I know the
address of a page what happens if I
request that before I've authenticated
yeah so there's a series of checks that
you can do with that so it gives us a
set of common bugs to look for by going
through these kind of checklists the
thing is is is is it's naive to believe
that any kind of checklist is going to
be comprehensive enough and cover all of
the kind of things that your
applications do so you've got things
that are application specific but your
application does that none others do out
there the way that it works is different
and it doesn't fall into all of these
standard canned tests what happens if
new attacks come out there but you
haven't got a check for do you just say
well I'm not worrying about any kind of
vulnerabilities that released three
months ago there they don't exist as far
as I'm concerned you can't do that
because your systems still vulnerable so
thinking about new tests and new things
to do is actually pretty hard it's like
it's like if you're any kind of if
you're an artist I've got not one
artistic bone in my body but I'm told
the artists when they get this nice big
blank canvas can sit there and stare at
it for ages of like first of all what am
I going to draw on this the second of
all ways once they've got a view where
do they start they start in the upper
left corner and work in or do they start
in the middle and work out sometimes
it's hard because you've got this nice
blank canvas where do you start there's
such a big problem where do you start
looking also you've got the phrase we've
if all you have is a hammer we heard
that phrase before before you've got a
hammer what's the other part of that all
you see is nails if you have a
particular toe then all you're going to
say
is bugs that that tall can address if
you've got a framework or some kind of
checklist and that checklist
incorporates these kind of things all
you're going to see is bugs that that
checklist finds so you've got a widening
you've got widen things up a little bit
more so frameworks like that framework
that show that I showed you earlier and
mental models of how to look at software
help so if any of you guys heard of
stride before couple of people a couple
of people are more laughing at the
Ministry of Silly Walks picture aren't
they yeah I'm English I've gotta put a
picture of some Monty Python sketch in
there somewhere so stride stands for
spoofing tampering repudiation
information disclosure denial of service
and come on click escalation of
privilege what these are these are
mental models to help you think about
bugs and how to and how to look for new
bugs so what you do is you look at each
of the functions of the application and
you go through the security frame so you
go for insecure you go for your security
frame of whatever your checklist is and
you look for the common bugs learn by
your mistakes previous mistakes that
you've had if you had if your
application has been really vulnerable
to cross that script to cross that
scripting ratico injection look for them
kind of bugs because you know that that
that they're there that there's a
professor at MIT jung-gu tag and has a
really nice quote on this is bugs are a
lot like cockroaches in your kitchen if
you have one you probably have more and
it's not something that you should be
happy about so go through and look at
the common ones that you find but also
go through stride and think of potential
attacks so you go through and think what
can attack and do if they could s
spoofer user yeah what could they do if
they could do that not necessarily how
they could because that comes with later
with your test cases and your exploit
but what happened what would what what
would happen if they could would they be
able to access your application would
they be able to do anything nasty so
let's go through a little example we've
got a particular bit of functionality
with sign up for a new account print
we need to do authentication so
obviously there's our standard
authentication checks in there and then
we go through the framework one at a
time thankfully you guys have got a
great application which exhibits a lot
of these things the gmail sign up so we
look at the spoofing first when you sign
up could you spoof yourself as another
user well because you have to put your
cell phone number in and it puts that
back actually saying that you're someone
that you're not you've got some kind of
identification of who that person is
tampering with data but there's not much
there but you might want to try to mask
your educational stuff like that
repudiation what if someone signs up for
an account and then says it wasn't me
you've got their phone number you've got
some kind of method of saying this
person actually did go through that did
go through that process we did send an
SMS message to tell them that they'd
signed up information disclosure so what
would happen on here someone's if
people's telephone numbers got out so
think about them kind of tests what
about denial of service but denial of
service most people think about on the
actual server itself but you can also
denial of service applications one of
the good ones myself sign up is what
happens if i write a script that would
automatically just say sign up user I so
I name user AAA so I don't use a AAA
eventually what would happen is you'd
run out a database space and then no
other users could or you go through the
you know the birth register or the
census information you sign up all the
cool names no one wants to use their
your application because I don't really
bring you're looking logging in as Mike
384 972 I'll never remember it so what
on this it does is you have that sign up
on another channel so you have to do
something and then you get a token back
that then allows you to allows you to
complete the signup so that two-factor
helps it stops it actually being able to
try and script that it's pretty
difficult because you have to have that
SMS delivered to up to a place where
another script can pick it up and reuse
it and also you've got a phone number
and unless has someone has unlimited
phone numbers I
leave it what happens is you're only
allowed to sign up like 10 counts on one
phone number so that helps me to get you
there an escalation of privilege may not
be an issue on this because everyone
pretty much has exactly the same
privileges everyone else on sign up your
only signing up for one type of account
here if you're signing up for different
types of accounts are you know a paid
version where you had more space or more
facilities more functionality thufir it
might be a little bit different but this
is like an example of how to walk
through this kind of this kind of thing
when I was talking about information
disclosure it's mostly about not echoing
back too much information and a one of
the things you guys sometimes good at is
error messages not only are they tell
you what's going on in that there's been
a problem they don't give away too much
information and it's nice to have at
least you know some kind of bit of funny
in there shouldn't all be serious of
error 54 or something like that so one
of the things we've said earlier is rule
number one you can't trust the client
let me show you just a quick video
of
this is a great example of not trusting
the client we're a company that sells
software testing books I did this
particular presentation that at the camp
one of the company's main conferences so
i'm gonna do is i'm at the moment i'm
storing that page locally and i'm going
to go in and edit it you see there's a
drop down saying how many of these i
want to buy so rather than buying three
i'm going to say i'm going to x minus
three now there's a restriction in there
and the restrictions from the user
interface normal user would only be able
to choose between 0 and 10 books so I'm
doing is I'm changing that on the client
now reload that page and now instead of
saying three books I'm gonna x minus
three books you see that you know forty
nine ninety five times x minus 3 gives
me minus 149 85 I'm get the credit back
let's see whether this application
actually does this now all the while I'm
doing this in the conference the person
who runs this site is having absolute
kittens in the back of the room ten
Mike's attacking our website lively
showing thousands of people had to have
to rip us off well before I've done this
and one of the things I say to you in
just a bit is a lot of the examples that
I'll show on the web sites are already
fixed already recognizes that don't show
any live exploits on these kind of
things it's always give enough
information so you can track these back
and great there we go anyone worked in
retail before what happens if you put a
negative value on a credit card charge
that gets put back onto the credit card
so I've now got 150 or dollars on my
credit card it even gave me even gave me
tax back but unfortunately unfortunately
I still have to pay for shipping so I
own four bucks out of that so that's not
too bad and we're actually talking to
the guys when I went up when I told him
about this vulnerability they said that
yes that would have happened you know
it's that 4111 mess of credit card
number that does exist and get verified
and okay but it's a credit card number
that never ever gets billed against so I
didn't profit out of it at all but what
would have happened if it would've been
a real credit card and it would have
gone through you want to print it out a
little
so the guys in the warehouse go and pick
the books up and they would have gone to
the shelf and they've gone mike wants a
web testing handbook and he wants minus
three of them that can't be right it's
even got to be a printer malfunction or
a software malfunction or bit of speck
speck of dirt or something on them on
the paper so would it probably have
picked the books up and ship them to me
anyway so not only did I make one
hundred fifty dollars but I got the book
shipped to me as well so you can't trust
the client and that's usually no tools
whatsoever that it's just using the
browser and notepad so you can't trust
any of the stuff that the client does
how common is this but it's pretty
common let's just say that this is a
this is a major Hotel in Las Vegas and
it's a hundred nine dollars a night but
in this case my internet charge for
using the internet in the room was minus
ten dollars 95 so I got a little bit of
a discount the next day actually my
internet cost- $109 so I effectively
stayed there for free and then what
happened is some nice big guys in suits
come and knocked on the door and said
mr. Andrews someone in security would
like to see you and traipse down there
and then they get told yes it's a it's a
security review and it's good that you
found this but it means that one of our
systems is vulnerable and we had and we
have to fix it it's all over the place
it's kind of thing so obviously you guys
want to have a look at some hacks for
today and we're step through some of
them go step through some of the most
common ones are going to step through
session hijacking I'm going to step
through page defacements when I have a
look at some other security assumptions
that people have and have they leaked it
and how they lead to 2 security bugs I'm
not going to try and do is I'm going
trying to illustrate some of these with
previous vulnerabilities at Google as an
example and this isn't a case of trying
to show you guys up or anything like
that it's a case of if you know that
there's cockroaches in your kitchen you
know to go and look at other ones and
also don't be surprised that there are
cockroaches in your kitchen because
there are in so many other companies as
well it's just a case of if you know
what you're looking for and you can see
that you've you've had these kind of
things then you know what to look for
next time you know how to fix them you
know how to have start to address them
so why no live exploits why no live
examples we're two things is as this is
being videoed I don't want it going up
online and someone going ah that's how
we hack google and we've got a video
showing us how to somehow I don't think
Harry would be very happy about that the
other thing is security vulnerabilities
on web apps get fixed very quickly
because you've got this nice instant
service pack phenomenon if there's a if
there's a problem over a security bug or
even a functional bug on a web app as
soon as you find it and report it the
next time you visit the site when it's
been fixed you get the new codes you
can't actually create a snapshot of that
to do the exploit again there's already
fixed one of the great things about
doing stuff on the web you've got a
great advantage with that over
traditional software so no let's start
going through some of these we look at
session hijacking session hijacking
comes about because of one of these
security problems that we've talked
about before because there's no state on
the web so you have to add stay on to
that one of the ways of doing it is to
give you the session IDs when they when
they go and then that session ID tracks
them around and then you can associate
that session ID with who that user is
and what permissions they have and all
them kind of things so you can go
through your your checklist that you can
think what would happen if a user ID
could be guest happens if i can guess a
user's session ID what happens if a user
session ID can be stolen and you think
well what would happen in them
circumstance isn't it and the effect is
pretty much the same someone else can
masquerade as another user that's not
them because they have the same session
ID and the web app doesn't know any
different but they're different ways of
attacking the problem there different
types of vulnerabilities in their
different ways of looking at a man that
had to fix them so guessing session IDs
is a case of entropy its case of what
the sizes of the session ID and how
random it is good session IDs always
have a high end
p their long numbers that change very
frequently and are very very difficult
to guess so let's just quickly show you
an example here I'll have to put them
right now
so here we go this is a this is a neat
little web tool called web scarab and
what it does is it's got this nice
little tab here called session analysis
and what you can do on here is you can
say okay give me a HTTP method and
somewhere to get it from
and the HTTP version
and what you do is you say test and that
does a quick test to see whether oh
actually I need to go to hmm get yeah
that's not going to help is it so no
session IDs there but i think if i go
now let's go straight to the google one
test and this basically shows me that
there's there's probably at least one
session identifier in there by analyzing
and by analyzing the result and this
one's in one of them in one of the
cookies so it's told me okay this one
here now could start to do an analysis
on that but actually there's quite a lot
of the other information in there that's
not part of the session ID so how do I
get them out so I know that this is part
of the session ID so i could start doing
a bit of a reg ex to say okay so start
with some number of characters and then
it goes ID and then when I ID equals and
then what I want to do is I want to pull
out anything that's not a colon so
Colin's the end is the end thing and
there's going to be one or more of them
and I close that and then I don't really
care what comes after that so I regular
expression to try and match what the
session ID value is how many of these do
I want well I want 500 of them and I hit
fetch and it looks like it's not doing
anything in the background and it's
probably not doing anything why is that
that looks good although all else fails
grab the example that you had earlier
that worked
yeah ID was probably in capitals so it
didn't get it so there we go so what
it's doing now is it's doing 500
requests and pulling that ID out and
it's doing a difference based upon once
it had before and I thought about you
but I look at their numbers they look
pretty random to me but it's a lot
easier if you look at the visualization
of what's going on and each dot is one
of the values and you can see that
that's pretty random if it's not random
you can start to see certain things if
you saw a line going up which was what I
was going to show on the on the on the
flower shop one what I'll do is after to
talk i'll show you what what they look
like if you saw a line going up or a
line going straight across is probably
some kind of one that's based on
sequence or probably one that's constant
so the fact they're all over the place
makes it look like it's pretty random
sometimes you might see that they're in
there in bands which means that the
algorithm favors certain values over
others sometimes they might be big
gaping holes in here so you know it
might be like there's a big hole in this
area here and that might be that based
upon a particular time it favors certain
values and things like that so looking
at cookie values over time looking at
any kind of session ID / over time
you
helps just have an idea of what the
entropy is and so ensuring good entropy
and ensuring a good address space for
session IDs helps us protect against
guessing what their values are and
people masquerading as other users by
that so the address space is depend upon
the number of users you had logged into
your system at any particular time so
let's say we've got 128 bit session ID
about 16 ASCII characters and what we
can do is on a machine we can do about
10,000 guesses per second we also have a
hundred thousand users logged in we've
got a really popular application lots of
people are logged into it each time so
that reduces it I only need to get one
by the way how long is it going to take
me anyone care to guess day two days any
longer than two days philos week that's
300 years so having long session IDs and
making sure that it's making sure that
the entropy is good if it's a case of
it's not if the entropy is not good and
it's sequential to take me seconds to
guess what the next one is so actually
getting session IDs if you just take
care of these few little things it's
much easier to either steal a session
identifier or to fix one sometimes it's
easy to fix one so let's have a
walkthrough of how to fix one let's say
we're a cyber cafe I've got some shared
machine that we're going to use we're
just gonna log in and going to check our
email log or actually were going to
check our bank account along comes our
little hacker guy the hacker guy goes to
the bank account the bank account home
page gives him his session cookie so
retreats off and he has a think and says
okay I'll remember that session cookie
what it was some unwitting person comes
along later on sees the machine and goes
to log in go to the bank account what
happens with cookies they're
automatically sent whenever you go to
the next sub when whenever you visit
that same site cookies already set
doesn't have to issue it again so
cookies the same as 1 2 3 4 in visits
though it gets the home page back he
provides his login details he logs in
and he gets his account info back what
does our attacker guy do attack a guy
goes to a completely separate machine
and fixes that cookie information so it
goes to the account page and provides
the the cookie of ID and as far as the
applications aware it finks it's the
same person because that app that that
cookie ID is the same as what the other
person is using and there's no state on
the web doesn't know that two people
were logged in and there are two
different pages so they effectively get
the account value back that's one way of
doing it very easy isn't it so
protecting against the session ID
guessing and protecting against fixing
ensure good set good session ID entropy
and always give people a new session ID
when their role changes whenever that
when that other person logged in if they
were given a new cookie value based upon
when they logged in so they log in they
get a new cookie that tracks them
through that value that the attacker
knows isn't isn't useful anymore because
it was only for a particular role that
doesn't have any permissions what would
have that to happen was the usual word
about to log in and then gone to grab a
coffee or something the attacker quickly
take over generally you know that's an
attack that we can't protect from
technologically more common approaches
to steal session IDs two methods of
doing this stealing mean transit and
stealing them from the browser in
transit HTTP to clear text protocol so
what do you do to protect stuff in
transit stick it over SSL yeah what
happens if you get a box like this that
comes up what does this mean means that
there's something wrong with the ssl
connection in that the certificate was
issued to a different company that where
you're actually that where you're
actually heading I promised my wife I
wouldn't take the mick out of her on
this one but I'm going to break this
right now what do these two buttons mean
to most people
this button means no I can't do what I
was after this button means yes I don't
care just let me get on with my
activities yes let me get on with my
activities could be now suffering from a
man-in-the-middle it could be that
someone in the middle of that
transaction is presenting another
certificate and decrypting the the ssl
traffic between it between the two
you'll see it with tools like Paris and
stuff like that so make note of some of
these warnings stealing through the
browser oh sorry let's go back is that
so sensitive information over HTTP
protect it using using SSL make sure
that the the ssl configuration actually
matches the box is on and also make sure
that it doesn't go and get parameters
any kind of sensitive information like
in a credit card information and get
parameters are also logged on the
browser you can protect cookies in to
protect cookies with session ID in some
ways by having the secure flag set what
the secure flag does is make sure that
cookie will only get transmitted over a
secure connection over SSL most pages
get built with multiple requests not
only the one request for the page but
also requests for the images and stuff
like that and Java and JavaScript now if
the page itself is pulled over HTTP
great the cook is protected but if
images aren't secret so why pull them
over HTTP if that's the case then the
cookie goes with it and the cookies
unprotected for that for that moment for
that particular transaction so this is
mostly configuration issues more common
way of sealing session IDs is taught it
is to use cross-site scripting which I'm
sure you guys are aware of so let's walk
for a quick example we've got this
flower shop we've got somewhere on the
flower shop where we can leave messages
for other people so a guest book someone
saying what a great site what happens is
our little attacker comes along again
and says oh this is a great place i can
leave things for other users to pick up
so where does as he leaves this little
thing here leaves a JavaScript once we
said before you know code and data
intermixed once that gets displayed it's
going to pop up a little message box now
that might be annoying as hell but it's
not a security vulnerability because
it's not attacking any kind of asset
what's one of the assets on here one of
the assets is your session ID so what we
do instead is we put an image in there
now that image is a one by one
transparent pixel users aren't going to
be able to see it I'm going to be able
to notice it at all all that pixel does
when it goes and requests that it also
sends a parameter to the attackers
website with the cookie value this
document or cookie so when our Joe user
comes along to visits the site and go to
the guest book the code automatically
runs he goes there the script starts
executing and the browser goes oh I need
another image where I get this image
from well I get this image from the evil
attackers site but that image tells me I
have to I have to add that session ID
parameter onto it which it does so he's
got that and then the image comes back
on and it looks no different to the user
at all but in the meantime on the evil
hacker com there's logging all of the
session IDs into what's known as a
cookie jar and so at any point the
attacker can come along and pick out
these and they could be scrolling them
in real time and know what kind of
session IDs are being used and start
using them to hijack other people's
information once again how common is
this pretty common how easy is this to
find a fourteen-year-old found it a
couple of months ago the the story was
he was sending JavaScript to his friend
now that's just now he'd learned about
cross-site scripting from some kind of
from some kind of web page or some kind
of book and thought what happens if I
put alert in an email that I'm going to
be sending to one of my friends and this
is in the subject in
ject header bang cross-site scripting
error now rather than just doing the the
rabbinate just doing the rather than
just doing an alert message box we could
have done is he could have stolen his
friends session identifier and reused
that in his own request and all the
sudden he's logged in as that person and
can do all of the things that they
needed to do so how do you protect
against this now generally I can say
this over and over again and I'm are
sometimes we've interviewed to the book
what's the one thing that that I
recommend people to do recommend people
to validate their inputs things like
JavaScript and stuff like that has no
business being in fields that are
displayed to users or stuff like that so
validate the inputs that you're getting
what you're expecting now in some kind
of in a header you're expecting you know
alphabetic characters and numeric
characters maybe some punctuation you're
not expecting script tags also validate
application output just because it's in
there don't trust the data that in the
application is okay you know do this
defense in depth validate on the way in
and validate on the way out the easiest
way of doing this and that would soul
eighty percent of cross-site scripting
problems and stuff like that is really
these tags here this open tagging the
close tag is what separates code from
data markup is still code so you know a
bold tag or something like that but also
JavaScript tags change them the user
probably doesn't mean that they want
this angle bracket they probably mean
they want their bracket displayed so
change them from that to its HTML
equivalent which is ampersand LT or I'm
10 less T so they get shown and you
don't cross that boundary between code
and data don't just think that's that's
the only way of doing it though so
whitelist the kind of inputs that you
want the kind of things that you're
expecting data to see because there are
so many different ways of encoding these
its ways of doing it
there's a lot of them so be aware of
these things also be aware of your
protection of the actual session cookies
themself sharing session cookies between
applications extends the the attack
surface because it might not be a
vulnerability in one application but if
there's a vulnerability in the other
application which shares the same
identifier over over a single sign on
the other app becomes vulnerable at the
same time and you might not have any
control over that at all so you can
restrict the session ID eating cookies
and stuff like that by using the domain
and path attribute say that this cookie
for a session is only valid for this
particular part of its application it
shouldn't be used and shouldn't be even
considered to be part of an ID for
another application and that limits your
attack surface HTTP only in Internet
Explorer provides some kind of limited
amount of benefit um what this tag is is
non-standard tag just like we've you
know secure but secure equals true you
basically just put HTTP only on the end
of a on the end of a tag and what
internet explorer does is it says this
cookie here it's only really for me to
send to the to send to the center the
server local code shouldn't have
anything to do with this a most session
identifies local code don't have to have
anything don't have any knowledge of
session IDs at all it's really just to
help the server keeps keep track of
who's where so if there's a cross-site
scripting vulnerability and your cookie
that's holding that a session ID has
HTTP only on it that JavaScript will
basically return null because it's
marked as that cookie shouldn't have any
kind of access from from local code and
it's one little word and you might as
well put it on there most people use it
most people using using Internet
Explorer will get that benefit straight
away it's in as a bug feature request
for the Mozilla codebase they think it's
a great idea load Microsoft to have any
great ideas but they do it
and it's been down there on about a year
maybe they'll get around to adding it on
it at some point so how do we do page
defacements that's one of the things we
were going to say so we pretty much
covered you know session session
hijacking what about page defacements
well cross-site scripting can be used
just as easily for page defacements as
it can for session hijacking so cookies
are just a small amount of information
that you can get through the document
object model going through javascript
javascript can not only gather stuff but
it can also change elements on a page
that's how you know dynamic menus and
all them kind of things work when we're
talking about assets an asset might be
your ID but your asset is also how your
page looks because if you're a site that
people trusts the information that's on
your site is still an asset people might
may do certain things based upon what
your site says let's have a quick
walkthrough of cross-site scripting page
modification we've got a website it's a
news website people might believe that
you know the stuff they see on the news
is exactly what's going on so they might
do certain actions based upon current
news our attacker comes along and finds
a cross-site scripting vulnerability and
he uploads an image and he puts that on
his evil hacker com site a long time to
show user and the attacker sends him an
email message that might be a friend
that's trying to trick the user into
doing something it might be some kind of
spam message that goes out but the email
says start dumping your Microsoft stock
why so the user goes along and looks at
a page and instead of seeing the page
that's supposed to be there he sees a
page that looks completely different at
that happen well the email said
something like this the email with a
link to the page and it's found a
particular vulnerable vulnerable
parameter and instead of you know
picking up a cookie or something like
that what they've done is they've did
document dot image used off 38 so the 38
image in that page change it to the one
that I've created rather than that one
there
and it happens almost immediately and
they see that information rather than
the one that's there but if you saw that
link would you click on it some people
shaking their head some people were not
too sure what happens if you saw a link
like this so you can appreciate these
things you can hide them it does exactly
the same thing tinyurl was a great thing
for hackers to hide fishing links and
stuff like that pretty common this was
found October 2004-2005 by a guy called
Jim Lahey who's got a great website a
great blog said all sorts of things
found exactly this vulnerability in the
in the search engine homepage and
managed to make it look like you go is
a-goin subscription you're not are you
because I'm going to sign up for this
now if you are a 55 bucks well worth it
and send this out to some of these
friends I dread to think if anyone
actually filled this out and sent him
any sending their credit card details
but it's pretty common so one more for
the road of cross-site scripting and
then we call it a day on call it day on
this and we start with we start wrapping
stuff up cross-site scripting can be
used for actions so you can do things
like cross-site request forgery which
embedding a particular action on to a
page gets you information gets you
information back it's like a user
clicking on something but they didn't do
it was the JavaScript that did it so
this you know this piece of age Xcode
what it would do would be all go there
goes all my gmail contacts put into a
put into maybe an image tag which then
gets sent off to someone else it's all
their emails and stuff like that what
about if I was buying a book weapons if
I was doing something like this lammons
if I had a script that said document
that location equals this
oh yeah that looks like a good book to
buy if I manage to put this into a
review whenever someone went to review
bang all of a sudden they're there at
this page and they wondered how they got
there what if hold on a sec
so I'm just using firefox firefox has
got some pretty cool plugins that I can
that I can use to sort of show these
show what happens on these kind of
things what happens in the if this
review there was a cross-site scripting
vulnerability now I'm going to sort of
just use the Dom inspector just to show
the kind of thing that you could do on
this there we go there's the page what
would happen if instead of instead of
just the document that location eat
cause if I did
well take out that script what would
happen it's basically same document some
form click the submit button oh look
looks in my shopping cart without the
user having any control over what
happened at all and I could probably
change the quantity as well maybe some
way of authors may be boosting their
earth that their cells or anything and I
wouldn't possibly dream of doing
something like that but you can see that
cross-site scripting has so many
different places that it could affect
users and it's hardly getting any
recognition out there SQL injection most
people are starting to understand what
that is and why that's why that's a bad
thing so now everyone's looking at
cross-site scripting and there's even
more vulnerabilities out there of
cross-site scripting then there is that
then there is SQL injection so start
having a look at them kind of things
so other attack vectors that we could
look at so cross-site scripting is a
temporary attack users actually have to
participate in the attack to some to
some degree they have to visit a web
page or they have to click on a link
that has a vulnerable parameter or
something like that and some people say
you know maybe they could be unobservant
if they have a page with a load and load
of load of CGI parameters and some of
them look decidedly dodgy would they
click on it anyway but that's beside the
point cross-site scripting is a
temporary attack it has to have some
kind of user involvement HTTP response
splitting on the other hand is a new
attack it's only really been talked
about recently in the in the first
couple of months we're probably pretty
new in finding out what kind of
vulnerabilities we can use with hate TV
responsibility and what kind of what
kind of attacks we've got but HTTP
responsibly in isn't is an interesting
attack in that it's a one-shot attack
you do it once but it can have multiple
effects it's like one of these gifts
that keep on giving you do it once and
it keeps on giving stuff more and more
and more it can potentially affect more
than one user if one user suffered from
the vulnerability with HTML on splitting
it might be that a user that didn't do
anything wrong at all also suffers from
that vulnerability as well let's do a
quick walkthrough of it let's say we
have a we have a machine which is the
bottom one the black one it's going up
and doing requests to a web server so
quick walk through of the of the HTTP
that goes back to the forwards get
request goes up to the server the server
then replies with a river with a code
says yes it's okay send the stuff back
down including all the HTML one of the
possible ways of doing redirects is to
send a parameter to say okay redirect me
to a particular page the web server
replies with a 302 message and it sets
the location header to the place where
you want to go to what happens with the
browser goes the browser go to our 302
it's moved through this location so the
browser then does another request for
that particular location and the server
sends the right thing back yeah follow
me so far
what happens if we attack this mechanism
weapons if we say instead of it being a
proper page weapons if we start
embedding characters in there that
starts to affect what the response is so
on this we can see that you have to
encode these up by the way you know / r
/ in you have to actually encode them as
as a h2 you have to URL encode them
otherwise they always they get changed
but what happens is this request comes
up the response that comes back from
that is actually two responses the
response the real one from the server
which is the 30 to move temporarily in
the location and then where it says null
is the location that we've asked for and
everything else after that is faked
stuff that we do we're now creating our
own HTTP response that HTTP response is
200 ok is and here's a page for you and
that page might have a payload might
have a cross-site scripting it might be
a completely different looking page and
it was originally and then that little
lips at the bottom would be the
leftovers but the browser ignores it
because of the end HTML tag how do we
use this as an attack what we do is we
do to requests from a machine very
quickly one after the other they have to
use sequential sequential requests so
the first request does this does this
does the exploit and the second request
requests a page normally what's
happening we get back two responses from
the first one and we get back a third
from the other one but that's ignored
because the browser's are you expecting
to requests to come back so the other
one to index 2.html just isn't it just
it just is completely ignored and we get
these two coming back the first one is
this move temporarily which is the null
which is what we've seen the second one
is the payload so what does this mean
this means that the first page the first
request is associated with this
nothing really the index dot HTML is
associated with this now that's bad
because that's not the index dot HTML
page that's the one we faked up and it
means if someone goes to their index dot
HTML page from the browser's cache they
get they get the payload so we can
affect not only the location we can
affect caching and things like that now
I said you know it keeps on giving as
long as you don't refresh the cache you
keep on getting back that you keep on
getting back the malicious page how does
it affect multiple users well most
people go through some kind of web proxy
I'm kind of web cache to speed things up
anything that goes through the page and
anything that comes back get cached by
the web proxy what happens if you have
another machine over here that sends a
request for index dot HTML and index dot
HTML has already been seen by the web
cache what does it give you back gives
you back the payload page so this is
quite new this has only really been
discovered and starting to talk about in
the last couple of months so we'll see
how this how this works if you really
really do want to have a good
understanding of how this works and
including you know all the mechanisms
and stuff this is a great paper this is
great white paper to go and have a to go
and have a look at and it gives you a
lot of in depth of how it works how
common it starting to get common blogger
suffered from this vulnerability pretty
earlier earlier in this earlier this
year so I would imagine that a lot of
sites that do redirects based on 30 tues
also suffer from this vulnerability
because they trust the data that's given
them they trust that someone's going to
give them the right page or what is it
it's exactly the same protection measure
of cross-site scripting validate the
inputs what this is is in the location
where it asks for a page it's that
carriage return line feed breaks the
line the next line down the browser
assumes that it's a HTTP
when it's not it's still a follow on
from the location so validate the input
and validate the application outputs and
you have to be extremely cautious of all
the data that you put in HTTP headers
because if they use a controlled they
can affect everything they can affect
things from location they can affects
things to cash in they can affect
cookies and all that kind of stuff to
start wrapping up we'll have a look at a
couple of security assumptions and I
open it for questions is that we've got
the web's got no standards at all
everyone says that you know there's rfcs
on HTTP and all the way that things work
but there's not one of the examples was
everyone can play nice everyone whenever
they go to a page that doesn't exist it
will give them a 404 page but it doesn't
so the site at the siteminder or the
analytics stuff at that suffered from a
vulnerability where it asked for someone
to put up to say here's a page exists on
my site and I'll use that as your as
proof that you own that web server
because that that page must only exist
because you can put them there however
not your fault but other people's faults
if that wasn't on that if that page
didn't exist certain sites so for AOL
for example didn't do things properly
they didn't give back a 404 they go back
a 200 okay page but the page that said I
couldn't find that which breaks the
standard but it means that I could
register myself as a user of the AOL
site statistics and not much information
in there but if I was a competitor I can
see what kind of things people search
you want to get to that page other
assumptions trust the data that's given
to you Google News does this grabs data
from PR news feeds and so many people
have you know google news alerts of
anything that has has the title win now
someone made a press release and said
that Google has a 15 year old and all of
a sudden it's on digs homepage because
they trusted the data that comes through
there they should only be trusted from
no
an authoritative sources don't feel bad
about this because it gets a lot worse
North Carolina news 13 had I had a web
page that had closing Pickers for
schools and businesses and things like
that what happened was they put up a
page that said a schools closed today
because of a boiler malfunction and it
will be closed or such-and-such a
business won't open until ten fifteen or
1030 because of because of weather or
something like that so the idea was
there was a particular flow used to
submit information used to get human
approval for that information used to
allow the companies to do any kind of
changes that update the time or
something like that and then it was
published out to the TV a little hackers
come along and just go straight to the
change without changes which what does
that do propagates it straight out to
the TV now a bunch of students from
North Carolina University managed to
figure this out and this link here is
the chat page of them absolutely
laughing away as they put things up on
the screen anyone will have a look at
what they put up yeah some people do
here's a good one through you hackers
out there and of course one of my
favorites so they took it down after
that and thought it was mostly unmute
mostly an amusing so we can filter out
for bad input I'm going to skip through
these and going to look at why all the
problems so one of the problems web
servers are a great target web service
web server is a great target for all the
things we've talked out before and also
as you've seen these attacks are not
rocket science the dead easy to Dell
easy to do most the entry for skilled
people were low and the rush to innovate
is out there get these applications out
before someone else comes out it's that
the gold rush i'm going to stake my
claim to this part of the river because
if i'm not there someone else will and
it doesn't matter whether the codes bad
or not the thing is is some of these
security vulnerabilities can kill a
company we've had loads and loads of
companies that because a particular
security and because of security
breaches and stuff at have suffered from
not only PR problem but also financial
problems companies be shut down for this
example guess jeans got got find a few
years ago for having SQL injection on
there and someone found it and the FTC
find them because they were releasing
you know customers information also fun
enough is a drop in share price when I
professors from Maryland University
tracked share price against when
vulnerabilities released in the company
and he found that on certain
vulnerabilities a share price dropped by
five percent which can affect quite a
lot main reason whether there is
education and nice picture of one of my
colleagues is people aren't told about
security they talk about algorithms they
talk about in a bubble saw and they talk
about you know quick salt and they
talked they told about linked lists and
doubly-linked lists and all them kind of
good things and they're not told about
validating for input on why it's about
oh and why not validating for him for it
is a bad idea and unless you start to
push it back to their
people are going to come out and they're
going to steal start creating the same
problems so if we want to go back and
start fixing it somewhere we start
fixing it education by telling people
what they are we start fixing it by
companies being responsible when doing
the right thing training the developers
up making sure that the make each other
codes the codes clean by doing them kind
of things so next wave of things coming
out how we doing for time by the way am
i over running or is it ok so next way
with things are going to come along is
in a buffer overflows and do s we look
at web services they're going to be done
in things like recursive payloads and
stuff like that it's all going to come
back again SQL injection web service is
going to be XPath injection going to
start coming back again cross-site
scripting same vulnerability and web
service external entity attacks
including other pages from somewhere
else parameter tampering is going to
stay parameter tampering there's going
to be nothing different there it's good
to be a different arena xml actually
helps us with helps us helps attackers
with with with payload because it's a
standard format they don't have to they
don't have to worry about doing it
specifically for an application it's a
standard so just because we start to
solve all these things of cross-site
scripting doesn't mean they're all going
to go away the next technology that's
going to come along it's going to have
exactly the same thing so even though
I've shown you a couple of examples here
and I've shown you the vulnerabilities
and how to look for them be aware of how
these kind of attacks affect the next
wave of software that you're going to
develop Ajax it's coming along and it's
being more and more used which means
more and more code push to the client
which means less control and less
validation at the server so we've seen
what happens when you trust the client
and just because it's Ajax rather than
forms or instead of JavaScript doesn't
mean that we should trust it anymore
web-based worms web-based worms have
already been done to some degree they've
had limited limited impact and you know
you guys have brought up things of pages
it says you know we've noticed a lot of
requests for a particular thing so
blocking it from there we've got stuff
like
web-based keyloggers and back doors like
you know like back orifice but for the
web is the next holy grail for web
software and as web software becomes the
next platform for developing
applications and things like that that's
what the attackers are trying to look at
that's what the heck is a gunning for
for the next big goal bidirectional
communication to arbitrary domains with
no refresh and preserve between sessions
in some cases they're getting close some
of it is already done excess XSS proxy
is a bunch of scripts it's already
written for cross-site scripting in a
frame that you can actually send
commands to another machine once it's
activated doing it over sessions you
know HTTP recruiter HTTP response
splitting managers preserve that between
sessions in some way so we're back worms
and viruses might be the next five
applications and operating systems have
suffered from it there's no reason why
we can't expect the same in future
there's a guy at spi dynamics called
Billy Hoffman done a great paper on this
a great presentation one of the reasons
I wanted to go black out is he saying
that he possibly going to talk about it
more at blackhat 2000-2006 so we'll see
there so lessons we've learned so far is
it's not rocket science as you say you
don't need any hardcore hacking skills
to be able to do this kind of stuff it's
mostly common knowledge once you know
the knowledge that's out there there's
so many more attacks I wish I had time
to talk all over them but as probably
already have well over to step my time
schedule but hopefully you've all got
the book and hopefully we can hang
around later and talk about these kind
of things so if I have to give you two
things to walk away from validate input
and validate output if you can solve
them eighteen ninety percent of the
vulnerabilities are out there in the web
just go away so watch for new attack
vectors and institute some kind of
security attitude you'll never be able
to design perfect web software any kind
of software there'll always be
vulnerabilities in it although all the
time you never be able to find every
single vulnerability but by doing things
of awareness of a security frame that
you walk through and check stuff off be
able to think about new attacks and
stuff like that to actually think about
it in that
why helps you and also have some kind of
security champion in your team have
someone that is has in their spare time
or one of their responsibilities to keep
up-to-date with security stuff that if
someone goes you know this this little
thing here looks a bit fishy but I don't
know whether it's really an exploit or
how to or vulnerability or how to how to
impact it that person's there that can
go yeah is now it isn't things like that</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>