<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GTAC 2013: Karma - Test Runner for JavaScript | Coder Coacher - Coaching Coders</title><meta content="GTAC 2013: Karma - Test Runner for JavaScript - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>GTAC 2013: Karma - Test Runner for JavaScript</b></h2><h5 class="post__date">2013-04-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/YG5DEzaQBIc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so next
is with the Jinnah he likes a funky jazz
and he has a very action-packed talk
he's probably gonna run right to the
middle or to the end so he probably
won't have questions and we'll just go
right on into the end of the next talk
right after he's done so here you go
great thank you so this conference is
about automation and testing right so
assume you guys are one of those crazy
people who try to automate everything
right even if it takes more time than
doing manually we write a script for it
because that's what we believe in right
and that's cool I mean angular team we
are the same like we basically try to
automate everything so from simple
things like automatic deployment to the
website to things like you know we have
CI server and whenever I push some code
to github it automatically built angular
runs all the tests on different browsers
you know and screams with me if it fails
or every release has a change log you
know that's basically it's basically a
list of changes like list of new
features back fixes breaking changes and
you know what we generate even that like
we have we have a convention for get
messages and then there's a script that
basically generates the change log based
on the get history or my favorite
example is angular Doc's so let me
actually let me actually show you the
docs it's if you go to doctors out
angularjs.org there is angular
documentation and this is for instance
api docs for ng-click which is directive
in angular and down here here is an
example here is a source code for that
example and then there's a live preview
like demo where you can actually play
with it and see how it works right cool
I mean of course the whole documentation
is generated automatically but the thing
I want to show you is the second tab
which says into and test and that is
there's basically example for you how
you could possibly test such a code
right like end-to-end test for that but
what do we do with that we extract all
these tasks and then we around them do
as a part of the build let me show you
that so it looks like something like
this and you can see it's basically
going through the whole documentation
and checking whether all these example
still works and this is really awesome
just before we did this it would be like
all the time it would happen like
someone would email me like hey man your
Docs
example for HTTP doesn't work and like
oh cool I even didn't know that that was
an example for that you know but now
with this like you don't have to think
about it like if if you break it will
scream at you
so we basically try to automate
everything let me let me kill this guy
and we do testing a lot we rely on
testing a lot and therefore we want to
make sure that our testing story is
really efficient and that's pretty much
why we did karma which is I would say
test runner that fits our needs because
we did we made it for ourselves and
that's what I want to show you now I
wanna show you this tester that we used
to do this angular and pretty much do
this any JavaScript so let's do demo so
karma is NPM package so assuming you
have no js' you can install it through
npm install karma and then first thing
you need in order to start you need a
configuration file which is basically
for karma to know about your project
basically where the files of the project
what browsers you want to use which
testing framework using and stuff like
that to make it simple
you can generate you can generate this
config file by karma in it and it would
ask you a couple of questions like what
testing framework you want using you
know which browsers and stuff like that
and it will generate the config file for
you or if you are using ground
do you know guys ground Jas it's really
awesome task runner for javascript so if
you are using ground you can there's a
ground plugin for karma that allows you
to configure karma through ground and
you don't need this configuration file
at all
alright for this demo I'm gonna be I'm
gonna be using angular code base which
already has this config file so we can
start it I can do karma start and what's
happening in the background it starts a
browser that I I told in the config file
that I want to be using and you know we
can forget about the browser for now but
the important thing is that there is a
real browser in the background that
karma will use to actually execute the
task and that's um that's something I
want to actually talk about because you
know you can execute you can test your
script even without browsers you could
do like onload ejs and rhino but for us
it was really crucial to use real
browsers because if you know angular
there's tons of like components and
custom directives and stuff and that
stones of dual manipulation and we need
to do my API we need to test these
things so we need real browser for that
plus you know there are so many
inconsistencies between different
browsers and honestly javascript itself
as a language it's not that bad it's
pretty consistent but the dome api
that's what's you know most of the
issues are and so again for us we need
real browsers
plus third thing there is a good
advantage once you're using real
browsers it basically communicate
communicates through HTTP and WebSocket
so it means you can use any browser like
you can you can test your phone your
tablet TV PlayStation whatever you were
where you want
okay let's let's go to source code and
another thing that hat that's happening
in the background is that karma is now
watching all the source files of my
project and whenever I hear is like Cash
factory some service in angular it's not
that important what it is but I'm gonna
save the file just you know just press
command S and you can see that comma
immediately see that and it starts
executing all the tests and you can see
it executed over 1,800 of unit tests in
like three seconds on the real browser
right and I mean 30 seconds is not a bad
but if you have huge project it can can
be more and our goal is to get this
instant feedback so that I can run these
tests all the time because what I really
do during development is like I want to
run these tests on every safe and that's
why we have this feature we call it D
describe and I it you know on the right
side that's my test I'm not sure if you
recognize the syntax it's a Jasmin
testing framework so I should mention
that karma is agnostic of testing
framework you can use it with any
testing framework you like pretty much
there is adapter fork unit mocha Jasmine
and node unit and stuff we on angular
using Jasmine that's why this example is
in Jasmine but you can use anything else
and this scribe in Jasmine basically
means like defining a test suite you
know list of suits and it means defining
a single test and what I can do I can
focus these things so I can do I can put
D describe and now when I say if you can
see it immediately execute just this
suit so it's even faster right like now
it executed only 24 of these 18 hundred
unit tats and it was like I don't know
few milliseconds and so the goal is and
the the thing why this is important is
that it gives you like a new workflow
it's basically like using tests as a
development workflow where you basically
you can stay you can stay in your text
editor and you don't have to go you
don't have to move back and forward
building
your taxes or do you see how things
works because what I can do let's say in
this test I can do I don't know
console.log cash 1 or whatever it is
maybe give me size right ok
it gives me error undefined whatever ok
so there is no size so I guess there's
any 4 right and the thing is that I just
saved the file and I immediately see in
the console the result from the real
browser so I don't have to go to the
browser to do these things you know and
this is this is really important for the
workflow because you can stay in the
browser sorry in the text editor one
more thing that I want to mention is
that there is no there's no support from
text editor like I'm using sublime you
can use Emacs vain whatever you want
because the only thing that the text
editor in this workflow does is saving
files and I got one more thing that I
want to show you and that's debugging
here's what I can do I can inside this
code if I want to actually use the real
debugger right I can do this and guess
what I can go to the browser that I have
somewhere in background and I have
debugger you know I can watch water
walls I can see calls tag I can step
into functions and this is something
this is not feature of karma that's just
the browser had like most of the modern
browsers they have debuggers so it only
allows you to use that and again you
don't need any support from the text
editor to do that if you happen to using
something like webstorm or some better
ideas you can even configure it to do
this debugging directly from webstorm so
you can put breakpoints and stuff you
know and you even don't have to leave
your IDE for debugging
all right I think that's you know there
there is tons of other features like it
can do code coverage it can pre persist
files so you can develop like if you're
getting use CoffeeScript and it will
compile coffee scrape on the fly there's
a dart plugin for you know testing Dart
all kinds of other plugins but I think
the the most important feature is the
workflow that you can run tests and
instantly see and instantly get the
feedback that that's the main thing so
that's what I wanted to show you if you
like it you can go to github check it
out it's open source so sans pull
request and as I said I'm we're probably
running time pretty soon so I'm not sure
if we're gonna have questions but I'm
gonna be here today and whole tomorrow
so find me and more than happy to talk
to you guys about pretty much anything
but you were to actually I think we may
have time for oh cool one question I
have to say I was really happy that you
only typed karma start uh-huh and you
never typed karma and as a little
worried if that was gonna happen because
I do
we'll see okay with that we could take a
live question if someone has a live
question or we can go to the dory or we
can move ahead okay I got a question
here the number one question you
probably saw this actually in the UI -
um it says why was karma renamed from
testacular okay I didn't expect that
question at all I don't think I want to
answer this question the stage but but
the good thing is that now typing karma
is way faster than testacular because
especially if you're using regular
layout keyboard layout it's like really
it's really easy to type great all right
thank you
actually very much can i I think I would
like to I'd like to close
with a quick story I think we have two
minutes so I can do that 30 seconds 30
seconds I will I will do it quickly okay
just I'm I'm really happy about that
thing we there is a product there's a
project called YouTube on TV it's
basically if you have PlayStation 3
there's a YouTube app and it's written
in angular and few months ago we were
helping the team to debug some
performance issues and I noticed that
they had like 90 or 100 unit tests I was
like wow that's not many and so I asked
them like guys why don't you write more
to test and when they showed me like how
painful it was to like add a new test to
then in their in their shooting and how
slow it was to run these tests I was
like kind of like ok I understand that
and so the next week I helped them to
set up their environment with Karma and
we actually set it up to even the
rounded on the real PlayStation and it
was really cool because in like a few
days maybe a week I got an email from
Tyler or one guy from the team and he
was like boy Tom this is awesome
like it completely changed our life we
test drive everything now and believe me
or not but they after the week or
something they had over 400 unit tests
so it basically took them about a year
to write 100 tests and then they rode
another 300 tests in just a few days you
know and the point is that you know you
should spend time figuring out your
workflow in your environment you know
find the right tools for you it doesn't
have to be karma like I don't care use
whatever works for you guys but it's so
much worth it to spend the time because
once you do it well it will save you
tons of time cool thank you thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>