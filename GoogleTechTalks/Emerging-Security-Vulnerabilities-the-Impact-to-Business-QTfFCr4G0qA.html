<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Emerging Security Vulnerabilities &amp; the Impact to Business | Coder Coacher - Coaching Coders</title><meta content="Emerging Security Vulnerabilities &amp; the Impact to Business - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Emerging Security Vulnerabilities &amp; the Impact to Business</b></h2><h5 class="post__date">2008-01-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/QTfFCr4G0qA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so I'm gonna talk about what every
programmer needs to know about security
and where to learn it more specifically
I'm gonna be talking about what every
web programmer needs to know and even
though the talk is titled every
programmer it's really relevant for
software architects developers engineers
however you want to call it i I've given
other renditions of this talk in which
the talk has taken on a slightly
different title in some cases it's taken
on the title emerging security
vulnerabilities and and their impact to
business and so regardless of which
title you're more interested in you
should get you should get something out
of the talk all the slides and a lot of
the information I'm going to talk about
is also available on my website at Neal
Dewani comm and I'll be giving you an
Earl for another website in which you
can get more more of the information
let's see so let me go ahead and get
started one of the reasons that I'm very
passionate about this space is because I
look at many of the press releases that
one sees and given the string of
security vulnerabilities that we've seen
over the past couple years sometimes I
look at it and I wonder whether or not
the sky is falling to give you a couple
data points there's a company called TJX
TJX is a holding company for many retail
department stores like TJ Maxx and
Marshalls and they got attacked in a
pretty major way what the cyber
criminals were doing in their case was
they were parking cars outside of the
retail branches and they would capture
traffic that was going by on the retail
branches Wi-Fi network the retail branch
was using Wi-Fi to transmit credit card
numbers from the point-of-sale station
to their back-end servers and it was
attempting to protect this communication
using WEP the wired equivalency protocol
that was part of one of the original 802
11 standards of course the security
community has known that this protocol
has been broken since 2001 2002 because
of the fact that it uses the rc4 stream
cipher in a very bad way it doesn't
correctly seed the
a four-state table and as a result if
attackers are able to simply gather
enough packets they're able to kind of
work backwards and figure out what the
what the state table is and so once
they've done that they can pretty much
see all the product that goes by so you
know there's a lot of details that have
been coming out about this attack and in
spurts because there's been a
class-action lawsuit going on against
the company basically because over the
time period of the attack the bad guys
were able to steal ninety five million
credit card numbers from transactions
dating all the way back to 2002 and
that's a very significant number of
credit card numbers in fact this has
probably been the worst cyber attack of
all time given some some measures
another another rather spectacular data
point occurred back in June 2005 when
card systems a credit card payment
processor was was attacked
they basically you know when you swipe
your credit card there's a number of
gateways through which or a credit card
number goes through to get authenticated
and card systems was one of those
processing companies that was along that
chain they had a database of about 43
million credit card numbers and their
database stored these credit card
numbers unencrypted and there there
really wasn't you know while that might
have been problematic in it in itself
things became really bad when somebody
at the company decided to connect a
website to that database the website had
a bunch of forms on it which allowed
users to see some of this information
you know register of course the
attackers went to these web pages and
they didn't enter their email address or
other subjugated into the forums they
entered database commands and they
tickled the database just right so that
their commands got executed what they
did is they dropped a script on the card
systems back-end database that that
basically ran every day and would email
them a couple thousand credit card
numbers this went on for about six
months before the company noticed and
once they did notice a lot of bad things
happened to them
basically Visa and MasterCard cancelled
their contracts with their company the
revenues dropped nearly to zero the
company went out of business their
assets were acquired by cyber source you
know in the attack there were about two
hundred and sixty three thousand credit
card numbers that were stolen but you
know all 43 million of the credit card
numbers in their database were exposed
to the attack and customers needed to be
notified let's see this attack was due
to sequel injection I'll talk more about
sequel injection later on but you know
you might think oh you know 2005 was a
long time ago we must have learned all
our lessons since then unfortunately if
you un tur SQL injection into a site
like News google.com you'll see articles
and articles of recent vulnerabilities
perhaps not as big you know not as much
not as many compromised records but but
still quite significant in fact there's
a website at privacy rights org which
has kept a very good chronology of data
breaches that have occurred over the
past three years
and when I gave an earlier version of
this talk you know three or four months
ago that web page had reported that
there were about 153 million
compromised user records over the past
couple years and I just checked earlier
today and there were two hundred and
fifteen million compromised records if
you if you look back over their records
and and just look at the year 2006 there
were over 300 security reported security
incidents and that was just in one year
so pretty much every business day there
was some major security vulnerability so
given all of this I hope that you can
see why I sometimes feel that the sky is
falling so let me tell you a little bit
of what I'm gonna cover in this talk I'm
going to talk about sequel injection the
type of threat that was behind the card
systems case I'll also talk about
cross-site request forgery
a very significant web-based
vulnerability that you know many sites
need to defend against since I'm going
to be telling you about real attack
methods of course you should not try
these attacks on real
and sites you should try them on your
tests and your development versions
after talking about sequel injection and
cross-site request forgery I'll go on to
talk about some trends in security
vulnerabilities and then I'll tell you
where I can learn more I'll point you to
some courses books and websites and by
the way for those of you that that are
here we have copies of one of the books
book that I recently published together
with Christoph Cornyn and in either case
fun this past February we have them in
the back for you and we can we can
provide those to you for those of you
that are the virtual world I'll tell you
where you can get it so let me start off
by talking about sequel injection so you
can imagine a typical two-tier web
architecture in which you have a web
browser that connects to a web server
the the web server might ask the user
for a username and password the web
server might then want to make a query
to a database to find out if that indeed
is an authentic username and password
and might do so using a query like this
select password from the users table
where the username matches the username
that was provided by the user where the
dollar sign username is simply a a
placeholder for a variable and then
depending upon the response that the
database gives the web server might be
able to check or will be able to check
whether or not the credentials are
authentic and decide what to do with the
user you know for those of you that have
some security background you know that
well we probably don't want to get the
password in the clear from the database
we probably want to get a hashed and
salted version of it you know so of
course this is just a strawman example
now if this is the way that the
application works then you can imagine
that the attacker might attack the
application as follows instead of
entering a quote unquote regular
username the attacker will enter the
following for the username quote
semicolon drop table users semicolon - -
and enter something for the password
doesn't really matter what of course
what happens when this username gets
plugged into the previous statement that
we
we had on the slide we see that the
quote will terminate this string literal
the semicolon will terminate the first
sequel statement the drop table users
semicolon makes up the second sequel
statement the - - comments out the quote
that the application had put in and if
this actually gets executed it'll wipe
out the users table resulting in a
denial of service attack and legitimate
users will then no longer be able to log
into the database so that that's a you
know pretty basic straightforward sequel
injection attack these attacks are so
prevalent and are fairly well known that
you know this colleague of mine
forwarded me this cute cartoon at this
Earl and it kind of makes fun of a
situation between a let's see a school
administrator and the mother of a
interesting student the the the school
calls and says to the mom you know this
is your son school we're having some
computer trouble mom says oh dear could
we did he break something in a way you
know the question that gets asked is did
you really name your son Robert quote
paren semicolon drop table students
somebody : - - oh yes
little Bobby tables we call him and the
school admits that well they've lost
this year student records gee I wonder
why so the mom's advice is you better
learn how to how to sanitize your
database inputs now you know when
looking at this kind of problem you
might think oh you know I we can solve
this problem easily you know we should
we should just you know look for quotes
and semicolons and such characters and
filter them out right and let me let me
provide an example in which a sequel
injection attack would still be very
easily possible even if that kind of
filtering was going on so let's take
another example application let's say we
have an application which allows you to
order pizzas online and the application
might have some functionality which
allows you to look at your pizza order
history right so
might be some web form in which you can
choose the month and then you hit the
View button and then you'd like to see
all the pizzas that you ordered in that
month
well you might imagine that the HTML for
you know for this application might look
as follows there's a post form it has a
number of options that one can select
from in this drop-down menu where once
the user selects something it fills in a
value for the month the month is a
number from 1 through 12 and then
there's a submit button and the web
browser would make an HTTP POST request
passing the month provided by the user
now you might imagine that the sequel
query behind that webform to show the
user the results look something like
this
it might look like select pizza toppings
quantity ordered a from the orders table
you know where the user ID happens to be
the user that's logged in and the order
month equals 10 where the 10 came from
one of the values in the HTML form now
of course what the attacker can do is
you know modify the form you know save
the HTML modify the HTML such that the
value for one of the months is 0 or 1
equals 1 and then the attacker can
reload the form and hit submit or an
attacker can use tools like W get or
curl to issue a similar HTTP request and
you can imagine that what happens is
when this 0 or 1 equals 1 gets
substituted into the query we end up
with a with a bad situation
the 0 since there doesn't correspond to
a real month will end up bringing back
no results but the or 1 equals 1 will
match basically you know all the all the
rows in the table so the one thing to
notice here is that because n takes
precedence over or when the order month
equals 0 predicate is combined together
with the end with the user ID this
entire Clause is false and or 1 equals 1
now applies to the entire table and is
true so what will get returned is all of
the pizzas that have been ordered by
every user
on the site and you might get a form
like this so you can see you know all
the pizzas all the toppings quantities
and order days now while this might not
be so bad for a site from which to order
pizzas imagine if this was a medical
records database now the attacker gets
to see all of the medical records from
all of the users which can be a pretty
bad deal so so sequel injection attacks
can be can be quite damaging in fact
they can get a lot worse even if our
pizza delivery site you can imagine that
the you that the attacker might want to
get a hold of all the credit card
numbers that were used to order these
pizzas and so the attacker could input 0
and 1 equals 0 Union select cardholder
number expiration month expiration year
from credit cards what happens when this
is provided as the input and you know
filled into the previous query well
the 0 and 1 equals 0 will basically well
it'll result in no results but what
happens in the second part of the
statement is there's a union and it
poses a second query merges it to the
first set of results which is in fact
null and takes the cardholder names the
credit card numbers the expiration
months and the expiration years and
merges it into the the table one thing
to note is that the datatypes selected
here exactly correspond to the data
types in the previous query so the
database will go ahead and happily
execute it because there's no syntactic
errors and so if we look at the results
that the attacker will get it might look
something like the following
there would be a you know table which is
supposed to show pizza order histories
but what well it'll end up in showing is
the cardholder names the credit card
numbers the the expiration dates and the
expiration years and so this is how
these types of attacks occur where the
bad guy is able to get everybody's
credit card numbers although a little
bit indirectly but still pretty easily
possible
I mentioned earlier that all these
queries did not have any quotes or
semicolons or hyphens or any funny
characters yet you know yeah and yet so
they were able to be used for attacks so
you know even if you did try to filter
out these kinds of characters it
wouldn't have helped your application so
basically what this tells us is that
blacklisting as an approach does not
work right instead you should use
whitelisting instead of blacklisting
instead of trying to blacklist and
filter out certain characters what you
should do is specify the set of inputs
that are valid so you know why doesn't
blacklisting work well it doesn't
prevent many of the attacks that we've
seen you could fill you could forget to
filter out some of the characters you
know each database has its own set of
meta characters and it could end also
end up providing a preventing some valid
input you know why shouldn't we allow
our user to have the username Oh quote
Brian right we want users to have a very
personal connection to to our website
and they we want them to trust us so
there isn't any reason that we shouldn't
prevent this kind of input on the other
hand if you use a whitelisting based
approach where what you do is specify a
set of regular expressions that
correspond to valid input you might be
able to do so as follows so if I'm
expecting alphanumeric data then I could
specify the following regular expression
if I'm expecting say an order month I
might use this next regular expression
here where the first character has to be
a 0 or 1 and then the rest can be a 0
through 9 you know I I wouldn't take
this too literally the idea that we
should use regular expressions to
specify valid sets of input I'm sure we
could spend you know we could do a much
better job of writing regular
expressions the other thing that I'd
encourage you do do so is that when
you're writing these kinds of regular
expressions and building your
application trade them with your
colleagues and or trade them with the
security professional or a vendor that
you're working with because writing
these kinds of regular expressions is
really hard and so you should try to
break each other's regular expressions
and break each other's waitlisting
another place where you can use these
regular expressions in addition
your code is if you're running a web
application firewall let's say you're
using Apaches mod security you can
specify mod security rules that
correspond to these regular expressions
such that even if the application didn't
you know do the white listing you can
have your web app firewall do it so
white listing is extremely important the
other thing that you need to do to
prevent sequel injection attacks is use
escaping properly right so if you did
want to allow this user name like o
quote Brian or you want to allow a user
name like O'Connor it's important to
take advantage of the escaping functions
that your database provides you with so
you know my sequel as well as other
databases will will provide functions
which will take the take an expression
with meta characters in it and convert
it to an escaped version in this
particular case the single quote is
changed into a double quote and what
this means to the database o quote quote
Connor is please interpret this double
quote as a single quote piece of data do
not interpret it as something that is
you know changes from data to control so
it's important to use escaping properly
of course escaping only really works for
string inputs in the case where you're
accepting integers and such things you
should you should do the following you
should take advantage of you know the
third mechanism here called prepared
statements where what you can do is
specify a query template so you could
say I'd like to have a query that has
this form select pizza toppings etc from
the orders table where the user ID
equals question mark the question mark
here is a bind variable and the order
month is also a question mark it's also
a bind variable a bind variable is
simply a placeholder for data
so once you've specified the query
template you can then say okay I'd like
to set the first placeholder to the
current user ID and I would like to set
the second place holder to the order
month some things to note here
these are typed first of all so if the
type doesn't match the Davis will
complain and secondly if regardless of
what is specified here it will always be
interpreted as data if you put quotes in
there or other meta characters they will
not be interpreted as instructions to
change to control and change the
structure of your sequel query so so you
know taking advantage of this pattern is
good in fact you could imagine in your
application what you might do is you
might have a file where you specify all
of your parade templates and you're only
allowed to construct you know
application code that takes advantage of
the of the query templates so that you
shouldn't need to see any sequel in your
code and that might be a good design
pattern to take advantage of to mitigate
sequel injection attacks so I've talked
a bit about sequel injection but there's
there's there's more to learn as well
there's more approaches that you can
take advantage of so for instance you
should you know limit privileges
wherever you can for instance you should
not give you a web application server
the root password to your database you
should not have the web server logged in
as an administrative account you know
instead you know and the reason for that
is if the if the bad guy is able to do a
sequel injection attack you don't want
the bad guy to be logged in with
administrator access instead what you
can do is you know create a separate
account just for you know the functions
that that particular web server needs to
need to do so for instance if you only
need to provide read-only access then
create a database account for which that
user only has been granted read-only
access so limiting privileges is a good
thing to do as a part of a defense
in-depth approach to mitigating sequel
injection another thing that you should
do is make sure that you harden your
database server and you harden your
operating system on which your
application is running this is extremely
important simply because for instance
some databases like Microsoft sequel
server when they're deployed they're
deployed with all kinds of interesting
functionality turned on so when
Microsoft sequel server is shipped for
instance you can from an SQL prompt
issue a command which will invoke a
command shell give you direct access to
the operating system
you can from SQL invoke commands which
will go ahead and create outbound
network connections you know and that
can be used also to port scan your
internal network so make sure that
before you deploy your production
application all of these things are are
shut off there's no reason to ship a
production application with all of this
interesting functionality turned on you
might ask what else do I need to learn
about sequel injection well there's
things like second-order sequel
injection where in the attacks that I've
shown the bad guy tries to send in
malicious input that gets executed right
at the time that it's entered a
second-order sequel injection attack is
one in which the bad guy sends in some
data that might actually get properly
escaped and such and gets stored into
the database and then at a later point
the attacker
you know tickles the application to use
that data in some other sequel command
which may not validate the input again
and get it to actually execute I've a
there's a nice example of this in the
sequel injection chapter of my book you
can you can take a look at that if you
want to learn more about second-order
sequel injection there's also a blind
sequel injection in order to do the
attacks that I've talked about you might
make the observation that the attacker
needs to know something about the
database schema and blind sequel
injection is an is a technique that you
can use to learn that attackers can use
to learn the schema of the database
basically it takes advantage of the fact
that databases store metadata about the
tables and other tables and you can ask
the database queries like you know are
there any tables in the database that
that you know start with the letters m
to Z and the database will respond yes
or no and then depending upon the
response let's say it responded yes I
can basically use binary search to
locate the first character of the table
name of the database and then basically
do that successively for each character
and I can basically get table names and
other such data that I need to mount
attack so defending against blind SQL
injection is is also an important thing
to learn about so I've talked a bit
about sequel injection I I've mentioned
that sequel injection can
due to unvalidated input there's other
types of attacks that can occur due to
unvalidated input for instance
cross-site scripting is another very
popular attack that can be done against
web applications which relies on
unvalidated input but i'm not going to
talk more about unvalidated input types
of errors all I'll leave it to you to go
learn more
I'll talk instead about a you know a
vulnerability called cross-site request
forgery that's due to design errors and
we've started seeing an increase in in
these types of attacks and they are you
know they're they're very damaging
because in some cases it might not even
be apparent that there's an attack going
on that said there are many other types
of vulnerabilities both in web
applications and other types of
applications that can occur due to you
know failure for checking for boundary
conditions appropriately failure to do
exception handling properly
failure to do Access validation checks
etc so you know but I'll just give you a
sample of cross-site request forgery
attacks so let me let me ask are there
any question about sequel injection
before I go ahead and proceed No okay
let me talk about cross-site request
forgery so let's assume we have a
scenario in which we have an application
hosted at a website called Bank comm I
don't own bank comm I don't know what's
running at Bank comm I'm just using it
as an example but let's say that our
user Alice uses bank comm and Alice logs
into Bank comm with a username and
password once Alice logs in with the
username and password the website after
Alice is authenticated we'll send Alice
a cookie and then when Alice's browser
makes subsequent HTTP requests to bank
comm Alice I'll you know the cookie will
get looked at by the website and if the
cookie is indeed authentic then the
website knows that it's Alice and allows
us to do what she needs to and as you
might know there's many applications
that have this architecture for their
authentication let's also assume that
Alice
also happens to while she's logged into
bank.com
she gets lured her her browser gets
lured to load some web content from a
site called evil.org say in a second
browser window and let's keep that
scenario in mind and let's see what can
happen so let's say that Alice's logged
into bank comm she her browser places a
request for a login dot HTML page this
login dot HTML page has a form on it
which accepts a a username and password
she goes ahead and enters a username and
password that username and password is
passed to bank comm as part of invoking
a you know an authentication script
write the forms action will be off and
Bank comms authentication script will
run it'll look at the username and
password it'll check it in its database
and let's say Bank comm determines hey
you know Alice is indeed an authentic
user what bank comm does is it sends
back a cookie callouses browser saying
that ok you're logged in and your
session ID happens to be this for 0a for
c 0 for D by the way this is way too
short to be a session identifier you
should use a much longer one but let's
say that this cookie gets sent back to
to Alice Alice then might get back you
know a web pages part of this response
that allows her to do all kinds of
things at her bank's website so she
might say decide to view her balance so
she clicks the link that says view
balance and her browser makes a request
to bank.com
and of course the way that cookies work
is because this pre the session ID
cookie was handed to her saying that
every time that the browser comes back
to back da bank comm the browser should
submit the cookie so the browser
faithfully of abides by that and it says
oh I'm calling the view balance script
I'm making a request to bank comm oh I
should send the bank comm cookie so the
bank comm cookie gets sent with the
request Bank calm you know sees the
session ID says oh I I know this session
ID I give it to Alice it must be Alice
that's attempting to view her balance
and she's already authenticated
so I'm going to go ahead and tell her
her balance is $25,000 so everything's
you know just fine so far but let's look
at what can go wrong when her browser
happens to get lured to evil org let's
say that the same situation occurs she
goes to login she provides her username
and password
Alice enters her username and password
she is given a cookie with a session ID
because her user and password were valid
and let's say Alice is viewing her
bank's web page and let's say while
she's doing that she happened to receive
an email and she clicks some link in the
email and the link is a link to evil.org
and it lures her to view a web page at
evil.org while she's logged in to bank
comm so her browser makes a request to
say an HTML file to get an HTML file
called evolve out HTML from evil.org
evil.org sends back a page with some
HTML in it and i've um slightly
sacrificed technical actors here for
clarity of explanation but basically
evil.org might you know send back some
interesting content on the page so that
Alice thinks everything is fine but that
page has some say combination of HTML of
JavaScript which tells her browser to go
load the resource specified by this URL
HTTP bank.com slash pay bill question
mark address equal one two three evil
street and amount is ten thousand
dollars so Alice's browser receives this
web page and being a faithful browser
the browser wants to render this web
page for Alice so the browser says oh
okay
I should go access bank.com and I should
I should access this pay bill script now
you'd hope this wouldn't work but the
way this does work in reality is that
since the browser now makes a request to
the paypal script at bank.com it says oh
I'm making a request to bank comm
Alice's logged in to bank.com I should
senda bank.com cookie and so the browser
sends that cookie together with this
payable request with parameters of the
attackers choice in this case what ends
up happening is is it's basically an
instruction to bank comm saying please
send the attacker $10,000 to their
address and when Bank calm receives this
request it looks completely authentic
from the standpoint of bank comm there
is very little or nothing in this
request that Bank comm can distinguish
can use it to distinguish from you know
I was clicking the link for paying the
bill of herself and so bank comm happily
abides and says okay payment sent and
you know Alice just got cheated out of
ten thousand dollars so that that's
pretty darn bad why did this happen well
you know there's things in the browser
like the same origin policy which will
prevent evil.org from being able to read
the content that is given to Alice Penn
from Bank comm but what the same origin
policy failed to protect against in this
case is evil.org making a write request
to bank comm you know when when evil org
had this link for for paying the bill
you know it basically got executed so
being able to make write request is
still very very damaging now what kinds
of applications need to worry about
cross-site request forgery well
basically any application that stores
user data profiles so for instance you
know Facebook would need to worry about
this many other sites need to worry
about this you know you know MySpace or
could etc they all need to protect
against these kinds of attacks let's see
so you know sites that also allow you to
do financial transactions are also
susceptible to this kind of an attack so
how do we protect against it or actually
before I tell you how to protect against
it I'm going to tell you about how how
the cross-site request portrait can be
even more damaging how many of you have
heard of drive-by farming
one person nodding their head and that
is war driving or driving war driving is
where you you know kind of drive around
and try to find wireless networks that
are not protected but this is drive-by
farming this is a little bit different
right so in this attack the bad guy
takes advantage of the fact that when
most people buy their home wireless
router they just you know plug it in to
their you know phone line or whatever it
happens to be their DSL modem together
with the Royal Saud they just plug it in
and they don't bother to change the
default username and password and while
we all know that's bad let me tell you
one reason why can where I can be really
bad basically what the attacker can do
is you know if the user can get lured to
evil org evil org can basically send the
user a page which says which has some a
combination of HTML and JavaScript on it
which says hey make a request to
192.168.0.1 the address for the home
router and you know try to try to do
some kind of a write you know and the
attacker isn't able to read what
happened but the attacker can specify
things like on error clauses and so
basically what the attacker can do is
send out a bunch of queries to see well
where is the home router running and if
and when it finds the home router it can
basically issue a write request saying
please try to log in with the default
username and password okay what does the
attacker do once once they can log in
with the default username and password
what the attacker does in drive-by
farming is the following the attacker
says please change the default DNS
server to a DNS server that I own right
now regardless of which site the user
decides to go to bank comm brokerage com
whatever it happens to be the attacker
can serve his own version of that simply
because you know the the the home router
is now relying on the attacker to
translate the domain name
to the IP address so the the user is
just totally owned at this point and
even worse there may be no way for the
user to realize this the important thing
to realize here is this drive by farming
attack it's it's farming farming is
basically taking control of the users
DNS it's drive by because it happened
when the user just muted a web page but
what happened is it's basically a
cross-site request forgery attack in
which the quote/unquote website that was
attacked was the home routers web
administration console and the write
request was one in which the attacker
said please change the DNS settings so
this was some good work done by Sid spam
zuly ramzan and marcus jacobson and you
know all the more reason to make sure
you don't use default credentials per
year for your home routers so now that
we've talked about a you know exactly
how bad cross-site request forgery can
be let me talk a little bit about how
you prevent across that request forgery
so you know earlier on I said that
well when bank.com gets the gets the
forged request from evil org you know
it's virtually indistinguishable to bank
com but there is one thing that could be
different the one thing that could be
different is that HTTP says that you
know a refer can be specified so in the
usual case when alice is logged into
bank comm and only Bank calm and didn't
get lured to the site and Alice clicks
pay bill what happens is the browser
will make an HTTP request and specify
that bank comm is in fact the referrer
so you might argue hey well maybe we
could use the HTTP referer headers to to
check whether indeed bank.com made the
request or did evil lord make the
request but this doesn't work very well
in practice and practice simply because
well first of all you know you shouldn't
cross the client that's like rookie
mistake number one in security and the
refer is specified by the client but
secondly there's lots of good reasons
for the referer header cannot be there
let's say that the user is interested in
anonymously browsing websites and
happens to be using an HTTP proxy
if the McKay's then it's most likely the
case that the HTTP proxy will go ahead
and scrape off the referrer headers so
you can't tell where the users coming
from and so it's not very practical to
try to prevent cross-site request
forgery by looking at referrer headers
unless you want to alienate some part of
your user base and make the rookie
mistake of trusting the client so that
that actually won't work you might ask
well you know I'm let's say I'm running
Apache and I'm running a Web Application
Firewall is there some way that I can
use my web application firewall at the
server to prevent this kind of attack
maybe similar to using regular
expressions to prevent sequel injection
attacks and the answer unfortunately is
that this doesn't help either simply
because you know the request looks
completely authentic to bank.com and its
Web Application Firewall so so that
won't help either let me talk about some
things that you can do one thing that
you can do to prevent cross-site request
forgery is you can ask the user to
provide a secret that only they would
know as part of the request so for
instance if we ask the user to enter
their password again in before we
allowed the bill payment to take place
then the attacker would be out of luck
unless the attacker already has the
user's password right so if we ask the
user to enter their password again
before we allow the bill payment then
the attacker doesn't know what what
password to substitute in so that's a
pro CH that can work you know and of
course if the attacker already knows the
user's password then it's kind of game
over anyway they could probably do much
stuff so asking the user to validate the
action by specifying a secret that's
only known to the server bank.com and
and alice is a legitimate approach so
that's okay another approach is to do
validation by an action token and the
idea here is we could take you know some
cryptographic signature checksum and you
know how to build this action token
right is a it's a little bit tricky you
know consult chapter 10
my book Christophe Kern did a great job
in in you know in helping co-author that
chapter but basically what you can do is
use a server-side secret at bank.com
to compute a cryptographic checksum that
gets sent in the response to Alice and
appears in the form so when the user
hits submit it's not just the cookie
that needs to get submitted it's this
cryptographic checksum that's also one
of the form field parameters and the
idea there is that well the attacker
won't know what value to substitute in
simply because it was computed by a
secret that's only known to Bank comm
using using some secret key so that's an
also another approach I went over that
pretty quickly
please feel free to ask me afterwards if
you have questions about how to do that
and of course you know there's lots of
sources you can consult so I've talked
about sequel injection and I've talked
about cross-site request forgery and I
hope I hope that I'm convincing you that
you know there's lots of very serious
web application and vulnerabilities to
worry about and that it makes sense to
audit your application for for these
kinds of things and to design it from
the get-go to have defenses against
these kinds of attacks but let's step
back for a second and think about and
look at some data with regards to what
kind of attacks are the most prevalent
so what I've done is I've pulled some
data from The MITRE
vulnerability database which contains
information from over the years of you
know from various companies that
reported certain vulnerabilities as well
as the security research community and
lots of other sources and let's look at
what's happened between 2001 and 2006
what we see is that as of last year the
number of cross-site scripting types of
attacks have just increased dramatically
and I believe that in this data
cross-site request forgery also fits
into that particular bucket so so that's
kind of web vulnerability enemy number
one you know the next most prevalent is
sequel injection attacks so it's here
with the yellow line and the upside-down
triangles so it's not as viewable as I
would have liked
to be but there that are kind of number
two but they're pretty closely tied with
other types of code injection attacks
namely PHP include attacks in which you
can get a site - if it doesn't validates
or an input properly include PHP code
from from site of the attackers choice
so that those are the next things to
worry about and then things like denial
of service and buffer overflows kind of
fall below that you know as we're
nearing the end of 2007 it'll be
interesting to see Valle 'nor abilities
nearest database newest database in
addition to looking at the mitre
database I also looked at data from
other vulnerability databases like the
security focus vulnerability database
but you know the picture that I just
showed you you know gives you a
reasonable picture of what's going on
overall the number of well the number of
web Bowl of vulnerabilities that we're
detecting are increasing and you know
the number of attacks may also be
increasing but we're certainly getting
better at finding the finding these
kinds of vulnerabilities Ravel's of
which vulnerability database you look at
the big four types of attacks are about
the same across all of it so cross-site
attacks like cross-site scripting
cross-site request forgery cross-site
script inclusion are you know number one
you know and then these are the big four
code injection memory corruption due to
things like buffer overflows integer
overflows format string and denial of
service so if you're building web
applications these are the kinds of
things that you should be worried about
today tomorrow the picture might be
different things might change and so I
think that you know learning about the
the current set of attacks and defending
events against your applications today
is is a very very good thing to do at
the same time it's important to kind of
prepare yourself for the long term and
so I'm gonna provide a little bit of
information about what you should do if
you're an engineer or developer or a
programmer or an architect or
responsible for leading a team of folks
building these kinds of applications the
first thing that you should do is arm
yourself with this type of knowledge and
the second thing you should do is you
should for each project elective
securities are you know unless you have
one person whose job it is to to focus
on these kinds of issues a lot of times
things can fall through the cracks so
you know elective securities are for
your project is pretty self-explanatory
I'm gonna chat a little bit more about
how to how to arm yourself and how the
army or your securities are if it's not
you
so I'd mentioned that it's important to
defend against the attacks of today it's
also important to prepare yourself to
defend against the attacks of tomorrow
and you know if you ask yourself the
question of why we're in the situation
that we're in it's probably it's
partially probably because of the fact
that you know the knowledge of how to do
secures is on design has not been
disseminated throughout you know
computer science and electrical
engineering as probably as we would like
for instance how many people learned
about you know encapsulation and
polymorphism as part of their computer
science degrees yeah pretty much
everybody right and and the reason that
you learned that is so that you could
achieve code reuse extensibility
scalability in some cases
maintainability etc on the other hand if
I were to ask the same question how many
people were required to take a security
course to get their degree and actually
I'm not raising my hand myself I wasn't
required from me either
but the number is much much much much
smaller in fact I don't think anybody
raised their hand so there there are
certain principles at the heart of
secure design like the principle of
least privilege like failsafe stance
like how to defend against the weakest
link first how to identify the weakest
link first and it's important that we
teach these kinds of principles such
that when we're confronted with the next
new problem we have a set of principles
to guide us to help us figure out what
should be the right solution so that we
don't have to just rely on the current
set of tips and tricks that we know but
you know we can together with security
professionals figure out what the what
the right thing to do is so once you
once you know about how to do secures a
design
it is important to be familiar with the
current set of most prevalent technical
flaws and also be familiar with kind of
the current threats out in the field
right all of these different technical
flaws could be
used to conduct different types of
attacks for instance at the beginning of
the stock I provided an example where a
simple injection attack was used to
conduct denial of denial of service but
it can also be used to conduct the data
theft
you know similarly you know code
injection can be used to you know bypass
authentication or authorization or it
can also be used to you know get
information that you're not supposed to
write so it's important to be familiar
not only with the various technical
flaws but all the different ways that
they could be used to to conduct certain
attacks so if this is what every
intranets know the question is well
where do we learn it so I'll talk about
some courses certification programs
books and websites of course the
information that are providing here is
not comprehensive by any means but but
it is more of a sampling so if you're
interested in security courses you you
you know every major university will
have courses on cryptography typically
at the higher levels which is which is
good to know at the same time if we
looked at the types of vulnerabilities
that we've been seeing most of these
vulnerabilities or most of the attacks
are not about you know how do I break
the encryption function right how do I
break the cryptographic checksum very
few people in the real world are trying
those types of attacks instead most of
the time people took advantage of
vulnerabilities in software in order to
conduct attacks so we need to go we need
to get a lot better at building software
cryptography is an important part of
that it's it's important tool we can use
to help achieve security but the
software needs to have this inherent
characteristic of security in order in
order to protect our users and so some
universities like Berkeley and Stanford
have more systems oriented security
courses that at Stanford Dan Bonet
teaches CS 155 the u.s. UC Berkeley
recently you know provides cs161 and
these teach both systems as well as
cryptography to provide that set of
tools there's a much more comprehensive
list of security courses you know both
systems and cryptography oriented
I'll be Reubens website I encourage you
to check it out it's a it's a it's a
it's a decently sized list given that
there's a large folks of I mean there's
a large base of software engineers that
was not required to learn these types of
things when when they were in school
which is also the case with me
there's offerings like the Stanford
advanced computer security certificate
that's been created where you can you
don't have to take a semester long
course you go in for one week very
intense you basically learn how attacks
are done you basically construct attacks
yourself you attack you know test
websites that have been set up you then
build defenses and I not only can can
the event security certificate be taken
kind of on campus but it can also be
taken online in in the interest of full
disclosure I helped Stanford put put
this program together and what this
certification program has done is you
know in the old world we act a kind of
creative scenario in the lab where
people can come in and do attacks
against test websites and make sure they
don't harm themselves or anybody else
about what this program has done is
created a bunch of VMware images that
allow you to conduct the attacks in a
very isolated fashion you know and then
build the defenses etc so so you know it
it's very hands-on and you can get more
information at this particular url'
provide dot stanford.edu question mark
advanced security the program it's
divided into two sections there's a set
of core courses on things like you know
using cryptography correctly even for
security professionals that write code
you know using the cryptography
libraries correctly is challenging if
you get just one parameter wrong or
don't you know see it an IV correctly
you could just break the security of
your entire scheme and then there's
other courses on you know writing secure
code security protocols and there's a
set of electives you'll note that one of
the electives is securing well securing
web applications so if the kind if if
them killing the stock has been of
interest to you that meant you have
interest there's also a course that
takes place once a year and it's it
very fresh it's entitled emerging
threats and defenses and so it talks not
only about the types of abilities but
I've talked about but it also talks
about things like advanced phishing
attacks botnets etc there's also a
number of other security certification
programs out there that I encourage you
to check out one of them is offered by a
group called IC squared this
organization exists strictly to make a
certification program called the CISSP
available it's shown to be very good at
preparing people for administrative jobs
in security or government jobs also in
security it's much more broad than just
software security most of what I've
talked about today is software security
but CISSP covers things like physical
security telecom security etc and you
know you go in you learn this signal
multiple-choice test and you can get the
certification another certification that
you might want to be aware of is a
fairly new one it's called the giac
secure software programmer lots of
acronyms and while the certification is
fairly new it's offered by a group
called sans it's a security training
institute that's actually been around
for quite some time so while the program
is new the institution has been around
for a while they've created something
called the secure programming assessment
where you know you basically learn
software security knowledge and take a
multiple-choice test it has questions
like you know here's some code does it
have a buffer overflow yes in line three
you know this kind of thing you know
it is fairly new their first exam was
offered in August 2007 and you know
that's something else you can you can
check out let's see there's also a
number of books available I mentioned
earlier that I I recently published
foundations of security whatever
programmer needs to know together with
Christophe Kern Anita cassavan
it spends the the first third of the
book is spent on secure design
principles secure design methodology and
what it does is it
takes an example of a hundred line web
server that was you know built to kind
of just do its job right scenario as a
manager tells an engineer hey you know
just just build something that works and
go to it and so so so the programmer
does that and of course there's like
tons of vulnerabilities in this thing
and it illustrates you know how if
certain design principles were followed
those could be those could be avoided so
that's you know that's the first third
of the book second third of the book
talks strictly about web applications it
talks about client state manipulation it
talks about cross-site scripting it
talks about sequel injection it covers a
lot of the type of material I talked
about today and then the last third of
the book provides an introduction to
cryptography with the intent of giving
you enough security knowledge and enough
cryptography knowledge to have a very
good conversation with the security
professional in deciding how to build
your security protocol and the security
for your application so that's one
resource I listed two other are three
other very good books here one is on
security engineering by Ross Anderson
one of the great things about this book
is it has lots of interesting stories
and case studies and examples from you
know security that needed to be designed
for nuclear command and control why the
security of some early banking systems
available even though the cryptography
was great another great thing about the
security engineering book is it is
freely available online so so please
check it out
take advantage of it let's see a second
book that's available is Vega and
MacGraw is building secure software it
was published in 2001 it was kind of the
first attempt at bringing together
software security knowledge in one place
and it covers you know things like
buffer overflows very well it covers
race conditions how if there is a race
condition that can be used to to say bye
pass an authorization system due to time
of checks time of use issues strongly
recommended I also recommend the secure
programming cookbook by Vega and Messer
the security programming cookbook is
great because has lots and lots of code
examples of how to do security sensor
operations so for instance if you need
to do input validation and escaping
there's code right there that you could
you know pretty much steal to do proper
input validation it has lots of examples
how you should if you need to use
cryptography and let's say you're using
the open SSL library it has lots of
examples of calls how to do calls to the
open SSL library correctly so so those
are all good books to check out let's
see let me talk about some websites I
let's say one website that I want to
mention is the OWS P it stands for the
open web application security project
and you know it's a very interesting
group they kind of maintain a top 10
list of you know the most current
vulnerabilities it also one of the other
interesting things about this group is
they have a list of you know local
chapters in every city so if you're
interested in learning more about
security you can go to once a month
meetings wherever you meeting somebody
would talking about a different topic so
a very interesting group there in fact
having a conference in San Jose later
this week which which I'll be flowing
back forward to serve on a panel there
so it's a variation group the the next
thing I wanna tell you about is the
security focus website security focus is
the home of the original bug track
folder ability mailing list so that's
another good site to check out and we
also recently launched a site called
code.google.com slash edu and that has a
introductory web security course so if
you need to if you need to start
teaching security courses this is a
great place to get some slides let's see
let me just mention a little bit about
the OWS P top 10 this group has become
much more mature over the years you know
if you look at what their top 10 list
was like back in 2004 or like
unvalidated input was number one but
unvalidated input describes quite a few
different things right and you could see
that well that was dropped from the list
and a whole bunch of more specific
things you know like sequel injection
and junction flaws malicious file
execution etc
placed it and you can also see that this
top-10 list is also now beginning to
mirror some of the information that
we're starting to see them from
vulnerability databases so so lots of
good stuff there I told you a little bit
about security focus I told you about
code.google.com/speed contributing to
this please let me know if you're
interested in using it please feel free
to just go ahead and download materials
from there
let's see if you're interested in
anything that I talked about at this
during this talk there are some slides
and pointers to all the resources that I
mentioned that learned security comm
just go there and click on the resources
link to check it out you know to just
kind of conclude here every engineer
every software professional should be a
security practitioner and you know if
you're interested in interesting
problems and security please please come
talk to us my contact is information my
contact information is below please feel
free to let me know if you have any
questions Thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>