<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>django: Web Development for Perfectionists with Deadlines | Coder Coacher - Coaching Coders</title><meta content="django: Web Development for Perfectionists with Deadlines - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>django: Web Development for Perfectionists with Deadlines</b></h2><h5 class="post__date">2007-10-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/p-WXiqrzAf8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi I'm JJ Behrens from our important
system
thanks to Google for letting us user
building we're gonna have a special Bay
Piggy's talk today by Jacob Kaplan moss
one of the lead developers of Django and
jingle is a very very cool web
application framework which I've used
and I like a lot and you know we were
getting banged around by Ruby on Rails
for a long time and so it's it's really
nice to have such great cool stuff and
in the Python world and now let's listen
to someone more important than me Jacob
alright well thanks so I've spent the
last few days at the my sequel
convention here and all the PHP and my
sequel talk is has made my brain hurt so
what I'm gonna ask from you is if I'm
boring you being too too uh spending too
much time on the details you know tell
me do to skip a bit and similarly if I'm
moving too fast and you have questions
just stop me at any point I don't have
this down to a science so interrupt me
etc so my name is Jacob cap and moss I'm
one of the lead developers of Django
which is an open-source web development
framework for Python I'm imagining that
most people here know what Django is is
there anyone who doesn't sweet so I grew
up here in the Bay Area Redwood City
actually and so as you might imagine
when I grew up I moved to Kansas which
actually isn't as bad as you might think
actually it's really cool Lawrence
Kansas where I live it's an amazing town
college town of this really awesome
downtown it's got one of the best used
bookstores I've ever been in in my life
it's got an amazing live music scene we
we've been called the Midwest's Austin
which is pretty awesome considering it's
a town of 80,000 seriously the music
scene is amazing you walk down town on a
Friday night and you'll hear you know
eight different bands playing we have
bands that come through Lawrence that
are playing selling out stadiums on the
coasts playing in little jazz clubs
in downtown Lawrence there's an amazing
local brewery and a number of other
incredibly cool things but I didn't know
that when I moved there I moved there to
work for the local newspaper but
actually more precisely I moved there to
work with these guys
Adrian hollow-body on the left and Simon
Willison on the right I had known who
these guys were for a long time and when
a job opened to work with them I've
scratched my head a bit and went what
are they doing working in Kansas but I
couldn't pass up the possibility of
working with these these amazing guys
when I got there I found out what they
were doing in Kansas they had this thing
at the time it was called the CMS and
it's what eventually became Django but
I'm gonna step back a bit and go through
the history of Django so this is a
picture of election night 1957 and if
you look in the background you can see a
blackboard that's actually the first
version of Django back no seriously in a
very real way you can claim that Django
started in the 1850s when the newspaper
was founded it's a family-owned
newspaper and they've always set an
extremely high premium on innovation the
owner of the newspaper the current owner
is the fourth generation in the family
he is in his 70s he doesn't know how to
use computer he his secretary will print
out emails and bring them to him he will
write on them and pencil and she'll type
back in the the content this is the
owner of the company and he has built
one of the most amazing web teams I've
ever had the ability to work with so our
flagship project is this thing called
Lawrence comm and it's got all the cool
buzzwords mp3's RSS everywhere podcasts
yeah
we even have a print edition which is
taken from the website rather than the
other way around for a long time we were
the only company doing this now there's
a few people who have copied us the our
bloggers become colonists readers
submitted photos become our photo pages
stories are suggested by readers most of
most of the content is posted online
first usually comments on stories are
published in line with the rest of the
story now originally this was all
written in PHP and this was before I was
there but they adrian and simon went
through a very similar process that I
went through we discovered that PHP had
some issues everyone knows that
maintenance is sort of the biggest part
of developing software it's really fun
writing things upfront it's much less
fun maintaining things and we all
discover that maintaining PHP is
incredibly hairy for example this is a
list of every a function in PHP
available in every scope PHP doesn't
have namespaces I'm told the reason it
doesn't have namespaces is when they
discussed the feature for inclusion in
PHP 5 they couldn't agree on a syntax I
imagine that some of the people who
develop Python might understand that but
the interesting thing is that they
didn't make a decision and move on I'm
told PHP 6 will have them I'll believe
it when I see it
now I'm gonna quote someone who is kind
of surprising but our arch-nemesis DHH
is fond of saying that PHP is the devil
and it is it suckers you into thinking
you can develop something incredibly
fast and then you had 90% of the way
done and you can't do the rest so we are
extremely proud to be Python power and
by the way we need a better logo
I'm gonna talk a bit about the
philosophy that led to the development
of Django and that continues to guide
its development we need to make web
development stupidly fast we measure our
deadlines in hours not in days
definitely not in months we'll come up
with a feature over lunch and we'll
launch it before we go home
we need to automate the repetitive tasks
I can't count the number of times I've
written form handling code Django
doesn't form does it for you
dealing with the ridiculous politics
surrounding RSS is boring and obnoxious
Django just does it I can go on and on
about this kind of philosophy of there
are stupid boring things that every web
developer has to do that we shouldn't
have to do and that's what we aim to
free you from we're pretty fanatical
about best practices a prime example
would be when evaluating an existing
Python web framework a few years ago
Simon discovered that you couldn't tell
the difference between data that came in
over get versus over post that's a big
no-no when you're dealing with you know
with good web interfaces because you
need to know the difference between
variables passing the get string and
content posted this is sort of basic
HTTP but it needs to be done right as an
end developer you you don't necessarily
need to know about this but the
framework shouldn't get in your way of
doing things the right way finally our
last philosophy this is something that
Adrian's fond of saying the ink is never
dry on these babies now Adrian comes out
of the journalism world he actually
majored in journalism before becoming a
developer and the difference between a
web app and something printed on the
page is that you can continue releasing
content for the web app so the goal of
Django is to be able to develop
applications incredibly fast but allow
you to continue to tweak them and use
them into you know into perpetuity
so this software all existed in Lawrence
and continued to be developed in March
2005 or around March 2005 a couple of
things happened that led us to want to
release it the first was PyCon 2005
which was the first time we had shown
the software - excuse me - anyone
outside of the world online the horribly
miss named extremely local development
company that is the division of the
journal world where we work and we had a
pretty overwhelming response a lot of
people said hey you got you got it
releases this is really cool the other
thing that happened around that time is
it Ruby on Rails started to really get
this an enormous buzz if we looked at it
and we said hey we we can do that too
this was actually the first mock-up of
the Django website come July 2005 we had
our IPO I think the site looks quite a
bit better so I'm going to talk a bit
about some people that are using Django
one of the things that's that's blown my
mind is how quickly it's been picked up
but actually the first person I'm going
to talk about is us we have a new CMS
called Ellington that drives all our
sites some of which they're shown here
but we actually just sold Ellington and
Django to Scripps Howard newspapers as
their standard development platform for
all their newspapers I'm so excited
about this I can't even express it the
fact that a major publisher has decided
to go with an open platform for all of
their publishing from down you know from
down the line and that it's our open
platform
it's absolutely thrilling yes
the we sold them the source code
basically so they're free to do what
they not the source code - Django
obviously the source code - Ellington so
they're free to kind of do what they
want with it so it's we have a weird
licensing model which is based around
the fact that there are three of us
that's three developers so we can't
possibly support you know 25 newspapers
I'm sure most of you have seen Chicago
crime
org Adrian won a $10,000 prize for it
so you can make money just using Jenko
there's also a developer in Canada st.
Joseph's Media which is very quickly
launching or relaunching sites based on
Django these are three of their sites
Greenpeace is using Django for a social
software tool they're calling melt I
don't know much about it I know it has
something to do with connecting people
to work on environmental issues and more
precisely I don't think it's actually
Greenpeace it's a third-party contractor
I think it's thought works that's doing
the development for Greenpeace this is
just a site I ran across the other day
passion DC there a dating site in the DC
area they claim to have over a thousand
single horny DC i'ts grow no dotnet
which is the Polish equivalent of
Friendster has six hundred thousand
users and is using Django in some
capacity they don't speak English and I
don't speak Polish that we've had some
difficulty determining exactly what
they're using it for and there's quite a
bit more sites using Django so I'm gonna
shift now to what Django looks like I'm
gonna kind of zip through the basics I
have these slides in there but I'm not
gonna spend much time on the code
because we have pretty good tutorials
that cover the basics so I'm gonna rush
through them and move on to kind of the
cooler stuff that I often don't have as
much time to cover in a presentation
first a word on philosophy a big
question is is django MVC this is this
you know MVC is a big buzzword we if we
have a methodology it's that we're anti
methodology we're not precisely MVC I
like to think of art you know Django is
being MTV model template view I guess of
MVC gets to move the the order around we
get to move the order around too if we
want to and there's some subtle
differences in the way that works
I've never really understood what it is
about it exactly where of you becomes a
template or where a controller leaves
off from a model I find model view
template just makes a lot more intuitive
sense to me
so models a model is a blueprint for
your data
it describes everything that there is
about your data one of the big goals was
not to write sequel now not that sequel
isn't a great language and it's perfect
or mostly so for what it's meant to do
but you can't describe everything about
your data there's there's a large amount
of data of metadata that doesn't fit
into the database but that your
application code still needs to know
about so a basic model look something
similar to this and by the way I'm using
the new style or magic removal syntax
which is being merged into truck as we
speak we're having something of a
upheaval
right now and I can talk about that more
later oh when is that going to be
finished as soon as possible we're
probably going to release a stable
version pre merging to trunk to let
people try to try to find if it is
actually stable in the next week and
that API will be 99% stable through 1.0
and future versions so photo is a model
it has an image field it has a character
field it has a date/time field
now so far this there's nothing here you
can't describe in sequel and and that's
and that's okay because we love Python
I'd rather write Python than write
sequel this will generate the sequel for
you at this point
and just from doing this you get a
really cool pythonic API
photo dot objects dot all like that's an
iterator that iterates over all of the
photos photo to objects filter uploaded
equals today
that's the date time date dot today
it's amazing how short your code samples
have to be to fit on these slides you
can do arbitrary filters title starts
with pants uploaded is less than some
particular date you can express nearly
everything you need to express in sequel
directly in Python one of the really
cool bits about this new syntax is this
concept of a query set which is what
filter is actually working on lets you
pass around kind of these canned queries
that get evaluated only when you iterate
over them and you can slice them and you
can combine them and intersect them and
that kind of cool stuff however there is
there are ways to drop directly into
sequel if you need to and every so often
you need to I used some abstraction
layer at some point that actually had no
way of just dropping into sequel and
running a rock query and I just couldn't
just absolutely couldn't believe it
every so often the language breaks down
and I'm told that Python 3000 world tabs
support for creating mini languages so I
don't think we can hope to have that in
in the language okay so back to this
other metadata I talked about earlier so
one of the in my opinion the coolest
feature of Django is the automatic admin
interface our particular development
model looks something like programmer
develops the data models figures out
okay what's a photo
what's a gallery how does all this stuff
work and we hand it off to a Content
producer a photographer and editor
somebody maybe sometimes ourselves
usually some other content producer and
I think it matches the way a lot a whole
lot of websites work that person needs
to be able to enter data into the
database and that's where it's sort of
the pain point for web developers starts
writing these admin interfaces
interfaces are so boring have to
validate this field you have to make
sure that that's not blank check that
this is a valid image type make sure the
dimensions aren't the rights you know
it's just so boring so this is what it
takes to do that in Django you had a
piece of metadata I've added some fields
about list display here which controls
what fields that show up in the object
list there's a bunch of other options
you can give and that's it and you you
all of a sudden have a production ready
pretty nice looking if I may say so
myself admin interface for editing your
data this is the main admin interface
for all of our sites and there's as you
can see there's a huge amount of content
in it we don't have to write a single
line of code to make this happen neither
to you this just happens for you you get
a list page for edit for selecting
objects this is a more are more complex
photo model that has fields for which
site it's published on you can filter by
creation date you can search by caption
I'd also actually Lily you can't tell
that you can you can search by stat by
the person who took the photo so if you
know the name of the photographer you
can type in their name and find that
photo you automatically get your
standard add and change pages and you
get your data validation I've just
submitted this form without filling it
in any information here so it's telling
me what's required I can't tell you how
much time this saves us it's insane
we can we can simultaneously have our
editors uploading information to the
site as we're writing the public views
takes us five minutes to knock out a
model and then they can get to work the
kansas kansas state government released
a list of the salaries of any state
employees making over a hundred thousand
dollars about a week ago and we found
out that this list was released at about
10:30 p.m. on a Sunday night and press
time is 11:00
and one of the reporters knocked off a
story to go in the paper but it wasn't
very long and he said we really should
do something online about 11:30 one of
our developers started working on some
models for
the data have those models done about 10
minutes later our program our reporters
started entering the data took him about
an hour to put all the data in by the
time he was done entering it we had a
site that lets you browse the salaries
of any Kansas State employee making over
a hundred thousand dollars search by who
they work for filter by how much they
make sort in different directions and we
launched that feature at midnight and
got close to a hundred thousand views
the first day that's what I mean by
stupidly quick we have to be able to do
this this is these are the deadlines
that journalists work on and we don't
get an exception from that just because
we work with you know bits instead of
ink the next step of design is to design
your URLs and now some of you going what
wait a minute that's not part of this
MTV thing you talked about you know you
need to what'swhat's this about
designing URLs that's boring it might be
designing URLs might be something that's
a little annoying but god I hate that
why should I as the user have to know
that they're using ASP why do I care
what the page ID I mean why do I need to
know this stuff that's that's awful and
this man that is just really ugly he
died recently did you know that it's
pretty sad this is Sam the world's
ugliest dog by the way this is this is
real this is not no Photoshop here
search google for it that's a little
more like it this is what URL should
look like and actually I have a bug on
my slides really that shouldn't be a 14
that should be a nice little slob
describing what the what the photo
looked like but my my next slide didn't
wouldn't fit if I used that so I used
ideas instead so what you do in Django
is you design your URLs they are a part
of your application and I think now with
all the all the rest stuff finally
really catching on people are seeing the
value of having URLs be clean and
describe a resource and be guessable
but there's a lot of there's a lot of
back and forth in the Django community
about this this level I'm a fanatic that
your URLs should be clean and beautiful
and as are they're as important a part
of your app as a UI is sex I go to is
that I make a guess as to what something
is and either says it doesn't exist or
it says you were not authorized to be
what it was was making an observation
that some of the sites that he you know
views home make a guess about what a
what a resource ought to be at and it'll
either just not exist or it it will be
you know unauthorized yeah I mean that's
that's part of it and forcing a
developer to explicitly think about what
the URLs are I think really cuts down on
that um there's a feature in Django that
will email the site administrators every
time there's a four or four generator on
the site you should see my inbox it's
extremely valuable though because we
will see we'll see people guessing we'll
see people chopping a portion off a URL
and guessing at something and there
won't be something there so we'll put
something there you know it happens a
lot we have a whole sophisticated series
of filters that filters out the ones
that have a refer from the ones that
don't because the ones that don't have a
refer the more interesting ones those
are people trying to guess URLs and we
get a steady a steady stream of them
every time we launch a new app we'll
usually have a bunch of people chopping
something off a URL in some place or
adding something on and trying to do it
and I view those as unwitting feature
suggestions so this is what designing a
URL looks like a URL pattern is a loose
data structure it's very similar to a
list although there's a constructor for
because it's got a couple of fiddly bits
and each URL pattern is a regular
expression and a callback this this bit
at the beginning gallery is a prefix for
the callback since a lot of times your
callbacks are all on the same module so
you provide a pretty
and they're all underneath that so this
basically says anything that matches
photos is that it calls the photo index
function anything but massachio toes and
then some digit only missing a slash at
the end there um matches goes to the
photo detail page view excuse me there's
some other stuff you can do with these
that I'll get into later well the big
thing to point out is that although they
do have the regular expression you know
beginning anchor they're actually semi
relative URL patterns can be included
with an other URL pattern so you can say
I want to include all the URLs for
photos at at this point right this might
be a top-level URL pattern but if I was
doing this as part of a bigger site I
would probably match just slash and
slash ID and then that would be included
at whatever the particular site wanted
it to be at a good example is um our our
standard for news stories is news slash
something there's a date hierarchy but
fairly often when we're doing work for
clients they'll say oh I want that to be
it you know slash stories so that's
really trivial to make JJ yeah I've
noticed that in the tutorial the URLs
will actually be duplicated in and said
the templates and so like it's you know
it's here in the world patterns but when
you're actually creating a link it's
also in the templates and I heard that
that was being discussed on the
developer mailing list yeah the question
is so you've got this really nice
abstraction mapping a URL to your view
but when you're sitting in the template
when you're developing a page and you
need to generate a link to something how
do you do that but the current way is is
not incredibly good we've had we've been
defining a get absolute URL function on
objects that return the URL to that
object and that's extremely brittle
that's at the wrong layer and the
abstraction there's there's all sorts of
problems with it Adrienne just came up
with a proposal to simplify this
basically being able to say link to this
object and figure out from the object
type what view is it maps to I
know what the state that's going in in
some form but I want to say this no no
please having a very strong take for
what it's worth this is yeah so routes
has a pattern called rail rail
systematical Brown yeah and then back it
up up he's here but it comes too close
for Python which yeah hi
and I love you it's great for bashing a
generation it's saved days of work yeah
one of the currently there's an
abstraction about what's used for excuse
me so the question is ruby has this
thing called routes which is extremely
cool and there's a python implementation
called routes also which has more or
less solve this problem of going you
know one way to the other so there's
there's two things first when i say more
or less i've run into and I haven't used
routes in six months or so so this may
this may not be true anymore and you
know shut my mouth if it is but if it
isn't but um I run into things that
can't be described we can do pretty we
do some pretty complex stuff with the
way URLs work sometimes and that fiddly
bit of going both ways can be difficult
to get right answer to is actually the
way that URLs are resolved is abstracted
right now there's just not a documented
way of saying use my resolver instead so
one of the plans is to support routes as
an optional you our URL resolver and to
probably support object map or type URLs
even though I hate them JJ so if you're
gonna support generating arbitrary URLs
in the templates and of course looking
at this of course you're gonna want to
be able to pass multiple parameters be
nice to have a keyword syntax for
calling functions within the template is
that gonna happen because I noticed that
was one of the things that I found most
lacking question is about basically
about function dispatch within within a
template yes with keyword artists I'm
going to talk more about the template
language later and I think that's
probably the bell I'll remember that and
come back
it because there's anyway I'll come back
to that question and remind me if I
forget so at this point we've we've
mapped the URL so what does that URL map
to it maps to a view and a view
describes the data that's presented to
the user not how the data looks but the
data that actually gets presented to
them and this is important because if
you've ever if you've ever seen HTML
embedded with database lookups embedded
with you know Web Services calls you
know how how hard to maintain that can
be I've actually seen a system I shit
you not that has every single URL on the
site calls a stored procedure in an
Oracle database that generates HTML in
the stored procedure and returns it to
the web for display I'm not joking that
is just so awful I can't even start to
be heart to begin so there's a big
distinction between what data you see
and how you see that data and that's I
think where in my mind in my limited
understanding the MVC thing kind of
falls apart for me so this is what a
simple photo index view might look like
and actually if you're gonna write this
code you shouldn't because there's a
better way of doing it but I'll get to
that later you gotta you got to walk
before you can run there's this really
simple render to response function that
takes a template name and the syntax for
this has actually changed since I wrote
these slides we used to guess the
template name extension now you
explicitly put it in and a template is
rendered given a context and the context
is just a dictionary of values they
looked up there there's more
abstractions involving a context with
nesting and things like that but it's
not particularly important what this
does is abstract a couple of different
steps that depending on how your your
view looks you might do you might do
separately and that's loading a template
creating a context rendering a template
given a context and returning a response
object with the data from that render
template you can break each of those
steps out and do them individually and a
lot of times you know you'll need to if
you want to do something you want to set
some crazy headers or if you want to do
you know caching based on the URL or
things along those lines and that will
get rendered through that template I'm
gonna go over templates later so this is
another thing what a photo detail
template might look like might look like
very very simple and the vast majority
of views aren't really much more complex
than that I did an audit of all my code
a while ago and I think the longest view
function was about a hundred lines and
most of them were in the twenty to
thirty line range if if not less for the
context or is it just generated a memory
and help there it not really there's a
cache great oh yeah the question was the
question was is there persistence for
the context or is it just you're just
generated into memory there's a cache
framework that lets you at a very simple
level just cache an entire view it's
also extremely simple to cache arbitrary
objects in the cache there are some
fiddly bits with storing objects
directly into the cache so we don't
cache contacts directly for example if
you cached if you if this context was
automatically cached for you know let's
say you know ten minutes and the photo
object had a relation to some other
object that wallet was cached got
deleted it would cause an error when you
pulled that object out of the cache not
when you pulled it out but if you tried
to access the contents of that object it
would be internally inconsistent you can
store objects in the cache and they
pickle and on pickle
fine but we kind of want you to know
that you're doing something we don't
want to do it automatically because
it'll come back to bite you people who
don't understand the ramifications of
that
just described fiddly bits if they wanna
play the questions can I describe fiddly
bits I use that term to describe things
that make me uncomfortable about about
coding well the example I gave about the
about relations maybe not being correct
once you pull the content out of the
cache the the biggest problem is with is
with many too many relations because
those aren't using an attribute stored
on the object itself it's you know it's
using an intermediary joint table but
Django abstracts that from you so you
don't have to think about the fact that
you're doing you know joining this table
through that table to that one and that
can in corner cases fall apart when you
cache objects directly that answer the
question pretty well okay so let's go on
to a template a template describes how
your data looks and for me actually this
is this is the part of Django that I
know the least about mostly because I
don't develop templates I don't know how
true this is of most companies but my
gut reaction is that there's a lot of
companies there's a separation between
the people who write the backend code
and the people who did the design if if
most developers are anything like me
there really should be that separation I
myself I design looks awful we have
extremely talented developers to do most
of the template development so a lot of
the tips and tricks about how to use
templates are not things I deal with on
a daily basis I know how the
implementation of the templates work but
I don't know a lot about a lot about the
tips and tricks of using them posit Ori
of those I don't know but there should
be I don't think that there there's
pretty comprehensive documentation that
was written by by Wilson basically by
our designer and the guy who knows who
uses the template language is full time
so I imagine that that's pretty complete
there's also this really nifty
automatically generated and user level
documentation that's built into the
admin that it gives you information on
every template tag built into the system
on every filter stuff like that
um it seems to me very noticeable
that you guys like don't have to write
the templates yourselves because I love
jingles so don't get me wrong but when
it comes to don't repeat yourself I
could do apply that perfectly fine to
all of jingle except for when I go to
the templates and then I'm stuck and
like I bought that like crazy so the
question is basically that it shows that
we don't use the templates extremely
well or all that of us of the developers
because often the d ry principle don't
repeat yourself breaks down when it
comes to the templates I disagree let me
move on and explain why this this look
is the first line in most of your
templates extends bass now I hated this
so when I started working with I
absolutely hated this model of extension
basically the way it works is you define
at some level of base template and you
define a series of blocks in that base
template and then your child templates
override those blocks and put value in
it if put values into it it was inspired
loosely by cheetah and it's very similar
to what you might do in subclassing you
define a whole class with a whole bunch
of behavior and you'd subclass it and
override just a piece of that behavior
and I absolutely hated it I said where's
include you know I need my include
actually this generates much much
shorter code the answer to JJ's question
earlier is if you're repeating yourself
it means that your contents not in the
right template and we can talk about
this more later because I'm seeing him
shaking his head but I still maintain
that that I'm I'm a convert I've drank
the kool-aid
I think extension is the coolest thing
so once you've extended a template this
is what a block looks like as I said the
base templates define blocks and in here
I'm describing the block content they're
variables there are you can it's got
this object map or thing that's ripped
off directly from sheet at this time
where you know photo dot get up image
URL that could be variable that could be
a dictionary key that could be a
function that takes no parameter
and it kind of hides that from you so
here's the philosophy behind the
templates right and here's basically the
answer to every time this is the answer
I'll give every time the developer says
why doesn't the template do X they're
not for you they're not designed for you
no one in this room is the target I
don't think is the target audience for
the template language I'm not Adrienne's
not most of you aren't I know from
talking to designers who use it that
this that this is what they want they
want something amazingly simple they
want they don't want to think about
dictionaries they don't want to
understand the difference between an
attribute and a function call they don't
want to know what an iterator is versus
a list they'd want something as simple
as possible so we've restricted we've
resisted strongly making the language
any more complex than it is and we
actually I think it's too complex
already the the basic idea is that I
need to be able to hand off the template
development to someone who really isn't
a programmer Wilson said it really well
he said that you know I'm not a
developer and if you try to make me into
developer I'm gonna let you down but if
you give me something that I can wrap my
head around and something that I can do
I won't bother you and as a developer
that makes my ears perk up I I love it
when my designers don't bother me so
that's the the idea behind the template
languages
the question is does this mean that
Django doesn't scale down to a single
developer and that's that's an
interesting question because so there's
this tension between optimizing for the
large case and optimizing for the small
case and I I don't know how I feel about
when the individual developer comes
directly in conflict with the separation
of separation of tasks my gut reaction
is that there are probably more places
where those tasks are separated than
where they're not but then the other
part of me goes longtail long tail so
it's a difficult question and it's a
difficult tension and I don't think we
have the answer to that so normally I've
gone pretty fast here normally this time
getting to the end of my presentation
here when I talk about Django and I show
this next slide of this is all the cool
stuff that's in Django that I don't have
time to talk about this is all the cool
stuff that you also get in Django that
I'm going to talk about because it's the
best part once you've learned the
beginnings generic views syndication
authorization authentication comments
internationalization localization
there's actually a few others that I
haven't included on here the cache
framework being one of them that is it
saves my ass every day but it's so
simple I didn't think it was worth even
talking about so generic views now as a
as a developer you probably notice
you're doing the same thing over and
over again when it comes to views you do
views that have a list of these things
you have a single thing you have lists
of things broken down by date you have a
creative thing you have a delete a thing
you have an update a thing
Django does pretty much all of that for
you with these with these things called
generic views because those tasks are so
repetitive and in most cases in fact in
all the view examples I showed earlier
you don't actually have to write any of
you KUB what you do is
in your URL pattern you farm out to
what's called a generic view and there's
this third argument to a URL pattern bit
which is a dictionary of additional data
to pass that view it's passed in as
keyword arguments to the view so in this
case I'm redoing what I did before
without without any view functions I'm
calling the object list generic view and
I'm passing in a query set which is
photo objects at all but the cool thing
about this is that this lookup actually
isn't done here and not done till they
iterate over it
so if my if I pass and I can pass in
another keyword argument which is a
paginate by which will say paginate my
object list by 100 items or by 500 items
and the slicing will be done in the view
for me and only and the correct limit
clauses will be issued in that case so
all I have to do at this point is create
a template that's called photo detail
photos slash detail something along
those lines and I can just just do it
all on the template we use these
everywhere I bet half the views on our
sites actually or generic views because
you know you've got an object you need
to show a list of them you need to show
and you know in a detail view and here's
what the detail view would look like the
object detail generic view knows to look
for an object ID parameter from the URL
pattern here's a bit that I didn't talk
about before if you define every capture
you define in a URL pattern is passed in
as a positional argument to the function
in the order that they appear named
captures with this p object ID syntax
are passed in as as a keyword arguments
to the view functions so this lets you
do stuff like moving you can move around
where your object ID appears in the list
and pass it in and the object detail
views can do you can do a detail based
on ID you can do a detail based on a
slug field and you can you can there's a
number of other options there's they're
pretty extensively documented so I will
refer people to that question
generic fuse extend face like an example
you should profession is do the generic
views extend base they don't define a
template so you you create your own
template again because the process of
while the process of loading a list of
images is exactly the same as the
process of loading a list of stories
loading a list of blog entries loading a
list of salary values it looks nearly
identical to the template I showed
before it you can either pass in an
explicit name or it guesses it based on
the name of the object in this case it
would be photos / photo detail for this
page do you know for this particular one
or you can pass in a template name
explicitly that's pretty cool because
you can set up another argument you can
pass into the or rather you can take
let's say I wanted to have a list of all
photos and also a list of all photos
taken by a particular photographer you
know we have an award-winning
photographer on our staff so I want to
do a bill Snead photos page I can pass
in a different query set photos objects
that filter author name equals bill
Snead but I can pass the same template
if I want to I probably wouldn't in that
case actually because we would want to
have a different view or a different
look of that data but you can mix and
match in that way the developer is
always responsible for the designer the
developer is always responsible for the
template it's a question no I mean the
designer is usually responsible for it
generally the way that we work is one of
the developers will will create the data
will create the views or just define the
generic views and then say and I'll say
hey Wilson photos / op photo detail and
okay and go off and do it and there's a
reference in the admin of what's
available in that view so you know
what's in the context for that view and
or if your Wilson you probably know just
because you've worked with me for a long
time what I've put what I've named
things
it's kind of funny when I had a Oh
Adrienne launched a site in the
Washington Post the other day and we
were poking around guessing URLs of
things that he hadn't publicly announced
yet and in each case we were right about
them and we were like what does this
show about us that week we can guess you
know what all of us are gonna name
things I think I think Django is very
much optimized towards the small team
that knows itself well that knows each
other very well
and that's a space that I'm really
comfortable being and my experience as a
developer is that those are the teams
that get the cool shit done and those
are the teams I want to target I I know
that scripts right now is using Django
slash Ellington with a team of 20 I
don't know who the team of a lot of
developers I don't know the number and I
haven't heard that they're having any
problems with it so that makes me very
happy but definitely this comes out of
what we use and what we are is a small
team that works well together so there's
a bunch of other generic views there's
this simple there's a set of simple
views there's one that just renders
renders a given template that's useful
for um I don't know if you just want to
display some static content at a
particular page you just pass it off to
it you know a designer just to do you
know an about page maybe there's a whole
set of date based generic views these
are actually the ones we use the most
and they let you do they look similar to
the object list views and the object
detail views but they let you do
breakdowns here so you have a year index
you have a latest end objects by date
view you have a year view year month
view your month day view and then a
detail view and we use this all over the
place that's you know it's a pretty
common I think inspired by blogging URL
structure and then there are create
update views which do creating an
updating of objects as you might guess
Syndication this is relatively new and
is seriously like one of the coolest
things in the world we we have RSS feeds
for nearly every piece of content on our
sites and a lot of times people are
impressed when we tell them that and
they shouldn't be because they're so
easy to create so some imports for a
feed photo feed inherits from feed I
give it a title I give it a link this is
you know used for the link element
within the within the feed it'll it'll
guess the full you know HTTP whatever
URL for you or you can give it to it you
give it a description you give it the
item should be items excuse me and you
return a set of items that's it
that's a feed this creates a feed of
photos all right let's feed if I wanted
to make an atom feed it's one line I say
feed type to atom feed instead of the
default RSS feed if I wanted to find a
author for for each individual object I
define an author name function that
takes an item as returned by items and
returns the author name given that item
you can get a lot more complex most of
the time you don't need to again I'll
refer you to the documentation if you
want to know how to get more complex
here so I had a whole oh there's a
question back there
the question is how how does uh how does
this get attached to a URL basically
there's a central dispatch function for
feed so you route them maybe at slash
RSS and you pass in a list of sorry a
dictionary of feed slug so like photos
to the feed class that you're gonna use
and it's again that's the philosophy of
one site might want to call it RSS slash
photos another site might want to call
it feeds slash images so you can you say
you do that all on your URL conch I
don't have a slide of that but the
documentation does so I wrote these a
while ago and I had a bunch of slides
about off off however this is changing
member of the community joseph is
working on a new abstracted
authorization system currently
authorization is all based on models in
Django there's a user object group
object permission objects he's working
on a abstracted system that will let you
use that the standard way will let you
use LDAP will let you use flat files
will let you use whatever you happen to
want to use the API is not stable so I
didn't want to cover it because I'm
relatively sure the way it is right now
is going to change so stay tuned it's
super cool the way the admin works in
this respect is that you define users
and groups in each and they're a set of
permissions for each object so my photo
object will have a Kent can create photo
can update photo can delete photo set of
permissions in each user can be assigned
permissions based on their role within
the admin those roles assigned their if
they're assigned through the admin
there's an admin interface for editing
the user object just like this for
everything else and you assign the
permissions there and that won't change
as far as the admin works but as far as
and how authorization works in the admin
is mostly transparent so I don't think
it's particularly interesting how
authorization and authentication works
in your code is going to be is going to
be different and exciting
the things that the josephÂ´s
authorization work is going to allow is
token based authorization for doing web
services which is something I'm
personally really excited about if I
start to do a lot of more of that stuff
and that's gonna basically just be built
in you'll be able to say expose a web
service for this object at this URL
using tokens and just do it another
really cool framework that we use all
over the places comments made the
decision a long time ago that our sites
are a central location for members of
the community to discuss things and
despite the fact that we have the same
problems with commenting I think that
everyone has trolls and jerks and creepy
people and all the various varieties of
ugly human behavior you can possibly
imagine what's what's the line an
anonymity plus free commenting equals
assholes I don't know what the I don't
remember what the quote is exactly but
man it applies to our stuff but that
being said we attach comments to
everything any place we in the same way
that if it can have an RSS feed it does
have an RSP RSS feed if it can have
comments it does have comments so Jango
has a built in framework for attaching
comments to an arbitrary object and in
fact you don't have to write any code to
make it happen it all happens in the
template there's a series of template
commands that will generate the forms
and the list of templates automatically
without having to set anything up and
this is very simply what it looks like
you load the comment library
Django's template system has a way to
define custom tags in python and these
are a set of custom tags get free
comment list for my app photos photo ID
as comments my app dot photos is a
content type identifier in Django every
every content types a photo has an app
label which is the application that
defines it and a model name which is
photos in this case usually it's a
there's some legacy stuff going on here
but it's generally a lowercase
pluralized version of the class and you
can define what what each of those are
and it's a way of uniquely referring to
a particular type of content I find this
extremely valuable actually to be able
to talk about types of data in the st.
using the same language that you talked
about data itself it's extremely
powerful the next argument photo dot ID
that's assuming that there's a photo
object in my in my context here is the
unique key to use for the comment as
comments is the name of the variable in
the context you want it you want to do
it you want to load those comments into
so then for comment and comments display
the the comment objects the questions
you can turn commenting on for any
object that you want yeah you just put
this in the temp there's no there's no
switch to flip or setting to make once
this is in the template and allow calm
it allows comments and you can do things
you have the full power of the template
language so you can wrap this in an if
block if you want to you know
conditionally allow comments an example
is when we first we have an internal
debate about a year ago about whether or
not to allow comments on all news
stories and there's been some
interesting industry you know buzz about
whether or not this is a good idea
there's been some talk about sources
being reluctant to contribute to stories
because people will trash them in the
comments and we've seen that happen
there's been buzzed about reporters not
liking what people have to say about
their stories and we've seen that happen
but what we've also seen happen is it's
just an explosive growth in our user
community since we turn comments on
stories but what we noticed really early
on is that certain types of stories
don't deserve to have comments that the
one that really drove at home for me was
there was we living in the mid what
Midwest is interesting we cover little
league the same way that the New York
Times covers you know sports I mean it's
crazy we have we have player cards for
ten-year-old batters we send out we send
out videographers to tape nearly every
little league game and we run them on
the local cable channel we have
galleries we have a weekly print
magazine devoted to youth sports comes
out once a week we have a staff of three
people who work on this magazine write
crazy we published a story about just a
routine story about you know the ten and
under North West Lawrence girls lost to
the South East Florence girls and we and
we got just these comments on that story
that were just disgusting just these
people being I think we banned ten users
that day it was awful and we kind of
realized there are certain stories that
people should not be allowed to comment
on so the the conclusion to this long
rambling story is that stories now have
a allows comments field and our
producers will make a decision on
whether or not those stories allow
comments issue of putting children's
names and papers for being able to track
who they are and target them the
question is what about putting
children's names in papers when we do
the player cards it's always with the
parents consent and we generally our
general policy is not to publish
children's names the player cards are
really the exception and that's because
pretty much the parents want us to do it
yeah
what do you go through so how do you
manage schema evolution how do you add
fields to objects
the answer is stay tuned we have some
proposals about how to do it and we
actually have a student who is applying
for Summer of Code to work on that I'm
relatively sure that he's going to be
accepted because I'm gonna be making
that decision everywhere in every object
so how do you manage compliance
so how do we manage compliance about who
gets to post comments well basically
there's a User Agreement that people
agree to when they sign up this
particular example uses the free comment
object which is very similar to the
regular comment object except that it
doesn't have user fields we actually
require registration for all of our
comments since I'm running out of time
I'm gonna zip through a couple of things
real quick this is what it looks like
when you load a form this spits out a
little template that that has all the
fields for posting the comment and
there's built-in security to make sure
that people can't spam you by posting
you know to a particular thing and some
other clever details there that you can
look at briefly mentioned
internationalization and localization
Django's right now translated into 23
languages and including Welsh and which
thrills me to no extreme and more
hopefully on the way the vast majority
of the framework is is internationalized
and if you see places where they aren't
gets a bug and file it and there's
really nifty and user tools for doing
internationalisation get the
internationalization to support
pluralization correctly
internationalization to support
pluralization correctly I don't really
know I'd have to refer you to to Hugo
who is in charge of that I am a naive
American with no foreign language
ability um I'm gonna talk a little bit
just a teensy bit about what's in the
future for Django we have this merge
happening right now and we have a 1.0
release coming up as soon as we possibly
can and if you like Django and if it's
something that you want to use at work
or at home or to hack on please please
please help us get 1.0 out the door as
soon as possible 1.0 represents is going
to represent
for us API freeze code will be backwards
compatible as with Python
you know 1.1 1.2 1.3 etc we're going to
be very strict about that this is the
time now that we're kind of in a code
churn getting things exactly how we want
it to be so if you have input please now
is the time to do it in the further off
future we continue to use Django
everyday internally and we have a number
of grand visions for what the future
might bring including a redesigned admin
interface there's this dojo integration
which is happening right now and that's
going to bring with it eventually some
really slick ajax support but you got to
do the Foundation's first and we want to
get those right before we have things
sliding in and and the yellow Fayette
technique not only faster than most Java
and Ruby on Rails sites but faster than
most static sites I found that to be my
experience as well it's been a couple of
times when we've moved a bunch of flat
files into Django into database jungle
apps and it's ran faster this one
absolutely blew my mind this is one as a
math geek this is one impressive open
source project that shows or at least
seems to show that the people who
designed to really know what they're
doing it feels like opening up an ipod
box and reminding the packaging design
and button laya and that's from David
Asher the author of the Python cookbook
and other things as well I hate to rave
but this level of detail and usefulness
is unprecedented in my professional
experience especially in a free and open
programming framework at this point I'd
say Django is the winner in the lamp as
in Python space so questions at this
time
contributions Django project calm
well support for composite the Q
question is what about support for
composite primary keys in the in the
database model the the doesn't have it
right now I'd love to see it get in but
it's not high on any of our lists of
priorities I'd love to see someone
tackle the problem I don't think it's
particularly hard there's only a couple
of small issues that need to be worked
out about how how exactly it would work
well Oracle support being 1.0 so here's
the thing it's the the real stumbling
block for both Oracle and sequel service
support is actually limit clauses
because doing those in a way that
integrates well with the way other
database packages do it is actually
really obnoxiously difficult and we've
been hesitant to kind of hack up the
core parts of Jango to deal with the
really we especially sequel server
Oracle's not quite as bad as sequel
server is in that space but I think the
answer is yeah we're gonna you know hold
our nose and do it because that's that's
a big that's a huge group of developers
we'd love to to have working with Jango
any other questions
so do most people deploy with mod Python
and do I know of any other successful
deployment environments yeah
that's actually one of the the bits of
Jango that makes me really proud is the
deployment hives
you know high-end large-scale deployment
is super easy mod pythons the sort of
standard way that's the way we always do
it I know people who do also deploy
using fast CGI and either Apache mod fat
CGI or a light httpd I've heard good
things my experience has been dealing
with fast egi is kind of like it's
another set of server processes I have
to manage if I'm doing lighty and fast
CGI I have to have scripts to start and
stop lighty and I have scripts to spawn
my fast DGI instances I'd rather just
deal with them with mod Python but I'm
told anecdotally the speeds much better
with lighty and fast egi and you're not
in your head so chances are there will
be I will experiment further with it
right now we're using actually a pretty
complex setup where we have pearl bow
which is a load balancing software in
front of our Apache processes and that's
more than adequately solved any
performance problems we've been having
but you know as I'm sure as scripts
rolls out Jango for 15-plus newspaper
properties we're going to get some
interesting data about how to scale
Jango even larger than we use it what my
critique of Ruby on Rails I am it's
written in Ruby really if I hadn't come
to Lawrence and discovered Jango or if I
hadn't been elsewhere and you know seen
it open-source I probably would be using
Ruby on Rails listed today it's it's a
great framework it solves many of the
same problems that we have I don't
really have anything well I have bad
things to say about it but I won't we
will frame Chicago Python user group
back in November had Adrienne
David Meyer Hansen speak they're
side-by-side each presenting their own
framework so it's a good comparison -
I'll repeat that for the for the record
yeah there was a the Chicago Python
users group sponsored a meet-up six or
so months ago in Chicago where they
invited Adrian the other creator creator
of Django and and David Hansen to come
speak and they both presented their
frameworks and then they had a hour-long
kind of Q&amp;amp;A session with both of them
and it was videoed and it's online at
snakes and rubies calm if you want to
know more about how the to compare and
see them see Adrian and Dave David argue
about which is better you should go
check that out
yeah yeah it's yeah it's Naik's in
rubies calm if you just search for
snakes and rubies you'll find it
yes the question is are there are there
plans for more more full-featured WSGI
support so you so you can do things like
plug-in other whiskey components I guess
the answer is yes and no it Jango as it
runs now if you run it as a fast cgi
thing it uses whiskey if you run it as
mod Python it's got a custom handler
we'd like to get rid of that particular
duplication of code and so that the the
the dispatch goes whatever webserver you
using whiskey Jango in terms of
supporting other plug-in points for
doing things like other template
languages or other object dispatch type
things we'd like to support that within
django itself you already can if you
want to use a different template
language just in your view use a
different template language I know a lot
of people who are using Django with with
cheetah I think some people are using it
with with kid so you already can do that
as I mentioned earlier URL dispatch is
another one of those points that you
ought to be able to choose a different
package if you want to basically our
approach with most of those things are
we obviously think the defaults we've
chosen are the right ones but we don't
want to prevent you from from overruling
us there's there's a line between
opinionated software and obnoxious
software and we'd rather be the former
instead of the latter
yeah okay so the question is going to
talk about using Django with a legacy
database right obviously so there's a so
this is there's a command line tool
Django admin which is kind of your
central point for doing things with your
models Django admin sync DB is what
reads your models and apply and puts the
sequel into the database Django admin
new Django admins sequel which will dump
out to the to the console the sequel for
a particular model there's a command
Django admin in spec DB which will read
an existing database and dump a model
file for you to use my experience has
been that that model file needs to be
tweaked by hand sometimes the big pain
point is as you asked earlier with
composite keys if you if your legacy
database uses composite keys you're
you're Sol at the moment and that sucks
and we should fix that but for the most
part I've been pretty successful using
inspect dB the thing that some database
backends don't report don't report
foreign keys correctly so they come out
to to Django as just integer fields and
you have to go in and change them to
foreign keys to to make Django work
perfectly but it should be good to get
you up and running I know a lot of
people who are just kind of point Django
at a database to get the free admin
interface I love that and if it doesn't
work for you please file bugs because
that's one of our that's kind of what
our hot features that we want to make a
lot better database inversion are you
using which sequel database and version
am i using we use Postgres at work love
it absolutely love it
you cannot couldn't pay me to switch
we're using eight one three right now my
experience with Postgres is that the
dotto releases haven't been as good as
the ODOT one releases so I generally
wait until 8:01 8:02 to to upgrade but
there's some stuff coming into 8:1 that
will probably make me upgrade
or maybe it's a - there's some stuff
planned for future releases that are
that are I'm drooling over using a
certain Python adapter right now jingle
only supports psycho DB version one
we're gonna support version two once
they actually release it and and not
over there there is hasn't been an API
freeze we have no problem supporting you
know a beta version but they haven't
guaranteed that things won't change and
we just don't want to support that
there's been talk of a what's the other
one for Postgres yeah we talked of
support for that one and it's one of
those adding another database support
for a different database adapter should
be trivially easy we we don't use it so
we wouldn't really be able to test it
generally database support at this point
I use Django we use Django people within
the you know our core development
community use it with Postgres with my
sequel and with sequel Lite so we're
happy maintaining those but if you want
support for your if someone wants
support for their database you have to
commit to maintaining that I mean that's
the biggest reason why Oracle support
hasn't been checked in there are working
patches but no one willing to commit to
maintaining it and we don't use Oracle
and we're not gonna we don't want to use
Oracle so we're not going to commit to
maintaining it server and our deployment
I'll just I'll just sketch it out
briefly so about a year ago I saw a talk
by Brad Fitzpatrick of LiveJournal where
he talked about their server setup and
and if you've seen that talk or seen his
slides this is gonna sound and create
incredibly familiar we've got load
balancers up front right now those are
just just pearl Bell processes on the
same web server boxes because we're
ordering new hardware and it's being
shipped to us and those will eventually
be two boxes they'll be round robin DNS
going to the two of them those were on
pearl Bell and there was run memcached
and I've written a plugin for Pearl Bell
that will that will read cached pages
directly out of memcache and serve them
without hitting Jango the basic problem
you run into as you start to scale up
I've heard referred to as the
heavy or the the the spoon-feeding
problem excuse me light heavies the
solution to it the problem is that you
you actually Django is much much faster
than you can possibly push out to
clients before we were using load
balancing our web servers were like 99%
idle they were just sitting around
waiting for clients to read data so we
had to have hundreds of hundreds of
Apache processes and there's an eat up
memory and start swapping the Perl bow
the big bonus of Perl Bell is that it
will read the data from the backend as
fast as that giggy link between them can
process and then spoon feed it to the
client as the client needs it and
profile processes are extremely cheap
compared to mod Python and Django and
the database adapter is in etcetera etc
I find that's great we have a database
server on its own box and actually the
biggest piece of advice I can give to
someone trying to scale out Django is
the first thing you want to do is move
your static media to a separate box and
a separate web server you would not
believe what a big difference that makes
serving your static media from a box
running lighty
all off on its own it was it's night and
day
that's a huge huge boost even before you
move your database to a separate box do
I need to wrap it up or all right so
thanks everyone and I'm gonna stick
around here if anyone wants to ask me
questions so thank you so much for
inviting me to speak here</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>