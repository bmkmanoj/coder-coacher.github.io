<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>The Remote Agent Experiment: Debugging Code from 60 Million Miles Away | Coder Coacher - Coaching Coders</title><meta content="The Remote Agent Experiment: Debugging Code from 60 Million Miles Away - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>The Remote Agent Experiment: Debugging Code from 60 Million Miles Away</b></h2><h5 class="post__date">2012-03-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_gZK0tW8EhQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">we're on Garrett thanks um can I take a
quick poll before I start how many list
programmers we have in the room okay so
very least somewhat sympathetic audience
this talk grew out of a a little rant
that I wrote there was originally
entitled or subtitled the rise and fall
of Lisp at JPL this presentation was
originally given at a lisp users group
meeting so it was very heavily slanted
towards that topic for for this talk I
tried to de-emphasize that a little bit
make it a little less geeky a little
more general interest and as a result
it's come out a little disjointed not
quite as coherent as as it originally
was I'm gonna try to that are
dynamically adjust to the interests of
the audience I wasn't quite sure exactly
who was going to show up for this and
because of that so please feel free to
interrupt me with questions at any time
if I blast over something that you'd
like to hear more about so there are
couple of themes are going to run
through this talk of course that
autonomous control of unmanned
spacecraft which is what the remote
agent was about and under grading that
is some lessons learned about software
development methodology and the limits
of static analysis and in general limits
of writing software that is
mission-critical really needs to be
reliable we learned some very
interesting lessons about that and we
also learned some very interesting
lessons about effecting change in large
organizations and a few parenthetical
comments about Lisp we're still
remaining sort of set the tone for this
there I was doing a little research the
other night and came across this quote
from Machiavelli which is often cited on
the Internet
there is nothing more difficult to take
in hand more perilous to conduct or more
uncertain in its success than to take
the lead in the introduction of a new
order of things and usually the quote
ends there but if you actually go and
look at the original source
Machiavelli goes on and explains why
this is for the innovator has four
enemies all those who have done well
under the old conditions and only
lukewarm defenders in those who may do
well under the new it is only in
retrospect that I fully appreciate the
wisdom in these words leave it at that
for now so let me start the story by
taking you back to 1994 where to
paraphrase Bill Clinton the era of big
spacecraft at NASA was coming drawing to
a close these are the last two large
interplanetary spacecraft built by
NASA's Cassini on the right and Galileo
on the left the black one you can see I
don't have a laser pointer with me but
down in the in the lower right-hand
corner of the the Galileo picture and
down in the oh actually lower right-hand
corner of both pictures you'll see some
people for scale you can see there
they're the the size of multi-story
buildings and they weigh about two and a
half tons each the Galileo spacecraft is
notorious for having its high gain
antennae stick and one of the things
that's not much when they were tried to
open it it's stuck and they weren't able
to deploy it and one of the questions
that people often ask is well why didn't
they try closing it again and they they
weren't able to a lot of people think
that it's because the motor that drove
the antenna could only run one direction
that turns out not to be true the motor
could actually drive both directions and
during ground testing you could see the
antennae open and close open and close
like an umbrella the reason they
couldn't close it in flight is because
the switch that drove the motor in the
opposite direction was not part of the
flight hardware it was part of the test
rig so the because they figured we're
never going to have to run it backwards
once it's launched we're going to open
it once and then we'll be done so we
don't need the switch we can save a
couple of grams of weight
so the in in the mid-90s for reasons
that I'll actually get into more at the
end of the talk was becoming fairly
clear that mission multi-billion dollar
missions like this were no longer going
to be viable Congress was losing its
appetite for those kinds of price tags
and so director of NASA at the time a
fella named Dan Goldin initiated a
radical program of change called the new
millennium program and the idea was to
take an organization that traditionally
had been very conservative and very
leery of novelty and innovation and new
technology and try to drag it kicking
and screaming into the latter half of
the 20th century and try to reduce the
costs of missions by taking advantage of
new technologies and economies of scale
the slogan for this program was better
faster cheaper to which the the snide
response from the engineering community
was yeah pick any two but golden was
very charismatic and persuasive and got
this program off the ground the first of
what was originally intended to be a
long series of missions that we're going
to test out and demonstrate all these
new technologies was this mission here
called ds1 the new millennium missions
were originally divided up into the the
deep space or D s series and the earth
orbiting a series there have so this is
this is ds1 the very first new millenium
mission it's interesting because for a
number of reasons but the the most
visually apparent feature of the
spacecraft is that it has these huge
solar panels going off of your side and
then on the business end it has an ion
propulsion system just another drawing
of the main bus of the spacecraft with
the the solar panels folded up in the
launch configuration I won't get too
much into the details here except to
point out
this gadget in the the mouse oh yes yeah
yeah thank you
yeah this little gadget here the Sun
sensor it is exactly what the name
implies it to be it's a gadget that
tells you where the Sun is and the
reason that's important is because one
of the crucial things about operating a
spacecraft is that you have to know its
orientation so that it can point its
antenna towards Earth so that you can
communicate with it and in order for it
to figure out what orientation it's in
the easiest way to do that is to look
for the Sun which is the brightest
obviously the brightest thing in this
guy that will turn out to be important
later here are some some pictures of ds1
in flight the top picture this one here
this is a painting but the other two are
photographs and this one in particular
is interesting because it's a photograph
of the spacecraft in a vacuum test
chamber with the ion propulsion system
actually firing and this is really what
it looks like it's got this cool blue
glow that comes out at the end the way
in this gadget works is it takes we back
up a step and talk about how normal
chemical propulsion systems work by
essentially burning to chemicals and and
shooting the react the result of that
reaction out of a nozzle and the
characteristic of that kind of repulsion
is that you're using the same material
both for the source of energy and for
the reaction mass in an ion propulsion
system you have a different source of
energy from the reaction that's the
reaction mass is a tank of xenon gas
which is ionized and then sent in
between two charged plates and the
energy is provided by electrical energy
that's generated by these solar panels
and the it provides very low thrust but
it you can run it for very long periods
of time and over time they turn
not that ion drives are much more
efficient than chemical propulsion but
for you fans of Star Trek out there
there's a very famous Star Trek episode
where they they chase an alien
spacecraft by following the trail of ion
sometimes from its it's ion drive it
really is a real a real thing and this
is what it looks like there's a closer
view of just the ion drive unit itself
in a vacuum test chamber this is again a
photograph and I actually have a good
fortune of being able to see this thing
in the test chamber with my own eyes
this is exactly what it looks like with
this with cool with the cool blue glow
and everything
it's the xenon that's the xenon ions
coming out the back end so they this
thing here is is basically a just a
screen like you'd find on a screen door
and there's another screen behind it the
spacing between them is I think a couple
of millimeters I'm not sure about that
and you just probably put an electrical
charge between them and then you ionize
these the xenon gas and run it through
these screens and the electrical the
difference in electrical potential
accelerates the xenon pops out the this
side of the screen going very fast and
Newton then arranges for the spacecraft
to go the other direction this is a
photograph of the actual spacecraft with
again people for scale and notice how
much smaller the spacecraft is compared
to Galileo and Cassini in in terms of
numbers the contrast between the ds1 and
its predecessors was really striking
Galileo was 10 years it's approximately
10 years from inception to launch the
reason I say approximately is because it
was originally scheduled to launch in 86
but that was delayed for three years
because of the Challenger disaster and
it's actually some speculation that that
delay is what led to the antenna
sticking because in those intervening 3
years the the lubricants on the antenna
dried up and evaporated way 2 and a half
tons and cost 1.7 billion dollars
Cassini was 15 years from inception
launch wait about the same as Galileo
and cost 3.2 billion dollars and by way
of contrast ds1 was four years from
inception to launch or about a quarter
of the Cassini schedule weighed 373
kilograms which was about 15% of
Cassini's mass and this was the real
killer at a hundred million dollar
budget about three percent of the
predecessor missions we over ran that by
50 percent but still by NASA standards
this was a dirt-cheap mission as a short
incomplete list of some of the
technologies that were aboard there was
of course the the solar electric
propulsion and the the the solar array I
used to know scarlet was an acronym that
stands for solar concentrating array of
something I can't remember now there was
also something called Auto nav which was
a navigation system to let the
spacecraft figure out where it was by
taking images of near-earth asteroids
and triangulating its positions by
looking at the apparent position of
these asteroids against the star field
and a couple of other things a small
deep-space transponder
very monitor and a couple of science
instruments and of course the remote
agent the mission actually produced some
science return we we went to a comet and
an asteroid the comet was called Borelli
and the asteroid was called braille and
this image of Borelli is the image from
closest approach to still today the
clearest image of the nucleus of a comet
that has been produced to date you may
notice that the image of braille is not
quite so clear and there's a story
behind that to which I'll get to in a
little while hmm well yeah as ironic I
guess the irony of that name didn't
strike me until now but Jesse right so
the remote agent was a system for
controlling of spacecraft autonomously
without human supervision and the
intended benefit of that was to reduce
operations cost if you looked at the the
total mission cost operations cost or a
significant fraction of the total
overall mission cost and the goal of the
new millennium program was to make
flying missions a better faster and
cheaper and so one of the ways of
reducing the cost was to not have to
have as many operators on the ground
telling the spacecraft exactly what to
do there were three major components of
the remote agent there was a planner
called Europa that was developed by this
gentleman over here an executive and
execute a smart execution engine which
was just called exec that I was a lead
on and a diagnostic system or a state
model or called Livingstone that was was
worked on by Pandu Nyak who's sitting
over here and as longer than I had also
mentioned Jim Larson who is over here we
also worked on the railway agents at
least three people in in addition to me
in the room who worked on this project
and they're here to keep me honest and
as long as I mentioned
I should also say that I've been
challenged on my figure on how far away
the spacecraft was when the story I'm
about to tell you unfolded my
recollection was that it was 45 minute
light trip round trip light time away
and when you back solve that it turns
out to be 250 million miles but Nicola
here says that no it was only 45 million
miles so it's possible that I'm I'm off
or it might have been kilometres nASA
has a track record of so it was possible
that that number is a little off after
the talk I'm going to try to look it up
and see if I can pin it down one way or
the other but it was still pretty
freaking far away so the way that remote
agent was was organized was conceptually
very straightforward you had goals
coming in from the ground telling the
spacecraft what you wanted it to do and
the planner came up with a plan which
was given to the executive which then
executed it and took care of handling
unexpected contingencies like Hardware
breaking and there's a tight feedback
loop between the spacecraft hardware and
sensor readings coming back to the
monitoring system so that when you see a
sensory anomaly you can back solve
through a model of what the spacecraft
configuration is to try to figure out
what actually went wrong and how to deal
with it conceptually fairly
straightforward but the actual
implementation details certainly back in
the day were fairly challenging the
remote agent was written in Lisp there I
said it
I don't know how that decision is viewed
today and I certainly don't know how the
people in this audience think about it I
think that in the programming world at
large Lisp is now mostly seen as
kind of an obscure nichy language that a
few AI geeks maybe use but it's not
something that is is commonly used by
hackers today and and so it's not
certainly not the first thing that comes
to mind or that would come to mind if
you were going to do this today but you
have to keep in mind that this was the
mid-90s the state-of-the-art spacecraft
software was still being written in
assembler language in some cases and in
the case of Galileo and Cassini the
flight software for those spacecraft
were written in Hal s and ADA
respectively it's a programming language
that I don't know anything more about it
other than that it was used to write the
flight software for for Galileo and and
as far as I know hasn't been heard from
since there was no Python Java there was
no Java SEC was five years old which is
knew by spacecraft standards and C++ was
had been around for longer but it still
wasn't ready for primetime about which
more will be said later also at the time
there was still a vibrant list
development community at NASA there was
a lot of Lisp work that had been done up
to that point there was a lot of work
done on autonomous Rovers that were led
to the Pathfinder missions nearly all of
that work was done in list although
Pathfinder itself was programmed in C
there was something called the
spacecraft health automated reasoning
prototype which was a ground-based
diagnostic system similar to the
Livingstone system the flew on the
remote agent and a whole bunch of other
things there was a spacecraft sequence
generator called planet - there was a
software patch generated for the Galileo
magnetometer that was all the code for
the magnetometer was written in forth
and they had a memory byte
bad in the middle of its two kilobyte
Bank of a program of code space and so
they had to figure out a way to recode
things to work around this bad byte of
memory and the original development
system for this instrument had run on an
Apple 2 which had long since been
decommissioned and so the way we fixed
that problem was basically recreating
the entire fourth development system in
Lisp so that it could run on a Macintosh
and that's what makes another
interesting story but for another time
and some other things so the use of Lisp
at the time was controversial but not
completely outrageous not quite as crazy
as it would sound probably sound today
now there was a fourth component of the
remote agent which turned out to be sort
of the remote agents bastard stepchild
and I don't mean that to sound as
disparaging as it came out especially
Reed Simmons if you are listening to
this or ever see this on YouTube I'm
going to try to present this story as
objectively this part of the story is
objectively and if as soberly as I can
if I fail I apologize there was quite a
bit of emotion associated with us in the
day and some of that is hard to let go
of so TCA is was another autonomous
control architecture TCA stands for task
control architecture was developed at
Carnegie Mellon University by a fellow
named Reed Simmons and it had two major
components there was something called
TTL or task description language which
was a language for describing giving
instructions to a robot to be executed
by a smart executive that could deal
with contingencies and there was also an
IPC an inter process communication
component that had nothing to do with
autonomy or or intelligence or anything
even really interesting from a research
or even a technological point of view
but they built it because at CMU they
were running this code on multiple
processors and they needed some way of
doing inter process communication and
there was nothing available off the
shelf at the time and so they had to
roll their own the IPC was something
that basically fill the same niche as
Google protocol buffers do today but of
course we didn't have those back in 94
or we might have used them now there was
quiet
at least early on about what components
were going to go in to the remote agent
and we were given marching orders that
Carnegie Mellon had to have a role of
some sort in the development and so in
in the course of the the resulting
design discussions there was a conflict
between TD Elvis ass description
language developed at CMU and exact the
executive which also had a competing
language that it was written in called
ESL or execution support language and we
couldn't use both they filled the same
role had to choose one or the other
and the politics there was a lot of
emphasis on trying to spread the work
around as many different NASA centers as
possible in the hopes of getting as many
different centers on board with the
whole program of inducing major change
at NASA it was believed probably rightly
in retrospect that if any major player
was shut out that they would oppose the
entire new millennium program and that
that opposition would result in the
program failing and that was very likely
true so TDL and ESL were competing and
IPC was competing with something else
that was available at the time called
korba just called the common object
request broker an architect architecture
does anybody here know remember korba oh
wow it's I'm shocked does anybody
actually use CORBA anymore okay that's I
were up for my worldview is not rock one
of the things that I remember most from
my days at Google back in the early days
was reading the the guidelines for
interviewing new job candidates and it
had some things to look for a sort of
yellow yellow flags and it said you
should ask them how would you do this
and this and this and this and if they
mentioned the word clora but don't hire
them
and that was one of the reasons I knew
I'd come to work at the right place
Corbett didn't have an advocate at the
proceedings and I PC was competing with
it and so sort of by default we ended up
with an architect looked like this where
we had the planner and the executive and
the monitoring system that were all
written in Lisp and running in the same
Lisp process but were forced to
communicate with each other through this
inter process communication system that
was written in C and was buggy in crash
groan because it would been developed at
a university by students and was
designed to run on research rovers where
something went wrong you just reboot
them unfortunately that wasn't the end
of our problems because our new process
communication system was written in a
language other than what the application
code was written in we had to have the
data be marshalled serialize and
deserialize in order to communicate
between the two languages now I the TCA
IPC supported that but it had its own
data description language and it had to
be kept the the the data structure
descriptions in the data description
language had to be kept manually in sync
with the dot H files for the C code in
the main lines in the spacecraft control
code that we were communicating with so
we now had three different descriptions
of data structures that had to be kept
manually in sync we had the the TCA IPC
code we had the odd H files for the C
code that was in the spacecraft control
code and we had the list data structures
in the RA and of course keeping those in
sync manually was a horrible mess and so
a fellow named Bob kinetic he built a
tool
that tried to parcel it out H files and
generate automatically generate the DDL
and the list data descriptions this tool
was also an acronym that I can't
remember what it would have stood for
but it it had the also unfortunately
ironic name of clash and because clash
was a hastily developed one-off tool it
also had lots of bugs and problems and
so we now had two different external
tools that were injected into this very
highly accelerated development process
for a spacecraft control system that had
never flown before yep they so I
actually don't know enough about though
the question was would protocol buffers
have solved this problem Jim says if
they'd been invented at CMU they would
have they certainly if we had had access
to protocol buffers as they exist today
it certainly would have helped because
protocol buffers are in use in a
production system and hence more
reliable than the IPC system was when we
started using it because it came from a
university research project so in that
particular in that respect it would have
helped I don't know enough I've never
actually used protocol buffers myself I
just did a little bit of look up the
name last night I am
understand that they have bindings to
lots of languages and so I suspect that
that also would have helped a lot in
just the fact that it's designed in a
way the specifically intended to bind to
lots of languages would have helped so I
strongly suspect that the answer is yes
but the only way to know what for sure
of course is to try it
oh okay yeah it's alright I has just
been pointed out to me that I got some
of my terminology wrong here a DDL was
another part of the system GDL was the
domain description language for the
planner it's a planner right yeah
the did the data description the data
description language for the IPC has
some other name and I can't remember
what it is but that clash didn't handle
that it was okay some of my memories of
this are fuzzy okay and in case the the
the details here don't matter much what
what matters is that the politics of the
situation drove the inclusion of this
component of the architecture which
drove the development of this tool which
turned out to be difficult to use
because it was developed hastily didn't
really have time to mature and so after
two years of working on this we had
something that was kind of sort of
working but it was crashing all the time
and and and the development cycle was
very slow and it was clear that we were
slipping our schedule and our budget and
people were starting to get very tense
and it didn't help that all
this AI technology and Lisp and all this
weird software sort of stuff was viewed
with extreme suspicion by the spacecraft
community from from the get-go and so in
1996 ish there was a design review a
critical design review which is a term
of art its formal part of the spacecraft
development process and he consisted of
about 50 or so top NASA managers all
gathered in a big room very similar to
this one and all of the area leads for
the mission presenting giving updates on
on the current state of things and one
of the people who presented was the lead
software integration engineer and his
report was that the project was a
shambles
nothing was working everything was
behind we were we were heading for a
train wreck and at the end of a
half-hour long exposition on exactly all
that all the different things that were
going wrong one of the managers in the
audience finally got fed up and said
okay if you could do one thing that
would help improve this situation what
would it be and his answer was get rid
of the remote agent those weren't his
exact words what he actually said was
get rid of Lisp I'll just leave that
leave it at that that's what he said the
result was that the remote agent got
downgraded from the mainline flight
software we originally going to run the
spacecraft for the entire mission and a
couple of weeks after that design review
the decision was made to downgrade us to
a flight experiment and to replace the
main life flight software with a port of
the software that had run the the Mars
the Mars the first Mars rover mission
the Sojourner the Pathfinder mission
there was also some attempts on the part
of the the remote agent team to address
this concern that that Lisp was a source
of problems and there was attempt made
to rewrite the planner in C++ which also
had to be abandoned after year because
it turned out that C++ was not quite
ready for primetime it was the situation
they are since has has obviously
improved marketly but back then trying
to find a reliable compiler for c++ and
in particular reliable compiler that had
a back-end for the flight processor
turned out to be impossible didn't exist
but it took us a year to learn that so
all this sets the stage for the story of
what actually happened on the mission
and and the sort of frame is I'm going
to go back over and review the
chronology very briefly so the whole new
millennium program was announced in 94
the critical design review happened
about two years later around 1996
ds1 was launched two years after that
October 24th 1998 and it's probably a
good thing that we were downgraded
because the remote engine software was
not ready when the spacecraft launched
it had to be uploaded later in February
of 1999 and then in May of 1999 the
remote agent experiment actually ran we
controlled the spacecraft for three days
and then in July of 99 and September of
2001 we did our Comet and asteroid sorry
asteroid and comet flybys and the most
salient feature of this chronology is
that they actually let us run the remote
agent experiment before the science
experiments which in retrospect was an
amazing show of confidence on the part
of NASA because we could have lost the
space there by turning us on we're in a
position
that if something went wrong we could
have lost the spacecraft and the fact
that they didn't wait until after the
science was in the bag to run us I think
was we didn't really appreciate it at
the time but in retrospect it was an
amazing show of confidence it is I just
point that out to show that NASA as an
institution is not always inherently
averse to taking risks so the mission as
a whole had lots and lots of issues it
was really a testament on the one hand
to NASA's ability to perform under
extreme pressure because the mission was
not an omitting aided disaster it worked
and we got all of we didn't lose the
spacecraft and and we got some science
out of it and we demonstrated all of our
technologies but it was also a testament
to Murphy's Law because lots and lots of
things did go wrong when the ion engines
were first fired up they powered
themselves down after four minutes
turned out that what had happened was a
little grain of sand residue from the
chemical propulsion engines that in
injected that that launched the
spacecraft got stuck in the little
screen in between the two little screens
and caused them to on the ion drive and
cause them to short out the mainline
software that the the supposedly
reliable backup software that was
inherited from the Pathfinder program
crashed 48 hours before the Braille
bye-bye this is of course after racks or
access nothing had nothing to do with
that but that was the reason why the
image of Braille was was so fuzzy it was
a heroic effort to get the spacecraft
back in operational mode in that short
amount of time the fact that they were
able to get a picture of it at all it
was really amazing the star tracker
which was the one piece of hardware on
the spacecraft which was not a new
technology demonstration it was
supposedly old reliable Hardware failed
shortly after Braille and again another
heroic effort on the part of the space
craft team was able to repurpose one of
the science instruments in order to in
order to get the spacecraft back to the
point where it could figure out what its
orientation was and then finally there
was was the the central topic of this
talk which is the racks bug so
reliability of all the software in the
space so it's extremely important rear
control going to control an asset that
had 150 million dollar investment behind
it which by NASA standards was dirt
cheap but still seemed like real money
to us at the time and if you screw
something up you can't just go into the
Machine room and reboot if the
spacecraft loses its sense of
orientation and there are lots of ways
that that can happen and it doesn't
pointing a Santana to earth and you've
lost all communications with it and you
can't and if if the spacecraft isn't
able to on its own figure out what's
going on and get itself we're headed
back to earth and you've lost it you've
lost this hundred and fifteen million
dollar asset so racks along with all the
other flight software was extensively
tested for months and in addition to
that we actually did a formal proof of
correctness of certain aspects of the
software and in particular the exec was
an Allah was was underwent the static
analysis using a tool called spin which
does static analysis of multi-threaded
code
and was formally proven to have certain
desirable products certain desirable
features most notably being free of
deadlocks so we ran for three days in a
heavily scripted scenario so we knew
ahead of time exactly what was supposed
to happen despite the fact that the
spacecraft was operating autonomously
and on the second and so for two days we
were listening to telemetry coming back
from the spacecraft where it's telling
us this happened and this happened and
this happened and everything's lining up
according to the script and then on the
second day 48 hours into the experiment
there was an event that we was supposed
to happen that wasn't in the log and so
Red Alert was called all hands on deck
and I got to experience firsthand what
it's like to deal with a spacecraft
emergency there's a very interesting
process because you now have this very
expensive asset very far away the
round-trip flight time is somewhere
between 10 and 45 minutes depending on
who you ask and so everything that you
do has to be thought out very very
carefully and there is this elaborate
procedure and protocol for deciding
exactly what it is that you're going to
start out with the engineers who
actually wrote the software all gathered
in a room trying to brainstorm trying to
figure out what's going on what should
be the next thing to do and of course
the first thing we wanted to do was to
gather up some more telemetry
information to figure out to actually
find out what happened so then that
group of people comes up with a proposed
plan of action which then goes through a
number of layers of management that are
progressively further removed from the
technical details and therefore
progressively less qualified to actually
assess whether the plan that's being
proposed by the engineers is actually a
good plan or not and then finally the
plan ends up at the console of the
person who actually types the commands
into the
the terminal that's that's hooked up to
the deep space network that actually
communicates with the spacecraft and
everything mapper and that person
actually has almost no clue of what's
going on because what their job is is to
just deal with this interface and they
are an expert at the vagaries of the
particular UI of this legacy system that
was originally developed back in the 50s
and 60s so they're told what to what to
do when they type it in and they do it
and everything that to do is recorded
and they have their they're wearing a
little microphone and they go through
the kind of procedure that you imagine
that you see in the movies where
somebody says you know ready ready for a
system upload and and somebody else in
the room says just you know go for
system upload and the operator typed
something and this is the only person
who actually has their hand on the
button so to speak but but all of this
all this formality is there because if
it doesn't work they want to be able to
go back and do a pour smoke pour a
post-mortem and figure out what went
wrong and that's why there's so a null
about recording every little every
single thing that was done and said and
every keystroke that was entered so the
problem turned out to be a race
condition and dues deadlock which we
were able to find and fix in large part
because we had a read eval print loop on
board and because we had a read eval
print loop on board we could upload code
on the fly that for example that that
did things like look through the state
of all the semaphores and all the
processes not and don't remember exactly
how many round trips it took it was two
or three every one of which went through
this long elaborate process before we
convinced ourselves that we understood
what the problem was and decided on a
plan of action that that would unlock
the deadlock and let the experiment
continue which we eventually did
initially they
parent proceeded and and everything was
hunky-dory and we eventually were were
awarded a prized we renamed NASA
software of the year for a 1999 but this
raised an interesting question which is
that how is it possible that a system
that was ground tested for months and
had a formal proof of correctness that
there could not possibly be a deadlock
nonetheless have a deadlock in
production and the answer to that turned
out to be twofold first is that we just
got unlucky in in the post-mortem
analysis we figured out exactly what
happened and it was an event that was
very crucially timing related and the
clock on the flight computer was very
slightly different than the clock on the
bench ground computer that that all the
tests had been run on and so the
probability of hitting the exact
sequence of timing that would lead to
this deadlock turned out to be just very
slightly higher on the flight system
than on the ground system and we got
unlucky I don't remember what the odds
were against it they were pretty heavily
against us but we we managed to discover
this bug anyway it's probably a good
thing because we wouldn't have learned
this lesson otherwise it's a very
valuable lesson to learn because the
other thing that happened was that the
next question is well how is it possible
that this situation exists after this
formal proof of correctness so one
possibility is that the proof system
that was used to prove correctness would
actually had a flaw in it that turned
out not to be the case something much
more prosaic than that does anybody care
to hazard a guess
hmm well obviously yeah obviously some
assumption we're wrong what's wrong but
which assumption
what know it revealing visuals of not
one of our problems they're very anal
about that very careful about making
sure that you fly what you test and test
what you fly that's all part of this
what we at the time found to be
burdensome bureaucracy so what now
that's right the code what's your name
oh okay another this this is the guy who
actually did the analysis sorry I didn't
recognize I don't think we've ever
actually met before
okay well it's great to finally meet you
yeah so so the executive was was
designed as a layered system there was
this core kernel that provided all of
the core functionality and that's the
part that was analyzed and proven to be
deadlock free and then layered on top of
this kernel was the application code and
the assumption was that because the
kernel was deadlock free that the
application code would be deadlock free
as well but what happened was that the
application engineer who wrote the
application code encountered something
that he had to make work that he
couldn't make work under the constraints
that were imposed on him by the design
of the kernel and so he wrote a little
bit of code that worked around this
problem and that little bit of code that
worked around this problem turned out to
be the source of the deadlock and this
is interesting because it it's it's a
problem that is I don't see any way to
solve this problem because even if you
have a formal proof of correctness
unless you have a formal proof of
correctness of every single line of code
in your system which is
certainly impossible given the certain
the current state-of-the-art and
probably impossible in general given the
halting problem you're you're going to
have to deal with situations where a
coder has done something to work around
an issue that inadvertently in all
innocence violates one of the rules of
the road that you have to obey in order
for your proof of correctness to be
valid and I think that that is very
useful lesson for all software engineers
to keep in mind particularly when they
have debates about the the relative
merits of static versus latent typing I
won't say anything more about that
version so the the aftermath officially
rax and in fact the ds4 the entire ds1
mission was a success
it worked mostly we didn't lose the
spacecraft which was a big a big feather
in okay we flew the very first but not
the last read eval print loop the all
the the Mars rovers have used an
operating system called vxworks which
has a rudimentary sort of read eval
print loop people here would call it a
shell but it's it's interesting because
in 2004 the I forget which rover that
was one of the Rovers wasn't Sojourner
was Peter do you remember which one at
the deadlock any case the the exact same
problem with a spirit okay had almost
the exact same problem encode that had
absolutely nothing to do with a remote
agent had nothing to do with Lisp it was
just straight-up C code written by
spacecraft engineers and almost a point
for point replay of thorax deadlock code
was tested out the wazoo analyzed
sowas whoo still deadlocked they were
able to save the mission again only
because they had a repple on board and
they were able to figure out what was
going on and give it a kick start
unofficially though at least from the
point of view of most of the people who
worked on it it was a disaster it was it
was not the launching pad to long
successful glorious careers for at least
not for anybody on the on the racks team
there's some of the spacecraft engineers
who are still working on spacecraft
there and from my personal point of view
as an advocate of Lisp and somebody who
believes that get a lot of leverage from
using that programming language I find
it very unfortunate that that was the
end of Lisp development at JPL and at
NASA no listen nothing has been written
in Lisp but NASA since as far as I know
certainly not any flight software but it
was it was a bigger it was an even
bigger failure than that I was having a
discussion with Nikola the other day
sort of reminiscing about this and came
to the realization that the entire new
millennium program that whose vision was
a future NASA that was flying small
cheap missions in large quantities in
order to take advantage of economies of
scale that didn't happen mm-hmm and this
is the most recent unmanned spacecraft
that's under development by NASA today
this is the mark the the Curiosity rover
also known as the Mars Science
Laboratory and notice the the people
over here for scale this thing is the
size of an SUV weighs a ton literally a
ton 995 kilograms it cost 1.7 billion
dollars to develop
and I will personally be surprised if
this is not the last unmanned spacecraft
that NASA ever flies
NASA is as an institution is is is in
decline there's a lot of talk about
replacing the shuttle resurrecting the
manned program but obviously not very
much actual progress in that regard so
the new millennium program in some sense
can be viewed as as a deep systemic
failure of NASA to in in this attempt to
reinvent itself and also other attempts
that have been made at NASA for example
the idea of permanent base on the moon
or a manned mission to Mars all these
other big ideas that were supposed to
drive change and drive the institution
into the 21st century none of those have
come to fruition either and I think that
it's instructive to at least speculate
about why that is so I was thinking
about this and here's some of the things
that didn't go wrong there's some
obvious candidates here but we did not
lack support from upper management it's
not like we were some Young Turks who
were just trying to inject change into a
large bureaucratic institution from
below and got stomped on that was
absolutely not the case we had support
at all levels of NASA management
including the very top is the NASA
director was was the initiator of this
thing and and again I pointed to the
fact that they flew us before they did
the science experiment as an
institutional vote of confidence for for
the technology so that wasn't it we
didn't lack technical expertise we
didn't fail because we were idiots oh we
did something incredibly stupid we did
bump up hard against some of the
fundamental limitations I think of some
of the fundamental limitations of
writing very complex mission critical
systems under tight budgets and
schedules but the bottom line is it it
basically worked
we did like spacecraft training all of
us on the remote Asian team essentially
knew nothing about spacecraft when we
started out but we learned on the job
and and by the time we were done I
wouldn't necessarily say that we were
rocket scientists but but you know we we
could hold up our end of a conversation
so so what did go wrong and I found that
it was very I think I know what it was
but I found it very hard to characterize
put into words without miss
communicating so here's the best I could
come up with gradually came up with
something like what we lacked was
political savvy sort of harkening back
to that Machiavellian quote at the
beginning of the talk but that wasn't
really it either it's not that we didn't
do the right wheeling and dealing
although if we had done that things
might have turned out differently but
there were people on our team who did
have political savvy again we had
supported all levels of NASA management
which is not to say that there weren't
people along the way who were opposed to
what we were doing there were but it's
not that the power structure was against
us and it's not that we didn't have
people on our side who understood how
the power structure worked and and how
to manage it but here's where I think we
went wrong we focused on technology and
economics and coolness we said all right
NASA has this mission of reducing its
costs which seems like a reasonable goal
and we have a technology that can reduce
costs and oh by the way it's a really
cool thing and that's a kind of prize
itself on being an institution that does
cool things and we thought that those
three things would be enough to propel
us to success and that turned out not to
be the case because we as we we assumed
that our users and our users ultimately
for our system were the people who
operate spacecraft our tool was a tool
that was going to make spacecraft
operators more productive so that you
could take a team that before could
operate only one or two spacecraft and
let them operate
10 or 20 and we assumed that everybody
would agree that that was a good thing
and that turns out not to be true
there's one very crucial group of people
who did not think this was a good thing
and that was the operators because what
they wanted with job security you think
about this from the point of view of
somebody who's made their career as a
spacecraft operator they have spent
decades acquiring very specialized
knowledge that's nearly impossible to
transfer to any other field and so to
them we were not a liberator we were not
people who were coming in there to make
their jobs easier we were people coming
in there to make their jobs go away and
they pushed back and so my theory about
why NASA is having problems is that they
are having the exact same problem as we
had that they're failing to understand
the needs of their users because NASA
everyone thinks NASA is about space
exploration but it isn't it's never been
about space exploration it was first
initiated it was all about eating the
Russians and then it sort of morphed
into being about a way to to route pork
into key congressional districts and so
ever since the fall of Soviet Union in
1991 the institution has been rudderless
and I think it's it's not a coincidence
that the followers of a union in 1991
marked the beginning of the end if you
look back in retrospect of NASA's
clarity about its role in the world and
what it's supposed to do and how it's
supposed to do it and no one has been
able to really articulate a clear
mission for the institution since then
which is very unfortunate because it's a
tremendous national asset it's it's it
really is this group of
uniquely smart people and physical
infrastructure and domain knowledge and
the fact that we as a nation have not
been able to figure out a way to make
effective use of that asset for the last
20 years I think is really an indictment
of us as a nation and its citizens I
promised myself I wasn't going to say
anything controversial in there I've
gone and done it so I'll just close with
this with this closing thought that the
hardest part of giving the customer what
they want is figuring out what it is and
you can you can see this lesson again
play itself out again over and over
again the the most prominent recent
example that people cite of Steve Jobs
Steve Jobs is genius was in being able
to figure out what it is that people
want and even he wasn't always able to
figure it out not everything that he
touched turned to gold in fact he had a
lot of flops the Apple 3 and the Lesa
most notable among them it took him a
while to figure it out too but it's an
important thing to think about and put
effort into and to be aware of because
if you get it right you can really win
big
yeah question the back where is the
spacecraft now I don't know it's out in
space somewhere it's in solar orbit but
exactly where I don't know that there's
there's almost certainly a webpage
somewhere in in the NASA website that
will give you its current orbit but it's
at the the mission has come to an end so
they're not communicating with the
spacecraft anymore as far as I know and
so you probably I don't know I would
have to look it up but if you go if you
go just google for you know ds1 current
location if it exists and then then
you'll you'll find it that way and if
not then you can go find what it's orbit
was when they turned it off and and you
know just run complain mechanics on it
from there to figure out more or less
where it is now yeah it was a tough sell
how how was the line drawn between the
back up try to rephrase this given that
we were writing mission critical
software and we're bringing in lots and
lots of code that had been written by
other people for other purposes how do
we draw the line between how do we
decide how much to vet this outside
software so that we would get to the
point where we felt confident betting
our spacecraft in our career on the
reliability of the overall system is
that a fair Restatement
and the answer is that it was done in a
very ad hoc manner the up until new
millennium the processes for making
those kinds of decisions were very well
established they had evolved over the
course of of decades of lessons learned
often by having spacecraft blow up on
the launch pad and new millennium was an
attempt to dislodge all of that sort of
in one fell swoop and so we were kind of
making it up as we went along and what
we ended up with was a mishmash of of
intuition and experience and empirical
testing and formal analysis and a wing
in a prayer to no small extent if we'd
had more time to work on it we probably
could have come up with something better
but again you know inception to launch
for for for this what was really a
radically new thing in terms of
architectural design and budget and
schedule that was really tight and the
fact that it were that it worked at all
in retrospect is miraculous yeah so I
think if I were to go back and do this
over again what I would have tried to do
was not to try to deliver something that
users wanted but to go and try to win
the users over to our side try I would
have tried to market them more and make
friends with them and and give them
demonstrations and and kind of hold
their hands and show them how this was
would be a path to a better world for
them
we didn't do that I don't know if we had
tried that if we would have worked or
not but but we didn't really do a lot of
outreach and and I think that was that
was probably a crucial mistake in our
defense you know we had a lot of other
things on our plate and didn't really
realize except in retrospect how
important that would turn out to be but
that's I so I actually had a backup
slide here which is some advice to
recognize that if you try to innovate
it's always disruptive again go back and
reread that Machiavelli quote
that you will you will always if by
definition if you're innovating you're
going to be stepping on somebody's toes
and you should find out who that is and
do something about it don't just ignore
it either schmooze them and get them on
and win them over or find a way to to
get them out of the way but but don't
just let them sit there and and grumble
because they can make you fail
good could NASA have been a better
institution at the strategic level yes
they could have been better by by
applying the same heuristic sort of in
the large NASA proceeded on the
assumption that its mission was at least
in part to do scientific exploration of
the solar system and it wasn't not and
isn't notwithstanding the fact that
people say so and even people who are in
positions of a sort of authority say so
there are lots of things that
politicians say that aren't true and
that's one of them and so I think NASA
could be better at recognizing that this
isn't true and either working harder to
make it true come do a little bit more
outreach to its ultimate users which are
the American people do a little more
more marketing it's a little bit weird
because NASA is constrained by the fact
that they're funded with taxpayer
dollars in the you know like they can't
buy a Super Bowl commercial at least I
don't think I think that there's
probably some government regulation that
says they can't do that but they could
probably do better at convincing the
American public that what it does is
worthwhile and that they're worth or at
least they have something to contribute
even if it isn't exploration of planets
maybe it's something else but something
that the American people could really
get behind and get enthusiastic about
writing checks for I haven't really
given that a whole lot of thought if you
a question was have I given that you
have any ideas as to what I haven't
given that much thought I could probably
I don't know if somebody give me an hour
or two I could probably come up with
something but having it say I haven't
give it a lot a lot of thought
because I don't think that my thinking
about it is going to help anything
because I don't think that the problem
is a lack of ideas the problem I think
that convinced if there are tons of
people out there actually much more
qualified at coming up with good
missions for NASA the the problem I
think is that NASA as an institution
doesn't recognize this fundamental
problem that it doesn't really have a
mission and that that's what it needs to
be working on what would I put on the
next spacecraft Lisp or Python oh boy
that's a very tough question I actually
do most of my coding nowadays in Python
but but every now and then I go back and
I write some Lisp and and when I do it
it makes me cry because I just envision
what the world would be like if certain
things had gone slightly differently at
certain key junctures in history and
there's one particular episode at Google
that falls in that category which I will
tell you about after the recording stops
that that if things had gone differently
I think the world would be a better
place but you know you got to you got to
play the hand you're dealt and in
today's world software development is
much more of a team sport now than it
ever was before and all else being equal
I still prefer lists but all else is not
equal and so if I have to write
production code today I regretfully
arrive at Python that's up to you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>