<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Using open source tools for performance testing | Coder Coacher - Coaching Coders</title><meta content="Using open source tools for performance testing - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Using open source tools for performance testing</b></h2><h5 class="post__date">2007-10-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/KQ-wm3rW8_c" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">face for the makeup
he promised answer that he'll come up
with something unless I send them to
self in time so it's definitely morning
15 you know what I actually do but so am
I talking about can be slightly
different because I've looked at all the
talks yesterday I think majority people
coming from the perspective of
developers and how do we do I'm a QA
engineer and I truly want to do QA and
I'd love to Purdue I decided well first
being overworked and underpaid is just
no no it's got to be and the second
thing is I wanted to know about the
software suck I'm an engineer and
religions don't follow daily basis
people get through anointed the cards
blow up so why is it okay for my
Cristofori to crash on the 15 times a
day and yet when Pentium bug had
problems and abandoned ship had a
problem everybody was up in arms and
they wanted their chip equation what's
the difference between a piece of
hardware and software - hardware can
expect it to work and like a software
sock and if they actually have answer
for that but the topic of today's
presentation is slightly different and
it's a really accurate presentation so I
don't have a new mark I don't have a new
infrastructure but what I really want to
focus on is how do we use existing
pieces in getting something as important
as before assessing that and one of the
things that I should also mention ahead
of time is very strong UNIX bill of UNIX
for a long time and part of the reason I
joined Google was that after couple of
years of being occluded by my friends I
realize that people are weak is there
and anybody who hates PowerPoint as much
as I do cannot be a better person and
the place for Heroes has to be replaced
so this is the first PowerPoint
presentation ever I need to apologize
for it
it's probably the last one I will ever
do but
moron to a performance testing right so
who has an interesting problem right
obviously be the launch things all the
time quite often I will get an email
saying actually the law suppose like at
4:00 p.m. saying okay we want you to do
some performance test why bother
I'm sure it's good I'm sure you guys can
see some of the results of inference
like that but you generally getting to
the point that solving the problems
banging on machines is just contrary to
our mission statement which is let's
let's try to conserve resources make
sure you can always start our machines
at it but eventually run out of space
using too much like there's a day it's
just the wrong thing to do
so what I'm going to talk about today is
first a little bit about terminology
because performance testing at least
since I've left a t-tail a heads I'm not
dissing it don't don't even have
terminology standardized so I'm going to
say what I mean that I'm talking about
performance testing or a liability or a
scalable or anything else because
typically people come to me and say like
hey I need to do this testing I think
I'll go ahead so what do you want right
performance testing okay so give me more
and and there is never anything coming
back and I think useful
let me start so then I'm going to talk
about why bother you know I mean why why
have you been interested in testing
performance mentioned a little bit about
tools and I didn't want to say I have
very strong opinions unfortunate
language goals so they give me the grain
of salt right everything is coming from
my perspective and we'll give you some
examples of between the panic will go on
hopefully all the proprietary
information taken out if you know
I won't be working here and by Qwest I'm
gonna say how do you start performance
testing because I actually don't think
this is very hard I mean it's really not
that difficult at all I think it's so a
lot more is made out of it's actually a
fairly simple process and then I'll open
it up for questions and hopeful answers
so let me talk about first of all what I
consider performance that's it so
anytime you're on a test and you're
actually measuring concretely system
responds to the workload that to me is a
performance test alright so in the sense
you are in question given the load X how
fossil the system returning the result
right but the important thing is I'm
really interested in that time that's
what I'm measuring like in the case of
the stress test well I'm really more
interested in a cement on the system
fail and how it's bad I don't
necessarily care about how positive
spawns times are but what I really
wanted to know if I can look low to
build a system failed and hopefully it's
gonna go so basically I mean I really
don't want it to go up into people's
faces locust for me means I'm looking
circle of in the system and what I want
to find out over-prepare that kind of
hollow the system behave typically the
low that you're talking about is
reasonably high load right so you know
if I'm putting one query a second on a
Google system you know it's yeah it's a
low test and I can call this purpose of
it you know it's not going to give me
any results but in general from a notice
I'm going to mention that later on the
thank you is about 80% of the of the
maximum wall that the system can handle
and single density running the system
at one period of time one of the things
that we typically focus on it googling
they trying to benchmark all of our
properties is basically create
benchmarks for any particular feature
any service that we have and then
concentrate on and convenience that our
benchmarks to understand how the code
changes and evolves over time and so a
benchmark test most important to us is
as slices it's simplified it's
measurable and it's repeatable right
those are the three things that are very
important to me and in general the so I
like benchmarks that they use right
they tend to be misused and in the world
because typically the vendors will use
benchmarks to game the system so that
they will sell you their product is it a
book on PPCC we use so much better than
X company and if you use them in that
way the new completion is using what the
purposes but basically the benchmarks to
ask me is let's try to figure out who
the customers are what the users are
going out in the real world and then
let's extract some subsystem or subset
of those operations that we can
reasonably easily create that reasonably
well what represents will behavior of
the system and then every single time
when you make a cock change what's not
that benchmark and find out the
deadliness of the system to the point
that it's unusable or it's something
really changed the management so we tend
to do a lot of Hedgehog testing
now tied into this and typically when
people are talking about performance
testing but they really interested their
scalability testing and a little bit of
performance profiling and scalability
means eat my Aneesa particular research
so for example on a typical system where
I may have clients and that sub contents
and a little bounce in front of ever
that Bank hence the Sun well what if I
have five fun things as opposed to ten
or as opposed to 15 they fight for that
with a number of fact that is how they
like through exchange or if I double the
memory the machines how will the change
or one vendor processors so some people
are able to be changed increased or
decreased and I won't understand how
does it affect the performance of the
system performance profiling is
something that the testing group at
Google doesn't do much of because it's
usually very development and what we
have found out is that typically they
can they remove eighty percent of the
problems with the testing effort rofling
tends to believe tedious expensive
fairly difficult to running on a
specially instrumented code and you
really want to do it only when there is
no other solution right so so in a sense
what we first go for the low hanging
fruit and and I'm interested on some
benchmarks and find out why is your
system failing how and where and then
and only then if we know that the
problem is right here and I can't figure
out any better way to understanding
safety why let's run some performance
profiling tools and figure out you know
which particular things are being called
to offer neapolitan what is you keep
sighs you know how much time is and
and figure out which repeat should be
optimized and made faster by beginning
the performance testing you know
viability the best things so typically
when I was at 18 you could run for about
a month at the time after everything was
done just to find out that the system
can actually stand up and campaign and
they basically weren't find it alone for
a growing period of time so basically
your liability testing and I want
stability that you should do it pretty
much any product that you have time for
at least 72 hours and find out how is
your system handling below you'll find
out strange things happen people are
running you know megadome processes at 2
a.m. because nobody else obviously loses
the system at 2 a.m. and you'll have the
developers say but if it's all just
transfer these logs from here to there
it's if you're not keeping that time
period you will never realize that there
is a huge performance in fact that at
the time available interesting time to
tune in my ability and anomie show my
canopy discussion because he he doesn't
like the Thermidor liability in this
sense but it's when people talk about
four nights five nights and saw that's
what they're talking about availability
testing is something slightly different
and it basically says when a system
fails how people will come back up so if
you have to take the kick and if
something goes down you really want to
be back up as quickly as possible take
money from people so availability
testing tells you if it's the final if
something has failed but can it be back
up in line very very quickly and in case
some company like Google where we have
systems failing really all the time our
systems are designed so that we know
that at any point big primaries probe at
least a thousand machines failing right
now our systems are designed in such a
way that nobody should never be able to
see that those we could buy crappy
hardware and said you know about
hardware sucks
so let's handle this in software any in
it works really well now the most
important question for me is when people
come and sat on the fence performance
and I want you today you know why do you
want to test performance and one of the
common answers is because there's a
checkbook somewhere here in the Senate I
promise testing and in that case it just
don't like okay so here's any mark there
just check it off you know and be done
you know no problem so in general you
should want the best performance for one
of these reasons right so you want to
find out kidman applications support
what I think the customers will want
right so in case of Google you will see
that on Google search we have up simply
paranoid about how possibly get those
results back to you and if you look in
the upper right hand corner one of the
rules is it has to be less than a
segment but we typically thurman results
in like 0.1 seconds or so this thing has
to be fast because it's one of the
things that we say it's our fate marking
distinguishes us from the rest of the
world
one of the more working reasons is if
you can some certainly requirements or
if you know Department has promised
certain things so in case of Google we
actually manufacture an appliance that
we sell to the companies
the only product I think that we sell
yourself to the companies and basically
searches you Internet and when we
manufactured at the clients there are
certain merit easily say okay so you can
support these many clears per second if
you have this many documents search and
when you say that you actually have to
have that they click will bake it up
because if you don't want to come out
into the trouble of going and
performance testing will help you with
supporting that when you are if you have
any kind of fiber situation as new
hardware comes out you have to do
testing with different manufacturers and
figuring out all sorts of impacts build
a new hardware heaven your future
platforms and so again you can do
performance testing for that reason and
ultimately a peace of mind right if I if
I finish my promises on any particular
product that we have at the police you
know I look at minutes out they will
have didn't crash in 72 hours
it works for at least a period of time
and I feel a little bit more comfortable
sending it out one of the things that
yeah and I forgot to put it over here
why you should invest performance and
and personal pet peeve is people come in
to does performance it basically means
please fence the functional subsystem of
the threatening subsystem of my of my
system to mean it's functional testing
and you know you really should have
somebody else and 15 minutes as if you
think five or six things in parallel to
make sure that you don't have that logs
and the priority inversion problem
because you know my time is right the
time to sit down and write disappeared
said everything whoo everything and
lunch the law and find out that
everything is special because you know
somebody's taking a walk and it's not
releasing it until something else
happens I get fairly annoying that
campus so before you ask your
performance team to do something make
sure that all the functional testing has
know the reason why I think people
consider process maybe like hard is that
quite often when you're starting you
don't really know how to set things up
account organize things and you end up
discovering all these things that really
should be published somewhere but
they're not but if you set everything up
correctly to begin but it's really not
that difficult so what do you need you
have a system on the test right this is
this is the machines that somebody's
gonna deploy something on and this is
the thing that you have to concentrate
other than that we're gonna need
machines that will generate and eat the
machines that we'll be monitoring those
would be the same as the support we can
be the same machine but they don't have
to be I need some sort of a data
repository so when I'm running these
performance tests those results should
be going somewhere hopefully a database
and then I have to have some way of
displaying results and my one and only
attempt at creating a graph so basically
this is what the performance testing
system looks like and in all honesty if
you are testing more than one
application the only thing you should
have to change is the red thing over
here everything else should exist
everything the system doesn't change so
once you have all the other parts the
stuff on the Left changes to some
reasons go on different software over
here but I should have my little
generating machines and I should have a
piece of software running on
thing I need to do is create this critic
for it the monitoring spirit should more
or less be the same hopefully you know
your company is not very systems for
every application that you have the
results parsing and aggregation as long
as you're not changing your won't
generate the software the results
parsing an aggregation scripts they make
exactly the same but you can't that you
at Google we have performance the
information which we score all the
summary results and then we have a
presentation layer on top of that
database we'll see some results memory
that actually presents that they get
some sort of meaningful way and then we
have the row storage data because the
typical performance turn will generate
tremendous amount that you don't really
need all of it and I'll explain why and
what we keep in what we go on cable now
one of the frustrations that I have at
least kind of Google and I'm sure that
at least some of you have experienced
performance testing is that typically
people who performance testing it starts
by saying hey I'll just write my little
script right and I love the mobile
person I hate developers at the same
time the first step for some reason is
always I'll just write my little script
and I don't understand mine you know you
don't sit down and say well alright I'm
a little operating system show installed
on this machine
they don't have my own little
programming languages then I'll write my
escape so while I do write your own
script or journey things mean stuff
exists okay why why do we build the
systems from subatomic particles but we
have bricks and so I love all of your
tools and everything else but I wish you
will do more of it you know it just
seems like summer we really call it
Jimmy's just goes out the window and
everybody wants to develop their own
little system which is
so I'm going to talk a little bit about
what goes over here in our cases you can
imagine I personally believe that
everything goes here everything goes and
monitoring is you don't have it real
life right because if you use any other
kind of monitoring you have to account
for the differences involved that you I
got a regular monitoring system or a
special monitoring system is pooping on
or the system of their tests so we tend
to use whatever in our case Google one
of our machines is over here and my
scoops actually get information from a
special pages become the parsing spins
it looks for the summary results into
the performance database that all day
this stays in the storage to look at
into the next day and if everything
looks ok swimmer stated us for about
couple weeks and it's going to get
tossed the summary data stays with us
forever so back to the thing and a
little bit of a discussion which i think
is probably the most interesting one
which is this box over here over here is
load testing tools and so before you
decide if there is nothing else to take
out of this phone right here is one
thing before you decide to develop your
own yet and I don't know testing tool
please take a look and see what is out
there and you have several options in
how schools before you develop a
learning how school please use one of
the 55 mins we have it all right I don't
like them for several reasons right you
have the advantages the typically is
developer developer who is working on
the product and it's just really quickly
to pick it up and I'm gonna be in a
different
next month and for that month I'm gonna
still support it and then after then
I've stuck with supporting the school
that you know you're down the road it
doesn't go finding the things that I
want and it's just incredibly expensive
to support and it's a thing I mean it's
just any bug I have to fix I have to
deal with it it's just really a terrible
choice in my opinion this advantage is
huge I can't share it the customers I
have as I said I have 55 different
Google in-house load testing version of
tools that will do you know won't this
all of that I can't give any wanted them
to any one of you because so if I'm
actually publish the beta and if I'm
using this goal a perfectly reasonable
question is for somebody else say okay
so let me get this straight you know
testing google google in-house - I can't
have access to codes by the run of those
oh yeah of course I'm gonna trust you
because you just look so anybody
personally that the results of their
pain okay listen I know I would I mean
it would be like if I were if you were
to come up with some point this stuff
would be the first thing I don't
weakness in all this looks alright and
just hang it up as I'm going along this
is probably the most expensive option
that you can have I don't care how
expensive and their pools are this is
the most expensive way to go because you
will end up ending a full-time engineer
supporting the school for the rest of
its life and engineers are kind of
expensive in Silicon Valley so metric
goals right so these are the companies
like mercury said my went below the you
know they made their money by selling it
was
and I don't have a problem with it I
think they're provide some of them you
pretty much should be same job the
problem is their pricing structure is
just ridiculous you know you have look
if anybody has a quarter million dollars
experts see me after the talk I'll help
you long you know but why do we what we
do spend this much money on a fool that
doesn't do anything that your open
source tool does so so go and check them
out another thing is these guys will get
you into learning and spend 3 hours
going through it the slickest PowerPoint
presentations that's you know you have
ever seen it by the time you're finished
you will feel that you've just lost at
least six IQ points so I honestly
consider them guilty of like wasting at
least five hours of my life
the duels are professionally developed
at MIT in the right so you get the buck
it's this reasonably easily it is asking
so many nice things about these tools is
in some companies and I don't know
whether yours belong into one of those
the create the reports totally
meaningless supports but really pretty
and the majority managers that's all
they want I mean that's what performance
testing means you made it up it looks
really really pretty then I can show to
somebody else nobody will know what is
going on but we can check off the box
these fools are really geared well about
that and you come to the DJ meter but
you know loner web load segregate silk
performer fantastic we might be in the
extinguish spensive and they gonna be
good about it for the money
they all have proprietary scripting
languages and and some of them will tell
them that oh no no we're using see
that's that's me mercury well you see -
the pointers in - myths and - that well
okay great
that's
a silk silk uses video benchmark
definition language completely in
Albanian language and so forgiveness
school and that just makes me any
quieter people to learn yet another
scripting language and along did that
although testicles I think the world
doesn't have an offensive in languages
and really needs a couple of warm you
don't have access to source code in your
tool if you need this one thing right
and you need it six months from now
you don't have the source code and this
will work really well or you cannot work
it all depends on how much money you
have when I was in eighteen t segment
what's why developers put all from their
hosting office to just get the work done
for us but you know we can't whatever
company billion dollars suspended waste
and they do that right but in general if
if you're not giving them outrageous
amounts of money in here you never gonna
get your feature in right so and you
can't help yourself because these things
you don't have the country open source
tools to me this is the answer this
solution and we're really five years ago
they just weren't there but today they
are my personal preference jmeter again
keep in mind and UNIX bigger than that's
why Jamie Gries stick to my records but
if you prefer something else take a look
at open SDA take a look and right there
all these tools are listed on on Apache
website and they're really neat little
tools that can be used for different
things depending on what you
you may find it a different to will work
for you so typically for anything from
10 so anything buoy we tend to use chain
either for API testing we have applied
behind our successfully we don't use
open sta very often because it is
windows online and if I want to create
tremendous amount of load
I want to distribute thanks to my you
know Google Data Center machines which
are all Linux machines to me obviously
jmeter and solutions that the price and
I should say acquisition price is no
good you do have to occasionally develop
new features there I mean it's when
people say free free software this is
one of the things that I actually
believe it's common in early on it's
explained in the sense of the puppy is
free right
so you know you will acquire it for free
you can go to the pound but after that
there is a certain expense and it's
there but it's still cheaper a lot
cheaper that our in-house loan
what is nice so what we have at least
found that jmeter is it's whenever we
developed a mod something that you might
immediately need you send it back to
these guys if thrilled included in the
next version they just are great to work
with they really want to be able to use
their tool they want this is development
that they actually don't have to do this
also you have to go to their standards
and that's fine but in general you can
we stop send it back to the community am
giving back being shared with other
people and see I don't have to maintain
it after that to me that's that's the
big part the ego for me to share my
results with anybody else you want to
verify how many people yes you know
Google Search Appliance can handle this
well here is this video download Jamie
Durie doesn't cost you anything and I'm
not asking you to spend quarter-million
dollars to get lower honor to be able to
do this you can have it up and running
in a day you know skipping and standard
programming languages
it's so to me that is a big advantage I
don't have to learn yet another language
and we have to bother it
thingy and the other new person that
comes in the project you know but you
know you don't do semicolon here you
actually it was called cult or something
else but whatever reason is it over in
scope this is the feature of my language
this advantages supports protocols I
think this is one place where the render
tool section stronger it supports far
more protocols that open-source tools
but as long as you're staying in the web
space and you're looking at HTTP HTTPS I
all three the open-source tools are
pretty good being a poodle then sort of
the things that works in my advantage
it's a little bit steeper minute or
learning curve right you don't have
slick presentation materials you don't
have somebody come to you and offer you
a you know two-day class of the tool why
would you ever need to fill a class
amount of performance testing and
logical it's a different story but you
know there are some things there are
some little tips and things and so if
you make a tool like this the best
advice that can no I can give you is
find somebody who has done something
useful with it or find a couple of
skirts Department because there is
always this two or three things like in
case of Janie Brown give you an example
if you have a data file the data file in
the script have to be the same correctly
right now I think it will fix it for the
next version but it doesn't say it right
you can have a link to the data file
from the same character but but they
have community director it's so if you
put the absolute pathnames this stuff
just isn't working and you find yourself
making appended to the wall like why is
this working it should I mean look you
know should and then you find out you
know it's it's about here's why it's not
working it here's how it takes it but
these kinds of things can cost you a lot
and you can actually find a sauce
this was just something they don't know
anything about awesome it's worth
spending an hour with someone who knows
how to use them and show you this five
or six different things and basically
what exactly it's but it has been pretty
much in my opinion the only disadvantage
of this course everything else was but
it's also a performance tester you're
running your you're running your
performance test you have your stuff
going on one thing you will find out
about the promise testing is you'd
really go to generating data
I mean you will terabytes I'll fill
terabytes no problem at all
the problem is what is all of this mean
and quite often you need to look at this
data and you need to extract information
and I think the biggest problem in habit
to promise testing is that a lot of
times people just have the date I don't
know what exactly to create other and
I'll show you sound that there are since
some of the ways of looking at the data
so for every performance test we create
tremendous amount of other agents so
during the performance test every
construction is being tracked and the
performance testing too when Jamie help
track everything itself can send this
request at this point in time at this
point I'll just come back this is main
things obviously if my tests are running
for a couple of hours or days there's a
lot of data but then in addition to that
for every machine in the system I have a
track of CPU memory utilization this
Kayal
possibly some additional variables so as
you can imagine this is a tremendous
amount of raw data that actually
multiplied by the number of systems that
we have multiply that by the number of
tests the periodic and you realize even
even the Google producer to start
turning out the disk space right so I'll
show you a couple of things now a couple
of examples of all the typical
performance tests right so this is a
very short performance that's too cold
on a project people are speaking with a
different language this I think was our
aunt's folks and and they have their own
birth star I mean you have no idea what
they're talking about there and you'll
see here the coal users as normal users
and premium users and ecology but I
don't know their system at all and you
need to give the process quickly out
because you know that we're having
problems so what we do first is say okay
so you have two different kinds of user
it is so very nice having problems
writing so well we have a problem this
feature over here okay so I don't know
at all I have no idea of how the system
is performing the first thing I'm going
to do is I'm going to pick would I
consider where they've told me the most
important very precise and here there's
two different kinds of users we're
looking at this one feature and it's
going to find out okay I'm going to keep
certain set of users it's bringing fixed
I'm going to vary the number of normal
users and I'm sure this this is what 300
seconds so about five minutes that's
just to see what what is the system
doing how is it responding and as I said
in this particular case since IO was not
interesting at all it's not most about
here what important is the memory is the
red line CPU is the green line and then
the main throughput is the board and I
should also say that the scale on the
left is the Hoople scale the percentage
there on the right is the scale for the
CPOE for the memory and so I'm going to
repeat this with a whole bunch of
variations for for the number of normal
users and this is on a small subsystem
that we've set up and what we're looking
for is the blue current
sorry another book curved but let me see
the red color yeah the normal use
article this is the curve that I'm
looking for right this is the I want to
find out as our weakness in the number
of normal users which is the load on the
system what is happening with my in this
case reports per second what is
happening in my throughput and what I
also want to find out this bitch
particular resource of the system is
going to be exhausted right and at what
point in time and notice that all of you
8 users my CPU is going up to about
hundred percent right so on some level
then what I'm doing here is asbestos I
keeping the single load and for every
one of these runs I'm trying to figure
out its how much my resources is because
you know what is meant to good and at
what point in time with my system be
exhausting at least one resource to
about hundred percent in general when it
comes to use machines at any Theory
unix-based systems I would say don't go
above eighty percent UNIX is a wonderful
operating system that will do anything
you ask of it as long as something is
not above 80% right so the moment you
started going above eighty percent you
can trust what's gonna happen and so
it's so in general you know we look at
this and say ok let's go back to about
eighty percent line and it will be
memory that can be IO or that can be CPU
I don't care each one but the focus they
go 80 percent of the usage and so you're
not stressed like the stress that's like
this and then you're on a different
stress test where you vary the number of
being users or the other parameter
there's a basically what you're looking
for is your really optimal point where
the system is not to get love at the
most
once we've done all of this and figured
out how the system behaves we sit down
and talk with the guys that actually was
life support and find out what what
would make could be some benchmark right
so and your developers they have new
features bugs everything else to track
and what I really wanted to give them is
something that will allow them to find
out as quickly as possible preferably
within 24 hours I've just introduced a
code change that will really hit
performance and the users out there
badly and therefore I should go back and
fix that today rather than two weeks
from now but I have no idea what I was
working on and I have no idea why I did
it and so what we really do and how we
do our benchmark tests is you'll see one
of the one of the cases over here this
is the guys that you were concerned
about these are premium reports and at
some point in time one of the candidates
so the purple graph over here is one of
the candidates and then suddenly
introduced a code change over here and
the promise is going out by 500% me
basically doubled the amount of time
that it takes the data they sell bad
clearly the developer didn't attempt to
do that but was fixing the bug doing
something else and if I can get this
feedback and to me this is the biggest
value of performance testing on a day to
day basis because I can give you think
that immediately and say hey guys
something has gone wrong
from yesterday to today here's what I'm
getting they can look it up they can
just go to our front and actually have
it office immediately generated for them
and every day morning they come in they
can look and see how is the recent code
change or the recent build
performing compared to the other bills I
mean and then you will see also that the
form of bills who fix the problem it
immediately
a particular post about any performance
issue so that we don't really have a
problem go out live but to me this is
the biggest value of of performance
testing to be doing at Google and that
is instant feedback to developers I can
run on a nightly basis they can figure
off the tests of their own everything is
automated all of the results go directly
to the database
everything is fact the actual average
said to different databases so we can
actually store the binaries that were
running on the machines at the same time
as the one that I tend to use or it's
just the labels of the of the software
attorney but they do have the ability to
store the actual writer it's if somebody
is messing around and trying to figure
out how will the different switches in
BIOS impact things we can start all of
those things and people working in
example scalability perfect so you're
looking at a new configuration right you
have a hybrid platform you you are
running out of partisan you know
basically looking for the next
generation hardware platform what is
really interesting is working with
finance people because for that much
twenty bucks is a lot of money right
it's so me being an entitlement and
buying and building my own new machine I
always look at it and say how much
memory can I shove into it and what's
the best graphics card and then you're
working with these guys anyone I call it
so much twenty bucks between you know
one gig ram and and 512 stands milling
machines I know how to never think about
it but they do and so what we do is we
tested four different memory
these are Old Testament 510k HTML files
and just goes to point out this
particular machine is really only sold
in this range so my never be attesting
we go intense too far out of the range
we know that they will sell the machine
for rights in this case the next sizes
vary from hundred thousand machines it's
a small machine to about a million
dollar comes with us to 2 million dogs
testing 1 5 to 10k 10k htmls is very
important to us because the average size
of an HTML document out of the bed is
about 7k they also test in the larger
files because obviously if you're
growing your documents or PDF files or
anything else they actually convert
those stored them and they're much
bigger but if a company is interested if
it had only HTML Doc's
chances are their sizes will be about in
this page and so one of the things that
happened originally we're just telling
people so we will guarantee you 5 ups
and you can see it on the website before
all this thing will get any fuck-ups
well if you take a look for the machine
that is selling within hundred thousand
documents to two hundred thousand
documents they actually do it 50 QPS
right but you cannot look at these
systems as this is the throughput I mean
it depends on what the condition is and
so one of the things that in the gloom
bit our Salesforce is saying like you
have to look at what the customer is
going to do because you get impounded by
the competition saying well we can do 20
QPS under these conditions and we're
saying well we can go 5 when in reality
I can do 50 depending on what my
configuration is how much memory good
but even even in the lowest if you look
at the configuration whatever 3 even in
the lowest form you know I can do 45 43
q yes
so before you pick whatever is the
lowest number down here
scale I realized if you're talking about
that out your really modeling the
performance of the system you're talking
about charts if talking about the house
and that is the thing that should be
presented to the customer and other than
than some lowest number and then get
pounded by somebody else who actually is
presenting data in a more accurate
fashion but also this one thing every
single time you run out before a success
story
I'm unfamiliar with the system I don't
trust it I'm a QA person by my choice
and one of the things that I realized is
that a the systems will fail exactly in
the place where the people tell me
nothing could ever go wrong the
developers are totally delusional about
their own sensor and and pretty quickly
they will just forget about things
they've done you know two weeks ago I
know if it's not in my inbox it's not
gonna get done so I not every test here
you have only three results for every
SEC but they don't have the best five
times I want to see that I have some
sort of statistical consistency and
depending on the software you would be
surprised how the results may be all
over the place and you go back to people
and say you have some serious problems
because clearly the data is going to be
a little bit off and you have to do some
statistical analysis but if you're
finding that your results are 50% or 60%
off you have a problem the system has a
problem something is wrong you don't
understand something about it so this is
a this is an example of scalability
testing now if we simply had an
interesting configuration sort of
conversation their purses are like oh
you don't really have to want to
remember it because female memory is not
a problem
and you may know for a fact that memory
is not a problem in you have enough
memory and so on
the reason why this case is like this
performance testing should not be used
as a true
finding memory leaks but it can't write
and so this is one of the examples of
many pests and and this is my purpose
think of right so look at this women
said I want that we short ground again
and I've had millions of girls like this
from the same machines where my memory
deadline was completely straight and
becoming the morning and men officer
baby for me and I look at it and go oh
you know something it's not very good
because this life has always been
completely straight in the past and now
suddenly isn't what happened right and
you filed back email and you know the
guys saying like so take a look at this
chart I think you have a memorably can
you get back or Commander Lake us oh
wait a second yeah you may be right
about this it's you know the data
doesn't lie the machines didn't decide
to pay to this day but this is why this
is why you do want very great
performance testing honestly performance
testing without monitoring don't bother
why waste your time right go get a cup
of coffee or something you have to want
to do stuff do you have to keep this
data forever
no because majority of my ants I'm going
to come back in and say everything is ok
I'm just going to keep the summary stuff
I'm going to toss this date after 2 or 3
weeks because nobody really wants to
look at it but this one the moment they
have this month people will jump on it
and look at it you Frank understand what
is going on because it's telling them ok
I definitely have a problem once the
problem is fixed they call suppose the
summary data stays right the information
stays but all the know they've indicated
this chart why do I care about it a year
from now the problem has been removed
and that's pretty much the only thing
that I'm really really interested in so
per that several people here interested
in have been told you need to do
performance testing and to talk because
have to do this no idea where to start
so trying to begin first of all we've
seen the setup and I think I have
another slide of it you need to set up
everything that will allow you to
extract the information out to give a
thing that will allow you to use the
data alright so the information so the
database has to be involved in in our
case it's my sequel right you can be a
heavily open source and my sequel works
really really well
set up a schema that will allow you to
keep the average throughput for on the
names of the machines that you're
monitoring the average CPU memory
average this file let me see
we definitely keep track of every single
piece of software that is running on the
machines and the versions that are on
there all that is in the database all
the data needs to be easily accessible
we have clearly setup that you know
pretty much anybody can go and check and
find out what has been happening with
this particular project on these
particular machines I've also been
totally agree yesterday a speaker
consent every once in awhile we will
find a machine that just is different
than behaves differently I can even tell
you what it is you my previous company
be at some point in time partnered with
a large large large hardware
manufacturer from Texas with many mates
but they were going to provide us with
the machines and at some point in time
the method points provides this thing's
compilers and and they store they die
it's kind of people really get picked
off if it was all over they throw or if
you want it to be seen all over the
world and so we started getting these
boxes from the same manufacturer
we're all supposed to be exactly the
same I found out it's about four percent
battery boxes verb you just Park in it
and behold the back up and said
something's wrong maintaining focus of
everything okay so I guess the you know
so this particular manufacturer has an
issue I would guess that all of the
other is to have error rates that line
up and so some of the emotions will be
different they're different because they
have different parts because you didn't
order but you have to learn you have to
realize that if you buy millions of
machines that it's a good idea to test
them know what's going to happen that
you have to deal with it okay so first
thing is set up a realistic environment
right one of the most fascinating things
is being told
okay so here you have this Bentley for
me they would like to know how will this
work on a supercomputer what can I tell
you but what I can say is if I can tell
you what is the research you exhausting
and if you have never done any
performance testing before chances are
you know maybe we're able to remove like
20 percent or so of the box that will
cause eighty percent of your soul
slowdown work than any one of our
products it's really 28 little works
don't know why but it does
so said that your system understand what
are the machines and what are they doing
and make it realistic what I mean by
that is majority of Google developers
are really great about testing but but
we tested it zero size database is very
because you a developer if you heavy on
low sit setup you're not going to go out
to the real world and create the series
they can this and it works just fine and
your machine is quick enough and then
they load a production database and the
stuff is not working at all so if you
want to know any performance testing
make sure you pratik
databases are somewhat realistic I mean
they don't have to be exactly those
things production but it had to be the
same order of magnitude otherwise the
results you're getting I just once you
get that you can't know them and you
can't extrapolate but let's make sure
that again that you can that you
understand what are the risks and what
are the problems that you can encounter
second thing execute asbestos find how
your system is failing finding buried is
failing and then as I said depending on
how critical your product is 60 to 80%
if it's you know you pick it out of thin
air but only UNIX machines we find don't
go above 80% and it will be happy to
find out how the system handles overall
because you really have no good defense
mechanisms against people are they're
trying to you know even in our cases
like when we when we launched Google
Earth predictions my talk it will have
about thousand people that have only the
first day and for whatever reason if you
google and no matter what you do some
code ends up on go on get within 15
minutes became millions of people
downloading stuff you can't plan that
you can't you can't protect yourself
against stuff like that it's just the
product is a lot more interesting than
you ever thought but in general you
should know how your system will behave
if something like that happens sauron
really really high stress test to find
out what will happen hopefully you
shouldn't blow up they figure out what
is your performance test point and as I
said 80% is a good good starting point
basically performance tests it has to be
long enough and long enough means you
have to reach a steady state and
depending on a different system you
manage the state very quickly or or it
may take a couple of hours but again do
some investigations of your system and
first a couple of short tests and as you
see the graphs leveling off you know we
are starting today the steady-state
decided that's through the reasonable
warmup period I think it's completely
unfair to start counting thousand users
over the same second and say oh the
server didn't handle this particularly
well well you know it's it's designed to
petals up like this make sure that those
users are coming online slowly or over a
period of time collect all the data
right you may not want to keep me
forever but definitely collect all the
data the system performance is the
lowest throughput for the duration of
the test right so you will see that the
people will go up and down usually
happens because there are some
background processes kicking off you
know I'm moving logs around a lot of
rotation tends to be a standard UNIX
machines and so on but you have to be
you're reporting a performance date that
you have to report the lowest throughput
right because that is the only thing
that you can guarantee anything higher
than that you cannot guarantee because
the people who be running at the time in
your video scripts are keeping off and
taking some resources to something else
they beat that several times just to
assure yourself you do have statistical
it's nothing weird is going on and the
balk is necessary happening that
questions
sorry BJ says would you take your five
samples on your performance test if you
get one beat right to go back and figure
out why so here we go this monitoring
and bloating some of the things over
here and ensuring you but we actually
also look at what is it on another
machine which process is that I think at
what is sources and then is how quite
often you find out oh my god these
people actually kicking off this we're
supposed to be a low priority process
that really does nothing but it's
running at like the highest level user
and you can usually fix the problem
we're just messing it down or support
that but quite often people don't really
realize everything that is running on a
complex system and in some cases you
find that there are the amount of things
left in there any people have forgotten
to turn off but we have to keep track of
everything so if I don't have that very
god I really don't know the tests with
all of the technical order to find out
which process is causing the slow down
what what has happened because something
must take place
heathyr fighting them testing web pages
with stuff like that just tests maybe
the HTML how do you test the whole page
the images the JavaScript the style
sheets in an automated point okay
so Jane even has been absolutely great
for that purpose you are there couple
things you can do you can actually ask
it to anything the images are not as you
see it and you can ask it to verify any
of the things right so I can actually
make sure that the imaging is getting
back mentions the image I think it
should be getting back saving the jobs
that we have had no problems we had to
do some extensions food but they are
over the in the product now saving HTTP
we've be vetted and that's gonna be in
the next version of jmeter we've added
ability to record over HTTP to it and
they assured us that it's going to come
out with the next version Jamie there is
actually an interesting not exactly
most user friendly programming
environment because it's kind of
graphical programming environment but
when it comes to record playback and
then modify things it allows you to do
fairly nice job and then what is to me
the most important the nicest features I
can keep it off auto pipeline and I can
run it in ongoing
no problems with all verifications of
any of the things everything bill did
James Harvey Kuenn siphon do you you
were talking about storing the we're
talking about storing all the data from
the tester oh listen do you ever find
that the an act of collecting when
storing the data affects the performance
of assistance you're trying to text I
should have mentioned that they actually
wanted girls to the machines that are
doing the collections and so since the
monitoring which means themselves that
are actually collecting all of this data
it's not the machines under test right
the machines on their tennis at least in
our systems was set up so that they send
periodically information to monitors and
then he actually coined the data from
the monitors the new monitor also our
both work generating machines in our
monetary machines to make sure that they
are overloaded and that my performance a
it is not skewed because the machines so
yeah absolutely
thank you for power writer from Piper
graphics have you had any attempts to
ultimate analysis of the results or
anomaly detection that is that is the
last thing that we can watch so so one
of the things that they found out is it
used to be fairly expensive to set all
these things up and let me go back to we
have just recently I've only been
they've just recently set up all these
pieces because this layer is still being
worked on and and all the graphs are now
there would be any more stuff to it
would you would really like to be able
to do is automate the stuff that all
data and basically that I really get the
graphs printed on my screen in the
morning only if something is wrong now
I'm paranoid so even when that is
the girls will be on every day for every
project with a ton because you know I
know too many developers and so I know
you know there is a reason why I don't
develop right because because I'm even
worse right but I just I don't know but
it's been it's something defense ion say
you will definitely working on it who
died necessarily interested on something
like ads which pays my salary or
something that doesn't pay myself why
not but but really it's how much that
thing is really about basic analysis in
QA is about risk analysis right and so
if I believe it slightest
I want to take a look at it if I believe
there is collectible oh and okay but we
are working on it that is you know one
of the motivations is to be always it
right so why should I stretch it from
ultimate testing what I can see is that
the measures for little beyond abilities
towards substantial works upon stress
and code apart from this do you have any
other qualitative quantitative measure
to to see their ability and ability
testing research because for it can be
the sensor what I mean to say is then I
would come relatively to be the mean
time between failure the new share
between the failure of the system and I
will have an quantitative measure with
respect to me tend to be there
underneath not fix for that particular
by the way of SQL injection so if you
have to remove the factor of stress and
load
actually they do but it's done by the
ops people right so in particular and I
don't even have the data for that very
particular all our systems are really
being monitored at the whole time and so
I'm sure that our operations people will
be able to tell you from any particular
datacenter what is the mean that oh they
would be able to tell they were sure it
they would tell you but we do have the
data for the machines I don't really
have access to it
Google is fairly paranoid about any
sensitive so for example even when we do
this and do searches I can't get access
to searches going down there I don't
know what they like but honestly they do
not the level of clearance we have to
get to get access to any customer base
is really astounding because you're
surprised and we equally better know
about high current okay as you know me
like one fan yeah by the way to sequence
very quickly the good source of income
source sources for benefit the
audience's vocals testing Dumbledore
about someone and they are system is
also located on sister affliction stop
but also you mentioned particularly
record feedback which I think you
quantify this being a date yeah so you
generally don't hold with this overnight
because they tend to be rather belong
and you know you have five in a sequence
and so on and so you cannot go home and
then
there so so what suggestions you have
for developers who might want to get any
more active feedback say as part of
their continuous integration builds
beyond just the basically currency
testing perhaps with things like gel
unit Perth to you to help sort of
augment them and get rapidly back as
part of their continuous integration but
so within minutes they know that they
actually introduced some fundamental
points issue and not have to wait an
entire day for some of the basic
feedback so I would say go get a
5-minute pest right because it's going
to give you some information I still
insist on nightly rounds that are all
with water but a feel point with the
parts of the code that are fairly
sensitive and can impact performance and
you want to get the feedback you know
just under five or ten minute pastor and
make sure that all the data into four
stations that I personally have is there
a lot of times people when there aren't
performance tests that don't realize
that they you know the information is
important and a likely capture all that
information even if it's for some
building between or song if you're
running the test like that store the
data to the database I mean that's
that's what it's there for
right so definitely keep track of
everything you're doing
and ultimately I should have all sorted
that in the database we have obviously
fields that allow us to comment on any
particular on or anything else so that
people understand what is going on
especially if you have been doing made
parameters
but yeah you can you can get pasta
results we are working on setting
something up that baby pasta
24 hours she's been fairly reasonable
for us in general people think we
remember the things that they have done
yesterday when a week ago is really hard
I mean I know from the personal angle to
tell you what I was doing
do you clear networking in your
profiling ah the question I should have
mentioned that thank you for bringing
this up when I'm doing performance
testing first the first thing I try to
do is eliminate a network right because
I want to simplify my problem I'm
interested in the machines and my hope
is that the network is going to be
provided to be able to handle everything
I need
now once we have profiled all the
machines understood everything we will
do some tests it didn't in between
multiple data centers right and at that
point in time the network is equal to a
man but honestly if if you can
everything on the same subnet everything
going off of the same switch and that's
going to make you much happier
performances very the first us debugging
networking problems fun
but thanks for bringing it up
hey one of the big problems about doing
that benchmarking and performance
testing we found is that the marketing
department private so they want the
biggest number they want the - let's say
because this next event we're only
keeping it a 210 capacity possesses what
users can expect is that capacity has
the biggest number so any of us on you I
smoke marketing bunnies Oh general wide
them right because but the funny thing
is that you don't think about marketing
people who can always come up with some
technical explanation they won't
understand me you know because the
defects will blow up and it works by
putting general it's go back to the risk
analysis in their liability right do you
want a not even kind of percent sure in
that case I can guarantee you it's gonna
be on for thing you want it more than
eight you want to do what I'm telling
you and one of the next things I didn't
know people his marketing people I've
never met one
but I think I've dealt with my fair
share of meta and it's just sort of like
each one of you people come from and but
yeah I you know I but I also get a lot
yeah it's honestly we do miss our savant
I've heard that actually make yourself
is also booth some similar things that
they go down to sixty percent so it's a
standard thing they know that you know
when you come above certain level the
machine will just know behave they
expected to behave things will just
hello Howard JPMorgan I'm interested in
what you say about knife Appalachia the
results on service we could be
pacifically we buy supercomputers for
production and some of 3:06 is for our
QA and and consequently when we do our
performance tests we get certain set of
results about happy we're doing and it's
actually we find this lots of failures
but we figure put it in production
anyway because it probably won't happen
and it generally doesn't and I'm
interested a square that circle because
clearly most people can't afford to
replicate the entire production
infrastructure for testing I mean maybe
you can borrow it overnight maybe can
take production data but that's a very
real problem that we have so I also a
couple things at Google unlock it right
because machines in our Davidson project
we have no supercomputers unless you
look at how we have organized the
machines that you act as one but they're
really individual boxes that are pretty
much the same as the vault is I don't
have a job so I'm very lucky in that
respect in a TV so I joined AT&amp;amp;T offer
off their money seven years think that
the University and so that was that was
a shock because universities if it's the
newest I'm notoriously for a cheap and
you know just correct equipment then I
came to a 10:00 p.m. I wanted to do
tests on other times it was he five
thousand was the sons of light chain it
cost a couple of million dollars or
someone bad it's wrong and I get a call
back from the department saying like
seen border and eat five Casa and we
knew we were going to use it and you
know I'm going through like oh man this
is snow long until we're going back
through like there's no way they go my
glove so here's the thing you know what
if you order going look something fails
can we just order a couple and be done
with it and so that's about a solution
work for a company that has a certain
amount of money and it's not going to go
back the sorry and he's willing people
bankrupt
if you have you have a little problem I
mean you really want to get some some
time on that machine before it of water
production and if the system is not over
they want production it should be not
that difficult to get it for a week or
weekend or something to get some date on
how its behaving because you can't
accept what there's also maybe six you
don't even know but it's a different
operating system you know it's
everything is different
extra point will kill it interpolation
is great but extrapolation will kill you
because things will just go wrong but
you don't you do not out of somebody
search that you never expected I
remember issues when our Solaris
machines were not configured properly
and we had limited number of handles and
suddenly I would get this two minute
delay nothing was hemmed up happening
because the system was waiting to start
recycling the file handles and reuse
them so quickly and so now there was
like a two minute kind of and you will
not need the stupid stuff on there that
you can't predict ahead of time the only
you know validation is the only thing
that you can do you have to go in there
and you have at least I don't know
anything else thanks very much
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>