<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>The Top-To-Bottom Review of California Voting Systems | Coder Coacher - Coaching Coders</title><meta content="The Top-To-Bottom Review of California Voting Systems - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>The Top-To-Bottom Review of California Voting Systems</b></h2><h5 class="post__date">2007-12-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/tEI9Wn_hPWE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so it is my pleasure to introduce our
next speaker he is an associate
professor
rice and has done a lot of work recently
in the area of electronic voting in a
prior life he was a grad student at
Princeton who worked with Ed Felton and
has interesting stories about receiving
nasty grams from RIAA lawyers about
breaking watermarking and pointing out
obvious things of the such but today his
talk is going to be about his adventures
an EVO doing research thanks Justin
let's see how is my audio working
everybody hear me ok fair enough so I
titled this talk adventures in
electronic voting research both as a
shameless way to try to attract people
with making the talk more interesting
than it actually is and because this
sort of work does occasionally involve
more adventure than the average computer
scientist tends to experience so the
work I'm going to be describing is joint
work with one of my graduate students
dan Sandler dan Sandler is also the
wizard of Apple Keynote so if the
presentation looks beautiful and great
then that's my student and if it looks
weird and messed up that's me converting
it to PDF and getting it wrong somehow
okay taking it away this story begins
with what dan and I did over spring
break in March of 2006 so the beginning
of our adventure is in Webb County Texas
this is in Laredo which is a bustling
border town NAFTA has been very very
good to Laredo and so the city of la
radio Laredos population maybe a quarter
million with another million across the
river in Nuevo Laredo and our story
begins with the march two thousand six
primary election now some of you might
think that Texas is full of a bunch of
Republican types I don't know where you
might get that impression but in fact
South Texas is actually a democratic
stronghold such that the Democratic
primary election in Laredo is the
election for all intents and purposes
which means that even though it says
primary election you should read this as
the election and this
they're very first time that the county
of Webb County Texas used electronic
voting systems okay that's the setup
everybody ready so here's the end of the
voters were given an unusual choice as
they were transitioning to using the
shiny new computers they could vote on a
touchscreen electronic voting machine
very shiny very happy colorful or they
could take a pen and apply it to these
processed dead trees that we call paper
and fill in a little bubble which would
be counted centrally with an optical
scanning system so let me tell you about
a judicial race in Texas judges are
elected and this is a race between an
incumbent judge Manuel Flores and his
challenger I forget his first name Lopez
and what happened at there were about
50,000 votes cast in this particular
race the margin of victory was very
small two tenths of a percent and the
loser who happened to have been the
incumbent suspected that something was
wrong with the dr ease because he won on
the paper and he lost on the dr e
therefore clearly something is wrong yet
dr e stands for direct recording
electronic by the way so try to avoid
using acronyms but that one's
inescapable so what do you do when you
lose by a tiny margin and you suspect
the technology is at fault any guesses
so which is exactly what happened so
when you when you have a lawsuit that
involves a technical question you need
to go and find yourself an expert who
can be impartial and so that so I by
phone rang and you know dr. Wallach this
is so-and-so lawyer from you know can
you please come down we'd like to have
you work on this so my student dan and I
flew down in April to go have a look at
what we could figure out so there are
two kinds of data that we could collect
these voting machines have come
packed flashcards just exactly like the
ones in your digital cameras and we were
able to get some of them and they had
this binary undocumented opaque bizarre
file format which later on a smart
undergrad of mine cracked and figured
out what it was you know just nothing
crypto just you know binary and
obfuscate 'add there were also text
records that yoga wires gave me a shiny
CD and said this is what the election
administrator gave us see what you can
do there were two classes of records all
text easily readable with your favorite
editor one was called an image log this
so images these are like cast ballots
here is a ballot and here are who the
votes were for and they were allegedly
in a random randomized order then the
other thing was what's called an event
log so this is everything other than who
the people voted for at a certain time
this machine was enabled etc I'm going
to talk about event logs a lot so let's
see did we find a smoking gun did we
find evidence of evil diaries' hacking
the election did we find hacks how could
we we had no time we had no access we
had lawyers breathing down our neck from
both sides that was this isn't a story
about discovering evil brilliant hackers
on the Mexican border this is a story
about finding procedural problems in
real voting systems we fed so these
event logs which I'm going to talk about
for the next couple minutes are per
machine records for each machine you get
a list of events timestamp for when they
occurred these are things like you know
we opened up the terminal of vote
happened at this time we close the
terminal etc so this is a direct quote
so let me break this down for you the
left column this is a serial number of
the voting machine the next column is
the a peb that stands for personal
electronic ballot it's basically a bad
repowered smart card box thing that
talks via infrared to the voting machine
if you think in your head smart card
then you're right along this is the
thing that's used to enable the voting
machine to take a vote as those have
serial numbers too there's a date at
which the event occurred a date and time
and then an event code so we had page we
had you know pages and pages of this
stuff so we started flipping through it
by hand and whenever we'd identify
something funky we'd write a bunch of
Python try to find every place where
that same funkiness occurred so here's
an example of something funky anybody
see something wrong with that so you
might notice that this says that the
machine was cleared on 330 p.m. on the
day of the election right polls opened
at 7am what happened between 7am and 3
30 p.m. answer we have absolutely no
idea because there are no records so
perhaps some votes were lost there were
approximately 10 machines that had some
variation on this theme where the
machine was cleared at some point on
Election Day that just shouldn't be
likewise check out this date that strike
anybody is funky or remind you the
election was on the 7th of March and
here it is march six and we have a bunch
of votes cast that might strike some of
you as possibly problematic or
indicative of of errors or fraud or
heaven only knows a total of 41 votes
were cast on the wrong day according to
these timestamps so here's a case a more
specific case where we see we saw
several machines where the votes were
cast the day before the election there
were
aisely two votes and when we went to the
actual vote records for the machines the
order was randomized but we could see
the machines that they came from and
every single one of the votes of this
sort there would be one Republican
primary vote and one Democrat primary
vote and the Democrat was vote both of
them were for precisely the same
Republican or Democratic slate so
there's a word for that they're called
logic and accuracy tests and these logic
and accuracy tests were included in the
final election tally so right there I
can just tell you that a quarter of the
winners margin of victory was an error I
mean just right off the top so after our
first investigation you know we had we
had all we had a bunch of machine serial
numbers that we wanted to go and touch
in person and by now the lawyers had
finished arguing with each other and
calling each other bad names and had
agreed that the experts would be allowed
to inspect some of these machines in
person so when you're a professor and
you need to do something ugly what do
you do you send in your graduate student
so they had that this is the outside of
their warehouse the warehouse space is a
little bit smaller than the room that
we're sitting in now and the machines
were all piled in at this kind of a
density that's about half the machines
so they had to lug them outside the
serial numbers are printed in six point
type inside the thing and there were in
no particular order so the computer
scientists in the crowd might say that's
like an order and process yes you have
to open up the booth and open up the
thing just to read the little serial
number to figure out that this is a
machine you didn't care about repeat and
oh by the way they set a record high
temperature on the day that that my poor
student was actually lugging all these
damn machines around so this is computer
science field research
so for the machines that we suspected
were logic and accuracy tests the clocks
were accurate so the machine at least
Nia when you boot them up the time that
they reported was it was today it was
now so from that we concluded that these
were in fact cast the day before the
election and therefore they were test
votes and therefore we could subtract
them from the tally okay poof
one-quarter of the margin of victory
disappears for all the other machines
that we could find we found probably you
know sixty seventy percent of the
machines on our hit list at that point
he just said enough I'm done the clocks
were incorrect so they're like off by a
day in one case off by a year so and
that actually accounted for all of the
anomalies we were able to find by
reading the logs now you should realize
this is far from proving that the tally
was correct it merely proves that we
could find reasonable explanations for
the anomalies that we found does this
make you confident in the outcome of the
election I you know so the real problem
is that we just had insufficient audit
data many of the machines were cleared
on the day after the election or you
shortly after the election in direct
violation of a judge's order many of the
paper tapes that are supposed to be
printed out as proof that the machines
have been zeroed were missing many of
the records that we might want to see to
corroborate what we had were missing or
gone this in particular there's a
feature where you can cancel a ballot
what does it mean to cancel a ballot
there's this problem called the fleeing
voter which is really these are voters
who didn't figure out to hit the button
that says I'm done this is analogous to
leaving your ATM card in the ATM machine
because you got your money right the vet
the analogous voting thing is you picked
your candidates and you forgot to hit
the I'm done button
so there's a whole procedure they can go
through to cancel the ballot now you
might say to yourself well shouldn't you
cast the partial ballot rather than
throwing away the partial ballot that's
a legal question not my department in
Texas the answer is you throw the ballot
away because your vote counts anyway
let's stand back and try to reach some
conclusion or observations or something
mistakes were made I hope I'm not
exaggerating the point to claim that in
fact this was not the best administered
election the world has ever seen just
basic election procedures were simply
done wrong the fit you know I can run
off a list of 20 different things that
they should have done and the manual
said they should have done and the poll
workers were probably even trained to do
that didn't happen properly and that
caused the loss of records and that made
it hard to figure out what actually
happened clock set wrong etc and at the
end of the day that impacts election
confidence in the result why should you
believe that the result that the
election officials tell you is correct
given how much stuff went wrong it's a
legitimate question okay honest mistakes
or illegitimate manipulation right
there's no way to differentiate between
them when they're so in the records suck
it's difficult to audit an election in a
case like this here's a URL where you
can read my expert report for the court
please don't rat type this down rapidly
if you go to your favorite search engine
and type the name dan wallach which is
conveniently printed on my badge this
you can find this link from my homepage
ok now I'm going to use this example to
try to motivate some research okay we
have identified a problem can we as
smart computer scientists who like to
engineer shiny toys can we build a
better mousetrap so we want to make it
easier to audit the election after the
election is over and we want to make it
harder to
make mistakes can we engineer the system
to make it harder to screw up these are
two valid research and engineering goals
we'd like to prove that every vote that
was tallied at the end of the day
belongs there as opposed to those logic
and accuracy testing votes we'd like to
prove the dual of this which is every
vote that was legitimately cast was
included in the final tally there should
be a nice one to one mapping that would
be a good thing can we prove that and
we'd like to be able to tolerate
accidental or malicious loss of data
we'd like to be able to tolerate
machines failing and machines will fail
for a variety of reasons during an
election and we'd like to be able to
tolerate these kinds of failures I'm not
making this up this happens this is the
world of Elections I believe that this
woman is a poll worker who is expressing
disdain at somebody's opinion about the
quality of D bolds engineering prowess
perhaps voters are wacky what can I say
so how are we going to do it you know
what you know reaching into our bag of
computer science tricks well what can we
pull out and leverage to help address
this problem so our answer is Network
them together let's try to anybody here
heard of this ninio networking thing
it's like a series of tubes we're not
going to use the internet I just want to
connect the voting machines together and
be able to let them replicate records I
think Google might have some experience
with replication as a fault tolerance
mechanism am I preaching to the choir
here oh we can't tell you that that's
trade secret our goal is to waste
resources like mad when you think about
the voting world it's exactly upside
down of the problem that you guys solve
every day you guys as I understand it
every bite matters right if you add one
extra bite that you transmit to 10
bazillion users that has a measurable
impact on revenue I find that staggering
that's not the problem here these voting
machines are basically computers they
have huge amounts of memory they could
have hard drives if we want and we're
talking about capturing order of a
thousand votes in a day the event you
know the number of events per second is
a fraction it's less than one so we can
waste resources we can use algorithms
that are super linear in the number of
events n squared that's just fine we've
got we've got time to burn we've got
space to burn we've got bandwidth to
burn it's a very liberating feeling
isn't it how often do you get to
actually waste resources on purpose and
feel good about it oh it's great so
here's so here's so what can we do we
want to store everything everywhere
every vote record on every single voting
machine in the precinct and we'd like to
try to throw some crypto at the problem
to create what we're going to call a
secure timeline that can help us detect
any tampering that might occur during
the day so how's that work we're going
to call this thing auditorium for
reasons I will explain in just a minute
and the first ingredient we're going to
use is a classic technique called hash
chaining the idea is every time you post
an event to the log you include the hash
of the previous event thus there's some
recursive hashing going on what this
means is if somebody wants to go back
and change history then your subsequent
records will have hashes that are
inconsistent with the past this is a
fairly simple but powerful technique
that's easy to verify and if you want to
change history now you have to change
the future to be consistent with your
false past so that that raises the
barrier to entry the next technique
we're going to use which is also a
slightly more modern but still classic
technique this was invented by Mary
Baker and petros maniatis while they
were both at Stanford
is something called timeline
entanglement and you know you have these
logs on individual machines now whenever
one machine sends a message to another
one it just includes the hash from the
head of the log and that hash gets
included in the eye in the receivers log
so now one machines log effectively has
a pointer to another machines log which
meaning which means that even if you can
corrupt and take over one machine there
are pointers to its prior history in
other machines thus making it even
harder for you to consistently tamper
with history so conceptually here's a
diagram time is moving to the right and
we have pointers back to the left
effectively what you have is a dag where
all of these hashes are pointers
backward in time which means that events
on a single machine are totally ordered
events across machines are partially
ordered ok for any two events we can ask
are they we can conclude that that they
have a common ancestor or a common
descendant or have a direct you know
this one came before after that one or
we conclude that there's simply no path
in any way from one to the other that
would be interesting alright so let's
waste resources let's broadcast every
message to every machine so you know in
our implementation which I'm not going
to talk too much about we just use a
simple n squared gossip protocol have
you seen this yet oh here you go I mean
really gratuitous ly wasting network
resources but we don't care right
liberated it's a great thing so in
practice you know the logical picture on
the left has the physical picture on the
right where this this real message a1 is
sent to hosts B and C every so every
host actually has every single message
and we have a little bit of logic to
deal with what happens if two things get
sent contemporaneously you know ships
passing in the night so you figure it
out and you you merge it back together
again not really a big deal so you have
broadcast messages and timeline
entanglement that is what we call the
auditorium it's like audit
aureum get it hey computer scientist bad
puns wordplay at all anyway okay so
everyone hears everything in the
auditorium one this machine announces a
vote all the other machines have copies
now some of you might be asking now wait
a minute what happens if I can jack into
the network and I can see plain text
votes yes we have to do some kind of
encryption hold that thought getting
there this actually is something there's
some historical precedent for this
voting architecture so the Conclave
which elects the new pope after the
previous Pope moves on to whatever comes
next the Conclave is actually not unlike
this there's a whole procedure where the
Cardinals you and they're doing they're
in their College of Cardinals when
they're all doing their thing the vote
casting process all of them can see it
and they have a whole procedure
involving they put their little written
vote fold it up in an envelope on a
silver tray and then on everyone sees
the silver tray get dumped into the
silver bucket and the process is visible
to everybody but yet the votes are
secret so yeah try citing historical
precedent like that in a research paper
anyway so the super of our architecture
has a supervisor console that can see
everything that's going on the
supervisor console so here's we want to
help prevent member i said we want to
help prevent mistakes so here's like
basic engineering 101 wouldn't it be
nice if the supervisor console could
tell the poll worker hey machine number
three's battery is running out could you
go plug it in please or the voter at
machine number four hit the Help button
please go help them this gets us an
architecture not unlike when you go to
frys to check out and there's somebody
telling you oh go down to counter number
24 and you know you can you can use
technology to help orchestrate and make
things smooth which requires less
training for the poll workers etc now at
least in the common case where things
are working like they're supposed to the
poll worker does what the Machine tells
them to do
okay and again ballots are distributed
everywhere and you can add a machine
midday if a machine blows up midday not
a big deal we even have a hot spare for
the supervisor so the booths now one of
the things we have to worry about is
imagine a booth goes crazy and starts
announcing fake votes how do we tell the
fake votes from the real votes right so
okay basic crypto architecture every
vote has to be authorized the
authorization includes a nonce just a
randomly chosen number so any vote you
see that doesn't have a corresponding
authorization message must be bogus so
now in order for you to forge votes you
have to have an evil controller and an
evil voting machine working in cahoots
with each other that increases the
difficulty doesn't solve the problem but
it makes it harder and yes we're
encrypting the votes and i'll tell you
how later that's the encryption gets a
little bit tricky the supervisor can
monitor everything and can broadcast
authorizations and again we're
everything everybody records everything
we can have a backup all right well now
i've given you the pretty marketing
pitch let's talk about how how it fails
right I'm a security guy which means I
spend my life analyzing how things break
so let's talk about different let's
start with the simple failures and then
build up to the big catastrophic stuff
what happens if a machine fails well
again I've hit on this replication thing
about 30 times so the replication will
protect us from regular failures and we
can prove that a vote record on an on a
backup machine is legitimate by virtue
of the fact that it has a corresponding
authorization message every message is
digitally signed you know off the shelf
boring you know RSA type digital
signatures so no magic there what if a
late machine shows up you know we have a
log or longer queue of voters than we
expected somebody calls to election
central and says we need more voting
machines well no problem plug them in
and everybody can tell whether those
machines show up empty or
if they show up with votes on them you
know they're bogus because they're not
connected to the timeline hey ballots
cast on the wrong day well if the clocks
are wrong it's not a problem because we
don't care so much about the club out
the time stamps because we have the time
line either they're hooked into the time
line with the rest of the votes or
they're not so the timeline is more
powerful than the time stamps likewise
we could easily distinguish test votes
from real votes because the test votes
are completely disconnected from the
real election and you can imagine that
you're auditing or tabulation
infrastructure can look for that all
right stuffed ballots this would be sort
of the first thing if a machine starts
generating bogus votes you can
distinguish them from real votes because
they don't have the corresponding
authorizations if a ballot goes missing
you can detect it because the hash chain
will be broken ok so our basic
architecture here is already capturing a
lot of common fraud or error conditions
so what about bigger stuff ok Godzilla
is going to come and mess with our
election well one attack might be that a
group of evil poll workers who have been
running precinct 342 for the last 20
years and they've been deciding the
results of their precinct for all of
those years and they're not going to let
these new fangled II voting machines get
in the way of them deciding who wins the
election so what they might do is the
day prior to the election when they have
you know when the machines were locked
in the school cafeteria or wherever they
are they might sneak in and run a fake
election collect all the results and
then erase the machines run a real
election and then try to swap the fake
results for the real results so let's
call that a shadow election you could
imagine that they might also do that
post factor rather than prior to the
election how are we going to deal with
that well we can have what's let's just
call it a launch code so the election
administrator who might be concerned
about some of their malicious poll
workers on the morning of the election
announced
is a code you know six digit pin
something like that and if that pin
doesn't appear in the log then you you
know if the votes are not successors of
the pin then that means that the votes
aren't legit so that would prevent
somebody from staging a fake election
prior to the real election post facto
you'd let the way to solve the post
facto problem is you better make sure
that these pull the poll closed message
and it's appropriate hash and whatnot
gets tacked on to a bulletin board where
everybody can see it right the minute
the election is over that would prevent
somebody from trying to run an election
after you know just change the dates on
all the machines so we haven't got to
software tampering yet we're just
talking about people trying to
manipulate the machines as is everybody
clear on this because right now we're
going to start cranking up the evil the
power of the evil people yeah election
how did I prevent post facto fraud so
the threat model here is that our poll
our erstwhile poll workers are not
prepared to hack the software they're
simply prepared to set up the machines
and start casting fake votes again you
know hit the Clear button on everything
and then do a whole day worth of fake
votes well it'll take them by definition
a day to finish and if the polls closed
message has to be delivered you know two
minutes after the official close of the
official polls oh it's just a message
that you know all the machines echo
around and broadcast to each other I'm
done I'm done too I'm done too and so
all the machines agree that they're done
and all those done all those we're done
messages can then be announced which
would and if that's been posted to a
bulletin board like literally printed
out and tacked up to the wall that that
that casts that in stone as a put and
then it's harder for somebody to come
along and generate something later which
will yield that same set of we're done
messages at the end of the day okay okay
now we're going to crank up the power of
the attacker here's where it gets fun so
what if the attacker is prepared to try
to clone these machines and when a
concurrent shadow elec
so they're going to get the launch code
at the beginning of the day and they're
going to sneak in at the end of the day
into a presto change-o how do we prevent
that attack right well at this point now
we need to try to prevent the attacker
from getting a hold of the crypto key
material how do you do that well this is
where we have to rely on TPM you know
trusted computing ships my stupid little
lenovo laptop has one of these alltel
chips in it and it's not good for much
but if you believe the marketing it can
hang on to a crypto secret anybody here
have any experience with that you worked
on this stuff right yeah yeah so do you
believe that it has any value so it's
only like your PhD thesis work anyway
that's holding I can heckle back anyway
so I'm not I'm not claiming this is
going to solve the problem but at least
we can try to increase the level of
difficulty for somebody to get at the
key material by hiding it inside a
ceramic chip you know soldered to a
motherboard not perfect but a good start
okay anybody here from India 122 okay
two two and a half ok so in India
there's a problem known as booth capture
so I'm not making this up the way booth
capture works is armed evil doers will
show up at a polling place and like take
over the polling place and cast votes as
fast as they can until the police show
up and scare them away this seems like a
bad plot from the 1920s you know like
Groucho Marx kind of film but this
really happens in India like the current
Indian electronic voting machines have a
rate limit or built-in to limit how fast
you can cast votes as a countermeasure
to this very attack I find this
staggering but you know democracy is
wild and crazy what can I say needless
to say detecting this is not
difficult so what can we do as a
countermeasure to this attack well to
some extent you can imagine adding a an
alarm button to the administrator
console kind of like you know bank
tellers have the secret button under the
counter so you can hit the the alarm
button on the console and that would
mean that at least any subset you can
then have an epic and you know what
happened before the epic and after the
epic and then you could at least
separate out what are probably
legitimate votes from what are probably
illegitimate votes that's a start I'm
not saying I've solved the problem but
at least now I can detect one from the
other now if our armed assailants are
capable of you know bringing along I
don't know a degausser or something they
can certainly destroy former results if
you want I mean I can't prevent our
armed assailants from physically
destroying voting machines but if any
one of the hard drives survives I might
still have all the records yeah sorry
what about punch card slot okay so the
the question is what about after each
vote is cast why not print it out on a
punch card or some other paper mechanism
so if our threat model is armed
assailants taking over the polling place
our armed assailants can can attack
paper probably easier than computers
because they probably understand paper
better so that I mean paper is an
important ingredient in an election but
I don't think it helps against booth
capture all right so pushing onward
we're software people how many people
believe that the software that the
vendor shipped is the software that's in
the machine on Election Day why you're I
gave you a PhD you should know better
yeah maybe I should know better why did
I give him a PhD ok so the scenario is
that there might be malicious software
installed in some or all of the machines
and in fact we've added a new risk that
what because we've networked them
together one machine might be able to
attack another one over our local
network so that's what we've added a new
risk this could be introduced by poll
workers this could be introduced by
field upgrades you know somebody claims
to be you'll have a shiny badge and say
oh I'm here from diebold I'm here to I'm
here to help right maybe they're not or
even perhaps a voter can get to the
magic port on the machine somewhere and
dork with the machine somehow so this is
a very real threat because everything
else I've described is worthless if a
voter can tamper with the machine
because then I press the button for
Alice and at the summary screen it says
you voted for Alice and oh by the way
there are some human factors results
that say even if it said Bob two-thirds
of the people wouldn't notice so even if
you print it out on paper two-thirds of
the people won't notice if you print it
wrong so it's kind of important for the
software to be correct the human factors
dimension of voting is just a whole
other hour of mental anguish for you
that I'm going to spare you anyway hey
man ok maybe it's worse anyway the
two-thirds number is is a ballpark but
it's I'm willing to I'm willing to say
that it's a reasonable number anyway its
countermeasures to software tampering
there are really two broadway's are
actually three broad ways we could try
to attack it via paper records because
it's exceptionally difficult to
unprinted vented the unprinted maybe
somebody at MIT is working on it this
new e-ink i guess that you can unprinted
stuff but you can't unprintable paper so
that that's a start you could again go
the TPM trusted computing route that
might help prevent I mean at the very
least it might prevent the the crypto
keys from being released to unofficial
software so that has some value because
then everybody else could detect that
the results coming from a machine were
bogus
well I'll be talking about later though
is trying to throw some cryptography at
the problem in a way that we can do
real-time audits of the machines that's
that could be an entire hour long talk
by itself i'm going to give you just the
high points but we can throw some crypto
at this problem and actually come up
with a clever solution so I'm not
actually ending my talk early I'm just
wrapping up this phase of it in real
elections mistakes happen okay mistakes
are just a part of the game you know
data is going to be lost auditing is
both logically and physically
challenging and the question is how can
we throw technology at the problem my
proposal my modest proposal to you is
that we should network the machines
together locally replicate everything
everywhere waste CPU like there's no
tomorrow because we there's such a low
event rate that we can afford it and
entanglement plus broadcast of
everything helps us get recoverability
and there are a lot of other researchers
doing a lot of other clever techniques
in the electronic voting space and a lot
of that and it all composes well with
this system a lot of other people are
focused on tamper resistance we're
focused on recovery of data and you
could these these are you know two great
tastes that go great together so please
don't fear the network okay coming up
next I'm going to compress an entire
hour long talk into about two minutes
here and say that there's a technique
called homomorphic encryption which
broadly speaking has the property that
you can take to cipher texts to
encrypted things and anybody can do an
operation on them and yield the
encryption of the two plain texts have
they been added together so you don't
need to decrypt add and re-encrypt you
can do that all is one step and anybody
can do that step so they can yield the
encryption of the addition of the two
things now how can we leverage that we
have to use an alphabet soup of other
cryptographic techniques we have to have
something called a non inter
active zero-knowledge proof which is a
fancy way of that I can generate a
statement that anybody in the world can
verify that i have just encrypted either
a 0 or a 1 and I'm not going to tell you
which but you know i just gave Alice 0
or 1 votes and you can absolutely
convince yourself that I've done that
without me needing to reveal whether I
gave Alice 0 or 1 votes and then I can
prove that the sum of my votes for Alice
Bob and Charlie is 0 or 1 and as long as
I can prove all of those properties you
can convince yourself that that the vote
is not I didn't just cast 50 votes for
Alice again you have no proof that the
you I didn't cheat but at least you have
a proof that the vote is vaguely
well-formed the only other crypto trick
we need is that we can have the machine
we can do something called threshold
cryptography which means that it takes k
out of n machines to agree on the result
the encrypted result and if they all
agree they can jointly compute the
decryption of it so no one machine gets
to decrypt like partial totals or
partial sums or anything like that only
all the machines or k out of n machines
working together can arrive jointly at a
result that they can all verify so that
means that an attacker would have to
corrupt greater than K out of n machines
in order to corrupt the election so the
crypto can buy us some really neat
things and here's where it gets fun at
that point there's no danger to letting
an election observer actually watch all
the network messages go by we'd rather
the network observer not be able to
inject messages so we can do a simple
trick called a data diode Doug Jones at
the University of Iowa and one of his
students built this thing it fits into
an Altoids tin it just has a serial port
on one side a serial port on the other
side and ir and a little bridge man of
an ir you know infrared LED and infrared
LED detector and you can look at this
physical board and see there are no
traces going from the left side to the
right side so you can convince yourself
with this little stupid board that fits
into an Altoids tin is a one-way data
pipe and on the other side of that data
pipe heck why not put the whole the
whole internet
so now all of the results from every
polling place can be broadcast to the
Internet in real time so now heck you
can syndicate it with RSS do whatever
you want and you can let anybody in real
time audit the election as it's going on
that sounds kind of cool so there are
two other clever techniques we can bring
into play here one clever technique
which was invented by Josh bonello is a
simple cryptographic trick that impacts
the voting you I in one simple way you
have your regular voter experience who
would you like to vote for president
Alice which like to vote for Senate Bob
etc you get to the end and the Machine
said you say I'm done at that point in
the original been a low-vision the
Machine prints to a piece of paper
behind a plate where you can't see it it
prints a cryptographic commitment just a
hash of your vote so the machine has
been forced to commit to what your vote
is and the machine doesn't know that
it's about that when it's about to give
you a choice do you want to cast your
vote or do you want to challenge the
machine it's already committed but if
you hit cast then it just throws your
vote into the bucket like normal if you
had challenged then it's forced to
reveal the plain text of your vote which
you can then compare to the hash
commitment if it matches then you know
the machine was behaving if it doesn't
match you've caught the machine
sheathing provably so that same
technique can be leveraged excuse me
over the network and now you can imagine
a voter walking in with their iPhone or
equivalent and then we have to be a
voter they can say I'm an election
observer here from the country of whosay
Watson Stan to observe your election and
I want to challenge machine 5 now and
they can bring their video camera
pointed at the screen and as and you
everybody can watch them like a hawk to
make sure they don't accidentally press
the cast vote button and they can go
through the whole dialogue hit challenge
the Machine didn't know it but all the
people did and you can now catch the
Machine cheating by watching the results
in real time over the Internet so this
and you can even imagine the League of
Women Voters having a rack of servers
where they can verify all this stuff in
real time League of Women Voters
syndicating over Rs
you can do all kinds of cool stuff right
now we have so the second cool thing
that we can do is that we've built a
whole first order predicate general
purpose validator so we can write rules
that says for every cast vote message
there must exist a corresponding vote
authorization message and they better
have the same notes or for every cast
vote there had better exists a pulls
open message and it better be the same
polls open message so we can write all
these predicates and we can evaluate
them and with a bunch of performance
tuning that people hit that some people
here would find brilliant and some would
find really boring we've got that down
to about 4 milliseconds per message
which given that our message rate is
messages per minute so where were
several orders of magnitude ahead of the
game and that will give us some room to
spare which will hopefully I mean our
next research goal is to get the
verification up to the point where I
mean my goal is to have you know anybody
who wants with their home dsl line with
the cpu power of a home machine be able
to validate a million votes from an
election in real time that's the
research goal and i think we're going to
hit it okay so i'm going to wrap up here
take a couple questions and then i'm
going to tell you about the california
top to bottom review so let's do a
couple questions and then i'll tell you
how not to build a voting machine
now
so the question is what if the vendor is
evil is that is that is that a
paraphrase of the question so this is
where that hole at some point you have
to have something you trust so standard
answer number one is paper have the
machine print paper which is then the
Machine committing to some ground truth
which which can be independently audited
the problem with paper is voters don't
check it the other so the the the snazzy
crypto answer is that you should be able
to walk up to any machine at any time
and challenge it in the way I've broadly
described and then you can catch a
machine in the act of cheating now let
let me flip this around let's say that
you know one percent of the machines are
challenged well and the machines don't
know that they're being challenged
versus not challenged so as long as
there are just enough challenges the
odds of a machine getting away with
cheating start you know shrinking
dramatically and if the legal wound
voters hires themselves you know
somebody who's done basic you know
probability and statistics then they do
you can you can drive that number as low
as you want not perfect but a good start
so the challenge mechanism depends on
somebody who is not evil being willing
to do the challenging so what that
typically would mean in modern political
practice is if the election
administrator happens to be a Democrat
then the Republicans are going to be
very interested in auditing the voting
machines and likewise if the election
administrator happens to be a Republican
the Democrats are going to be very
interested in auditing the voting
machines and this is one of the curious
things where you know whoever is on the
other side tends to be suspicious of
whoever's in charge so they'll do
auditing and you know the league of
women voters will find the local
computer scientist and get them to go do
some auditing and you know this I think
this could work but auditing is clearly
required if you don't audit you don't
have any idea what's going on so when
you talk about recovering from the
election is it can you actually recover
the results or is it more question of
detecting that something went wrong well
the answer is how much damage was done
if somebody went and physically
destroyed each machine and degauss to
every hard drive there's a limit to what
i can do i can probably detect it but i
might not be able to recover the results
right and so what happens in any
political universe if if votes are lost
well you say what is the total number of
votes cast in precinct foo is it greater
than the margin of victory if so oh boy
if not whatever and that's that's how
that's how it works in practice yeah
in the event when good event stop right
in the actual image law the actual votes
can you tell me so the votes are
actually recorded in the order that
they're cast but encrypted and so far
the crypto that I've described to you
requires a coalition of the machines to
get together in order to compute the sum
and decrypt it and all that you could
also imagine encrypting the votes with
the public key of the election
administrator or something so you could
build a you know oh boy back door into
the system and then you have to talk
about well okay we better do some
threshold crypto and have some trustees
who are in charge of the key material of
the back door that would be a whole
separate engineering discussion but to a
cryptographer that's all yeah sure we
can do that it's not novel from a
cryptographic perspective it's just a
matter of engineering the right
properties so shall we push on and talk
about the State of California's top to
bottom audit ok this will chew up just
about the right amount of time I'm now
going to blast through a bunch of
unrelated slides that would be lots of
fun if we had another hour but we don't
and talk about the California top to
bottom review of its electronic voting
machines this occurred this very summer
it was commissioned by your secretary of
state debra bowen very nice very nice
woman very smart actually and what
happened was Dave Wagner UC Berkeley
gave me a call early you know like in
May and said hey Dan I got I got I got
something for you want to do this I was
like really sign me up so we got SR I to
give us some unused office space in a
dark corner we had some you know old
1950 steel case desks you know
state-of-the-art technology and this was
the biggest study of its kind ever you
know 40 40 plus researchers bunch of
grad students bunch of faculty type
people like me there were source code
teams i was on the source
team for one of the vendors red teams
who had access to the physical machines
could poke at them documentation people
who read all of the voluminous filings
that they're required to have and even
an accessibility team to make sure that
the wheelchair actually fits under the
place where it's supposed to fit you'd
be amazed at how like these many of
these machines weren't wide enough to
get a wheelchair close enough to them I
mean stupid stuff anyway three vendors
were considered that's the URL if you
don't want to write it down if you go to
Google or your favorite search engine
and type California top to bottom you
will find this you might think that
California top to bottom might find some
other interesting search results but
apparently voting system is voting
systems are more popular somebody here
might need to work on that ok so we as a
group found significant flaws with all
three vendors and for each vendor we
looked at all of their products their
optical scan their computerized things
ever the tabulation that works in
particular we found viral attacks let me
explain that again voting machine virus
okay let me say that one more time you
corrupt one voting machine once and by
the next election they're all corrupt
cool as a result of all this diebold and
Sequoia work quote decertified and
conditionally recertified which is a
complicated legal way of saying that you
can only have one per precinct and a
huge number of restrictions on how
they're used so that way they can
satisfy accessibility requirements but
most voters are in the state you are
going to vote on paper and that's a good
thing hardener Civic initially they got
a slap on the wrist and myself and the
people on my team Eric rescorla hohokam
and see new in gava said ah no and I'm
pleased to report that after months of
going back and forth to Sacramento and
all of that we've they have now issued a
read some revised conditions
that recognize that things are pretty
bad and I'll talk about what this means
in just a second so this is a heart
inter civic east late this is what I
vote on in Houston Texas it is not a
touchscreen it has this like ipod wheel
thing and you dial down to who you want
to vote for then hit the enter button
that's the basic UI pretty
straightforward and oh by the way their
network together this is the only major
vendor voting machine there's a polling
place network so do they use crypto yeah
kind of they use H max Shaw 122 as an
integrity protection mechanism on the
votes unfortunately every voting machine
in the entire county uses the same key
anyone see a problem with this
architecture the key is not exactly a
secret and that kind of defeats the
whole point of an H Mac the keys are
supposed to be secret so it's actually
really trivial to forge this or to get
ahold of the key and then start for
drink or whatever they actually so hard
in our Civic uses openssl they have this
concept called what do they call it the
idea is that you might collect results
at these regional processing centers and
then mode on them home to election
central not a bad idea you know if
you're in a big County likes a West
Texas there are some very large counties
and not needing to physically drive data
to election central is a good thing well
they used openssl but if machine sees
assert that it's never seen before it
just pops up a dialog box with all the
x.509 stats you know name company
whatever without anything to do with the
key which means that you can for you can
do a self-signed certain put anything
you want in to all of those proper name
fields so you can trivially forge a cert
from anybody and get it accepted as long
as a human being says yeah that looks
okay and hits the ok button so they got
openssl wrong there's no other crypto to
speak of on the network all the messages
are plain text the network protocol the
most interesting feature from the oh my
god perspective is they have messages
that read and write memory in
the voting machines directly please give
me bite ranges X to Y please thank you
so that means you can extract that H
matki you can extract the votes you can
you know do all kinds and you can write
to any address in memory which means you
can overwrite the code you can overwrite
the votes you can overwrite anything you
want in the memory of any machine that's
that's also a tasty way of injecting
viruses and regular voters in the voting
booth can reach behind the machine and
unscrew the port and speak this protocol
it's not Ethernet it's some bizarre EIA
485 thing mod so this is also something
that shows up in the skater universe
it's a it's it's you know weird from our
perspective normal from embedded
people's perspective yeah you can buy
you know USB adapters for your computer
anyway so here's the viral attack so
there's this thing called servo which is
used at the end of the day it does
inventory management it lets you
extracting data from the machines clear
the machines etc so each of the machines
at the end of the day has a little you
plug it into servo it checks it in yep I
got serial number foo the next machine
comes along and eventually you hit a
machine that was evil because one voter
corrupted one machine servo as it turns
out is full of buffer overflow
vulnerabilities so now you take over
servo which can promptly use that memory
overwriting technique to blast the next
machine that it talks to ad infinitum
and now all the machines are evil in
time for the next election one voter can
do a ridiculous amount of damage so once
a machine has been compromised the only
way you can fix it is with screwdriver
open up the back replace the chips
inside the machine that sort of a thing
I mean the official software upgrading
tool that Hart uses when they upgrade
their own software uses these very same
memory read and write commands needless
to say once you've taken over the
machine you can happily ignore all of
that
so oh by the way a couple other fun
things these machines support headphones
which is a good thing if you are blind
or have low vision or have some dyslexic
type condition a lot of different people
can benefit from having the machine talk
while it works and anybody who wants you
i went and voted one slice it can i use
the thing with the headphones they said
sure are no problem and so i put on the
little headphones and as you're clicking
whatever you highlight it just reads
yeah President George Bush President Al
Gore president you know whatever it just
it just reads what's under the cursor
very straightforward well turns out that
you can receive this with a shortwave
radio at a substantial distance which
means that you can hear the machine
chatting away I mean the room that they
were in they could get about as far away
as from here to the back of the room
that was the size of the room they were
in and anywhere they went in the room
they're a little short wave radio the
accessibility team discovered this both
this guy named Knowle Runyan he's
awesome anyway another interesting
feature lets you adjust vote totals in
the tabulation system now if if if
somebody came to you and said I've got a
feature requirement we need a way to
adjust vote totals how would you
engineer the adjust vote totals solution
in your voting machine a would you add
an entry to the database that said
adjustment for this entry is plus 2 or B
would you overwrite the number that was
already there in the database who votes
for a who votes for be well guess what
they just overwrote the number in the
database which is staggering I read the
I was reading the you the manual and it
said here's this feature I'm like her so
I went I'm like you know looking for the
SQL code in the source code and sure
enough they just blasted right over it's
staggering anyway so needless to say
diebold which has now renamed itself to
premier and Sequoia heads
of comparable magnitude to what I've
described in heart in her civic esns
which caused all the excitement in
Sarasota last year was not considered in
this study because this particular
machine isn't used in California what's
coming next well other states will
hopefully follow California's lead and
realize oh my god and do something about
it like this notion of limiting the
number of diaries' used and shifting
some or all voters over to paper that's
a good thing I support that and likewise
mandatory audits of a ver we could talk
about auditing for the next hour vendors
will hopefully engineer better products
you know hopefully publikum if public
embarrassment can't do it I don't know
what what can and needless to say
optical scan paper ballots are growing
in popularity so that's all I've got to
talk about for today do I have time for
any more questions I think we've got
time for will call it three questions
all right let's do it yes so are any of
the vendors looking at some of the work
you're doing or other Ruben or all the
folks and responding ah are any of the
vendors responding the vendors right now
are in a defensive posture I was invited
to testify at a hearing in Tennessee
where all the vendors got to speak first
and then I got to go and let's just say
that they were in cover your posterior
mode and they are not yet ready to hear
about how they need to re-engineer their
systems maybe they will but they're not
there yet meanwhile we do have an
election coming up soon don't we yeah
other questions
how common are these voting machines now
across the country in the 2006 election
approximately 41 percent of the votes
were cast on some variant of electronic
voting machine fifty percent were cast
on some kind of paper and nine percent
other the numbers in 2008 are probably
going to be of Camille comparable of the
electronic voting machines how many are
operated by this small cartel and what
hope is there that there will be more
diverse marketplace so the there are
probably four vendors who have the
lion's share of the market place and I'm
not going to go so far as to call them a
cartel there's a favorite quote of mine
from Bonaparte Napoleon which is never
ascribe malice what can be adequately
explained by in competence that is very
much the situation that the voting
system vendors are in today we don't
need malice to explain where they are
what can we do to address the problem
you know of course right now the same
vendors who are selling the optical scan
systems are the ones who previously sold
the electronic voting machines the
problem is that people who are really
smart computer scientists for some
reason want to work at companies that
give them free food and you know free
t-shirts and stuff and that for some
reason these kinds of people don't want
to go work for small vendors with no
budget and they're controlled by
marketing people rather than engineers
let me describe a market to you and you
tell me whether you want to do a
start-up in this market you have 50
states with different regulations for
your product sometimes contradictory
like Texas says you must have a summer
you must have a straight ticket voting
option California says you may not have
a straight ticket voting option so that
means you have to do 50 separate QA
processes for 50 separate state builds
of your software or maybe you're smarter
through to config file
whatever you have to deal with 50
separate state regulatory processes and
ultimately you're selling to county
clerks who don't understand the
technology you're selling it all and are
more likely to be influenced by their
buddy who they used to work with who now
represents a vendor so is that a market
you want to jump into the sell a product
does that sound like a great startup
opportunity no so unfortunately you know
the the brilliant people of Silicon
Valley who want to make lots of money
are rationally not getting involved in
the voting machine market so my hope for
the future of the universe is that you
know academics like myself can build can
get our research prototypes up to the
point where we're confident that they
work reasonably well and then you know
GP album or something and really reduce
the barrier to a vendor the market that
I would like to see evolve if I was king
for a day which in a democracy is
moderately ironic I would like to see a
market where there's some central
organization that is a non-profit who's
in charge of the software and then have
a standard spec for the hardware that
multiple vendors can compete to sell
into and they also commoditize the
hardware have the software be written by
some government pseudo bureaucracy and
let you know if there's only one hunk of
software there can be a lot more
attention to auditing it and getting it
right well that's the way I would like
to see things happen is that going to
happen any time soon I wouldn't I
wouldn't you know I wouldn't bet on it
well on that note I think we're going to
have to finish up so let's thank the
speaker
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>