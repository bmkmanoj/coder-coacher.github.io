<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>PhotoTechEDU Day23: Raw Files and Formats | Coder Coacher - Coaching Coders</title><meta content="PhotoTechEDU Day23: Raw Files and Formats - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>PhotoTechEDU Day23: Raw Files and Formats</b></h2><h5 class="post__date">2007-10-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/gLw0A-Y8rQk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">ok welcome to the twenty
heard in a series of photo tech lectures
today we're very happy to have with us
David Cardinal from pro shooters he's
he's got a a rock conversion software
program that he sells called digital pro
and he's written books on nikon d 1
series cameras i think the first book
that talked about raw files and rock
conversion and has done a lot of cool
stuff in software and photography he
leads like wildlife photo tours to
various interesting continents far away
and some of his info over here if i'll
check it out later let's get into the
talk david thanks can everybody hear me
ok great thanks thanks for inviting me
thanks dick for inviting me I've done
quite a few of the line brothers for for
a long time so so he's fun to do
something with him i worked with Bob and
Tom at Sun Microsystems a long time ago
hey hi I know high from the tennis court
since my daughter back there and a
cardinal who is one of the few people
into it doesn't shoot raw she shoots jpg
but every time she wants to use one of
my files she has to work with my raw
files so she is really curious about why
she could do all this stuff with raw
files and not JPEGs as civil you should
come to this talk I am coming at the
subject primarily as a photographer I do
lead photo safaris and there's some
information on that there but I have a
strong technical background and out of
necessity starting in two thousand
started hacking on raw files and dick
asked me primarily to address the whole
topic of raw file formats and raw files
and not as much on raw file processing
because I guess he's already given a
talk on the image processing pipeline
however it's important to know something
about that image processing pipeline to
even understand what's important about
raw file format so we'll go back and
forth and talk about raw files and about
processing raw files I'd encourage you
to ask questions because this talk is a
little bit unique I don't think there
are too many audiences that would
actually want to come to a talk just on
raw file formats I've given it it let
this talk but a similar talk at
Microsoft at one point
about the only other place that you know
that's what people want to hang out and
hear about so talk about raw file
formats some background on why they're
important what's in them some thoughts
on how they get hacked and why and
issues about them I think one of the key
reasons I was willing to give this talk
is I think raw files are a like the
global warming of photography which is
there this problem that's going to mount
over the decades at the rate we're going
and it's going to get worse and worse in
terms of their sustainability and our
capability and we'll talk about that so
it's not something that people notice
today but it's going to it's going to
grow as a problem and we'll talk about
the future of raw files the first thing
that's I think important as a background
is why would anybody care about raw
files does everybody know what row files
are in principle and it's good son this
is illustrations from an article i wrote
for outdoor photographer on raw files
back got almost five years ago now when
when it was important to tell people why
you would want to use one it's simply a
raw picture of the Golden Gate Bridge
where I changed the white balance from
warm to cool and in that one action I
can now take my my image my stock
photograph and use it in two very
different ways as kind of a moody
evening shot or a morning kind of
standard scenic shot so the raw file
because it's trying to explain this to
Anton the car on the way over and I
guess you think of it as robbers is
cooked when you have a raw piece of meat
you have a lot of options you can make
it rare or medium or well-done and we've
got a JPEG it's essentially already been
cooked a certain way and it's not going
to be any worse than one of those ways
it's just that once it's already cooked
medium well you can't go back and make
it rare anymore so the industry i think
has done a disservice by saying raws are
better than jpeg and I think that's kind
of bogus it's like saying a raw steak is
better than a cook steak it's not it's
just that you have more options on how
you cook
and that's where the benefit of raw is
delayed processing yes which does this
only works and Rafael so this is
something you can ah but let's see
that's that's that's putting the cooking
step out of order i think oh it's
supposed to repeat the question the
question is what about things like noise
reduction that can only be done with raw
files the tricksy that's part of the
cooking so say you took that same noise
reduction software and you put it in the
camera it would be part that the point
is you can you can do everything to get
to that JPEG when at some point the
camera does have a lot of noise
reduction software in it so the key
isn't that I mean your points you it's
limited because it has to be done in the
camera but it's not limited conceptually
it's only limited because the camera in
size if in a sense is limited and time
that's right so the flexibility is huge
that's right you know that once it's a
JPEG you can't go back and undo things
but the point is it's not necessarily a
worse image it's just been cooked a
certain way maybe it's been cooked in a
microwave instead of a really nice wood
fired oven or whatever but it's not that
because you shoot raw you get a better
picture you just have more options to
create possibly better results well I
think it's important because the camera
companies all talk about it like if you
don't shoot raw you know you're you're
like getting shitty pictures or
something like that and it's it's it's a
little bit misleading so sure you can I
shoot I shoot a hundred thousand raw
images a year okay so I'm a huge fan and
I have them for different noise
reduction software's that i use on them
so i'm with you as a practical matter i
just the industry has a tendency to
oversell this stuff like it's a panacea
so rough history of raw files 2000 is
practically speaking where they started
for most people boy the original phobia
might even predate battle i guess it
didn't have the raw files anybody could
you
is ok that was the d1 and the only
software that would process it was Nikon
capture which is a five-hundred-dollar
piece of software at the time 2001 saw
the beginning of a third-party raw
market the nikon D 1x came out I think
Canon got his first DSLR out by then we
had digital pro in the market by then
eric hyman had Bibble on the market and
dave coffin had a freeware converter DC
raw all three products are still there
but they're now lots of other products
obviously especially adobe and apple
both do a lot of raw conversion and you
guys in Picasa have raw but most people
who have raw converters either start
with David coffins code or they license
Eric's libraries from Bibble I don't
know if picasa did one of those things
or not but they might have typically
that's what most people do more recently
there's cameras that will shoot both a
raw and a finished jpg there's
compressed raw we'll talk about that and
then now there's more and more support
for raw files in various pieces of
platform software in the Apple OS adobe
and its products through Camera Raw and
we'll talk about the white balance flap
as well and what one of the things i
think has gotten exciting and a little
bit confusing is that one of the things
people like the most about raw i think
is the non-destructive editing notion
that your settings in Camera Raw your
raw converter can be maintained
separately from your raw file well of
course people are not realizing that
that same thing could be applied to any
image format so you're starting to get
non-destructive editors that are
bridging the gap between the raw
processors and full editors like light
zone from light crafts Lightroom Camera
Raw itself aperture so it's I think
it'll be interesting over time as the
industry figures out which of these
capabilities are features of raw files
and which ones are just features of a
future editing paradigm that involves a
lot of
active image processing okay the meat
and I've tried to put someone
appropriate pictures alongside the words
here so it's like the opposite of and
Stephen Colbert they have the thing
called the word where he talks and they
show weird were its longing to talk and
show weird pictures these lines are
submit my meat picture I'm not going to
use this very often but they're getting
this uh what's left of this water
buffalo one thing every raw file has in
common is fundamentally the image data
which i guess go without saying in
almost all cases that we care about the
image data is a 12-bit integer from 0 to
40 95 which approximately represents the
voltage or the photon counter or
whatever at that photo sensor site and
in the beginning this were very simply
encoded and they just slammed down 12
bits four bits four bits 12 bits and
then people started to figure out that
they could compress them they can encode
them different ways they could get
clever about them they can encrypt them
and then sewed a lot more options for
encoding but basically it's a linear
encoding at each sensor site and we'll
talk about that a little more detail for
the most part sites are in a bear array
and I'll show you a picture that for
people that don't know what it is but
it's a a color layout that allows you to
do RGB with monochrome sensors so we're
photo sites so in it in your camera
sensor and that's probably most you guys
already know this the sensor itself is
is not color sensitive it's just a
photon electron counter or photon
counter but on top of that as little
micro lens with some spectral response
curve that only allows or mostly only
allows light to come through that's in
some set of wavelengths and in order to
create multiple colors the typical way
to do that is you have some sites that
are approximately green some that are
red sums are blue now some cameras some
of the coolpix models for example do
with a see my instead of an RGB or they
used to I don't think they do anymore so
there are some other ways to do that
there's also the Sony uses an emerald
fourth color and then of course there's
a phobia or dick work which DS is a
whole different system where they
actually have multiple color renditions
from a single photo site but for the
most part they use one of these bare
arrays that I'll show you and as a
result what you wind up with is you
don't really get RGB you get this sort
of at each place you get how many
photons correspond it to a particular
spectral piece of the spectrum so to
illustrate that I'm going to take this
race car image and just take a little
tiny piece of the seven off the race car
and show you a little bit of what that
looks like as we go through this is wow
that looks through the image pipeline
this is the raw data that you would see
if you actually looked at the bare array
you can see it's green blue red green
green blue red green and they start and
in the file format there's normally a
field that actually tells you what the
bear array layout is in which color it
starts with and for the most part the
camera vendors actually use that which
is nice it's one of the few pieces of
the raw file format it's actually more
or less self-describing is the barrier a
layup when you interpolate it you get to
hear you then have to tone map it color
corrected we'll talk about some of these
stages to get to the final image but
that's when people talk about raw file
formats and the work they have to do to
process them it starts to look like that
as you go along that's the actual sensor
data now you can see a couple things
about the sensor data one is it's really
dark because display outputs are used to
this kind of gamma ramp where we really
bump up the mid-tones and the device
input device is linear so it has to be
tonemapped you also can't see too easily
from here but the Reds are
are very very muted and we'll talk about
why that is and that's not true of all
cameras so another tricky part with the
raw image is it's not all colors don't
have to be created equal and the camera
vendors have started monkeying with
these micro lenses to give them the
maximum rendered gamut on the output
side but as a result the actual Road
data looks worse and worse in a lot of
ways so the first d1 that when it came
out the raw image when you just
displayed it on a screen actually look
pretty good because the sensor itself
was calibrated by I I think not not by
machine to look like an ntsc television
to basically play out ntsc but what they
realized was that limited the gamut of
the camera NTSC and so what they decided
to do after that was actually play with
all the primaries although the micro
lenses in such a way that they could get
the maximum possible theoretical gamut
but the actual pre-processed image
started to look awful and then it had to
be you know ground up with a set of
mathematical transformations like the
matrices dick was talking about in his
talk to get you into something you could
actually read so for people looking at
raw file formats just finding the image
data initially was like hey great we
have the image we can display it and
suddenly the new cameras came out like
oh wait a minute we're just playing it
looks awful yeah what's wrong and then
it's like okay we have to now do more
and more math and more and more
processing so this is a typical bear
pattern there are twice as many green
photo sites because the human eye is
really sensitive to green as a
substitute for luminance and it's in the
middle so it makes it more important
that's not why that image looks green
necessarily it's also because these Reds
have been very muted any questions so
far
this making sense to people yep vcenter
oh so she pulls his bare hands
yeah that's a trick except for the fovea
on marketing brochure oh yeah sorry the
question was we talked about the
resolution of the sensor are we talking
about the resolution in photo sites or
in if you will true pixels and this is
this is one of the issues Phobians had
is that the way the industry talks about
it it's strictly photo sites so this
would be one two three four five six
seven eight this would be eight by
whatever and you sort of kind of can
generate eight pixels from that but
you're inventing two-thirds of the data
right because it each pixel you only
have one color and you can get better
and better at inventing the two-thirds
of the data and interpolation algorithms
are getting better but you're inventing
it and one of the the tricky parts in
the fovea on sensor you got all three
colors at each site but the apparent
resolution spec wasn't as high so they
were having this problem of like well a
three they were trying to say a 3
megapixel phobia on was as good as it
like 8 megapixel or 10 megapixel bear
array camera but that's a very hard
argument for people to get because
they're used to like well how many
megapixels is it and so yeah the way the
industry agreed to count is that each of
these as a separate pixel and it's an
issue because as these guys get smaller
the noise gets worse and worse and you
now have because each you know set of
colors is broken up into here you have a
lot of noise artifacting going on when
those pixels get small and it's gotten
to be a almost a dominant problem in
some ways because they can now make
these 12 16 megapixel sensors or 8
megapixel sensors even these kind of
like this one can and sent me to play
with this 7 megapixels or whatever and
it's got a sensor prior to smaller than
my thumbnail so the noise suppression
has gotten to be huge
to give you a sense of how that the
color changes this is a human visual
system and what we more or less see is
red green and blue you can see in the
nikon d 1 classic the sensors the micro
lenses were kind of tweaked to be quite
similar to this except they had a
problem a little bit in the Reds where
the cut the full off and the Reds is
quite sharp and it didn't mirror quite
as well so that was always a trick with
it the original d1 but you could
basically get that raw data right out of
the bear array to a real simple bilinear
interpretation and you'd wind up with an
image that you could basically send to
an editor practically it needs
sharpening a little bit and stuff and
told map it but interestingly in the d 1
X and H for example and much more common
in cameras now is to avoid they did a
couple things they put a sharper I are
cut off filter and all these cameras
have to have an infrared cut-off filter
because the silicon is sensitive up to
about eleven hundred nanometers up into
the infrared and of course your eyes
only sensitive to around 700 nanometers
if you look here at most and if you
leave that unmasked it means that if
you've got like warm cheeks they
suddenly show up as like a really bright
red which the canon 1d s had that
problem so people had to use hot mirror
filters and all this stuff on their
cameras so instead the vendors put the
sharp cutoff I our filters in but unlike
digital signal processing these you know
these chemical filters have limited
accuracy they can't just slam it down at
700 so as a result they took a lot of
the red out and you wind up with a
non-color balanced image so starting
with about two thousand one there had to
be look-up tables for every camera that
gave you corrections and essentially
they became matrices for the primaries
used in the camera this red green and
blue and how you have to multiply them
out to get something like the human
visual system or
actually not to get a adobe RGB red
green and blue or srgb red green and
blue but to be more more uniform and
this none of this data this data is
published this is all data that we
figured out both for the book and for
our raw converter by hooking up what's
called collimated light or single
frequency light and shining it on the
camera sensor every 10 nanometers from
400 to 700 or 300 800 whatever we did
and then watching the and then taking it
and looking at the raw file and looking
at the counts at each photo site and
basically calculating these things so
this is stuff that in a lab you can do
and it gives you a really good analysis
of the camera but the camera companies
all consider it proprietary so they
don't tell you any of this which is
interesting is in the old days Kodak
with a film curve or fuji with a film
curve you could go to their website and
they'd have a big chart here's the
film's response to every kind of light
and that was considered part of the data
sheet for the film well it's no longer
now its proprietary and that's one
reason there's this big dust-up about
stuff like raw file formats is the
camera companies are trying to keep a
lot of this secret and the industry
spends a lot of time trying secrets out
of the raw files and the result is you
wind up with a format that's kind of
brittle because one side is trying to
hide stuff in the format it cites trying
to get stuff out and yet at the same
time the photographer is kind of stuck
in the middle because it's my digital
negative now I want to keep these raw
files for a hundred years maybe or a
thousand years just like I could have
kept a film negative for a hundred years
at any rate so the first step is to
interpolate which you can imagine a real
simple version is you add up the greens
and you know kind of divide by two and
fill them in and and you get something
like this there's a lot of science being
done in interpolation algorithms to
maximize the signal minimize the noise
get color accuracy so everybody's got
some secret sauce involved in there but
fundamentally it's just a you know you
add divided simplest case and that gives
you something that looks dark but at
least recognizable there's another thing
that's I won't go into too much because
it's more image processing but if you
notice on the sensor one of the problems
you have here if you have a one pixel
wide red object and it falls on a blue
column it's invisible so you've got a
problem that you're a parent sensor
resolution isn't as high as you'd think
because you miss potentially half your
colors so there's a blurring filter
technically it's a low-pass filter along
with the IR filter on your sensor and
sometimes it can be removed and
sometimes it can't they call it
anti-aliasing filter and what it does is
it blurs everything by about a half a
pixel so unfortunately we spend all this
time and money building the world's
sharpest lenses high resolution sensors
and then we put a blurring filter in
front of them which you don't have to
sharpen away again later using Photoshop
or the camera does it if you have it
produce a JPEG or whatever so that's
another thing people get confused about
they look at raw files and they try and
figure out the sharpness of their camera
or their lens it's like well it's tricky
because here's a step in there that's
arbitrarily blurted a little bit so you
have to kind of back that off with some
sharpening before you can say you have
your your image of what the sensor saw
you know one of the things I found
interesting in our rock convert that
some cameras have non-square pixels so
the D 1 X for example from Nikon is a 6
megapixel camera but it's basically like
four by one and a half it's not two by
three so they're rectangular pixels and
at first we thought oh gosh how are we
going to interpolate that turns out it's
really simple you just feed the inputs
and outputs and the same algorithm works
exactly but this whole
epilation stage has all these tricky
things and you're asking about how you
calculate the resolution that's another
funny one nikon has no qualms about
saying it's a 6 megapixel camera but you
can make a theoretical argument that
four by one and a half isn't as good as
two by three when your output sizes two
by three but its marketing I don't care
they have six million photo sites at six
million pixel camera white balance we're
going to talk about a little bit that's
the next step and it's separate
from-from that color transformation the
color transformation is to adjust for
the fact that the camera is tweaked so
that all the colors don't come in
equally the way the eye sees them white
bells is a different thing and it's
something that the camera the reason I
want to talk about this has been a big
flap about white balance in RAW files
recently and we'll go into that a little
bit the camera doesn't adjust for the
light source like when you come in here
and you look at somebody's t-shirt like
that you say that's a white t-shirt now
it looks completely different here than
if you took it out in the sunlight but
your brain reacting to the visual clues
of the environment that's amount of
light and the fact that you know most
people have white t-shirts or whatever
says okay that's white and then it kind
of correlates everything else the camera
doesn't do that so that t-shirt in here
looks completely different than it does
outside so if I showed you the picture
of the two without correcting for it
you'd go well that's nuts t-shirt looks
blue or it looks red so the white
balance correction basically is the same
as we used to choose different films
it's to make something that's supposed
to be white looking gray or whatever
tone look that same tone independent of
the light source now the reason that's
important in terms of the file format is
to some extent the camera can try and
figure that out and you can set the
white balance on the camera or the
cameras all have what's called auto
white balance and an auto white balance
the camera tries to figure out
what the white balance of the scene is
now historically cameras were so bad at
that nobody really cared what the camera
thought because afterwards you could
probably do a better job of figuring it
out on your own anyway but with a newer
cameras like the d2 series from Nikon
there's an external color temperature
sensor on the top of the camera that
reads the ambient light and if you're
standing in the same ambient light as
your subject it's very accurate and
therefore the camera knows the white
balance of the scene now if I'm an event
photographer and I have two thousand
images I want to get to an editor and I
shot him on auto white balance I want to
process those raws automatically and use
that auto white balance the problem was
nikon decided that it didn't want other
people to know what the camera thought
the white balance was so they literally
encrypted that data so you couldn't read
it back so now if I'm Adobe and I have
Camera Raw say and I want to take those
two thousand files and process them and
it's the way with the correct white
balance I couldn't do it I could look at
the image and I could use an algorithm
to guess what the white balance was
based on the image but here have this
perfectly good piece of data from a
color immature and the vendor the camera
vendor is saying no you can't use that
only our software can use that and so
that's an example of the kind of
metadata war that thats starts when this
stuff gets hidden and encrypted now in
that case they cut a deal and Adobe now
has a special mini SDK from Nikon that
lets them read back this particular
thing now that encryptions been hacked
anyway it was hacked in 72 hours and the
source is on the web it's public so
anybody but Dobby was like well we have
copyright issues we don't want to have
decryption code a license so it had
spent three months negotiating with
Nikon have a little mini SDK to decrypt
this data which is in these files that
photographers are thinking of as digital
negatives that are good for a hundred
years and now that leaves a little turd
thing and I'm like a little encrypted
instead of it being in some nice ansi
standard you know here's the white
balance data so it's really it's for us
writing as a as an industry I think
simplistically the other thing that
cameras can do and many of them do and
they put them in the image which is kind
of nice they don't record the white
balance necessarily in Kelvin which I
won't go into that too much but that's
that that's how warm or cool the light
is they actually put a multipliers in
there for how much to multiply the red
color by and the blue color by so that's
a piece of data that's in the raw file
for most cameras is those multipliers
and these are ones we just picked out
from some of the older cameras because
from the book we did so if you set your
camera to sunny then the image data
would have a metadata saying multiply
the red x 2.5 and 2.15 in the blue x
1.25 etc the question
yeah for one balance is simplistically
really simply generic white balance of a
warmer cool color temperature is really
just about red and blue rotating around
the green now the truth is there's a lot
more complexity than that if you look at
camera raw for example it's got two
sliders for light but for white balance
and the top one is not red and blue it's
like red and yellow on the bottom ones
with yellow and green I forget but
there's two they've broken it down two
different ways there's also white
balance of like fluorescent lights which
are missing pieces of the color spectrum
so like a fluorescent actually it's got
an internal set of code that doesn't
just do this it actually then does muck
around trying to amplify certain parts
of what it thinks a signal was because
you're you're missing data when you take
a picture under fluorescent light
because you didn't get a lot of the
spectrum but simplistically it's just it
rotates red and blue around green real
quickly I'm going to go through this
piece because one of the other places
that the the raw file is so important is
it got this full 4096 levels of tonality
if you will from bottom to top at the
end of the day you can print maybe a
hundred to one if you're lucky your
display unless you have a very very
expensive display is only going to have
an 8-bit driver anyway so it can only
display 256 different levels at maximum
so it's not that you need all four 2000
levels it's that you want to
intelligently map them to your output
and to go back to the raw cook thing
what happens with this shows by the way
is that the funny thing about linear is
the top half the top stop of your image
is represented by 2000 levels so you
have huge total variation possible in
the brightest part of your image so the
part that's the brightest your sensor
can hold two half as bright gets two
thousand levels down here
the same ratio of two might only have
128 levels or 64 all the way down to
almost no levels so even though a camera
has a theoretical dynamic range of 11
stops say realistically these down here
have almost no levels of a total
variation in them and when you add in a
noise the top the bottom two or three
stops are almost useless anyway because
your your mb annoys is is more than that
so what happens is the cameras at some
point or your raw processor remaps this
whole thing into 256 levels for your
JPEG or your 8-bit TIFF if you do an
8-bit TIFF and it tries to map it in an
intelligent way but for example your
2,000 highest level highest levels of
tone are mapped into 30 levels of tone
on average that's okay let's say because
if I'm looking at a scene I can't really
tell apart 2000 levels of sky you know
maybe 30 levels is all I need of my sky
but if for some reason I have a lot of
data up here that I wish was down here
I've thrown away big chunks of my
original flexibility there I've tried
remapped my 4000 levels into 256 levels
so if I can avoid doing that and stick
with the raw file I can do the tonal
mapping and change the exposure like in
Camera Raw or different tools you can
you can pull the exposure up and down
with much less damage to the image then
once it's been cooked into a JPEG if I
start to pull the exposure up or down
I've got a lot less data to work with
and I start to see artifacts so if you
look at the levels per bit you can see
that with JPEG it try and even them out
more or less like television does the
same thing whereas with the linear it's
it's not
it's not the way you'd want it you want
them even the problem is the evening
process also throws away a lot of data
and the upper stops that you might wish
you had later to do some other kind of
processing with so that tonal mapping at
that same time it gives you the gamma
correction it brightens it up basically
in the middle yes people suggest that
you over expose your image as long as
you don't blow it highlights such that
you have this latitude me yes exactly
there's a very popular thing on the web
now which I'm a little nervous about
because what it says is the question is
isn't this why people are recommending
you over expose your images and the
answer is yes and saying look all the
all the ability to retain detail is up
in the top stop so if you can brighten
your image up until you get your subject
up in that top stop you're going to get
the most possible shades of tone in it
and then you can post process it to
darken it later but if you keep it down
here you're not going to have as many
shades the only problem I have with that
is I think it's like a lot of advice if
it's taken out of context that's a real
problem so if you're in the field and
you're tinkering with your exposure even
assuming that you're not missing
something and then suddenly the sunlight
gets brighter or something changes or
you change subjects it's really easy to
have a blown-out shot and the problem is
film was pretty forgiving as you got up
into the highlights it had a slow slope
here everything after 4095 is white
period unusable unrecoverable so the
answer is if you're in a controlled
lighting situation absolutely if you're
not you have to be a little careful or
you're going to point up with some blown
shots
versus the gin takes to get this
if you have a bloke finalizing a process
picture is nothing silly when you say
they're on fire that's right boy i would
say it stopped more it's it's it depends
a lot and one of the things that's
pretty nice now is the newer version
Camera Raw for and Bibble have single
channel highlight recovery so what
they're what they're doing is saying
well if any one of the three channels is
not blown we can still kind of
intelligently guess as you back off on
the where those might have been based on
the one channel we do know and that's a
pretty new phenomenon that didn't used
to be in the raw processor so it used to
be that once that once any of these were
up above 4095 you were kind of in
trouble but now let's say your red is
here and your blue and your greener here
and a few pixels over the red is here
and the blue and green are here it might
say well you know we can probably guess
when we back off this one you know where
those really are and we can figure out
where to put them so the highlight
recovery tool is is actually pretty
clever and I think adds another half
stop or whatever I mean it's hard to
generalize but jpg is it dark in here
pictures of it if you represent that the
valleys lesson 55 yeah
oh you mean when you owe the Highland
recovery interest I don't know if it
even works in the newest version and
Camera Raw supposedly also works with
JPEGs but I haven't actually tried to
see what it does incident was that in
the in the ocean treasure but in a JPEG
remember this doesn't really cover any
more ground than this it just read it
displays it because this space is is a
2.2 gamma and this is a one point 0
gamma so it's it's it's actually
representing the same 0 to 255 all it's
doing when it does highlight recovery is
that top stop moves into here and you're
just sort of tinkering with where each
thing goes so it's twisting them that
pop pieced back down and lower and just
pulling it like is if you have a pixel
that's here here and here a simple and
simple rendering simple interpolation
puts it out it may be you know 270 or
something or bump 255 but if I work
those back in I can now say are up now
it's at 253 or 251 or something like
that some previously would use of the
loser but a
stuff or stuff
literally applied as before 255 and as
they think there's enough perspective in
4096 instead of about 3,000 ok it here's
why it the top corresponds but when you
look at these values like 4096 all the
way down to like 3900 all mapped to 254
and 255 these are just rough
approximations that Kurtz like your top
hundred tonal values map-21 jpg value if
you just do a simple mapping so but you
can recover all those if you then go
wait a minute let's take those hundred
top hundred nits where all my data is
let's say I can map them into a hundred
jpg values so that the endpoints are the
same it's just that this curve is so
radical that you're this doesn't even
really show it it's like this so you're
losing this top part up here it is all
mapped into a tiny tiny space normally
but you can remap that into wherever you
want so I don't ya stop let it stop
that's just my rough sense of the total
flexibility you get if you're
manipulating this in Camera Raw versus
the same thing in a JPEG in Photoshop is
you can be about to stop more off in
terms of the taking this mapping because
you're still going to do this mapping
it's just you can completely change it
to whatever you want basically
so just for fun one of the things we did
we plotted the camera colors this is
what your camera is a d1x I think or
maybe do you want to forget actually
sees all the way up through the spectrum
this is the theoretical color what the
eye sees and those are the RGB primaries
of like an srgb so just that for example
there's no yellow there's no point at
which the camera sees anything that
looks yellow so the the firmware or your
raw processor has to actually figure out
from colors that look like this that
they're really supposed to look like
that so that matrix transformation is
pretty pretty magical in a way you know
it takes this and turns it into that now
I'll talk a bit more about raw file
formats and what's in them too there are
a ton nikon is the neff format canons
got sierra WCR to every camera vendor
pretty much has its own at this point
we'll talk about dng as an attempt to
standardize but for the most part
they're all different go through the
canon raw formats that started out with
a crw file which was kind of based on
tiff but there was a lot of metadata in
these really squirrely places which was
pretty frustrating so you had to put a
lot of Canon specific code and even to
get the standard metadata out so then
Canon did something I thought was really
clever for the 1d s they said well you
know really while we just make it a
multi-page tiff file and the first page
of the tiff file will be the thumbnail
the second page will be the raw image
data cuz tiff says I can store image in
non non RGB formats and we'll just throw
it in there and then we can make it a
dot tiff file and everybody can be happy
and I think maybe if they'd stuck with
their guns it would have been a really
good thing but what happened was a lot
of TIF processors that were used for
images had never seen a multi-page tiff
so as soon as you touch that file in one
of those processors it immediately
rewrote it without the second page so
all you had was the thumbnail so you had
people buying this eight thousand dollar
camera shooting these images and putting
it through some sort of image pipeline
that turned them literally useless
they're destroying images so they were
trying to get that fixed in all the
software but instead can and said hey
this isn't going to work we can't have
people by our camera and then destroy
their images accidentally so they came
up with CR 2 which is a pretty good
format it's got the standard metadata in
standard places they more morally use
large image previews one of they don't
use large image yes god is there is
dinner yes sort of exif is the the best
standard we have for the camera metadata
now that's not for photographer metadata
IPTC x and p amuse a that's a whole
separate mess but in terms of what's the
aperture what's the shutter speed what's
the ISO exit does a pretty good job for
anything that's been around for 20 years
anything newer than 20 years is become a
big problem so yeah the standard camera
metadata is in the X of standard places
large image previews in their high-end
cameras not in their lower end cameras
because it's one reason they want you to
buy the higher-end cameras they say left
it out on purpose or their lower end
cameras and then it's all different in
point and shoots that's the other thing
of these which canon stopped using raw
in their point and shoots they used to
allow it it's confused they say they
don't a lot like the g7 would just be
such a nice little point and shoot
companion for a professional
photographer but it doesn't shoot raw
rose up through like the g3 or so they
did and when asked they say well the
image quality is in good and mumble
jumble it's like well what to your point
earlier you know you'd think you could
do more with a raw file than a JPEG so
if it needs help why don't you give us
the raw file and then we can do more
processing with it unfortunately though
they've stopped the only point and shoot
now pretty much that shoots raw is a
couple of the lumix is from
panasonic almost all the rest of
pointing shoots they've gotten rid of
the raw capability which is kind of a
shame oh you can yeah I'll let you read
out the raw file oh that's cool that
might be worth it owner if I did that in
a loaner camera where they'd be bummed
so for Nikon things started out pretty
simple and then nikon never technically
changed the name of their Neff file it's
always been called an F file but they
keep monkeying with it they did one
interesting thing here compress draws
from Nikon use a look up of about 550
entries so they're actually encoded
using about 9.5 bits with a slight tone
curve so they're like a third of the way
to JPEG which nikon says is visually
lossless which is mostly but not a
hundred percent true but I do find it
really funny than the one side the
marketing department says I'll run so
much better than JPEGs it's 12 bits
instead of eight bits and then they say
nine point five bits is identical to 12
bits it's like well okay now we're down
to one bit you're talking about here so
which is it you know is it the 12 bits
that's important or is it really that
9th bit that's important yeah lots of
lots of metadata changes one of the
about nikon that's been really
frustrating is the camera group doesn't
talk to the capture group which doesn't
talk to the other camera groups so each
one can come out with incompatible
changes in the file format and so
sometimes you can read the data from the
camera files but as soon as it's been
through nikon capture it twists it
around in a different way a classic is
byte order a lot of the the private
metadata from these cameras was always
written in the same byte order no matter
what byte order the header of the file
said it was in so you had to write in
your in your processor you had to go
through and say okay even though this is
an Intel byte order file we know that on
the D 100 the private data is always in
motorola x order
or what well then it would go through
nikon capture software which might say
well you know we think that's stupid
we're just going to change all the data
and make it all in Intel format now well
except these others it was never there's
no way to tell in a sense except by
saying oh look this is one that's been
processed by capture so they must have
switched although data and that sort of
thing it's really scary again if you
think about this is your digital
negative that you're going to keep on
some hard drive for a hundred years and
there's just all these little things in
there that today we can kind of all keep
in our heads in our code but it's only a
matter of time before they start
dropping out of the test suites or
people start forgetting them so there's
this thing called the maker note in a
nexus standard for everything that's
newer than about 20 years pretty much
and it just grows and grows and grows
and that's a lot of what's in these
formats is these camera vendors this is
not none of this is documented this just
straight from our code where we've
figured out what's in each of these tag
numbers and what it means by painstaking
looking at images from each camera
changing the settings on the camera
shooting more images comparing notes
with other people who do the same thing
and figuring out what each tag is like
Hugh was added in some of the later
nikon camera so they just that's the
next tag and then they added saturations
that's the next tag at a noise reduction
so you could tell whether it's on or off
the next tag and it just kept adding
these tags and there's big blobs that we
never have figured out on and on and on
nikon allows you to download tone curves
into the camera so it's a tone curve tag
to say where the tone curve is so a lot
of the data and he's rope yes you all
know the old adductors the same problem
yeah Peter see well boy Nikon and Canon
are probably about equal and I don't
know of any other vendor that's really a
lot friendlier I don't spend a lot of
time with the rest of the raw file
formats those are the two that are most
interest to me it's kind of a
35-millimeter full system shooter not I
think a couple cameras are starting to
use dng now but yes you know
is it really cool well congratulations
oh yeah I should repeat that dick lion
former CTO of phobia and wants to make
sure we all know that the fovea on maker
note is completely documented online yes
 my son again and like a little
Chuckie dng and Daniel been back since
is it the Panasonic that does I knew
somebody was shooting Indian Jo just
wasn't sure and that that's cool now it
doesn't mean it's all documented because
dng allows you to have hidden data but
at least the basic format is documented
the envelopes document and a lot of
these fields are in dng because it's a
new format you know the encoding of
these data can be incredibly obscure is
the other thing especially a cannon and
Olympus in their point-and-shoots had
really bizarre imaging coatings and you
know thank God for David coffin figure
them out because they're like the bottom
four bits get dropped and moved over to
hear a lot of it was to save space and
they were kind of doing signal analysis
and figuring out an average image if you
encoded the top eight bits and the
bottom 8-bit separately it'd be a little
smaller but then they don't document it
so when you see that in a file and try
and figure out what you're looking at
it's very hard reading through the bytes
to realize that's what they've done
there's padding in some of the cameras
and not others out to 16 bits there's
alignment of rows in some of the cameras
there's a bunch of different compression
schemes some are real simple like a run
length encoding type scheme some like
the Nikon of a lookup table so there's a
bunch of different things that go into
the raw file even in the image data that
again are not documented anyplace so you
need to sort of figure them out if you
want to pull the data out or find
somebody else has done it yeah
encryption there's this big thing is the
Nikon white balance encrypt that or not
it's encrypted I mean it's not below
maybe it's just an accident and they you
know Rayna cipher on it because they
didn't know what else to do like no no
no
it's encrypted for real Sony was so
concerned about this fourth color this
magic emerald color they came up with
that they encrypted the data from that
sensor so no one could figure out the
emerald color well 72 hours later David
coffin had hacked it I think for a
competitor and he posted the code for it
on the web so it did no commercial good
to Sony and now there's millions of
cameras out there with encrypted raw
files forever you know that are going to
always have to have this a little bit of
code to decrypt them so that's too bad
and the legal implications are part of
what's a little scary and the practical
implications technically all this stuff
can be cracked so far but legally
companies like Adobe are certainly
worried about the Digital Millennium
Copyright Act practically it's a problem
because it means the code bases all get
cluttered with all this croft by camera
and by vendor that has to keep being
rolled forward and already there's 125
cameras supported in Camera Raw maybe
more and you know as that number goes up
how many of those are going to stay
tested and supported because the
original cameras are going to break oh
so this is the sony decryption for
example for emerald for those who want
to david coffins code courtesy ahem it's
on the web I reading his code can
sometimes be as hard as actually
cracking the encryption yourself as far
as I can tell but it is a real service
to the industry i just find it not the
easiest to read here's some encryption
code for pho beyond read so even other
vendors or less well-known than sony and
nikon also did use some encryption i'm
not sure what that was encrypting alan s
dick but something in there so there's a
lot of these you can imagine now if you
have a row decoder that's filled with
pages and pages of code that looks like
this to unclip tour decrypt different
things you're getting to the point where
you're not really building a great
archival system for for your children
and their children and generations to
come
one of the questions that comes up is
really who owns what as a photographer
I'm real possessive about my images I
get in the u.s. at least the right to
that image from the minute I click the
shutter but the camera vendor owns the
firmware in my camera even though I've
you know bought the camera that firmware
is still under license from them and the
metadata is written by the firmware but
of course it's part of the image and
it's not really clear to anyone I don't
think who owns what and has control of
what because to me it's like I paid for
a camera it has a color image records a
white balance I'd like to know what that
white balance is but I can't force an
icon to tell me what that white balance
is necessarily and scarier yet is is a
certain number of people are
interpreting the Digital Millennium
Copyright Act to mean that decrypting
that metadata if it's encrypted is
legally pro eligible and if you're
coming like Adobe you don't want to risk
Creative Suite three being stopped in
its tracks over some tiny white balance
decrypting things you're just not going
to mess with it you're going to say hey
we're not going to deal with it the
other problem is that because these file
formats aren't documented reading them
is bad enough writing them is worse
because now you really have a hard time
knowing exactly what bits to put back
where to make sure you don't break
anything the formats are very brittle
very few only really the small companies
right the files back as far as I know we
do Bibble does Chris breeze might so if
you want to add IPTC metadata for
example to a raw file in an Adobe
product they don't do it they write an
XMP sidecar they're right out and out in
the database they'll write it out in a
tiff file they will not write it back as
a tag or set of tags into the raw file
which is a real issue so it's too bad it
these are the raw files are the hardest
to fake a lot of contests now want you
to submit the raw tomorrow let's prove
you didn't fake the image you can
fig raw files but it's hard I found this
is a generalization that depending on
the brand new shoot it affects your
opinion of the how important the whole
raw file thing is because for the most
part most Canon users use the adobe
camera raw either in Lightroom or
Photoshop because it does a better job
for them than the Canon software so
they're kind of like hey as long as
Adobe stays on top of it it's not that
big a deal I just use my photoshop I can
survive but for Nikon interestingly they
actually have really good secret sauce
in capturing capture NX and a lot of
Nikon users really prefer the rendering
from those products but that means
they're kind of scared because they've
now they're worried about raw support
from Nikon which is not exactly a
software company necessarily and the
capture instructions are all a blob in
the file and nikon has already
deprecated some of those instructions
and in either case the processing of the
file from Nikon doesn't look the same as
the processing from Adobe because
there's no standard for how these things
are rendered so I think the Nikon users
are a little more on average militant
and concerned about undocumented raw
files then the Canon users aren't the
problem again if we think of this as a
legacy or an archive for the future is
that because these formats are changing
and they're not well documented there's
not really I don't think a good plan for
the future I think it's just a matter of
time before people start to have
important images from cameras that can
no longer be accurately rendered unless
they're so important that somebody goes
back and sort of reinterprets them and
figures them out all over again so I
think there's a lot of this stuff people
are trying to put away as being
permanent that's not going to be
permanent there are software kits from
both vendors most people don't use them
they're pretty slow they're limited and
they don't actually give you access to
the raw bits anyway all they give you
is an API into that company's own
conversion software so if you're
building your own converter they're not
very helpful because what you want is
access to the wrong data the raw data
metadata we talked a little bit about
the file is obviously the best place to
put your photographer metadata because
that way it stays with the file
automatically but raw files don't really
support both most of them have an iptc
segment so if you're careful and you
don't move stuff around too much you can
put IPTC tags in them but most of them
don't support XMP at all which is where
the industry is going and if you update
them incorrectly with IPTC you can
render them unbel-- which is a scary
thing because there are a lot of
internal pointers to the file that
aren't documented if you don't know what
you're moving around and where it needs
to be patched then you can mess up the
internal pointers that tell the camera
vendor software how to interpret it so
the solutions I've seen to that so far
one is dng which is Adobe's digital
negative format which we'll talk about
in a sec the other which is interesting
is in Vista Canon and Nikon and the
other vendors are providing codecs that
will do display and print and hopefully
also tagging of the image files it's a
really embryonic architecture there's
already some issues with the first codex
out there because as you might imagine
that that interaction is is pretty
tricky but I think it's a step in the
right direction and hopefully it will
force the camera vendors to clean up
their act a bit in terms of the formats
because now they're going to have these
codecs for an operating system that
they're also going to need to support
and maintain and I think it'll help
clarify some thinking yeah a little bit
hacking raw acting raw files it reminds
me as a Bushman and he dug out this
yellow scorpion it's pretty dangerous
and as a big sting for us and we said
well how come it's not biting you and he
goes well because I'm a healer for my
village and said he says so the scorpion
knows that I'm a healer so it doesn't it
doesn't bite me I thought well it's kind
of like hacking raw files it's like
you know you're not breaking anything in
the raw file it's it's tricky so to
figure out what's in them the simplest
way is really with a hex editor and you
keep changing stuff in the camera keep
changing settings look to see what tags
change or again find other people have
run those same tests we did all those
charts you saw earlier of the cameras we
did either picks them or Stanford at
some pretty nice imaging labs and use
MATLAB in Mathematica to run the
analysis to come up with all the charts
and it helped us characterize the camera
which helps you build the transformation
matrices from the cameras primary colors
to Adobe RGB or srgb I'm going to skip
that last part we wrote our own profile
generator so we can actually generate
raw files with arbitrary test patterns
real quick here PNG I do think it's
technically a great format it supports
all the known that metadata it allows
for the vendors to hide stuff you can
keep the original raw bits in there as
well I think it's got to be given to ISO
or someone if it's going to work and the
bigger problem is except for I guess
it's panasonic leica now the big camera
vendors aren't supporting it so
something has to cause that to happen I
think before it's useful otherwise once
you put your images into dng then if
you're an icon user for example nikon
capture can't be used on them anymore so
you're sort of stuck with using Adobe
software and you just kind of moving
from the frying pan into the fire so
unless there's critical mass behind it I
think it's going to be really hard for
it to take on takeoff
you can reacts tracked it sorry I didn't
mean to say you couldn't react stract it
it's just now you're these things are
big and if you have thousands of them
and everyone's 20 megabytes yeah it's
just so worst case you could but it's as
a workflow it be it's horrible open raw
if you're interested check out the open
raw website they're kind of militant and
trying to help push this whole idea of a
open documentation of the raw file
formats and then I think the camera
vendors and free enterprise are starting
to work because they have so many
cameras out there now they're starting
to learn they have to do better
documentation for their internal use of
nothing else and the formats are getting
better but they're still not safely
writable they still don't support any
good way to put XMP in them as far as I
can tell and Adobe certainly doesn't put
x @p in them I think one of the things
that could happen is organizational
pressure so if the government said for
its buying it's got to be documented
it's got to be an open format if writers
for example started to say that which
they might pretty soon when I was at Sun
in the 80s we did that just a couple big
organizational customers helped push the
network file system across the industry
because they said we're just not going
to buy a computer that doesn't support
it and it happened relatively quickly
all of a sudden even though lots of
individuals had wanted it before that so
I think organizational pressure could be
could be key there so that's all I had
for remarks I know I'm run over a bit
I'm happy to stay and answer questions
if people have time and invite you to
take a look at the information if you
want to come in and do a photo safari or
workshop or something I'd love to have
any along I do them in Africa southern
Africa Southeast Asia Alaska for the
grizzly bears and then summon the rest
of North America to depending on the
year I do a variety of things I also run
a site called nikon digital org or canon
digital org if you'd prefer to type that
URL which has a lot of articles and
information on these kinds of topics and
more photographic topics just
information on digital photography in
general
and we've got digital Pro which is
actually an image management software
the wrong interpretation stuff was just
something we had to do because a lot of
the images people want to manage or raw
images thank</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>