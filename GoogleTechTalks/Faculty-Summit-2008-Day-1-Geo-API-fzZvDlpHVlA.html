<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Faculty Summit 2008 Day 1: Geo API | Coder Coacher - Coaching Coders</title><meta content="Faculty Summit 2008 Day 1: Geo API - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Faculty Summit 2008 Day 1: Geo API</b></h2><h5 class="post__date">2008-09-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/fzZvDlpHVlA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I'm the technical lead of the my maps
team in Google Maps my maps is a tool to
allow users to create content on a map
and share it with other users but I'm
not going to be talking about my maps
today I'm going to be talking about what
to me is the most exciting aspect of
google maps which is the Maps API now
just by a show of hands how many people
here have used the Maps API okay so few
how many people have ever written any
code in JavaScript okay few more i'll be
giving some examples of javascript code
but i don't assume that anyone in the
audience knows javascript also i would
like to encourage anyone to interrupt me
this is most useful if the things I talk
about are actually relevant to what all
of you are interested in and the Maps
API is a very big topic there's no way
that I could possibly do it justice in
45 minutes so if you have specific
questions that I'm not addressing you
should feel free to let me know
googles mission as I'm sure all of you
know is to organize the world's
information and make it universally
accessible and useful now this is this
is actually rather audacious audacious
goal right and in pretty open-ended
right but I think understanding this
mission is really important to
understanding everything that Google
does including the things we do in the
geo group which includes google maps
google earth and sketchup it Google is
not a software company Google is not a
mapping company we might incidentally
write software or develop mapping
software but that's not our primary
mission and a lot of the things we do
are not going to make sense if you think
of us as a software company our mission
is to organize the world's information
now one way to organize information is a
web index right that's that's a nice way
to allow users to organize very
unstructured information just based on
keywords that appear in the text and
what in web pages but there are other
ways of organizing the information right
much of the world's information has a
geospatial content and a great way of
organizing that is geospatially right so
we can have a geospatial index and
another part of this mission is to make
the information universally accessible
and useful an important aspect of being
useful is displaying it in the context
that makes the most sense for the
information if you have if you run a
business and you want to see the
locations of all your franchises or look
at the locations of all your trucks or
whatever a great way to do that is
display it on a map right so Google is
not writing mapping software to produce
the map the map is just a means to an
end
and that end is to to display the
world's information geographically now I
also want to draw attention to the
world's information right Google is not
also not primarily a data provider there
are some particular services that we
have that involve data provide do data
from users you know such as for instance
picasa and you know bloggers and things
like that but but we're not interested
in creating walled gardens right some of
the world's information actually happens
to come from our competitors and we're
not interested in excluding that
information just because it happens to
come from a competitor and we're also
not interested in blocking our
competitors from accessing information
just because it happens to live on
Google servers right this is all about
organizing the world's information and
universally accessible is a big
challenge for us in much many people in
the world particularly in the developing
world don't have access to laptop
computers or desktop computers they're
primarily accessing information using
cell phones and with very slow internet
connections and so one of one of our
goals is to provide ways of making
information available to those users for
instance through you know Google Maps
for Mobile and other through mobile
mobile platforms so so this is just kind
of give you an overview of where we're
we're we're positioning ourselves what
we're thinking of in terms of what we do
in the decisions that we make now
to make the world's information truly
useful we need to provide ways of
displaying the information in a way
that's that's most useful to whatever
goal is someone's trying to accomplish
and this is a real challenge because for
a lot of very specialized uses it might
be for researchers or science
researchers or you know bird watchers or
hikers the the ideal way of accessing
that information is going to be very
specialized to that particular domain
and Google can't possibly develop all
the different specialized user
interfaces for all of these different
applications but we can do though is
provide open ap is to allow developers
to to write these applications on top of
Google's you know services as a platform
which is why the Google Maps API so the
Maps API is a tool that allows us to
collaboratively with developers and
researchers organize the world's
information and make it universally
accessible and useful there are over a
hundred thousand active Maps API sites
we know that because every API site has
to have a key you know specific to that
site in order to access our our services
and and so we track those keys and so by
active I mean you know in any given week
you know this many at least this many on
different unique API sites are using the
Maps API now not all of these sites are
equally useful or equally impressive but
many of them are very impressive and I
just want to give you sort of a little
feel for some of them this site is
called a housing Maps
calm it was developed by a fellow named
Paul rademacher who actually now works
for google although he didn't at the
time that he developed this site and
what it is it's a mash-up of google maps
and the housing listings from craigslist
so using this site i can search for
housing i can specify the price range
i'm interested in you know what what
city i'm interested in these different
markers tell me different information
the yellow markers indicate that the
listing contains photo so i can click on
one of these yellow markers and see a
photo of the house if i wanted to i can
zoom in and and look at particular
neighborhoods this is a really useful
way of accessing the information on
craigslist right which is what i mean by
making the world's information useful so
that information was there but it's much
more useful it's displayed on a nap i
believe that they do I don't think
craigslist has flat Long's associated
with these things so yeah that this I
think necessarily uses the user uses
geocoding queries so basically just
takes the address and submits it as a
geocode request I believe that's the way
it works I haven't actually looked at
the code for it
this site is a tour de france nap and
this is using a google street view to
show the location of the writers if if
the race we're actually going on right
now this map would actively track the
writers in the Tour de France and I can
I can look at any of the roots I can use
Street View to kind of pan around and
get a feel for it or you know click on
the little navigational arrows to to
move around I can also click on a
particular part of the route if I want
to see like for instance you know what
one of the mountain this doesn't look
great mountainous but there you go one
of the mountain parts of the of the
route look like
here's a map showing the effects of what
the effects of a particular amount of
sea level rise you know from global
warming would have on a particular part
of the country so i can just select what
I think the you know worst-case scenario
is and then see you know what parts of
the city are are going to be flooded
right so I live in San Francisco so is
relevant to me you know whether you know
my house would be flooded if the if the
sea level rose and there are lots of
other examples there's various maps
showing you know locations from
Wikipedia this one here is using google
sky and showing a showing videos of
different parts of this guy so I'm not
going to wait for this to load anyway as
I said there's there's a hundred
thousand of these sites so what can you
do with the Maps API well as I said our
organizing principle is you know to
organize the world's information and so
really you can think of the capabilities
we provide as a way of doing that so you
so first of all you know an API site is
a program written in either JavaScript
or flash obviously if you want to
display information on a map you need to
display a map and you can display any of
the maps that you could display on maps
at google com including now something
actually you can't yet do on now so
google com and you can't currently do in
all browsers and that's view the earth
and 3d using a a 3d earth plugin which
incidentally was developed by Paul ragem
at
or the person who wrote the housing
website so you can display your own data
on the map right because some of the
world's information might be something
new you own or something you want to
mash up from some other site like
craigslist you can display Google's
information and access Google's
information and you can get information
from users right so some of the
information comes from the community at
large that's something that's very near
and dear in my heart working on the my
maps team you know whenever there's a
you know major event like a natural
disaster you know you can go to maps to
google.com and search for like for
instance I was traveling when the bridge
in Minneapolis collapsed and I searched
for Minneapolis bridge collapse on
Google Maps after I'd kind of exhausted
all the major news sources and and found
lots of of just community created maps
people who were on the scene taking
pictures with their cell phone cameras
and whatnot describing you know
firsthand personal experiences of what
was going on there's much better
information than anything I get from any
of the news sites similarly you know
many other natural disasters you know
fires you know last year in in in
Southern California some great maps
produced by you people KPBS and lots of
ordinary users
okay so so how do you actually do this
how does this work well it's very simple
that this HTML is enough to to embed a
map in your own and embed a Google map
in your own one page the the key here is
this URL maps google com you say file
equals API specify what version you want
and then an API key it just identifies
your site it's it's it's free use but
you know you need a key for it and then
you can write whatever kind of
JavaScript code you want so I'll show
you some examples of some JavaScript so
can anyone tell me what this code does
okay yeah so we have a geo coordinate
here right so okay yeah so it's going to
set the map to a particular location and
what about this any guesses on what that
does sorry yes yeah that's exactly right
so we run this code and just goes there
waits a little while and pans over to
another location so so one of the things
you can do through the API is just
display locations animate the map
respond two timeouts or or or other
things as I'll discuss what about this
what is this code do
sorry
yeah so so it's adding yeah it's adding
two things to the map adding two in sets
to the map so let's run this right so we
have a little bar there you know to pan
and zoom and a little selector to select
the different map types so so the ad
control method on the map object add
some kind of control it could be a
control that you wrote or it could be
one of the built-in controls and we have
we have a number of these the so the
small map control is that guy there and
the the map type control is this guy up
here so using this I could select a
different tile set so this is our you
know terrain map the hybrid map okay
okay let's make this a little bit more
interesting one of the most significant
aspects of the Maps API is is its event
model its support for user events so we
have this G event object which it can be
used to listen to various user initiated
actions on the map so any guesses on
what this code does okay yeah yeah yeah
so what about this part
okay yeah pretty close yes so so what
this does is like click on it it adds a
marker I click on the marker it just
takes the marker away so so you can
respond to click events on the map you
can respond to other types of you
mouse-over events you can make things
draggable I could you know you know say
that this this particular marker isn't
draggable but I you know if I change
this to I'll do G event listener
a very good question i'll get to that in
the next slide then if I sorry I change
this code to just say draggable true now
I can click on this guy and then I can
also drag it around and can still click
to remove okay so even asked about info
ba a window so I can see one and go okay
so here's some code I'll just show to
you I now click on this guy oh and it no
I'd scrolled there and it opens in the
info window this says New Delhi so
that's controlled by this code over here
I so I add a listener to the marker on a
click event and when this click happens
it calls marker open info window HTML
and then name which happens to be new
delhi so this info window can contain
any arbitrary HTML so you can make our
pineal pretty interesting things you can
do embedded videos or you know any kind
of you know widgets or whatever you want
yes
in other words a lot of times we want
because shadow are making that area yes
that's true yes so the the comment was
that you can't click under the info
window um as shadow yeah so so there's
definitely room for improvement you know
this is by far you know yes yes yeah no
I agree it's you know it that's annoying
i think the the earth UI for info
windows is much nicer among other things
it doesn't always like have to scroll
the map around toes
tremendous amount
yet you can actually click on markers
that are under the info window but if
you want to click on the map you may be
right and it's probably also browser
dependent getting things to work
reliably in all possible browsers is is
an interesting exercise
sorry the shadows on the markers are you
can do whatever you want with you can
specifically set the shadow image and if
you don't specify shadows and you don't
get one the shadow under the info window
is that just kind of comes prepackaged
you can implement your own info window
if you want you can do something just
open up a whole div or whatever yes yeah
that that's bad for scrolling to write
that that it tends you have a small
window you open the you open it info
window and it tends to scroll the map
down sometimes so far down that you
don't actually see the marker anymore
that you clicked on yeah that's a
problem what we you know no no need to
apologize it that's very useful feedback
and I totally agree with you I think we
should we should fix it
ok
so we can also display other things you
know not just markers can display
polylines so here I've just you created
a you know an array of points and then
created a polyline specifying that a
point array as as an argument now this
thing is is unlike the marker i showed
you before where i could drag drag it
around and click on it and things this
right now is totally interactive totally
non-interactive right i can't click on
it I can't drag but we recently extended
the polyline API to include Mouse events
you can now handle mouse over you know
click and and other things so let me
just show you and this was something
that we added basically taken out of the
my maps editing API and so I and my maps
editing user interface and put in the
Maps API so now what i can do is i can
create a polyline object with an empty
point vector and add it to the map and
then I call this new method enable
drawing and then clicks on the map will
just add points to the line but now once
I've done that I've double-click to end
the line now it's totally
non-interactive again right which isn't
very good so we can we can extend that
we added methods enable editing and
disable editing here I'm just adding a
listener on mouseover and mouse out
events so anytime I get a mouse over i'm
going to call this enable editing and
when i get a mouse out i'm going to call
this disabled editing so I run this code
now when I mouse over I get these little
boxes if now if there's two kinds of
boxes here there's the ones at the
vertices which are kind of dark and then
there's ones in the centers which are
which
more faded if I drag a vertex it just
you know moves that point but note the
ones in the middle they stay attached to
the line if I drag one of the midpoints
that just adds another point to the line
we can use the enable drawing also to an
extend a line what i'm doing here is i'm
listening for click events but i'm
looking for this optional index argument
which tells me if I clicked on a vertex
e tells what vertex I clicked on so here
I'm looking for to specific vertices
either the first vertex or the last
vertex and if if I click on the first
vertex I call enabled drawing with the
from start argument equal to true if I
click on the last vertex I call enable
drawing from start equals false so what
that does is if I say click on this
vertex here right I can keep adding
points to the line or if I click on this
vertex here they can add points but if I
click on a point in the middle it
doesn't do anything okay so just to kind
of show you how all these things can tie
together this is just a really kind of
crude implementation of very basic
implementation of my maps in the Maps
API so here I have a little drawing
tools and so I can click on a marker
tool and put a marker down and you have
to dragging around you know exactly how
that works that's just a Maps API call
to enable dragging if I click on it it
changes the color that's just listening
to the click event by draw a polyline
you know hit that works just the way I
showed you before I do the same thing
with polygons I click on a vertex it
deletes that vertex so anyway
I'm not going to showing you the code
for this but if you click through from
this this URL here you know just kind of
drill through and look at the HTML you
can see the code for it's not very
complicated it's pretty basic question
state storage say I whole off the page
close is the data actually stored on
these examples on your Google server or
the quality a very good question and
which sort of leads me to my next slide
the answer is it depends on you really
the the most the most general solution
the most general so so in this
particular example I was showing you
yeah so to repeat the question is the
data just gone you know what or is it
saved somewhere and in that particular
example it's gone right it's just stored
in the browser state but there are
events that tell you for instance when
someone's finished drawing something or
some finish dragging something right so
you can listen to what the user does and
then take an appropriate action right
and and one appropriate action would be
just like talk to your own server right
you could run a database server or
whatever and store the data you know
however you see fit and you can do that
using our library for doing asynchronous
HTTP requests you can you can do hdb you
get to fetch data from your server or
HDD post to to post data from based on
user action so this example here on just
I'm just getting data from from this
this file here dated XML which is just
you know putting a bunch of points on
the screen but the point is that you can
you can take take that data and do
whatever you want with it something that
I'm not specifically talking about in
this talk but we're very soon going to
release a data API a GData API for my
maps so you can also store or you will
very soon be able to store any of your
data directly on Google servers and all
that data will be indexed and accessible
through google search so if you want to
store it on your own serve as you can if
you want to you know to store it on our
servers you can do that also sorry we
will not be supporting gmail at least
not in the immediate future we will
support KML and georss and based on
demand we may add additional performance
as resources yes yes exactly
this
yes yes so are you talking about
searching data that is on google servers
or searching data that's on other burke
both yes yes yes so so we have a NC I
think I have a slide for that let me uh
yeah look well let me start here with
the geocode or API I may or may not have
a slide for the local search but i'll
talk about that so so this this code
here is talking to the geo the google
geo coder and so what I'm doing is I'm
creating a G client geocoded object and
I'm simply passing it a an address in
this particular case in Paris and I just
run that code and you know you know put
a marker on on you know i mean this code
here is putting a marker on the screen
based on that location I could just as
well have said you know say market
street san francisco and market street
san francisco so but we also have an API
for local search which includes
geospatial data that Google has crawled
from the web so you can it includes my
maps user created maps it includes yo
KML is great from the web other things
like GPS tracks so so that information
is is available and it is searchable
through our api's
so other kinds of information you can
display you can display pictures on the
map here this is just a kind of small
single image but you could also if you
had very large imagery there's an API
that allows you to display it as tiles
you can zoom in and just see more more
resolution working that works basically
just the way our own servers work
yeah we don't have an API for the vector
data and a big part of the reason for
that is it's not really our data we're
licensing it and our data providers are
kind of nervous about making it too easy
for people to scrape the data so so not
all the data is ours to give away but
you know if not for that we'd love to do
it so in short we've been using the Maps
API to display information related to
simulated emergency to our next
generation of a one project we're doing
work with department transportation and
one of the problems that we have is that
much of data is not directly user
generated for example our coverage areas
or the location of fire trucks or all of
these things come from third-party
sources right my not say vehicle
tracking system or the various other
auxiliary data systems that we want to
interface wife so it's a little awkward
in a sense would be nice to have a AP I
that is a protocol API as opposed to a
language api yes that we can get to data
maybe that exists him I just didn't look
hard enough to do that um yes so one of
our hopes with the GData API that we're
developing is actually that we could
encourage other companies to also adopt
it right that there's no reason it needs
to be just an API to get data out of
Google servers it could be an API to get
data from other servers into Google or
you know into a particular API site
that's very much in line with what we we
want to do okay flattering about so I'm
I'll talk to you offline but is a active
standardization effort on going in VI
ATF on these type of protocol level API
is type of thing so would be good to
coordinate in some way
yes absolutely
ok so anyway some other information a
display traffic driving directions so
here i've i've specified in my query you
know what locale I want you know the
directions to be so the directions here
are in French if I'd specified some of
the language yeah they would have been
in that language now the these
directions here are not interactive I
don't know how many of you have noticed
maybe by a show of hands how many of
you've noticed in on get maps I google
com you can actually drag the directions
around ok good most of you looks like
yes so that's kind of a nice thing we
don't support it in the API currently
but but based on what I've already
showed you right we could we could kind
of hack that up right so show you I
showed you how you could draw and edit
poly lines and you can do these these
queries driving directions queries so
let's kind of put these together and now
I have code where I can click on points
and it as I do it it adds points to a
driving directions object I can go and I
can mouse over and drag these I think I
can oh what's happening oh yeah it's
just not I'm still drawing that's the
problem ok so i can drag these guys
around and update the the path so
so you know we try to provide tools that
make things kind of maximally useful so
there's also an API for street view as
you saw from the Tour de France page so
here all i've done is i've i've created
a new street view panorama object I've
set it the location to a particular lat
long I set the map location in
particular lat long and I've added a
listener on the the pano basically
anytime the view changes in the pan oh
it's going to call this function that's
going to change the location on the map
so I can kind of navigate around in here
and it updates the location on the map
so it's not a very interesting example
here's something a little bit more
detailed now what I have is I have two
things here I have a camera and I got
this little guy here the little guy
indicates where the camera is looking
and I said this the the little guy to
sit right on top of sutro tower which is
a very prominent landmark in San
Francisco it's actually an X excellent
navigational beacon for me because I
don't live too far away from it and so I
can tell people anywhere you know they
are in the city if you head towards
sutro tower you'll be kind of heading
heading 20 house so this this code
basically does same kind of thing it
says anywhere the camera moves I always
want to point it back to sutro tower so
you can see you move this guy around and
you know wherever it goes it always you
know pans around so it's looking at the
tower now I can also move a little guy
say over here to Twin Peaks reservoir
and now the camera moves to the closest
location and points the little guy so
so at the point is you can develop some
pretty you know elaborate applications
you know on top of the Maps API and I
think that's all the slides I have so I
you can find all the documentation that
you could possibly hope to find about
maps in every effort everything else at
Google at code google com and for more
specific information about the Maps API
this is a very good website so thank you
so I guess we have maybe a few more
minutes before lunch for questions or if
anyone wants to stay later sorry
how do you get the pan dimma jizz from
any arbitrary location okay we can't
actually get the imagery from any
location we can only get the imagery
from where the street view bands have
actually driven so so the specific
request that I'm making is saying give
me the nearest pano to the location that
I've specified in fact the the second
example I showed actually the camera
will will always snap to wherever the
location of the nearest pano is so I
can't position it arbitrarily so you
didn't talk about another API that we've
used in Google Local API so if that's
not something I'm we're just asking you
can tell me about something I should
talk to somebody else about is one of
its implementing applications that we've
built is a system that allows you to do
ontology-based searches for specific
type of businesses so we have a an
application and allows you to basically
say I want a movie in to dinner it
should be removing dinner should be
within walking distance and they should
be Italian and below thirty dollars type
of thing so one of it one of the
difficulties we've had is to get the
data for bad and so Google Local
obviously is one that offers itself
without actually we have done a bit of
scraping for a demo to do just add I any
but the data is very noisy for obvious
reasons right and so I wonder if there's
any interest and this came up doing
buffet introductory presentation this
morning if there's any interest at all
at providing providers of services such
as restaurants movie theaters my example
the opportunity to provide less noisy
data yes the problem you have is you get
my random street locations or way a man
you get the corporate headquarter
address when you're looking for local
McDonald's which isn't terribly helpful
yes we actually have that of so
you can go to map Saifullah calm and if
if we're missing a listing you can add
it if we have incorrect information and
the listing you can correct it all of
that you go through moderation but but
basically in specific countries where
we've launched it which includes the
United States you can go and you can fix
our data okay so but it's only the basic
and what I'd like to be able to add for
example if I want if I'm going to pick
up a restaurant example I wanted to have
a category which says I'm a an entree
adult thirty dollars and I wanted to use
that as a tagging vehicle is it possible
to essentially kind of add data bees
fields that you would it's not currently
although we definitely intend to do that
it's it's really entirely a user
interface issue right certainly we have
all the support for it in the back end
it's just a question of making the user
interface to wear it it's both as
powerful as you want it to be and also
not totally overwhelming to to the
casual user what and where you could
what again some standardization would be
very helpful for that so one of the
things that again you might find
interesting to look at from a sensation
perspective there's a new thing called
for service your end which describe a
family affair I'm so it's a new way of
labeling specific categories of services
initially emergency services but others
as well and it would be you I think
would be very nice to have some
confluence between those right yes I
agree so a combination of having a well
a richer ontology and the ability for
users to step outside the ontology both
of these things I think are really
important and yes absolutely those of
those are both very much on the radar</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>