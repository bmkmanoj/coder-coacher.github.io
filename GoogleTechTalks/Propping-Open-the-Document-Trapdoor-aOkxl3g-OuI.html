<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Propping Open the Document Trapdoor | Coder Coacher - Coaching Coders</title><meta content="Propping Open the Document Trapdoor - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Propping Open the Document Trapdoor</b></h2><h5 class="post__date">2009-11-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/aOkxl3g-OuI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">lack of my talk is propping open the
document trapdoor we think the reason we
chose that title will become evident as
we go through the talk but as that
absurd what we're really interested in
is sort of rethinking the way
presentational documents are described
on a computer for the 21st century I
mean by presentational documents we're
talking things at the sort of level of
PDF things about a very high quality
typeset appearance but are used to
communicate electronically so what I'm
going to do to all can deaf will come in
and add his bits at various intervals
given the history and the philosophy
alongside this I will talk about what's
actually changed in the marketplace in
the way people can seeing documents and
why we think it's important that we do
this now and also we'll then go into
detail what are the problems with the
current document formats like PDF or
doing these sort of things but with most
things the best place to start with this
is at the beginning and this story
really began early in the year when I
bought myself an e-book reader I went
for the Sony model but they all seem to
be pretty much similar and what I found
was that while reading a standard novel
was pretty good the appearance was very
nice you've got the text you've got the
images those fonts were good and it
looked pretty good when I loaded on my
PhD thesis which was stored as a PDF
things started to look not quite so easy
to use so my PDF was designed for a4
paper size but obviously the display
size on the e-book reader
is a lot of smaller than that so the
device had to resize the display to fit
on there and the default option it chose
was to just shrink everything down to a
much smaller size and as you can see it
was just about illegible but it wasn't
very nice to read and actually you
having to strain sort of fill in the
gaps from what was being shown but
they've got this flow right but I didn't
worry the manual for the e-book reader
had said that it had the option to
reflow the PDF to sort of fit it on to
increase the font size so you could read
it nicely so I pressed the button to do
that and was presented with this where
yes it had reflow the text to fit but
all the formatting all the presentation
information has started to be
lost it had kept the right sort of fonts
but the factory it was double line
spaced was the standard for PhD thesis
in the UK was lost and you also started
to seeing that the actual line breaking
had gone slightly wrong and things
didn't look anyway as new ice it was
okay to read as a performance but it
wasn't as nice as had been seen before
when I realized there was a big problem
that's when I started to look at some of
the mathematics in my thesis what a
display fine suddenly ended up rotated
on its side and completely broken for
the matrix there which I've talked to me
was neatly typeset but suddenly ended up
rotated through 90 degrees and
translated and so it's just complete
garbage as I went through more and more
of the PDF and more documents like this
I found that while he could cope with
very simple things when it was presented
with highly technical stuff it went
wrong and what we're actually seeing
here is the difference between the two
common formats used on ebooks on the one
hand we have epub which was being used
for the novel the Alice in Wonderland
novel which is basically XHTML with a
few extra bits to define how things
appeared all zipped up in one thing
which worked okay for novels but
obviously as we know HTML has limited
support to typeset mathematics and
things and so isn't so good for
technical documents on the other hand we
had the PDF display which was very very
good at getting the typesetting
absolutely right and getting a fixed
performance but it was fixed to the page
size it was designed for at any attempt
to reflow it as we saw on the last slide
just looked absolutely horrible and so
we had these two formats one of which
which could work and really flow nicely
and another which could capture the
presentation and as I look more at the
ePub what I realized was even though
that the sort of just about okay with
the presentation sort of quality of the
typesetting who was creating as he
reflow this and altered the font size
you started to see that the quality of
the typesetting really dropped off and
here you've got this color of text on
the right where there's only one or two
words per line and it's not quite as
nice to read and if you increase the
fontsize even more we found that things
just got really really nasty you get one
like work a line on the right-hand side
here on the word wondering the letter G
has just disappeared off the edge of the
ebook reader screen so I realized at
this point that there was a bit of a
problem with the way the documents are
being stored and then for comparison I
got hold of my old childhood copy of
Alice in Wonderland and compared the
layout and realized that even with the
ePub the experience of reading a drama
thing wasn't quite up to the same
standard that you got with the hand
typeset probably hot metal in this case
copy that you get on paper and so I
started to think whether this was an
actual inherent problem with the formats
or whether it was something that could
be adjusted your problem with the device
as a whole and what I came up with the
conclusion was that it is down to the
current formats they don't seem to work
for devices like this you neither have
formats like epub which allow a good
presentation that can be refloat as well
in certain circumstances although that
breaks down as the constraints get too
hard for it to handle as we saw as we
increase the font size or yes stuff like
PDF which has a really good presentation
providing you view it at the same size
every time and so I was discussing this
with Dave and we came to the conclusion
we came down to the question is our
current document format suitable for
e-books we started to ask this to
ourselves and then as we thought about
this a bit more we realized that the
actual scope of this question was
slightly larger and was down to our
current document formats were really
suitable for the way we consume
documents in the 21st century allow me
to explain a bit about what I mean by
this traditionally when people have set
down to design a document whether it's a
home user using Microsoft Word to write
a letter or to produce a leaflet for
their local club or something they'll
sit there and design it in the software
for one particular layout and even
professional designers will do this
they're laying out a magazine or a
newspaper they have a fixed presentation
that they're producing this for and so
they'll lay out for that occasionally
you do get
things which are published in multiple
formats the classic example is novels
that come in hardback softback and
sometimes even other more weird shape
versions but because these are being
produced multiple copies and many many
thousands of copies they just
effectively treated as single documents
either just happened to have the same
content in them and so as I thought
about this I realized that these days we
don't just consume documents on one
device in one fix presentation we may
take a document of uuk on an e-book
reader or a mobile device we may view it
on a range of different computer
technology and of course we will still
print it and use it on paper and as I
thought about it you start to realize
that all these devices have very
different display characteristics I mean
the laptop and the desktop computer are
pretty similar but the netbook computers
often has a much truncated screen
vertically and so you get far less
displayed on it then you would say on a
laptop or net desktop in terms of the
e-book reader and the mobile device the
screens are much smaller and can't hope
to contain as much display as you'd find
on paper on a computer desktop and
actually this is a thing we're all
familiar with if you've ever tried to
read a multi-column PDF on our computers
we find that we're always scrolling up
and down the same page as we get to the
bottom of one column and back up to the
top we have to scroll around all we see
it on webpages where we've got a fixed
layout and coding in HTML and as we
resize the window it stays at that fixed
size and we end up with whitespace on
the other side or the other alternative
we find lots and lots of long lines of
text which are not very easy to read as
we see them on the screen
so as we considered all their stave and
I realized that if we're going to
support modern usage or adopt this idea
that can be viewed on multiple devices
at multiple sizes then we really must
rethink how we describe them on the
computer so that the document formats
take into account this fact that they're
going to be viewed on different sized
devices but we then realized that we
needed to step back and think about what
it is people do with documents what do
people want from a document and just
what actually your document is before we
started to think about how we designed
the new format so we stepped back and
started to think about the documents
purpose the first thing we realized was
a document was an information carrier it
was designed to carry information to the
person reading it and this could be in
the form of a novel for entertainment or
it could be a technical document that
you're reading to get some information
out of and in this case it's important
we realize that it doesn't just contain
text we may find images equations tables
diagrams etc in there and possibly we
realize it's in the future with the
advent of cheap camcorders and so on and
people using lots and lots of material
that you find on YouTube that people may
want to produce documents that also
emerge in video and audio clips as well
so as we started thinking about a
document new document format we realized
that we'd have to cope with more than
just text being loaded onto the page we
then started to think about how people
use documents and we flipped us realize
that the most important thing is that
people are going to read or consume them
and this means that they must have a
presentation they must have something
that displays them it's not just good
enough to have the text and code you for
the computer to deal with we must be
able to display it for the human to cope
with and the other thing to remember
here is that the design of this is
really important the way it is designed
really has an effect on how the human
sort of feels about the information
contained if something is very poorly
developed design they often don't feel
confident with the material whether
you've got a very nice clear layout that
they often put a lot more confidence in
the material what does it say so we
realized that the the way they lay out
the design
the document was absolutely vitally
important and we needed to be able to
encode this as well of course the other
problem is that we need to be able to
change that design sympathetically
depending on what device reviewing it on
so if we're viewing it on a desktop
computer we've got a lot of resources
big screen real estate and we can
generally fit quite a lot in but if
we're viewing it on an ebook reader
we've got far smaller space and perhaps
we have to switch from two columns to a
single column layout as such like but
we'd also have to make sure that images
were positioned like we saw with the
Alice in Wonderland example so that we
didn't get strange text layout happening
around it the other thing we realized
about documents is that people like to
be able to repurpose these things that
could be able to take content from them
and use them in new documents now this
could be like we all did as kids with
scrapbooks we just cut out a piece of
information from a newspaper and stick
it into a scrapbook just to keep it or
it may be they want to use this content
to drive another computer process so you
may have an equation in a text in a
paper that we're reading we may want to
feed it can some week to plot that graph
for us and so we realized that we needed
some form of structure as well as the
presentation in these sort of new
document formats to support this so he
has some sort of idea of what the
content actually was so that the
computer could probe says it as well as
a human could sit and read it
so to recap documents would be
information character carriers but that
information wouldn't just be text
anything we did needed to have strong
presentation we needed to be able to
encode the presentation of the document
with it so that we could reuse this
every time and view it and understand it
with a human but we also needed to
include some sort of structure so if it
was repurpose a ball for the computer to
use it both in terms of being able to
reflow it to fit onto a new display but
also in terms to be able to use it to
drive a new process and it's this
repurposing repurpose ability that we
really think is the key feature that
we're going to have to consider as we
consider to develop these new document
formats the fact that we need to be able
to repurpose them to new display shapes
or to repurpose them into new computer
processes we've got to keep that in mind
when we design these new
documents the other thing we realized is
speed these devices have quite low power
processes compared to say our desktop or
laptop computers it's an ARM chip
probably around a few hundred megahertz
but they also have high resolution
displays and computer screens have
typically been so as while they're
having to generate more information on
the screen they've also got less
computer processing time to deal with it
and what we actually find is that the
more complicated the presentation is the
more computation the computer has to do
the less page turns per battery charge
we're able to get and with a device like
an e-book reader or even even a mobile
phone we really want to maximize this
page turns per charge
I have a PDF here that I created for one
of the other people at the University of
Nottingham and what I find is that even
on my 2.8 gigahertz laptop you can still
see it visibly redisplay on-screen as I
change to it you move around zoom in and
out you can see it it's playing on
screen the document is so complicated
that even on a 2.8 gigahertz laptop you
can still visibly see it refresh and in
terms of knee book reader though
something you want to minimize you want
to try and mimic the format yeah well I
mean even on say a mobile phone or a
laptop the more computation has to be
done to draw it the more battery drain
you will get on your battery so we think
that it's is important and in fact the
places where we read documents mean on
the plane over I was reading documents
you really do want to extend the battery
life if you're on budget obviously on a
desktop it's not important but we feel
that these documents aren't just going
to be viewed and so what we're thinking
of doing is making sure that the way we
scribe the document is amenable for
these sort of processes rather than just
saying we've got lots and lots of
computer power so we can do this in a
way that uses it we're going to try and
take into account that we've got small
devices with low power as well as high
power devices yeah yeah I mean that's
probably the one way to describe it but
that's where it came from as we were
considering it so okay I'm now going to
hand over to Dave who is going to talk
through this sort of history of where
current document formats have come from
hello everybody
again can I echo Steve's thanks for
inviting us it's very very good to be
here I'm David Bradford I think I've
been called here for a little bit of a
historical retrospective you will have
gathered from what Steve has said we're
not really coming here with any answers
nor with any implementations of anything
because this Avenue of research which
we'd passionately keen about going down
has really only just started and so you
know we're looking for ideas and
inspiration from anybody as to exactly
what kind of compromises we need to make
in trying to get this repurpose ability
and reflow ability and so on and it
struck me that if we looked at the two
big success stories that are highly
contrasting in their approach to digital
documents namely XHTML and PDF we might
learn something about how to do it and
in a sense how not to do it as well so
yeah I mean I think we all know this
really 1984 for me was one of the most
amazing years of my life I think every
computer scientist goes through certain
years when they think the world changed
nothing would ever be the same again and
for me the Macintosh the laser printer
PostScript to just blew my mind and it
made me quite determined I wanted to be
in document engineering for the rest of
my
it was quite incredible and of course as
we all know what it gave you was the
ability to have really high quality
typeset documents and yes PostScript
appeared on things like lino tronic 750s
and all that very high quality things
but the real beauty of it was that it
came out on three hundred dpi devices
the apple laserwriter later six hundred
dpi so you know you could proof on your
laser printer you could commit to your
higher quality device then if you wanted
to and so on however I think the
frustrating thing just after in a few
years just after 1984 was that many of
us wanted the ability on the
increasingly good workstation screens to
preview what we were going to get
without even having to commit to print
on a laser printer even and again I'm
sure lots of you know that for many
technical reasons of fairly slow chips
in those days shortage of memory and
also for some political reasons as well
display PostScript as it was called
never ever really caught on or took off
but in the end fairly shortly after that
Adobe did do it right as it were they
developed a thing originally called
carousel which promptly as we drop like
hot potato when a certain Kodak
threatened to sue them if I didn't stop
using the name and of course that became
Acrobat and his underlying format PDF
well known to all of us what it
essentially gives you of course is
nothing more or less than as a
reportable print master for arbitrary
complex typeset material it is as we
know solidly page based it is very hard
to reflow and repurpose as you've seen
with Steve's PhD thesis that matrix no
way should be refloat like that and yet
it bravely tried to do so amazingly and
only of course a few years later one got
the complete contrast in an approach to
documents engineering portable documents
and so on the experimental hypertext
systems which we developed Thatcher in
the 1980s finally made it into public
and popular awareness via the World Wide
Web
and of course hypertech's purists in
those days absolutely hated it but it's
gone on to conquer the world in many
ways and as I think Steve has already
indicated the problem there is its hTML
is a very weird hybrid of a little bit
of structure and a little bit of default
rendering and of course that little bit
of default rendering tends to vary
somewhat alarmingly from various browser
manufacturers and the idea is that if
you want a better-looking rendering then
you let CSS on top of it afterwards
almost as an afterthought it's not a
tall page based as we know it's more
like an endless scroll so I think one of
the things that occurs to us in thinking
about if you like the structure
appearance compromised in any new
approach to digital documents is this
HTML does a little bit of structure and
a bit of default appearance and complex
appearance is almost lay layered on as
an afterthought PDF is exactly the
opposite way around your detailed
appearance is this incredible mixture of
what you think of as your data
intermixed very intimately with
rendering operators and if you want any
structure then Adobe does enable you to
create a so-called structured PDF but
it's the structure that's the
afterthought so navigating between these
two extremes which is the correct way
forward what does one sensibly take a
little bit of both if that's what you
want to do so yeah as we know page lack
effects are really substituted by exotic
transitions of various sorts or simple
hyperlinks and so on the other thing
which I know Steve will be showing you
later on is that many of our colleagues
particularly say oh you know good thing
about XHTML it's all in XML and anything
you put your necks ml instantly becomes
easy and clean and wonderful - which we
often reply oh no it doesn't just
because it's in XML meta notation
doesn't say a thing about whether it's
detailed yucky and so on and certainly
Steve's got one or two two examples to
show as if you didn't know already there
xml-based notation can get just as messy
and just as low level as the innards of
PDF do and the other common fracture I
guess now is a text HTML and PDF for
both code generated very much from front
ends there's I suppose a few hardcore
cells out there that still hand code
they're web pages but they're a dying
breed I thought I'd go through this
diagram with you I'm often told by my
grad students that when I go to the
document engineering Nirvana in the sky
this is the one outside with me
oh you think 10 years ago and I've
hardly had a change of thing it was used
at a meeting in the UK of newspaper
publishers basically saying to them yeah
remember this is late nineties they're
all familiar with dumping their
PostScript that produce the newspapers
into PDF and then only later on finding
repurposing that for the web is well
nigh impossible they're rips that print
the newspapers have done all sorts of
things about the rendering order not
being remotely related to the reading
order so repurposing that material can
be absolutely horrendously difficult but
at the same time the newspapers had come
under a huge amount of pressure that
they must start doing websites to back
up the newspaper content so I drew this
diagram and chairs in Adobe I've just
put InDesign up at the top as something
that can generate a wide variety of
outputs and I pointed out you can come
down the left-hand arm of web publishing
driven by sgml XML type Mehta syntax
technology you layer on your CSS make it
look reasonably nice or on the other
hand you come down the right-hand arm
and you go for the classic print
solution for your newspaper and I said
at the time to the audience I said you
know I bet you those two teams that do
that hardly ever talk to each other and
somebody stuck up their hand and said
it's far worse than that they won't even
go to the same pub that's really serious
you know so the point I'd like to make
here because it does bear on that
ground where all those heavy arc arrows
are is the following if you look at
going from left to right from structure
to appearance things are not too bad
things like web capture of Adobe's of
course visits web page translated into
PDF and also you might say the Apple web
browser which goes off picks up web
pages and is solidly PDF based as it
were inside going that way is not too
bad what I want to ask somebody here or
somebody come point me at somebody here
who would know you are really face
they're difficult is the other way at a
very public level because you get your
Google hits and if it lands on a PDF it
basically says viewers HTML for those
people who still have about reader now
you do a reasonable job it's a really
tough gig going the other way from
appearance to structure it's not at all
easy and I suppose one of my questions
is that just a few but not very many
PDFs out there on the web do have the
Adobe structuring tags inside them again
as many of you will know that's not
really for any old Trapps track document
structure purposes it's basically to
establish a reading order so that those
things if you follow the tag so to speak
become easier to read aloud but if those
tags are there does it make it any
easier to go back and view as HTML
logically at all to but I sometimes
wonder whether they really are of any
use much at all okay so to summarize
then I think what we're saying is
somehow our new format has got to be
good enough to produce a nice-looking
appearance but it's got to go back a
little up the abstraction chain because
yeah I'm saying there look InDesign can
produce as it were an XML eyes version
of the document that you input to it it
can export as HTML it can export as PDF
but what is really infuriating for this
eBook work is that you may only want to
do a small amount of reflow but you
don't want to have to revisit the
authoring application that designed it
first place you want to go a little bit
backwards at the left to gain some clues
about these objects you know is it a
matrix is it a table is it a photograph
and therefore to have a few simple rules
it seems to me about what you can do and
what you can't do with those objects I'm
not saying it'll be perfect but every
little bit of hinting helps so there we
go then repurposing a document requires
us to understand the content of the
document whether it be for extraction or
reflow and that is very very tricky with
current formats back to you Steve
I hope the reason for the title is
because you're giving obvious because as
we convert the documents more and more
from the structural representation where
we can do things like repurposing and
reflow so sort of appearance a
presentation based thing it's like the
document falls through a trapdoor and
you lose enough information that trying
to get back out from that point is very
very difficult and so the reason for the
title is that what we're defectively
trying to do as Dave said is pop open
that trapdoor so that we can repurpose
the document and reflow it to hit new
things now as they said it's very very
tricky and things to do that so what I'm
going to do now is take a look at some
of the formats and see what are the
weaknesses and what are the strengths
that are causing it to be difficult yeah
so I'll start I mean obviously reflow is
easy in XHTML every web browser on the
planet probably manages it to some
extent or another and the reason this
works is because XHTML as you all know
describes a document in terms of
text-based blocks we have paragraphs we
have divs and the text is just then
flown into a shape to fit it the
formatting is applied a display time so
when we display the document when we
view it in our web browser it's run
through an algorithm to display that
whole screen generally web browsers use
pretty simple algorithms because the the
more complicated ones that get nicer
title layout are much more
computationally extensive expensive if
we consider the north' class algorithm
that's used in latex if you could
imagine that you'd have to wait every
time you read a web page for latex a
certain
set your document for you before you
could actually view what it wasn't
wanting to see on screen I don't think
the web would have taken off anywhere
near as much as it has now but what we
find
even though XHTML is good at reflow is
the one what to do complicated layout
things get more Nass that we have CSS
floats which effectively end up
positioning things roughly at absolute
positions on the screen or if you were
to do really complicated layout example
from Alice in Wonderland where we've got
the mouse's tail which is sort of flowed
into the shape of the mouse's tail and
the fonts getting smaller and smaller if
we actually look at the XHTML from the
ePub document that created this what we
actually see is that we have a series of
spans containing already pre line broken
words with a different font size apply
to them and another service fans would
are actually providing an offset from
the left-hand side of the page to
position them into that wavy shape and
what we find is that as we get more and
more complicated layout we tend to
become more and more down to specifics
in the XHTML PDF really does take this
to the enth degree and what PDF is
interested in is that hard coded
appearance and everything in a PDF
describes that for those that are not
familiar a PDF is constructed from a set
of what Accord calls objects these have
built up into various structures to
represent different things within the
document so today so there's a structure
tree in some PDFs but there's also a
pages tree which defines all the pages
on things each page is represented by an
object and this will have links to other
objects which represent the resources it
might use fonts images etc and also a
description of the page content now this
page content description is stream based
it's a series of ASCII characters at a
process by the PDF interpreter to
display things on-screen unlike perhaps
poster which we some of you may be
familiar which was a full imperative
programming language PDF is completely
declarative the operators within the PDF
content stream just describe image this
piece of text here draw a line from here
to here place this bitmap image at this
position there's no sort of computation
and
it's completely declarative and what's
appearing on the page and this is why
partly PDF was designed to be much
faster in the early 90s with the
computers there than post requires to
display on screen so the operators that
appear on screen that can be described
in two groups there's the content
operators which describe what appears in
the document these fall into things like
pastors there can be filled or stroked
text which can be fired in very
different fonts and so on bitmap images
and a few other things and alongside
them there are operators which set the
context which these content is drawing
so you can set the fill color the line
with the font size and so on and once
these are set they persist until they're
changed or the end of the document or
page is reached so if we take a look at
the output this is the content stream
and you see that you get operators that
say image the T at this position
followed by an hour to another position
then because the letters I and n
together V an ENT and one of the things
you see is that PDF isn't even concerned
with spaces between words as far as its
concerned there's no need to encode them
because if you're imaging think position
then they'll appear at that point anyway
and you find that these PDF streams go
on and on and eventually when viewed
they image the page you're interested in
you can see up here with top line we get
the to invent programs that we started
to look at in the content stream so the
PDF contest dream is purely designed to
image two things on the screen and one
of the big problems with PDF is that the
content stream basically works on the
principle that the end result just
defines the means that you get with it
and so as it's only concerned with the
final appearance the way the content is
imaged is immaterial as far as the PDF
interpretation is concerned as long as
you get the final appearance is happy
and what you find is in some PDF you
don't get the text imaged in reading
order so not only is it broken up into
single characters or small words you
sometimes find that they aren't image in
the same
order at all on the page you'd expect
and I've got an example that I'll show
you in a minute you also find it's being
done for specific reasons and it's some
graphical effects that type designers
use you often find require things to be
imaged out of order as an example of
that the execution of the PDF
interpreter yeah so on this I've got two
example two copies of the same PDF
document but they image the document in
different ways and I've also got a
slider at the right that allows me to
control how much the document is imaged
and what we see is we alter the amount
of documents imaged is the two ways they
build up the document so this one on the
left is using what typographers would
call baseline sort or more commonly is
hopping the gutter and so as we build up
it'll image the text on the Left
followed by the text on the right
whereas the one on the right is using a
much more sensible approach and is
imaging the text in the way we would
read it so it's going down the column on
the left and down the column on the
right and the problem this causes if we
want to do anything with the PDF in
terms of reflow we can't just apply as
some sort of process to get the text out
we have to sort of reorder it this is as
it appears in the content stream into
the order that we'd expect to read it so
they can reflow it as we expect
otherwise we'd end up as we often see
sometimes with cheaper PDF viewers that
you couldn't pay some flex out of it and
it always ends up jumbled up on screen
the other problem with the PDF is we try
and extracting content for repurposing
or reflow is that they operate some of
the operators set the context the line
widths the font color and so on as I
said and these persists until the end of
the document or until something else
changes and the problem with this is
that we can find that these operators
right at the beginning of the stream
which are happening effect on things
that appear at the end of the document
and if we're not careful and we just go
and pull the content out from the end
without considering with what's gone
before we find that what we end up with
display
on screen is completely different to
what we expected to pull out and we can
actually draw the analogy here to a
computer program we consider the PDF
content stream to be a computer program
then what we're actually trying to do is
extract one procedure from the program
for reuse elsewhere and if we're to do
that effectively we need to consider how
that procedure is affected by the rest
of the program it may rely on other
procedures or functions in the document
or on the setting of global variables by
other parts of the program and so we
can't just extract a piece of a program
and use it elsewhere without considering
the whole of the rest of the program and
it's exactly the same with the PDF if
you want to extract some content from it
then we have to consider the whole of
what the PDF page was doing to get to
image the whole page and sort of
constrain it ourselves and really
understand what's going on so we feel
it's quite clear that the current
formats aren't really suitable for
getting a high quality of presentation
that we can reflow and repurpose as we'd
want they either don't really allow high
quality layout with HTML we get by using
tables spans CSS floats and things or we
have things like PDF which do allow
really high quality of layout but
require significant processing to do any
repurposing and even then the end result
is something that isn't as effectively
as we'd like but can they actually
between do we have to go off and develop
a completely new format or can we make
some tweaks to the existing formats to
make them suitable and what we'd like to
do now is just talk about some of the
work we've done in the past few years at
Nottingham to attempt to do this so the
first was actually the topic of my PhD a
few years back which we called cogs who
look at first and then Dave will come
back and look at some work we also did
at marrying a structural representation
in the document with a presentational
representation as well and link
informing hard links between the two so
the component object graphic or cogs was
basically an attempt to extend the
metaphor of the document of a computer
program and we said it's hard to pull
code out of a PDF in the same ways it's
hard to pull code out of a program
but we've developed tools when we write
software to make this easier so we use
things like object-oriented programs we
write things in terms of objects which
are designed to be pulled out and reused
elsewhere and so we said what if
documents were object-oriented and so we
implemented this on top of PDF we found
ways that we could use structures that
no one was using aside PDF to create
sort of object-oriented blocks of
content which we could then image on the
page so we redefined the page so instead
of being a complete monolithic block of
content operators that draw things we
said that the page is now as a series of
objects or cogs as we called them that
image on the page at specific points and
we also said and this was the crucial
thing that each cog would be completely
self-contained what we meant by this is
that the cogs would assume nothing about
the content state or the graphic state
of the page so if the character wanted
something to be read and in Times Roman
it would explicitly set that this thing
was to be image in read Times Roman
rather than saying oh the last thing I
did was in read Times Roman I don't need
to change it so it explicitly set up the
state that it needed it would also again
this was just like PDF linked to the
resources and the thing we found as we
did this was we actually had to link to
the resource that was used to create
this piece of content because there are
subtle variations in the widths of the
glyphs in fonts for example which cause
if he didn't link to the exact instance
it was used to create it then you found
the typesetting all went horribly
nathalie wrong the other thing we did
was I said well these cogs should be
good citizens if they make changes to
the content they'd also undo those
changes we'll make sure that they didn't
affect anything after that so that you
could then remove them and add them into
the document as we went as I said we
implemented all this on top of PDF and
we did this in a way that didn't break
compatibility with any with any PDF
viewer so all my comp PDF documents are
completely valid however if we were to
load them into at all which understood
cog media which is generally Acrobat
with a few plugins I wrote on top of it
although a couple of other people have
implemented parts in the specification
then we can manipulate the
in various ways we could remove content
from the page very easily add extra
content reposition it on the page even
create new documents by dragging content
from one document into another and we
also have programmatic ways of doing
that
so just to provide a way where we could
easily extract content reuse in other
documents until our new documents to be
formed but it didn't really help with
reflow we'd solved all the containment
issues would all be done in terms of
reflow was to sort of sort of reduce the
problem down to a smaller size we still
had all the same sort of yuckiness
inside the car that you find in a PDF
page it was just as it now applied to a
much smaller part of the document and so
we had some hope of doing that but not
much I'm going to hand over to Dave now
who were close by talking the work we
did I think it's down to me to say a few
more things and I think a whole talk as
well what hasn't been so explicitly yet
but I think is worth while interjecting
something about it is to say if we come
at this problem top-down and a great new
future one of the things that surely is
going to have to happen and I don't see
many signs of it at the moment in things
shall we say like InDesign is rather
than saying you can start with InDesign
and go to XHTML you go straight through
to PDF you can do other output formats
with it they all tend to be one-way
processes with these kind of implicit
trapdoors and you can't easily get back
to infer what the starting InDesign
script was but also I don't see much
sign of the things saying are so you are
a document author and of course you will
want to create a multi-purpose of all
document you'll want to do it not only
for a hardcopy novel but you want to
create the e-book as well so help me
come on give me some hints tell me when
you start putting these tables in what
would you like me to do with them on I'm
you know I'm inferring that what you're
doing here is gonna
type table and that you're not just
abusing tabular facilities are you to to
gain you know graphically nice content
but it's not really of type table all
those sort of things do seem to me to be
very very important indeed that we start
trying first of all to design in
repurpose ability but also to accept the
inevitable facts that people will
absolutely swear blind it's going to end
up on us letter had never on anything
else and then somebody will swing it on
to an e-book reader for which it has not
been designed and we still want to do a
better job that is currently being done
and that is the real challenge and
perhaps the biggest challenge developing
on from that is not coming top-down and
going bottom-up people will want to
write how should we say rescue legacy
PDFs from the web which is what you guys
do all the time and it will be lovely to
be able if we can afford the time to
infer the structure a bit better to do a
better job than just slamming it into
HTML and closing your eyes and sort of
hope it works
but that's inference of structure is not
easy to do and yet it does seem to me
that to get old material better than it
is at the moment it is an important
thing to work on
well my group actually back in the
mid-1990s I think I think we were the
first to publish on this I guess there
may be other groups in the world working
on it at the time in about 1995 we
started looking at inferring document
layouts and document structures and
document objects bottom-up not starting
as the scanner manufacturers would do
with a bitmap but just starting with an
unstructured PDF you know it's come from
somewhere can you tell me what it is is
it a newspaper is it a magazine is it a
academic article so that was the sort of
structure of recognition we tried to do
roughly that kind of granularity that
kind of level and then it really did
hitters of course for the first time
that rendering order not being the same
as reading order is a huge huge problem
you start having to do X Y sorts on all
your text runs and so on and so forth
and of course these techniques were used
and are now very widely used in OCR they
are of course used in Adobe's own
Acrobat CAPTCHA where they use OCR to
acquire the text and then lay that text
as it were invisibly behind the bitmap
and then with their capture plug-in come
up with the apparent miracle of
searchable bitmap text and you can make
bitmap PDFs more accessible that way as
well
so its thesis was our product where we
started working on this and made us
realize the real importance of document
structure inference the other thing
we've done which again I think
highlighted to us some of the problems
we face but in some senses was a step on
the way from about 2001 to 2006 had a
couple of my grad students working on
the problem of something like this
suppose you've got a nun structure to
read only PDF and you want to make it
more accessible you are not allowed to
add structure into it it's on a CD or
some copyright restrictions say you may
not mess with it at all we tried a lot
of work and it was really very useful in
saying well we could kind of externalize
if you like the structure as I believe
what the XML people call standoff markup
you could have your original dot book as
it were source and what you assert is
your corresponding PDF text and then
build a kind of shadow tree of pointers
saying this paragraph in docbook
notation really does in bite pointer
terms start there in the PDF and end
there in the PDF and you can imagine it
was a huge relief to us doing that if
ever we got one of Steve's cog PDF
because then it's very clear you'll
point at the right cog you are not
pointing at bits and pieces of PDF
rendered in funny orders which logically
belong to the same thing but of course
unfortunately not many people create
called PDFs so we were able you know
basically to say that piece of typeset
music notation here corresponds to the
abstract music request as it were in
your original source document
so yeah you could point from something
like the docbook original into the PDF
it works fine up to a point the problem
I would say is basically this you've got
your abstractly structured document here
you've got your detailed PDF here you
build links by what we call landmark
pointers from one to the other it's
handy to have that assertion of
equivalence but the problem is those
arcs are not decorated in any way with
how you did it what was the document
processing that went on between there
and there and I think what we're saying
is that exactly those links between your
starting point and your finishing point
ideally should be decorated with just
enough hints for want of a better word
as to how you might first of all what
type of object is that we're talking
about and what are the reflow ability
options available for that thing so that
is really in my view what we need to be
looking at in our new format carrying
over in the mapping at least some of the
rendering reflow decisions and at the
authoring end trying to extract that out
of the author without hacking them off
and you know them saying I'm trying to
get on with designing my book honest it
will never appear on a B book I'm just I
don't want to get into a situation of
the bouncing paper clip you know where
it comes up to you and says hey I think
you might be coming to an e-book with
this thing have you ever thought about
what might happen but yet it would be
wonderful if we could extract that
information upfront from the authors
okay what I then where to next document
representation and what we're saying is
what should this representation be we
don't want it to get too heavyweight and
yet we want it to enable us to do a
better job than we currently do on the
exact sort of examples that Steve has
should it be component based we see some
real advantages in going that way in
rejigging your components like sliding
blocks so to speak on the page where
does the heavy lifting work happen in
some sense the more you just put hints
on things the more you're relying on
your
rendering our engine still to do
something about that and as we found
what you don't want it to flatten your
battery in about two seconds flat trying
to implement some fabulous free flow
algorithm which makes it look beautiful
but it's very computationally expensive
another possibility would be to have a
sort of interpretation scenario of the
sort I'm saying you consult your dynamic
Lea on the fly but maybe being able to
compile some key documents if it's
worthwhile doing it down into a more
compiled code form closer to shall we
say the graphic primitives on the Apple
is another thing we're looking at
multimedia we haven't said a word about
it but we know it's not going to go away
it gives us a headache even just
thinking about text on ebooks but yeah
we know multimedia has got to be coped
with and as I've tried to indicate it I
think this business of backwards
compatibility you've it's no use wishing
that X HTML and PDF would be suddenly
replaced by some wonderful new
intermediate that combines the best of
both people will want to put their own
documents and give them this new reflow
repurpose of all capability if we can
but we've got to recognize enough
structures in them to be able to do that
is that it okay I think we'll call a
halt there thank you very much and
invite questions if that's what one does
in Google</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>