<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GTAC 2013: When Bad Things Happen to Good Applications | Coder Coacher - Coaching Coders</title><meta content="GTAC 2013: When Bad Things Happen to Good Applications - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>GTAC 2013: When Bad Things Happen to Good Applications</b></h2><h5 class="post__date">2013-04-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/zBEtAOEy360" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">actually next up is going to be menaul
Mishra from netflix and he's going to
talk about when bad things happen to
good applications great thank you good
afternoon everyone well I hope you can
hear me alright I'm now and I manage few
of the key platforms in Netflix to start
off did anybody did everybody know that
yesterday was a good day so happy Earth
Day to everyone i'm going to use earth
science to kind of introduce my topic so
let's start with what what makes a
successful life system one of the most
widely accepted theories of plate
tectonics plate tectonics for the
uninitiated is basically large-scale
movements in the earth's lithosphere it
is not limited to just the formation of
mountain ranges and ocean trenches but
it also postulates that it is very
essential for life to succeed on earth
some of the tasks that are accomplished
by tectonics are replenishment of
depleted nutrients generation of
magnetic field which prevent the solar
while and solar wind from affecting
earth and stabilizing the temperature of
the planet by recycling carbon dioxide
so what is the similarity between a
successful life system and a successful
software application a successful
software application needs to adapt and
constantly innovate depending on market
demand this means that there is constant
change in every layer of the stack and
haven't we all seen that with the
success of the mobile platforms we know
that these platforms need to constantly
and rapidly innovate
but with every coin has a flip side so
does this churn in the case of life
supporting plate tectonics we have seen
catastrophic side effects like wall
canners landslides earthquakes and while
we have come to accept these side
effects we have also made tremendous
progress in the technologies that are
used to determine and drag these events
with Heidi with high grade of accuracy
thankfully we in the software industry
don't have to deal with anything of that
magnitude but software development the
dynamics go hand in hand with its own
side effects that we refer to as bugs
and we have gone and developed a lot of
systems that you know helped catch these
bugs sooner than later I'm going to talk
about one set system that at Netflix has
helped us catch these bugs which is our
enduring system and I will basically
also explained you know discuss some
case studies which will help me
illustrate how bad things that are out
of your control can affect a good
application so let's start with what is
the motivation behind endurance tests
for a consumer application the user
expectation right we all as users have
began to use mobile applications rather
than website because of the magical
experience offered by it with greater
performance the performance of
application again varies from platform
to platform and also on the application
architecture we also face unpredictable
user behavior where a user behavior
might might invoke code paths that might
affect the performance of the
application and finally
or a media application like Netflix
where users spend at least 30 minutes
right we don't have TV shows which are
shorter than that a simple memory leak
can lead to suboptimal experience for
our consumers so like every other
automation team we went ahead and you
know build a functional automation
system the architecture that you see
here is very similar to a lot of the
client automation architecture that are
available today however we built a
custom in how solution solution
basically which could scale to multiple
different platforms that our application
is available on and also build reusable
parts a certain platforms you certain
parts but overall this is the
architecture of one such platform using
those reusable parts and of course you
know with the continuous integration
mantra we put our functional tests
behind the continuous integration system
on Jenkins the thing with the with the
custom solution was that it was modular
enough that we could basically develop
endurance tests on top of the system
with minimal effort and then with the
power of google spreadsheet we were able
to build a reliable endurance reporting
system obviously you know we are client
automation team we don't want to deal
too much for databases server and the
cloud so why not use google spreadsheet
so what do we measure we basically split
our performance counters into three
parts platform specific which is memory
utilization of the the platform itself
cpu utilization metrics that is provided
by platform the second being video
playback statistics where we measure
things like you know the playing video
bitrate and audio bit rate which is
again dependent on that
condition that's the hardware itself
that you're playing back on the frames
rendered dropped the buffer size which
is important and rebuffed accounts which
is really important from consumer
perspective since it determines the
quality of experience the third third
pieces of course the application metrics
where we measure startup times for the
application in order to give a good
consumer experience you need to have
faster startup times and we also measure
certain transition times between pages
as the users navigate through them so CI
for endurance you can see the image
right there which is pulled from the
performance metrics that you normally
receive from a car like a lot of people
in the bay area where I live I also
drive a hybrid car and what I've
realized is the continuous feedback on
the book on my driving performance has
helped me become a better driver so we
we took this idea and we put it for our
application to measure to continuously
measure the performance of our
application this also ensured that
performance is treated as a feature and
not as an afterthought and for for the
test teams benefit we get the ensure
that our endurance tests are current but
you know what they say about old habits
they die hard I realized that when I
came back from a long vacation and I
began driving my car I easily slipped
back into the old bad habits and I felt
that having looked at my performance
trained over a period of time I could
easily correlate the mistakes that I was
making with with the trends and be
easily able to remember that so we took
so we decided to build trend charts on
top of our continuous integration for
the endurance test where we use simple
statistical functions
to kind of track progression over build
for the different performance counters
and we looked out for these statistical
outliers using this system we were able
to find several bugs that were
introduced by our developers but to
justify the title of this talk I'm going
to talk about two such case studies
where we found issues using this system
that were not introduced by our
developers the first one last year
Netflix realized that the API service
that delivers data to hundreds of
different devices needed to be riorca
tected the main reason behind that was
the main reason we had that was the fact
that one-size-fits-all model could not
work with you know low-power devices so
what the the direction that we moved to
was giving the control to the devices to
be able to tweak the response so that
you get just enough response data to to
render a rich UI for your platform as I
mentioned before we were tracking our we
were tracking the the startup times on
our platform over different bills and
this chart over here basically shows you
the different startup times to the
different experience that you might
launch inch into one is the regular
experience and the other is the the kids
experience what we realized is after a
point the once we switch to the new
version of the API the startup time to
the the kids browser screen increased by
about twenty-five percent and we were
able to look at this build and
immediately notify our partner team and
over a period of time we were able to
fix it before it will actually affect a
dark and consumers the next example is
even more scary
is we we got notified of this issue
three days before our release this was a
release that we were scheduled in
December when we were releasing a ton of
promotional features for our new
original series house of cards it's a
great show if you haven't seen it so the
other thing that we also do is you know
like I showed in the the application
stack itself like we are dealing with
bleeding edge services we also deal with
the bleeding edge ATK from our partners
so like a good dog good consumer of the
platform ATK we were the first one to
take the ADK version the top graph
basically shows you the application
memory that that is provided by the
counters in our application and it kind
of remained consistent over the last six
months you can see it's kind of remain
flat in terms of how much memory is
utilizing the bottom chart shows you the
available native memory which is the
memory provided which is the counter
provided by the system which tells us
how much memory is remaining and you can
see as we switch to the new version of
the ADK you can see the mountain ranges
out there where there were times when
memory hit rock bottom and there were
times when it remained constant but
while testing this we found a functional
bug which was more worrisome where the
playback would crash every time you
every time you change the audio stream
which is you know a big deal for our
customers and we realized we were able
to track this bug back to the ADK so we
revert it back to the previous version
of the ADK notified a partner and went
ahead with our business three days
before the release the partner comes
back to us and tells us that the the bug
has been fixed and you know you can go
and adopt it so we said okay we will
test it out everything worked fine
functionally the you know the
application looked really good
but what you see out here is that the
native memory consistently hit rock
bottom so these are a test endurance
test our tests which run for two hours
over our platform and most of our
functional test gets done within 30
minutes so the memory leak over here
manifests itself after one hour of video
playback and as a netflix consumer you
know there are no movies which are less
than one hour long right so we were able
to track this down to an 80 k bug again
we revert it back and ship the version
in time the main the key takeaway that
we have over here is basically anytime
any form of tests that you're developing
whether it be functional integration or
performance tests make sure you're
consistently running it and analyze the
result and that that you get out of
these tests with these starts I would
like to end the talk with a quote from
Robert Allen which has a bigger meaning
in life but I think it's still
appropriate for the test community thank
you
great thank you but all yeah that's an
old adage if nothing is running it
doesn't use any memory so that's a good
learning yeah I think we have time for
one question I don't see any live
questions just yet we'll wait for the
dory if there's a good Dory question
i'll pick it otherwise we're going to go
to into a break right after this until 3
45 and then we have two very interesting
talks one from academia and one talk
that has influenced many of the others
here so let me see if let me see the
story question or this moderator
question here it says do you include any
testing part into your product delivered
to end-users what statistics do you get
from the apps on end users end users
devices and how do you deal with it with
that huge I suppose amount of it and if
the lawyers are not here it's ok if you
don't answer that uh yeah basically we
do a lot of end user testing we do
instrument our client applications with
a lot of information that gets logged
into our service we have a you know huge
cloud-based system which basically
collects all this data and we we
basically process this data in a
distributed cloud platform to kind of
you know get an analysis of what our
users are face you know going through
because it's very hard for you to test
all the all the cases and the best way
to test it as by testing it in
production great and with that thank you
we'll be back in seat at 345 so you'll
see you then thank
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>