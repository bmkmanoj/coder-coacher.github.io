<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>DocEng 2011: Building Table Formatting Tools | Coder Coacher - Coaching Coders</title><meta content="DocEng 2011: Building Table Formatting Tools - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>DocEng 2011: Building Table Formatting Tools</b></h2><h5 class="post__date">2011-09-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_BqhOJ2D5uI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is me hi Blanca from University
of Limerick Ireland thank you for
introduction to Andrew today will be
i'll be presenting a paper on building
table formatting tools just to give you
a an idea of I'm gonna stick into within
the given time I for take slice don't
worry there are some of them are just
lots of images and I'll be flying
through them just there's a little
counter at the bottom of the
presentation in case you wonder where am
I about and how long do you still have
to wait until I'm finished why this
paper tables are widely used for
presenting logical relationships between
data items interesting enough the
widespread of WYSIWYG tools only allows
us to control typographical parameters
and very little control do we have
around the structure the table structure
manipulation have you ever tried to
rotate a table after you realized it
doesn't fit into your page and you have
to rotate the other way around and see
how long that's going to take and also
see how long how many rows can you
actually introduced when you try to do
that also the existing tools have
limitations last year I kind of
highlighted a couple of the problems
that existing tools have from word to
openoffice to other word processing
tools that we currently use and you
probably know that altering tables is
hard time consuming and error-prone
during the presentations I'm going to
look at a review of the logical table
models I I will be presenting a table
drawing tool prototype and in that
context typographical issues and the
table drawing through prototype
implements an automated table out
optimization for tables with spanning
cells we are reporting on experimental
results for large tables we are making a
comparison with the previous models that
we have published and we also providing
a simplified solution for nested tables
and we are going to draw some
conclusions so illogical table models
being able to
control the table after the logical
level as it presents a couple of
advantages that have been already
documented you know as I said earlier
you are trying to rotate a table once
you realize it doesn't fit in the in the
given page weight and you realize this
is going to take me forever to do that
you know so one of the first people to
look at a logical table models beach in
1995 he actually presented the model
where the table is in fact a grid that
had a table topology and a table
geometry which has defined that as the
table as a doco attract object in a
tioga document processing system and the
object knew how to format itself based
on a given on given dimensions in 1999
cameron identifies three mental
processes in tabulating structural
editing content editing and visual
editing 1989 van arbic came with an
interesting way of defining tables using
a language based on attribute grammars
and basically an arabic looks at tables
as a multi mile multidimensional
collection of logically connected data
items each dimension is dividing rubrics
to classify data items and measure items
are being used where an item is
connected to multiple rubrics I found
interesting the way Christine was able
to link the typographical parameters to
the the the data the data items using
this language based on attribute
grammars in 1996 one in the PhD thesis
presents delay it separates the layer
structure from the logical structure and
one is using the mathematical based on
unordered sets they identify operations
at the table category and label level an
interesting the model was introduced by
partners where tables are not only just
data items they are in fact meaningful
expressions that can be evaluated and
validated
Partners is using the indexation to
separate the table semantics from
appearance and basically table is in
that set of grids an index set and a
mapping between the two and every grid
in fact is an inter set of expressions
and again an index set and a mapping the
reason I went quickly to this logical
table more than three who is to see how
the requirement to be able to manipulate
tables at a logical level has actually
evolved from a simple grid to a set of
expressions that can be evaluated and
validated to discuss a table drawing
through prototype that we have actually
been working on in the university of
limerick the table drawing tool is a
part of a larger project that was
supposed to deliver a tablet expressions
tool there are four modules part of this
tool the table input tool that's
concerned only with the problems arising
from data entry a colonel that's
concerned on how to hold all the data
and the implementation in a valuation
module that guides the user in making
sure that expressions are complete in
evaluating the expressions and a table
drawing tool which have been working on
for a while and the consent of the tray
be drawing tool is to simply draw tables
and the way the table drawing tool works
is it renders tables depending on their
layout on a rendering device using a
layout optimizer the current version
supports rectangular tables which can be
rendered in PDF using a loud optimizer
that's using an IBM I logs optimizer why
am I saying Redick devices because all
these objects are abstract and the idea
is that they should be independent of of
off of each other a circular layout was
that it's a circular LED for table have
a look at the table 1 for example and
you can see that the same way
the same table Kennedy can be
represented in a different shape
obviously the circular circular layout
in this case will pros totally different
sets of problems when it comes to
drawing that cells are no longer
rectangles as you can see that of a
different shape the arrangement is
different so maybe it's not the best
example that I can come up with but just
to say that tables or arrangement of
data can happen in any shape and that's
why the rendering tool is in fact as I
said rendering tables of any layout type
on any rendering device using
optimization and an optimizer what's a
device a device an abstract object
provide functions to open and close
device set callers feel chorus line
Styles phone settings vertical and
horizontal alignment draw curves has to
support images and support for paging
the content the device must return
measurement units in the coordinate
system a system used by the tool again
the device has in fact to know how to
deal with its own with its own
parameters and expose those parameters
out to the 2t DT implemented
hierarchical model why is that because a
table tool is to be as powerful as a
page layout tool in a table you can have
any type of objects layout in various
ways you can have fixed projects
positioning containers you can have
floating positioning containers and a
hierarchical model allows us to control
the hierarchical propagation of
typographical parameters that means you
don't want to set up your phone size at
every cell level you want set it up at
table L table level and then the cells
will inherit the phone size from that
and also allows us for layered control
of typographical parameters you know you
may have objects that overlap and you
want to determine whether you have to
let user to decide which ones should be
which object should be visible when
overlapping it is each containers
responsibility to format itself in fact
every container should know how to draw
itself to a rendering device the
rendering device should return whatever
information the container requires to
render itself for drawing tables the
table drawing tool implements a box
model similar to the box model
implemented by the CSS the box model
allows us to have a margin space aboard
a space a padding space in a cordon
space however using this model that a
number of typographical issues we have
to deal with the table layout like in
which has a caption in a layout the
caption is normally placed on the top
but it should be down to the user
whether he wants the caption to the left
the writer to the bottom the layout can
be as I said rectangular circular or a
custom layout it can be of any shape in
fact the caption you have to have a
label a number in the caption text but
obviously you have to define a global
numbering styles and you have to have
some rules around how these captions
should be displayed they have to be in a
consistent way laying containers you
have to work around laying containers
they are fixed and floating positioning
we are implementing in table drawing
tool a method where we are laying
floating containers on lines and
obviously when you have fixed and a
mixture between fixed and floating
containers complexity of the arrangement
algorithm is is increased lines you have
to define Lyons styles and joins the
patterns and you have to work around the
margins when you have containers next to
each other should the margins be added
should they be at the attempt should
should they be merged and all these
questions all this issues that you
encounter while you're trying to program
the the drawing tool you have to deal
with with each of them individually in
the table drawing tool the coordinate
spaces
we implemented coordinate space where
the where the measured what the unit is
a similar to the point the finishes for
in definition as being a 72 part of an
inch you have to deal with the text
direction right to left top to bottom
especially if you need to rotate the
cells content equations how to render
equations that we implement the web aq2
it's an API that renders mathematical
expressions when dealing with images you
have to convert from pixels whatever
units the images are coming in coming
with into the units of the chorda system
you are implementing and I left borders
especially at the end because borders
cause enough lot of problems when you
are trying to alter a table you probably
have experienced yourselves all these
issues around borders and you have to
deal with the border space with a
borderline mint and border priority and
just to give a quick example as what
happens when you are dealing with
borders this is an example from from
from when i was using openoffice you can
probably see that cell a1 here is a
portable in cell b2 the board is
actually overlapping over the text
that's because the the border space is
taken from half of the bordered space
the border space is taken from the
inside the cell that's why it's overlaps
/ b2 here and also it's a bit
inconsistent because it seems like the
bit to the cell b2 has priority over
cell a1 but only for the lefty right
borders not for the top one the number
of problems that you actually
encountered when you're looking at only
at how to deal with borders it's it
isn't funny also if you look carefully
the bottom border is actually taken from
the next cell the space for the before
the bottom board is taken from the
sell beneath that while the border for
the right is taken Hulk from one cell
house from the other said I mean all
this kind of small minor details are
what a Sheila makes life very very
difficult when you're trying to draw
tables and that's only talking about
borders there's a whole range of
problems when it comes with dealing with
margins not going to spend any more time
on this I actually I reported on some of
these issues in a previous paper iiiiii
presented last year at the same
conference here in the same tool we are
implementing how to make table layout
and what I ought to make the table
layout and why a table out optimization
is because there are applications where
you need to know precisely the layout of
a table with the minimum height for a
given page we'd imagine if you want to
print a book and your table jumps 11 row
on a different page you have to add hair
there's your other page and so on so you
have to find out what is exactly the
layout of the table with the minimum
height for a given with also in when we
are optimizing layout we are giving
priority to the user impose constraints
and address state is criteria we in the
way we are modeling the table
optimization we're adding other
constraints to the model in very easy
way so the table out problem basically
says finding a layout of a table with a
minimum height such that the page width
is that it wit is less than the page
with understand and soap to give a
formal definition of of the problem for
tables that contain a text and basically
don't be put off by by the amount of
mathematics and indexes I will try to
explain in a natural language basically
every cell has a number of text has
number of configurations and the idea is
to select from each of this cell
configuration that configuration that
we'll actually minimize the table height
for the given page wait and as you can
see what's the self in this case the set
of cell configurations there are three
configurations as you can probably see
here and that's the set if we are given
a integral integer programming
definition for simple tables that means
table for those spanning cells it's
minimize the height and the height of a
over row is given by the maximum of cell
height subject to the page with the
table with to be less than the page wit
and using some binary variables X ok so
for basically for every configuration
kay-kay in a Cell where we have a binary
variable that selects that configuration
for tables with spanning cells we we are
giving the we are introducing new new
variables we have two arrays where s
page and SW here where the number of we
are storing the number of additional
rows spanned by each cell and the number
of additional columns by spanned by each
cell and therefore the height of a cell
is the height of the cells that it spans
in the same way the ways we identify two
cases we have a case in the case a where
the cell 11 spans white columns and cell
11 spans narrow columns in the in the
second in the second image and what we
are saying is that to solve the problem
where the cell spans narrow columns we
introduce the concept of glue glue is
something similar to the way cannot has
introduced glue for in paragraphing it
shrinks and expands depending on as
required we are introducing blue because
it can be further a constraint we can
say look I want to be to have the glue
distributed equally or some other
constraints around the glue you can
probably see here it's likely grayer
that extra space that's required to
actually feed the text correctly
therefore the height of the cell and the
weight of the cell is the it's the sum
of the span cells closets plus the glue
for each of the columns the integer
programming definition in that case is
simply using binary variables we are
computing for every column we are
computing the set of possible column
widths and favored every row the set of
possible row Heights we are using three
binary variables x y and z you are
probably going to see a troll to our
presentation and they are being used to
select that cell configuration that's
actually less than the selected column
width and the selected row height so as
you probably have seen the new you can
see now the new the new integer
programming definition for tables with
spanning cells is to minimize the height
of the table or using those row Heights
that have been selected and their blue
subject to a number of constraints such
that the every cell is less than
selected as i said earlier selected
every cell suite is less than the do
then the width of the column and every
cells height is less than or equal to
the height of the selected row height of
course every for every cell as you can
see in constraint for here in every cell
only one configuration is to be selected
and in every row only one how it has to
be selected in every call every one with
has to be selected in order to be able
to deal with constraint for we are
introducing 44 cells that have been
spawned which Bob's they'll have no
configurations we are loosing dummy
cells there are basically cells that
have a width and a height equal to 0 and
therefore constraint for is expected for
all the cells in the in the layout this
table is a MP complete it has been
demonstrated by one in 1996 and under
sown in 1999 therefore we are using a
optimization programming language of BL
to solve the problem we are providing a
model that and we've chosen opl because
it supports mixing injury programming
and constraint programming it supports
logical higher-order constraints and it
supports scheduling resource allocation
applications that noting wasn't for our
purpose but as a presentation of opl it
shares structures and syntax features
with mathematical programming languages
such as I implore gums and what's
important is that problems can be
formulated in a language similar to
their algebraic notation it so it's very
easy to follow what I just presented in
mathematical form of formulation into
the programming language just quickly to
demonstrate the model I'm going to
introduce a couple of keywords d'ivoire
is the is a decision variable and the
purpose of an appeal model is to find
values for the decision variables an
expression is DX press and expression
decision were able to in a more compact
way and between the curly brackets it's
a it's a set of type data type and we
have a topple so how we have actually
formulated the the model a couple of
data types initially we have conf and
sell conf sell confess that contains
three integers that the IJ and the width
and height of the cell we have a set of
cell configurations as you can probably
see
and then we are determining the set of
cells the set of rows a set of columns
we are computing therefore the set of
possible column width by excluding the
spanning cells obviously the span over
number of columns in a similar way the
set of possible row Heights wheat reduce
three decision variables as I explained
earlier the mathematical model x for
selecting cell configuration why for row
Heights and that for colon width and
also to other deceit to other variables
the horizontal and vertical glue the
cell wit is expressed as a product of
the width of the cell and the decision
variable that has been found similar way
for the row height and for the corn with
that binary variables and the zoom and
the height of the table are just simple
sums of those row Heights and colon
weeds and the problem is to minimize
table height where the following
constraints need to be respected table
it has to be less than the page weight
then each of the the valleys that are
selected for the cell and rows and
columns have to be selected only once
for choosing for it to choose for each
cell a height in a wit we have to make
sure that they are less than the sum of
the columns or row height and the the
glue for each of those row height or
column width it's the same for column
widths that the constraint for column
which is similar to the constraint for
the cell height as its presented at the
moment one of the things I mentioned
earlier is that we can constrain the
glue I mean how do we want the glue to
be divided along the columns
and that is a way to actually constrain
the glue we're basically distributing
the glue over the number of columns at a
cell spans and there may be other ways
of dealing with it when it comes to
experimental results we have actually
improved on the TAC modality reporting
one has actually improved time compared
to the previous models we we have
published last year as you can see in a
table that was 30 by 30 with up to six
words in each cell the running time came
down from probably an hour and half down
to under ten seconds here we have we
have some other experimental results for
even larger tables with this model are
now able to report to tables that have
up to 3,600 cells I'm going to show a
couple of examples earlier that in the
in the next slides for example for a 40
by 40 table we had a case where the
running time for the previous model was
an hour and 26 minutes to solve now that
has come down to about two minutes and
again we are with the previous model we
weren't able to report on even larger
tables than 40 by 40 just the running
time was we just got a report on that
but now we have some some good results
just sample output how the how does it
look after its being optimized this is
just an example now we also have an
example for nested tables dealing with
nested tables when it comes to
optimizing the layout it's quite tricky
because our model is based on knowing a
predefined set of possible
configurations obviously a table will
have a large number of cell configure a
large number of configurations and
computing the number of stable
configuration is takes time you know and
also every change in the table
configurational luckily in the inner
tables configuration will change the
whole
configuration of the pattern table there
for a quick solution is to actually
embed the inner table into the table by
considering the inner table as being
part of by merging or considering the
table as being or considering the the
cells where the merge table is as being
merged and therefore the inner table
becomes part of the outer table and
therefore the cell configurations of the
inner table are taken into account for
the larger table this is this is an
example we can see how the inner table
has actually been embedded in an outer
table and the model that we just defined
applies for it as well obviously if the
inner table has now captioned has other
elements around it it is not going to be
as easy to deal with it I'm going to
show you a just to see how a table
that's 40 x 45 with if you can zoom in
see how large it is by the way this page
is a zero so it's probably a meter if
you are to print it and how the the
layout looks when the our tool has
optimized that we have a couple of merge
cells here and just to draw some
conclusions building table tools is hard
because tables can contain any type of
objects text images mathematical
expressions and even other tables
operations at the table structure level
are hard and prone to errors we Civic
tools are concerned representation only
using a flexible presentation model such
as the hierarchical models to the Box
raise a number of issues and I have
explained some of them the model is
presented is faster and we are not able
to present to report on larger tables
computing test configurations in other
words the paragraphing problem is
critical for this modem and it is time
to time consuming we can constraint the
glue for tables with spanning cells and
we have suggested the possible
I'd approach to solving the layout with
nested tables we are intended to work
further on the nested tables and we are
looking at other users constraints for
example consideration of group of rows
and columns and that's it we like to
express our gratitude professor David
partners for motivating much of this
work and I'd like to thank Kim and
Graham for providing feedback 404 on
this paper you have any other questions
unless the tables I I wasn't quite sure
whether you mentioned that the table
that was nested whether that's as a
static object whether you actually rely
on that I will reopen it it wasn't what
you mean by a static object just an
object doesn't change just just gets
embedded well I'm not sure exactly what
you mean it doesn't change what you mean
that likely do you actually apply the
algorithms to that yes what we are what
we actually do is that table becomes the
cells of that table become part of the
cells of the outer table and therefore
the cell configurations for the inner
table are now a set of the outer table
and any change in those configurations
are taken into account when we are
computing the outer table so obviously
it's part of the larger table as another
question it's clear to me how nested
tables are difficult the the kind of
recursive structure could be nasty but
is there other content you have you
talked about other kinds of content and
I'm kind of intuitively wondering
whether mathematics is is trickier
somehow then standard text because your
examples are also our standard text are
there is there other material that would
cause you more trouble well mathematics
as I said throw the tool we
rendering the mathematical expressions
of course there'll be more difficult you
know the rules are on mathematics are
totally different in arranging text for
mathematics we are using API that
converts mathematics into JPEGs or gifts
and that's fixed size they don't change
okay so if you were to really retype set
the mathematics that would be that would
be a hard problem we the way the idea is
that the input is totally different in
the output we are not looking at a
WYSIWYG tool here we are looking at a
tool that allows you to do your data
entry it's get stored in the kernel
evaluated it's what the tool should be
able to tell you if the mathematics are
the expressions are correct have you
provide enough information and then
drawn out it's not we see week tool
thank you sorry for very how you get one
more question do you have any idea why
your new model is so much faster than
the previous model yes in the previous
model we weren't constraining the row
height we were only constraining we are
working only with the set of column
widths so now we have further can't we
where we are further constraining the
the derivative problem so we haven't
used the row height at the time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>