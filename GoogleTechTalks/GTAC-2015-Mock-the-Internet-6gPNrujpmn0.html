<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GTAC 2015: Mock the Internet | Coder Coacher - Coaching Coders</title><meta content="GTAC 2015: Mock the Internet - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>GTAC 2015: Mock the Internet</b></h2><h5 class="post__date">2015-11-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6gPNrujpmn0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">next up we have a yaw beam from LinkedIn
to talk about mocking the internet hello
everyone I know it's about time for
lunch but that'll let me use the 10
minutes to give you something more
interesting and may help senior
day-to-day work so a little bit by
myself Menem is jabbing Kong and from
Lincoln New York team I have been
whistling theme for three years so today
I'm gonna talk about the topic Mock the
internet which ever first introduced the
new marking system that we are currently
working on which is called flashback and
also give you the overview of the
mocking studies that we have in nineteen
so flashback is a network layer marking
system that taking care of old album
traffic that goes on the internet where
you really don't want to see like the
third party downtown network issue or
resource constraints that break your
test that's why we create flashback
Before we jump into the details let's
talk a little bit about like why we like
mocking not only for unit tests but also
for the service level integration test
so why mocking imagine we have the link
in profile page hopefully everyone in
this room has the link in profile
otherwise you'll miss a chance to
connect the other four hundred million
professionals this is truly my love the
West now the marketing team asked me to
do ok back to the profile page so it
requires more than 100 downstream
dependencies service to render this page
if you're a test emotional here test it
just has one tiny specific agenda on
this page you don't really want to allow
all these dependencies right and since
are getting worse you've one of the
dependencies actually I think external
service that our internet which you
don't have a control so the best way to
solve this problem is Martin mark all
the dependencies then you have a good
test so take a look at this a high level
picture of Lincoln jets in service
besame engine service is built by a new
by our New York team and it is a service
to grab a content from internet to
enrich your profile to be more
attractive so besides the besides the
typical three-tier architecture on the
Left you'll see there is a gateway
service in the middle it is a it working
on sir proxy and here is a good
opportunity for us to mocking this layer
in order to test our ingesting service
without rely on the external providers
and this is where the flashback fishing
so flashback still act as proxy handles
HTTP HTTPS traffic intercept the request
and response and store them it is
controlled by a test framework so you
can start it like record or play you can
also change the mock data on the fly
from a test case since we have the API
or as you wish you can manipulate the
response in a way to test the different
variation of the negative case for your
service so basically you'll have the
food control what's going to be marked
on the network so let me show show you
some so show you some code this is an
implementation above the record and play
inside flashback let me recording we
actually take the response returned from
the external provider and apparently
with the request that came from the
internal service and store them locally
when we're playing we load the local
store response according to the request
I came from internal service and just
return them back so there's the there's
not going to be anything any traffic
goes on the internet also i want to show
you get some the mock data the actual
mock data you can see we have all the
informations about the request and risk
and like I mentioned you can actually
manipulate the response by modify this
file like we can change the standard
code to something else from 200 to 44 to
indicate a novel response or you can
modify the content of the HD body to
something else anything you want sin in
this way you can test your service in a
lot more scenarios then you can see how
strong how the library service is so
okay a flashback is a good solution for
us to testing or ingestion service
without rely on the external provider
but when we are step back and take a
look the whole picture of how flashback
works it's actually it seems a common
solution just doing the mocking the
network traffic right if we can make the
flashback more generic to be essential
at the service or system it can helps in
a lot of other players in the same
manner like the internal service so
linking internal servers are all
ratifies which means you have a common
Arabic been used by the service and all
the clients so to adding the support for
flash back is just like a conflict
change to a flashback enable dhcp client
then you can use that it's quite easy
and a nothing need to be changed inside
your service it's also a good solution
for dinner service as long as your
service is going through HTTP protocol
then you can enable flash back and are
eager to Carol that the mocking part
mocking mocking the data from a dealer
service also it's more interesting to
talk about the mobile client have seen
so let me do mobile client testing we
actually need to launch the emulator
launch the app and deploy your service
and having the the real traffic between
the client and your service but instead
of making all these left traffic if we
can set up the progs instead emulator
and point to the flashback and then you
can take a wanted over the flashback
and the browser way of marking network
marking so it's quite easy to set up the
proxy inside emulator and you saw it
also works for a real real device and
again there is nothing need to be
changed inside your app you can just use
flashback ok I I hope you guys have the
idea of what we are trying to build the
flashback it helps you in the area of
doing the service level of integration
test that requires the network layer
mocking and we are trying to build it in
a way that could be open sourced and it
will be library by anyone who won't use
or ma who even want to make contribution
back or you can like come and join us in
LinkedIn and let's work together and
more control thank you thank you what's
the difference between using dedicated
flashback service versus using mocking
frameworks at the class they are like
makito easy mark etc ah so the flesh bag
is still like uh like that will they are
mocking so for those unit has smoking is
kind of mocked the class layer so let me
mark the novel layers so you you
actually have the real traffic goes out
to go goes out from your service so that
that's verified like a lot more than
like just inside close how does
flashback compared to wire mark or other
mark proxy tools that's a good question
I I know someone will ask the discussion
so where Mark is uh sorry so flashback
was so the idea Pro flashback was for
already in Jasmine service we build us
that also proxy then we realized we
actually there is a like bear marks or
Betamax there are a lot of other mocking
that were marking stuff there but some
of them it's not doing like a proxy way
some some of them it is all handily
the HCBS traffic so we we animal is we
want to build something ourselves how do
you deal with post requests and how do
you deal with URL get with variable
parameters like timestamp random session
ID etc the post request a thing is the
same like it's still just a request it's
just different message so we have the
post like in the mock data may have the
master tab for cat or post to deal with
the different parameter like x my random
session okay so so this problem is we
don't have this problem for already
ingesting source testing because we most
other cases like a static content you
setting your organic content but we do
have a sort of about this we can make
some power meter or wherever wearables
inside of your URL or you have way to
indicate okay this part of data is like
dynamic we don't care we we just care
something like the Impala knee is a gap
and was a URL what's the body if a
couple content yeah um it's flashback
open source yes he is going to be all
the sauce yeah that one's a repeat how
do you manage situations where
third-party providers change their
layout or schema mmm okay that's another
good questions ah so basically um so for
the case for our ingestion service uh we
we don't we don't have the idea when the
third party will change their content
right so we keep running our our test
for using the mock data which making
sure our server is still working for at
least the old data then we have some
left has to making sure that's going to
be working for them for the new data and
also since you have the mock data you
can periodically to check the data
versus the
the new data from the third party since
then you will know like is there any
change is any schema change or some
content change if there there's a
significant G you can't really recall
the stuff and doing the test again how
does it handle HTTPS requests okay so
since since since you know we are using
like the proxy way I know it feels
required we have to happen in the middle
proxy so we can i implement that and
that's the most challenging in flashback
since our most our urs is going to HTTPS
traffic so we spend a lot of time unlike
handling the HCBS and doing them in the
middle thing yeah how do you keep
recorded data up-to-date that's sort of
like if the content change in all those
third-party so like I said for whatever
the mug data you have we usually be able
to test to run your tests but if the
data change you need to have a mechanism
to check if it is any thing changed
between your old data and the new data
from the sub party so so like I said you
need to periodically check this this
thing how do you ensure mock tests don't
get forgotten about when internal
services API has changed okay that's
that's sort of similar to the last
question but I think it's more like
asking about the internal service since
we testing uh if we run in that against
internal service so you have the idea
what version you are using for you for
your downstream service so basically you
have a service you have mersion for your
own service and you have another
dependent dependency service so when you
update your dependable service you know
something might be changed right so in
the flashback either you do really
recording every time there is a change
before the
version or are we want to have some like
magnetism to see my test knows my
service anyway no we only care about
some particular data like I only care
about the first name last name I don't
care about like maybe someday that
there's a new field sixth title or
something so I can have a way to worry
if I like if the new service if I
constructed the data schema for the new
service you have the first name last
name thanks good I can see use that data
I can still test my service and it
should not break my service should not
break my test and should there is
nothing I should worry about for the
downstream update and one last question
yeah they keep moving uh where's the new
one how is flashback different than
LinkedIn's other product Sofia ah so so
the flashback starways like like I
mentioned for the ingestion service of
the proxy way oh the other products is
kind of doing either the smoking inside
the service or or inside class which is
a you need you have to modify some
things at your service or a serial code
which just cannot give you the benefit
of life proxy as long as you can still
have a pro season you're good to go
great thank you very much thank you guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>