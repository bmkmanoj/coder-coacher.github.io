<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Release Engineering as a Force Multiplier | Coder Coacher - Coaching Coders</title><meta content="Release Engineering as a Force Multiplier - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Release Engineering as a Force Multiplier</b></h2><h5 class="post__date">2013-05-31</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/7j0NDGJVROI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome everybody it's my
pleasure to introduce today john odden
from the Mozilla Foundation I met
Germany last week the icsc 2013
conference in San Francisco he gave a
great talk on release engineering
actually it was not a talk it was a
keynote speech for the first ever
release engineering track of the
conference I thought it was really an
inspirational talk full of details like
technical stories and perspectives and
please welcome journaled into Google at
Mozilla obviously as you can imagine we
care a lot about browsers so this is a
diagram that I put up just to show as a
organization Mozilla is very very small
so I wanted to note just to kind of
scale what we're dealing with here and i
realize i am the mozilla person in the
google so i am the numbered person here
these are logos of these four companies
these are the four major browser
companies these are done to scale by the
number of employees who work there you
know Microsoft is 97 almost ninety eight
thousand people Google is 54,000 if you
include the motorola situation Apple is
50 and Mozilla is 700 so that's kind of
and obviously of course headcount you
can play you know all sorts of ways to
statistical games here but headcount I
include everybody down to janitor front
door there's different products that we
work on internally at Mozilla there's
different products you work on but just
I wanted to get the point across that
scale is very very different here and
I'd also make this logo a little bit big
so you could see it otherwise you
wouldn't see it at all the other thing
was while I picked head count the same
sort of scale mismatch happens if you
talk money I mean we make millions per
year you guys make billions to the be
per year so it's not right this is not a
start-up who you would rationally choose
to compete again
right despite all that we're actually
holding her own depending on how you
count it and everyone in the world has
their own version of numbers were
between twenty to thirty percent of the
browser market and some locales were
over fifty percent that's not bad
considering you can hardly see our logo
there on the screen so some of that is
because of the release engineering
changes that we made some of that a lot
of it is because of community and other
things that are going on but I want to
talk about specifically how Mozilla and
release engineering worked here hence
the talk that I gave as the keynote the
idea that release engineering can be an
enabler or a force multiplier for an
engineering section or an engineering
organization it's not the way most
people tend to think of it I wanted to
put that idea out there I also want to
note that Mozilla's my first time I've
been doing release engineering for a
long time this is my first time in an
open source environment so some of the
stuff I've covered is things that I've
learnt along the Tong the years this is
not NDA anything first time ever I can
publicly talk about what I do and so
it's kind of cool and there's nothing
specific to open source here this is as
part of the general intro this is what
we have done this may or may not work
for you you may already be doing
something like this you may spot huge
holes in our logic and you say do this
it'll be much better anyway let me know
what you think and the last disclaimer i
feel i have to give because every other
time i see people talking about release
engineering it's usually as part of a
sales pitch that says and therefore you
should buy our stuff i note that i'm not
selling you anything okay so force
multiplier those of you who've ever been
in the military or know anything about
board games or anything like that i went
and looked up you know the military have
a Department for this this is the
official definition it's a capability
when added to employed by a combat force
significantly increases the combat
potential of that force and the sis
Hans's enhances the probability of
success so it's a force enabler right
and they have a few different
pockets or categories that are headings
that they put this under it can be the
technology right if you've got a bunch
of people with machine guns versus a
bunch of people are crystals that's one
if you have like tactics like surprise
ambushes or behind lines tactics you can
also have better infrastructure so you
could have all the best weapons in the
world but if you can't get bullets
delivered to you once you use a bunch of
god you're sitting there twiddling your
thumbs so infrastructure technology and
tactics or what they put a lot of
attention to in the military so I
thought I'd talk about why we do that
here and what we did so we started with
a couple of things and I wanted to just
upfront and make a couple of assertions
or assumptions the first one release
engineering is not actually covered in
as far as I know any computer science
course I've got a degree master's in
computer science I've never ever heard
of release engineering until I was in my
third or fourth job and it kind of seems
to be true across the board so given
that and given that people don't really
talk about what they do and they don't
really trade stories why would anyone
get into this field firstly and then
secondly it's rarely considered to be
glamorous right it's usually where you
get caught in the ignored or you're in
the hot seat depending and those are
your kind of binary situations you spend
your life in so why would you choose
this I would want to note that actually
as a developer I found there's different
motivations for why people want to do
this so the first one to carefully I
found carefully interesting was release
engineers are not the same as developers
and what I mean by that is they could
have computer science and programming
backgrounds but what motivates them is
different and so what I thought of as a
short way of describing is I think
developers like to build a product where
release engineers like to build a
pipeline
delivery system they don't actually
particularly care too much what goes
through that pipeline so long as it's
efficient and smooth so that's a
different mindset so you want to think
about that when you're hiring that has a
side effect your company depends on that
pipeline you could have the best
software in the world if you can't get
that out to your customers it's not
worth anything so the efficiency of that
pipeline in terms of delivering out the
door is what's going to be important to
your entire organization so that's why
you want people to think about
efficiency of pipeline and what do I
mean by efficiency of pipeline well
here's a couple of quick metrics just to
give you some sort of concept see if you
feel like you're in the right room these
are numbers I put together from Missoula
you know at Mozilla since 2007 so some
basic kind of metrics to see if we're
we're actually making things better or
worse one of the things I measured was
from the time that we have an emergency
or what we call a chem spill release
somebody comes in the door and says hey
we've got this problem if you do dis dis
dis this you can compromise the browser
and you can exploit some users data
that's an ad minute past midnight we
have verified at two minutes past
midnight we have a one-line fix in hand
three minutes past midnight we check in
that fix and we declare victory how long
did it take us to actually ship that out
the door and have users get bills signed
updated through QA through to web dev
hosted on sites updates available on
users actually seeing that was about
four to six weeks average sometimes
we're faster than that sometimes worse
now we're pretty consistent with getting
it down to the last one was 10 hours 42
minutes we beat you guys slightly and we
think we can get another few hours off
there still how long does it take to
ship a new feature release that's where
we put in together some new not a one
line security goods we're actually
adding some new functionality roll
through
of alpha Aurora beta test cycles at the
door to users used to be totally
unpredictable 12 to 18 months could run
longer it could be less you really had
no idea now six weeks on a clock that 10
days ago we put out another one it's
pretty routine it's kind of boring
actually kind of nice the other one how
many active code lines of development do
we have so we used to have one and a
half line so is the main line and then
we kind of have supported the previous
line or the official release line that
users had now we have 42 which is not
actually because of the book it's just
the number of people we've had asked for
branches and we support all of these on
par with each other I'll explain about
that later and the other question comes
up a lot as a simple way to measure is
how many check-ins can you get per day
and this is a very kind of pointy haired
boss kind of metric about how effective
our developers you know like a one-line
check-in could be you know one line fix
or it could be a total refactor that was
still one check-in but took months of an
entire team so it's good kind of bogus
but it's kind of useful we average about
15 check-ins a day that missoura our
peak is 325 a day we do between 280 and
300 routinely you don't even think about
it anytime we go over 325 I actually
when i go over 320 i setup though who
look we broke another record so that's
some sort of measure of infrastructure
improvement and that's to me and also a
measure of how our infrastructure has
improved which means how our pipeline
for delivering software to users has
improved
so that those numbers i just talked to
got us to this this is what it looks
like by a market share scale those same
logos let me do that again the observant
ones will notice actually Google can
change it seemed like a good kind of
milestone to place things around now of
course the marketplace is still super
competitive you're still competing with
three very large well-funded companies
so now we just have to get features out
and compete but we have a chance force
multiplier so I also want to start
quickly by saying aye these are a couple
of steps I've going to enumerate through
but I would like to note with hat tip to
Guy Kawasaki anyone who who've seen his
talks he does have this great idea which
I like so up here you'll see one of 11
this is how we are going through if this
is totally boring to you at least you
know when it's going to end so you have
some idea of how much long and I
promised I'll be done in 45 minutes or
less if I can but ask questions as we go
along and if it's interesting that's
even better so first off people as
engineers we tend to try and see a
problem and try to jump in and start
writing code instead I actually said
let's try and switch the situation
around these engineering used to be the
highest attrition burnout operation at
Mozilla your average life span was six
to nine months let's change now we've
got one of the highest retentions at all
in the entire arc so I wanted to start
off by going and talking to the people
who cared around the entire company
instead of writing code I wanted to talk
to people so first question who your
customers I actually felt that the
customers I cared about the most sorry
the customers I cared about the most
were actually the people who cared about
the survival of the organization
so founders all the c-level executives
VP of engineering these are people who
care across individual projects they
care about the entire organization
that's a different perspective I went
and asked every one of them not what do
you think release engineering should do
better because they'll always say I want
faster bills wrong answer wrong question
what keeps you awake at night if you had
a magic wand what would you like what
would you face I would deliberately ask
those as open-ended questions now
deliberately sit there in silence with a
note pad and a pencil and wait and when
you start poking sometimes you have to
poke them a few times to get them to
answer this we actually start getting
very different answers to the kind of
things you would normally get I'll come
to those in a second and don't forget at
some point you should also walk around
and talk with developers and QA these
are the people who are actually living
the frontline battle what did they need
you're trying to make their lives better
voice from the ceiling keep going okay
so keep an eye on the developers but do
ask these guys my main thing was I
didn't want to start building something
only to find out that I had built
something that really wasn't solving the
problem the real global scale problem
not just a local project problem so they
all talked about company threatening
problems examples falling at bad press
coverage from shipping a bad release if
you should have broken version of the
browser that suddenly has exposes a
security hole that's a lot of bad press
that's bad news you're going to start
ticking off your existing loyal users
you're going to start having new people
say oh I don't want to use firefox
because look they just had this whole
bunch of negative press coverage that
kind of stuff can be hard to fix
you can start losing existing loyal
users it's going to be harder to gain
new users this worries CEOs a lot slow
response to a security problem that's
another one how quickly can you get a
security fix at the door you actually
get good press coverage out of being the
first person to actually nail a fix
after black hat or DEFCON you have this
weird market effect if you are always
consistently fast on closing things down
as soon as they become known bad guys
say hey it's not as profitable I've to
put all this effort into figuring out an
exploit those Mozilla guys closed it
down in 11 hours IE however still hasn't
fixed it two quarters later let me keep
looking for more exploits there you
become a less attractive target for all
the work it's a market economy there too
you know losing customers because of
buggy software people complain hey my
firefox keeps crashing oh i switched to
this other browser no works great you'll
never get them to come back this is one
of my favorite I didn't I use this an
example in the keynote and I never
expected to give it here missing a
release schedule when you have feature
Wars and you're actually on level
footing with another browser and you're
competing against them and you're on
future war games missing a schedule is a
bad bad scene so my example here is in
June 2010 missoula Google and opera all
stood up on stage at Google i/o and
talked about whether as a new feature
that was coming up jun 2010 September
2010 chrome shipped with web M support
in a release product three months later
nice good job march two thousand eleven
six months later Mozilla shipped we
didn't really change the code we've got
it working back before September we had
no way to get it out the door we have no
valid release that was stable enough to
ship that we could put web on wear them
onto
the way them guys zillow we're not very
happy neither all the sea level folks we
have this other thing which I'm sure
maybe you guys do too where you can
actually pay to have a customized
version of Firefox made so you might
have your own home pages different set
of bookmarks that kind of thing we call
it a partner repack people pay money
both for that and also for the ongoing
support security fixes and things like
that this was so intrusive to the little
bit of human time that was available in
release engineering that we had to
actually stop doing this in 2007 nothing
upsets a CEO more when he's trying to
raise revenue then try having to turn
away customers with cash in hand and
question hey we're going to be hiring a
whole bunch of developers will our
system stay up if we double our staff
what they didn't care about not one of
them said any of these terms which is
the stuff that every release engineer
really cares about no one said anything
about agile scrum jenkins Bill bought
cruise control devops well and she's
just like fix these problems I don't
care how occasionally you find someone
who does for three rare the way i phrase
this earlier was they care about the
company not the tools you use to solve
company threatening problems so talk to
your customers keep doing it again again
I make sure even if it's just like I'll
walk you to the coffee machine I'm back
what's on your mind do it every few
months business needs change market
demographics change what they said three
months ago may not be still true not
because they're whimsical look because
the market has changed and focus on
company threatening problems that's the
you know global optimization versus
local optimization what else that was
first one second most people
communications having actually talked to
them don't just disappear that's another
classic it's like I've got a lot of need
to know I'm going behind the curtain and
you won't hear from me for six months
bad news so they don't expect miracles
they do you expect you to fix things and
keep them informed on what you're doing
so what I would found myself doing was
finding things to measure KPI those of
you don't MBAs short succinct summaries
of what you think the problem is that
you're trying to solve an easy way to
measure it choose carefully I'll come
back to this in a second and then show
progress lots of progress consistently
show something even if it's a little bit
every day show something it's going to
take a while to fix it's easy to lose
perspective and most importantly it
helps you in your group keep perspective
what's going on and keep it simple the
by simple I mean not just
simple for you to explain simple enough
that someone else can explain it to
someone else while you're not there if
they can both understand it you've won
that's a good tactic that's a good thing
to measure and as soon as you can do
this you start seeing other groups
realize how they can help I'll come to
this in a second that's really important
once other groups saw that they could
help that made a big big difference the
perception had been it was all in
release engineering here's a quick
sample that go to building I told you
about earlier with the emergency
released in the four to six weeks the
perception was in the company that all
of that time was spent at release
engineering the rest of the company
could just stand by helplessly and watch
the flaying that was happening when
actually went measured the first one
which is a few releases after I got
there because the first few were totally
chaotic the actual mechanics turned out
to be different less than fifty percent
of the time was spent in relaunch in
fact it was a little bit over thirty
five percent of the time the rest of the
time was spent on things like back and
forth of developers QA cross group
communication up dating websites
preparing caches on servers to handle
the load totally outside release
engineering and these are the groups
none of them realized they were on the
critical path so we found a few a few
things a way to work on there the other
thing we found was there was a lot of
churn that nobody realized by
miscommunication about whether or not we
really had the fix or not when someone
says go and then someone else comes by
30 minutes later says wait wrong thing
let me just check something one last
check there's only a few of these you
can do before people start throwing
instruments around so I give my
disclaimer earlier people will optimize
for what you measure so you need to be
very careful here I specifically did not
ever measure developer coding time I
don't want a developer to feel
pressurised into coding a bad fix just
to beat the clock
I want them to actually do a good fix
I'll stand nearby I'll get your coffee
if you need it but once you say go I
will snatch it and run but until then
I'm gonna be very quiet the other one is
don't count open bugs number of Reese
pins remember releases this is the kind
of thing that I've seen in some
organizations where people will actually
start unintentionally but getting
pressurized by managers and start gaming
the system they'll close bugs to show
that their bug count is good but
actually they'll still continue work on
the item I gave you hey if you got to
find any problems don't reopen the bug
just ping me and I'll deal with it
privately then there's suddenly six
months later they're very busy working
on things that are not in any bugs it's
all the bugs are closed because they're
trying to make the metrics look good so
if you're any kind of manager I don't
know the audience here be careful what
you measure you'll have weird cultural
impact another example measuring
check-ins we didn't do any of this
before so I started graphing and you
guys can tease me about how I do this in
Excel sometimes not always this we
generate dynamically this is our number
of check-ins load throughout the day
varies depending on developers in
different time zones this you can see
here is across the month so it shows the
different days of the month so you can
clearly see the weekends here which is a
sign that developers have a life
sometimes and this is generated showing
check-ins since I started which I didn't
get to even start this until 2009 we'd
already made a bunch of improvements I
started tracking this once we crossed
over a thousand check-ins in a month now
we're at six and a half thousand there's
another way of showing the same thing a
note or disclaimer we have grown we now
have eight times the number of
developers and best case scenario you'd
expect to have eight times the number of
check-ins
however I see some shaking heads out
there however the reality is you're more
likely to get less than eight because
you're going to have developer stepping
on each other's toes it's going to be
more code conflicts merge conflicts all
this kind of stuff going on same way if
you'd like put things into a multi-core
machine you really get exactly the
straight number that you don't you
always get a little bit less so we would
ideally love to get eight times the
number of check-ins we actually got 21
times the number of check-ins over that
same period of time the rate of our
infrastructure improving is faster than
the rate we can hire
and we keep showing these numbers so
people know what we're doing we don't
just say it once then go away this comes
up a lot again and again again next
thing is pretty to start I found it
really hard to figure out where to even
start at the beginning of like well just
okay that's it you know we can sit here
and draw fancy diagrams I'm just going
to find something to fix today so I know
today I fixed something even if it was
tiny small it made something better
today I used the phrase analysis
paralysis you're sitting there trying to
figure out what's the best thing to fix
first like fix something you know so I
didn't make any big proclamations I just
went and found something small to fix
that day and we changed the group ethic
a little bit it's like don't try and
draw a fancy diagram will fix bigger
harder more complex problems later but
for today just fix anything something
that you know you can fix today before
you go home a couple of reasons that's
important you won't actually know you're
making a difference if you feel like
you're just going through the same stuff
every day again again there's no hope in
sight it'll never get better at some
point you end up throwing a chair and
leaving but if you know you've made it
just a little bit better today and that
gives you hope that tomorrow is going to
be a little bit better again and the day
after that again now you're on to
something so this is a really really big
thing and I know the joke here is a it's
a very touchy feely thing right it's a
very human thing we are humans we need
motivators and demotivators these all
exists there's lots of books on this
stuff but being optimistic is a big deal
again military had a very interesting
comment on this they care about
battlefield morale like nobody else it's
another one of their force multipliers
so they do care about this they'll
actually go to the bother of taking you
out of the front lines of ringing you
back and sending you on vacation in a
war
they have all the evidence to show it
makes a difference so baby steps be
optimistic start something start
something now and don't stop relentless
baby steps is what got us through those
differences i showed you there we've
been doing this for six years we're
still finding things to fix every one of
them gets a little bit better that's why
I know that 11 hours is going to get
knocked down under under 10 at least
sometime the next month or so it's going
down further cross-group coordination we
just conscious a time moving along we
found ourselves with an interesting
problem and this is something we did
right at the beginning is like find
remember I mentioned all the go no go
stop go stop go miscommunications like
find stop this right now next release we
do there is only going to be one person
we all agree to is the person who is
allowed to say go and if you have a
problem where you think you see
something that's a problem that means we
should stop the release you go convince
them to say stop don't come along I
don't we just haven't happened running
the drawer hands waving in the sky oh
it's all bad it's all bad you have to
stop now with the bug is not really
fixed have the release engineers turn
around and kill all the two and a half
days of jobs that are running at the
time to start scrubbing the decks to get
ready for the rebuild and then half an
hour later have somebody else walk in
say oh wait that was a false alarm how
the bills going like well we just killed
them because you told us to kill him a
half an hour ago it's a good blood
pressure test don't do that instead have
somebody whose job is to actually get
people to calm down pay attention
cross-check it try it again on the
second machine just to still work there
okay now you have a real problem so we
appoint them before the release not in
the heat of the battle of the vanilla
release it's too late at that point now
we found that this was ad hoc now we do
it all the time so now we have a group
of people this is their full-time job is
just do this
they make all the stop go decisions they
understand the market they understand
the product so they understand the
trade-offs they're making like hey is
this performance hip here really worth a
Reese pin or is it only impacts point
five percent of the user base and so
we're actually okay with just getting
this other thing out that impact 99% of
people right now and they need to be
neutral it's very hard to be objective
and say I'm the release coordinator and
I'd say we should not do a reason I
think we should go if your job is the
person who's also operating the dials of
doing the reskin everyone's going to say
and believe that you say no because you
don't want to do the work so it has to
be a neutral person and if anyone comes
along to us directly we redirect them to
that release coordinator the other thing
we had very low tech was a set of a
mailing list we used to have this around
but we never really used it for
everything so we transitioned all
communication to that so if you had any
kind of hand over it went through that
what we call release drivers and if
there was any kind of mistake back and
forth across group communication went
through that list as well normal
releases go through this as training for
when we have to do fast releases because
everyone knows the process it's the same
process just the timing is tighter just
clock it through do the same as you
always do but just do a timing faster
and later on that's handy that's why I
get these time stamps for the how long
did it take is to do a release is by
getting the time stems off these emails
baby steps these are all right fairly
simple halfway there almost you can
having got those basics in place I then
started what I would call the draining
the swamp phase this is where you get
the easy to get into a conversation
about who this infrastructure is so
broken you know what we should just
leave it as is and you should go over
here and build a shiny new castle it'll
be perfect it'll be wonderful Lorraine
will never leak the doors will all align
it'll be a wonderful thing problem is
you only have enough people in your team
to barely keep this broken thing working
you don't have a second team of people
to build a new thing that's one problem
even if you did have a second team of
people to build a new thing how do you
know that they're going to build it
perfectly is everything that's in here
documented because it's not in my world
this here is a total total can of worms
that nobody knows where anything goes
into our work comes out of and you won't
know if you're building a new thing that
actually matches the functionality of
this whole thing that's too much risk I
mean how do I know that if I make this
thing happen this shiny new thing and
there's a bug in it will let somehow do
something that's company threatening
life send the wrong updates the wrong
users because I miscalculated on
something so make sure you think
carefully about this is very tempting to
build something new I actually found in
our case it was better and more
efficient for us to start now with
something that we could do right now
start fixing our own world so this is
what I called rainy a small weed no end
of suggestions of what to fix people
come along with the most esoteric things
that they were worried about my favorite
was the autumn I automated signing we
generated build way to go and sign them
right signing keys and things like that
and automated secure signing server is a
non-trivial project and everyone like a
little Q people lined up on my door with
that is there you should start with that
and I was like can I start with checking
for enough disk space it's really
humdrum but actually one builds blow up
in the middle of night cuz I ran out of
disk space that's very very bad news so
let's fix the simple stuff first
and again fix something doesn't have to
be the biggest thing but make a
difference one thing we got actually to
go back the VP of engineering at the
time agreed after some thumb wrestling
that we could have the day after release
intro free we were constantly
interrupted but the day after release we
were off limits if anyone had to come to
us they had to go through him this
guaranteed us to have fresh memory this
is my I asked for this because we had
fresh memory of what we just been
through and we needed just a day to fix
something before we went back to the
churn and this was what got us out of
the situation in the beginning once we
started getting a few things fixed then
we actually didn't need this anymore but
it took a couple years and we would
focus on what we thought was the best
what could we deal with today the disk
space thing doesn't sound like much but
it would save you a half a day of
repairing a broken build halfway through
like so now anything you can do to make
it more robust and mindset is expect
surprises every time we fix one problem
we'd find another problem that what's
been lurking underneath and I've lost
track of the amount of times that we've
said like hey how did this ever work and
that's a common thing we'd hear so just
expect that okay and a document as you
go because who knows what's going on
here and you know it does mean every
release is better that's important in
terms of giving hope very important
hope optimism
reminder one thing a nice little thing
was nice about this as you started to
fix a lot of these smaller things you
started a little bit more time now your
one day off off interrupt to go fix
things you could actually focus on
slightly bigger things and then slightly
bigger things a couple of months later
you're focusing on things that span a
couple of days a couple of years later
you can work on multi-week projects so
this is actually a big deal okay the
other thing we did was a strategic
change structural change sir in how our
infrastructure worked we used to build
continuously Mozilla built a tinderbox
server back 98 I think it was and that
was a continuous integration and it was
building continuously literally meaning
he would finish a builder would start a
nut pull tip and start another build
finished the build pull tip start
another bill which is even if nothing
changed it was always building which was
better than nothing right this is what
it would kind of look like as a display
page it sorts everything by time and
basically every one of these columns is
a different type of job so there would
be a column for to make them small so it
fit but there's a column for like Linux
32 bills there's a column for linux 32
debug bills and this is actually six
screens wide by the time you start
adding support for all the different
platforms and build types we change that
to only build if somebody does to check
in don't bother building if there's no
check-ins some sounds trivial but
actually a lot of time was wasted trying
to figure out which of these last three
bills had this intermittent problem only
to discover that two of those three
bills didn't even have a check-in in
them and the QA people are like ooh what
what's going on here so if you don't
even need to build don't
let's convert that's confusing for
regression hunting note we're also doing
builds and test for check-in and this is
a little excessive right now we're doing
7.3 compute days of bills and tests
across linux mac windows 32 and 64
android and boot to gecko or firefox OS
we do that for check-in we get one of
those check id's approximately 4.6
minutes little excessive so we're trying
to get better but what do we need what
test do we not need to run when but
that's our current of my point and we
had to arrange these in a way that
actually made it easy for people to see
what was going on so one of the people
at the side release engineering designed
this this actually as a different layout
would show the person who did the
check-in and my apologies to the folks
on the screen you probably can't read
this at all the name of the person who
did the check in the change sets in this
particular case he's merging a whole
bunch of changes from one branch to
another so here's all of the change sets
here's the original bug authors here's
the bug numbers the description of the
check-in comment and then over here each
row is a different operating system so
you got your fedora debug builds you've
got your OS x 10 6 opt bills all the way
down it barely fits on a screen but it
does fit on one screen and the color
coding and the lettering is in papi is
it really important so like B is for
build the numbering of here M 1 2 3 so
moche testa's name of one of our overall
test Suites it was too big so we broke
up Moki test into 1 2 3 4 5 and all
these sub all within brackets you can
read trigger them you can mark them with
us an asterisk if there's a known issue
where you as the developer who checked
it and say who that's actually a known
problem don't worry about it I've got it
all of that's doable from here so a
developer can immediately see did they
or did they not cause a problem that was
really hard back here
because of all the timing of all of
these starting and stopping at different
times you could really not tell what was
going on so therefore you could really
not tell your change it broken it or was
it any of the other five people who are
also in the same check in as you so
build on checking was a big deal both in
terms of morale for the developers
because now there was less infighting
and also in terms of clearly knowing
what was going on this helped a lot in
terms of improving how many check-ins
people could do per day Dylan was pools
of machines in 2007 we had 86 machines
they're all very very handcrafted custom
unique machines most of them actually
were on reproducing which is its own
level of fear and if any one of them
died for any reason which is likely when
you have 86 old machines that's a tree
closing event no more check ins allowed
when will relaunch have that windows opt
builder back online and you can bet the
phone would keep ringing so this is a
problem instead of having just the one
machine what if we had another machine
that was identical I could take over
when the first one fails so we tried to
start building up pools of machines so
we'd say here's a pool of machines that
could do any type of windows build-up or
debug and we have multiple so one
machine dies others can take over but
they keep going we're currently running
at over three and a half thousand of
these we grow and shrink this as we need
to is about seventy percent of these are
physical thirty percent virtual and it
depends on we grow and shrink these
depending on the actual check-ins that
are happening during the time of day if
you remember that chart bar charts i
showed you with a load going up and down
and they're all identical we use puppet
and nagi us on these things you can't
keep track of what's going on this
number of machines you can't even
remember the names of them right so
never mind if they're up or down so we
use nat geo's for telling us who's
puppet for setting them up if you have
to touch one of these by hand as part of
setup it's a failed case so we don't
there this is a very simplistic diagram
I put together we're in three amazon
regions and although it couldn't get it
to fit in here we have four different
colors physical colors and this is all
inside of epcs because we don't want bad
people touching our build machines
because that would be bad and some quick
gratuitous machine photos I'll skip
through here you guys probably have way
more racks than we do but it's plausible
right so here we have some one uix these
ones do the as well we use for linux of
Windows building this is our unfortunate
OSX situation where you have to
basically build on Mac and test on Mac
so we actually put a bunch of mac minis
racked out we have for Mac minis will
fit on a 1u shelf and you can then put
the power supplies in between like here
the newer mac minis I prefer because
they have a power supply built in so you
have more space makes it easier this is
what a pallet of mac minis looks like if
you order them in units of pallets this
always causes the IT desktop guys just
collections they're like hey I bought a
mac mini wait a minute what's this the
other thing we do is we do we tried it
testing on emulators for Android testing
and we found more bugs with the
emulators that we actually found with
the actual product is super super
disruptive so we instead focused on
doing testing on actual circuit boards
so these boards here are NVIDIA Tegra 2
50 boards they run android 2.2 and
they're wired in by ethernet which you
can barely see back here in two switches
and that's how we do all of our android
2.2 testing the problem with these
things they're not you know you're
dumping the filesystem and rewriting the
file system continuously throughout the
day so at some point you corrupt the
file system that turns it to an address
alert that turns into us filing a ticket
the IT support guys will pull out that
machine from this custom-made non fabric
non non metallic fabric shoe rack that
you can buy in bed bath and beyond for
about 30 bucks and these things are like
because you can fill a lot of these into
a small room which is where we have them
so we have a few hundred of these and
you can easily pull the board out to
reset a tegra specifically with sequence
of rocker switch buttons you got to
press in exactly the same the right
sequence it's a to press one press to
press thing so you can't automate that
in any way it's super painful by the
magic wand that's one thing I'd love to
fix however this gets us very very
stable android 2.2 testing and we've
been using this we love it and resetting
and reflashing one of these things took
a while to get the process down but now
when one of these crashes it takes about
15 to 30 seconds to actually reset it
and put it back in production spends
more time walking down the corridors the
room that has the machines in it this is
how we do our Android for testing these
are panda boards panda boards running
android for have a nice feature which is
you don't need to press any buttons on
them that gives you a whole bunch of
goodness because now you can put it in a
box put the lid on it this is a for you
box that holds 11 panda boards and a
whole bunch of little sockets of the
back and we can run that also driving
tests so this is how we do our Android
for testing and because you don't need
any human intervention you put the lid
on the box and we fill up as you can see
there's some more racks of these
that's our machines those image some
quick machine photos this is a big big
thing for us statistically you now
guaranteed to have machines die every
day but we notice it sorry we notice it
but the developers don't trees stay open
that means we can actually fix these
machines in a timely quiet manner we
don't have to be fretting about it we
can fix them right if a machine dies and
can't be repaired it's okay toss it plug
in another one image it up have it go in
and start taking upload build it and
they will come multi-branch moving along
a little bit here project branches
missoula used to be a one track
operation right developers do their
checking on one line and then at some
point we'd branch off and make a release
and that was very very few check-ins
went on that release my nose emergency
only stuff problem of course is someone
makes a mistake checks in some bad code
stops all development then you get a lot
of attention that's kind of obvious if
it's easily seemed to be that but if
it's a whole pile of people make changes
just right in a row and you're not sure
who made that change who made the
mistake it can be hard to debug that up
meanwhile the entire development
organization is looking really grumpy
because they can't do check-ins so
that's a problem so we went first to
project branches which is something that
a few developers were interested in but
most thought was just like why you
bother then basic motivation is here
knows if you make a mistake you block
everyone on this side they're still
grumpy where you have people on other
branches who can proceed along just fine
this may be all self evident to intrude
everyone but wasn't at the time and
still not great you still don't want
this but it's better than it was before
but it only works if sorry this only
works if all of these bills and tests
can be handled by the same identical set
of machinery so you don't have a windows
30 to build machine for this branch
that's different to a windows 32 machine
for this branch it's only because all of
these are queued up to go through the
same pool of machines and to guarantee
to get the same identical results that
you can actually have people trust on
project branches so that was a big plus
we're now running with 42 project
branches as I mentioned earlier they all
go to the same pool machines we can add
more people wanted a handy side effect
of project branches is released trains
we were able to build up another four
branches call them special sounding
names to humans like Aurora beta release
they're just project branches and now we
can coordinate things landing on to
those this is how we transitioned over
from the 12 to 18 months long ship it
when it's ready cycle to the ship every
six weeks camus the way I describe this
to some of my customers was your release
is as predictable as your flaky astore
riskiest project if you've got three
projects coming down that's going to go
out in this release and two of them are
rock solid and one of them is all over
the place guess which one's going to
derail your schedule and the theory is
that you might be able to back one out
near the end but the reality is when you
try and do this it typically actually
causes other breakages because people
have started checking things in on top
of that and so when you say oh I project
three has gone off the rails let's drop
project three out and we'll just ship a
project one and two as soon as you start
backing out all the code changes for
project three that have been there for
months you're going to refine one and to
break in some weird and wonderful way
because
had an accidental dependency they didn't
know that now you're stuck your only
choice is to basically get project three
to somehow be working and slip the
release so your release schedule is as
predictable as your riskiest project bad
news project branches healthy projects
ship on schedule late and risky projects
bump them off they don't get to land
they stay on the project branch and they
wait till the next release schedules
like this are actually great for the
company remember the company is your
customer this is how we do here you can
be working on a project branch you've
got to go through a sign-off process
here assuming you got your sign-off
process you're allowed to land into here
this is our main line as all central and
then following a cadence if there's no
problems you're allowed onto the aurora
or the alpha train and eventually on to
beta and eventually had to release
all this plumbing was actually done as
part of standing up our first few
project branches we done it to fill out
the rest of the project branches and
then we could go through a large culture
change in the organization about this
but it's working quite well for us the
other thing I okay time running out here
the other thing was there's some
problems they may well have just talked
about there is fairly stock getting
stock standard release engineering stuff
these are all things that police
engineers who clean around the board
before I've done and dealt with and seen
big impact there's a couple of other
things we came across that actually are
not typical what actually were tools to
problems that we had we had tools to
problems that were actually not
something that people need to even ask
for so here's two quick examples one is
updates remember I was talking earlier
about users complaining about being on
buggy software turns out that a lot of
the people were complaining about being
a buggy software were actually on an old
release the thing they were complaining
about the crash ever had already been
fixed in a later release they just
hadn't updated okay that seems easy but
actually the problem is we didn't make
updates available so we turned on a
bunch more infrastructure at this point
and part of the ideas here is now every
day we would make updates available
whenever we put out a release so if a
new release comes out of on a Tuesday
like happened last week there will
always be a check for updates option in
the menu will always work and that check
for updates option will always get you
to the latest version we used to have
people go and download the Installer a
lot of people wouldn't bother doing that
or if they did why would you go through
click click next next next is it
terrible so making sure that they can
always download an update
big deal make it simple and the other
thing is and be safe you can change the
update rate so when you make updates
available on our update server we could
say oh don't make it available to
everybody make it just available to the
people who do manual check but don't
make it available yet to the people who
are just on idle timer checking so we
have people if you haven't used your
machine for a few hours you're not
surfing you're actually actually using
it as a browser it'll ping in idle time
back once every 12 or 24 hours and say
hey is there an update we could tell
those which are the vast majority of
users not to bother don't do it just yet
we want to see if there's any more crash
reports if there's any problems we do
this a lot specifically on release days
we love throttle up just a little bit
and we're also very very concerned about
things like Patch Tuesday's which is
Microsoft patch Tuesdays or anytime
adobe flash puts out another update to
their plugin it's bad news if you have
Patch Tuesday and adobe flash update
that's when you're like oh hold on do we
have to all go at the same time like
we'll find new problems that's great
it's okay and the other thing is we make
it one click or less and this is a
personal soapbox a last time I had to
update adobe flash it was eleven klicks
including downloading the installer and
unchecking a did I want some bloatware
and all this kind of stuff in it so it
is a one check it's here are you ready
yes now do you want it yes no and this
is a company policy thing we actually
have an option to turn off that and just
do it which is what Google does as well
you just like here you go here's your
update chrome you in fact you don't get
a choice that's the way it is this is a
company policy mozilla feels that people
should have a choice in the matter so we
choose to let people have the one click
but it is one on only one click
this is our life day I just pull this
very late last night this shows our user
base you can see we have fifty-eight
percent of our users are on the release
that we put out on Tuesday now we
actually had it throttle down for a bit
over the weekend because we weren't sure
what was going on with a particular
video driver the next big batch here at
fifteen percent is the previously this
is a Firefox 21 this is Firefox 20 and
you can see all the rest these are all
two percent there's this one back here
is 3.6 is is three and a half percent or
something like that but most of our
users are on the latest version so we
don't get many complaints from users of
that buggy software for bugs we've
already fixed we also would do things
like go find some of these old clumps of
users and specifically target them with
specific updates so we prompt them
without having to prompt the people who
are on the more recent versions and
upset them because they feel like oh
like I'm getting prompted too much no no
we just target the people who are way
way way back so update fatigue is a big
thing the other thing we put some time
into who has download size we want to
take care of the fact that a lot of our
users are outside of the US not
necessarily on high broadband so if
you're in a developing country and
you've got pretty bad internet
connection you care about not
downloading a huge download so here is
partial update is we'd if literally
every file we take n minus 1 and n n
minus 1 being the elastance install and
n is the current install and we will go
through and recursively diff every file
say this file these seven bytes changed
this file same this file these first 20
bytes these will make that partial diff
which is really really small and you
would actually be okay downloading it
off of a mifi when you're on caltrain
definition of third world or when you
are somewhere else in the third world
pay attention to making it easy for your
users this helps you get this kind of
profile
the other thing was localization Mozilla
since day one has always had that all
locales ship at the same time and that
they're all you know on the same change
said it's actually kind of cool is my
first time ever working in an
organization that did that up to now
I've always worked in companies for is
like oh the tier 1 most profitable
countries then it's all the tier 2 kind
of profitable but there's a contract
involved then it's the tier 3 maybe if
we feel good about it you know and
actually like all humans are equal so we
go to ship all locales same changeset
same day this means it's harder to set
up what it's actually easier to ship
security fixes so if we need to ship
security fix at very short notice we can
do it in for all locales because every
locale in every operating systems off
the same train set we do that by having
nightly builds the localization people
can see what's going on make changes
through as active development is
happening localizers are doing active
localization that's always been true the
problem was they never got updates they
download a build and install it and then
a couple of weeks later they'd remember
go back and download another build and
then look for a differences so we turned
on infrastructure to actually generate
alternate updates for those nightly
builds that made it quick and easy to
find localization problems and also it
was a big motivator for localizers
because you can make a change and you
could see it the next day in your next
nightly build that's a massive massive
motivator numbers may 2007 we had 34
locales may 2013 were 94 locales
this is our breakdown globally
forty-three percent this is ian us then
we get into llt this is German I just
stick these numbers of man this is
German French Spanish Spain and Russian
and Portuguese Brazilian and of interest
here I note that of the forty three
percent hear that see in us about half
of these we did its analysis a while ago
about half of these are actually on IP
addresses that are outside the US these
are people who live in non-english
speaking countries who don't even know
that there is a browser available in
their language so they download the
American one so we're working on that
but
this is a problem that we had tools to
fix that mill be new to ask that's why
those leading questions the open-ended
questions at the bidding beginning are
so important so that's it companies live
or die by that efficiency how efficient
can release engineers make an
organization I'll just gone through some
of the things we did and way I like to
press it this is what release
engineering looks at like at Mozilla if
this group of people can make that kind
of a difference what could you do</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>