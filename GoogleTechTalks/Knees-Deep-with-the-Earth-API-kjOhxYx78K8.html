<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Knees Deep with the Earth API | Coder Coacher - Coaching Coders</title><meta content="Knees Deep with the Earth API - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Knees Deep with the Earth API</b></h2><h5 class="post__date">2008-09-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/kjOhxYx78K8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Roman Nurik I am a member and
kind of a newly minted member of the Geo
api's team I work on the earth API and
the KML spec I do developer support so
third-party developers that have
questions about the earth API and KML
they post in a public group which I why
do you link to and I'm I respond with
answers things like that so just to
start off how many of you have actually
heard of the earth API I'm assuming
everybody has right okay so right now
maybe you've coded before with earthy p
I maybe not right now we're actually
going to get into the code not
immediately but we'll get into the code
and see what it looks like all right so
how do we get here so in google i/o may
2008 michael t jones announces the earth
api he kind of just showed it off opened
up a browser window popped up earth and
they were using oz around the audience
and it was kind of a big step for earth
in general and I'm you know it's very
very big moment for us Paul rademacher I
think either that day or the next day
showed off some demos and he showed off
kind of some of the capabilities that
the earth epi has and their browser
plug-in has so those those videos are
actually available on YouTube right now
so anyway so after Google i/o there
hasn't really been much public much
public kind of many public announcements
about it so in june through august we've
been releasing new demos and we actually
revamp their api reference and we've
provided some new documentation so
people that that haven't been able to
use the API because they're not sure how
to use it and such they've been getting
more and more resources recently in the
past three months so today September
we're going to start writing some code
and see what it looks like and we'll
show off some more demos and hopefully
this can be kind of another step forward
in the earth API you know in the life of
the earth API
alright so some current capabilities
before we get to the code right now the
browser plug-in and API or Windows only
five bucks to and higher and ie6 and
higher so some of the things that you
can do with the earthy p I you can
programmatically manipulate and create
place marks which are kind of the
equipment of markers in the Maps API you
can create paths which are like
polylines and create polygons ground
overlays screen overlays and 3d models
which are probably one of the more
exciting features you can even show KML
files just as you normally would in
Google Earth and you can actually
manipulate the KML files once you put
them into the earth browser plugin so
some other features you can let the
users interact with the things you
create on the plugin you can actually
listen to Mouse events so when the user
clicks on a placemark for example you
can give them some sort of feedback you
can do whatever you need in JavaScript
you can also show balloons which are the
equivalent of info windows in the Maps
API using the native browser HTML Dom so
you can actually embed whatever HTML
your browser can render inside of the
earth plugin and another nice feature
for I mean there's no numbers in the
audience I'd or maybe there are I don't
know but you can actually show the sky
which is a which is kind of like you can
see the stars the nebulas whatever
whatever imagery we have is available
there so a quick overview of kind of the
systems overview of what the earth API
and browser plug-in are so earth API is
very simply Google Earth in your browser
it's the entire Google Earth package
just kind of trim down sliced apart and
stuffed into your browser window the way
it works is that there's actually two
components there's the earth JavaScript
API which is kind of the intermediary
between your application and Google
Earth itself then there's the earth
browser plug-in which is which is just
like I said an extension of the earth
desktop application so you
the same rendering and whatnot and then
there's your own website here's your own
client side JavaScript so your client
side JavaScript uses talks with the
JavaScript API which then passes
whatever you need along to the browser
plugin and back in the case of for
example events so a little more details
about the JavaScript API so there's kind
of two pieces there's the global
namespace Google Earth dot whatever
that's just job those are just very
basic JavaScript functions that give you
kind of a top-level set of features to
interact with the plug-in you can tell
if it's supported if it's installed you
can create an instance you can use this
to fetch KML to load KML into your
plug-in and you can add event listeners
like for mouse for mouse and things like
that there's also the second part is I
other classes and I'll actually just
quickly show you a list of the classes
so the classes there's two types there's
the GE whatever classes and then there's
the KML etc etc classes the GE classes
are plug-in specific so these kind of
they would not necessarily make sense in
in the in like maps for example and they
were to make sense in our that Earth
application the KML classes are actually
just an exact replica of KML elements so
if there's a ground overlay element in
KML there's probably a kml ground
overlay class in the earth API as you
can see so these are designed to kind of
mirror the exact functionality of KML
which as you may or may not know is kind
of the language of Google Earth all
right so let's move on now the
JavaScript API was designed to very
heavily mimic the kind of the w3c Dom
and the w3c DOM is like if you've done
any sort of JavaScript coding in an HTML
or and you know whatever you you kind of
familiar with things like a pen child
remove child child nodes
things like that so the earth API is
kind of a KML DOM and it's designed to
mimic like those features that most
developers are familiar with already so
all right so now we're going to get
started with coding I see that some of
you have max so kind of unfortunate
right now since its windows only but you
can follow along on my screen as we
start coding so the very first thing you
need to do in any you know to do a very
very basic or CPI page you just need to
create a basic HTML page with a fixed
size div and that div will be replaced
by the plug-in and let's say that as
error that HTML so I'm going to go ahead
and start typing away so it's the HTML
head let's see what we say to do sorry
write a basic HTML page with the div all
right ahead we'll leave that open for
now body div ID equals map 3d that's
that's kind of a convention but you can
name it whatever you want style with
let's make our let's say 640 pixels 540
pixels so this div will be replaced by
the earth plugin
okay so let's save that see what it
looks like in Firefox absolutely nothing
as expected all right now let's see at
the standard Google jsapi loader now if
you guys are familiar with the Maps API
or any other Ajax API is there's a
standard loader that you can use to load
whatever you need there's actually now
functionality to load things like jQuery
and things like that but those are kind
of unrelated and there's a standard
syntax for that so what we're going to
do is we're first going to load the
jsapi loader and then we'll load the
earth API so let's go back to our head
script type equals text app text
JavaScript source equals calm / GS API
okay so usually you'd actually append an
API key to this but since we're looking
to since we're working on our local file
system we don't need to so we'll do that
and then what's the next thing it says
to load the google download earth one so
now we'll add more JavaScript this time
it'll be in line that script if you
google that load earth one and now so
that's going to load earth and it's
going to load version one right now our
version is stuck at one there's no kind
of minor versions think in the future we
do plan to have minor versioning things
like that but for now it's just google
download earth one so let's save that
and again you're not going to see
anything yet because it's just loaded
the JavaScript that hasn't really done
anything yet so we'll just leave it
alone for now so now this is what the
code should look like you just saw it so
we'll just skip over this so now we need
to create an infinite function for body
onload very simple unload equals in it
and I'm sure a lot of you are getting
very bored of this since it's very basic
but i just want to show off how how
really really basically code is for for
just getting very simple Earth API
mashup
and running on in it called Google that
our google data earth decreed instance
so this is one of those kind of global
level functions that are exposed like is
supported is installed and things like
that so actually right here if you want
to just check if the browser supports
the earth the earth plugin is supported
by the browser you can do google that
earth dot is supported and just do your
coat dear lot some logic there but we're
not going to do that we're just going to
do create instance so now we're going to
pass in the ID of the day we want to
replace with the earth plugin then we'll
pass in and something called a Nik call
back and that's that's just the function
we're going to write you getting that
whatever you want and then know that
null is just a placeholder for a failure
call back in case there was some error
that function would be called but since
we don't really care right now we'll
just leave a blank and finally create an
it call back function that calls GE get
windows set visibility true so in it
call back oh actually one thing to
notice that you're in it call back is
actually going to get an argument for
for an instance of the GE plug in class
the GE plugging classes in our API
reference that's kind of like the root
of everything everything you do in there
with API is going to kind of start with
the GE plug in class so GE plug-in that
get window that's set visibility true so
what that's going to do is just going to
kind of show the earth it's a very most
primitive form and yeah so let's see
there we go so it's going to show the
universal little loading icon and
eventually it'll load up and again that
eventually we're hoping to minimize that
eventually as much as possible of course
yep
how big in terms of memory or file size
it's pretty much all of google earth
they're trying to like trim it down as
much as possible but it's mostly just
Google Earth stripped down to buy maybe
a few megabytes and it's just packaged
in there if you actually look in program
files you'll probably see very similar
file structure yeah it's it's pretty big
I mean it's it's a work in progress so I
mean I'm sure that they're going to kind
of cut down as much as possible to save
in both memory and file system usage
hard this space but I mean as of now
it's it's what it is so this pretty much
all right so there we go so we have a
very basic mashup actually is not even
mashup doesn't even do anything but
there it is earth and how many lines of
code 23 lines of code with spaces and
such so as you can see it's very very
simple to just get the most basic
features running all right
chrome actually it's coming it's one of
our top priorities just to get chrome
support out we'll talk a little bit
about that after in the Q&amp;amp;A session so
so earth that HTML so this is these are
the things that we just added you get it
actually this is this code is wrong it
should be GE or g plug in this variables
should be the same anyway so that's very
simple you just add those lines and
blooming at earth and we're done so
fired up Arthur HTML works in firefox
and ie cetera et cetera now if you
actually write this code on on a on a
machine that doesn't have earth
installed it'll still work you'll just
say you need to install earth I don't
have a demo of what that looks like
right now but it's pretty much just a
some HTML with a button that says
installers ok so we've written some code
let's let's do a little interlude and
look at some demos because demos really
kind of get people excited exactly there
you go and that should say it doesn't
support your browser right Ursula's only
windows ah gotcha gosh ok so let's see
monster milk truck how many of you have
seen master milk truck so only a few
people have seen monster milk truck this
is by far my favorite sample ever in the
world in all like for all plugins my
favorite thing in the world so this kind
of shows off first of all it shows off
3d buildings which you can enable or
there they on you can show off 3d
buildings you can show through the
buildings and that's a one line of code
like you just enable that layer another
thing this is showing off is events
actually these aren't exactly Google
Earth events these are just dominance
right now my focus is in the is in the
winter the web browser so the web
browser is catching my keyboard events
and it's passing them along to some
JavaScript that's moving around this 3d
model so this 3d model is loaded
actually from
from 3d warehouse and you as you can see
it's pretty sweet and it's pretty fast
so by the way this is also showing off
info balloons and ground overlays the
shadow as a ground overlay so this isn't
a new sample this was discussed and this
was showed off by Paul rademacher and
google i/o 2008 so that's kind of
monster milk truck one of my favorite
samples so now let's go to some newer
samples this is a new sample that I
recently made called the driving
simulator so what this does is you put
in any two addresses put in a from and
it to right now I actually think there's
a bug where it breaks if you're trying
to kind of simulate New York to San
Francisco but you know it's kind of
absurd anyway so from San Francisco to
Mountain View you just could go and
shows you this is showing off markers
and balloons and such and polylines see
their line strings but and now the cool
thing about this is that you can
actually press Start and it will start
driving let's increase the speed here
it's a little model of a smart car I got
in 3d warehouse so it'll drive you along
and you can increase the speed and go
really really fast and as you can see
this is synced up to a map on the side
using the Maps API and that's very easy
to do i think in total number of lines
of code is maybe a like a few hundred
and this is actually using some reusable
components from the driving simulator
things like there's a kind of a
javascript file that gives you stuff on
how to do some basic math in in a 3d
space and there's actually another
helper helpers file that I've made
that's included with this as well Sonia
so you can drive around and you can
pause it and do whatever you want
alright so some more interesting demos
this one's really cool this actually was
internal internal demo that we recently
put up it's called Earth pad and it lets
you
of it's like a chat room for the earth
plugin so you can chat and actually
share the same view port so I'm going to
go ahead and open this in a new window
and show you how let's see there it is
show you how they sync up as you change
viewports wait wait for it wait for it
come on
well this was working just like five
seconds ago I guess not well anyway you
can play around with that and out there
we go now it's actually moving well you
can play around with it on your home
computer and it actually does sync up
pretty well you can kind of create
placemarks together you can actually do
it chat so this shows just kind of shows
things like catching events here and
kind of replicating them across a
network and then I'm in mimicking them
on the other side so that's our pad
another one another cool one is for
anybody that's into KML at all there's
actually just got put up today it lets
you kind of edit KML interactively and
show it in the earth plugin side by side
so let's see background color right so
this shows a balloon with a cool
background color now I can change it
right here let's say I wanted completely
white or actually let's do cyan it will
refresh and should be sian so this kind
of this shows again like KML stuff this
actually uses something called parks KML
which gets a string of KML and returns a
KML object you can then traverse the
object for all of its features and such
that's the KML interactive sampler and
here's actually this is an exactly a
demo but it's a demo gallery these are
all the demos that we have available
right now this was also recently
launched you can actually select topics
filter by topic and see whatever you
need the nice thing about this is that
there's a lot of basic samples turn a
quick example of a basic sample and
those are kind of really really simple
samples to show you how to do one thing
really easily so show hide terrain right
you click on join shows you an instance
of earth and it shows you the code that
you need to run to both hide and show
terrain and it's pretty simple you just
do get layer by ID or enable layer by D
and you could do this for terrain
buildings roads
there's probably more that I'm missing
but those are kind of the important ones
all right so that's that's the demo
gallery now let's go back here okay so
those are the kind of small kind of the
newer demos that have come out now let's
write some actually now now there's more
community demos will go through these
are kind of interesting as well this
shows google sky and some interesting
things you can do with it so there's the
skies it's probably kind of hard to see
with this terrible video signal but um
you can navigate the Stars and this is
what somebody from Arizona State
University did I think of media
professor than I'm not really sure but
you can actually just find stars and get
information on them and there's some
navigation here so there's some pretty
interesting things you can do with this
especially for astronomers and airline
routes map this kind of shows a really
nice or is it there we are so you can
see airlines in Europe actually airports
in europe and all the other airports
they fly down and it's cool because it
shows you in 3d so you can kind of see
the trajectory I mean it's not it's not
an actual trajectory that's not what a
plane flies like but it's a solis kind
of like a nice visualization alright so
those are some more diamonds from the
community okay so we're done with demos
for now we'll see some some more demos
later but um so let's talk about maps on
earth so let's say you have a Maps API
site kind of like a mash-up per say that
and you just allow users to see your own
data and a Google map and so we now
start with API and you say oh that's
great I want to use that but you don't
want to have to use our entire you know
you don't have to kind of rewrite all
your code to kind of use the new API and
new do google download earth one
instance etc you don't have to create a
separate instance and things like that
so we've actually made it really really
simple for you to just put in one line
of code into your existing map site
and show and show an earth tap that you
can click on and it just mimics the
exact features that are in your maps of
your Maps viewport and it mimics them
right in earth so use the Maps API one
line of code and you're done so create a
map with the Maps API map that I'd met
map type you had this map type and then
you'll be done so let's actually start
writing that should be very very quick
HTML head I'll skip some of the some of
suspense
japi and again you'd have to use the map
key their script
so again the Maps API you just do divide
equals map etc you can give it a style
with 500 pixels 500 pixels
okay so now we'll load the Maps API
instead of the earth API because this is
what people already doing actually two
will create an uninit function unload
rather then in this init function will
do the standard thing that you'd
normally do new gmaps too so again this
is stuff that people have been using for
a few years already so this is nothing
yet map now let's see map that set
Center 37
okay so let's see what that looks like
for now we don't do anything i should
have does absolutely nothing so I made a
few mistakes module mathema found out
whoops naps
okay so that's that's your vanilla Maps
mashup doesn't even do anything forever
add control gene map type actually type
of control this is wait new dream out of
control sorry I'm not a pro at the Maps
API like Tamil foxes she's she's good
with this stuff and her so there's
there's the simple maps of control now
we're going to do is with one line of
code we're going to add earth there so
map that add map type G what was it
let's see yeah g satellite 3d map
satellite 3d map
boom so let's navigate around click
earth actually it's more impressive when
you go from satellite to earth the
satellite and earth so it's the same
thing satellite arts mode as you can see
the imagery is very similar so there it
is that's all you pretty much need to do
to have an existing map site run with
Google Earth side by side alright so
that's that's the code you'd have here
some actually this is a nice feature to
show off as well ya later so you can if
you notice that where is it there is
so the navigation controls and map the
earth navigation controls are very very
similar and they're in the same place
now so it's you know it's a very
familiar user experience users won't
have to kind of learn a new system and
it's available for them it with one
click of a button zoom levels are very
close there's some math going on here
that's kind of its kind of matching up
the zoom so if you go to set yeah it'll
it'll zoom right in so there's some math
going on there that's pretty advanced
that that kind of makes this really
simple and kind of really usable okay so
let's move on from there wait that's not
that's not it there it is alright so
what's what else is coming um so I just
showed you maps and earth right the
thing is though that like if you let's
say you add some markers in maps right
now if you click on earth those markers
will be transported to earth until they
look the same it will be in the same
place and you'll have the same info
windows and everything however this is
this kind of functionality is only
supported right now for markers and
polylines I believe that polygons you
have to manually transfer over and it's
it's not too hard to do it's probably a
few lines of code but you still have to
transfer them over manually so that's
one major thing we're working on we're
also working on google chrome support
should be coming out fairly soon mac and
linux support is coming as well we'll
talk about that after the video ends and
enterprise support is also planned for
so enterprise customers that currently
are stuck with kind of the free terms of
service there they'll probably will have
i don't want to say a date but they'll
probably have some sort of support
coming up so here's here's kind of some
important things if you do cute plan on
going forward with the earth API and
kind of developing your own mashups and
whatnot some of the main things you want
to do are I mean first of all you can
get in touch with me in
finally you also want to check out the
developer's guide which is right here
some new references that we've put out
actually the earth API reference is
brand-new the KML reference has been out
for a while but those kind of go hand in
hand there's also the community support
group which I do spend most of my time
in kind of responding to questions and
kind of proposing solutions for some
common patterns there's also the earth
API hmm it's on groups yeah there's
there's a separate BBS for Earth itself
but this is done through google group so
also the earth API interactive sampler
with this is enough airlie simple it
lets you just type in JavaScript code
into a text area press run and it runs
that code and it kind of shows you the
results in the earth in the browser
plugin another useful really really
useful thing for any sort of JavaScript
debugging not only with the earth API is
fire book if you guys haven't used it
then you should I'm assuming everybody
here is heard of it but I just wanted to
throw it out there all right so that's
that's the talk</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>