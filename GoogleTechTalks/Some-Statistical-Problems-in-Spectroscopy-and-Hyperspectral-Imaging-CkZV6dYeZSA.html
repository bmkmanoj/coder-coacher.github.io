<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Some Statistical Problems in Spectroscopy and Hyperspectral Imaging | Coder Coacher - Coaching Coders</title><meta content="Some Statistical Problems in Spectroscopy and Hyperspectral Imaging - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Some Statistical Problems in Spectroscopy and Hyperspectral Imaging</b></h2><h5 class="post__date">2008-07-26</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/CkZV6dYeZSA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my great pleasure to introduce North
Berman here
csro that you know in mark for almost
two decades now
right anyway time flies yeah but so mark
has been involved in geospatial imaging
and especially hyperspectral imaging for
many years he also has done a lot of
work in the area of morphological
imaging and he's now a chief scientist
that chief research scientist at Cicero
Cicero is the largest Research Institute
in Australia and for the past I guess a
couple of months he's been in Stanford
or maybe more than couple of months yeah
Stanford for five and half weeks so it's
a summer teaching position and so today
is going to talk to us about
spectroscopy and hyperspectral imaging
Marc Thank You Luke thank you for having
me here okay um this sort of talk about
some of the work that we've been doing
over a number of years in these areas
I'm with the division of CSR which I'll
talk about briefly in a minute called
mathematical and information Sciences or
CMAs for short at the bottom you can see
a number of collaborators over the years
mostly in my home division but also to
key collaborators in another vision
called exploration of mining okay here's
an outline of the talk what is CSIRO
I'll tell you in a minute what a
spectroscopy and hyperspectral imaging
and why are they useful and major areas
of our hyperspectral research it's all
about mixture models and what's called
unmixing and they're two extreme cases
where you have a spectral library what's
called a spectral library and I show
some applications in mineral exploration
and talk about what we've done so far
and some future work and then mixture
models where you don't have a spectral
library and I'll give a very brief
application in biotechnology just to
illustrate the point in a low
dimensional setting and then I give an
example in remote sensing which probably
probably more interesting broad sense to
people here I'll talk about some recent
extensions of our work by others and
I'll talk about some future work and
please ask questions as I go but not too
many I gave a similar talk a couple of
years ago and I had so many questions
only got halfway through
so they invited me to come back the
following week to complete the talk so
I've got what about 45 minutes okay
thanks okay what is CSIRO it actually
stands for Commonwealth Scientific and
Industrial Research Organisation it's a
little over eight years old it's
Australia's largest research
organization you don't it takes research
and a whole lot of scientific areas
agriculture environment health
information communications technology
advanced materials and manufacturing
minerals and energy transport
infrastructure services and astronomy
it's got the annual budget of about 1
billion u.s. dollars
70% of that comes from the Australian
government and the other 30% of funding
comes from industrial work so its focus
is very much on on customers needs there
are about six and a half thousand staff
for day over 50 sites in Australia and
overseas so guess we're comparable in
size to Google but we're more well now
you're spread out as well aren't you
sorry okay now can ask how many people
don't anything about spectroscopy here
also there few of you know okay but
obviously not all of you they're
actually many different types of
spectroscopy typically the amount of
light that an object reflects absorbs
transmits scatters or flores's is
measured at many wavelengths often but
not always equally spaced will mostly be
concerned with reflectance or absorption
spectra to make life easy the absorption
is just minus log of reflectance I'm
used to if in the remote sensing and the
mining industry they used to work with
reflectance and you'll see spectra these
curves with the features pointing down
in the life sciences they used to work
with absorption with them and because of
the minus sign in their game the
features point up okay the log obviously
has a difference too but the main effect
is the minus sign it can often they can
often be represented as a smooth low
frequency curve with absorption features
which are intermediate frequency and of
course the noise is the high frequency
the spectrum of material tells us about
chemistry so some examples follow okay
these are taken with a spectrometer
called an ASD
which gives you a measurement at every
nanometer from 350 to 2500 nanometers
but I'm just going to show you your
spectra between 400 and about 1300 okay
and to give you a frame but this is
called the visible and near-infrared to
give you a frame of reference blue light
is roughly between 4 and 500 nanometers
Green is between five and six hundred
and red is between six and seven hundred
so if I take some samples of green
vegetation now these are not repeat
samples they're actually different
leaves or well I guess mainly leaves
okay and so what you see you can see
that there is a peak between five and
six hundred in the green which is higher
than the than the blue and the red which
is why our eyes recognize the green
because it reflects more green light but
if you go into the infrared you can see
it actually reflects more light in the
infrared but our eyes can't detect it
and a lot of these actually have because
they're green they have water and these
features here are due to water okay on
the other hand if you take dry
vegetation which is typically red or
yellow or brown it actually reflects
more between six and seven hundred than
in the green part five and six hundred
because that's the color we see but you
go in the infrared and the water
features have disappeared because it's
dry okay so in a very simple way I'm
showing you what spectroscopy is
measuring at a very coarse level these
are spectra of a mineral called hematite
does anybody here know what hematite is
yes yes but it's main the main thing is
it's the important iron mineral rights
there seventy more tight and good side
for the main minerals are on rich
minerals okay and you know what color it
is where it's reddish okay good thoughts
yellowish so it has a reflects more
light and between six and seven hundred
in the green and the blue parts and then
has a bump and goes up and then down and
up like that lazurite
is a mineral that's known in the jewelry
trade as lapis lazuli okay does anybody
know what lapis lazuli looks like
blow that's right so it has a peak in
the blue and then goes down and then
goes up now my wife actually has a fake
lousy right it's called a soda light it
looks just the same here but if you move
in the infrared you can actually tell
the difference between lazy right and
soda like when I told my wife a few
weeks years ago she said we should start
a business using spectroscopy to
identify fake jewelry okay so actually
let's move into that what's called the
shortwave infrared this is with an older
spectrometer called a Pima which is
where I started the 90s with with
collaborators it measures between
thirteen hundred and twenty five hundred
nanometers of 2 nanometer intervals it's
a size of a shoebox it was made for
geologists to take out in the field and
make point measurements of spectra okay
these minerals are in mineral expiration
you don't look for gold or silver or
zinc or copper directly you look fat
other minerals called alteration
minerals which are sort of signposts I
won't go into details an important class
of alteration minerals are called white
markers when we started the 90s we just
had to alight and muscovite and you'll
notice all of these white markers have a
feature an absorption feature around
14-hundred another absorption feature
around 2200 and you can see the
background shape the low freqs if it
varies a little I'll explain why in a
minute
but really the Dyke when it when a
spectral geologist looks at these he
looks up at the where these absorption
features are in their shapes and the way
you normally tell the difference between
a light muscovite is by this feature
here which is due to water again but is
bound okay so i've seen one take a
muscovite wet it measure its spectrum
and it looks like this essentially and
then you put them they put in the
microwave for a few minutes to drive out
most of the water it looks like this
with an e light essentially you can't
drive it out you can if you're going
about 300 300 degrees Celsius but so
it's called bound water and that's the
main way you distinguish between these
now more recently we subdivide muscovite
into muscovite Prag a night and fen guy
whoops as we sorry as we understood all
of my colleagues geological cogs
understood the differences basically
with
muscovite the features around 2200 okay
with pragna night it's around 20 190 and
with thin guy it's around 20 to 20 and
basically that slight shift in the
position of the feature is indicating
substitutions between potassium sodium
and either iron or magnesium so you can
tell just by subtle chat changes in
position and sometimes in shape you can
actually detect substitutions if I
showed you the formula for these things
they're quite complex okay and the
geological names rather than chemical
names so for instance and you know
geology started in many ways before
chemistry and the names just don't
reflect the chemistry so for instance
can anybody tell me where the name
masculine comes from yeah it was
discovered near Moscow and there lots of
minerals named after the people who
actually discovered them okay so that's
part of the problem that we have to deal
with okay so number of things to notice
as we move into shortwave infrared the
the the features of importance have a
higher frequency like all intermediate
frequency the backgrounds vary in shape
they have very little information
content and you also have you also have
variation in brightness okay that's
either natural you look at two leaves
from a tree some are slightly darker
than others okay
or if you there is a lighting issue if
you look if you have the Sun okay and
you've got trees facing the Sun Iran on
the side of the hill trees facing the
Sun will be brighter those on the other
side will be darker so there are all
those sorts of variations and this two
first order they're essentially
multiplicative okay most of all I've
cities on this slide they're brightness
variations do you either natural
variation or variable in the
illumination they're predominately male
duplicative the most of the information
is user spectral shape there's a whole
issue about scaling a spectrum which I
won't talk about here that's something
I've been talking to my students about
the absorption features are usually high
frequency in the shortwave infrared than
in the visible and the infrared and the
backgrounds are due to either scattering
or the presence of other minerals such
as quartz and feldspar which have a very
low frequency signature in that
spectrum but these minerals actually
have a map a distinctive spectrum higher
up in what's called the thermal infrared
and I've been doing some work there
lately and we'll be doing more as time
goes on traditionally the backgrounds
are move removed before subsequent
analyses such as taking the convex hull
and take the upper bit of the convex
hull are the subtracting or ratio II
okay so what's a hyperspectral image a
hyperspectral image produces a spectrum
typically tens or hundreds of numbers at
each pixel so hyper spectral images
enable us to map variations in chemistry
in fact in the chemicals industry it's
called chemical imaging the original
hyper spectral senses
I'll show you one later on the data from
one later on in the 80s and 90s were
airborne they were used mainly for
expression environmental and military
applications there are several hyper
spectral satellites due for launch over
the next six years starting this year by
a number of different countries the US
has isn't probably go up to about 2013
or 2014 there are now hyper spectral
microscopes and cameras being used for
terrestrial applications such as medical
diagnosis burns analysis skin cancer
biosecurity pharmaceuticals forensics
agribusiness exploration and mining so
it's a whole burgeoning field ok let me
show you one example which I
unfortunately have time to come back to
this is an example of part of it an
excedrin tablet well known in this
country it's a company on the outskirts
of Washington DC called spectral
dimensions that makes its living just by
doing hyper spectral lines developing
devices and software for doing
hyperspectral imaging of tablets ok
tablet inspection ok this is in the
range range 1200 to 2400 which is more
or less the same ranges of p.m.
spectrometry 1,300 to 2500 but instead
of being two nanometers apart it's a 10
nanometer intervals okay and it produced
121 images unfortunately that's 11
squared so I can show the data in the
grid these are some sample spectra
because it's in the last Sciences of
features point up because their
absorption spectra rather than reflect
inspector
okay with techniques I'm going to talk
to you about later more won't have time
to show you we can actually take those
121 images and decompose them into
therefore essentially four ingredients
in there right
caffeine aspirin acetaminophen and
filler and you can average those are the
concentrations or proportions maps of
each of those in constituents and you
can average out proportions and get an
overall estimate of what's in there and
that's actually pretty close to what's
on the bottle from what on the label and
the bottle from which this tablet came
and no it's only part of a tablet and
it's only looking at the surface that's
within a few percent of what-whatever
toys from the bottle but it's also
important once you've got this map you
can actually what you can visualize but
you can also test for the spatial
distribution of the ingredients because
if it's not it's important it's
uniformly distributed if you have as you
know excedrin is for migraine headaches
if you have a five-year-old child as a
migraine you take take that child the
doctor and doctor says give the child
half a tablet if it's not uniformly
distributed the chances the child may
get too much or too little of the active
ingredients okay
so I want two major areas of our
hyperspectral research in many
applications most Pixel contain a
mixture materials where I started where
this was in remote sensing at you know
airborne instruments depending on which
instrument it is or how high they fly
they might be 30 meters by 30 a pixel
might be 30 meters by 30 meters my
office which is fairly standards office
is 3 meters by 3 meters so that a
typical pixel is about a hundred times
the size of a standard office the chance
of that pixel containing one material of
actually very small and perhaps
surprising it first but not surprising
on reflection in a microscope the same
is true you know you just look and find
a scale you see more okay so our recent
research has been focused on what's
called unmixing spectra into their
constituent materials the older stuff
which is first of up the new nineties
but still going on fast and reliable
identification and material mixtures
with a spectral library and that's
called the spectral assistant more
recent work is fast reliable
identification material mixtures without
a spectral library in remotes when the
hyperspectral literature that's called
the end member problem this algorithm
was originally called iterator
constraint in
members and the guy who actually
programmed it up said well this is too
much I'll just take the initials and
call it ice I come to that okay so the
spectral assistant is about the
identification of material mixes with a
spectral library and it's been developed
since the mid 90s so a spectral library
consists of spectra of pure materials
okay or notionally pure materials and
then you have a simple model which I'll
show you and from that model if you have
a mixture you and mix into the
constituent components okay so the
spectra assistant identifies pure
minerals and mixes of two or more
minerals from a spectral library we're
now up to version six but it's not been
publicly released version five has two
libraries of pure materials the larger
library the more important one it's a
shortwave infrared library it has two
hundred nine nine wavelengths that has
55 materials soon to go up to over 60
with various minerals dry vegetation
wood Teflon plastics or I'll show you
shortly
a newer less developed library isn't the
visible and near-infrared which is 163
wavelengths and on these 17 materials
for iron ores such as hematite and
sulfides and green vegetation this is
what we started with for the developing
the shortwave infrared with this
disappea map as ice it's about the size
of a shoebox building libraries is a
very time-consuming business okay and
well in this application certainly my
main collaborator John Hannigan took
took a pima went around the world went
the US Geological Survey I went to
various mining museums took samples that
were notionally mineral a and and
measured their spectra and it turns out
that some of these things art mineral a
there may be mineral B which is similar
but not quite it's got a substitution
basically okay it's not quite the same
well sometimes it's a little impurity in
there you know the geologist has
actually looked at it having that data
for chemical analysis and they put it in
as the the in the collection said this
is such-and-such and they take you know
and that effects if you've got
impurities in there there to fix things
so there's a whole process of slow
process
okay and in biology it's even harder if
you if you think of the microscopic
level if you how do you actually get
pure samples of of in greetings in a
cell your dainty okay so this is the
basic model they're three main
components okay let me just focus on
here there's a thing called beers law
which says in this very intimate
situation - first all the mixing is
multiplicative but it really doesn't
make very much difference whether you
take logarithms or not well we do take
logarithms to make things out here okay
this is that the main model you have you
have two sums and I'll talk about each
some separately okay
M is the number of materials in the
mixture AJ is the mean spectrum of the
jafe library class out of em and of
course and these are the weights now if
you're taking I mean the simple way to
think about here you've got a pixel on
here because it's all you got material a
that's all you got material B right if
it's 40% of material a you know 40% of
the areas covered by material a 60% it's
covered by material B then sort of the
naive so the model says that the
spectrum I'm looking at is point four of
the spectrum of material a plus point
six the spectrum of material B but
you've got a brightness variation so you
don't you constrain those weights to be
non-negative but you don't constrain
them to sum to one okay so that's the
constraint is that these weights are
non-negative and we model the background
as a as a low frequency cubic spline
okay for those of you know about cubic
splines we just have two knots which can
be modeled as a sum of six basis
functions plus we always put in water
water is ubiquitous in spite of a
drought it's ubiquitous okay and people
actually do mostly uninterested in the
amount of all water so we always fit it
okay but unlike these alphas these
beaters are unconstrained okay and then
we have an error my backgrounds and
statistics I tend to think about
statistical models and the implicit
assumption is that there is a common
within a common covariance matrix that's
actually incorrect okay
but it's really difficult to if you
assume different classes if either here
we have 299 wavelengths so we have a two
hundred nine nine by 299 covariance
matrix we just don't have enough data
the estimated for each separate class so
we have to lump them all together
no I'm talking about the low frequency
remember there's a low frequency
variation which doesn't tell you very
much about what's what's in the spectrum
that's how we're modeling it we're
modeling it was a low frequency spline
what do you mean what is it well I told
you that they're due to two main most
likely sources here either there are
other minerals in there such as quartz
or feldspar which have a low frequency
signature in the range we're talking
about or sometimes you get these things
these changes due to scattering if you
haven't got an example here I'm not
going to show the example with the
tablet but if you ultimately you can see
by this a Diagnostics will show you that
there's some particles in the tablet
that actually are facing slightly
different way and they scatter the light
differently and the light actually has
its main effect in the low frequency
okay so it's the living straight it's
it's variation that you're not
interested in then you've got to model
it out
okay well now quartz has emit quartz as
a mineral felt as a mineral now it's
it's I'm it's it's one of two things
it's either minerals that have a low
frequency information count in the in
the shortwave infrared or it's due to
scattering okay
unfortunately I have the time to show
you everything you know I'm happy to
talk to you more about it offline but
that's what it is it's this it's this
extraneous stuff here right you can see
the variation right in the low frequency
which doesn't tell you very much okay
we're trying to model that out and it
things fit better if you if you fit
everything simultaneously rather than
one by one
okay so that's how that model is okay
the second part is we go into some of
you will have heard of linear
discriminant analysis you can do this in
the subspace called canonical Verret
space we do have a penalized version of
this okay because we don't have enough
data to reliably estimate that within
class covariance matrix it's a paper a
little over a decade ago by some people
I'm working with in Stanford core where
they have a way of penalizing this and
we do that for two reasons one for
dimension reduction okay and secondly
for D correlating the data so
effectively then you can use the least
squares typed approaches rather than
working with a little Mahalanobis
distance okay and the other thing is far
subset selection procedures we have a
library of fifty five minerals or
materials one of which is water that we
always fit so there's another 54 in any
particular mixture you're unlikely to
find more than a few you know you know
it's silly to fit all 54 you're gonna
over fit okay so actually want to find
small subsets and then make a decision
about hammett which is the right number
so for the shortwave infrared library
you have to look at just at mixes of two
you have to look at 54 choose 2 which is
fourteen hundred and thirty one possible
mixtures of two materials okay and so we
have far subset selection procedures for
doing this because the model is wrong
you can't use F tests or ya information
theoretic things like caucus information
criterion or minimum description length
it doesn't work okay we had early on
some well with the pure data I think
most of them had actually been
chemically analyzed we hadn't made a few
dozen samples of mixes of two and maybe
half a dozen two mixtures of three we
just didn't have enough to work out yeah
well for mixes of two we empirically
worked out a rough rule of deciding
whether it's one or two we're now trying
to do three and four because we're
seeing example that now this software
has been incorporated into another
package called the spectral geologists
which I'll show you briefly shortly
which is sold commercially and it's been
sold to over 100 expression of mining
companies which is that game is pretty
good and it can analyze tens of
thousands of spectra in a few seconds
okay let me show you a quick example
here I'll show you these before these
are white mike is the key to note is
that they all have single these
absorption features around fourteen
hundred and twenty two hundred this is
another important class called
candidates okay and therefore in that
class as well the important thing to
note is they have a doublet around
14-hundred and around 2200 and they're
also the doublets are all slightly
differently shaped okay there is one of
the early samples I worked on when you
look at it it looks like you know it's
got the single feature it's got another
single feature here and it's got this
water feature so it's probably like but
if you look there's a little a little
bump there and the shoulder and when I
showed it to my collaborator John
Huntington is an expert spectral geology
so it's probably going to be with
Caroline in it okay because of that
doublet so you can remove the background
parametrically okay and what I'm showing
you here the black curve is the
background corrected true curve and then
the red green and blue are the best
three fifths of a single mineral okay
and you see the black none of them can
quite get that shoulder but if you take
a mixture of two the bit and these are
the best three mixes of two and they're
all a can diet plus a white mica they
can all get that shoulder and you've got
a score called the standardized residual
sum of squares and it's gone from 228 to
55 which is a highly significant change
you know threshold is one point for the
ratio of one point three okay so it's a
very significant thing but one of the
questions that we're grappling with is
how confident are we that say the best
mix of two minerals is a correct answer
posterior problems will be useful but
what are appropriate priors okay so
where we've gone with this well my
collaborators are geologists but they
also have a group of engineers who build
things okay and they've built a thing
called a high logo they've actually now
built several of these and now the
Australian government is funny in to
build eight there'll be one in each of
the six Australian states plus one in
the Northern Territory so mining
companies can go to a central location
because up till now they've been
actually taking them to mind sites and
it's quite a business and they'll have
one of their own and basically it's a
it's a spectrometer mounted on top of a
stage and you take these trays of
all that go on the tray and the
spectrometer moves also that the stage
moves up and down and and the
spectrometer quite quickly measures a
lot of spectra now this is important you
may know Australia's a major exporter of
minerals but most of the most are large
deposit or maybe all the large deposits
we know of the near the Earth's surface
in Australia being discovered ok
and Chinese buying some of these
particularly iron at an incredible rate
so our deposits are going down quite
quickly of of iron ore in particular so
there's a campaign on to look further
beneath your surface several hundred
meters
it's a flagship in Sierre so-called
minerals down under which is funding
part of my time so this is a screen for
the spectral geologists what I'm
actually going to do is just bring it up
so I can show you a little bit better
this is with a smaller data set with
about 18,000 spectra ok this actually
run as you've watched it's actually run
the spectral assistant as it comes on
ok there's other things in here so what
do we see I'll put up another few things
here slider screen
okay so what they do they take all these
trays and for that one site there are
dozens of trays and that they
reconstruct it into a virtual the
geologists actually like to see the
rocks by eye because they used to take
and interpret a lot my eye okay so we do
this but you can actually home in so
that the end of I'm focused now on this
spot here
right which is blown up the pixel is
that wide and maybe this long and you
can see their graves and there are
whites and there are browns in there so
there's a number of different things in
there okay
and four you can also buy this up okay
so what do we have here this is just a
number this is a sort of a color coding
of a spectrum and this here is in the
shortwave infrared identifying what what
the spectral assistant thinks is the
composition so if there's only one it
says I think there's only one and this
is here in the ear light if it's - I
think it's then it gives the two and
says it's a mixture here of sod right
muscovite this is a measure of the error
and then it similarly does in the in the
visible and near-infrared but there's
really little going on there that's
spectrally what we call spectrally
active okay and you can see here for
instance this pixel thousand and nine
it's at a mixture
holy site and anchorite but in fact than
if you can see this but actually saying
it's actually now saying it's a mixture
of three and it's actually another
mixture of three it's a mystery for us
it's miss that little feature which if
you go so it says auto that's it's made
its decision but if you want to override
it and say what's mixtures before it
finds a chloride I haven't got my
glasses on but so you can see part of
the problem we're actually seeing now
things which are mixes of four and we
want it automated a reliable way of
being able to to estimate it
okay so there is a typical drill hole
consisting of 67 drill trays a trays I
didn't bring that one with me
unfortunately and it's got about 60,000
spectra and it actually measures about
you know 500 wavelengths between 400 and
2500 it's about 30 million numbers which
is probably swell not probably certainly
small by your standards but it's still
fairly large but they excite there about
a hundred drill holes so it's a lot of
data to analyze and think and then you
geologists take this and they have these
3d models of what's happening okay and
then of course you can summarize it
information so that's the summary for
these three white markers down a drill
hole and some three minerals called
chloride now talking about the
perversity of geological names chloride
contains no chlorine whatsoever okay but
the thing I want you to focus on here is
it's mostly blue here which is illite
mostly green here which is muscovite and
mostly red here which is finger so
there's a gradual sub change going on
from somebody that's got more sodium
sorry
no ill I didn't it's got sodium and and
and then the substitution of iron and
magnesium in there and you'll see it's a
bit noisy because these are probably
mixtures I suspect a lot of these greens
should be blues so spatial information
that you can use so I'm just going to
briefly talk about current and planned
developments while which is
incorporating spatial context the grouse
classification trends on the previous
slide are probably correct the
individual classification and noisy
should be able to improve the
classifications by using a hidden Markov
model there's a large number of states
say there are 54 minerals but the
materials what's actually grown since
then so you've got 1400 and 31 mixes of
two materials plus the pure 50 for pure
once they've got a 14 85 by 1485
transition matrix and largely with
mixtures of three or four minerals so
you also need to estimating the mixing
proportions there's a computational
challenge there which we have yet to
address another issue which is quite
important which is part of the reason we
I think we have difficulty well we get
things right about 85 or 90 percent of
the time and when we started people said
that would be good enough and now the
customers say well I can see these ones
are wrong by I
you got to give it close to hundred
percent so we're thinking about ways of
doing that but here you can hear what
I've taken is the standards regional
residual sum squares of the training
samples under theoretical model where
they all have the same covariance matrix
the expected value is 100 ok and here
I've taken the individual ones and take
the mean within each class and you can
see there's some classes which are very
hardly clustered more so than others
which is indicative that there are you
know different within class covariance
matrices so actually wanted to to look
at how to incorporate that with the fact
we don't have much data which is an
interesting challenge because that will
give into serious estimation of the
number of components in the mixture
we'd like posterior properties for
classification but what are appropriate
priors we start investigating our one
realization for those of you who who
know about that as an alternative subset
selection that naturally provides
surprise we've also developed a
statistic for determining whether a
spectrum is in the library or not right
we our library is not it's large but
it's not comprehensive and as I said
we're also been doing stuff in the
thermal infrared it will be nice there
issues about you know I've just modeled
the background as a spline with two
knots been asked to be able to automate
that process deciding on the number and
locations of knots for particular
applications okay so let me move on to
the the second part of the talk which is
identification material mixes in hop
spectral image without using a spectral
library as I said building spectral
libraries is a very time-consuming
process currently it's easy to measure
training samples with a spectrometer
such as a Pima which is the size of a
shoebox which is more portable than with
a hyperspectral camera there are large
especially physical airborne or a
microscope also airborne spectra are
distorted by the atmosphere there are
atmospheric correction algorithms but
they're not yet reliable enough to
enable reliable matching they're born in
terrestrial spectra but let me actually
gonna show you something I've just done
the last few days which suggests that
all may not be lost and there's a lot of
interest to identifying Pyrrhus spectra
in the scene as I said they called out
and member some people called blind and
mixing
but in the end it will still require
either a person or a machine to identify
those end members and you see why the
automation isn't is important later on
okay so let me return to that linear
mixture model if you think about from
the air air it's probably the pixel
level it's mixed things are more likely
to be added here rather than
multiplicative but it really doesn't
make much difference for simplicity I'm
going to assume that the background has
been removed so for a pixel I have this
linear combination of my N members and
whether I'm now changed my alphas P so
I'll explain in a minute
but they're non-negative now both now
both the peas and the YZ are unknown and
again we're seeing the area's have a
common covariance matrix so note the
scale indeterminacy between the peas and
the YZ so it's common to assume that the
peas sum to one so that's why I put in
peas as representing proportions it's
what's called convex the convex geometry
model okay so the implications the
convex geometry model if there are M
materials and there's no noise in the
data line side of simplex with M
vertices in M minus 1 dimensional space
the pure materials like the vertices so
if M equals 3 the simplex is a triangle
in a two dimensional subspace if M
equals four the simplex is a tetrahedron
in a three dimensional subspace okay let
me show you just to convey some ideas
and concepts a toy example I've taken a
triangle okay and I've generated a
thousand random points which are
mixtures of the vertices okay I've added
a bit of noise to represent natural
variation or inadequacy of the linear
mixture model now to this vertex I've
allowed pure samples to be retained but
here I've said I'm not allowing Eve more
than 80 percent of this pixel and then
think more than 60 percent of that pixel
to be found in the data okay because I
think actually this represents what
happens in practice okay here are two
existing solutions widely used one
uniform a colleague of mine Morris Craig
is now commonly called the shrink-wrap
algorithm so you assume you know the
number of N
which is a question itself and you work
in some let's say it's M you working at
some M minus one dimensional subspace
and his algorithm finds the simplex with
the smallest hypervolume constrained to
surround the data okay that's the pink
solution okay and you can see the noise
this is the truth the noise can force
the solution quite a long way from the
truth from the to result there's another
one who - Michael winter which is sold
commercials called n finder and it fine
it's a mirror image it finds the largest
type of volume constrained to lie among
the data points and of course it's
problem is it can't get out here there's
no way to get out there okay so we
developed this isoh algorithm a few
years ago
unlike other n member finding algorithms
ice accounts for noise and the data
doesn't assume that for every material
they've seen there's at least one pixel
which consists only of that material
okay so here are some technical details
it's a fairly busy slide it's carried
now so we're out in the space called
minimum noise fraction space which as
you don't now explain shortly was basic
and rather than or sometimes called
noise adjust a principal component space
basically principal components for
directions linear combinations
maximizing variants the mnf transform
looks for direction as a maximizing
signal-to-noise ratio and I'll show an
example shortly it's analogous to
canonical variate space that we use for
the spectral assistant for
dimensionality reduction and d
correlation and actually uses spatial
context to estimate was called the noise
covariance matrix so in that space if
there are n spectra in an image and M
materials in an image you choose the pIJ
and ej to minimize the following things
again it's a sum of two things let me
focus on them on the time this is just
the least squares fit of the model and
it's not difficult to show I've actually
set as an assignment for my students
this week that the solution lies in the
subspace spanned by the first M minus 1
principal components and then any when
you project the data onto that subspace
any solution which totally surrounds the
data has is gives you the minimum
residual sum of squares
right it doesn't matter whether you're
simplex is small or large so the the
Krag solution is one but I could have a
bigger triangle okay that would give you
the same residual sum of squares
actually want to favor yeah what he's
doing is favoring some solutions that
hug the data so if we if we're going to
make that assumption right then we watch
some some measure of the size of the
simplex to counteract the fact that
there's all this indeterminacy now that
these guys use the volume but volume is
a determinate that's computation
expensive I'll use something cheaper
which is the sum of squares of distances
between the vertices why that's useful
is because this thing is quadratic in
the ejs and it's quadratic in the pIJ is
subject to these constraints so you can
actually solve this thing iteratively
quite yeah very quickly okay and there's
a weight parameter a regularization
parameter mu and the closer moves to
zero the largest simplex is and we find
that mucles pointer one appears to work
well in most real-world situations so if
we return to that toy example these are
the solutions I showed you previously
these are to ice our isolation with two
different parameters of the real world
one and one that works probably better
in this example so you can see with the
0.01 this one's almost perfectly
obtained it's a bit short in for these
ones but whether you take point double-o
one this is a bit high but it gets the
estimates is these vertices quite well
okay so just for an example sake let me
show you a simple example in biology
it's it's from a hyperspectral camera
from company in Boston called CRI it's
of a mouse a mouse lung with a tumor
which has been labeled with something
called green fluorescent protein the
mouse was dead when this was done this
is one of the legs of the mouse it's
between 500 and 650 nanometers so it's
in the in the green and the red part of
spectrum it's got almost 200,000 pixels
its fluorescence rather than reflectance
and I've normalized out the brightness
by dividing each spectrum by its mean
these are the mnf images of those 16
images and you can see most information
is in the first 3 mnf
and four and five and then essentially
nothing else so we're going to have a
look at this in a different way but if
we're if we ignored that we said there
are three mnf bands and that suggests
there are four end members okay just
like with the triangle in
two-dimensional space there are three
vertices with a three if there's three
dimensional space here you can you're
assuming four vertices so now what I'm
going to do next is look at pairwise
plots of these first three of the 200
196,000 points in there so this is mnf
band one against two you can see in
crude terms something that's got three
corners but there's something a fourth
thing going out there a fifth thing
going on up there and then there's this
outlier here
so these explain why you have some more
dimensions in there but the bulk of it
is in the first is in the first three so
again for the purposes of
exemplification let's assume there are
only three materials this is the the
tetrahedron that ice will fit okay in
those first three M&amp;amp;F bands and I've
colored each of the edges with a
different color but the same color in
each band so this dark blue for instance
actually lies behind essentially behind
the the data cloud okay and you'll also
note how it doesn't chase it outlier
whereas the other children's I show you
will and you'll see it's also missed
this fifth one as I've only assumed four
and the other thing to note is it's not
constrained along the data points so
that vertex is not the data point so
once you've got those you can actually
rotate you can invert the mnf transform
to see what these things look like right
so this is actually isn't these points
then estimate any members are not real
because they're employed cmf spaces are
not real so you could reconstruct them
what we put next to them is a sanity
check is the points in the data that are
the the the best exemplars of that in
the sense they have the maximum
proportion and what typically happens is
the first few have a maximum proportion
of one that's sort of for some things
close forces a few things usually not
always to be one okay and then we order
them in decreasing order of maximum
proportions this goes down these ten
to look less like their estimated things
and once you've got that you can
actually work out what the purport you
can produce proportion maps or
concentration maps of each of these i
won't going to this except to note that
this one there are just 14 pixels which
have more than 0.5 of this so this is
some sort of outlet might even just
being dust on the screen this is the
tumour and it's useful to look at the
residual sum squares image from the fit
okay and then to look at any of it the
worst fitting spectra and these are the
worst to worst fitting spectra based on
the residual sum of squares and this is
this outlier right and that's the fit so
if you fit at six you probably find this
this is the second worst one this this
didn't have very much quantization I
think it had five bits six bits of
quantization and so you can see the
quantization error in here statistically
it's probably a bad fit but in practice
it's okay okay let me come to a remote
sensing example which I'm going to talk
a little bit about a little bit last one
this is from the original hot
hyperspectral scanner avarice put up by
NASA in 1985 the study from 1997
stands for airborne visible infrared
imaging spectrometer it's of a place
called coop right in Nevada it's a
mining site in Nevada it's actually got
224 images but for various reasons are
restricted to this one of which is the
water bands that's totally saturated and
so NASA have just set them to zero so I
can't use them okay so I've I've used
51 bands between just under 2000 just
below 2500 there at 10 nanometer meter
intervals rather than 2 or 4 there are
600 by 500 pixels you'll see the
variation except I've divided by the
mean without division by the mean to
take out the brightness variation they
all look the same
ok to the eye anyway ok you actually get
much more information about shape by
divided by the mean okay these are what
the first 25 principal components of
those data look like you see this last
signal at the end but even way down here
you've got you've got signal where as we
take the M in s it compresses them
nicely and things broadly are
reducing and sick what we would call
signal quality down to about the 14th
okay which suggests there may be 15
things in there but there are two things
some things actually may be highly mixed
and are very hard to find the other
thing is you actually might be getting
some slightly nonlinear mixing going on
right there actually might be a dozen
things in there but because of the non
slight nonlinearities you're seeing them
expressed in some of these other mnf
bands okay when we're a nice we actually
I'm showing you the result of running
ice with 12 n members and you'll see the
maximum proportions decreasing and they
get down to point five six and then they
drop to 0.34 this might be real but this
estimate is not very realistic looking
okay the problem is when you gets below
of maximum proportion between about
point five point six this is a long way
from the data cloud it's really hard to
estimate and what happens is the
proportion map essentially there's
nothing in there right so essentially
the ice can find eleven things in there
okay well I've done the last few days as
I said in the end you actually if you
want to automate this you actually need
something to to either match somebody
either manually or a machine to
automatically identify these things so
start look at this issue I've actually
seen can I take the spectral assistant
library okay and identify what those
things are because by I I can tell you
that's a white marker that we saw before
and this thing is a candle right what's
got that doublet I told you about that's
got the single feature you don't have
the one further over because that's also
where water expresses itself and so
that's just been zeroed okay so so what
I've done is ovary sampled the spectral
assistants word library from four
nanometers to ten nanometers not just
subset me I've actually take I know what
the shape the approximate shape of the
filter function is it's a Gaussian shape
and I know the width you can find that
from the website and I fit the best pure
materials and mixes of two materials to
each a chair member the results are
reasonable allowing for noise your
average spectra and limitations that was
for it correction use
I should go back you can see in a lot of
these things as a feature here in common
this is actually as a result of the
inadequacy of the atmospheric correction
we think this is a residual carbon
dioxide left after the field so I've
actually removed the first few bands
here to emit this region okay so that's
the best that's the first end member
okay that's in black and you can see
them some there's some funny's going on
up here but it's basically saying you're
getting a good fit of a mineral called
calcite okay very nice fit the more
impure spectra need to be fed this
mixtures so for instance this is number
10 if you take the best fit it's sort of
this is shifted with a holy site but if
you take a mixture of kale light and
fungi it fits this quite nicely there
may be a third thing in there you can
see some little fun is here big gnosis
it is this and here this this these
spectra are noisier and we've been
training with a different instrument and
there's some things that are probably
not now library so there's number four
it's trying to fit opal or opaline
silica and you can see it's not quite
right it's probably something else
that's not now library okay just to
finish quickly there been some recent
extensions of ice last year a couple
papers by Zahra engage on a thing called
spice which stands for sparsity
promoting ice they add an additional
term for those you know about l1
regularization just this is a taken from
that idea and they take for each end
member they take a different wait times
the sum of the proportions if you took
the same one and inverted you yeah the
same one you could take it outside then
you can invert the sum and then there's
some of the proportions for each in
memory is one so it doesn't do anything
so here's a different one and we've
programmed it up it doesn't really work
all that well to be honest it's highly
depending on the application and another
thing which is a very impressive is
called minimum volume constraint
non-negative matrix factorization by
miao and key it extends ice in two ways
it replaces the regularization term
which is
squares of distances between vertices by
the volume which is very impressive but
I don't really think it's necessary and
they also as well as constraining the
weights to be non-negative they
constrain the spectra to be non-negative
but they perform it in the original
space rather than M in F space so they
lose out by doing that
okay the future in the last year I
started working with our remote sensing
group in Perth they do continental scale
mapping mainly for environmental
applications using six band Landsat data
it takes about 360 Landsat scenes to
cover Australia which is roughly the
size of the company in the United States
so it'd probably be something similar
and you get the images need to be
corrected for lighting variation so this
is actually a mosaic with three of those
six bands of Australia that have been
corrected and you can still see some
boundaries you know the boundaries
between some of the the images and in
particular you have problems where for
instance has being cloud cover on a
particular path so if they wait for a
later pass and put something else in but
they need to be corrected mosaic to
ensure consistency in overlapping
regions as I said there going to be a up
to half a dozen hyperspectral satellites
do to be launched over the next six
years the remote sensing group would
like to be able to do hyper spectral
continental scale mapping we currently
work with some high map airborne images
which are just I couldn't it was too big
to fit in here just if you bear with me
bring them up bring up a color
representation of that
okay
so this is an airborne system and it
basically flies up turns around flies
back and it flies up so here are nine
flight lines and they make sure there's
an overlap and that's what's going to
happen with these hyper spectral
satellites there will be an overlap but
not in one direction but in in both both
directions and that each of those is
about 11,000 pixels long by 700 pixels
wide okay so so that's the sort of day
we work with we need to obtain good
estimates the number of n members
interesting so the idea is to do a first
pass of ice in each sub scene okay
and get a good estimate of the number of
n members and then to constrain the next
to run ice again but with a constraint
that the proportions in the overlap
regions are the same okay and I don't
think that's hard to do but you need
good estimates to begin with of the
number of n members in each scene okay
other research focus on greater
automation integration of the spectral
system nice to deal with problems with
some end members are known and some are
unknown I didn't speak about this but it
was its incorporation of baseline the
scalar corrections and dice it because
standard tests don't work because those
things aren't fitted very well and the
incorporation of other constraints into
ice particularly spatial context we
could also do non negativity although I
don't think it's a big issue really when
you do it them in this space that's the
end I'm sorry for a run a bit over time
yes
for the airborne okay well for the for
the for this data set the coop right
data set there is some ground truth
because people actually gone out George
has gone out and actually said this is
what there is okay so you can do that
and there is but there are very few
sites around the world where there is
ground truth but there is a campaign on
to have to develop a number of sites
that people can use for testing purposes
whereas the ground there is ground truth
having said that ground truth is only a
very approximate thing right because you
say I can find these rocks here but if
your pixel is 30 meters on the side it's
going to be a mixture of things okay and
people on the ground they're not going
to be actually to to actually map
everything on the ground they're just
gonna be able to take sample so the
whole issue of how you actually validate
with that sort of incomplete information
but that there will be I think over the
next five to 10 years there'll be an
increasing number of sites that have
that sort of validation but they're very
few at the moment
in the day that I've looked at you know
I don't think I've ever seen clusters
I've seen papers which work on dated
with clusters and you could imagine in
an agricultural scene that you might
find that but I've mostly been working
in real scenes but I'll be working more
with environmental suspect those are
going to be highly mixed as well
particularly in an arid country like
Australia you know where you get you
might get your work well desert is
desert will be I don't know what desert
probably will probably be fairly boring
but quite easy but in those sort of semi
arid zones where you have probably some
sparse vegetation mixed with soil you
know you're gonna get mixtures of soil
and vegetation so I forgot what your
question was about about having possibly
possibly arrived I I don't know as I
said I've not in practical practical
terms I've not seen data that requires
separate clusters but clearly one could
imagine that if you had yeah if there
were clusters and you can visualize
those clusters it shouldn't be very
difficult to separate them into separate
clusters and do and then run that
algorithm on the separate clusters as I
said it's not in my thinking because
I've I've seen lots of datasets I've
actually never seen data did it cost in
fact the data said I give you my course
that it's not quite that it's it's glass
beads on the background and you expect
those to be separate yeah classes and
they're mixed because the boundary
pixels between the individual be there
are seven types of beads the boundary
picks between the individual beads and
the at the background are mixed and you
get a central bit with lines I can show
you if if you're interested it's it's a
rather neat example
it might be that that would work worked
into even without the separation of
classes but anyway I mean you can
separate the cutters first if you needed
to
I couldn't I they're all going to be
fairly similar in terms of their
wavelength range your org at about 200
bands between four hundred and twenty
five hundred nanometers how they're
going to be I don't none of them is
actually being launched by a commercial
organization they're all going to be
launched by government research
organizations so presumably that they
will be reasonably freely available but
exactly you know you might have to pay a
certain amount to download the scene but
I don't think at this stage that they're
they're going to be commercial
satellites like yeah I could be wrong
but I doubt it
thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>