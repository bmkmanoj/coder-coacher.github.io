<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Scaling the Internet routing table with Locator/ID... | Coder Coacher - Coaching Coders</title><meta content="Scaling the Internet routing table with Locator/ID... - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/GoogleTechTalks/">GoogleTechTalks</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Scaling the Internet routing table with Locator/ID...</b></h2><h5 class="post__date">2007-10-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ezjh1m6G2ek" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">I got from everybody
it's my pleasure to introduce Dino to
Google Dean has a fellow at Cisco
Systems minute Cisco since 1991 it's
been building routers for 26 years been
active in the IETF for 19 years and you
probably have seen his name on multiple
RFC's post by the IETF and various
standards he was also a co-founder of
pocket networks that was bought by cisco
systems so i was a little bit of a
detour for dino around 1999 of course do
you know its intimate knowledge of most
writing protocols he's particularly a
specialist in multicast most notably
today he's going to talk to us about his
latest protocol draft Lisp and just as a
matter of housekeeping this will be
published externally to google video so
if you can hold your confidential
questions at the end and they'll just
edit that off so please join me in
welcoming denote to Google so we've been
we've been trying to fix routing in the
internet and this is a proposal that
we're going to focus on called Lisp and
we think it's a we believe it's a level
of indirection that's going to possibly
help things gotten a lot of input from
service providers and hosting vendors
and content providers like yourselves
and we're hoping we're in the right
direction but we this talk is good not
only going to benefit you I hope but
it's going to benefit me by getting
feedback so it's a it's a fairly
technical talk and you guys are actually
the first ones that are seeing some of
this content especially the mapping the
mapping service content down here this
is basically does this thing work yeah I
just can't see it so based on all those
large numbers you gave I'm getting old
that's why the numbers are large right
but anyways um so the mapping service is
pretty new new meaning it's just weeks
old and we almost are going to get it
down in in spec form in the coming weeks
trying to get it available for the ITF
in July so you guys are really the first
public guys that are seeing this so it's
pretty fresh and a lot of a lot of new
ideas and a lot of ideas from previous
protocols
architecture of the past but what we'll
start off with a problem statement look
at the solution space with respect only
looking at list as the solution there's
other solutions in this space called
shim six hip and GSE which we're not
going to explore at all we'll talk
briefly about the categories or classes
that they fit into but we're going to
just focus on list because that's the
work that that I'm working on her we're
working on so the we want the basic
problem same as we want to help sites
large content provider sites that are a
huge bandwidth sites and Internet
service providers we want to do reduce
op X and capex I'm personally very
worried that all kinds of vendors are
pricing the internet too high and we
need to make it cheaper so I'm looking
at solutions that reduces protocols so
it can reduce operational expenses and
try to build cheaper systems I work in
the dc-3 product area at cisco and we're
trying to build a high-density low-cost
switch / ship router and i'm all the
challenges that are associate of really
making it low cost so we're worried
about capex as well as op x we want to
introduce some addressing flexibility
hopefully hopefully a live allah a level
of indirection could solve some of the
problems that we're seeing in the
internet and we may this solution may
introduce some forms of mobility but
we're not totally sure if it's going to
scale there's a lot of large tables in a
very small number of places in the
network that would be needed so would be
interesting to get your feedback so we
think the solution space is address
splitting an address splitting through a
level of indirection and I'll get into
that in much more detail and it's also
been oh so these are kind of all the
cliches this is known as a jack-up model
okay where you take the protocol stack
as is you jack it up and you put stuff
underneath it and we're not talking
about putting a layer to infrastructure
underneath it like ATM or anything or
sonnet or anything like that it's
another network architecture underneath
it and the lisp solution is focusing on
a network based solution versus host
based solutions and we'll talk more
about that and then i'll describe the
data plane and then what i call the
control plane is the mapping service
okay so operationally what we want to do
is we want to improve site multihoming
and we want to improve isp traffic
engineering as well we want it to be a
little bit more flexible not have to
depend on mpls because there's their
solutions in IP that can work as well so
if you don't mpls is not the only tool
in the toolbox we want to reduce or
eliminate completely sigh tree numbering
IP address renumber numbering we want to
be able to eliminate if we can and we
want to reduce the size of the core
routing tables at the same time so we
could bring those lower cost forwarding
chips to you and then price per port
goes down because of that P I for all p
I here stands for provider independent
addressing so sites may and we're seeing
the registry starting to allocate p I
blocks to customers which means that the
customers are dresses don't fit into the
topology so it's composed addresses are
completely unattainable when they're
under gradable that means the internet
will eventually be flat routing at the
slight level everywhere will that be
able to scale does this make sense so
this is the nervousness that's happening
and the urgency to put something in
place to solve that and mobility is
going to be hot we have some form of
mobility that may be a locator ID or a
level of indirection can solve and you
guys could judge that so architectural e
what we're going to do is it's just one
architectural concept that we're going
to introduce here and it's we're going
to take the address and we're going to
split it into into an ID and a locator
and throughout this presentation
wherever you see green numbers or
letters it's referring to the ID
wherever you see red letters is
referring to locator addresses and we'll
explain how all that works this effort
was provoked at the Amsterdam I be
routing workshop last October and people
said it's been ten years and we haven't
solved the routing architecture problem
we went from ipv4 to ipv6 but the only
difference is a packet format change in
the address length change nothing else
is really different so we really need to
look at the routing architecture in the
capital I Internet as a whole so these
are some references on where you can
look at the problem statements I've been
thinking about this problem for nearly
ten years now and I'm ready to start
working on a solution so that's what's
motivating me so I started working on
this last November and so what you see
is about a six to nine-month effort up
going input that's in place and
continuing
so sites and I ISPs cannot control
ingers traffic paths they can control
which way they send packets out and at
their edges they can decide where to
send it but to be able to get packets in
it's the upstream guys that use bgb best
path selection that decides which way to
get to you so you can't control which
way packets come in so since you can't
control which way they come in but you
can't control which way they go out you
just basically have this wash sort of
agreement with your peers you say if you
send me too much stuff over here and I
don't like it over here I'm going to
send you stuff over there which you
don't like over there so we want people
to be able to control their egress as
well as ingress pals and that's both at
the site level and at the ISP level okay
the only way people can do that today is
by injecting more specific routes if I
want to be able to attract all these
flows and I just send the one aggregate
this way they can only send it this way
because they believe this path is not
available but if i say i want to punch a
hole in that address space so i can get
an exception of that block to come this
way i inject a more specific route while
injecting more specific routes into the
internet is not a good thing because it
grows routing table sizes so we're
finding that traffic engineering is
affecting the size of the routing table
and we're losing the aggregate of a
aggregate ability of the network and it
requires large tables lots of meshing
and we're having problems managing that
you get what you want at the expense of
everyone else you inject the more
specific route and you don't care
because what happens is you get the
paths this way but since you injected
the more specific route it continues to
flow wherever needs the flow in the
internet and everybody pays for your
traffic engineering benefit okay and we
suffer from routing table bloat what is
happening at the same time is the
registries as I mentioned are giving out
a dress p I address blocks and those p I
address blocks are causing routing table
blow to I don't want this presentation
to say that the routing tables are
getting too large routers can't support
them therefore we need a solution we
really the amount of multi-homing that
is increasing in the internet needs to
be solved and when we solve that we will
also make the routing table scale at the
same time so the IETF seems to want a
big problem statement before they take a
solution seriously but I also want
features while I'm solving problems at
the same time so I don't want that to be
misunderstood sites like blacks for two
reasons it's the same reason why you
like your cell phone number and if you
switch providers you can keep the same
number for the rest of your life you
don't want to have to change you don't
have to tell anybody about the new
number you don't have to renumber house
inside you're inside your site so if you
get AB new P I block Yuri number all
your hosts and routers one time and you
never have to do it again that's that's
the mislead impression that a lot of
sites are getting right now registries
want to sell address blocks so they're
motivated to sell them so why not I
don't care about the internet at
somebody else's problem right p I box
injected a core gives you flat routing
major routing table bloat again that
mobility hmm mobility is pretty hot
right there's a people are throwing down
around hundreds of billions of dollars
worth of revenue to solve mobility or to
provide mobile solutions not only in
just handsets but applications I mean
you guys are very aware of this so low
latency what and doing quick hand offs
are very important as well how do you do
that when your address when you when
you're at Google and you move to the
starbucks do you want to keep Google's
address does it matter if you want to
keep your sessions alive all these sort
of things or questions you ask for
mobility we think a level of indirection
with a locator ID split can help this
problem the question is can we make it
scale that's always the question so the
solution space is that let's don't let's
stop overloading an IP address that is
the problem it holds semantics for both
identification and location we need to
have something that says this is me Dino
and right now I'm at Google where this
afternoon i'll be at cisco or I'll be at
my house those look those latter three
locations are things that are changing
frequently or can change frequently in
the case where you're changing from one
isp to another that's a subscription
time change that changes less in
frequently than me on a hobo mobile
handset or me taking my laptop closing
it and moving somewhere else and opening
it up arguably we've done that already
but when you move and you close your ID
and your locator changes at the same
time and you do lose your TCP connection
you do not lose your google session but
you lose your TCP connection right so we
need a decoupling for some flexibility
and the big question is should this
saw that the routing labor that the
routing layer that's that's a question
that deserves asked to be asked or
should you solve it at a session layer
and you guys have done some work on that
where you solved it at a higher level it
remains to be seen if we can do that and
scale the internet as we know it today
not sure if we split the addresses we
could solve these problems so if so the
solution space says let's split and it's
been affectionately known as an ID
locator split so you have this kind of
address and you either have two
addresses where you take part of the
address and you split into separate into
separate pieces there are host based
solutions and there's network based
solutions the host base alysha solutions
was run shim 6 you put a shim layer
between TCP and ipv6 and it worries
about changing the locators while the
TCP connection stays up a lot of
negotiation a lot of lot of dynamic
stuff going on people are a little bit
scared of that hip is another way of
doing it but rather than using assigned
ipv6 addresses the Eid part or the lower
eight bytes of the address is a
cryptographic hash and that's used as a
as an ID and it's also validated to be
you know you are who you are because of
that validated hash so the hash just
passed around and then you could build a
public key from that and then find out
that if done is if somebody is talking
to me with this Eid and it looks like
Don's I can use that as a hash and
figure out and if I go find a public key
and say that this hash matches that
public key then I know it's Don who's
talking to me no matter where he's
moving ok that's the kind of the idea
with hip another host based solution
sctp is a TCP replacement so to speak or
UDP replacement where the connection IDs
are in sctp so now the IP addresses as
you use our only locators and they're
not connection IDs because the session
idea or a connection ID is being handled
by a ctp those those three are probably
the running candidates for being able to
give you a locator ID split network
based solutions Mike Odell had this
thing called eight plus eight that
evolved into GSC where it just basically
said that you could split an ipv6
address into two parts and the routing
goop or the high order part would be the
locator in the
autumn would be the would be the locator
the higher part would be located the
bottom part would be the eid and the
routers at the edges would then fill in
depending on which way you wanted to
exit Lisp is using a Mac map inning cap
scheme which I'll describe so those are
the basically the classes and so we're
looking at i'm looking at a network
based solution because i wanted it to be
incrementally deployed and not have to
change hosts so splitting an address say
we have an IP address like this like i
just mentioned the GSC scheme said this
would be the the eid down here this
would be the ID here and this would be
the locator and if a host would it emit
a packet it would have to say where the
destination is because then because this
is telling you where its current
location is so the routing goop they
call this routing group that would have
to be part of a DNS entry ok but the
source address of this packet that's
being sent out could be filled in by a
network device and so the return packets
can come based on that that that address
so an ipv4 we have this kind of address
and we can't split it up the same way
right so what we could do though is
today it's known as a locator but it's
also used as a hash to find the TCB when
TCP is looking for when incoming packets
are coming in and trying to associate it
with a TCP TCB data structure this is
what TCP uses today well if we can add
some more bits we can then have a
locator ID split as well ok but we don't
have enough bits in a single header so
what do we do so ipv6 could have a
different solution from ipv4 right GSC
is rewriting the routing goop stuff and
then the mapping cap scheme which has a
separate address that's maybe somewhere
else in the packet can be used for ipv4
so GOC is kind of a net-like approach
but Lisp is a map in ink cap approach
Lisp well actually one network
architecture can be solved for v4 and v6
and that's kind of where we're going in
the case of lists it's we're calling it
jack up because you have this protocol
stack as you see it today and what's
happening is just you're just putting a
new network layer underneath it and
everybody's going to say oh that's just
like tunneling and the answer is yes
this is what it is
it's dynamic tunneling that's not
interface space tunnel zero you know
tunnel destination blah it's not that
they're not static configured tunnels
okay and that's why we loosely call it
encapsulation and what we do is the host
stack operates here so the host emits
packets up to with that network layer
header so it all it knows is about IDs
and then the mapping and cap scheme will
then all it know about locators so when
you see a packet that's on a wire inside
mi SP the outside header has locators
the inside header has a IDs so some of
the list goals are is we want it to be
incrementally deployable Knossos changes
whatsoever there's no host changes to
make this work there are some
modifications to a small number of
routers but these are routers that you
will have to deploy new routers you have
to deploy you don't have to change your
igp routers or your core routers at all
okay so it is a modification of the IP
architecture it's not a enormous
redesign this is looking at a short term
solution and I'll talk about later that
this solutions being done in the IETF
we're more advanced routing architecture
changes are being proposed in the I RTF
in the routing research group so we want
to minimize require changes to router
hardware and software I'm getting a lot
of requests from people that this may
not be the case because we have to
change encapsulations to do different
things I'll explain that later but we're
trying to keep the amount of software
and hardware to changes to a minimum
support both v4 and v6 together and fast
time the deployment I told the IED that
we should be able to get a pilot one
year after that routing workshop and I
would say right now we're pretty close
to that goal we have running code we
have to decide if we could actually get
in people's hands in some decent product
form somebody anybody can get in some
decent product formed by that time so my
goal is October of this year to get a
pilot deployed some of the list parts
I'm going to break up the talking
between data plane and control plane the
data plane is the design of the
encapsulation and tunnel router
placements and
94 located reach ability is a locator up
or down even though you know that its
associated with this Eid and it's a data
triggered mapping service the control
plane is a design for a scalable mapping
service and that's what's brand-new that
that nobody has seen yet we have these
variants for Lisp and we did this not
well we did it for two reasons we
couldn't make up our mind we didn't know
what was the best solution and we wanted
to be able to phase the implementation
to get experience so if you so list one
basically says we are going to have
routable ids over the existing capital I
internet to pro for a mapping reply and
I'll except through an example let's 1.5
says when you're using P I addresses
nopee I addresses will be in the core at
all but when you need to trigger a
mapping reply you send these packets
over a lower performing smaller topology
that's not congruent the capital I
Internet it's another tunnel topology
that basically is an ARP request over
the internet if you will to get a reply
back lifts to says dns this is already
thrown out nobody wants a circular
dependency between dns and routing so we
probably won't use this Li Jie Zheng at
UCLA is trying to use DNS to the
protocol but not on port 53 to be able
to do I eid two locator lookups but it's
going to be a coma it's just using the
packet formats and the protocol and
existing code but it's going to run on
another another configuration topology
and another on another port number and
then list three is interesting this is
saying well let's build a new scalable
database let's make sure that II IDs
aren't routable mapping serve tamed by
using some new mechanisms and I've done
a lot of research on distributed hash
tables to see if they can work their
kind of interesting things but they're
really dynamic and in an anti
third-party ISP world they probably
won't work all the researchers are
telling me to stay away from dhts I
don't know if you guys have experiences
at the routing layer dhts weren't good
at the peer-to-peer labor because you do
have this that you have disabled the
stable substrate on the bottom that you
could depend on but when dhts are
changing and it's affecting your your
packet connectivity then you have a
problem so soulless comms is the control
plane that we're going to introduce
today and Elliot Lehrer has something
from Cisco called nerd which is
basically
an Etsy host type thing where you
actually use HTTP and you push the
entire table out to all these boxes and
the mappings will always be there so
this is definitely a push-based
host-based ftp based the love of a sort
of thing and list cons is a hybrid of a
push-pull model that we're going to
explain in a second so some quick quick
list turns and we'll get to it we're
going to call the the identifier Z IDs
and less and the ids are used are used
by the host and our routable in source
and destination sites okay so the the
actual ID are in packets but when the
packet has to flow to the router who's
going to perform the encapsulation that
idea is being routed at the same time
it's also being used as a as a
connection ID as well sure question a
site is a site in my definition is a
multi-homed stub site a multi or single
home stub site okay and i would put
google and the yahoos of the world in
that classification okay routing
locators are the routable addresses out
of PA space okay these will Pope most
likely be out of pie space this will be
out of provider assigned Bay a provider
assigned space and we call those locate
just we call them our looks or just
locators and then we have these ingress
tunnel routers at prepend headers and
egress tunnel routers that that strip
headers okay pretty straightforward so
let's look an example so we have the
source site on the left in a destination
site they have been allocated by a
registry that you're going to assign all
your host addresses Annie I in the Eid
prefix 1 / 8 so everybody is going to be
assigned those addresses and in the
destination site it's 2 / 8 you deploy
these ITRs and etrs ingress tunnel
routers in egress tunnel routers in this
example what I'm going to show is a
packet only going in one direction from
source to destination so these these
guys when they when packets come back
there are also etrs but i'm just showing
it for unidirectional okay so you notice
that they're green so there I IDs these
are red so they're locators these are
actually IP addresses that are assigned
to the et
ours they come out of the blocks that of
their attached providers okay the the
actual locator addresses for everyone at
the site are those two addresses and no
more so now sites don't have to allocate
/ 24 / 16 / 22 s whatever the site they
only have to allocate 248 addresses to
the site they could reclaim a lot of
space that could be a benefit okay and
these guys don't have to run bgp anymore
they really wouldn't have to okay since
these guys are allocating these these
addresses here the aggregates that they
advertise for all the sites that they
connect to our just advertised back this
way so that could be a simplification
just starting off there so let's say
let's say s wants to talk to d and in
DNS there's an IP address on a record
that's 200 to that is an ID that's the
ID of d okay if d ever moves that's
still the idea of d okay and let's say
the internet the itrs already have
cached i'll tell you when they don't
have cash to what we do but if they
already have cashed that the ID prefix
to / aids associated with this site that
the locator said are these two locators
and they're each each have a priority
they say use an equal priority with
equal a load split them so this is the
IP address of router d1 in router d2 and
that's the mapping entry let's say for
this example those two ITRs already have
that entry there okay so a packet is
then sourced by the source it originated
it without its eid which is 1001 going
to d's the return from the dns which is
2002 it puts that on the network just
like it does today there's no changes so
far to the host there's no changes
whatsoever so that packet actually is
going to follow the default to the c/e
boxes right that's where I said that
this a ID now is routable within here
but it's a scoped routable address and
routing it here does no harm because
we're trying to protect the capital I
internet there okay so that's good
because you don't have to actually
reallocate today if you have this site
your addresses that you're using today
could be used as IDs if they're p I
blocks or PA blocks you could use them
today as IDs nothing at this site
changes
other than putting new software in these
two boxes okay that's really important
incremental deployability is key so it
happens is the packet makes it all the
way say the default route is taking the
hat the hash of these two addresses
taking the default throughout this to
this place so what s to does it says oh
I just get a packet that's me it's
either matching the default route which
means i'm sending it out or there's no
route found at all those are the two
triggers that say i need to encapsulate
i'm going to do is I'm going to put my
locator which is going to be 1100 one is
1100 one out of that address space and I
know if I do an eID look up on 2002 I'm
going to find this entry in my table so
what I'm going to do is I'm going to
pick one of these two to encapsulate to
be the destination locator so I'm going
to use 2002 and then I'm going to ship
that off of course everybody in the
internet knows where 12 / 8 is its
provider ex is that's his address block
so there's no the ones the one flat
shading 2 / 8 is we've been removed from
here that's good routing tables get
smaller so packets just get routed
through through into 12 and then when
the packet comes on this wire here it's
still encapsulated now since this IP
address is the IP address of this guy
there's very simple code already in
routers hardware switching routers that
say if it's addressed to me I need to
peel off this outer head or if the
protocol types a certain thing if it's
GRE or l2tp or whatever so this guy
already knows that he needs to peel this
off he will peel it off and then he'll
then route to 2002 and then this ID is
routable within here so the igp takes
over there and so that's the fundamental
concept of bliss data plane we're using
dynamic encapsulation and the outside
addresses or locators in the inside
addresses or IDs any questions at this
point yeah Vijay
all done
I couldn't even hear it actually what if
s in deep here let me hold that off
until the ISP traffic engineering
example because that's more applicable
for that go ahead future slide anything
else okay so let's look at the case now
where s sends a packet and there is no
mapping in the ITRs for the two / atid
ok so in list 1 what we say is what
we're going to do is when there is no
mapping what we're going to do is we're
going to copy the inner ID to the outer
address and then we're just going to
route it along here we can do that if
we're using PA addresses for IDs we
should not or cannot do it if we're
using P I addresses ok so if we're using
P I addresses and we pull them out of
the internet then you have to use this
other variants of 1.5 saying have this
packet get right in some other topology
okay it could be another verb it could
be another BGP topology but find another
way to get the packet to these guys so
they can respond back ok so the package
gets routed through here in the case of
Lisp one variant it's going to be routed
through here this guy receives that
packet he sees that the inner and the
outer addresses are the same which
causes him to he D caps sends the packet
and it causes in the scent of mapping
reply in return so what happens he sends
a mapping reply from himself 1200 to
back to the outer source address saying
this to slash atid maps into those two
locators equal priorities equal weights
ok so what it would be nice here is if
the ITR could actually have all the IDS
of the world in there so would never
have to route this thing over or if it
could request it and get a reply back on
demand it would be nice as well so what
have to store everything so the nerd
idea says push it everywhere so this guy
never takes any ID look up fault it'll
always be there will be stored in nvram
it's going to change once a day just
send it everywhere if you do a request
reply protocol then its treated its like
the traditional art problem what do you
do it the first the first end packets
until you're waiting for the reply to
come do you drop them on the floor do
your cue them nobody ever accuse them
because it's insane right so you drop
the packets on the floor so the question
is do you drop the packets on the floor
and go send a request or if you actually
use the data packet and try to make it
on a lower performance path to get the
packet actually 2d so that initial sin
message this is the first time s is ever
talking to d so the sites don't have
each other sites eid prefixes so what's
happening is this guy could send the
very first sin packet if you're adamant
about getting it to this guy on the side
you have to route it using this but I'm
calling a data probe either on the cap
light topology at 1.5 now my personal
preference is we're going to throw out
Lisp one because we want to be very
strong about removing unnecessary routes
from the core so we're going to use
either another topology we're going to
use a list three point 0 mechanism where
we're going to have a different mapping
database okay
do you wanna receive the packet it's got
an 1100 122002 so why did you just go to
the back with autism how did you know
there's something in that head of it
says this is a packet in it it knows it
by looking at these two addresses seeing
that they're the same looking at the
protocol number is UDP and look and that
the UDP port number is Lisp that's what
it does and that arguably could be a
host change or a hardware change but you
could also put a 200 / 32 in the fib to
bump it up which is dangerous because I
mean this guy would have to store host
routes here or you could put a more
granular route in there to cause it to
be popped up that's not going to
interfere with the ospf route that's
going to get you there ok but if
architectural e the best way is to do
with my first answer was to you is to
make those four checks is in or equal to
outer is it UDP is it a list destination
port if so do this and we also have
announced in the UDP packet because we
don't want to eat ER spoofing as well
we'll look at the packet formats in a
second but we wanted to give you the
basic flow first so the benefits of a
locator ID split locators come out of PA
space so we have topologically aggregate
able addresses once again I hope that's
not a naive to want to go there but
let's give it a shot right eid s come
out of P I space or registries could
still make their money sites cannot now
don't have to renumber this is a good
thing locators can change while you di d
stay fixed so your your mobile device
will have an eid that's based on where
you bought it or what service provider
you're using that wants to allocate your
IDs but the locators will change as you
move when you do is pee changes no
renumber that's probably where we're
going to go first at the high end side
where we really want people to be able
to have the flexibility of switching
service providers without getting stuck
like they are today they're stuck today
because they can't remember and for VPNs
they're stuck because of 2547 they're
stuck on one isp they have no
flexibility whatsoever so I'm trying to
fix both those problems actually so
roaming no chart no changes the idea
gets session survivability because as
long as the ID stays the same the TCP
session stay up check something works
tcp pseudo header checksum works because
you're using it on these fix things that
don't change this is goodness ISPs only
need to allocate very small number of
addresses the sites we mentioned to that
I don't know I don't know which way that
which way we should encourage it to go
it's a good question if they use PA
space they don't really own the PA space
because if they leave the service
provider they're going to want their the
service prior it's going to want their
addresses back so right yes is it true a
new paint OPI space well we confer to
get the simple answer off the table we
don't have to worry about this for ipv6
and then we'll say okay now we don't
care about ipv6 what about ipv4 right I
don't know what's going to happen there
I mean I need you operational guys to
help me with that or at least think
about it or explore possibilities and
you know here the gotchas and here's
where the economic model is going to
change because of this blah blah blah
you know so I'm not totally sure so the
list data plane the encapsulation format
was IP and IP but we just changed it to
UDP the dash 200 spec is IP and I piece
of you if you get back to your offices
and you look up Lisp you're going to
find the original version we're going to
publish the dash 0 1 in the next week or
so but the implementation we are we
already found problems with a design
from the implementation so we're already
fixing the design because of it so we
decided to go at UDP encapsulation for
these really important reasons we want
to be able to get through reflexive
access lists based firewalls we could do
that with UDP that's not the most
important problem ok we want the ITR to
hash on the inner header to produce a
random source port when it encapsulates
so the core router that's all the way
down there that has a lag can still hash
get even load splitting across the
members because that box can only hash
on the outer 5 tuple which is the source
destination and then the UDP port
numbers so where the ITR is going to aid
the core router to be able to to get
good usage of your lag and we need to
carry an ounce in there for anti
spoofing we're going to trust that if
that data probe PAP it gets to the ETR
and then the ETR responds back with a
map reply with the nods we're going to
it's called trusting the network versus
return route ability and that's we're
going to use a lot of we spent we list
would have been out a lot faster if we
don't have to worry about security right
and you go to all the security experts
and you say you need this this and this
and I'll say ok we we need a peek at pki
you need a public/private key pair you
need a distribution mechanism to do all
this stuff the security stuffs just a
total mess and nothing could ever get
deployed if no but nothing can get
deployed without it they say and nothing
can get deployed if you try to put it in
because it'll just take too long so we
decided to not we didn't want to depend
on the third party pki because how do
you do that you don't want to have state
between the ITR in the ETR right so you
have to and you have to if you want to
trust the mapping service then you have
to be able to maybe the mapping service
itself is a pki but do you want to have
a separate pki and the mapping service
and the and the millions and tens of
millions ITR ETR flows going back and
forth so so we're you'll see how we're
going to skirt or avoid the security
problem by using a train at a chain of
trust in the map reply in the mapping
database model what we also put for the
UDP encapsulation was the reach ability
bits and this is how we're going to I
think the hardest problem out of all
this is not the mapping service and
making it scale it's determining reach
ability because what you want to do is
now that you know you have two locators
and you're selecting one versus the
other or your load splitting based on a
hash you have to know when one of them
is unreachable and it's unreachable for
a variety of reasons the path in the
internet can't get there which is
extremely unlikely because I like to
think that there's enough messiness
enough for busting the internet that you
could probably get pretty close to the
PE that's attached to the site so what
normally fail
is the link the PC link fails or the
router that fails or actually because
you're running 2547 the Pease always
crashing that's another reason too so
but the CD box can fail on the site side
the PC link can fail or the PE can fail
so I wanted to optimize for those sort
of scenarios so we had to put bits in
there so this is what the header format
looks like so you did I put any okay no
I did so this is what this part of the
header is the IP header that the host
builds there's no surprise everything
looks the same we're just changing the
semantics of the destination and source
addresses and we're calling him eid
instead of addresses the term address is
too opaque to general too vague whatever
so we don't want to use that anymore we
want to put specific semantics to it we
try to just keep the as small as we can
list patter so we put in a 48-bit nonce
and we put in twelve bit reach ability
bits in there so there could be 12
locators per site I'm worried about that
there might be too small if it's too
small we'll make it bigger there's
plenty of bandwidth I'm not going to
worry about overhead if we can't support
what we need to support UDP header is as
you know it UDP checksum sent 20 on data
packets destination port as the packets
being encapsulated from ITR to e TR is a
well-known port well-known port that
we've already allocated from Miami used
for data packets and mapping replies
we're also going to use it for the
mapping service with TCP then there's
this is what the ITR puts on which is up
says UDP follows but the dress is here
are the locators I already mention that
that should sink in by now so let's
first talk about locator selection and
then I'll be able to answer your
question about located reach ability ok
so each mapping record will be an eid
prefix not an individual / 32 or / 128
so we can get some aggregate ability out
of Eid prefixes by saying a site has one
or a small set of Eid prefixes so we're
assuming that the allocation is not flat
or using CGI script 0 graphic generated
addresses we're assuming that it's going
to be you know some people said can you
use in a couple class a's can use Class
D those sort of address I don't know if
class t is kind of interesting I mean
that class d class E is kind of
interesting to use but the problem is is
there a lot of hosts tax
that fail Martian checks when they look
at that address and they see it's a 241
111 and they may not do the right thing
so I'm not sure if we can use that yet
but let's just say for now that each
site for the most part can have a single
d ID prefix your traditional multi-home
site site okay the you know I'm seeing
the comcast of the world that Google's
that Yahoo's the world won't be in that
class they'll be in a much more
demanding class as you would guess so
those those addresses be out API space
and then the locator list would be a
locator with a priority in wait so
depending on how many locators that's
what we call a mapping record we want
the ETR to control the locator use so we
want to be able to say that if you're
going to send me packets I want you to
send it on this locator more so than
this other locator and the reason you
want the ETR to control this because you
want to control the ingress traffic
engineering so what you say is i route
this is this is an underutilized link
and when this gets to ninety percent
nobody uses this link or so what I have
to do is if I can if you can do a 9010
sort of thing then you can use this link
or not overload that link and only use
this link if this link goes down okay so
what happens is if you make the
priorities all the same then the ETR is
telling the ITR is these are the
valuable links you can use that I want
you to use and you can decide within
them which you want to use so the ITR
also has some control as well so there's
some flexibility there now for mobility
you may want to glean you might want to
glean when you get a packet in and
you've never talked to that guy you
might want to take the source locator
and store it and associated with an eid
and the knee ID prefix so then when you
send packets in the other direction you
don't have to do the lookup or if that's
an exception list to what is in the eid
mapping for the mapping service you
might want to use as an override right
if Don is sending me packets right now
and his eid is out of the Google space
and his locators are for the locators
that Google for the ISPs Google's
attached to and Don starts driving and
then and goes to starbucks and now start
sending me front start sending from
starbucks I'm going to see that his the
IDS
coming in from a different locator than
what I have in the mapping database the
mapping database tells me that Don is at
Google and here the set of locators but
i just got a packer with a different
locator there that might be a Roma event
on an insecure Rome event but a Rome
event so the ETR could have these
exceptions it's not host routes
everywhere it's these exception routes
only in the ETR can we make this work so
we're front trying to figure out how
fast of mobility we want list to solve
and right now we're claiming slow
mobility so camera slow mobility ok no
fast mobility ok so locator reach
ability that was one of the questions
it's imperative that located reach
ability is not in the mapping service we
want the mapping service to scale and so
we can't have changes that happen often
so we're saying that the mapping service
has a subscription time mapping where
when you set up links and you do you a
dealer allocations that's when you put
in the mapping service it probably
shouldn't change as often as dns entries
less often than dns entries ok
you you have to decide that for large
equivalence class of flows that's going
to use one list time versus different
list uh no if that information needs to
be in the mapping service or is it just
plain old static that's all you have to
decide right now the mapping service
that's provided there doesn't need to go
in the capital I mapping service
infrastructure it could be a map reply
that's does this data triggered thing
because you see we have this data
triggered way with the map reply and
then we have the mapping service way the
control plane way so we have to really
figure out look at the really gory
details to figure out what's the best
suited for the traffic engineering piece
so how do you know a locator goes away
we're assuming that locators that are in
the record are all reachable and let's
let's say that the glass is half full
and we keep it reachable we use them
what you want to find out is when they
go unreachable well you might we're not
going to depend on it but you might get
ICMP network or host unreachable
messages back from somebody in the
network well usually it's not going to
happen for two reasons one reason is if
a look if a locator goes unreachable and
it's probably not going to result in an
unreachable message going back at this
box because that that address has been
aggregated so really in the core of the
network nothing goes away and there's no
opportunity to send icmp unreachable if
you think there's an opportunity to send
it everybody configures to turn them off
so so so I'm not going to depend on that
and that's in the middle of the network
was something going reachable really
like i said the CP link the see box or
the PBOC's is going to go down okay and
that's why we're putting these located
reach ability bits in the data header we
want return traffic to tell you what
about the reach ability of the etrs okay
so they'll think of it this way i'm an
ETR at a site and scott's an ETR at a
site right we both know if I were
rejecting default route into our igp
right and it's usually based on having
this interface up to the ISPs if one of
those interfaces go down we withdraw our
default route so i will know that if the
PE link goes down from scotts point of
view or scott crashes me and my IGP will
know that Scott's not around when i
start encapsulating package because now
everybody's gonna be sending me data
here because I'm the only default router
right so I'm going to be getting packets
here and I'm going to be encapsulating
as a nice
our to the destination sites wherever
well everybody who's gotten the previous
mapping for us I'm just going to say
that okay I was ordinal zero you were or
into one so we're going to set bit one
in bit too so the value three we're
going to send across when Scott goes
away i'm going to set the bit one just
saying that when they're going to look
and say ah there's this bit string
that's describing the reach ability of
all the locators that have been
previously advertised to me there's dino
and scott is in the list that there was
advertised me Dino is telling me scott's
not there so the ITR once encapsulate
data back only uses me so its data
playing piggybacking anybody so the
person who did you ask a question about
reaching really did it that satisfy your
answer okay so I'm selection okay that's
what was based on this slide maybe I
didn't make it clear enough but you know
I didn't I didn't say anything about it
so what happens is I give you a map
reply you have these lists of locators
you will look and only use the high
priority ones if you have more than one
high priority one you'll use a hash if
you want to road round-robin them
against it if you have a policy to say
only use one you can use one the one
that you decide to use must be up based
on the advertisements the piggybacks
coming back and so if there's something
like let's let's keep it simple let's
say there's one 1 two 2 three those are
the priorities you have allocated as one
1 two 2 three so the ETR saying that you
can only use the first two and only if
the first to go down you can use the two
that are in priority level two and you
can decide if you want to load split
across the to use one versus the other
long as they're both up you can do
whatever you want as an ITR ok if those
two go down then you only could stay
within the two so that's how the
selection is done so this is kind of a
not so sophisticated very loose form way
of doing some policy but not going over
overboard so let me know if you think
this is sufficient
yes it follows the default route as it
does today to the edge of the network
because because the destination address
that the host put in the DA field
there's no specific route if there is a
specific route and it's if you're bgp
inside it'll follow the shortest path
out and that egress box will actually be
the ITR and prepend the header if it
doesn't have the more specific route it
uses the default to find the edge yes
and that's based on your igp policy on
how you want it to exit your network
what you're using today will be the same
mechanism you use for this it depends if
you have more specific routes injected
in your IGP or you're using equal using
active active active default routes
using active backup but it's going to go
one way and if it's from P I space you
won't be able to because they won't be
there good point so you can only resort
to the default route inside the igp
routers yes
in a multi-homed site a stub multi-home
site you will go to the shortest exit
okay you're trading egress no it's not a
trade-off it's not a trade-off no okay
so so this is google talking right did
google wants to inject all the routes
into the ISP into your site if you
inject into your site and you have
locator dresses that are in senior IGP
what you do is you move the itrs closer
to the host rather than the edge and
then you get those locator addresses put
on the packet sooner and then you get
what you want okay I see okay I see
where you're coming from you guys have
the whole internet in your routing
tables you guys are the hello internet
like the odd don't answer right I wonder
if you type in who owns the internet in
google search what you get in response
can you fix that before I get back and
try it okay so so one quick word about
transition issues and in any brand new
design designing you're trying to do you
have to worry about what's already
what's not out there right so if a lisp
site wants to know that there's no ETR
at an honest flight it really doesn't
know there is no protocol that taught et
art ITR stuff it's just encapsulation is
trying to be stateless in terms of the
connectivity you know there's no
security associations between the two so
the only way that you know that there is
no ETR there is by testing it using a
negative test if you do encapsulating
assume that there is because you're you
think that this is the locator address
for a particular site but it turns out
to be a site that is using just what it
is today so the packets are actually
going to go straight to the host but the
host don't have I see
vporn unreachable turned off so those do
come back to the ITR and then the ITR
could put negative cash state saying
this is not a list site any future
packets that I'd come through me will
not getting capsulated okay so that's
great because now you can get the
packets all the way over there now the
packets coming back can come back if my
source locators are PA addresses right
because that means they can route back
but if mom TI addresses they can't get
it back so what my ITR has to do is know
that a site is not list capable and if
it's using P I that has to source NAT
the packet it has to change the address
to a locator and send it back which
means it has to change a TCB Chuck some
just like any other NAT device that's
the that's the how we make sausage
basically yes good question no solution
yet oh did I the preamble was let's not
talking about security because once you
claim you have it you don't because
there's always something that could
could could circumvent it so we're just
going to say we don't have it and you
can circumvent it in any way but we're
get we're gonna we have to figure this
out some way so let's get to the traffic
engineering this might be more
applicable we can have these things
called TI TR s and T etrs that are
deployed by consenting peering ISPs or
large hosting vendors and you can take
these large equivalent class flows like
bunches of prefixes that you know of
today and associate them with the tunnel
and then encapsulate it and then you
don't have to use the BGP policy /
prefix per customer prefix you had just
not yet to use a BGP policy for the
single locator okay and then you don't
inject more specific routes so here's an
example how it would work sure
teeters and Tatars okay okay that that
that's the best comment i got from you
today Steve Peters and Tatars okay so we
still have the same situation we did
with eid Zahn each each of the sites we
still have the same locators but now
what's going to happen is the provider
be and provider ex want to do some te
stuff so let's see how it could work so
the host emits the package just like it
did before the default route follows it
down through there okay okay just I want
to be reactive to your questions so if
if this 1200 to was injected into here
the ITR would be here and then this pack
o two be floating around here so you can
inject more specifics to address that
question so that that would work fine
but the packet appears encapsulated
there on that egress link now what
happens is be one would normally send it
to the red link right because that's
where bgp would tell it to go but that
red link is a little bit overloaded but
these green links are unutilized I mean
be doesn't know that this Y to X link is
underutilized but it definitely knows
that it's be too i link is underutilized
so what it does is a TI t are saying i'm
going to put on another header and i'm
going to say which way i want to go and
if it puts on this address that can
either be dynamically determined the map
reply or statically it can know that the
bgp policy for this specific / 32 is
maybe this way because what's happening
here is provider being provider ex have
an agreement that they wanted to use
these traffic inter-domain traffic
engineering tunnels okay so we know that
intra domain traffic engineering tunnels
work with LSPs with mpls LSPs we know
that there's a way you can circumvent
routing to take packets and that's what
I'm pls does what we want to do is pick
it up a notch and say we want it to be
interpreters you want these links to be
more utilized so what we can do is we
can say that anything that comes in
through this port if b1 was having this
T stuff coming in through here or
through some agri you know say there's a
thousands of sites or hundreds of sites
that are coming in somewhere in the
middle of network i can say everything
that's coming in through me
I can go ahead and just encapsulate and
send it through some other path okay now
let that we already mentioned is we
don't want to put that in the mapping
service so we think that the data
triggered of that may work or it could
just be flat-out static te tunnels are
static right there's some what's that
there's some ecstatic which means the
the length or diameter of the tunnel
hop-by-hop is configured statically
right and then you have a protocol that
actually builds the LSP that's not very
interesting and then use these igp
shortcuts and try to you bastardize the
igp to make it use those paths okay I'm
not sure if I want to bite off and say
let's have bgp treat this as a separate
path and use it the IE the tunnel but
this can be made actually more secure
than the ITR DTR connection because you
can use shared symmetric two keys here
and you can then encrypt all the data by
going back and forth like an ipsec
tunnel okay and you'll be able to get
your load splitting because this guy
this guy here will then look at the UDP
packet that's the UDP header here and
we'll be able to generate a new another
UDP header here so these lags that are
built inside here can get good equal
cost load splitting because the big
problem with with doing tunneling is
you've taken all these 12 10 gig flows
and you made them look like a very large
flow and because the source address is
coming from one point so we have to be
able to to figure that out so the packet
comes to the there that x1 d capsulate
sit he forwards it so there's basically
two levels of tunneling here now we only
going to support two levels of tunneling
and no more so this is kind of an MPLS
label stack of two and no more and it's
important because there's a lot of
overhead its associated with this and
you don't want to have too much you
don't want to you have to worry about
looping so the first check that's done
in the forwarding paths is how many how
many levels there are and if somebody
does screw up something with static
routing you always copy the TTL from the
inner to the outer and then from that to
another outer and then when you d
capsule you copy back into the inner and
back the TTL is preserved from source to
destination you have to do that or
there's all kinds of loops that can
result
forwarding loops here and MSS or
something like PCP and I don't know that
that stacking is going to go on you've
got fragmentation and reassembly problem
right right you have to if you use MTU
discovery you have to respect it if you
don't want to depend on it you have to
you have to the the receiving side will
have to know that it gets lowered and
tell the other side that's a host change
that I don't want to write off
Oh
thought of the bottom line is if ya see
what we're depending on at Cisco is that
everybody continued to use Giggy and
using 15 on their bites and then we use
9k everywhere else so we think it's less
of a problem but if you use 1500 1500
you have a problem or 99k you have a
problem right I mean that this is
nothing new I'm not introducing anything
new tunneling has these disadvantages
right and we have to just figure out how
to do it now mpls has the same problem
but it's usually 48 bytes that's added
so you don't hit you don't hit the air
part as quickly
why white greatest goal browser you can
but when you change bgp you have to
change it everywhere and you have to
really be sensitive to that any change
the bgp takes two years to get deployed
everywhere if you're lucky incremental
deployment I mean we have made we have
made really hard decisions to keep it
incremental and nowadays if you want to
do anything new on the internet it's
over the top no kidding right you gotta
do it you have to do it n den though get
the do it and then
so so so so two beasts oh well you
certainly can do that if you think
there's local scope I mean you still
have to upgrade all the Sprint routers
all the verizon routers to do it and
that's still a mammoth project too okay
or just going to verizon and say upgrade
all your route as a newbie gb is a
mammoth thing to do let alone
inter-domain let alone capital I
internet but to be sensitive to your to
your thing it has already been thought
about that on this list 1.5 topology
where we want to move around eid two
locator mappings that we could have a
new nlr I in BGP and use it on a
different topology but it's a different
topology it's not on the existing
routers that are moving data quickly
took five years is it me and may it may
be the proper response to your question
it is maybe we don't have to hurry maybe
it's not urgent maybe five years is ok
if you think it's better I mean it's all
these sort of trade-offs and our
decisions you have to make in crystal
ball you know predictions so it could
work I mean there may be people that
will want to do more things in BGP
because it feels comfortable they have
the knob but I know that doing this
mapping service thing the BGP is too big
a hammer for the problem and bgp has
problems that would it be nice if we
could fix it and go to a next generation
thing so yeah so that brings us to this
yes would enough thrust anything can fly
and everybody knows that the older guys
and your know who is calling that phrase
right
running transit and I've guaranteed to
get you out right and you could you're
absolutely right so what you have to do
if you wanted to put a mapping record in
a BGP update you have to build a new nlr
I'd that has to be exempt from doing bgp
path selection right because it's more
of a distribution you don't care about
the shortest route to the Eid prefix you
just want to get them everywhere right
and really we don't have this perfect
segue into this so we don't really have
a database infrastructure that gets a
lot of pieces of information everywhere
and when I say get it to everywhere
means push it right we know that we have
one very large and scalable database
called DNS but it's an extremely pull
and TTL timeout model and we know it's
hard to update right so we have to
decide do we want a database that's
easily updatable and push things out
because if it was and if it was scalable
though this is really you know panacea
and I'm smoking something by saying that
is that it wouldn't be great if we can
push out everything and all the itrs had
all the mappings and when the locators
came and went that we told them what the
new mappings are this ain't going to
scale right so let me continue and then
and then maybe I could pacify your
question is you could put it into DNS
fast you can't get everybody who has a
pointer to the old information to get
updated fast that's the problem there's
a thousand people that know what your
locator is and you just changed it now
how do you get to those specific
thousand people the new guys will come
and get your new information the old
guys have to TTL timeout now you could
push the TTL zero time out everywhere
ain't going to scale because you got
pushing everywhere to find the thousand
guys make sense yeah I mean it's this is
nothing new this is you know large
scalable distribution protocols so we
want to build a large distributed
mapping database service it is not a
routing protocol I repeat it is not a
routing protocol it may look like a
routing protocol but it is not and we
are keeping it as simple as possible
because I have to implement it okay
scalability is paramount to the solution
so how do you scale this is the I'm
calling this the new Tony Lee formula
because he just brought it up it was
elegantly simple and it's like no
of course well if you have a lot of
state and you have it changing at a rate
both of those factors are really large
you have a real big props Kaling problem
but if you can control one versus the
other you may not have a scaling problem
depending on the size of the other
factor so we think the state is we're
going to shoot for 10 to the billions
are the 10 to the 10 which is 10 billion
right we're going to shoot for that mini
host we're not going to shoot for that
many entries in a database we're going
to try to aggregate that to a couple to
too many orders of magnitude and see how
it works and of course we don't need
that in everywhere okay so what we'll do
is we'll aggregate AI DS the action ones
are assigned to host and eid prefixes as
I mentioned before that's the first
order of reducing state and we have to
keep rate low and that's why we're
saying that the mappings our
subscription time frequency changes okay
really important so mobility will not be
solved with this solution we have to
figure another way so all the big
questions asked is where do you put the
mappings how do you find the mappings is
it a push model is it a pull model these
are all the questions you ask when you
want to build this large scale will
distribute a database these secondary
storage because there will be a lot of
it but maybe memory and disk is cheap
maybe you can store all these entries
right do use a cash what about securing
the mapping entries oh boy what about
protecting infrastructure from dos
attacks oh boy these security things are
nasty what about controlling packet loss
and latency trying to go get the
information so push doesn't scale
caching doesn't scale pick one okay so
we're going to pick both of them we're
going to do a hybrid approach okay so
push that upper levels of the hierarchy
we pushed it upper levels of hierarchy
because we think at the upper levels of
hierarchy we can scale the number of
table entries to be really small okay at
the lower levels of the entry you don't
want to push everything there because
not everybody needs everything all the
time so they're going to pull what they
need and they're going to cash and
they're going to time it out we know
caching works to a certain extent DNS as
an existence proof
mapping stay at lower levels so we have
these mappings that stay at low levels
for the part of the internet that
they're going to be responsible for and
we're going to send requests and if we
find the guys at the first level that's
great if not we're going to route the
request to where the mappings are going
to be in return okay so let's Khan is
not a DHT but it looks the way the
request is being forward it looks like
you're trying to find the node on the
distributed hash table that maps to the
key that you're trying to do look up
data for it is not a DHT it's a list
three-point ovarian so we get good at
you ID'd prefix aggregation I'll explain
how it all works with a picture I'm past
my time by the way you want me just to
keep going through okay if hierarchy is
based on the ID prefix allocation and
not topology we can get good aggregation
okay this topology that we're going to
build is going to be an eID allocation
topology and it's not going to change
often it doesn't have the effects where
you put a backdoor link between verizon
and sprint and everything changes we're
going to force the semantics to get
scalability okay so we're going to build
this logical topology based on eid
prefix allocations map requests will
follow the logical hierarchy and the key
to be used to find the data you need is
the eid and the map reply will return
the record so we'll introduce introduce
these two components so lisp we're
calling the protocol cons because we're
bringing the data plane in the control
plane together and we're calling the
first level the hierarchy content access
routers or cars and Cooter's so you own
list programmers we're going to our part
of the we're using some of the
terminology and it's somewhat fitting we
we did put authentication up there right
which we still might use but we didn't
want to focus on the security aspects of
it because there's tons oles in it so
anyways that maybe we should implement
lists and lists yeah anyways we're going
to hold the mappings at level 0 of the
hierarchy it doesn't mean each level 0
node has to hold the entire mapping it's
just going to hold the mapping of the
sites it connects to and so it will be
in the power of 2 block of those sites
that are getting those eid allocations
so and then you aggregate eid prefixes
as you as you
up the hierarchy and then you generate
map requests and respond with map
replies I already said that the Cooter's
themselves are doing the pushers so the
cars at the bottom are doing the
requests and replies and then the
Cooter's at the higher part of the level
they're going to push around the Eid
prefixes in an aggregate able manner so
let me let me give you an example of
that so we have some sites down here and
we have itrs these are the guys who need
the data to find out the location of
these guys to encapsulate packets right
so what we have is we're going to have a
huge number of cards that are going to
aggregate lots of sites the first level
of the hierarchy we're going to call it
level 0 okay and then these guys are
going to have these parents which are
the Cooter's and the Cooter's actually
push the data around with in a mesh but
then they have different levels that
they will then aggregate prefixes going
upwards so we have level 0 we're going
to level start numbering the levels here
and as you need to make it scale in the
future you add levels to the top you
just do a plus one for the levels okay
good yes I will do it at the end because
that's a mobility suture that's that's
mobility haha let me explain the first
and we'll talk about the operational
stuff and that's the kind of input
that's the kind of input i want to get
from you guys in in short I think the
cars can be put either at ISC I xes they
can be put at registries or at ISPs I
really think that you know you have your
DNS server here that's what the ETR X is
you this is your first level dns server
that you use where's that DNS server
today it's at an ISP where's the second
level on a root server so it's really
only three levels of hierarchy I don't
think it has to be much different than
that but let me know what you think that
you know we I'll be around after this if
people want to help me see the light so
to speak okay so let's say we have this
this guy right here is this Eid prefix
it's been allocated to the entire site
and the locator dresses are l1 and l2
right here so he keeps a table this is
supposed to be a table even though
like a newspaper he keeps a table there
now the first thing we did and we pulled
it out a design is we want him to
registered up here and we realized if we
wanted to register because we wanted him
to be able to give him the public key
and then when he registers he would then
sign it with a private key so this guy
knows that this guy would give it to him
but we said let's start off really
simple let's configure it here because
if you configure this thing here this
guy this guy or maybe this organization
is allocating that to him well then have
to configure it in here to make sure i
sent this guy because he's going to
configure this peering relationship he's
gonna say i gave this thing to this guy
now i got to make sure that guy
advertises it back to me so it's just
like I'm telling you something now I
have to put an input ingress filter to
say that it's the right thing well just
have him configure it right if this
guy's motivated get this site online
because he's paying him so to speak talk
about economics later but maybe there's
some motivation so at front we were
saying this mapping will actually be
configured here so what's going to
happen is this guy calls up the registry
say this is aaron wright and eras
errands going to deploy a car he's going
to say i need some eid prefixes he goes
oh camon devious / 24 it's 111 and he
goes okay thanks a lot here are the
locators i'm going to use because
they're going to be IP addresses that
i'm going to use these IP addresses that
he use is based on his IP connections
this guy doesn't know that shouldn't
have to know that it shouldn't have to
keep track of that so he's going to say
l1 and l2 or my my locator addresses he
says okay so I'll put in this entry in
there and so when I tell people that
when they send in carefully packed so l1
and l2 it's in fact etrs that can
encapsulate it okay so this guy has
similar and you notice is the same power
to block if this guy was not in the same
power to block of this guy he would not
attached to this car he would attach the
car that has the same power to block
we're going to force that a logical
topology here this is just a TCP
connection we can do it we have no
restrictions at the physical layer
anymore we have these business things
that we have to worry about that I hope
will be okay but I don't we don't have
any physical limit restrictions so now
that these this car will keep these two
mappings so these two mappings are just
sitting there right what he's going to
do is because he has the up the next
level up when he has a peering
relationship with this cooter he's dead
going to aggregate so anybody that's in
1 11 / 16 no matter what registry
anywhere in the world that's going to
say i'm going to give you something out
of 11 16 they're going to tell them the
only way to get on to the internet is
that you have to open up a TCP
connection to this guy we're not going
to let you come in here because we would
all want to do more specific to get
injected if we let more specifics get
injected we're at flat routing again
this is bad so this guy will have the
same thing and he's going to aggregate
them for the next set of cars that come
into him so as we see the aggregates
just go all the way up to the highest
level now this is what I learned working
25 years in the internet you never have
one guy at the top because everybody
wants to be at the top it's going to be
a mesh so all the big four guys they're
going to be in a mesh and they're going
to appear with each other okay this is
good and they're now within a mesh what
happens is we're going to enforce that
these boxes all have the same mask
length so nobody can advertise you
better not have a / 16 come up here if
this guy has a bunch of / aids coming
from other Cooter's this guy's going to
reject it and we're going to try to make
it auto aggregation so we're going to
make sure that this hierarchy stays
intact this is an eid allocation
hierarchy right not a packet forwarding
hierarchy data packets never go on this
topology only request for eid lookups go
on this topology and replies okay so I
sins should start putting some iconic
logos up there so let's say the ITR
sends a packet down here this guy will
send a map request for who he wants to
talk to maybe somebody 1111 so it's
somebody in here you got that from DNS
okay and then what happens is this guy
let's say he has no mapping up here he
has no mapping so he's going to forward
it he's going to forward it because he
doesn't have any specific route at his
lair the hierarchy so what happens is
this guy always forwards to a parent
what we're going to do inside here is
anybody who has a parent relationship
injects 0 / 0 so you'll either have at
this level it / 16 or / 0 and nothing
else if you have a / 16 you know that
the request is for one of your peers and
then you'll route it within here but if
it's not you send it up ok so the
latency in Korea if you want to come
back to somebody far away your latency
increases cuz you're going to do this
hierarchy I don't think this hierarchy
is going to be many levels okay we look
at DNS today and we're at two maybe
we'll do 3 I don't know it doesn't have
to be a lot of hierarchies so what
happens he doesn't have the request so
he forwards it up this way now this guy
up here since he's at the highest level
of hierarchy he's going to find the
shortest path to one /a he knows 1 / 8
is in his tables up here because this
was aggregated right there's going to be
a good chance that these routes are
going to be don't column routes these
entries are going to be very stable
because there's a lot of crap under / 8
this / egg will probably never be
withdrawn that means route stability
this is good right so he so this guy
pushes it to his shortest path when she
thinks in stat cooter this cooter says
I'll send it down here and then now it's
flowing down downstream based on the
more specific routes each time just like
IP routing is done today this car gets
it and says I have the mapping for 100 1
or 1 1111 so I'm just going to send the
reply back he sends a reply back loops
he just sends a reply back and the reply
is actually routed back the same way so
when this guy sources the request it's
out of he sore TSA's request from an eid
that's part of this aggregate able range
so the packet can flow back we're
putting path vectors in the request and
the reply and in the advertisement so
when you look at a table you'll see the
paths of what's happening you don't have
to have another tool called traceroute
to do it so you will find out the path
or request takes and which path the
reply comes back so the tools will be
embedded in the protocol what I've also
learned in 25 years is you don't build a
protocol and then worry about management
later you build the management
capabilities inside the protocol at the
same time okay so just quickly how this
thing works in a little bit more detail
so you have this these lines that I've
been drawing here these are all peering
these they're all appearing on TCP hmm
protected connections we're going to
make the implementation say if you open
up a TCP connection to me and you don't
have md5 or sha-1 as the TCP option
connection does not come up we're going
to require up here to peer
authentication that's going to happen
okay these guys are regarded as sibling
peers and they're configured as such
because they're in the mesh
this guy's a parent peer because he has
a connection to a child pier and that's
where you know what the layer boundaries
are the level boundaries are okay and
then the this guy what his
responsibility is since he's a child and
connects to another level he's
responsible for injecting a or pushing 0
/ 0 so anybody knows how to get up okay
and then he aggregates going up those
are the only roles this is going to be a
simple implementation I'm going to try
to do it in two weeks okay I always try
to challenge that way within the cooter
mesh you just push entries and we're
going to push entries like a link state
protocol all that means is we put a
sequence number in the packet we push it
out all our links if you see a duplicate
sequence number you don't reef or word
it okay and then we have a path vector
along the way you use the path vector to
find the shortest path in terms of
number box and simple hop comp that's it
no more it's not it it's not a
full-blown routing protocol where we're
not running a Dykstra we're not doing
split horizon with poison reverse we're
not doing the dual algorithm it's just a
simple distribution protocol okay the
shortest paths shouldn't matter I
believe and tell me what you guys think
from your initial gut reaction I believe
these connections will be relatively
stable because these are TCP connections
between two points in the internet and
there's a lot of robust connectivity
under here that's going to keep that
connection up again the only time the
connection is going to go down turn the
camera off is when the cisco box crashes
right but other than that these
connections should stay up so i think
it's a stable hierarchical topology not
used for data that can be sort of stable
and stagnant that's the goal so in the
just in the car it's very simple car is
this a special case of a cooter but it
holds the mappings right and it has the
same sort of attributes as everything
else and then the parents there the
child's there and then it does and this
is an HMS protect the thing to the site
as well so do we have security in the
mappings it's a chain of trust through
this hierarchy hm ected is it good
enough
keep going it it each of the green
things is a box there could be a linux
box it could be a router it could be a
host oh no problem yep no problem I was
going to put the hierarchy in but I
thought it would make it too too messy
but that's a good net that's a good
comment for the next revision that don't
worry there's there is redundancy built
into it viability inside doesn't matter
when the farmer for huntington says
what's the building it says turn that
off yep yep yeah greh gated all your
redundancy yep okay so winding down so
this was the this is what we published
in January and this is what's going to
be updated to do this sort of thing we
should have that out in a couple weeks
this should be out by the end of the
week Dave and I are working on it right
now this is the mapping service this is
the encapsulation service we have a
prototype available I did a prototype of
the data plane version first before
we're working out the mapping service
I've tested it in my lab I'm i haven't
running on on daddy cos which is another
operating system Sisco is working on on
a pc platform it can work on these other
platforms to but their platforms you
probably wouldn't buy for this purpose
so we have it working Dave Meyer and
Vince fuller are now taking it and doing
internal testing these guys are really
good because these are ex operators so
they know where things break and they
know how to test I've used them for beta
sites to like 15 years ago actually so
they're testing internally we want to
start some kind of small external pilot
which is a very well focused set of
people that want to work on it if
there's anybody here that has cycles
haha and wants to be involved in this
I'd love to get you guys involved in it
and then I'll my next step is to then
start writing some code for the cons the
list comms part the standardization less
is doing the engineering stuff so people
think that list should be in the IETF
but more learn long-term architecture
stuff should be in in the I RTF and then
this the Lisp cons part of it is part of
I RTF as well or the RG in particular
and this entire effort is completely
open an IPR free that was the commitment
we made at the ivy workshop that there's
no proprietary stuff going on no patents
or anything this is kind of pro bono
philanthropy whatever you want we want
to help the internet and there's a bunch
of us that want to do this now so what
do we want from you if you could review
and comment on drafts that'd be awesome
Devil's in the details we want to get
the details right give us requirements
keep us practical and if you're
interested in beta testing anything just
please let me know and let's rules
that's it I'm done I was 25 minutes late
sorry do you want me to go back I can
whether it's a core here for the first
adopter I'm staring to support their
benefit is the first step to get from
happens or how does it work again right
well the first adopter will be able to
get benefit by going to get a p.i
address being able to renumber and and
doing that until other people can do it
so they can do that now I basically a
locator ID split is implemented today in
all NAT boxes it is so there is
motivation but it's like anything
anything you you introduced that to New
there is motivation but how do you get
the first I mean why did we go to BG
before when we did it wasn't very
motivating because people said we could
build routers or more memory and just
make it work and just throw in and just
throw do flat routing and just make it
work there were a set of people that got
together and said this is the right
thing to do we want to be efficient we
want to lower costs and we have to thank
those people that the internet wouldn't
would be a mess today at PG before
wasn't implemented a lot of people would
like to get rid of BG before but just
think if it wasn't there so it's I mean
I don't have this solid response to you
just saying it's just the right people
have to get together to provide the
incentive hopefully there's some
business models that can that can come
from this there's new infrastructure
whenever there's new infrastructure
implemented everybody says i could sell
and do this i can provide a car service
i could provide a cooter service i could
be an eid allocation entity all these
things spring up as revenue sources
potentially so that that's how the
infrastructure guys will provide how
will the insight benefit is you know
same reason why ipv6 is not deployed
there's just there's not one killer
thing that's totally obvious that it
gets everybody to do it well we
eventually get to ipv6 probably we
probably will get there
my real question is this ever going to
be real in my hands are practically
sixes you know for a while then no Katya
not in the next five years I'm not sure
if that's right anymore i've been
watching priceless
well yeah what is it how much s euclid
for somebody right I think unfortunately
I think if you want to look for like one
killer app or one killer reason to do it
it's going to be mobility which I which
I had major disclaimers against right I
think that's the biggest one right now
because everybody's doing locator ID
splits sort of thing anyways with mobile
IP and mobile ipv6 and Nemo and all
these different ways of doing mobility
and so it's kind of already there the
question is is can we have one solution
that really kind of fits all these
different environments if you could
solve a fast mobility case it'll work
for isp change case right so I don't
have a magic answer I mean that me as a
protocol designer first has to make it
simple and convince people like you that
it's actually doable and hopefully the
concepts here weren't too advanced or
you didn't see any non-starters and I
have to get past that before I can look
at the business models and and the
motivations and that's why we need more
operational and people in the arts so to
speak that do this for a living to help
with that aspect of it
bigger bigger how many folks have two
adopted before they start seeing what's
you also have to define what's benefit
its benefit looking at one particular
router seeing that as a hundred thousand
rounds instead of 200,000 routes so it's
hard to say what's benefit you but you
bit the way it's worked in my career is
you build technology people find a way
to make money off of it that's benefit
I'm building another tool in the toolbox
i'm not sure if if it's the end all i'm
not trying to say it's the panacea it's
we're just looking at real technical
problems and trying to solve it and
creating opportunities for people to use
it in different business model ways I
mean it says it's as humble as that I
mean I don't know what else to say you
know I I can't give you the answer that
you're looking for I wish I could that I
could
drop table sides of the decor but the
first but in order to get back you
basically have two people who are at the
edge of the network happening with this
on their our right people have to have
the eye dr easy are in their stuff
networks but like I really work just it
is really exists like you busy you that
I brdg are could be pretty simple it
doesn't have to do a lot of stuff right
scan your stuff networkers for the
compilation yep you got here you know
inside that network but so there may be
benefit to them it seems like one of the
large parts of the benefit of this
protocol is that reducing your outside
so you see that as a benefit right that
kind of scares me a little bit because
those are the personalities that could
help deploy this but now that they're
not involved they're going to say oh
it's not my problem now I presented it I
presented where you can use Lisp I
tiaras and ET hours at the site there's
no reason why you couldn't put them at
the Pease I don't think that's the best
place to put them for scalability
reasons because I think I've always had
the mantra that VPNs always scale better
at sea devices than P devices and it's
proving true with 2547 so you could do
this at p's and you could have an ISP
provide this sort of locator ID split
prop service for and if somebody likes
prints going to build all these mobility
services and and have this wimax
spectrum that they're using and
everything that they made me motivated
to put these things in there and offered
as part of their service but so that's
another way to skin it but I mean you
hit the nail right on the head if you
have to depend on goldman sachs bowing
forward those kind of companies to
deploy this and they don't see direct
motivation right away like this
gentleman said it's going to be it's
going to be hard so that you know you
first come up with the idea you solidify
it you get some experience technically
with it and then you take it to the next
level and see what happens so but good
really good comment I think
any other questions
thank you thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>