<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Move Your .NET Core Applications to Linux in the Cloud Using Docker | Coder Coacher - Coaching Coders</title><meta content="Move Your .NET Core Applications to Linux in the Cloud Using Docker - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Move Your .NET Core Applications to Linux in the Cloud Using Docker</b></h2><h5 class="post__date">2018-04-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/uHYQnH5bPMg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi there thanks for coming out I'm
Christian Shea I'm from Oracle
headquarters in San Francisco and today
we're gonna talk about dotnet core and
docker and what it means for you as a
developer and so before I get started I
just want to see a show of hands or how
many of you people how many of you are
currently using dotnet in your day to
day work okay
that's great and how many of you are
using docker in your day to day to day
work okay that's good so small amount of
people of each so I have a some intro
material in here so the people who are a
little bit experienced there with the
very beginning part and then I've got
some some somewhat ambitious demos if
you know what I mean I mean trying to do
stuff across the internet during a live
demo is always exciting so we'll see
what happens and the one last question
is how many of you ran the marathon
because III didn't know why the hotels
were so expensive when I came here and
and and I get here and it's like people
are running in this weather oh my
goodness
so that was pretty amazing I have to say
so let's get started so just kind of an
introduction to what this session is all
about so in the recent past Microsoft
introduced something called dotnet core
this is a new version of.net asp.net
that is designed to be cross-platform
meaning you can run it on your Linux
machines you can run it on Macs so in a
lot of ways it's a complete rewrite and
it's designed for things like containers
which we'll talk about in just a minute
and one of the reasons they did it also
was because they needed higher
performance all the years I guess of
dotnet of evolution kind of slowed it
down plus it was designed for monolithic
systems and not for nimble cloud-based
applications so it also allows you to
run side by side with different versions
so I mention that because if you're
coming from a company that has other
kinds of dotnet applications you may or
may not want to
so some of the things that can can can
make you won't not want to migrate or if
you're using some of the features that
are listed on this screen that are not
supported with dotnet core right now so
that's things like asp.net webforms
webpages windows presentation foundation
z' and workflow related services so I'm
not a spokesperson for Microsoft they
could indeed support these later but but
right now that's how it stands and also
if you're using third-party NuGet
packages that are not supported and
finally if you have a really fancy
desktop app that you're working on done
that course really not designed with
that in mind so you probably get better
features if you stay with dotnet but any
case if you are interested in moving
over to dotnet core and then start doing
some of the things we see here today
there are a few things that they offer
you that are interesting I haven't used
them personally but they have something
called the windows compatibility pack
which adds to 20,000 API stood on their
core and also dotnet standard is out
which basically is attempt by Microsoft
to kind of find the common ground across
all the different dotnet frameworks and
so that will you can possibly port to
that to begin with okay so that's an
introduction to what dotnet core is
running asp.net apps dotnet apps on
multiple platforms
so what's docker so docker is an open
source platform and it's designed to use
Linux and Windows containers so these
are basically it's the whole ecosystem
of docker is designed around developing
shipping and running apps so what's a
container well a container is unlike a
virtual machine in the sense that it
provides hardware virtualization instead
a container provides operating
system-level virtualization so
containers actually can share the host
systems kernel with other containers
that's definitely true on Linux
Microsoft has a few moe
where it's more like a BM but you can
still have the kind where you're
actually sharing it's more like a
process except the process is very
isolated you're not you're not seeing
the other processes that are running so
because of this containers are very
lightweight especially compared to VMs
you don't have to install a guest
operating system you use a lot less CPU
RAM and storage which means that that
you're gonna be able to run a lot more
containers in the same kind of
processing power and you can start them
up and shut them down very quickly
so if you're gonna try to do some of the
things that I do in my glorious demo
today you're gonna need to have some of
the tools of the trade as we say so let
me give you a laundry list of the things
that you're gonna want to download and
try out as you move your way towards
trying out my demos now all my demos are
are provided in the slide deck I
actually have the commands I'm typing I
put them in the slide deck and I also
have a github we have a github at Oracle
for dotnet so we have some of the sample
code so if you feel a little like I'm
going too fast because I probably am
this was a lot to cover you can go back
and get the slide deck you can look at
the github and and try it out yourself
not to mention I think they're offering
free cloud credits I noticed that when I
walked in so some of the stuff I'm doing
is gonna be using the Oracle cloud just
because that's what I have available to
myself so if you want to try it out with
that you can even do that as well okay
so the first major tool for dotnet
developers of course is Visual Studio so
if you haven't tried this you're in for
a treat it's a really nice development
environment it does a lot for you a ton
for you if you take a look at just the
UI for creating an asp.net core app with
Linux with docker enabled it's just a
few check boxes and then it creates all
of these files for you and manages them
with scripts it's pretty sophisticated
the downside is it does everything for
you so when you can when you really need
to understand what's going on sometimes
you have to suddenly go back and read
everything so but but it's pretty
amazing in terms of
work flow there's also something called
the dotnet core SDK dotnet quart SDK and
this is fairly new it's really
impressive it's command line base
compiling you don't need Visual Studio
at all you just type dot net and then
then action item to take care of so if
you prefer to work with command lines
you know you don't want to do everything
through Visual Studio you can use this
this SDK so I put a bitly link let me
zoom in on this if you ever want to
figure out where some of these items are
obtained you can go through my slides
and click on the bit ly links to make it
easier on you to find them but anyway
you can see the kind of commands that
that that I have here on the screen
dotnet new web that creates a new
asp.net core project add packages this
adds the new get package manager it adds
some of the packages that we need build
does a compile of the project publish
basically generates a zip Abul
compilation of all your your files or
executables and then dotnet and the name
of the DLL just runs it so you can do
all this in scripting you can do it all
from the command line and that's
available on all the platforms it's
really cool now one thing I forgot to
mention when I was talking about Visual
Studio 2017 is they do have a free
version of it
it's called Community Edition so no one
you know no longer is that for the
people who are supported by an IT staff
you don't have to pay thousands of
dollars it's available to you for free
moving along to docker of products that
you need to install to be able to do
these demos so there's something called
docker Community Edition and this is the
free docker that's available to everyone
and it's supported on certain operating
systems for other ones you need the
Enterprise Edition but so docker for
Windows there's it's really fancy you
can download it it has the command line
but it also has this pretty interesting
GUI that runs as a task in your down
below on your on your taskbar that that
you can monitor what the docker is doing
and then on Linux there's a really nice
set of instructions on their website
that basically you generally use this
pack in package managers like yum to
pull down everything you need onto your
Linux system it's really even someone
like me who does Windows all day long
every day can do it so you can do it too
so so that's that and as far as what
Dockers doing under the covers for
example darker on Windows so they've got
you know at starting with Windows 10 a
creators Edition and Windows Server 2016
they have native containers and Windows
now so that means that they don't have
to run a VM to simulate that you're
running a container it actually uses you
know the same type of process isolation
that Linux uses but they also let you
switch into Linux mode which does run a
VM so that you can develop your Linux
docker containers right there on Windows
as well so it's pretty impressive and
these are some of the types of commands
that you can execute with the command
line with docker things like docker
images let me look in my database of
images docker login let me login to
docker hub we'll talk about that in a
minute that's a registry for your images
docker pull let me pull the image out of
the registry docker run let me run my
image in this case let me map my local
port 11,000 to the container port 80
unfortunately this I didn't know what I
was going to be doing when I created
this so this is a private docker
unfortunately you guys can't pull from
it but it's not very hard after you see
what we do in the demo it won't be very
hard to create one yourself
so docker hub I've been talking about it
what is it well it's a registry
basically a database I mean that's just
one part of it it's got a lot of
different features but one of the key
features is it's a database of images
and docker images base
Stickley the way docker works as you
start with a base image and then you
tell it I want to create I want to
create another image based on that and
you have a docker file which executes
off the base image and then makes a new
image and maybe makes a new image and so
it can have several layers of images and
it actually can get a little bit big
like I think some of mine are like 300
Meg but they're really smart about
pulling and pushing from that registry
so since everything's in layers they'll
only pull the layers that have changed
everything is is God
everything has got hashes on it so it
knows which part is changed in which
part hasn't so actually it's really fast
after you know as long as you're not
changing the entire image from bottom to
top it's actually really fast and so
what's nice about this is you can send
your changes off to your docker hub go
over to your Linux machine and pull it
back down you don't have to worry about
tar balls or tars or FTP or any of the
old-style stuff you can just very
quickly pull and push from the registry
and then other cloud vendors including
Oracle know how to talk to docker hub it
can pull things out of there into the
cloud so that's another really great
feature of darker though we're almost to
the demo I just wanted to give people a
little bit of background before we start
hacking on this stuff but the other
thing of course you're gonna need an SSH
client this is easy and Linux it just
comes away with it but on Windows it's
actually been a little bit kind of you
know you have to roll your own eye
whatever you decide to do so in the past
a lot of people have used putty for SSH
I personally find it to be quite painful
I personally like cygwin which is Linux
like emulation but it does a great job
and then now I hear tell anyway as they
say that Windows 10 has an open SSH
client available in the creator's
edition of course I didn't see it
because our IT guys won't let us have it
I guess I don't know
but but in any case I'm just joking
about that but in a case you very soon
Microsoft is gonna include OpenSSH as
part of
just ten ok the last slide before we
really get moving here I'm gonna be
using a piece of code called simple web
app this is on github on our github and
it's you'll see the code multiple times
as we move through this so I don't have
to linger too long but the basic idea is
it's an asp.net app that takes a connect
string from the environment opens up a
connection using that connect string and
then basically queries a simple database
table and then outputs the result of
that database table in order to do this
let's see I guess these slides are a
little out of order
in order to do this I'm going to be
using the following cloud resources so I
have a cent OS Linux running on Oracle
cloud infrastructure compute I'm using
this because that's one of the ones
that's Community Edition is free on and
then we have an image on there so it was
easy so I'm using it we also I'm also
going to be using application container
cloud service which is Oracle's
container as a service and uses docker
hub on the background in the back to
pull in asp.net core images and then
Oracle database as a service as well
so I've got three demos it looks like
I'll probably just do two because
there's these things can take a long
time if things go wrong but the first
demo I'm going to build an ASP Dino core
app using just Visual Studio I'm going
to ship off the image to visual studio
hub and then I'm gonna log into my Linux
instance and pull it down into Linux and
then execute the container run it and
then connect to the connect to the
website the second demo I'm going to do
is create a doesn't it
asp.net core app but to keep things
interesting I'm going to use the command
line to build it instead of Visual
Studio so you can see how that works and
then I'm gonna package it up and give it
to the application container that will
take the asp.net docker core image
run it so if it sounds ambitious it is
in 30 minutes but I think I can do it so
then I included all the steps in the
slides as well okay so now I'm gonna sit
down and not get up for thirty minutes
all right
okay so let's see what we have here so
okay let's see let me make sure doctors
running so here's Visual Studio and let
me open up a new project and I'm going
to do a project for dotnet core and
asp.net core web application so we'll
call it Oracle code Boston and that's
good enough then it should bring me
another dialog that says you know what
do you want to put in the web site I'm
just gonna leave it empty and do you
want to enable docker support so this is
the key part here it lets you choose the
operating system that that they'll set
it up for and then they'll take it from
there so let me say okay
okay so first thing you can see is that
it's done a whole lot of work for us
already so it has a docker file already
created so if you take a look at this
this basically is a docker file it says
start with the asp.net core docker image
and then start doing stuff to it so it
starts copying in my application that
I'm about to build and then publishes it
and then tells docker you need to use
the dotnet command line to execute my
dll and there's a bunch of other stuff
too it uses docker compose which is a
little bit more advanced way of
maintaining multiple containers that are
all related in a single basically
multiple containers and multiple
services so it takes care of that too if
you want to have a more complex scenario
now down here on the right it's a little
bit hard to see but I've got my docker
instance here which seems to be giving
me problems so let me quit docker this
is the kind of thing that live demos are
really excited about because let's see
why it's failing here okay we see okay
if that doesn't work this demo is kind
of
something is going on that's chewing up
my CPU
okay let me look at my processes see if
I can figure out what's going on because
I have my CPU is getting hammered well
it was quit dr. C I can't even quit it
let me try killing me and killing the
process
okay now let's hopefully we'll be able
to restart it okay and while that
starting I may move on to my second my
second one let's see darker darker
darker darker
okay well well it's starting let me get
this project set up and let's cross our
fingers that it's going to actually
start because I've never seen that error
before okay so all right so if you go to
our dotnet OTN page you can find our you
can find our github down here at the
bottom so this is where we store a lot
of the sample code that that we help
people with so here I have samples used
for oracle code
so here's Oracle code Boston and what I
want to do is I want to copy this code
that you saw on your screen on the slide
deck earlier I want to copy it into my
project this is the one the code that
okay let's see this is the code that
hits the database okay
okay and we called this Oracle code
Boston okay and then I I'm using the
Oracle data provider for dotnet for data
access from the database so what I'm
gonna do is I'm gonna add that using
nougat and browse
and then it's I have to check off the
include pre-release because right now it
this provider is in beta so I'm going to
install this into my my project this
will give me date Oracle database access
in my application and now you can see
that it has added it here into the
project alright
and what else okay great Dockers read
that's never good
I wonder what it's trying to connect to
that I why I can't connect I've seen
this before
sign out the only thing I can think to
do is to reboot all right let me try
building this
I think I saw this before and it was
related to shared drives but I just
don't know well what I could do is build
it and then do it all by command-line I
guess I could do that but that would
really be winging it
okay all right
let me save where I'm at and reboot the
computer because I've never seen that
before and this computer is acting very
slow so let's see
okay now won't even let me exit Visual
Studio yeah see it's it's still trying
to connect to docker so I don't really
know oh my goodness I've never seen
anything like this this is terrible an
error occurred okay
all right well I'm gonna restart
and I apologize but I've never seen that
before no I have never seen this before
I suspect that still shutting down
sorry I just had to reboot it'll come
back up hopefully
all right oh good I'm right in there
okay
get rid of those ugly things okay doctor
should be coming up on its own so
hopefully it will
I may have to redo the app if Visual
Studio closed hard to see if it's in
there some projects no it's still there
okay
are you kidding me
unbelievable yeah it's fine I mean well
you know I'm just gonna I'm gonna try it
won't even build that's the problem
I just we'll have to move to the next
demo I guess I would like to I would
like to do it by command-line but the
problem is I need at least Visual Studio
to build the DLLs and it's not even
going to let me do that because it's
trying to trying to connect to darker
well now it's running what are you gonna
do okay it's working finally yeah okay
what do you know okay here we go let's
get the where is it
okay it's gonna be a push to finish on
to finish now let's see alright so
here's the code we're getting an
environment variable and we are
connecting to the database using that
environment variable just to give you
some information about what we're doing
in the backend I have an Oracle cloud
account here you guys can too and in
that Oracle cloud account I have what
are called compute instances so I have
sent OS here running that this is the IP
address you'll be seeing a lot for sent
OS and I also have Oracle Linux which
I'm not going to get to the demo of that
one and then just just happens to be
here Windows but you can use Windows as
well and then I also have a 12-2
database here Oracle database and here
you can see you may see my connect
string it has the IP address and it has
the the container name here for the
database and it has the the host for the
database and the port so you probably
see that in the connection string as
well alright let's get to the code let's
get hop in here alright so let's try
building it again
cross your fingers
so behind the scenes you can see it's
doing a whole lot of stuff here well
it's doing that I'm gonna run zoom it
again so I can zoom in on things okay so
you can see it's doing a whole lot of
stuff behind the scenes and yes docker
is working okay so what it has done is
it has built a docker image and put it
into docker and if I want to I can set a
breakpoint and I can actually start
debugging right here I can debug my
running application right in Visual
Studio
okay and I can step through it and I can
take a look at the well I'm getting an
error let's see why
connexes string as invalid I haven't put
the connect string in yet but in any
case you can debug it and and so forth
until you get things just the way you
want it like for example I forgot to put
in the connect string into the docker
compose so so it couldn't connect to the
database but you can debug it and then
when you're finally ready to deploy it
you can change the the properties for
the for the solution to release and you
can build it again
you can see it's just doing tons and
tons of stuff for you behind the scenes
okay and then once you're done finish
please finish
once you're done you can
you can publish it
and now this is gonna ask me where I
want to publish it to files container
issue I'm gonna say container registry
docker hub and publish and that's gonna
ask me for my name my password and now
it's building the image and sending it
to docker hub if you've ever done
anything with docker it's doing quite a
few steps for you and you can see the
workflow here debug test do it all
locally and then put it in docker hub
when you're done okay so was it where is
it still going
and you can see it didn't have to push a
lot of the stuff it just pushed the fort
Meg because the rest of these images
that it's based on are already up there
okay now I can look at my friendly
darker icon here and I can actually see
that Oracle code Boston is now listed in
my repository in fact I can go there I'm
gonna need to because I need to know
what the tag is so this is my personal
repository so you can see that I just
pushed an image up here I'm gonna copy
and paste that tag because I'm gonna
need it on the Linux side alright so now
it's up here now I can pull it down into
Linux so I'm going to connect to Linux
using cygwin so let's see the IP so
that's SSH - well I better change into
the directory that has the has the
private key
yeah okay and now I'm gonna say so this
is cygwin I'm using I'm gonna okay so my
account is OPC that all the accounts in
the cloud are they have an OPC account
and then the IP was 129 213 103 if you
recall that was this guy that was this
IP all right what did I do wrong
identity file not accessible where am I
private it's probably not
oh that since C okay
permission denied
/im doing too much both unix and no
that's not it either so you corne you
know what I'm just gonna change into
that directory or you know I'm just
gonna that's that's it no it's right
there I don't even need to give the path
private alright let me try let me try
this sometimes this works ok I need to
run cygwin as administrator
let's try it again all right
okay I don't know all right now we're in
here we're gonna log in so the command
is pseudo to change to root pseudo
Ducker log in give it my Christian Shea
and my password okay and then all we
have to say is pseudo docker run
environment file I'll have to show you
that
11,000 to port 80 this was called Oracle
code Boston
and then the tag hopefully I saved it
nope
the tag was here
okay port is already allocated all right
let's try a different port 12000 okay
it's listening now I'm gonna open up
another excuse me
I better run that as administrator
because last time I had trouble
and I want to execute
I'm getting a second window open I'm
gonna change directory
all right so then I can curl which is a
simple HTTP request for localhost colon
and then what port did we say it was
what did I say eleven hundred twelve
thousand okay
my gosh it works all right so that demo
works mm-hmm and we have three minutes
so hmm let's see what I'll have to do
unfortunately show you the slides with
the commands that I was going to run
okay so what I was gonna do is locally I
was gonna say dotnet new web and - n for
name my app this creates the same kind
of project that Visual Studio does then
I was going to put that start up CS code
back into the project and then if you're
gonna use our container cloud service
you do need to tell it what port so
there's this use URLs command and then
you add the port from that the container
cloud service will give you telling you
what port needs to be done and then I
add the Oracle managed data access core
beta to the package these are all the
things I did in the UI that you saw and
then but I'm not doing it for I'm not
targeting darker at this point I'm just
building the app because the container
cloud service has darker in it and then
dotnet build to build it dotnet publish
to build a set of the DLLs you need zip
up the files edit deployment Jason and
application can manifest let me show you
those I don't even care if you see my
connect string because the machine is
gonna be down but I got my connect
string to pass to the container and
manifest just says the size and then
this is the command that would call it
so I would change this to Oracle code
Boston DLL once you have all that you
come to the container cloud service
which again you get for free with your
free cloud credits you say create
application and choose dotnet from here
and what this is doing is it's now that
you've seen what we deal with with the
other side of docker it's going out and
pulling in the asp.net core base docker
image and then it's going to put my
application into that and this is the UI
to do that so you give it a name you
provide the zip file how many instances
how much memory you want to use this
thing can scale like you wouldn't
believe
you you give it the manifest you give it
the deployment which has the bind
variable in it and that's it and you say
create and then it just it starts the
process of creating it it takes about
five minutes to get really going and
then you get a log file it's like the
old days you have to you know after you
did all that you get a log that has your
error and you have to go back and fix
your error and send it back but I
actually did all this earlier so I have
this app simple web app and you can see
that this is exactly what I was going to
do in the demo it provides you an Earl
and when I run it it just does the right
thing and the last thing I'll show you
before we say goodbye is that if you go
in here you can look at your binder it's
really important to use buying variables
when you're using containers because
they can find themselves anywhere in any
environment especially here because you
can be using other Oracle cloud services
that can be moving around so in this
case I'm using my own buying variable
but there's default buy variables from
other databases so if you take a look
here under under deployments
you can see that the pine variables are
down here and that's it so that was the
demo I was gonna do for you I apologize
that we ran out of time I would
definitely encourage you to get the
slides because not only do I have all
the steps you need to do to do the demos
I did today but I also have a third demo
which is how do you deploy a asp.net
core on just Linux bare metal without
using docker at all which is actually
extremely easy you you're just doing
sudo dotnet run the DLL that's it
okay sorry for the excitement it ran
about ten times in my hotel in the last
two days so you never know what these
things but I didn't really want to give
you slide where and bore you to death I
thought I'd excite you with drama so
please check out our github please check
out these slides and take your cloud
credits and give it a shot or whatever
you'd like to do okay thanks for coming
out</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>