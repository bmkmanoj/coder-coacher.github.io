<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Notify Your Mobile Clients by Integrating Push Networks and Java EE 7 | Coder Coacher - Coaching Coders</title><meta content="Notify Your Mobile Clients by Integrating Push Networks and Java EE 7 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Notify Your Mobile Clients by Integrating Push Networks and Java EE 7</b></h2><h5 class="post__date">2015-06-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/5logwHO-9zg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so today we're going to be talking about
mobile clients we're going to be talking
about integrating push notifications
that was his phone push notifications
with Java EE my name is Jay belounis I'm
a mobile platform architect for for red
hat and jboss and over to my left here
is Matias weapon dwarf he's a push lead
for that the aero gear project and a
member of the apache software foundation
and lots of other cool things so as I
said today we're going to be talking
about about mobile push networks and how
we're going to integrate those into java
ee applications so just out of curiosity
how many people here have our have or
have in the past built mobile
applications mobile web how about how
about hybrid patchy cordova all right
and how about Objective C Objective C
developers excellent and android java
excellent that's a bigger percentage
than both of us kind of we're thinking
so so anyway first we're going to talk a
little bit about mobile since so many of
you are familiar with mobile based on
the show of hands I'm going to go
through this pretty quick but when we
say mobile what do we really mean right
well first of all we don't mean brick
phones right and kind of these older
type of phones here and we don't mean
the new factory or not new but the
factory very specific work mobile device
what's interesting actually about those
is that a lot of them are actually
switching over to commodity effectively
commodity mobile Android devices and the
such because you can you know customize
the way custom-made customize the apps
and they have lots of accessories and
things like that so what we are talking
about is you know the modern smartphones
you know which everybody has in their
pocket at least one if not you know a
tablet as well so we're talking about
iOS we're talking about android
blackberry and windows at to some degree
and then who can do knows what this is
logo in the middle it
anyone anyway it's a patchy Cordova
which is a which is from phonegap which
is a hybrid application technology all
right so what's the deal why why why are
we even talking about this well one
we've got new requirements right now you
have different concerns different things
you need to worry about and new
technologies all of a sudden you're
introducing non java technologies and
non you know kind of non non java
technologies that interact in new ways
new build processes things like that so
in general we just have new challenges
right and they can get kind of
frustrating if you're not if you're not
one hundred percent sure what what you
need to do I'm going to talk a little
bit about different types of mobile
applications because it is kind of a big
spectrum so on the one end we've got
mobile web now that is you know just
like every all of us have probably built
in the past it can be jsf applications
they can be html5 apps you know struts
whatever that's going to be posting up
HTML pages that are formatted for a
mobile device on the other end of the
spectrum you've got native to our native
now this is where you're you're using
objective-c you're using Xcode android
android java SDKs things like that going
to get the most access to the device
you're going to have you know full
feature functionality that type of thing
and and then in the middle we've got a
couple of different types of kind of
hybrid application now as I as I
mentioned before Apache Cordova is a
good example of a hybrid application and
what that allows you to do is
effectively use web technologies and
then package those as a native
application so at the end of the day a
hybrid application is still a native app
you're still installing it either
through a apps like a public app store
or an enterprise app store however you
can use for the most part web web based
technology so there's some based on Ruby
others you know aion on html5 CSS that
type of thing now in the the hybrid
hybrid apps plus one kind of interesting
example here is what Facebook is
so Facebook kind of started out with
with pure hybrid app approach and the
problem with that is they ran into some
poor performance issues right because
the choice you make whether you want
mobile web native or something in the
middle it's really dependent on your use
cases in your requirements well Facebook
had requirements that meant they
probably shouldn't have chosen a hybrid
app out of the gate so they switched
over to native right but one of the
things they did with native is they made
it so that there was a way for it to
fall back effectively to mobile web so
if they ran into issues on the native
app they would fall back to mobile web
and show the Facebook page using that so
it's just kind of another interesting
approach to kind of solve practical
problems so next we're going to talk a
little bit about java ee 7 and the
foundations around mobile so one of the
one of the key things to think about
when you're talking about mobile
application development is restful
architectures and restful endpoints now
how many people here are familiar with
jax-rs yeah so pretty much everybody
right i mean it's it's a it's a great
way in java ee to generate restful
endpoints and then kind of work that
into the life cycle of your application
right and it's all its I said it's one
of the key things about mobile
application development because it
really allows you to decouple all these
different client types it gives you guys
the freedom to choose what type of
application you're going to build
without tying you to to a specific
back-end right now obviously there's
when you're talking about jax-rs you're
talking about making HTTP calls straight
into straight into the server where you
can do you know post put delete that
type of thing one of the things for me
that I really enjoy actually about this
is the the meaningful response codes
because you know if a resource you're
accessing isn't there you're going to
reply with a 404 right so you're
actually using these types of HTTP
response codes as they're kind of meant
to be from the beginning so here's an
example of an endpoint and here
obviously we're going
post endpoint distort and then inside of
the inside of the application of the
method we're just going to be triggering
off a few actions now here there's
actually kind of a problem with that
right in that we're really coupling the
the actual call of the restful endpoint
with the actions that are going to be
performed right that's kind of what we
mean by a little bit of code smell there
right so what we're going to do is we're
going to modify that with a little event
driven program right so we're going to
use CDI events which you're going to
allow us to to process that jax-rs
endpoint and then trigger off an event
and let whoever wants to act on it act
on it then obviously there's also JMS at
the end now this is fully asynchronous
and I'll show you a quick example of how
to do some juice some of do some of the
processing there as well so here you see
a modified version of that restful
endpoint here we all were doing here is
we get this call we're just firing off
of that oh
and then you can have a set of listeners
in this case we have we have the storage
and database that is just going to
listen for that that object update and
get that event that's going to be able
to act on it now here's a JMS example of
kind of the same thing how you can fire
off a message using a JMS queue so it
kind of acts in a very similar way so
here is would be an example of how you
actually process that event once it gets
fired by by by the end point being
called and now i'm going to hand it over
to Matthias is going to talk a little
bit more about push where that plays in
yeah right so you saw on the server side
that whenever you get a request from
your partners or whatever like
somebody's using your application it
might be very interesting in the age of
like mobile that you would notify your
clients right so what is going to be
like when the server actually talks to
the phone some of you did already in a
posh perhaps some sort of like
server-side push technologies somebody
familiar with like WebSocket comment or
whatever these hacks were called all
right so there are several words ways to
actually get a phone somewhat connected
to your back end the WebSocket is kind
of a standard way for web web interfaces
but you can also have like a real
connection like a real TCP or UDP socket
and you can also have something like
message broker directly from your phone
connecting to your phone using like
protocols on top of the action TCP or
UDP socket like storm or JMS or mqp but
there are some problems with it first of
all everybody really wants to push all
the things to the mobile devices but at
the end of the day the idea is nice that
you have like a permanently connected
device that is like always receiving
almost immediately interactions and
events from a server but there are
several problems with it
your phone has one important constraint
and that is like power and battery life
so the more connections you have on your
phone the more the power is going to do
over time and not only the power
constraint is there one problem is
really if you have like two three or
more apps everyone has to maintain the
connection to the server right you go
into the train you breath through a
tunnel and whatnot you kind of have to
make sure yeah signal lost I kind of has
to reestablish all that stuff and that
also it's not only two years to the code
it's I said like some problem for the
battery life and yeah and if we are
honest not really every mobile
application really really needs to have
a permanent connection from your phone
like constantly connected to the back
end right the best situations to
actually use that kind of permanent
connection like TCP socket UDP socket or
even something like WebSocket is most
likely like Kia's applications like like
what you do with square for instance
like you have an iPad somewhere with the
cashier and what not sure that is a
mobile device but use cases like that
they're not like really mobile right i
mean that ipad is like really in that
store and it's not like an ipad like you
travel around with in your bank or
whatever so firm and connections like
web socket or yeah n QP or JMS socket
connections are really best for like
gears applications and that kind of
stuff but not really like for mobile so
with mobile again what you really want
is you want to push events as they occur
on the server and you want to trigger
and issue updates so that your clients
can interact on these updates push
messages that are very common in the
mobile space are a little bit different
than like web socket and like any tcp or
UDP base socket connection because what
is really meant it is a small very small
message that you've sub made on your
back end and you basically trigger some
action eventually on the client that the
client understand
else and connect on it right and the
benefit is that you don't really have to
maintain a custom connection on your
phone for instance you have like two or
three different apps in the App Store
and then when these apps are able to
receive push notifications that is all
done by the built-in connection from
your device with the Apple cloud the
same is true with Android so what they
really do is they already kind of phone
home they always have like if you are on
data plan like if you have like internet
connection on your phone there is a
permanent connection from your phone to
the cloud of like apples so when you
install the first iOS application that
is able to receive push notifications
from iOS they immediately establish a
connection and if you install like the
second one they reuse the same
connection if you installed assert
whatever so they kind of do some
multiplexing of one connection then is
actually maintained by the phone right
you don't need to worry about so the
phone understands the phone really
understands hey I have internet
connection yes I can establish my
connection home to the apple cloud to
the Google cloud or whatever cloud
you're using on your phone and it's
really not your problem anymore what you
really need to do is okay your server
needs to say there's an event that
occurred I may trigger that event and on
the client side there's just a few very
simple Apple is more simple there's just
a few client AP is that you need to use
in order to actually process the event
that of course when a push message reads
the phone so what is really meant for is
notification not like carrying around
data what you do usually with web socket
or any other TCP UDP socket or like
message brokers like mqp JMS you deliver
real data with notifications it's more
like something happened like you write a
mail client you do not notify the client
saying hey here is mail from mr. blah
blah blah with the subject Lola and that
content you just ping the client and say
hey there is a new mail and then it's up
to the client to react on it so the
client could then issue an HTTP request
against the back end and say okay i
wonder if i want to receive the new
content that is there
so somewhere raising the hands for like
apple development iOS development
objective-c you guys already used a
penis some of you did alright so a P&amp;amp;S
is like the servers that you use to just
remove messages to iOS devices like ipad
and ipod an iphone and recently they
also added support for like safari so
you can also now use AP and has to
actually trigger actions to browser
based messaging ApS itself is kind of a
pain in the ass to actually set up it is
very very complex it has different
environments that you need a
provisioning profile for the environment
of production if you want to test you
have a different sort of profile there
you can even select different types of
development you can do at hawk
development you can have like some
phones being registered for like the
test profile and then when you really
want to do push notifications you don't
need just the app ID you just don't need
the provisioning profile you also need
an ssl certificate and again you need it
for like production and you need it like
for testing and then you need to export
it as a setter certificate you need to
give it a pass phrase and whatnot so the
setup is really really complex on a pls
once you are done with it you get
everything going the AP is on the client
they are pretty damn simple and you
almost get like built-in messaging for
free but now when you are using Java on
the backend you want to trigger a push
notifications from your back-end when
something of course and something
happens to the clients right all the
clients that are registered like for all
these agents or whatnot and then yet
there are different Java libraries which
you can actually use to create a P&amp;amp;S
messages so what we see here is a very
simple payload which is basically at the
end of the day it's just like a JSON
object and we're using here the library
called Java dash akin s so what it
really does it uses the Builder and then
you have a fluent syntax so you can say
like other body which is like the tags
that occurs
like natively built-in and then you can
like specify a badge icon so your server
needs to kind of maintain this is the
first message it sends so if you want to
like update that badge icon on your
iPhone and then you can also specify
sound so like the B but whatever like
your application is using so default is
built-in to the platform as well so we
don't need to ship any sound codes with
your app and then you can also use
custom fields so you can then parse the
JSON object on the Klein and then
there's like an action code and based on
an action code the application can
decide what is the priority or whatnot
and then it can read more information
and act on the payload as it goes so
once you've built the payload so this is
really just a JSON object once you've
built a payload you actually do need to
connect to the Apple cloud and just the
same API as another builder so here we
create new service and we have to
specify the certificate stored somewhere
you can store it in the database you can
store it somewhere on the file system
and here's the exported one to the p12
format and you also have to give it a
pass phrase as I said before and then
there's like the notion of like with
sandbox destination or with production
destination and it there is a question
in the back question yeah right okay the
java library that i'm using here is java
dash a P&amp;amp;S and the one is on github
available yeah so so the Builder here
i'm using with the certificate and i say
yes and box destination so this is for
my testing environment if you're going
to use production you again need a
different like certificate you may use
the same pass phrase or whatnot so once
the service is available for you you can
push the APNs message like to pay load
to a list of devices the devices are
identified by a unique very unique very
long unique string which is again
different for environments production
device ID is different than the one in
testing environment and then you can
send it out and later on it is
recommended to actually stop the
service otherwise you still have liked a
connection out there to the apple cloud
so that was the Java side of things so
here is a little snippet of objective-c
code receiving the message when the app
is running in foreground what a show
later in the demo is what it is when you
receive a message when while the app is
in the background objective-c maybe a
little bit funny all the brackets all
the stars all the pointers if you from a
Java background when I first started it
I was like wow this looks like doctor
but them it is growing on you so I do
appreciate it actually now I have to so
here is a delegate function like a
callback that is built-in into the app
delegate interface and when you
implement application did receive remote
notification right it makes sense it is
very long but it is fluent as well right
everybody probably understanding English
probably doesn't know what this does so
what we get here is a dictionary which
again is just adjacent map and then from
the map we can receive information so
here I extract because my app knows what
it is receiving from my bag am I do
receive the name and I do receive a
phone number and then what i can do is
up to me i could issue a rest request
pink like updating data that i want to
display and in this case what I really
do here is I create a widget which is
uialertview and I give it a title and it
says hey and then I give it a message
call mr. blah blah blah whatever the
name was when available and then I can
also apply some buns like if you've done
like any gooey stuff this is very
familiar with you and then at the end of
the day on that alert object I just
invoked the show message so every method
call you really have to put it in
brackets but it will grow on you so it's
it's not that bad as it may look here
okay so how does it work good question
how does it work okay here i do have a j
unit test that is using the same java
library can you guys actually read it in
the back the java code somewhat all
right so this is a vanilla standalone j
unit tests and what I do here is I just
create the payload as you saw in a
slight I give it an alert body which
would show up later in a few seconds on
my device I give it a badge and since I
was lazy I just used the default sound
my app has no real cool sound unlike the
one that started when Jai was talking
and then yeah so here is the API part
that is taking care of connecting to the
Apple cloud and I have to give the
passphrase under certificate so in this
case I have a certificate stored summer
on my file system but you can also
stored in a database using blog right so
it does have to be somewhere on a file
system and then yeah you give the API to
pass phrase and here I say okay I have a
development app because I just I'm not
allowed to put any demo app in the App
Store that's like by Apple policy and we
want to play nice with it and then you
use the service class and you give the
service class the push function here you
give it basically the payload the JSON
object and here is like my unified
string which i'm not showing that's why
i'm using your constants and then yeah i
play nice and I just shut down the
service so now hopefully now I start to
j unit test so what it does is basically
connects to the apple cloud and then
hopefully once it is green it did
successfully connect
do have internet connection yes there
goes so here's the payload that I was
just typing in in order to show that's
not a fake hello Gemma one you are early
today typo whatever it's one of the
things that's really great about this is
now you can actually run j unit tests to
verify your application right verify
push so once you get it get these steps
integrated you can actually integrate
the the actual testing of it as well
which is obviously something that's
really important as you as your app is
going it is slow because i use my
private hotspot here which has not the
best internet connection so that's the
reason why it takes a little bit but you
see again the text that i just provided
is showing up here so one thing I'd add
one thing I would add about any of the
the native push functionality is that
it's is that it can be that the timing
isn't guaranteed right so my wife
sometimes get it gets gets a text
message you know if you you know 30
seconds after I do or a minute and a
half later or whatever it might be so
it's not like real-time communication
right you're not going to be doing chat
chat conversation here but as far as
like notifying the application that
there's updates I mean that's really
what it's for like Mateus was saying so
it's sometimes you're going to see a
delay and that could just be Apple push
network that could be you know some
other some other effect of the phone
that type of thing it's just good to
good to realize it's not always just
instantaneous right and all the push
networks that you can use for instance
like apns for iPhones or Google Cloud
messaging like when you read the Terms
and fun print they all say it's not
guaranteed that it is delivered and it's
also not guaranteed if it's delivered
that it is like immediately so if you
run like your mission-critical stock
ticker app or whatever don't trust on
this one because can make you very rich
but also you can lose some money if you
like react on that stock notification a
little bit too late alright for Android
there is a service that google
few years ago it's now called Google
Cloud messaging GCM and here again I
mean any Android or Google Android
device have to say is able to use that
functionality and they also added the
capacity to allow you to send messages
to the browser so the Google cloud
infrastructure does allow you to send
push messages to a chrome based browser
app the set up on the Google side of
things is way way simpler right so you
just create an API project within their
API console and the API project has a
project number which is the sender ID
that you use on a client on your device
and then it gives you basically a google
api key which is used for
authentification against a google cloud
that's it there is no like profile there
is no like testing or production profile
there's no hassle with a certificate
file and whatnot so the setup here is
really really simple and again they also
have some term to identify your phone
uniquely within their push service on
Apple that's called like device token
and here it's called registration ID so
the setup of the cloud infrastructure is
really simple but on the other hand like
writing that stuff in Android is pretty
much awful it is very complex you have
to have like a lots of XML and the
manifest you have to give it permission
you have to register like your service
class that you're receiving the push
intent you have to all define that stuff
in XML and then there's a lot of by the
way the stuff that I showed for iphone I
had zero lines to code that push
notification has been done with built-in
code I had zero lines of code to show
that push not notification event and in
android yeah you have to write a lot of
classes you have to actually implement
an sort of complex interface you have to
override a few message so who of you was
already doing like Google Cloud
messaging for push one you may agree
that it is a pain in the ass to write
that stuff right yeah and then you have
like the declarative XML you may have a
typo and then it doesn't work it is it
is kind of tedious to do the setup
we do but yeah when you start you have a
lot of code to write yeah yeah so again
he's repeating like it is complex on the
device type of thing to set up with the
cloud is simple but on device you may
run into some issues okay um there is a
different java library this one is
actually from google it is not available
on get up it is available on google code
and the semantics are the same you
basically create a GCM message with at
the end of the day is a JSON thing and
here you use a add data function which
basically is like key value pattern so
Jason is always like a map and that's
the same here so i can add my custom
keys there is no like understanding of
them built in like sound built-in like
badge or build in like alert and then
when i when i'm done with adding all my
keys I just built the payload and what I
need to do for the sending is I create a
sender object I give it like my google
api key for the odd ification against
the cloud and then I really just use a
function called sent which is taking
care of my Pig load of my message then
again I have a list a collection of like
tokens or registration IDs and here the
last argument is like how often I would
like to do the retry in this case for
the demo I just say no or zero yeah so
this is a simplified version of actually
receiving a payload one of the functions
that you have to override and implement
is the on receive you get like the
context of your app and you get like an
intent when something happens there and
then with the recent change that they
announced on I owe you now have a
utility class for cloud messaging you
get an instance of that of that object
and then you need to see what kind of
message did I actually receive so there
is like on the lead there is like an
error or there is like a real payload so
that is already a little bit more
complex than the apple case and then
yeah when it is not like an error or not
has been deleted on the server like when
your phone is actually sending something
to the cloud and it couldn't deliver it
you may be notified the server went
ahead and just deleted the message that
your device send out so you get a
notification hey your message was
deleted so in this case we just focus on
me like payload here and what I do on
the intent that is passed into my
function here I just extract something
that's called extras and at the end of
the day it's really just the bundle
which is the map in Java and that is
like the equivalent to JSON object and
from there I just get the key that I
want and based on the key the
application can go and perform the
action letter real ones so another demo
here so this time I'm using the emulator
it's another good thing to notice is on
iOS the emulator does not work with the
push and push notifications you have to
use the device so you actually have to
have a physical device to receive the
message we're with Google Cloud
messaging it's a little bit more in my
opinion a little bit more
developer-friendly in some ways
sometimes where you can actually use the
emulator and will actually receive the
the GCM message right so you don't
always have to have a physical device
setup that type of thing so I run the
unit test and you may notice it will be
faster once the connection is there to
the Google cloud
so the connection to the internet is
slow as well here
what
demo gods are struck again the problem
is I don't get to the home button to
open up my app so on Android your app
needs to be at least started first that
you can receive it let me see we're here
doesn't work I was clicking our way so I
need a different resolution one second
it's frozen
okay so I have my little demo up here
and then I just run the test again
and it's not working yeah I don't know
why it's not working it was working
yesterday so yesterday just because it
was kind of funny he was he was flying
in or on Saturday who's flying it he was
over Greenland and he was using the
Wi-Fi on the plane but he could only
have one but one thing hooked up so he
had his computer hooked up and he sent
out some some unit tests for prep and
stuff like that and when he actually
landed his phone still got hello from
Greenland right because he was over
Greenland when he changed the text and
even its simulator and even the
simulator when we fighted up to try to
work on the demo and stuff yesterday it
said hello from Greenland when we
brought it up and we're like holy crap
that's cool all right so yeah google
cashed it for the 24 hours or whatever
that was and and so it does work so
something you know general gods have
struck so you have to trust him okay
um-hmm yeah eventually it comes okay so
yeah now the emulator is going nuts let
me show you the Android oops let me show
you you the
I love it yeah android development is
really cool yeah besides the Java syntax
it's not that great okay now everything
is frozen here I just kill it now sorry
okay here this is an interface that you
have to implement and it's called base
intent servers so yeah but still you
have to ride a lot of code what you end
up doing is you factor that out into a
utility which you can reuse over project
you do it in your own jar file and
whatnot and then yeah so see this code
is funny so if I would get a
notification in the notification bar
there was like the text that supposedly
was distributed by my j unit test that
would show in that notification bar in
iOS i wrote 0 lines of code to get that
push notification on my phone and what i
have to do here is I have to do a lot of
crap sorry um I have to get my
notification manager I have to get a
notification or create a notification
have to give it an icon I have to give
it a message and I have to do a lot of
things here until it is actually being
visible on the phone and this is not the
only class in here so this is a very
simple demo the demo does nothing
besides receiving push notifications so
the Java code is one part of it and a
lot of XML is there as well so here you
have to give it permissions you have to
say okay permission to d 10 permission
to wake up clock and here's the
messaging specific permissions right you
have some xml code here and then you
need still more xml to actually identify
the class that is receiving the demo
stuff sorry to push message stuff here
so a lot of XML and a lot of Java code
so the setup is quite easy with the
cloud but application wise it is kind of
painful so
what was the question sorry
that is the public library that is the
google code that gives you the
opportunity to receive something there
that's all google is offering you what
we did on our project for instance we
have a jar which you can deploy on your
android device and you get it almost for
free you just have to declare our
utility function and then we have filled
inconvenience for you as well we have by
we support that other key that you have
seen on the iphone as when it pops up so
our library understand here is an other
key and it starts it and just place it
on a notification bar you have to say no
I don't want to do that but you offer
utilities like that but this is really
all Google gives you a bunch of light
interfaces you have till the man and
then you hold it announced trap reactor
player yes I want that permission and I
want you to use a class so our sister in
it works out of the way but you have to
be clear so in or ever hear from about
100 top in this and then it works for
you but this is really all who will give
you so it is to you to do it yourself
you said you can push it to the Chrome
browser the massive payload is the same
what you submit to the Google cloud
infrastructure is basically a Jason and
they have like some JavaScript functions
and again your JavaScript browser needs
to know the project number like the
sender ID and your JavaScript they have
like built in JavaScript functions which
notify your custom JavaScript code and
then you just extracted so it is
slightly simpler than the Android case
yes okay there's something new you guys
aware of Firefox OS and they also have
to do of course push messaging right
have you hear about something called
simply push before nobody okay Wow so um
mozilla has its own like every other
vendor has its own push notification
service and they call it simple push it
is simple and kind of restricted but it
does its job so
their main goal for them was to create a
service that allows your back-end
application to trigger again their cloud
infrastructure or any partners cloud
infrastructure and then deliver messages
to the phone for five s Firefox OS and
yeah as you seen before Apple does it
for Safari Google does it for Chrome
Mozilla would soon as it's not building
now this thing is still like on
development so if you get it for five
bucks if you have to get like a custom
build and the Firefox desktop browser
may have it built in by the end of the
year but they also support to push
notification concept on the desktop
client and they're extremely clear about
it that push is not meant for carrying
data around on iOS you have a very small
payload but you can still add like
values with real meaning content right
you give it a key like foo you can still
say hello this is my test message or
whatever on Android you can send up to 4
megabyte to the device right it's more
like carrying data around but it's not
really meant for like real-time
communication and Firefox is very very
clear and very very strict about it that
push notifications is really just meant
to be a notification a signaling process
so it does not carry around any data the
process is like pops up so you similar
to the other ones you kind of register
with a channel and then you give the
server the channel name or the channel
ID and then your back-end application
pings the Mozilla push service and then
your Firefox ass gets updated again they
have a unique string which they call
channel ID so your app connect like more
channels and Mozilla came up with the
specification because the w3c community
was defining a standard for all the
browsers to do push but it had some
issues so they were not having internet
scale in mind they were not aware of all
the problems that may occur and Mozilla
tried to implement that one and they
were running into a bunch of issues so
they figured okay we may do this as our
own and they have a protocol define
which is very nice you
can implement the server your own if you
want because the protocol clearly says
what it needs to do the protocol itself
is based on web socket so you can
implement it like client-side and
server-side yourself which is very nice
and then of course they have a
JavaScript API because Firefox OS is
really about JavaScript what we did in
aero gear team is because we thought
this is really interesting we wrote our
own server because the reference
implementation that Mozilla has and may
use it for production is written and go
and then it is the back-end service of
their like push mozilla.org push
services but the idea is more open than
the google one and then the Apple one so
the idea is really that partners or
third parties actually can run their own
push network can run their own push
server or private enterprise or private
enterprise so you can deploy it in your
back end somewhere and you just can use
it internally within your company so
what we did is we did write a server
that is based on natty for simple push
and we also have a polyfill JavaScript
library so ours is not restricted to the
built-in functionality of Firefox OS or
Firefox desktop browsers the demo that
you will see later is actually running
in chrome but you could also use it for
instance on Safari mobile right you
could like connect to web page that is
serving up from an ipad and it does
understand the meaning of the mozilla
push protocol um because simple push is
really no we not only have like the
JavaScript polyfill library and not only
the server we also created a quick start
which is available on get up again on
get up / aero gear and an aero gear
simple push quick start so it kind of
explains the protocol it explains the
meaning of the protocol and it walks you
through how to start the server and how
to write a JavaScript and actually to
receive something there there is no java
library out there that is doing simple
push for your like java back and there's
not really a need for it you can do it
with like vanilla standard java s ii
like in this case I use the HTTP URL
connection
and what I do here is I create a
connection url url connection object and
I have a convenience function that
basically creates a connection and
whatnot and it performs an HTTP put so
they use HTTP put to signal staff to the
cloud and then the cloud dispatches to
your device or to your JavaScript line
here I use the secure URL for the push
services from Mozilla and this is really
the payload that you give it you give it
a version and you give it a version
number so your server has to keep track
of the version number if you submit
something that is below the previous one
it is not submitted to the client which
is very nice so they are strictly clear
about signaling and notifying instead of
like providing a lot of information and
they agree they argue with it like yeah
it's more secure I don't leak any
information and then the client just
really gets painters version 5 and it
knows yes the previous one was below ur
so i may just update my sports ticker or
my mail client so you send out the HGP
put and then you get back a status code
which is also very interesting unless
there is an error you always get 200
status code so even if the channel or
the client sorry or the server side code
is not there they just don't let you
know they just give you 200 ok because
they don't really want hackers to get
interested like if you get like 40 40 I
couldn't find this channel so they don't
really want folks to kind of go nuts on
their network and then the javascript is
similar to the code that we seen before
so basically you have to register some
way to show the message that has been
received on the Cline so in your
JavaScript code you just set up a
message handler for a push object and
the function here the anonymous function
here basically checks if the message was
really for my push and point that I
wanted and if that is the case I can
trigger whatever action I want so i
could for instance update my mail client
or my sports ticker or whatever all
right I have a demo for that too
so here i have my server running my neti
server running and then I just open the
client so what this demo from our arrow
give quick start really does it first
time registers my push endpoint here and
then I get an HTTP URL here which
identifies the endpoint that your
back-end needs to notify when something
happens so you get that URL so this for
instance can be used and in your back
end
nice
okay i use the fresh URL here
and yeah I mean this is very fast
because it's just like local so if I
again submit something here like the
version number 15 it's no longer
displayed because the client already got
like the latest greatest version so yeah
if I do like 16 you see the notification
the new version arrived on the client of
course I mean just trading versions and
whatnot doesn't really make much sense
for any business type of application but
the idea is really for a mail
notification like you have an increased
version / Klein per customer and then
the application knows yeah I may fetch
new version and then it's also up to the
client for instance to see ya I have a
good internet connection yes I want to
try to reach our main server and get
some content from there or it sees I
have a very low connection and you can
just pop up maybe you check your mail
once you have a better connection or
whatever so it's really up to the client
all the tests that i was showing there
were standalone j unit tests and of
course for a real application what you
really want is like java ee integration
so what we did for our demo here is we
have just like one jax-rs restful
endpoint which fires an event and then i
have different asynchronous observers
that trigger the different push networks
let me show you the code oops there we
are
so what I have here is a very simple
endpoint under / push and what it really
does it receives a JSON object which
contains some information like push
message or whatever and then I I just
really fire the event I did receive a
push notification and then here this is
really all my logic for the endpoint and
then I can add as many observers that I
want so any one of you was already using
CDI events before a few okay so what I
really do here is I have an asynchronous
using ejb asynchronous CDI event
listener basically which has a function
here that's called deliver push message
and it reacts on the observed annotation
so whenever my restful endpoint fires an
event or fires an object of type post
message this one is invoked I have the
same not only for Apple I also have the
same like for google but that didn't
work before so I just focus here on a
P&amp;amp;S and then again this is really the
class that takes care of all the apple
stuff I built my apns specific JSON
payload and then I just connect to to
the Apple cloud here and then I
afterwards stop the service once I
delivered the messages so let me start
the server here real quick
so it's important to note that it
doesn't have to be we're showing a
restful endpoint called / push but that
could actually that that CD I event
could be triggered by anything right it
could be triggered by business logic
that knows that a score was updated or a
customer bought something mail anything
like that so it's not strictly just when
this receives you know a message to /
push alright that's just what we did for
the demo but it could be any business
logic that you might have inside of your
application so what I did here is I was
issuing a curl to my java server and my
java server jboss server was receiving
that restful request it did fire up that
CD I event and my apns observer did
actually connect to the cloud and
dispatch the message to the Apple
infrastructure and then my phone is
connected on Wi-Fi again and I was
getting the message here so the code on
the back end side is really simple so
when you leverage like event-driven
nature you never have to touch your
endpoint unless you want to change
dramatically how it behaves on receiving
an HTTP request but what I really do
here is just firing an event and then
you can can add observers for instance
you need to have like blackberry or
Windows or whatever you just really add
one observer for the certain platform
one of the things that occur when you do
push messaging is it's quite of complex
it's quite off two years to maintain all
the state yourself for instance your
device on Apple and on Google is like
uniquely identified using a registration
ID or using a device token so we figured
it might be a nice tool if there was a
server that allows me to store all the
device specific metadata and that also
unifies the API to actually submit the
push message right you have seen Apple
is totally different than google and
google and apple are totally and
extremely different than the one from
mozilla
foot push so on the aero gear team we at
the end of August we did release a
server called unified push server and
what it really does it is your like push
server for native and non-native push
ability so we support apns we support
Google Cloud messaging and we also
support Mozilla simple push than that so
you can even send your message not only
to like our pulley for JavaScript
library you can really also use your
Firefox OS device and then submit the
message using our push server the
workflow is the following you basically
have some code on your device you just
need to register your device with our
server that's through an URL you have to
get the URL where the server is running
and then we have a kind of credential of
the app ID and unlike a secret and once
your phone has the secret and has the
app idea ID it registers mr. server and
then when when you send one rest request
against our server our server goes ahead
and sees okay just part is for Apple I
just patch it to the apple cloud this
part is for Google Android just
purchased it to the Google cloud
infrastructure and similar with Mozilla
not only the server we also have my
client SDKs that help you to actually
register your phone your application on
the phone with our server infrastructure
and we do have server libraries that you
can integrate within your back-end
application for similar to what i was
showing before like your server gets a
restful request and then you need just
deserve a utility to connect to our push
server the infrastructure is written in
like standard HTTP and restful api so
you can even write your own server
library if you want but we already offer
one for java we have 14 noche s if your
back-end for instance is running on no
chairs and another library for PHP is on
the way so if you guys liked the idea
and you think maybe something like Ruby
is missing go ahead and join our
community let me show you a demo how
this all works
the service is available on the service
is available on openshift and I do have
an empty instance here how many people
are familiar with redhat openshift ok so
quite a few so for those who aren't it's
a red hat spass offering and it's where
we host not only Java and Java EE
applications up on up on our own cloud
network but there's also support for PHP
and Ruby and node and other things and
so it's a great way to just get an
account and then trigger off I want a
new push server right so it's already up
there now obviously you know community
and development but you fire that off
and that's exactly what you'll see here
this is what this is what will get
launched when you do that right so once
you are on the open shift side and
you'll click that one it's like pretty
up it takes like a minute or two to
create the infrastructure and then you
get like this empty server what I do
here is I create an umbrella push
application which is like umbrella for
all the different variants that I have
like for iOS four google and for Mozilla
simple push so once it is created I do
get I do get a list of all my push
applications takes a little bit my
internet connection so here is the
authentification information when you
want to submit a message to this push
application but currently I don't have
any variation of it what I want to do
now here is I would like to add an iOS
version javaone iOS i'm using the apple
push network i have to give it a pass
phrase that i was using before oops typo
java one is really high secure and i
have my certificate here and then i
created
so with this setup is really useful is
in a lot of enterprise situations you
can end up especially with BYOD bring
your own device you're going to end up
in a situation where you're supporting
multiple multiple applications it might
be the same application for example ESPN
writer or sports app that's going to
have an android version a web version
possibly in an iOS version this lets you
have one place to to kind of manage
those and all of them register to the
same push server
and wire West the badges
I know so what we do is we unify on that
one so we have an API which for instance
does horner the keys to special keywords
for Apple and we do submit that to
Android as well because our convenience
library does read for alert and it shows
you something it does also look out for
sound or whatnot and it plays sound if
it's attached with the application so we
unify on that one but you can still use
your own keys yeah yeah you basically
submit a JSON message and your
application is responsible to parse the
JSON message we have a few key words
that we specifically highlight so the
other one is also supported on our aero
gear android library if you don't want
to use that one that's fine just provide
your own key and value things and then
it is ha nerd and your application has
to explicitly look for that one so we
unify on that one for simple push we are
not distributing all this stuff because
they don't honor it anyways we just
drink down to the version number but for
Android and iOS yeah so we're running
pretty low on time and so if the booster
right we have a wing of a booth talk at
the Red Hat booth in the Expo Center at
ten-thirty where we'll be able to spend
a lot more time going into the unified
push server and kind of what it does for
you how it makes all of this kind of
come together so you don't have to
manage those registered devices and it
will also show possibly how to how to
target specific devices either by user
by group by OS x by device type phone
tablet that type of thing ok so if you
have done iOS development before it's
kind of complex to do wallet coding and
get started with a project so we do have
an Xcode template which lets you love to
write or get started with an application
so we also have support for our push
offerings in there if you download and
extract the template you get something
like here with an Xcode anybody's seen
Xcode before I mean not the OS guys I
was guys it scary but it's good i mean
it's as fast as eclipse so what I do
here is I just give it a simple name I
have
like org aero gear javaone this is
exactly the name that I use for my
certificate pipeline is our restful
support I don't really want that aero
gear has more than just push we also
have like security stuff I don't want
like one time password now I just really
want to push and then I do next and it
asked me where to save it I replace the
demo that I prepared guest today and
then what it really does it creates a
skeleton application here and all the
delegates that you need for push are
already generated I do need the URL of
the server and I do need the
identification information for my iOS
variant so I have that here really the
only thing is doing is putting in is his
openshift URL to the push server that is
right and then the key that we generated
there yeah and I also submit some client
specific metadata here client one second
so the project that i created is using
some maven like approach for the iOS
community it is called Coco pots have
you guys hear about that one already
it's like think maven for iOS you have
like a pot file where you declare all
the dependencies and then what you
really have to do so this is the pot
file real quick so in our case we just
have the dependency for the aero gear
push library and then I do pod install
and what this does it generates let me
close that well no it generates my xcode
workspace it sucks down the dependencies
so our push library has a dependency to
a afnetworking library which is like the
defaults done that to do heb
communication on iOS so our dependency
is being sucked down and the one for a
if networking is being sucked down and
it does the wiring like all the linking
and all that stuff and it generates you
a workspace so it takes a little bit
because my internet connection is not
that great it takes probably one more
minute if you
at that time so why don't we take some
questions because we are going to show
this at the booth yeah well in a little
bit and I know we're almost at a time
does anybody have any questions on what
we're doing or the project at all or
everybody's ready to go be pushin in
jizz yes yep it's soon it's one of those
things where we're going to see what the
interest is I mean if people want
windows phone support the great thing
about what we've done is it's actually
pretty simple interfaces so we can kind
of you know we can we'd love to have you
take a look and you know add that or or
or whatnot right it's pretty simple to
update these different sections because
we also want to do amazon and blackberry
and and some other things like that but
we started just with with this ok my
project is ready but if you want to add
windows phone I mean join our community
and we can help you to get started and
whatnot we definitely have interest but
for our initial release and end of
august which is focusing on iOS and
Android not saying windows phone is
unimportant ok so now I do have to write
bindings here this is my dependencies
that I have and now I can actually use
the code completion here let me do one
thing real quick I also set some aileas
that you can identify the user right I
give it a string oops and then let me
run it on my device shown the camera
other if anybody was like a aero gear
sticker for your laptop or what have you
they're actually very cool stickers
although I am awfully biased so we've
got it we've got a ton up here we'll
have some at the booth as well okay my
empty application because this is a
skeleton it doesn't really do much it's
really just to get the push being hooked
up has been started you saw something
happen on my device now I can use the
same restful server to ping my groups to
ping my mobile device okay I do need not
the identification information for the
specific iOS variant because that's like
really for my device registering with
the server and did it work over the slow
network yes you see here my device is
there and hopefully it has like my
nickname in the information it has so my
device is now registered without push
server we have like a management you are
you can see all the devices I could even
kick off myself here saying oh that
guy's is the douchebag so I don't want
to notify him so here is my here's my
information for the umbrella one so
that's the one that is interesting to
submit as a message and then we figure
out the Apple part we figure out the
simple push part and we figure out the
google part just real quick about it
from from a printed at enterprise or our
live application type type situation you
actually see a listing of every device
and then the the relative information
that that has been registered to receive
push messages and not only just for iOS
obviously but for android and simple
push as well it's part of the part of
the registration of course ok so I need
to restart my JBoss server here locally
so one one minute guys we're getting the
cut symbol from yeah AV guy yeah one
second one second so my server is now
starting and it is now running
it is up so what I do now is I just
submit a curl against a different push
end point so my jboss server receives to
push my java server talks to our apush
server which one is talking to the apple
cloud and then the apple cloud is
dispatching the message to my phone and
you see java one meets every year and
that's it thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>