<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building Nonblocking JavaFX 8 Applications with JacpFX | Coder Coacher - Coaching Coders</title><meta content="Building Nonblocking JavaFX 8 Applications with JacpFX - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building Nonblocking JavaFX 8 Applications with JacpFX</b></h2><h5 class="post__date">2015-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/krqp79oCG5o" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to the session building
non-blocking Java fixate applications
was jzp and fix before we start some
words about us because we are currently
two main developers my name is Anna Mons
Egham Java consultant and for traumatism
Switzerland and yeah I'm the core
framework develop of JSP fix and the
second guy who was unfortunately not
able to join you as Patrick's among he's
working on are all the UI stuff in this
framework and the custom controls so
they are maybe next time you can join us
so what is the agenda today first of all
an introduction to JSP ethics what it is
how can help you how it looks like then
I will show you a small integration
example with MQTT because yeah all
clients need a kind of data access so I
decided because IOT is such a big thing
here on the Java one I decided to switch
to MQTT the first slides well with web
sockets and the last part will be at
least one demo if we have enough time
maybe more so let's start with
introduction jcpoa fixes first of all a
rich client project a smaller way into
being small and lightweight which client
project we don't try to come up like
eclipse or NetBeans RC periods should
kept a bit smaller so the Java files are
we are currently three Java files and
it's up to 200 kilobytes so it's quite a
small project with no dependency
historically the project is much older
than Java fix 2 so we started while I
started in 2006-2007 at that time I was
staff member at the university and we
had a lot of internship project with
Eclipse ALCP and a lot of internship
students who started to be creative
and then I thought okay what do we need
for a rich client project to keep it
small simple and that everyone can
understand how to use it so I started
with a set of interfaces without any
direct implementation because the first
idea was also to keep its toolkit
independent so in 2009 had two
implementations as vici and swing and it
was it was too much for spells and
project so I started to maintain the
swing project and then in 2011 I've seen
the first better release of Java fix to
was published and I thought yep this
could be the technology we need
unfortunately this was Windows better
only so I took the John started to
migrating more or less blind and then
the first Linux release
I was published and then it takes two or
three weeks in it and it works so it's
more or less a success story of
migrating a swing project into Java
effects and two or three months ago we
released JSP effects 2.0 yeah now we
think it's establish we won't changed
the user interfaces anymore so it's time
to go in the world so one of the ideas
was toolkit independent so we dropped
this so we stay on jailor fix no that's
not the point here
but the other points we try to face with
this project was first of all
structuring composition I mean
structuring you f you have always when
you're using rich client project but the
composition is sometimes much
complicated the next thing was loosely
coupling ok loosely coupling I've also
but we tried to yeah to use it on more
layers and then usually the third thing
was try to help to developers to you
know create your eyes that are not
freezing so
something with we have non-blocking your
eye and the last thing or one big
problem we face but the students was how
did how do I communicate between
different components so so the next
slide will be more or less those four
bullet points so let's start with
structuring composition this picture is
taken from our new website released with
JSF pfx 2.0 and you can roughly see
where we're not invented to feel
completely new we have a workbench we
have perspective we have components and
on top of this component C of your
custom controls and so on so the basic
idea was on one hand you have to need
for for structuring your application
that's is also fine with Eclipse or
simply NetBeans are superior F logically
your workbench of perspective components
are fine but when you take a look at all
the business applications created was
that they all look the same because
simply the effort to create a appealing
UI is yeah it costs a lot to create a
cool UI that's the reason why all the
business applications look looking the
same on the other hand when you have
business application created from
scratch they mostly look they are
slightly better much better but when you
take a look at the code is yeah more or
less a mess at least I have seen a lot a
lot of such projects and maybe the first
developer had an idea how to structure
this application but this idea is maybe
getting lost and then you have a kind of
messy code of this so we try to get in
balance those two two things to go
because I mean UI is always hierarchical
that's also the reason why the Java fix
using a tree like scene graph because
you can always take UI and create a kind
of tree from this and yeah it's
necessary to control your AIA tree and
to know where where you are in the uija
tree and that's also the reason why from
in perspective we choose to have a
workbench out and perspective and also
have components the perspective and
components are more or less control
model-view-controller predicting beside
and the big difference here between
other frameworks if when you take a
perspective it's creating your current
view you can do anything any complex
your eye with your perspective and you
simply have to mark areas where
components can be random so that's the
basic idea
gives the scene builder to your
marketing guy or to your UI guy and
bring them together and they create a UI
whatever they want maybe a business like
UI um maybe a website UI with static
content left a virus blinking
commercials and so on and then simply
mark content areas where your components
can live that's a bit like and portal
you have portal page and then you insert
your portal applications inside that so
and one effort was also to to be able to
reuse all controllers or to our
different views in different contexts so
how does it look like the development
should sell itself is more for
configuration purposes so you can in
workbench you can set the toolbar menu
menus decorators etc so let's start with
a perspective and every JCP a fixed
perspective via implements here ethics
perspective and here you have a
declarative perspective you can choose
either to use F XML or plain Java fix it
doesn't matter what we see here we
referencing to H boxes C main CLC top
and then the trick is small as that we
have here the perspective layout and
register those two containers to be
render targets for components so with
this example more less you can yeah
create whatever UI you want whatever
complex you are you want but simply mark
those
containing us which you want to use for
your components later on if we take a
look at a atom JCP a fixed component
that's only snippet then we have here
again the fuel declaration you can use
FX ml which I play in Java fix and we
have initial target layout this is only
for we have the initial state when you
stop application later on runtime you
can change this target layout so you can
say okay currently my component is at
the top and I wanted later to be
switched to the bottom or to the left or
to the right so this because we call the
initial target layout so that's the
basic idea behind this let's come to
loosely coupling ok loosely coupling is
yeah is always a good work we all once
lose the coupling that's clear but we
try to get it yeah on every level in the
framework so you have no wet direct
references the workbench knows only
ideas of its perspective the perspective
knows only ideas of its components also
the render targets are only ideas and so
on and so on the messaging is only by a
team so this was yeah the basic idea you
can move replace components also at
runtime you can say okay of my component
currently in perspective 1 and I want
this instance to move to perspective too
because I needed for some reasons in the
second perspective with the same state
it had before and a perspective one yeah
and you can reuse the components in
different perspective so I can say ok I
have one search-form component which I
have currently in perspective 1 but I
need a second instance of this component
in perspective two and in perspective
free so which is loosely coupling it
made
yeah it's getting quite easy and also
packaging is getting quite easy because
the only thing which belongs together
the application launch and the workbench
and the rest you can divide in any
packaging you need to conceal ok I have
my perspective and the all the
components in one job or it can say I
of all the perspectives in one draw and
the components in different jaws so it's
up to you how you organize your
application if we take a look there how
it looks in the code so we have here the
workbench the workbench has its own ID
and the array of ideas ideas referencing
the perspective the same with the
perspective it has its own ID and an
array of component ideas and what we
already saw the registration for the
component rendering is also by idea ok
messaging before we start with messaging
the problem was simply communication
between components because we saw a lot
of students who had problems with yeah
you have a on the left side a navigation
tree on the right side you have a detail
view and students can be really creative
how to solve this problem so most of the
students create some kind of static
members at the when they push the
buttons at the value on a static member
and then on the right side they create a
kind of polling or whatever to get the
value so we thought okay how to solve
this problem and and messaging was one
we have this one simple solution to face
this so we have a lightweight
communication inside JCP fixit's and
simple p2p messaging bus we created so
it's an old creation because we want to
avoid so you have to start support and a
client application so we created no one
you can simply change the state by
notifying any other components or yeah
and all the messaging is a synchronously
in J's appear fixed so that's one of the
reason we see and it's simply d-cup
decode was the cause and effect because
if you have on the left side a
navigation tree it doesn't care what the
detail view will do with this message he
only knows ok he's elected person one
scientist message to component XYZ and
what does component is doing the left
side has not care about it today it's a
detail
for the person tomorrow at the table of
whatever and yeah it's an easy to
understand concept the addressing is
simply perspective I the third component
idea
that's because components always unique
perspective because we can reuse the
component in different perspectives so
so how it looked like in code the first
is we have here context we see the
context can be injected to any component
and this one sends a message to yourself
so why do I want a message to myself I
mean was a typical JSP of its component
you have all the abilities with with
Java Java fix you have vif XML file and
you can can say okay when I press the
button I want to execute this method in
my control there's no problem but when
you want to start the lifecycle of the
component users as entron execution it
may be quite useful to send a message to
yourself so this is more or less for
your convenience the first method the
second one simply sends a message to
another perspective and a third one
sends a message yeah to a specified
component and one of the perspectives
okay let's come to the non-blocking UI
this was not quite easy to achieve
because we had a lot of ideas how to
achieve this this idea of non blocking
your eye and we saw a lot of concepts
with handlers and woke later and so on
but that's all stuff that the people
must note that it's existing so that's
that's one of the reason so and when we
had this idea with messaging we thought
okay what what can fit in this ready and
we thought okay a kind of actor model
would would fit quite well because
they're also communicating with messages
and you can use them as in quantity in
the sector model but for UI components
it's not that easy because you have the
first part that the mailbox of nectar
and the task execution phase in the
worker thread but then you have to
switch in the ethics of
patience red because Java fix is like
SVT or swing you have always an ethics
you have always an applications red and
if you want to change your UI you you
must switch to the applications thread
so yeah we created like this so the
message boxes in workers read the task
execution in the work read but the state
changing will always happen on an ethics
application thread so it's everything
triggered by messages so that's also the
reason why I can send message to myself
and yeah simply separate tasks from
state changing that's the basic idea
that's I think that that was the initial
idea nectars too so we did it for this
this actor like model so it's JSP if X
is not an actor component completely
it's only actor like I would say and it
only happens for for JCP a fix component
because we said ok perspectives are only
for UI if you want to create some
database queries on your perspective ok
that's your problem then you have to to
see how your higher-self solve it on
your own so this as in current model is
only four components and how it look in
code so again we have implementing the F
X component and now we have to implement
two methods the first method is the
handled method and this method is always
executed in the workers fret so when a
message arrives it comes to this handle
method in this handle method you can do
whatever long-running task you want and
you can create new notes because in Java
fix you can simply also create new notes
outside the FX applications friend you
are not allowed to manipulate existing
nodes in a scene graph if you do so we
provide a friendly exception for you not
to do so the result value of this can be
a node and this notice as an input for
the post handler methods so the idea
behind this okay create your database
query fetch the result create a table
was I don't know with 1 million result
and when this table is finished simply
turn this table and this is input for a
post handle method and now you can
change the UI state of your component
now you can add the table to your eye or
to whatever you want so what else
I mean perform a rich client project
this is nice but it's not really enough
also we try to keep small we had to add
some some stuff because we we mentioned
this is simply not enough so we added a
kind of special toolbar dialog option
Puppets we have contacts in resource
injection for example the resource
injection you can specify a resource
bundle file on every component
perspective whatever and then you can
inject this resource bundle the context
injection you can do everywhere and we
have specialized cycle annotations ok
post Capri destroyer is clear but then
we have for example on hide on show this
means simply when we have several
perspectives they are stacked so you see
always one perspective in the front and
when you switch to another perspective
you may want to do some cleanups or
create some new stuff so the perspective
which will be hided is executing it on
height and the perspective will be which
will be shown next is executing on show
so you can do some cleanups or whatever
you want dependency injection so the
penance injection is not really part of
JSP ethics we created like that we have
a lounge Shore interface and this large
interface can be implemented currently
we have two implementations a really
basic launcher which only starts the
component and we have a spring launcher
the nice with the spring launcher is
that every perspective and every
component is also a spring beam so you
can use the complete spring world inside
it so but if you want to weld launch or
juice launch at
and I think it's quite easy to implement
it's not currently on our focus to
create new implementations for this but
it's easy to use interface so it's quite
possible to switch from spring to well
to whatever you need and then you have
all the possibilities with this
frameworks so I do by default if you use
our archetypes provided on a website you
have always the spring implementation
but we mentioned we did some tests with
raspberry pi and so on and we have small
application which is I don't know three
hundred kilobytes and then you have
spring with five megabytes we decided to
provide a minimum implementation for
this ok JCP effects toolbar it's an
extended Java Java fix tool but was yeah
you can add some special regions top
left sense and Santa ant and so on and
we have an automatic an automatic or
manual button management this means if
you have two or more perspectives with
all those components and you add a body
in one of those components to your
toolbar and when you switch your
perspectives then all those buttons will
be disabled and only the battles will be
visible from the currently visible
perspective that's the basic idea behind
it but if you do not want to simply
provide an idea for the buttons you add
and then you can manually change the
state of the buttons so next one was
dialogues I mean we started with jazz
Java fix 2.0 so at that time we had no
dialogues we had to implement our own
dialogues and they are still there so
Java FX 8 is providing his own dialogue
and you can use this dialogues
but yeah we have this dialogues and they
can use for the JSP option pain for
example where you have ready to use
option pain was ok cancel about the next
buttons and so on and it's also used for
ex exception pains you can provide a
jcpoa fix has a do fold exception pain
if you do not like this exception pain
you can provide your own implementation
of this exception pain so all the arrows
and all the exception that may occur the
application will yeah print the values
to this exception pain
okay let's yep by the default no it
resizes by the text but but only to I
think sixty percent if you want and
resizable you have to implement your own
but it had okay integration example this
is simply one integration example like I
said before I add in the integration
examples WebSockets WebSockets in and
qtt are more messaging like but you can
use the same example to it for request
response or form for example form do we
need database access to in rest access
whatever you want it's only an example
how to do is because JSP ethics has no
direct bindings for for some special
technologies it's only a way how to do
this so the integration example is a is
a yeah we choose remote Ron we had a lot
of demos for me a more businesslike was
was you press apartment and a table
filled with millions of rows and we
thought okay that's quite boring so we
choose the remote drawing because with
remote Ron you have several problems
first of all you have to synchronize
different clients and then it's more or
less the worst case for an UI
application when you have a constant
stream of events which is changing your
UI so we thought okay remote drive maybe
it could
before jcpoa fix and we connected an
edema we'll see later to a mqtt broker
message King telemetry transport a
machine to machine connectivity protocol
for all of you who are interested in
Internet of Things so these MQTT is
quite common protocol for this yeah
let's take a look at I can make it we
saw in the F X component that you have
the handle method and you could do
everything in your handle method but we
all know separation of content and we do
simply not want those specific
implementation our GUI components so we
added the ability to have non quick
components so and this is the way how
you can integrate everything so simply
move your specific implementations in
such language component and integrated
while the internal message bus so the
good component does not know if you use
mqtt or WebSockets or whatever it only
knows okay I have to ask a non-void
component and get a result from an angry
component so here we have an example
jcpoa fix non GUI components always call
back components they have only one
handled method because they are more act
alike so you have only this one method
which is running in them in an old
workers fret and by default it returns
the result value to its caller component
by default if you say now then it won't
return anything and you can see that a
with the kind of dual-use you can use
this non UI component also has an qgg
callback component and also as WebSocket
callback component as small as always to
say with those two technologies you have
a kind of callback component if you try
this with pure Java f-fix you have
always the problem when the kaabah
component is executed it's not on the
ethics application thread so you have to
provide some kind of
your own implementation to be sure that
everything you you try to change in your
ethics application will be again in the
ethics of FX applications right so with
this you don't have this problem so in
the handle method we see who sorry we
see mainly we're checking for two
message types the first one is the
connection properties which will be sent
on startup of this application with the
connection properties we connect to the
topic and so on and the second message
is I I call the C point that simply the
coordinates of your mouse movement
always x and y and that's it and ours it
it gets those coordinates send it to the
topic and it will be released to all
connected clients you I we have a
component which simply has a canvas
component and it simply tracks the mouse
movement so what we do here is when you
move the mouse and you're on your canvas
we simply do not draw directly on the
canvas
we simply send the coordinates to the to
the message person that's it and this is
default Java fix code and here we see
okay send this coordinates to our
mqtt component the implementation you
can now simply switch to WebSocket or
whatever so you can leave the name like
this or simply rename it and now this
message goes that goes to the proko and
now to all connected clients and when it
comes back this callback component sends
a message to the UI component and then
the drawing will be started so yeah
encode it's like this we have here the X
component and every time a message it
receives a message it simply draws a
line from - and that's it
so let's start with a demo I would say
can you hear me okay
what I did here I started and MQTT broke
I think that's mosquito
and when I start for clients I've tested
this with more than ten clients but it's
difficult to lay out all those all those
windows here like to see in the demo
which will be provided to me get rape of
JCP of eggs you can choose whether you
want vertex with WebSockets while and
qtt demo so I put it everything together
and you can take a look at the code
first I connect you
I've also public service fee but I've
mentioned they are really slow depends
on the time you try it so and yeah
together with the with this internet
here simply connect to the localhost
here
okay when you start drawing you see it's
adding quite fast even with ten clients
it's no problem on this MacBook what I
wanted to say UI wise we're here
one main perspective have here a toolbar
with a clear button which you can use
and have one component here which is
simply the drawing canvas and the second
component here with a with the title and
with a color selection tool but the same
UI components and the same perspective
will be reused no matter if you used
vertex when you select vertex or MQTT
it's only changes the configuration
which which call the component to use
nothing else because the UI does not
know which implementation you use it
only receives messages and sends
messages to a defiant background
component so that's the basic idea
although I've here dummy perspective
which is a second perspective with the
same component the only difference is
here
the callback component does not know
this second component in perspective
tool because it only knows okay sent my
result to perspective one component one
and if I draw here you see okay the
other clients are drawing my client not
but when I switch to the first
perspective it draws in background and
for all the stuff I did know invoked
later or something else no ins threading
so everything simply with the components
and yeah it works quite well a second
daemon I want to provide us simply the
idea okay we would include everything of
a rich client project which they have
wishes which has Eclipse for example so
I started to look for which other Java
fix projects may fit well together with
JSP effects and one is for example beta
effects data fix has two main purposes
one is to fetch data and one is data
it's flow components so I thought okay
flow components are fine so I do not
have to implement it on my own so I took
more or less the examples from the demos
from data ethics and integrated into
into one component and yeah it worked
immediately so what we see here I create
this application from the from the basic
archetype we provide the basic archetype
provides two perspectives was two
components basically one perspective was
playing Java fix the second perspective
was FX ml but it's all it's always the
split pane but the only one vertical and
yeah divided and the same with the
components one was playing Java fix one
was ethics from hell and what I did here
I added a third component which is
simply text field and here we have the
data of extra tutorial one and data of X
tutorial two so I simply copy paste it
to this components nothing else so on
what we will see here when it changed
the state in this component it does not
affect the second component because they
are single compare perspectives simply
that's in different instance but what I
think what I can do is I can move this
component from one perspective to to
another to keep it to keep the state of
this component that's possible and when
I did this integration I realized okay
the data of X components may be isolated
from your framework so we did a plug-in
to go over the data fix guys so we can
now inject context of a JSP effects
application in the data of X and what
you can do now is okay this is a flow
this is a flow Wizard of data of X and
when I type here I simply send messages
to the injected context of JSP effects
to a different component so it fits well
and integrates well with their data
effects and I think without a project it
should fit also quite well so
yeah that's I think that's all we're
already late one short thing the outlook
what we want to do is to provide a
mobile embedded friendly UI because
currently the do for when you start this
application it's more for desktop like
so we want to take a look if it's more
fit in the mobile device world one thing
is that the message post it would it
would be nice to use network transparent
message was it was one of the first
ideas pubs and we're not sure if we want
to do this all the class load isolations
we're customers who asked for class load
isolations this is such a thing where I
can argue always if you need in a
desktop application class load isolation
because I saw a lot of projects who had
started with hibernate sri and then they
switch to hibernate for because of the
class load isolation of eclipse RCP you
had a five versions of hibernate inside
of them then it becames unmaintainable
simply so that's the question if it's
really neat class loader isolation but
we think of it and yet the next we'll
bill that would provide more demos and
archetypes on our website so go to our
website here the T and we have quite
fully documented it with examples and
some hog types but yeah it will be more
extended so it's all
so any questions yep if you try it with
those giant specification no because
simply I work all that they was always
GI oh no wanted to after that was
Jeffrey so yet could be possibly it
would be a valid way to use this class
loader isolation of OSGi and so on but
we have no dependency currently so I'm
quite happy with that any other
questions if not so we're done</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>