<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Security Starts in the Head(er) | Coder Coacher - Coaching Coders</title><meta content="Security Starts in the Head(er) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Security Starts in the Head(er)</b></h2><h5 class="post__date">2015-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/psQ-TzrNbLc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everybody and welcome to the
security starts in the header session my
name is Dominic shadow and I'm a senior
consultant at reaching IT in Germany
where I develop all kinds of java based
web applications and I care about
security and try to find easier ways for
developers like us to develop more
secure web applications so who view
actually has used one or another header
in a java application but its security
related or not doesn't matter at this
point I perfect a lot of you so you are
familiar with the concept because they
are quite a few of them and not of all
of them of course security related but a
concept is always identical so we need a
response object but it's in a servitor
servlet filtered as manner and we need
to add the header the header and of
course they had on its policy name and
policy value to being tired so the name
of the header that's most of the time
the easy part the value depends on which
header you choose sometimes it's only a
small bird and the other times as we
will see later in the session it can be
quite complicated and long the problem
of causes yes we are requiring the
powers of the user agent to understand
the header so the browser has to
understand what I had a means and how he
has to react on it but he has to do with
that and of course if the bouncers
doesn't understand the header doesn't
know it because it's the pauses to old
version or it doesn't support it well we
have a problem because nobody is then
enforcing the policy so you see already
one downside here if you put anything in
everything in a head-on and don't care
about security well if the boss doesn't
understand it you don't have any
security last
so keep in mind that the browser is only
one line of defense not your single line
by the one line of it it can help you to
improve the security of your web
application but it shouldn't fail
because the process simply doesn't
understand it defense in depth keep that
in mind so security at us I've prepared
five for us today ex-con ten time
options cache control x frame options
HTTP strict Transport Security and
content security policy the first two
are out a simple and then they get more
complicated and the final one content
security policy what let can be the most
complicated header you've ever seen as
you can see some headers start with an X
the others not X means hey let's not a
standardized header and not all browsers
are required to support it with a
standardized header it's a little bit
different and they fight different
challenges or security problems in web
applications so the first security
vulnerability I want to talk about is
type I downloads which sounds great
drive-by downloads you visit a web page
and something gets downloaded by the way
if it's an executable you also might
even execute it and one way to prevent
that is the x content type options
header and I'm sure that a lot of you
have heard about I fed our nodes because
it's affecting more less only one power
zone anyone want to take an educated
guess which ours I'm talking about here
I'm sure you're all thinking about
Internet Explorer and that's correct X
content or drive-by downloads our
problem in internet explorer so what
happens wouldn't drive-by download take
this HTML and return it is plain text so
your content type
is text plain and what you're thinking
about is how you parse is going to
display your text file and you don't
want to see any HTML if you set a
content type to text plain and this is
how it looks in almost any parcel it's a
text file even if it contains HTML I'm
using OS X so I don't have an Internet
Explorer there but this is how it would
like in an Internet Explorer in an older
version without the X content have
options head on so the browser actually
sniffs into the response ignores the
content type and thinks oh it's HTML
let's kinda it and let's display it and
that's drive-by downloads imagine this
is not HTML but an executable so you
burn also launches the executable right
away you don't have to do anything you
simply loose it a page as I said this is
only a bob lemon Internet Explorer and
it is normal web applications not a
problem up to the point where your users
can upload content and participate in
your web page it's still a problem so
with Internet Explorer and if your users
can participate so they can upload files
even if it's as simple as uploading text
files or PDF files or images they can
trick you by simply naming the fire from
executable 2.jpg for example and then
ever that I fight or not so set this
header and this is how it's done X
content have options and there's only
one value so this is a really simple
header no sniffs but also asked I said
it's only internet explorer the go guys
they decide here let supporters header
and the others they don't support it
which is not necessary because other
bars don't sniff so they can simply
ignore it and this is the nice thing
about most of the Enna's if a person
doesn't support it he usually ignores it
so there's no downside there's no
additional security of causes on the
website but your website or your web
application do not break your power
simply ignores the header and continues
to vendor the rest of the page but you
can see here is that I don't mention any
versions this is a difficult topic when
it comes to security had us because it's
already a collectively hard to find out
which browser supports the header and
finding out which parson version
supports a certain era is even more
heart you will not find too many
documentation on that so the general
rule of thumb is the new the powers are
the better to support some overhead us
are supported in most puzzles the next
problem is sensitive data it gets stored
on your client so you are serving your
HTML content Oh an HTTPS connection it's
secured lens but everything is secure
from your server to the client but then
your pals are caches the data so if
you're in a public computer the next guy
can log on and can check the temporary
internet files and have a look at what
was served before so you can discover
all the protected date how you don't
want your client to store just one ahead
of her net cash control and this cache
control is an additional option to your
browser cache normally pauses are set up
that way that they don't store https
connections on disk you can change that
and so you need a right to override it
with an error so use cash control and
instruct your browser explicitly i do
not store https content and as you can
see here this header gets already a
little bit more complicated we are only
talking about in starting the
also to not store https continent disk
we need a little bit more the header
name is cache control and you should
serve all three values mentioned young
no store no cash and must be validate no
store takes care of not cashing any
regrets of response data no cash takes
care of not storing any files on disk
and must be validate leads to the next
head apart at date header expires minus
one that's nineteen ninety nineteen
seventy so the content of these pages
already expired the moment we ship it
and the browser has to check this header
again and has to download the data again
yes so this may be a dancer at the
question was whether no cache takes or
influences even static files like images
and send data it doesn't change between
requests yes it does so this header
might have performance implications
because what your browser doesn't catch
any more depending on what data is
contained in the response so this is a
trade-off between security and
performance you have to choose so you
might want to be careful where you're
serving this error I'm sorry okay yeah
kashkin colossal support looks good keep
that in mind that's not too often the
case every browser is supporting cache
control and you said it so even older
versions of parts of cache control
headers being around for quite a while
now so use it
the way the next one has a nice name
it's famous for click checking which I
do not really like because it doesn't
sound like an attack does it I mean it's
you I redressing attack sounds much more
dangerous because of clicked chatting
you saying think hey the user clicks on
something he is not intended he does not
intend to do and what could possibly go
wrong here so you I retracing your tag
is the much better name and the
condemnation is called X frame options
header here keep X frame options header
in mind because we're going to talk
about that later again when we talk
about content security policy so how
does you I redressing work but typical
scenario you have to login form you
create a page where the usual has to
login username password to text fields
or one peso fillion one text field in
the send button yeah and attacker has a
similar idea so what an attacker does he
creates a more or less identical looking
page and what I did here on purpose is I
remove the labels so you can only see
two text fields the upper one for the
username lower one for the password and
you can see a scent button and what
happens with you I redressing well take
an iframe for example and if so layer
technology and some opacity so what
happens is an attacker takes your
content your UI you form and adds
another layer on that with this fake
form so you have two forms above or
another and I use the peasant a year to
to show you that in this case you can
see the lower form you can see both
forms in the screenshot so a normal
attacker wouldn't do that he would
completely hide the original form and so
he embeds a page or a form inside your
page
from normal user it looks like he is
entering his credentials in uniform he
clicks on sent and the attacker that
leaves the user data is good engines so
send actually leads to an attacker
control page and not to your login page
in the next step what an attacker can do
years well answer with an elbow paige
Taylor user sorry the application is
down for two three four days please come
back later and in the meantime the
attacker can use the users credentials
he knows the username and he knows the
password now so you I redressing is not
simply a user clicks on the like button
on Facebook he doesn't want to do it can
be more serious to gain use of your
engines so it's pretty serious and we
need something to do against it and yes
the X frame options head up with deny
this had a means that you page your
login form in this case is not to be to
be it's not allowed to be framed in any
other page so no page but it's your own
on an attacker controlled is allowed to
frame your pages which would prevent
click checking because it's using
iframes with deny you have to keep in
mind hmm that's affecting your own page
as well so inside your host inside your
domain you are not allowed to use frames
either nobody is let's deny it turns off
all framing so in case you need framing
on your page inside your host you can
use same origin as an alternative value
which lets your page frame its own
content and nobody else the third option
is yeah you have an allowed forms from
certain you I so you can specify an
external UI which is allowed to use
frames or use a frame your content keep
in mind that your I supports only one
you
so there's no comma separated list it's
only one you I if you have to allow more
than one you have to specify the header
more than one but you shouldn't use
allow from you I anyway because all the
mouse's support deny and same origin but
allow form is only supported in Firefox
and Internet Explorer so stick to
normally you don't use frames anyway so
stick to deny or use same origin if you
have to support it since click checking
is pretty serious and you have to test
that which might be a little bit
difficult at first there's no as project
called click me this is a really simple
project it's a charm and the only thing
you have to do enter your application
you are and what click click need us or
it tries to up to iframe your
application so if click check click me
succeeds your application of vulnerable
to click checking this is a good start
if you're new to the topic and the
moment you have seen the HTML code used
for click tracking test well you can do
it easily yourself but if you've never
used it before I recommend using collect
me okay time to see some of the headers
in action and I've prepared a little
demo application which I will show you
at first this is more or less it ex-con
tonight options the drive drive-by
download stuff doesn't make sense here
because i'm not using internet explorer
so I don't receive any HTML in here the
other had us make more fun and more
sense here consuming a little bit more
so cache-control is always an
unprotected version and a protected
version and I will show you in code how
this looks like in a second
no ok the question was whether or not
the Dark Matter downloads data is coming
from so it's coming from anywhere you're
taking likes so it's not all head us our
effect effect client side only and the
data current come from and I take a
controlled server any any server that's
reachable via internet so it's normally
never your own application because the
attacker has its own web space somewhere
and he uses that to surface malicious
content so if you look at cache control
I have a look at the Firebug console
down here I know it's hard to see from
bank but what you can see here is its I
try to zoom in these are two requests so
it display here you can see two requests
one for the JSP and one for the styles
so keep that in mind and let's click on
send okay login successful that's faked
here and if we if we return to the
original page you see there's only one
request left so the power uses the cash
is not trying to connect to the server
again and retrieve the the the HTML page
of the tasty page in my case yeah you
can see it's cached and if we use the
protected version you see here to
requests again and if you click on send
and now return you'll see that we
actually have
to requests here and that's the
difference the part of this way doesn't
store any critical data on disk so he
has to connect or contact the server
again to do that and if you check that
in code but it's easy what I've done
here is it's a servlet filter so the
only thing you have to do is create a
service photo and normally you wouldn't
use URL patterns that strict as I did
but because this is a demo application I
need an unprotected version and
protected version so generally you would
use / / star for Hannah to affect your
whole page or whatever pages need to be
protected and then the rest this is
shown in the slides use cash control
with this the values no store no cash
must be validated and adding expires
with minus 1 and you are all set the
next part is the UI retracing attack and
I don't need that here just looks
strange no okay and it's because of the
soup you see it falls apart when you
assume too much what I've done here is
these are actually two forms and the the
yellow or the orange part in the red
part are provided by an attacker using
this so when you think you're logging
into to your page it's already fake
looking so it's going somewhere else and
if you use a protected version again it
looks a little bit different so you can
see that the labels are missing and it's
still the fake login form but your
original page is missing and this is
what prevents click checking because i
am not allowing my original content my
login form to be i framed and if you
look at that in the code it becomes
clear
explain options so again the only thing
i'm adding here is the excellent options
deny header with specialized you are
pattern in this case but if we look at
some code this is what i try to achieve
on a tiger would try to achieve this is
my iframe this is my original login form
and the attacker would use diff
technology for example with an layer and
add a fake login form so what happens if
i surf the the ex-prime options head is
this part isn't is ignored so only this
part here the diff is going on inside
the page so i need a fake login and the
normal user would notice that in this
case okay let's see the next laid on so
do you have some relatively easy at us
and it's a promise that gets a little
bit more complicated now because now we
are talking about sensitive data so with
cash control we prevent the browser from
cashing sensitive data on disk and now
we need to serve this sensitive data of
an HTTPS connection and the problem with
HTTPS is that most users don't enter
HTTPS most users don't enter HTTP they
start with www and they run so htps is
required by the users don't enter it of
course you server can do a redirect
which we always need but the first
request initial request is HTTP so the
data is unprotected now imagine the user
logs in you serve a week conium be
directs him to HTTPS and everything is
fine the user doesn't load off and comes
back later he enters
uwin and the server's connect contacted
with HTTP so that transport is not
protected and you want to avoid it
because at this point we have user data
a session ID in place which we need to
protect at any time so we need to make
sure that following requests after Rita
reg are always based on HTTPS yeah a
one-part yeah the comment was that if
you protect your cookie with HTTP on
it's a secure only it's all secure flag
it's only travels through a secured
connection that's what you should do
additionally to the HTTP strict
Transport Security header because
sometimes you don't use the session IDs
don't store the session ID in the cookie
you storm and you are but you shouldn't
do but sometimes in hems so you secure
on your cookie that's a good comment and
use hsd s HS TS is my relatively new
header and what it does it takes care
that you stick to https so there's no
fallback to HTTP and what happens is the
first contact to the server maybe HTTP
parser sends a redirect to em the server
sin salida egg to https you serve the HS
TS hera and all following Rita and
requests and responses are always based
on HTTPS so there's no fallback even if
the user doesn't enter HTTPS the powers
of redirects in automatically to https
so there's no initial request that's
unprotected everything's are protected
and what you need to do is but at the
strict Transport Security era and set a
max H parameter next age is a countdown
in seconds
so this is a vm a one-year a long period
and that means that the HST s header is
valid from one year of a half year your
powers are keep the local registry and
stores https house and the coast that
use HST as header chrome for example
already comes with a prefilled registry
with known HST s hosts your normal web
application isn't part of that so you
have to add that by serving the HST sno
this header is relatively easy the other
option but you can add is what include
subdomains so if you're using
supplements that should be protected as
well simply add includes up the man's
Newland why am I specifying such a huge
time here one year or half a year that
sounds pretty long well if this
countdown expires the initial V quest
wouldn't use the HST s header it would
fall back to HTTP and you want to
prevent that so use a large value here
half a year or one years the
recommendation if a user doesn't visit
your web application within that time
well that sounds a little bit
unrealistic so after year one year
should be enough but you should avoid
that this header expires or discount on
expires because think of users going on
holiday or not visiting your application
frequently you armand avoid that they
contact your application via HTTP at
first and at any time you return this
header this countdown starts again so if
you user with your situation is one year
and your use of this it's your
application after two weeks again the
countdown starts again and again and
again
the question was but it's not enough to
set this duration to this session
timeout think about the next session so
if the user well you want to serve HTTPS
content all the time so session timeout
is too short because the next week west
will be on HTTP again you want to avoid
it all the time to use it doesn't look
out you have a problem use a longer
period I would recommend half a year
that's there's no there's no problem
there's no downside on that so the
process does it there's no buffer
overflow memory problem if you use a
large value for that give up I well it
has some impact and well HD h st as well
first of all it stops in secure
communication and it's only active if
you serving your content of an HTTPS
response so this header is not active
when you use an HTTP response it's not
doing an HTTPS week redirection
automatically so if you saw your server
still has to serve a redirect the user
to HTTPS and then the header becomes
active what you just let me finish this
one and I come back to you what you need
to do is all resources have to be
accessible via HTTPS so there's no mixed
content or should be no mixed content
anymore so if you include stylesheets
images and stuff like that and your page
you need https for that as well your
browser can't block in secure
communications a chest years now and
finally this is a way of getting rid of
all these self-signed certificates
because they are invalid with h st s so
you need a certificate authority signing
your certificate which might cause
problems when you have a development
machine which only uses self-signed
certificates this decision whether or
not it's blocked
is up to the browser so different paths
may handle that differently but in
general the advice is to use valid
certificates even for development
machines yep security and development of
performance are most of the time a
little trade-off and yes one are above
the Muslim one thing you have to be a
rare of not a real problem the head as
I've shown you so far I egg type for the
response they are edits to so if i use
as before x content i'm options header
phone response and it don't use this
head on the next response the head is
inactive so the headers are always
active for the response they are
contained in except HS tears h st s is
always active for your whole domain so
all your domain you complete the main
needs to be accessible via HTTPS this is
performance implications normally
because h st s is a little bit more
requires more power server side you have
to be aware of that fact yeah the
question was how can you disable HST as
hannah set the time duration to see low
when you set this makes H parameter to
see her your power zone will remove your
page from this parts of registry and he
will not try to contact it to h via
HTTPS again that's the only way to get a
little bit yep yes
I'm not sure about this at the moment I
think it's if you don't include the
include subdomains head it's only egg
tie for the current domain but if you
use these include subdomains and you use
it for one subdomain its egg head for
all the other sub domains as well so you
have to be careful about that too if you
have an application it contains several
sub domains well support is looking
relatively good with one exception of
course there's always one exception and
at least internet explorer doesn't care
about it so there's no you don't benefit
from HS TS but there's no problem with
it so use it anyway if you if you pay
just delivering content via HTTPS okay
the last header is actually the biggest
one and it's fighting a huge problem
cross-site scripting cross-site
scripting is dangerous and it's very
common and it's hard to find and a
Content security policy header is one
way of fighting cross-site scripting and
it's an addition to the other ways so co
site scripting in a really really
natural and atanga injects javascript in
into your web application something like
this so it's a script that takes your
document.cookie the cookie form that
contains the session ID on the client
and add it to you all and tries to load
an image from that you are so the
attacker control its evil to calm in
this case and he'll this the session IE
from a victim so the first step of an
attacker can be to inject that data into
your web application your web
application stores it so
injecting happens that way that the
attacker finds an input text field that
doesn't do validation the data is in
your verification installed in a
database then comes the EULA and he
visits your page and the militia state
under the attacker has included gets
served as well so what happens but the
strava script is executed on client side
and it takes the document cookie the
session ID and sends it to the attacker
this is called stored cosine scripting
because it's stored in the database the
other possibility would be that the
attacker simply sense that JavaScript to
the user in an URL for example user
clicks on it the javascript is sent to
the server returned to the user and
executed his puzzle again let's reflect
it because it's not stored server side
and the server simply reflects it same
Chavez good same story who r sine
scripting so but the session ID the
attacker can pretend to be that user so
if somebody few logs in and I'm a rare
for your session ID which jsessionid in
JAMA I can pretend to be you and as long
as the server doesn't ask me for your
password which I'm not enough i cant
pretend to be you so maybe at some
online shopping site i can look but you
have purchased i can look up your
address maybe i can even change your
password without entering the current
one so you are out of the game land so
we have to find cosine scripting and as
you can see from the subscription course
that's getting a serious so content
security policy only helps you in
fighting it but you should still do
input validation output escaping and you
have to protect your session cookie and
in addition to that use content security
policy and this is where it gets a
little bit complicated because content
security policy is rather complex this
is
most simplest case you can think of and
they had a Content security policy and
defaults or self defaults or self means
load only content that is coming from
the same domain the page is being served
up everything inside my domain is okay
anything else not this includes images
CSS diets JavaScript funds whatever you
can load in a web page and what content
security policy does by default it
blocks inline scripts in Einstein's and
eval functionality so even methods are
not executed inline scripts remember the
the script I've shown you before the
attack enters so the script containing
script and never get for anything the
source file with drama script that's an
inline script because the moment you
enter it in your page it's somewhere in
line it's between all this HTML it's not
an external jrs fine that's an inland
skirt and this is blocked by default so
at this point this JavaScript wouldn't
be executed even with the simple header
we've used here the problem is i'm
pretty sure that your web application
would stop working at this place this
time because think of all the external
resources you are using javascript
you're learning from external domains
that are included in your lips and need
to be loaded jquery for example images
coming from google and stuff like that
everything would stop working so you
need a whitelist and this is where
content security policy directives and
to the bleh you are already aware of the
default sauce this is the most common
source and it's active if you don't
specify anything special so there are
more than that if you use object sauce
for example it overwrites the default
sauce
if you don't specify script source which
falls back to default source so if your
default source contain self everything
that's coming from your host then script
source if it's not specified but contain
the cell the same so default source is a
good start set it to self or none and
then specify the rest you need what you
do with these directives is you add URLs
as a rival list and if you want to load
images from for example from istockphoto
or something like that and one loaded
life from that page well you have to add
my list that you are and you have
several possibilities to do that there's
the star which serves as a wild card
it's not a good idea to use that because
it simply allows anything out there so
be as quick as possible and fill this
void list s required self is your own
domain none means nothing then you can
specify the domains you can even say hey
only HTTPS for example and this is how
your whitelist begins to grow and this
is even an unrealistic sample but it
contains some more URLs the directives
are edit the header gets bigger in a
normal application even if it's an old
especially when it's an old one this
list would be huge so at the moment you
add this header to your application all
you are doing is you're searching for
violations and you try to fix it by
adding this URL to the wine list and you
loose curls and goes and goes and goes
so especially with content security
policy it's better to start from the
beginning with new applications and
don't apply to all applications and
since I was talking about violations
already content security policy blocks
it so if it's an external URL that's not
why I listed the image is not loaded for
example and you are not informed
that is a develop of this web
application and that's my they came up
with policy report only so he pond only
is a report only mode and it sends
violations to the leappad you I you
specify the directives are the same as
before but you specify you I where the V
pots are the violation reports should be
sent to that's a simple post you are and
what you receive is chasing it looks
like this you have to refer that coming
from what was blocked the directive and
the sample for it in the sky scripts and
the third line from the bottom so you
can see what violated the directive and
if it's necessary you can fix it if it's
a legitimate determinate request you can
fix it but keep in mind there's a
difference between content security
policy and content security policy me
part only kind of security policy blocks
report only be parts it doesn't block so
we part only is for testing use it in
your test environment have a look around
whether your application still works and
then we move we poured only and set it a
Content security policy because it v
parts and it executes so you don't want
to have that in production but you can
combine that you can say hey okay i'm
using content security policy so it
actively blocks dangerous data and you
can still have to reporting so it kind
of security policy support sleep at you
i as well but be aware of the fact that
you get more or less flooded if you have
a much used web application that you
have a lot of violations in their attack
us you lock wilco so use this for a
certain time to make sure everything
works and then get rid of it and there
a nice may public web application it's
available for free called cast bio but
you can upload your chasing violation
teapots and it provides you certain
possibilities of analyzing it so you can
have a look but violated the page
Wendy's Adam violations occur and how
frequent they are so this is a nice way
of making more sense of discrete parts
browser support yeah it happened again
so with four bars is supporting it and
with partial support at least partial
support Cynthia ten ie10 with the other
browsers the more modern the versions
are the better the support so I think it
started with comb 25 for example so you
have to use the latest versions to make
full gain full support and the next step
this was content security policy born
that's level two which is a candidate
recommendation at the moment this will
add more possibilities and if you
remember the ex frame options head upon
before fame ancestors no part of the
content security policy level two is
going to replace X frame options header
and if you keep drag of dead mesilla and
now it's a couple of weeks ago that
explains headers debt or debt-like they
duplicated it well yeah since must allow
Firefox is the only parts of supporting
content security policy level two they
can say that any other browser isn't the
valve CSP letter to at the moment so
what you need to do is but keep x-ray my
options header and if you want use frame
of frame ancestors or CSP level two you
can surf both at the same time the
browser should choose which one to use
reflected XSS is a replacement for x XS
s protection head on which i will talk
about in a second and there are more
options with level 2
so I have kind of mixed feelings about
that because CSP already gets
complicated you have you may have a long
head of value and the more options you
add the longer this gets so yeah handle
of the head of it with care and I think
of all the wideness you have to add and
to maintain of course so this is the
content security policy in level 2 with
claim answers desserts replacing X
content I'm options from before only
active in Firefox ok time for another
demo let's have a look at these headers
it as well and what i'm doing here is
i'm using reflected exercise so what you
can see here is that in it that my you
are contains a parameter and serves
javascript sm regressed had a parameter
and the part of course executed so as
you've seen it gets executed and with
content security policy in blaze it's
blocked so if you have a look at the
page content side you can see it's in
here the script is egg type but the
power so simply doesn't execute it so
it's not cut off the parcel simply
ignores it and the difference is as I
said before we put only while it
executed and if you look at the console
give me a second to zoom in here's the
violation of a pod so that's the lively
part from content security policy but it
was still execute it to keep that in
mind the the content or the Java code
looks the same as before so it's it's a
simple header which of course in my demo
application is short it's only defaults
or self and I don't have to whitelist
anything else it's not a realistic
example the stuff here is content
security policy level to which looks a
little bit different from before this is
the same content as before and I'm
afraid it's in German but what you can
see here is that Firefox decided to
block the iframe and this is the x
content type of x frame options from
before so you see a huge morning for the
user hate as a Content security policy
violation on this page this is what an
end user will be confronted with and
that doesn't make sense for an end user
it looks dangerous so you will hopefully
move away and doesn't enter any data
because this one still works not in my
demo application but it would sense the
date as well I'm sorry ok the question
was whether this security report date
where the security repo data is sent to
and this is done in here CSP reporting
and in my case this is a servlet so it's
server side and in a normal web
application you would retrieve that in a
lock so you can access it on your server
side and use this Casper I oh I've
displayed before what a use you can see
if he is a welter of fire back you can
see there as a violation in here so
if you use the console you can see a lot
of violations but no normal use of which
ever look at firebox so content security
policy is well a normal user wouldn't be
aware of it okay so I was talking about
xxs protection before and as as you've
seen that Internet Explorer doesn't
support CSP there's one simple header
you can add x XS s protection with this
value and Internet Explorer will block
some co site scripting attacks only some
reflected ones but it's better than
nothing so soft that header as well soft
both yeah well that's an internal
implementation in internet explorer he
has some xss detection so if you use
javascript sqlparameter as i did before
it will block that normally it's not as
sophisticated as other browsers work for
CSP but helps a little bit okay the
question was how tools supports usps
policies well you can have a look at in
so you can use an intercepting proxy or
you can use Firebug to have a look at
them but i think there's no attack on
death at the moment okay give me a
second i will show you something for an
end as well first of all remember to add
these headers from the beginning don't
wait till the last moment because
especially with CSP it influences your
page design you have to be very strict
you have to separate your chase and your
javascript in external files CSS in
external files you have to write lists
all these URLs
so do that from the beginning don't wait
until the last minute because that will
fail and create a solid filter the
examples I've shown you all use servlet
filters with relatively strict URLs at
the moment only for this demo I
recommend create a single server filter
/ header you serve and then restricted
to the do you are you are else you need
this way you can easily copy the server
Phyllis between different web
applications and you can reuse it and
you can enable and disable them as
required it makes it makes handling
easier or in case you're using spring
security 3.28 a lot of these headers
automatically accept content security
policy content security policy adding
the header itself is easy it's just
writing content security policy the hard
part begins after that because you have
to make your web application book
working again so you have to add CSP
manually and after you've added these
headers yeah make sure they are served
and contained in the response because
sometimes the boxee might cut it off
firewall might block it or something
like that so you want to make sure the
client actually it gives you said us and
you can either do that manually with
Firebug for example which I recommend if
you have a web application that's
accessible via internet you can use
check your headers and enter your URL in
there and take that box at first because
you don't want to appear in the worst
reason scores list make sure you have a
good score then you can show up there
and if you don't have an application
that success provided well as Chrome
extension contracts like security
analyzer which should help you and this
should answer your question from before
EIT ticks it gives you this nice little
green check marks that everything seems
to be okay so
this is an additional check that can
make sure that your application is okay
an always remember ya head us they make
some vulnerabilities harder to exploit
but especially with cross-site scripting
you have to do a little bit more use the
head us use them in addition to your
other countermeasures and always
remember as security starts Mara but it
doesn't end there and with that thank
you very much for your attention and
have fun with secure development</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>