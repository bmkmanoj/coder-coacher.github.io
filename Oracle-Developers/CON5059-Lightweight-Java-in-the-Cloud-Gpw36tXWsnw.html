<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CON5059   Lightweight Java in the Cloud | Coder Coacher - Coaching Coders</title><meta content="CON5059   Lightweight Java in the Cloud - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>CON5059   Lightweight Java in the Cloud</b></h2><h5 class="post__date">2015-12-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Gpw36tXWsnw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so welcome how you doing after so many
days of java one I am bushed like
seriously first it's too much this days
left so my name is Sean Smith I'm with
the application container cloud team at
Oracle and with me is my colleague
Garrick moon wold Gert you are
technologies evangelist at all go it's
tits down yes yeah yeah and so we're
talking about lightweight javon the
cloud and we'll talk about a few things
I mean we're going to have a few
conceptual things and then we'll show
you some type of real things real
architectural issues that people to
address for a number of different
vendors so it turns out that there's a
lot of job in the cloud today already
people are going there and adapting to
the environment so I went about the
environment what takes your application
in the cloud what takes to run it there
and Garrett will give us a demo of a
small sample a building talk about the
experience of taking it to the cloud cuz
I think you had it running off cloud
yeah and then took a to cloud and and
he's still with us and it so he's
smiling still still in love good so the
first thing i should say is if you
haven't seen this i'm sure you've seen
this please don't buy anything based on
what i say things could change and not
into my control so like I say people are
building things for the cloud today
right this is not a new thing people are
this Java in the cloud and it's actually
really good for in the cloud I mean the
most the vendors out there have Java
support so you go any of these cloud
vendors small cloud vendors Java is
there right now why people are going
there is for the obvious good qualities
of the clouds right high availability so
you've got multiple data centers with
good availability failover dr strategies
all kinds of stuff so we want you to
have application somewhere secure well
the clouds a good place right so it
makes it makes total sense it also turns
out the relatively affordable I think
it's a lot cheaper to rent a few cycles
on a cloud computer than it is to buy a
server right even the internet
connection itself will cost you more
than it cost me to run an application in
the cloud for
from so affordability is a big thing
ease of management I think that's more
aspirational I think everyone would like
to have ease of Management and you can
judge for yourself whether you know some
succeed and some don't but the theory is
that then the cloud management should be
easier for you right managing the
software rather than managing the
hardware at least is easier for sure and
then the big thing that I think people
maybe underestimate or under discuss is
the cloud ecosystem so if you look at
the various clouds out there they all
have additional services whether its
databases messaging object storage
whatever if you're building application
of the cloud and call you cloud native
applications that leverage these
services that's why you're going it's
much easier to consume these powerful
services and use it leverage them in
your applications because they're there
in the cloud just sort of a la carte
right you say oh yeah I want some
database I want some no sequel database
I want messaging they're easy to pick up
and use and incorporate your app so it's
really nice to take your java
application step platform and then use
those services so it's quite attractive
and I think if you if you haven't tried
it when you try it you'll see what what
what I mean no I wanted to find cloud
and I think this is a kind of an old old
slide instance I wrote this last night
or yesterday but I wanted to define my
terms so we have is infrastructure as a
service software as a service platform
as a service so i'm going to talk about
application platform as a service or a
pass right so specifically focusing on
running applications which means i'm not
talking about clouds as VMS where you
would install java vm run your
application the kinds of clouds i'm
talking about these APIs clouds are you
bring your application and then the
environment is provision for you you
don't have to manage jdk you don't
manage all these things you bring your
application they're very focused on
running your application in the cloud
not making you manage a lot of
infrastructure
okay so it's a it's nice because it's
easy to use and typically their
container based so everyone's used to
dock are now in Linux containers before
that right running your application of
container on a cloud is quite
straightforward and this is what all
these all these cloud servers was doing
even the oldest guys around there people
like her uu KU and running your
application in Linux containers for
years before they really caught on right
doctors made out there I made easy for
everyone to pick it up but it's been
going on for ages and although you seem
a bit of consolidation around Dochart
it's not a done deal right but this is
where things are running a good thing of
a pads platforms is there's lots of them
and i'll talk about a few those you go
through and i were for oracle okay so
submitted remember the slide i refer
oracle but i think you'll see that the
comments from the different vendors
different cloud providers are pretty
consistent we're all pretty much on the
same page about what we think these
clouds look like and that's encouraging
I hopefully if we're on the same page or
we're all up to lunch together no I
actually don't know if a cloud vendor
doesn't support java so i don't even
know why i said most i think they all do
some of these cloud platforms have come
out of other languages but job is there
everywhere you go so let's talk about
the meat so the real issue here is if
you were to bring your java application
to a cloud platform what does that mean
like what do you have to do you have to
do anything like I just take my java app
and i give it to you and it runs not
exactly although ideally so you think
your java application is ok it's my app
right like you just have this
application but it's a heck of a lot
more going on there's a lot more stuff
that we do or pieces of the application
that we tend to gloss over which become
really big deals in the cloud because
moving your application from your
desktop will you control everything or
your application server environment
where you own everything to a cloud
where you're in a box and your
application runs in that box it has to
plug into that world but you're in a
container and the services you have to
consume you need to be able to recognize
that this distinction between sort of
local on-premise and cloud so the first
big thing is your configuration
right so your application has a bunch of
config in the past we've had a lot of
XML files right one got very excited
about XML files then we get tired of XML
started writing JSON files the animal
files whatever but there's a lot of
configuration files and you have to
really recognize what in your
application is config and which is your
application so you make it have to make
sure that in the cloud environments for
java app that you have factored out your
application configuration you can source
it from the outside world because if you
move your application to environment
it's going to change all right so if I
were take my application here and deploy
it in 20 come to the beginning ok ok I
won't I'll move the mouse off the little
bottom partner ok so take my application
I deploy it into into dev I have a dev
configuration dev database dev whatever
server is messaging all these real stuff
right same binary this is the component
return to write you won't take the same
binary and deploy to dev I want to
deploy it test I want to deploy it to
prod I don't want to recompile that that
operations guys don't want to mess your
code they don't want to know what your
code looks like all they want to know is
what are the required inputs to
configure your applications deployed for
the environment you're trying to run it
right so you have to build your
application that way you know
applications to be parameterised right
environment has to the configuration has
to be has to be pulled out so we can
parametrize your application with the
environment so i can move it from
environment to environment the easiest
thing you easy way to do that and the
way you see most I think pretty much
everyone does it is environment
variables super low tech all right so
some of these techniques are slow tech
the environment is contains your
configuration typically so I can take my
application I'm going to deploy to prod
I set up the environment where the
database is and deployed yet and start
the application that picks up that
environment I move to dev or well
obviously i'll go all the way around but
i move between the environment and i
change the environment variables and the
application picks it up and no xml no
json know
oh nothing pretty much application or
environment variables is really all we
have is because it's so simple and
portable right works everywhere now like
I say the important thing is that ops
wants to manage your app so think past
yourself think about past when you own
the application think about when you
hand over that binary to someone say
here's the binary I want you to apply it
someone else's job is to make that thing
work you have to make it so that they
can configure your app so here's a quote
from her I'm being being a
non-partisan they're talking about the
concerns of in this case putting
credentials into some config file right
you don't want this stuff and config
files in fact that configuration I'm
talking about shouldn't be in your
source code source control repository
because the old days you see some people
do this they have oh I have a flag dever
prod where I have two configs Deborah
prot that's nuts you've got production
credentials in some source code
repository somewhere I don't think so
right that fact those credentials are
part of the environment the environment
definition includes the credentials for
your service you put the service there
except those credentials and goes to
where it's going to go right so managing
your career configuration independent
the binary is critical even produce the
security concerns like this
openshift guys same thing right there
there's making the point here I'm making
which is you want to have all this stuff
pulled out so you can be any these
applications around so really no I'm not
saying this everyone's saying this and
you'll find that for java applications
no matter where you're running them this
will be something you're going to want
to do it's going to be environment
variables which might be a bit of a
shift because I've used all those
frameworks to read property files before
but they're kind of gone away now I got
a couple of samples here of what this
looks like so here's a little grizzly
Jersey app this is it this is all I've
got this is a very small application but
you see here that at the top we're
reading the environment for port and
hostname right so I got I got a little
rest application here actually this is a
web application running on grizzly and
Jersey and I have to I have to put
environment on picking up a few things
in the environment what port should I
listen on right what's the hostname I'm
going to bind to you see how I put some
coding here saying well if I didn't
define in the environment well then go
to local host and maybe 80 80 because
maybe I'm running out on desktop
probably that's even a bit slack right
but I'm picking up the environment and
after that the application is happening
so what you see is if you look at risley
in Jersey this next one here is tom cat
embedded Tomcat same deal pick up the
environment your variables from the
environment and plug them into your
application what's amazing is this
actually it is starting to bed at Tomcat
so if you never seen embedded Tomcat
this is starting a tomcat instance
running adding a single war file which
is pretty pretty cool so it's nice and
light very small embedded tom cat app
zipped up with all of its stuff is about
5-6 Meg minimum size it's pretty small
okay the other thing to think about
there's a few things to think about so
you've got your configuration out of
your application second thing to think
about is your dependencies all right so
you know some not time with Java a lot
i'm talking about the environment right
this is the theme the theme is that so
when you run your application in an
environment where are you getting your
dependencies from what are your
dependencies do you know what they are
and are you in unintentionally picking
up your dependencies from the
environment which would be a bad idea so
your application should be explicitly
declaring all its dependencies so they
can be managed so we can be adjusted for
the environment you're running in what
you don't want to be doing is picking up
system-wide libraries so imagine you
deployed and I actually have this
environment this and the issue for you
is going to be like Neelix libraries
that are native libraries you depend on
it's kind of hard to deal with this but
you don't want to be picking up these
libraries because when you change
environments who knows what's installed
in that environment right how many times
we've gone through this where you deploy
an environment to an environment you
find it doesn't work they're like why
not so one of the principles of sort of
Java in the cloud is having explicit
declaration of all your dependencies
that can be tracked and they basically
it deployed along with your application
nothing in the application nothing in
you're in the environment of you picked
up now of course if your Java person
this is not that challenging for you
right because you've got maven Gradle
and whatnot do dependency management for
you so this is not a hard one to do but
it's still critical that you have
explicit dependencies declarations for
your applications
this one I had a hard time come for the
name for we're just I just changed it 10
minutes ago so a service interface this
is the thing that you expose to the
world so your application it provides
rest api zor provides a web application
or whatever it is is the interface it's
a service you're providing to your
clients whatever that is and doesn't
think about what what you expose now if
you're building rest web web socket type
applications as you saw in those tomcat
and Jersey samples you're basically
binding to port you're exposing your
service the question is where do you go
like what does it connect to how do you
get it out so if you're using these
kinds of things it's very easy to do as
you saw me doing the samples like find
out the hosts report oh yeah connect to
that because what you see in these
environments is you're running in a
container and that the name of the host
in that containers but a doctor is like
some gobbledygook generated hostname the
port you're listening on is not the
public port somewhere there's a public
port on the Sun load balancer that your
customers are talking to and that
traffic is being routed to you in a
container so there's a disconnect from
the real world from what your applique
environment your application runs it so
you need to be prepared to be flexible
about the environment you're deployed
into knowing that your traffic will come
to you but how you get there is not
clear now what it turns out that this is
a common thing across almost all these
cloud platforms and they all have a
dollar port member accent environment
variables for configuration so they use
dollar port so you can go to I think all
of them are suckin dollar important is
just going to work because that's what
we all seem to agree on is the de facto
standard something you got to do
what else let's about that's that's
enough for that one talk the last the
last piece here so service dependencies
so your services applications tend to
consume other services right so when I
first had the first slider district Java
but yet you're like yeah my job
application it does this job it turns
out yeah we have configuration
dependencies you the services you
provide and how they bind to those
external worlds and then all the
services you consume all right whether
the database or messaging all the things
you use and again in the cloud platforms
this is what you typically do want to be
doing is consuming these services
because it makes it easier for you to
build your applications so you need to
be explicit about these also you need to
know what they are and what you want to
do is you want to make it pluggable you
want to make sure that your again like
like we had with the environment
variables you want to have the
coordinates of your services available
to you in your environment through
configuration so where's the database
right what is it what is the host name
of the database what is the port I'm
listening to all that should be coming
to you through basically environmental
configuration now what's nice about this
closer to the mic I'm getting the sign
what's nice about this is if you change
the configuration you just change the
configuration and in the environment and
bounce the container or dispose of the
container and get a new container all
right so it was nice about this is if
you do want to reorient your application
to talk to different services different
database it's relatively easy because
you just basically declared in your
environment right it's very simple the
fasting is treat other treat your third
parties and your own services alike
right you can write your own
applications with services I expose them
consume them or the database or other
off-the-shelf services consume them it's
all the same thing so really has a nice
uniform model of think of you to pick
your services and make sure you publish
the cornice those services in your
environment pick them up as you need
them so with that I'm going to pass it
over to Garrett who will give the word
on the ground here like okay how is it
readable I hope you can read it so yes
um so I try to put something together to
to demonstrate that you can how easy it
is to put a java SE based application
into the java application container
cloud service so the idea was to create
this which is in principle it's just
it's a website it's just one file
contain some JavaScript shows a map and
show some geofences here that I can for
example click and it says okay this is
Java one this is very important it's
thirsty be a bar you have to know that
one and this is oracle openworld stuff
so you see i have a map with an overlay
so these overlays are coming from my
service that is running in the
application container cloud so and then
you see the location where I'm located
in right here and with the radius of the
accuracy and now I can check for example
I type something in here and the check
for fence right so now it will come up
hopefully with a response soon okay I
got the push notification on my phone
already in the browser tooks a little
bit longer I don't know why all right
that will pop up some something
hopefully soon so the idea was can I for
example I have some geofences define
in my application right there could be
in the database or something somewhere
then i have this interface which is
coming from the browser it locates me
and then i sent this data to the cloud
service it checks against all the fences
and then it comes back with a message
which it doesn't hear it just works on
the phone at the moment because it also
sends a push notification to my phone
alright that was the idea and let me
show you what it needs to do that so the
Java code to spin up the rest service
because it's a rest service that I
expose their on there on the application
container cloud service it just contains
two endpoints one does it get where I
get all the fences that that's this part
and they're using spark spark right yeah
I use this bark framework which is just
one small library and you see this is
just four lines of code to to create a
rest service and a rest endpoint to get
the fences it just returns everything as
a JSON array and then I have one more
which is the post where I just post the
location the coordinates and then I
check them here in one method I check
the coordinates against all fences right
this is this method here it just it's
not not a lot of code it just take all
fences check the location if it's in the
fence outside of the fans of it entered
the fence and here i call a third-party
service which is push over which is you
can use it for free and push a message
out to my phone so that's all i do right
so that's very simple and therefore i
also created this pushover manager a
class which and here it's against
something that is very typical you don't
put the credentials in the air because i
define these environment variables in
the cloud service and so i can also
scale and all the instances will use the
same credentials from the cloud service
so don't have to put it in the in the
app you usually don't do that and then
it just has them has a mess some methods
to send the post push message to the
phone which is very simple and this is
their their their API from
from pushover so to deploy that stuff so
I can run that locally so it will open
the restaurant locally i can do
localhost open my website no problem but
to bring it in the cloud service it
needs some kind of a startup file right
to define ok how to start that thing now
really in the cloud so that we created
this manifesto JSON file form it where
you can define for example the major
version so it should run on Java 8 then
this is the command to start the app
it's the same that you do in the show
java minus jar and then the jar files so
you can also have parameters that you
would like to set then we have release
informations like the build number comma
string version number and so on and some
notes so it's really simple right you
take these two files so the jar file
that I created and you have to create a
fete jar so that means containing all
the libraries in this case is just the
pushover jar and the spark framework
library and I combine it in 1 John file
it's around two megabytes take the JSON
file create a zip file and then i just
upload the stuff to the cloud service
well i can show you which looks like
this well this is the interface that we
have at the moment in the application
container cloud service so here you can
for example spin up more instances if
you need or you can increase memory or
decrease so you can adjust it manually
if you like then you can bind it to some
services and in this one yeah network
it's a little bit slow here you see for
example this is the port that that was
configured this is what what Sean
mentioned the string poor thing in this
case it's 80 80 and this is the API key
and the user ID that I needed for
pushover right so instead of putting it
in my code i just put it here and then
during runtime I load this stuff from
the environment variables and then it
will get started I can add also you add
services like for example if I have a
database cloud service somewhere running
I can hook it up here
and create a connection within the
infrastructure right because the the
database cloud service is not in the
public cloud and so if you would like to
access it from the outside it's not so
easy to make that possible so the
application container clouds are cloud
service can create an internal link to
the database cloud service and this can
be done with this ad service bindings
alright so you can spin up a database
and then your code can connect to this
one you can see something like
deployment history so these are all the
files that are deployed since last
Friday where I started that you have
locked files that you can access which
is very useful if you would like to see
some exceptions how can you do that how
can you handle that you can just
download it directly as a zip file from
here alright so that means in the cloud
service you it will create locks as soon
as you started and then you can just see
ok give me the rock pile you get the
exception so you can react to it that's
that's the idea behind that and in the
end we have yeah unfortunately it I
didn't show this didn't show that
because it should show another it worked
before and it I get the push
notification works this is too bad yeah
I don't know why this is really a quick
hack but and in principle no this is
chrome but it also works in firefox and
so and there is indeed if you would like
to try you could type in tinyurl.com /
sec yes geofence and then it should
bring you to this page which is running
on my dropbox so it's like I said it's
it's a quickie got a hybrid environment
where here's an HTML file in dropbox and
get out service on the Oracle cloud so
is so yeah so if you open that you will
see that you can also type in your name
and then check it so it should run on
the phones and on that's not complete
not in this room maybe not in this room
as you see as you saw but I can see on
my phone if someone used it because I
get the push notification
so indeed the the deployment to the
cloud was it was really like this I was
a little bit surprised because I
expected I might be a little bit hard I
have to set up stuff but it was really
just set up the environment variables
take the jar file and the manifest Jason
zip it up load that's it hey questions
for you all questions for me they go
good questions is really good are those
service bindings to on-prem to this is
no they're not to on prime so one of the
challenges for the cloud is whether you
can secure communication back to
on-premise or not if you don't have
secure networking then I don't think
people are willing to open up like their
databases to a public internet so until
we have those overlay networks we don't
have that yet yeah okay so the next
question was if I would upload the demo
to get up I can do that this is really
it's nothing special I hacked it to get
on last Friday within an hour so it's
really just a quick act but yeah I can
do that so if you ping me on Twitter I'm
i will respond say runs on it runs me
that's hot too right yeah yeah so it's
just yeah just ping me and then I will
that's kind of kind of a point it's kind
of one of my my goals in life is the
applications are around premise she run
the cloud like I should be able to do
both I shouldn't be so tight in some
weird cloud environment that I can't run
it and debug it right so that was really
the the biggest yeah the good is not to
say that it was the best thing of all
that it was just for me I run it locally
I just took the command put it in the
JSON file uploaded this stuff and it
worked so Oh getting kk is not in any
fence so someone used it I see push
notification yes sir so it works it
works oh there's another question Karen
how is version controlling happening for
cloud services ok that's the awesome
thing about these services is depends on
the service depends on the cloud
provider whether oh you come back to me
again okay so it depends on the cloud
provider
typically people are following a process
of you know push to get kick off a build
deploy the thing to the service what's
deployed the runtime environment the
version in the runtime environment is
under ops control really the versions of
the code is the code itself is in get
rights all that version ISM that is and
get our service you deploy a binary to
us and we have within the deployment
environment no history with server but
we know what you've given us you have
you tell us which version is running so
people can check it but all of its
outside right it's all in your version
control system we're not keeping
multiple versions of your binaries like
why would we keep old versions of
binaries we have your lives version your
binary deployed in the environment if
you want to deploy an old version go
kick it out kick out the jobs out of get
and apply it to us right so these are
not version control systems these are
runtime environments where you deploy
your applications so there's two
different areas of concern and 22 area
two different sets of tools really for
those things so a good question though
because it's something we thought about
we didn't want to be in that business so
so let me talk about a few things are
the applications themselves so what's
the insides of those boxes right the in
size or for some of the qualities of
these cloud applications the first thing
is around statelessness so think about
your running your application in some
docker container or you're scaling it
out hundreds of these are running in
containers across this cloud and it's
much easier for everyone if they're
stateless if you push the state end of
the unique Kerman Kron estate reliable
state outside into databases storage
service key values towards no sequel I
don't care but something that's backed
up you know maintained properly for
doing that exact function right so
having stateless applications makes it
much much easier for us to deal with
scaling so imagine you've got ten
instances and you want to scale in we
kill what we shut one down gracefully we
shut it down right it has no state to
back up I can take it down right it's
not a problem for us not like oh my god
okay I've got to back that guy up then
what if he comes back later no it
doesn't do that all this date for your
application is somewhere else you're
just adding more compute power to your
application by scaling up scaling down
right so it's much easier for us also
having stateless applications that are
disposable is easier for us in terms of
the configuration if you change
configuration all we do is start some
new applications so we kill the old
applications have the old
figuration and we start some new ones
have the new configuration again
complete freedom it's much much easier
now the ephemeral disk i mentioned
before dimension is ephemeral disk so
typically these these containers contain
a femoral district temporary disk it
looks like file system it is file system
when the container goes away so does the
disk so it's useful for things like a
temporary processing of the current
request maybe you want to dump a file to
disk work on it and then send something
back maybe you're an image processing
service that's fine but when that
container goes away that disk is gone so
if you want to keep that file for later
than one download later push it
somewhere which is somewhere else Oh for
questions um no so downtown rolling
restarts all the usual stuff right so
yes it's true you can also do green blue
so you can switch over between new
version to old versions all things kind
of things you can do to maintain up time
so that's not a not a big concern so
there's another question restarting
applications to change services will
result in downtime for dessert I system
agenda that yawns ah okay look sorry
that's okay sharing none share nothing
so these stateless here not the
architectures right this is pretty cool
especially the standard and so again so
we have stateless applications shared
nothing no shared disk these your
application is running in a little
hermetically sealed box with you know
wires going out to services it consumes
databases and whatever with traffic
coming in through a port this is the
world that these cloud applications live
in and so they should be stateless and
share nothing what's nice again is no
shared nothing means that we can we have
all the stocks ability scaling out these
applications is really easy for us
there's no shared resource being being
hammered now not everyone agrees on this
point this is actually somewhat
controversial and in particular
openshift does not subscribe to this
philosophy so there's a great article
and I thought the title was good you
know why we aren't joining the cloud
foundry foundation and basically they
simply disagreed with the state well one
of their points one of the points was
they disagreed with the notion that all
containers to be stateless and so they
prefer the idea that some containers
could have state and some of them not
really a choice and so when you're doing
stateful containers your bedding your
running sort of more mini VMS
I these things have stayed in fact out
you into a whole different world but
that's some of they chose to do so it's
interesting to see that there is no
total like agreement on everything
there's some flexibility and depends on
I'm really your state of mind in your
position so it's kind of engine but I
think that for scalability reasons and
ease of management on your part in my
part statelessness share nothing is much
easier for everyone so just I'll show
you what it looks like I think yeah you
showed the UI anyway so our architecture
looks like this you know simple load
balancer in front all traffic comes the
load bouncer I think you'll see this is
pretty common most providers right
shared load balancer reading traffic to
your application running in a container
may be a stalker or maybe it's not you
know I scale out app I add applications
load balancer handles the traffic your
application doesn't even know is being
load balanced to write add some more and
I can do all this with usually either I
have a mouse I don't have a mouse you
know you I has simple controls or
there's West API this is pretty normal
stuff all right but this is how we do it
we scale out by adding more containers
and then we consume any shared resources
in the ecosystem
now once about one more practical matter
as a person who can writing applications
for these platforms you you hit some of
the basic issues you know like right up
front when you're trying to kind of code
for these things so the real thing I
want talk about was development versus
deployment so you know these aren't
development environments their
deployment environments so how do you
test your application is working
properly in that environment since it's
really you know here's my code run it
right and if they're running over there
were development happening right so what
do you do that it's not there and the
tricky part was is with debugging for
sure debugging is a tricky problem so
there's a few choices here that I'll
just outline and there's no right answer
at this point no one is really got this
down to a science so this is some of the
options they have and and some of the
things I've actually tried some of these
things so one of the option options is
okay I've got this application and I'm
going to deploy to a cloud platform what
I'm going to do is I'm going to
configure my environment to be just like
it would be in the cloud so in the cloud
I'm running on Linux you know probably
so it's a linux environment fine I'm
Ella nice environment desktop let's say
I said that the environment variables to
match what it'd be like on the server
and I point at local resources like
local database perhaps i'm going to use
the same jdk release all the same stuff
make this simplest possible things like
form and let me are useful for starting
up applications and sort of define the
environment for me so I starting up a
sub shell and setting up the environment
this isn't useful tool the problem is
this is emulated right so this is like
the cloud but it's nowhere it's nothing
like it's not really the cloud but it
lets me do the basics so i've done this
i have a little tool i wrote i can start
my application and i can an option run
in a shell so it runs a subshell plus
local databases and I can do basic work
with that it's running right on my
machine so it's pretty easy as Java
right but I wanted to have that same
consume the configuration consume all
these externalized resources right that
works okay but it's pretty far from
my deal that's for sure the second is to
debug it in the cloud so you deploy out
your application to your cloud service
and then debug it and you know hook up a
debugger to it and the guys from spring
tools Martin Lippert my buddy at a
pivotal demoed this I don't know that
it's anyone here from pivotal know
whether this is ever gone GA because I
think that it was experimental so what
they were doing was Martin had it so
that from within the switch spring tool
suite you could launch your application
on Cloud Foundry and then you could you
use a third party to do sort of a call
back so when you said it's complicated
when you set up a Java breakpoint in the
code that's running the cloud it has to
call back to your desktop right which is
tricky they had a third party routing
traffic some how to handle the call back
and then tunnel back into the into your
interior Eclipse IDE to go oh yeah we've
hit the break point in the cloud and
it's tricky cuz you know you gotta a lot
of work to do this is really it was
precluded and maybe they came up with a
smooth way of doing it but I don't know
where the other thing is you know your
environment there's a scale that's like
10 12 instances you like okay going to
debug it now so probably to have one I
put a breakpoint in one because he hit a
break point who knows what's coming from
so that's interesting we've debated this
I'd love to hear people's thoughts
should you do this shouldn't you do this
should you have a special environments
like the dev cloud environment was
limited I don't know the right answer no
one really got a good answer really
everyone's just deploying your apps and
they give you log files and you can do
monitoring but getting in there is
actually a bit of a challenge
the third one which I kind of like I've
tried this too is if using docker oh
yeah keep up with the questions any
questions sorry before you the last one
can I deploy the zip directly from my
build server through an API yes you can
everything I think my service and
everyone's service i think is fully
rested able so you can just i actually
prefer the rest because it's just
repeatable eyes deploy and you know it
does everything what is the strategy for
changing application properties for
single instances oh good question okay
sequential upgrade scenario oh yeah so
the issue there is can you change the
configuration for one of the containers
or one of the environments and then
bounce them over right really that's not
quite the solution the solution would be
change the configuration and then roll
that configuration of the rolling
restart this is the same thing right so
these guys are all the same like part of
the goal these services that treat all
these guys is disposable little little
robots who you can just kill off as
necessary so no one special the other
thing I should mention actually on that
is you typically don't see SSH SSH into
those containers typically is not done
because you want to view them as sealed
read wrongly right you know they're
written once they are there
configuration to get their environment a
configuration for the environment and
that's it there's nothing to manage that
we're making our life simpler it was a
power dependent service URLs resolved in
a cloud app usually look up through a
through a service you can look up
through the rip through a resolution and
service kind of use you have a Davina
cloud okay this is a good question so
should I should you run java DB order be
in a cloud environment no has a femoral
disk so the moment don't bounce it that
thing it's gone right so you're it's not
a good choice so this is actually good
example java application not good for
cloud derby javidi be because you know
it doesn't make sense you could do it
for test though you could deploy one
just know that when it goes away it's
gone like you know has no history no
stage
these automated scripted deployment
possible from a dev from death cloud
service yeah absolutely when appropriate
would like to know is the Oracle cloud
delivery service ta or this service i'm
talking about the container cloud is not
quite GA i did have a hands-on lab this
morning so you can take from that what
you will about how soon it will be
available and the pricing ok the pricing
all these cloud services are priced
typically and gigabyte hours so you pay
for how much RAM your application needs
per hour with typically discounts on
like longer term commitments so you're
looking at IBM has like pricing of eight
cents a gigabyte hour for all their
services and we're basically the I don't
think we've really am Stephanie but
we're the same range with discounts for
a monthly commitment so if you want to
have a gigabyte for a month we'll give
you a deal so they're all they're all in
the cents per hour range and it varies
is basically a fluctuation surprisingly
no one's cheapest and no one's more
expensive typically this is a set of
offerings everyone has where you're
getting premium offerings versus cheaper
offerings like for example Heroku offers
sort of dedicated compute where you can
say i want my containers running on a
rack or an instance it's only for me so
I don't have a multi-tenant some of
these environments are multi-tenant some
of them aren't multi-tenant some of your
containers will be on the same computers
as your competitors noisy neighbor
problems
our case we don't do that but that's why
Haruko has more fairly expensive
offering but it gives you this dedicated
compute so there's a lot of a lot of
variety but it's it's you know you can
you can get a gigabyte for you know 60
bucks I'm 150 bucks a month for an
application if you want two gigabytes it
costs you twice as much is pretty linear
pricing okay let me tell you what the
awesome last choice though so I like
this the best but it's and I've done
this so i have i said i have a little
app right so I'm playing have a little
app that says run my application on my
desktop in a shell it reads my
configuration from my service the
deployment files whatever and start runs
it on the shell and then I changed it to
okay do the same thing but run it in da
car on my machine with a docker image
that looks just like what the cloud
looks like and what's cool about that is
it lets me do things like open up ports
into the docker container to put java
break points in debug my application all
locally an environment that's reasonably
it's closer to the target environment
right I'm now in dock or at least on the
right version of Linux the right JDK I
don't have all those cloud services
necessarily unless they're available to
be a rest so it turns out I was building
an app using Oracle's messaging cloud
services messaging right and its rest
enabled so I talked to the same service
in the cloud and I'm developing and then
I deploy it keeps hogging the same
service in the cloud so even though it's
not it's on my on-premise I'm still
talking the same services that I'm
consuming which is kind of good so this
is this i'm just playing with this this
is like my own little pet project Heroku
has done something like this which is
kind of weird because the who doesn't
use doctor so who doesn't use docker in
the cloud they of Linda's containers and
it's and maybe not it for a long time
they came up with a darker solution to
run a haruka like environment on your
desktop to do exactly what I'm talking
about and I think they've just gone so
GA with that in
very recently actually think that this
year so it's like they good the right
idea i think which is put a container on
your desktop that looks like the cloud
so that you get as close as you can but
even for weirdly enough for them they
using a different technology then they
actually use in the cloud but they're
trying to get it closed so it's a pretty
good idea i think this is a i think
that's a great idea because it's because
what you get out of this is you avoid
the whole deployment step so what
happens when I'm doing this is I run the
container the container just looks on
the hosts file system sees my
application there's no you know
deployment step where I send it
somewhere it's just sitting on the file
system and the container code in the
container can see it so it's a pretty
good solution but there's it's a problem
like this is there's no good answer here
you will place this if you try this
which is why at the very least your
application should run on premise let
you debug it how close you can get it to
the production environment is you know
can be a challenge
all right I'm gonna just sort of move
towards wrapping up so Java is good for
this right so it's everywhere all the
platforms support it I don't know why
you wouldn't use you have for this and
all the vendors have support right so
it's it's well supported in all of them
although the version of Java does very
honestly so you might have openjdk or
get out oracle jdk depends obviously we
have oracle jdk which means we have
flight recorder and other things but
it's java but does vary and other things
i talked about today are some things I
talk about today are our news to you
right like I just say anything new like
oh yeah I should know my dependencies I
should have my configuration managed I
should know about my services I consume
I should know about what service time
exposing and how expose these are all
just perfectly commonly good practices
but in the cloud they're like really
seriously important because if you don't
do these right you're not going to work
nothing worse and deploying and I've
seen this because I did this you know
deploy your application and it bombs you
like what's up because i forgot to bind
to the port they told me to bind to
write I just said 8080 cuz on-premise
y'all was like 80 80 it wasn't 80 80 or
if it well you know so this the cloud
the cloud platforms do a health check
they go is anyone listening on that port
they find no one's there they go must be
dead and then they kill your application
so you're like so these are these things
start to try to bite you so you have to
pay attention configuration dependencies
the whole thing right but nothing
nothing new so this is just good
practice so maybe the cloud is just
bringing more discipline you know I
always liked it when you know the
environment said he's always GI Bill
which kind of made me maybe I'm a
masochist but you know it was very
strict so real strict rules means you
have to be disciplined disciplines not a
bad thing necessarily
so so my advice is Java is awesome of
course you should use Java but focus on
your java application and not on the
platforms right so I would folk I would
encourage you to take ownership of your
stack so if you use spark or whatever it
is you use if you like your stack make
sure your stack runs in those
environments and don't get all sucked
into features of these clouds that may
be unique I think that you want to focus
on Java as the platform not the cloud
instead in a sense as a platform right
java is a nice portable universal
runtime you can run the cloud run the
desktop the cloud shouldn't be polluting
your Java environment shouldn't be
senior java applications now the
principles we discussed here are bad
principles for on-premise either so
there's no reason not to focus on good
job applications those embedded servers
i showed you those are a great thing to
think about so if you're currently using
things like full tomcat you deploy your
apps think about embedded tomcat you
know single application easy to run it
starts in no time small same with jetty
same with grizzly Jersey the tyrus
WebSocket stuff you you if you're not
into java ee then then you might as well
embrace these lightweight things
lightweight containers right there fast
too easy to work with their fast if you
need to have a nice tough of course as
oracle i will tell you that we have
products for you for sure i work in that
team but if you don't need those
services then you know really look at
these things because they really do
enable you these embedded servers it's
quite it's a sort of inversion of
control here the application is now only
in the container the container is
annoying the application anymore the
serb the container you know serves the
needs of the application what services
do i need rest web whatever rather the
container sort of saying these are what
I've got for you is kind of a weird
inversion
and the final thing here is i didn't
talk about microservices too much
because a bit buzzed wordy but a lot of
what I'm talking but it's sort of but is
microservice like right so small
services with rest api is that you can
compose together it sounds like a micro
service thing that's that may be true
that's the essence of the micro service
approach there's more to it than that
but this is not a bad thing right so if
you're building small sets of
applications that offer services to each
other that's a that's great I think that
you assemble them to build a bigger
solution right so I think that's all any
more questions on there or we back up is
the last nice clay is elastic scaling
out of the box configurable can stick
what is out of the box configurable mean
who asked that question fess up I just
want to know more do you mean does it is
it magic or is it I'm just kidding yeah
ah right so so others can yeah so we
actually are don't have that today we'll
have it there's sort of two flavors of
scaling there is policy based like my
memory utilizations at a certain point
trigger a scale app or CPU or then this
scheduled like time of day like at 5pm
people come homes are using my service
so those are both those kind of policies
will come some have them some platforms
have them some don't but yeah it'll come
and you
there is there is not but I think that
with the rise of the microservices
platforms you see that's becoming more
good it's going to happen
okay that's a great question so can I
run something like a hazel cast in these
content in these worlds so today I don't
think any of them can read it if the
issue is these containers are all
isolated now that's true for ours too
but I'm going to change that so we will
actually open up ports for inter
container communication to support
things like data grid clustering your
tomcat apps whatever and then surprised
actually when you look around that no
one does is because it maybe they have
us to dogmatic right so they can be
stateless doesn't mean I can't talk to
each other right so yeah okay this is
more here what is better from micro
servo octopi are micro or java SE of
embedded today I don't know I can't
answer that question you know that's
like a religious statement here call is
jmx possible these kinds of
architectures good question too it's
coming up for us right now the only
ports that depends on your provider most
of them do not provide anything but 80
HTTP traffic into those containers the
trick is can you open up jmx so I'm not
aware of anyone who actually has that
today so what you're left with then is
whether you can run whether your plot
the cloud platform itself has tools that
let you even themselves use jmx to go
into those containers and find things
out because something we have had to
look at internal hangouts are more
affordable please
when doing microservice do you deploy
service separately or together as one
deploy there are there are people who
have these are the plat lidl cloud
formations or what the term is so you
can do it either way and I can't really
answer that question definitively and do
these cloud passes support ssl to two
ways cell and other security measures
yeah so typically in our case
everything's ssl to the cloud like we
don't allow any non ssl traffic in to
start with so i think and we actually
terminate the ssl on the load balancer
and then it's non not inside that's the
way we done it today that's what's
happening but the inside the networking
itself is also constrained so there's
other limits okay sorry
right
so you can do that so you see that in
cloud found you they did all the time
they haven't look at environmental it's
got a JSON document and then what they
do is they have a some spring beam that
reads this JSON document and turns
itself into something and it's kind of
weird to look at it because it's just
way to look at how big an environment
where we'll be big anyone in the back
Oh
yeah so in that case you really need a
district that descriptor something that
tells it hey you need to look in that
database like someone's got to tell you
it sharp but this some of the some flag
or something that's part of the
environment that says we are the prod
environment therefore application please
look here that's okay but at least that
way you're still saying you know
hardware in the app and you're still
configurable sure standard yeah
the old ones yeah there for an hour for
us to there for a while they're under
your control actually so so which means
at the point of someone better clean
them up at some point because they're
going to stack up you know so the some
work for you to do right okay we're good
okay well thanks very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>