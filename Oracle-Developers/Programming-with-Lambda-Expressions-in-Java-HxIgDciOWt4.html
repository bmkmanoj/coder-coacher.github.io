<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Programming with Lambda Expressions in Java | Coder Coacher - Coaching Coders</title><meta content="Programming with Lambda Expressions in Java - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Programming with Lambda Expressions in Java</b></h2><h5 class="post__date">2015-06-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/HxIgDciOWt4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right good morning or welcome to the
session on programming with lambda
expressions in Java my name is Venkat
subrahmanyam I'm gonna talk a little bit
about what we're gonna do here and then
I'll get started with the code examples
I don't use slides the topics I'm gonna
talk about here along with the code
examples are posted on my website the
URL is on line number five but as I
scroll through the page I will also list
it in the bottom so if you don't note it
down now you can note it down later as
well so a best time to ask a question or
make a comment is when you have it so
please don't wait till the end any time
it's a great thing for questions
comments anything you have I will not be
taking questions in the end so anytime
you have the question it's a great time
for the questions if you do have a
question please do draw my attention
wave your hand at me so I know that you
have a question I'm not ignoring you at
all usually if I'm not responding it
means that you're not in my line of
sight so let's get started
Java has been around for a very long
time now looking back in time and if you
look at that last time there was a very
interesting change in the language since
its inception
that wasn't 1.1 and then not a whole lot
happened since then Java 5 had some
features which are extremely
questionable Java 6 didn't have much at
all Java 7 had marginal improvements all
that is about to change in Java 8 I have
to be honest about this I'm one of the
guys who endlessly complained about Java
over the years every opportunity I got a
complaint about Java and I never thought
I would be scanning here and praising
the language so I've completely flipped
over I love this language now because
it's really gone in the right direction
so this is the next big thing that's
happening in Java and I'm really
thrilled for what's happening in the in
this in this particular language now
what is lambda expressions lambda
expressions are really anonymous
functions let's call them as cute little
anonymous functions that's what they
really are and we can use these
anonymous functions to write functional
style code what is functional style code
well they're higher-order functions we
can pass functions to functions like we
used to pass objects to functions we can
create functions within functions like
to be used to create objects within
functions we can return function from
functions like we used to
optical functions so rather than just
being forced to compose the system using
objects alone we can now compose a
system using objects and functions as it
may make sense well that's enough
talking let's take a look at what we're
gonna do here it with an example I'm
gonna start with something extremely
familiar that everybody in this room
knows and I'm gonna refactor this code
several times over but every time I
refactor the code I'm gonna change only
one thing and so there'll be only one
thing new for us to learn and then we'll
get familiar with that and then we'll
refactor again and move forward from
there so let's start with something
extremely simple and common that we all
have done let's assume for a minute that
we have a collection of these numbers
one through six for a minute is the
foreign size beginner for the people in
the back of the room thumbs up if you do
excellent thank you so armed this is a
collection of numbers and let's say I
want to iterate through these numbers
and print the values out what would we
do for int I equal to zero I less than
numbers dart as its size or length I I
here both okay
is it less than or less than or equal to
some of them are less than other star
like I'm not sure anymore right now life
is too short for that isn't it we should
get the code working and go on isn't it
so there's a name for this kind of code
it's called self-inflicted wound pattern
right because there is no reason for us
to be writing this code in 2013 come on
we got better things to do so we have to
be writing over here numbers start yet
and the value of I for the index and
then we print it so we have done this
for a very long time and unfortunately I
would argue this code are things people
would look at this code and say it's
simple but they're absolutely wrong this
is not a simple code at all they're
confused with the term here what they
are talking about is the word familiar
this is an extremely familiar code but I
would argue this is one of the most
complex code we have ever written
because every time you write this code
you got to stop and say I am I going to
the off by one error today right and and
life was too short for that right so
right thing this code is like right like
walking on the mall with the guy with
the you know knife behind you every few
minutes your tolerances are still safe
to be here right so that is the way we
don't we've been writing code for a long
time and we don't have to so fortunately
we can improve already from this code
and what we can do is use the so called
you know for each statement so we could
say given an element e in numbers and
then we can simply output the element
itself how sweet that is right so we
don't have to put a lot of effort in
writing that code compared to the
previous code this is much simpler much
easier to write so certainly this is
what we should really prefer however
both of these code really are classified
as what are called external iterators so
what is an external iterator external
iterator is like having a rule dog at
home and you tell the dog to move and it
doesn't budge and you really push it
with your foot every few steps right
because you have to control this looping
all the way you have to do all the work
now on the on the other hand it's it's
like you have a good dog at home you
throw a frisbee what does the dog do
leaps forward and go gets it right so
you can write the same thing using what
is called an internal iterator now how
would this look like I'm gonna say over
here numbers dot for each and then I'm
gonna write some code in this internal
iterator now I've not implemented this
yet but let's spend a minute thinking
about what's the big difference between
the two the difference is enormous now
in the very first case the for loop is
not polymorphic at all we've been using
this for a long time but we control the
loop all the way through we have to
create the iteration control the
iteration manage it and then tell what
to do for each of the elements so that
is called an imperative style of
programming where not only we say what
to do but also how to do it in the
second case in line number 15 notice how
sweet the for each statement is
polymorphic in optional object-oriented
programming we want polymorphism why
because we don't control the looping
anymore so we lose some
control which is a good thing because
because we don't control it anymore
it can polymorphically very the
implementation
so if sequential iteration is what we
should do it would do it if concurrent
iteration makes sense it would do it and
other flavors if iteration can come in
without us having to modify the code I
know I'm throwing a lot at you right now
but I'll show you how that is actually
possible towards the end of this session
so this is polymorphic that's one thing
so how do we go about implementing this
little code well in order to do this I'm
gonna go ahead and import first of all a
little thing called function dot
consumer now what is this function dot
consumer well Java now has these
interfaces called functional interfaces
which really makes me wonder every time
I say it if there are functional
interfaces or they're dysfunctional
interfaces you know anyway so these are
the functional interfaces we have right
now and now I can go back up here and
say new consumer and then I can specify
the integer value here and implement
this and say public void and accept is a
method on the consumer which is going to
take an integer value on its hand and we
can simply print out the value right
here so you can see the code is
producing exactly the same output as
before but we completely made a paradigm
shift rather than forcing the iteration
to be controlled by us this is on
autopilot you simply say go ahead and
loop through and the only thing you have
to specify was what do you want to do
per element in the collection and it
takes care of the rest of the things for
us because it's polymorphic we can
control we can vary the implementation
of this iteration as well very nicely
the second benefit this gives us is that
we can focus on what to do and don't
have to worry about how to do it and we
don't have mutability in code anymore we
don't have this looping that we are
controlling so the chances of errors is
a lot fewer so there are several
benefits to this code I know what you're
thinking right now you're saying this is
all sounds really well when I hear you
say it but when you look at that code
that is so unappetizing right and it
just if if that is the code you have to
write to get all the benefits you're
going to say
no I'll go back to the old way of
programming because I'm not going to be
spending my time doing that
well thankfully we don't have to do that
so what we can do quickly here is we can
replace this because this is the
anonymous inner class we use which we
are all familiar with well fortunately
rather than using anonymous in their
classes we can simply say for each and
we can substitute the anonymous in their
class which simply a lambda expression
so integer and then I could say value
and then I could simply output over here
the value itself as you can see so now
look at how sweet that code is we went
from the anonymous inner class ceremony
and complexity and ugliness to something
really sweet here which is the lambda
expressions so anywhere a single method
interface is being used we can now use
an lambda expression has a nice nice
intact sugar
so in effect both the code are doing
exactly the same thing except that this
doesn't have all that ceremony in the
code and we got rid of most of the work
so what is happening really here we are
passing the function to this function
and what I've highlighted here is the
function that I'm talking about now a
function for most of us would say has
four things it's got a name it's got a
body it's got a return type and it's got
a parameter list of those four things
the body is the most important thing
well right here is the body of the
function to the right of this arrow as
you can see so that arrow separates the
body on the right side with the
parameter list on the left side so you
can see the parameter list sitting here
on the left so body of the function is
taken care the parameter list is taken
care what about the return type that's
inferred and what about the name of this
function well it's anonymous who cares
about the name so this doesn't have a
name so we are passing a function right
here to this method which is for each so
what's highlighted is the function
object of the function or the lambda
expression that we're passing to the for
each method itself so that was the
improvement in this refactoring however
there is a bit of a ceremony again in
this code one more time now if you
notice this particular code for a second
we say
integer value now you may say if I said
integer value what in the world could it
otherwise be in this context right it
makes no sense for this to be any other
type
it is extremely obvious what this type
is based on the context that we are
dealing with a collection of integers so
that's purely redundant and ceremony so
we can be intelligent and say hey Java
you know what it is I know what it is
why don't we just walk along without
having to say it explicitly so we can
simply output value right here and you
can see how sweet that was and we didn't
have to specify the type anymore and we
can get rid of the type and the ceremony
related to that well that's good so far
but in this specific example there's one
other problem look at this code for a
second very carefully what are we really
doing we receive the value as the
parameter and simply turn around and
pass it as a parameter to the parent
line method there is a very important
pattern name for this it is called the
office pace pattern remember the office
space movie what do you actually do here
I take the requirement from the business
people and I give it to the programmers
right so that is the office space
pattern nothing intelligent is going on
here right and you write this code about
three times about the fourth time you
will begin to feel stupid but here's
what I found about Java programmers they
never write stupid code instead they
create IDE is to write stupid code so
the next thing you know they would be
creating ideas and everybody retweeting
what the shortcut for this in their
favorite IDE is well the compiler team
realized this is not going to win any
support if they do this they might as
well take care of the office paste
pattern so the Java compiler implements
the office space pattern so what can we
do about this notice what I'm going to
do here I'm going to simply say numbers
dot for each and I'm going to simply say
system dot out print line and then just
leave it at it and say you take care of
the rest for me and that is called a
method reference so what method
reference eliminates all that
unnecessary coding where things are so
obvious that a parameter being received
simply is a parameter to the function
and argument of the function we gonna
pass in now method reference is a lot
more powerful than what I showed in this
example so for example in a you know
method reference the object you received
could be a target of the object of the
method you're calling as well so the
parameter you receive could be the
parameter on which a method is called if
you're passing multiple parameters to
this function the first parameter may be
the target object and the second or the
remaining parameters could become the
argument of the function as well so it
is very very smart to figure out what
the context is the only time you cannot
use method reference well actually two
times you cannot use method reference is
when there is a ambiguity and it doesn't
know which function to call it'll give
you a error the other time you cannot
use a method reference is when you are
really doing some work with the
parameter a rather than being just a
pass through like an office-based
pattern you actually are doing something
with the input parameter then you cannot
use a method reference so what did we do
so far what we did was we started with a
very familiar ground of the external
iterator and then we refactored it to
the for each method both of those being
external iterators we traded it for
internal iterator which puts iteration
on autopilot and then from there we went
on to using the lambda expressions to
remove the ceremony of the anonymous
inner classes we went for automatic
method type inference for the parameters
and then finally we refactored it to a
method reference as you can see so we
can start benefiting some some very nice
fluent syntax in Java so we don't have
to write as much code to do whatever we
do please yes
in online the last line you're saying
right so the question is in in the case
of this particular code you know what
does value really represent as a
parameter that's correct
so every element in this collection
would become bound to this variable
called value through each of the loops
of the iteration so this but this is a
function itself so think about this as a
separate function you're calling so what
for each does is it calls that
highlighted function in this particular
example six times over and as it calls
this function six times it is binding
the value the variable named value to a
value the first element the first time
the second the second time the third the
third time but each of these are
separate values now what I mean by that
is it is not maintaining a global
variable called value that it keeps
changing a new variable which happens to
be named as value comes to birth every
time and then it's given this value and
that dies at the end of the function
itself so it's a very local state within
that function itself please I'm sorry go
ahead
but once again go ahead the concurrency
problems happens all the time
yeah sorry go ahead yes
so the first exception where you cannot
do this is suppose I want to multiply
the value let's say by two before I pass
it then method reference will not help
you any processing you have to do with
the method reference you cannot use it
and the other one was that I don't
remember now what was I saying
Oh method ambiguity thank you so method
ambiguity here's a simple example if you
go to the double class there are two
methods in the double class that can
convert to string and if you just pass
the method reference itself it says I
don't know which one of them you want to
call because the type inframan
information is not adequate for it to
resolve so you have to really use that
sorry there was another question
well okay that's a very good question
and that's an answer is a little little
little bit more long-winded this is this
is well okay so the value if you specify
the type remember the scope of this
value is only within this function it
dies away at the very end however if you
really want it to be immutable you have
to say final right here unfortunately if
you don't put final then this becomes
immutable within that context I've
complained about this before but there
are sure there's reasons why they didn't
do it this way yeah so so hopefully we
don't mutate it within this function but
lambda expression is supposed to be you
know short sweet little code so it's
easy to find it's mutable and then go
punish the developer who wrote it right
so that that's not too bad please right
that's that's a very good question so
the question is what if I want to remove
an object while I'm reading it if you
would stay tuned for just a few more
minutes I'll show you some examples and
if I don't remind me again I will get
back to this absolutely a good question
all right
so we looked at a few examples so far in
how we the affected the score definitely
good questions let's talk about the
fundamental shift
we went from imperative style of
programming to a functional style of
programming what does that really mean
well understand what that really means
would yet another example here to make
it clear so what is imperative you know
feel like so let's go back to this
collection one more time now we are
asked to go through the collection
double each of the values and total the
values together how would we do this in
the imperative style will first say in
total equal to zero and then we would
output the total value when we are done
with it and then we would start with
four int element in numbers thank
goodness we don't have to use the other
loop and then we can say over here what
is the value that I want a total total x
equal to element times two and we would
be writing code like this oh wait a
minute that's what
even wrong so because it's got a product
isn't it it's a product of that so let's
go ahead and say so that's a zero and we
want to say this is a total off it plus
equals there we go so it is 42 is the
result but look at the code what we just
did we first initialize a value to zero
then we total loop through one element
at a time we multiply the value then we
add it to the collection then we finally
printed anybody was written code like
this everybody in the room I know I know
how very quiet you are because you never
want to admit that in public right
absolutely so you write that code how do
you feel after you write the code dirty
right you you go home in the evening and
the kids run towards you it said don't
touch me I got a shower first right
that's how you feel about this that's a
dirty code too right
it doesn't feel good at all writing this
code now this is called imperative style
of coding why because we have to tell
every step of the way how to write this
code it only gets worse but I said it's
dirty when you get home those of us
who've worked from home this is even
more dangerous if you're coding at home
a child comes into the room immediately
have to shut your computer down right
because if your child sees this the
child says that's what you do for a
living right and and it gets really you
know they don't want to go after a
profession afterward well yes you're
absolutely right this is horrible
horrible code let's try this one more
time so I'm gonna just output the code
and what I'm gonna do here to simply say
numbers dot and what do I want to do I'm
gonna call a stream okay what a stream
well stream is a fancy iterator well we
know what iterators are in java they
tell us the next element they tell us
whether there are more elements and they
do a whole lot of nothing else well a
stream is iterator on steroids it can do
a lot of stuff for us and in this case i
go to the stream and say hey stream i
want you to give me a and and the
operation i want to perform is a map
operation so dot over here map and i
want to really map to an integer given a
value i want you to return to me a value
times two because I'm trying to do a
multiplication and then I want to do a
sum operation and that was the result as
well but notice what what's a big
difference the big difference is you
actually can go home smiling after this
right in the first one we got mutability
all over if you look at the code above
we have to tell them every step of the
way what to do when running this code if
you turn up the computer volume you'll
hear the variable total say out out out
over here on this code because you're
constantly mutating it
there's no mutation at all in the code
in the bottom as you can see and it
starts reading more like the problem
statement how so well given a collection
of these numbers go ahead and find me
the double of each of the numbers and
the summit notice how it read like the
problem statement on the other hand you
say you know what let me try to figure
what this is doing why don't you go get
a cup of coffee for me right so that
complexity is gone it becomes nice to
read and flow through in this code life
is much easier to maintain this code
this is more extensible because we can
come make changes to this code much more
easily and without having to introduce
errors in this code so that is a
declarative style of programming so what
is the main difference immutability you
spell out every detail that is called
primitive obsession and sometimes we
have this primitive obsession
programming in Java decorating style you
put it on autopilot tell it what you
want and let the library function decide
what to do in the imperative style you
do mutability and decorators style you
don't do any mutability it nicely works
through the data and transforms the data
rather than mutating the data itself now
this leads us to a next problem how do
we really do more things with it I will
not even well let's actually try this
let's say for a minute yeah go ahead
please yes you're right so I'm gonna
stop it right there stay with me for a
few more minutes he's on the list before
you and and then I'll get to that as
well if I don't ask this question again
very good question absolutely I like
what where you are a step ahead of me so
absolutely we'll get to that so let's
say the
changed the problem is double the first
even number greater than three so that's
the problem given to us find the first
even number greater than three goes to
your question earlier a few minutes ago
right I want to only work with some
values not all of the values how do I do
that right that's kind of where it's
taking us how would I do this in in Java
so first of all I would say total equals
to zero in the old Java that is and then
I'm going to say are our value equal to
zero doubled equal to zero doesn't
matter what you call it and then I would
say total over here and in this case I
want to find the value how would I find
the value well to find the value what
I'm gonna do is I'm gonna loop through
the element in P in and then I'm gonna
say number start you know numbers itself
and then I would say if the element is
greater than three and if the element is
even then go ahead and double the value
total equals element times two is it
done no break it's only an hour long
presentation we don't need a break in
between
I'll break in the code okay yes of
course right so absolutely we have to
put a break in the code so let's go
ahead and put a break over here and run
the code and it tells us eight is it
done
look at the silence
this means oh dear right now that's the
beauty of imperative code right
you get fearful when it actually
compiles because that's when the problem
really starts well actually this code
has a problem in it and we don't even
see it yet let's see what the problem is
but before we see the problem let's
solve it the better way of doing it so
output what do I want output well in
this case I'm gonna simply say numbers
dot well that's great what do I want to
do get the stream from it now I want to
say over here I want to get only values
greater than three so filter value given
a value get me a value greater than
three over here so notice again it
begins to read like the problem
statement what is the next thing I want
to do then I
a filter this goes to your question
earlier right you start filtering and
say I want that dad and that I don't
want to be messing with the values
you're transforming the values not
mutating them and you select values you
are interested in so given a value what
do we want to do value is even over here
great and what's the next thing I want
to do given the value given the even
numbers given greater than 3 I want to
do a mapping because given a value I
want to find the value times 2 and
finally I want to say find the first of
the value in here and return it for me
so when I run this little code notice it
revealed the problem was that wasn't the
other code it then give me the answer it
said optional 8 why does it say optional
8 because the answer may not exist
because what if this collection has no
number greater than 3 what does this
collection has no number which is even
so how smart it was to figure out hey
programmer don't wait until the tester
comes to you and says your code sucks
let me help you right here right so this
is better way of programming because it
immediately tells us that this value
could be optional because it doesn't
exist now you can also call a method
here like a get int and say get me the
integer or you can use probably one of
the most threatening methods I've seen
in the JDK it's called or elles so you
can also call that method and say if it
doesn't exist give me this other value
well so what did we do so far we used a
filter method right here instead of the
map method itself and what is filter do
filter cherry-picks the value and so
what's the difference between filter and
a map map will transform the input to an
output no mutation the number of input
is equal to the number of output in the
case of a map the types of the input and
the types of the output could be
different you could receive lists of
names as an input you could be giving
out their addresses as output for
example in the case of a filter on the
other hand the number of input may or
may not be the same as the number of
output the number of output could be
equal or less and depending on what
you're trying to do but the output is a
subset of the input in the case of a
filter so that's how filter and map
actual
so we did this and said how we can go
through this so we start filtering and
cherry-picking the data out of it but
you look at this and say wait a second
if I have a 50 million records what's
going to be the performance like and if
I have a lot of data to use am I going
to go loop through the several times now
no matter how good this is no way in the
world I'm gonna do ten loops or five
loops instead of doing one loop well in
order to understand that let's change
this a little bit to get a bit of an
insight into this so I'm gonna change
this a little bit more just to gain a
bit more insight I'm gonna say this is
sample colon is greater than three and
I'm gonna change the next one here to
sample colon is even and then the next
one I'll change it to a sample colon
double it and then let's that's good
enough for now so where's this method so
I have a method called boolean and this
is going to be YZ greater than three and
it takes a number as an input and it
simply says I'm gonna return to you the
number greater than over return over
here the number greater than three
itself well then I'm going to write the
next function here static and this is
going to be also a boolean function I'm
gonna say YZ even once again a number
and I'm going to simply say return
number is even to do the check for it
and the last method alright here is
going to return integer value it's
called double it and it takes a number
and simply returns the number times two
itself that's what it's all it's
returning so when I run this code now
the output is still the same however
there is the concern of is the
performance gonna suck well let's look
at this code for a second if we
implement this naively I've got let's
say ten elements not just six elements
for a minute so I have seven eight nine
and I could go for another 10,000
elements if I wanted to so I got a lot
of elements on my hand potentially let's
say as an example now if our dildoes
naively i will loop through all
that pen elements that's ten
computations to find out the numbers
greater than three then I will pick all
the numbers greater than 3 which are
seven elements find if they are even
that is seven more operations total of
17 operations and then I'm going to
double each of the values that is going
to be the even numbers which are three
in this case so that's gonna be 17 plus
3 21 operations potentially and you're
like are you out of your mind
we don't want to do that many loops in
that many operations we'll come back to
that in just a second go ahead please
that's correct that's that's absolutely
right so they're static because they're
in main if there was in an object where
I'm using it an instance method I would
make them an instance method and
depending on the context I could do that
definitely absolutely so that is the
question well ok I talked about stream
and I told you that the streams are
really the this wonderful iterator but I
forgot to tell you one more thing
streams to share characteristics that
I've noticed only among my children my
children are wonderful but they're kind
of sitting there and playing and
suddenly they start fighting and then I
asked the kids are you done with your
homework they say yes of course we are
done how did it go wonderful is
everything working absolutely can I take
a look at it yes Daddy and then they go
to their room about an hour goes by and
I'm like ok have you seen the children
my wife says did you ask for their
homework yeah well they're working on it
right so in other words my children and
streams both are lazy to the bone and
well among the children it's a different
story but in in Java lazy is pronounced
as efficient so we'll see how that is
true in just a minute but I want to get
to your question real quick please
Oh like like you want to go through all
the operations you are saying are you by
applying multiple filters like this
right so you don't want to put them all
in one why because remember you know the
beauty of our field is we talk about
good principles we read about good
principles and then we don't code good
principles right and then we are record
sucks with the it failed single
responsibility principle we do
everything in one code and then we call
it a bug right why not write the code
with every line having a single
responsibility well because it's not
efficient what if it's inefficient so
let's see how that works so notice what
I'm gonna do now I'm gonna go to each of
these lines here and I said there are
pointing one operations to perform in
this example if it's done naively well
let's go ahead and try it E is greater
than and then I'm going to say plus
number and then I'm going to go back to
this code and say east even and then I'm
going to say plus number and then
finally I'm gonna say over here is
double it and then I would say plus
number so I put a little message in each
of these now when I run this what's
going to happen look at the beauty of
the output when I run this code it did
not do 21 operations at all so what did
it do well you first go to the stream
and you said hey stream go ahead and
filter done but liar it didn't do any
work at all and then it goes to the
second filter and say filter Italy is
done a map map it please done fine first
oh dear let's go do the work now right
so think about it this way and rather
than it going through all the elements
and filter then all the elements and
filter for even then all the elements in
map it doesn't go through them
horizontally one at a time instead it
goes vertically it takes the first
element one and says let me first see if
it's greater than three oh yes it is
is it even no it is not it's not greater
than three well I won't go to the next
one go to the second one he's two
greater than three no he's three greater
than three no is 4 greater than three
yes so only four four
will it come to the second line it won't
even come for the other elements and
once the time is even double it fine
first oh you're happy with the result
yes let's go home guys right no need to
do any more work
it's absolutely lazy please that's a
very good idea absolutely we have to
kind of understand and play with this a
little bit to improve its efficiency so
think of this as an engine given to us
we are still the Masters of using that
engine right and and so this is like a
declaration we have to really pick and
choose which way to use it and and so we
still have to control it to get the
efficiency but look at the beauty to go
back to earlier question they've had a
huge collection on my hand we can
leverage the laziness and we don't have
to go through the computational you know
complexity so that is one of the biggest
benefits we saw so far so let's
summarize the benefits before we look at
one more example so what did we see so
far here well in this example we saw
that there are several benefits to the
new approach the first benefit is we got
cold clarity on our hand now for the
first time the code is clear when you
write it
why because mutable code increases bugs
in code now how many times have we
noticed where a code is taking the
variable and mutating all over read and
then we're sitting and scratching
overhead what does it really do because
we're not able to retain all that in our
mind when things change we're all very
smart people but mutability is not
really balancing our smartness it makes
us dumb right and it's all that's why
mutability is not good we doesn't
leverage our been you know capabilities
and when you have mutability the other
day a guy came up to me and he said hey
look at this code right here and it is
not working properly it gives me a wrong
result I'm looking at the code and I'm
saying hey given this input you give you
this output he says you are right but it
doesn't so we both are looking at this
code like idiots
and about 10 minutes later I asked him
on the 7th line are you really modifying
the input parameter and immediately says
oh darn it now I know what the problem
is and walks away so the problem is we
don't think that
we are mutating code and we our eyes
don't see it often times and problems
creepin bugs are higher when we use
mutability and code with functional
style of coding we are doing it a lot
differently so how does this feel for a
minute let's take an example let's say
for a second
I'm really interested in a change for a
$5 so I'm gonna ask this nice gentleman
what's your name sir when I want to say
Ben could you please break this fight
for me I'd be very upset if he tears
this into two pieces and gives it back
to me right I'm gonna have these two
dangling five dollars and I'm like I'll
take you outside and talk to you right
so that's not going to be the way to
deal with it so I said looked like a
nice guy what does he do he takes the
five but he's gonna break it meaning
he's gonna give me back a five different
$1 bills so notice how the five dollars
disappears in his pocket but new five
point one dollar bills come out of it so
that's kind of what we are going to do
in programming is but rather than
sitting and mutating values we're gonna
use what's called transformation of
state rather than mutation of State
mutation of state is so
twentieth-century
we can do a lot better than that right
so will transform the state rather than
mutating it now one problem is we'll say
why don't we really do much tre state
transformation well the reason is
because we are worried about efficiency
what if I have a collection if I modify
it it's faster but if I have to make a
copy of it slower well we would slowly
start learning from this and would use
what are called more functional data
structures functional or data structures
will make a very smart efficient copy on
demand and so the efficiency will be
very high this is nothing new right now
because it's been around for a few years
already
it's called tries for example DRI es and
tries is a data structure that can make
a constant time change with immutability
so you would make a copy of at price
within a constant time and for a very
large number of elements in it I mean
millions of elements that is and so we
will start programming slowly with
functional data structures and and that
will take a couple of years for us to
figure out in Java because the other
languages have been doing this for a
while and they programmed with
functional data structures and we will
start programming in some of those data
structures as time goes on streams
already give some of those for us but
then we will go and explore more of
these data structures to gain more
efficiency along the way as well so yes
please right that's what price will do
no you don't because remember still have
garbage collection if you don't have a
reference to where that all will go away
still if you hold on a reference to it
that means you really want to have it
then it'll retain it so the memory
efficiency is a problem you are correct
it's a problem if we do it the naive way
right where we say I'm gonna do it just
like in this example we could have
naively looked through it ten times and
it would be an inefficient but it was
lazy to go through it in a similar way
we make selective copies and only
replace what we need to replace with
preserving new immutability and anything
that's not needed will go away I I
suggest that you go look up more on
functional data structures because the
problem is solved and and and the PIA
answer to your question is it is not
going to be a problem because only
things you care to hold will remain
things you don't care the hole will
disappear and there's not a problem at
all please yes yes our that's your
problem okay that's a very good question
hey I'm really interested in learning
scholars should I really wait for Java
I'm gonna give you two different answers
to that question I'm a huge fan of
learning languages and the reason I
learn language is not because I will
drop everything and program in that
language I learn new languages because
it helped me to program in the current
language very differently I have been
programming with I can program
comfortable about ten different
languages and and the reason I program
in those languages not because I want to
develop production system in those when
I got introduced to Java
eight my first questions my mind was I
can do this in Java I can do this in
Scala I can do this in groovy can I do
any of these in Java eight and I was
looking for answers to those problems
and I was able to do a few things like I
implemented tail call optimization in
Java eight using a lazy collections I
wouldn't have been able to do that had I
not known how tail call optimization
works enclosure in groovy and in Scala
and so learning these different
languages makes us a lot better
programmer in the language we are
programming in so that is the first
reason I would say we definitely have to
learn other languages it's it's our
profession and as a result it we owe it
to our self for our career to learn
these other languages and and when we
design code in the language we primarily
use the design patterns we use are going
to be very different because we are
familiar with these other languages then
a guy next to us who's not programmed in
any other language will still be
cranking up and writing this code you'll
be leap frog in the head and saying hey
we could try this well I've never seen
that code work me neither in Java but I
know how this works in Scala our groovy
I'm gonna try it that's one reason the
second reason is these other languages
have a lot of other capabilities beyond
functional style of programming like for
example groovy has made-up programming
which is really powerful Scala has very
nice story for in for enforcing
immutability there's a lot of
cleanliness attach to several things so
in other words you know the emphasis is
we should really get comfortable mixing
languages and then have the power to say
I am choosing this language because that
the right thing for me and not out of
fear and ignorance so my answer to the
question is that no I don't think we
should wait at all not now not as today
not tomorrow and learning a new language
is going to be something we have to do
until god forbid we become managers one
day right so absolutely we have to
continue to do that so oh yes please a
wonderful question wonderful question
that's what makes them closures so let's
go back over here for a second what a
couple of things I want to say because
your question prompted me to think about
a few more things so notice what we
do here we can when you write this code
you can do something along these lines
you could say for example right here I
could say I want to go back and and in
this case let's say double the values is
great but I really want to use a factor
so I'm going to say factor equal to 3
and then what I'm going to do in this
code is I'm gonna say for a minute a
numbers dart stream dart map and I'm
gonna say value and then value times
factor rather than 2 and then I could do
a sum on it for example and and in this
case if you notice let's again say map
do in for a minute now in this case if
you notice over here I have used a
factor in this code and and that's
perfectly fine to use a factor now
here's something beautiful in Java now
remember in the older version of Java
the compiler will complain to you saying
you have not put a final over here that
is called ceremony right and and Java it
is much smarter it says I don't need to
do that so notice it never complained to
you this is not marked as final but Java
8 calls us as effectively final meaning
you created it you didn't mess with it
so for all practical purposes its final
but if you come back later on in the
code and say factor equals 4 now you
wake up this Java compiler and it comes
at you and says what are you trying to
do you are not using an effectively
final variable you are changing it in
your code and this is dangerous practice
go home and think about it right so so
that is the beauty of this so it doesn't
force you to make it final but it's
effectively final so that's already
maintained this is so it can laugher -
this is called lexical scoping so
lexical scoping is where you can access
the variables in your defining scope and
most functional languages provide
lexical scoping and and Java also
protects us to a certain degree from
mutability in that regard as well the
other thing I wanted to mention a while
on this topic is though it's not a good
idea to do most of the time you could
actually do this you could put a curly
bracket and then you could start putting
multiple lines of code right here now
putting multiple lines of
and a lambda expression is not a
pleasant thing to do so they want to
gently punish us for doing it
which means got to put a semicolon in
the code you gotta start putting a
return statement if you're returning
value so for putting a curly bracket you
have to do a little bit more ceremony
but it can have two or three lines of
code in the in the function as well if
you want to do all right so we did all
of that you can have fewer errors in
code as well we talked about this but
it's easier parallelism how in the world
is that really going to happen I'm gonna
take an example here if my internet
connection holds good we will use the
internet to work on this exercise
otherwise I'll mark away the results and
show you so let's say for a minute I
want to go find the prices for a bunch
of stocks so I have thicker dart symbols
over here and these are a bunch of
symbols ticker symbols that I have on my
hand that I'm going to use so ticker
start symbols gives us a bunch of ticker
symbols all right there we go we have
symbols on our hand I want to go find
the price of the highest-valued Stark
less than five hundred dollars highest
value stock but less than five hundred
dollars how do I do that well let's do
this imperative to begin with
so we'll say find high imperative and
let's go ahead and say how we would do
this in an imperative style so I'm going
to say tickers over here dart symbols so
let's go ahead and start how to do this
so public static and in this case I'm
gonna simply say avoid find high
imperative this takes the list of string
which is called symbols on my hand now
what would we normally do in writing
code we would write code to say I'm
gonna write one big mess of a loop and
we can still do that but maintaining
that code becomes really hard so let's
split this into multiple loops over here
so list off stock info and I'll call it
stocks now what is the stock info look
at stock info it is just a POJO it
contains a ticker and a price that's all
the constructor takes loop those two
parameters and the to string method
simply outputs that value that's great
I'm gonna say list of stocks equals new
array list of empty elements to begin
with for and I'm going to say string
symbol
and then I'm going to say this comes
from the symbols that I have on my hand
and what am I going to do here well
stock start add and stock util dot get
prized for the symbol itself so what
does this get prized do if I go to stock
util for a minute and take a look at it
here's my get price method get price
method is going to go to Yahoo web
service and get the price what are the
Yahoo web service do it gets the web
data and parses it showing parsing code
in public is not a good principle
anymore and you know I would not show
that to you here but in the privacy of
your home or office you can take a look
at the prop arson code right so all that
is get priced from Yahoo does this get
the price and parses it great
now let's go back to this code I've got
all the prices on my hand that code
makes sense so far right so all I did
was did a looping and I got all the
prices for the symbols given to me great
the next step here is list of stock ute
info and this is going to be stocks less
than 500 this is going to be an
ArrayList one more time and and normally
you would Club all this into one
function and creating a mess but we
don't have to do that so in this case
I'm gonna say stock info stock and this
comes from the stalks itself and then
what am I going to do in this code well
in this code I'm gonna say well if stock
you do dart is price less than 500 dot
test and I'm gonna give it the stock
then I'm gonna say the stock less than
500 dart add the stock itself so again
let's take a look at what we did in this
code we start with a collection of all
the stock prices we check if a
particular stock is less than 500 if it
is we put it into another collection
otherwise we just leave it now what is
this is less than 500 do is less than
500 notice what it does it returns a
predicate object that's another
functional interface this predicate
object returns it's a function interface
so is price less than 500 is a higher
order function because it's returning
from
interface or in other words a lambda
expression itself and predicate has a
test method which is what I'm calling
here the last step I'm going to do here
is stock info high-priced and this is
going to be a new stock info no name and
0.0 is the price and for stock info a
stock in stocks less than 500 and what
am I going to do now high-priced is
equal to stock util dot pic hi and this
takes a high priced and the stock as a
parameter and returns the high priced
stock as you can see here it returns
takes to stock info and returns one of
them out so very simple code as you can
see so far now that we have looked
through all of it the last step here is
to output over here the high priced
itself but before we run this code let's
do one more thing let's go up all the
way to the top here and say start equals
system dart nano time and we will also
ask him to give us the end time over
here before we print this so I'll say
long end equals system dot nano time and
then we will also output the time it
took so time taken and then this is
going to be the end minus start divided
by 1.09 right so let's go ahead and run
this now and see what it is going to
output assuming I type this all of this
correctly we should be able to see
what's the highest top price today and
assuming my internet connection holds a
whole strong oh let's go ahead and fix
this code here so right about here I got
the symbol not symbols there we go let's
fix that and so this is going to tell us
what the stock price is this code takes
anywhere from about 30 seconds to 3 days
to run and when it comes back it should
tell us what's the highest stock price
but while it's running and if it
finishes running please tell me that
it's finished because I'm not seeing the
monitor right now so what is it doing
well it says I'm gonna take all the
symbols first of all and send one symbol
at a time to Yahoo
get the stock price and put it into a
collection now that I have a collection
of all these stock prices I'll go
through each one of them pick the ones
less than 500 discard the other ones
now we got a little smaller basket of
the star crisis all the ones which are
less than 500 and what am I going to do
next I'm going to walk through each one
of them and pick the highest value right
I start with nothing as a highest the
first one becomes the highest the second
one and the first one I compare and pick
the highest one eventually I'm done with
whatever is the highest one and that
should print out the result for us well
this is sequential code no doubt about
it it is imperative code
it was mutability all over imperative
all over it's a style we are all
familiar with the only improvement we
probably would make along the same lines
would be to Club them all into one so
there is one loop and then it becomes
really hard to understand and maintain
this code after some time now how can we
do this better we can still keep the
sequential but we're gonna use the
functional style of programming rather
than imperative style of programming
thank you so I took about 77 seconds
don't trust the time too much in this
case because the wireless network would
be very slow doing this but we'll try
this one more time now let's try this in
a functional style or a declarative
style so find a high declarative now how
many lines of code it'd be right does
anybody remember about 25 30 lines I got
25 lines of code great now I'm gonna
call a stream on this and ask for the
value so what is this dream so let's go
ahead and write this method can we sew
public static and this is going to be a
void method also find high decorative
takes a stream of string and this is
going to be symbols on our hand right so
what am I going to do within this method
first of all I need this help from this
guy so I'm gonna say util dart stream
dart stream and ask him to bring in all
the stream class interface two together
so I have that on my hand and then the
next thing I'm going to do here is I'm
going to measure the time this is going
to take so here is the time it's taken
and I'm going to measure the end time
and the start time as well so let's go
ahead and print the end time print the
start time as well well I'm not really
doing anything in this code so it
shouldn't take much time to do anything
at all
so that's time is zero that's good so
far now let's write the code how many
lines of code I've ever eaten so far
nothing for the domain three lines of
code just to you know give this output
all right here we go
output what do they want to output
numbers of actually in this case a
symbols right symbols dart and we have a
stream on our hand already I want to go
get all the stock prices given the stock
symbols what function comes to your mind
to do this operation of transformation
from the symbols to prices map awesome
you're all awake and listening that's
great so map and what should I do here
stock you dill dart get price make sense
great so we have all the mapping done
then I have to cherry pick only the
values that are less than 500 what
function would come come handy filter
you you guys Rock so stock doodle dart
is pry is less than 500 remember that
returns a predicate so we can just pass
it and the last function I'm going to
use here's a little quiz for you
salt is to pepper as map is to reduce
that's correct awesome hey I like this
game we are playing here so this is
called reduce and what should I say here
well I'm gonna pass to it a new stock
info no prize this is the initial value
comma stock you tell dart pick hi so
pick hi is the method I want to call
right here
so right there how many lines of code
it'd be right notice there are no
semicolons in this code huh keep that in
mind that's one line of code there's a
familiar name for this this is called
this this is ask got two names for this
pattern it's got composed method pattern
but I like to call it as the Train
direct pattern right so we can use
either of the names if you're interested
in using a name for this so let's go
ahead and run this little code Oh pick
hi pardon me these are method references
so I need to specify a colon here I need
to stay awake as I'm doing this and this
is the method reference as well so I
need to put a colon for this guy as well
and bring in those method references and
this is going to be stalking you sorry I
noted you please so
I'm sorry I'm not listening right now
so stalk you till basically is is what I
need to call right here so that is an
example of how we can go through and
implement this code in a functional
style of programming so how do we how do
you do this notice how we flow through
logically one step at a time
we start with a symbol and we take all
the symbols and we map it to these
values then we take the values and then
we filtered it down then we reduced it
and pick the highest value now that
should about take the same time assuming
my internet connection is not too flaky
but we can mock it out if that is flaky
and we can try try it again so while
that is doing let me eel to what you
were saying now I can actually listen
after well okay ah but it's not taking
zero seconds yeah all right so so yeah
oh it is what a report zero seconds all
right why did you tell this earlier all
right you can imagine how my wife feels
all day long what you know what she's
got to stay with me longer than you do
thank you
so now last thing I want to talk about
this coat is all right great everything
is wonderful and you're all fine working
one of what a few weeks into your
project before your delivery your tester
comes to you and says we got a problem
what problem well things are too slow
for a large set of values and you're
scratching to ahead how do I make this
really faster what can I do to make this
faster and one of you colleagues from
students is I got a great idea
you're like oh dear what do you have
well remember how we have multi-core
processor yeah well we could use
concurrency and you're like hold beer
because you remember last time you did
this on a project you had a sequential
code everything was working fine and
then they said let's use concurrency you
started changing code and what happened
to the code it not only broke it was
completely different
right it was completely different and it
was no longer like the code you saw and
what did how did it work it became very
painful isn't it
and then as you started fixing the bugs
you started updating a resume that's
what concurrency means on these projects
right well we could do a little better
notice what I'm gonna do here the only
change I'm going to make is a parallel
stream that is all I did I didn't change
any other code right here all right let
me make sure I change in the right place
so all that I'm going to do is come back
to this code symbols and I say parallel
stream so rather than calling the stream
I'm calling a parallel stream I did not
change the code on the top at all but
what's gonna happen now well initially
in the map we went to Yahoo for one
price at a time now we send all the
prices to Yahoo thank you and
immediately all says wait a minute you
kept coming back
one at a time now you come with all of
this well that's Yahoo's problem let
them respond concurrently right and so
when they respond concurrently we filter
them all concurrently and then we reduce
it
well the slowest part of this operation
is talking to the Yahoo because of the
internet delay and now that's faster and
notice without doing any work by simply
flipping the switch by making the stream
to parallel stream we were able to get
concurrency going really well here and
if concurrency can be the simple how
life is where we can make this very
easily happen it is not automated it's
not automated but the beauty of this is
we still make an explicit call to make
this happen so we are aware of this
happening but we're not spending a lot
of time and effort I do want to take
your questions but I have to take it
offline because we are already late so
thank you for your very much for
listening thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>