<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>The State of Java Web Container Security | Coder Coacher - Coaching Coders</title><meta content="The State of Java Web Container Security - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>The State of Java Web Container Security</b></h2><h5 class="post__date">2015-06-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/o2NyyR88tW4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome everybody we're going to get
started welcome to the panel on web
container security I'm Rahman solo I'm
going to be moderating and I have two
panel members here well I think you'll
be interested in here just briefly
introduce you guys mark thomas he's the
Tomcat security architect and one of its
important developers he's also you work
for pitbull and he's the security are
for spring sort what is now pivotal from
spring source I'm that correct Jeff and
Jeff Williams he's a CEO of contrast
security formerly apparently aspect
security or something like that and
co-founder and former chair of the OWASP
foundation and Java rock star so I try
to set them off balance a little bit
early so I'm Ron montello I've been the
jobby platform security architect for
many years and I don't really do that so
much anymore I try to facilitate I help
people right specs that are not familiar
with that process but um I've had
dialogue with both of these gentlemen I
agree with most of what they would like
to have Donna so I just want to give
them a forum here most yep right so he
said I'm supposed to argue with them
starting I guess so here's the basic
premise of today's talk and we're going
to try to mostly talk and we'll also
find a way to have the audience
participate so we're really thinking
about it you know especially when
vulnerabilities are found is what do we
need to change so that people are right
web applications using the Java servlet
container in particular but just java
web applications more generally what
mechanisms or techniques programming
interfaces
better would make it would what can
prove the experience or the possibility
at least of creating a secure
application and that you know as as I'm
sure you know we we'd like to have it so
that developers don't have to embed all
the security in their application so
we're trying to figure out how to add
functionality that is to the greatest
extent possible applied by that by the
infrastructure on behalf of the
applications so that's our generalized
framework in which we're talking and the
other thing that we're trying to do here
is we're trying to crystallize what
could be added to standards there are
lots of mechanisms and definitions of
mechanisms that people talk about but
we're really hoping to get things into
the standard so that's what we'll talk
about and these are some brief slides on
the panel members I i will put these
slides up if you want these details I'll
just go I just put it a couple seconds
on each one this is jeff slide obviously
and then there's marks so what I got
wrong before to the corrected here and
my Werner keels supposed to join us but
he's nowhere to be seen so click all
right so we've been talking for years
sometimes we haven't made the best
progress so some of these topics have
been around for a little while so we're
going to just start our discussion on
these topics but will will go farther as
appropriate they s will find a way to
take questions in the middle of our
discussions I'll try to I'll try to keep
it moving so we don't want anybody to
you know hold the floor more than I'm
doing right now especially and we just
try to exchange as much information as
we can so there's five five topics we've
discussed prior that we like to begin
this talk with and I'll start with a
slide for each one of them the last one
we don't have a slide for it but we'll
just talk to that so the first topic one
of the problems that we see you know web
that web applications are confronted
with this cross site request
forgery and the question is whether or
not we can have protection as part of
the platform for cross-site request
forgery if you're not familiar with the
attack I've tried to provide a very high
level description of its how it occurs
probably that the one you guys want to
talk to this yeah yeah sure i'm happy to
who's heard of csrf but just about
everybody said that's great um so so we
let's say we basically understand the
attack how many people understand the
remediations okay so i should talk a
little bit about about that you want
i'll start so you know basically in
order to prevent an attacker from
forging a request through a victim's
browser the idea is that the web
application should add a token you add a
random token to your session and then
when you generate the UI you put that
random token into your forms primarily
maybe into links there's some trade-offs
there but the idea is then the attacker
won't be able to forge the appropriate
link to generate malicious requests
against a web application because they
won't have the token so it's relatively
simple to do this on a case-by-case
basis but I think the real challenge is
when you want to enable a whole web
application and all the forms and all
the links there's really no support for
that built into the server framework or
any other there's a little bit in spring
now actually so you know we're starting
to get there but I think it really ought
to be part of servlet in my in my
opinion there should be support for this
and to me it's it's a gap it means every
single developer out there has to write
their own custom code in order to
address this problem um so so how do you
want to handle this um do you want to
talk about what we might be able to do
or or or describe in a little more
detail why it's hard to like like why
wouldn't an annotation on a URL
for example hell yeah I was about to
tell us what he's going to do we've
already done it so Tom cap ships with a
filter that does this protection the the
issue is really that it's not one of
those things that they can contain it
can do easily on its own for you there's
got to be a little bit of developer
involvement here and in tomcat that
involves if you want to protect a link
then you've got to run it through encode
URL so Tomcats got a hook you can use to
add the extra token it needs to put in
assuming you ought to go down be adding
the token to the links rate and jeff's
that there are trade-offs there um yeah
we got a bug report a few days ago yet
when I use this protection the back
buttons broken well yes there is a
trade-off it only supports a certain
number of presses of the back but and
then it breaks some what do you do do to
add it to a scissor have talked into a 4
yeah we don't the minute okay so that's
a big problem right the worst ref
attacks are posts where you're actually
changing something on the server well
yeah it should be a product I say that
it depends how the app constructs the
form if the app constructs the form and
it puts the URL in and it runs it
through encode URL right will protect it
so it's there's a there's a train of
thought I what we could do but we don't
because it's expensive and complicated
and difficult to get right is put some
sort of filter on the app that stream
piles as it goes past 80 yet that's
something we need to protect that
something we need to talk that's
expensive and difficult to get right
right I actually think the best player
so that that's right trying to do it you
know intercepting the servlet response
output stream and parsing it and adding
the tags is terrible agree ospf guard
has a different approach which we came
up with which is we just inject a little
piece of JavaScript into the output that
HR output and when it hits the browser
it runs and it instruments the the HTML
page all the forms and links that need
good okay so it's a lot faster that way
um but ideally I think the solution is
to have components like a standard form
component or a standard URL tag that
automatically includes the token when
you generate your UI yes so where does
that go there you know it's is that
something that can go and serve with it
I don't see that in a circle that sounds
more like a JSP JSF UI know things done
to tag library library got a couple what
are we to go yeah yeah sorry how are you
guys having SBA you're doing everything
through your a tactical HX is a little
different because I it's very difficult
for the attacker to form an AJAX request
cross-site that will include the the
cookies so what we recommend for Ajax
request is to include a custom header
most of the major Ajax libraries include
that already like jQuery in this life
that already include a ex requested with
xhr header and what you need to do
though is you need to verify from within
your server application that that header
is present so in your Ajax interfaces on
the server you have to check to make
sure that headers there and that's it's
like a token because there's no good way
for the attacker to forge that header
from a remote request from an image tag
or a form or something please I brought
in every engine has to specially one is
one another body
that the evil act section through
Tuesday and all the extras in their evil
pyrotechnics efficient right maybe
something to the electric field by the
way I think of CSRF is I if I'm the
attacker I'm trying to trick your
browser into visiting things on the
vulnerable site that they wouldn't wear
them ornament important so it's not a
direct attack from the attacker to the
this site probably the best way to get
an overview for all the things that we
talked about today is to go read the top
ten yeah actually form the discussion is
punishment it seems like a lot of loot
we fight with autism is everything and
we try to do just call the suicide and
so yes after this problem that is you
can we just actually it's always
possible or all the time actually wrong
side if we can avoid that little bit of
two different sections if it has enough
talking to each other and on each other
then so happen so that the problem with
that is that there you know what you're
what you're suggesting is the strict
same origin policy where the browser can
only ever talk to one domain but the way
the guys that built the internet built
it they said hey you know what we all
want to share images because we don't
want everyone to have the same images
all copied all over the place so images
finally image tags violate the same
origin policy by their nature there's
also cross domain forum posting and some
other things that violate the same
origin policy that's not going to change
we could we could think it was a great
idea but that will never change like
that's built into the DNA of the
Internet cloud makes that even worse
like you may have mainly needs to use
defenders are nodes for performance
reasons or whatever does in a different
country cottage sure yeah yep
that's a wiener and declaratively say
this is on my side yeah and therefore
check for the tag or the header so i
want to but in PhD miss cuticle i'm
looking like that it's kind of perfect
okay go ahead of the night in the
session one generally that's what i
recommend there are folks that will tell
you to regenerate this token every time
I don't get it so I don't see the
problem with having one took in
procession I don't we I think if it's
all Ajax I wouldn't even bother with the
token i would use just the header but
you know took it's a little stronger
okay and tomcat i think we took the view
that different people are going to have
different views like some people are
going to want and you tape on every
single request yeah so it's it's
configurable and i think we picked a
default somewhere in the middle that
every five requests or 10 or so the
brittany is configurable you can change
it so depending on how paranoid you
feeling then you change it more often
every time I've tried to implement a
rotating token what happens is a request
gets lost somewhere along the way and
all of a sudden I'm out of sync and I
got to log in again and it's yeah it's
terrible for users so I think the that's
why I steer away from that side the last
thing we want to do is security is make
stuff less usable yeah and the way we we
address that in tomm case we keep a
record of the last however many tokens
there are so that's how the back button
role I don't know it works but there is
a point where it will break but like
with all things the security that yeah
this
it off there but what we try and do is
give you the knobs so you can configure
it so it works the way you want to think
right whatever we provide in the
container these two have those sorts of
configuration or such as well there
isn't a do it this way and it will
always be fine it needs to have a the
ability to tweak it for your environment
so I want to kind of wrap this one up a
little bit by asking a question and
which made go up and go on a little
farther it sounds a little bit like we
need something like a filter in the
container and we need a tagging
mechanism that's at a different level so
then the question is does the other
level that provides the tag also provide
the filter or does it assume that the
mechanism is native to serve what or am
I just asking details there that nobody
cares I think on an oh this was a
discussion we were having before and
before we had the discussion I was kind
of neutral on how you do it but I think
Geoff's point that it's better if it's
just native in the container and you
don't have to configure a filter there
will be some configurations somewhere
whether it's annotations whether it's
web dot XML it'll probably be both but
the functionality I think needs to be
buried in the container rather than some
plug in thing you are in depending on
specific for each one they got or with a
standard API yeah just to get through
this so then just so that we we capture
that so does that mean that there's a
contract between the container and the
higher level framework the tagging
library that it understands in response
to certain annotations or tags it's
going to do something yes it's so and
it's always so is that the
recommendation so it's it's we're
building essentially so we see that
contract then has to be you know it's
you know the one-sided contract I mean
you could say here's what servlets doing
you should use it when you're building
your tech labs or whatever and if they
use a great or they could implement
their own yes I did I get it yeah but
how does it work how does what what is
the form of that contract is it since
the servlet container doesn't understand
tags how does it communicate to the
servlet container do this for me now it
could just be like a token name like you
know we have like
Jay you had yeah you added to you had a
header do you mean to a response oh you
can you money because daily a parameter
took in him could be like Jay csrf ID or
something so you would add that in your
form or you'd have a you'd have it
possibly have a depending on how your
building that form up it could just be a
a new guest on the HTTP response you say
grab me to all the requests grab either
toca then you have to build that into
your what have you hard to enforce
because if you set a rule that said
every form submission to this URL has to
have a parameter with this name or it
will get rejected developers going to
add the show to do that maybe we're
stuck in a whopper all right so maybe we
can stop there but I I would like to see
us have a way to say how the division of
labor have that I think my view on that
would be that I would reserve judgment
until I try building it and said see
what works and what doesn't yeah you
know I'm where I'm with you I I just uh
I I asked the question to these guys
before brand least I put it here as well
as to try to understand where things
changes and so in this case I just wanna
and I'm going to try to report back the
people that we'd like to have some basic
token in sort of injecting capability
and what the trigger is for having that
to happen I just wanted to have some
kind of one quick caution you might add
to that note is that you can't put a
token on every single page because some
of your pages you want to be public and
some of your pages you want to be
bookmark about and if you require the
token on those pages then they just
won't work would you know click on later
on baby so that that suggests that you
need some sort of annotation or some way
of you know wild carding the sites that
need tokens and once they've done just
look this was a very good discussion any
shall we move on or you can come back to
this one if you want but let's just try
to get through and then we'll come back
so another thing that I personally been
made aware of but
by a servlet expert group is this
problem with HTTP potential problem
that's referred to as HTTP parameter
pollution and this is a relatively a
straightforward problem where a form on
a request URL has the same name as a as
a form parameter so if that happens when
you call request on the request method
when you say get parameter by that name
which parameter you actually get is you
know not necessarily what you would like
in fact probably not what you'd like
because the form is not given precedent
the form is where the user probably
entered the data and the parameter in
the request URL may have been changed or
how should I say may have been pre
configured by the wrong party so you
want you want this one better no I think
that's a that's a nice description so
you end up with a request that's got the
same parameter in the URL and in the
fall and you call get parameter and it
pulls the one out of the URL and the
which the attacker put there and the app
was expecting the one from the form and
we've discussed a handful of ways of
chain of fixing it I think the simplest
one is just changed the priority order
the day inside is that's likely to break
stuff and java ee generally well it's
not likely to price it it might break
stuff it's certainly not guaranteed to
be backwards compatible and jari shied
away from anything that isn't backwards
compatible but I think the solution to
that is well just make it configurable
and change the default yes probably an
allocation basis somebody I'll make it
go that level but just to add one thing
to a mark said is the wii was i think it
extends to the server like expert group
so this has actually been discussed by
the servlet expert but i think there's
some consensus or almost um yes there
were there was definitely some solutions
that there was consensus were really bad
idea that they do I don't think there
was quite enough will should we say to
actually get put something into this
back and change it but yeah I certainly
have no
actions to changing the priority order
and adding a configuration option what
the details of what that configuration
option is how you configure it what it
is in web.xml I'm not really that both
at it in whatever it is we can implement
it it just changed the default you have
anything Betsy I was just going to add
you know in the worst case this can be
really bad an attacker might send you a
URL that you click on with the
parameters in it and then those
parameters will override the ones in the
forum because of this president's
problem so in order to find this in your
applications it turns out is pretty easy
you can search for any forms that you
have that don't specify an action
attribute you know the target URL for
this thing and if there's no action
specified that means the form is going
to post to itself which is when this
problem happens so it's easy to find
easy to fix if you just add that
actually an alert but i think the global
solution that we're suggesting here is
right that we should change the priority
and accept post parameters first because
more than likely that's what you
attended what happened I page what
happens if it's a relative URL in the
actions that fine it gives you expanded
by the browser to a full URL anyway and
the it's a lot harder for an attacker to
mess with a post with the post
parameters so let's make those the
default yeah well actually I'm not going
with that because they could send you a
page with a four minute and he says
since you can pour post cross-domain but
but it actually confucius the forms in
front of you you're gonna go and you're
seeing your for the nsa's it when we all
who provide the fields that are there
like hey you know that's interesting
though if they said to form with the
same name and in it with the same name
what happens don't know ah yes I do I've
just had this out I've just had this a
argument discussion they get returned to
the browser in the order they appear I
don't think about that it helps me have
some more work here maybe i will stop 11
by the song a gentleman on the back of
the tree speak up please speak up a
little bit
yeah that was one of the options that
the expert group discussed where the
short version of the discussion and it
did go on a while is you can't break
backwards compatibility so you've gotta
leave the existing methods there yes you
can add a new method to separate get and
post developers won't change don't just
carry on using the current one well yes
but that doesn't actually solve the
problem what was often I am of the view
that well if developers choose to shoot
themselves in the foot then they can
deal with the consequences but if
there's an alternative solution that
does actually fix it then the other that
I think that alternative solution is the
way to go other things we discussed was
putting a flag on the method to say
whether you wanted to get all the
pirates but it all comes down to
changing the API unless of course you
can persuade the powers that be and jari
that it's okay to break backwards
compatibility and I think you're on a
hiding to nothing on happen to be honest
and to me I think you really just put
your finger on the biggest problem that
the servlet spec team has to deal with
in terms of security is that you can't
change anything that's going to break
any existing apps and I've been trying
to push through some changes on various
things and gotten nowhere because it
might break stuff well and that's what
eyes are deprecated there is a process
for deprecating but I do take your point
that there's a lot of headwinds that in
order to keep up with the advances in
the bad guy technology yeah we're going
to have to evolve and other platforms
are that's really the way let's not add
it to take away that we need a faster
interface evolution strategy I'm also an
important free expert group in there I'm
not going to detail what executive of
that are certain things saw where it was
actually decided that it's best to have
the default being the new option that
actually forces developed us to change
the code if you want to
of the combined with the news back but
there's like it's which way you can see
insecurity comes back what company guy
that would be insecure so you cooked
okay jus don't want change your cold you
can damage back but the default out of
the box it will be any wearing okay let
me go to the gentleman he's had his hand
up well that that's I think the point is
is we we need to have more latitude in
this regard I think that's his Geoff's
point so let's let's agree that in this
room that's look that's well understood
but we have our work cut out of course
we have to see what that there were a
few fresh faces yesterday during the
candidates for the executive committee
is the hopeful specs off course also
approved another proof or criticized
whether you see having fresh faces they
are made probably also changes I get
your point so let's go to the next topic
I think we're going to I think this is
interesting what we thought was simple
to solve we came up with a few other
ideas here things we got to look into so
input validation and escaping now this
is something that Jeff it's like a
religion so I'm turning it over to him
but there's a lot of problem with it
data that's coming in from from the web
to your applications and that your loop
you're using in your processing
including returning it back to browsers
and you know we need to I i recall
correctly you've you've said that this
is the greatest source of
vulnerabilities and web application oh
there's no question the number one
vulnerability of all time is XSS it in
terms of numbers of vulnerabilities that
succeeded all the other types of
vulnerabilities ever discovered put
together including buffer overflows um
there are vulnerabilities that are more
serious which is my sequel injection is
what one notch higher and the OS top ten
but exercise is by far the most
prevalent and in order to fix it
developers have to be able to generate
HTML that's been you know that if
there's untrusted data in there it has
been properly validated and
escaped so a few years back i wrote a
library called es api and a wasp and
it's got a set of escaping methods in it
and I thought I'd be good idea to try to
add that to the sur les back because
then they'd be available much more
broadly than you know people download my
library uh and I haven't been able to
make progress on that to getting it into
the spec itself so that's that's I think
one of the primary reasons why exercise
is so prevalent is frankly it's really
hard with to generate XSS proof HTML
with the tools that are available how
much experience sorry I'm just looking
at one question how much experience do
you have or how much experience that
developers have with those encoding
routines can that be presented as a
strong argument for why that paradigm
should just be standardized there are
currently 4,400 companies using by the
acpi library there are a few other
encoding libraries out there absolutely
different goals in mind but you know I
think that that the idea of an encoding
library is wildly successful I mean that
is the defense you know that we know
about exs we just need to make it easier
to use yeah I mean mostly if you're
asking about how the API is one thing
for people anymore I think the one of
the things that I took away from a
no-loss conference I went to a few years
ago was not only is important to do the
escaping it's important use the right
escaping in the right context and that I
think is something that is developers
are less familiar with and you end up
doing HTML escaping in JavaScript or
something and it doesn't really help
very much right so having one of one of
the other advantages of having that API
in the servlet spec is developers will
see it and I think oh hang on why are
they different which one do I
nietzsche's or I'll go read the Javadoc
the Javadoc that explains it and it
helps with the developer education so I
be all for it I think as we talked about
before
this the other advantage is that having
those methods in the API encourages
developers of higher level libraries
like jsf tags and so on to use the
proper escaping like then everyone will
be using this common escaping framework
instead of having everybody crafting
their own a terrible escaping scheme I'm
getting it wrong ways to this evening
that's that's really the problem I
looked in one company's whole portfolio
of applications i searched out all the
encoding and escaping methods and there
were 50 different methods yeah all of
them were broken in some way or another
they were incomplete or encoded the
wrong set of characters or you know
we're just not well implemented for the
range of things that they were supposed
to do turns out it's a little tricky to
get those methods right I spent a lot of
time figuring out and I want people to
use a gue do you think this is something
that should be a JSR by itself possible
well I just the encoding or situation
coding and this isn't typical but it
could perhaps be in the circle at
namespace you know it's a bit small I
think maybe for full JSL and dancers are
small these days like jason peters asian
guy which led under the injection
consists of six annotations kids are
preferred yeah we might get very similar
is ours and the reason i suggest that is
i just want to see things happen and i
don't want you to have to wait for the
servlet spec but so then you have it you
have a problem then because you know the
objective is not just to create an
encoding APA you have that already
you'll be giving it some credibility in
javas namespace but that's probably not
all that significant so your real
objective is to get somebody to adopt it
yeah yeah and and Liz but I I'd support
that I don't know if anybody are uses of
that escaping API outside of Sir blue I
mean there's you know there's lots of
different codecs that can use databases
and held apps and also know there's a
lot of other escaping methods and Mark
mirrors are grind in something yeah xml
json i mean it would be nice to have
little fun together in one place yeah
highly efficient implementation I
providing an agent p
a bit addition to the core I guess it I
guess I may have it wrong there's a
binding this is jason right go ahead and
watch yeah it was gonna say it was just
um put it somewhere other than the
servlet namespace put it in a security
namespace or something somewhat and do
it in a way that gives a scope to expand
it other things in job x security yep
escaping yeah so or you know just
encoding or royal favor okay the action
passes multiple security like no but see
but see you you just got a ton of me
there because i think you've been
blocked but you can't go through this
assembly right so maybe that won't work
I'm the one what if you go down that
route the one thing you probably do want
to do is make it a mandated dependency
for certain the containers that's the
part that you stop at that's what I so
you have to feel the same people go see
a lot easier it's be a lot easier winter
day pajamas one line in the spec so what
I yeah that'll be a lot easier i think
so that's a suggestion there and i think
that would probably totally blaze past
the validation part of this i think it's
important i do think the bean validation
GSR is you know getting a long way
towards what we'd like to see for that
so if you know I validation is still a
big problem for servlet developers we
don't see it done consistently very well
but you know I think we're there is
movement on that front you think there'd
be a contradiction if you try to put
that in a you know in a JSR within talk
with it and might conflict with bean
validation answer I worry about the
problem with beam validation is that it
only covers beads like what if you're
using a header or something or a cookie
value or some other thing that's not
going into a beam that you're using in
your UI or something then then you don't
validate it because you don't have a
method there thing is I guess we'll be
pull the vehicle systems from what I
heard some hot because it's an optically
standardized a problem but based on the
new chase off with your eight you can
also have annotations that do other
things of validation including all or
stuff like that
oh hi low level can something that
without humiliation will hold it to a
tramp I'm just going back a second cuz
I'm thinking ahead to the pull side so
that's going to have to implement some
of this stuff in a few years time like
what's the licensing on ASAP on its BSD
but fine so that's all I can work with
that free you know for everybody it's so
any other comments on this topic we're
getting to the end here so we'll have to
dream up some new topics i guess i gotta
come just kidding it i'm not sure
there's oh I I put this in here this was
Jeff pointed out that there's a lot of
headers that are added to response
messages to affect the behavior of the
browser so that it doesn't misinterpret
things that attackers have become
accustomed to taking advantage of
certain interpretation so you can
essentially constrain the interpretation
of the browser if your server returns
some headers that's sound like them so I
view this as a different type of
constraint so in servlet and I defined
this constraint model many years ago and
it was really focused on inbound
constraints to this server container
everything things that the server
container had to do now now what we're
thinking about is maybe part of the
programming model could be that you
could specify constraints that
essentially had to be satisfied by the
browser and the effect on the servlet
container would be essentially just to
activate those two essentially attach
those constraints the responses so
that's the general idea without getting
into the details we could talk I'm sure
Jeff can explain all of these cases but
that's the general idea and we were
thinking that maybe that could be a
feature that was added to servlet as
part of its security model I would
really like to see this the new headers
that are coming out for security are
super powerful and can really
dramatically improve the security of
websites I think strict Transport
Security for any application that is
mostly authenticated you should probably
set strict Transport and just make it
SSL only all the time and then you don't
have to worry about
vesa cell and things like that well you
could almost do that today couldn't you
bye-bye well let me not confuse spectra
causes some cool things to to handle all
the corner cases yeah and by telling the
browser we want this site to be all ssl
the browser can really help out the what
I was going to say Jeff which I'm not
sure if this is a disliking mechanism
existing constraints we have in the
server for Transport Security they could
be interpreted to add this header like
it I mean it's got its kind of a so I
was trying to differentiate these
headers as browser constraints so that's
why I hesitate to say that yeah right
but you know that's one that's a little
bit we within the definition of the
constraint as it's probably defined this
could be assumed that be part of its
interpreter I'd I think I idly say no
okay um just because I wouldn't be
surprised at some point to come across a
me that wanted one and not the other so
I'd rather have the ability to define
them separately but let me let me say
that I agree with you but one of the
weird things about the constraint so
when I defined it I added different
qualities of the constraint which nobody
has ever figured out how to implement
but so you can easily just you know I
have a constraint that's just you know
integrity there's another one for
confidential you can easily just say you
know you want strict or you can yes a
dark line value that without let it
really think it's yeah but but the I
think the idea is is that I think we're
thinking about it differently when we
talk about constraints like this because
we're really imposing constraints on how
the browser interprets the things that
you send back to us yeah I think from my
perspective I'm really just looking for
a way that that you all as developers
can look at an application and say I
want these headers for these different
chunks of my sight you know this this
type of URL can't be cached this type of
URL needs clickjacking protection this
other chunk
to be strictly SSL and that kind of
thing so that developers can manage it
right now everything's done on a per
page basis which means you got these
little crappy pieces of code all over
the place and no one can get it right
unfortunately you know that you updated
one place and not another and pretty
soon your whole sites a mess and can't
they mostly handle that with filters
they could but people really don't they
stick these things into their JSP files
as meta tags and you know it's ty don't
want to argue that point but I do have a
different question or it's kind of a
little bit of a problem see I described
this and I tried to upload it into
Transport Security framing download and
care set not because I thought those
were good descriptions for these yeah
but if you're going to construct a
constraint model like at the level that
we've been doing so far you need to
extract yeah what the effect is
clickjacking may work for a lot of
people but i think that is itself a
little baby maccrimmon's better we just
need to have a model like that if we do
you could probably I think it could be a
part of this so everybody know
clickjacking just familiar with
clickjacking if you're not it's a way of
taking a framed page of your site and
floating it over a malicious site that's
designed to trick you into clicking on
it and the solution is on your website
is to not allow your site to be framed
or if you need framing to define who's
allowed to frame you more carefully
almost every page ought to have an X
frame options header of some sort on it
and barely any do you search the
internet they're just you know it's not
very widespread so I think I'm Berman
this is really Jeff's idea I'm just
fitting it into our constraint model you
know I would support that kind of an
extension of the constraint model I can
probably help get that bomb I'd like to
see ocean go ahead what does this just
sort of on a more of an implementation
detail just at the minute you when you
specify looking straight you basically
have to pick one and one of the things
we could do is just let you pick
multiple options is I want that one that
one and that we
yeah they make it very yeah make it
because there's ice hey its back
accountable as well yeah I liked are you
sure that whatever we do is extensible
because you know this this is the way
that we talked to the browser with via
headers right and so it would be you
know abstracting that protocol
essentially into some configuration in
the web app and I think it could be done
very cleanly and I need to get my head
around the constraint model for that
purpose but you're probably right that
it can do it cuz constraints can do
everything right no they're not on by
default where do you have anything to
add ok any other what what I interesting
question i got this almost last but who
any of you use also on the server side
trusted cheers are or a la Bonz of
trusted computing that program not use
kids are three two one not really no so
ok i had a couple topics if ever I think
we're done with our list this is not a
parent appropriate for everybody but I
just want to make sure it was in there
yeah we can take questions or I thought
universality yeah yeah I'm sorry that's
hurt Denmark brought up and i'll just go
back to the top just so video catholic
context we put a one other issue it this
sort of comes back to sort of one of my
little bug bears in in tomcat about i
made myself really unpopular in a tomcat
community a few years ago could because
I decided right there's a spec for
cookies if we don't follow it we have
all sorts of header injection problems
we're going to enforce the cookie specs
and it broke so many applications you
would not believe oh yeah the number of
applications want to put an equal sign
in the cookie valley without quoting it
anyway nice yeah I get it I mind that
you're suggesting air injection relies
on carriage returns in line feeds and so
I thought you were doing the minimal but
you really did the whole spec you
because I
stop what we because I never were and
that some of the issues we're seeing
were with the characters and live feed
but you stopping at x 3 equals things
you for all sorts of ambiguities that
how you a deposit so what this what this
got me back is like I then went to one
some people were complaining I was
looking for evidence sort of defend my
position you go back to the service back
and it says okay I can set a cookie name
and I can set a value what it doesn't
say is can i pick anything i like there
and the container will encode it so its
safety transported to the browser and
correctly understood or I'm only
responsible for encoding it or am i
limited to a particular subset that
there's no concrete definition of what
you're actually going to do that so
Tomcats taking the view that you can put
anything you like in there and we'll
make sure it's safe but another
container might do something completely
different so something that's perfectly
safe on tomcat might be wide open with
the security vulnerability on a
different container and that's just one
example of where this service spec is
ambiguous it could potentially it's open
to interpretation that those different
interpretations could cause problems so
what I one of the things i think the
service expert group needs to do and
unfortunately there's no choice but yet
server expert group has to do it is to
go through and resolve those ambiguities
and be more specific yeah I'll be
eternally happy if the service peckers
was precise as say the HTTP spec or the
WebSockets back there's far too much
wiggle room and we need we need to
reduce a particularly worried
security-related there's a whole bunch
of other non security stuff I'd like to
fix as well but let's do the security
first do a quick poll who would like to
be responsible for properly escaping
their cookie names and values okay you
can do it for everybody yeah we invented
a word here I know this to our can i
think is he doing acuity that is holy is
degree we were looking for a verb there
yeah
if any other any comments on this our
alternate over to Jeff and hola there
were some other things we might be there
all right so one other thing that I
thought it's in the top ten i think its
nine is called using indirect object
references are using direct object
references with that what that means is
you're exposing object names from within
your application as part of your UI so
things like database keys and file names
and urls get exposed as part of the UI
and their invitations to hackers to mess
around with them we find lots of access
control problems that way and there's
essentially no support in the service
pack for making those direct object
references indirect by creating a random
number or some sort of other obvious
getting scheme to you know to allow them
to be harder to attack so you need
something that would here's of his a
bunch of ID's or something that I need
some ID some random numbers for ya and
then it maintains the map and then you
can look them up together it's not only
that you said that so in es api i made a
bi-directional map called an object
reference map and you can you know if
you give it the real value you can get
an indirect value and if you give it the
indirect value can get the real value
and you use it when you generate your UI
to translate stuff back and forth it's
super simple but it's not widely used
because it's not part of the back
somewhere and i think it's a valuable
little utility it's something that
developers up to wrestle with all the
time and we should be preaching I had a
colleague who called it don't expose
your privates and that's what they
should really think about you know don't
you can make those indirect so there
night not quite so much of an invitation
to attackers sounds like a good idea I
have you know I have this Jeff I
contributes to the identity jsr as well
and have references all over the place
yeah he's not much of a ginjury not
everybody much like then I
not contribute but we have we have an
important reference scheme and that's
one issue I'm struggling with maybe I'll
bring that up there but an interesting
chat with you on falls from the body
power project that they they for example
in a the user account for some cases was
more like ethical reason decided not to
expose the tender so that would be
something that the user identity would
not contain I guess aside from that it's
definitely what other projects that is
related to castration but also be
interesting for the NHS are telling for
ya yes you're right um I don't know how
much time we have we can ask a question
yes there's any other topics anybody
wants to talk about go ahead Sean
well I think what you want is to have
other locations where there's a policy
enforcement point than just the one yeah
so so this this is a little bit focused
away from me JB but the general if I
understand that you're asking an ejb
question which is a little bit off ok ok
so so servlet doesn't have currently any
method based access control it's a URL
base yes so so we've actually done some
of that in the identity jsr based on an
interceptor paradigm so we we pick up
annotations and say you know role it's
sort of like the rules allowed
annotations and we probably we
essentially where you put that
annotation you now get an enforcement
point so I think that is an important
general yeah yeah well I think that
we're gonna if we're going to create an
annotation it's going to be high level
and then the I think the variability
will be on what policy you put behind
that unfortunate by wait wait we'd like
to get to the point where we get we just
approximately say you know it is allowed
you know that's approximately all we
want to put in but so when we put things
like roles we were just going a little
bit farther we don't want to go too much
farther than that then we get too much
cohesion between the the app and the
Pollard annotations it's also not so
easy to define all right we just if
right in the next room I believe there's
the pocket other corporation which is
our idea it's not get us out to be soon
and that's of course something where you
might also want to be able to configure
roles and other things between different
stages
so what is on of these let me just
summarize what my response to him I
think it's something that's herbal it
should do but I'm not sure that it will
happen in servlet so as with my I'm
going to have to implement this hon I'm
just I can see it it might not be as
trivial as I would hope it to be now I
know it needs some thought about how you
actually implement it what that would
look like but the concept I'm I'm quite
supportive of it's there ok how on earth
am I going prevent it that is bothering
me but that's one of the things that if
the expert group gets started on some
thinking about these things early enough
you can actually get the draft
implementations and get the feedback and
understand what works and what doesn't
and improve the spec before it goes
final rather than write it from your
ivory tower then try and implement it
and then find out what all the problems
yeah Jeff you want to say something and
then I'll have yeah okay so uh I my view
on this is mostly backwards looking
because I look at code that was written
over the last 10 years you know we look
at millions of lines of code every month
that aspect then I guess what what I
would say is that the use of of the
access control schemes in servlet and
even annotation based access control
systems like in spring is a little
erratic and in code that we've seen and
it's kind of like the headers problem i
mentioned earlier is that you know you
have to put access control in all over
the place and different developers do it
differently so what I would really love
to see is a way to somehow quickly audit
it if there was a way to dump the access
control policy directly from the code
into some readable format that I could
then look at and say oh that matches
what my my concept of excess control was
supposed to be we've written some tools
to try to do that for spring and other
things that kind of dump out the access
control matrix and we always find you
know this page should have had a check
and it doesn't
kind of stuff and so I think there's a
lot of room for helping developers get
the policy at a global level right it's
one thing to give them the mechanism to
do it on an individual method or page
but we really can't forget about the big
picture problem either because that's
where a lot of the difficulty is just
let me agree that it should be separate
out of that this is one of the reasons
it's dirty
because that way I'll go to change in
and it's also auditable as a separar man
yes that's exactly the bid they will
configure something for some intense
environment to your production by
without we combined people I create what
I was going to say it happens so vaca
said she sums up why I don't like
annotations in the service macro at all
but how about that arguments long gone
yeah there was all of my colleagues in a
project in ravenna hope asked Adam being
the question to get a divorce or some
other at the comprehensive Europeans
predicted he was of course also a
wonderful people advertising the use of
annotations because it's like simple and
you don't need XML there have been lots
of talks by we like element my colleague
argue that in real life you sometimes
need XML because today's right but you
know the model is that the xml / I see
so I you know I was stuck in the middle
of this my annotations for event given
they came down from high that you know
there will be annotations I heard
yesterday for the first time who forced
them into SC I was surprised because
anyways but but so the compromise that
was reached is whatever you write in
your web.xml essentially deactivates all
the annotations so annotations are
convenience mechanism and you know if
you really want to have the decoupling
that you're looking for it's there just
you've got the ruby slippers use it what
i was going to say ask mark is as a
starting point for a proposal to include
something like this in servlet if it was
just that you were able to do exactly
what you can do with Rosa let you know
the existing role so all you have to do
is the same type of check for role
membership that you're currently doing
so you don't need to understand any new
policies that is that's a little bit
that bothers me the bit that bothers me
a finding the annotations is easy yeah
the
that bothers me is how we then put the
hooks in at those points to make sure we
do the checks at the right point that's
why I suggest the Interceptor yeah
because I've done that I think it's
possible but I a super yeah that
thatthat's they don't look at an
investigator's another whole thing is
having separate policy spaces you know
for different you know it's really if
it's if it's a uniform system and you're
really just making enforcement points in
another place yeah it's about that was
valor del that would be better
definitely we never smiling so what's
wrong he smiles because he can make
money if we make a mistake I did it one
more topic yes now there's a touch there
is no action and I'm sorry yeah it is no
Jeff I did actually but you're it's
another approach to that same problem
they're actually not tremendously
different use the Osborn you primarily
because some cat didn't want to pull in
a external library so it's just a waste
just one filters well there's a whole
bunch of other stuff in there da lost
library that we didn't want to ship with
tomcat so we just did just did the
filter bet a generally it's just a
tomcat is kind of anti adding any more
jars less it really really nasty so
actually what are the major feedback
we've gotten on yes API is that there's
a few dependencies there and people
don't like them so what come in
every book that is a big big problem
that is extra we have a lot a lot of
code to handle at the digital manager
and it can see the question and then can
help displayed do another much honorary
on all kind of and so the manager
is self typical so typical actuaries
colleges you two years ago just have to
locate the years later adding another
school in here and some I'm divided okay
here you can see you at the Seoul
district is anyone can see that animal
cannot see just all just very power or
electric almost all logic is just kind
of handle this and so so far actually
that is kind of surveillance limited
actually just generate HTML and so they
won't know such a bit any component
mobile that's okay i can imagine okay
just a minute d actually where you get a
base to manage all that the okay okay
let's just look at this is a big big
 so is anyway it may be different
it's not the question anyway output we
can do some componentized just a
takeover component become human
situation and then we add that right
access controls to them and then
configurable application it sounds to me
like well up for that particular i I'm
probably one of the world's worst yeah
I'm probably one of the world's worst
web developers so this is probably the
worst idea but I'd probably gets up with
some form of Title I were to do that for
exactly what I was going to suggest is
build the access control into the
tagline and then when you invoke it you
just have to pass the role as they just
get users don't get all your contacts on
the other requests get the current roles
in the way you got ya yeah thought
that's probably how I'd do it well
you're basically taking the security in
philly entirely that was just on the US
side you need to do something similar on
the business logic side and you know
component eyes your business logic you
know in a way that can handle that
that's tricky though it should be easier
but older there's always that try and
push back on the requirements but that's
not necessarily easy thing to do in the
world right boy are we ramp it up or you
can now is just going to talk about
encryption for a second sure one of the
things that's really hard in Java is
getting encryption right you guys have
all probably experienced this the in
fact somebody once called the jce API
encrypted but the API is included okay
well oh so call them we're actually from
the same info knowledge is all that i
mentioned frosted cali i'm not sure if
there was expected but they weren't
least involved anyway we took a shot at
that in the es api project to try to
make a simple library that is just what
most developers need like the 80-20 role
you were talking about before you need
to encrypt a string decrypt a string
sign something hash something you know
simple stuff like that and we came up
with a pretty nice API and you're going
to laugh we went to the NSA to get it
checked for strength value verified
every sunday
I think I think they like it just on
Helena's is your API connected to the
provider frameworks underneath it is it
built on top of that so it leverages all
that good power that's there and and
makes it much easier for developers to
use and get it right without making some
of those really tricky crypto mistakes
that are easy to walk into like padding
Oracle attacks and things that's very
hard to avoid those if you don't know
really what you're doing so we try to
build something that would just give
that high level API so I don't know what
I'm going with us just check it out if
you if you have that problem you have to
speak up a little bit but oh that's
great to hear great to hear
sure he started using my situation
creates understand people
are you the next speaker welcome to stay
here and talk but the tech needs to be
done because he's gonna double know
you're welcome to stay you're talking
just going to shut down thank you come
on dad you could take all this stuff
okay yeah yeah</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>