<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CON2483   Java SE 8 for Java EE Developers | Coder Coacher - Coaching Coders</title><meta content="CON2483   Java SE 8 for Java EE Developers - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>CON2483   Java SE 8 for Java EE Developers</b></h2><h5 class="post__date">2015-12-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/-ZtAwvenQZw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone welcome to this talk java
SE 84 java ee developers now what is the
purpose of this talk really it's about
talking about java SE eight you know
that about a year ago something quite
all depending the java space we had a
new major version of java it take quite
some time for some observer web apps /
like tomcat to publish versions that
would support java ACA but now we have
them we have a version of weblogic java
ee 7 that is compatible with java SE 8
and that suppose device yet so we had
the feeling with the with david alaba
say that it was a good time to present
the new features of java SE 8 to the
java ee space of course java e july see
a Java 8 is all about lambda expressions
and stuff but I don't think that the
first thing you're going to to do if you
if you adopt java 8 for your
applications will be to convert all your
critical data processing pipeline built
on collection framework to the stream
api or using lambdas just at once so
what I would like to do in this hour is
to uncover some little diamonds
scattered here and there in the JDK that
you could really use up front once you
have moved to java 8 so i'm not going to
talk about lambda expression much i'm
not going to talk about the stream api
or bad collectors i'm not going to talk
about javafx own ass home that will be
cheated really what I'm what I would
like to give you is a good overview of
everything that is new in Java 8 once
you've removed everything that is new
you see what's left in fact and there
are many things left as we're going to
see many things much enough to pack your
one-hour talk I believe me so if you
have questions you can hose you can use
this application and you talk in your
phone and it will be recorded on and
broadcast on the
on the headphone that that's great you
can also use Twitter and I will publish
the start the slide on my Twitter
account within this ashtag after the end
of the talk so you can also interact
with the with us using this outside if
you wish so my name is Jose a I come
from Paris France I I live there and I
work at the university as an assistant
professor I also work as an independent
contractor in the Paris Area I've got
various material online i have a blog
called Java as well but it's mostly in
French I'm also from the Paris Java user
group I do that on my spare time and I
also publish courses online on the side
coupler site mainly but I've got also
content on the Microsoft Virtual Academy
believe it or not okay but this is true
in fact and it's a Java e equals on mba
and i also have content on parlays which
is the platform that publishes the toes
from dev ox and i'm also another for
java magazine ok the first api i would
like to talk to you about is the date
and time api we've been living with this
all java.util.date for years in the java
space in java 8 we have a new date api
called the date and time api which is in
fact a kind of port of the of the java
time api to the jdk the date and time
api is built on several concepts the
first concept of it is the instant
concept you can be an instant with this
now method start and end this instant
object is just a point on the owner
timeline and it's also an immutable
object difference from java.util.date we
can compute durations between instants
of time just with this API duration
between start and end and it will run to
it will return you a duration object
from which you can build well get
certain certain numbers here
representing for instance the number of
milliseconds between start and end you
also have we also have an arithmetic on
this duration object i can add for
instance here two seconds to a door
object directly this is very nice and we
didn't have that in the java.util.date
API the precision of the timeline of
this date and time it's PR is the
nanosecond which is great for most of
application now if you are in a particle
physics or particle live like 10 power
minus 23 seconds it might be not precise
enough but not that much people working
in particle physics a local date is the
second concept I like to talk you about
it's just an everyday date and you can
just build a local date with the now
method same at the instant date and you
can we can also pass just the perimeter
of this every day date with the earth
method like on the example here as I
have the concept of duration between two
instant of the timeline i also have a
period between two local dates so i can
compute a period how many years would
have been Shakespeare we would still
alive well I can compute it directly
like that and I can also convert this
local date in milliseconds using using
this pattern in fact you need to be a
little careful because period as a set
of Gators in it but Gators that do not
any kind of conversion inside the object
it just return the the number the
reminder of the milliseconds for
instance great so this is the period
object I also have the temporal adjust
class which is used to do some
arithmetics on local date I can do now
with a ton prodigious turn next day of
weeks let's say sunday for instance and
it will compute me the new date here
what is the date for of next Sunday and
I've got a bunch of static methods with
the subject of a 14 tactic method with
the first day of month for instance of
the last day of year which is extremely
handy so going out the day when you have
to act the calendar class now you can
just use this and do
you want okay i also have first in
months monday so let's say next month i
want to know the date of the first
monday of next month I can do that
directly through the API okay I've got
this local date i also have a local time
which is a local time in every day time
okay so 1020 is just local time of 10
and 20 which is really nice i also have
an arithmetic on the local time object
so if lunch time is 1230 well at least
in france is a bit like that i can add
two hours because we like to eat a lot
in front so we need two hours for that
and at well two hours later it's coffee
time just to not to be too much asleep
during the afternoon for instance okay
so this is the local time what is night
is that this date and time API provides
a excuse me provide directly zone the
time you know that it's not the same
hour all over the world which is quite
odd but it's true I've got this set of
string and zone ID dot get available
zone IDs which gives all the well the
set of all the time zones reference in
the world is our weekly implemented in
the JDK so this is really nice and if I
want to have the zone ID of Europe or
London I can just ask for it like that
great I can from this zone ID and local
date and local time I can build zone
time now you have to understand that the
timeline is completely independent of
any zone time so point is the timeline
is the same wherever you live now as own
time on the contrary is something that
is different depending on the time zone
you lavina so here for instance i am
building basically a local time and the
local sorry a local date and the local
time and i am adding the time zone to it
just to build this zone time i can print
it print it out it will use a default
format to do that but I also have a date
no matter that we will see in a minute i
also have arithmetics on this zone timer
so current meeting Plus let's say one
month will return me another zone time
and if I want to change the time zone of
the second zone time because my next
meeting is scheduled with people from
the US for instance well I can just do
it like that take the same instant of
the timeline and transfer it to another
time zone so this is extremely Andy and
this is extremely powerful I do not have
to act once again with the calendar to
do that great now for the date formatter
you know that there are many many ways
of format dates all over the world one
instance and I have even several
standard for that which is quite funny
because the standard is a standard so
having two standards for the same thing
might look a little odd but it's like
that so I have a bunch of date formatter
predefined in this API for instantly I
so date time which will print the result
here and the RFC 1123 day time will that
will print out the day time in another
format great now this date and time API
would be nice it is not supported in the
current version of jpa that we have in
java ee 7 unfortunately but i have a
bunch of methods to bridge the legacy
java.util.date and this new date and
time api here between the date objects
and the instant object here with between
the timestamp objects and the instant
object and here between the data object
and the local date object and at last
between the time object and the local
time object and from that and leveraging
the converter from jpa i can use this
date and time api right now right now in
my java ee 7 application I just need for
instance to annotate my instant filled
in
I entity class with this convert
annotation that will get the date
convert to class and this date converter
class is fairly easy to write it will
just use the bridge between the date and
time API and the legacy a date
java.util.date this class implements
attribute converter here from instant
the new date and time API to date which
is the legacy code and if I want to for
instance have string of characters from
Italy in a certain way inside my
database I can use the data date format
converter that is different that will
take your zone date I'm sorry zone zone
daytime and the string for instance
using the date time for matter so really
interfacing this API with jpa the
current version of jpa is extremely easy
hopefully in the next version of jpa we
will have the native support of course
for this new date and time or API nice i
love this one second topic annotations
you know that annotations if you want to
repeat them on a given element whether
it is a class with filler whatever you
need to rub those annotations in a
wrapper annotations this is a kind of
over hat because I do not this wrapper
annotation has really no role in itself
apart from rubbing several annotation on
the same element this is the case for
instance for the name queries in jp-a so
in java 8 i can write this code get rid
of the wrapping annotation and directly
repeat an annotation on a given element
in a class how does it work well in fact
it's a trick it's a trick the test case
in my example is the regular annotation
I still have to define wrapping
annotation here like that and I'll just
annotate the test case annotation with
this repeatable annotation that
reference itself the test cases class
annotation and the compiler will know at
compile time that if I repeat the test
case a notation
on a given element in fact it has to be
wrapped automatically for me in this
taste cases annotation this is great I
can also put annotations on types for
instance the non-lead annotation I can
put it on the type like that and even in
the parameter of this type if I want to
do it now the the JVM will not take that
into account for me I need to write some
code to enforce the fact that I cannot
have new elements in this list of person
for instance great the next thing is not
typically java ee related but it's
really nice and and worth noting i think
it's about the string API I've got
editions in the stringing pie that are
really nice I guess we all wrote this
kind of code at one point you have a
bunch of string and you want to merge
them into one with a given separator and
you end up writing a silly string buffer
and at the end of the day you need to
remove the last occurrence of the
separator of this at the end of this
string buffer and then you need to call
the two-string method and you end up
with a little piece of ugly code in your
application and so now of course will
complain because you keep copy pasting
this code we keep copy pasting this code
all over the place well with Java 8 I
have the solution for the concatenation
I've got a new class string joiner I
just I can just keep adding elements to
this string joiner this string Jonah is
built on a separate or itself and I just
print out the result and guess what it
works so so long for this little piece
of code I'm quite sight to see going
really and which what is nicely of
course it works even if I have only one
element in it the corner cases are
properly handled and I can also had a
prefix and postfix to the building of
the string joiner and this time it will
put hair curly braces on
on my final string of course if I have
only one element it also worked properly
and they find even if I have no element
it also works properly yes question the
performance is is is that you should use
it other question yes it's cleaner code
it's cleaner code yeah but that's enough
is cleaner code we are in the java ee
space joey is about writing clean code
ok well really yes I underlying its
build on this kind of thing too so yes
it's it son capsulated but it's night I
mean I wish I we should have been using
that for four years we are to which away
to have it okay and in fact even better
we have a joint static method on the
string class directly that's just the
same kind of of java so if all you need
is just concatenating elements with a
separator without a postfix and prefix
you can also do that using the string
class directly with this pattern great i
love this one it takes a viral or or an
array and it just works as expected
great
okay other point worth noting the
comparator interface you know that in
Java 8 I can put default methods in
interfaces and also static methods in
interfaces it's not just about allowing
all the interfaces to get more methods
and more stuff in them it's also about
building new kinds of API and i think
that the comparator interface is a very
good example of that i really love this
one well this guy is not lovable i'm
talking about the comparator interface
when you are to use if you want to build
a compiler in the old way without
without lambdas without default methods
and surf you'll end up writing this kind
of code this basically compares two
people using the last name pretty pretty
classical example but if you want to
compare those two 2 / 2 people using
their last name and then their first
name you'll end up writing this kind of
code which is by the way buggy because
if one of the two people is an ER object
or if one of the two first name or one
of the two last name is a new object
this is not handled by this code so if i
want to write really the complete
pattern of that it is much more complex
than that well in jdk 8 i've got a new
static method in comparator comparing by
and i just passed this method reference
which is in fact another way of writing
a lambda expression person the name of
the class current column get last name
the name of the method it is a static
method and it will return me a
comparator that will compare people
using the last name much it's cleaner
code we're in that okay and it's also
more more performant performances are
better effect if I want to change the
comparison of the first name I've got
the default method then comparing that
will take the same kind of lambda
expression but this time with the first
name and if I want to further compare
them with our age if the people are the
same same last name same first name okay
I want to come
with age I can also change this thing
like that okay you can imagine the code
within instances of anonymous classes I
would have been writing to to achieve
the same results great now I also have
other methods on the comparator worth
noting for instance I've got the natural
order static method which just returned
a comparator that would compare
comparable objects using their internal
logic of comparison and if I don't like
the natural order if I want to do to do
to use the opposite order I also have
the reverse order comparator that just
do exactly that and I can in fact
combine both so for instance if i have a
comparator by last name i can directly
take the reverse comparator just by
calling the reversed default method
design on the comparator interface to do
the opposite which is great now what
about new values new values are always a
pain to handle when i try to compare
elements for instance if i sought the
content of a list or of an array well
should i put the new values should i put
them at the beginning of the sorting of
the sorted list or at the end of the
sorted list well i have a comparator for
that comparators that needs first we'll
put the new value at the beginning and
of course i also have the comparator
news last that will put the new value at
the end of the list so this is a brand
new API the compile to API once again
you can readily use it without any kind
of refactoring should we just make our
life developer life easier
I'll the default use case that's a good
question in fact I don't know if I do
not call news lights on the first really
I don't know it really depends on the
way you have implemented your comparable
compareto method in the comparable
interface if you decided that the new
values were lesser than all the values
you will have you will have them first
and if you do not if you did the
contrary you are you will have them last
it depends on the way this this
comparator is built on the on the fact
that you have implemented the comparable
interface in your object so by
implementing that if you handle the null
value properly and I'm sure you did if
you decided to put the new value first
or last here you can impose the older
and it can be different from from the
comparable because the checking is done
before the comparator the compare the
compareto method is being called ok let
us have a look little look at the
correction framework and the list
interface the list interface got some
attention in Java 8 let us take a list
of string I've got a for each method on
the iterable interface yes so now if I
want to print out the content of a list
I just have to write this kind of code
strange that for each system out Karim
Khan println it's a lambda expression so
it's just a consumer in fact
implementation of a consumer it doesn't
work on array whereas an array is an
iterable which is kind of where but they
are good reason for that on the
collection interface I've got to remove
if method that takes two predicates now
predicate is a special functional
interface it takes an object from the
collection and reach on the boolean if
the boolean is true the object is kept
in the collection if it's false it will
be removed from the correction it works
in place so do not pass immutable
collections to it because it will not
work it will generate an exception
exception
Trent I'm on the list interface I've got
I replace all method on this replace or
method also works in place and it just
is it takes a function as a parameter
here implemented using a lambda once
again it's a method reference it takes
all the object of the collection of the
list sorry one by one and just apply the
transformation on those lists very easy
very chest forward straight forward I
have a sort method on the list interface
this is the one I prefer really for
years we've been using collections that
sort and blah blah blah because probably
people that design the list interface
forgot to put the salt method on it and
since they didn't they couldn't add any
interface due to backward compatibility
reason we lived 15 years with this now
we have a sort method on the list
interface so we can just sort a list in
place by calling salt on the list itself
and by passing a comparator as a
parameter isn't it great let us have a
look at what's coming in Java 9 I know
java java 8 has just been supported by
the major web application server but let
us have a look at what we are going to
have in 9 this will probably make it in
nine it's not sure yet but we'll be able
to build set or list directly using this
static this factory method directly from
the interface itself offset and list
which is nice because when we want to
bed lists or sets or whatever initialize
with default values in them we just have
to write some kind of hacking stuff it's
really it's really horrible so here we
have this very clean way of doing that
by the way the j AP is 269 if you wish
to if you want to to check it out
all right let us have a look at the map
interface the map interface got some
intention to great i also have a for
each method on the map interface so now
if i want to just print out the result
of a map i just called it for each
method and pass the B function which is
the key value which takes a key value
pair and do something with it so this
kind of code this time I cannot use the
method reference because the metal
reference will not work as either the
get method from the map interface got
also some some attention what happens if
for instance the key I am querying from
the map is not in a map I guess
everybody knows that I will get well not
optional optional come on its feature
from Java 8 the get method cannot return
an optional because it's it did not
exist when the map is with me we are
going to talk about optional don't worry
when append their kids art in my it
returns the new all right now what
happens if the key is in the map but
associated to the new value it also
returns a new so when I call the gate
key and get a new value I do not know if
the keys in the map or the key is not in
a map if i want to check if a special
key is in a map i have to write some
kind of ugly code get the set of the
keys and call the contents on this set
which is not really nice now i have a
get old default method on the map
interface and the get all default will
either return the value associated to
that key all the default object passed
as a parameter here which is nice
because now i have a clean and simple
way to check if the keys in a map or not
i have the same kind of thing for the
put method if i put if i call this kind
of code the person object passed as a
parameter will automatically replace an
existing value associated to the key to
this key now i also have a pretty fab
sont method that will check if the keys
in the map
the keys in the map it will not do
anything it will not modify the value
associated with it and i also have the
replacement with just the contrary as
the motive absent basically i can
replace if i recall replace the six and
john it will associate John to the key
six if the key is already in the map and
if I call replace six Peter and John it
will put John associated with the key if
the current value is Peter so this is
the kind of thing very Andy when I deal
with maps i also have a replace all
method that takes a be function of the
key on the value and that will replace
the current value with the result of
this method of the the application of
this method on the key value pair I have
a several new remover sorry I have a
remove method with with a new the newer
in this new API remove six and John we
remove this key value pair if the if
John is effectively associated with the
key in the map now I have a set of
method that begins with compute and that
are very handy especially if I want to
build things light map of keys and maps
or maps of keys and lists or things like
that this is the compute family of
methods so the first one compute key and
key person ki will compute a value from
an existing key value pair and a lambda
expression so basically i am taking the
key value pair i applied load on the
expression on it and it will replace the
current value on it in this case the
person cannot be new because the key has
to be in the map if the key is not in
the map nothing is done but i also have
a compute if absent this time the lambda
expression will be applied if the key is
not in the map so I'd only take a
function of the key because i know that
i do not have any value associated with
that key and guess what i also have a
compute if present that will work is the
key value pair is in the map so if the
key person passed as a parameter is
already in the map
I will apply the result to the this key
value pair and compute a new value this
time the person cannot be new because it
will um that will not be called if there
is if the key is not in a map the trick
is these methods compute something
written the value that has just either
been calculated just created all that
was already in a map and this can be
used to build maps of maps or maps of
lists let us see this example I have a
map of string and the values are
themselves map of string in person this
is quite to come on a use case if I want
to build this kind of thing currently up
to Java 7 I will end up writing some
very complex code with checkings if the
map is there need to create it if it's
not here it's tough here with just one
line of code computing absent one so if
the key is not in the map I will put it
in a map and I will apply this lambda
expression that dirt just create a new
hashmap of the right type this hash map
is the map in orange in a first line and
the put compute if absent will return
either the ash map that was already as a
value in the map either that's the empty
hash map that was just created so I can
just change this code with a boot to and
John so basically in just one line of
code and two method calls I can build a
map of map very easily and I can do the
same with the with the list for instance
by just replacing the new hashmap with a
new arraylist for instance
and last but not least for java 8 I have
a merge method that will allow to merge
two key value pairs from two different
ash map basically I have a map and i
want to add all the key value pairs from
another map to this map I can do this
key value pair by key value pair I take
the key from the second ash map the
other value and then I decide to add
them to move up if this key value pair
is not in the map I just add it to the
current map and if the key value plus
just there I just need to merge those
two values the value of the current map
and the other value of the other map so
I just provide a lambda expression that
will take those two value and that will
merge them together for instance using
the string dot join join is a static
call here by if I if it easy here as a
map of long on strings great great way
of merging maps and we can use that in
the industry may pind and in the
collector API mainly we will have some
new things also in jab 269 now we might
have that in nine new factory methods on
the map interface itself to build ash
map directly with values in them we have
this map off that will takes key one
value one key to value to etc and if I
have too much too many a key value pairs
to put them in I will have these from
entries the static method and I will be
able to build those entry with another
static method entry on the entry
interface and this time the forum
entries
method we take a vow rug so I can pass
any number of entry I need this is 49 we
don't have known yet we love it in a
battle year from now great I have some
things to tell you about the stream API
because still the stream API will be of
course it's not used in java ee 7 but i
guess since you're interested in java ee
you have an eye on what's going on in
java 8 and i will have new things from
the stream api in java 8 and we are
going to see example that what is the
stream basically it's a new API from
Java 8 technically speaking it's a new
typed interface and it's a new concept
in the JDK it might look like a
collection but a stream has nothing to
do with the collection basically there
is no data in the stream whereas I have
data in a collection let us see some
code probably you already saw some code
from for the stream API so Paul I
suppose I have a list of people for
instance this list is not empty I have
people in it of course I want to create
a map of City and doubles and this map
will regroup all the people by city and
do some post processing with that all i
have to do is to a open stream on this
list of people so people dot streamer
then i can for instance filter out all
the people younger than 20 i'm only
interested in people older than 20 right
for some reasons then i have this
collect method that tells the stream to
reduce in fact the stream using a
collector the collector is the object
i'm passing as a parameter to this
collect method this grouping by
collector will build a map of the result
the keys of this map are given by the
first argument of the collector so here
it is the city where those people are
living and the second parameter of this
grouping by is called the downstream
collector and will be a post-processing
of all the people associated to that key
basically hear what I'm doing is I am
computing the average of the edges of
those people so in one line of code and
with a little training I am able to
build an Instagram of the average of the
people living in inch city of my
collection of people which is great I
can also build the stream on
non-standard non non classical sources
for instance on the string class I've
got this Charles method that return the
stream all the elements of these streams
are the letters of this string of
character which is nice now i can write
this kind of code for instance map to
object letter letter cast it into a char
this is some kind of a hack to go from
an integer to a character put the
character in uppercase print the result
and which will just print hello as a
parameter as a result in uppercase if i
want to find the first line of a text
file that contain the arrow key word
suppose i'm writing some code that will
analyze the log file i can write this
kind of code build the path on the file
i want to analyze open a streamer using
the files outlines and passing the path
of the path as a parameter notice that
this stream is auto plausible reason why
i can pass it to the tribe with resource
statement from java 7 and inside that
since it is a auto plausible when i'm
living this tried with resource it would
close the stream and close the
underlying reader that is reading this
file and then from the streamer i can
filter and keep only the lines that
contains error find the first line of
the streamer and if it is present print
out this line on there here on the on
the console just basically one or two
lines of code to analyze a file line by
line this stream is in fact to stream
open on the text file all the elements
every element of that stream is a line
of the text file and last 11 last
example i can also bear
sorry build a stream on a regular
expression take a string of character
book suppose that the book is a long
string of character build a regular
expression using the pattern that
compile a code classical code from the
JDK on this pattern object I've got a
new method called split air stream which
will build a stream and all the elements
of this of the stream are the result of
the of the splitting of my long string
of characters using this regular
expression this is very memory efficient
because I do not have to build any kind
of intermediate array as I would do if I
would use directly the split method from
the string class so this is much more
efficient I can merge both both things
open my streamer sorry yes open stream
of line open ice cream on my txt file
suppose I've got a text file with many
many elements in it it could be I don't
know some kind of XML file or some
coverage JSON fight for instance build a
splitter that takes a line and split
this line into a stream of words on
using the pattern I just showed you and
then if I pass the splitter not to the
map method but to the flat map method it
will just return a stream and all the
elements of the stream are the words of
this text file this textile has been
read a line by line and then in slide
splits using this regular expression now
I can map that to lowercase call the
distinct method it will remove all the
doubles from the stream can the result
and which will just return the number of
different words from that book this is a
very efficient pattern because once
again the file is just red line by line
and I do not have any kind of
intermediates heavy structure a built-in
memory why is this stream API important
for the Java EE space well probably
because of Jason B that is coming in the
next version of Java EE suppose I've got
this kind of JSON file
the Jason be a team is currently
building patterns like this one I build
my contact like that get value from the
JSON past the JSON object class as a
parameter I can directly open a streamer
on this JSON file in fact filtering use
it using this lambda expression I'm only
interested in the people in from this
file whose agenda is f probably woman I
guess map to get from this JSON object
only the name field from the subject
then collect the result regroup that and
count the those name so i will have an
instagram directly in one line of code
from this JSON file build on the name
and the number of the people with that
name I can even collect the result in a
JSON array it is very easy to build your
own collector using the stream and the
collector API this is why the JSON team
did Jason collectors dot to JSON array
will collect everything in a JSON array
so this is coming in Java e8 I guess
that Jason be a specification will be in
play well Jason be stuff will be done
before the ie8 is it's finally released
so we'll be able to use that earlier
than the release of job ie8 great let us
talk about optional the little optional
is a new kind of object in the JDK
basically I need to look into an
optional to see there is something and
yes it can blow up my head if I'm not
careful an optional has been created to
tell that a method could return no value
and no value doesn't have a lot of
meaning in Java you always have a value
whether it to default value it's and no
it's a zero so false whatever but it's
not no value no value doesn't mean
anything now when I'm computing the max
for instance of an empty streamer the
max is not defined on an empty stream or
the average of an empty stream of age
for instance of ages it is not something
that is defined from the pure algorithm
point of view
so the choice has been made to rub the
result into an optional an optional can
be seen as a rapper type that can be
empty so I need to check if there is
something in it same kind for average i
can write build optional from nothing an
empty optional with this pattern of the
first pattern an optional on an object
well no or an optional of new label if i
try to build an optional of something
and pass a new value to it i will get a
new pointer exception you cannot put a
nail in an optional and if I build an
optional with this off new label method
and pass a new value I will not get any
reception I will get an optional but
this some channel will not contain the
new value it will be empty because
putting a null value in an optional
doesn't make sense so it's forbidden
either you have an empty optional either
you have something in it but you cannot
have a new value in an optional an
optional is a rapping type how can I use
it I've got this if present method and
if I want to get the what's inside that
just called the get method of this
optional and I can in fact I've got one
call here that is or else and URLs
method on the optional and basically
this or rent method will either return
the content of this optional all the
default value as I am passing as a
parameter I can also decide to throw an
exception if my optional optional is
empty Here I am providing a supplier of
exception instead of building the
exception the the exception is built
lazily with this pattern an optional can
be also seen as a special kind of stream
either with zero or one element and this
is very powerful in fact I have a if
present method on an optional that is
the same kind of method at the foreach
method from the stream interface I can
also filter an optional and ical so Anna
and I can also map a natural and
optional and I can even flat map an
optional also by passing this
this special function that returns also
a natural how can I use it suppose I
build on a new math class like that that
takes an object and you know that you
cannot compute the inverse of zero and
you cannot conclude the square root of a
negative number at least in the real
space okay so instead of dealing with
this way of the Nana not a number things
and things like that that are defined in
the in the I Triple E specification what
standard should i say i decide to rub
the result into an optional that is if i
cannot compute the inverse all this all
the square root of the past double i
decide to return an empty optional and
if it's not the case i returned the
optional wrapping the result how can i
use that well let us build a list of
double and there are on the result list
all i need to do is call the for each
method on this list for it to the metal
from the list pass this computer sorry
for each match for each element compute
the inverse which will reach on me an
optional if I flatmap the result I can
chain the the second operation which is
compute the square root and this also
returns me an optional and if I have a
value in that optional add it to the
result and very cleanly if I pass a list
of doubles with of course negative
numbers zero numbers and stuff like that
in the result I will just have the
numbers that passed through my data
processing pipeline which is very nice
now what is not as nice is the fact that
here i am adding something I there is
something I shouldn't be doing sorry
it's here in the result add I am adding
the result to an external resource from
my lambda expression and this I should
avoid to do it because accessing to the
enclosing
sorry two variable defined outside of
the lambda is something that is not very
good from the performance point of view
so I shouldn't be doing that what I
would like to do in fact if I extract
the red coat from here i have a function
that takes a double and returns an
optional of double and that i can use in
flat map operation of the optional
object but what what i would like to do
is instead of doing that create a
function that takes two double and
retail the stream of double with either
the result or either an empty stream
it's not very hard to guess how to do
that i can map my optional since i have
a map method an optional i can map my
optional to wrap it to wrap it into
sorry to take the content and put it in
a streamer so I ready to return me an
optional of stream since it is an
optional I can decide to open it now so
either this optional is empty either
there is something in it if it's empty I
want to return string.empty there is an
empty stream and if it's not empty it
will return me the stream with the
elements with the result in it so this
function takes a double now this
function takes a double and returns me a
stream of double that will have that
would be either empty sorry that's okay
I didn't know optional we'd have this
kind of effect on you it's okay so easy
to read on me either a stream that is
empty either a stream with the result in
it and now I can do really things in a
much cleaner way instead of using the
for each method from the list interface
I'm going to open the stream on it call
the flat map method and pass the
function are just built as a parameter
so this time I have a stream of double
and at the end of the day written a
stream of the ball and since I have a
stream audible I can collect it to build
it in the list which is really great so
I do not need this outside list anymore
this outside ladies enjoyed the result
of the collect call here and if i want
to go parallel I just need to call
parallel here and we could just work at
this it was not possible to call
parallel in the previous pattern why
because i was adding stuff in an
ArrayList which is absolutely not
congruent to wear so i couldn't couldn't
do that here in that case great there is
a devilish new class here called the
concurrent ash map now you might
remember the concurrent hashmap from
version 7 all right maybe some people
I'd look at the source code of the
concurrent ash my version 7 well the
good news is that for the people who did
not you didn't lose your time because in
version 8 we all we have a brand new
implementation of the concurrent hash
map that has nothing to do with what we
had in version 7 and is it's great to
build caches on things like that this
new concurrent hash map of course is
thread-safe it does not rely on locking
which was not the case for the version 7
and I have a bunch of new great methods
in it I have six thousand lines of code
in this class which is quite a lot
54-member classes just as a comparison I
have 58 classes in all the java.util
concurrent package and I've got a bunch
of new pattern
of new patterns in it remember there is
a size method on the concurrent hashmap
don't call it don't call it if you like
to stop the world of the garbage
collector you will love the size method
of the concurrent ash map which is
exactly the same everything's stopped
I'm counting my key value pairs 50 to
about 15 for our 55-51 what did you do
stop alright so don't call it I've got a
mapping count on the concurrent hash map
which returns longer so if you need to
be really big big big big big cash with
billions and billions and billions of
key value pairs in it these
implementations for you is for you what
is nice is that I have a search method
on it that will search key value pairs
for me matching the predicate v
predicates in fact I pass as a parameter
and I have a search key search value
search entry it just returned the first
element that matches the predicate and
you see this first parameter here then
as a longer it is called the parallel
parallel whatever comes remember in fact
parallel parameter if I have more than
ten key value pairs in my concurrent
hashmap the search will be conducted in
parallel for me so very efficiently so I
can pass 0 file photo for this parallel
ratio or long that max value if I do not
want to have any kind of parallel
computation in it i also have a for each
method that also works in parallel with
this first parameter i have a reduced
method that will do that will do
reductions automatically on my ash map
which is really nice
remember that in the jdk 7 I didn't have
any concurrent ash set and it this was
quite annoying because this is something
sometimes I need now I do not have a
specific concurrent asset class but on
the congruent hashmap I've got this new
key set static method that will return a
set that is big on its concurrent hash
map and that is congruent so this new
key set static method plays the role of
a congruent are set which is nice I talk
to you about parallelism twice in the
context of the stream API and in the
context of the concurrent hashmap now
just be careful with parallelism
especially if you are dealing with
application servers by the way i read
that weblogic was not supporting
parallel streams oh this is probably a
good idea all the parallel computations
from the stream API or for the
concurrent hashmap take place in the
so-called common folk joint poo this
common for joint will put a thread a
regular plot thread that will takes all
the cause of my cpu or all the cpu if i
have more than one cpu so if i launched
a barrel stream operation of our
parallel search on my concurrent hashmap
it will basically take all the computing
power of my machine if i am in tomcat
server this is probably not what i want
to do my thread should be kept to serve
my users so thank whoever I have a nice
property that can set one in my JVM that
will put the dimension to want to this
comment for joint pool and I think that
all web applications all application
server should set this property to one
just to protect themselves against this
kind of parallel computations
I have a very nice new API called
completa bellucci that will prove very
interesting in the a synchronous world
it's a new addition to the java.util
concurrent packager it's allows one to
chain the synchronous tasks as we use
case that just took an example from the
jersey documentation this is just copy
paste from the somewhere in the jersey
documentation it's an async resource all
right and I'm just calling this a Singh
get method it's a rest of this that
takes a nursing response and no title we
suspended and that will tell Jersey to
run this in an asynchronous way now the
jersey documentation use the new thread
of new runnable glabra to launch a new
thread we are in a Java 8 well so now we
can use a lambda expression to implement
a run-a-ball so this is the real thing I
have this longer operation task which is
a longer position that but that will be
launched in another thread lowing the
assing get operation to return
immediately now the problem we may face
is how can we test our can we build a
unit test for this kind of thing and
this is the same thing for a synchronous
calls in the servlet API or in the egb
API basically I want to check if the
result object has been properly passed
to the resume method in the eccentric
response it's it is a very basic test a
very basic you to use case but basically
in Java 7 I have nothing to handle that
properly in energy in a clean way i can
use mark for that i can eject a mock
Sankri pawns response i can also mark
the result if I wish just with this kind
of line of code I will verify if the
result object has been properly passed
to the mock recent response using the
rism talk the resume method but I need
to verify that once the run method has
been called and the problem is i dunno
no when this method is going to be
called so how can I be sure to test that
once the rent method has been called in
fact I've got this completion stage
interface to do that let us rewrite a
little this assing get Cola I cannot
really mess with the return type of this
asking get-go because jax-rs will take
that return type and try to make some
JSON or some XML with it and I do not
want that so I need something that is
not that clean too to do that I can just
create another public method execute a
sink which will return me a computable
future instead of calling this runnable
in any executive service what I can do
is call the complete able future run a
sync method pastor rene ball as a
parameter passed the executor at the
second parameter and this will execute
this runnable operation in that executor
so basically from the pure
multi-threaded point of view it will run
exactly the same but the call is not the
same and the API is not the same and
what is knighted that I have this
written object which is a complete oral
future and this complete able future
here it is Maya the return object of
this execute a sink Cola allows me to
run others tasks once the the runnable
passed as a parameter has been executed
so I can call the then run method pass
another another run a ball that will
just do the verification I need now I
need to be a bit careful of visibility
issues if my executive service has more
than one thread the verification of the
mock might occur in a different thread
as the thread in which it has been cold
and since my mocking framework might not
be thread-safe I might be a little
worried about that so I could I test it
first I create my marks the result the
response the ren able to train my mark
do return result when response is called
with longer
tion very verification verify response
resume here this is a mockito pattern so
i'm using mockito to do that i guess you
could do it with other mocking framework
so the complete pattern becomes sorry
then i need to go to a caller sorry i
need to create the call that is to go to
call my the method i want to test and
verify the stuff so as I'm resource
executor saying this is michael tutor to
the method then run verify ok so this is
also a rainy ball and i can just build a
single thread executor to run all this
code in one single thread that might be
different from the main thread so this
is the final test run a sank train
executor then run I think verify very
clean maybe not that simple but very
clean code and if I want to make sure
that nothing is blocked and that test
will be run properly I can even add a
timeout to it with this get method and
pass the time out of 10 seconds for
instance if there is the Taste phase it
will fail with the timeout instead of
running forever in my JVM all right I
think I'm done with this talk it was a
bit bit heavy I hope you like the little
diamonds i hope i try to uncover for you
here and there in the jdk in Java Sea
and I guess you remember the expression
that diamonds are developer best friends
I thank you for attention and I think
that and I think we have two minutes for
questions if you have any and of course
are plenty of time in the lobby if you
if you wish to to discuss with me and
don't forget to vote I think there's a
voting machine too if you didn't like
the talk don't forget to click on the on
the red button any question anyone okay
thank you very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>