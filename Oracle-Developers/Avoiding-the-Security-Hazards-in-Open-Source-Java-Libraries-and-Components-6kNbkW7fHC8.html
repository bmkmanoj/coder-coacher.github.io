<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Avoiding the Security Hazards in Open Source Java Libraries and Components | Coder Coacher - Coaching Coders</title><meta content="Avoiding the Security Hazards in Open Source Java Libraries and Components - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Avoiding the Security Hazards in Open Source Java Libraries and Components</b></h2><h5 class="post__date">2015-06-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6kNbkW7fHC8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is jeff williams and i'm a CEO
of a company called contrast security
and all we do is we help organizations
lock down the web applications and web
services we have an engine that we drop
on your app server and it searches for
security vulnerabilities but today we're
going to talk about securing open-source
libraries and your use of open source
libraries in those kinds of applications
so I've dealt with me Boyet Simic he's
one of our researchers and he's done
some very cool research and written a
tool that we're going to talk about a
little bit here so I'm going to start
out and I'm going to talk about the
problems with with securing libraries so
the first thing that that I think's
important understand is that the use of
libraries is absolutely exploding and
this started happening maybe four or
five years ago when tools like maven and
other dependency resolution tools
started coming onto the scene when we
started doing web app security we would
look at projects they're worried another
hundred thousand lines of code or a
million lines of code and they'd have a
handful of libraries maybe ten or a
dozen libraries and there'd be a Lib
folder and they'd be in there and that
would be it was a small percentage of
the overall application but most of the
applications that we're looking at today
there's still the same size there are a
hundred thousand lines or a million
lines of code but there are now hundreds
of libraries we often see over a hundred
libraries sometimes 200 or more
libraries in an application and when we
start looking at the relative size of
the codebase you know something really
interesting and different is happening
now we've got twenty percent of the code
is that little custom piece of code the
euro and the rest of it is this huge
iceberg of library code now what's
interesting about the iceberg analogies
and a number of people use this analogy
but of that eighty percent of the code
that's libraries you're really only
actually exercising a tiny portion of
that code so it's really a little
misleading
I think you know our our toe measures
exactly what pieces of the application
of the library's get used and so it's
you know I think it's unfair to say that
eighty percent the actual code is
libraries but it's still a massive
problem or opportunity perhaps so when
we look at the central repository this
is where open source projects store
their applets or their libraries now and
you can download libraries from there or
include them in your project with
something like maven there's over half a
million different libraries out there a
huge number of libraries and let's see
so by show of hands who's using
libraries from central okay so just
about everybody right and who here would
say that they have a really good
understanding of the security
implications of using those libraries
from Central just want a couple people
maybe so that's really the problem that
we're focused on here is that we don't
get any information about the libraries
that we're using it's just kind of a
black box and if you look at you know if
we estimate out the rough number of
lines of code we're talking about 10
billion lines of code in Central
approximately that's an awful lot of
room for for vulnerabilities so the
first part of our talk focuses on known
vulnerabilities this should be the easy
part of the problem if you're using
libraries and there's a known
vulnerability in that library that's a
pretty good sign you don't want to be
using that version of that library so
the first thing we're going to focus on
is the known vulnerability and I want to
give you a couple examples to give you a
sense of just how serious these things
can be this is an entry from the
National vulnerability database this is
a CVE from 2011 about spring framework
and it's talking about a problem called
expression language injection which is
it's a little obscure actually the
tack looks like this top line here where
you see a URL and if your application is
using a vulnerable version of spring and
actually that's three anything before
three point 0 point six and the most of
the latest branch if you're using a
vulnerable version of spring and I
suspect a bunch of you are then if you
send in a parameter with that format
that dollar sign open brace and then
some expression and then close brace
there's a good chance that your
application will evaluate that
expression for the attacker so that
means the attacker is essentially
sending code in to your application and
your applications running it generally
that's not a very good idea to run you
know attackers code on your application
server so the the simple attack is to
send in an expression that just grabs
them some data like pulls a piece of
data out of the session and reflects it
back in the UI somewhere but the more
complicated attack looks like this the
first step is you actually just set up
an array and store it in the session
that's the first expression then you
send a second expression that puts a URL
to the evil com slash attack directory
into your session and then the last
expression to get a value is any more
complicated it pulls that URL out of the
out of that array that you stored in the
session and then uses it to load a class
named malicious which you've stored on
your attack server so this URL can be on
you know to attack and you've got in
that directory malicious class stored
there this code will pull that class in
on to your application server and
execute you know create a new instance
of it and execute that that means the
attacker can execute arbitrary code in
the context of your web application and
you'll never know right you'll probably
not see this attack happen so this is
really devastating this is called a
remote command execution and this uses
expression language injection to do it
all you have to do to be vulnerable is
use a
version of of spring the next one I
wanted to talk about was this just came
out about a month ago there's a
vulnerability in javas XML decoder it's
actually not technically a vulnerability
it's a hazard and we'll talk about the
difference between those two things in a
second but this vulnerability works sort
of like this the XML decoder allows you
to pass in in the XML document names of
classes and methods so see right down
here where I'm passing in as part of
this XML document a class named runtime
and a method called get runtime and then
a method called exact that's pretty
dangerous so if your code is using XML
decoder to deserialize an XML document
that you don't trust an attacker could
put this attack in it and just by
deserialising this your your application
will run an arbitrary command in this
case that launches kalkaji a sexy she's
a good proof of concept because then the
calculator pops up on the screen so you
can see it but with this attack just
like the last attack the attacker
completely owns your application server
right they can do anything steal any
data Trojan anything they want on the
server so just a couple of examples of
vulnerabilities that are in libraries
that you're that are out there that you
might be using there's lots and lots
more and they're all interesting and you
know it's actually a great way to learn
security is to study vulnerabilities
like this and figure out how they work
write a proof of concept for yourself it
really is the best way to get into
application security so we did a study
in last year where we got data from
sonatype there the company that runs the
central repository and we asked them for
data on the 31 top libraries in Java and
we asked them for you know but GWT
xerxes spring struts
axis tapestry wicket lift tiles
hibernate anybody using any of these
okay so the data that we got covered a
hundred and almost 114 million downloads
of those libraries it's very big data
set and what we found oh and it was from
61,000 different organizations so you
know that's a lot of different companies
that are doing this lots of the fortune
500 lots of every kind of company
actually and what we found was a little
scary we found that twenty six percent
of those downloads that's 29 million
downloads were of libraries with known
vulnerabilities again this is the easy
stuff right this is like hey we got a
known vulnerability in its library but
you know what happened right developers
or you know they've got their palm it's
all set up it's working they're
downloading a version of it and they
don't update it right because it takes
work and nobody ever told them that
these libraries were vulnerable so
that's the way it sits and I think
there's a lot of projects out there that
are just continuing to download these
old vulnerable libraries and you know
nobody gets notified so this is a
problem because that means that there's
a lot of applications out there that
have these known vulnerabilities in them
and the people that are running them
probably have no idea so there's a
couple of things that you can do about
this one is you can run a maven plugin
called versions and it'll give you data
about what versions of libraries are
using it'll tell you what the current
version is and what I you know what
you're using and then the next upgrade
versions that you can go to but what
you'll notice is that there's no
information here about the
vulnerabilities right that's really the
super exciting piece of information like
if you're using an out-of-date library
that's it's you know you probably want
to upgrade but there's work to that and
without a compelling reason probably
your boss is not going to fund it but if
you had information about the
vulnerabilities then you'd know so the
next tool I want to show you is a tool
called dependency check
this is a tool from a wasp anybody here
familiar with the open web application
security project oh that's excellent i'm
really glad to see that I I was one of
the founders of a wasp along with Dave
wickers who's in the crowd here and I
ran Oh asked for eight years and I feel
like it's doing a really important job
so it's possum that you guys are you
know knowledgeable about that because
there's a lot of great resources there
this is a relatively new project at OS
but just come out in the past six months
or so sort of a guy named Jeremy long
and what it does is it queries the
vulnerability repositories gathers data
analyzes your project you pointed at
your projects baseline and it figures
out what libraries are vulnerable what
vulnerabilities you have so I wanted to
show you just how easy this is to run
here I've got dependency check takes
about 30 seconds to download and it's a
small little file I've got to set up
here to run on a project called web goat
web code is a deliberately vulnerable
application it was one of the projects
that I contributed to OS many years ago
and it's a good sample case for this I'm
running it right now with the dash n
flag that says don't download a new copy
of all the the XML files because it
takes like 10 minutes the first time you
run it after that it's very quick it
builds a database locally and then it's
very quick so I'm running it without the
download feature turned on I'm telling
it to produce an HTML report and then
I've seen that dash S flag that points
it at the directory where my web goat is
installed and you can add multiple
directors if you want to run it on lots
of projects at one time so I run this
takes a second and then I'm going to
open the report that it generated and
you can see I just this brand new just
generated a scan at 414 east coast time
because that's where my computer is and
you can see it's I you can see all the
dependencies if you want but if I just
want to see the ones with
vulnerabilities I can see them and in
fact if I scroll all the way down in
this file I can show you the
this is an instance of it finding the
expression language injection problem in
spring source so we've got spring sport
sources yell injection and it gives you
all the details a bunch of links to find
out more about it this is probably the
most important thing is this CBS s score
CBS s is the common foe mobility scoring
system and it's built by the guys at
mitre they run CW e and c ve and this
scoring system is pretty well-developed
there's like a thousand factors that you
got to fill out in order to actually
classify a vulnerability and this comes
up with a 7.5 which is at the high end
of the scale so our nice nice little
tool highly recommend that you you run
this on on your stuff another thing from
wasp that i want to point out because
it's important as the OWASP top 10 yeah
question i think it would be a great
idea I don't think anyone's done the
integration but it really should be at
least a sonar plug-in to read the it
produces xml output if you want and you
could easily read the xml output and put
it in a sonar I mean it'd probably be an
afternoon project so come talk to me
afterwards if you want to volunteer like
I'd love it Oh see now that's the way to
be an open source leader right there you
saw saw magic that's how I grew OS so
big so fast is just asking people to do
stuff we'll talk later so so this is a
page out of the new OS top 10 this was
released to the beginning of 2013 and
this focuses on exactly the problem that
we're talking about today using
components with known vulnerabilities
and i encourage you to grab a copy they
lost top 10 if you haven't looked at it
it's you know there's there's one page
like this on each of the top 10 it's
easy to understand and you can avoid
most of the major problems in web
applications we look at you know
millions of lines of code every month at
at my company and we find thousands of
vulnerabilities every year and if if
folks did the stuff in the last top ten
they would be
ahead of the game in terms of security
it's not everything it's just the top
ten but if you did this stuff you'd be
way ahead of the game so I want to
promote this a little bit because it's a
good stuff all right so we talked a lot
about known vulnerabilities but the rest
of our talk I want to focus in on
unknown vulnerabilities and this is I
think really important most of the
libraries in central haven't received
any serious security scrutiny so that
means there's you know if we've got was
ten billion lines of code out there and
some rate of vulnerabilities like you
know one vulnerability and every 10,000
lines of code which i think is
reasonable it's actually probably low
you know we're looking at like a million
vulnerabilities in central sitting there
waiting for somebody to discover these
are the unknown vulnerabilities and so
right now at least those vulnerabilities
are to you now known unknowns right we
know that we don't know where those
vulnerabilities are and that hopefully
will guide you a little bit in choosing
what libraries you include into your
applications because there's some
important choices there so you know when
we're looking at libraries like this
it's it's potentially a lot of
vulnerabilities to go find so that's the
stat so how do we hunt for those library
for those vulnerabilities all right
we're get a million lines million
vulnerabilities to find in 10 billion
lines of code how do we go hunting for
those and I want you to think about you
know maybe even thinking broader than
security vulnerabilities should think
about what are the security properties
of those libraries and wouldn't it be
great if we knew that for instance a
library used really good input
validation that may be something we
could measure and maybe it would lead us
to find some of those really critical
vulnerabilities maybe we could could ask
does the library do strong encryption or
is it using week algorithms
things like that does it do proper
encoding and escaping which are the ways
that you block a lot of injection
attacks doesn't use parameterized
queries to access databases or does it
use concatenated queries that might be
susceptible to sequel injection does the
library log anything you know do we have
a secure login don't going to have
accountability and is it using called
band API so you're dangerous api's like
runtime dot exec you know are we are we
calling that from the library these
would be interesting things to find and
so we set out to to try and find some of
those things along the way we just we
made an important distinction I think
between vulnerabilities which to me are
methods that if you use them even in the
intended way they'll result in your
application being vulnerable right or
being potentially exploited in that case
you need to update right that's a that's
code that you need to fix or grab a new
version of on the other side there's
something else there's that thing's
called hazards of the week all hazards
and that's code that it might be
vulnerable if you use it wrong but it's
not vulnerable I like if you use a right
it's safe to use you just have to know
where those calls are where the hazards
are so that you can use them safely and
it would be great if javadoc was better
at telling you which methods were
volatile what has erdis i'm on the
servlet expert group and i tried to get
them to put javadoc into the servlets
back that would say you know for each of
the methods that produces untrusted
input like request i get parameter
request I get a cookie request to get
header request dot okay query string and
a bunch of others in there I wanted to
add a one liner in there that said this
method might produce or my produce data
that could contain attacks and you
should be careful to validate and encode
or escape that data before using it for
something you know
passing off to interpreter or using it
for something and I couldn't make that
happen a lot of pushback in fact one of
the comments that I got was well that
people might view that as you know that
method being dangerous and I'm like yeah
that's which it is dangerous and people
don't know it and that's the problem and
so I'm trying to raise awareness about
these hazards and hopefully we can come
up with some annotation or you know
Javadoc or some kind of way of raising
awareness about this stuff because this
is the root cause of programming
practices that lead to insecure code so
I'm going to turn it over to boy n who
led our research and trying to figure
out some some of these things from real
libraries thank you Jeff so now that
everybody's officially freaked out we're
going to kind of talk about what we did
to kind of help you out a little bit so
what we really wanted to do was create a
tool that lets developers take a jar
that they're using and analyze it and
then provide them with those security
properties that Jeff just talked about
so we wanted to kind of set it up we set
it up to be pretty simple so the first
thing we wanted to do was to exercise
all the code because we want to analyze
this thing that all those libraries as
they're running so we created a fuzzer
and anybody can create a fuzzy right but
it has to be a good one in order to find
vulnerabilities so we'll talk about that
later what we did throughout the fuzzing
process is we instrumented all the
classes that were being exercised so and
then as they're being exercised we
basically attached the detector to it
that's able to find the vulnerabilities
as a library is being used so mind you
we use the fuzzer to basically just send
the library random data and then we
watched how it executes seeeeee and then
observe that and then made security
conclusions and we found some pretty
cool stuff so let's talk about the
fuzzing a little bit
in order to fuzz a library you have to
invoke as many methods as possible and
it was pretty simple at first right we
said all right we'll take a library will
look at all they're all its classes and
will execute the methods using
reflection by just taking the simple
ones that have like primitive types as
arguments so strings integers stuff like
that really simple however we soon found
out that that's not really useful
because it turns out we were like mostly
exercising getters and setters stuff
like that and we needed to we need we
need it to be able to create really
complex objects so I think we succeeded
in that and we'll talk about that a
little bit as well another issue is if
you think about dependencies of a
library so everybody has a pawn file if
you're using maven in your project and
if you when you build your project I
don't know if you pay attention to all
the dependencies they get pulled in from
maven but we've seen some libraries that
we're analyzing to have like 100 200
dependencies and all these libraries get
downloaded and push to your web
application server and you don't really
know what they do so in order to you
know analyze all these libraries and in
order to execute this code we have to be
able to load all these dependencies and
we actually do that using maven go
figure so now for the detection if you
think about it the library is executing
now we have to detect the
vulnerabilities so we used our tool that
we created called contrast and it has an
engine portion of it that basically
looks at the looks at the data flow as
the library is executing and it detects
vulnerabilities and it gives you the
security properties of your library so
what it gives you for every single
method that gets exercised is it looks
for gnome owner Bill
which we just talked about and gives you
all those and then it also has this
concept of tinted data so when when a
library takes a parameter we mark it as
tainted because you typically cannot
trust the user input at all and then
we're able to trace that input
throughout the throughout its entire
lifecycle and then see how it gets used
and then we we see if when when the
input goes in and then it comes back out
we see if it's still insecure and if it
is that we provide that data to the user
so what this allows us to do is get some
really do some really deep analysis so
if you think about the library that
you're analyzing your jar we're able to
using the contrast engine deploy these
little sensors and we deploy them not
just to the library that we're testing
because we know that it doesn't operate
in some gold sandbox we're able to
deploy the sensors to all of all the
other dependent libraries including the
application server that the admin you're
running on and this includes the JVM as
well so what we were able to do is we're
able to attract this randomized piece of
data and then log all the security
events that might be occurring
you put this back in it's so yeah this
is what it looks like so a piece of data
will go in and then it will take a very
unique path through throughout the
execution and then luckily we're able to
follow that data throughout the entire
lifecycle and then really see if it's
being used maliciously or not or if it
could be used maliciously so we're able
to look at the data flow of the control
flow and then we're also able to see if
it's going to any back-end connections
like web services stuff like that so
very cool so this is kind of what we
ended up with actually the architecture
of our tool we use instrumentation you
know keep track of the data as it's
going through the library while it's
being executed we have a very complex
object generator if you think about
libraries that you typically use like
struts or spring right they have very
complex like session objects they use
you know more complex I'll just like it
like output stream or HTTP requests
responses stuff like that so we have to
be able to generate valid versions of
those objects in order to exercise a
library without it just throwing an
exception every time so we ended up
actually using some of these really cool
tools like we use mockito to create mock
instances of like some of like
interfaces and abstract classes we use
the Java code coverage library to
measure our code coverage because we
wanted to be able to cover as much code
as possible in order to find as many
vulnerabilities as we can and then we
use maven to load all the dependencies
at runtime so this whole effort wasn't
really with that its challenges and the
first one was dependencies like I said
some of these libraries have hundreds of
dependencies so the first thing we have
to do is when we start analyzing a
library we load all the dependencies
because chances are we're going to use
them as we're fuzzing the library
and then the second biggest challenge
was a code coverage we have to generate
the valid objects we have to handle
exceptions right so since we're
providing these libraries with just
random data there's a lot of exceptions
and we have to know how to deal with
them and it's sometimes you want to know
what libraries throw what exceptions
depending on the data that take right
like if you're using a library and it a
user provides you some random data that
just causes the library to shut down
your entire JVM you probably want to
know about it right so memory management
was also a pain but we have this concept
of concept of an object pool that we
created so one of the really cool things
about contrast is it's able to track
data throughout the entire exercise
process so when we create an instance of
an object and we and we ant on it and we
exercise all the methods in it we store
it back in the object pool and then when
some other class requests that an
instance of that object we take it from
our pool and we reuse that object so
that way we're able to track all the
data that's provided to the jar and then
see if the see if it gives back in
eighteen to data and then of course
performance right so let me tell you one
of the fun things about this is so we're
analyzing just all these libraries with
random inputs so sometimes we would
exercise a method and it would just put
the threat to sleep right and we'd be
sitting there trying to figure out what
why it's taking so long and so we use
threading obviously to solve this issue
so like sometimes we would just say okay
if if a threat is trying to run this
method it's taking longer than like 20
seconds we'll just interrupt it and so
those are the types of things that we
have to work through
so let's talk about results right it's
what everybody's here for so we analyzed
these libraries that you see + 265
others so we went to the folks that Soto
type who manage their central repository
and we asked them hey what are the top
three hundred libraries that people have
downloaded over the last few years and
they give us a list and so we took that
list and we downloaded the latest
version of those libraries and we
analyze them and what we found was this
we found about 150 vulnerabilities total
and we marked about almost 6,000 methods
as potentially hazardous so again what
you know we want to differentiate
between the two vulnerabilities are
things like you know using week random
number generation if you're like
creating session tokens or something or
we cache algorithms then potential
denial of service and past reversal and
we actually found that we cache
algorithms week randomness weak
encryption algorithm use probably was
approximately half of the total
vulnerabilities that we found and then
for the hazards here's a great
description of how a hazard works if you
have a library method and you provide
provided some potentially malicious
input if that method returns the same
value that means that method cannot be
the result from that method can't
necessarily be trusted so if you have an
application or you're passing user input
to a method and you're just reflecting
that back to the user it's a web app you
know you want to watch out
so let's talk about some of the cool
findings that we have right I mean we
have like 150 but I just want to talk
about four or five that we saw the most
and that are particularly interesting so
we cryptography is being used everywhere
all right so I mean it's been years
since you know Chinese hackers have
pretty much told us or showed us at md5
sha-1 and all these aren't secure so it
was a good good the researcher yeah not
hackers yeah yeah they do they do
encourage pretty well so if you're using
random number generation you should do
something like this that's there at the
bottom and you got to make sure you got
to use the secure random object and you
got to make sure that you initialize it
correctly so please do that if you're
doing right don't use Java dot util dot
random or Jeff did you put this in I
must be alert for the USA oh wow that's
it so it says we at the NSA would
appreciate if you would use the
following code snippet and there's a
secure enim I'm just getting you guys
should not use this the NSA actually
purposefully we can this algorithm so
they can if it's been out for like the
list last week's it's been known for
seven years or so but just recently this
became a huge deal yeah so if you've
seen like articles like NSA can read
everything can decrypt everything we're
encrypting this is what it's talking
about so another cool one is this Jan
see library that we analyzed I mean it's
pretty commonly used because it's one of
the top 300 but one of the cool one of
the things that we found really
interesting is that it loads native code
and the whole reason that we're using
Java is so that we're not running native
code
and it's basically it loads native code
whenever it runs and depending on the OS
that you have it comes packaged with all
this stuff and that runs it which is
very interesting looks like a jar file
yeah Emmy it it's a jar file that loads
native code one of the cooler things
that we found was this when we were
analyzing the Apache axis jar Apache
axis has a whole bunch of classes that
extend the big integer class and if
you're using this constructor of the big
integer class that generates a random
biginteger if you pass it a large value
such as this which our fuzzer did you
know it passed in high values low values
in between everything if you pass it
something like this you're going to your
heap will fill up instantly and you're
up your application will stop running so
yeah it's very cool and it's one if
you're familiar with the mark of the
beast attack from a few years ago it's
kind of like that but it might be a bit
difficult to exploit but it's there
another common thing is read line if
you're not familiar with red line look
let's say you're reading in a file that
your user specifies and you create a
loop and you're going through the file
line by line this is an insecure way of
doing that because they can just provide
some input that makes your program run
out of memory and this is particularly
hazardous because it's a denial of
service vector and we've actually seen
this quite a bit in a lot of libraries
so
past reversal right how many of you guys
have ever used a library that or an
application that allows you to upload a
file right so everybody so we see a lot
of Pat reversal where you can provide a
custom file name and this so an attack
vector would be you know you can upload
a file that with the name dot slash
slash and then your file and then it
would override a file or put it in some
directory where it could be used
maliciously Jeff you want to talk about
no bite yeah sure so this is cool it
just just recently about seven eight
years ago I started trying to get son to
deal with Mel by injection in
java.io.file class basically a null byte
injection is if you put a null byte like
this into a file name java will see the
whole string all the way out to the end
of txt and if you try to validate this
string it will say that ends in dot txt
and probably your application will say
hey that's fine but when you try to
access this file on the disk probably
your operating system is written in C
and then see a nobody will terminate
this string and so the operating system
only sees this part just the exe part
and so you can actually trick a lot of
that file validation schemes and access
files that you were you shouldn't be
able to and potentially write files that
you shouldn't be able to we've used this
to write jsps into JSP directories and
then execute them bypass file access
schemes and and so on so it's finally
dead in the version of Java that just
was released a couple weeks ago 7u40 is
now there's there's no such thing as no
bites in Java anymore so awesome that's
one off the list
huge when the fetus throws an exception
something like invalid file path
exception gentlemen if you would be
recorded if you can stay on the
microphone I know if the water point is
you should be a laser pointers okay so k
thanks awesome thank you so yeah one off
the list so this is what how we see the
future of library security right we we
want to kind of like a you know how you
have like a nutrition guide on whatever
you buy well we kind of want the same
thing for libraries right so we want you
to be able to take a library and have
know exactly how it's being used in
terms of security you won't you want to
know if it's cryptographically safe if
it's you know XSS proof if its sequel
injection proof all this stuff and I
think you know that there's no reason
that we can't have this we have we have
the technology but you know I think
we're getting close we still have a long
way to go sort of you know our
vulnerability analysis is only as good
as our fuzzing so as our fuzzing gets
better we'll be able to find more
vulnerabilities but um you know I think
I think something like this within a
pretty short time period is pretty
realistic and then after that it's just
adoption right because you guys have to
start using you have to start thinking
about you know security of your
libraries because right now people just
don't don't seem to make it a priority
and the thing is the easier we make it
to do the more adoption it's going to
get so thank you guys if you feel like
it stopped by at our booth 5003 in the
grand ballroom we'll be glad to show you
contrast and we love to take some
questions yeah yeah
he needs all about the mark of the beast
is that enough oh yeah the mark of the
beast attack was a problem in javas
floating-point parser and basically if
you passed in a certain value to that
parser if you did like a float you know
parsefloat it would go into an infinite
loop and use up all the CPU resources
for a little while and so they dubbed it
the mark of the beast and you could
explain it like even in some of the app
servers by passing in you know a browser
version header and you know put that
number in there and then the the parser
on the server side would try to parse it
and blow up so that was that it's been
spin resolve but it took a long time to
other questions about libraries yeah
down below running
the nobility boil a very you know app
something that we pay you or you mean
that dependency check tool yeah that
dependency checked all as along with
everything else at 0 us is free and open
for everyone
polishing
we haven't decided exactly how to
publish that there's you know some some
of these we need to go talk to the
makers of the various libraries to say
hey you know you're using weak
encryption and you really should not and
that process takes a long time we may go
through cert for that the computer
emergency response team to handle some
of those for us but we haven't decided
exactly what to do and in order to
release the fuzzing tool itself we'd
have to do a bunch of work on it to
release that so we're trying to figure
out how to do that because we want this
these results to be available to
everybody but we haven't figured out how
to do it quite yet so yeah yeah really
the best that you can do is use the
latest versions of this libraries and
make sure that if there's a known
vulnerability in one of the libraries
that you don't use that version you
upgrade to a version that doesn't have
the known vulnerability and you know
really in order for this to be fixed we
have to change the ecosystem right we
have to we have to make it so this
vulnerability research is out there and
available to everybody so we're I'd love
to get there just not sure what the path
is to get there actually let me speak on
that first a second in the world that I
met the perfect world that I imagine is
you would go to one of the repositories
like you go to the App Store and you
could browse through libraries and find
out lots of information about the
libraries who wrote it did they have
security training what testing process
did they use what are the test results
and and security results there as well
right like oh it passed some static
analysis test or it past this fuzzer or
whatever and then you know you'd have
all the information that you need in
order to make an informed decision about
what libraries you want to use in your
app and that's that's down the road but
imagine like a library store that you go
to to choose your libraries instead of
just you know putting in your palm and
praying yeah
yeah and we pray so we'll do all that
food what did nothing will have it on
top of what we are already doing
something that so so two things there
almost certainly your static analysis
isn't analyzing the libraries at this
level static analysis focuses on your
custom code but most of them don't
analyze the libraries as well and if
they and their really don't because it
the problem is there's so much code in
the libraries I mean there could be ten
million lines of library code in a
typical app and it would it would take a
supercomputer to run the static analysis
on that to really do the data flow so
what those tools do is they analyze your
custom code and wherever your your code
calls a method you know library or
receives input from a library they just
make assumptions about whether it's
tainted or not and that's why you end up
getting so many false alarms with those
tools that's why we use contrast for
this is because contrast traces the
whole data flow down into the libraries
and back up now penetration testing you
know if there's a known vulnerability
your penetration tester might know about
spring expression language injection for
instance and they might test for that
but most likely they're not going to be
exhaustively testing the libraries
they'll be testing you know your app and
your custom logic so that there's
there's a big gap there I think in
finding these kind of unknown vaults
yeah
I am an old library my library yeah
actually so if you wanted to you could
you could write a test app right now
we're not releasing the fuzzer because
we don't know how to do that yet but you
could build a test app and then use the
free version of contrast to run against
your app and it would it would exercise
the the code paths and see if you've got
vulnerability I'll be one way of finding
phones in that code yes yeah so it would
check how your app calls that code so if
you wrote a test suite for instance that
exercised all the methods in your code
then you could basically do essentially
what we did but without the fuzzer you
would be doing it with a real app yeah
so that's a static analysis tool and it
has the pros and cons of static analysis
we chose a different approach with this
we tried to do it with with fuzzing at
runtime there's there's merits to both
approaches we just tried something
different than nobody done before yeah
you some kind of place probably some
kind of database festive which databases
use for ability to see the vulnerability
database oh yeah yeah so on your CV E is
the volar ability database it actually
uses a few others there's cve secunia
envy DB and a few others and that tool
pulls data from them whenever you run it
so they do update that database pretty
frequently you know any new
vulnerabilities they could discover it
go in there any other questions so sue
me an email or all the slides for this
are you know they get released for all
the talks so you can download them off
of the Java one website or feel free to
contact us you a question behind the
pole
it's a good question so so we didn't
explicitly fuzz RT dodge are right we
could and it might be an interesting way
to find some of the kinds of java flaws
that have played Java you know for
several years now we didn't do it again
yeah so we do go down into RT dejar and
so if you know one of those threads went
down there we might have found one we
didn't but if we fuzz RT to chart
directly we'd have more of a chance of
finding that stuff that's a good point
big integer is part of Java so yeah we
did we did find one yes success with hey
all right thanks a lot appreciate it</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>