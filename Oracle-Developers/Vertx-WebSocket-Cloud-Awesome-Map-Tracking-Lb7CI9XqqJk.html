<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Vert.x + WebSocket + Cloud = Awesome Map Tracking | Coder Coacher - Coaching Coders</title><meta content="Vert.x + WebSocket + Cloud = Awesome Map Tracking - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Vert.x + WebSocket + Cloud = Awesome Map Tracking</b></h2><h5 class="post__date">2015-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Lb7CI9XqqJk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">alright let's go ahead and get started
the talk for today is vertex on
OpenShift it's mostly vertex I think
I've taken out all the openshift pieces
there may be one slide and I'll skip
that all together because I don't want
to talk about it too much today come by
the Red Hat booth if you want to talk
about openshift I can talk about it all
day long but that's not what you came
here to see again this is the talk the
URL for the talk if you want to bring it
up to follow along on the slides on your
own or bookmark it and look at these
slides later there is link to links to
github repos the demo will probably not
be up all the time because I don't want
to keep hitting someone else's API at
the frequency I'm hitting it for the
demo but the github repos will be there
all the time if you want to look at the
code again that I'm talking through okay
and then this is me that's a zero and
then here's all the places you can find
me with that handle all right any
ingress players how is it that one and
green or blue you don't know you're dead
to me
all right so I don't understand how I go
all these tech shows and there's only
like one or two ingress players at every
tech show that's it I would imagine
there was more find out about more about
it if you're interested in spatial stuff
let's go ahead and get started so what
I'm gonna talk to you about today is
awesomesauce I'm assuming that everybody
in this room has either used Tomcat or
some EE server or jetty or some standard
Java web surfing technology that was
built at least 15 years ago right I mean
it's been updated right there's been new
releases of everything but in general
that architecture hasn't changed for
about 15 years we all agree about that
and in web time that's like forever
difference right so vertex is a very new
technology I wish Tim actually did come
to the talk like he said he was going to
so he could tell me when he actually
started it but I don't think it's more
than three years old right it's three or
four years old and it was built about
the same time as nodejs was coming out
as there's more WebSockets it's built
for a modern web with horizontal scaling
rather than vertical scaling it's a
totally new way of thinking about
building your web apps using the same
tech but using the same languages that
you're used to okay so the agenda is I'm
gonna teach you a little bit of cloud
but not even specific to us
and then a little bit about vertex on
OpenShift and then we're gonna see some
polyglot WebSocket mapping goodness okay
that's always just fun to say
so here's what we're gonna build if you
have if you have a browser open right
now and you don't really need to check
your email right now which I'm assuming
you're doing is the reason you have your
browser open go to either those URLs go
to the bitly URL or go to the the full
URL okay and what you'll see is
something better than this what you win
I can't get CloudFlare de terre I can't
get CloudFlare to resolve right now it's
not the seat you can't my for some
reason my laptop can't find the CDN so I
can't get the JavaScript libraries to
come down what you would see for those
who do it is actually a map with pins on
it and those pins are the busses in
Knoxville I think or is it in Kentucky
who's looking at the map chinanu
tennessee kentucky it's all the same
down there it's uh it's in it's in where
was it Chattanooga Tennessee right so uh
it's a they put up a feed of their buses
which gives the lat/long of the bus and
what I'm doing is I'm polling that and
I'll show you how easy vertex makes
polling an API and then I'm basically
pushing that out over WebSockets to the
browser and every time it changes you'll
see that everybody in the room should be
seeing who's gone to that URL should be
seeing the pins move on the map as
everybody's seeing the pins move on the
map you didn't memorize it as soon as I
put it up there Oh tip now Tim's in the
room now we can all ask them all the
hard questions alright so you should be
seeing pins moving on a map that is a
lot I'm sorry that I can't get it to
work up on this screen I tried three
different network connections and none
of them are doing it so that's what
we're gonna get to at the end sorry I
wish I had a better way of showing it
here but I don't we can keep trying I'll
try reloading and see if cloud for Club
oh no still so you can see it down here
it's still having problems a cloud flare
will keep trying as we go along
so I just want to talk a little bit
about cloud how many of you actually
developed something in the cloud okay
and so when you say that how many you
keep your hands up if you develop
something in the cloud keep your hand up
if it was anything other than Amazon Web
Services well that's pretty good
actually
you can put your hands down now so I
want to do a little okay I I want to do
a little education on cloud is that okay
everybody okay about that this is not
going to be propaganda for the most part
the basic idea is to teach you the
difference between infrastructure as a
service platform as a service and
software as a service because I think
that's something that most people don't
understand the distinction between they
say cloud and that means anything to
everybody so I want you to be a little
bit more intelligent when you talk about
it it's great for the cocktail party on
Wednesday when we're all when you meet
if you meet a Steven Tyler from
Aerosmith he's gonna be fascinated by
this so I'm just giving you some fodder
okay infrastructure services well who's
the biggest infrastructure as a service
provider out there Amazon right and
infrastructure services exactly that
sounds you say I want some
infrastructure and it gives it to you
virtually as a service right you get a
certain mount of RAM a certain amount of
CPU and they give that to you in a
machine you say I want in this data
center and then you get it which is
freaking awesome for those of us who
remember how long it took to provision a
server and get it racked and stacked I
can get one in basically two minutes and
I'm assuming most of the people since
we're not at Oracle world we're actually
at JavaOne almost all of you are
developers and if you have to be
assisted minutes because someone's
forcing you to be assisted min not
because you want to be assisted min is
that correct
for the most part ok gaudiest
participation is always appreciated
so that problem with infrastructure as a
service is you still have to configure
the machine right you still own the
machine you still updating the machine
you're setting up the DNS and all that
so it's made life a little better but
you're still assisted min when you want
to be a developer software is a service
take off your I know I'm at JavaOne and
I know this is gonna be hard for you but
take off your enterprise hat for a
minute who is the largest software as a
service provider that's not enterprise
Enterprise is still not the largest it's
I know which one is the largest in
enterprise what's the largest one I'll
get out of the way what's the largest
one in enterprise
Salesforce thank you who is the largest
that's not Salesforce is actually the
largest in the world software is a
service provider Google what part Google
Gmail exactly everybody has about four
different gmail accounts and there's
about six billion people in the world so
there's probably about 24 billion
different Gmail accounts out there right
so it is by far the largest software as
a service provider I think out there
right now but as a developer how
exciting is soft is Gmail to you it's
not very exciting at all it's great
because I don't have to set up a mail
server and I got all my mail but it you
can't really hack Gmail I mean you can
and then you violate the Terms of
Service and then they change their API
and everything goes away if because they
don't really have an API so for the most
part software's the services you get
what you get you don't get upset my PE
teacher comes back to life again and so
it's not so exciting for developers and
what platform is a service is it's in
the middle right it's in between
software as a service and infrastructure
in the service and so the idea is with
one command you can basically spin up
your entire development infrastructure
and get you out of the business of
maintaining the infrastructure okay and
so I work for a company Red Hat who has
a platform as a service you can check us
out at the booth but right next to us is
a greatly inferior competitor that you
might want to check out as well the
reason I bring this up is the reason I'm
really bringing up platform-as-a-service
is who are most of Red Hat's customers
like if you think about are they usually
like the new hotness startups no they're
usually enterprises right very large
conservative enterprises and how fast
they usually adopt new technology hey
exactly this the laughing covers it
right there red has was last time know
what that was the last time the Red Hat
was the last time so the idea is some of
our largest customers already asking us
for this and they're actually asking us
for the next revision which is asked
using docker right and if if we're
getting our vert if we're getting those
kinds of customers asking us for
platform as-a-service
you can bet that it's going to be part
of your life in the near future
so I'm giving you this hint so that if
you want to be on the be like a
a good developer and stay on the cutting
edge and have good skills and play with
get play with some sort of no sequel
database and learn platform-as-a-service
okay so that was the whole propaganda of
that whole part okay I hope you didn't
feel like to propaganda okay so let's
now go to vertex so vertex its polyglot
so anything that runs on the JV and what
that means is anything there throw these
all on so I could just keep walking
across anything that runs on the JVM you
can basically run on vertex so that
includes things like JRuby it includes
Java it also includes JavaScript it also
in scoot includes closure it includes
Scala any of those things you want you
can run in that server is that like
Tomcat or or EAP or WebSphere the
answer's no that was a gimme I'm giving
you softballs here folks come on alright
so that should be kind of exciting if
you want to try something else
it is both asynchronous and synchronous
and so what that means is all that great
stuff that you see the JavaScript
developers doing with callbacks on the
server side you can actually now do that
on the server side as a Java developer
or as a JRuby developer which is
phenomenal for us right and it feels
like Java means a little awkward in the
newest version which it Tim when is the
when's three coming out okay so by the
end of the year it'll be because the
other benefit that Tim gets Tim is
sneaky this way by making some sort of
totally new technology yes I say oh yeah
Java AIT's out I'm using it you don't
like it you don't have to but he's bait
so basically by the end of this year
it'll all be based on Java 8 and it'll
use the lambda functions in 8 for the
callback stuff right so you'll be right
there part of the JVM right now it's a
little turkey because Java wasn't really
built to have callbacks so they've built
some stuff in but it'll feel much more
natural with the next version of her
decks ok it also but no gel developers
should be jealous of this no there's no
way to get synchronous jobs and with
vertex we can actually do both and I'll
show you how they do that in a little
bit it also has non-blocking i/o so
that's the other great part about being
a totally new technology he was non
blocking out the
non-blocking i/o out-of-the-box and it
uses Neddie for that how many of you
have heard of Nettie almost everybody
right so Tim's building out Tim and team
are building on top of Nettie to get
some of that great functionality
it has event bus an event bus and
WebSockets right out of the box box not
bus how many of you know what an event
bus is everybody knows what an event bus
is right and usually you're setting up
some third party piece of software right
you're setting up some AMQP or you're
setting up some other piece of messaging
software here it comes right out of the
box so there's nothing else for you to
figure out how to configure and it works
right away and I'll show it again and
it's really easy to use and because it
was built recently it knows what most
modern web developers want to do so it's
got a ton of utility functions built
right into the API calls and I'll show
you at least two of them today which
make life really easy for you and not
having to think about all the threading
and all the timers and all that other
crazy stuff all right so now we're going
any questions I really as you might
notice I'm really informal and so I
would like questions from people if
you're stuck because with a room this
big if you have a question chances are
at least 30 to 40 other people in this
room have that exact same question so
please ask it's more important that you
understand then I get through everything
okay
any questions all right I so there's a
couple of people here or my talk last
night was I nice in my talk last night
yes see I'm nice I'm not gonna bite if
you ask a question all right let me make
this picture bigger can you see that now
a bit a bit better in the back the text
in the little box kind of this is I
can't this is the problem with reveal no
I can do this is that a little bit
better all the old people move to the
front and all the young people eyes I
can say that because I have to sit in
the front now to move to the back I
don't even have a laser pointer okay
I'll use my mouse okay
so there's the basic building block of
vertex is what's called a vertical okay
that's what it is and a vertical can be
any piece of code it can be a single
Java file
it can be multiple Java files put
together but the vertical is the basic
building block of what you're building
in vertex okay and then when you build a
vertical it goes inside the vertex
container and then you have to decide
you want it to be synchronous or
asynchronous right if you want it to be
synchronous then you're building a
worker vertical right and that basically
has a pool of threads that it'll give
out and handle in a synchronous fashion
so there's that thread pool that I'm
talking about right up there yeah one of
the other great things about a sinc
vertical so now I'm going to the async
case one of the great things about the
async verticals is that they have
complete class loader isolation right
the great part is you're never going to
run into oh this is using this version
of what's a really the JSON parts this
is using this version of juice while
this other version is using this other
version of juice and now I've got and I
want it at the container level I don't
want it you don't get any into that
class loading conflicts right you bring
everything your vertical brings
everything it needs to run so that's
some of you might see that as a drawback
if you're running lots of different
verticals and why am i repeating the
same library over and over again in this
case that you again that's part of what
you get by picking up the end of the
stick of having class loader isolation
right you don't share jar files you
don't share libraries but the nice part
is this how many of you have seen like
how Spotify does its development with
micro services does anybody see to hurt
or talked about microservices at all
a few people if there's any
microservices talks at JavaOne that's
another one i say you have to go to okay
so the idea of the micro services rather
than building a huge monolithic
application you're building a bunch of
Confederated services and they talk over
an event bus or something else and that
way individual teams can move it their
own Cadence's and evolve parts of the
API rather than other people rather than
all having to move in lockstep right
that's what Spotify does that's what
Netflix does tend unity there any other
big use cases that have adopted the
micro services architecture or anybody
else raise their hand
twitter twitter does micro services as
well right it just gives your teams a
lot more flexibility and a lot more
independence
you agree on the interface and then
you're free to implement on underneath
and anything you want and that's
partially the model that vertex has
bought into right out of the box right
that's that whole independent class
loader thing you're building your own
service you can start and stop your
vertical without affecting anybody else
you can change your jar file the
libraries that you're using without
affecting anybody else right and I
actually find that to be a great way now
of working okay and the vertex container
can have multiple verticals within it as
usually you will okay so any question
this is the basic building block if
you're lost on this the rest of the
slides are gonna get harder and then
you're gonna get an F on the quiz that's
at the end of the test at the end of
this class so I don't want you to fail
any questions okay I better not see any
FS the same
okay so we've now described what happens
when you start at vertex we get some
verticals now what I'm gonna do is show
you when you have multiple running
together so modules you can think of
this almost like a war file if you want
to think back to old speak you've put a
bunch of different verticals together to
create a module which is your
application an individual vertical can
be an application but you can also maybe
want to put multiple ones together to
form the interface to that right and so
that's what's called a module so this in
the module a in this case has two
asynchronous verticals and a worker
vertical okay and these do not have to
be in the same language I will show you
a module that I my application that I
wrote is a module and it's using Java
Script Java and Python to do its work
not because it has to but because I
wanted to demonstrate that that could
all work okay
you can have multiple modules in a
vertex instance so here is module B and
it only has one vertical in it right and
then what comes out of the yeah good
sorry what I'm calling the JVM is
actually the vertex container okay
so not that I I it's just I think a
logical grouping if I think about it
that way and they will share do they
share their class loaders new module
okay wait hold on we do a timeout okay
everybody in the room this is where you
get to pick so pay attention if you
don't pick you lose your choice do you
want to hear about what is currently
today or do you want to hear about
what's coming in bird x3 cuz Tim's in
the room this is the expert all those
who want it now this is where you gotta
participate all those who want to hear
about what's happening today because
they want to go home and use vertex
right now because I've excited them so
much raise your hand now for learning
about vertex to end of the year I mean
it's available now there it you can use
it it's just in alpha state it's usable
but there's still a lot to do okay how
many want to learn about vertex three
okay sorry to you lose
so Tim because it's not give me enough
time to talk about both what happens
with vertex three with this what I'm
talking is there a benefit did the
gentleman's question is that there are
benefit to modules what happens in
vertex three so there is no benefit
because they're gone
yeah so if I'm going to summarize its
you just basically put them in a jar now
rather than a module is just a jar which
is the grouping of your classes all
right
they're like basic yeah next one is a
backward model with the ball goes
inwards - is it backwards compatible
today in vertex - will I be able to use
that module in yes well I'll let me see
if I can answer this one modules today
are basically just a jar file with some
metadata in them so I'd imagine they
basically still just work breaking
changes in the API so you talk there at
the universe expert in education so you
will have to refactor it to certain
extent
but it's not it's probably not to take a
take a module and make it into a jar
it's probably not I would imagine it's
probably not much work that's just the
rebuilding but there might be API calls
you're making under the hood which have
gone away that part is which is should
be more cognizant of all right any other
questions this is good this is what I
like see this is when I sit in the talk
this is what I actually want to hear cuz
the the writer of the software's in the
room and I can leave with like knowing
the real thing rather than what the guy
who brought a half-baked demo actually
made up on the fly so if you wanted to
you can quite a bit the next thing you
get out of the box is the event bus and
so this is what I talked about before
this was like how many of you use
RabbitMQ maybe I don't know Java
developers usually aren't big on rabbit
but maybe you rabbit
you ActiveMQ is that a lot of people
there would have Hornet there's a whole
bunch of different ones usually you'd
have to spin something up and use it and
then get everybody to talk this comes
with the event bus right out of the box
okay and vert the main way to get things
to communicate with each other in vertex
is through the event bus right because
we have that isolation there shared
nothing so you can't say like oh I'm
just gonna reach in and talk to that
object directly so what you have to do
is put your message on the event bus and
someone else will have to subscribe to
that channel right and then with that
but the event bus also does is there's
the word database down here you can
actually set up a database driver to
talk to the event bus so there's
examples one of those I have two real at
least inverted X two at this point and
I'm sure it'll be the same way in vertex
three the vertex team has done a great
job of providing examples of almost
every bit of functionality you want to
do in almost every language they support
so they give an example showing where
you have a Mongo subscriber to the event
bus and the data just pumps when you put
it on the event bus the subscriber gets
it and puts it directly into a Mongo
data store there's no code for you
because Mongo schema lists right so it's
actually very easy to do that it just
pumps the data right off the event bus
as long as you publish it to the channel
that that subscribe to it'll just put
that document right into the data store
directly without you having to write any
code right so that I think that's
actually pretty awesome especially when
you just want to have something to
serialize all your objects to without
having to think about it the
other thing it does is you can choose to
expose that event bus channels on the
event bus outside as WebSockets and the
the WebSocket library that is on the
client side that comes with verdicts
will fall back to sock j s or long tarts
will fall back to long polling and he
uses sock Jes and it'll fall back to
long polling in a browser that doesn't
support it okay yeah yeah so the
question was is the event paws have a
endpoints that you subscribed to
completely there's an event bus I'll
show it in the example I'll show you two
different endpoints I create and
subscribe to yeah so I mean you mean in
terms of the WebSocket piece internally
that I have not dug enough into that I
mean I've been the only one working on
the app so I haven't had ever secure
them Tim is there a way to secure in the
event bus internally like so I think
what he's saying is I published
something onto a channel is there if and
somehow someone gives her a way to lock
down that channel to just say to the
following people or you need something
to access that channel yeah I think he's
talked about internal to the server know
and basically you would but the the
thing is they would have you could start
up a different vertex instance if there
are different vertex instances and you
don't tell them to cluster then they
won't know about the event bus at each
other attack true Tim yes
yeah server the assumption is on the
server side you're on a trusted network
okay yeah super support what the persist
if you want to persist you mean do you
is a support persisting the messages
anything that you want to pump out to
the pursuit that's like web Mongo is
doing right you can persist out to Mongo
so it's a good question but I want to
try to the question basically he's
asking and I want to save it for
afterwards is what happens if the event
bus dies that means your Wolverton that
means your all your vertex has died
right and so that's a much larger
question I think that maybe we'll get to
at the end but I'd hold it it's a good
one right so then I'm gonna go to the
last level of architecture here which is
when you have multiple vertex instances
okay and what happens in this case is
vertex is very good at clustering when
you bring up multiple vertex instances
the use case I'm showing here is not
supported on OpenShift this use case is
what I've shown here is we have one
vertex container running here another
vertex container running here there this
has been made that they're talking over
the same event bus this vertical this
module has this architecture this Merkel
has a different architecture but they're
all talking on the same event bus right
hold on one second let me just finish
this and then I'll remember you on
OpenShift because of the way we do auto
scaling or the way we scale up you these
all the vertex containers are gonna
scale up with the exact same verticals
and modules and stuff in them so you
this is this heterogeneous architecture
is not supported on openshift but it is
supported everywhere else so I want to
distance this is more of an vertex talk
I want to show you what you can do that
way yeah your question is
the question is are they are they
clustered what's the Ferrando
point-to-point but what was the first
word you said multi is it multicast or
it's using hazel cast under the hoods so
I'm it uses that if I remember we hold
on let me see if I get this right so
that I don't always have to have Tim my
crutch in the room with me my blankie
so if I understand it correctly it uses
hazel cast when it starts up to find the
endpoints that it talks to and then it
just talks directly over TCP ports did
that change in version three you're
gonna bout to school me that you know
what tip actually you're talking enough
do you wanna come just sit by the mic so
that people can actually hear you
because I think the people like over in
that corner actually can't hear you and
I don't know how to turn this one on but
is oh it's on now thank you Tim Fox yes
yes about clustering basically I'll sit
down so I can get near the microphone so
yeah we have this thing called a cluster
manager which is we abstracts out all
the Discovery stuff to the cluster
managers have completely pluggable the
default implementation uses hazel cast
as you've said basically we only use the
cluster manager to discover where
everything is and once we found out
where everything is we then create our
own connections there's much faster
doing it that way if direct connections
when they own the wire protocol then
going through the actual clustering
technology so nice relationship
and it sees the seam in three steps
antenna discovery instead of discovery
with the default plantation hazel car
supports both multicast and also
supports you know pre configuring your
servers you know statically effectively
so anything can do in hazel car so you
can do in vertex and it also supports I
think when you're on your ec2 that's
kind of it can use ec2 discovery as well
right so on open ship we don't support
multicast because Amazon doesn't support
multicast right so an enter in the
enterprise version of OpenShift which is
the bring it on premise you could do
that but you can't use multicast on the
online version okay any other questions
so there if that's basic
for the architecture now I'm yeah I've
given you a you can out read height
certified vertex developer no that was
not the level I gave you I gave you
enough talk to get you interested and to
hopefully understand when you go to
build an app what you're doing in what
pieces there's a lot more that happens
here and a lot more to the architecture
and using different languages and all
that stuff but this is basically just to
give you an idea because this part was
the hardest part for me when I was
learning to get my head around and so
what I'm trying to do is give you the
you can at least get into the pool and
not sink yeah
newspapers
talking over suppose last parking car
TIBCO okay so the question was basically
how is this different what's
differentiating this versus running in a
traditional whether it's Tomcat or any
of the old-school servers and using
TIBCO to do communication and I mean
I've never used tiptoe but I'm assuming
that some sort of messaging best
technology right so I'll start because I
don't want Tim to froth at the mouth
we're on the same mailing list so it's
completely different right it basically
the architecture is different the way
you think about things are different
like if you think about what you've done
what in the old way you basically have
taken technology that was built to work
in 1998-1999
and put a message bus in it and are
trying to adapt it to the way you're
thinking about architecting now vert.x
has been built from the ground up to
support the newer ways that we think
about building applications now so for
example you will not get doing
asynchronous with your application
servers that you're asking about that's
a whole lot of pain that I don't
recommend taking on especially unless
you're like ninja programmer right the
the other part about like all this nice
and easy discovery see someone else
usually setting up TIBCO for you or you
setting that up yourself yeah so if you
tried to set up the TIBCO stuff for
yourself
I think you'd understand like why that's
a pain and how hard that is to cluster
and yes EAP or an or web sphere or any
of those support vertical or horizontal
scaling where you're adding more out
this way but it's not built to be that
way from the get-go right there is
session clustering and there is all that
stuff but it's a much more complicated
beast to get that to go and work the
other thing that's completely different
is the polyglot part that I talked about
before you can writing a JSON or a JRuby
application or even JavaScript let's say
you there you know I've got a bunch of
JavaScript developers and I want them to
write a service but I really like
running on the JVM because the JVM is
awesome vertex gives you that kind of
flexibility right out of the box so ma
it's kind of yes it does web and that's
about the saint's that's where they
diverge
they both do web and then the
architecture is completely deferred
that are fair enough yeah it's a lot
cheaper nted co2 that's right it's a lot
like as in free so good point and it's a
lot easier to when you have a bug it's a
lot easier to actually get someone to
talk to about your bug than it might be
with TIBCO as well or even any of the
huge servers so I think he's looking for
propaganda to give to his manager and
say this is why we need to use vertex is
there are some no no that's right and
that's oh that's a good question so do
we have it like a I think it's all just
on the vertex site right yes I mean the
vertex sites got a lot of information I
don't really have any kind of Anasazi
kind of elevator pitch sort of stuff I
mean one thing you could put it a have a
have a look for some of my talks I've
done other conferences on the on the web
and I kind of did a bit of that in there
yeah but the problem is managers like
glossy PDFs yeah yeah we need a template
so we'll get we'll get Red Hat marketing
to work on something like that but I
yeah that's it the website right now has
the bullet points to talk about why it's
good okay and there's some benchmarking
on the way is there some benchmarking on
the website I think actually not on the
website no but there is some there's
been some independent benchmark inocent
people called tech empower who did the
whole later you pretty heard of them
they've done a whole lot of benchmarks
across across some excuse me you know
all the frame that's not just JVM stuff
but you know nodejs and Rebbie stuff and
everything basis c++ directly so the big
benchmark where they compared
asynchronous servers is yeah just just
any but they were looking I mean the
ones that really stood out was vertex
versus nodejs right and vertex versus
like twisted which is the python
eventing server right so though it's
there and you can see why especially if
your company already has the JVM inside
like then you're not fighting that
battle like oh now we're gonna run
everything on top of JavaScript no we're
gonna still run on the JVM we're gonna
bring the other language in the top so I
don't spend too much more time on that
there is a cartridge for this an open
ship so it's incredibly easy to download
and use top vertex you basically just
unzip it and say run and then run your
verticals if you want but if you want to
actually run it someplace where you can
you get a real URL it's also incredibly
easy to run under an open ship so I'm
just
so I'm telling you about it so in case
you want to try it so the difference is
on openshift though just if you're
reading through the documentation I just
want you to understand there's no
command line instead you set all your
things in the vertex environment that
you would normally sell on the convert
command line unscalable it's not really
made like that architecture I showed
right you're basically when did you
scale up you're gonna basically scale up
the same services over and over again
and there's no failover right and and
when you stand up yourselves you can
actually configure failover so that if
one dies the other one can take over
there's no failover right now it'll
likely be a module and OpenShift and
there's no git push to build and deploy
if you're an open shift developer you're
used to get pushing and then it doesn't
even build and deploy the cartridge
wasn't built with that Nick said he was
gonna want to do it but now that three
O's coming out for both of us
like open shift three OS coming out and
four and X 3 is coming out both at about
the end of the year it's gonna change
how that's up done for both of us you
have to basically build your library or
your vertical locally actually if you're
doing a java file you don't have to
build it but if you're building a module
locally you then just put that into this
right place and push it up okay so this
scenario we're building a bus tracking
system for Chattanooga we got a nice API
from this guy Jason D with JSON right so
it's a I here I can show you what I'm
consuming you can't see no I know tough
you can go back out if you want if you
want I don't know okay so that's the
JSON that we're consuming right we're
basically consuming we're basically I'm
not yelling at you tonight yelling at
the microphone we're basically consuming
there's a feature collection and inside
of it there's a feature and it's got a
point and the properties and that's
basically the properties the properties
of the bus okay and there's the
coordinates now I have the port this
demo at the last minute because my API
provider locked my key so you'll see in
the code I'm talking about planes but if
you will just substitute in your head
bus or route instead of flight okay cuz
that's what we're gonna be consuming but
that the code is all going to talk about
thumb planes so here's what here's the
github repo for it let me make this
bigger for everybody can you see that in
the back now so I think enough
okay so I'm going to show you
I have to remember let me give me one
sec cuz I have to remember how I started
up again I think it's in no I just did
resources it's not gonna be in there
it's not gonna be in there I have to
find the env file is what I'm looking
for yeah so it's gonna be in here
sorry you guys did you see the oh I know
why because I'm looking in the wrong
spot oh sorry this is just the Maven fun
right the env is actually in another
repository so the env basically
specifies which file we're going to
start up so the first thing we do is
we're gonna start up a web server right
we need a web server to serve up content
so the first thing we're gonna start up
is a pas oh here's the description of
the module that'll tell us the main
class for this module is at fjs right so
this is the metadata for the module
there is a Java vertical that we
commented out these are all the ways you
would start up a different vertical to
say the main class right I'm using a pas
to start mine then I just have some
metadata here that talks about it and
then I just said all to redeploy to true
so if I drop another module in just Auto
redeployed right you don't have to stop
the server and start again
that's that's basically all the only
required metadata is what's the starter
vertical and that's it I don't even have
to say Auto redeploy I just said it
there okay so I'm started with a pas so
here if I'm gonna show you some
JavaScript in my module basically we do
we start at some vertex we start up a
container we do some console this piece
right umm this piece right here is for
running on openshift or for running on
localhost right so if we don't find this
environment variable let me assume we're
running on localhost sorry for the
people all the way over there I I'll
come over there in a minute and then
basically what we're doing is we're
deploying them we're telling the
container the vertex container to deploy
a module and the module I want to deploy
is the web server this comes right out
of the box we're just telling deploy the
vertex web server what fortune to start
on well it depends on where we're Duke
we're we're on OpenShift or localhost
what IP again that the web root is web
so any web content that you want to
serve up is going to be in the directory
called web the index page is indexed out
HTML bridge true
this means open up WebSockets the
outside world but that doesn't mean not
get to do any whatever I want
I now have to say what I want to expose
the outside world and so what you see
you go up a little bit higher what you
see here I'm holy defining out that you
can also define inbound but I'm not
allowing any inbound traffic over
WebSockets
all I'm saying is outbound is permitted
and this is the only channel I want to
allow outbound ok so this is what Tim
was talking about before with the
firewall but who gets to come in and out
to the server so they cannot send data
back through this channel this is for
only outbound communication all right
and then start a web server then once I
started the web server I used this
vertical to deploy to more verticals
remember how I said a module can have
multiple verticals in it these could run
by themselves but they won't do much by
themselves the way they were architected
was to make it so that they're all part
of one module I deploy the vertical the
feed getter and then I deploy a vertical
flight publisher dump I guess what
language this one's in the feed get no
job and guess which one this one is in
Python right so just a quick how many of
you do use Python or thinking about
using Python on here ok this is the part
that's sad for me because I really like
Python but for some reason the JSON
community has kind of died it used to be
that it was like the crown jewel when it
first started but now - is still I think
officially at two five they haven't even
come out with two seven so like two five
doesn't even have JSON objects in it but
you can't even it's not as it's bad and
unfortunately for vertex they inherit
whatever comes from JSON so unless
you're using very basic Java capable
mean Python capabilities I don't
recommend using Python right now it's
out of Ferriss yeah having said that in
vertex three we hope there's a guy
George I'm not really a Python person
myself so the way it works we have
language maintainence for each language
different people that so the person who
does the pipes and staff sky called
Jordan and he's um he's been looking
into this can't remember it's cause the
new Python implementation for the JVM is
kind of bit embryonic of moment he's
been looking into that and that looks
like it might have potential because as
you say jathan's kind of I wouldn't say
it's dead but it's kind of like you know
it's very slowly moving yeah I mean that
they're not it's not it's not being
invested in right people aren't getting
paid to work on it full-time it's not
like JRuby we're like RedHat employs the
top three JRuby developers and yeah I
mean so JRuby is right up to date so if
you want to do Ruby development you're
good
Python is the one I think is the not for
any fault of heard act but fault for the
fault of Python on the JVM is the
weakest of them all so if I were to redo
this example I would not have done the
Python part but it works you'll see some
parts of my code that are really ugly
and the reason why they're kind of ugly
is because of the state of Zhai thong
okay so let's look at what the feed
Gator does now so we now can go back out
oh we want to see well I'll show you
index.html at the end so here's the feed
getter
and so here basically to make it a
vertical I just say extends vertical
that's it it's now a vertical right and
I override the start method because I
want something to happen when the
vertical starts up and so here is
exactly what I was talking about with
those utility classes that make life so
much easier I am getting a web client I
don't have to do anything really funky
to make a web client I say create HTTP
client I can do the nice chaining for
the object creation I say this is the
port it's on I wanted to use keep alive
I and here's the host I want you to talk
to right I said that all in one command
I actually in the version that was doing
the flight tracking that actually had a
sepia HTTP use HTTP on it but ignore the
certificate like I set that all up in
that one chain and then if you think
about doing that in a servlet or
something you're writing a lot of code
just to get a web client set to go right
here it's just one call to create it
this is you could ignore these because
I'm not doing flight tracking these are
left in from the flight tracking system
any questions so far actually yeah this
is asynchronous because I'm not
declaring it to work or vertical and
you'll see why it's asynchronous in a
minute so then I say here's the final
URL I want buses at the end of that API
and here comes another nice utility
function set periodic so vertex comes
with this function built-in that says
this is basically saying every two
seconds call this this anonymous
function I'm doing here all right I
don't have to set up any kind of weird
threading stop-start all that other
stuff it's just set periodic this made
my life so happy when I wanted to do
this example I just had to say I want a
job to go every two seconds awesome yeah
so he wants to know in mic so I've set
up this thing with a handler that goes
over fires off every two seconds he
wants to know what's happening to that
thread in the meantime which turn I
don't know which thread though the do
whatever the thing is controlling the to
whatever is going to wake up and call in
two seconds or whatever is gonna fire in
two seconds we say we actually delegate
inside net either to think all the
hashed wheel timer and then we delegate
to that so effectively it's the event
loop itself goes around there yourself
and it wakes up you know check if
there's any you know timer events that
need to be you know cool you know
delivered out to whoever needs them and
yes it doesn't know so that's a kind of
key point we're not blocking in if
there's no blocking a thread there's no
thread dot sleep he says in the meantime
no no no no the thread is off doing
other things this is kind of a again
it's a whole key point about the whole
asynchronous thing we basically this
vertical runs is assigned an event loop
right when it when you create it okay
and that event loop you must never block
that event loop because that event Lib
can be used to also service many other
verticals and you block it then it can't
you can't do any more work so that event
is always going around doing stuff right
yeah so you're not it's kind of it's a
different way it's not from way of
thinking is especially if you're used to
kind of sink you know you know most
developers kind of deal with synchronous
API is a very different way of thinking
we're not saying do this and then just
blocking the thread waiting for the
results come back we're saying do this
here's a handler when you're ready call
me back
the handler in the meantime but it's
gonna go off and do other stuff so
you're not blocking right this is a
non-blocking model yeah
yes exactly so by default well at kind
of so bite
did I already get that question the
question was so basically the maximum
number of threads is the map the number
of cores I have in the machine yes
that's that sort of trade say in an
ideal non-blocking system where the
threads are evenly distributed amongst
all the cores then you should never need
more than one core so one thread per
core right so yeah you look numbered
thread should be equal to the number of
cores in practice we actually choose it
to about twice the number of cores and
the reason for that is most operating
systems don't actually balance threads
particularly then there's something
that's said sometimes they clump up on
ticular cos so to actually get the
optimum efficiency which is slightly
more okay I may hold your question is it
short okay the question was if it is is
vertex smart enough that if the handler
takes more than two seconds it won't
just stack them up yes so it's um I have
to remember is it a two-second delay is
it a look it'll every two seconds it'll
put an event on the event loop and so I
think they will stack up yeah okay
and so then inside of that we define the
handler right so that's what this is
right here we're basically defining the
handle method for what comes when it
when it when that request when it when
it wakes up what should it do and so
remember we made a web client and all I
have to do is call get now on the URL
and again if any of you have done
JavaScript programming you're starting
to see callback hell but that's exactly
what has to happen when you're doing
asynchronous stuff right so it doesn't
have to I could write my code tim is
like no you wrote your clothes sloppy
and that's why you have callback hell
well this is actually interesting
subject so oh then we may have to hold
it okay cuz I want to get through that I
think we're almost out of time so I want
to get through the whole demo okay we're
the whole code but Tim would love to
talk about this in the Red Hat brief
later yeah well come to my talk oh come
to his talk he's got another on vertex
onset yeah okay this thing Thursday what
time um I think it's 113 okay so
Thursday afternoon there's another
vertex talk if you want to go deep dive
now that you're so excited I expect to
see all these faces at the vertex talk
unless
you feel so comfortable you don't need
to know any more so this is the web
client doing the get now and then we
just go through the response in the body
and we're just basically it comes vertex
has some JSON objects to handle it
so I take the data out and make a new
JSON observe objects out of it I get the
field features because that's what each
of the individual busses and then here
you were asking about putting things on
the channel making an endpoint vertex
event bugs publish I have just made a
Chan it is just a string write that you
puts it on the event bus that's the
channel now and that's the data I just
sent on the event bus I take that array
of the JSON array put on the event bus
and off it goes and then I just say I'm
all done yeah what API are using under
the hoods to do Jason Jack I'm using his
API I'm using the vertex one here but
under the hood that's using Jackson okay
okay so that's it that's all the Java
code is doing basically it's every two
seconds it wakes up makes a request part
takes a little bit of the JSON and then
put something on the event bus okay what
then I've done just as this is I didn't
have to do it this way I could have done
the entire thing in the Java one but I
wanted to show all the polygons it's not
in that one all the polyglots goodness
here is the flight publisher so this all
this is is it just has a handler right
to receive a message because all I'm
doing with this one is I'm all I'm doing
the main call on this is this and then
puffs notice with Python you can use the
indentation and this is the one that's
the only one that's indented all the way
out or not an instant at all
event bus register handler I'm
subscribing to that channel and I'm
calling the method handler
whenever I whenever I get something on
that channel right so this one doesn't
do any activity by itself it just
basically sits there listening to an
event bus and when that gets called
I define it handler ap gets the message
I turn I say the flights are a JSON
array and then basically what I have to
do is I have to go through this because
of the JSON stuff I have to do more work
the JSON problems it should be that I
just take it in processes a little bit
and throw it right back on the event bus
but because of the serialization in
Python I have to actually break it apart
a bunch more but then I basically make a
new flight which you can think of as a
new bus right that's the new bus
I basically parse that JSON get a new
bus with that long array and then I
publish again on a new channel called
flights updated and I put that light lit
array of buses onto the flight updated
channel everybody get that
basically I just listen to the event
channel take the data off do some
processing on it spit it back out in the
process format on a different camera and
if you remember back to the app J asks
where I was defining what was the
outbound channels the outbound channel
is flights updated so any web browser
can subscribe to that this is how hard
this is the part that made me cry with
joy because this app that I built I've
been wanting to build this app since
like 2002 but like the thought of all
the work I would have to do into
producing something that actually
updated in real time on the brows I mean
it's only WebSockets if I remember one
comment different here you guys are all
Java one attendees whoever's on comet
came out and we were all excited you'd
see the demo of people playing poker in
real time like whoa and then it was just
way too complicated so this was so
exciting to me because this it was so
easy to do the eventbus stuff it was so
easy to setup WebSockets and this is all
the JavaScript all this is just
basically this code right here is
basically all the mapping code this is
all it took this little flat block right
here is all it took to get the
WebSockets working ice I load the vertex
JavaScript libraries I say I want a new
event bus and it's talking to the window
location right the HTTP /the host name
on OpenShift 8 we published WebSockets
on port 8000 right so I'm saying on port
8000
and when you're using vertex by default
your WebSockets are exposed on event bus
that's the the endpoint right so I'm
basically all I'm setting up here is
talk back to my server on port 8000 to a
event bus and then I say on up when the
event bus opens call this you can ignore
that because that's just me debugging in
JavaScript in real time I register a
handler for this channel flights updated
this is another message right that I'm
just writing to myself so you can ignore
that I just call the pin the map
function and that does all the mapping
and all the mapping work which you can
see in the other parts of the code and
I'll show but I want people to be able
to leave to get to their next session
but so before I finish up though
basically 1 2 3 3 lines of code
get me WebSockets and I didn't and
server side all I did was just put
something onto an event bus I don't have
to do anything funky or anything put on
an event bus that is why I cried for joy
because I thought I was gonna be
spending like the hardest part for me
was getting my head around verticals and
all that stuff and then once I actually
got that this application took me about
an afternoon to write at most because it
was so straightforward and easy to do
the things that I was wanting to do as a
modern web programmer so that's
basically the end of the talk if you
wanted to stay I'll show the there I
just showed all the code vertex is async
and awesome without needing to know
nodejs it's great an open shift and
getting book better and it's free and
there's the github repo for the whole
type and that's it if you want to see
the mapping code I'll stay I'll answer
questions then I'll walk through the
mapping code unless is there a talk
right now
or is it lunch break lunch break ok so
any questions yeah
tons of libraries like spring security
yet hibernate and what are those okay so
the question was and I might in a
typical web app I might have spring
security and hibernate and spring maybe
spring web flow and all those other
things
the and how easy is it to use something
like that in vertex and I'll leave that
to Tim because I haven't done that work
yes so one of the things we're doing in
vertex oh you're building out a whole
stack hole a synchro stack so we want to
have Purdue have pre-made components
they're pretty much the most common
things that you want to do in an
application like in a web stuff database
stuff you know authentication
authorization all that kind of stuff so
hopefully you be able to just pull those
components out you know plug them
together like Lego bricks and then
you've got your application we've also
got the community is what you know
contributing a lot of good stuff
diversity we have like you know how 200
odd modules already inverse has to do
various different things in terms of
using other staff like kind of spring or
other libraries yeah you can use all
that stuff but one thing you've got bear
in mind a lot of libraries out there
today are inherently synchronous you
have to deal with that maybe run them
inside a work of art school and then you
obviously because a synchronous you may
have scalability issues there but we
certainly you know we're not trying to
reinvent the wheel with that with
everything we want to play nicely and
actually inverse x3 it's very much more
embeddable so we want to add you know
cecum
yeah use spring for instance very easily
or what you know whatever else he is but
I think the key thing about what he said
is you can use all those but be careful
because they are probably written for a
synchronous world and you may mess up
your app if you put it in the right in
the wrong spot exactly a second example
would be say using you know JDBC which
is inherently synchronous is he doing a
query inside a vertical and it's
blocking waiting for a result so while
it's blocking you're blocking the event
loop and so there my event loop can't do
anything else so it basically makes your
application and responsibility
understand you would basically do is put
that in a worker vertical and then it
would publish something to the event bus
when it was done yes so there's a bit of
an uphill struggle trying to get people
to you know I mean we we've kind of a
lot of new applications you know there
they have a lot of concurrency typically
but not all applications do but many
applications require on looking
whether it's a lot of connections but
might be HTTP connections WebSocket
connections mqtt in Internet of Things
or it may just be a lot of messaging
passing through it so you need a lot of
concurrency this kind of drives us
towards an async model but a lot of it
you know there's a lot of catching up to
do with a lot of you know especially the
database area most database drivers
inherently synchronous although having
said that we've got a puritan you've got
a purely async my sequel Postgres driver
Mongo Mongo DB bringing out a 100% async
driver we're actually working with at
the moment so but gradually people are
realizing they're you know if you want
to have the best scalability you need to
be async end-to-end but in the meantime
in your story to work with these kind of
existing synchronous libraries that's
why we have a worker vertical so you can
use that if you want but you just have
to bear in mind you know it might affect
your scalability there's a question yeah
so the question the next question which
is a good one because you see a lot is
how does this compare to akka so akka is
the zebra Dino and akka is awk is
basically another type of Java writing
platform but it uses the actor model to
do most of its work and I'll let Tim
talk to ya say we're at both akka
ourselves and verandahs various other
popular projects right now of what you
might call reactive frameworks you may
have heard this buzzword reactive is a
kind of really researched recently so
basically it means a single errantly a
synchronous that's probably the primary
might think it means
so akka is is similar in some ways they
are more a pure acts and model
implementation the vertex concurrency
model is very similar to the axon 111 or
a strict actor models H you can actually
think of each vertical as an actor and
then we're sending messages between
verticals so it's kind of like the
accent model in a way each verticals
inherently single-threaded
and we scale by having many verticals
not by having many threads going through
a single piece of code so in that way is
similar to the optimal akka is a bit
more limited in its scope its vertex
does more so with with akka you have the
rest of the typesafe stack kind of stuff
like Play Framework and stuff that fills
in those gaps but but we we hope you
actually interoperate with our case as
there's this new project called reactive
streams you may have heard of and it's
basically an idea it's
interoperability between these different
reactive frameworks so we signed up to
it
type ciphers signed up to it we've got
to pivot all the time that we got like
Twitter
we've got Doug Lee's on the on it as
well we've got Eric Meyer he's a guy who
does rx originally in Microsoft Netflix
where would they go to find out more
about or read more about that wherever
they go I've got a reactive streams dog
so that's my fins for pricing yeah yeah
good yeah yeah so the question is how is
this different from node yes I think I
can the biggest way I could take this is
all you can run in node.js is JavaScript
right this is this is actually running
on the JVM and so you can anything that
you can use in the JVM you can actually
use like all those libraries let's say
you want to rip apart Excel files as
part of this on your worker thread you
could use poi to work a rip apart Excel
files if it's not available in
JavaScript you're stuck write the
JavaScript library is not as big the
other thing I was gonna say about it is
node does not have the concept of
synchronous right so you have to be
fully sitting async if you're gonna go
with a no js' model anything else you
want to throw in them yeah that so this
this that's pretty much it so I think
the main thing is it's not that is not
just JavaScript where I signed up in
particular my in Javas for it but a lot
of developers don't want to develop in
JavaScript so we give the choice of you
know doing similar things but in other
languages yes using using the existing
Java ecosystem of libraries another
advantage users yep but even though
Tim's here I'm gonna say something nice
for node though now the one of the
advantages to note and this is one of
the I don't know how it changes in three
Tim and I've talked about this already
package management is kind of hard in a
vertex right so with node it's very easy
to use the NPM and pull down packages
you can't you at least in - oh you can't
use the NPM to pull in libraries and I
don't know what's happening in can you
talk that's the the biggest drawback so
yes Tim is here but we are friends and
I've already given him this criticism
the biggest criticism I have right now
with vertex at least 2.0 and I've been
lightly following 3 just because I've
got a day job
is it's very hard to bring in packages
for those other languages like Python
developers expect to do a pip install
when they're installing some Python
library no developers expect to do an
NPM install and just get the Jeanette's
not available right now in vertex yeah
and I don't know if that's changing for
three so yeah that's like for three will
support NPM as well okay although having
sup just because we support NPN doesn't
mean you know a node modules gonna run
in vertex is using a different API right
but the dependency mention yeah the
biggest problem is the dependency
management like in Python if I wanted to
pull I didn't understand how to pull in
like if I saw a library out there I
didn't understand how to pull it in yeah
yeah yeah yeah so the question is is
there tooling support for vertex is
alright yeah Alex let you take that well
know kind of when you said what way to
say tooling support man we you can use
any IDE with vertex we have any specific
tools for building the modules is just a
jar file yes I mean what there's nothing
special this yeah there's I mean do you
just writing a JSON file there's so
that's what we have a nice thing that's
good about vertex is not there's nothing
proprietary about anything you do with
it it's you can it doesn't even to be a
jar file you can you can you can be a
zip file it's like I mean it's in a way
I prefer us to write the Jason far than
to go through a wizard or something
today to fix it right so all right so
did everybody else stay to see the
mapping stuff the little mapping piece
that I did how to make the map pins on
the map and how I made them move or did
you just stay to hear what the rest of
to I'm gonna do it no matter what and if
you want to leave you can leave but
you're gonna miss the best part of the
talk okay so the mapping part I'm using
a library called leaflet if you do
mapping or if you want to do mapping and
use special are we still recording yeah
alright so if you want to do mapping and
you don't want to use Google Maps which
I highly encourage just because I like
free and open source leaflet is by far
now the agreed-upon standard is probably
if you're just doing lightweight mapping
it is the best JavaScript library to use
if you're gonna do like a whole
JavaScript editing of features and a
whole or a complicated workflow I would
look at something like what's called
open layers
in the browser but if you're just doing
pins on a map or if you're doing heat
maps or you're just mostly visualization
on the map use leaflet it's by far the
easiest to use it's got a ton of modules
it's great so basically all we're gonna
do here we just load up the do you guys
want to I mean I all I'm doing is
loading delete this is probably where it
this CloudFlare stuff is causing
problems for me as I'm loading the
leaflet library and the CSS right and
then I make a map write the the whole
HTML and my page is this is the extent
of my HTML right I put that title up
where's my bus and then I make a div and
the div is a container okay
the div is a container to hole I was
told this shoe out but there's nothing
after this right there is when what oh
so there's something at 12:30 so I'll go
quicker then so basically what it's
doing is we may be a div which is gonna
be the container for our map okay
here I'm defining my map and I'm in
defining the map I'm setting the center
point that I want to be set it on for
the map and what zoom levels to start at
right and then I'm making a layer group
for the map and I'm adding it to the map
and this layer group is a marker layer
group it's a it's just a layer group I'm
gonna i'm calling a marker layer group
is because I'm gonna throw up my markers
my pins into that so this is a container
you can think of this as a container to
hold the pins the map is one container
and then on top of that map I'm putting
another container which is going to hold
the pins alright then I actually set up
what is the map gonna display so I'm
giving it a tile layer and I'm using
Open Street Map oh you guys heard of
Open Street Map for those who are left
still if you haven't it's the Wikipedia
of maps all the data is in the public
domain I don't like the licensing
particularly because it's not a very
nice share license but it I highly
support the project and this is
basically using those pipes which in
certain areas of the world are even
better than Google's x because it's all
about like in Germany it's probably the
best piles there aren't
and in some countries where there's not
much map data it's way better because
they've got volunteers doing slice here
I'm setting the attribution which is a
little text evidence on the bottom and
then I add that tile layer also to the
map so I've got a map I add the marker
layer and I've added the map layers ok
and that's it I remember when they we
get into a message on the event bus I
called a function called pin the back
that's the function so what I'm doing
with that so there's no pins on the map
to start with because we haven't the
callback has an the websocket hasn't hit
yet in the map gets called I there's the
data that came over our WebSockets
connection I removed my marker layer
group because I don't want to keep
adding more and more pins into the same
map so I basically say get rid of that
marker layer group then what I do is I
make a new marker array this is what I'm
gonna hold all my markers or pins in I
go through my data I just ripped through
it it was a really nice little JSON
array when I was done with it so all I
have to do is say here's the latitude
playing or bus get black at the wall
that's for the marker that's a lot long
for the marker and I'm gonna bind to pop
up to it and if you for those of you who
got the CloudFlare to resolve there is
when you click on it you should see
route and direction when you click on
the pin all right and I'm just that's
all that I put into the data when I put
on the event bus I ripped through all of
those make markers for each one of them
and put them on the marker array and
then I just add that marker array to the
map and that's it ok so that's it that's
all the code</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>