<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>What You Need to Know About Java 9, Including Migration | Coder Coacher - Coaching Coders</title><meta content="What You Need to Know About Java 9, Including Migration - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>What You Need to Know About Java 9, Including Migration</b></h2><h5 class="post__date">2017-08-07</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/l2fYVvzBxcQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay let's let's get started then so
what you need to know about Java 9 I've
given this talk a couple of times as
only and so I had a bunch of slides but
it's only just before this talk I
realized I had the to not to us words
including migration so I'll talk about
that over a few slides as well but we're
going to be focusing really on what is
in Java 9 a little bit about me standing
up here tilton who turned the virtual
jug quite a few people called virtual
jug completely online drive user Greek
that's something I created a couple of
years ago two three years ago
I'm also the London jug leader anyone
not know about the London jug not know
about London jack
okay London jug is a Java user group for
you to attend in the UK in London sorry
and yeah just sign up it's on meetup and
we do monthly or even more frequent
sessions than that we're in fact we're
doing a hack their sales tile which I'll
give you more information about on Java
9 modules this Saturday so we'll talk
about that as well
whole bunch of other stuff that I won't
really talk about but I work in
developer relations used to be a
developer of around 10 years for IBM any
Webster users an Oracle conference oh
really
so some of those millions of lines of
code may have been partly down to me but
I'm not responsible for all of it I work
for zero turnaround company that
produces developer tooling for for Java
developers so we're here to talk about
Java 9 and here I'm really talking about
it from work from a developer's point of
view watch what's interesting in it
Java nine of course isn't out just yet
but if we look at the schedule it's
actually been around for a while back in
back in 2016 26th of May that's when
future complete was originally but then
there was a kind of extension because
there's kind of a few extra things that
needed to get in something from about
nine years ago
of modules and things like that then
there's a ramp down in which you
actually look at which bugs are about
are still inside the inside the product
and you look at and say I'm only going
to look at bugs from around priority one
two three then there's the zero bug
bounce and this means every single test
have been run against the JDK across all
supported platforms then there's the
zero bug bomb there's like all test run
then there's the zero bug bounce this is
when the entire backlog is is addressed
other than bugs that have just come in
within the last 24 hours which basically
means it's either fixed or it's been
deferred to another release finally
almost finally ran down Phase two
which basically means only showstoppers
can be fixed and then we go to the final
candidate release where it build gets
spun a number of times and then general
availability on the 27th of July that's
when it's obviously bug free ready for
production users I'm sure we're all very
much familiar with so what are we going
to talk about well let's first look at
what we can't talk about because this is
an unreleased product we can't talk
about detailed performance metrics for a
number of reasons one because well it's
not been released yet so where we
actually doing performance metrics on
and secondly because you know things are
going to change and also we need to run
big applications on it we need to
actually test things in real life but we
are really there yet we also can't
really provide much experience base
analysis because we haven't actually
used it properly yet and we can't get
experience without using it so anyone
who's already giving you experience
based job annoying information it's
really not experience those things that
can still change and we have noticed it
kind of is changing on very much a
weekly monthly daily basis so what's in
Java 9 first of all we're going to talk
about modularity something which has
been in the works for a number of years
almost nine years actually and when we
look at modularity modularity isn't a
feature modularity is a is
a concept an architectural concept it
can't be something that delivered by a
technology or a set of tooling it's
something which needs to be understood
by the developers and code needs to be
written in a modular way who's used OSGi
before I'm sure you have seen plenty of
projects which you use OSGi
which aren't modular at all a massive
great module things are connected
basically exporting everything not
really coding in a real modular way
let's talk about whether modularity is a
want or a need I mentioned OSGi OSGi is
mostly used these days by application
developers but from a Java point of view
there are two different parts - how
modularity is being delivered
there's modularity which is being baked
into the jdk itself and there's
modularity which is available by
application developers it was originally
there for the jdk base the actual the
actual runtime because Java is big Java
is not getting any smaller some of the
great things that come with Java such as
backwards compatibility means what I'm
running on Java 5 should still run on
Java 9 we can't just chop pieces of of
Java away and and state that it is a
backward compatible language so with
project jigsaw with modularity what it
allows us to do is state if I am a
modular JDK I'm modular it means what I
can do is only provide you with the
pieces of the runtime the piece of JDK
that you need for your application to
run so it means yes if you are still
coming over from Java 5 we will base and
run your application on Java 9 but if
you're not using things like core ba or
other things you don't necessarily need
to have a runtime with core Buran from
an application point of view well it
meant let's only need modularity because
other modularity environments exist OSGi
for example number of people currently
using that if you wanted to use
modularity you can use it today this is
a slide taken from some
Oracle like and you can probably tell
there's lots of words and lots of arrows
on it but what this is signifying is the
the ways in which you can group modules
together and in this case you can see
here the Java based module this is
pretty much the module that everyone's
going to get out the box it contains
things like our collections that Java
don't lag all the usual stuff in the
base and you also have other things like
if any of you have heard of maybe the
Compaq profiles you have compact profile
one two three and so forth and basically
what we're saying is your applications
when you create your application you
basically can compose the JDK or the JRE
around what your application needs and
I'll show you a tool called j-link which
will actually when you have your
application and the modules in that
application you'll actually cut down the
JRE so that when you actually come to
run it you're actually running a much
smaller version in terms of when we
think about creating modular
applications what we need to think about
is how we can create boundaries between
our components implementation code can
be very tightly coupled and we don't
necessarily want a tight coupling
between pieces of our implementation
that we want to kind of keep hidden from
either other components or other other
tools or other applications so what we
want to do is we want to create
boundaries between our modules that
allow us to say I want to expose this to
other modules and I want to keep this
hidden from other modules I'm sure
you've heard of what's happening around
the unsafe API it's would have been
wonderful if we think this could have
been encapsulated many many years ago
and then people wouldn't be using things
they shouldn't although I'm sure the
Java wouldn't have such a rich ecosystem
if it had have done that so what we
essentially want to create a service
contracts around our boundaries we do
this very very well now and we're
designing I'm sure everyone's drawn want
to tell you something like this but a
box with a word in it another box with
another word in it and an arrow between
the two your think people think in a
modular way well though when you
actually come to writing you know some
code down
we very often don't actually translate
that into modular applications so if we
architectural II do that and we want to
write code like that why haven't we
always done that well nothing's ever
forced us to do that and I know this
sounds bad but in when when there is a
corner to be cut and not just developers
but people in general will always cut
that corner and just because we think in
a modular way University is where we
learn to develop we don't we're never
taught really to code in a modular way
so we always tend to cut the corners but
with a new enforcement in Java 9 not
only will we need modernity but if we
wanted to use modules not only will we
need to make sure that the modules which
we're interfacing with are exposing the
code that we want to use and are sharing
the services that we want to use at
compile time it needs to be done at
runtime as well Java has done that to
some extent with things like public
private protected and stuff like that
but it's very much a class level and
very different to what we what we need
today so if we're using modules that
kind of means everyone can be happy
because the class Java class part is
dead we have something completely
different we don't have a flat class
block a class of where every single
class exists and when we get to the
right class we want that's the one we
want irrespective of it actually if the
one we compiled too is actually further
on there are problems with the class
path missing classes duplicate classes
that cause errors it's unreliable with a
module class path a class path is
actually created based on the scope of
the module if a module says it requires
certain other modules the class path is
created within within those parameters
but there are problems with the module
class path as well there is a lot more
work that needs to be done you need to
explicitly state which packages you are
exporting you need to explicitly state
which modules you require but there is
both compile-time and run-time checking
so you can't write something is bit
trying to write something which in your
in compile-time which is going to break
in your runtime there's a best checking
on both sides how this changed well as
any I always put this up before the
words really which is son Mis gun safe
this is very unsafe I wouldn't do this
at home obviously but one thing that
modularity gives us better encapsulation
in other words it allows you to state
what you want to expose from your code
this is extremely important for actually
people like libraries that actually
don't want people to go undercover and
and start accessing pieces of code that
you are thinking I'm going to change
that next week don't don't depend on
that this is what I want you to depend
on so you're effectively showing the
service contract this is the contract
which I want you to interact with me on
now from Java 9 although there is a kill
switch which I'll talk about a little
bit later you are not going to be able
to access directly things in the unsafe
unsafe API even through reflection there
are parts of that which interview which
is being pulled out into other API s but
if you wanted to be truly modular you
can't access that because it's being
encapsulated away from from the Java
Runtime but I'll talk about that in a
little bit more depth in second let's go
to a damn it as too many slides I've
gone through I mean to actually change
my display
okay so I'm gonna go to where should I
start I kind of show a couple of demos
the first time I'm going to show you is
is blind here we go no not you II the
okay can you see that I'll go a little
bit bigger in a second what I want to
show you here is a couple of pieces of
code this is going to be running in Java
9 and we're going to create two modules
one which refers to the other so here
what we've got these zoom in slightly
here what I've got here you can see in
my modules folder I've got an out
directory you don't need to worry about
that I've got a source directory
it contains module hello dot info and
module world info yes this is a hello
world example so yeah this is how
witness so this is an extra directory
which you would have it's not a package
it's just a directory which denotes the
fact that this code in this is a module
then we have our packages so we have all
Giro turnaround hello as our package and
then hello dot Java if I open that we
can see class it's basically not really
that much we have a main method which
prints out hello which is just a local
method and also world dot world if we go
and see what world's doing its just
returning a plain string so very very
Mickey Mouse kind of stuff let me come
here and I'm going to run Java 9 modules
in fact what I'm going to do is I'm
going to show you what's in here first
what the code we're doing in here is
because we're using a class because
we're not using a class path we're using
a module path we actually need to use
some of the additional
there's some additional parameters to
javac adding in Java 9 and its module
source path is the first one this is on
jar vac it spelling explained Java where
and modules exist we're saying that's
going to exist in the source directory
we want to compile out to the out
directory and we want to compile
everything which is start or Java the
next thing we're going to do once we ran
that is we're going to say we're going
to run using Java I'm going to have a
module path pointing out which is where
my modules are actually going to be
pushed out to I want to run the hello
class in module all Hello info so what
I'm saying is run the class in run
module hello dot info where the class
that you need to execute is hello so
slightly slightly different to what
we're used to but this is how you would
run a module in Java 9 does everything
need to be a module in Java 9 no the
class path is still available so if you
wanted to run normal Java normal Java
with a class park you can do exactly
what you used to do in Java Knight but
if you want to use modules and create
modules this is how you would invoke it
from here so let me come back out and I
will run that we're going to get some
exceptions module hello what also it
says module not found well dot hello at
module not found hello info so it can
see they're there but doesn't realize
their modules the one thing that we're
missing here is two files module - info
Java and this is the file that explains
what should I say this is the artifact
actually a Java class though that will
define what should be exported define
what network is required by a module so
it effectively draws out the dependency
so let's create one so I'm going to
create source hello dot info and this is
going to be called module - info dot
Java I'm going to do the same with world
dot info so we've got a couple of extra
classes here so for hello this is just
going to be hello
info
and we're going to say module and in
here we're just going to leave that open
for now the next one we're going to do
exactly the same it's a module work it's
going to be called world
info and whoops and we'll leave that
open there so now they actually defined
as as modules but now what we can see is
we're getting a different error what
we're saying is the error is packaged
all dot zero turn around world is not
visible package is declared in module
world but info but module Hallowed our
info does not read it so the compiler
can tell that we have this we have this
package available that we're trying to
import but and it's in world but info
but hello dot info isn't using it so
what we need to do is we need to go into
hello dot info go in here and we need to
say we were acquires world dot info so
now we're stating and there is a
dependency between this module and
another module basically what's going to
say is anything that that other module
exports I now have access to so we've
growing we're growing our module path so
if we run this again we have one more
thing that we need to do and that is
that the second part here in brackets
has changed always find this slightly
more more readable than the first part
it's saying that package 0 turnaround
dot world is declared in world or info
but it's not being exported its
effectively encapsulated by world info
so if we go to world dot info now and I
type export all dot 0 turn round dot
world this is now going to expose this
this is now not private and to this
module so anything that uses this module
can use classes in this package so if I
run this we get the really exciting
hello world output but you can see the
what you get you know this extra steps
you need to take to actually get
something simple running and for those
of you who've used OSGi I don't know how
big your environment was but artifacts
like this can actually be a bit of a
pain in the arse and when you actually
have a large complex system particularly
if you're trying to worry about some
cyclical dependency which you're not
allowed it can it can be quite
aggressive
so that's not modules but they're still
very tightly cotton one thing I really
like about OSGi compared to something
like mud jigsaw is the fact that with
OSGi you don't well you shouldn't say
use this particular bundle what you
actually should say is I want to import
certain packages at a certain version
okay
but with jigsaw we don't have either of
those unfortunately but what we do have
is something called services and it
allows us to be a slightly more
decoupled there depending on what's in
your runtime you can actually make use
of of different services and I'm going
to show you a different different demo
here now and what we're going to do is
we're going to do something similar and
whereby we have one module kicking off
some code in another module but we're
going to do it in such a way where it
doesn't actually require that module and
we do so by services let's have a look
at this so let's have a look at this
here in a services directory we have
source we have a module called consumer
dot mod this has a consumer Java what
this is doing in its simply go into our
service loader saying I want to load a
certain type of service whose interfaces
my service class it gets that back as an
iterable of services of my services and
then it spins through that in a for loop
and calls a method of my services
interface and just simply puts that to
the system out nice and simple the next
thing is the hello world API so this is
another module and this module has the
my service my service service and it has
a single method on its interface called
get message so this is the service which
an implementer can implement they can
make their service available and I
consumer can grab that from the service
loader and actually executor the other
thing that we have is a provider input
and this is in provider module a
provider module is sorry and the
provider input is simply implementing my
service and implementing the method the
the get message method so fairly
straightforward three modules I'm going
to what we're gonna do is going to have
the consumer execute the code in the
provider without
actually adding a requirement to it so
we're going to do this we have module
infos with as a consumer mod there's our
hello world API and there is our
provider so from the consumer what do we
actually need to do well we're using my
service so the first thing we need to do
is have access to that class so we need
to actually use or import somehow the
the classic we're going to be executing
so we are doing that we are importing
all 0 turnaround or API so as a result
what we need to do is we need to say
here that we requires hello world dot
API so we're stating that we want to use
this hello world API because we're going
to be using my service class what we
also want to do is state that we want to
use a type of service so here what we're
going to say is users and the type of
service is all dot 0 turn out 0 turn
around
dot what was it API dot my my server so
now we're stating that we're actually
going to use a service type in Hatchin
service from the hello world API point
of view the only thing we actually want
to do is just export the the services
for the class so the consumer can class
to it and the producer can can implement
it so here we just need to say we want
to export all dot 0 turn around API
swear I wish my company name is slightly
shorter and that's pretty much all we
want to do that from the provider point
of view what we want to do is we want to
say well first of all I want to require
the hello world dot API bundle because I
want to actually implement my auto
attack right across my implements that
my service class and the second thing I
want to say is honestly I want to
provide I want to provide the all dot 0
turnaround API dot my
servus I want to provide this this
disservice and I want to do it with a
zero turn around around dot provider dot
provider input so what we're saying is
I'm going to provide this service I want
to make this service available and this
is the implementation class which I want
you to use and that's important for one
very good reason the reason is because
Java in the background actually going to
auto register this with the service
loader so we don't have to do any more
code writing register ourselves as a
result because this is in the service
load already a consumer just needs to
just need to perform a load of that and
that should run nicely so if I look at
the actual implementation what we should
get is the fact that we should get this
being returned without our my service
input if I find my consumer without my
consumer actually having a buy wrecked
link into our producers module so if I
come back here and I type rounds Java 9
services we get our hello world so
that's using services of being much more
dynamic and if I had a number of
different services registered you'll get
a number of different calls for each
server each service one last thing I
actually wanted to wanted to talk about
where do I put this I think I put it in
here
yes J link who tried of J link few
people so J link is Jaylin gives the
ability gives you the ability to to cut
down the JVM based on your application
so we've talked about how you can use
how you can modular eyes the JDK which
will effectively take out things you
don't need but we're still using the
full JDK here so if I was to look at J
link here what this is going to do is
from from here we're going to invoke J
link we're going to give it a module
path which is going to be the job of
home mods which is you know all the
modules which comes with the JDK I'm
going to add specific modules or on an
ad consumer provider and hollawell
my application modules I'm going to
output that into a into a new directory
called image so fairly straightforward
in terms of in terms of the actual
command if I was to what did I call that
J link if I was to run that it takes a
little while to run but this is
essentially going to create me with a
Java executable which is much much
smaller with all the modules I actually
need to then invoke that same code that
I
I literally just write if I go into
image now let's in fact do a tree across
there what you can see here is we have a
bin directory with without Java class we
have some configuration with some policy
we have some includes with some
obviously legal stuff Lib and this is
kind of like where our dynamic libraries
and our modules are going to exist so if
I was to go into the bin directory there
we have Java if I was to execute Java
what I'd need to do is state minus m to
say which module I want to run and it
was called comms humor mod and inside of
that I want to run org dot 0 turn around
dot consumer and I think it was called
comm humor and if I run that then we get
the same thing with a much much smaller
JDK go JRE
how would ever time I have no idea what
time I started so let's just go okay so
that's Java 9 modules but what actually
let me just good as no screw but what
problems that actually saw well there's
dependency hell and a number of other
things
big big environment some of which you're
not using more security risks or things
that you're not using what's the cost
well you've seen how what I needed to
add it is going to add more complexity
it interring to be harder to maintain
but from a developer point of view it's
interesting to actually understand
well did actually the problem I have is
that actually solved by modules this is
a really interesting migration guide
one of my friends in zero turnaround
oleg gave me which is quite interesting
it because he thinks modules is kind of
nowhere ready right now and there's an
easy way to kind of upgrade to java nine
basically upgrade your ide so you can
use a lot of the awesome api changes you
add the the the new flag permit illegal
access which i'm sure operations are
going to love the name of and this is
really kind of just saying well i'm
going to kind of do away with a lot of
the encapsulation requirements that that
is being that you're mandating i used
for java nine you'll get a load of
warnings per out to the to the system
error and then just wait till java ten
comes up and then use modules so this is
actually i would kind of actually argue
this is actually a fairly reasonable
advice there are a lot of things in
modules in java nine that haven't been
fixed which is where this flag actually
came from this flag is literally only a
couple of couple of months old so that's
one way of looking at it if you look at
this leg also said remember in this
picture who is the developer and who is
the architect because the developer is
always going to be the one that's going
to have the hard time implementing what
the architect says and a couple of other
things that I'll say about migration
when you want to migrate an existing
application across to your across to
your new job in iron environment there
are many reasons why you want to do that
performance is a great reason why but
when you do that you might want to turn
your application to a more modular
application don't forget you can still
use it in the class path you can still
just deploy it as a class path based
application but if you wanted to push it
into modules you might want to kind of
start deconstructing it into little jars
and dropping those jars into the module
path when you do that Java will
automatically make that I think it's
called an automatic jar and an automatic
jar is something which will effectively
export absolutely everything and it will
also have requires on every other bundle
in your system okay so it is a really
kind of bad
modular jar in terms of it requires
everything and it needs everything it's
not really much uh but it gets you into
a way way and you can start
constructing your application and that
will always be in an automatic jar if
you don't have your module job module
info door Java once as soon as you add
it in there and all constraints are
there straightaway if you wanted to
experience more of that then then come
along on staff today we're at the
Salesforce tower and we're going to be
doing an amazing hackathon it's about
six hours were going to be looking at
modules we're going to be looking at the
bit of Jay shell we could be looking at
other stuff as well okay let's talk
about Jay shell who's heard of Jay shell
who's who's used a rattle before in any
in any language get quite a few so Jay
shell is a rapper who knows what a
rattle stands for come on let's test you
not you money go on a read of our print
loop it basically means when you've used
to a developing Java you're going to
throw it your usual monolith I'm sure
that's what people do right they throw a
monolith into an environment and it just
executes in the JVM so it's a very non
community clip you non-communicative way
of interacting with the JVM J shell a
rapper says I'm going to read one line
at a time I'm going to read it I'm going
to evaluate each line then I'm going to
print out any response from that line
and then I'm going to loop around and do
the whole thing again so it's
effectively a terminal but where you're
in constant conversation with a JDK
probably jbo our demo okay so this is a
good term I like this one oops there we
go so let's go here it's a bit bigger so
if I type J shell unsurprisingly I get J
shell and now I'm in the terminal at
this time and if I type tab it's been
type tab tab completion what I can do
from here is I can either talk to Jay
shell or I can talk to the JTA or the
talk to Gerry if I want to talk to Jay
shell I hit a slash before my command if
I don't want to talk to Jay I want to
talk to the jury I don't put a slash so
if I don't put a slash and I put one
plus one I get to how cause that that's
what everyone wanted to know huh
two plus three seven must be something
wrong with the circuitry of my laptop
problem attention but you know we can we
can just send it glance it'll execute
evaluate it will print out any response
and it will leap run give you the same
same command I can type /v and it will
tell me exactly what is which variables
exist in my environment let me do that
again
/p so you can see at the top I haven't
actually stated what the what the names
of my variables are I'm going to be a
really good developer I'm going to type
in x equals three really nice and
descriptive if I type /v now I get my I
get my variable my X variable I can use
that if I want I can say dollar to plus
which plus X and I get eight in my
dollar for see it's very communicative
if I type system dot out dot print Lynn
and now I put hello Oracle code London I
get hello Oracle code London what did I
miss
how good is that I can write Java
without semicolons that's what we all
asked for now what about if I do this
thread dot sleep one
I didn't you're right how cool that so
no need to do stupid interrupted
exceptions or semicolons what if I do
this public void sleep on steep one
second and here I then say thread dot
sleep one second
oh semicolon expected why is this why is
this because I'm writing a method and a
method of the multi-line multi-line
multi command right so if I if I want to
write if I just want to write single
commands to it I have to I have to I
don't need any there any kind of line
separator in terms of a semicolon but if
I'm right multi they asks that if I
fixed that with the semicolon it's going
to make me even sadder I'm going to tell
me I need to catch exceptions as well
all these horrible things that we have
to do in Java huh what else could be if
I wanted so I could type I can create a
class I can type /t tell me all the all
the pipes out so I can that'll work for
intimations classes whatever if I type
slash it'll give me a list of things I
can run I can type slash slash lift and
it'll tell me a full list of things I
have sent to I've sent to the JRE if I
type slash history it'll tell it'll give
me a full list of everything that I've
typed whether I'm typing it to the JDK
with I'm typing it to the repple I can
save that if I want to so save that to a
text dot text because I'm a great
developer then I'm going to type by oops
not by what is it a flush exit I don't
know why it would be the bios argument
for me but that's the way it is you get
a nice goodbye there look that's very
sweet of it if I type in LS oh my god
there's my text text if I was to run J
shell again oops and then say something
like I think it's open its will open
text dot text it will run everything
again that I've just done I wanted to I
can think it's reset yeah resets my
state so everything goes back to back to
normal I can also check what I'm
importing I can import things on that
what else can I show you I'll show you
something funky if I was to type let's
do one plus one against this bring that
to the top one plus one let's just say I
- I really would have liked to have
added that as a variable rather than
just throwing it away in the dollar one
area this works on Mac if you have to
type function escape and a V doesn't
work hang on there we go
function escape V it it provides you it
actually does the inference of the type
and provides you with that there so I
can now type num and out give me now
equals two I don't know if that works on
other platforms actually grab that off
venkat so that the credits of n cut what
else can I say that's probably around
everything i is is useful to show if you
if you're really angry at j show you can
type command d and you'll exit without
saying goodbye if you really don't want
to talk to it so look like like slash
takes place mark they'll give you the
help I think opinon
so J shell um what I want to rubbish
let's talk about garbage collection so
many of you who want to talk about
garbage collection are probably used to
this kind of image but g1g see the new
default garbage collector in Java 9
looks more like this and it provides
regions it provides you with 2048
regions of either 1 to 6 up to between 1
and 64 Meg's per each for each region
and it goes up as 1 2 4 8 6 power of 2
or 2 to the power and it has different
region types here we have old regions we
have even regions and we have survivors
or spaces as well they're called you
also have humongous objects which is I
think an object which is over 50% of
your region size and every single one of
these regions is the same size
so what makes you one DC special not a
lot really because it was kind of
introduced quite a while ago
Jani k6 for that mm and something early
it was tested and became a supported
garbage collector in JDK 7 so it's not
even new and supported it only
officially become the default so that
means if you're going from Java rates
Java 9 and you don't state explicitly
the JVM option which garbage collector
here using you will switch to do one GC
if you want to use it before Java 9 you
can just use this in Java 8 Java 7 it's
just it just says UT 1 GC as my as my
default as might as my garbage but I
think you threw a couple of terms
collection sets collection sets is
essentially a group of a grouping of
regions or groups grouping of spaces
that you actually want to collect on the
next garbage collection you can have
young and you can have mixed young is
basically a collection of all your eaten
or survivor spaces so it's effectively
the really the the objects and things
like that alone you've been there for a
small amount of time and you can have
mixed which is both young and a
selection of old generation
these are candidate old regions now the
key thing here is we're not if I take
you back to this slide we need a garbage
collection you typically do a garbage
collection of the whole heap on the
whole whole team certainly when you do
something in g1 GC when you're dipping a
g1 GC you only do candidate all regions
and it's candidate because it attacks
the area's attacked the spaces where
there are most garbage first
as a result your GC pauses actually a
lot of our smaller can be a lot smaller
in terms of how actually decides which
ones are candidates or good candidates
there are references between regions and
G 1 GC makes notes of which objects or
which spaces are good candidates so if
there is a reference from a young to an
old region this isn't really that
interesting because
most things or a lot of objects are
going to be referencing things in the
older region things that have been there
for a while but it says as soon as
there's a reference from an object in
the old region for something in either
another old region or a young region
whenever it's referencing because the
old object is likely going to be there a
while whatever it's referencing is
likely going to be there awhile as well
so they're not necessarily good oh so
it's that they're not necessarily good
candidates for for garbage collection so
in a young collection will we care about
here in Eden space and the survivor
space so it grabs all of these and it'll
turn it'll turn the Eden's it'll look at
the Eden's and it will say if there is
if there are objects there that I can
garbage collect I will free the space if
there is stuff that is still there still
referencing or still being referenced it
can keep them and turn it into a
survivor space it'll take the survivor
space and do the same thing and then
turn that into an old space so it does a
very very similar thing and it does it
on a region basis rather than the entire
heap multi-version jars it took me a
second nested I'm like what is this
spider doing multi-version jars
I think it's called multi-version jove
actually it's cool
there's multi-version jars isn't it yeah
multi-version jars this is something
that is amazingly bad something I've
added in Java 9 and it provides us with
the ability to do something like this I
say amazingly bad I'm sure it's useful
for some people but potentially not
useful for many many people it allows us
to say I'm going to release different
versions of my class depending on which
version of jars you're going to be
running this against so it allows me to
say in my jar provide this versions
directory and in the version structure I
have 10 I have 9 I have a different
version of my class in each and then
default version over here so the Java
were actually looking in different in
different places depending on the level
it's running up and then default to this
to this previous version this might be
great for libraries because a library
you can say winner whatever you're
running at will will provide you with
that version but imagine
imagine the test implications imagine
the combination implications it will be
far greater as an application developer
to just agree with ops what version
you're going to be running out and
provide a version there HTTP to HTTPS Oh
HTTP has been supported one has been
supported since Java one obviously but
it's been pretty job has been pretty
slow in the adoption of HTTP to this we
were really hoping this was going to
come in Java 9 it has but it's common in
the incubation part of of Java you can
still use it in terms of the impact of
using this I win in Java rather than
just using the kind of Apache API that
you probably are using now it's not a
really a massive impact you just stop
using the API and start using you know
this baked into Java so it's not it's
not really going to provide us any major
addition but some of the interesting
features additional features in Java 9
include things like collection
initialization I'm sure everyone hates
initializing collections show everyone
hates seeing double braces and things
like that you can do things like map off
with you know passing in passing in
values into your map you can do things
like set off rather than you know having
to do a kind of like a raise as a list
or whatever or horrible workarounds so
this makes things much much neater to
actually just write your write your
regular Java there's been additions into
the stream as well so take while and
drop mile I think and it dropped while
drop while yeah so take while this is
really good for infinite streams as well
what it's basically saying is you add a
you add an expression which must be
satisfied rushing that start that's
described it's in a different way let's
let's say you have a stream of ABC blank
e ok this is the stream we're going to
run an execute a choir on that passing
it this addition expression and it's
going to be a lambda and we're going to
say we don't want that string we don't
want to string to be empty of a
particular value so here we're going to
go through the stream then start a we're
actually going to carry on and go to the
for each because it's not empty we're
going to women a printer out B C
absolutely fine but then D because it's
empty we actually stop executing that
stream and we'll actually come out
of this execution so here we'll just get
ABC and then we'll can will continue
progressing on really nice particularly
for an infinite stream drop world does
it fit the opposite way so what we're
saying here is I want the length to be
less than 100 so less than or equal to
one and I will I will only X start
executing when this expression is met so
until the string length is greater than
one I will not start executing further
these further intermediate or in this
case terminal operations on the stream
and until we hit that so in this case
I'm gonna ignore a going to ignore B
it's going to ignore C this will all
stop this expression here and as soon as
we get to be e the string length goes
beyond one so we carry on going that's
when we start printing so we're actually
going to get it even F you can use these
in combination as well so if you were
for some reason trying to start to
manually pause an excellent piece of XML
or an HTML you can do it on tags for
example so you can say I want start here
on an end here I'll grab everything in
between if you wanted to do that there's
quite interesting deprecation
improvements as well you can use the add
deprecated annotation which allows us to
actually provide more information to say
this is this has been added this was
deprecated at version eight one point
eight sorry if my job is getting you
here at version one point eight and this
will be removed this isn't just a soft
don't touch this it will be removed to
stop using this and the biggest thing
about Java 9 is documentation is now in
html5 format so we can actually search
through it and make use of it the search
box yeah this is a little bit here as we
actually do reasonable searches on our
Java Doc's possibly the biggest feature
that's been added since err generics who
knows
that's definitely I have for you if you
have any questions I'm sure much of what
time this finishes but we can let's do
some questions now or maybe over a beer
but there's my details please do follow
me on twitter and
uh thank you very much for attending and
please any questions that anyone has yes
a lot of stuff that seems began into the
gentle care the moments in speak of work
around small feed on for jigsaw yes for
example like that one things you'd
expect enhanced aggregation and work
with version yes and six will have no
notion of the version yes
so the question was about how are there
been a lot of bolted on things because
there have been kind of major changes
for example things like the deprecated
works a version but modules don't have
versions so there's actually kind of two
questions there that I'm going to split
out one question is going to be there's
really let's let's take it as is modules
really ready to push out and is it being
supported by the entire ecosystem I'll
say it's good that it's out I'm really
hoping we can get quicker versions of
Java so we can have a ten in a year
maybe eleven and so forth but there's
there's work going on out space Java
extension so in terms of versions it was
actually a decision not is it actually a
decision made it's nothing to do with
what we're just talking about they're
actually a genuine decision made not to
version modules so so you cannot mote
all you can do with a module is to name
a module you can't version a number can
you not if you don't interested even if
you want to try just just have to write
out dr. ni na yeah so that might be the
way but yeah unfortunately that's one of
things which is really good with OSGi
cuz then you can have a bunch of
different versions at different
applications or whatever confuse what
they want to connect up to but that's
not available in in jigsaw I think this
is going to really be not bullet proof
necessarily but at least you can kick
the tires in probably Java ten and
beyond it nao NIOC same architects same
problem I mean there's no support for
later
well the pot I think and yeah if you
look at something like if you look at
something like the multi release jars
there's no support in maven to produce
them as well so even if you wanted to
create them or how we actually going to
start creating them and things like you
kind of have to hand bake it
but jigsaw I think I'm in all of the
Java 9 core team at the Java core team
there are really really good engineers
but there are only so many of them
there's only so much they can do within
the time jigsaw has been going a huge
amount of time and it has made cool
changes same as a value types
it changes the memory model right these
kind of things can't just be done
overnight so there's a lot of there's a
lot of hours that go in to actually
create this mean well Apache harmony
there are other legal issues around that
as well which which you know when when
we start talking about the major vendors
it's who knows where that goes when we
talk about legal so it's it's all fun
but yeah I mean I think it's in a better
State now than I actually thought it was
going to be but it still has many open
issues that need to be resolved in a
future release and the the committed
legal access is testament to how in
shape it is I think that they have said
that will be removed in Java 10 so don't
rely on it but there's yeah if you
wanted to use modules personally I would
maybe consider sticking to the classpath
on Java 9 that little that little
release extra and maybe push into
modules from Java 10 but it depends how
what your reasons are for what your pain
is and what your reasons are for needing
modules any other questions yeah
so the question is are there any major
licensing issues or changes sorry that
have been made particularly around J
linked with being a distribute Java I
think actually there was so in terms of
distributing Java it's actually even
even lawyers I like looking at the
Oracle licensing sometimes the Java
right and I am NOT a lawyer I should
start with that but one thing there's
two things that I'll say first of all J
link isn't necessarily just there to
allow for a redistribution the second
thing is Oracle have actually they are
actually working at making the licensing
better for redistribution and I know at
comm there was an announcement just
recently about having Oracle products
being been loosened it in terms of
allowing for a redistribution
particularly the things like Java on
docker because that's obviously like
huge controversy about what we're not
allowed to redistribute Java but then
what was a docker image right how do we
share that so Oracle I know Oracle are
working on that what I'm not going to
ever say to anyone you should do this
and shouldn't do that but I think it's I
think though I'll make them if they know
about it and they are making sense of it
yeah JDK presumably is probably open JDK
yeah I mean it's going to be it's going
to be more open but you know it's still
there are still a lot of licensing which
doesn't allow you to do stuff so but
yeah it's certainly better than Oracle
binary decision yeah any other questions
so the last thing I'll say is if anyone
is keen on getting my hands dirty with
modules Man II hear myself had the
Bankura from the JCP chair and also John
Stephenson Hendrik Evers and about maybe
five to ten other Java user groups are
going to be online we can actually
broadcast it through the virtual jug but
if you're able to come to the Salesforce
tower go to meetup.com forward slash
london java community from 10 a.m. to 4
p.m. we'll be hacking on J link will be
acting on modules
looking at migration of existing
applications
maybe even having a little hack on on J
shell lunch is included and yeah just
you just need to register and turn up so
I hope to see see many of you there as
well great thanks so much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>