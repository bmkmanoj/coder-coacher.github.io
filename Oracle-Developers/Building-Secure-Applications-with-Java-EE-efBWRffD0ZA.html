<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building Secure Applications with Java EE | Coder Coacher - Coaching Coders</title><meta content="Building Secure Applications with Java EE - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building Secure Applications with Java EE</b></h2><h5 class="post__date">2015-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/efBWRffD0ZA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone thank you for coming my
name is Patricia event innovations and
today I'm gonna tell you about how to
develop job applications in a secure way
really about myself I've got over 15
years of professional experience all the
times working and coding developer and I
must admit that I still love it
I've been working on projects ranging
from Bank Systems domain name systems so
pretty much
mission critical systems and later on
I've moved to the other side like I've
been working on how to detect software
packs and vulnerabilities in software so
more recently I'm working at UNITA it's
a start up with the idea to bridge the
gap between the industry and the
academia so basically we are working on
automated tool for detection and
refactoring for various anti-patterns
and from there abilities is software
regarding performance databases and most
importantly security you can follow me
on Twitter at Ian's labs
that's important because during today's
session I'm going to tweet some
information which might be helpful for
you for your exercises okay so what
about today's session first of all a
very short introduction to security to
be on the same page and then we move to
oh wow a wasp that's open web
application security project and I'm
gonna tell you a little bit about top 10
the risks according to all wasp then we
move to security in Java in I will show
you several attacks and how to harden
your application and make it less
vulnerable to various security
vulnerabilities and attacks according to
ours and we end up with some security
takeaway for you for the future ok 2014
it's been so far pretty scary year in
terms of security hard read how many of
you heard about heartbleed yes everyone
so open SSL is does that but over but
which exposed nearly most servers based
on open SSL then most recently
shell-shocked
barking Bosh have you ever heard about
that pretty new thing
yeah pretty popular and so when it comes
to other security breaches that was
quite a very serious quite a few
security breaches in 2014
like for example eBay or other resellers
which lost some confidential data of
their customers and as far as I remember
over 100,000 customers of people were
supposed to change their passwords so
it's pretty serious
in another online shop it was the case
where over two million credit cards now
were exposed is closed so that might be
pretty damaging for brand right so
basically every system has bugs
security bugs there is no system which
is 100% security proof there are only
bugs which are discovered and that one
the ones which are not discovered yet
right so security vulnerability is sort
of a weakness in a system this weakness
might be exploited by by hacker in terms
of wasp hacker is often called threat
agent and the threat is a possible
damage which is called which is caused
by exploding vulnerability those attacks
might have very serious impact on on a
business right from the technical point
of view as well as from the business
point of view technical impact factors
include lots of confidentiality so for
example the data of your clients are
exposed loss of integrity so the data
are modified or deleted or in an other
way destroyed those of the availability
so for example your system becomes
unusable so it stops it stops serving
the client as well as a lot of
accountability so we can't identify
right person
responsible for the damage and the
serious business
impact factors which can be very
damaging to a company like financial
financial damage like like reputation
damage like non-compliance to your
regulation like privacy violation so
these are pretty important from the
business point of view okay so in terms
of security there is always a gap
between developers and security officers
so we you are on usually we are not on
the same page we we talk different
vocabularies we we focus on different
things from the point of view of
developers it's about good code quality
and how to meet deadlines and how to
meet requirements right from so security
is not Authority usually that's
completely different point of view from
the security teams they they focus on on
security but they talk in different
terms different vocabularies they talk
about session IDs in IPS and network
traffic usually and we can usually we
can't convert their opinions to what we
want to change in our application to
make it secure right we don't understand
how to fix some problems and that's the
gap and
open web application security project
it's not not-for-profit organization we
with the call to increase security
awareness among IT professionals
including developers so they they
produce very useful documentation
including top security vulnerabilities
list including guidelines also for
developers how to how to deal with those
vulnerabilities a lot of cheat sheets a
lot of will a lot of information on wiki
how to deal with security
vulnerabilities but they do not focus
strictly on documentation they also
focus on working tools and examples so
one of the project is that attack proxy
which I will show you today how to use
it to test your application and sense
see some vulnerabilities and exploits
and vulnerabilities they've also
developed in Turkish security API which
might be useful for us developers
because it contains a lot of functions
for encoding and escaping basically
input and output validation and
sanitization also one of the most
prominent projects from my point of view
is web code which is a sort of
educational application for IT
professional
to make them familiar with exploiting
security vulnerabilities so that's
definitely something you should be aware
of and you can get familiar with those
projects and tools later on so let's
move to taunt top turn security risk
according to or wasp the last list was
was mating at 2015 and it's based on
some sort of statistics from from many
companies and we see what corner
abilities are the most popular and most
risky for companies so the first place
is injection injection how many of you
heard about sequel injection everyone
right so sequel injection is the most
popular kind of injection but not only
sequel injection there is command
injection like in that bash back that's
command injection we can have like XPath
injection so there are many others types
of injection the second place goes to
broken authentication and session
management basically the securom also in
java application during this tutorial I
will focus on session management quite a
lot because usually other attacks aim at
stealing session many still say
session ID you can hijack session for a
user and basically you can impersonate
authenticated user so that's a very
important how to program and manage
sessions in Java environment security
the next one is cross-site scripting
it's basically it's also a type of
injection right because we inject HTML
code into browser HTML including any
scripting which can come with HTML right
so exercise is kind of injection but
because of its popularity and because of
its are that target because it doesn't
aim at servers it aims at browsers
client-side it it's been like on
separate position in the list in second
that direct object reference it's about
when we expose underlying identifiers so
like database identifier in our web
pages and hacker can manipulate that and
possibly get access to some assets which
are not supposed to be disclosed him
security miss configuration is about
alter all types of miss configuration
only usually in the when it comes to
descriptors when it comes to application
servers think about all those admin
consoles which come with default
passwords not secure
Chatto and cetera once I deployed Tomcat
on some public server after like one
hour I noticed I didn't secure it at all
it was like default installation so
after like one hour or so I noticed that
some kind of robot deployed new
application to my Tomcat with empty
execute with system executive asically
inside the servlet so basically the
hacker could get access to that public
server on the level with privileges of
the user under which the Tomcat instance
was running right so this kind of
configuration we we as developers we
usually do not pay attention to right
because for us it development should be
fun and configuration is not fun so it
goes to DevOps sensitive data exposures
we need to take her not to lock
passwords we need to take notes lock
credit cards basically when we deal with
any sensitive data we need to think how
to protect them how to keep them secret
from the outside world
missing function level access control it
happens pretty often that in the course
of the development we change the
authorization all the time right that we
add new functions
functionality and we forget somehow to
put security check whether or not for
example this function is dedicated only
for administrators right so it happens
we are only people nobody's perfect and
that some des place number seven in our
list and then it gives cross-site
request forgery that's another kind of
attack on session because it's not about
stealing session it's about using
session so we hackers craft special
requests tea and treat victims to to go
on the web page and then click link and
instead the clink sensor occurs two
different server with privileges such an
ID cookie of of death victim right
it it exploits the behave the default
behavior of browser browser
automatically sent cookies with every we
request to the domain for which the
cookie for with the domain for which the
browser has cookies for okay and
almost the last one using non vulnerable
using using components with with known
vulnerabilities as I said before
nobody's perfect and today's modern
development with Java
it's about huge technology stack right
we use a lot of third-party libraries we
we run our application on application
servers in wet containers we use
different databases and all those
components have their own
vulnerabilities and we need to take care
of that as well
but it's more about configuration than
actual development and I'm validated for
direct and forwards it's again attack to
take a user to go to some sort of
malicious web page if you don't validate
user input that's a problem and a
potential weakness which further on
might be exploited by a hacker
okay so during our talk we will focus on
session management broken authentication
and session management will focus on
cross-site scripting and cross-site
request forgery and then injection
that's our priorities we will also
tackle a little bit other things and to
win do not stack resolve security with
configuration and using components with
known vulnerabilities because it's kind
of out of scope of development or at
least not on the primary track
so I will take a look at this list from
another point of view I'm more
interested more I'm more interested what
bad could happen to the application from
different kind of attack attacks so the
first group is going to be session
attacks so attempt to hijack session
then we will talk about client site
attacks like cross-site scripting
cross-site request forgery which are
aimed at users and stop browsers then we
will talk about on an authorized access
attacks which basically exploits missing
level function access control and the
server site attacks which basically the
primal form is injection
okay let's sir what's HTTP HTTP is a
protocol to transfer content over the
Internet the important thing is that
HTTP is stateless so we a typical
situation we cannot identify from which
user given requests comes and that's a
problem for us developers because
usually we want to identify the user to
assign in him or her some privileges and
functions and data and so on so for us
developers it's important to have sort
of a session session is a way to
identify interaction interactions with
one user and how is such an implemented
and ideas basically we need some sort of
a unique identifier associated with
every week was which comes from a given
user right so if you are travel over you
know about J session ID that's in Java
world that's the way to identify a user
that's the way to keep a session but
there are also other ways like special
header in HTTP requests such a session
ID might come as a parameter or as a
cooking also sometimes people think
about hidden fields but that's not very
useful as hidden fields are all the
applicable for post
HTTP requests so session hijacking how
can we get access to other session to
other users session we can still his or
her cookie and this cookie might be
visible
I did not a cookie because it might be a
parameter in URL think about your web
rewriting in Java and Jason ID in URL we
might business in Club network traffic
and see what comes in requests and see
Jason IDM requests we can take a look at
server logs
sometimes people log J session ID just
to identify identify one session and one
in two interactions with one user just
to debug to simplify debugging later we
can also steal session by exercise two
aside sporty another type of attack on
session is session fixation and certain
prediction certain success fixation is
that a hacker provides a victim a
special crafted URL or all browser which
has already opened session and then user
comes and logs in locks in without
changing session right that
certification certain prediction in some
technology's jasa session IDs might be
guessable predictable it depends on
technology used how many of you use
jetty server jetty jetty a few of you so
probably you notice the jetty has pretty
short session ID j session ID it's like
only 8 characters long inland for
something so it's pretty short for 4
session ID to be of good length is at
least 16 characters so if it's for
example not the random session IDs
sequence IDs it might be easy to predict
based on the previous session IDs and so
hacker might get access to other
people's session okay so now you will
Hal hijack my session I will login to
some application then I will post a link
with my session ID by a twitter and then
you will access it and we will see how
many people access the link and from
what IPS and what browsers so you'll see
that's pretty easy tea
okay I will try t we'll see whether or
not my session expired yes it's a good
time so I will lock in you can try it
out after you hijack my session you can
steal my secrets okay so you will see
that J such an idea is visible in URL I
guess that he are not that you are not
able to type so fast so it's better for
you when I post it
okay so it's enough for you to access
the Train if you access it you'll you
you should get such a webpage as you see
with hello Patricia even though you are
not Patricia I guess none of you and
oops that happens too often doing them
okay so I will I will post post it once
again
and I can show you that even though I'm
in Firefox now I can I can login with
the same session from from from when I
don't include session ID
it's like a new session and since and
the server requires a new login okay it
seems and nobody clicked the link who
who managed to click a link oh I see
Windows NT the same address I guess that
we all use Oracle Wi-Fi that's why why
all our devices are visible under the
same IP address is anyone else
you're not on Wi-Fi but it's ah probably
I oh oh it was on the previous session
okay I can click the link of the
previous session oh yeah
30 hackers quite a lot with different IP
addresses so you see that was so easy
right
the high tech session it's enough to get
our hands on on a cookie or a session ID
so how to prevent such situations
first of all we should avoid session ID
in URL right it's too easy to hijack
such session in the sample application I
forced usage of URL rewriting but if you
don't configure anything
the default is cooking but URL rewriting
is possible as well for all those user
users who disabled cookies in their
browsers or all those users who use
browsers without cookie support its
minority at the moment but still so by
default yes you can have URL in a
session ID in your URL so you should
disable you are rarely writing in your
app server and that configuration is
observer specific or you should use web
XML and tracking mode mode which is
available from Java EE 6 so you should
configure your web XML 2 tracking mode
cookie no URL rewriting at all you can
see the configuration in my application
it was tracking mote URL just to false
URL rewriting can't disable cookies at
all
okay cookies are better but are they
enough what do you think guys absolutely
not because without any encryption you
can do session sniffing network
monitoring and packet sniffing and you
can get your users session cookies in
clear texts and then once he a hacker
got his hands on on a cookie he can he
can make use of it it's not that easy as
it was in a session ID in URL so I can't
post a link or anything but you can in
you can imagine your developer right so
you can write your own cottage it's not
a rocket science t do HTTP connection
and set up some headers and cookie and
connect the server but that's a hard way
there are a lot of terminals of easier
ways like browsers plugins and add-ons
or intersecting proxxon like our SAP
proxy you can just configure proxy in
your browser and then change requests
when they go are sent to server I was
supposed to do a demo oh it's such an
sniffing but I guess that we can skip it
that's pretty simple that shows I use
white sharks and sub jet application
proxy Wireshark is for for packet mode
sniffing
I just can see all the pockets with the
content and then I use intersecting
proxy to set up a cookie so basically
the problem here is that we do not
encrypt our session Cook identifiers
during transport how to avoid such an
exposure during transport use HTTP right
and with session cookie we can configure
a web.xml to send cookies only
undersecured channels also there is
another security constraint which can be
set up in what XML for for transport to
be confidential or integral consider for
the transfer chi-chi to provide
confidentiality or integrity basically
in java application it means in both
cases the same use HTTP
so there are three places where certain
concession can be exposed during the
transport that's pretty obvious so we
should avoid an encrypted transport the
session can be can be seen in clear
taxing on the client-side and that
includes such attacks like XSS
cross-site scripting to grab session
cookies or are the kind of attacks on
browsers or operating systems all those
malware and viruses often steal cookies
and the third place is server side we we
should not log our session IDs in in
analog files we need to think about
session replication secure session
replication in application clusters when
we use clusters with certain replication
we need to take care of that replication
is done on the secure Channel and there
are various attacks on on servers like
hacker can do memo dump just to read
session IDs in clear for think about
such an ideas your sensitive data right
so it's connected to another security
risk from wasp list sensitive data
exposure so for all sensitive data
including cookies including passwords
including credit card numbers including
Social Security numbers and so on
and clipped at rest and in transit
you're strong algorithms and sense long
kiss remember to disable auto complete
in the disable caching on webpages which
are used to gather all those sensitive
data so how to steal a session if sexual
transport is used you can attack the
client as I mentioned before and now we
do it demo
previously you hijacked my session now I
will hijack one of your sessions we will
see who will be the lucky victim
basically we need to first of all we
need to JavaScript code to steal a
cookie
I've prepared a servlet who which logs
down stolen cookies and I've prepared a
vulnerable application to be exploited
via injected JavaScript code so it's
kind of XSS attack I will store that
malicious JavaScript code in the app I
would like you to log into a vulnerable
application I will post a link in a
moment there is very basic
authentication and a non-empty username
is accepted and after I will store
militia JavaScript code in the apt you
would be able to click view other
sauvignon page and and then we will see
how many
sessions I will be able to grab
okay so that's
that's for you guys and now it's my turn
you see here you see textarea when a
user and concern his or her opinion
about the service so I will share the
opinion together with malicious script
I've got that script prepared so let me
let me get it so you see that that
basically it's access document.cookie
and then requests to to load an image
basically the such construct is used to
avoid to bypass same origin policy in
browsers because you can't get you can't
request HTTP GET to other pages from
other domain from under other domains so
to avoid that we load it as a image
because for scripts and images it's
allowed to be loaded from other domains
than the original page
okay so now you can you can take a look
at the opinions pages please go to that
page after I've written my opinion you
will see a cookie alert that's saying
that cookie is about to be stolen for
sure a Hockett would not include such an
alert in his script that's only for you
and to show you that I have very clear
intention so so we'll take a look at at
my log oh it looks like I've stolen
twice a lot of cookies you can see
differences in inter form this one is
from Firefox and this one the other ones
are from Chrome so now I can exploit
session basically what I will do I will
configure a proxy in Firefox my zap
proxy is working from 1990 port
are we at a breakpoint in a proxy now
I will try to to access you you see
that's now the browser does not float
debate automatically it goes to proxy
you will see that my profs mij session
ID is different I will change it to the
one I've stolen and we'll see how it
turns up oh we have the lucky victim who
was that yeah we got you okay so that
was pretty simple demo which hold how
easily you can exploit java application
if not written properly let's take a
look at code what happened here
the coach is very simple we use a simple
JSP page we iterate over opinions and we
simply display them I guess there is a
very similar piece of code in your
application as well who uses JSP a lot
of you so so now you want the usage of
simple display is very dangerous for
your users
uhh
how can we avoid this kind of attack we
can use one more cookie configuration
parameter which is HTTP only this
parameter was introduced by Microsoft in
the Internet Explorer version 6 as far
as I remember it was for their users T
to prevent XSS cross-site scripting
attacks so this flag instructs a browser
not to expose cookie for JavaScript so
without that flag we can JavaScript can
access a cookie via document dot cookie
with this flag it's impossible at least
in the browsers which support this flag
it's not standard but it's widely used
every modern browser supports HTTP only
so it was yes
but now it's it's just when you send
when you send requests automatically
it's it's okay the problem is only with
when you access document.cookie from
JavaScript so it's not about sending
requests
it's about accessing cookie so it's when
you send a request from JavaScript
the cookie will be attached as as with
every regular week was so that was
cross-site scripting along with broken
session management and that way I
hijacked one of your sessions
another type of attacks assistant
session fixation when a hacker opens a
web page of a system in a browser new
session is initialized then hackers told
some house the session ID then leaves
the browser open and new that comes and
locks into the application
unfortunately the user uses the session
initialized past the hacker then hacker
can easily exploit the stored session ID
to hijack the user's session the
solution to that problem is to change
the session ID after successful login in
Java EE 7 in several specification 3.1
we have changed session ID method in
previous version we can use the per
invalidate and get session true just to
obtain a new session
so broken authentication and session
session management is quite a huge
problem even in modern job application
first of all we should use random
unpredictable session ID at least 16
characters in length most application
servers support that so that's not a
problem in the Java world we should use
sake of transport and storage of session
IDs that's a problem we should configure
our web XML appropriately to use secure
and HTTP only flux we should
consistently use HTTPS once the user is
locked in so for example we need to
carefully serve static content because
static content usually served through
HTTP right not HTTP just to make it
faster in such cases the server should
be configured to self static content
from under different domain name so not
the same domain name as the application
don't mix HTTP and HTTPS under the same
domain cookie path
why because once your cookie travels
without any protection it can be sniffed
and then your session will be hijacked
don't use too broad cookie pops because
it can lead to usage of HTTP and then
your cookie will be compromised we
should very carefully create and
destroyed session
first of all new session ID should be
assigned after login that's a must
to avoid session session fixation attack
we should provide logout button for our
users and that's that sounds funny but
sometimes we forget that we just we just
implement new login form user in the
same session without and logout session
timeout it's recommended to for critical
applications session to set session
timeout to two or five maximum five
minutes for typical application 1530
minutes it's enough why we should keep
session our session short just to give
the least possible time to hackers to
hijack session right if our session
would be very very long then hackers
have more time to hijack it so one more
thing why is it so easy to hijack
assertion remember the first exercise
their session my session was hijacked
from different IPS different browsers
and so on that's not a typical behavior
right of a user to change the browser to
change NP when you open a browser you
interact through a browser so it's the
same user agent the same browser all the
time usually it's the same IP all the
time the IPS are even if if you are
behind in art the IT piece are pretty
static so probably it's a good idea to
keep some sort of original information
some sources some selected headers from
the original request in our session and
then with every request check whether or
not session I user agent IP or any other
headers and match the original headers
if something's if they don't match
something's going on and just in case
for critical application it's better to
invite eight session it's important to
the best our intent occasional standards
and frameworks don't develop your own
framework use what's available in Java
are in make sure that your credentials
are stored in a secure way it's about
passwords think about salted hashed
passwords you don't have explicit
support for that in Java EE you need to
take care of that yourself to implement
salted passwords
who knows what salt is for password so
salt is an additional random string
which is added to the original user
password before hashing wide to do that
to avoid say brute-force attacks with
rainbow tables and some sort of look-up
tables
brutal force attack with such tables
ability pass so once when not salted
harvest are exposed and stolen they
might be easily hacked so with salt
every password has that unique part
and look-up tables do not work the well
with with salt 'its passwords so it's
not fast to decrypt and fine or rather
find find the passwords
what about the support in Java EE we
have declarative security implemented
using annotation or descriptors
descriptors but remember that that
declarative security does not force new
session ID after login does not
associate and other headers wait with
your session just to check whether or
not there was Adam to hijack your
session so it's a good approach but does
not solve everything there is a
programmatic security supported from
Java EE 7 with HTTP servlet request
methods authenticate login and logout
and this should be used for advanced low
fluorescent requirements so my toes
would be a programmatic authentication
with Java EE 7 just to do login logout
and additional code those additional
requirements include changing session ID
after login and invalidating session on
logout and together with programmatic
identification I would go for the
clarity authorization so configuration
web.xml together with rock a notation
was allowed permit all and deny all the
configuration detailed are based on
application servers what XML of course
is a standard by the configuration of
rails and login modules depends on
application server security constraint
in which exact are they that's an
example do you see any problem here the
problem here is pretty tricky that we
secure only two methods even though the
other hdt methods are not implemented
there is a trick in RFC that the default
when there is no hat implementation for
it falls back to get so basically and
gann we can we can execute any get
method through through head hdt method
with hard we don't get response
so if our get methods don't have any
side effects that's fine because we do
not expose any data with read but if it
often happens that get Matins have some
side effects or some modification into
the database and that's why such
configuration is Tadros and here we have
connection to another point from the
wasp top 10 missive level function
access control in case of missing
function level access control e we
should remember to check always on
server side too to protect all wet
resources to protect all services
including EJB or multi jb's we should
remember to not expose UI navigation to
unauthorized functions and to implement
all those things in such a way that it's
easy to update and out it so basically
in maintainable code okay
cross-site scripting so you've seen an
example of cross-site scripting
basically cross-site scripting is when
the user supplied input is not properly
escaped or verified before generating
the output bite you have seen a stored
exercise so I was injected script was
persists on the server side there is
another type of exercise its reflected
exercise and mode more common when Rick
was dark data when malicious script goes
in URL in some parameter here you can
see our script URL encoded it could be
included in a URL as well and the
example of reflected XSS would be that's
for example we have an application with
a vulnerable search page a query term
display disease in JSP hackers link
would be like he is he on a slide
hidden under some cute name and and the
hacker could say Trick addicting to
click that link and it would end up in
in ascending
a cookie to the hacker so what's her the
best practices to avoid cross-site
scripting escape or untrusted data with
that example of mine you see before the
problem was JSP take a look at the code
there is another very similar code which
is facelet so it looked similar but
under hood under the hood there is a
different completely different
technology with facelets it would work
fine because facelets
escape parameters or attributes by
default so even though it looks the same
it works differently
GSP was default technology for Java
server faders in version one it changed
in version two in version two the
default technology are facelets
so for those of you who use JSF in
version 2 it's more or less fine if you
don't use JSP at all so how many of you
use JSF one just a few hands that's good
that's good but we should remember there
are a lot of people who use JSP still so
that's a problem so if you use any other
framework and it's based on JSP you need
to take care of that you should usually
display all your output through special
tags like in JSF is H output text you
can use jst LC out and sell on so when
you generate for your web page you
should escape all untrusted data there
is another approach to validate input
and that's much more difficult because
it's very hard T to validate properly we
should base our validation on positive
validation on whitelist so allowed
values on instead of disallowed values
and validate as much as possible based
on business rules ok so on cross-site
request forgery another daemon
- to show how cross-site request forgery
works in practice I will login to the
application then I will ask you to login
to the application as well any non-empty
username will work and then I will
provide you a malicious link and and you
will see later on what happens basically
I will check my account balance which
should increase the Finchley
so
oops I've forgotten that the proxy is
turned on so I'm disabled epoxy and now
the answer should be pasta waiting
requests okay so basically this is a
simple application which makes like bank
account or something like this
it's very basic we can transfer our
mommy to our manatee
to anyone by name so you can log in
transfer me some money if you don't want
to transfer me any money I will ask you
to click to click a link
wait a moment I will find sleep
this is a very unsuspicious page they
leave me
oh I've got the first transfers
oh this one is this one is malicious
because take a look at yes there are
more coming if you take a look at the
source of the webpage you will see that
it mimics the original application but
it does not show all the fields
available to the user
instead it's based on hidden fields so
that the source code for our attack it's
very simple hmm take a look it's
basically the same form as you have on
your original application but all the
fields are hidden and revealed with with
Patrizia and six as a target for the
transfer of money and with prefilled
with their amount 666 so basically i've
shown you how to send a request in the
session of other users we can trick
other users to send a request and they
can even not notice it at all
so the problem here is that the
browser's automatically sent cookies
when the requests go to domain name
they have cookie for
so for attackers it's enough to create
malicious web pages and trick users to
to see that web pages users don't even
need to click on those links it's enough
to have web email client and turn
enabled automatic loading of images I've
shown you before that there is a trick
in JavaScript that's user that's reload
completely different URL into image
source yes yes that's the problem T to
avoid the same domain the same origin
policy and that policy doesn't work for
scripts we can and images so that's the
exceptions and that's why it works fine
so to avoid cross-site request forgery
we need to use unique tokens for our
requests and it's worth considering to
use remote education before important
operations in Java EE we have disappered
for out-of-the-box cross-site request
forgery tokens in JSF version 1 those
tokens were a little bit too weak and
predictable
so it was vulnerable in JSF 2.1 we have
strong tokens
be careful with the last addition to JSF
2.2 of stateless vs which
which none of the security viewstate
tokens which basically serve as
cross-site request forgery tokens so
without those tokens it works much
faster and we don't need stalkers for
for for example public anonymous pages
but on the other hand we need them for
all pages which are accessed by
authenticated users and one more thing
because we here focus usually on forms
in GSF you can use protective use also
for get requests it's configurable via
protected views element in faceless
config
and then injections floss and as I
mentioned before injection floss
occupant application sense and festive
data to an interpreter any kind of
interpreter usually it's about sequel
interpreter or compiler but it can be
also JavaScript engine in browsers
that's about cross-site scripting also
type of injection it might be jpq l or
HQ l in case of object relational
mapping it might be any query language
for no sequel database it might be XPath
it might be JSON it might be comment
shell so all those tools are vulnerable
when it comes to invested data and
injections a simple sequel injection I
think that sequel injection is one of
the most common most popular and
well-known so I guess that all of you
knows how to protect against sequel
injection we should basically use
prepared stent statements criteria api's
and basically parameters I'd api's
instead of concatenating strings
unfortunately in some of those before
mentioned technologies it's not possible
to use safe api in that case we for
example XPath so in that case we need to
be like help about escaping what are
possible damages when it come to SQL
injections
for example we can experience lots of
convention confidential a
confidentiality so sensitive data can be
exposed to hacker we can lots of
experience lots of integrity like hacker
can modify our database modify data
modify structure of our database and so
on
so here it's worldwide to mention that
all we need to apply the least
privileges role so our database user we
connect on from our web application
should have should has the least
possible privileges so for example she
shouldn't have right to drop table for
sure also with sequel injections we can
lose we can experience lots of
availability of our service take a look
at that benchmark in such a such a way
when we benchmark hash function many
many many times it means that our
database server is under heavy load
right so probably users are not served
that's the right performance or probably
we can experience even some crashing
something like that sequel injection
might be stored for the future like
hacker could create some trigger on on
other day or incident that's why it will
be launched from their ability and
access to every internal data here you
have some interesting examples of
injections it's very important to
validate data coming from all external
systems right it might be it might be
strange to validate data coming from our
barcode reader right but here you you
see the examples that barcode can be
hacked as well and that's funny how do
you avoid speed stickers so you've seen
a very simple sequel injection but there
are other versions of sequel injection
like planned sequel injection if you
don't get any data only two states of
response so you can test and exploit not
sequel injection and there is timing
sequel injection if you don't get
anything you always you don't get
anything from the server or you always
get the same response but you can also
trick the server G to differentiate its
behavior and then find out more what
about blind sequel injection blind
sequence direction we have we have URL
which returns only two states the
article is displayed or not no article
error is provided to user when we append
always true condition we can check that
article is displayed we can when we
prepare always false condition no
article
it's provided so we don't get any
specific data from that sequel injection
we only get two states right the state
is the article spine and the other
states that there's no article based on
that we can we can basically do anything
we want we can't we can test any
condition we want right so here we can
find out the first ticket off of a pin
for a zoo for user so this part of
sequel represents our always true or
always false condition from the previous
slide so if we if we get the article it
means that this condition is true if we
don't get it we instead we get the error
it means that it's false and in such a
way we can test all ten number ten
tickets and we can find out which one is
valid or we can use a binary search to
speed up the process so that's blind
sequel injection which can be used to
find out many data in our database and
there is another form of sequel
injection timing sequel injection where
basically we always get the same
response from the server
we know that the server executes our
injected sequel but we don't see any
difference
so we can't find out what was the result
of the execution but take a look at this
sequel if statement based on the
condition we execute the first branch or
the second branch so the first branch is
benchmark which takes part of a long
time and the second branch does nothing
which returns very fast
so basically basically we've reduced our
timing sequel injection to blind sequel
injection when we have two responses but
we differentiate the response based on
time not the data returned so in the
same way as before we can find out any
data in database differentiating on the
time of responses so it takes a lot of
time to have such a application but
still doable so best practice practices
I guess that you all know that you
should use a safe API it's a safe API is
unavailable you should carefully escape
characters you should consider usage of
existing libraries it's always important
to do strong type checking and strong
key input validation and introduce trunk
input validation rules and security
takeaway for you for the future nobody's
perfect
we all make mistakes but we all need to
learn learn and plan we should use
standard components and api's Java is a
good choice but it still needs to be
applied widely and don't just anyone
validate validate validate all the data
they are
provided to your applications from any
external sources it's also important to
include security into your daily routine
and daily development process just to
have appropriate tools used appropriate
policies introduced and appropriate
attitudes in your team so thank you and
if you have any questions I will be
available during the break so we can
talk about sets</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>