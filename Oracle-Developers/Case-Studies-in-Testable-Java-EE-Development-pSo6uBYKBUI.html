<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Case Studies in Testable Java EE Development | Coder Coacher - Coaching Coders</title><meta content="Case Studies in Testable Java EE Development - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Case Studies in Testable Java EE Development</b></h2><h5 class="post__date">2015-06-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/pSo6uBYKBUI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome by the way to Java one any
first-time attendees javaone San
Francisco Wow gosh is pretty cool all
right sorry the title of this talk is
case studies in testable java ee
development a couple years back my
colleague and I this is ash luck dancin
by the way my name is Andrew rubenzer we
are both senior software engineers with
jboss which is generally the middleware
division of red hat so we do open source
I have a history and working on the
application server and found it a little
bit difficult to build because it wasn't
maybe so testable so I went into
building some tests based frameworks and
awestruck signed on around the same time
so we started collaborating and came up
with a suite of projects that along with
our community started to fill the gaps
that we were finding in the testability
of Java EE so Java EE developers and how
about how about not actually job just
java SE your guys are cool all right i
like it so we set out to write this book
and we figured look there are a lot of
books out there that describe how to use
ejb i wrote one CD I or servlets or any
particular of the slices of Java EE but
nothing that was really like hey guys
here's how to make an appt and really
hook everything together and by the way
when we're hooking everything in
together it should all be testable too
so oh that work so we set out to write a
book this book right here with O'Reilly
and we're going to be sending off the
final bits into production very shortly
over the course of the next week or so
if I hit the book if you have cards like
I gave out little cards right because
this screen is kind of small this room
is really deep and we only have like
four or five of these slides and we're
going to be spending most of our time in
the IDE to try and show you exactly what
we've done tell you a little bit about
why we chose to go those were out
and then show you link so the objective
of this talk really is to give you an
understanding of what you can build that
it can be testable don't worry about
trying to figure out how we did it
that's why we're going to give you
resources it's all in a github repo you
can pull it down you can view it you can
run it on your own you can see it
running on openshift all that try not to
worry too much today about the how just
remember that it is all possible and
think about maybe some ways you might
want to bring this into your own
development so those are our goals here
today just kind of wet your appetite
we're going to go through a wide swath
of technologies to make it go as we
honey filled up or down okay so let's
like start in with the examples here
actually can you just show the
continuous data of dev thought org
website then does that work okay so if
you go to continuous dev org you will
see like the book site that we have in
place this will kind of be replaced with
there's an example application that we
have the example application runs online
doesn't run today apparently but does
run online in is the proof that shows
that everything that we're doing works
when you hook it in together so here on
the upper left corner is a link to fork
on github and if you were to follow that
you'll see a link to the repository for
the book the entire book is creative
commons licensed by oh say so it means
you can go in you can start reading and
go through chapter by chapter to see
kind of what this is about and like
really just actually read it in place or
you can go online in like order it and
do whatever but the whole idea is to
keep everything open so that you got
references and examples so as long as
we're all cool that you guys know where
to find the resources after
words later then we can continue along
here are you start by reading I'll start
but yeah this is completely what's that
thing in Congress when they just want to
like stay up and filibuster yeah we're
going to filibuster javaone today so the
name of the book is continuous
enterprise development in java colon
testable solutions for modern
applications continuous we've all heard
continuous quite a bunch lately probably
in terms of continuous deployment or
continuous integration we've chosen the
moniker continuous development because
we feel that yes while the DevOps angle
is very important to us and while
testing in continuous integration and
then pushing is all great too there's
also kind of this link that infers that
it's okay maybe to not be doing your
testing during development and we want
this whole cycle where basically
everything is in the IDE and as you're
developing you get the test you commit
and then it should go in all the way
from there into production so that's
kind of what we're doing with our app
and we consider that to be part of the
whole continuous like development
lifecycle by enterprise what do we mean
by enterprise anyone here ruby-on-rails
nice a little bit transactions so the
answer is usually no but I'm impressed
by that that's cool when I talk about
enterprise look when it came to acid
transactions over the past few years
that was kind of the very rigid thing
like we need to have acid transactions
things to maintain their integrity and
have the proper isolation all that
you're getting from the asset databases
and then amazon kind of came out and
they were like yeah guys but but but but
you realize that maybe like ninety-five
percent of your use cases really don't
need to have that that type of isolation
and durability and we really don't need
it most of the time so we're going to
get away with something called
eventual consistency and well alright so
eventual consistency is kind of that's
the funniest term by the way I've ever
heard because it's just kind of like
yeah yeah it's a consistent database
like it eventually at some point in time
but it suits most of our use cases and
it suits it like actually pretty well so
now we've got this dynamic of all right
so we've got databases that need to be
transactionally supported we got ones
that don't necessarily need to be we
they off to play nice so this is kind of
what we mean by enterprise when we get
into the real nitty-gritty of having
transactions have things properly
secured because not everyone can go
ahead and do anything just like we
wouldn't leave our homes unlocked or our
car doors open probably we need to have
some security involved there and again
this is kind of in the base of java ee
but not limited to java ee text we're
going to go start to implement and java
because well for this book we're going
to implement this in java and see what
the community affords us in terms of
getting things to work and move forward
so will first start with some difficult
to test cases this talk by the way we'll
assume that you know how to run an
integration test on something simple
like a hello world is that it's it's a
broad assumption look I know when I see
people coming into these talks sometimes
the fight is just to like convince your
boss to do testing at all or to whatever
we've done this talk a couple years now
we've done the whole Oh worlds and felt
that maybe people were getting sick of
hearing that same thing over and over so
again we're just going to show you kind
of what's possible file away for later
to unravel and how to do it maybe get
the book to have it explained to you
totally so yeah when you do a a true
sectional secure to the world it turns
actual secured hello world right it's
well then it's not hello world it's like
Hello John and only john the amp is back
up and running that's great all right so
we were able to hack around the whatever
this is the example application that's
going to back everything in the book and
if you scroll up a little bit we have
very similar
it's at the top of the there's a login
button which shows that like will
integrate with Twitter and we've now
just like logged in using our socks
Twitter account which is shown very well
above where you can see but trust us
okay it's there it's there you don't
feel wow we really didn't need to make
that work at all because we use could
like in the future like I yeah it was
off-screen worked great note to self
note to self yeah maybe let's flip over
to the mail example um testing async
operations has anyone done this try to
do it yeah how'd that go for you was it
tough would you do nice alright so to
test a sink operations here II
implemented the entire SE and EES web
stack and use it so you mocked the whole
stack if he rebuilt the whole stack to
mock great ok here we are part of the no
mock movement we know that mocks got
very popular for like giving you stubs
for testing things the problem with Knox
is that when you test with mocks then
you're by definition not testing the
things that are going to be in place
actually in the runtime right so so what
we're going to do is try and test a sink
operations but using the real runtime
components here's the problem with
testing async this is something we used
to do in the jboss application server we
needed to test our message driven beans
implementation message driven beans
basically works you send a message it
gets received the control just gets
returned to the client it can do
whatever so we had all these thread dot
sleeps there are two problems with the
thread sleeps one was that well when you
have like say a thousand tests and they
are all thread sleeping for five seconds
then that's five seconds x 1000 tests
5000 seconds of just waiting around for
stuff to happen so it adds tremendous
amount of time your test suite the other
problem with a thread sleep is that it
doesn't really guarantee that anything
is going to be done by the time that
thing hits so guaranteed it was like any
particular run of the jboss AS test
suite this was many years back we would
have like any number of transient errors
the whole thing would never clear we'd
always have like four or five kind of
like and we'd look at it and be like oh
yeah that's a timing thing that's a
timing thing as probably fine it's
probably fine not really the way to do
testing so let's take a look at what we
have here it's the question first
getting people to the back see the text
at all or do this need to be bigger
bigger all right I'm going to assume by
the way that like just you can't like
there's I'm going to assume that there's
nothing we can do to make everyone in
the back so we're going to try but to
see everything this one right here is
going to be called mail service test
case and it's in that repo that we
showed you before so you can refer back
to it for later and maybe just listen in
and here we have defined herein are
Killian based test if you've not heard
of our Killian ah so you guys that's all
right things have been working for us
the are Killian test is going to be the
thing that it allows us to integrate our
test case in with some sort of a backing
container in this case it'll be wild fly
today you p-6 p a p 6 which is our
supportable enterprise application
platform which by the way is now free
which is awesome we couldn't say that
last year or any of the prior years but
our supported EAP java ee runtime
product is now free to download i think
you put in your name and email address
and that's about it and you can use EAP
to develop on and then it gives you kind
of a nice way to if you buy support
later you're still on the same platform
so I was really happy when they did that
but this case right here will start up
the test case it's going to run the
server it's going to deploy a web
archive into it which is going to
contain a few things including this smtp
mail service so if we take a look at the
SN
gmail service class we'll see that we've
defined here a singleton ejb it's a
local being local interface and if you
look down you'll see that it's got two
features two methods here one is called
send mail which will just send a mail
message and the other one all right it's
called Q mail for delivery and in Q mail
for delivery what we're going to do is
basically going to send the mail but
we're going to add some step in the
middle where instead of just sending it
directly and having the caller block on
waiting for the mail to get delivered to
the mail server and then return we're
going to queue it into a message-driven
beam we're going to put it into a queue
a JMS queue via message driven being a
message-driven beam will then be
listening in on that cue read in the
messages and then send them up so
basically if you imagine that you've got
like a real successful website and
you've got to send you know thousand
emails a minute or whatever you're not
going to wait or make your users wait on
each one you put them all into a queue
and just have whatever processing thing
is listening on the queue go and do that
whatever but we still need to test that
this thing is all working and because
we've now put it onto a JMS queue this
thing is by definition an asynchronous
operation and we still need to make sure
that things are going to get sent
properly so this is our ejb that we're
going to test not all that complex in
its makeup it just is basically an ejb
that sends things along to the java mail
service the test itself is going to
inject a couple things first we're going
to inject this smtp mail service that
we've delivered so that we can actually
call it right from the test we're up to
do a lookup whatever we're going to
inject it in standard arquillian stuff
that those familiar with arquillian
should know and we've got this smtp
server service and a deployer so
basically what we do we come down a
little bit and we're going to use this
in sequence annotation that our Killian
has to say hey first we're going to run
this test
if you run j unit before you know that j
unit provides no guarantee as to
ordering right when you you just have
test methods they're called in whatever
order we've added this in sequence
annotation to allow you to like put
things in sequence a lot of testing
people will tell you like hey everything
should be able to run on its own or item
potently or whatever and it should only
test one thing and I say great those are
ideals to strive for but like I live in
the real world and sometimes I want to
be able to know exactly when things are
going so like here's what's up well also
something about considering that the
test is the test class that's the whole
scenario what you want to test and not
just the individual methods within one
so the integration becomes the whole
test class does multiple different steps
in a scenario instead of having that
just put in a moment test method right
baby you know for unit testing maybe
that's more true for unit testing you
want to be able to have anything and it
stands on its own here sometimes if
you're going through like a whole
sequence or a functional test you're
going to have like a sequence of events
that happen and you want to know when
they fail so cool so first we're going
to configure the app server I'm not
going to drag it through this code this
is all specific to the app server we're
using that basically just says hey we're
going to define some mail session in the
app server and like said addala then
we're going to limitations in the es6
which are fixed in 87 mind you yeah
actually deploy a mail service instead
which is basically what we're doing here
yeah we're basically we're just
deploying a mail service here and then
the thing that's going to run after the
test is we're going to reset it back to
normal so that everything is all clear
here is our test method and maybe we can
blow that up a little more or that is
little screen is all right our test
method is this it says test smtp async
we're going to define a string which is
the body of the email we're going to set
we're going to define a cyclic barrier
who is familiar with a cyclic barrier
Java util dot concurrent cyclic barrier
usually when I say that part people are
like oh yeah I know that obviously
stahma the SDK cyclic barrier is kind of
a cool thing it'll say
we'll pass it a number two these are the
number of parties that need to arrive
upon that cyclic barrier it's a mutual
waiting point right so like imagine if I
have a gate and the gate stays closed
and one person arrives and it's still
closed and then because I have to when
the second person arrives then the gate
opens and it resets and shuts again
that's why it's cyclic because it will
shut again so this thing is going to
wait for two parties to arrive at this
barrier before it lets anything go
through which is cool because we have
two parties we're going to send this
email and that's going to kind of be one
event and we're going to have the email
service like wait and then the test is
going to have to wait too so what we do
as we go into this smtp server service
and we set a handler that says hey when
you receive a message a weight on that
cyclic barrier so this is kind of like
an event mechanism that says like oh hey
my thing got my email service got
something i have a custom handler i can
say all right i'm going to do that and
i'm going to wait here in the test and
if you go further down then we say ok
we'll define the message and then we'll
say mail service queue it for delivery
and send the message at that point it's
going to then call upon the ejb to cue
the message for delivery we've defined
in the handler above that it's going to
have to wait when it gets there and the
first thing the test is going to do is a
wait for a maximum of five seconds on
this barrier if we get any of these
exceptions then the broken test setup if
it times out then the test hadn't
received the confirmation message and we
know that we didn't get the email if the
barrier gets cleared in time then that
means that the email was received on the
server side and it hit the handler and
it cleared the barrier and we're all
good cool well if you added that the
estimate smtp handler there is actually
on the smtp server which is right very
worth noting that the handler is
happening on the server side as well
don't want to make everyone's eyes kind
of glaze over with this but this in my
mind is among one of the more complex
examples that you can test and should by
the way because to catch that there's a
problem with your email service or
whatever in production is ultra bad so
we can run this
again with any arquillian test we run
them all from the IDE we don't require
any other plugins we don't require any
other anything this is a standard j unit
test so from eclipse with like no other
or anything else we say run as a unit
test ASM server upto rep and loading
yeah and it goes through and you see
that it's now all working and actually
if you scroll up a little bit in the in
the yeah I think I put like the output
of the mail in here something I think I
dumped it enough I commented that out I
used to like have a string and they're
just sometimes I write tests and then I
don't even believe that they work so i
have to like system out print line that
like hey i got this email it's kind of
like my testing neurosis so this kind of
thing is popular is possible and again
is like covered in a whole chapter in
the book that we have on testing
business services and a sink and showing
how to wire it all together and probably
go back and read it if you're looking to
do that kind of thing later yeah yeah
you can use a countdown latch to in a
bunch of other scenarios i use a cop
down latch which doesn't because it's
not sick like it's just countdown
latches once and done that's good i'm
glad you like looked up the javadocs and
call me how I that's all you it's
impressive there you go alright so
that's it you know acing stuff we also
say in the description for this talk
we're going to cover security and rest
and you I so we got examples for those
we're happy to show you anyone have any
specifics to where they want to begin
security protections rest web rest goes
the nice thing about the rest example is
that it also is secured it's like well
so we're starting at the end instead of
it in the bottom of course since we're
going for rest first what we have here
there's a couple of different tests
bye we're using rest assured to test or
to do the actual test in vacations what
we have is a repository is standard JP I
type of repository that is it's not the
rest of is backed by the rest repository
nice pass a repository and which
basically just have the normal get input
type of operations and in our test case
here we are again of course deploying
what we need to test which is a simple
deployment of the rest service the
backend repository and then we go
through in this specific test case where
we're trying to test the scenario of how
a user would would use the API so we're
creating a a conference we're updating a
conference or updating existing
confidence we're adding a cup a session
to a conference we're updating the
session we're deleting the session where
deleting the conference just is going to
see that the whole flow of the the the
REST API works and then of course using
the the outputted URLs like in the link
results and so on to go on to the next
step so when we create a conference we
will know that the conference instance a
URL is given by that great call when we
create the comp session we know that
this decision me the session instance
URL to using the next one so in this
rest api has built up ways to that
there's one route that tells you all the
other route services so the first thing
is to get just the ewer at the URL for
the conference as defined by the route
application which is stuff found by a
link if there's a link that has the
realm of conference then use that
conference link and assume that in the
next step i'm going to create a
conference that URL actually exists
because then the first step furnace I
jump in sure
so something I've discovered like
through the process of writing this book
is that restful design is really not
just about exposing HTTP endpoints for
your services it's a really easy kind of
hacky way to go about things mostly it's
about defining links and saying like all
right we're going to be able to have one
link at the top and when you perform an
operation upon it be able to get out a
set of links that are like you're
available actions it's about literally
walking the tree of what your next state
changes can be within this application
so the clients of a restful application
can look for a link by name and then be
able to follow it and navigate and say
let go from the home I can create a user
I can view sessions I can do any number
of things then you walk through it this
way so an ox ox laid out here from the
root is a way to like go and make sure
that you get yeah this is our contracts
to the client in place that they're
looking for links by name and they can
follow them if this test case breaks
then it may mean that like any of the
clients that are depending upon that the
restful design of that service will
break as well when you expose out your
your links in a restful api you've got
to continue to support them so they
can't just be these like standalone
links that then are used to do crud
operations on resources that's your only
half of the way there I guess right well
especially did what the next generation
rest which was basically the first
generation of rest as well which no one
actually caught on to is the hypermedia
a bit of it where you actually have the
links and following the links and that's
the only API you have and the URL itself
is not really relevant it's the link rel
that's in the response so here we're not
we're not hardcore during the test case
to actually try to find API / something
something except for our route point
which is the only exposed exposed URL
that's a API everything else goes cause
based on the links links within the
response and we're also then
we're going to create a conference so
we're going to do a simply simply pushed
within the rest assured one we're going
to put in me put the conference media
type on the as the content type of the
body that we're doing a post to post is
just a representation of our conference
type and we we assert that the status
code that we get back from the server is
created and then we do the actual post
request and we save the header location
which is where this new you new
conference exists that again is then
reused later down the test case to for
instance in this case add the sessions
so we add a session to make to a
instance of a conference and basically
that's what it just goes on doing all
the way down to trying two different
things making sure that when you delete
something then you try the URL again you
actually get that it's deleted
and currently we just do for a for what
it's yeah yeah it depends a bit someone
is it once no content if it has existed
but has been deleted so if you want to
keep keep track of it and so on but
right right yeah true so yeah we've been
trying the examples and the and the rest
interfaces for this application is
mostly based upon the the book from
O'Reilly what is called web restful web
services yeah it's trying to follow
basically that type of flow first this
is well of course can just be RAM as a
unit test yeah we pulled a lot of the
design for the restful segment from
restful Java by bill burke who
previously of the EJB container and
yelling about things fame and in fact a
lot of a lot of the chapters that we do
that we go kind of into graph databases
we go into data stores of for we do in
Fitness band as a datagrid we go into
security and for each of these we've
tried to follow whatever the leading
design patterns of the domain experts
for that particular slice have been in
Kabul enos all together so you're all
kind of familiar with java ee how many
how many of you find like java ee to be
like a smooth development experience and
it's easy and that's like a leading you
do so
you're better than it than I am I think
because all this time when I was you
know just working on ejb we're just
working on my little slices like yeah
this makes this easy i can so quickly
prototype of business mean i can so
quickly do this and then we thought to
ourselves we should maybe like take a
step back and just try and build an
application that integrates everything
together and we found that it doesn't
that easy which was why we set out to
actually do it and see what it took to
bring everything together and then maybe
write a book documenting our experiences
on how to do it as well so like not to
not pull the target the party line here
but java ee is it's comprised of a bunch
of independent specifications that are
then integrated in together and not
integrated it's kind of it yeah the
integration part is kind of difficult
it's it's never going to have maybe the
same kind of polish as a framework
that's a lot more opinionated controlled
by one body and does a smaller set of
things and isn't as extensible because
that's that's how it was designed so we
need to kind of just be aware and like
recognize the warts of the platform that
we're working with and figure out how to
kind of work around them what do we want
to see we've seen like some restful
stuff yeah
huh
seems a bit easier to start a session
start a conversation well yeah we don't
have any yeah this 36 pack the
conversation scope is bound to jsf and
we don't really have any chase after
this application sorry you're not
allowed to use it outside of it obvi
Jays have requested itself / perspex
right but kill the next an enterprise
which one well it's it's in there and it
gets in practice it gets bound into a
jsf like a view scope yeah one OV m yeah
how they resident expert Jason Porter
here from the CDI expert group got our
back oh yeah that would be and in that
case will be basically going over to the
UI a bit of it which will be doing a
client request from the client side and
invoking the HTTP request the jsf or
whatever you call them and then have a
be in there that's conversation scope
the knot and kind of jump between the
different paths we can move on to the
you are to the UI one and guys you use
jsf you're all using EE but not jsf yeah
yeah John jsf it's just we find it heavy
it's really like state heavy and
component-based and like there's a lot
of stuff it's still like it you know it
shocks me still almost to this day that
the java ee doesn't have maybe a
pluggable templating solution or
something that's a little bit more
lightweight so for this app we went the
course of doing some like playing html5
with angular and i'll see thrown
backbone and some other no just angular
just angular and widgets from bootstrap
no yeah hey blue shirt right so from the
UI perspective this is based on
sub-project overkilling called are
killing drone and n are killing graphene
which wraps the selenium drivers
you can have selenium atom firefox
chrome and so on or are also htmlunit or
phantom j/s to get the headless versions
of them so if you see in this this test
case where specifically trying to test
what happens if we're in the in the UI
form can actually see the version of it
here so if we want to add a conference
and yadda yadda yadda yadda yadda and we
want to see that we can actually handle
the exception case in the UI to get the
proper elements out there when there's
no start or end date set but those go
red basically so this happens only we
don't want to necessarily have someone
clicking through it for every version of
the application and make sure that they
get that expected response we want to
automate it right and the interesting
part here that the application itself is
written as a one page type of a jsf so
there's a lot of potentially waiting for
the Ajax requests to do their bits and
to update the page and do the rest goes
in in the background so were you seeing
we're using graphene are killing
graphene which has the feature of
creating the page objects which wraps a
lot of the page logic let's see so we're
stating at we're injecting the main page
The Maids page contains page fragments
which is basically the same as a page
object but there are recurring snippets
of a recurring snippet of HTML basically
so we said when we initiate initiate the
main page that's going to go to the URL
app of wherever we deploy the
application somewhere on that page they
might find a action links ID or a user
action links and the UI hair is roughly
mapping how the back and rest
service works so what when the rest
service returns a link to a conference
then the app knows that okay here we can
add a conference we know that we can
query for the options can be the leader
specific conference can we get a comfort
or post a conference and so on and
that's kind of mapped over in the UI
which is by the web sorry the resource
which is a kind of our main main exit
point let's see the fragments so for the
conference bit of the application we
have a form which is our input form up
here we said where'd the root element
within that page somewhere that that's
the roots so we want to find something
that's content conference in CSS a tag a
tag name of form which is of course our
form and an input component which is
another sub component of our own or a
page fragment roller which can contain
something that's an input or a CSS
something an asset that has errors so
this is just wrapping in Java API are
different UI components but then
handling it as if it was a selenium
driver that gives us a type-safe API to
deal with in in the test case itself so
the only thing we need to do or when
things start start to change this
basically we'll put when you need this
so if the action links ID changed then
you have to replace that in one place
instead of having having like this
lyneham ID generate up the tongues of
expats and whatnot you get there and
then you have to redo all those so we
say when you have gone come to the page
get at the external links does it have
wonder a link that says conference okay
good then click that conference which is
in short clicking a comforter
which is in short what we're going to do
find this link click it and then get me
the portion of that page that is the
council conference form and set name tag
line start an end to nothing ends submit
it then assert that the form now
actually has snow errors on the name tag
line name or tag line but it has input
errors on the start and end date we can
I love this because it gives you like a
type-safe way of accessing your form
elements for your UI but like in Java
and you can basically just describe it
out like hey grab this form fill in form
name add the stuff all in place and then
submit it and see what happens so Kurt
to quit we're running it already where
did you stop
that's not the big fight that's not the
right word but some women in debugging
clearly we need to work some of the UI
here for smaller screens yes so for
those who missed it like we just ran the
test case just as we did before right
clicking well you know run as J unit
selenium under the under the covers are
Killian and wrapped a selenium thing and
launched up Firefox instance which
brought up the page with the URL click
the link filled in the stuff as it is
and now we're kind of waiting because we
set a breakpoint automatically in the
right yeah and the test in the fist so
and this where we perform our assertions
right so we assert that there is no
error on the name or the tagline but
there is one on starch and an end date
ever good to go whoops good to go and
the only thing that's selenium bits hair
drawn handles starting and stopping the
selenium drivers and whichever one you
have the only configuration we have for
it except for adding the de binary's of
course is to tell it which type of
driver you want so in this case we're
saying Firefox we could have said
phantom jas which then would be the one
you potentially use on a only build
server to get a headless version of it
run that again it shouldn't pop up a
window
again
probably passed there you go No so like
in our view you know it's it's really
important to do verification you know
we're used to maybe doing some database
verification and we obviously plenty of
tests for doing that any number of ways
but to do this type of like you I
verification is amazing because you
write it out once it makes you think a
little bit about what error messages you
need and then you don't need a QA QA
person to go and click through and
validate on your own when you can
automate it and see them running would
you change it back to Firefox real quick
you know if we take out the debug
comments you'll see that like you go and
you run this test and we'll see how
quickly it is that it like pops up
Firefox and does the whole thing for you
and in a repeatable way to make sure
that no unexpected changes are going to
go break things it's all about it's all
about building things correctly the
first time and making sure that once
it's there and it's in place it stays
that way you don't have to worry about
recertifying it with every single
version you do that's what's enabling
you to do the testing is going to be
what enables you to take advantage of
the continuous deployment because it's
great to have like get push and then a
server and then it goes out live but if
you don't if your test Suites not worth
anything then you're just pushing out
stuff that's live without you got to be
able to like have faith in what's going
on there we've allow find selenium tests
allow you to abandon other forms yeah I
mean they absolutely do but you
shouldn't because you can test you know
we talk in the book about levels of
testing and at what layers you should be
doing it so we're in San Francisco and
there's probably some sort of a water
source it's like 30 miles away or
whatever and I could turn on the faucet
here and figure out whether or not it's
all working if there's water coming out
but if there's not i'm probably going to
want to know at a much finer drained
level where the problem is and if i'm
building tests as i build these layers
as I go along then when things fail I'll
be able to catch it much more quickly
it's all about fail fast right so yeah
selenium tests will be able to tell you
like
base level like hey this thing doesn't
work but then you don't know is it the
UI is it something in the business logic
is it something in the database
integration layer and you're fishing a
lot longer and of course there are
things within your application that
potentially is not controlled by
controllable from the selenium interface
itself or from your web application so
back end process coming in with males
and so on can't be necessarily tested
through the UI you need something below
to test it and sometimes it's going to
just maybe just give you a radical
behavior that you won't even be able to
figure out how to spot when I'm writing
a service without without exception I am
writing a test for that service and it's
easier at the lower levels what we're
showing you here is once you start to
integrate those together how to do it
and maybe add some other third-party
frameworks to ease it along for you like
using rest assured with the rest bits or
using the selenium stuff and the drone
extensions here for you know interacting
with the view pages so you're not just
putting in free-floating strings yeah we
know this is a lot it's like really kind
of heavy deep dive it's the first time
we've done maybe a talk like this this
is that deep in that technical again our
goal is to kind of show you the kinds of
things you can do I don't think we've
come across the case yet that we've been
unable to test or unable to build
something to test so we're really we're
really proud of that in that basically
we feel pretty confident that no matter
what you're doing there's a way of
making sure that there's an automated
repeatable test case for it and the book
details that not to say that they
couldn't be made simpler but if possible
right I mean its simplicity is aleve is
a tremendous component of that too we're
here this week we have another talk that
we're giving on that's Wednesday at
something earlier than I want it to be a
30 am-8 I don't I guess there's no way
that's true
that's it wednesday at 830am which was
1130 when i saw it approved when i was
sitting in Boston before I real did the
timezone thing I was much happier in
Boston about that but we'll do our very
best to make it worth it for you because
we'll do some more slides there a little
more theory a little more stuff like
that we're doing a book signing tomorrow
in the event hall here not here episode
at the Mary Hilton there's the
exhibition hall in the Hilton o'reilly
has a booth so we'll be there and
handing out it printed off these neat
little galley copy things oh so good was
that too many bags it printed out these
little galley copy thing so like
assigning those but it's a good chance
to like get to meet you guys and talk a
little bit and you know if you generally
see us around you know before eleven
o'clock at night I'll probably be in
some state to talk about things fairly
coherently and after then like you're at
you're here risk it the next talk name
is the ABCs of integration testing
testing the enterprise layers or
excessive integration testing it
definitely has an alphabet in it we can
put up that last slide again for people
to reference yeah all yeah related I
mean at this point we've really stopped
promoting our Killian as a tech in and
of itself and we've more started
positioning it just as a means to an end
for testing so while our Killian is like
very near and dear to our hearts it's
time that we recognize that it is just a
tool and we want to show the types of
things you should be testing educate how
you should be using it really get you
thinking more about what your end goal
is and we'll show you how to use our
Killian to achieve those in some ways
I'm sorry documentation of the test you
talk about the bid behavior-driven style
all things yeah yeah there are
integrations with her Killian for their
big elfish but he behaved has a Spock
has one JAY behave has one and the guy
to talk to about that it won't be i was
sitting right behind you okay this is a
bar toshi's joining us from poland and r
kelly and contributor and kind of a
behavior driven development fanatic so
those types of extensions don't like
don't like labels all around nice guy
and yeah there's some cute with a cute
space kook in space is that work only
yeah which is the cute cucumber kill
ensberg cuke in space i think it is
called cooking space because it's
cucumber and aliens and whatnot merged
comer and drone or cucumber now Killian
cucumber not killing it yeah yeah well
what was the question cucumber or
Killian Court is a good it goes to our
kellian which goes to drone right so you
know both extensions from me like our
Killian core you know right right so you
don't need a standalone thing drone is a
we get will uh yeah nice yeah
you guys want to see like a simple our
Killian hello world e type thing we can
start from the beginning a little bit we
can do that will dismiss the class for
those that don't need the intro stuff
and the remedial students can stay here
and we'll help you out with getting jump
started but awesome hanging out with you
guys be sure to like fill out that
whatever Oracle e how is the session
thing for you because that's how we know
what to plan for next year and if it's
working or not so cool oh thanks
apparently doesn't have a microphone
anywhere hello we basically just run
through the simplest form of K unit
integration with our Killian we're
handing we're using the J in an
extension point which is run with which
basically tells us to hand over the
execution to our Killian instead of the
normal Jamie runner so that's that and
then based on that and based on the
arquillian runner it doesn't need one
but it could use a a method that's
defined with the pipes deployment which
is aesthetic something class that
returns some form of archive while
you're right you mind if I step back a
bit step back yeah i'll give them loca
oh sure right okay you've done j unit
okay our Killian is going to be your
bridge between the j unit life cycle and
some packing container any backing
container the idea is to abstract all of
that out and make it so that your tests
that run in some sort of a container
look just like a J unit test act just
like a JUnit test and run just like any
type of the unit test but they're not so
that run with annotation is a J unit
annotation where you can provide your
own test runner our Killian is the test
runner and that's our hook into the
whole process because most containers
need some sort of a deployment to act
upon what we do is we have this
deployment mechanism
called shrink wrap and shrink wrap is an
API for defining archives but in like a
Java dsl right so you'll say hey shrink
wrap create me a new archive called my
web app bar and put this class into it
in that class into it or resolve me this
Gavin address right and put those
libraries in there and now you've got an
object that represents your deployment
instead of a flat file type of thing
this is nice because it means whenever
you run these tests from the IDE it
picks up the precompiled stuff that's
already there and you don't need to
switch in and run a full build to get
that ridiculous like finally compiled an
assembled war you can just define it
here and if you were to make a change in
any of these classes when you hit save
the IDE puts the class in the target
directory and this will pull it up right
here from the classpath right yes you
want the palm file for the arquillian
dependencies here in this one this is a
bit scattered but I wouldn't say that
this is a good thing but if I mean this
is this is for our application okay this
phone and palm files by their nature are
not the most brevity is not a strength
of the maven pom file let's say that a
little bit verbose so no but it is a
shin of the bed and the top part here is
just our own application that's just our
own different modules w pendulum protest
bit now with the evolvement and a lot of
the versions are specified in a parent
the first thing you add is the we want
to test user killian to test with j unit
so that's the dependency there and we
want to use rest assured and due to some
problems between rest assured and rest
easy you end up having to exclude that
mapper and then you add graphene and
they will webdriver and that pulsing
drone for instance and that's basically
what's in here
yeah that's the only achillion set up in
this poem though if we look at the
parents where we define some well if
you're if you're looking for like a get
started type thing our Killian org is a
website especially ashlock put a lot of
work into and has all sorts of like
quick starts and jump getting started
documentation this is admittedly a lot
more advanced than that so probably if
you're looking for that kind of
information hit up the guides button on
the top of our Killian org and there's a
getting started thing in like 20
languages and a guide for how to make
your deploy the Lark ives with shrink
wrap all this kind of stuff as well as
links into something we have called the
showcase the arquillians showcase which
is a repo that has just examples of how
to do a lot of things but but isolated
so this book is an integrated example
that shows a fully working app the
arquillians showcase is like a jax-rs
example and this exempt just standalone
stuff it's easier to consume right
basically we've a lot of the feedback we
got from the beginning was it well of
course it works in hello world example
right so okay let's prove that we can
actually use it in a full application as
well which is the book right and and we
were like of course it works in a full
application and then we had to build a
lot of stuff to make it work
and as far so back to the example or the
simplest case of it Ramadhar killian
define some kind of deployments this
this deploy doesn't mean anything it's
just a bunch of different ways of doing
it so you can add a package you can say
that the package that that class exists
in you can have that and all the sub
packages you can add single classes and
you can resolve full libraries with the
transitive dependencies and so on
through the maven and the shrink-wrap
resolver project this here is basically
saying like hey yeah from the maven
resolver like grab the palm here look
loaded all the version information we're
going to want some dependency say we
wanted to like put log4j in there then
we would say like resolve log4j log4j
and also transitive dependencies it
would go fetch all those from your like
local maven repo and put them in the lib
directory of whatever your your thing is
and the the tournament methods of the
return type of this method is basically
something that's an archive and shrink
wrap defines up so been professionally
enterprise archive job archive web
archive and resource adapter archives
and basically that's just to simplify
for you to add things seem to the
correct locations within the archive
like web beans and so on generally just
a glorified hash map and a sense they
have become say slipstream this f is
covered in our Killian org it's also
covered in chapter 3 of the book called
enabling technologies where we go
through before we start using all the
stuff we talked about how to make shrink
wrap how to make it our Killian test
case it's like an introduction to all
the players in there and that again is
also on the tin your card there's a
github repo and it's all in an ASCII doc
you can just click it and start reading
basically at this point when the test
hits were inside the container the
instance itself is inside the container
environment so anything that container
supports inject a gb
resource wealth entitymanager
transaction yeah persistence context
yadda yadda like well yeah so like we
also examples of like look if you're
doing like JP a testing you can inject
the entitymanager into your test case if
you're testing that your business
components have the correct transaction
attributes you can inject the
transaction the user transaction into
here and be able to like you know set
roll a only or commit them and have
control over that anything that's
injectable from the container will be
injectable into your test case because
it runs inside the container but again
looks kind of just like a standard j
unit test case that's kind of like what
we aim to achieve with our Killian and
that is the 4-minute explanation of what
was once an hour and a half long talk I
hope you all have enjoyed your time come
find us if we can make anything more
clear or you know anything else is be
great to meet everyone enjoy the
conference</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>