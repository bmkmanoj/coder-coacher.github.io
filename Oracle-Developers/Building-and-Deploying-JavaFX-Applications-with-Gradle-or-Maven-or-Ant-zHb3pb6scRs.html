<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building and Deploying JavaFX Applications with Gradle or Maven (or Ant!) | Coder Coacher - Coaching Coders</title><meta content="Building and Deploying JavaFX Applications with Gradle or Maven (or Ant!) - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building and Deploying JavaFX Applications with Gradle or Maven (or Ant!)</b></h2><h5 class="post__date">2015-06-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/zHb3pb6scRs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so I could welcome you to this morning's
session building and deploying native
JavaFX applications with Gradle maven or
ant and I did some looking over on the
conference materials and this appears to
be the only session we're talking about
the JavaFX packager directly so even
though I intended to talk mostly about
native I'll do a little bit of hand
waving over the the web start stuff
which is kind of important for some of
you as I understand it first I'd like to
point out some other sessions that are
going on later on in the conference that
are of note integrating JavaFX with
native technologies is going to be after
this in plasm 1 which is next door
talking about how to any write some of
your native if you're going to build a
native application there's a good chance
of doing because you need native
integration with some of the stuff the
native application I'm going to refer to
through most of the talk you can
download the code from bitbucket along
with a presentation source there's a
hands-on lab about java code signing and
deployment now while you don't need to
do that for your native applications you
will need to do that for your web start
applications and if you're on an applet
in 2014 I've heard that they're gonna
require code signing for every applet
that you would run on a on a Oracle VM
don't forget to call out your session
surveys last year I had response rates
and the single digit percentages that's
because they don't have someone's back
the room with a piece of paper asking
you to fill it out so please go on the
line and fill it out and the last
sessions JavaFX tools of the trade by
andre so i'll marry tomorrow at one
o'clock in this room you can talk about
all of the other sorts of tool chain
tools you could use in your job FX
applications more than just building
native applications ok so like I said
I'm going to try spend as much time as
possible in the native India in the
package as in the code as I can but
first I need to talk a little bit let's
get this a little closer with my code is
first we need to talk a little bit about
well first we're gonna talk a bit about
what needs to be done to build a native
application but first little bit about
me I'm a Tomcat and an emeritus
committer I don't think I have any code
left in Tomcat and I think I have two
lines left in ants i co-founded Griffon
with
honors all married and James and
Williams and I also like to play with
Legos officially I say it's for my kids
but we all know how that goes
so really the the moral the story is I
like building things I like taking
things from pieces putting them together
and say wow isn't that neat
you know the whole is greater than the
sum of the parts and I think that's part
of what you're going to discover from
building these native applications just
that little extra bit to give a native
icon on the desktop for the end user
there's going to do wonders to change
your perception on what your application
is even though all you've done is you've
changed a little bit of how you package
and distribute it so one of the key
things about anything is a real artist
ship and this is about the art seus
looking ship I could find but when
people say ship usually mean deliver and
that usually means a different kind of
ship a delivery ship that's that's kind
of ugly but functional but most of us
never ever have to touch a delivery ship
like this even though we may be sending
huge amounts of information across
country across the seas you know we
deliver things all the time without
seeing the build infrastructure the
reason is packaging if we put our things
in the box the proper way and we put the
proper labels on the box someone else
solves all the difficult problems and
does all the heavy lifting and that's
what's happened with the JavaFX packager
and they've taken some interesting bits
and pieces about how you build things on
on Linux and Macintosh and Windows and
some of the esoteric eccentricity is
about how you deploy native applications
as long as platforms they are acting it
away and with the build tools I'm going
to talk about it's been abstracted away
even more so that all you have to do is
just get your pieces together and put
them in the Box in the proper place put
a label on them take it to the FedEx
office and it's done and it's all done
for you so like I mentioned what what
can the JavaFX package or make it right
now it makes about six different kinds
of bundles the first one for Windows it
makes an executable installer based off
of Ino setup and an MSI installer based
off the Wix toolkit and anyone who is a
Windows system administrator is gonna
love the MSI because that's having them
remotely montt manage most of their
installers for Macintosh you have a dmg
which is their hard drive disk image
which is the drag to the apps folder to
install and the dot a PP applique
and file image itself which is actually
a directory but it looks and acts like a
file for their application and then
finally for Linux on packages of course
the two major distribution formats for
Linux the Debian and the RPM format you
know that depends whether you're a Red
Hat or whether you're a Debian fan or
what supports rpms are more useful
inside of stuff like sent OS and Red Hat
Enterprise and new Debian is getting
getting more open source from the Debian
crowd so one important thing about these
applications is they're all
self-contained by default they're all
going to bring their own java virtual
machine with them and why is this
important because it insulates you from
a lot of the problems of a system VM is
that the right version doesn't have the
right security baseline if you work in
air gapped networks where the network
has an air gap you know there's some
very strict controls about the type of
software they're gonna let in and if you
isolate it and bring your own java
runtime environment you solve a lot of
those problems
something interesting coming up in J and
JDK 8 in the draft jsr they happen I bet
they have a provision to allow you to
quote-unquote strip the JDK which allows
you to go through the RT jar and all the
other things and take out the things
that you don't need and it's permissible
under the provision of the draft JDK to
ship it out without swinging corporate
or XSLT kind of make your own compact
profile they also have provided them in
JDK a regular old compact profiles that
that that do most of the stripping for
you and are inter tested and better this
is my old slide anyway you can also
configure your system the application to
use the system JRE if desired that'll
save you anywhere from 10 to 50
megabytes in your package and some
organizations require you to use the
system tarry with your native bundle so
that is an option yeah in an older
version of this slide I had I also
mention the compact profiles you can
specify which JRE which JRE version and
in JDK 8 the compact profiles are a big
deal for controlling the size now I'm
going to show four approaches of how you
would want to build your application I'm
going to start off with a command line
and that's mostly the familiar
with the tasks that need to be done to
on to create a native application then
I'm going to show how this is going to
be automated with aunt answers the build
tool automation that ships out of the
JDK today and tasks seem to be the lingo
francais of a build tool integration
everyone speaks aunts even though they
might speak other plug-in languages they
can always use an ant task so it's
really useful then I'm gonna show the
maven integration and put together by
Daniels of elinsky from from Down Under
I think he's in Australia it's not at
the conference today I don't believe and
then I'm gonna show Gradle integration
which is a plugin that I've written for
the Gradle system so the moral of story
is if you use a build system that has a
IDE support it is supported by the
JavaFX packager through either a native
or a third-party plug-in so you don't
have to use the command line tools so
before you run your installers no matter
which build tool you use you are going
to need to do a little bit of
preparation like I mentioned for Windows
it uses the inno setup and it uses the
wicks toolkit if you're going to be
creating one of those on your Windows
system you need to install those and put
those in your path it's not a difficult
thing to do I have zero familiarity with
the inno setup and Wix and I was able to
do it just by installing and pointing it
at the bin directory for Linux you'll
need to make sure you have your RPM
build installed or your debian package
installed and if it's the native
packaging system for your distribution
it's not too hard to put on but if
you're taking Debian and trying to
install an RPM builder or vice versa it
gets a little tricky but it can be done
but if you're building on Linux you're
probably familiar with these issues so
it shouldn't be too hard now I don't
think you need to do anything special
for Mac I've had X put on here for so
long it just worked I don't know if it
needs Xcode or not the docs don't say it
needs Xcode but if you're developing
software on a Macintosh you should
probably just install Xcode anyway
because it has lots of neat and useful
tools let's talk about the command-line
tools briefly now for this sum this
project that I made in let's close the
change window I made a little sample
project from the controls FX project to
take their sample code and bundle it
into something that can be launched via
native installer so that so the
usability isn't just you know go
download the code
run so they can just download something
and see how it works out having to
install all that all the accoutrement
surround it and I've done it via the git
branches in four different formats right
now I have the bash version then we're
going to be showing the ant Gradle and
maven versions so when you check out the
code from from bitbucket look and see
how it's done in the different
approaches just be sure to switch your
get branches and get the latest get head
on those so as far as building with a
bash file the preparations for getting a
command-line tool set up is you just
need to install the JDK and you need to
put the JDK bin in your class path and
then you're going to have the JavaFX
packager tool in your class path now
like any command-line tools well I'm a
slide head like any command-line tools
there's lots of command-line switches
and there's four general modes that you
run this in and then a fifth mega mode -
all it does everything you would need to
do for it but I'm only going to talk
about the four main modes now what do
you need to build the JavaFX package or
what do you what items do you need well
obviously you're going to need all of
your class files you're also going to
need all the library jars that you are
using in this and if you're doing with
bash your aunt's you're gonna have to
provide them yourself you can't rely on
the build tool to provide it for you
even if you're using ivy you're gonna
have to get some sort of a file set to
point to these library files you're also
going to need all of your other
resources if you have native dll's
you're going to need to bring them in if
you have large media files you're going
to need to bring them in and also
metadata relating to your package what
do you want to call it who's the vendor
what's the copyright statement
there's flags to put a lot of these
these options in so let's go to the
native the bash build and look at some
of this you know this is just a simple
command line find all the source files
compile it copy over the resources
create a list of samples now this is in
here sometimes you might need to do some
custom strange processing and for the
the controls FX the controls FX they
they need a list of which samples to
actually run they do that dynamically so
I extract that by running a little grep
script you know bash is wonderful for
these scripts and you can do all sorts
of things like that but everything up
until this point is
is nothing to do the JavaFX packager and
once you get to this point of line we're
going to see some of things we do with
JavaFX packager there's four things you
can do
first you can compile our CSS into a
binary representation which gets you
some runtime speed you can create the
JavaFX jar and java access that the
JavaFX does some different things with
the jar as far as launching your
application then you can sign the
journey again JavaFX has an alternative
way to sign the jar that is much quicker
than the current sign jar and then you
would would deploy it into your
deployment package and you would do all
four of those right there so creepy SS
BSS or binary CSS files and they take
the precompilation the CSS which can be
somewhat CPU intensive depending upon
your rules
and puts it in a format the CSS engine
can just load and go quickly with this
is optional it requires build tool
integrations just probably why a lot of
people don't do it but with the JavaFX
package or it is built in automatically
you also need a reference 8 BSS file in
your code rather than a CSS file the
next step is create jar and why does
Java FX have a special jar format they
don't really have a special jar format
and as much as they do some of the heavy
lifting for you to get a Java FX
application to run by default they load
a custom launcher and allows you to do
things like adding a preloader while
your extensive loading is done and as
the classpath manifest entries of all
the other jars that you mentioned and it
adds those into the manifest of it you
can also add launch arguments and system
properties via the set up of the of the
the custom JavaFX jar let's look at some
of the arguments here getting specify
the main class and as I'm going over
this if you have any questions just feel
free to raise your hand I'll do my best
to answer them some of these some parts
of these code I know better than others
particularly I know Gradle a lot more
than any of the other bits of code here
bear ab cat class where you're getting
your source files where you're getting
your app files where you're writing it
to whether or not to do the CSS to bin
as part of the jar but your class path
is and what other possible manifests
attributes to go in there and this is
kind of important for doing things like
applet and web start deployment when you
create your jars starting with Java
update 40 you're gonna have to start
adding a permissions attribute and
signing it and that's just some of the
things that they have to do to keep Java
applets secure to keep from it's it's
it's absolutely necessary to keep it
secure to make sure that they can
identify who which which jars are valid
and which ones are just trolling you and
trying to cause problems again you can
specify the preloader additional
properties arguments manifest attributes
you can disable the embedded launcher if
you want to but that's that's fraught
with peril if you're doing it to JavaFX
way if you're doing it your own way and
creating your own jar you can skip that
step runtime version of source files so
the next task would be to sign the jar
and what JavaFX has been able to do is
they've created their own signing
mechanism where rather than signing each
class file individually they take the
whole jar as a whole and they give one
binary signature for it
the downside is well probably the upside
is you do any changes to the jar you
have to resign the entire jar now note
the capital J and the dash this is the
only one of the arguments that has a
capital camelcase letter inside of it
despite all the other ones having
multiple words and another word of
warning is to use a real certificate I
here coming in 2014 that the security
team is going to consider a self-signed
jar to be the same as an unsigned jar
anyone can create a self-signed jar it
takes just a little bit more to get a
real certificate and that little bit is
going to do a lot to solve a lot of
these security issues that they've been
having the final step is to call -
deploy and this is where the real magic
of the JavaFX packager happens it's
going to take all these pieces together
in a platform specific way spit out a
platform specific native bundle and also
through this you can spit out web star
configurations although I haven't spent
a lot of time on my talk on this because
I'm not familiar with the issues
surrounding Web Start it's something
that they've been working on I know
there's a lot of customers out there
that still use Web Start and still find
value in it and this addresses most of
it most the problems related to caching
and signing of the jar so let's go
through the code and look what what's
of things that you'd need to do to get a
very minimal at least packaging most of
these flags relate to the metadata of
the packaged application itself and
whether you can do hello controls FX you
know the vendor descriptions what's the
main class and this one tells what kind
of installers to make you can actually
limit it to make one of the installers
on the list that I showed you but here
we're going to make all of the
installers you know where to put it when
we're done what's the name of the odd
file where the source so let's go ahead
and try this clear build it's going to
go ahead okay - we're going to go ahead
and build this with the bash script and
see what our results are
and here's the dmg it creates this file
that you drag over install so what it
created us and build deploy bundles and
these these these Installer show up in
for the bash it well wherever you tell
this show up and I told her to put on a
tower build deploy in the bundles
directory so here the the files that you
would need to use for a web start
deployment there's no way to turn those
off currently when you do the deployer
you always get Web Start information and
part of the reason there's a lot of that
as used to actually build native
bundlers they depend upon some of this
directory layout but here we get a
native dmg file it's gonna go ahead and
open and verify and as we can see it's
got the nice little icon that I provided
for it on the desk and we just drag it
to applications and here we have a
native application that launches
controls FX this is where the preloader
would be handy so here we have a nice
native application complete with fancy
macintosh things like a name in the menu
bar that is something other than plain
old java an icon in the dock launcher
and you can do these you can make you
can make your application do these
without using packager but the JavaFX
packager does all these magic things for
you similarly when you run it on Windows
it's going to create all the necessary
ICO files for you well you might need to
provide the ICO file yourself they'll
put in the right place for the MSI
installer and for the executable now
while we're at it let's look at the file
layouts of the app and I remember we're
gonna do actually going to show you the
windows file layout because it's a bit
more interesting
let's go to my photos these are not the
photos that I had what's new photos
guess my sharknado snow globe is a
better photo so here's the directory
layout of a window so this is probably a
better one to show rather than showing
the can I get a full screen on this
where's the full screen button there we
go touchy touchy there we go so this
shows what what a typical Windows layout
for this this application of the Mac is
very Mac --is-- um you'd recognize if
you see it but for Windows
it creates four entries in the main
directory of it creates an app that
contains all your app data creates a
runtime which is the Java Runtime and
then it creates an executable in an icon
with the icon integrated into it I just
built this on the surface it's just
because of Av problems it's it's harder
to demo it with the way I have things
set up now one of the things you'll
notice is interesting about the runtime
you go into the bin directory is that
there are no executable files
it actually strips out all the xes from
the runtime when it creates a windows
even crates windows installer and i
think this is worth noting because it's
a great way to keep it's it's it's a
small simple step to reduce the security
exposure of these native apps because if
you were to put the native runtime in
there and you had java exe and it
happened to be a version that had some
incompatible that had some security hole
if they found that job and exe through
some other trojan they could exploit it
however the only executable that is
created in here sorry I'm making fun of
hands as in English they're the only way
to run it is via the the the exe that we
set up here that starts up to JVM with
adjust your class install so that's one
of the small things they do on Windows
to make this work and they do a similar
thing on the Linux installer and that
there is no native executable for Java
Exe and the GRE on Macintosh so they can
they have an easier time packaging it
there
if there is a some Java native interface
API is that you can say start up a java
virtual machine
here's your main class here's your
arguments who do system properties and
it creates that execute only just runs
it inside of the executable so as a
native program it starts up JVM in
process in in this exe yeah so it does
that for you
yeah the JVM DL elves are all inside the
runtime so you still have all the dll's
you need in runtime and that's also
worth noting if you need a package
native dll's right now the support isn't
very good so the one trick that I found
works is to create your own runtime
distribution and put your native DLLs in
the JRE directory and point your build
tool to use that JRE and that's the most
successful way I've found to get actual
native dll's inside of your application
hopefully they'll be able to fix it in
the future but you know with JDK 8
freezing there's not much they can do on
it right now
you know deadlines are deadlines is what
they are
now another step you can do is you can
override some of the native resources
that is used to build some of it some
some of the key things are like the
desktop icon the background image for
the dmg installer some of the install
scripts and the package metadata pretty
much if it's a resource that is being
used during the in during the creation
of the native bundles there is a way to
override it if you don't like the
defaults that are given by by the JavaFX
packager and the way that you figure out
what these native overrides are and
figure out which ones it's using is to
pass it in the dash of V flag when you
run it or turn verbose equals true on in
one of your build tools and it'll spit
out more data than you would know what
to do with about what's going on but you
can find out when and where it's loading
which resources and it even will keep
the resources for you in the temporary
directory so you can inspect them and
modify them if you need to so from from
seeing the batch file you might ask well
why use a build tool it all just works
you know this is a typical build tool
advocacy thing you get finer grained
control of your of your bill better IDE
support better continuous integration
and it's easier to maintain with a build
tool you can use bash the tools are
there but my recommendation is to use a
build tool if you can't use anything
other than ants use ants although I
personally recommend either maven or
Gradle I think they provide a higher
level but ant is easier to get into many
different organizations so what are you
gain by ants there's actually some
things that you gain from ant that you
don't have in the command line tools you
can specify a different JDK to package I
was mentioning that a little bit earlier
about how you could bring your own JRE
you cannot do that with the command line
tools right now they don't have the
switch but if you use ant may even our
Gradle integration you can specify a
different Jerry or JDK to run you get a
little bit more installer metadata you
get some platform specific identifiers
and you get some a little bit more
metadata that you can bring into the
Installer so let me go ahead and bring
up my C kit to check out you know do
some little bit of hand waving on the
code here to show you how you would use
the ant so to install the plugin you
need to do a couple things if you've
done ant tasks a custom ant tasks you're
probably familiar with these
need to find a custom namespace and in
this case it's xmlns effects equals big
long stream that's magical then the next
thing you need to do is you needed to
find the task desc
let me make the font bigger so it's
easier to read there's a resource you
specify I wouldn't recommend writing
this down I'd recommend going to the
docks of copying and pasting it there's
a URI you would use and then there's a
class path you specify the class left
when you of where you get to int JavaFX
jar and this is actually in the jdk jdk
ext Lib directory it's it does it's not
load automatically you have to put it
there there's one little quirk here is
that I put the dot the current directory
in there and that is because when it
loads the native overrides such as your
custom installer image your custom
installer scripts it loads it from the
class path in ant of what you specify
for the task so you need to put the
directory that those live in and since I
put these in package Mac os10
hello they pull an update for this
because I thought I put Windows icons in
here too anyway that's just show up
shortly but if you want to use the ICN s
the native icon files you need to
specify let's put the package in the
directory here we go
and the window is hello control FX ICL
and for the ant you have to provide the
native ICO icns or PNG in the case of
Linux for your custom icon so there's a
couple of metadata elements that they
define before they do the actual tasks
in ants they have an application
metadata element where you specify the
name in the main class you don't have to
specify it in five different places in
the code resources you can specify our
resources and those are the two ones
that are used across multiple tasks so
here we have the same CSS two bin tasks
rather than a command-line switch is a
separate ant task FX jar looks a lot
like a regular old jar task the
differences you can specify an
application and a resources elements
that you defined earlier to put off some
of your metadata in there now this jar
itself is a file set and it takes file
sets of which classes you want to do it
also references resources which are your
other third party
jars it does not actually put these
third-party jars in the same jar the
reason it means that resources elements
is so it can create the classpath
manifest entry for a jar so it'll
reference the other class path
attributes
that's just used as metadata and you can
specify again this is it's good practice
when you get at the mana that manifests
to put in your implementation code there
I left in some key signing code in here
to generate a useless key that you can
do a self signed jar with to sign jar
there's some some parameters to specify
the key storing the alias and you know
it's never a good idea to put passwords
in a build script so don't do it the
next the last step is of course the FX
deploy task and this is where all the
magic happens again we reference the
application and the resources element
there's also a couple more elements in
here that provide more metadata the
platform element specifies useful things
like the JVM arguments the JavaFX
property and I think you can specify the
the Java Runtime right here with the FX
platform if you want to specify a
different runtime you would specify it
in the platform element the info
provides you know more metadata and the
preferences this is something that you
gain and from ant maven and build you
can tell it whether to install it
system-wide or local you can tell it
whether to put it in the Start menu from
the Installer you can tell it whether or
not to create a desktop shortcut now
realize that not all of the installers
use this information Macintosh does not
have a system Start menu or a
applications menu so it's going to
ignore the the menu option and if you
say install locally it's going to stall
it to the desktop instead of the
Applications folder on Mac so these
little little idiosyncrasies are
abstracted away from you so that you can
just just grab and go with your
information yes
installers a service right now they
don't have a bundle that doesn't windows
service I think that is an awesome idea
if you go to the JavaFX JIRA you could
probably put a feature request in there
because I think this is a perfect tool
to put windows services in I think this
is a great Avenue to you know create
your Tomcat services and all that you
know set up and Wix probably do have
existing scripts that would show you how
to do that so you can override your in a
setup script to create a window service
I'd have to look look you know look some
of those up but you can customize the
script to do these service installations
in the in o setup you can add more
complex installs company I used to work
with used to have an optional you know
50 gigabyte blu-ray drive of map data
you could install and you could
customize that in there as well any
other questions yes
it's the exact same the jdk from seven
and update ten and later comes with
JavaFX and whether you shipping with
java java 7 or java 8 the embedded
launcher is smart enough to figure out
where GFX RT is so that's that's one of
the advantages of using the Java FX jar
the Java FX way is it's gonna figure out
all these little platform changes for
you yes that's what's wonderful about
this it can be any application um it was
written for FX applications um you'll
have to turn off the embedded launcher
and you might have to manage your own
class path on that I think if you
specify an application that's a main I
know if you use Java FX if you use if
you ship with Java 8 it'll handle it
nicer if you just pass in a main class
rather than a Java FX application but
it'll just start the main class in the
main method for you
I'm coming up I think in the future it
might already be fixed in update 40 I
know one point you had to go through
contortions if you're using a main class
but I think that's been fixed yeah this
this is this is more than just Java FX I
think you know there it could it could
be used to install it in a general Java
and starless solution if necessary so
you could just put it in a box and ship
it and install it doesn't work for large
enterprise apps gazelles require strange
custom multi server installs and
configuration for SES anyway this might
help them in there you never know okay
so let's go ahead and give this a run as
you can see it's
ah can't clean too many different build
systems on my mind
so this looks a lot like the Bosch bill
that's using most of the same steps
there's a lot of steps come on in here
we get again coming up the whole bill
thing that's one of the things about
Mack is you always get this dmg coming
up front because use a quill script to
automate it and we get the same bundles
901 because I told it to do there isn't
okay native bundles is the attribute I
should call out
it provides a Nance and the other build
scripts and all options where you can
tell it just to do everything not just
the installers not just the images but
all of them at once so let's go through
the slides and see what things I forgot
resources just has to been FX jar got
all those native bundle remember to call
that out where you're gonna put it info
yeah these are the the various magic
strings that you can pass into the
native bundle element image will just
create the let's go back one oops image
will just create the the directory based
image for Windows and Linux you'll
create the dot app bundle on Mac OS 10
the installer you'd pass in one of these
six values if you want to just create
one because I could totally believe that
on Windows you might have you know setup
and wick setup and you just want to
create the MSI on some occasions and you
can also put in the magic value of any
which will build all of these ones above
it'll try and build anything now if you
if you try and build a Windows or Linux
you don't have you know Debian or or the
Wix toolkit installed the FX package
you're smart enough to do a little bit
of sanity checking its gonna look for
the files try and execute them and if it
fails to find like you know light and
candle for Wix if it fails to find those
it's just going to quietly continue on
without it and build without them it'll
illa mention that in the output file
that you know in the verbose file that I
couldn't find the Wix toolkit so I'm not
going to build it but it's not going to
blow up your build if you don't have all
the right pieces in there it's going to
build everything that it possibly can
and go on as quickly and reasonably as
possible
so any questions about ant let's go on
into maven about half hour this is not
where I wanted to start going into these
these so of course I need to start this
off with a little bit of advocacy why
would you want to use maven over ant
mavens not my favorite build tool but I
like it better than ant and the two big
reasons why I like maven over ants is
the standard file tree conventions you
can use conventions other than the
standard file tree but it is really
difficult to do that it is much easier
to just conform to the conventions that
they've set and so it's an opinionated
framework could believe some things to
go there and even though I don't like
the file tree I like that there is a
standard file tree and I consider that
more important than have my own personal
preferences the second big thing about
maven is the repository based
third-party jars is the dependency
management the notion of the dependency
is that they put in the pom file it's
where you can take your results push it
up to repository and use it in some
other file without having to copy the
jars and store it in your bill directory
it is a much more sane and rational way
to build larger applications and it
provides big dividends for the
integration for maven there are entire
things that you don't need to worry
about when doing a maven or a Gradle
build of a JavaFX application that you
would need to worry about if you used an
ant or a command line variant so let me
get to check out Nathan now one of the
first things you're going to notice is
that the the file tree layout changes
dramatically everything goes in the
source main this is source main deploy
package Mac os10
Java resources the the job and resources
files are separated into two different
directories and the deployment goes
under source main deploy package by
convention that's where you need to put
these items and I guess I need that to
update again
and the see this is old legacy Antico
that we're seeing here so everything you
had and delete this we're never going to
see this again so it's a nice clean
setup for permanent the only thing
that's actually checked in a source code
is pom in the source tree so it's
obvious what a source and what is what
its destination if you look in the pom
file it provides more of a declarative
look at what it is you're building no
tract branches oh well we'll just live
without the windows icons if we had the
windows icons they would be under a
windows directory with the ICO here I
just don't have my get set up properly
so there's a lot of metadata that is
used in here already when building the
the native installer we already have the
the name of it what version it is we're
installing in the organization of your
of your app and and and Daniel when he
wrote this he just tried to use as much
the existing metadata as possible
because you really have a lot of it
there so here's how you would install
the Java FX plugin for maven you would
build a build sections you do plugins
and plug-in and you would just install
his comms in Java Java FX - maven -
plugin there's the artefact ID and the
current version is 2.0 and that's all
you need to do and then you need to
provide some some configuration
information that you would have seen in
the ant build script at the command line
and that's all of it except for the
dependencies we depend on controls FX
there is no no declarative tasks that
this is how you jar it this is how you
sign it a lunch a lot of the other
burden has gone away in the declarative
say this is what it is go build it so
let's see I feel like I'm forgetting
something so I wrote slides arc types
that is a huge game that you get out of
maven that is right now unique to maven
Griffin does ARP types as well but I
didn't get Griffin into this talk
Griffin does they still have the native
package or stuff in there that I put in
okay
Griffin supports native packaging - on
that
I'm gonna show up in the JavaFX tools
talk tomorrow but you get art type
support if you just do a job FX
archetype and use the maven archetype
support it's going to create a file tree
with all of the default files and
settings that you're going to need
automatically for you it also
automatically includes your third-party
jars for you if you reference a
third-party jar that is used at runtime
it's going to do all the math and all
the calculations for you to include it
in your packaging bundle you don't have
to do any extra steps of copying local
libraries I mean and also what's cool
about third-party jars is if there is
transitive dependencies it goes down and
grabs everything that it might ever need
that's related to that so you don't have
to manage a lot of third-party jars
brought in by accident
again here's how you would install it if
you're using the maven plugin for Java
effects - there is a special step you
have to run first maven does not like
where they put the JFX our jar so
there's a little bit that you run jfx
colon fixed at classpath if you're
running Java 8 you don't need to worry
about this because they put the JFX RT
jar where you would expect to find it so
that's just a little word of warning
when you install this you might need to
do that step again we went over the file
structure I'm the only addition to the
standard maven layout is source main
resources sorry source main deploy
package boy it was late at night when I
wrote that slide the pom configuration
so let's go over some of the pom
elements that are in here take down
version control of this to the side so
you have a lot of leash you look
familiar from the app plugin there they
do basically all the same thing specify
what your main class is what the vendor
is what the bundle type you'd bundle
what the identifier for hello controls
affects the JVM arguments you would use
the properties there's one little thing
in here that is special and this is
really to accommodate Windows Wix
demands that your java version be in a
particular format and so they let you
change that based on your it only allows
three dots for Wix because that's a
Windows specific thing so it lets you
change it there in case you have all
sorts of crazy versioning information
and you're in your
in your you know one OH - snapshot it
doesn't like the desk that wicks does
not like some of the maven isms like -
snapshot and the other things that go on
there
and again your key store aliases for
doing all of your signing so the next
thing that we need to look at is the
goals
unlike ant what tasks you can Ron maven
is not always immediately obvious the
big one that you're going to want to use
is jfx colon native this creates the
native executables this is the goal you
will want to run to create your native
installable x' there is another one gfx
run where you can actually run your
application from inside the build tool
and this is really nice for IDE
integration because a lot of ideas
integrate specific goals that you can
attach to your hotkey shortcuts to do
everything that you need to do there's a
couple of other goals that are kind of
unique GFX Jarrah creates the fat jar
and the JFX web creates a jnlp packaging
format for it they split out the web
innate of daniel did in this results
show up in yeah i didn't up running off
an old cached version of this AV
problems got me early in the morning um
so the results will show up in target
MVN GFX native now even as it is a
peculiar thing where all of its
directories are in all of its build
results go in the target directory
there's going to be a deploy a GFX
native bundles here's where it all shows
up it's all going to show up right in
here when it finishes building it so the
target was in GFX native bundles and
just like every other build system you
know this just magically works we have
another instance of it's a mic dock icon
the same toolbar integration it's all
the same code just built a different way
so if you want to do maven there's just
another plugin you got to install and
configure a little bit of metadata you
know put your files in the right place
put the label on it and give it to the
FedEx office and they're going to ship
it for you and make an installable
package for you so any questions about
maven so so the same thing was there
some more caveats about maven the JFX
fix plug in a fixed class path can
sometimes break your jdk so i would
recommend using the java 8 and also it
doesn't work with the current maven 3
100 on there still some things going on
with it yes in the back yeah you can fix
class path moves it but if you copy it
instead there isn't there's some chatter
on the mailing list about this this is a
Java conference and make the future Java
so my recommendation is use Java x8 you
won't want to go back so in the meantime
you may not have that option so there
are some things you'd want to do but
once JavaFX 8 ships my recommendation is
to go there as soon as possible and
stick with it because that's where all
the major development that's going but
it can be fixed in Java FX 2 on JDK 7 if
you need to fix that any other questions
Packaging type for this I said told it
to use all bundle type you mean
packaging type I think is jar yeah it
still jar we don't override the existing
goals I mean we'll still create a jar a
compilation from that in fact I think it
uses the jar goal to create its GFX
native I think the JFX native exists
after the jar goal so if you were to
upload this it's not going to upload the
native binaries to the repository you
could probably do some more
configuration to take those and upload
it as a classified version to the
repository but I'm not a I'm not a maven
expert on that Daniel little Winsky is
that is the best person to talk to about
that unfortunately he's not at the
conference today alright so let's go
ahead and talk about Gradle now the good
news is person who wrote the Gradle
plug-in is here today I actually wrote
it there we go so we'll just do a hard
for switch to this and I personally like
Radle it in my opinion that Gradle is
the best parts of maven and ant one
exception Gradle doesn't have archetype
support yet that is probably the biggest
lacking of Gradle right now and that's
something they're working on it's my
understanding but it takes the default
it defaults to using the Maven directory
layout it it uses the built-in
integration it uses the maven
repositories to pull and push you can
configure it to do both at the same time
you can do customizable build logic and
you in it's all written in groovy so
there's there some parts of a build
process where you need to do things you
know in an imperative fashion I need to
do a I need to do B and I need to do C
and at the same time there's parts we
need to do it in a declarative fashion
when you clean you do this when you
compile you do this when you package you
do this and I'll let you figure out
which ones you need to do and the groovy
DSL written around Gradle lets you do
both of those both imperative and
declarative logic at the same time
so why use Gradle JavaFX plug-in um
it's as far as using Gradle if you're
ready using maven you don't have to
switch you can give just about
everything you need with maven but if
you're looking to switch I would
encourage you to do so both of them work
fine I think Gradle works better but I
don't think the differences are so
extreme that you need a drop maven but
given a choice on equal grounds I would
still use Gradle it allows the plug-in
however it goes an extra mile in that a
go it allows you to create custom icons
just from the PNG file it'll create the
icns for you it'll create the ICO and
the integration of the complex task
logic is available in the plug-in so
there's a couple of things that great
lads above and beyond what the main and
an ant's integration would be so there's
two things that maven has better than
Gradle one of them is archetype support
and the other one is standardized
plug-in support because the way there's
two ways that you can install the maven
degrade the JavaFX plug-in into Gradle
and I'm actually going to talk to hands
about this today during the open
conference time the what you can do is
you can install from a URL and it's URL
points to a Gradle script on bin tray
that's going to install the pieces of
the java plug-in for you so that's one
way to do it the other way to do it is
to take the contents of this plug-in and
install it into your build script and of
course it doesn't show up show and
finder I need to
but you can see I've done the sixth time
shows that I do this a lot thinking you
can just download and get the text it's
like I think I'm an Internet Explorer or
something I am just not having a good
time today open with there we go so this
is the build script that that is going
to add job FX to it and this is why I
don't recommend that you type it in by
hand that you just copy it from the
distribution but basically we install
these these jars put it in the build
class path and apply the plug-in so it's
it's kind of clunky which is why my
preferred mechanism pitches in work here
yeah so you can see it's there's a lot
of it looked better at normal font size
and you saw that's the details so that's
why I recommend that you do the URL
install downside is you always have to
do online builds but that's generally
not a problem for a lot of developers if
it is a problem copy that file somewhere
and reference that file so that's how
you install the plug-in now the Gradle
file conventions are differ from the
maven conventions in two ways number one
it builds into a bill directory instead
of a target directory and number two I
change the location of the package
overrides if they go in source deploy
package and you don't have to supply the
icns files or the ICO files you just
provide a plain old PNG of the image
that you want and it will do all of the
calculations on the in the build process
to create a necessary shortcut and
volume icon for you but other than that
it looks smells and acts a lot like a
maven build so let's talk a little bit
about the icon conventions and go into
some of the extensions you can specify
the shortcut the volume in this setup
the shortcut is the icon you see in the
general launchers the things you
double-click on the volume is a Mac
specific thing that is the picture of
the Mac of volume and the setup is a
window specific thing
there are a couple of icons in the setup
that can be overridden and if you don't
by the default is gonna be the gray Java
icon that gets in your way there so
specify you specify what kind you want
the sizes in a possible retina doubler
Macintosh is happy with 632 128 256 and
512 I don't know why they don't like 64
by 64 bit icons but they don't and if
you do with that at X 2 you need to
double the size of it it'll use it for
retina displays and all this is
completely transparent to Macintosh and
Windows so you don't need to worry about
that because I got Mac Mac into Windows
and Linux Macintosh is the one that
really cares about this just let me show
you another more involved so here's you
know how you would set 256 this is how
you would set up the icons for multiple
icons for a resizable icon and it'll
create the icns file for you at runtime
from these pngs now you still have the
ability if you have the icns and the ICO
file to just drop them in their usual
places and just put them right in there
so you can get these icons so here is so
fun stuff I was doing with Retina
displays looks different on retinas
versus
you can still also specify your icons in
the build script so let's go over the
Gradle build script here quickly so that
here's here's all some Gradle isms you
specify which repositories you're using
here we specify our third-party
dependency in the colon formatted
approach they specify our group in our
version now here's a custom build logic
idea to create the samples text file and
we can just put this in here as part of
the process resources step I don't
actually do this step in maven because I
don't know which
Mojo's to invoke and which lifecycle
things so I punch it on that one and
here in a JavaFX block ignoring the
profiles block for a bit which I'll talk
about a little bit later we again have
all the same metadata properties that
you would in that you would configure in
the various different places and I try
to keep the names as consistent across
all three of these build systems as
possible so if you have to switch it's
not a foreign concept look at what these
various values are so here if we were
configuring our icons inside the build
script here as we would let you do it
now the one thing that I added another
thing that I added in the in the Gradle
build script is the notion of profiles
and the reason I added this is because
there's a couple of properties that mean
different things on different platforms
the ID on a Windows platform needs to be
a globally unique identifier it's a big
128-bit hash that has special meaning
inside of Windows it's unique in some
cases and random in others the other the
other end in in Mac there are special
rules about how it kind of looks like a
package name the other thing that is
different is the category Mac and Linux
have specific sets of limited category
names that you should be using
whereas in Windows a category basically
corresponds to a group in your Start
menu or your Start screen windows is
very freeform in that and Macintosh and
Linux are a bit more constrained and
restricted as to which categories you
can use so that creates a problem when
you want to use the same build script
across three different platforms so this
profiles mechanism is a way that I
allowed you to to override values for
the various three major platforms that
you would run it on and as a bonus you
can specify a different Java run
on each different platform you know
obviously what Mac's not going to put
their Java Runtime and C colon program
files I type that into the command line
you're gonna get weird stuff so you can
specify those on the different machines
configuring metadata the two screens the
native profiles now there's three main
tasks that you're going to want to worry
about in Gradle the the one to actually
build the native bundles is the assemble
task this is going to do all the
declarative logic to figure out what
needs to be built to put it together and
it's gonna wind up dropping everything
into Gradle clean install assemble and
it's gonna wind up dropping all these
into build distributions bundles and
again there's to run tasks so you can
run in debug run runs everything in
place from the build directory including
all of your all of your third-party jars
and debug does the same thing except it
starts it up with the JPA JPD a debugger
set up to listen to another port and to
stop it so with the build tool you can
actually debug your application in there
as well and have it come up and stop and
wait for you now there's a whole bunch
of other tasks that if you do a tasks
option it's gonna tell you that some of
the stuff that it does you can look
inside the box and see all the
interesting things but generally
speaking you're not going to use any of
these tasks there's one exception scenic
view double-click the scenic view task
right now scenic view is um really it's
awaiting a solidification of Java 8 it's
using a bunch of private API to do some
really interesting things if Jonathan
Giles was here he would probably have
had a session on scenic view because
it's a really neat tool and the Gradle
build plug-in uses some of that to
actually launch your application in the
scenic view so you can do all sorts of
interesting debugging visual debugging
work on your application
however we're waiting for Java 8 to
finalize so we know which private API is
we're not going to blow up
so that doesn't work right now
when it does work again it's gonna be
put into the bill tool if you use an
older preview release of Java eight it
actually works
so it's you know it's a problem of
living on the edge so those are the four
ways you might want to build a native
bundle that should fit into whatever
your build process is any questions yes
so the question was how do you handle
32-bit versus 64-bit Java and the way
that I would handle that is I would
specify the Java Runtime to package it
with there was the I don't know if you
could create two different if you're
gonna create a 32 and a 64-bit installer
you'd probably need to set some flag on
your build script to change that value
depending upon which version you're
gonna run but try remember if I
hard-coded profiles I think there is a
way in the Grail script that you can
specify non-standard profiles by default
the Gradle build script so what you
might do is you might create a Windows
and then a Windows 64 then you would
just run the installer twice we run the
build script twice and you would just
turn on the windows 64 profile and
that's some of the stuff in this talk
with hands doctor about right now I'd do
my own handwritten thing but the Android
Gradle build script is introducing build
flavors and build types so that is
something that I'm looking at in future
versions of the Gradle plug-in to allow
for just that situation to say well I
want a 64 and a 32 and not only that I
want them both built on the same pass so
that's some of the things that they're
working on with the Android build script
I think is really awesome it's just not
ready yet
for consumption outside of Android so
yeah III hear your pain in my
recommendation would be to UM
unfortunately run the bill twice with
different Java runtimes yes
the question was is it possible to build
Windows on Mac that's an excellent
question and right now the answer is no
Windows has some specific windows
compiler tools that it uses I it the
substitution it might be possible but I
think I don't think it is because I to
replace the icon it's a native Windows
application that they run as part of the
bundle process and that's generally a
problem with all of these if you're
gonna build a Linux installer right now
you have to build it on Linux same goes
with Mac and that's never gonna change
if you're gonna build a Mac you're gonna
have to build it on a Mac that's that's
just a general problem with the builds
and same with Windows the same goes with
raspberry pi if you want to build a
Raspberry Pi then you're gonna have to
load the JDK on your Raspberry Pi that's
I think that is solvable but it's not
going to ship with the Java 8 that's
going to come out in March so I think it
would be possible to cross compile on
Linux but I don't think he can cross
compile across
I don't think cross compiling across OS
platforms is gonna be a possibility
there's just too many native bits to
worry about sorry about that
the question is does it always bundle
the JDK and the answer is you can tell
it to not bundle the JDK you just passed
in an empty string into the in this case
the Java Runtime and for the Gradle yeah
for all three of them Gradle maven an
ant
if you pass in an empty string into the
Java Runtime it won't bundle the JDK or
the GRE and I will try and use the
system JRE and it's got some logic to
fail if you can't find it
the question is in build.gradle where do
I reference you know setup or Wix and
the answer for actually all three of
these build systems is you don't
reference it in the build tool you set
it in your system path so you would set
an environmental variable and add your
path to it so it's always there that's
you know just just the nature of doing
native builds is the native tools have
to be in the native path and I know it
can create problems with some of the
continuous integration build servers but
I think some of those even have ways to
add stuff to your persistent environment
before you run it yes
the question is can you rename the
default file layout from like app and
runtime not in the current release I
would like I have patch code in that I
don't know if it's gonna make it in the
JavaFX 8 that will allow you to create
your own bundlers and you could do your
own custom thing you could extend the
existing bundler and change it so I
think there are ways in the works to do
that if that is an absolute requirement
but it's just easier to let it bundle it
the way it wants to right now but I
think that can be changed but just not
in the first release yes controls FX yes
it is okay right yeah that's something
I'm gonna fix the question was the the
Gradle build currently fails and that's
because it hasn't been pushed up to any
maven repository this is my last talk to
the conference so I'm gonna have great
time ago in a hacker garden and fix
these sort of things this is my plan
going in to just work like crazy to get
the presentation running and then to
make sure that the demo because the demo
code that's gonna be in in the in in
bitbucket it's gonna be kind of a living
example of how to do all these three
different things so I want to fix these
things if you find any of these bugs out
there let me know post a bug I want to
get this thing continually working and
that's specifically one that I'm going
to fix so also the slider that I have in
there it won't compile if you try and
get the present because I don't have a
couple other controls checked into the
bin tray repositories yet so that's
something I'm gonna look into fixing
the question is can I contrast this with
the Oracle app bundler for ants and the
answer is I cannot contrast it because
I've never used that bundler I haven't
worked in hardcore Oracle shops the the
the shops have broke I've worked in have
been build your own back in the early
part of the 2000s in the later part of
the 2000 were pretty much an Apache
stack so I really don't have that much
exposure to the app but my plugin for
ants probably the one thing I could say
is not about the app bundler but it's
about build system integration is that
you're gonna encounter problems with
third-party libraries that may even in
Gradle will manage for you that you
still have to manage your hand so that's
you know it's true you can call it
unique can even call it for me there's a
maven an plugin that's right but I never
touched it so I really couldn't say
anything intelligent about it
okay we're over time so thank you all
for coming I know it was early in the
morning to talk about really deep issues</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>