<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Keeping Your APIs Honest | Coder Coacher - Coaching Coders</title><meta content="Keeping Your APIs Honest - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Keeping Your APIs Honest</b></h2><h5 class="post__date">2018-02-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/VRWOmmVXsHM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">being put together are going to be HTTP
API is using the HTTP protocol in the
JSON serialization again you know come
back here in a couple of years three
years we're gonna be probably talking
about something else but that's what we
see mostly today so I want ask the
question here who in the room identifies
as a front-end developer okay one
back-end developer all right a few more
that there's gonna be things in here
about both so don't don't despair it's
not just about the backend so my
background is in building API so I've
been doing that for the past ten years
or so and in the last three years or
four years I've been building tools
around the API so all of the stuff that
I needed to get my job done that that
didn't exist I kind of got into that and
um have been doing AM API tooling for
the last few years so keeping your API
is honest what happens if you don't keep
your API is honest and what does that
mean well it means what would happen if
your API eyes don't meet the
expectations that are being said so
probably what would happen is maybe your
mobile apps are gonna stop working maybe
users are not going to get the data or
the the current data that they're
looking for
they're probably going to get upset
because people expect things to work
today and if this is some kind of
integration projects or some kind of
partnership or other type of high
visibility project that you're doing you
might run the risk of a project failure
because you had this some big project
that the CEO announced and then the API
stops working and of course who gets
blamed the developers get played right
the API is known work front-end folks as
well as back-end folks so it's a good
idea to do meet those expectations some
for your API and here's how to do it so
I think the first thing you need to do
is to have a basis for what the
expectation should be and that should be
an API specification in the old days we
used to write outs our API
specifications in the documents in free
prose and that document used to be open
to interpretation well what do you mean
you want the customer data there and
what should the field be and you know
what should the error be well the past
three years we have dedicated
domain-specific languages for describing
how an API should behave and here are
some of them like API blueprint or
swagger or open API spec now these
languages allow us to describe with
precision how the API should behave and
because the they allow that that
precision in there we can bring both the
backend and the front-end developers to
collaborate on the specification and
each of them can bring in what their
expectation is and they can agree on
that expectation and and because this is
a language they can say okay we're going
to shake hands on it and this is going
to be a source of truth for the API
going forward so you can base the
implementation or the building of the
API on it you can base um any
deployments that you do on that or even
you know learn about the the consumption
of the API from that specification you
can also use the specification for
testing because even though it's it's a
format that's human readable and and
human write a book so people can
collaborate on it it is also machine
readable so if it's describing the API
with precision and it's machine readable
you can use it as a basis for your tests
and again a few years ago when I was
developing API I used to have to write
the tests by hand
in those days I used to use mocha and
and in JavaScript and I would write all
those tests and it you would have this
repeating para-power patterns all over
and over again and it would take time
and it wouldn't be maintainable every
time I had to go in and and just kind of
do the tests all over again so if your
spec describes that API behavior you can
use that for interface testing you can
use that to run your tests and because
it's it's text or code you can check it
in in version control with the same code
that implements it in the same branch so
you can say hey here's what you do in
the spec here's what should implement it
check them in together and once you do
that great thing happens you can almost
kind of imagine this tool that takes the
spec as inputs for a particular version
of your API and you could possibly point
it to the implementation of the API to a
URL and in something magic in between
should be able to take that as input and
then give you a pass/fail if you were to
have that then you could do test-driven
development on the desktop so you could
develop very rapidly and feel kind of
safe about the changes you're making and
feel that you're making progress you
could use this tool in continuous
integration so anytime you refactor you
would kind of stay within the same
parameters and if you're a front-end
person you can also use such a tool to
make sure that the backend folks are
doing what you agreed on so you can have
some some easy way to test based on the
spec that hopefully you collaborate levy
agreed on you could you could have that
there so and how many of you are today
use continuous integration here just
wanna check okay all right any folks
okay so there's that tool exists today
well yes it does that tool is called
dread it's a free open-source tool it's
a test runner it takes the spec as input
as we showed in the in the previous
slide and it also takes a URL and just
looks at the spec figures out what the
API should do and just invokes all those
API calls they're build some
expectations
and sees if those expectations are myths
or have failed
it's a command-line tool so you can
build it in very easily in in continuous
integration or again use it on the
desktop for TDD it it will give you the
pass/fail basically via exit codes so
success would be a zero so you can build
it into scripts you can build it into
anything else you want it also has
outputs
that's human readable that I'll show you
briefly and it supports a couple of
major spec formats out there such as API
blueprint and swagger 2.0 with a few
more coming if you want to take a look
at that there's a repo out on github you
can contribute to it it's it's been
there for a while more than two thousand
stars almost sixty contributors and it's
a pretty much your tool so you can go
use that right away so you can check
that URL but if you google you know
github dread it's gonna come up first
result it's really easy to to install
it's a JavaScript application so you can
just go my npm install read fairly easy
if you have JavaScript there and it's
also pretty easy to start using it to
get you started it has this easy
configuration you can type dread in it
they ask you a series of questions like
you know where is your API spec what
should I use to go run the API and a few
other options and sets up a
configuration file a gamma file for you
that he uses over and over again so you
can do that ma that's easy to get
started I'm gonna show you a different
way how to do it so let me jump into if
I can try to okay here's what I'm gonna
do
oh yay now what I need to do really is
get out of powerpoints so I can actually
see what I'm doing because this is gonna
mess me up get back into PowerPoint and
the show there we go all right so and
I'm gonna make this bigger so you can
see it so here's an example of an API
specification in this case it's a
swagger 2.0 spec it's a simple Yambol
document that has certain paths certain
parts that a parser for the spec
recognizes are specific to the API so
for example you see line 9 you see it
has the host that means okay well where
does the API live he has a bass bass
bass bass it's it's the root of that
host it tells you that it produces or
consumes Jason and then we get into the
resources so it has a resource called
seats this is an API that we wrote for a
chatbot demo it was supposed to sell
seats for a sports game and them then
you could buy beer and and so on so
here's a resource called seats it
supports the get method so you're kind
of getting the collection of available
seats and it gives you a response code
at 200 which means okay so it says if
things are okay you should be seeing the
following and then it describes what the
data should be coming back there's a
bunch of ways to model data here one of
the things we're doing is we're giving
an example of what the data should look
like and examples are really really
useful especially when you're doing this
collaboration between different people
so you can say hey this is what the data
will look like does that look okay for
you so it's just a collection of all of
these seats and the other thing I've
I created a small JavaScript application
note application that it's a very dumb
API but it returns that collection of
seats so what I'm going to do is I'm
going to take the spec gonna run the
application and then test it out see
what happens
aha there's gonna be some problems and
I'm gonna fix them and show you how you
can get that passing result so we go to
the CLI and okay so I can always do
dreads help and it'll give me a bunch of
options of how to use dread there's a
lot of the things there including these
are pre and post hoops for setup and
teardown for your tests ways to pass in
headers or authentication and so on so
there's a bunch of things you could do
but that it's simplest what you can do
is you can pass two parameters in one is
the not sure if you can see that bottom
line there but it's it's passing in the
spec the gamma spec as the first
parameter and the second parameter is
the URL where the API lives so I'm just
gonna go around that and it's gonna come
up and it's gonna wake up the server
which lives on Heroku and takes a little
while it's going to attempt to interpret
the spec and invoke the API calls that
it thinks it should and compare with
what the expected output should be in
this case I have two failures and I've
turned on the verbose reporting here but
just to cut to the chase you're going to
see that I'm missing a required property
it needs a JSON key called available and
it's also missing another required
property called a row
it's the row where the seat is and if I
scroll down I also have a resource that
it didn't find at all so I'm gonna get a
404
here saying hey I tried this resource
couldn't find it at all
so just to save you the suspense there
there are some errors in my in my
implementation so you remember it
expected this Macky name called
available I did available flag by
mistake it's gonna fix that and then I
somehow company doubts this row it was a
required parameter so it needs to be
there so it's gonna complain to me if I
if I don't have it there so fix that and
then the next thing I screwed up is when
I was setting up the resources it
expected this resource called beers get
me the collection of available beers
that I can buy but I did singular beer
so all these are kind of mistakes that
you can do while my implementing in
there they're kind of difficult to see
especially in a complex implementation
so I'm gonna go and fix that and I guess
I have to go deploy real quick all right
fix all the things and okay so now since
I'm pushed to my repo I can just call
redeploy real quick
see that
and I see
okay so now my changes are going to be
deployed and hopefully we can get the
right result so I promised you that
there's an exit code that you can read
so this is the way you can look at it in
the in the shell you can go dollar
question mark and that's your exit code
of one that means that it was a failed
test the previous thing that we ran was
a failed test I'm gonna go run it again
okay that's it so I'm running and now
tests are passing and if I look at my
exit code it's gonna be a zero so kind
of easy to understand when it's passing
gives you an exit code of zero you can
say you know I'm gonna deploy to this
environment I'm gonna continue with the
build
it's safe for me to consume the API and
and so on so dogs if you want to look at
the if you want to look at the
documentation this is your URL you'll
find ways to kind of exercise all of the
options in there you can also find the
same URL from the repo in github and I
did say that you know we do have also a
an online product so this was the
command-line free open-source tool we
also have an online product it's all
about designing in reading the test from
the api's this was a recent acquisition
by Oracle we came in as a start-up about
a year ago and just want to talk about
what we're doing with the Oracle API
platform we're members of the cloud
native computing foundation members of
the open API initiative API blueprint
spec is open sourced and in the public
and we have a sauce platform were
325,000 developers they've created more
than 400,000 api designs or on the
platform and it's being consumed by more
than three million eight
consumers and and this is a platform
with tools for the entire API lifecycle
so when I talk about lifecycle we're
gonna use that API spec that we talked
about earlier and I showed you to do the
design and prototyping to help us build
the API implement the API and test it
well we're building its publish its
deploy it and probably test it again and
then monitor its so we can figure out
what people are doing with the API and
then feed it back into the next design
iteration you can go register today for
free on a period OTO
and there you'll find an editor specific
to these domain-specific languages or
formats for AP is you'll find a way to
generate prototypes from the API
specification a way to generate
documentation from that very same API
specification so you can see how that
API spec that you're agreed on with all
the developers is becoming the center
and the source of truth for them yeah
you can display your test results from
red that we showed back into the
application so people can go look at
that you can of course sync to github we
said that this is this is code this
should live in the same place as your
API implementation so you can get
automatic sync to github including
branching and and for larger themes we
also have limping of API style guides so
you can have a consistent base of api's
in your portfolio you can say hey you
know we said all our resources like the
mistake we made earlier are going to be
pluralized you can make sure that
happens at the design stage or that you
know casing or lexicons that you're
using
perhaps you're using a particular
industry lexicon or a particular
language you want to stay consistent
with that and of course we also
integrate with the runtime aspect was
which is automatic but more importantly
the parts that are highlighted are free
to use forever so you can go register
online on the Paleo tile use all the
stuff for free use them for your
or some bread tooling so that's about it
and all of the codes that I showed you
the including the specifications
including the little nodejs app is on a
repo I'll send out the slides a tweet
out the slides you can go take a look at
that and with that I think I want to
thank you and awesome that you guys are
staying here till the end you must be
really interested in api's to be staying
here this late and I can answer any
questions that you have yes sir</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>