<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to Program JavaScript in Java | Coder Coacher - Coaching Coders</title><meta content="How to Program JavaScript in Java - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to Program JavaScript in Java</b></h2><h5 class="post__date">2015-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/FcVy0HHp3kU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">good morning thanks for waking up so
early was it easy to wake up
no I would say for the European guys it
was very easy because they wake up at 4
a.m. all of them yeah actually that
happened to me I was so nervous about
the presentation so I couldn't sleep
was it the jetlag of course so my name
is Yaroslav Clark and I work for Oracle
on the NetBeans project this is Tony
Apple independent consultant doing
consultancy on NetBeans Java FX and now
also Duke script he is basically the
inventor of Duke script name so we are
here to do a demo but the demo is real
basically if you have good connection to
Internet you can follow us do the same
thing immediately because the technology
is ready so they are not this is not
just a demo where this is a technology
that you can really use take your photos
I wait so the agenda should basically be
a bit of talking followed by a cool demo
and then also another bit of talking and
then another demo and so on so on but we
actually are not completely sure what to
show so in case you are interested in
something just shout at us and we will
try to answer question or somehow adjust
the demos to suit your needs so first of
all probably a few questions do you code
in Java
anyone codes in Java ok anyone codes
JavaScript
Oh both is it client-side JavaScript
whoo
server side one two okay so actually
yeah we are going to be focused on
client-side Java and JavaScript we also
have some support for server-side
basically there is project avatar KS
which NetBeans which basically brings
the node.js libraries and programming
model into java virtual machine and
NetBeans can debug that quite easily and
intermix Java and and JavaScript code so
on a stack half of your stack is
JavaScript half of it is Java we will
demonstrate that what not but not just
for a few seconds I guess so it's our
great a great pleasure to announce that
we were awarded by Dukes Choice Award
so dukes grid is now officially
recognized pinning technology yeah we
can we can call it an award winning
technology that's nice that that helps
and yeah we also have a great support
from the Java Vaughn man number one
Stefan team who was so nice to agree
with this quote
so now let me speak about motivation why
we started to develop this technology
basically when joy was created 19 years
ago it was meant as a client-side
technology for small devices for running
in televisions maybe phones but well by
some accident Java ended up as the
server-side technology right now
basically of half made a lot of content
in Java one is Java EE its server-side
and that's about eating a lot of memory
scaling handling a lot of requests and
so on but it's not it's no longer the
client-side technology which would fit
everywhere today it seems that there is
a different language you would choose if
you want your code to run everywhere
which language would you choose
JavaScript exactly but well for me
javascript is just another assembler
language it's fine to generate
JavaScript but I think in JavaScript
well that's only for really their people
I would much rather code in Java and get
back the same portability because
otherwise we well we will end up like
COBOL because the new generation is
refusing to learn Java the new
generation of programmers just sticks
with what's this most convenient which
is JavaScript these days or some other
languages but Java is not attractive
enough for them the in spite it's a
really good technology that that has
nineteen years of history behind it and
is rock-solid
so I believe that one critical part to
this is that Java is not available in
browser and it's really hard to write
once and deploy anywhere so that's what
the Duke script tries to fix my demo
usually starts by showing you the most
productive ID on the planet and and it's
not I don't say it because that means is
basically my fault but because of this
little icon
it's a minesweeper game and this
minesweeper game is written in Java but
renders the UI is written in HTML so
basically that's the grow of the
technology of the Duke script technology
basically be able to write application
logic in Java and then show it bind it
to an HTML page so you can play the game
which is actually what I do when I have
a long-running belt I was click the icon
and play it and wait till the build is
over so by the way this is an
implementation of minesweeper that is
actually a little bit different from the
minesweeper that you probably know
because it's fair it's typically when
you when you start playing minesweeper
you want to win the game very fast so
you start clicking clicking clicking
until really a lot of fields open up but
this game really is fair in that if
there is a field that is definitely a
bomb and you should know it and you
click another field it will put a bomb
there like this so you cannot you cannot
cheat basically and on the other way
it's also fair because if there is no
field that is where you can really
decide what it is
then it will remove a bump even if it's
there because he it would not be fair to
let you click on an on a bump by chance
so I really like this game it's it's an
improvement over the original actually
when I was studying my university this
was one of the tasks for the students to
create 590 but so I impossible able to
handle it back then so I said okay now
now I alder I can try once again okay
okay but that's not what we wanted to
demonstrate rather we wanted to show you
this version of the game which is the
same game just running in a browser it
looks the same it feels the same you can
play it and again this is completely
Java written code no JavaScript in the
9c per application and rendered through
HTML and in addition to that we also
have a dalvik Android version dalvik is
the virtual machine for Android so if
you have if you are a happy owner of
Android phone you can seek for our fair
mind super on the Google Play and
install it and we also have a version
for iOS so you can seek for a fair
minesweeper as well if you have iPhone
or iPad okay what's next
so basically we think that the nuke
script technology has only benefits and
no drawbacks of course and actually Juke
script itself to somehow differentiate
screen is the name for the whole
ecosystem yeah right but in its core we
have a technology which is developed by
NetBeans it we call it HTML / Java API
and you can feel that this is not strong
marketing claim this is the technology
name the marketing is done by Tony his
inventions we have to have a name that
you can refer to other than HTML Java
API is because that's not really
something that distinguishes a team up
so actually why Dukes good to me it's
tradition for the naming the idea for
the name was because JavaScript
originally has is its name because Java
was very popular in the browser back
then it was the first time that you can
could actually do some dynamic
stuff in the browser with the applets so
everybody was there was a really really
a hype around Java as client-side
technology in the browser and so the
guys called their language also
JavaScript to be part of that hype
basically but JavaScript actually has no
Java in it
so it's basically a lie so we decided to
call this technology dip script because
it puts the Duke representing Java into
JavaScript some people think that Euclid
is another language which is like
problems problem I got a lot of pitting
for the name as well so basically no we
don't want to invent new language the
opposite is true he wanted to reduce
Java as it is to be a replacement for
JavaScript and also if you don't want to
build any new UI UI toolkit we rather
want to intact
existing JavaScript libraries because
there is a lot of them and they are
quite useful and sometimes it it seems
to me that the innovation in last two
years on the client-side has mostly
shifted to JavaScript there was a period
of time when every week there was new
JavaScript library allowance doing
something really cool and animated and
well it looks like that the Java
community does not have power to compete
with this mass innovation on the
JavaScript side so but even we have Java
affects the amount of new libraries for
Java FX is not as growing as the amount
of libraries for html5 and JavaScript so
you just want to piggyback on that and
create an easy way how you can integrate
these html5 libraries and use them in
Java and actually by doing that we think
we will get Java back to its roots we
will be able to write Vance display
anywhere run anywhere and we believe we
will have a language which is much more
usable than JavaScript and has much
better tooling because by being a type
language we can offer code completion in
the IDs and if we fix the IDs to also
support HTML or a relatively well we can
have really good tooling platform of
course in order to have Java everywhere
we need a runtime we need to be able to
run the Java code anywhere on iOS
Android and browsers so here is
description how how we do it so we need
to run the Java code anywhere and we
need to display HTML anywhere so first
case is when we are deploying to Andrew
it then well there is
dalek virtual machine which can
understand Java it's using different
bytecode but well it can it can run Java
quite well and over the time since
Android was announced people got used to
the differences between between Java on
desktop I mean the Oracle hotspot of
Java and Java on Android actually I
would bet that when Android was
announced and it first introduced not
many Java libraries around on Android
because well they could be using some
misc
something or doing some wild things
elsewhere but over time libraries adjust
you basically fix your library code to
be able to run on even smaller
environment not only on the only one
that you use so far I mean hot spot on
desktop so so this is something that I
basically would like to see happening
also the Duke script because I'm not
claiming you can take any library out
there and run it everywhere but if you
start from the templates that we go show
and you grow your application with
portability in mind you can certainly
write Java code which runs anywhere so
now on Android there is that view
component so we are using that to
display the HTML and then it was just
about writing a bridge bridge between to
Java and the review component and when I
say just I overestimate a little because
it tooks me many sleepless nights to do
it because the communication that
Android webview is a synchronous
so if you can run JavaScript you can
send JavaScript to the webview but it
runs later and well this is
hard to debug have to simulate and hard
to find a working model because for us
we would rather see a synchronous call
calls mostly when we call from Java to
JavaScript would that do it we would
like to do it in synchronous matter and
it really was hard on Android especially
when it got to recursion for example
computing factorial when the
multiplication is done in JavaScript and
the recursive call in Java so so on
stack you have Java Java JavaScript Java
JavaScript Java and this JavaScript runs
a synchronously
you need to simulate that it actually
works synchronously that was a bit of
pain over after a few nights I was able
to compute factorial of 2 and after next
2 and after next 2 weeks I was able to
complete the factorial of 5 and more so
I mentioned that we can deploy to iOS so
yes we can do it there is a common
shared knowledge that Java cannot run on
iOS but it's not completely true what is
what cannot run on iOS or what is
forbidden is a dynamic code generation
all the code that runs on iOS needs to
be signed so basically hotspot cannot
generate new code but there is a fix to
it just link all your code statically
and thanks I'd like to thank to robotium
guys and actually I was surprised that
Robo VM was mentioned at Java keynote as
its alternative VM that makes sense
because I really liked it I think it
makes sense and actually what it does it
takes bytecode of your application and
converts it into
LLVM assembler which is also used by
objective-c
as under process
since the LLVM file is generated is
basically shared with objective-c so
that means you are basically generating
the same native application you would
generate if you code in Objective C just
you don't have to do it in Objective C
you can do it in a real language so
that's a benefit well actually I have
you heard that Apple launched a new
language Swift yeah why they do it
probably they feel that people cannot
code in Objective C probably they feel
that they should mimic the Java
semantics to attract Java developers
because coding Objective C is really
different
okay so what the Robo VM does is I'm
generating the bytecode but then of
course well I always say that writing a
virtual machine is easy the only problem
is to get the necessary libraries so you
can actually run some java code on it
and the Robo bean guys solved it by one
clever decision they reuse Android
runtime libraries so Java util java.lang
Java muttered math Java IO it's all
taken from Android which has great
benefit because it guarantees
compatibility yesterday Nick was turning
we had a talk above at the evening
comparing various virtual machines so he
said that one of the problems in using
the Android libraries was portability
between linux and freebsd because iOS is
basically built on freebsd which both
are supposed to be POSIX compliant so
those they are supposed to be the same
systems and they have the same api's but
the behavior is sometimes different and
he said that especially in the area of
network communication the behavior was
different but they fixed all these
differences so but otherwise
I think that job was greatly simplified
by reusing the Android libraries
moreover what the Robo BM guys do is to
basically create the Java records for
every I guess almost every specific iOS
API so there is a visit in iOS which can
display HTML it's UI that view and the
robotium guys created a java wrapper for
this visit for me so basically I when I
wanted to instantiate this widget and
show the UI HTML UI in it I could use
Java and stick to Java again it required
few tricks but this was much more
simplified because the execution of
JavaScript in the iOS web view is
synchronous so factorial computed almost
immediately the last thing to the puzzle
is running Java in browsers both major
browsers Firefox and Chrome try really
hard to burn plug-ins claiming that they
are basically security holes well given
the last year's Java reputation I don't
I'm not surprised but the basic problem
there is not that Java is unsecure the
basic or more unsecured and Chrome
browser
I think the exploits can be find in both
Java and in chrome the the thing that
motivates the browser renders to plugins
is that they don't have controls on them
they don't have control on their
security updates and so on while they
control the security of their own
browser so it sort of makes sense but
then of course if you have browser
without
without plugin then the only thing that
you can run is Chaves script and as i
mentioned well nobody wants to write
JavaScript it's assembly assembly of our
time so there are there are projects
which are trying to replace JavaScript
with something else
typescript dart or awesome ideas from
Firefox which allows you to write in C
and compile into JavaScript so basically
when I saw these efforts I said to
myself ok why not write a virtual
machine for Java that would basically
translate into JavaScript so you could
take Java class files the bytecode and
translate it into JavaScript so back to
browser VM is my pet project which I
work on for last two years and evenings
and I'm basically capable to generate
ahead of time or just in time I mean
just in time in a browser so you can
really load class files in a browser and
translate that into JavaScript I can
generate a JavaScript and execute the
bytecode in browser which has no plugins
the code that I'm generating is heavily
optimized for v8 but should run in all
modern browsers I know it runs in
Firefox I know it even runs on my iPad
so it turns in Safari and the generated
JavaScript is good enough to execute
relatively quickly even in limited
device like iPad but yesterday I found
it out that it does not work on Internet
Explorer I probably need to install
Windows and do some more testing of
course for Duke script we need two
components in it the java virtual
machine in this case it's back to
browser virtual machine and a way to
display HTML and HTML is for free
because we are in browser so that works
quite well and what I needed to do or as
I said
the it's not hard to write a Java
Virtual Machine the problem is the
libraries so I was also for a while
considering to take the Android
libraries but then I realized that I'm
Oracle employee so I decided to take the
open JDK libraries so right now
I support JDK 7 subset of JDK 7 api's
and my goal is not to execute any Java
code but execute enough of Java to help
you do UI control the UI do some
validation logic on the client and
communicate with the server so that's
that satisfied but everything that works
in the back to browser VM should work
the same as in hotspot VM I have a lot
of tests to guarantee that the behavior
is the same so if you find the
difference you can report me aback and
either fix it it's usually trivial to
backport something from the from JDK or
fix something but back to browser VM is
not the only VM out there who is trying
to target JavaScript that is before I
started my back to browser VM I did
research and I found doppio and when I
finally was able to execute and I found
also a few other virtual machines and
after I was able to actually execute
some Java code in back to browser which
was something like half a year or I
don't know three months I checked again
and find it out that most of the Java
items are completely dead that nobody is
maintaining them except doppio so trippy
doppio is alive
it does it does something but isn't it
does not integrate with the Duke script
they somehow III tell them to do it
I even offered a help but they are so so
academic they don't care about real
products but there is other
called TVM which is written by andre and
f who contacted me and actually I
managed to convince to provide support
for Duke's crib so the same application
that I demonstrated before the fair
minesweeper if I change this to DVM it's
basically running in his VM this is all
the version of the application so it
doesn't have too fancy UI but otherwise
it behaves the same so it again
basically shows that the Duke script is
really portable if you have a virtual
machine you can make it run so I guess I
promised only short introduction so I
guess it's time for a demo so Tony it's
your turn ok so I don't know do you do
we have anything on do as well in this
no not at first because if you want to
get started there are basically two ways
you can start with the real project
everything that we do is maven based so
you can use IntelliJ IDEA even Eclipse
if you know how to configure it and and
which plugins you need for maven but
what you can also do is you can go to
the browser and let me see yeah and go
to this website here and what we have
here is a website that is actually a
Duke script application that is running
with the back to browser virtual machine
and I need to choose a sample what do I
know I'll use the spinning Duke and here
you can see okay
increase the size is it possible yeah
Oh or at least at least like this it's
adjusted to to the screen resolution now
I see on the html5 go yeah so what you
have is basically you have an HTML page
and
in this HTML page you've got well
whatever your web designer basically
does and you have Java code and the Java
code is basically the business logic
that is going to be executed and you can
see it here it has good completion it
even has code completion in here so you
can you can try out samples in the
browser and you don't need to install
anything if I run out of your box so if
you have the internet connection strong
enough you can connect to the Jew site
and play with it and if you have you can
do it you can basically do it right now
and when I run the application it will
it will really compile inside the
browser and execute the application
inside the browser and if you create if
you manipulate the the example you can
even save it to get up it's just like as
the guys who are doing JavaScript
probably know chase federal who knows
chase fiddle it's basically our version
of chase fiddle so you can now execute
the application and really try it out so
you can share your samples with this so
this is one way of basically doing it
and yeah sometimes people ask whether
back to browser VM is capable to execute
some complex Java code so this example
basically execute Java Java compiler in
the browser on your own your client in
the back to browser VM and Java compiler
is sort of complex so it shows it can
execute something okay so but another
way or the best way to doing it the most
comfortable way is to use NetBeans and
in NetBeans there is a plug-in that you
can get from the plug-in portal so if
you install NetBeans you can go to the
available plugins and look for Java HTML
project support sorry for the resolution
it's it's the it's a projector so it's
Java HTML project support and if you
install that plug-in you will have some
new project types like just short intro
you can also install the minesweeper
that
get really productive okay but I suggest
you may start also with this html5 with
java application logic I'm going to read
it to you because I cannot zoom out here
let's zoom in here and then you will be
guided through through a wizard and this
wizard is actually itself written in
nuke script so Duke script also
integrates with technologies like swing
or Java FX so you can embed it in your
existing applications and enrich them so
for example if you need something like
we maybe we showed an example later like
a map component or something like that
you just take and accept an existing
JavaScript library and integrate it into
your swing much of FX application and
you have these components available so
from here you can go to the
documentation it's Java API Talk that
you would get there but it's really good
it's really very concise and it has a
lot of examples and even some examples
running in the API dock which is
basically the the only API dog that I
know that runs Java or includes Java
well actually maybe you can go that
because there is the minesweeper game as
well I decided that I will enrich the
documentation by a game so you can play
it by reading the documentation okay
so let's step through the wizard and in
every step you will learn something
about we educate basically about Duke
scripts let me call it demo probably two
three four and give it a package name
that's the maven coordinates basically
that you because you create your maven
project and there are a couple of
templates that you can use and actually
this will automatically update as there
are new temp there will be new templates
available the last one has been added
like a couple of days before that's
controls jeaious we talk about that
later I think this
today it was added yesterday and but the
most basic one is is it's probably the
best to start with HTML and java basic
template so by default we have the
Chamath X based version application
version installed because that is the
one that is executed in hot spot in the
regular JVM so it has the best support
for debugging and testing the
application though this is this is
available by default if you want to test
and debug the application you need that
so that's why we don't allow you to
disable it so then if you decide to
deploy to Android you need the SDK I
don't have it here on this machine if
you want to deploy to iOS you know I
could do that nice if you want to deploy
to a browser you just check this box and
if you want to deploy as an app that
doesn't work actually in my example so I
yeah nobody wants to deploy tonight and
in the end what you will get is an
application and you will have a custom
menu here that will invoke some maven
goals and run in the respective platform
so let's create this project and what
you will get is a website just like in
the do example and some Java code okay
so right now I'll just run the
application to prove that it's working
so you can now start some animation stop
the animation show dialogues Oh jianci
it back yeah
this is Ibaka in JDK 8 we reported it
and it should be fixed in some next
update of dedicated but you can also
deepak this application so the first
thing you can do is you have this Dom
inspector here so you can walk through
the Dom elements it's just like you know
it from these Chrome or Firefox tools
fire back or whatever and you can also
inspect the Styles I think this the dips
here have some Styles assigned some CSS
Styles so you can probably see something
in the in the span when I start rotating
and I switch back here to the span you
can see now the span rotate class is
active so they're in this thing you
didn't know that and I didn't know you
can absolute it okay so it's really nice
so you can really you have a great
tooling available oh and I forgot to
show that you can also set breakpoints
in the code of because that's very
important so I won't go too into detail
now what actually happens here but let's
say I want to set a breakpoint here in
this method turn animation on you can
guess what this ms does if I press the
start button I can I can start debugging
here and what I get is I should probably
increase the size here a little bit so
what you can get here is you can really
see you can you can debug the elements
and and see the state of the model and
just like you would in a regular java
application can you try to rename the
start button to begin in HTML while the
application is running I can do that so
that that's another feature which is
relatively nice and it helps us to get
on par with the style of development in
JavaScript and HTML
so if stone a renames the now the start
button and saves the application it
should be renamed once he wrote the
Tirana oh okay
I should probably let it run again yes
so the start button is now labeled
begins so you can really dynamically
update the application while you're
while you're debugging it okay
I have already mentioned that the goal
is not to reinvent the wheel I had so we
don't want to recreate in Java
everything that has happened in
JavaScript because well that would be
enormous enormous effort rather we want
to reuse what did the JavaScript
community has done and in order to allow
that the essential part of our effort is
to have an easy way how you can call
JavaScript from Java and how you can
then call back from JavaScript to to
Java so basically this is based on GWT
native methods do you know do you know
GWT okay so basically that's a java
compiler which compiles to JavaScript
and actually well I believe it's it's
weakness of GWT because when they
decided to write a compiler they
basically need to adjust to every
language change and language changes in
Java are happening for example JDK 8
introduced lambdas and it's probably
very unlikely GWT will support lambdas
anytime soon the situation of back to
browser vm for example it's much simpler
because we are using bytecode and the
bytecode is not changing that much so we
don't need to do much porting and glumly
does almost work automatically so ok so
what we do so we got inspired by by the
GWT libraries and in fact do you have
has anyone of you or wrote your own GWT
library GWT code with native annotations
one so actually what we have in that
means it's automatic hint so you can
convert that code
- this JavaScript body annotation and
actually the reason why we are using
annotation and not the javadoc comment
is that we are processing class files so
we need information about the actual
JavaScript that will be executed and he
needs that in a in the class file and of
course Javadoc does not get compiled
into class file so he needed to use
annotation but the format of the
annotation closely mimics what has been
done and used in GWT
so a calling method a Java calling
JavaScript from Java should be
relatively easy you just write
JavaScript poly calling back from
javascript to java requires some tapes
type safety and again we are using what
has been available in GWT so basically
you need fuelie qualify the class name
the method name its parameters and then
send some values to the method so in
case of runnable the run method has no
parameters
that's the parentheses okay I needed to
find out how to say parentheses so the
first parenthesis are empty that
basically identifies the type of the
method the second parameters are the
second parentheses are also empty and
those are the actual arguments the
second example shows how to call a
static method on a string and it takes
integers so the first parenthesis
contain the signature which is integer
in JVM spec I and the second parenthesis
contain the parameter so this would
produce string with value 10 and
reducing hellos callbacks from jar so
actually by default we are trying to do
synchronous calls between Java and
JavaScript but while I was measuring the
performance of the minesweeper game on
Android I find it out that
it's horrible because the JavaScript
execution happens asynchronously that
means when I want to call something into
into the JavaScript I need to this needs
to I need to stop my threat wait up
until the JavaScript is executed in AD
referent then they cut my original fret
and continue and this is also really
slow so for that we introduce a
synchronous callbacks basically you can
send JavaScript to the browser without
waiting for the result and then the
performance in increased dramatically
the callback from Java from JavaScript
to Java is always synchronous okay I
think it's time for demo so Tony your
turn ok so basically what we are trying
to do is have a really clean separation
of design and business logic so we want
to have a designer developer workflow
the designer designs the website the
developer writes Java the business logic
in Java code and that works and we have
some basic libraries that allow that and
the art I will talk about that in a
little but for me that was not enough at
one point because I needed some code to
really draw something because I wanted
to use the canvas and I want to draw on
that and there wasn't support for it so
I asked the order how do I do it
basically how can I add support for
html5 canvas so I can draw something on
it and this is done via this JavaScript
body annotation so it's very easy to
call basically JavaScript methods and
make them through Java and in a type
safe way so what we need to do is
basically write our interface by
creating static native void method let's
say I want to I'm just showing you one
x11 little example I want to fill a
rectangle
then probably I want to have some
arguments position then width and height
and color for the sake of simplicity
I'll do it in hex code okay
so I have the static method native
method and now I want to provide the
code that is actually executed when I
when I call this method and this is done
like this I use the JavaScript body
annotation
and as you can see I get error messages
because I'm missing some stuff in here
for example I'm missing the elements rxm
body that's what you cannot read it but
you have to believe me
so that's @rx
and body is a string and now it's still
complaining and what it tells me what
Nevins tells me here is the number of
Arc's arguments does not match real
arguments so I need to provide one for
each of these let me do that and the
name must be the same as well so X Y W H
and C and now I can use those in the
body I can use the actual values in the
body it's not it too nice T to to
duplicate the arguments you have them in
the method so why they need to be
duplicated in the argument list again
you have to tell me ok ok so the problem
is that well G dk8 might have fixed it
but definitely in JDK 7 which I was
starting with you cannot get the names
of the method arguments by reflection so
I actually don't know that I know that
it has integer integer integer integer
strength argument but I know don't know
that that it's XY w H and C so I need
the names I need to know the names so
Tony can use those names in metal body
ok so now I have to write JavaScript
code I'm not good at javascript so I
face if I screw it up you will tell me
they were enough JavaScript developers
here so let's call it Y T C is document
get element
by ID I let a canvas and then it's get
context 2d and now I can do something
like GC fill style is see the color and
she see fill wrecked it's a method a
function so X Y W age that should do it
okay now I need to provide the element
here in my demo hmm
so let's add a canvas here the ID canvas
and with 600 right 400 maybe okay
and now since I have created this this
method the static method I can call it
so I can call it from here and say eight
model
feel wrecked ten let's hope it works 100
100 and color is like this alright
yes okay
did it work ah thanks a lot thanks about
I deserve this I wouldn't do this it can
work okay so basically it took me an
afternoon to create all these
annotations and create an Java API for
canvas and from that point on I can I
could use it and I can show you another
example so where where I actually use it
let's see what it does I don't know
which example is which okay here is one
that obviously displays some circles and
rectangles and renders some text and
it's a bit more elaborate so you have
the chava API here where you get the
graphics context bigger form probably
increase the font size so I can get it
from this API I can get a graphics
context and have a typesafe Java code
here where I can create colors and set
them where I can set phones and and
render something and the basic idea why
I did that was because I already had a
little game library that is written for
Java FX and that uses the Java FX canvas
so what I did is basically write a
compatibility layer so the same code the
same games that are running inch of FX
would also now run in in the browser or
on iOS and and all these platforms and I
can show you some more examples of this
like for example here the game library
also has a physics engine it's actually
the same physics engine that is in Angry
Birds and the Angry Birds game box too
deep and this is basically a little bit
overkill having a physics engine in the
pong game but it's just like my hello
world example that it works you ski you
can see there's some gravity
there and I can go on for hours okay
yeah if you can talk right okay
and we also have a little tile engine I
can show you that so it's really nice I
could reuse all that Java code that I
already had and suddenly deploy to new
platforms by just enabling this
compatibility layer in there
so you can see you have a regular tile
engine actually right now this doesn't
work in the really work in the browser
because it uses some libraries that are
compiled for food for Java 5 so this
example that's not really it's not the
best example but we are going to fix
this I think in this demo in this
session in this session
yeah I hope so yeah recompile the
library ok so so basically the problem
there is that back to browser is relying
on stack information present to be
present in in the class files and stack
information is being added if you
compile with target 1.6 so the libraries
that can be used in back to browser need
to be compiled with 1.6 target as some
older are not yeah I'm sorry so we need
to recompile them actually one more
thing can you return back to your
annotation that you wrote Because yeah
when I talked about the duplication of
the arguments we really try to make the
developer experience as good as possible
so Tony can you remove the arguments and
I mean at the bottom yeah yeah just
leave the arcs array no arc equals
nothing removed at all even the even
yeah so basically when you press called
completion you can basically get the
code generated for you now I have a and
now I have a feeling queue blocked about
that once you just forgot so basically
this is building upon the fact that in
in the editor in during compilation we
have access to the names of the
arguments so we can use we can we can
really fill the array for you yeah and
also like if you have these callbacks
here you will you will get error
messages if you screw up for exact
well here I add an integer argument and
the code completion or the the error
message will tell me call back to
java.lang runnable with wrong parameters
only known parameters are none yeah it's
really nice to have this annotation
processes because they provide
completion items and they complete
provide error messages in in IDs so well
actually the integration we are showing
the code in NetBeans but the integration
is not not been specifically are not
using any NetBeans ap is all the all the
annotation processors all the errors
that you see even the code completion
for the arguments is built on annotation
processors which is a standardized API
in Java since jdk 1.6 so basically the
same code completion and error messages
should work in IntelliJ and in clips
routes don't because they are really
lame on implementing connotation but the
specification but definitely it works in
Java C so if you make a mistake you will
get a completion error by Java C which
is which is good okay I think I'm ready
with the demo
so when I started working on back to
browser VM and all the HTML Java api's I
said to myself that I don't want to get
into into library business I don't want
to create API for manipulating HTML page
but well it's hard to do demo if you
cannot create a page that looks nice so
at the end I was forced to actually
create some ABI that you can use to
manipulate HTML page and again I wanted
to build on what is available in
JavaScript world so I decided to use
knockout anyone knows knockout one two
three Wow an ear on heard about angular
more
okay so knockout let's think about
angular as a bloated version of knockout
each is actually a part of angular is do
the MVC stuff so basically you create a
module and then you refer to elements in
your model from your HTML page and when
you change something in the model the
page updates or the UI updates
automatically so so this this is one
part of angular but in addition to that
angular provides modules and I don't
know connectivity to network and
testability and stuff like that and
actually taking angular and converting
that into Java would be much more
complicated because I only need a small
part of of it I needed the MVC stuff and
that's actually what knockout does
knockout a small library which is doing
mV
see and nothing else which is great
because then I can reuse the classical
Java way of doing things but I think
unit tests in Java
having kettle's cetera Sanders really
designed the rest according to the Java
style not follow what I'm forced to by
angular so MVC is really fantastic
technology and when I discovered it I
felt in love with knockout Aegis and
this style of development because there
is not a single reference to the UI in
your application code you just create an
abstract definition of various
properties that you have in your
application and and that's all as a
result it is perfectly unit testable you
can write unit tests for for your
application for your UI and you don't
need selenium or some testing framework
which really clicks in a browser because
well everything depends on the module
and then on your trust that knockout J's
will correctly understand the model and
update the UI and knockout J's is really
good at that is portable that's a
portable library supports browsers of
all the browsers and probably even all
the versions of browsers so it really is
portable enough and it saved my life
because I don't need to play the DUI I
don't need to pretend I'm a designer and
I'm not I'm a developer so I can focus
on the code and the UI will just update
itself so of course if you use knockout
Jas you are supposed to write the model
in JavaScript and well you don't want to
write JavaScript you want to write Java
so we needed to create a Java API that
will allow us to create models in Java
and then somehow on back
behind-the-scene convert that into
JavaScript modules which knockout could
understand when I was designing the API
I basically said to myself that my goal
is to design API which will allow Java
developers to be more effective than
JavaScript developers of course we have
all the goodies like code completion IDE
support and stuff like that real
factoring or effect of refactoring which
has been developed in last 19 years but
still Java is sometimes considered a
variables language for example the Java
Bean pattern well yeah you need
properties you need catalyst setters and
when someone from utter some fan of
other language sees that they they
usually think that Java is completely
ridiculous so that was one thing that I
needed to address and I did it by heavy
use of annotation processors as a result
the API may initially feel slightly
upside-down but I actually tried to make
it natural and try to explain the
concept as much as I could so I
organized a usability study there is a
service on on internet a web site like
API usability studies comm I don't
remember - you are correctly where you
can basically submit your API and they
will find a few developers that will do
a review of the API so I did it and the
initial reactions of those guys are sort
of mixed so I improved the documentation
I really tried to explain everything and
after two weeks they did the review once
again and at that time everything felt
completely natural because well maybe
the initial experience is strange but
then I think everyone can get used to it
so yeah eliminating getters and setters
was the main main goal and actually yeah
I when I was designing NetBeans I had to
do a lot of ATI development and I think
I made almost every possible mistake
that I could while doing so so that
experience convinced me that I'm
qualified to write a book on the topic
of API design and I did it and actually
you know maintaining something which is
15 years old like NetBeans that's that's
hard because you are not developing
something new you are basically a
sustaining in general engineer you need
every change into the API needs to be
evaluated for backward compatibility you
don't want to break existing users and
so on soon and well it's not that big
fun but when I was designing this HTML
Java API I could start from scratch and
that was fun that was perfect you know
because I could I could really apply the
best tricks that I learned and really
focus on the initial experience not
being restricted by the past so I number
one goal was to eliminate getters and
setters and basically get a setter is
now if you use this API reduced to a
single line you give it a name and you
give it a type and so the other thing to
do was to do the JSON binding because
it's not real JSON but knock out has the
JSON like structure where you put
something called KO observable and what
I needed to achieve was to take the Java
code and convert it into this into this
structure so to do that I actually
didn't hard-coded the conversion into
the API
I created a service provider interface
so everyone who has some framework if
that angular guys are eager to try it
you can write your own binding that that
will bind the Jason module in Java API
so the two generated Java Bean classes
that will bind it to your technology and
actually Tommy mentioned that the list
of templates in the visitor is growing
the third one was the controls jeaious
the template so the company which is
behind controls J's widgets for
JavaScript basically decided to actually
do exactly this they implemented SPI
so they can use so the developers can
basically use the same API for
generating the models but instead of
knockout they bind in their own controls
J's technology and achieve completely
different UI in a different way while
the developer experience on the Java
side stays the same the third thing to
tackle was client-server communication
well real applications business
applications need to talk to servers so
we should support that as well and
actually I believe that exactly in this
area we are really shining we are better
than the JavaScript because JavaScript
communication will just service over box
I only need to call you are then HTTP
headers parse it turn it into JavaScript
at the end it gets into really a long
callback so what I did I again use
annotations so you just take a method
which should be called a new receive a
reply and annotate it and you get onion
then you initialize the connection to
the server you get a reply and you can
update your UI and that's all so
again it's few liner code and the rest
of the boilerplate is going to generate
it for you actually ten days ago I was
in Vienna in Austria at the Java day and
the Java day started with a presentation
about angular and Dart
can you imagine that can you imagine how
the Java community is desperate that
they start Java day by talking about
angular and dart it's just complete
nonsense but I I could feel the
enthusiasm of those guys sitting in the
audience and looking at the technology
and say wow this is cool I want to write
single page applications on a client
which we have to slick UI enter on on
the client I don't want to use
JavaScript should I learn Dart
and they very convinced to learn that
so what I did I took two sources from
the guy who did the presentation and
before it was my turn I had three hours
and during those three hours I managed
to convert the example from a dart to
Java and from angular to knockout J's so
when I finally got on the stage I could
say look guys you don't have to learn
that you can stick with Java and you can
do the same so I well it's sort of
worked I guess
so here's picture of the technology of
the way how we do knock out knock out
for Java bindings so in the topmost left
corner you have the model annotation
that's basically the Java code how we
define the structure of your application
based on that we use the annotation
processors to generate Java boilerplate
code that a lot of code well a lot of
well yeah basically a job in like code
so I'll get that as settlers and stuff
like that that you don't want to write
by hand
so we generate this and we also leave
hoops for the SPI to plug in and then
there is the Jason the knockout Jas
binding which hooks which provides the
SPI and hooks and and whenever the
something in the model changes it
basically switches to JavaScript and
updates updates the Dom tree and then in
the right bottom corner you have HTML
that's something that you write as well
so you write the model in the left
topmost corner and HTML in the right
right bottom corner and hTML is using
special knockout directives called
attributes called data bind which
identify what in your model you are
observing and so I guess it's time for
demo it's my turn right so should we
show the maybe the simple demo first and
then switch to something more complex no
I didn't even finished I already have
yeah okay already have the the code for
this simple demo that I started in the
beginning so we can have a look at that
because right here you can see the model
annotation in the Java code that's the
data model class and this class is
annotated with add model and you have a
class name and you have a set of
properties and the properties have a
name and a type assigned to them so what
happens in the background is an
annotation processor will create a class
that has all the methods that are
required basically for it to work
correctly together with JavaScript and
have the getters and setters and stuff
like that so in the beginning when the
page loads I create the data model
that's the generated class generated
from this annotation I can fill the
properties set in the properties where
are the setters that have been generated
show good completion
so you have code completion here
obviously and you can see all the
methods that you have here no obviously
Eclipse does not have it all the time in
the yes because again the class is
generated by gravitation processors and
either you need to IDE which understands
annotation processors or you always when
you change the model need to go to
recompile whole project and and force
the ID to refresh so the apply bindings
tend as does the the binding for you
between the model and the HTML page so
now we can have to look at the HTML page
and here you see this data bind
directors the knockout data bind
directors so you can have code
completion here with some some
information some documentation about the
data bind syntax what we do here is for
example in this example we bind the
enabled state of our button to the
rotating property of our data model so
whenever the rotating property changes
in the data model the enabled state of
the button will update and if we click
we can call via this route we can call
the data model that is bound to this
page and call methods on it like turn
animation on so now I'll go back to the
java code now and there you can see this
method it's annotated with add function
so that's another annotation that that
allows us basically to call into here
that sign up for the for the annotation
processors so what we do in this method
is we simply update the model and set
the rotating property to true so it's
it's really that simple and as you can
see we do not have any code that really
interacts with buttons we have just the
code that manipulates the model and
that's for example a difference to the
way that it's done in Java FX so I do it
also Java effects a lot and I like it
but I like this approach actually better
because in Chaves who have us doing
JavaFX enjoy FX you have the FX ml and
you have the controller and you
basically inject the components like the
buttons and so into the controller so
you have UI elements in the control and
manipulate them this approach only works
with the model so you don't have any
reference to UI in here and that's
really a clean separation so the UI code
stays where it should be in in the HTML
page so what else can we show do you
want to go to a more complex example now
I think the basic I can show the mine
seaport ya sources okay so the basic
stuff is is it's basically that maybe
one thing one more thing
oh sorry maybe one more thing computed
property mm-hmm
so we have these properties here and we
also can you also can have more complex
properties that actually require
computation like for example here we
want to split the message that the user
inserts in the input field in the text
field text input and split it and return
it as an array so we can use it for
these elements that are going to be
rotated maybe I'll I should run the demo
again so you see what I'm really
actually talking about in the UI because
right now we're only looking at the
model scroll down yeah so here we have
the input and this is the message
basically and the computed property that
we see here we'll take this text and
we'll split it in an array and it will
be used for these fields down here so if
I change something here the computed
property will be executed again and the
values will update accordingly okay oh
maybe one more thing is Tony can you
refactor the name of the string message
to be something else not a variable
message but
I don't know anything you will need to
divert it anyway okay so now we should
have an error which is another benefit
compared to JavaScript well okay it's a
I can read it to you input is not one of
known properties message or rotating
because basically the model class has
defined only two properties and here we
are referring to a set of properties
which we depend on and we can do the
checks whether everything is correct
during compile time because we are typed
language and we have annotation
processors
okay search so here is the source code
for the minesweeper game which is
slightly more complex example but on the
other hand not that much so the basics
model is called mines and it consists of
rows and a row is proper is actually of
type row and it's an array so we can he
can have multiple rows now role model is
defined here and it has columns and
column columns are again array of type
square and square is defined here
basically each square has a type and
either it has a mind or does not have a
mind and the type is defined as a
numeration so we can basically when
defining the model we can either use
primitive types like integer double
string we can use enemies or we can
again refer to another type defined by
the model annotation by doing that we
really make sure that we are capable to
generate the JSON like structure in on
the on the on the browser side and then
well some computation like whether a
bump is visible out of derived
properties a function is actually a
callback so when you when you start a
game you can basically
so this is when you click new game this
method is going to be called and it's
reference from the HTML page so let me
find the HTML page here is it so normal
game so we have a button we have a
button actually we are using bootstrap
for to achieve nicer UI so these are
bootstrap styles the bottom line is by
default disabled but once we load the
load initialize the page it gets enabled
and when it's clicked it calls no normal
game one really nice feature of this
application logic and UI separation is
that you can write the unit tests so
click remove mark sign so actually yeah
so let's try the behavior I think you
can I can run the game well hopefully
this is the right on I can run the game
and null pointer exception aha so this
actually this project is not being
generated from the from the templates
this was created before the templates
were actually then created based on this
project so something slightly
differently anyway it is the game and
you can see the support localization
basically now the game is localized to
check what I can do is to basically mark
a mine and what this test is supposed to
do if I click on a mark sign it's
removed so if I click here the mark cost
goes away and actually I can I can unit
test for that if I do the back focus
test method
so maven starts here we are and I can
create the new model and actually nice
thing is that to string method of the
model which has been generated for us
returns the JSON object so we know that
the minds module has two properties
state and Rose so here is init method
which is going to initialize them and
now if I want to step into you will see
the general generated code so basically
what I need to do so this is this is all
generated usually you don't Wow by the
doesn't work usually you don't need to
care about that so in it
oops so that was not a good
demonstration once once again I don't
have sources for something I see
so let's try stop right I don't know
that I am where I am the idea is
completely confused Oh
once again the idea is broken does
anything work oh yeah something works so
well sorry I can restart that we'll
probably fix the issue but let's go on
so I know so basically what I'm doing
here is I'm trying to simulate a click
so this is a square on a position 5 and
column 5 and I can go into the my
business logic method basically a
handler for what happens in the UI and I
can go through it and see what it really
does but it changes the state of the of
the field and now I can do some asserts
again find out that the state is not
marked but unknown and yep so what I
wanted to demonstrate is that the
testability is is there that you can
really benefit from that so now given
the fact that previous demo almost
failed we can try something more
advanced so basically these projects are
maven projects so you can work with them
from command line but also from ID but
the way how you deploy to various
configurations is done through maven
profiles so let me be adventures and try
back to browse super file which should
give us a way how to deploy to browser
so right now the command that is being
executed is different and it again
failed like two browser in the current
project
no later
so one more try can i deploy at least to
Android
another failure could not resolve
dependencies back-end is unhealthy oh
okay so I'm sorry this was this is under
during demo right now so I will find
whether I can fix it
while Tony is talking okay do you want
to switch to mine yes okay so I was I
was just right now
working on preparing something but let's
go back here because what yarda
mentioned is that you can also have
custom knockout bindings and actually I
have an example of that
Oh perfect so because what I wanted to
do is like I wanted to have a for the
canvas API a simple demo application
where you can respond to mouse clicks
and draw something so I wanted to
respond to mouse clicks and I went to
Stack Overflow and pages like that to
find out how I can get the real position
on a canvas I hope this is valid
JavaScript code but what I'm doing is
I'm defining for knockout custom handler
under the name of mouse click and then
I'm using jQuery and a register method
onmousemove and whenever the mouse moves
I basically get the position of the
mouse and execute the bindings of knock
out all bindings mouse click call with
the view model and the event and on the
other side
I have this method mouse click that is
going to be called throttle font yeah
from the from the bound method and I get
the model here and there's actually some
magic going on because I can define
properties from the event that I want to
get as parameters here and they will be
automatically injected so I want to know
the real X and real Y position to use
them so I can get the graphics context
and draw something on it so I will fill
a circle at position real X real y
I will also get the color from the model
the current color so let me show you the
respective HTML page so here I have the
canvas and you see the data binding
sorry now you see the data binding so I
this is my custom binding and when it's
actually executed on this on this
element the mouse click method in my
java code will be called and down here i
have a regular data binding just as we
seen that before so you also have code
completion here in these knockout
bindings so i have the check binding of
radio button here and if i check like
color red the value will be set to the
value of color in my in my model will be
set to the respective string that's red
that's black and that's white so let me
run it to prove that it actually works
I hope my demo works yeah probably it
would have to switch to
okay it should work
okay so now I can select a color and
start drawing in that color mm-hmm so
actually now I should I should draw a
Duke black
okay so this is how you how you would
provide custom binding so are you ready
for you with your simple demo will work
I hope so what I wanted to demonstrate
initially was that I can debug into the
back into the debug the application
logic application model so let's try it
now that beam seems to be in better
shape at least it was a few seconds ago
so this is the generated code basically
it needs to deal with things like
threading because javascript is single
threaded while in Java you can basically
make the calls from any fret so what we
need to do is to reschedule happening
here and here is effective dispatch
method and now we are finally in our
code that we originally wrote and we can
actually test our logic usually it's
better to of course give the generated
one one thing that I wanted to mention
is that the generated code is completely
a reflection a reflection less we are
not using reflection everything is
statically compiled which helps or for
example a robo VM to find out a
transitive closure of classes that
should be included in the application
and of course helps back to browser VM
to do the linkage effectively in
JavaScript as well
I cannot demo the deployment to browser
and on draw it because for some reason I
am NOT able to download anything from
maven central its releases back server
is in unknown condition or who knows
there aren't connecting so it's not our
fault that's good okay so back to the
demonstration we mentioned that
we really tried to make the
communication with the server as
effective as possible so as in previous
state with knock out we are we have also
used annotation we are generating some
skeletal code that you don't want to see
another but we are also exposing SPI so
there can be various implementations
that handle rest calls or WebSocket
calls so by default we are using the
implementation which comes which is in
the browser so basically what you can do
is to use basically we are using XML
HTTP resource for doing the request
request it's not resource it's request
we are doing XML HTTP request to do the
rest calls and then we are using
WebSockets for working with WebSockets
but sometimes you don't want to use the
browser's implementation so there is a
possibility to use directly Java nephew
RL connection and a jsonparser to obtain
the data and also we can use grassfish
Tyros implementation of WebSocket client
which can basically do the WebSocket
communication from the Java code as well
so it depends how you setup your
application the SPI is pluggable and I
think Tony can do demonstration of the
current application
I should be able to do that ok what I
did is I just used the same wizard but I
didn't want to guide you through the
take you to the wizard step so I did it
already
and just chose the second template
that's the choice of crud demo and it
consists of four modules and there's a
server module here that's the rest demo
jersey-based server and there's a client
and there are two modules for some
JavaScript library integration
for the data structures that are
actually shared between the client and
the servants so that is really a nice
nice benefit of this approach you can
reuse the same classes on the client and
the server otherwise if you do like
chase in communication between
JavaScript and back-end you would
probably have to synchronize the model
all the time we do any changes on one
side you have to do the same changes on
the other side if you want to do
validation you have to create the
validation in both languages so it's
really it's it's really much easier if
you have something that you can reuse
you so the Jersey based server is here
and in here we have this under the path
context okay under the past things
contacts we have registered this
contacts resource and this contacts
resource uses the shared data model
basically here we create a new contact
and this new contact is actually defined
just as we saw it before with the model
annotation so the nice thing about the
model annotation is that it also
automatically creates basically a chasin
wire the two string method so it's it's
it's really basically prepared for the
transportation or for the transport
didn't don't have to do anything with it
just have to do two string with it so
here are a couple of methods that expose
basically rest service with Jason
messages so here you can get all the
contacts here you can get a single
contact identified by an ID so it's just
a regular Jersey code basically yeah
okay I'm client site developer so this
is all magic to me well actually I
mentioned the Hawaii was rewriting the
dart example to Duke script and again
not only Tony is client site developer
dart is also client site language in
spite you can use it on server but the
server written in dart was really
horrible because it was like create a
server by this to this part if the
request path starts with this then a
loaded attribute convert it into JSON
and do some logic so basically you get
all of this for free
I think Jersey is a perfect library for
developing rest servers so because it
handles all the conversions and parsing
for you because we are not dealing with
Jason anywhere we just annotated the
method with that it produces or consumes
Jason and then the type is our class
generated by the model augmentation and
Jersey knows how to do everything for us
so it's really nice so you can really
you can have a look at the server and
you will immediately understand what's
happening by basically it's really very
very simple to understand so I'll run
the server and then I should be able to
run the client as well let's open it and
let's first have a look in there again
won't okay fun again fund so we have we
connect to localhost here that is set on
the on the UI on the model here so we
have this this model class defined
somewhere in UI model here and it has
these properties URL message contacts
selected edited and a couple of methods
that are annotated with this own receive
method which are basically callbacks for
for the server for it to connect and and
and because in browser
most of the communication done with
server is a synchronous so I had a
question how do I represent a
synchronous communication in in Java of
course in Java 8 probably the best way
to do it are lambdas you initialize the
call and need to create a lambda body on
the function that will be called when
the call is done but I was targeting JDK
7 and doing that effectively in JDK 7
was problem it would require inner
classes and for the callbacks and I
wanted to avoid that so rather than that
I used annotation approach you you start
with creating what will happen on call
back annotated and it will get your
method which can initialize the
connection generated into the model
class ok so and again in our UI model we
are using this contact class the contact
class that you saw on the server and
this contact class is actually defined
here in the rest demo shared
client-server data structures and if I
go in here into this class phone type
you will see the model annotation so
here's the model annotation class
contact and this is basically what is
shared between client and server and you
can test it in in this one spot
basically so you don't have to do it
twice for client and server
so you have a couple of methods here
that will just interact with the rest
services on the on the server and I
guess I'll simply start it okay yes
thank you I just thought I forgot to
because I want to try to run it in a
browser Oh perfect
how easy is it to deploy to browser
obviously it's very hard right so I
think we need to we need to build the
hall the parent bomber with all the
modules yeah if I can if I can actually
find it here because I have I have a
hard time reading this yeah
I'm not hope we have all the libraries
already on your computer otherwise we
won't download much all right we should
we should because I built the demo
before okay success
let's see
success yet so now you should be able to
learn the client hopefully hammington
browser yeah running in browser so
basically now ahead of time compilation
was happening so we converted the Java
files into Java Scala file into
appropriate JS file and then we just
loaded it in an in a browser that was
opened server again uh-huh okay you just
connect it once it runs okay so now
we're connected and this is actually the
contact that has been added on the on
this that's in has been taken from the
server-side in the initialization of the
server you can call me if you want is
this your actual phone number yeah it's
nobody can read it no it will ring in my
office in brach so you can really do it
now but if you have problems with your
script you know how to contact me
I think they they've got problems with a
screen resolution so I can try to pinch
so you can read it so now we can we can
start adding new contacts oh that's me
you can visit me but you can't call me
okay and the you I will update so we did
a round-trip basically now yeah it's
called the server yeah and yeah it's
good for now so they are we have lost 70
minutes so the question is what to do I
can show I can show Java FX integration
because that that we haven't shown yet
mmm what do you want to do the chase and
stuff so actually okay let's vote
so Tony can show how to embed Duke's
crib application into existing Java FX
application if you are interested
what I can do is of course the
server-side example for that I needed to
create integration with Jersey and it
basically requires parsing JSON into the
model classes and there was recently a
bus about creating new JSON API into JDK
off route we already have a version Java
X JSON in in Java EE so I don't know
what else the guys Angelica can create
unless they use the type safe approach
with models that I am using so if you
were would be interested in a raw input
stream parsing of Jason you can vote for
me otherwise vote for Java FX who is for
Java FX 6 who is for parsing I'm fine
with it I'm going to show it anywhere ok
so actually but you have to use the
Chasen that I gave you okay
so the Jason that Tony gave me you know
it's open it it is somewhere here Jason
X Jason now adds my Jason yo Jason is
also
let me check not here
downloads geez I don't have it yeah I
cannot I cannot use oh geez okay and use
yours okay so actually the one that I
have oops
the one that I have is downloaded from
github
it's a reply when you ask for a list of
when you ask for a list of repositories
for a particular user so this is how it
looks like so well seeing the structure
it looks like it is an array of some
objects so basically I have already
written the example but what I can do is
to open input stream for that file
create an array of repo info class and
then setup browser context which is a
bit of magic and then call Matt modules
method which is coming from the HTML for
Java API s to parse in the in this
browser context which is not really
browser right now because we will use
just a Java implementation without any
browser to parse the input stream into
the array and then I can print the array
and I can also manipulate it directly
and in tight safe way so I will run the
application and what it does is
basically says okay this is this is the
repository so this is the array and I
see only few things from the array
because what I have actually done is I
define the repo info class as as having
just two properties because those are
those that I'm interested in so let's
try some more what would be the next
property URL
URL homepage no sighs sighs is good
integer is not there so if I add new
property property name size type int
class I can run it around the
application and now when we dump the
value of our array we see that we get
the size information but not only that
if I get the repository I can also print
in a type safe way that we have some
size F get size here is it
so basically immediately after adding
new property into this class I was able
to get to get new property in the IDE
and got code completion and I really can
use it now one thing that is interesting
is inner objects so basically here is
the owner class and we would like to
know the login so this is also possible
so we will define another property
property name all nura type own own
class and of course we have a problem
because this class is not defined so
let's generate it static final class
owner angular is using controller so I'm
trying to stick to the same naming as
well so I want to generate class owner
and it will have some properties so the
property is going to be what's the file
login okay property name is log n
property type is string
so now again I can I have the code
completion already so the login is going
to be F get all Nara get login and
that's all so and I if I run it we
should see it all so we have yeah this
is the owner field owners inner object
embedded inside of the of the repo info
object and here we have the login
printed by calling the Gator so well how
more typesafe parsing Jason can get in
Java so I'm really looking forward to
know what the guys are thinking when
they want to introduce new Jason API
into jeddak debugging debugging Java
debugging JavaScript well yeah I I
probably can do it you can do it you
have this simple application
so Tony will okay don't evil demonstrate
to mix debugging then you have Java and
JavaScript on a stack so you need the
sample the simple sample just opened the
simple sample there is JavaScript body a
notation which is doing callback
not in main it has to be in model here a
callback is being done and then actually
go to test
so actually what okay I will talk don't
it'll show so here we have basically a
callback from JavaScript to to Java and
that means the JavaScript will be on a
stack and if there is something wrong
with this then basically we can write a
unit test for that and actually the unit
test is not data module tests but the
other one which is calling the J's
interaction it needs some setup so for
example you need to setup a presenter to
be a test presenter to basically use
noise horn as
as the JavaScript engine but then Tony
can put breakpoint into the run and I
thought yeah 443 line 43 it up okay and
Tony can execute the test under the
bugger and then he can inspect the stack
and what he should see is that there is
part of the stack you need to execute
the test sorry
and actually I think you need to learn
on JDK 8 because niceness on is not
Angelica 7 so if you want the Ness horn
debugging feature which is in NetBeans
you need to use Nathan but now just
debug the test and we'll see okay so we
stopped in the method and there should
be some JavaScript on the stack is it
this is this is actually one of the
generated class that we need to do in
HTML for Java API but this one is called
from a Java Script so if you yes this is
a Java Script so actually this is the
JavaScript that we used in the Java
Script body annotation and if you hover
over or show show variables you should
see the values of the individual
variables on a stack so now we basically
have environment for doing mix debugging
of Java and JavaScript if you are
running on top of JDK 8 a virtual
machine and it's not useful only for
luke script actually this is useful for
avatar jeaious so if you want to develop
avatar J's applications which is
basically node.js model you can use this
debugger in NetBeans and relay switch
from Java
I have Java and JavaScript mixed on the
stack and Seto which sometimes helps I
was when I was designing nuke script I
often faced the situation that I could
either debug Java or debug JavaScript
but usually not both depending on the
environment
for example on Android I could debug
Java but not what is happening inside of
the webview on yeah on in browser I can
debug the JavaScript but the Java is
sort of hard so it really helps then you
can see though and the NetBeans debugger
can make that happen okay I guess we
should leave some room for questions or
you just shout out if you have a
question questions
okay so so the question is what we are
generating well it depends in case of if
you run on Java effects using Java FX
webview you are using the real hotspot
virtual machine and you know in such
case we don't need to generate much we
generate as little as possible so here
is the binding that is done in a
knockout so modules knockout for Java
oof can I see it
test test knockout for for Java okay
here is it and knockout class is
basically using the JavaScript body
annotation to implement the methods that
are common on even using knockout
knockout has value has mutated method
apply bindings and of course define
define observable and we do it in a
batch so this is basically the
definition of the observable anyway how
we call back into Java to get the value
and so on so this is the JavaScript that
is running when you are using iOS
Android or the desktop version with Java
effects in case you decide to use Java
Virtual Machine we need to also if you
decide to use the back to browser
virtual machine and run direct in a
browser well we need to generate
something more complicated because we
need to basically generate JavaScript
for all the Java classes not only for
the native methods and yeah so how to
show it and not to scare you that's
going to be tough because I don't have
the internet connection so I need to do
something here like to browse oh sorry
so so here are basically the sources for
the back to browser virtual machine I
should go into runtime virtual machine
for the browser and I think I have a
test here which is supposed to be
failing
that's the ahead-of-time compilation we
compiled everything I can show you how
it looks like if you are interested in
so this is a test I have a lot of tests
for the virtual machine and if I make a
mistake here
it should print when I run the test it
should print the file downloading don't
download anything I will try to run in
offline mode okay good so now it should
fail and javascript file should be
generated
okay here we are this is the file so now
I'm going to open it open file okay
it's too big to be edited so if you want
inspect this then the best way is to
collapse all and then open only the
things that are interesting so here
basically for each class we have a
function which defines the class so
let's inspect something format exception
so it has initialization which is done
only once and the initialization defines
all the necessary method in the
Constructors yes so this is it and fills
out field it does so this is basically
generated JavaScript if you know the
output of Java P which allows you to
dump the content of a class file that's
basically similar thing just in
JavaScript
I don't hear properly and like I don't
understand the question
you need to shout okay so how do we
initialize the page now I guess the
question was if you if you can have Java
code in the script tag no no not at all
so for all the environments that Duke
script support supports we just
initialize the HTML page loaded and then
start the code which talks to the page
except for the back to browser VM which
is using which really needs to use the
the script tag so at the beginning at
the end of each page we have this
initialization but this is a java script
and this is the only job you need then
you can basically run java so this boots
the virtual machine and loads the main
class and that's all so I guess we have
one minute left so that's all thank you
for stopping by and if you have
questions we will be around for the rest
of the conference
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>