<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>From IoT to the Database: Soldering, REST Data with JavaScript and Python | Coder Coacher - Coaching Coders</title><meta content="From IoT to the Database: Soldering, REST Data with JavaScript and Python - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>From IoT to the Database: Soldering, REST Data with JavaScript and Python</b></h2><h5 class="post__date">2018-02-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/zk6ZlQk6dmQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is my presentation I do where I
hope nothing catches on fire so we
should be good to go
howdy my name is Blaine Carter I am
Oracle's developer advocate for open
source so my job at Oracle is I work at
the intersection between open source and
the Oracle database so what that means
is on the one hand I look for
interesting tools and software that will
help database developers get their job
done a little better open source tools
and utilities and on the other hand if
there is an open source project out
there that might need a little bit of
database help I'm available to assist
with anything from intro to database
development all the way up to the more
advanced features of the Oracle database
now of course this does not mean that I
know everything even about the things I
talked about I like to experiment with
things I like to take things apart see
how they work sometimes I get them back
together sometimes I don't I tend to
learn more in breaking things and I do
with any other method I'm a kind of a
hands-on type of person and when I
learned something new I like to share
which is why I'm why I do this and this
particular project I'm about to go
through has lots of little components
there's some hardware that will see
pictures of there's some software and
multiple different frameworks and I'll
kind of go through a little bit of this
the intention of this talk is to just
show you one method of merging a whole
bunch of things together and maybe
there's something in here that will
interest you enough to try it out in one
of your projects another thing about me
you might want to know is I'm that tend
to be easily distracted by shiny things
my oldest son calls this ados which is
attention deficit ooh shiny if if you
follow me on Twitter
about a minute ago a tweet should have
went out that will show you this graph
here this is what we're going to build
by the end of the session so if you'd
like to watch this as we're tracking the
power usage and you'll understand what
I'm talking about there as we go along
just make sure that's running okay you
see the power starting to creep up there
at the end when I turn that little light
on all right so one shiny thing lately
that's been getting my attention is my
power bill my power bill it seems to go
up and up and up and I would kind of
like to try and rein that in a little
bit now true this is partially a green
thing I'm all for making the planet more
comfortable for all of us but
realistically I'm just tired of giving
money to the local power monopoly and
since I can't switch power companies and
try for a better rate then I need to
figure out how to use less energy and to
do that I need to figure out how much
power my devices are using and then I
can either reduce their usage or replace
them all together so a handy little
device to do this is called a kilowatt
looks like that or life-size that looks
like this right here that I get the
power cord plugged into does not come
with a little LED on the end you'll see
where that comes from in a second it's
pretty simple you plug it into the wall
you plug something into that and it will
tell you how much power that device is
using whether it's a TV or a power strip
full I should probably plug in my laptop
so we don't lose that it could be you
know whatever you want to plug into it
and then it will print on the display
it'll track the kilowatts per hour so
yams bolts all kinds of useful
information you may be surprised at how
much power your devices tend to use when
you think they're turned off basically
if they're plugged in they're probably
sucking some power and the more we get
into this IOT stuff the more those
things run all the time even if you turn
your TV off it's still listening and
it's still transmitting that off
somewhere so you know it's still sucking
power to be a device like this will help
you understand
how much power they're using even when
they're off of course if you're not
paying attention to this device you may
come back a couple weeks later and go
well what happened to all that
information you know I might have a
cumulative report on the device but I
don't get the little bits and pieces and
you know I'm a database guy so I would
like to try and keep track of the data
usage now I could use the old
tried-and-true pen and pencil or pen and
paper method and I guarantee I will
diligently go back and record that on
paper maybe five times if I make it to
five then I deserve a whiskey because
that would be a record I'm not real good
with pen and paper maybe I could write a
cellphone app where I come in and
everyone so now let's take a picture of
the display and then use like OCR to
figure out what the numbers are and send
that up to a database but then how do I
access the camera I could go find an
open source project that scans barcodes
and see how they're reading the camera
but you know what would be cool is if I
was scanning barcodes I could scan the
barcodes on the groceries in my pantry
and write an application for my phone to
keep track of my food inventory and then
a shopping and cellphone apps are a very
shiny thing for me I start I've started
several I'm not sure I've ever finished
a cell phone app because I keep getting
more and more really good ideas so
rather than go down that rabbit hole of
starting 12 new cell phone apps how
about instead we void a warranty and you
know take this thing apart did I mention
I like to take things apart I like to
void warranties as well fortunately for
us Lady ADA has put together a project
on the Adafruit website called tweet a
watt and when you finish putting the
project together it will be these
components there so I have the kilowatt
and the little flashy light thing here
these by the way the only reason these
are connected is because I have power
plugged into this other strip so these
two devices are not connected there are
a lot of really good projects on that
Adafruit website if you want to learn
something about
IOT or programming or soldering lots and
lots of really good tutorials on there
this particular project is kind of old
but the parts are still available I was
able to find everything I need the way
that it works is you take these two
little xB radios that's the top part on
here that's on this little board the
flashy lights are not part of the radio
the board is an adapter board so one
radio is actually inside of this device
sending data to the other the receiver
and of course that board doesn't come
all put together you do have to do a
little bit of soldering with this
project you probably can find somebody
who's already put the board together and
willing to sell it to you for more money
but you know where's the fun in that the
URL at the bottom of the screen there
you'll see this is the how to to put
this board together and it's a really
good walkthrough on how to do this it
contains some very useful tips for
example when I first went to put the
components together I was thinking I
would put the the two wires in clip them
off get it all nice and positioned and
then solder it in place a better tip
that came from this guide is you put the
wires in you bend them to hold the
device in place you know the resistor
whatever it is and soldered in and then
clip that way it you know stays in place
speaking in stay in place if I had a
really good tip I would say get some
good tools this is a board clamp that I
picked up it's really nice it
spring-loaded you put your circuit board
in there and it holds it in place and
you can adjust that for different sized
boards and then I got these helping
hands to hold the hold the components on
the board so that frees me up so all I
have to holds my soldering my soldering
iron this particular set of helping
hands it would be a lot more useful if
that base was heavier it looks like it's
a big cast iron base but it's really
just about this big and it's hollow so
it's not real heavy so if you don't get
these things all balanced just right
it'll fall over and then you say bad
words
the magnifying glass is great especially
when you're getting these old man eyes
like I've got so the next little bit
here I'm going to show you a couple
pictures of some of the mistakes that I
made when I put this together because if
you're sitting out there thinking I
can't do this because it's got soldering
and I'm not good at soldering before I
did this I had soldered one other thing
since I was back in the Army 30 years
ago and so my soldering skills were not
all that great but even with these
mistakes that I'm about to show you it
still all worked just fine so first up I
got to this step where I'm soldering the
header boards on that's the little black
bar that you can see that the xB unit
plugs into and you can see right here
where there's a gap that's not because I
didn't push it in enough that's because
when I soldered the pins in from the
bottom I overflowed the solder and it
went up into the hole so it still worked
in that position but it kind of bothered
me so what I did is I took my vice grips
so you can see in the next picture and
put a pin in there and then heat it up
the solder and push the solder back out
of course you got to get back off before
the solder hardens or now you have a
different problem and then on the
backside of that board you can see right
here where I tried to fix that problem
that I burned the board pretty good and
this slide doesn't make it look as black
as it really is but even with burning
the board everything still works it's a
little ugly but it's not that bad and
here you can see a couple spots where I
didn't put enough solder on it but once
again it it still works so you don't
have to be an expert soldering genius to
put this all together as long as you
know you're not connecting to points
that don't need to be connected which is
what the multimeter is for so anyway
once you get the first adapter board put
together you need to program the X CTU
or the the XP devices using this program
called X CTU this is provided by dizzy
comm who sells the devices with this
you'll upgrade the firmware you'll set
the settings for how many times per
minute you want it to burst the
transmission you'll set one up as a
receiver one up as a transmitter make
sure you either mark them or at least
keep them separated because although I
do like to take things apart
I don't like to take things apart just
because I messed up and put the receiver
inside the device not a big deal but I
don't like it when it's my fault all
right next up we put together the
transmitter you'll notice this kit is a
little bit different it doesn't have the
buffer chip in the middle and a couple
other additional components for the
transmitter chip we're actually going to
siphon the power out of the unit itself
to power the transmitter which is why
you'll also notice that that graph
I should probably plug my cell phone in
where did I put that wire there's that
I'll put my cell phone on here which is
probably why that graph in the in the
one it should be zero it's doing this a
little bit that could also be for my
awesome soldering job mistake I made
here notice my ribbon cable is one of
the ones that's all gray with a single
pink wire as you can see in this next
slide it would have been really nice to
have the rainbow cable the rainbow cable
is their example of what it should look
like the one with the pink wire and all
the gray wires is my tried to figure out
where I put the wires I solved that I
went and got some colored sharpies and
just colored my own colors on the ends
but my colors are covered up by the
shrink table there alright so once you
put that together and well don't want to
fall off there that would be funny it
should look like this one it's done
theirs is on the on that side mine is
the one that's on the the wooden desk
there so pretty similar in nature and
now it's time to void the warranty and
take the track of the power the power
tracker apart and so this was my first
little panic moment I was putting this
together for a presentation that I had
set up and I had a couple weeks left and
I open mine up and oh crap mine does not
look like the example so mine's the
close-up view and the other one is the
example for the project take the the
board off on mine flip it over and now
you can see the chip that I'm looking
for on my board but it's in a different
orientation and it's actually quite
smaller I'm not zoomed in on the other
one that's relatively similar focus on
those devices and even worse my chip has
no pinout numberings on it however like
I said earlier this projects been around
for seven eight years and so somebody
else had already gotten this device and
posted up online what the pin outs were
so I got through with a little searching
you can see the on the top solder joint
I did there my pins are way smaller than
what their pins are I did check that
with a multimeter so I'm not actually
touching there even though it looks like
I am but once you solder onto the chip
put everything back in place and then
mount your components on the inside
there's a big hollow spot right there
you can stick those on with it's a
double-sided mounting tape that you can
get in the paint section of your
hardware store and it's pretty cheap and
it doesn't short out the back of that
board so there's a good tip alright with
that put everything back together plug
it in make sure there's nothing no power
running through it and turn back on the
xct you program turned into serial
console and you should see those red
chunks of text just rotating through
it's gonna go blip blip blip however
long you set the transmission you could
go figure out what all those numbers
mean but they've done a force in the
project so I never bothered to go try
and translate that myself and once again
being a database guy now that we've got
the data being transmitted from this
device into the receiver going into the
USB and then this is just a normal
Raspberry Pi by the way that I put a
screen on so it's just a PI three
nothing special about this other than I
bought a screen screens are really cool
they're ten finger touch I think it was
like 35 40 bucks if you're gonna play
with PI's and that screens a nice thing
to have but anyway it goes into there
and then the project itself comes with
some Python code to translate that data
into something a little more usable and
and of course the name of the project is
tweet Ã¡what so originally it would tweet
the data out every five minutes that's a
great way to lose Twitter followers by
the way if you want to if you got too
many and you want to get rid of some
turn that on and just start sending
random numbers every five minutes now to
persist the data we could just it's just
Python so we could do load XE x CX
Oracle and just do some database insert
statements that's simple enough we've
probably all written an insert statement
or two by now
so that's not a whole lot of fun or how
about setting up a rest service now if
you're familiar with rest you're
probably thinking at this point well
that's more work because now I have to
install a server somewhere probably use
node or Python or Java or something to
build a REST API send the data in and
then I still have to write the insert
statements and use the connector to get
to the database and unless you're using
an Oracle database in which case you
should have access to Oracle rest data
services the Oracle the install affords
short term for that is included with the
Oracle database installer and it's also
included with the sequel developer
installer so if you want to play with
the words download sequel developer and
you should get the Ords installer along
with that all right so enough blah blah
blah let's actually do something stay
okay so if you're not familiar with it
this is sequel developer and the first
thing a secret developer has a couple
wizards in there that work with orgs
once you've done this a few times you
can also create just a plain sequel
script that will create rest services
for orgs and run the script as part of
your build but I'm gonna go ahead and
use the wizards so first up I'm using
the Exadata Express database and I'm
connected to this schema so you'll take
the schema that you want to put a REST
API on top of you go into it you're
right click on the schema you go down to
here to where it says rest services
and then enable rest service so put that
in there you can see all of that you can
see here you go into there and you click
on this enable rest services and click
on that and that will open up this
little wizard you click enable schema
that turns awards on for that particular
schema and you give it an alias this
alias will be used as part of the URI
that you will consume later on with the
rest tool that you're using if you're
going to do this for production you'll
want to check this box and go set up
permissions and all of that but it's a
little more advanced so what we're
looking at for my little project for my
house so with that you hit next you get
a summary I've already done this the
only difference when you hit and finish
and cancel as it would enable the schema
so I just cancelled that out so it
doesn't overwrite my other thing so with
that there are a couple ways there are a
couple different wizards in sequel
developer you can go down to rest Data
Services and use this built-in wizard
here if you don't have the credentials
to log on to the Ords server itself you
can still go through the schema however
I do and I will explain the other
difference on that in just a second you
can get to this rest development panel
by going to view rest data services and
click on development and that will open
up this rest development panel from here
maximize that make it stay we need to
make a connection so you click on this
little globe and over here if you don't
already have when you click the plus
when you do it will look like this these
are the credentials to get to your ords
server yours front end not your database
ok they may be on the same box but
whoever installed the ords service will
have this information for you to give
you a user for that and then right here
you'll notice this is that schema alias
that we just enabled on the table a
second ago alright so cancel out of that
I'm gonna connect to it it's going to
ask for my super secret password
I type it correctly the first try I'm
proud of me I've been doing this all
week and that's the first one okay so I
have already pre-built this rest service
over here and that's what's currently
being consumed by the tool on here so
that's why the data is going through if
you went and checked out my Twitter
account and got the link to that graph
that's why the the data is flowing on
there but I'm going to reproduce that
here and show you how quick and easy
that is so first up we need a module so
we right click on modules we click new
module we got to give it a name this is
just the name that you're going to use
just as a visual so you can see what the
name of the service is I'm really great
at naming things so I'm gonna call my
power and the URI prefix actually
matters what you type in here notice
that that ends with cod mo kilowatt demo
which is what I made that stand for
that's the schema alias that we set
before and so I'm going to type in power
here and notice that URI just got longer
and added power on the end I want to be
able to use this so I'm going to publish
it I'll come back to pagination in a
minute I hit next and now I'm into the
universal resource identifier think of a
module as a collection of similar rest
services so if you go back to like the
HR employee schema and if you're
thinking in a schema type mode and you
were to write an employee module that
would be a collection of rest endpoints
that all deal with employees okay you
might have one endpoint that goes out
and gets all the employees for with a
certain search criteria or handles
adding new employees updating that type
of stuff and you would have a different
module for all of your HR functions so
if you want to get Blayne arrays that
would probably be over there the UI pad
URI pattern template where we're at
right now this is the actual endpoint so
if I have an employee's module and I
have an imp endpoint this is the this is
the final endpoint so since I'm tracking
power usage
I'm gonna type in usage ho plays hope
just spell that right okay and notice
that the you are I got a little longer
there and then I hit next and now I have
to give that end point a method handler
there are four available method handlers
there's actually five but there's debate
and blah blah blah get gets records
that's the same as if you go on your web
browser you type in a URI it'll bring
back data post is for when you are
sending a new chunk of data to the
service so basically you're creating a
new record but you don't know the
primary key you don't know the ID post
is typically used for that put is when
you want to replace an entire record
knowing the ID or you want to create a
brand new record and you know the ID so
that's pretty much the difference
between putting post is knowing the ID
or not you can actually miss use any of
these handlers to do anything you want
you can write your whole thing with gets
and that's wrong if it works for you
it's still wrong but you could do that
you can use puts post whatever you want
delete is really difficult you send the
ID and it supposedly deletes the record
what the actions actually are is what we
do in the next step and we set up so if
we set it up correctly I'm going to do a
get I'm going to base this off of a
query and I'm gonna set the page size to
ten if you've got a billion records in
your database you don't want someone to
send a rest call and start pumping data
for the next ten years
hopefully we'll speed up before that
gets done so ords has a built-in
pagination mechanism so if I put ten
records it's gonna add some some
functionality that I'll show you here in
a second so I hit next I get a summary
that looks good
I hit finish now if I come over here and
I expand power usage and I look at the
get it opens up this sequel worksheet
and since we don't want to make this a
session on how well blame can type in
front of an audience I'm gonna just copy
a query that I already wrote
and paste that in there I'm just getting
the ID the sensor ID the watts and the
timestamp of when that was created from
my power usage table where the sensor ID
equals one for the last ten minutes
based on the time stamp order by crayon
very simple statement at this point I
could right click and hit validate this
is not making sure that I have good
sequel here or even well-formed it's
making sure that there's text in that
window it doesn't even have to run
validate we'll say yeah you got
something so whether or not you want to
click that is up to you what you do want
to do is right click that and hit upload
and so with that I now have created from
scratch a REST API that handles getting
records down from my database based on
that query but I also need to get
records up to the database so I'm going
to go back down to the template URI
right click on that and if you notice
when I hover over add handler get is
grayed out you only get one of each of
the handlers so you can have one get one
delete one put one post okay so I'm
going to do on the right spot there we
go I'm gonna add a post handler because
I want to send data up to the database
and once again I have awesome typing
skills my typing skills consists of ctrl
V + ctrl C not necessarily in that order
and I'm gonna tell my new rest service
that I'm expecting you to send me JSON
data whenever you send me data if I get
something and it's not Jason then my
service is gonna say not this wrong data
so that's what this piece is for when I
hit apply it skips me right over to the
worksheet because I've already got the
URI part set up now with ords when
you're working with anything that
changes the data so insert update delete
or I should say put post and delete on
the handler area make sure I copied that
just bragging about my copy/paste skills
and I forget to hit ctrl C we use PL
sequel PL sequel gives you you can it
can be argued whether PL sequel gives
you more control or not
PL sequel gives you a little bit better
control over what's going on in your
code you can use actual code to control
all this I mean minimize that so you can
see the whole thing and so it's just a
simple anonymous block of PL sequel I
declare a variable up here to hold the
new ID because my table auto generates
the new IDs with an identity column I
have an insert statement here I'm using
bind variables we like bind variables so
we don't open ourselves up to any blank
injection attack whatever injection
attack you can think of and I'm a
believer that when you create a new
record that generates the ID you should
return that ID back to whoever's calling
you it's just polite maybe they want to
make child records it helps to know the
ID so I returned that back into this
variable that I made up here I do not
have to map these to bind variable
variables because as you'll see later on
when the data comes in if the object in
my jason are the the keys of my jason
match the bind variable names right here
orgs will auto map those for you makes
it a little bit easier I believe it's
case insensitive but I don't have to map
these two however I'm returning that new
ID and I want to set the status to 201
so I will need to map these two
variables status of 201 normally when
you do something with rest and it works
then you send back a status of 200 that
means yay it worked
okay 201 is still in that yay it worked
block but 201 means yay it worked and I
created a record so you don't have to do
this but it's a little more correct and
it helps your end users consume your
rest API a little bit better they know
that you created something and I'm going
to put that into a bind variable called
status now the way you map these is up
here you have this parameters tab and
I'm going to go in here and I'm going to
add first up I will add in the new ID
and I wrote this really quick and I
believe it's improper that I named them
both new ID I probably should have named
one one and the other the other but in
here just know that the name
is what ords is going to see so that's
the bind variable on the other side the
bind parameter is the name that you see
in your PL sequel with the colon next to
it so that new ID references this new ID
value in your PL sequel the other thing
I need to map is my status and so I'll
add another one and so that goes here Oh
see awesome copy and paste skills with
orgs as well as with Apex there are some
predefined control parameters built into
the system one of those is X a pic
status code that's for setting the
status code for your response that we're
sending back to the client and speaking
of sending back these are both out
access methods the status code goes in
the header but the new ID is going to go
in the body of the response so I will
change that to response these should
probably both be int but this works so
we will leave them as they are if you go
over to this last tab the details tab
you'll notice down here at the bottom is
that URI that we've been building the
whole time ok and I'm going to just copy
that out of there and then I'm going to
expand this back up I'm going to right
click on the module and I'm going to
upload and with that we now have created
a rest service with a module and a
single endpoint that single endpoint
both will receive new data and let you
pull new data back out to use in another
application all works just fine trust me
no we don't trust we test so I'm gonna
go over and use an application called
boomerang boomerang is just one that I
found
it's a services testing it'll test both
soap and rest this is currently the one
I like I have like four that I switch
between it's just a simple tool for
testing rest services so we'll start
with the get and I will delete that out
and I'm just going to paste in the one
that I just copied from the tool by the
way remember I said that you there was a
in the connection if you the connections
section of sequel developer if you don't
have access to logon directly towards
the difference between the two is the
connection to the through the the
connection through the connection if
that makes sense you don't get this part
you would still have to go get the you
the main part of the URI from whoever
set up oars
the database won't know what that is
because Ord sits on top of the database
that's pretty much the main difference
between the two wizards otherwise
they're almost the same
so using this URI that we just built I'm
going to send that request off and you
can see that sends back an array named
items and in here are my 10 items
remember I set the pagination to 10
words automatically handles the
pagination you don't have to mess with
it not only that but you get the bonus
down here of a reference to the first
record this URI and the reference will
always take you back to the first set of
ten no matter where you're at if there
are more records after this orgs will
automatically put on this next section
and this URI which cleverly just says
page equals one it's zero based so the
zero page is the first page if we go to
that and paste that in we hit send we
get the next 10 records and now since
there are both records after this and
before this now we get the previous tag
so the way you would process this is you
would go into the system pull out the
first chunk of records process those if
there's a next you pull out the next
process next process till there is no
next when you hit the end that next no
longer shows up you just have first and
previous now I know since I wrote this
stuff that I plan to set the transmitter
up to only transmit data every 10
seconds and I know that when I draw my
graph at the very end I'm on is only
going to show the last 10 minutes of
data and so in doing that I know that's
going to be roughly 60 records if I did
my math right
and they I say roughly because it's not
going off at exactly it's a timestamp so
it's going off whenever this gets data
and so I think I can handle sixty
records so I'm gonna change that to zero
on the pagination size I got there
through the details tab same place that
you get the URI and then once I've
changed that I just go back in and
re-upload and that's uploaded and by the
way this is all I think I mentioned this
is all on Oracle's exudative cloud
account so I'm doing this live through
the internet on my cloud account and so
if I go back into get remember these
pieces at the bottom or the first next
in previous see I need to take the page
off when I hit Send this time I get an
array of approximately the last 60
records get to the bottom there is no
first next in previous because this is
all of the records that my query
returned if I run that same query I get
these records so that's the get part of
the service so to create new data when
you're doing a post remember I said I
need to make sure that it's Jason you'll
set your content type in your header to
be application Jason so on the client
side that's me saying I promise this is
Jason I'm not promising it's well-formed
Jason but I promise it's Jason so the
server will at least try to process it
this is about as well-formed Jason as
I'm gonna make right now right here I'm
sending the sensor ID and the watt
values of two and 20 remember I said
that if the name if the keys match up to
the bind variables I don't have to map
them my keys match my bind variables I
don't have to map them so I'm gonna hit
send and I get back that quick it
inserted a new record remember I told it
to send me back the new ID so that's the
new ID for my record then over here you
can see that I got that status of 201
that I wanted if I send that again we're
on 88 75 oh yeah great so let's wait 10
seconds
all right so it's just showing stars
it's not a big deal basically all I'm
showing you is that I'm consuming
different rest service with this that
goes to the same table
I basically duplicated the rest services
and so this one is going through the one
rest service that's identical to this
one but they're both going to the same
table so by now there we go it skipped
an ID because that one ate the next ID
which happened to be 8 but so right
there you can see that the with all of
that we created a brand new REST API so
what we did is we rest enabled the
schema we I already had a table made or
you can create a table I created a Nords
module which is a collection of similar
functioning rest endpoints I added the
single wrist endpoint that I was using
and then I added a get and a post to
that endpoint and that's all working and
with all of my blah blah blah that took
about 10 to 15 minutes but if you do
that without you know talking a lot you
can get it down to where you can make a
rest endpoint and you know 2 to 3
minutes tops depending on how
complicated your queries and your PL
sequel is going to be but that's always
an exception but the actual setting all
of that up really quick easy REST API
all right so now we have our REST API we
want to modify the code that came with
the tweet Ã¡what project if you go to the
tweet Ã¡what project and you download the
tweet Ã¡what master zip file it's going
to have several different Python modules
in there all kinds of different things
I'm only concerned about three of the
the ones that are in there we first we
have sensor history this one controls
all of the timers so every so often it
will try at the data every so often
it'll transmit the data it collects the
sensor data and calculates using that
calculate your kilowatts per hour if you
go through the Python code you'll notice
that there's five minute this and five
minute that throughout those are all
just labels I've changed my code to work
every 10 seconds and I probably should
change there at least get rid of that
part of the labels but everything still
works the math is the math is good so
just ignore the five-minute labels the
other one I need is the X B dot pie
is the one that collects the data from
the XP unit through the USB plug and
then it formats that data into something
that that sensor history module can use
and finally there's watcher pi notice
the clever TT for wot cheer in here this
has the code in it too if you want to
make a CSV file instead or if you want
to lose Twitter followers or it will do
a Python graph of the data there's even
some pieces in there on how to set up a
Google app I think it's been long enough
the actual Google app this works with is
no longer hosted but there's
instructions if you want to do that you
could do your own and if you want to get
really fancy and actually implement
implement this in your house there's
instructions in there and how to do this
with multiple transmitters against a
single receiver all right so I've made
some modifications to some of this code
for starters I'm a firm believer that I
rip out code that I'm not using so I
went in and I took out the code for
tweeting I took out the code for the
graph the CSV file the Google Docs all
of there the Google app all of that
stuff I no longer use so I ripped all
that out I made a new file called
watcher - min because I minimized the
file a little bit and then I went in and
I modified lines 10 and 11 they were
hard-coded for the common serial port
I'm also a believer if your if your
program depends on something about your
environment you should be using
environment variables I mostly work in
Linux I have to use the windows box when
I go to my presentation so I have to
make sure it works in both so user
environment variables he had to re-do
your code I converted all three of these
programs from Python 2 to 3 using the
Python 2 to 3 converter and I got one
error when I did that and that was line
151 it formatted the print statement
wrong I probably should have taken an
example of that or redo it but this
actually is the statement that works and
I've uploaded my slides by the way so
you don't have to memorize all of this
stuff line 158 159 this is where they
have the timer that was set to go up
every 5 minutes they
check this if it had been a minute and
then they mod five the minutes to see if
it was zero so every five minutes I
changed that to be every 10 seconds and
then finally another pet peeve of mine
line 164 they called a function stored
the value they used the the variable a
couple times and then they called the
function again a couple times but
nothing has changed in that cold code
block so I just took out the function
call and put it in the variable once
again my pet peeves if none of this
matters to you you don't have to do any
of this unless you're doing the three
and then in which case you have to do
151 then I created my own module called
ORD spy I like to separate out my
functionality and this is a simple
little program where I use the Python
request module to do the the rest
request you can see where I store the
URI that I'm going against I create the
JSON object based on the data passed
into the function I try to do a request
up post using that stuff timeout of two
seconds if it all works then if your if
you come up close and you're welcome to
come look at this afterwards every once
awhile this will say create a new ID
that's what that does and then if it
takes longer than two seconds I don't
care this is just fun so I print out a
message saying it's taking too long if I
see too many of those you know I'll go
poke around and then I go back to
watcher - min and I add in a call to my
new function I like to have control over
stuff so everything but the last line is
me adding python call to watch for a
command line variable of - oh if I don't
call it with - oh it doesn't send up to
org so I can test without you know
mucking up my database once again if you
don't care line 168 is all you need
alright so now we've got data we've got
some hardware in here that we built
sending data through the magic internet
or Ethernet through the air
it's a radio I'm not even sure what the
protocol is to the receiver through the
USB into the Python the Python is
calling the rest service to put data
into ords or through words into my
database so now we want to get the data
back out
we want to make it pretty and so I'm
going to show you something called
Oracle jet this is Oracle's javascript
extension toolkit okay I always say that
wrong and I better say it right today
anyway so let's just let's don't talk
about it let's I run all kinds of
plugins I don't like things to stay open
too long so that was my timeout program
plugin saves a lot of memory if you're
if you like me I my fedora box at home
currently last count I had 200 open tabs
still and so this will go through and
just it doesn't fully kill the tabs but
it kills the process anyway little
plug-in right there that's fun
back to jet so if you go to the Oracle
jet website it looks like this it's got
a whole bunch of what is jet basically
what jet is is we've taken a bunch of
open source frameworks and utilities
combine them together and then put some
really nice components over the top of
that and made it all work together real
slick so for example in there is jQuery
knockout j/s is a cool little module
that that's the magic wire that gets you
from your HTML to your JavaScript so if
something changes over here changes over
there it's magic I don't know how it
works but it does work and then
require.js for your dependencies we want
to get started so we click on get
started oh I need to start one thing
that I should have where's the line
there it is so I need to open up this
one on my machine for some reason it
sometimes takes a second to run so I
will get this started
while we talk the command is oujet using
the command line interface in place
interface to create a new module called
track alot using the nav drawer template
and so I'm going to let that run
but if you're gonna use the command-line
interface then you need to have note
installed
particularly you need to have NPM
installed as well to get the command
line interface interface now I'm doing
gonna do it all the rest of the day you
just run NPM - G install at Oracle oujet
CLI just like that copy that paste it in
and that will globally install the
Oracle jet command line tool for you to
create a brand new application from
scratch so it's probably too late but
now this directory wasn't here before I
typed in that last one and it's filling
this out as we speak so to create a
brand new application from scratch you
type in this command there are different
templates that you can use I've chosen
to use the nav drawer template so if we
go back over here I'll explain why I'm
doing things in this window typically
like I said I mostly work in Linux and
so even I'm in Windows I like to use git
bash I've done something to this machine
so when I try and run this command in my
git bash I've got NPM or Bower or some
weird thing misconfigured so it would
throw an error over there but it works
just fine in the windows prompt so other
than this I won't go back to the windows
prompt you can see here a report of all
of the stuff that that command-line tool
installed for us it built all of that
out and put it in the directory I'm
running out of time so I'm going to kind
of start speeding up a little bit I've
got probably about four or five minutes
left I'm gonna try not to go to extra
late once that's created I open up oh so
this is a git bash prompt that I'm
opening up inside of Adam so once that's
created I'm going to change into the new
directory that we just created and I'm
gonna call oujet serve and so this is
going to grab everything from that set
of files that we just made and put them
where they need to be and then start up
a server for me with a watch by the way
I love the watch commands so if I change
something it will automatically refresh
and when it's up this is the application
that we just wrote from scratch
this did not exist before I type in
those other commands and so it's just
kind of a stubbed in application you can
see there's some tabs here there's a
drop-down list most of this right now is
just stubbed in and we expect you to
fill out your application I want to make
a graph so I'm going to overwrite the
dashboard so going back to the get
started guide I'm going to jump into the
cookbook and in here this is an example
page of a whole bunch of different
components that you can use from Oracle
jet all kinds of really cool stuff if
you want to build some collections
here's a bunch of different collections
you can do different controls you can
put in if you want to make some forms
frameworks layouts and navigation
patterns
I want a visualization in fact I want a
chart and the chart that I want is the
line width area chart when you come into
here it's a fully functioning chart and
things move when you click the buttons
and it shows the code down here so if I
switch over to the JavaScript side the
cool part is if I change this number to
something else and I hit apply right
here it rebuilds the graph with my new
number so you can mess around with the
code all you want down here when it's
working exactly the way you want it you
copy it out of here paste it into your
application and go now I don't want
everything from this like the buttons
here in the extra series I just want
little bits and pieces so I'm gonna
cherry-pick just the pieces that I want
I'm gonna make a chart so I need to grab
that dependency and I'm gonna minimize
this because that's not interesting
anymore and I'm gonna go into my track
of what module that I just made I'm open
source JavaScript I'm gonna go into the
view module modules which is the back
end of the the jet application I'm going
to open the dashboard j/s and it comes
in with a bunch of really cool stubbed
in stuff that I don't care about right
now so I'm going to just push it off to
where we can't see it and I'm gonna
paste in that component that I wanted
I'm gonna go back over to the chart and
really all I want out of the JavaScript
are these two these are what's called
knockout observables remember I talked
about knock
is that glue between your JavaScript and
your HTML whatever happens here happens
there
I'm not going to default the values so
I'm going to take the default values out
and this should say self so I'm gonna
copy this and replace that this is what
selfs otherwise what's the point of
having the self variable up there and so
that's really all that I need from the
JavaScript portion of the cookbook and
so now this looks really big long and
complicated I'm gonna take a piece of
code that I've pre-written this
particular graph uses an array of
objects for one axis and a different
array for the other axis if you remember
when we did to get from my rest service
it all comes back as one array of items
so all of this code once the down in
this area just takes those two my one
array and splits it into two arrays and
I'm happy to go over this with anybody
that wants to actually look at the
JavaScript code after to prove that you
know there's nothing up my sleeve the
rest of this is I'm making a simple
jQuery AJAX call it's a get I'm going to
the URI that we created for Ords when
that works I split those two arrays out
right here is how you assign those new
arrays to those knockout observables and
then down here I just set a timeout so
it's going to call itself every 5
seconds and then an initial call itself
wants to kick it off
so I mentioned the watch functionality
before I went too far now that's it that
break okay nothing super shiny is going
to happen right here other than it Auto
refreshed you don't say anything new
because we haven't messed with the HTML
yet almost done so let me jump back over
to the cookbook here and I'm going to
switch over to the HTML so you remember
I said I just want the chart I don't
care about all the rest of it around
there so I'm going to come in here and
just cherry-pick out this chart object
and I'm gonna go back over here and into
the view this is where your HTML lives
I'm going to open the dashboard view and
this is just that piece of text in there
that says this is the dashboard put
something in here
so I'm going to get rid of the text and
I'm going to paste in something in there
I mentioned I don't want those two
buttons so I'm going to delete out those
two buttons and let's make sure we're on
the right one here so I'm gonna hit save
and see if I can get there there we go
our graph is up and running and if I
turn that off you'll see that the power
is going to start is going to drop down
in a second so this is feeding live but
while we're waiting for that I've got a
lot of screen real estate here and I'm
only taking up a little bit you can see
the power starting to dip there so one
last change I'm going to make is I'm
going to change that from 500 pixels to
a thousand I'm gonna hit save come back
over here it stretches it back out a
little bit and so with that that's all
it takes to create a really nice Oracle
jet application that is consuming the
REST API that we built before okay and
I'll turn this back on so the data will
start going back up alright so this
presentation has lots and lots of shiny
features in it we started out by talking
about how we void a warranty to take
apart the hardware solder a radio in I'm
amazed TSA lets me through every time
with that thing we created a rest
service using Ords for both putting data
and get our posting data and getting
data from the database we modified the
Python we talked about modifying the
Python code to consume that service and
get the data into the database and then
within a few minutes we created an
oracle jet application to get that data
back out and put it in a nice shiny
little graph alright any questions yes
Oracle jet okay so is Oracle jet stored
in a local machine or up on the cloud
when you load the CLI with that the npm
command and you run that command that I
did in the Windows DOS prompt it creates
a little mini node server on your local
machine so while you're building your
application it's all on your machine
when you want to send it up to the cloud
then there is a what's the command jb2
package is a package build release yeah
so you can run a command that will
package it up and get it ready for
deployment up and then you'll take that
little package and deploy that so while
you're doing the phase that I did that
was all and I don't know if you noticed
but the URI was just localhost I think
was port 8000 or 8080 something like
that but it is its own little
self-contained node server for Oracle
jet
yeah yeah for Oracle jet you just need
to if you're going to use the command
line interface you can download just the
zip file of Oracle jet you don't have to
use note at all you won't get that
server you'll have to work that out
yourself but if you want what I showed
you install the command line tool and so
all you need is node and it's on your
machine you never need to go outside
your machine but it can still consume
the rest services from the cloud which
is what I was doing there so alright if
there are any other questions later on
there's my contact information I love to
talk about stuff if you can't tell if
anybody wants to come up and and look at
this stuff I'm happy to stick around and
like so there's my contact information
thank you for spending your time with me</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>