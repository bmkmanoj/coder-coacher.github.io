<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building Custom JavaFX Controls | Coder Coacher - Coaching Coders</title><meta content="Building Custom JavaFX Controls - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building Custom JavaFX Controls</b></h2><h5 class="post__date">2015-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/L9xtOhdSx6k" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so thank you everyone for coming along
today my name is Jonathan Giles I'm a
software engineer in the jar FX team at
Oracle today we're going to be talking
about building custom jar effects
controls I'm wired up to a lanyard today
that's because if I get jet lag I can
just lie down and start presenting from
the horizontal position but if I did
disappear it may be also because I've
fallen off the stage right there okay
before I begin right next or a good
friend of mine your hand boss is
presenting on gyro fix applications on
Android so if you wanting to learn about
how that happens I won't mind if you
disappear next door so what's the plan
for today first of all we're going to
talk about what is a UI control and I've
looked back at my slide decks from
previous Java ones and now the
conference's as well as what other
people have presented about the UI
controls and I've come to realize we
don't start from the fundamentals so I
thought it would take a quick diversion
to the fundamentals and we'll talk about
what is a UI control then I'm going to
talk about what's changed in JDK 8 which
has happened over the last few years and
I actually missed last year's Java one
so this is the first time I've talked
about how to build UI controls using JDK
8 features then I wanted to talk about
different ways we can build UI controls
I wanted to round out with useful tips
and tools and hopefully if we have time
I hope I'll leave plenty of time for Q&amp;amp;A
I know the sessions always very popular
for questions if you have a question
midway through the station feel free to
ask it the only caveat a caveat is try
to keep it to 30 seconds because I've
got a lot of slides to get through and
otherwise I might ask just leave it till
the end so what is a UI control if I was
to sum it up in a few words I've said
it's a visual element it's user
interactive and a head stay and these
things are kind of intermingled you know
the visual representation is what your
users see the user interaction is how
they modify the State on the control and
the state can be changed like I say by
either the user or by things happening
elsewhere in the system they update the
state so to put that into the context of
jar effects
I would loosely define as follows the
visuals come about by the fact that we
extend from the jar effects note
everything in the scene graph is a node
and we'll talk about that a bit more
shortly but
the other main aspect of that is their
UI control doesn't have to extend from
the control class which is much further
down there of a node hub with a class
hierarchy another way you could build a
UI control is that it could be a canvas
control which is to say instead of
building your UI control using nodes and
building up your own scene graph you
could draw you know on a canvas similar
to what you do it with html5 canvas or
Java 2d for example I'm not going to
talk about that today I've never built a
UI control like that you can find
presentations online by people such as
Garrett on parlays and he talks about
how you can build a UI control using the
canvas approach UI control is typically
styled using Java effects CSS that's not
required you can use the justin java api
s but as I'm going to show there's a lot
of power and using the Java fix CSS
functionality and it's typically
designed to be reusable which goes to
say that you should give some thought
about what the API and the what the API
exposes you don't want to have more api
than necessary and what we're going to
talk about today is different classes
that you can extend from and what that
means for the API that's exposed to your
users so for those of you not familiar
with what a what Java fix is
everything's based on this concept of a
scene graph you build it up using a
whole bunch of nodes so everything in
the user scene graph is there for a node
a UI control consists typically of many
nodes so for example something like the
scrollbar control is either horizontal
or vertical it consists of a track the
thumb that sits on top of the track and
top and bottom buttons for the you know
increment and decrement and these are
all separate nodes that you layout and
then you provide rules that say that the
thumb can't go past the top and the
bottom of the scrubber the other point
to make there is that just because the
UI can control can be built with nodes
doesn't mean that you should go crazy
and just have as many nodes as you can
every node requires layout and CSS and
and these aren't free
operations so it's always important to
keep the number of nodes that you use to
a minimum so a good reaction that what a
common reaction that many people will
have is that you know or I'm a Java
developer I'm not a CSS developer why do
I need to know CSS at all I just want to
make my user interface look nice and I
know Java I don't see it as a foreign
concept to me then you know I hear you
I'm you know I I understand where you're
coming from it's never nice to have to
learn something that you're not familiar
with it takes time and you know that
time takes away from your productivity
but all I can say is that investing a
little bit time to get to know the CSCS
functionality and how it applies to jar
effects is going to be very useful in
your long run it's very very nice I'll
show you some features of it shortly
that in Reis the time don't kind of bury
your head in the sand and just pretend
to ignore and try to use the Java API as
you may as well now take the time to
learn about the terrific CSS right so
that's kind of a very quick overview of
the high-level concepts of a UI control
so what's changed in JDK 8 well in March
2014 we came out with the JDK 8 that in
the context of UI controls is a whole
bunch of changes there's a skin based
class that's now public API and we'll
talk about skin based shortly yeah
there's a lot more CSS API is now public
and again I'll talk about that shortly
it is right-to-left support for certain
parts of the world we're in the flow of
your user interfaces from right to left
and it's just automatic it's really
quite cool you toggle a bully or an
enumeration to right-to-left and user
interface this reflows itself so there's
a brand new visual styling code Medina
and I highly recommend that you use that
by default is switched on so it's
actually your choices to opt-out of
Madinah we're not following the swing
approach where we always are stuck on
metal so we do upgrade the visuals as we
come up with new style sheets and the
interesting thing about Medina as well
as the testing that came before is that
they are entirely the way in which the
UI controls our style there's no speech
code inside our skins that is special
for Medina or special for Caspian and so
it's really cool to see that Caspian was
a cool a good style five years ago and
trends have changed and Medina is a
really nice style for today and so we're
just God's really long CSS file and I
talked about a bit later on but you know
I I haven't counted maybe four to five
thousand lines of CSS and they apply
styles to every single UI control that
we ship and if you want to know how to
style your controls that's a really good
place to start learning so there's a few
new controls there's a date picker
control and the tree table view and the
lambdas and I've been told if I say
lambdas more people coming to the room
so this is our land isn't JDK a and I'll
talk about lambda shortly just because
it's pretty nice just a month and a half
ago we had JDK 8 u-20 and that was a
really fun release for me for the for
the sad fact that I spent the whole time
just fixing bugs and we squashed so many
bugs and that in the controls area I
think about three to four hundred were
easily squashed which was really nice it
was about six month for a development
cycle I think the Ella nice thing is
that we got a whole bunch of CCS API
improvements and I'll show you some of
those later on and the next release at
u4t
is coming up the first half of 2015 and
unfortunately I had to do some funk some
feature work this time around and so
we've got spinner formatted text field
and dialogues coming up in a tu 40 the
other nice thing in at u4t is the
accessibility API and it was a session
yesterday but the cool thing that the
accessibility API is for people who are
partially sighted or blind and need
screen readers went from being a black
box to being able to drill down into
every individual component of the user
interface and it's it works really
really well so it's and that's all
handled for you all the UI controls that
we ship support accessibility and it's
possible for any UI controls that we
write ourselves such as the controls
effects or any that you write to be made
accessible with only a few lines of code
you basically say what the role of your
UI controllers and you react to an
events coming in
the operating system so it's very very
easy way to add accessibility support so
glanders so this is the old style you
know you're all familiar with writing
event handler or event handler code like
this we're going to rectangle we see it
on Mouse clipped we add the event
handler we get the handle method and
then we call handle massive in which is
just this method down the bottom right
now the way we designed a lot of our
code our API and jar effects was that we
went with the single abstract method
approach where you know event handler
only has the handle method and we we add
an event handler for when that mouse is
clicked I like the swing approach where
we had and I forget in terminology
exactly but we had a massless no that
would have three methods in the
interface so the nice thing about that
is that we've we automatically get
lambdas support for free so you know
this is option two
as you know we've got rid of a few lines
there so we're just we've got the event
and we handle the mouse event by just
calling the method like we did in the
first one we could go to option three
which is let's get rid of those bracket
bracket so we go down to one line of
code and we could go to option 4 where
we just passed in the method reference
directly so five lines down to a one
line and if you can imagine your code
base it collapses quite nicely and I
know there is a talk specifically on how
we made will we cover it all our code
injera fix Thailand is I'm not too sure
if it's bean or if it's still to come
but it's certainly worth attending if it
hasn't haven't yet
so does there anyone have any questions
about what I've covered so far
yep
got one
a wood has provided that the arguments
coming in to the CNI mouseclicked were
equal to the methods there on the handle
Mouse event right now people have to
remind me to repeat the question alright
so here's some different ways you can
build a jar of X UI controls and as I've
kind of said I'm responsible for the UI
controls and Geographics but I don't
have a definite definition of what a UI
control is so we're going to work
through three different ways of building
the UI control and unlike previous years
when I've given this talk we're not
going to build half a dozen different UI
controls were just gonna build one UI
control and I'll cover that shortly but
I wanted to focus on what's different
about each of the the approaches so
we're gonna start with a really simple
UI control and we're going to transform
it through two steps until what it would
be like if I would write in my day job
so what are we gonna build
well we're javelin so I thought would
build the job of one button start we've
got a client who's come to us and he
said I have a new project for you and
he's given us a very specific a UI
design requirements document it's many
pages long and it looks like there he
wants a red button has tilted to the
side and kinetics put on it but it has
to be red and has to be rotated and has
to be big has to respond to Mouse events
it has to have different visual
indications for the normal pressed and
Javed states so that's all we have to do
now I've got a lot of code coming up I'm
a software engineer I'm not you know
going to just gloss over things I'm
gonna dive into code so if you want to
play along at home I don't recommend you
taking photos or writing down all the
code it's all available at that bit back
at repo and I have the same URL at the
on the last slide as well so there's
three main approaches to how you could
build a UI control with and the N is
more about this is these are the three
we're going to cover today we're going
to customize an existing control we're
going to extend from a layout container
and we're going to in extend from the
control class itself so steam from an
existing control so but in a moment of
clarity we realize the Java one button
actually sounds remarkably like the
button that where we already ship and
Java effects unfortunately it looks
nothing like what our client wants it to
look like the jar effects button is gray
and blue and pretty boring and our
client said they want it to be reared
and rotated but we've got CSS so we can
deploy that so here's our code for our
Java 1 button using the first approach
it's all of really what five six lines
and really there's only one line of any
particular interest as they get style
class add Java one button and if any of
you have been in do any of the CCS talks
that we've had earlier in a week this
will be familiar to you but what that
basically allows us to do is then write
CSS that targets their style class so
the CSS is just doing what the client
wants he wants that the the base color
of the image to be reared he wants it to
be rotated negative five degrees and
he's once it's scaled and the X and the
y axis 2.5 times the thing is this Java
one button CSS isn't the only CSS that
will apply to our button because you can
see Java one button extends from the
button class which means we also bring
in any style classes or any CSS
information that relates to button
because in the madina and the Caspian
file they have rules similar to this
although obviously a little bit more
saner where the selector is dot button
and you can see on the left hand side we
have a get style class sure and we're
adding Java one button to our Java one
button class but we aren't removing the
the button style class that we bring in
from extending button so the end result
is that we get all the benefits of
Madinah or caffeine whichever one's
applied without having to do anything
more so we get all the nice gradients
and the borders and every
so then there's a little bit code to
show our application I've skipped over
some parts of the code so what we're
going to do is we're going to create a
normal button just a normal Java effects
button that's very disappointing to our
client and then we're going to compare
that to a Java one button using the
constructor that we just defined in the
last slide now what we have to do is we
have to bring in that Java one button so
we say seen and when we get the style
sheets for that scene and that's just a
list of strings that points to CSS files
on the file system or on the web and
then we have this kind of bizarre line
of code but it's something we use
throughout Java graphics and it's
something that you should use so what
it's saying is get the Java one button
CSS file relative to the Java one button
class and then two external form just
expands that out to be the entire file
path reference so yeah all we're
basically doing is adding the path you
know a reference to a CSS file some we
run our file system relative to Java one
button in this case Java one bath and
CSCS should be in the same package as
the Java one button class and success
our clients happy he's got as a Java one
button
no the SOL equation is doesn't have to
be the same package exactly or just the
same package structure what this say
what the slide here says is that Java
and button CSS file is in exactly the
same package as Java one button you can
put you know you know extra folder names
and prior to the Java one button CSS and
then it will be referenced in a relative
to where the Java one button classes so
there's a few comments I can make about
that as you can probably tell there was
actually no need to make the job of one
button class we could have just had
these two lines everywhere in our user
interface which is you know we create a
normal jar effects button and then we
add in style class to the button and
that's exactly the same of course
there's a few problems with this
approach one is it's less reusable
everyone has to do the second line and
if they forget they don't get the
results they expect as prone to
refactoring errors for example if our
client also wants to do a Oracle
OpenWorld button they they have to
change these strings or they have to
come up with a common name in any case
they have to do a string replace
throughout the code instead of
encapsulating all with them one class
and finally it's more verbose it's an
extra line of code
so as I mentioned all genrich's UI
controls have a default style class
seating them the botanist button this
view has list - view so you can always
style all the controls in your user
interface using the default style class
so why don't we just use the button and
I really hope you know the answer but
the answer is it might not always be
what you want so this is just a
application hell a whole bunch of
buttons and I applied the rule back here
where I all I did was change job or one
button to button and then the interface
exploded like that now the reason why
they're overlapping is because I've set
the scale in the X and the y direction
to be 2.5 and when we do layouts we take
into accounts some things but we don't
take into account transformations or
effects or rotations and those kind of
things so that's why they were
overlapping if we did something else
that doesn't impact those kind of things
it might look a little bit more saying
that this is taken to the extreme it
occurred to me about a week or two ago
that is actually possible to avoid a
manually important a CSS file so you
don't have to ask your user to call this
or have this line of code on every
single scene where they want to have a
Java one button it should have been
obvious to me it but I've just avoided
for some reason what we could have
actually had them do is head them
override this inside the job of one
button class that we defined earlier on
and this returns a user agent style
sheet for that control and what this
does is basically encapsulates that CSS
file inside that control so every time
that control is used tells a CSS engine
that this is the CSS file that should be
applied to that control and so I would
highly recommend that you do this if you
are going to use this approach so that's
kind of option one it's the very
simplest option is predicated on the
assumption that is a control that
matches exactly what you want that you
can just change those visuals to which
there's probably not all that common
now does anyone have any questions on
option one okay so the question was when
we apply transformations are they
accounted for in the proof worth profile
the answer's no what happens is is
unlike swing geography X has different
bounds so it's got layout bounds bounds
and parent bounds and local and these
different bounds are calculated taking
into account different at parts of the
entire process so the layout bounds do
not take into account any
transformations any rotations any
scaling or anything like that and that's
what the layout container is used to
layout there's ways around that for
example if we put every single one of
those buttons inside a group a group of
takes into account the bounds and parent
so that all those buttons would have you
know being right there next to each
other rather than overlapping I'm sure
there's probably been or will be a
layout session but if you've got any
questions on layout feel free to ask but
there's a whole whole bunch of
intricacies around layout right so
option two is to extend from a layout
container and this is probably my my
recommendation for most people without
building UI controls so why would we
ever use a different person option one
is perfect well as I said obviously
someone has to be the first person to
build the UI control and also in cases
where the there is a UI control that
closely matches and they not match
closely enough it may not have the right
API or too much or too little
functionality and oftentimes too much
API is just as bad if not worse than too
little API because the last thing you
want is your users doing things that
weren't anticipated or you don't want
them to do so the obvious question then
becomes you know there's a whole bunch
of layout containers and Java graphics
which one should I use so here's a
little bit of a know class hierarchy and
I'm going to step through a few of these
would you extend from node well probably
never just just don't do it because node
has no concept of children so the thing
is if you want to build up an anywhere
near proper UI control you're probably
going to have to have children and so
children are how you can build this
hierarchy of nodes so parent extends
from node and adds this concept of
children there it adds children as a
protected variable so you can access the
that you can call the get children
method only from within parent or from a
subclass appearance so if you subclass
parent you can modify the children so
that's really quite you know you I'm
gonna talk about shortly about you
you know the pointers that you don't
want to have more API expose impossible
and sometimes when you're building a
control for example a button it makes no
sense to expose the children of that
control that there's too low level of a
concept you'd rather expose the concept
of text and graphic for example parents
not overly CC star boards certainly
style ball but it that's nowhere near as
good as the next one which is region so
region is a CSS style parent so it's
still got the same concept of protech
good children but it's far more seats
available so the regions are really good
layout container to extend from region
doesn't have any layout algorithm of its
own it's it's going to put everything up
in the top left corner so you are
required to write your own a layout
algorithm unless your control is to put
everything up in the top left hand
corner pane is a region the only
literally if you look in the code for
pain the only difference is that makes
the protected get children method public
so all of a sudden people who are using
the pain class can now call get children
and modify that list and anything that's
in the children list gets laid out you
know and up in the top if they in corner
in the case of pain it doesn't have a
layout of an algorithm of the zone and
then there's a whole bunch of layout
containers then these extend from pain
and what they do is they provide a
pre-specified layout algorithm so you if
you're not familiar with any of these
feel free to ask but
some are better than others for building
custom UI controls common ones include
stack pane stack panes really good for
just layering things on top of each
other all the nodes and your children
list will be centered and slate on top
but in the order they appear on the
children list each box lays them out
horizontally obviously VBox lays them
out vertically and border pane gives you
the top right left and bottom as well as
the center areas so those would be some
good layout containers to extend from so
for the job of one button we could
reasonably pick two obviously our
containers we could pick a region and
the pros of that are that's obviously
CSS tileable everything sees your style
from region down and has no public
access to the children list so it's a
really nice feature for the button like
I said we don't want people accessing
the children the downside is that we
have to write our and layout code stack
pane on the other hand actually is a
really good default layout algorithm
that for our text only button the
downside of it is that it's leaking the
API is leaking the get children method
that we don't want people in BO access
so personally I would choose to use the
region in this case so here's some code
I'm going to slowly fade things in so
because we've chosen the region approach
we have Java one button extend from
region we are now responsible for
building this entire control so we have
to create a label that's going to be
inside our Java 1 button and that's
going to be the other ticks that we show
to the user we create our constructor as
per usual we add the same style class we
see that control to be focused traversal
it's just so that we can tab through and
it will get focused as expected we
instantiate that text label and we add
it to other children list now we can add
it to the children list because we're
inside the region classes subclass so
that's fine it's accessible to us on the
right hand side we just kind of continue
with the constructor code where we add
to event handlers the mouse pressed and
mouse released and the only thing we do
at the present is the mouse pressed we
request focus mix that we add a text
property we want to be able to be user
changed the text that appears inside the
button
so we just use the standard jar effects
properties API we create a string
property called text property it's got a
get a setter and the text property
itself next I perform that we we bind so
what would what we're saying here is the
text label is visual and showing to the
user that we're going to bind to the
property inside the Java 1 button so
that whenever a user calls Java one
valancy text that's going to be updated
visually in the button itself next of
course we see it the text has just been
passed into the constructor and it's
going to have the effect they'll just
see it's gonna visually update the
button now there's a little bit of code
that fades in there so I hope you were
all in the CSS sessions earlier in a
week but what we do here is in the top
left ankle when we say private static
final pseudo class pseudo class state
and then we just say pseudo class gets
to a class armed and all that is to say
we want to represent the concept of the
period between when the user presses the
mouse button down and then when they
release it it was caused as part of our
client requirements we are asked to make
the button look different between those
two stages so on the right hand side you
can see in the mouse depressed event
handler we now have a line of code that
says pseudo class state changed on
pseudo class state is true so when the
mouse is down the arm tutor class is
true and then in the mouse released
event handler we say that the state is
false so we'll cover that shortly but
what this is doing and you can see the
key thing is really the armed and the
speech marks quote max because that's
what we used in our CSS shortly to alter
the visuals of our UI control based on
that pseudo class state changing on the
right hand side because we either exceed
in region we have to start doing some
min width min height next with max
height calculations and so what we're
saying here as a bunch of code but what
all we're saying is that the minimum
width and a minimum height of our Java
one button is whatever the text labeled
with a text label nodes minimum width
and minimum height are we're just
leaving it up to the text label we're a
Java one button we've only got one node
inside
we can just leave it up to the tick's
label to do that calculation for us if
we were to have a graphic in our Java
one button and it was to be beside the
text we might also add into that
calculation the minimum width of the
graphic and the minimum height of the
graphic for them in height calculations
for example the maximum width in the
maximum height will just defer into the
computer if with the compute pre-fight
which is to say the button when place
inside a container isn't going to grow
any bigger then its preferred size so if
the screen was this big and we had a
container this big but our buttons
preferred with only this big it's not
going to grow bigger than that we can
override that by setting the max width
the max height to be double dot max
value which is to say it's going to grow
to whatever size it's got available to
it according to the layout algorithm of
the layout container so the main methods
really though are the compute proof
width and compute proof height and I've
I spent hours doing this diagram for you
so I hope you all enjoy it so compute
proof width so actually first that that
diagram down the bottom bottom is
obviously the Java 1 button and we're
going to now work out what the preferred
worth and preferred height of that Java
1 button is there comes us of the the
text labels pref width which is the
here--it arrow area as well as the any
padding on the left side of the snapped
left and sit so you call that method
then you get a nice pixel snapped value
it's better to do that and to use to try
to work it out yourself because if you
don't get the right number you end up
with borders that are necessarily a
pixel aligned in the in that blurry kind
of crossing over to pixel art to be a
pixels and of course you do the same on
the right hand side you add the right
and set so the sum of those three is the
preferred width of the Java 1 button and
the snap left and set and snapped right
and see of what we get applied to the
job one button via CSS so the you as a
designer or your designer or your user
of your control can specify that they
want and set some padding applied to
the control and similarly we have
compute pre-fight which is the profile
of the text label as well as the top-end
see it and the bottom set and that's my
wonderful diagram but now we do it in
Reverse for when we go to layout so the
layout we first of all work out what the
X's and the X is basically the padding
in from the left and it so what my
question is we're computing the pre of
height and we pass in the width or we
compute the proof with and we pass in
the height what we do is we calculate
the preferred worth but we give the
information about the heights so that we
can you know if you can think of a text
a flow of text you know the food high of
a flow of text is based on how much
widths available because if it's this
constrained the text might be that high
but if it fits that's why did the height
might be much much less so you kind of
need the other argument so anyway back
to layout children which is like I said
the reverse of computing the proof so we
work out the X as the NC of the spacing
in from the left using the snap to left
and sips method again we work out the y
using the top and see it we work out the
width based on the entire width which is
given to us by get width and we subtract
the left on the right so it's the width
you can see there and we work at the
heights based on the entire height
subtracting the top and the bottom
padding and it allows us to put the text
label in there remain in the area which
you know is what you want that way if
the user provides CSS where they want a
huge amount padding on the leaf for some
reason your layouts gonna do it by the
snap lift and see it's giving you a good
greater number for the x value
so this is takeout CSS from option one
and we're going to apply it alright you
can't even see the Java one or the hello
Java one text there so I add to the -
order to kind of indicate where it
should be the problem is is that we no
longer extend from button we extend from
region and so we're not getting any of
the you know the special sauce that
comes from the button CSS so we go in to
madinah and we copy and paste and this
is exactly what that code there from the
coming down is straight out of the
medina CSS file and soon as we put that
in our java one button looks exactly
like our java one button from option one
because literally is using the same CSS
as option one that should look the same
now it's not gonna have the same
behaviour because we're not bringing in
any of the behaviors but we can start to
add more visuals to it for example with
our armed pseudo class state that I
mentioned we added earlier on so when
the mouse is pressed on our button and
held down we change the ethics color to
F expressed based base and again I've
copied this straight from Edina only
replacing the Java one bus it or the
button with Java one button so that's
how we have a custom pseudo class state
we also have built in pseudo class
states in Java fix for things like hover
and focused so when the mouse has moved
over the Java one button and not Prius
just moved over and held over now we
changed the color again to a hover car
so as a lighter color whereas the the
armed color is more of a dark Hallett
and together that's pressed down and
with focus which is when we tab into it
or when we click on it we can apply some
CSS like this and this is again taken
straight from Edina and this is when it
pays to get to know the JavaFX CSS the
language
well the questions why did I have to
code the owned one but not the hovering
focus but you know I had the arm
pseudo-class state in the code the
reason is is because gyro fix has built
into it the concept of hover and focused
and possibly others I forget for node so
the pseudo car states you to kind of
managed internally you know when you
move your mouse over and stuff it's
doing the pseudo class state
transformations directly and David's can
answer right right yes so David's got a
good point so David's point was that I
didn't actually have to do all of this
what I could have done is inside my java
one button there extends from region I
could have also added the style class
dot button and then all the CSS that's
applied from Medina or Caspian will be
applied to the button directly so there
would have been a better way and then we
could have gone back to just that code
that CSS there could it's that's why
David's the CSS expert and I'm not
so success you know we've got our Java
one bus on that is now built using
region we've done a little bit more
layout with you know we've taken a bit
more control of it of the process the
downside of this approach obviously is
it requires more coding but then
someone's got to do the coding somewhere
along the line like I said there's
controls don't kind of pop out of the
year and you know magically appear you
but someone's got to do the first one
the downside of option two is region at
present doesn't have a method like I
showed the option one with that whereas
where there is that there get user agent
stylesheet method where you can
encapsulate the CSS file inside the
control itself so the users have to
write seen get style shoes to add you
know exactly what we had before
they've got add that to the scene when
they use a Java one button but you know
stop press exciting David and I in the
past two weeks have actually changed
things region now has their get user
agent stylesheet what we've done we've
moved it up from control into region and
I'll talk about it much more later on
but it works exactly how it worked in
option one and how it's going to work an
option three when I get to it
which is to say you don't have to have
your users manually import the CSS file
they can just embed it within their
control so which is really nice because
if you have an application with twenty
scenes and they use a job one button
than every scene they've got to remember
too important to end up with a button
that doesn't look right so option three
is to extend from control any questions
on option to feel pretty good okay great
so option three is to extend from
control so this uses the JavaFX control
api that is the way I build controls
it's not necessary for people to use
this approach and especially with option
two now supporting the get user agent
stylesheet method that was the biggest
problem with option two now that's not a
problem anymore go for that just as much
as you know this is this one
the nice thing about this approach is
that does result in the cleaners code
you separate out the state in your
control class from the visuals in your
second class so this is kind of weird
control fits into the class hierarchy at
extends from region the children list
still remains protected so it's not
publicly accessible and adds this
concept of skins and every control has a
skin that's responsible for its layout
and the interesting thing is the control
has the children but skin is able to
access those children just to do the
layout so all we do really is we take
the code from option to the region
approach and we extend from control
rover ven region and then we create a
new class Java one button skin it
extends from skin base so I'm a software
engineer so that skins the code so Java
one bars and extends control instead
region now the constructor is
significantly shorter it's only three
lines rather than twenty odd lines that
we had previously
we still have exactly the same text
property and this is the point David
made one way we could have has done the
styling is to add button as a style
person to here as well that for now we
haven't got let so the two methods that
are important if you're sitting from
control of these two and the first one
I've mentioned a few times already get
user agent stylesheet so this towels are
control what's the easiest file to bring
in and in the second method is create
default skin that towels their control
which skins are load to take
responsibility for displaying the
visuals and we pass in an instance of
this control the the control itself so
now over on the skin side of the plate
we create Java on by the skin that
extends from skin base and the generic
type is just the type of the controller
self Java one button we've got the same
pseudo class state that we had
previously got the same text label from
previous you know this codes exactly the
same as what we had in the region
approaches just they were moved into the
skin rather than leaving it in the the
region code the interesting thing is get
children is there and as I just said
skin doesn't actually
children what we're doing leer under the
hood down and the skin based code is
just a forward in there over to the
children class itself we have some
internal code that does that so when you
add children inside the skin you're
actually adding it to the control but
that's kind of in the moment ation
detail other than that it's exactly the
same code that you've seen already this
is where it gets slightly different in
the comment earlier was why are we
passing in height or width to these
methods well when you get to extend from
skin base you don't just get that path
then you get the NC it's passed in as
well so you get the top right bottom and
left in NC it's and if they're relevant
for your calculations you can use them
in this case they're relevant in the
same way that they were relevant and
read the region approach which is in the
compute pref width and compute pref
height rather than calling snapped left
and c and snapped right and see it we
you just can use the left in the right
and see it surpassed and into the method
the reason we did that as a game because
people were using the wrong numbers and
ending it with non pixels net user user
interface controls and in reality I
should have actually snapped the size of
all those men with them in height
calculations but the point is is that
you you've got to be very careful when
you're calculating these things because
if you don't you end up with blurry
corners so yeah this was like I said
that those are all new in their skin
base approach but other than that the
codes logically the same the next width
and max height are the same that is
clamped and you can see the layout sort
of a method goes from being I don't know
seven or eight lines of code to just one
because you're given the X Y width and
height and because we run in laying out
the text label you just resize and
really look at that text label to be the
width X Y width the height so CSS
remains exactly the same although as
David suggested and another approach
would be to use the button style class
same same demo application
you know it's 60s around three
so the point that I made earlier is you
know this has just changed in the last
two or so weeks we've moved control get
user agent stylesheet from control up to
region as you may recall from a previous
diagram region is the parent class of
control and so there's two big wins from
this first of all all the region
subclasses can now and be a style sheet
and that's not possible that you xx and
like I said it's major job a drawback of
the option to approach the other last
thing is the way David's done it is that
you can isolate the CSS from one custom
control from the rest of your
application and from other UI controls
which is quite important otherwise you
end up with situations potentially where
the CSS from one you are control is
clobbering a totally unrelated part of
your user interface or and someone
else's to our control so there's now
been encapsulated and isolated just to
that branch and if you're interested in
seeing what changes were applied isn't
JIRA number there this is unfortunately
a source and compatible change but we
figured it was worth doing the
alternative was to actually have
multiple methods with different names so
we are breaking things a little bit here
if you've built custom controls in the
past that extend control they have get
user agent stylesheet implementations
all you have to do to be source
compatible both with 8 you xx and 8 you
for T is to change your method from
particular string get user agent style
sheets to public string get user agent
style sheet and they'll work in both pre
and post the API change here's some
useful tips so I've covered pseudo class
dates in the demos we've done for
example hover or armed and the pseudo
class takes a really nice way of Java
Talent CSS to do something different to
apply different styles but what about
the other direction which is style we'll
properties which is
CSE has changed in the state of
properties inside your Java code we
haven't done that yet so an example is
you know for our Java one button we
might have a style property Java one
year and we can
just you know every year we can just
change that in LCSs and we don't have to
recompile our our application I'm not
going to show that demo because I've
taken code from David Rives blog which
is linked here and the other thing is
like I said there's a lot of 8r CICS API
improvements coming up in 80/40 one of
them is that David's made the amount of
code necessary to do style board
properties and much much shorter so it's
gone from being a lot to being not so
much I'll show you the at u-20 approach
you can kind of see the brace down the
bottom left this is the amount of code
that we're going to have to go through
so in this case we've got we're not
doing the Java one button example but
we're just going to a generic example
that I've copied from his website so
we've got my button extends from button
we want to have a style property in our
CSS that allows for the user to see my
food style board property to true or
false so if it's all we have a boolean
property through property and we create
that by creating a simple style board
boolean property yeah so far so good
apart from there through metadata so we
have to create a foo meter data and food
meter data describes to the CSS engine
how to convert the CSS that's coming in
into a value that can be applied to the
UI control in this case the boolean so
we create a style converter get boolean
converter that boolean converter
requires two methods to be overridden
accessable and get start or property as
suitable basically says is this property
inside the my button in this case the
food property able to be see it and it's
able to be see in all instances other
than when that property is bound so
that's it this is boilerplate code that
you can copy and paste if you're going
to create a style board property Nate
you 20 the get saleable property just
returns their property yourself so you
can to see it returns node dot foo so
this describes that property what we
need to do then is that we need to
create a list of all the CSS meter data
that belongs to this button and the CSS
metadata for this pattern consists of
you can see it's very important that you
take note
versus that the button gets class CS
estimator data you have to pre-populate
the ArrayList or at least populate the
array list with all the CSS metadata of
the parent class in this case button
because if you don't do that the only
CSS property that's going to exist for
my button is the food metadata that
we've just defined in the liens prior
which means that we won't be able to do
any styling of CSS meta data relating to
the button class or the region class at
the button extends from and you lose a
lot of functionality then the end result
of all that is that we add all this
button class CSS metadata as well as the
new food metadata property into this CSS
meter data list near the bottom and then
we have to override our gate control
system metadata that returns the CSS
Miller so a huge amount of code and it
actually there's another method that you
should override you should also
implement the get class CSS metadata
which is just a nice convention so that
subclasses of my button can then import
all the CSS metadata so a lot of code
sorry about that you can wake up again
because this is the eight you forty
approach and again the brace has moved
up quite a way so you should get these
impression that it's a lot better so
what we do here is we create a style
board property Factory and you can see
here we're passing and all the CSS
metadata that exists for button wishes
the parent class of my button we define
our food property but you can see we
create the food property differently we
create it from the factory using the
style ball boolean property we pass in
an instance of my bath or the the buy
button instance we pass in the foo which
is the name of the property and we pass
in my foo which is the name of the style
property that will be written via the
CSS and finally we implement the gate
control CSS meter data but in this case
all we do is we pass factory key at CSS
to meter data so it's a lot shorter and
so David's done a good job you know
making it possible to do soluble
properties without losing your sanity so
just a few other tips quickly you ever
running out of time unfortunately UI
controls are entirely styled using
CSS Gerak's - was caspian giraffe x8 was
Medina if you're going to go into those
files go into Medina because it sound
newer style looks nicer and it's done
better you can find these files it just
plain CSS well the CFX CSS files you can
find them inside the JavaFX RT file and
you have got to drill down to calm
Sanjar effects scene control skin and
inside there there's a Medina and a
Caspian package so David Green maintains
a very helpful guide that Rick rolls you
if you are give it time that that's
that's a really good reference document
for people who want to know how to style
all the UI controls that ship with Java
fix as well as just learn generally this
easiest functionality that's available
so just a general tip that you've
probably heard to countless times don't
modify the scene graph needlessly it
isn't free toggle the visibility and
steered the other thing that really
caught me out when we first started
doing some a lot of events and things
like table of view and list view was
that the screen updates at a set rate
the 60 frames per second events can fire
it many times that right so if you're
going to be responding to events and
change in the user interface there's no
point up and the user interface on every
single event that comes in because it's
not going to be seen by the user and
it's going to result in a lot more as
you work so a good way to do this is to
see a boolean that says you know Rio I
deity for your specific UI control and
then when you get around to the layout
children me that or one of these methods
that's called once per pulse that's a
good time to check the boolean state of
this duty boolean and in that instance
you know do what you need to do to
update the visuals that's gonna save you
a lot it was going to give you a lot
more performance and it is a noticeable
amount so you know it's a you know it's
great to get people on our open GFX TV
mailing list you know we welcome your
discussion your suggestions about what
we should be doing or how you want to
help so that's the URL for the mailing
list is a pretty active mailing list is
multiple emails per day
don't assume that we know every bag that
exists because we don't in fact we make
bags and we don't know that they have
come into being and we need you to
sometimes tell us that we have created
them so let us know the best way to do
that is via the gyro fix JIRA docking
Icom don't do while some people do which
is to email the list to say is this a
bug you may as well just file the bug
and we'll tell you that way we can have
a discussion and JIRA and sometimes it's
a duplicate sometimes it's not but we
tend to have a pretty good knowledge of
what's the duplicate we can you know
close as a duplicate pretty quickly you
scenic view I had up off the other night
on what scenic viewers it's a free
open-source jar effects scene graph
analyzer you can find out more at scenic
view org so this is what it looks like
it has a tree view on the left hand side
and as all the properties on the right
hand side and a little overview the nice
thing about scenic view is it's a
runtime analyzer so you start seeing the
view up start your application up and
see any of you will find your
application at runtime and and show you
all the properties which is you know
quite nice there's got whole bunch of
other features too about event tracking
and you know changing the state of
properties and you know it's as well
worth using I often find myself I'm very
you just changing the border of my code
via CSS you notice here style if
exported color red and then I remember
that I've got scenic view which makes
things a whole heap better the nicest
thing about scenic view is that it can
do bounds it can show you the different
bounds which is the question I had
earlier regarding layout bounds versus
bounds and parent for example you can
see this rectangle here has different
bounds that's been rotated I gets 45
degrees so the lower bounds remain where
the square was originally whereas
because the bounds and parent take into
account the rotation the layout bounds
oh sorry the bounds and parent are the
yellow filled rectangle so it's a very
nice way to know that one other side
point on the image is the rightmost
rectangle the one that's covered by the
arrows that's inside a group so if we
were to analyze that and scenic view we
would see that the layout bounds are the
same as the bounds and parent
and the layout bounds would be around
the border of the bounds and parent so
because group takes into account all
transformations follow ethics experience
that's where I put up a whole bunch of
weekly links and news and interviews and
whatever else I can and that's it thank
you for attending those are the links
like I said earlier on if you want to
see you all the source code I've shown
that's a good place to go this Joop just
pops up as I didn't put that there but
you just just just ignore the joke
unless you're going to give me a five
and then maybe do it now if you want to
ask questions you can email me if you
want to follow me on Twitter
that's my turret Twitter handle any
questions yes
no I don't the only card that son on the
CRL is the card that I've showin but if
you email me I can point you to some
open JPEGs card will we do that because
we do it in a lot of the skins yeah yeah
because the thing is on equation was
that you just want to check out a side
of your layout children me that yeah
the answer is yes because you know your
events are gonna be fired because the
users move their mouse over or whatever
you know some but some of the vents
comings from somewhere in the world and
you know maybe a mouse move you know the
move their mouse over the button and
there's going to fire dozens and dozens
of events for every you know money
movement but the layout may not be
happening as quickly as that movement so
why for every single movement waste time
redoing a whole bunch of layer and
computations when you can just see it a
building to true and then once the
layout gets around to having next time
react to it inside the layout method so
you only do a once rather than
potentially dozens of times so because
we have we run at a fixed 60 frames per
second do it that frequently not anymore
because you're not going to see it if
that makes sense right Brian and
typically so so so typically what's
going to happen is everything's going to
come in and what I sometimes do is I end
up with multiple billions I say layouts
dirty or sounds of dirty or something
and we just have different billions to
represent different things there's not
so much they were coalescing events into
a stream of events that within replayed
during the layer I typically just say
the bounds of duties so recalculating
the bounds once per layer so yeah I'm
not I'm not doing anything quite as
advanced is there because I haven't
found the need for it
loading custom controls and scene
builder yeah so I'm it's doable I don't
have a great deal of experience is
summer the basic requirement is is that
scene builder can load your control in
the NIF excel file so if your control is
compliant to the F XML requirements
which is as far as I understand I'm not
I'm concerned that you either have a no
args constructor or you have a
constructor whose arguments are all
annotated with the with a certain
annotation which is named AG which is
basically just allowing F XML so then
you know sits those properties as part
of the instantiation from a of XML I
think those are the main two
requirements for example controls are
fixed we we can dragon that you know
then the scene builder and some controls
work and some don't
just because we haven't actually looked
at you know they're having all the right
constructors and all the write
annotations yet but that's certainly the
plant so yeah you know args or name tags
how people pay attention to the Juke so
the saleable property is the question is
what's the use case for sale or property
and that's for bringing in you know a
rule from CSS and applying it to a
property inside your java code so you
know my food was the example but also
Java one year so Java one year we'd say
that 2014 when that rule is applied it
will be sit inside our our java code so
you know it's it's quite nice to wait
around trip as well because you can
change the pseudo class state which may
have new style properties that push it
back into Java typically we use it for
things like the NC it's or the
background color you know the built-in
starboard properties but there's no
reason why you can't create your own for
use cases with it make sense
two minutes to go sure
right so one control that gets a little
bit neglected or so the question is you
know tickets highlights rich text
controls that kind of thing one control
that gets a little bit neglected injera
fix is the HTML editor control because
it lives in jar effects dot web so
that's kind of what you're asking about
not really what it is is it's basically
an editor so it's got all the you know
toolbars across the top from a text
column font in size and all that and
that generates HTML output but in terms
of a proper rich text editor or the
ability to it is it more than a 13 or
more than rendering so so that exists
yes that exists and Geographics and Tom
Schendel has presented an implementation
of that based on I believe ListView
as well as custom cells we do rendering
each of the rows so it's very very
efficient kill me right right yes so
that's the other thing so there's also
alright so it depends if you want takes
editing or just text rendering for text
rendering there's the text flow control
which yeah does that it does it really
nicely you know spent and it wraps
around multiple lines you can change the
font colors and layout if you want
editing there's open source projects for
that as well as the HTML editor hope
that answers your question but anything
more
so that that's leaning more towards Tom
Tyndall's doing with his rich text
editing control there's a few different
people who have done rich text editing
controls some are based on web view
where they bring in a JavaScript library
for that kind of thing Tom jingles one
is native Java fix all right well we're
out of time and it looks like we're out
of questions thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>