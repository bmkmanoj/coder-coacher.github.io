<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Practical RESTful Persistence | Coder Coacher - Coaching Coders</title><meta content="Practical RESTful Persistence - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Practical RESTful Persistence</b></h2><h5 class="post__date">2015-06-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/o-PnIS2YSkw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">good morning everyone and welcome to
practical restful persistence my name is
Doug Clark and with me today is Sean
Smith
we're both product managers we work in
the WebLogic GlassFish and of the fusion
middleware stack in addition to our
Oracle responsibilities we're also very
active in the open source community
leading and contributing to the eclipse
link project which will be the core of
the technology that we'll be talking
about today it looks really good over
here this is my standard legal slide
obviously my computer felt that you guys
have all seen this enough no no but it
kind of leads me to believe that there's
other problems going on just second I
think whoo that's brayer
this is great because we have some demos
at the end and there's always some sort
of failure it's nice to get it out of
the way with the projector early on well
while that sorts out all I'll give you a
little bit of background on how we ended
up here we've worked on the top leg
product in various different roles with
Oracle and a couple of companies before
that for 15 years now our main focus has
been Java persistence how we deal with
integrating Java with relational
databases but over the years that's
really expanded we've started doing work
in XML persistence eventually
implementing Jack's B were obviously
drawn to jax-rs restful integration and
JSON processing and binding some other
stuff we're not going to get into today
that some other sessions might be of
interest to you within our product line
we deal with and no sequel persistence
now being able to integrate a couple of
different no sequel databases buying
them into a JPA style application and
leverage them within almost back and
leverage them within your Java EE
applications maybe just warming up ok so
a brief history on the JPA side for
those of you who aren't intimately
familiar with JPA
it's the object relational persistence
standard within the EE stack we
obviously predate this going back to the
early 90s but we were really trying to
build a framework that dealt with
lightweight persistence or plain old
java objects there's been a couple of
different technologies related to this
come along obviously our backgrounds
with toplink hibernates probably the
most popular open source solution in
this space there was the JDO standards
and then EJB evolved with different
ideas of persistence up until EJB 300
when JPA came along
and it really standardized this kind of
notion of pojo persistence in in a
lightweight fashion for both java SE and
e integrated containers so the one o was
e 5 2 o was 6 and then most recently
we've shipped the JPA to one reference
implementation for e 7 within GlassFish
so just a little plug for the e 7 stack
obviously we're very involved with that
and you'll see how it connects to a lot
of the rest related work we've done so
JP a21 introduced a lot of incremental
features in the in the persistence space
a lot of things that the various vendors
had already done on their own just kind
of standardized them but more
interesting to me in the e7 stack is
really the enhanced support for html5
related technologies getting rest
interface with JSON processing exposing
them over a rich jax-rs solution
WebSockets we won't talk to today but
obviously fits in nicely with what we're
building as well so as far as an agenda
goes this is a the stack that we are
trying to help customers build and this
is what we're going to talk to you know
from the database on the backend where
you store your enterprise data right out
to the browser so just to fill this out
a bit so obviously in today's
applications most customers are looking
at thin server architecture based
solutions html5 JavaScript they want to
leverage all the capabilities of html5
offline storage WebSockets server-sent
events and although rest is not
intrinsically part of the html5
definition it becomes very prevalent in
how you get data in and out of your thin
server applications
so HTTP there we're looking at HTTP and
HTTPS for rest calls to the server and
then we're into the world where we spend
a lot of our time dealing with
persistence so when you get a rest call
across or you send data out you're going
to send it in other XML or more likely a
JSON format so we need to have a way to
easily get our data into and out of
these payload structures and deal with
the rest Resta fiying
your back-end services in an appropriate
fashion for these clients the Java
persistence layer you know dealing with
JPA
accessing that databases whether they be
relational or no sequel and then as far
as tying it back to the e7 technologies
the jax-rs
specification defines the bindings for
how you present rest interfaces we're
primarily dealing with the reference
implementation of that in the jersey
project the eclipse link project that we
lead and all this technology is based on
has a component called moxie for mapping
objects originally to XML now we do a
lot of our extended support for JSON
binding but the X has lived on so we
continue to call it moxie
Eclipse link JPA is your object
relational and no sequel support for the
database so what we're really talking
about here is how do I get my data into
an object representation that I can
leverage it in my custom application
logic in the middle tier expose it out
to a rest client in a JSON or XML format
and then use it successfully in a thin
server html5 JavaScript based client so
really it's round-trip from the browser
to the database using an e7 or
in a lot of our cases in ee6 stack one
thing I would like to make clear is all
the technology that we're talking about
has shipped in Oracle products it's
available in gloss fish 4 and WebLogic
12 1/2 so everything in here is
available today in both an e6 and e7
based solution the bottom half of the
stack is you know historically what
we've talked about at these conferences
how do I get Java in and out of my
databases that's not what we're going to
be talking about today we're really
looking at assuming that you have some
kind of object model in the middle tier
that you can persist to the database and
then how do I deal with these New Age
clients so how do I plug in to jax-rs
and how do i do my xml and json binding
to make that all function together so
the first piece we'll talk about is the
XML and JSON binding solution another
important thing to learn about building
slides at open world is when you build
your last set of slides before you go to
the bar to drink beer make sure you
really sent it to yourself the the
version we had last night was fabulous
the version we figured we had 20 minutes
ago little extra graphics but all the
contents there ok so binding persistence
as we call it dealing with xml and json
so historically toplink and eclipse link
have always had mapping files for
dealing with how we define the
relationships between our objects in the
application space and what the database
structure is so over the years we
started reading an XML file after XML
file we upgraded versions scheme has
changed we went from DT DS to schemas
and eventually we ended up with our own
object XML mapping solution and it
worked really well as infrastructure but
you know we kept evolving it and
eventually it became a public feature of
our project and became a jack speed to 1
to 2 implementation so if you're running
in WebLogic
twelve one two and you do any XML
binding with Jax be you're using the
eclipse link moxie solution it's the
default implementation in there so we do
xml two objects which is still very
important but in the rest space getting
from java to json is obviously what most
of our clients are asking us for there
is no standard in this space when we
talk about json in e seven we're really
talking about JSON processing so there's
an api that are very similar to the xml
processing spec the actual binding spec
for how you map objects onto json has
not been standardized yet although as
you'll see we have an implementation
that is being proposed as the starting
point what we do currently is we
actually use the whole jax be
infrastructure and we just throw a flag
to say whether you want xml or json
which really makes the integration nice
so that if a customer calls in with one
of these map solutions and they want
different formats for different use
cases it's really just a flag a one line
flag in our code so here's what XML
arjax be binding looks like if you've
done any Jack's P with annotations
you'll see there's always an XML route
element there's an implicit mapping of
the elements in there and then I can do
a couple of other relationship based
mappings XML element wrapper and
elements for how the phone numbers are
stored so if you take that customer
object create an instance of it and
marshal it through a Jack's be context
marshal ur that's on the far right
that's kind of what the XML will
effectively look like by simply changing
the media type on the marshal er I can
get that JSON that you see so it is Ajax
B based solution for JSON binding there
was a lot of challenges we learned in
doing this dealing with the database as
our history has has a lot of different
characteristics for how we can handle
relationships bi-directional
relationships a lot of different
cardinality rules but when you start
flattening things out into a textual
represent
in XML or JSON you run into some other
unique issues dealing with cyclic
relationships different key structures
and how they relate to objects both
embedded within a parent object and
related within the same document or in
other documents and then a lot of the
implementation details of how a JPA
implementation deals with persistence
involves bytecode enhancement or
bytecode weaving and that adds
additional state to your object so if
you take a secondary technology like Jax
B and you look at an enhanced object all
of a sudden it's reading a lot of
interesting information into your XML
and JSON that you would not expect so we
had to deal with these scenarios as well
to come up with a a binding solution
with a high fidelity to the persistence
or the database solution so we can look
at a simple example here to show you
what this means here I have a customer
and a phone number this is a JPA based
mappings each customer has a collection
of phone numbers and each phone number
knows which customer belongs to so here
I have my my collection relationship my
one-to-many and my one-to-one back if I
was to persist that into XML you'd see I
have a customer within a complex type of
phone numbers and then each phone number
in there and that's marshaling it out
when I unmarshal it back into my object
model the customer has its collection of
phone numbers but by default jack speed
doesn't realize the inverse relationship
it can't handle that so we've had to go
in and extend the configuration set to
allow our persistent solution to deal
with this so here all I've done is
extend my JPA
configuration with a Jack's be extended
annotation to say that when you populate
this owner relationship you're just
using the inverse phones and that gives
us all the information we need at
runtime to marshal it out in the same
flat structure and give ourselves back
the customer with the phone number
it seems trivial but these kind of
things are really painful if you start
dealing with complex object models you
end up with 30 40 50 objects in your
system and you have to manually go in
and deal with every one of these special
cases so our customers who have really
embraced this find it really easy to
start using this and it just happens out
of the box for them so some of the
challenges above and beyond just dealing
with JSON or XML binding is when we
first started into building rest
interfaces to a JPA back-end it is
really really simple to do things wrong
if you follow through a lot of the
samples you know I take a beam I put on
there that it takes a get operation I
can look up an object I can return it
I'm off to the races and all you're
doing there is dealing with the
mechanics of how rest functions you're
not really exposing a rest interface so
when you start building out a true rest
interface you're gonna find you have to
create a lot of these beans you need to
start dealing with what exactly is a
resource a JPA entity maps to the
database basically at a table or row
level is that is that table or that row
your resource and a rest interface in
most cases the answer is no a resource
is more of a business level object it
usually has contained relationships it
scoped at the you know at the business
level and something that the application
consumer something on the client side
would ask for if I'm going to populate a
screen with a customer and his phone
numbers in that I don't want to make ten
calls back to the ten different rest
calls back to the server to get all the
data for one customer my customer is my
resource I want to create customers I
want to get customers and then there's
this transformation between this
resource model and the JPA model and we
spent a lot of time trying to build out
a solution that gives you the
flexibility to deal with that because
just looking at the jax-rs demos you'll
find it simple
and then as you get more into rest and
you know Rastafarians as they sometimes
call them there's a there's a real
purity to how a rest model should look
and it is challenging in the Java space
to do this properly and of course you
you can't lose data so as I showed you
in the in the marshaling back and forth
by send objects out over xml or json to
my client they manipulate them and send
them back i can't be losing any
information from the client back to the
database it has to remain intact and
consistent okay so the next piece of the
stack is this jax-rs implementation and
how we bind into it to build this
appropriate rest interface so for those
of you who aren't intimately into the
rest space represent represents a
representational state transfer and this
where it comes down to the resource
model what is the addressable resource
if my resource is a customer I need to
be look up look up a customer buy ID I
need to be able to put or post a change
back to that customer create a new one
it's all about having this full
lifecycle of these rest resources and to
deal with a stateless interaction with
the server jax-rs
is the Java EE standard for dealing with
that and it has a programming model to
build these endpoints for rest access
and a lot of api's for how you plug in
different transformations and handlers
within the within these rest beans it's
a very annotation based programming
model as most of the e6 and e7 standards
are I guess our specifications it's a
little out-of-date there
yes the 339 is final and shipped within
the e7 family of standards so here's
what it looks like to build a rest
interface in jax-rs
so I have a beam class here's an invoice
service and I have a method in here to
go and read and return to me an invoice
so using a JB's at stateless annotation
I marked that this is an stateless
session bean within the invoice method I
have a JP a call to do a find operation
for the given ID and return that invoice
now this is a very simplistic model just
to show you the mechanics obviously
you'd have a lot more error handling and
input and output checks to make it
jax-rs enabled I have to give it a path
within the you are a URI space of my
application so what this says is at the
slash invoice of my web app I'm gonna
have a listener for this for these rest
calls and then the specific rest call
I'm going to support is a get where the
path element after invoice will be the
ID of the one I'm looking for
and then to specify that again within to
get it into the input argument I need to
add path per am and then the name and
then in addition to that I can tell it
what kind of data will come back so here
I'm going to say I could take XML or
JSON and this is what it looks like from
an HTTP request obviously I have the
Machine port the web context for my
deployed application and then the part
I've specified is the invoice and for so
this means go to the database through
GPA do a query find the invoice for
bring it back and return it to my my
caller jax-rs implicitly will do a jack
speed binding for that and by default it
will return to me an XML representation
of that object using whatever Jack's be
configuration is available or defaulted
for my option
so to look at the how this works
structurally I have the jax-rs layer I
have my custom application which is my
session being in my any application
logic I have a JP a persistence unit
talking to the database through JP a and
JDBC and then I have these invoice being
as I've shown you with those annotations
and that lets me register the listener
and process the requests when I get that
get that I showed you and the container
will find that that slash invoice is for
my invoice beam it will take the for
find that path per am and look at the
get operation that I'm calling and map
it on to that method within there it
will look at the injected JPA entity
manager make a query my fine they'll go
to the database and I'll get my object
returned back up to the caller so what
we've built here and this is kind of the
whole essence of this talk is a better
solution for dealing with this what I've
shown you is the pure JP a and jax-rs
standard functionality what we
discovered through our own research and
working closely with customers is that
that's a lot of work for every single
rest call you have to do that set of
operations and I haven't even shown you
all the exception handling and all the
error codes going back to the rest
client so what we've done is built a a
better integrated solution between
jax-rs Jersey and Eclipse link and we
call it j pers for exposing a JP a
persistence unit over rest so the key
thing here is it automatically builds
this entire rest interface for your
persistence unit each of your entity
types can be realized as a as a resource
the full lifecycle operations can be
exposed and you don't have to do much of
anything and we'll show you in the demo
how simple it is all of the rest
operations are automatically wired all
the XML and JSON are automatically set
up for you they can all be customized
but they're all available with default
out of the box all of the queries that
you defined in your persistence unit are
exposed as functional operations get
operations within your HTTP interface
and as I said all the XML JSON is
automatically done and all the features
we've built to make JPA
and xml and json binding work together
are automatically enabled out of the box
all of your relationships between
resources are now realized as links
within your XML and JSON payloads so
that if I make a rest recalled rest
request to get a customer and then I
want to get all the orders that customer
has I have an a link in there that the
consumer gets and they can actually
navigate the model remotely and all
we've done to enable this is we give you
a web fragment a jar file that you drop
into your web and flip folder of your
war file and everything is turned on and
then okay again all of that can be
customized as you learn more about how
you want to present your model so now
the stack looks a little different we
have jax-rs dealing with this GPRS layer
we have our persistence units and then
on the bottom end we still talk to our
database now for all those different
operations across all my entities and
name queries here I have an get I have
my context route in this case I've set
it up to BJP RS I want to talk to the
accounting persistence unit it has an
invoice and then maybe the number for a
find operation and then we go through
this JP s JP RS transformation layer
where were you decode what you've asked
for look up the write persistence unit
translate that into the various JPA
operations and execute them on the
database and then on the way back up the
objects get converted and realized in
the proper format
so just to summarize again the features
we're giving you this full rest
interface with JSON and XML it gives you
the full rest access to two-year
persistence unit and it's entities
there's a rich documentation explaining
the full URIs that we build all the gets
puts post and delete to properly realize
these objects as resources the
underneath that you have the full
Eclipse link persistence layer that
means I have all the performance
optimizations for dealing with cached
objects plugging in stored procedures
dealing with optimized joins and
transformations on the database if
you're dealing with the Oracle database
I can then leverage you know XML DB
support I can leverage PL sequel
functions everything we do specific for
the Oracle database as well as the
general features available to all
databases are built into this solution
the last bullet on there is a little bit
of a different feature we we added and
as we started integrating the solution
in more and more consumer apps a lot of
them found that they were just trying to
get from rest to the database so we
added capable capabilities around
dynamic persistence which is a name we
coined for persistence without Java
classes so just based on XML mapping
metadata will spin up the whole
persistence unit in the rest interface
without any Java classes at all so if
you don't have any custom logic and it's
just pure data transformation routing
out to the front-end then we've come up
with a simpler model that works with
some of our more dynamic clients okay
and here's a sample I'd like to walk
through just so you get a feel for what
the JSON looks like so obviously this is
a JPA entity of an employee or a
customer they have first name all their
standard basic attributes
responsibilities as a collection must be
me it has no responsibilities
salary version but down at the bottom is
one of the interesting pieces we've
expanded in our binding solution this
resource this employee resource has an
address and instead of actually
embedding the address the address is a
separate resource in my system so I get
a link and I get the the reference the
href so I can go back and get the
address of this employee so it's it
really gives you this model you can
fully navigate from the client now
the other aspects of it that are not
shown here that I'll get Sean to show in
the demo is a full metamodel so I can
actually interrogate this system and say
ok what operations do you have available
one of the different get query
operations and now I can build very
dynamic clients that can ask the system
what it can do and then navigate to
those and then if I upgrade the system
over time this metadata will continue to
enhance to show the customer what's
possible three minutes fast so Sean's
gonna walk walk us through a demo of how
all this functions within what server
using yeah that's good right I want to
go back a second so this business of
Link's here is is huge I mean we we were
dealing with it for a couple years so
Jack's being a sort of mentioned a slide
Jack's be is greedy all right Jack's be
will marshal until it can't stop anymore
right so just goes down through through
the arms model you have right transitive
closure so when you may have you had
just plain old Jack's be making a rest
call it's gonna marshal up a ton
sometimes and in the case of the
bi-directional relationship stuff you
might get stack overflows too so we've
done a bunch of work to basically let
you say I want to pull some data off the
server marshal it but don't give me the
world right this is actually a big deal
so this business of we automatically ISM
as as Moxie Jack's be as marshalling
when it hits what it knows to be a JP a
relationship in this case is a one to
one it says okay I'm not gonna go down
that path I'm gonna inject me our link
provide a reference to let you get to
that thing and just pass it down so this
so snipping of the connected graph in
two pieces but yet it's you
constructible so reconstructive all the
clients once the client gets this
employee they could fetch the associate
address and build it up and in fact I
actually do this in this example here I
pull down pieces of the object model and
and then work with that the pieces I
want so yeah I got overwhelmed with the
fact that this looks really easy but
it's really being a pain in the butt for
like years and I didn't whine about it
so I'm I'm actually really excited this
actually works now but the point where
you go yeah it was so no that's really
bad okay isn't it what's bad for me too
the model is really simply a in this
example is an employee who has a
question of phone numbers and an address
okay something very exciting about this
except that there's a one-to-many
relationship here and a one-to-one so we
have some JPA relationships the phone
numbers or I think it's the phone
numbers do have a back point of view so
their owner just like we saw in these
samples and will soon follow
just dump in the code take a quick look
at code here so this is gonna okay hang
on let's go into giant font mode for a
second here bond you know he was saying
for years it should be a feature to let
you just crank the font and apparently
there is a plugin for Eclipse to let you
crank the font I just don't know where
it is okay let's try this
alright giant fonts great so let me
shrink this up I'm new to a Mac so you
know I think I have a screen displaying
is good right we are not those guys okay
so here's my employee it's got a bunch
of name queries on it right this is a
braced and 'red GPA a couple of little
extensions here as an object type
converter here a clips link feature that
lets us map between gent in this case
it's a gender object type and a simple
feel like M or F in the database so it's
a conversion there's some fine dolls
here some so find all employees boring
we've got simple stuff like names simple
stuff like mapping attributed to a
different column name etc so it's very
straightforward JPA kind of works that
here employees have managers they have a
collection of managed employees list of
phone numbers this is all pretty pretty
vanilla JPA there's no Jack's being here
there's nothing here at all so what the
model we have is you work with JPA you
get to JPA working correctly and then
you deployed your web application drop
in the web fragment and magically all
the the jacks be map marshaling
information is deduced we spin it up
dynamically so behind the scenes is if
you have have annotated them but you
don't have to if you do annotate some of
these classes with Jack's P annotations
will honor them so if you want to take
the default behavior and tune it a bit
like you want the shape shape the
external shape the jason'll but you
certainly can do that out of the box it
just does it all for you
and then of course the phone number is
just a phone number with its main one
back right so I have that loop so I'm
gonna go over to so I was deployed and
screen to airplane if I show you the
target here so I build this with derby
up with Derby I built this with maven
and so it's built it for me it all done
in the maven pom if your maven fans
who's using maven self-interest yeah
good okay so half of you know what I'm
talking about here I'm pretty new to me
even - so I have a dependency in here if
I can find the dependency
this is I'm the wrong model sorry my web
application this application is built
with angularjs and Twitter bootstrap if
you look at the I can't see it from here
unfortunately it's filtered all I've got
in here is I've got a web application
with the model jar so the domain model
employee that model is jarred up on
there with the dependencies just above
No thank you that's good so I cut the
model jar I have GPRS here that jar and
these two jars so two jars basically put
into a web application and deployed
that's already all I've got done here
and then there's a bunch of JavaScript
and HTML that that GPRS element is the
web frame the web fragment so it's quite
small and really isn't it there's two
classes in there they just let us
bootstrap up the jax-rs services we need
to do so there's really not much in that
jar it's just there for the container to
detect them give us some control to wire
ourselves in to the container so let's
go over to the jar so Doug mention that
there's a lot of metadata available and
I think I'm not quite fitting on the
screen here
I'll just go down one not trying to fit
bit more no I guess not
we automatically produce a way to obtain
the metadata so that that persistence
you know that we deployed if I go to
this root you're right right now it's
bound to persistence v1 this is my
application here employee web GIS if I
go to that I can get back a list of all
the persistence unit so I may have
multiple persistence units deployed in a
given web application and with that URI
I can go off and fetch sort of a catalog
of what's available for me so I'm
building a dynamic clients I have a
fully interrogate able system I can find
out what data is available so in this
case I know I've got this employee
persistence unit so I'm gonna go look at
that and see what's available for me and
I can see I've got in that persistence
unit I've got a number of different it's
quite narrow here I'm gonna go dance
down one in the back that's not working
huh you can't see that yeah
right I have phone numbers information I
have metadata about the address let's
look at the address for a quick second
here so I can't arrogate oh yes I have
an entity called
address I get it has seven attributes
and the names the attributes and the
type so this is telling me if I make a
request for an address this is what
you're gonna get so I can actually you
know browse this and interrogate right
now this is not following any particular
standard in fact the problem with Jason
is there really is no standard for
communicating structure so this Jason
schema is a possible standard we're
looking at migrating to that so we're
we're pretty stuck than we came to
deciding because we didn't know what
would be a standard right there's no
standard what's popular what's not
popular Oh data there's number of
different formats so the version of
shipping right now is kind of a
homegrown but I think that it's not far
off from what you would get enough Jason
it's a schema so you see here and what's
cool also about the the metadata is it
gives you a number of templates for
links for example I want to affect a
particular employee I have a template
here it gives me the URI address slash
the primary key a put post and delete
method if I go look at let's see if I do
this here if I go back one go back to
yes in the wreck the top here's for a
second I'll go down to fill employee
there's a bit more information employee
had all those name queries right so
navigate my way down the clients quite
handy to be able to just of navigate
through and browse through the metadata
so here's employee take a look at the
metadata okay so that's the structure we
saw before and down the link templates I
have those then I also have Curie
templates so I have I can do an employee
count by invoking this query here but
let's give it a shot so do it get what I
get 10 so there are ten employees we're
actually ran a piece of jpq all there if
you look at the console you'll see that
ran it was can those compiled into
sequel and I skipped against the
database and then returned back to me I
can also change that to get XML back and
so as Doug was saying the the Moxie
Marshal on the server
even said the media type
we pass the media type here from the
client it gets assessed to me to type on
the marshal Arachna front I request
there we go
right so there's a service some syntax
here around the structure of what we're
returning
I'll stick with Jason because it's a
little bit easier to parse alright so we
have all this metadata so if I do
something like I see her I'm fine go
back to the that other query here
it's easy to go with your history
although I can't see the history because
it's too clicked let's try this one I
think that's good okay so look the
employee structure here so if I can do
something like a find all I see fetch
all the employees this is typically a
bad idea to fetch everything but I can
get it all so let's look let's flip out
of this thing this is a client right
there
plank query let's build an app so I have
an app here and I should say this
applications checked into the eclipse
link examples get repo so if you google
eclipse link examples you'll find the
main examples page there's a link on
there to the subsidy so will subversion
some older stuff and the get so we sort
of migrated like many people were
migrating so some examples are still in
subversion this stuff's all I'm get I
see clip link employee examples and it's
under JPA and you can pull this down try
it out yourself and that should all
build with maven and you can pull it off
to GlassFish 4 or to WebLogic 12.2 so
I'm gonna bring up I can do this so I'm
gonna show you the network so this is
Chrome and this is the because this is
WebKit a little network monitoring panel
so I can do things like invoke a query
so here I've got a query for find me by
first and last name and JPA so I've got
this query on employee yeah yeah buncha
name queries here I have a find by name
and notice a fine by name has parameters
like parameter and like parameter so in
the rest interface those become of
course parameters on your URI so I've
wired this up to the screen here and I'm
actually gonna bind these input values
here to the
their songs because they give me
everything right so you see the request
made I get a results set back here you
take a look and that's gonna be
impossible to read down there I'm afraid
I don't see any way to make that bigger
either let's see here
screw it here yes all you see is this
Aquarius has employed a find by name and
his first name equals parameter value
that from the screen and parameter value
the second name so it's quite
straightforward to so build UI bound to
these URLs I knew things like doing edit
and fetch you'll notice there's a bit of
activity here so I mentioned before that
we snip the graph and so at this point
and infective alluded to this there's a
question of what is your resource model
looks like there's no way in Java today
to express a resource model so jax-rs is
concerned with exposing rest interfaces
but there's no metadata to describe what
is the scope of a resource what does
that mean but that's the concept exists
conceptually right obviously but there's
no way to express it
so we've taken an approach today and
I'll call a naive approach where we said
every entity is a resource any object
that's an embeddable object in JPA this
part of another object is not a resource
so if you fetch in this case an employee
it's a resource and so are the addresses
and the phone numbers they're all
separate resources which means that when
I fetch the employee I just get the
employee I don't get all the addresses
and phone numbers so in this screen I've
actually pulled down address and phone
numbers and so I had to make separate
calls going forward and these are the
first question people ask having seen
this is can I change that can I bring
down more data can I effect it to be
less chatty so that's a feature that we
obviously know we need to improve we
haven't implemented yet and what we're
looking for there is how can we take
this model which we this jpn any model
which were we're coming up with a jax be
model on top of that how can we then
further influence that to say well the
scope the resource is this this piece
rather than just the default behavior so
it's something we know as a practical
concern we're just not too sure where it
fits is it a jax-rs problem is it a Jax
B problem and whose problem who's gonna
own this
like who owns the resource model it's
not really totally clear but let me see
here so you see here when I did a fetch
for the employee does a request for
employee slash one those in the front
row can actually read that and the
response comes back with the object here
and all the links for the other objects
initially you'll see that I fetched the
phone numbers in the address so I
actually populate this screen by
fetching 303 resources so it's nice
about this is I make a change I do a
save goes back to the server side you
see them we see over here we need an
update to the gender of the employee
whose values are passed over here so I'm
not really a client-side developer guy
like we're server-side guys you know we
used to have sexy sequel con you know
I'm even showing you the sexy sequel
output that was the best we could do now
we have now we have style sheets you
know and so you know we're learning you
know JavaScript HTML is stuff you know
the client side stuff and it's actually
really easy to do that so once you get
once you see that once you get the idea
what is the API what is what are these
rest calls return for you building that
client was actually not that hard
because I'm you know I have a model I
can pull down some pieces display it
click a link make another call fetch
that data push this data back it's very
much a very simple rest rest model so I
think that was the the title was
practical I think it's very practical
and straightforward so I think we're
pleased where we got to there's
definitely room to to enhance this like
I say the rest the resource thing is is
a big deal the other thing is that again
there's no JSON binding spec today so
we're looking at you know the JSON
binding becomes a standard obviously
supported that standard in this stat -
okay
so I think that's what I have so you
know our story is no ee7 is expanded out
more to client we are strangely if you
look at that stack we were always on the
bottom of the stack and then maybe
became sort of a piece up and high up in
the stack and our challenge was how do i
navigate the full stack back and forth
whereas a Java developer and it's not
that easy in that you're going from the
different primary models right
relational model into a Java model to a
resource model it's a whole bunch of
different things are dealing with and
we're trying to smooth that over so try
you know shave off the rough edges so
these things fit together so you can
build applications obviously things are
evolving and we think this is a really
good step in simplifying this sort of
thin server architecture kind of
application style that's all yeah so we
think with a quarter class today we're
happy to take as many questions till
we're in yes to ask the hard question
right away yes yes link right right now
the only way to do that is to change the
map the JPA mapping you'd have to move
that to an embeddable right or the
question in that case but yeah that's
something that we would have to change
and the question is sort of is it in a
dress case right his address always part
of the owned object or is it only in
this case so is it the relationship it's
this is a control de resource or is it
that entity is it always an embeddable
resource jp-21 introduces entity graphs
and kind of the next step in this
evolution would be to extend the entity
graph model so it can be your default
resource scoping right and then there's
also a notion of request specific
scoping right so we so that's true we do
have a feature and I think it's
partially implemented where you can make
a request and say it's kind of like a
like to say it's entity graph right it's
kinda like our old fetch groups you know
fetch this and the other pieces it's
kind of cheating in a rest way but it's
efficient right so it's practical yes
the partial yeah so the same solution so
I don't think this features implemented
either so we have this notion of being
able to do a partial read of an object
in database so we have a fetch group so
you say readme the object with 10after
used to get me to if we know if we
understand that context that you've only
taken the two if we our feature describe
this feature we've identified is you
make a request and the request will say
and we're Lea data use this fetch group
it's a name fetch group certain
parameters when you post it back you say
and by the way this is obvious coming
back to you was fetched with this fetch
group we understand what's relevant and
what's what you've touched or what you
want us to update because as it is if
you don't do that you can this back on
object that's missing pieces we'll
assume they're gone yeah so there is a
way to override that it is possible
today to do queries the returned parts
of an object that come back as kind of
data sets but not in an object or a
report but then it's just for a like a
report query just for reading or
projection there's no connected right
back right and then the fundamental
challenge will be is if somebody reads
back apart reads a partial entity and
puts or posts without telling us it was
a partial you could have some data loss
so so you're going through the same
thought process as we I'm right so this
is like make it work and then there's
optimizations like don't give me all
that data it's a big object don't want
all of it I want part of it or I want
more of it I want the Associated objects
these are all the tweaks bells and
whistles we need to talero on but being
able to declaratively set this up will
kind of take this solution to the next
step and yeah very eager to get that
going
yes
what can you do a little bit of level
security to the question no it's it's up
to you at the access level our JPA
solution does let you tie into back and
label security VPD or label security if
you want to tie it all the way back to
having the database control access our
only security model we've done on the
front end is ease URI based restriction
where I can act set up authorisation
groups and then challenge the user to
when you hit certain you are eyes so we
do have a page up on our wiki for
setting that up in the e6 in these seven
servers where you edit the web.xml to
define these groups and which your eyes
are restricted it gives you it gives you
the feature level access control but it
doesn't give you the row level now we
have one down here sorry
we spent a lot of time on performance
our core JPA level and our XML Jack's B
are very much a part of the oracle spec
J benchmarking efforts so we do a lot of
micro optimizations on how there's a lot
of money pieces it in the performance
yeah the end end performance of the this
whole stack we haven't done a lot of
detailed analysis just the individual
pieces within it we're very happy with
our end end performance you know Jersey
and the jax-rs piece the the
benchmarking standards having got to
that level yet they're still dealing
with soap based services yes
right yeah you'll notice in Sean's demo
light neglected him we hit this problem
really quickly yeah we we shipped our
first version and the open source side
of things without a version number in
the API structure and we realized the
folly of our ways so you can see that so
we actually version the API yeah so if
you go if you go to deploy your second
version of the application with an
extended entity model you would just
bump up that version and then you could
keep them both running right and I
neither feature this that's sort of
lurking there is right now the structure
is sort of what we're defining we
realize that you don't want your
application to look like it's an eclipse
link you know GPRS application you want
to shape the your eyes yourself and so
do some some mapping is gonna be
possible to let you shape the URL so
that you know it looks like it's part of
your app rather than exposing the
internals of what we're doing every
every bigger organization we deal with
has a group of engineers discussing
their rest standards for how they're
going to expose rest interfaces and we
need to fit within each company's
produced rest your eyes structure and
not force our own we realized that one
two yeah yeah
you mean like a JavaScript client that's
that I it's funny to that because I
thought about doing that like once you
see that as metadata they're the
medicines are very regular structures I
thought I'd be pretty easy to put
together a sort of generic client
thought your browse data but it wouldn't
I mean it's a data browser it wouldn't
he do something you want to embed it but
seems pretty doable yeah we've talked
about it but there's been no real work
on the client side we've kind of kept
ourselves on the Java you know enough to
be dangerous on the client side
basically we can spell JavaScript okay
oh one more okay it it works with JP it
with eclipse link JP a and yeah that's
what works with yeah so this this is an
eclipse link stack we get this question
a lot we leverage a lot of our knowledge
have how eclipse link JP a functions in
order to do the Jax bj's on binding and
the rest integration so it's it's not
possible today with hybrid a yeah
oh yeah so I'm going back to that
earlier slide what we're doing is
because there's no standard on JSON
binding right now right we'll see here
how I jump back hey Cho
an escape out of this mode huh we're
really at this point just interpreting
Jax be right so like in this light here
we've taken the Jax P metadata and use
that as the guide so really it's pretty
much exactly what Jax B has the
structure is the names of the names you
can override the names of the elements
you can there's one little subtle tweak
in here you'll notice it on phone
numbers there's no phone number
level in JSON right because it's
redundant in adjacent Roy we have an
array of object so I don't think this is
this is pretty intuitive that it's
pretty much like the xml same names wind
change Jason becomes along well it's a
good and bad story the good story well
the good the bad story is that right now
we can use the same metadata to produce
two different models which is awesome
right I can flip a media flag and I can
get different formats Jason B is
probably gonna have a whole set of its
own annotations that won't be the same
as Jack's B and so you may have to empty
twice to to tune or tune with different
sets of annotations but it'll probably
be the same in the end I don't think
there's a lot of flexibility in terms I
don't as far to go we've not come up
with our own rules for how we represent
XML as JSON so it's same as some of the
other frameworks out there
jettison yeah it's it's pretty much
well-trod ground I don't think there's
anything too strange in here yeah
yes yes yes yeah no I asked our
developers because we have it we have a
tight dependency on Jersey and eclipse
link so anywhere you could set up an
eclipse link Jersey compatible container
so it can run on Tomcat should be able
to be pluggable own into almost any web
container yeah I don't think we tried it
but why not you know I mean it's just
pretty standard stuff we're just fitting
together about just standard
technologies right so the fact that runs
on Tomcats a good time right obviously
we're a little more focused on that our
Oracle Steiner you know but but Tomcat
works so why not right I mean there's
nothing we're not anything strange here
is because the developers are stuck to
the spec api's for jax-rs right and
that's the key thing so it should just
drop in yeah yeah
yeah it's a question so even if that the
metadata actually shows you the JPL
which is probably a bad idea
right like it's one of those you know
showing too much so that's probably good
to go yeah we but then the question of
do you want to give people sequel
injection opportunities right type of
thing it's debatable I don't know in our
early proof of concepts you could pass
in JP QL and we could interpret it on
the server sure but in the end we backed
off to a more it's kind of declarative
exposed API yeah and even that we
realized that you know some of the JPA
things are leaking out right so we
should fix that up we were like the tape
EQ all showing it's probably not my
client developer whether it be html5 iOS
Android they shouldn't have to care how
I mailed my back-end so we're gonna have
it even things like the Java data types
right is into the right words that
integer like what's the right word for
describing that data type right now
there's some Jabba nuts in there too so
you know it's a it's a pretty good sort
of 101.1 at this point he's one point
one issue where we are yes
for DCU designing your home
oh yeah it is really the translator the
format going back and forth name so
that's something that we looked at
supported it's certainly possible we
haven't decided but it really is
that's just describing what the protocol
is across the wire it doesn't really
talk about the modeling on the server
side which currently is really in this
cases
JPA centric yeah sure
yep yeah it could be that we support
Howe data at some point today everything
everything we do you could build
yourself this is just integrating the
pieces and making it easier it's not
really at the point of extensibility
where you could plug in a node ADA
adapter but you know it's all open
source code you could look at where we
plugged in our custom Marshall ER and
transform that if you needed to yeah I
said that but I I was wrong
he's Jackson Jackson that's Jack's rst
learn dependency it's we did some tight
integration with Jersey and then in the
end it's it's a pure jax-rs annotated
class that we put in that web fragment
jerseys the only rest implementation
I've played with but anybody who is
jax-rs compliance should be able to pick
up this if you're running in a container
that identifies the web fragment and can
process this annotation you should be
fine
yeah sure yeah it's on my list to get
the engineers to test with rest easy
very similar to what yeah its melting
point so the the rest easy guys have
attempted to do this to a degree it's
not really all the way there I would say
I mean then I've talked with some of the
developers and our approach is we want
to take all this links and stuff for you
it's just how it should just work and
with rest easy they make you do a bunch
of work to try and reduce these links
and I like ours better you know but just
me it would be a really bad presentation
if I didn't expect there's better yes
yes this so eclipsing is just a
foundation EPL EDL software right it's
certainly you can use it with in rad no
I don't know whether the rad guys remove
some of the wtp tools or not because our
team actually wrote the the JPA tools
but you don't need any of that stuff
right it's just a runtime library you
don't need it mean you could if the
tools don't work you could have put
notepad and just code this but I don't
know how much of RAD picks up they pick
up some of the JPA tooling that works
with eclipse link because there's very
specific eclipse link feature support in
in eclipse and so i think IBM picks it
up but they tend to rewrite a bunch of
stuff and substitute their own
components so all you need to be able to
do is set up JP annotations which could
be an IDE integrated solution or it
could just be a Java text so it's a
runtime solution right it's totally
one-time if you get to the latest builds
of WTP I can actually point at the
database generate my entities from the
database structure into a web project
drop under drop the jar file into the
WebM flip or set up the maven dependency
and deploy actually the index that we
can actually use in the eclipse tools we
can actually generate a mapping file
that describes what the objects would
look like that don't exist and deploy
this XML file and it will resolve if
there's no war it's a war file with two
XML files in it you get the full ripple
stack is built
it's not for everyone no okay one more
oh we're past our deadline are we</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>