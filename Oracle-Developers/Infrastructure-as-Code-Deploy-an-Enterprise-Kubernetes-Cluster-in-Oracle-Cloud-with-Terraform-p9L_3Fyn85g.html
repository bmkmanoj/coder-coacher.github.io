<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Infrastructure as Code: Deploy an Enterprise Kubernetes Cluster in Oracle Cloud with Terraform | Coder Coacher - Coaching Coders</title><meta content="Infrastructure as Code: Deploy an Enterprise Kubernetes Cluster in Oracle Cloud with Terraform - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Infrastructure as Code: Deploy an Enterprise Kubernetes Cluster in Oracle Cloud with Terraform</b></h2><h5 class="post__date">2018-02-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/p9L_3Fyn85g" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right thanks everyone for coming I
know you guys didn't get much of a break
and they have beer in there so that's
hard to fight
I appreciate y'all's time today so this
is infrastructure as code and we're
gonna show you how to deploy an
enterprise kubernetes cluster and Oracle
cloud infrastructure with terraform and
we're in Los Angeles today so I'm Gerry
Ward and on my left we have Eric
Espinosa
and on my far left is Charles Kim Oracle
ace director and president of our
company which is viscosity so we'll go
through it's just a brief introduction
promise to be brief here then I'll talk
about docker kubernetes in terraform and
the tooling that we use to build this
enterprise infrastructure and then I'll
turn it over to Charles Kim who got more
he'll talk a little bit about you know
why you might want to use Oracle cloud
infrastructure as one of your options
and what makes Oracle cloud
infrastructure unique and then we'll go
into a demo that Eric built for us where
he's gonna deploy a kubernetes cluster
onto the Oracle cloud in probably five
or six minutes and do some testing and
he'll show you a real live micro
services application and that's really
why you guys came here so we'll take
some questions and at the very end we'll
be giving away a book and this is a
blatant bribe for you to stay till the
end so a little bit about me I'm from
Austin Texas I'm an engineer and
developer I started back in the 90s with
C C++ I was one of the first folks on my
company to use Java Perl Python and I do
a lot of JavaScript nowadays but I also
started using Oracle way back in the day
so
been around for a while co-author of the
Oracle cloud solutions guide which will
be giving away at the end of this
presentation and also co-founder of
viscosity North America I'm a private
pilot and also if you have time to talk
we have a booth in the exhibit hall I'd
love to talk to you about the boondoggle
that my wife and I started which is a
vineyard in Argentina that also runs
Oracle but that's a long story
so more about the pocket solutions guide
this is a 100 page book where we take
you from basically taking an Oracle
cloud database or Oracle database moving
it into the cloud and we keep adding to
this about twice a year we update this
book so if you have the Kindle edition
you automatically get those updates and
to win this book it's real simple just
text cloud uppercase or lowercase to
four four four nine nine nine and it'll
give you a dialogue and at the end of
the show we'll will award those books a
little secret
everybody that texts here will win and
speaking of books you know Charles is
really well-known author in the Oracle
communities written over 13 books or
written or co-written over 13 books at
viscosity we have 18 books on Oracle
cloud and what we do here is we partner
with the Oracle product managers on a
lot of these with Oracle press and we
co-author with with you know various
industry experts and and push this
content out to the community so this is
just one of the more than a hundred
presentations we've done in the last 12
months here in Los Angeles and so
viscosity is really about three things
data infrastructure and apps all right
around apps we do devops micro services
we do DevOps in the database which is
kind of struggling to keep up but a lot
of a lot of places we do Java legacy
Java applications we modernize them and
move on to
Oracle Java cloud service we do
platform-as-a-service for software
as-a-service so there's a lot of gaps in
Salesforce com there's gaps in Oracle's
software-as-a-service apps and we plug
those holes with platform-as-a-service
and we do integrations around that and
also what I wanted to offer you is that
you've got five hundred dollars in
Oracle cloud credits so to put those to
good use we will be happy to do a POC
for you guys for free whatever you want
to do we'll sit down discuss it with you
and help you get started using those
credits and maybe even build a live POC
for your company just a few of our
clients these range from small companies
to nonprofits all the way up to the
fortune 50 so I don't know if you
recognize the cover slide it was the
SpaceX plan for colonization of Mars
terraforming Mars basically and this was
the not the launch of Falcon Heavy but
this was the static fire and SpaceX is
really interesting because they like to
test things they put big straps on the
rocket and they fire the Rockets this is
something they didn't do a lot of in you
know the Apollo days but SpaceX likes
continuous integration continuous
delivery model much like software and
they model a lot of this stuff in
software and so I really look at it
almost as software-defined
infrastructure right to be able to test
and continuously deliver mmm-hmm
and that's kind of inspiration for you
know a modern micro services development
today as we move from developing code to
actually building infrastructure from
code so take a simple application I've
got a node.js application and I might
put that in a docker container okay and
you know no big deal I can deploy that
into the public cloud but usually that's
I want to do a little bit more you know
maybe hook it up to my sequel right if
I'm hooking it up to a data
bass I might as well have a persistent
data store or dr site where i'm
replicating that data and then you can't
just have one of anything right so you
need to have an auto scaling cluster out
there and so now I've got some
infrastructure components that I need
them to talk to each other and discover
each other I've got to orchestrate some
of that so I'll also want to configure a
load balancer and have it do the same
right so you know maybe deploy this into
the public cloud whether that's Google
or AWS at this point do I need a high
level of automation do I need
infrastructure code not really but what
if I want to do more than just deploy it
to a single cloud provider what if I
want to deploy it into my own data
center onto OpenStack all right well the
tooling doesn't really exist you know
the cloud native tools their various
different SDKs and api's across these
providers maybe I want to deploy it to
Oracle cloud infrastructure which
Charles is going to talk a little bit
about what makes it so unique on to bare
metal for example so I've got a high
performance dense i/o bare metal cluster
and worrell cloud infrastructure or I've
actually got 50 raspberry PI's in my
closet that are running in aetherium
minor maybe I want to deploy it there
right so I need something that's very
flexible where I can write the code once
and deploy it in many places and then
this can get more and more complicated
let's say I have a Python app I want to
bring in other data sources like elastic
search I want those to discover each
other and I want to talk to them so now
we're getting a little bit more
complicated let's take a modern micro
services example and this is going to be
one of the reference architectures this
this is open source on github you can
download it there but basically we've
got user connecting to a front-end
written in node on the backend we might
have a legacy application and dotnet or
Java which is an order management system
let's say that connects to a database
and then we've written some micro
services that are easily deployable and
go so we've got a payment system which
connects to a third party payment
gateway so no database there but user
management let's say we've got that in
Mongo a catalog system in my sequel in a
shopping cart system in Java and then on
the back office we're connecting to a
shipping system and a various bunch of
other types of systems that are
published and subscribe to a RabbitMQ
queue so that's a this is the reference
architecture that Eric is going to
deploy today using infrastructure is
code but let's get it a little bit more
complicated so let's say I need the
exact same configuration as a
development system right so right so
I've just doubled the amount of
infrastructure I've got let's say I want
a disaster recovery system so then again
now I'm starting to get lots of
components that I need to keep track of
right let's say that I've got I've run
40 consecutive tests I'm on the
forty-first tests right so I've got in
my own environment and I've tested the
40 first it didn't work so I'm gonna
destroy that environment and configure
the forty second test right so these are
the kinds of things where we're starting
to get so much infrastructure there that
we need to codify this in such a way
that we can build it repeatedly as we go
through our continuous integration and
continuous delivery anybody using
containers everybody know what
containers and Dockers most everybody so
just briefly on containers on the Left
we've got a virtual machine
and on the right we've got containers so
with a virtual machine the guest OS has
everything so if you multiply this
enforced you know if you if you have
your binaries and your libraries
deployed to the guest OS it's going to
hold everything and when you have
multiple VMs you're gonna basically
repeat this infrastructure everywhere
you go versus containerization is much
lighter weight you're only you're
sharing everything on the operating
system and you've got a container engine
and then you're basically just packaging
up the libraries with the application as
you deploy it
okay now docker is extremely popular why
because developers have made it so
popular because developers installed on
their laptops they may put a database on
there they're building out their
continuous delivery applications on
their laptops and these really
popularized it and it's given developers
quite a bit of power so as we start to
build out this infrastructure we need to
do things like orchestrate it right so
kubernetes is basically a platform for
orchestration it's basically you know
taken from some libraries that Google
had been building over the years I think
we first saw it in 2014 and now it's
part of the cloud native computing
foundation anybody go to docker con or
cloud native Kubik con and Austin this
year ok that's where I'm from so pretty
cool next year I think it's in San
Francisco so or this year it's going to
be in San Francisco
it's got massive community behind it in
traction and it's really focused on
productions and operations and they have
very rapid releases at least once every
three months but more frequently than
that we've seen it and it's got a huge
community behind it even more of a
community than you might find with you
know docker swarm or some of the other
orchestration platforms and that's why
we really like it and its really gained
a lot of traction so you want to build a
self-healing self scaling auto
correcting cluster kubernetes is really
our go-to
from there and then terraform is really
about infrastructure as code and the
idea here is that you're gonna treat
your infrastructure the same as you
would treat code where you're gonna have
continuous integration pipelines where
you develop test deploy stage and push
to production the other thing is that it
codifies your infrastructure into a
human readable format so you can you
know understand it see it in one place
and the text format that we use you know
either in JSON or other markup language
allows us to commit it to a source code
repository create versions of it and
break it up into modules so if we have
let's say deploying web logic with some
containers in it onto a kubernetes or
onto a docker container we we code that
once and then that's available for the
rest of our developers to use so it's
very repeatable in that sense it allows
you to create execution plans and what
these are is basically it can look at
your current infrastructure let's say I
need 15 nodes in my cluster and I've got
10 so it looks at the current state you
prefer it prepares the change let's say
I only need to add two five to that and
then it allows you to generate the
execution plan to see exactly what the
effect on that infrastructure is going
to be before you do it and it's only
gonna run the Delta so that's really
important it has a concept in it called
resource graphs and what these are is
basically auto-generated dependencies so
if I've got a basically a node web
server that's dependent on a container
as a block storage container being
created it's going to create the block
storage first then the node container
right so it can go through and and
execute those components in the correct
order
and it's it's basically built for multi
cloud deployments so Oracle cloud
infrastructure Google AWS OpenStack and
even VMware and all the providers have
glommed on to terraform and they've
basically you know pretty much in any
infrastructure you want to deploy to you
can either use their provider code or
build your own and so what what it might
look like is you know here's here's a
volume that we're creating a 100
megabyte gigabyte volume with compute
instance on an Oracle server the shape
is an oc-3 shape so that's out on
cloud.oracle.com and then it allows me
to do things like reference these
variables in a kind of a declarative
sense
the first thing we'll run is plan and
that's going to tell me what what the
effect of this is going to be so it's
going to basically to to add 0 to change
and 0 to destroy so these two components
that we defined and next we'll run
terraform apply which executes the
chains in the order based on the
resource graph and it can parallel eyes
those changes when possible and it can
handle and recover from some of the
errors transient errors for example not
everything sometimes you have to debug
it but but yeah so that's that's apply
and then the opposite of apply just
reverses the order and we've got
terraform destroy so what's very common
in the terraform world is i've got a
cluster running my production but I
don't want to have I want to have zero
downtime so I'm gonna build the
infrastructure from code for my next
production and if everything smoke tests
okay I'm going to cut my DNS over and
then destroy the old infrastructure so I
have a zero downtime and so this is very
important to have these these three
commands working together Oracle has
released their own provider it's on gift
hub
and you can download this you've got 500
dollars in credits so just go to
oracle.com slash code 500 la so that's
plenty enough to get you a kubernetes
cluster up and running a fact eric was
gonna run one I think it costs about $1
for him to start and and destroy this
thing so you can do it at least 500
times but this is Oracle's example and
you can modify it so it creates a highly
available kubernetes cluster on your
oracle tenancy it creates the virtual
cloud network all the subnets and
instances that you need and it allows
you to specialize the shapes and and
that sort of thing so you can scale your
cluster as needed
so our deployment workflow today we're
basically and you can do this a variety
of ways you can actually have the
infrastructure as part of your build
process or you can have it separate so
what we're gonna demo today is pretty
much this piece so that's why we've
separated it but basically Eric's a
developer he's built the code he or he's
built the infrastructure he's gonna
stand it up basically check it out of
the source code control and clone the
repo and then run those commands we
talked about a knit plan and apply and
that's gonna go in provision kubernetes
and a the reference application that the
order management system for a sock is
basically a socks company that order
management system is going to be
provisioned in the Oracle cloud and then
we'll flip some switches if we if in
this case we don't need to but we could
flip some DNS which is for that example
we talked about where you know we're
doing a zero downtime deployment and
then a logical extension to this would
be to incorporate a Jenkins process
where you clone the repo repo build your
app run your smoke test and then ready
to you're when you're ready to go you're
going to deploy it onto the
infrastructure that you just built
so with that I'm gonna turn it over to
Charles and he's going to talk about
Oracle cloud infrastructure and what
makes it unique and why you might want
to integrate this into your multi cloud
strategy before I begin how many of you
guys are actual developers and how many
of you guys are infrastructure slash
Oracle DBA types I was actually
surprised because I got to stop by in
the audience and we're talking about
this particular presentation and they
were asking about 18c Oracle cloud and
why would I want you know as a DBA want
to move my databases and applications to
Oracle cloud right and so and so but the
the thing is is that there's a you know
our jobs evolve over time you know we
adapt and it's not you know from a
database administration perspective you
know it's more of getting to know your
data now you know the the whole be in a
database right that's gonna eventually
start to phase out a little bit you know
that's going to be you know outsourced
to other companies or offshored and
stuff like that right and as we continue
to first computer thank you know yeah so
as we continue to work in this space
right our jobs are gonna actually evolve
and it's going to be more about data
analytics right and doing data analysis
being a development DBA data modelling
right and and now it's gonna be even
learning things like this technology
right we may not be the guys who are who
are developing you know the code to do
DevOps but you know the more we know the
better we can service the business it's
gonna be about how do we work together
with the business a little bit of up
myself I've been doing Oracle since
91 and written quite a bit of books and
one of the books that we actually author
together with Gerry is an Oracle cloud
and we are going to add dev ops chapters
to the book so if you're interested let
us know and everybody here can actually
get a Kindle copy of the book and it
goes from talking about storage cloud to
talking about database cloud talking
about doing infrastructure as a service
- we have a white paper that we wrote
with Oracle on doing a lift and shift of
on premise PeopleSoft to Oracle
bare-metal cloud service and we're gonna
add a chapter on how to do it with EBS
and we're adding chapters for the IO ug
conference to collaborate conference
that's gonna happen in April in Vegas so
for that one we're gonna add chapters on
Exadata cloud and and lastly we're gonna
add a chapter on universal credits and
so it's gonna actually be called
demystifying universal credits because
oracle changed how we license an Oracle
cloud at the end of last year so for
those who are new to Oracle cloud how
many of you guys have looked at Oracle
cloud okay cool
it's good to know so a lot of the people
who looked at Oracle cloud 2 three years
ago right didn't like it as much and in
fact a lot of the features - three years
ago didn't render it for performance and
functionality and so the past year
Oracle made dramatic improvements to
their cloud infrastructure and they've
actually changed the name and so the
technology that they used a couple years
ago that they actually call it Oracle
cloud classic or OCI classic is what
you'll actually hear and the new Oracle
cloud is what they call Oracle cloud
infrastructure or you'll just hear them
say OCI right and so now we're talking
about a brand new technology and the
reason why it's relevant
is every year as an organized director
there's about a hundred of us in the
world and we actually get to go to
Oracle headquarters before open world
and we get to meet with all the product
management and a few years ago when we
met two years ago right it was the same
group of product management guys that we
knew who developed OEM who developed
other other products at Oracle they were
the product managers for Oracle cloud
right and so that's why you know we
didn't see the big advancements that we
expected right last year when I went
however it was a complete new set of
faces and so what Oracle did was they
hired the best of Amazon they hired the
best measure and even Google and they
basically wrote him a blanket check he
told them what can you do to make our
cloud better and how would you architect
it if you were to redo your entire
infrastructure all over again Amazon
that's a pony I want you to do for
Oracle cloud right and so that's why you
know after a couple of years right they
you see all these new advancements and
I'll go through some of these with you
all right
also I happened to be AVM or V expert as
well and most companies out there run
VMware right and a couple years ago also
Oracle bought a company called Ravello
and what Ravello does is that it does a
lift and shift of VMware workloads to
Oracle cloud and so it literally takes
your application stack your database
stack and any kind of complex
application that's built right and you
can learning move them as a single
blueprint to Oracle cloud and you could
have you know development instances and
QA instances right in Oracle cloud right
and so I'm gonna go through quickly some
of these things right so what makes
Oracle cloud so special is that in the
networking stack right they implement it
what we call off box virtualization so
what off block virtualization does is
it moves the management of the
networking and the the actual virtual
networking itself right it moves it out
of the hypervisor and sticks it back in
the network where it should be so the
hypervisor doesn't do any of the network
management piece right and also what it
also that gives them the ability to do
is to do what they call private overlay
network and so whether if the server is
virtualized or if it's on bare metal
right the communication happens directly
to the actual hosts its own okay also
with their network they have a concept
of a region so in the United States we
have regions within the United States
right within each region let's say for
example Phoenix Oracle has a huge region
they're right in that within that region
we have what we call availability
domains and they'll have minimum three
availability domains within a given
region for H a and scalability right and
so within a communication between
availability domains which is basically
a data center right the actual network
response time is about less than 500 you
sex so for those who are not familiar
with what an oosik is a usek is a
microsecond so when you do a ping across
your network right your response time
comes back in milliseconds right a you
SEC is a mic is measured in microseconds
so between data centers right the
average response time is going to be 500
microseconds that's within a between one
data center to another data center right
however if we talking within an
availability domain which is within your
actual data center itself right or we're
guarantees that you are not going to go
beyond two or three hops to get from
your application to your database server
so what does that mean in terms again in
terms of network performance you're
going to be guaranteed that it should be
around a hundred you sex or below 100
microseconds right and so between data
sinners right oracle lays out dark fiber
between the data centers for those who
don't know what dark fiber is right is
that it's the technology that people but
that we're using right now to do
clustering between data centers right it
has to be between within 100 kilometers
right and it gives you that reliability
that that people need ok so we talked
about within data centers right
also within an active domain right you
can get up to 1 terabit per second of
network performance that's huge
right and also within the the actual
servers within each act availability
domain right each server has two network
ports right each network port is 25
gigabits today all of your servers today
will most likely be 10 gigabits right
forkel has already invested in 25
gigabits two ports on each node and also
all their networks are 25 gigabits also
right twenty-five gigabits translates to
3.1 gigabytes per second right within
each host right you you can a
theoretical number a six point two five
gigabytes per second if you take 225 gig
cards right and establish 50 gigabits
right depending on how you bond your
network active-passive or if your
peering right and so within Oracle also
we have four kinds of storage we have
your traditional storage that you guys
know all the Amazon guys know about
object storage right so Oracle has
object storage they also have archival
storage which is in Amazon's terms
glacier storage right and Oracle also
has our block storage which is common
across all the other cloud providers as
well Oracle also has nvme storage for
bare metal cloud and so customers who
are leveraging
they're lifting shift capabilities
meaning I can lift and shift my entire
application and database to Oracle cloud
right and they need that heavy workload
right they can go to bare metal cloud in
Oracle and recent you know papers are
out that within bare metal cloud they
can achieve five six million plus I ops
with in bare metal cloud right so there
aren't that many applications out there
that has that kind of demand right and
also Oracle has the exudative cloud in
their o CI as well so I'm gonna talk a
little bit about some of the use cases
for terraform okay so one we have a
customer that work with right now and
we're actually they have three data
centers across the United States and we
instead of it being a list migrated to
Oracle cloud it was more of a
conversation with their CIOs and to talk
about
let's modernize your your technology and
let's modernize your application stack
and let's consolidate you to Oracle
cloud and Oracle was pitched as a data
center migration and consolidation right
and these guys heavily leveraged
kubernetes and heavily leveraged
terraform and so for these guys it's
more about managing hundreds of nodes
and thousands of and thousands of pods
and they automate the heck out of this
thing and we're going right into Oracle
bare-metal cloud with them right another
case that we have is leveraging
terraform with just VMs and bare-metal
inside a local cloud so for you guys who
are running Oracle right new companies
right you guys pay for annual support
costs of Oracle right and when you're
talking about doing infrastructure as a
service in Oracle cloud for example
right you're going to be paying yeah on
a per hour Lea or a monthly basis
metered or non meter kind of basis right
and with that right
the whole idea is that as you as you're
paying for metered right understand your
workload right if your oil TP for
example right you're gonna be busy
during the business hours and however at
nights right you may be sitting idle if
you are running a data warehouse for
example right you may be idle or
relatively idle during the day and super
busy at night as you're doing loads
right well terraform I can actually go
automate the entire increasing and
decreasing of what we call Oracle CPUs
right
and because you're paying per OCP you in
the cloud right so we could easily for
example from the get-go we do should
license cost in Oracle cloud by half
leveraging terraform right so if you're
OLTP will spin down your OCP use to be
like 2:00 in the evening however before
you start your workday right spin it
back up to 16 right and do the same
likewise right in reverse for data
warehouse workloads right and so with
terraform we can get to the point where
were some customers right even get to
Oracle cloud for free by just paying for
your support cause we're terraformer I
can actually go and do all that level of
automation and that's what well show you
some of how to do that and Eric will do
that for you right and so you saw some
of the examples that Jerry showed you in
terms of how to change a terraform
script and you can actually apply right
and that's the whole idea we will up and
and decrease euro CPUs right so in the
world of kubernetes right what we would
do is we would actually spin up number
of nodes or spin down number of nodes
and we'll help you control your cost
that way right with terraform we can
scale up and scale down and definitely
from a licensing and cost perspective
right that will actually help you with
that as well so with that I'll turn it
over to Eric and let him give you a demo
terraform with kubernetes can we seek to
computer number two to
okay so Jerry already talked about some
of the concepts of terraform I'm gonna
start off by showing you guys this file
this is just a configuration file that
we're gonna use for our demo and it
essentially you know lays out what are
the different settings that we need to
use in this case for Oracle OCI we need
to define the tendency and all these
weird ideas that you guys see here is
just you know those internal IDs that
the Oracle cloud used to identify
different resources and objects so the
tendency the account itself has you know
an internal ID the compartment there's
you know an identifier for the user
itself and of course you know in which
region I want to deploy my or you know
the resources that I'm about to create
I'm gonna head over real quick to the
main file from the kubernetes installer
and you know I'm not gonna go in detail
on this cuz it will take us a couple of
hours but essentially this is what Jo
was showing earlier right here's how you
define the different resources that are
going to be deployed into the the cloud
provider in this case this code is for
deploying into the OCI right we have VCS
we have some cloud controllers we have
drivers that we will need to for force
for the kubernetes cluster specifically
and we have a bunch of other components
that we will need in order to make our
you know our deployment of this
infrastructure into the cloud real quick
I'm gonna head over to the two
repositories aren't important first of
all is the term provider for OCI
and this is essentially the plugging
that abstracts how to talk to the Oracle
API to create the different resources
right so this is a project that is
currently supported by the Oracle
developers community and it's open
source you work
- you know check it out and you
definitely will need it in case you want
to try you know deploying resources into
OCI with terraform and the other
component and I think this is what's
going to be most important in our demo
it's the Installer itself so what the
Installer it is is is the code the the
actual code that is going to be run to
provisional resources so you know again
you can just look at in to check it out
and get and github under the Oracle's
github account so we're gonna start off
by you know invoking or terraform
command we're gonna do in it in this
case I already did in it so it's gonna
tell me that my terraform repository was
successful initialized what it does is
that it downloads some other provider
plugins that I will need in order to
deploy my infrastructure the very next
thing that you guys would like to do is
you know write your code in this case we
already have our inning right which is
the terraform installer so in our
specific case we're gonna head over to
our configuration so what I'm gonna do
is you know this is where I'm gonna
deploy my resources and this is what I'm
going to deploy it for now the
architecture of the cluster we would
that we're deploying is you know we're
gonna employ three master nodes we're
gonna employ three etc' nodes and
initially we're gonna deploy only one
working note it gets later I'm gonna
show you guys how quickly you can scale
up the infrastructure in terms of the
kubernetes cluster just by you know
making a change in our configuration
file and issuing terraform plan and then
apply so i'm gonna do this real quick it
will take you know about five minutes so
i'm gonna do plan and plan is getting to
basically it's you can see it as a
compiling process it's gonna go over all
my code and make sure that I'm you know
providing the right parameters that are
required and validating some other
parameters right that the right format
it's being provided and at the end
very important is going to tell you hey
I'm planning to add fifty-four resources
what are what are those fifty four
resources will you know it will list
them for you
writes creating subnets I'm just gonna
you know highlight a couple of them here
it's creating a bunch of subnets it's
creating a workers in subnets and
masters in subnets and you know it's to
me it made my life easier because you
know provision of vcn can can get a
little tricky with all the rules they're
writing rules and stuff like that and
it's something that this coronet is
installer already has built in so you
guys don't have to worry about it unless
you have a very specific use case around
your networking so next thing I want to
do is you know of course apply and apply
is gonna take the plan that I just you
know compile and it's gonna start
creating resources this is gonna take
about five minutes it will ask you hey
do you want to proceed creating these
resources I'm just gonna say yes I'm
just gonna start creating will let it
run for a couple minutes in the meantime
I'm gonna head over to my Oracle
Infrastructure console as of now you
know if you see just popped in my vcn
it's it's been provisioned I'm gonna
head over to my computing section this
Terminator instances are all my tests so
I'm just gonna filter by the running
instance I don't have I don't have any
running instances right now cuz maybe
hasn't gotten to that step yet a very
important thing is you know it's very
important in OCI to keep all your
resources the group you know within the
workflow or within the logical grouping
you know again that you guys need in
this case I created a compartment for my
kubernetes right and I also have a
compartment for my DevOps so you know
all the VMS all the resources network
resources subnets VCS Phoenix they're
all gonna be grouped within my
kubernetes compartment
let's check it out still running before
you know I jump into that I'm gonna talk
about you know and you guys saw this
already from early in the presentation
this is the architecture of the micro
services that we're gonna deploy at
first you know we're gonna get an empty
cluster but it's gonna be only the
infrastructure no application in it and
then we're gonna deploy our micro
services application into our cluster
see it's going it's creating load
balancers now it should be should be
done in a couple of seconds I think
another important thing to to mention
here is for you know the typical use
case from what Gerry was mentioning
earlier in typical continuous
integration and continuous delivery
environment is that this you know
essentially this configuration file can
be different from environment to
environment so for instance this can be
my development environment shape right
I'm gonna have four VMs right for
production I can do something you know
slightly different I might want to do a
two for actually two for right that will
be a fork or two gigs of memory right so
I'm gonna be playing with the
configuration of my environment and I
can very well take this file committed
into a repository so every time I want
to build my you know workflow or
workload from scratch I can just say
okay I want to build from my prediction
reproduction repository right so all
that configuration can be stored in a
repository and you can just manage all
the tenancy variables as secrets into
your Jenkins instance check real quick
I should be almost done we're gonna
check our console if you guys see you
know a bunch of VMs have been
provisioned already we have some for
etcd which is the the persistence layer
within
Nattie's I have a master note and I work
your note so should be done here in a
couple of seconds in the meantime I'm
gonna head over to my micro syllabus
application so you guys can take a peek
into what that looks like so for my
micro services application I'm defining
a deployment for per each of the
components so the front end is going to
be a deployment itself it what a
deployment is in this case it's just a
docker container right so in that case
I'm able to simplify what my deployment
processes so all the logic of each
service is encapsulated into the
container so I can you know maintenance
give maintenance to that component by
itself without worrying about where is
gonna be deployed right and how is going
to be run into a infrastructure
environment it's taking a little bit
longer than I expected
probably we're not yet there and in the
five minutes they were you know I'm
building it from scratch so should be
ready there you go so you know at the
end you can see this green sort of
output that means everything is you know
good if you see red and bad news you
will have to go back in debug what you
did wrong and you know will tell you hey
I apply it completely and I created 54
resources real quick I'm gonna export
and this is specifically to kubernetes
I'm gonna export the could be config
environment variable and kubernetes
create a config file for me to be able
to connect to my kubernetes cluster so
all right so I'm gonna issue my QB
control command and I'm gonna say get
notes just to make sure all my notes are
up and running so this is one way for
you to take a snapshot of your current
state you can also commit that to get so
as part of your deployment process you
see the before image and the after
absolutely looks like still finishing up
their provisioning
might be my network all right I'm gonna
get ready over here what I'm doing right
now in the meantime because you know the
infrastructure is already in place but
the kubernetes cluster is starting up so
it might take a couple of minutes to
fully be up and running so in the
meantime I'm gonna head over to where I
have my application right and this is
what I was showing to you guys earlier
sorry I have my you know this is just a
configuration follow how my application
is laid out and inside of the kubernetes
cluster so I'm just defining deployments
and you can think of a deployment as a
you know container image and I'm
defining services for those deployments
so what this means is like in a
kubernetes cluster you will have one of
your services let's say you know I'm
gonna bring back my diagram so let's say
the front-end component right we can say
okay my front end component is going to
be a deployment and depending on the
load of my system I might want to have
multiple instances of my front and
deployment so those instances are called
pots inside of kubernetes so you can
think of a pot off you know a single
instance of your application or you can
put in running but on top of that you
know all the orchestration happens and
it's called services so you will have a
service in front of your pots and the
service is essentially going to take
care of some sort of a load balancing
between your different instances right
so all right
it's there's nobody in that room yeah
let me see
no no there's there's actually someone's
room there
still connecting oh I remember now so
yeah there's a security component I
forgot to turn on so you need to tell it
that I need to be able to talk and this
is one of the things that you know I
totally forgot about this and this is
part of you know the beauty of terraform
right I forgot to say to tell my come on
we need to do a terraform plan and this
is gonna take you know it's gonna is
gonna recognize that I have some changes
to be applied to show me you know 17
changes three actually 17 to add three
changes and 17 to destroy so I'm going
to do terraform apply
why that number was so high because you
know I have multiple subnets inside of
my vcn one for each availability zone so
that's what it's accounting for so
should be fairly quick way over are we
over okay oh I'm about to be done just
Nita okay all right this is what happens
when you do a live demo so I just want
to give you a taste of you know that
it's super easy to build up your green
ideas cluster all right
okay almost done one more to go so you
know again what I'm doing right now is
just opening the rules for my little
balancers at the masternode snack level
and at the EDC notes level so I can talk
I can remotely manage my kubernetes
cluster so
soon
should be almost on
still turned it down yeah it's it's
since everything is being orchestrated
from Mike from my computer the
connection to the cloud might be a
little bit slow
okay yeah we want to round it up put
them in sure yeah so if you guys want to
see the application just stop by the
booth it's the very first one in the
exhibit hall and we'll show you the
application run and appreciate your time
Thanks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>