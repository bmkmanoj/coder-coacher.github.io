<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Applied DDD in a Java EE 7 and Open Source World | Coder Coacher - Coaching Coders</title><meta content="Applied DDD in a Java EE 7 and Open Source World - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Applied DDD in a Java EE 7 and Open Source World</b></h2><h5 class="post__date">2015-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/9D_-7E7Mrzw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">good afternoon everybody it's very nice
to see you here in the last day of Java
one I think in the session before the
last one also of the day so I'm very
glad to be here from Brazil
my name is at Sonia Naga my Twitter
handle and I'll talk today about how to
apply a bit of DDD in a Java EE 7 world
I mean practicing DDD for a long time
but I think that finally with Java EE 7
we can use the Java EE 7 api's to
produce the most the nearest thing that
we can as with ddd that we put in use
before without using proprietary api's
so we have in a Java developer since
1997 I also like to play with UNIX all
kinds of UNIX since 99 and I've been a
professor of graduate and undergraduate
courses since 2000 spin quite a few
years and I also have some
certifications that I forget her for the
years mainly Java ones oh we're in Java
1e
job once so I'd like to ask who was
yesterday in has a Hartman's talk about
DDD no have you seen any DDD talk in
this conference yet no yeah ok
oh maybe I have to remember some
concepts for you but I've been doing a
lot of things but I'd like to present
myself as a software craftsman because I
believe the software is a craft you can
do a Janene but everything is it we
produce art we have we dedicate a lot of
time in our work we choose the best
tools we juice the best techniques
pretty to produce something that's
unique
nobody does that same software twice
it's not a factory in fact you produce
the same thing multiple times we
dedicate our life to produce something
that's unique that's why I think the
software is a craft
in this year 2014 we're we've celebrated
10 years of the domain-driven design
book by Eric Evans and we also celebrate
more than 10 years of the agile
manifesto so I don't know how many how
many of you Pratt Sergio
I think agile and the last years has
been a just like a common thing it's
common for people to be saying that
we're doing agile but I'd like to
emphasize that it doesn't matter what
technique what process we use to produce
software the most important thing with
software developments are the people
involved in it so if we have better
people have competent developers the
adducing software will have better
software so that's what our emphasis
should be should go to we had to make
better individuals and we have to have
better interactions between these
individuals I believe that's why we are
here in Java 1 learning making
connections becoming better and better
in what we do every day and I'm very
happy to follow some of the principles
of the agile though of the software
craftsman manifesto because I believe
that two things that are missing in
these days in software lament is not
only working software you can you can't
do software in just any way you have to
learn it in a well-crafted way and not
only individuals but also a community of
professionals I'm happy to be resilient
I happy to have a very very happy and
cohesive community for professionals
there that's why we're all qj1 over also
and so and just to end this discussion
list of software craftsmanship I'd like
to begin with some fellows off go
questions since DDD I think it is
something that's very closely related to
object or Anette oriented software so
I'd like to ask you what are the things
that we have learned about objected
oriented on analysis and design on CS
101 no CS one at you what are their
objective oriented principles of
programming
I'm chances no I think I've learned it
in the very first book where first
lesson of object orientation is that we
have three principles inheritance
polymorphous encapsulation and I clearly
remember what my my professor said about
this principles because she said in
disorder inheritance polymorphism and
encapsulation and we keep telling
ourselves that the we should apply
object-oriented principles in this order
the most important one is inheritance
later we apply polymorphous and in
encapsulations couldn't be more wrong
because in fact the most important
principle of object-oriented software is
encapsulation yume we can achieve
beautiful constructors you polymorphous
but I think inheritance is one way that
we can achieve this kind of poly
morphine's I believe you all of us are
job developers so we need some kind of
inheritance either from classes or
interfaces to produce polymorphous but
if you take a dynamic language cues you
could produce polymorphism using that
typing so that's not strictly necessary
to produce polymorphism so that's the
book that I anybody here you haven't
read it yet I suggest you to do so it's
a very good book it's not an easy book
to grasp and because it's very I think
it's a very it brings some very abstract
concepts I don't know if it's my fault
or not but I've taken a very long time
to understand DDD I think I'm still
learning every day about DDD and I've
asked about the heads of Hammonds talked
yesterday because he handled a lot of
explaining some of the concepts behind
domain driven design I'm not going to
waste somewhat too many time here but
I'd like to emphasize some of the the
most important ones which are which I'll
try to express in in my codes which are
entities
the which represent the nouns that we
have in our systems we also have
aggregates that's also represented now
since our systems and a common
misconception that people have with
entities and aggregates is that well if
there are the gnomes how can we how they
relate to each other and how can we
implement it using Java EE technologies
entities people usually entities to JPA
entities even the nouns very close but
aggregate should also be implemented
using GP entities so what's the kind of
difference aggregates represents some
entities that have clearly some clearly
defined it bounces our systems and you
should only or try so much as hard as
you can chali manipulates aggregates
doing your codes entities in the domain
driven design words you should should be
should be classes that are internalized
you know inside aggregates so I'd like
to say that the entities are usually our
classes that have the same life sack of
aggregates or show an example after but
usually entities cannot live with
outside and aggregate the so I said they
have the same life cycle repositories as
some some people have a misconception
about repositories and daos common
design pattern that we used to have in
Java EE explain the difference later
with code and value objects let's
actually talk about value objects are
also nouns but what would be the
difference between entities and value
objects I think entity should be
modeling in our in our system if you
have something that might change over
time but it has a
identity of its own for example a person
a person you are you clearly have an
identity you can change your name during
time you can change your date of birth
in the in the system you can change your
SSN but you're clearly the same person
over and over time and person is a noun
in the other side value objects and
nouns in your system that doesn't have
an identity that the value that we
represent is the only thing that can
differentiate differentiate one from
other so if I say that I might even have
the same name as as an odd person but if
I'm not equal to him we are different
persons we have different identities but
otherwise a telephone if two telephones
in a hypothetical systems if they have
if they have the same number they should
represent the same value so they don't
have an identity center so entity
objects they clearly have an identity
and value objects there's not
distinguish between the the different
object there in the system's the value
represents what the value object we also
have factories instead of creating
objects using the new operator in java
you should you also always use factors
to produce your entities and aggregates
or show some cobble also
and as an S and as an example we have
public class person that's usually what
we would do program in fact many of the
books that you read around would suggest
as you create a class press use a
private string name registering SSN a
telephone and a date worth this is pre
Java eight code so we're not using local
date from from Java 8 but this code has
a lot of codes Mouse that switches which
is which are examples of code that we
should not be using every day this this
kind of codes programming brings a lot
of problems that are the truth file we
will try to avoid some of the code
smells are primitive obsession that code
uses too many primitive times of the
Java language so usually when you have a
string or integer or dates you cannot
represent correctly the semantics of the
value that your you're storing in this
code yeah SSN you probably in the
numbers of the SSN you have a validation
it's not every number that you have or
every string that you have that is a
valid SSN just in your system also it's
not every string that is well the name
perhaps in your system you have a
constraint that your name must have at
least 5 characters or cannot be more
bigger than 60 characters you might say
also that in Java EE you can use
annotations to provide these kind of
validations but in this case you're
relying on a framework to do your
validation instead of relying your your
code to provide this validation and if
you forget to turn on the for the the
bean validation API or if you use it
directly for your code instead of using
for example as a framework as to JSF to
to trigger the validation your code will
be wrong in fact your the state of your
object will be wrong because you have an
invalid string for SSN or name or
telephone or anything else
so the soft primitive obsession Martin
father has written an article I think
more than ten years ago which is
publicly available on an Internet which
is when to make a type he could have
written it today and it would still be
true because so many people doesn't
follow this principles he says that you
should always be striving to write
custom types for our prefer the values
of our systems
obviously it's that's too much code that
we must provide to create a class called
name or class called SSN yeah but
usually the benefits come later and we
have when we have better encapsulation
of our codes so as a final point in the
conclusion of this article it suggests
that you should always create a custom
object if I have any doubts because it's
much easier in your code to remove a
custom time rather than later to insert
the custom type in your code so a
suggestion of our class person could be
this one to have a class called name
that represents the name so when you
have a name in your system you know that
all names that I mean in the persons are
valid names you won't have a string that
that will have to be validated later so
you should create also a class called
SSN so there won't be any SSN in your
system that is invalid if there is an
object and this instance of any object
of SSN in your system you know that it's
correct the same as telephone and SMS
birth should I use it for everything
well sometimes you have to waste down
the the pros and cons let's see I think
it's usually a good practice to follow
and create cousteau times for if not
many at least if not all at least many
of your value objects tell don't ask
principal
tell don't ask principal it helps you to
produce better encapsulated codes I can
see in many Java EE projects that's very
common for you you carry a set of
objects from the database then you
iterate way before in the list and you
keep oh I need to calculate something I
need to concatenate strings and you keep
using you you get an object and you get
gets named get SSN get value get ID get
easy to get these and get that you in
the same method you get an object from
another piece of code you take that data
object and you keep issuing getters and
getters and gathers over there
you break encapsulation why
encapsulation was created soup to allow
the state of an object to be deep nested
inside that that container so that the
data manipulation operations should be
performed inside the object that
contains information when you get all
the information that you have inside an
object individual getters you're simply
exposing your internal implementation of
the object to the outside the common tip
that I give it were to apply the tail
don't ask principal is in any methods
used take an object and you issue more
than two Gators in that object in that
method you're probably doing wrong
instead of asking for the object to give
you information you should be telling
the object to perform some operation for
you
you don't call getters you call a method
on the object and you if you need you
pass a sample ramÃ­rez parameter to
these methods to produce some results
new pointers that's a billion dollar
mistake
Oh gems of God leans in almost well he
didn't regrets in the community keynote
this morning but when you when you don't
have custom types you have to deal with
the pointers because what represents the
absence of some information you have a
string SSN but the person doesn't have
an SSN you have to put null or you have
to to choose a some arbitrary string to
represent the obsessive value if you use
a custom x you can create an object in
your system that represents this absence
of information we can create a new
object or now in Java 8 we can you even
use the optional reference to represent
something that there is absence another
piece of object orientation is the the
mirror law don't talk to strangers it
means that any class should only talk to
its directed dependencies it means that
you have if you have an attribute of the
class you can call methods on that you
can also call methods on objects that
you will receive as a parameters of the
other methods but should not do what you
should not concatenate or chain methods
sometimes you have the code that you
received a person person that get
child's dot get
relatives dot to get pets dot get
something yeah you're breaking
capsulation because you're assuming that
you your code has this clear structure
of person child relativism pets you
should not assume that you should have
you should have used the principle of
tell don't ask to tell them to sound
free something for you instead of asking
and information from inside also another
point from the menu design is mutability
I don't know if Mary Fusco was the first
one to tell this phrase but that's the
older one that I could get in on
internet mutability is the new go-to
just like Dijkstra said that go-to is a
harmful strength statements we consider
a new object oriented languages that
mutability
is harmful so we should model a system
to be if not immutable at least the
least mutable possible system that we
can provide and that's some of some of
the things that we intend to show you
all the codes and also last thing I
wanted to tell you that we have a lot of
open source libraries that we can use
our projects to have to assist us in our
objective of applying domain-driven
design in Java EE 7 one of them is
curator cell curator cell it's a
beautiful tool to create DSL to
co-create to issue Curie's on JPA and
not only GPA you can use curator cell to
issue curious also MongoDB loose an and
even collections the motivation behind
cure the cells because this we have this
unreadable code which is beautiful jp2
criteria it's hard to tell what is
happening we have a lot of factories we
have beauties
this code is hard to read we can hardly
too many too many lines of codes to do
very very few things the same curing
cure the cell could be written this way
and you know we all have the knowledge
of also simple so when you create a
queue using cure the cell you can you
can use Curie from men women were it's
almost readable it's familiar it's
something that's very near what we were
used to in in sequel so that's one of
the tools I've chosen to to to to
integrate in my domain of the design
experiments there are other tools
available also you have job which is
also good too although even though I've
never played with the with joke
but in this demos or use cured esta
that's a quick cure the cell to produce
it but I think it's not enough for
chatting let's do some codes now I hope
that the concepts have given to you we
become clear with with codes
so I've produced it a standard Java EE
can you see it in the back the code
that's fine this is a standard Java
project that I've producing I'm running
over here on the last wish and Java 8 I
wanted to do some lambda tricks so I
have to do some tweaking here
that's an entity you have an ID a name
SSN primitive types pretty much the
coded you see around here so I've
provided an interface let's run it
oops wrong projects
here
ever started
I forgot to tell you that cured a cell
it generates the dsl using maven so I
have to calm even first
create them ever mute I asked you to
refresh
I'm gonna run again
I forgot to tell but made the demo God's
behavior in my favor
it's very tough to do well no yes he
always has something wrong yeah
sometimes I'm getting this bug yeah I
don't know why but I have to go into
this class if I modify it and we start
the server it starts work so I've issued
simple C's outs
ten seconds okay successful
Oh TV in the open they already so I have
a person we have an SSN there's a simple
Jeff interface call my name I have an
SSN once you're free I don't know how
many dudes do we have an SSN a lot yeah
nine okay okay I could issue another one
so I'm not validating it I could have
provided some annotations to validate
but how could you use something
different if I apply the domain driven
design concept in SSN I should have
provided a value object for that and the
value object should always be mutable so
let's go to my personal class and
instead of using oops wrong person
there's a person of my test case okay if
I use this promise three guesses then I
don't want to use a primitive type I
want to use a custom type or create a
class called SSN I'll also have to
generate the getter and setters that's
the same it's complaining let's create
access class
now create a value of how do I create a
value objects it should be mutable
also value object most of them are
serializable so I'm able to use it in my
session scope of my view so value I can
provide constructor is it very what else
the string methods I'll just print the
internal data and now you also use a
factor methods to produce these SSN well
click here for sector
oh god I can't see the my screens too
big but I'll go do it by hand
oh the Clara private constructor nobody
can stand she ate it
nobody can superclass it well there's
too much code just to provide a custom
type what benefits does bring to me
first
nobody in the world know that internally
I'm using a string I could have used
anything if SSN are only digits I could
have used an integer along a big integer
a big decimal I could exchange the
implementation for self-performance
reason for memory reasons and nobody
would be affected so first benefit of
encapsulation a lot of an eft of thing
capsule encapsulation is that i can use
a factor method to produce objects oh
why not you don't just do an EOS SN the
problem with new SSN is that it's not a
refactor friendly are these IDs do does
a great job trying to do some
refactoring but in one of the main
benefit is of SSN is that if you use
effector methods today you're returning
a class an instance of SSN but tomorrow
you might all now I have two different
instance of SSN one SSN for America well
I'm not American wanna know what I wanna
stand for for American citizens and one
SSN for foreign citizens that they would
have different validations of the
numbers if you use a constructor you
would keep you you have to go ask your
codes and look for every single
statement that produces new SSN to check
which kind of SSN do you want to
instantiate but if you use a factory
method or the logic of the object
creation you could use in this factor
methods so today you're returning this
SSN but tomorrow you could superclass
SSN and return here and all your code
would compile normally so that's the
main benefits of factor methods factor
factoring methods should be used instead
of constructed for encapsulation for
refactoring and for
evolution of code you can provide any
superclass instead of just play the
playing class that you're using today
you can provide a new hierarchy instead
of returning the same objects another
example I'm used to give is instead of
SSN we could have called an interface
identification an identification could
be could have two different
implementations SSN for Americans and
for Brazilians that could be CPF they
both would be implementations of
identification and I could have provided
the logic right here depending on the
format of the number that you give on
the other on the factor methods I would
return a different kind of objects so
here it's immutable
I don't provide Gerrits for a value
object they do not expose anything to
outside their final I mean they're
immutable immutability also has its
benefits I can check the state of the
object to write at the factory methods I
can say here using watch X check
argument not that you can provide an
empty string to SSN I also can check
that value must match as a system must
match than digits so I won't have any
instance of SSN my system that doesn't
comply with this these checkers I'm
reducing the logic of validation to only
one method my code I'm not relying on a
notation and everything else if there is
an object of SSN in my system I know
it's correct because I'm validating it
before I create objects
so I returned here not my name is my my
code will compile but it won't work
because in my interface I'm showing an
SSN and JSF knows how to show a string
but it doesn't know how to show an SSN
today today using interface so that's
where Java EE has available constructors
constructions to provide this this kind
of stuff so I can create a converter in
JSF I'll create an SSN converter which
implements converter or implement the
methods first get as objects I'll
receive a string from the interface I
want to provide to the my back in being
an SSN so usually the pattern form if
it's not does not equal new return SS T
of s the value press return now but you
can see I've made a validation this
method call could prove could throw an
exception so it should wrap it in a
try-catch and if any exceptions happens
during the instantiation i first throw a
converter exception which is the way JSF
has to show that something wrong happen
to decode the conversion we should warn
you valid SSN no ok
I'm throwing a fascist message geta the
string is easier
I can safely use a two-string because in
my fellow object I have arrived already
in the overeating the two string methods
so it would provide a consistent string
in fact if I wanted to to get it from
edits with the with the I don't know SS
and if I believe it has dots or perhaps
slashes or something yeah
adesh so I could have a over reading the
two string method suit to show it with
the dashes or could you use them even
use I don't know how many of you know
but there is a an interface in JDK
called formattable which can which can
plummet to provide custom formatting for
objects so when you use a string dot
format it will form from format the
object in the way you want but I just
use plastic playing a string for now the
last thing I'm missing is to use the
notation first phase converter for SSN
dot class so that jsf will automatic
convert this instance of SS sent to
string and from string the other problem
that we have is just as JSF does not
know how to show SSN JPA does not know
how to store SSN the database so I have
to go here and create another converter
but this time a JP a converter so I have
to SSN attribute
converter which is new to JP a two point
one in Java EE 7 previously I had to to
use the hibernate user type or something
like that from SSN two and I want to
store it in the database as a string
because a string already has a mapping
to the to the world 12 our char column
so use a string here convert to database
column fourthly here in the attribute
converter I have to deal with knows it's
not know every turn the to string value
of it if s different not know Burt and
SS n of s so here we have a attribute
converter jp8 2.2.1 that will
automatically map my SSN instance to
database columns of type washer now I
have to tell jp-8 I want to use it
always so another notation attribute
converter sorry converter Java X how to
apply true now my system is ready to use
the value object both in JPA and jsf so
I just have to restart them server
deploying
success okay I'm using a dairy B
database that's why I lose everything at
the time the server restarts so now I
can you put the same value yeah
one two three four five six seven eight
nine nine digits it's it's okay it's
saving in a database but if I try to
modify it
wow I don't know if it's quite right to
try once you're free whoops
over to exception you didn't get my face
converter ssinnim corrector look this
try yeah sorry
your resume used to say that the
presenter is never wrong she just makes
mistakes
deployed so just creates another one
here your records invalid
oh it's also been wrong in Weld SSN so I
did the whole validation using my code
instead of relying on B validation or
anything else to provide with the
validation of my codes so that's how we
integrate value object error codes if
you're aware of the cargo tracker
application on java.net in that
application to use tend to represent
value objects as embeddable objects i
dislike this approach i prefer to create
custom classes and converters so that we
can have the benefits of immutability we
have some limitations using available
objects for immutability so I prefer the
I believe this approach is better and
are a lot of examples like to give to
you is I've created an invoice and then
invoice I can put some items on that the
traditional approach would be what I
would expose items in the gaiter
anybody in my system would be able to
get the list include items in the list
remove items in the list and my code
we'd would be unprotected because I'm
allowing external classes to modify my
internal State so when you declare a
list of our invoice items in your
invoice you're just simply breaking
capsulation oh but I want to see I want
to show this this just lists all on JSF
so I have to I need some way of getting
this list so what can you do to protect
your codes luckily Google guava also has
some some pretty good stuff for
providing dates I have will not really
return the same list I will make an
immutable copy when you create an
immutable list upon to copy off items
I'm returning a list to my clients that
is immutable nobody can
Pilatus lists Oh perhaps somebody can
manipulate the contents of the item
which would also break my my the purpose
of immutability so how do i model my
invoice heightened I just for the sake
of simplicity of but an integer as that
types an item has a code it has an
amount I have two constructors JPA
forces me to have a protected
constructor at least default constructor
Nene in any entity but I do not provide
getters I just provide us I do not
provide setters I just provide getters
so my variables my attributes are not
final but they are not exposed
nobody can modify my item so but the
point is how do i integrate this
immutable entity in my code because JSF
and all of the Java frameworks for web
requires you to do provide getters and
setters for everything breaking
encapsulation to resolve this problem we
have to create another class that can
produce immutable items so I've created
an invoice item Peter which is a very
popular design pattern for domain driven
design I've created a class AA simple
POJO with my progress properties they
are immutable
I provide getters and setters but I also
provide the methods called beaut imbued
with turns an invoice item which is
immutable so after an invoice item is
created nobody else can change the value
contained in the item and also notes
that we have clearly a relationship
between invoice and invoice item you see
there is no invoice item in my system
that doesn't belong to an invoice so we
clearly have a life cycle dependency of
one objective into another that's what
we call in DDD
the aggregate and the entity the
aggregate here is invoice because it has
a lifecycle of its own invoice iron on
the other way it's method to end to an
entity in that database but it can't
survive without an invoice if you
delayed the invoice you delete all of
the items also
so invoice here is the boundary invoice
item is the entity invoice is our
aggregate I cannot allow nobody from
outside to manipulate my my items
because only the aggregate can
manipulate the internal objects of its
implementation that's the beauty of
encapsulation I can provide them if
invoice item is immutable I can create a
method for example add item which can
check a lot of things in the items that
are being added so I have done a tricky
implementation here I'll show you how it
works first so I have item
my coat here I have an invoice or create
a new one I'll provide a new item once
you free amount one oops okay
something's not working as usual oh I
know because the add item eaten is empty
I'm asking it to add the items and write
their items but it's empty let's provide
a simple implementation here we start
the server
I could be preventing all this for a
deploys I have Jay rebel on a machine
that had too many troubles with
GlassFish this morning that I'm using
the old-fashioned way and I want to keep
it having troubles here deployed so
let's go back to the order in fact my
example I used to call I didn't call it
an invoice I call it the order then I
remember that order is a reserved
keyword of a sequel and I couldn't
create a database called order so I have
to rename its invoice new item code once
you're free amount one then I could add
one to free - whoa perhaps I wanted to
if the item being added has the same
code as the another one that I already
have I should have some the amounts it
would be a rather tricky implementation
if my code was Mirabal because I would
have to look for in every piece of my
code to see if anybody is modifying my
list to put this this code that adds the
items in my invoice but my code is
encapsulated in an aggregate and the
only class that can manipulate my
entities is the a group called invoice
so I can do some tricky stuff here I can
use a lot just and comment here check
not not all one allow and no.18 to be
added I could check the what is code
base would you have used the four to
check if the list that I have in
internally already contains any item
with the same codes but as I want to use
Java 8 I just provided a string create a
future compared if the the code equals
the code that I'm receiving and I called
find any find any returns not returns an
optional because I could have known
repeated codes
then with this optional I create a key
repeated dots map if it is this it would
remove the item from lists and create a
new invoice with the with the same code
but summing the amounts or else if the
optional is empty I would provide the
same item that's I don't know how many
of you are aware or practicing lambdas
in Java 8 but I think oh it's called
this beautiful it would prevent a lot of
loops and force and doing stuff I
suggest you take a careful look at find
any and optionals so with this I could
restart again my server
let's check how many minutes
successfully let's come back again new
item once you're free a month to create
a new item feature one about three
they're not at it again three two on
amount to five and also I've provided in
a single methods all the logic that that
is needed to sum up their items on my
invoice that's another benefit of
encapsulation but I also want to show
you something more interesting perhaps
which is the users of repositories and
specifications how many of you are aware
of spring data a few it's a very
beautiful project for creating
repositories it has different
implementations for for Emma would it be
JPA many others technologies so if I
procreate here I'll go to any voice
controller and create I'm using just
this interface called invoice repository
in fact I wanted to play a bit with
lambdas in my code so I did kind of in
this example I did a kind of a homage to
spring data there I think their code is
very beautifully written and I've taken
some I've create another implementation
based on spring data code just to add
some methods with lambdas but the basic
principle is you just declare an
interface that extends a repository or
in the case of spring data JP a
repository you declare the entity that
you're manipulating and the kind of the
idea of the entity and you have a full
implementation with all kinds of methods
that I can use my codes
so when I get invoice I can invoice
repository to find all it will list a
lot of the all of them I have a red
implementation for save for delete and
they are from the house without having
to to code any of the dis methods
because you know repositories usually
all of them have the same methods for
retrieving objects for saving for the
leading for clearing why do I have to
copy paste all of them
why don't I can take advantage of some
some proven library that's available
open source this you can use now in my
project in fact into eating when some
say spring data oh then I'll have to use
the whole spoon stack but no spring data
also beautifully integrates with your
CDI using in CDI extensions well that's
the way I'm integrating here using CDI
in a plain Java EE project so I'm
creating repository another rule that
you must follow
using DDD edge if you only provide
repositories to Kurian save entities in
your database for aggregates entities in
the domain driven design terminology
should not have repositories only
aggregates that's why I have an invoice
repository and I do not have an invoice
item repository because the invoice is
the aggregate they control the life
stack of the Artic of its internal
classes so here I could also produce let
me create another problem to solve
I could have provided the invoice
I've seen some code like this you create
a controller and I need to know the
total amount of items in certain I'm
invoice somebody could have used it a
for an external for integrate it there
but I could use has to use it it's with
lambdas so if the class that busts
manipulate the data is the class that
owns the data in this case it's the
invoice so you get our items or get a
stream
I would like to map each of the items to
do an int to sum of all of them I would
use invoice item and use the get amount
methods use a method reference I would
like to summon some the ball now I have
a total sum of the items in the
that's what starts hopefully I'll get a
lazy initialization exception
deployed and they'll get it over there
bunch of three a while
Simon then I save and now I have a lazy
sensational exception because I'm curing
all of my invoices and when iqe
using find all it returns a proxy in the
item lists and when it try to calculate
the amount in JSF the the entity manager
is already closed so how could I solve
it I could use fair check use call items
dot size or something like this which
wouldn't work because I'm returning a
copy so it starts to become more tricky
so I have to issue a custom Kure to my
repository to solve it
that's where that's where I've tried to
that's the thing I wanted to play with
using the repository that's why I've
played a bit with the spring data codes
and I provided an odd implementation
called find when I kept as a lambda for
the curie using curious l like you use a
curie from
I will stick to a verbal cue from
queueing voice Oh use a joint to fetch
all the items so they do not have a
laziness attestation exception later
from queueing voice echoing voice dot
items carrying voice I don't know
then refectory here I use the from or
just make a break here from drawing I
just want two distinct so I do not have
the repeated LMS all to join but lists I
want to list all the invoices so provide
the lambdap limitation using q de sel no
redeploy it
successfully let's say one
whoops oh I forgot to call fetched or
else you won't initialize the collection
for me
so let's save it again
now it's initializer that'll have any
problems what I did here was to provide
some kind of some sort of specification
to be run against the repository using a
lambda but the point is probably in
other parts of the system I'll have to
copy paste this code to initialize the
items again so how can I reuse it or
else as some favorites like Ruby and
spring dead itself I can provide some
you can create custom Curie's using a
meta finder methods you can use find by
name fine by SSN which is a very
pratical particular IDEs like this
approach because it tends to prove to
create some kind of community or
explosion of methods because sometimes
you want to find my name and sometimes
you want to find by name and SSN and
find by SSN so you keep creating a lot
of different combinations of find their
methods so it's it's I think it's wiser
to to create some kind of way to reuse
all of these carries and specifications
that you create so QE your your
aggregates so that's when we could you
create a class called
invoices books and here I could be
providing all of the specifications that
I want to carry I could provide for
example using cured SL public a boolean
expression
I want QE invoices we've SSN and I
provide an SSN then I can just do this
way oh you voice doesn't have an SSN
there is a person queue person equals
SSN I could provide another with the
name and pass it a string name returned
queue person that person that name but
contains in our case Oh beautiful
methods provided by cue the cell that
mimics the string API and then when I
would use it in the in my I'll just
rename it for persons or people better
perhaps better if I rename a class for
people I could use it in my person
controller
to find off and all what to find out all
people
it must be static
there's so much other to find all people
we've name beginning with ABC and people
we've SSN one two three four five six
seven eight nine yeah let's take a -
that's what we call a simple form of
specification you create a class which
aggregates all of your specifications
that you use to qe your database then
it's much easier for people to compose
the specifications that to reuse it in
other types of the code because
sometimes you create a QE a very complex
QE to do something and you embed it into
a service later some weeks later another
developer needs the same Curie but he
doesn't know that you did it already
here we programming again instead of
reusing the same code so that's why we
should always but the the the
specifications that we use to QE objects
in common class that in this case I'll
call I called people so no and well
that's the time I had to present
I like to use this Homer Simpson phrases
a software craftsman where we live in a
world where the or it's very common for
people to say this is everybody's fault
but mine I don't care
so the problem I'm just programming
during a part of the job and I don't
care about what others do I believe it's
not the way it works
we as software developers should be
worried about the result of our work one
of the most wonderful things that I've
learned that programming is that you
when you create your first hell Awards
you become really happy for seeing the
your job done whoa I produce it
something and it's very sad that some
developers in their current companies do
not cannot feel the same because I'm
writing code I never get to see it
running I want to see people complain
about it
I never deploy I never do my job but me
I think we must have a purpose as
developer we should produce the best
code we can well-crafted codes to create
a better words not just for me but for
my children's but for you for your
children I think that's the the real
purpose of being a Vella per and being a
software craftsman if you don't care
about the others
doesn't matter do it for you at least
for having a better paycheck and a
phrase from your Ford if you think you
can do a thing or think you can do a
thing
you're right if you think you can make
the difference with the code you've met
you code every day you're right if you
think it doesn't matter you're also
right because it's a matter of believing
so I hope that we all can use all these
beautiful techniques that we have to
learn yet to produce better software and
create a better world for all of us
thank you guys</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>