<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>JSON in the Oracle Database: Customize Auto Generated Views with JSON Dataguide | Coder Coacher - Coaching Coders</title><meta content="JSON in the Oracle Database: Customize Auto Generated Views with JSON Dataguide - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>JSON in the Oracle Database: Customize Auto Generated Views with JSON Dataguide</b></h2><h5 class="post__date">2018-02-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/OY5OaRrA1Os" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">this is the third video on the JSON data
guide and it's a little addition to the
last video where I've shown you how you
can use the data guide to create a view
here in this video I will show you how
you can retrieve the view definition
modified and customize your view start
again by creating a table to store the
JSON data in a column called JSON data
and we insert a hundred thousand JSON
documents those come from the Yelp data
set so they represent reviews about
stores and shops so this jason contains
the name of the place and the address
and if we scroll to the right there is
some information about the hours when
they're open and what kind of services
they provide so we create the JSON
search index with the data guide on a
parameter which means that every
document that gets inserted or mod
modified automatically gets scanned for
a new field so that we get the data that
information if I query the view user
Jason daily guide we see that data guide
information has been retrieved I won't
go into the details in this video for
that I recommend you watch the first
video on the data guide so we use this
information to create a view I've
explained that in the last video and if
we query the view we have a hundred
thousand rows it's basically one Jason
input row gives us one relational row
with a difference of having the data
inside one jason we now have it
projected out as relational columns so
there is a column called Jason data
Dollar City and that will contain the
city information there is one particular
field in this view I want you to look at
and that is called JSON data dollars
categories and it's a varchar 4000 so
it's a rather long one if we query it we
see that the values are actually JSON so
we see it's an array and inside the
array
we have a list of categories what this
particular business offers so this place
here would offer food and coffee and tea
how could we flatten this information
meaning right now it's relatively hard
to query it let's say we wanted to look
for a store which has the category car
wash it's not very easy to do a and
equality here because we wouldn't look
for a car wash equals this this column
value because this column value has more
information than the car wash
so we want to flatten this out create
one row for a car wash one row for
automotive and one row for auto
detailing because then we could easily
query the data so let's get the view
definition so we use DBMS metadata to
get DDL and this will return us the
statement of the sequel statement to
create this view so I'm copying it over
and we see that this view is based on
JSON table so Jason table takes our JSON
input this is the column JSON data and
then it extracts the information for a
given path so this path expression would
be dollars hours Monday and the value is
associated with this column so if we
scroll down to the end we see that this
is where our categories are and the
format Jason here actually tells us that
the value that is being returned is not
a sequel scalar value one category but
it's an array of all the categories so
we want to flatten this one out so we
use this Y just using the nested path
syntax so because that array is nested
inside our JSON so we want to
unnecessary access the array but then I
use square brackets star to iterate over
the array and now in the columns Clause
I have one field called category and the
path to this will just be the path
expression dollar dollar means don't go
further it's the route of what we select
there then we can erase this field here
at this point I could also erase other
columns if I'm not interested in that
so let's complete the statement syntax
here if you get created it's still
called demo view so let's first see how
many rows we have so remember that our
original table and our first demo view
had a hundred thousand rows but now we
are expanding or we're flattening the
categories in the array so we see that
the number has gone up by a factor of
three point seven which means on average
the business has on average three point
seven different categories now with
every row containing only one category
we can see what Katter is we have using
a select distinct query and we see that
there's categories like beer and comic
books ok so now let's look for cities
which have comic books so we can just
query this using plain sequel we can say
select the city and the name of the
place and how many positive reviews or
how many stars it got from our review
were the category is comic books now we
can do is simple equality because the
category will not be an array of several
strings but just one sequel string and
we use the order by clause to get the
best comic places first so now if we run
this query we see that the best place or
well these are all five-star places one
is it Phoenix all about books and comics
so that's where I'm heading now and
thank you for watching</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>