<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Java EE 7 Meets Java 8 | Coder Coacher - Coaching Coders</title><meta content="Java EE 7 Meets Java 8 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Java EE 7 Meets Java 8</b></h2><h5 class="post__date">2016-09-21</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/E25xlERjJWc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay can we start okay welcome guys the
morning thank you so much for joining my
session about java 7 mix Java 8 are you
guys enjoying the conference come on I
cannot thank so much enthusiasm come on
yeah I know it's been like two long days
and probably you guys are already tired
coming on the first day on the morning
so I'm guessing that you guys being on
the parties drink some beer and they
have like another party later in the
evening so thank you so much for joining
anyway if you allow me to introduce a
little bit of myself my name is Roberto
Cortez I'm mostly a passionate developer
about Java technologies and of course
yummy as well I run my own blog on Roth
Cortez com which I write a route java in
Java in general i also have a youtube
channel what I just record some small
videos that I call the Java tip of the
week and that it's not just like five
minutes long where it's just me coding
and showing some Java aspects also i
have a couple of other videos of my
sessions around conferences around the
world and you can see i'm also a speaker
freaking on java 1b box j focus java
zone and other conferences I run a Java
user group in my hometown sitting
portugal which is called Queen bruh you
probably never heard about it it's very
small oh you did oh awesome thank you so
much sir yeah I'd love to receive you
there and be a part of our jug and I
also be in a pointing java champion over
the in the last few weeks so it's very
very hard for me to have that title and
thank you so much for all your support
these are my contacts Twitter blog
YouTube channel so in mail feel free to
reach me on any of those if you have any
questions later on or if you have any
general thing that you want to share
with me or ask me I'll be happy to help
you
so now regarding questions I don't
really like to set questions to the end
I like to keep my sessions interactive
so please feel free to interrupt me
anytime to ask me any questions we're
lucky that the room is quite small
usually my my far side is not very good
so if you if you cannot count my
attentions just throw me anything I just
probably not going to return it at the
end but the please shout do whatever and
i'll i'll go back to you so any
questions just do it as soon as you have
them now our agenda for today we're
going to do a little bit of I see any of
you so I'm not gonna I don't have many
slides so most of the things I'm going
to show is closed and i'm going to do a
little bit of live coding most of the
demos that i have repair is around using
some of the java SE eight features with
java ee 7 we have something around check
the a's jax-rs batch web sokka's timers
exok execution Fred's on Java 7 as well
and I also compile some features ideas
that I have some of them's are a little
bit crazy on how we can involve the
platform to comply with not to comply
but at least to make better uses of some
of the java SE 8 features on java 7
cimarron java ee environment so as you
probably I don't know if you ever
noticed but usually there is a alignment
between a cme over the over the years
with seeing that whenever you have a
Java Sea reliefs usually followed by the
java ee release that the lines with that
particular job i see release
unfortunately over the last couple of
years especially when oracle of choirs
Sun the releases were less frequent as
see here on the on the chart with years
and unfortunately and he probably also
where the java ee work over the last
year was a little bit slow hopefully it
seems to be going the right track at the
moment again but we have a java c9
release expected to 2070 17 and the same
java ee eight released on 2017 so seems
that we might be a little bit unsynced
for the next year but if you guys
attended the keynote you also heard that
the java you guys are going to have a
very aggressive work to try to align
these versions and then they expect to
start java e9 work on 2018 as well so
just to make sure or just to have an
idea on how you guys are using java ee
so everyone here is using java ee okay
awesome i guess i guess that's why you
came to recession right and who's here
is using java to e doesn't matter the
version one person to come on your we
are on a safe environment you can you
can you can you can say that you're
using java eat a java to eat it's fine
so two persons or I'm really sorry for
you I'll try I'll try to help you as
much as I can yeah so I also started a
few Java as a Java three-round version 1
3 &amp;amp; 1 dot for when you have like that
huge amount of XML and few for super
slow and what about java ee 5 a couple
of people java is six ok most of the
room and java 7 ok a few others as well
awesome so this is just a summary on
what we being discusses so EE 7 is not
really align it with se8 but that
doesn't mean that we cannot try to use
some of the features
that se8 brings to us on the java ee 7
environment some of them are can even be
used on Java he fix maybe Java if five
as well especially because the things
that I'm going to show you some of them
are not really java ee specific just a
couple of things so let's try to improve
what we can do on a java ee 7 with java
SE it's tough if you look into the e
application servers landscape i'm just
going for the ones that currently have
support in java ee 7 so we have glass
fish while fly Tommy weblogic and
websphere liberty profile some of them
were raised rapid support for java java
SE 7 completely and they are only
supporting se8 from now on so i think
that that's also an indication that the
servers also wants us to use se8 even if
we're still stuck in an old e
implementation does anyone use any other
server that's not listed here like resin
juice or something okay awesome so what
does what do we get with se8 of course
one of the major features is lambdas
right who's here using lambdas awesome
and now you guys using lambda to ja ve a
couple ok let's try to change that
because you can actually use them
currently streams of course a huge
improvement over the collections api
whose you're using streams as well you
had the same people are using lambdas
that makes sense probably stupid
question and we also introduced the
date-time API who's reducing to the new
java at a time api also the same people
of course yeah i'm guessing that
calendar doesn't cut it anymore right
and
daytime api is an awesome thing to build
with date so we don't have to deal with
calendar or the old date class which are
a pain to work with but those are
probably the some of the major features
that we can use but Java Sea eight also
introduces a couple of other things that
are like not very talked about or
they're not on the main things that when
they were announced it but i think they
are also very useful for when you're
building business code or enterprise
applications so we have a couple of
other collections enhancements not other
not only on streams especially new
methods that you can call on maps on
collections and so on kind of like put
these apps and things like that optional
it's one of my actually favorites who's
here using optional a couple of people
as well awesome string joiner computable
future which is awesome to do a scene
calls new ways to do comparators and
repeatable annotations so now for the
slides let's go let's look into some
codes all the code that i'm going to
show it's in this Peter bleep oh so feel
free to look into it I'll probably going
to be updating in the next couple of
weeks as well with even more stuff and
of course you're free to send in your
own ideas if you have them and I haven't
talked about them here okay
here we go
can you guys see it properly yes no can
anyone can anyone not see it okay great
so the first things i'm going to show
you is about using the API with jpa so
who here is using jpa most of the most
of the room so i have here just a simple
entity it's called the person of course
it's an ID in the name doesn't matter
but now you can see that i'm using a
local date and we'll called a time to
have like birth date and i create date
for the record of that person so if you
try to use these out of the box it just
don't work because the JP I
implementations don't know about local
diet or local daytime because they they
were introduced on Java 8 if you can see
here on the javadoc I think I should
currently that I burnett now on the last
couple of versions are not supporting
local daytime and local date out of the
box still other type implementations
onto it so how can we actually use these
directly map with into our entity class
without having support directly natively
from our JP implementations so Java is
seven introduces something on jpa called
converters so basically it's just a
poacher that you implement an attribute
converter you can say that the at work
converter will be from local date to
timestamp and timestamp is the Chavez
equal time stamp and that's something
that jpa actual nose so now I annotate
this with converter I say autoplay
equals true so basically could tell JP
implementation that's going to apply
this conversion to any JP entity where
it finds a local date and it's going to
convert the local date using the rules
that I implemented over here in converts
to timestamp so to convert this time
stamp I'll just say local date since
sometimes this Bank me know I use
optional of noble and if it's not know I
just say timestamp value of local data
at start of the day so local date might
have doesn't doesn't have any any
information during the four for the
further for the time stamp itself so i
just set it i started today but you can
put whatever you want over here or if I
don't have any value just return null
again and do not get anything set on
database so on the end then you have the
other of course says convert identity to
watch it would which means that convert
the timestamp to local date so again the
lecture say that the column exception
also i can actually get know from there
so i use an optional of knowable get the
valley from the database do a map to
local daytime that's because timestamp
has a way to convert directly to talk to
local daytime and then from local
daytime i convert it again to local date
if not i return know are you guys
familiar with all these strings lambdas
met well that's not the stream was very
similar to stream on the optional side
but your guys familiar with method
references on java 8 yes no ok if not i
can just convert this to to lambda and i
can convert it as well to the norms in
class which means i'll just go to my
local daytime and call local date and
here oops I'll just replace this with
lambda and norms in class so of course
this this type of code is not very
visible so that's why i use the method
references but basically you can see
here that you were able to use these to
convert objects to their native office
on on the on database and of course you
can use this to even your own not just
just not to local daytime
of course here you have the local so
that was the local date this is local
data and converter which pretty much the
same except that now I just grabbed the
valid that is exactly on daytime from
from the timestamp and I can actually
run this don't recall the name of the
class let me find it over here there you
go are you guys are you guys familiar
with Java 8 daytime API okay like 25
goes into the room so let me show you a
couple of things that the local data API
can do for you so here i have a person
right i just created with like a birth
date and a creation that for the record
so see how easy it is to just set up a
date like that so i just say local date
off buster died in or if I want to grab
the current date i'll just say local
daytime dot now or dot now over here
extract it to a variable and put it over
there and now if i actually for instance
it's very common that we want to know
the edge of the person i can just say
person get birthday until now and I want
the now until or I want to the day until
in years so it will return me the number
of years of the person's if you're not
using any particular API that
facilitates that like the date-time AP
and Java rate or even Joe the time which
was the one that people use before you
probably have to go with the calendar
approach and you have to do crazy code
like this every any of you have done
some crazy code like this before yeah
please use converter delete this and
then you have your age for the person
also get just a little bit about local
dates again so this is another example
you can also use it to map Jack's big
objects so now this is a schedule so you
can forge XP latches you can use the
Java at the xml Java type adapter and of
course use a local died XML adapter
that's implemented by you if you come
over here you'll see that the you will
do something very similar as you do with
the conversion of JP a value you just
say extensive XML adapter just say
usually what mean you get something from
XML is a string you say string to local
date now on a marshal you grab the
string going to an optional again
because might we know map its local diet
parse it so the API also has a way to
parse strings vices on format so most of
the more standard formats are already
there on static variables so just say
dot parse is not just return 0 and the
same again if you want to marshal it
back to xml you grab the local date
format it into the iso date and you're
done so now in in your Jack's big object
now you can work with local diet and
local day times I also have here local
debt and the daytime AP also works with
Sony's dates which allows you to grab a
date with actually actually an actual
time timezone so in here we also
conversion to convert the date into a
zone with daytime any questions so far
ok good let's move to other stuff no i'm
going to show you the things that i do
to find objects on jpa using some of the
java 8 stuff so i have here an entity
which is a movie not a big deal an ID
enter name and i have here a movie bean
so most of the times what
usually do to find an entity will go to
the entity manager and called find but
when you call finds it such that can
return null so then you have to do all
null checking on your code on your
business objects to see oh if that's no
I'm going to do something about it so
what I end up doing is I enhance the
method which to defined and I wrap it in
an optional so I do when to manage and
fine wrap it in rational option of
notable and then on your business class
you just get an optional and then you
can a more easily check for null and do
operations on that particular entity yes
sir
yeah so the probability of saying is
that you're talking about the optional
that came up with the guava right or
yeah so the the optional class is
something that was around started with
guava and then they were later
introduced in Java 8 as well so this is
just a Java it cold there is no library
edition of library to use optional does
that answer your question okay and now
here to the find then I can just say so
this is probably what i'll do i'll do
the movie pin find movie thing so if i
try to find a movie that does that's not
actually present on the database i have
to check for now see if the movie is
there or else a movie not found but if I
museum optional I can improve that code
and i'll say movie being fine movie 5 l
so certain not no movie optional if not
i'll say i move the optional that map
kept the name or else i'll just say
movie not found so basically it will
remove all this code and it will show up
like this so if i if i run this
well I get of course movie not found but
see the difference of writing this code
which is a painter right to write
something like this with optional map
and then do something if the things are
not know returning to our movie Dean
then you can even do some more stuff so
the entitymanager api is somehow
different depending how you call the
Mets to find something so if you call
find you'll get the null if the objects
not on database but if you actually do a
create query and pass the query in then
you say gaps in your result actually jpa
if it doesn't find anything it will
return you know result exception then
you have to deal with the exception on
your code as well so what I did here is
I also do the enhancements a family with
burning enhances I passing the query I
wrapped it in an optional I do a catch
and if I get a no result exception
they're not just return an empty
optional and then you don't have to
worry about dealing with the exception I
run on your business code for for doing
for doing the leaks or remove it's even
better so you passing the IV usually
have to find the object first on
database you have checked if you have to
sell to their to pass it to the entity
manager to remove it with the optional
you just say pass the long ID call the
method that actually returns view the
entity but but since it's an optional
you can just say if present and then you
call entitymanager remove nicer huh
I need any other questions so far feel
free to interrupt any time so we seen
find let's look into criteria doesn't
even you guys used JP I criteria API a
couple of people yeah it's very boring
so I'm just going to get one one of the
most bad we can say piada ever saw
really yes feel free to to to to agree
or not still I have a couple of years
how can we improve it so this is usually
what you you what you write you might
write it like this so you should use the
criteria API when you have multiple
where statements that you want to chain
them together so but sometimes you want
to filter them out and you don't want
then don't you don't have the values so
you have today like say if the value
that I'm passing to compare on the query
is not know then that's when i append it
to the to the string so then you end up
writing the criteria api to do like
something like this you have a list of
predicates you start adding the private
case if they're not know and then add a
list of predicates to the criteria api
word list but now the advanced learning
has inversions a little bit different so
instead of actually passing the
parameters that you want to pass in the
where as regular values just as a user
national again if they can be now so now
the things we can do a little more
simple now you can say query that select
where now you could have a string
passing the optionals that you're
passing on the on / a mirror so you can
actually use I know just using this
example as a one-parameter but if you
have multiple you can actually pass in a
stream or optionals then you say stream
of something get filter if they are
present then map them
and get the value and if they are all of
their you just create a new array of
predicates and then you can pass in this
to the work laws so it's a little bit
more complicated but at least is
becoming a little more generic so
instead of just having to add if if if
is it just passing a stream of optional
or put an option over there map the
streams here and you're done but what I
actually really want to see and this is
just a crazy idea i'm not i'm not the
responsible of doing any of these it's
just ideas is you can do something like
this you say query does select we put
the class vehicle dot where and and then
in here when actually use the predicate
of java 8 so now you can say something
like if the vehicle plate equals
something then it filters the query and
then of course instead of having that
ugly cove you will just do stuff like
this keep repeating the work losses and
grabbing the values all together but of
course this doesn't exist yet it's just
an idea so if you have something like
this will use it no okay maybe it's not
a good idea after all okay so let's I'm
sick of jpa probably you guys are as
well so let's move to something a little
boring interesting as well jax-rs
probably the IPI that people move up the
most who's using jax-rs yeah most of you
guys everything now our rest services
with microservices running docker on a
cloud instance right okay so let's look
into what we have here jax-rs so I have
here a POJO and this photo represents
just something that I get on
my rest endpoint might be something that
I used to like append query parameters
to do searching and let's just say that
I have my address I want to find my
address and usually if I want to filter
them out I either pass them as query
parameter example here and then I
usually have or usually your info and
then of course I don't know which ones
are coming on the address or them quite
parameters have to check for Noel's all
the time and I have to something like or
our info white paper me just got first
and then if I want to filter them out so
these just doing something memory I'll
just say address gets treats equal
streets different know then gas Street
is not going to get the streets from
from the address so it's a little bit
painful to write this code so my
suggestion is of course use an optional
so now I grabbing the parameters and
wrapped in into optionals from the URI
info so this is just the same are you
guys familiar with right info object or
you guys use the query parameter query
poem and map all the query bottoms
individually so I just use this because
if you're use multiple ones then it's
just easier to grab them
programmatically and just having to add
them on the mat parameters all the time
well now this because it becomes a
little bit simpler I guess so now it
just grabs a similar dresses i have my
addresses over here in a new list i call
stream filter i just grabbed the method
i want to compare on the address and
then of course i'll go straight off the
optional and say or else i'll just match
it against the dresses on the street so
it's going to be equals and it's going
to return it so it's going to satisfy
the condition on the filter and i do
that for all for all of them
but we can actually enhance this a
little bit so sometimes we also use
parameters that are separated by commas
right whose you're using line things
like that separate the perimeter
separated by commas that you pass on
query strings so usually is this code
familiar to you guys like to grab you
grab the string you split it by a coma
you add it to a list usually put it to
like uppercase to like to make sure that
compare is the same what you have on
database or something and the end you'll
return the collection with the with
parameters did you guys do some stuff
like this yeah so how about if you use
streams to do it it comes much more
easier I think of course again we use an
optional to map the parameters because
they don't like me no I do a map to
split them by a coma and then from the
coma I just so basically what this will
do let me just probably expand this for
you guys see what you get so basically
this will return you as to an array of
strings so from the string server of
array I just map it again to another
stream then call to uppercase on all of
the stream on all of the strings and
then I collect them to a list and if I
don't have any values I just returned a
single term list with the default value
so this also becomes a little more
generic and more easy to work with any
questions ok so now one of my personal
favorites for jax-rs who here likes to
write a sink Jack's arrest requests or
as interested on doing jax-rs a sink
yeah a lot of people so no java it
introduces something called the
computable feature sone java 7 i believe
we had a few
sure we draw allows us to do something
that we don't know what's going to be
the result and then is going to give us
a result back but the problem is the
future is that usually when you call
gets going to block your response so
it's not very very a sink and especially
and this only works for java ee 7
unfortunately because it's not a very
good idea to start your own Fred's on a
Java environment because the files are
managed by by the container but on Java
7 we're actually able to access the Fred
pool on on the container and we can do
it with managing scooter service and
luckily computable future actually you
can actually say which as a kid to
service you want to use to execute the
distinct methods so now it's just inject
with resource the managed security
service that you have on your java ee
container and now you can call complete
able future is a supply sink passing the
executor on when you want to execute
this is incremented and of course the
supply is seen casually the supplier
which is a functional interface on java
c 8 and now you can pass him the matter
that you want to execute as a method
reference so in here i just made like a
simple method called long execution just
sleep for a couple of seconds and the
coast thing about computer to do if you
actually look an actual chain a sink
methods together so instead of having
multiple futures say okay if this
completes successful then i call this
and if this doesn't complete then i do
something else now in here you can
actually say supply sink call this
method and you can say then then supply
sink again and then you supply another
sink matters and so on so what I
actually doing here is I'm grabbing the
duration return of these execution and
I'm adding it to another call that I'm
doing on another a sink
and finally then I call this method
called then apply sudden apply is just
compute to the result back of all these
things and just grabbing the Russian
again and returning the amount of time
that it took me to execute all these
things and when I'm happy with the
results then I can just say resume and
the computer filter will return the
result back so one of all so wonderful
mention computable future is of sorry
sir yes no those are not I'm not
creating any friends here so what I have
is this management Secutor service which
is a java e7 new feature which basically
gives you access to the fred pool of the
container so one saying is hey i want to
execute these the sink methods and here
is a threat pool for you to execute them
I don't care which first we are going to
use so just use this Fred pool so since
you're handing the thread pool of the
container itself then you're not
creating news fred is the container that
are managing this the Fred's itself so
basically the computer football just
request a threat from that Fred pool and
then we turn it back when it's done so
it's not very it's not safe to actually
run a sync stuff on java ee using
computable features if you use this
technique because you're not creating to
fret yourself and you don't have to
dispose them and so everything is
managed by the container so I i also
have it so all the things that are shown
here also have tests for you to see how
they work so for I had that for the rare
info as well that's i think is no point
to run it at this time but for instance
for the sink and you not just do a
client call and will work just just the
same when you call any rest endpoint i'm
just going to run it
this takes like the little bit of a few
seconds because of the actual delay that
I'm running on these sinkholes so in the
end I'll get the result back took me
five seconds to generate these response
so this was one is as Anna sink so you
could do actually other stuff when
you're doing your rest endpoint find
this useful yes no okay so what else do
we have here so we've been to JP a bin
jax-rs Jack's me as well let's go to web
socket so if you're using WebSockets a
couple of people as well are you guys
wanting to use web sockets the rest of
the audience okay a couple of more well
let's do it try to do it to load fast
well we're going to show you a couple of
other aspects of the Java Sea IP is so
with WebSockets now it's super easy to
actually implement chat servers right so
this is the Justice sample where I
implement a chat WebSocket server and
for web sockets you have to implement or
at least a note 84 methods say when you
open the session when you close it and
when you send a message to that
particular session so when you say on
open usually get a session that session
that you open it on the web socket and
then you can pass a pod parameter when
you're calling the WebSocket address
endpoint so in here I'm just creating my
kind of like an RC thing where you just
send a message to a channel and then
what I actually have to do is I have to
grab I have to associate the session to
a particular channel to be able to send
a message that particular channel as
well so an open usually on a java on
java before java 8 you will do something
like grabbed sessions from the
concurrent hashmap if sessions are not
are no then I just add a new a new
concordia hashmap to that particular
things so basically I'm saying here for
this channel going to have a set of
sessions and I basically are just
starting up the set on that particular
channel and then I can add the session
safely there so actually if you look
into these disease this code is kind of
that code because it's actually only 11
execution with that is when you actually
need to create the first time those
sessions or those sets to have the
sessions so when I told you that you
have some new enhancements on the
collections API now you can write code
like this so you grab your your your
collection and you can actually call
something like compute compute is absent
some saying that it will execute this
code if the code if the channel is not
there so let's just say okay if if
absent then I'm going to create a new
piece set for the tacori dash map and
now I can safely say add the session
that's sad also notice that is just a
Chinese API so it's much more easier to
read it like this then to have this ugly
code over here so now you can safely
replace these things with this same for
close so close usually you grab you grab
the session from channel if the sessions
are not know then remove it it's not
just for a legal static ception now
again as you probably seen I'm a very
enthusiastic V optional so everything
that I think like me know I wrap it into
an optional so now I wrapped the
optional into channels that got to grab
the session if weeks now I just throw
the legal static ception and if it's
there I'll just remove it now the
interesting thing here is about doing
the messages so let's just say that it's
trying to send a message to a channel
right
and if you remember I see you sent to
channel everyone else can see it but
you're not going to see it because you
already send it so basically what you
want to do is send it to everyone minus
myself so again if you want to do it the
old way you'll basically go to the
channels set you get the channel when
you sending the message to if the
channel is the sessions are different
null then you iterate over all the
sessions and if the session is open and
if I'm not the session ID that's an
engine the message then I call I just
come in please over here so on my test
doesn't the results I don't show a
couple of times then I call the sink
remote send texts get the message and
this is just a method that for max the
message over there now the new way I
will just say again channels get or
default so i'll say i would like to get
the channel from this set but if i can
get it I'll just return an empty set and
this is useful because now i'm able to
change stuff together and do stuff
basically saying if I'm not able to find
a channel I'll just use this empty set
meaning that all the evaluations that I
do afterwards they're not going to do
anything but still keeps the cold pretty
Queen then I call the stream i filtered
if the session is open then i post
another lambda to filter say if much
session is not myself then for each of
the sessions I'll just go to the sink
remote same tax get message and that's
it useful yes no
so I have a test for this as well there
we go from here just calling just
creating a web socket container and in
here if i run this then just cannot put
some the message that I just I'll call
it over here javaone hi it's good to be
here chug one is awesome okay web
sockets are done let's go for timer
timer service up to the desk sorry I'm
ravine so do you know how do you guys
hate when you have to implement multiple
so basic actually before who here use
timers on java most most of people in
room awesome so you guys when you have
to use the timer you usually have to
implement one class per timer right
because you have to use the time at o
notation to have a method and then you
have the code over the metal over there
and then if you have multiple timeless
and you have to repeat the process
because of the timeout methods so
actually what i did here is i've done
like a little bit of a clever way to
only use one class five multiple timers
and this is using one something that was
introduced in java itself that allows
you to actually cast the an object to
multiple types so basically what i'm
doing here is I inject timer service I
do is usually do this the schedule
expression on what I want to do and then
i create a new timer config but now
notice that on time the timer config
itself
sorry you can pass in a serializable and
luckily lambdas itself there are
serializable so that means that you can
actually pass a method reference over
the timer service so now what actually
done is I have like this couple of
methods that are doing different stuff I
passing the serializable n runnable
methods over here and now on my time out
I'll just gonna call the run method
unrunnable so now I can I can I may only
have one timer class and I can have all
the time we're here and I'll just have
one timeout matters to deal with all the
timers doesn't make sense so if this
actually works on java 7 java it
probably on java e5 as well because as
far as i remember that be exactly the
same so for the timers i also have a
test over here
and now you will see that you can say
hey let me sleep wake me up let me sleep
wake me up yeah I use this as my alarm
to wake up in the morning so timers are
done now concurrency so concurrency is
something that was only introduced in
Java e7 so it's a little bit similar
with what I show you with the sinks on
jax-rs but basically on the man you
execute the service and java 7 on the
executor you usually passive submit you
call the submit to pass a runner ball
but runner ball is actually one method
interface with only one abstract method
so that even though so now you can see
this actually on Java it is annotated as
a functional interface so meaning that
when you're using the manager executor
service you can pass in the lambda or
matin reference to execute your code so
now here is I just create vulnerable
task which actually is a lambda over
here and then on the submit method on
the executor I'll just call the method
reference directly so it's it's a little
more user-friendly or code friendly than
having to write in items in the class
like this and then put whatever code
over here the other benefit as well is
that since you're extracting these to
imagine reference then you can call that
method multiple times whenever you want
instead of having to implement the
enormous in class again if you need it
so the same thing for the managed cattle
executed service so the manual scripted
service is the same as the executor
service but it's love you too I also
have the delay and a timeout to the job
or to tacit your scheduling so in here
just say this task I want to
trigger it with the delay of 10 with the
time into a second so we've been
WebSockets okay batch who's here doing
batch J batch just a couple of people
okay so let's go for this very quick so
here on unbox also using a jpa entity
nothing fancy just to store some data
and usually for bad you will implement
these free classes the item or either
which will just say like an open method
will it just read the data that you want
to possess a real item the processor
itself just going to write the elements
that you read and the sorry the writer
and the process is going to map
something on your on your on your
objects so again sewing redress nothing
special about this class the process of
itself let's just say that I'm reading
like CSV file so usually again now we're
going to split it by commas and then I'm
going to map it to the to the class that
i want to write again we can use an
optional here and use the maps to do the
the mapping on the object if we want to
create so i create some great i'm
reading this this line over here I say
optional of item I classes through
string like this so it's it's also you
can all use a method reference to the
casting I actually prefer this method of
instead of doing the usual one likes a
string before split it by commas and now
I create the action the action by using
the values of the array that i got from
from this map then I get the optional
so for the reef or the writer itself
again usually let's just say now that
you have to set up the ID the old way
you will have to iterate over the array
grab the item cast it back set the IV
and then persist it now with with dreams
just get the list you call the map and
cast do a map again to grab the other
the item set the ID return back and then
for it call for each and call them to
manager persist so it's a little simpler
this way I guess any questions so far
okay so now let's go to some a little
more crazy stuff these things thats all
i have a couple of ideas as well that I
came up with those don't work but I
think there are some ideas that the
specs can evolve to use some of the java
java SE features so who's you're using
bean validation most most most of the
room some validation you know that on
validation let's say we have a class
here called driver driver as a name and
a license number and you have you can
have your custom annotations that's
going to validate the driver itself so
usually we will have like you'll have
this annotation over here a license that
as a not know and has a constraint and
you have to pass in the class that's
actually going to be map use a notation
to do the validation itself so you have
your d slicing validator and then you
have these initialize and it's valid
which is to return the boolean so it's
quite some boilerplate code that you
have to implement
so my suggestion over here is is instead
of having to use all this water pipe
code we could have something like called
these oh sorry it's not okay enhance
evaluator is when you inject the
validator itself you could just say so
this is not this is just code that I
wrote so this is not on the Java EE
stuff but you could say something like
add constraint validator passing the
annotation that you want say good what
you want to validate itself and then
remember that the license validator
which into implements the constraint
validator from the bean validation API
is the boolean so on java SE eight we
have something that deals with bullion's
online that which are predicates so in
here this at concentra later called
passing a predicate and this predicate
then we'll just implement a validation
here say return the boolean itself and
now for the validation itself is just
SAT yet okay for this annotation I want
to execute these method reference so it
becomes a little more easier and shorter
to use your own custom annotations but
again these are just an idea it's not
there maybe which will be I don't know I
know that you guys don't like patch
sorry but i'm working on the j sorrow
for batch so i came up with this also
crazy idea maybe if we implement this
maybe you'll use batch a little more but
basically what i want to do is have a
streamable batch so basically grab the
stream or get up the stream interface
and permit something i call this
remember batch were basically what you
can use is the entire stream api on a
batch way so
basically is something that will look
like like this you'll say I have a bad
job I say how many how many elements I
want to process let's just say ten and I
passing everyth so basically this really
is just a again an item either which
comes from the batch interface and I say
what I want to read so basically what
I'm having here is I'm creating a query
which comes from a database grabbing a
result set basically i'm passing in the
way that i want to read elements into
this stream and since these streamable
batch which is just an interface aren't
going to fear to be able to show the
code xn stream with these additional
methods then I'm able to call all the
API that strange gives me of course
including maps sorts filters all kinds
of stuff in the end I'll just have
another method called right to write the
elements to something else and I called
execute so the idea of this code will be
I'll grab like 10 elements put into a
stream do operations on them writing
back grab next n elements and doing
doing basically doing the operations in
a chunk and the idea as I explained this
to use the same API to improve your
experience to deal with batch process so
it will look it could look something
like this but again this is not there
yet so I'm guessing yeah other crazy
ideas this not that much crazy probably
the last thing I have to show you guys
is since just an improvement for JP I as
well it's just applied to JP a but it
also be applied to all all the other
cases on java ee where you have to have
like an annotation that receives the
same rotation over and over again so for
instance if you have multiple named
queries you still have to rap name of
queries before then it passing
the individual namath queries for that
now in java SE 8 you're actually able to
repeat the annotation so basically these
things can go away and then you can
implement something like okay I have a
name of query and this is the one I have
another name required in this is the one
and then you can repeat these as many
times as you want so just makes the code
a little more simple or gas so let me
see if I'm done so web sockets
validation timer again basically these
are the ideas I mean working with some
of them as I shown you can use them
right away some of them are some crazy
ideas that I hope that we can implement
in the future so I'm open to other
questions now we still have a couple of
minutes left no more questions guys okay
so I only have one last thing to say to
you I was almost forgetting what about
parallel streams have you guys using
parallel streams no well parallel stream
is something was also introduced in Java
8 that allows you to call a method
called parallel stream instead of
calling stream on a collection called
parallel stream and this means that
should be you're going to be Hannibal as
a in parallel and all the elements are
going to be processed in parallel now
the problem with parallel streams is
that they use the common for joint pool
so these are threads that are outside of
the Java environment and the for joint
pool actually use all the CPU cores that
you can represent on so it's very
dangerous if you use parallel strings on
a Java environment because most likely
it's going to start on your course and
you might gonna be problems and on your
enterprise applications anyway if you
really want to use parallel streams on a
Java environment you might want to use
these property over here which basically
tells basically says is now polished
metal so basic says that the cores that
they are parallel seems going to use
just one but maybe we can tie with these
around and say to and at least assign
two cores to the parallel stuff but
hopefully there are already
conversations for the Java EE future to
start handle the parallel streams
properly and you were able to passing
the Frederick the security service on
the parallel streams to use the to use
Fred's from the common executor poo on
the Java environment well that's it
thank you so much for your time guys
really appreciate it for you guys to
come into my session if you have any
other questions please let me know i'll
be around the conference and you can
reach me on any of those channels so
once again thank you so much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>