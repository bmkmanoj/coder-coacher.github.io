<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Securing RESTful Resources with OAuth2 | Coder Coacher - Coaching Coders</title><meta content="Securing RESTful Resources with OAuth2 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Securing RESTful Resources with OAuth2</b></h2><h5 class="post__date">2015-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/DX0TFtoRCOE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so today we are talking about securing
restful resource wheezing well first on
to first of all I'd like to thank you
all for coming
now I can see so many people in my
sessions a pleasure to talking about
that I know we already had two talks in
these Java one this year about securing
restful resources just to me know is
there is any anyone I read solve any
session about off at d0 at JavaOne
please raise your hand okay I'm going to
talk about a beginner introduction about
restful resources and aalverson - it's
not an advancing talk but I will give
you a brief overview and I have a demo
showing some good approach to working on
these security stuffs and I hope not
have some duplicates with the other
sessions what I have done in the Java
one so first I'd like to introduce
myself and this is my picture I am from
Brazil and we have some guys from Brazil
also here and I working as software
actor architect for Integrity's
directors it's a company for working for
some projects around the road and we
have around 100 developers located in
Brazil and also in u.s. and Sri Lanka
team we have doing a very good job you
know some projects around the world and
I also a joke bitter for you Java SE
which community in my city I have some
friends from the same community here so
this is my brief overview
about the agenda for today we have some
talks I would like to show you first the
concepts about of' version 2 what's the
difference between the version 1 and
version 2 I'd like to know about the
grant types which are important and when
you are working around that we have the
tokens actually out version 2 it's all
about tokens so we we aren't talking
about what kinds of tokens you can using
with this specification and codes and
also with a implementing you have in
Java available to date you working with
a lot of version 2 I have different code
to show you guys about libraries which
supports of version 2 so I went out we
had to the morning was about Jersey
person - I don't know if anyone watch it
this total but I'm going to show you a
piece of code of Jersey and also have
some other kinds of implementations to
show and also a demo so first of all we
need to know why we need to securing
resna if you look this picture here we
can see so many kinds of public web
services API you have available today in
the market and today in the internet so
if you need some data for gaming steps
or analytics context ERP systems and
muse key social steps we already have
that available in the internet so the
API it's a kind of buzzword today all
you need is get the data not to create
the data and these integration is about
web service in the past we usually use
libraries or propria or proprietary
libraries should do that with today
we are going to use web services for all
the kinds of integration stuffs and when
you have those we probably need to think
about security security is very
important if you want to get some
sensitivity data confidential data like
social steps you know you need to share
your social security number or you need
to share your preference and you need
privacy
so all those api's needs to think about
security and when you think about
security we have basically two concepts
two main concepts about is the
authentication process which means the
user need to validate his credentials
like username and passwords and we have
also the authorization steps which means
the checks about if that user has
privileged to access our resource for
example and we also have policies
involving strategies and that is you're
going to talking about our first on two
and how can I help you on that security
is is a pretty good top because we have
different approach to program and in the
past we have different ways to secure
our api's for example we can use a basic
approach which means using the
application server strategies to block
the urls the resource and we have
credentials over the
either parameters you know preferring
transferring over the network and we
also can have certified certificates
signed certificate sorry about the
diesel education way but there is no up
a good approach
today to do that instead of all our
other selves and if you look the
wrathful or rest they haven't any about
anything about security wrathful just
defines procedures like HTTP methods or
paths get post and you have any
information about security so this is a
good field to working on REST API when
you publish it those API is over the
Internet we can have some problems like
the standard web apps problems for
example injection attacks replay attacks
and other stuffs so you need to figure
out how it's the best way to secure our
API so that is the question about and if
you look the traditional way to protect
our research we can look a picture like
this one on this slide for example on
this use case we have first page which
call it a web page print fast it's a
website to print your photos over the
Internet but the photos are actually not
located at the website this website
wants to connect in a cloud provider
like Picasa or Flickr you know and the
strategy to do that before 12:00 is
basically creates a login page on the
print fast websites when the client app
and the user inserts the username a
password over the client app and client
apps transfer those data to the
providers to plank pro cloud providers
what's the issue here we are sharing
some configure data in the client side
so if we put our Google password
that will be sharing the client-side so
we we have a big issue here because
sometimes the client app needs to
protect the Google password sign steps
if you hack the first client app we can
get the Google passwords and Google our
other providers password so that can be
pretty painful you know
so using off the this picture is
different we can look a different flow
using this approach on this screen so if
the print fast application we need to
access the photos here you redirect that
to the cloud provider like Picasa so
Picasa you offers a login screen at
Picasa domain and the user inputs the
data directly in Picasa domain so on
this case because I you handle all the
security steps and you grant or deny
access for the pictures
the research for the client side so the
clients you get a token and access for
out resource-related so in this case
here we have a different flow from the
first one because we are not in sharing
the credentials for the client
predictions in the first app for Sep
just need to redirect that to provider
so that is the basic flow for off so
that why was why did you use well first
of all all fees are standard protocol so
we are talking about standards and that
is pretty important to not to avoid
proprietary languages and also enables
applications to access data across not
sharing credentials
which is pretty important as we said for
off avoid password issues
so if user and password is fine you
don't need to take care about that you
know and one good thing here is all
required required users require the
lightning axis so if you you deny or
grant access for different applications
you can after a change that change your
opinion about for example if you get my
smartphone and grant access to Twitter
and someone gets my smartphone I can or
if I lost my my smartphone I can go
directly in the Twitter site and denied
the access to protected my data you know
so I'm not putting my credentials
directly in the smartphone sighs I'm I'm
grinning axes in the clouds so that is
very important if you need to keep some
privacy and not shading she's not
sharing credentialed stuff who is it so
who is using walls today some we have so
many players using of today so many
companies especially companies which
provides public
api's you get some data for example
Google is already using adverts on to
Facebook Flickr and other ones so if you
want to integrate with those systems we
can use this protocol it's AI standard
protocol and you can get the data to
have that in our system you know about
all timeline off is currently in the
version two as I'm speaking about but we
have also the version 1 and 1a the
version 1 is basically relate
to the authentication process not for
authorization protocol so if you want to
use the version one we can just use that
for for this proposed and the version
two is inverse version 2 is about
authorization process not about the
authentication process so a big main
idea here is using off to buy with
another kind of strategy for password
and credentials so we can mix it well
chew with open ID connect or other
technologies like that so probe 2 is the
current version this available since
October 2012 it's secured simple and
standard and still being working on so
we have some new new improvements on
this area for off to this version 2 is
not about user and passwords is only
about tokens so when you use of version
2 we are at sharing tokens across the
applications related so we have a system
to create and manage it and start the
tokens you have a protocol to use this
token and get some privilege to access
research so off to use the delegated
module which is a this grant and deny
process it's very simple we are looking
some demos one good point here is off
true is not compatible with all version
one so if you are already using version
one your app you can't be great to
version two you need to rewrite your
code or you know we need to choose some
strategy
to be able to get this version to
applied in our code so well of to is
especially indicate for authentication
process and about tokens we are talking
about that and show you some demos we
have some rules involved on these
processes for example our version to
have four different rules the first rule
is a resource owner such owner
represents the user the final user
basically and he is he has decreed
angels and he knows what kind of data he
wants and the resource unit usually
access the client application which is
your application and this application
usual connects on our research server
which provides the data across the
network for example the research server
can be Twitter or Facebook and you can
get you can get the data from there to
be able to get this data you have a
authorization server which manages all
the token steps so the authorization
server generate the tokens start the
tokens and share the tokens for the full
system I mean those are the four rules
related in the OS version two and you
have a basic flow in this picture when
we can play without version two on this
picture at the resource owner tries to
access the application client to get
some data this data is coming from a
different different source for example
I'm using a client app to get some data
from from Twitter so the client you ask
Twitter
domain for this data and that would be
redirected to authorization server the
transition server you ask the user you
redirect the page to user and ask the
user to get the credentials about it and
ask the user the grants or deny about
that pulse for that specific data if the
user agrees then the client app can get
those results so the idea here is
protect our research our restful
research using this approach so if you
you are coding our research is using
Java like Jax R Us or using jar C or any
other kind of framework you need to
think about to protect those resources
using this strategy we can also use
other kinds of strategies like HTTP base
or any other but this is a good approach
because it is standard and we have so
many players at the market using the
same same way so the grant types are
basically the four different ways or how
they allow true works so we have the
authorization code way which mark
indicates to web apps that is the
standard way the traditional way to work
with your app we have implicitly grant
types which Mar indicates two mobile
apps and web apps but web apps using
Ajax are another kind of JavaScript
stuff we have the resource owner
password credentials this is kind
similar than the HTTP base bisk
we need to insert the user needs to
inserting char the credentials for the
source app so that is this case and the
last one is the client credentials
well you can use our certificate assign
certificate to get this data from the
source through the server so do this the
four types about that looking around
that we have some different flows to
play without on each of these brain type
the first authorization code is a
stunner as I told you before and on this
case the user wants to access the data
and the client app you ask the data for
the authorization server and the
transition server redirects for the
final user a page to login and grant the
tag they access for this data
so if user agrees the flow view back to
authorization server and authorization
server you gives the client a path token
to get those data and file an app you
can get and access the protected data
without any issue related okay if you
try to access directly without token
that won't work you you'll be block it
the implicit e way is pretty different
the first one on this case the user
wants to access but basically you have
some JavaScript code running over here
and like objects which which needs to a
pinch the research server every time or
ever minute for example and on this case
we can generate the token and using a
refresh token to access the data over
some time cycle time I mean the idea
here it's using that this approach in
some JavaScript you know Ajax and that
is the big difference between these are
Oshin the last one the third approach
the search on ur credentials basically
the client you provides username and
password to authentication server so
this login page you be at the client
know at the server the final server so
that is an issue we talking about at the
beginning because you need to know what
data you'll be related so but if you
trust on this client if you are server
trust on this point you can use this
approach know that that would be good
and the final the strategy is about the
client to client credentials on these
case you can have a sign it certificate
and you can have a tryst agreement
between the client and the server so on
this case you can use pretty good
strategy about security so this is more
cost involved what is about tokens as I
said before so we are not in working
with different username and password
approach is how about tokens on this way
you have two kinds of tokens one token
call it B here and another colored Mac
the Mac is was use it at version 1 so
these Mac approach is not use it by
version 2 this is a kind of duplicated
strategy the beer is the token standard
for the version 2 so it's a large Rando
token it's like a number we we can see
here a random number
mixing letters and numbers you know it's
not a except decimal but it's kind of
and dizzy generate by authentication
server and thus token needs to be
cryptid because of true doesn't crip it
diss talking to you so that is not group
it and usually when you have this token
being being shared over the network you
need to work with a so with SOS SOS our
any kind of protocol those tokens are
our share it as access and refresh token
those two kinds of tokens we can have
the access tokens a short live token
basically use it for short periods of
time over your application and refresh
tokens a long lifetimes token usually
use it at implicit II strategy by
JavaScript so Ajax so those kinds of
tokens can be used both in the same
application what are the pros and cons
about the price for off we have a good
integration for different applications
we have a standard here waxes can be
granted for a limited scope or duration
you can also denied the access after
some time depends on the client choose
client can go at Twitter at this time
and just denied the access and no need
user to SH our password and credential
steps that is only related to the
resource server not the client and some
drawbacks here we have some complexity
at this time to working on not how
libraries are supporting off to for
example in Java we are going to see we
just have a few options at this time and
those options not support the few stack
for off to lie
the server's some libraries just give
you the client connection about and we
and these protocol just specify the
how you can use that know how can code
that so those libraries are pure
difference between the code so you can
have some problems to share this
knowledge about change one neighbor to
another one the Java side we have some
different implementations available
today I listed some ones here but
probably have some others over the
Internet
we have Jersey which is the reference
implementation for jax-rs jar six you're
all right supports of two we have Apache
Apache OH - it's another lie bridge with
supports of version two we we have
spring security it's a pretty good
library which supports of version two I
show you a demo at the end using spring
security and few others available at
this time one point here we haven't any
thunder at Java Eastside for this
approach we probably you probably need
that in the future you know maybe at the
the jacks are us API or you know at the
Jersey but at this time you have any
standard available at the Java EE side
that is a pretty good idea to the future
for Jersey uh I think I don't know about
that or I read her about that Jersey is
the current reference implementation
about jacks are us Jersey has support
for OAuth version two but only supports
the client-side so if we want to protect
our desserts using Jersey
Jess I don't support at this time I've
stock it with the speaker and worker for
Jersey at morning and he told me Jersey
supports its in probably at the end of
the year
nope they are working on that at this
time but I just want to use today
they don't have this available to use
Jersey also integrates the Java EE
standard security steps we can use some
annotations like rules and nine so if
you are using the role system for Java
EE the Jazz support which are so you can
give us those annotations apart-er they
also have entity futures futures we can
filter JSON data over the resource and
over the network and jars it can be a
good approach for this one I have some
code here for jjrc so this is a resource
using drugs are us annotation and you
can look you can mix it some jazz RS
with the Java EE standard security
annotations around that so we can deny
access or we can protect some access
using rules systems but on this case you
need to integrate the Jazz with Jessie
and Jax are us you know so if you are
using different approach you can't do
that by your your code I mean for the
OAuth 2 client supports Jersey give you
some class sodas our example to connect
with our server protecting research so
we can have a client support you know
offer some chewing Jersey
basically we need to create a flow flow
object and this flow can be started and
finish so during this time we you be
redirected to the login page for the
server and the user you interact giving
the username the password and the grant
and deny access policy and at the end we
can get the token results so during this
process
jug's ERC doesn't support at this time
but for the client-side we can use the
GRC api library as this example Apache o
- it's another library we can use today
for of version 2 integration he also
covers other kinds of security
implementations like JSON web token
which can be used by generated tokens
over the JSON JSON is under we can use
the JSON web signature also and OPL D
connect those protocols are also
supported by Apache o - so if you want
to use that that can be a good choice
for you
Apache OTO also supports the few
features for OAuth version 2 so we can
have the client as Jared say have but
you can have the resource and
authorization server also covers by
Apache code that is good know also it
provides pretty definite a clients so if
you want to connect to Facebook or
Foursquare or github we need to
understand some kind of code to
integrate around that bashi Auto has
those libraries available to you so if
you want to integrate with Facebook you
can use a library call it Facebook
a client type and that can connect to
you you know that is a pretty good if
you want to use those libraries in our
application this is a sample for Apache
o to PI co2 is not integrated inside of
the servers so need to create this code
to protect our research for example this
is a servlet Java server the class gives
you publishing some resource so we need
to create some code here to check the
authorization process and check the
policies about about the restrictions
and the rules needed for the authentic
authorization process sorry from this
case here we can insert this coding a
filter maybe should be able to have
these spread over our different paths in
our code but you need to code that you
know a Apache auto also supports the
token generation so we can have some
classes to generate and start the tokens
so all of version 2 has some way to
generate these tokens and keep those
tokens across the clients then we can
use some classes to generate that for
example well you sure and off token
requires to you you can get the access
token and refresh token like this code
here so that is pretty good easily to
figure out and understand how to code
that to protect the results protect the
rest resource you can have some code
like that off resource request and
access to
Okin no Apache auto also support that
and the client also this is a client to
connecting the Facebook so it's pretty
simple you know you can get Olaf client
to request class and you can set the
provider we already have predefined
providers here for example I am using a
Facebook provider on this code sample if
you want to use a Google or github
Twitter you have these available on this
library so this is a pretty good to
reuse this code and we can create the
client and access the token to on these
sample here's the same sample we look at
Forge RC is the same approach the client
only but Jersey doesn't have the
protecting research as you look at
before and the last one I will show you
it's spring security of its base it on
top of spring ecosystem so we can use
this spring security configurations
around our code it's implemented four
types of authentication grants so it
supports all types of authorization
grades from olaf protocol supports of
two full futures also like authorization
research server and client has a good
integration with jacks are us in spring
MVC also so that's the pre good approach
if you are using a spring you're writing
our code you can use you can get this
library and just set up and use for that
this library has some configuration
points like this one we can use
annotations to create and enables the
authorization server basically we can
put these
code inside of our spring configuration
class and sets the details about the
token generation about the toking
storage we can using in memory or JDBC
implementation for storage tokens and I
also have some other points to set on
this class you know this is I'll show
you a demo using Springer off so you can
look these sample directing the codes
running that you'll be very to figure
out how that works
no we also have the spring research
server that can be the same server as
the authentication server we have
different configurations and annotations
about the enable research server is the
configuration to set on we also have X
meow related if you we want to set back
by X meow and a pretty good feature here
is about the expression based access we
can have some access like expressions to
restrict the resource so we can add for
example of two client has whole to check
if the client has some rule to access
the resource or if client has any rule
or deny client we can have those by
using expression basis which is pretty
simple to protected no spring go off to
all supports the client it's pretty
simple also we have a notation like
enable of true client we also can use X
meow related and all these steps related
about redirection and the connection
between the source and the server-side
you
be handled by this code you know we
can't figure out we don't need to figure
out what should be done to be able to
have that working so this is the last
part of spring off client support I have
a demo now to show you how those things
stuffs and fit together this is a use
case using oauth2 and spring based on
spring so this is a conference
application which share it with sources
with different clients for example we
have the JavaOne conference here the
java one server has data about these
speakers has data about the sessions and
we want to get this data choosing a
different client application for example
I will show you how you can protect
those data using off on this damn an
hour now
I'll try to start and show you playing
and after we can dig inside of the code
okay
Oh
guys okay so working out okay oh these
demo here we have a client app on this
one let me open with a different browser
here just to show you how that works so
we have this client application here
this kind doesn't have the data so this
client needs to get data from the server
the conference server on this case the
server is a different app hosted in the
same server actually and if you try to
access the data directly for example I
want to get the sessions about the
conference using our arrest service see
I can get this one because I unprotected
those data but if I want to get these
Pickers at the same server I will get AA
block it here so these data about these
speakers are protected using OAuth
version 2 and we are using the clients
application to access this data right
now
so if you try to play that by the client
code for the sessions okay that's fine
is unprotected but for the speakers
you'll be redirected to a login page in
the conference server ok on this case
here we are using the OAuth basic flow
about the authorization process so the
client tries to access the data and the
server red rag to login page and show
this login page to a final user so the
user can just insert the username the
sir then click on logging after logging
the user needs to approve the policies
about shutting data so you can have
approval deny some data are you approve
and at the end we can have the data
showing so we have these speakers now
some speakers are in this talk I think
ok so ah this code here look inside we
have two different applications running
one is the server call it conference and
another one is the client the conference
server has the resource related so I can
look those resource using this class
here so this is the class sharing their
results we are using here the jax-rs api
you know so we have deep speakers and we
also have the sessions on this class URI
we does not we don't input the the
restrictions about the both to security
that will be inserted inside of a spring
configuration around so this class here
is just clean drugs our ice code and if
I look on the configuration about I have
all the OAuth configuration management
by spring at this time so I have here
the paths request so on this case the
path readspeaker's you restricted by
access
by users has hole only hole user for
example so that is not public that is
restricted the rest s also and other
paths also we enables the resource
server here by this code doing basically
the same process for example here you
can use that expression based
configuration related so we can create
some custom code should protect our
research those are our policies related
and over here we have the details about
token generation and storage and all
turrets and secrets I'm on this code we
are starring the tokens in memory not in
the database but we can put those data
at the database or you know over atashi
she's a kekkaishi system or something
like that so we have all the policies
for the tokens generation here and at
the client side we have a different code
also managed by spring on this case I
have both two clients
I also configure it here which I have ah
off details for my clients and I said
what is the token where I'll I need to
provides that we redirect to the server
and what should be the authorization
we're all related so setting those
profits I have the flow working fine
as I show you before redirect to the
server server to the clients getting the
logging data and approving are denied
the axis and all those steps you manage
it automatically by spring at this time
I mean and to access that you can just
use some codes like this one you have
the operations related and Kingdom on
this line here for example I can get the
object for speakers data I mean I can
get these speakers data for the rest
research protected so this is approach
using OAuth and spring as I show you
before we can use Jersey or you can use
Apache also but on this case I'm using
spring and Bob to is a pretty good
protocol standardized it by someone and
II we can have those steps working fine
and feeling together to give a good
approach for security stuffs you know
back into my presentation here these
demo code is already available in my
github so you can get you can have the
access there okay so any questions
related let me know
I just put it on my list hit there you
know but CSF also parts off to the full
features of server side to client and
server side but it's a pretty complex to
figure out how to fit together you know
that API is not clean cling to figure
out and understand how it should works
you know I prefer spring if I choose one
today
I prefer Springs mark clean to figure
out how to put out together you know but
cxf also parts you know full yeah yeah
they you can use the Refresh token to
get another abscess talking basically
yeah sure sure for you basically needs
to keep this token the server-side
so if you keeps for eight hours for
example this token can be expired for
any region and you need to refresh that
for to avoid to expiration time you know
yeah yeah yeah the Refresh token is
basically used by JavaScript code you
know doing some psych cycling requests
yeah yeah that's right okay yeah yeah
that's right
well version one handles authentication
but version - no and on this time we are
using different approach for that for
example we have open ID connect mix it
with OAuth 2 so of two is only related
for the authentication protocol at this
time
they just concentrate on this one and
for authentication we have different
protocols like Open ID Connect or JSON
generation token you know strategy
so the yeah yeah I own on my demo in
general it depends depends on each
application you know in my demo I was
using Java Java authentication process
the standard you know jazz for that but
you can choose open ID or you know also
Alf - but sorry also of version 1 if you
want but that depends on each case I
mean
yeah I'm farting yeah no that not
happened because they are completely
different so we have the name the name
is the same but the idea is completely
different you know so the version 1
version 2 are not compliant set at this
time I mean compatible at this time yeah
those tokens are not creep it so you
should creep it using a secure protocol
like SL s SL well some something like
that
no yeah yeah I know that is you can
creep it yeah using some md5 you know
md5 ER but that's not part of elf
protocol you know you need to code
something probably okay so guys I'd like
sure
so guys I like to thank you again and
see you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>