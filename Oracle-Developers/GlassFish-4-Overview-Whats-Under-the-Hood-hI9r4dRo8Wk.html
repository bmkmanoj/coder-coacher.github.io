<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GlassFish 4 Overview: What’s Under the Hood? | Coder Coacher - Coaching Coders</title><meta content="GlassFish 4 Overview: What’s Under the Hood? - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>GlassFish 4 Overview: What’s Under the Hood?</b></h2><h5 class="post__date">2015-06-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/hI9r4dRo8Wk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">well hello everybody my name is marcin
hi I'm Chanda percale we both work for
oracle and we are part of glassfish
organization and this is just to let you
know that whatever we are going to
present and demo today is for
information purposes only and may not be
incorporated into any contract so first
what this presentation will be about we
want to tell you first because we want
to give you chance to run away as soon
as possible so definitely this
presentation will be about glass fish
and as you probably know the main goal
of grass fish for is to provide you the
java ee 7 implementation but this
presentation will not be about java ee 7
yes it is not a little bit true as i
said at the end we will actually to the
generation but it will be mostly about
the GlassFish we want you to see the
GlassFish server your application server
which can you use and you can add Murray
State it and whatever and because it is
also open source and at least we can use
it so you also can use it and can change
it can use its modularity can extend it
by our own commands to do whatever stuff
you want to make this cetera get rate
for your work so but still there are not
so much changes in this spec in this way
of seeing of the grass which because
really the main goal of grass before is
java ee 7 implementation and i am pretty
sure that you already studied july is
seven on this conference it is third day
and there are demo boosts and whatever
has several sessions about Jie seven so
we will really focus only on the grass
fish itself and we will focus on
glassfish only on the new stuff because
God's wishes some history we have just
one hour we cannot cover the whole glass
fish so we want you to show what's new
in the grass wish for
itself and because we will focus only on
this part we can see it from three
different ways first is that you
probably use the GlassFish so you need
to make administration by the way this
is main interface between you and glass
which itself is administration interface
API is mostly for developers in java ee
7 and also because we can i won't like
to show you that it's pretty easy to
adapt this server to your needing so i
won't also show you some pieces of code
how you can do it that it is it is fine
to adopt it creator commands and
whatever and because most of you are
engineers or so we will speak we will
tell us tell you something about to how
we done it to understand why there is
such change so don't worry there are not
so much changes in the grass fish for
itself from the previous version and in
the beginning I have to tell you that we
have three presents for you to have some
farm unfortunately two of these presents
are only pointers to some data so but
Sir present is physical so you can take
something from us something small
because we like that you are here now
first people talk about our command line
interface about our CRI first
interesting change what we made which
makes feature yet well be pretty change
the CLI not invade how you see it it's
almost the same but internal structure
is pretty different from the previous
version and it has some positive effects
some new features one of these features
is that it is now possible to detach
your command to start your command on
the background yes it was possible also
before because if you start some come up
yes admin you know this utility some
and then you press control-c the command
going on just you break your interface
but you will never see how what was the
result of the comet if it was success or
not now it is possible to do that by
just simple sink a simple switch called
detach and if you do that you will see
some number some ID and you can then
attach to this command or you can check
how this command goes or if it is
finished it is okay or not so maybe I
didn't see it set set it to you before
but most of the this presentation will
be live and we will show you on
glassfish installed on my on our laptop
so let's start to something that edge it
can sense most your commands which can
take sime time so for example start
instance can take some time okay detach
okay yeah
thanks but fortunately the first tell me
to do so you see that we receive just
some job ID and terminate him urgently
so we can list it using this command
yeah this is that we have just one
instant it is done it was successful
great so let's start some other instance
no problem and now we will attach to the
ID so we must wait for the instance to
be started it is by the way why we
detach it first yes okay come on tis
done and it is success okay boring but
you can use it to simplify your scripts
if you have for example some scripts so
let's see some scrip some such scrip
this one yeah okay in this clip you can
see that I in the loop just list all
instances on the server which are not
yet running and then I just start it and
use that edge and because i am lazy to
pass the output itself i use tears it is
already existing feature of the grass
fidgety few stairs the output can be
shorter maybe to be better parsed settle
by our screen so if i use tells with the
touch i will receive just the idea
nothing else so i can just put a result
into some rest and then i will wait for
particle van started started instance it
helps me because instances are now
started in parallel and i have five of
them so it can help me to do that okay
now we take something like four or five
seconds to start all these instances you
see we are waiting for the first one and
the second and third will be done very
fast very quickly because the second
insert are executed in parallel okay now
it's done if we will do it in series it
will take much more time I am professing
I promise it ok back to the presentation
simple new fiction the simple new
feature for your understanding is
something like a fact or a result of our
changes of the CLI itself as you know
you can admit a glassfish in several
ways and one of it which we use now
mostly is the rest interface but we have
also several others interface CLI his
own interface your graphical console
console as own interface and now we
convergent everything to this
best interface so the commands CLI now
uses also same rest interface as you can
use in public yes little bit different
URL but the same internal implementation
which which perfectly covers our CLI
needing so now we have commands or just
HTTP interface / command station command
name and if you get there you will
receive model of the comeup and jason
model is what parameters you can put
your if it is mandatory or not and you
can make orient yourself or you can post
there and it means that you just execute
the command as simply this is a simple
sis one more improvement is that we have
we have now the models cached on your
local interface your local computer
local local instant so if you are using
glassfish from far cellular from another
sellers from another computer it takes a
little less time to use CL eyes and
before by the way is now a little bit
faster than before at all not only
little because the business logic is
almost same at the CLI itself is faster
now and also the executive command
mostly we can do that we don't have what
we can do that we can execute commands
using server sent events so we can
connect to the command and if the
command wants to tell us something
during its execution it can and you will
see printed on your screen it is such
simple and you can also use it yes I
think that most of you never create
command for the GlassFish but it is
really simple you can just annotate some
class that it is command implement one
simple method and you can do that and by
the same approach you can feel your
company needing Slyke for example
whenever somebody deploys on your server
in test environments in another test
environment in production environment
for example you need to innate deployed
application to be locked in some
information system for operation teams
that there is new version and whatever
and you can do it you can just create
your command you can tell by annotations
at your command must around after or
before some standard command like deploy
and everybody will deploy also execute
such command and do your business stuff
again to the live presentation so first
first back to the CLI interface so I
touch that VR now on we are now on the
rest interface and that it is simple to
use yes we who are working with rest
often we are you Carl to demonstrate
whatever is possible but maybe you have
better fingers
so command and the simplest command ever
is up time of the server get the
director me Jason Jason string which is
the model yes it is pretty pretty
unreadable so I will parse it and you
can see that in up time I have just I
can put there some just one some
parameter called code milliseconds so
that I can see the result in my sequence
of a do something more interesting let's
exactly something oh why not the final
up time so we must do post and
fortunately or unfortunately all
interfaces or HTTP interfaces in
glassfish masthead from security reason
cross scripting cross scripting control
do not be cross scripted so the simplest
cross cream think prescriptin control is
to provide monde some mandatory custom
header because it is not possible to do
that from the browser currently so our
costs custom header is standard custom
header for Jersey because we are home
jersey you know way and this is X
requested by the value is not important
it just control that we can do that and
let's put another header that we accept
actor jason i hope that i am correct so
forty-eight 48 / c'mon /up up time
and post a HDD be yeah my fingers are
really bad so it was again Jason so
let's see in better eh okay one hour my
gosh nose running one hour now SS e i
tells it i will show you the sse so
first again the assessee are nice if the
commands goes for a long time this if it
is long running so for example star
cluster but because i never remember
what I have to provide I first take the
model of it and I see it at least I need
to provide cluster name so as simple as
you can so first first of all not actor
Jason we need SS e and SS e by standard
is text event stream HD cluster name is
I remember that I have c1 coastal so
let's try okay and this it cross tourism
you see that we receive a bunch of
events it was pretty fast and this event
the first one is important you see hit
the ID this ID help us to do the touch
because we receive ID as soon as the
command is started we can tell you ok
idea of the come out of the service days
and you can now stop your work and then
you can attach work so as I tell you
this data is just side effect of using
the SSC for commands ok
I will try to I did not plant before but
I will try to show you also how you can
use it or how it is simple to create
command it is almost unchanged you see
that your command is just service with
some name this is our standard
annotation for any service with some
name and the service implement this
interface and this interface is only
contains this method and that's all now
you create your business logic of your
command and if you have some parameters
you need you just described it by taste
pretty simple what to do something more
clever now we have SS e sao viet
annotation this does that my command can
run without the without the connection
to the client ok or so it means that it
will the sse pretty fits to that so use
it not mandatory but to use it and we
will create also the command which runs
on the client it means on your CLI
interface better this command this one
and this to command can communicate
using sse one way SS is one way ok so
this command just lists read count of
threads on the server and print it
server-side does do nothing important
just fire events and event put the
information how many threads of such
kind are running on the server client
side again nothing important in execute
just execute the command but first it
register own self this as a listener and
then implement something on admin
command event and any event from the
admin account of this name will come and
I can print it so it is kind of the view
of our of our data
and then seeing two simple class let's
try place surrett going until I
terminated on the client and because
when I terminate it on the client I will
remove the several remove the listener
and I have in my command check in the
main cycle if there is such listen error
listen somebody to my events and if
nobody listen the command will exit so
it worked like that okay yeah I know
that via V was pretty deep but I hope
that you are not boring until now and
now I will ask Shonda to tell you
something more so previous releases of
glassfish already has a large number of
logging related commands like define
threshold file rotation change file size
etc so the two new commands which have
been added to glassfish for our list
loggers and set log file format so using
lists log as you would be able to see
the login name its description and the
sub component it belongs to and it helps
to understand the logger hierarchy and
using set log file format you can change
your handler from oriole to you LF or to
any other custom handler if you want to
develop your own custom handler then the
best approach would be to create it H
schedule service by implementing handler
contract by this a glassfish will
automatically register it as a service
but if not a educator service you can
copy it over to domain dr lip exe folder
and then add it to your logging dot
properties and it is still possible to
view the log messages in the admin
console so why did we change to audio
because it is all good standard all the
person oracle use oracle diagnostic
logging it is more accessible and useful
for the administrator
as well as the developers and it also
helps in internal application management
so this is just to illustrate a small
difference between the previous version
of class fishes which had the Ulf and
now that we have changed it to Orion so
now i'm just going to demonstrate the
two commands which I spoke about really
really simple
okay so as you see here we can see the
logger names and the sub component it
belongs to along with what is the
description so while creating the
application logging is boring but when
you really want to debug this is what
you have to look for and then
as you see here that the default value
is 0 deal but out of the box we also
support your lips so you can change to
uniform logging formatting and if you
have any custom handler you can change
it also okay over to Martin okay first
present may maybe you'll realize that we
often you stop and top top because we
are using the grass efficiency ally of
the glass which quite often so when we
prepare this presentation we now find
out that we never send it to the
community the best script to provide you
the outer competition for the best so
now it is on github this is the address
when you can download it so if you are
using glass efficient if you are using
CLI of the GlassFish please go to this
link or fight on github something about
our total competition of glassfish this
is pretty new for grass before you can
you can download it that use it of
course if you are using bash ok now
continuing the in the presentation
configuration ok again probably you know
that the grass which is configured
mostly in domain xml file somewhere in
domain directory but until now it was
almost impossible or hard to do for
developers of particle plugins modules
we call it modules be confused osgi so
modules of the grass which to use this
to use this domain xml for own
configuration because it is mapped it is
pretty nice for developers of glassfish
because everything in dominicks emma is
mapped to some beans which we just
create interfaces for it and some
framework what we call hd2 maybe you
know about that do the job to read this
configuration or to write to this
configuration very easily but because we
map xml to the beans
the any part which was not in the domain
xml will not be in the beans so if you
want to put there some unknown bean you
must first change some bean in glassfish
domain XML bean for example it was not
possible for the users so and also one
more thing we can use default for
attribute in XML elements in the in the
in our interfaces but we cannot tell yes
there is some default implementations of
default tech so the domain XML was more
and more full of empty text just empty
text which refers to something and it
was confusing so it does ok get it out
we must be change it to something monde
i Nam 'ok we need to through the next
versions to reduce the initial size of
the main.xml and also to enable you
think dynamically putting core modules
with configuration ok it's done the
configuration is a little bit more than
before not dramatically but little bit
smaller but the internal structure is is
there so we can now we can now use it
and some would use already using it if
you install some module if it happens
that you download from community some
module 2 glass which and this and you
read from the manual from the from the
module and that this module is
configurable you need some configuration
you can use such commands on CL I to for
example crate default template of this
configuration into your domain XML you
can call create module config for such
module and it will prepare you the
default configuration and you can change
it in the file you can when you delete
it you can remove it from the from the
domain XML using this command so there
is some support again practical before
in the first presentation we use
detection attached and you see that we
can list
jobs there's some jobs which already are
done on the set over so now server is
able to remember results of your
commands for some limited period and to
configure it I think that you will never
use this configuration but if you want
to configure to configure such
configuration you can use some command
it will write something to the main.xml
so I change my glass fish and now let's
look into the domain Excel itself I have
it something here domain xml and what we
want to grab is managed chop config and
I hope that it is not there sorry wrong
usage
okay nothing ok start glassfish and
let's configure it so yes admin
configure manage jobs do for example in
memory retention parade route 24 hours
haha so hmm configuration is done now
grep it who is there I expected it there
of course we can remove it of course it
is just module configuration the elite
module configured was the name manojob
config ok grab it away oh that's all the
tolerable configuration again how it
works I love the test sorry for that ok
here every every other configuration is
just interface nothing else which is
configured interface and you just create
your getters and setters put judge that
it is attribute that it has some default
value you can check it values against
some parameters were some patterns regex
whatever and it is dynamic why this
dynamic because it extends this
interface domain extension what was
defined here in our main configuration
in the representation of domain XML here
return state get extension by type using
this annotation please give me domain
extension which is manager job config
yes it is not there but please look if
you find interface and created by
default and if it is ur receive it from
the from the server that's all so if you
want to both the message if you
want to create your module four glasses
and you need to configure it easy just
look into our typical places like domain
xml it means domain Java interface
domain Java or do I have some okay yeah
into the domain Java or coffee or
application and you can extend this
configuration for your application or
configure ship from your module to that
just look it in our source code as I
sell domain extension config extension
an application extension are your main
places you can find more much more of
places where you can dynamically put
your configuration so now osg re so if
you have used last wish before I'm sure
you very well know that the GlassFish
modularity is based on osgi and the
default subsea I sub system used by
class spacious Apache Felix the Apache
Felix cocoa interface has been
integrated with the es admin commands in
the class fish for release so using s
admin osgi or osgi shell you can connect
to the remote shell and execute the way
she are related commands so now you can
manage the osgi bundle life cycle start
stop the shear bundles install uninstall
list the services is the way she I
bundle or view their headers you can do
all of these using the AS admin command
and we also have optional web osea
console and you can look into the
GlassFish administrative guide to know
how to install the web wash a console so
now i am going to demonstrate how to
list osei bundles using es admin come on
and list the services and also add a
sample application i'm an overshare
bundle
to start with help I want to first show
the osgi commands which are now possible
using yes admin directly and you don't
have to connect to external port to try
out osei related stuff so I'm sure
whoever has used over gia is familiar
with these commands and know how to use
Felix install uninstall LS lb to play
with their sheer bundles and now I want
to list all the way she I bundles in my
class fish instance so I have like 293
osgi bundles here and and it shows some
of them I installed some are active and
some are resolved state and now I'm
going to show you how we can use es
admin to install a new OS you bundle
okay i'm using this keyboard which is
czech republic's right Martin I'm trying
to figure out the keys okay I didn't put
specify usgi so i have installed this
new our bundle and the bundle ID is 294
so let's see what's in there so it says
it's an installed state and it's the
hello world hei bundle and now i want to
start this bundle okay so i need to
specify the bundle ID great so my hello
hei world is staring not charging pick
sorry for the typo and then i'll also
like to show the services that are
present in the washer bundle
okay why is a Z right Martin in the
Czech Republic keyboard ok so this osei
bundle has following services so it's a
cool feature which has been added so
those of you are familiar with OSI I'm
sure you're going to enjoy it ok back to
Martin okay now our section will be
about changes in glassfish because of
java ee 7 but if it is vehicle is that
if you slice it we will not talk about
Joey 7 now second present some you can
download if you want some new desk stops
for your computers glassfish oriented
desktops of course the grass fish in the
world this is just for fun first one can
be goose but use is usable the first
present this is just for fun so salt
will be real materazzi ok i will wait
for the guy to photo the QR code play
joy some concurrency ok yes
link is broken 10sec the all tiny CC did
not work we at the end of the we have
just for few fights vivir chicka chicka
yeah i check it just before
presentations at all things whoa-ho-ho
sorry beaver check it is very important
to oh no no sorry about that video yeah
presents are most important from this
presentation we will check it at the end
of the conference for sure concurrency
you know what this concurrency in July
is seven it is the same in July's II
only difference is that everything must
be everything important must be managed
by the server because it must be managed
by the operators on production on tests
or whatever there is different role to
manage it so these guys may be in
diversity I'll show you but these guys
must have control how many sets you are
using whatever so the pools of the
threads are defined by the by the
operators so only difference between
Java C and Java EE is that now you have
to enact inject your executor service as
a service as a resource injected the
resource and it also does it one more
stuff was change maybe you would not
recognize it in july seven that some
resources including this must be
predefined by application server itself
so you don't need first to define
something there are some defaults for
the developers and in most simplest way
simplest application you just directly
directly use it okay demo it's it's bad
that you cannot check the photos of
glassfish currently it will be more fun
than the demo demo you see executor
service is injected as a resource it is
the demo application from the NetBeans
under demo application so let's bro
broke it it will work before we'll be
there in the gossage but we want to see
something funny so we need to we need to
break it okay so look up for ja'von does
not exist such a resource of course we
just created now so change the
application so rebel application it will
be fast new grass fish
start a cut it out put it on
okay and deploy our application there
must be some VAR that role we deployed
application but we'd not configured so
it will not work I'm sure it will not
work these hopes that it will not work
okay the multiplications is one click
aha does not work of course and so fix
it we have to create we have to just
create the results for it so sad mean
create executor or the name of it
managed executor service okay g one
object it was lower case yes still
around work because we are used in
servlet and we already use the service
that is loaded it is singleton so we
must restart application or so restart
application glassfish is disable and
enable ok disabled executor we have it
disabled and any enable execute oh ok
application is restarted and click
Google cross fingers yes the some you
know the same publication just run
around called round round collar on a
run call execute some renewables &amp;amp; Co
Labour's ok that's all from concurrence
only that you can manage now concurrence
application in your grass which this was
the message
okay so uh July e7 batch applications so
bad shop legations for Java platform has
been defined as part of GSR 352 so it is
suitable for non-interactive
long-running bulk oriented tasks so some
of the typical example would be end of
the month bank statement generation or
end of the day interest calculation
those kinds of job there should be
extractor here comma okay so i'm sure
you have attended many more jawan
sessions where you have got information
about java ee 7 batch application just
to give a small recap so a job is an
entity that encapsulate the entire batch
process it contains a number of steps a
step is a domain object that encapsulate
a sequential independent phase of the
job and a job operator is an interface
that provides that manage that helps us
manage all the aspects of job processing
like it provides managed commands like a
start/stop risa restart etc and job
repository holds the information about
the currently running tasks and the
tasks which have already completed so
reader processor writer is the primary
pattern which uses chunk oriented
processing style so reader is the
abstraction for retrieving the input and
the processor is the abstraction for the
business processing of that input and
writer is the abstraction for output of
that particular item so once reader and
processor has completed the task on the
item it is submitted to item writer for
aggregation and once the chunk amount of
items have been aggregated they are
written out so this was a small recap of
what batch applications is so now
relation between last wish for and batch
applications so
glassfish 4 provides batter on time for
scheduling and executing bad jobs so
batch applications must submit their
jobs to the batch runtime and also
provide the information as to how and
when to execute those shops and the
batter on time then processes those bad
shops based on the information content
in the job XML which is using the job
specification language and in glassfish
server job repository is the database so
if you go to the GlassFish 4 console and
if you click on server tab you will be
able to see a new tab called batch which
contains the out of box configuration
where the default executor service and
data source has been defined so out of
the box you can use a match application
no need to create new configuration and
apart from the configuration related
commands you can also list the jobs and
the steps and what has executed so I
will show you in a minute with a
demonstration on how to how you can use
it
so this is a very simple payroll example
where I have this month ear employee IDs
and base salary and me to calculate the
bonus and payroll for those employees
okay so if you see here the input the
item reader is reading of the salary of
each employee and business processing
the item processor processes the
information and then item writer is
outputting the bonus tax in the net and
now I want to go to the console to show
you how the job repository has told this
information and we have information on
which batch processes have already
completed
so as we see here that we have executed
one time and we have execution ID and
the job name and it says it has been
completed and once you click on the
execution ID you can see that it's for
the month year january two thousand
thirteen that it has completed and also
you can see the execution steps where it
also defines the step matrix as to what
has happened the number of reads the
commit counts and the right counts so
for any long running tasks where you can
apply this pattern this is really useful
and this example that we just
demonstrated is present out of the box
with the netbeans 7.4 beta version so
you can try it out so over to model
again all today of course the last
present for you before we add the last
present is the small gingerbread glass
fish for you so I don't know how to put
it I will put it here and please calm
down were a when you will leave the room
and grab your own because I don't know
how to go with this enjoy your small
Gossage thank you that you are here sin
kuta to laugh or hate or whatever
glassfish in java ee but not ignoring it
and open eyes they have a tent for the
last and now you can solve course asked
me and i will check the link to the link
to the 10 sec</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>