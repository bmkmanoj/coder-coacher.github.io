<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CON4218   Innovating Democracy with Java EE and Open Source | Coder Coacher - Coaching Coders</title><meta content="CON4218   Innovating Democracy with Java EE and Open Source - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>CON4218   Innovating Democracy with Java EE and Open Source</b></h2><h5 class="post__date">2015-12-08</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/5gBOihM2Fu4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay thank you very much for coming to
my session about Java II hope you have
enjoyed the Java one yeah this is the
last session of Java 1 2015 so thank you
very much for coming and yeah I'm going
to talk about innovating democracy with
Java EE and open source and this talk is
about my past experience in developing
online voting systems but also in my
previous job in developing you know
applications for bangs and insurance and
so on my name is Alec Soto you can
follow me on Twitter and you have any
question you can ask me they're also
have a blog lot of the jaws calm I'm a
civil engineer at club ease and also I'm
a team member of all these projects also
I'm the key author of the apache tomcat
this on ref card and I currently I'm co
writing a book or given in action with
my friend Jason witches here so yeah you
want to go deep in our klien you can buy
the back also let me tell you that
decision in a touch different topics and
maybe some of you will say yeah I can
take everything or maybe you say I like
there's something that you have
explained that it's not useful for me
but these are things yes then pick up
whatever you need since we are you know
talking about different things you have
any question or any time raise your hand
and let's answer just in time so yeah I
said that we'll talk about Java EE and
maybe your first question is why i use
Java EE in the past and not all the
technologies and i would say that there
are different things the waste of
thinking about this the first one and
for me to the most important thing is
that was the team let me explain that i
was in architecting one
the division of the company my moon they
moved to another division and the first
day I arrived there all the team like a
team of 50 person 50 people come to me
and say hey oh you're the architect yes
we want to use job ie that's and I said
okay and why because it was a poisonous
said because we are tired of using a
spring in the last two years we were
tired of always using Alto wider
notation components can application
context dot XML and so on it was the
team that you know wanted to do
something new and they said we know that
Java e-cigs injury seven are great and
we want to use it and I said okay I mean
that I'm Java yet okay so for me it's
not a problem so what I'm saying is that
it's important to listen your you know
your your mate and tall with them and
they decide to use some technology give
an opportunity to this technology
because at the end all the technologies
works but of course there were also
technical reasons lend me warned that we
use services and what what I mean is
that we didn't use a micro services
approach nano services approach Pico
services approachin all this was that
today are so hot we use only services I
mean that maybe some services were
microservices always not yeah but it was
up let's say a service applications that
told each other using a REST API s so in
this sense we needed jax-rs which is for
Java EE it's perfect we need to pass
JSON files or JSON documents so we had a
JSON processing API we also use beam
validation for you know checking that
the an input is correctly formatted with
a GPS and maybe some of you said OHV
this is the heavy thing we are going to
see why we use HD vision also let me
spoil you that as
these are no heavy anymore they are so
light because the local HEV is at the
end are a simple proxied purchase we use
GPA for storing things to the database
and lastly we use CDI for injecting
things and we will see an example of
evens so yeah we decide to use Java EE
but then another problem that comes is
which application server we can use
there are several some open source other
properly and one of the requirements we
had was that it should be an open source
project maybe I said I'm way open source
uh yeah because of the money and so on
no it was not a problem of money the
government has a lot of money that's not
a problem of this it's about
transparency they want it open source
projects because they want to see that
when you cast a bolt you are not doing
anything strange so they wanted to see
not only your code but the code under
your problem is running so you can it
use a property application server I must
say that there was an exception it was
the oracle DB but this is the only
exception that the government raised but
rest it's open source so what we choose
which is apache Tommy Apache Tommy it's
an Apache project so it's open source
and you can think about Tommy like tom
cat plus java ET so it's a tomcat which
is quite important because this means
that everything that you have in your ID
or your you know your scripts that runs
in tomcat still runs into me and i'm
sure that everyone here is using us
using tomcat or use Tom cutting from
projects so this was one good future
about Tommy and also because our
infrastructure team which at the end was
the team responsible of deploying the
application to the client
usually did the same with tomcat we
always used Tomcat than waste our time
Tommy and it was really easy to
introduce them to me because it's like
don't worry your you know contacts that
examine files still runs intra me your
uncivil scripts still runs in Tommy you
don't need to learn anything it's
exactly the same and a top of tom cat
it's a java it's a java application
server also it's certified which means
that you know if your team has
experiencing glassfish or wild fly or
any developing any java ee application
in these servers they can use Tommy
without any problem and also it's tested
and it's tested because being certified
means that you have run like tens of
thousands of tests of the TC key case
test to be certified so the Apache Tommy
project is well tested and that's
important also it's light keep in mind
that Tommy it its weight it's like 80
megabytes and you need under 100
megabytes to run of RAM so it means that
let's say that 64 megabytes of RAM of
your system is for Tommy and the rest of
the RAM is for your application all the
room for you and I mean that you can
compare this with other solutions maybe
you need a minimum of 10 by to ram to
start and if you compare one gigabyte
with 64 gigabytes yeah it's quite better
I'm finally I will say that it fast and
yeah maybe some of these days and what
it's fast because you need to compare
with something and I prefer to show you
what I mean when I said fast
i have here an Apache installed machi
Tommy notice that i'm going to the bing
sorry bin directory i'm still using the
catalina a scrip and I do run and with
under one second you have a nap like an
application server up and running for
you with the CD a container gb container
and activemq embedded starlet whatever
you need dar with under one second now
you can compare with other solutions if
you want and tell me if it's if you are
able to run it in one second so this is
what I mean that it's a fast so yeah we
had the that we are going to develop in
Java EE we had an application server and
now let me share you some snippets of
the things that we did with Java EE wait
no the first thing is that you need to
add a dependency notice that it's only
one dependent in a provided scope so it
means that this dependence is dependence
is not bundled inside the wire and this
is because the Java EE application
server contains all your code that you
need to run your application so you only
add this jar this jar contains the
interfaces of the spec and that's all
you'll need anything else you need to
start adding adding more and more
dependencies for you know if you need a
database you need to add some
dependencies if you need to run with JMS
all the dependencies you need to use
rest a claim or dependencies in this
case only one dependent so as I said we
are we headed services and this service
is connected using
rest api and using Jack's arrest and it
was like all the rest MP endpoints were
done in more or less this way notice
that we are using the singleton
annotation which is a saying that these
classes an 8gb and a single turn ATP
which means that this there is only one
HP for the wall application there is not
a pool or anything like this and I'm
writing the default lock mode from right
to rate so you're wondering why this is
a new GP and it's an AGP because heb
comes with some default really nice
features like for example transactions
any method that is executed within an
heb its transaction by default you can
use the security annotations like permit
all Daniel or resolve it or even you can
as you can see here deal with the
concurrency thing and this comes for
free for you only using an 8gb and since
a local heb are a simple proxy apostle
you can you know put it and need to know
really a paper a performance on this
then we use the path annotation to say
yeah this is a resting point that you
know comes from a slash color another
very interesting thing is that we inject
directly the entity manager in the rest
endpoint we didn't use a doll pattern it
doesn't it doesn't matter I mean
entitymanager is a generic dowel in its
root and what you need to do an dau then
thou interface thou implementation and
this replicated for all your entities
for simple creating the reading updating
and doing two queries it's you know it's
a waste of time for developers and not
only for developing the Dow's but also
for writing tests for this code so
remove all this code and less code less
box then yeah when you see di to
things and finally you can see just a
top sorry at the bottom of the slide
that I'm this is a post and you can
submit the application ji-sun we used
beam validation in the in the parameters
so in this case the first parameter say
that it's in a string that it must be
from two to four lengths and then yeah
it has a poacher with this collar that
should be a ballad and this color is
annotated with more bean validation so
yeah it's a really simple rest employed
but you have ever I mean that everything
here it's a transaction endpoint it uses
a database and validate the input and
it's really really simple and without
you know having one dependency the other
thing that we have seen in the example
that I use CDI for injecting things but
also use really in any really several
places city events and this is a example
that I really like to show sometimes
when you are doing some operations you
need to send an SMS to the to the user
saying hey I don't know you have been
accessed in this application this time
or whatever and so we create an even
that a notification even which contains
all the SMS number the name of the
person the measures and so on and then
in our code at the end when we need to
send an SMS we do an SMS even that fire
we set birthday even and the even was
you know fired and the question is who
is observing this evens and the problem
is that if you deploy your solution in
Spain you need to talk with one provider
if you're deploying your your
application in u.s. you need another SMS
provider so basically what we did is
creating
in this case is just two jars files one
for Spain another for us observing the
notification even as you can see and
inside each method it will be the logic
depending on the country so when we need
to deploy something in Spain we added
the Spain SMS jar in the classpath and
when we need to deploy it in us we added
the u.s. SMS jar so in this way we avoid
it to create some kind of factory
classes of saying I passed here the the
country where I'm deploy it and if it's
us every time this instantiation if it's
pain its decision sensation and so on
instead of doing this kind of thing we
use it evens so we avoid it any which is
always a good way for avoiding bugs and
also for simplifying the test and
basically yeah you may said that it's
quite simple but only importance are
simple although you may think that these
are really complicated with this thing
we covered almost all the cases but Java
EE is not completed at all and we had
some things that we are not covering and
we need to cover and the good news for
us is that Tommy covers these things the
first thing is how you configure things
how you configure the database how you
configure a JMS how you configure the
stillest container of these things need
to be computer and doesn't and Java he
doesn't provide a standard way to do it
and in case of Tommy there is something
called resources configuration which are
filed one file that it's Tommy dot XML
which is on conf directory and this
means that what you put in the Tommy
that XML is computed for the wall
application server or if you want to add
something specific to an applique
you can put the resources of the xml in
the weapon territory and that's all and
both in both files are almost the same
format so you only need to decide if you
want to put something in that affects
all your application server are only
your application and yeah here is an
example of defining data source you can
see that it's an an exam l+ properties
file because sometimes you may think
that xml files are too verbose maybe you
will say that properties are too you
know hard to to right so the mix which i
think that it looks pretty well you
understand everything in this
configuration also notice that the using
a readable format for the times so
instead of putting here 3600 seconds or
milliseconds or whatever you can put 30
minutes and that's all and it's always
it's a good thing to do and that you can
also configure stainless container and
also the good thing that has this format
is that it comes with default so if you
don't use for example the moon maybe a
big table idle time take out to the fall
it has a fall for username and password
because they fall for GDC URL and jdbc
driver so it means that if you don't
want to you know for testing purposes
you don't want to configure data base
Tommy comes one by default in fact uses
hypersonic sequel and you can use it
without computer in anything of course
this is for for testing things don't you
don't do it in production but I mean
that it's a good wait for writing test
but it has something that I think that
it's quite unique in the application
servers
is that you can up or use placeholders
in your configuration files so you can
configure your data source and saying
look I my GD bc URL is the content of
and DB your DB URL system environment
variable if it's not set use jdbc h
sequel DB mem and anya and you can
connect to movies so this is very
important because you can do export DB
URL you put that on the case the my
sequel and at runtime if there is this
DB URL system environment will be
replaced by Mexico if not it will use
the H a sequel TV it means that if for
development purposes you don't need to
touch anything you can run it without
setting the property and then during the
deployment your deployment team your def
up steam or your IT team or you know who
deployed is to the production will set
whatever they want and that's really
important for us because we don't know
when you go to decline what you are
going to find and also you can even use
the system java system properties you
can configure it just in system MBO and
variables F we have seen you simply
shoulders but if you want you can also
replace the wall property using mini SD
the name of the datasource the property
and the value you want to use in this
case as you can see you are replacing
the wall properly instead of replacing
some path but also you can use this to
add new properties so again your dev ops
team or infrastructure team has the
power to change anything they want from
the plication configuration and it's
when these things worked really really
well for them and also this is one of my
favorite feature is that you can even
create your own resort
in this case I'm using the Mongolian a
standard class you know this come that
MongoDB that Mongo client I give an ad
and I put the hostess localhost properly
in this case what Tommy does under the
covers is taking the mongolian class it
checks if it has a set with the name
host and it has it call it with local
host and again you can use place holders
or system properties to replace all
these values and that I think that the
the whole thing from the developer's
point of view is that you can inject the
manga client as using the standard
resource annotation so using a standard
resuscitation you are injecting here
among the client to be used and I really
like this feature for this because
sometimes you say yeah but I can only
define that the sources you can only
configure containers you can only define
GMS but what's happening i'm using Mongo
if I'm using a new sequel database or if
I'm using I don't know which became a
thing you can do it with this even we
use it for configure the location of not
the location and the URL of all that the
services that are called by you know
that the first service I would like to
ask you how many of you are putting the
database password in the configuration
file in plain text in clean anyone is
doing this yeah no I mean that if you're
not doing yeah it's perfect if not the
problem is that you're putting your
plane pass were in your files if you do
this someone can enter to your system
and get the password of your database
which is not a good idea or maybe even
you know maybe you have some sensible
data in the database and some employee
may you know lock that database in the
logs then the logs are
stolen and someone can see the password
and this fix in Tommy because you can
define your data source with a password
super attribute so what you're doing
here is saying I want to use a static
three deaths super and I'm putting in
the password the zipper the you know the
tippet password and then when the
database is configure and the connection
is going to be done it takes the
password zipper it takes the chunk of
bytes and they encrypt the things and
send it to the database of course in
this case static 3ds are provided by the
fall which is not very secure at all but
you can configure can create your own
keepers so you can you know it's a
simple thing of implementing your an
interface and put in animating services
the implementation and then you can
refer here the implementation so you can
use probably some kind of symmetric key
to do things but also if you are using
your custom service you can still use
the encryption thing and this is a
custom service which is bold gateway and
you have several properties and finally
there is a property which is the
password to access to the bolt and what
i'm doing here is saying i want to use a
sipper which is a static 3ds and this is
the chunk and that's all and then when
Tommy starts and see this that property
starts with zipper it will scan the
algorithm it will encrypt the things the
crypt of things and put you this thing
so in this way you'll need to you know
provide your path in your password in
clean format which it's always a good
idea to do
okay uh I'll show you java ee basic
things as we've done what things we use
from Tommy that are provided that Hawaii
does not provide and of course we need
to write tests of you over or code and
the first thing that you need to do is
write unit tests maybe you think that
since you are running an application
server and and so and you don't need to
write unit tests all you said how can I
write a unit test if I'm using
annotations no worries it's a simple
g-unit I have here my rest endpoint I
play make the unit test i bought the
entity manager i instantiate manually
the color service I add the mark I test
the method and I assert that the color
that the call have a lot is great I mean
that sometimes people get crazy about oh
my class has a lot of invitations how
can I write a unit test and it's right a
unit test it's it's it's as simple as
this but of course your code is running
in application server so mmm how to
avoid the schrÃ¶dinger's code and the
running girls code is code that has been
ridin but not tested and isn't in a
state of nature working or failing until
you deployed to your application server
maybe some of you what they are doing is
you have your project due am even
install you take the word you put the
war inside your tomcat or your
application server and then you go
manually to the browser or your you know
test tool and you check that everything
works and even go to put a debug pine
you you know and check what's happen but
this is manual step and yeah you can do
it once but when you have to do this for
every change at the end you don't do it
and you you know you think well QA team
will
notice when I deploy to production and
if QA doesn't notice then it will be a
back on production let's fix them so
yeah this is a rolling girl code and the
problem at the end is that application
service provides some futures some
features like entitymanager
configuration how many times you
configure your persistent at XML you
haven't ate all your domain and when you
start application it complains about
some annotation can it be that place or
maybe you have miss it any attribute
transactions plication server gives you
transactions way to fall and we've seen
in the heb so your code in unit test
doesn't have the transactions see the
qualifiers so probably all of you that
they're using CI some time they visit
that but you know that CD a container
complains about that there is no in
implementation of some silly see I with
this qualifier because you miss it
something see the evens again you need
to test it check the rest we have seen
that you are notated your resting point
with path annotation or you know things
of being validation so are you
configuring correctly your rest api or
demon HTTP servlet filters you can you
know create your wretched with several
filter you can create a unit test for
for it but at the end you still need to
know if this is going to work on your
application server so the solution is
are killing do you know with the
circulon everyone knows no well
arquillian yeah it's a testing platform
that it's used for basically writing
integration tests that for java
applications so basically it you know
start an application server deploy your
code there deploy your test run your
tests inside the application server so
this means that
your test and your coat is run inside
the application server so you still
starting your application there and
means that all the annotations are check
out there and your test fails you're
sure that you have configured correctly
and when the tests are executed it stops
the applications are an adult basically
it's reducing the you know the
boilerplate task when you do that maven
install take the war put on the
application server and execute something
manually it's reading this and I may say
that it reduce the integration test to
an child's game because it's really
really easy so when you want to use our
killian the first thing you need to do
is choose which is your application
server maybe you're using Tommy but
maybe you want to use wirefly or
glassfish or any other application
server so you need to instruct
arquillian to say I want to use this
application server a start application
server it packages your application
because it's an application server needs
a war or an ear file so it needs to
create this war and send it to the
plication server to be deployed notice
that i put here micro package because we
are going to see that it's not necessary
to pack all your application which if
it's very big it will take a lot of time
to start application server so instead
of deploying everything you can choose
what what classes you want to
deploy it creates a war with these
classes and deploy it so yeah your
application may have like 1000 classes
but if your test only requires five you
create a war with five classes and then
they are deployed and educate the test
and of course the point for classes it's
quite faster than 1000 it runs the test
in this case you can run the test in
container which means that your test
travels from your computer or your ID to
the inside application server and it
there runs inside your application
server and this means that you can use
the continued futures inside your test
so you can inject things inside your
test you can make your test
transactional aware you can inject an
heb everything that you've done in your
application server you can do it in your
test but also as you see this is a white
box test probe because your test knows
the merman you can use a black box test
proach which means that your test runs
as a client it's like you know like a
browser when you have a browse on your
testing your application your processor
is of sight depletions you're outside
application server estas connections and
this case it exactly the same but it's a
g-unit test it's the browser when the
desire run with a stopped application
server and that's all if it's green you
mean that everything is correct how to
run under clean test it's you know you
had one dependency and clean comes with
a bomb so you had a bomb then you add
the killing G you need artifact which is
I want to use j you need to run or
Killian and then notice that there is
two dependencies just at the bottom
which is the archaean Tommy embedded and
Tommy jax-rs this is how you instruct
our Killian to use the application
server that is going to run your tests
so you put in this case you put that you
want to use that test in Tommy and the
test is in this case a J unit test
notice that I'm using the run with a
notation with instruction heed to not
use its own runner but user Killian
runner then I have an aesthetic method
which is annotated with deployment
annotation which is how we create the
package notice that we are creating the
package programa de lis you don't need
to adduce any of maven and you know
maybe install or maybe in package of
rabba you create your jar file in this
case working a war file prolly mentally
and this
war file simply has the color class in
the color server class then we have the
archaean resource of course are clean
takes care of view of instead of having
to you know have a property where you
said if your test is running localhost
or in a remote host or what is AP where
you are running your tests instead of
this you can use a cleaner sauce and are
killing automatically here injects the
URL where your application is deployed
so it's perfect because with a killing
you can deploy your test locally or
remotely to you know a server that is
far away from your computer but you
don't need to worry about where this
computer is and finally as you can see
this is a simple test annotated with
tessa notation we use runners client to
instructor killian that this test is
using a black box test approach and then
we are using the web client to you know
create the URL at the cholera / green
post with null and said if their
responses to handle them for or not let
me show you a really a simple example of
our Killian
this is a test that you have seen like a
in a war I am setting the color service
in the color which are you can see the
color service is the simple it's a
simple service I mean that is what I
have shown you and then if I run this
test it's here you're going to see how
tom is a starlet everything is deployed
that does not execute it and Anna green
bar it's done notice that if taken five
seconds in starring Tommy deploying the
war file executing the test and under
plain things and getting the result
really really fast i think notice here
how the tommy is a started and as you
can see it's a tomcat in fact here is
the studying all the containers yeah
here is notice how it's deploying the
war file we have created using a swim
wrap mean that this thing that case a
war file is this part then deploys your
code it prints here all the rest
endpoints that we have computer educate
the test i'm finally a stop Tom you know
in only five seconds so it's that's
quite interesting to use not as a
replacement for unit tests but for your
integration tests bronze PDP will let me
I don't know if you are having this
problem and it's doctor was not used in
production um you know it's this kind of
business decisions at all doctor is so
new and so on so we're not going to use
darker and yeah you a circuit egg you
you know that the advantages that you
have if using a darker but it was not
possible but the good news for all of us
is that or at least for me it's that we
could use darker for testing probably
well you have yours so your service and
the service may be sent an email if you
need to send an email you need an a mail
server so how you write an intuition
test or functional test of this part of
code it's like okay we need an a mail
server so you can install your mail
server locally and run the test and then
it means that all the developers need to
install the mail server locally and your
Jenkins instances have that mail server
installed or you can use talker so you
can fear an image with Tucker that has
an mail server and when you j'ecoute
your servers I saw your test you
previously start this docker image and
the same it can happen with you have a
service that call to another service if
this service is finish it needs a war
file in you want to test that how this
test a communicates to test be as to
service be you need to you know a star
service be and this means knowing how
series which deployed it means that take
the war install the application server
and sched Tommy deploy the world
configure all the configuration files or
whatever they need and and this has to
be done in all the environments so
instead of this if you dr. eyes your
application all that it's not going to
be used darker and production it helps
on tests and what we use was alkylene
cube alkylene cube is a an extinction of
our Killian for dr. as you can see
what I've mentioned when I explain it
arquillian I said that arquillian start
your application server deploy
everything is a test and stop the place
on server so we can move forward this
approach to docker so maybe our killian
what can do is start the docker image
then executors and then stop the doctor
images I mean it has I mean that its
natural step for a key Liam also let me
say that are killing cube have support
for the native thing I mean that if you
are using Linux i may say that it's
another thing but also you can use good
talker or doctor machine automatically I
mean you put in European give a property
it saying I want to use these dr.
machine and our clean will take care of
checking the AP and all the things that
requires to connect to the darker host
and the good thing is that since it
seems that dr. Campos is going to be the
default orchestration format of your
containers it's also supported so you
can have your daughter compose with all
your you know you're describing your
infrastructure's there your application
server your database server your mailing
server whatever you need in dr. Campos
and then arquillian will read the doctor
compost pile start everything it run the
test and then stops everything so in
fact we may say that our Killian cube is
helping a lot in ultimate icing all this
kind of thing if you want to see an
example of cube it's a simple matter of
adding a new dependency which is a key
link if dependency and then you
configure inner Killian that XML which
is a file used by our Killian to be
configure you said that you want to use
the compost format you said where the
composed jamel file is and finally you
said which dr. machine you want to use
if you are not setting what the car
machine you want to use if it's running
Windows or Mac
we'll try to use butiker and if not in
if and if not it's not going to work and
if you are using a linux it will try by
default to use the native support of
using the socket load linux socket thing
so we use our clean test so not only for
writing intuition test but also for
functional tests using drawing of an
extinction basically this is an
integration for selenium and it's really
interesting because you utter no
dependency and then your your clean test
you can do it using the drawer notation
you said drawn up drawn webdriver and
then there is the webdriver you don't
need that the selenium webdriver in fact
but you don't need to worry about how to
configure selenium how to compute the
selenium server how to configure the
browsers and so on and so on it's all
this thing is managed by helium you use
it also for BDD test basically for Coke
umber and that's all for the testing
hope that you find arquillian
interesting because it simplifies a lot
the testing in the Java environments and
finally yeah I've said that we were not
using docker so maybe you're wondering
what you how you deploy using the
standard way of you know having a lot of
people going to the machines and copying
all the war files there and see what's
happened well this was how we did in the
past but of course now with it a bit
better and basically what we need is a
full torrent system because x let's
suppose that you're going to bolt and
the system and then say the system is
down you can bolt yeah it's quite weird
also we need some way to manage the
resources in a dynamic way it means that
probably you may think that the
elections are in 12 hours elections but
there are
actions are like 15 days so and maybe
you expect that people both during the
daylight then in the night but to do
with those resources important the thing
is that you're that what we were doing
was bad things so during the during the
day will be awesome that we could use
all the resources for the boating
systems and during the night reduce
these resources in the of the boating to
do some kind of badge tasks and the next
regardless was that it should be easy as
I said we have a IT department that
needs to operate this application to the
the clients so if it's something really
hard to use then it's not good at all so
we use apache mrs. plus marathon i don't
know if you know what is Apache mrs.
well I / to mrs. Allen patchy project
which is open source which feeds of
requirements basically it means that all
your resources bare metal or bill or
virtual machines looks from the point of
view of the operator as a single
resource so basically you may have like
100 machines with four cpus each one so
it means that you have 400 CPUs for you
and the operator would see is this that
I have 400 CPUs to be used it doesn't
matter if I have 10 computers 100
computers or whatever or if even you can
apt dynamically more computers and what
see the priorities that you have a big
computer this is what the pearls
assistant the same for the RAM and you
know for for the disk and so on it's
fault-tolerant which means that if you
if one instance dies one then
automatically it starts another one so
it's quite an Instamatic so it's quite
interesting for us because you need to
about you know staying there monitoring
all the servers and say oh look this
server has died let's go there and a
good nine don't know which is great that
starts everything now it's automatically
done and also it uses this elastic
distributed thing so we can dynamically
say now I want ten instances of this
service and now when it arrived at 12 at
the denied I instead of 10 i want to
have five and then they've reduced the
instances 25 and you have more resources
to be used and that was very important
is that it can be used with native
applications and with docker
applications in our case we use native
applications wicket too because then you
stalker but if you can use docker you
can even use mrs. for this thing and not
if is you know it's educating a shell
script and at the end so this is how you
deploy you have marathon and you have
missiles missiles only takes all the
information of all your infrastructure
and publishes to the marathon so when
you say to the marathon I want to deploy
two instances of service one marathon
checks which machines can host two
instances of your service and deployed
there so mrs. only offers things and
marathon decides where the things goes
so in this case I have three machines
and you can post and you said I want two
instances of service one and two
instances of service to and and Madison
decides to you know deploy it in this
way and we're going to see an example of
how to do this now but before you maybe
you're wondering okay you have said here
that you have to service to and if
service one talks to service tool which
one of the two instances are going to
talk so you need to some way to discover
these things and we use the mal phone
thing
it is pretty pretty simple maybe you've
read a lot about service discovery and
several projects that does this thing
but you can do something really seem
simple which is using NHA proxy
basically marathon it has a meditation
practice american bridge and a chair
proxy in each of the slaves so there is
metal masters which only receives
incomings and then they have all the
slaves that are the ones who do the job
so basically it just leave have a nature
proxy it continuously talk with marathon
to know where are each service so as you
can see here the service to which is
positive 4 30 1200 and once to talk with
service one talks with not with any
service but to the h a proxy then they
cheap proxy seems in knows by marathon
where all the service ones are host the
site that you need to talk with the slip
one maybe because of traffic or who
knows or for any politic that you can
have in your HT a proxy configuration so
this means that when you want to talk
with from service 12 service to the only
thing that you need to do is talk with
local host because a cheap roxy is
running in your slave so it means that
it's running in local host so you need
to worry about where is the services or
you know you only put local host and
everything works because it's a cheap
proxy the responsible of you know
sending your request to the service the
service that did have happened if
service one in this case is shut down h
a proxy will notice and when you do a
request Shh a proxy will ready leg
instead to the service one of sleep one
to the service one of select tool you
need you don't need to worry about this
and when messes decides that oh this i
need two instances of service one and
one has been down it will automatically
start a new one as your proxy will
notice and then it will start to
redirect traffic to the new instance
maybe you're wondering how you can
deploy something to the missus malecon
maybe you think that it's quite
complicated and it's the simplest thing
I have ever seen it's only a JSON file
you send something to a PP /a be 20 / AP
p you send this post you've set an ID
then sorry go to the bottom of the JSON
you will see that this annuities this is
what you want to execute and in this
case I want to download Tommy you can
just hear a file ftp a Hadoop file
system wherever you want then it will
take this since it's a tar.gz thing it's
going to uncompress this and then it
executes the common the common thing
which in this case goes into the Apache
Tommy it replaces the 8080 port to the
port the finite by mesos because meth
because mrs. cannot use 8080 because
then it wouldn't be able to run to
services in this import in the same
machine so it overrides the port and
finally I do a backup of the of the
server dot XML and I run the Catalina
lot SH run to start the Tommy I'm
finally you can see here wait here you
can see here what i'm doing here is that
this service only need 256 megabytes of
ram because 64 is for chummy the rest
for my application I don't need anymore
I only need half of CPU and I only want
one instance you could put here two
three four five or legs that you need
and then Martin will check with this you
know with this constraint which machine
can run this and that's all you post you
do a post to the marathon URL and
everything is done let me show you
quickly how to do this
yeah now what what what I have here
sorry now I'm going to star background
machine x ray machine which yeah it
starts a missa smartphone master with
all this with one slave and with one
zookeeper and 1h a proxy the starts
everything now it's ya know in attics
much time to do it well well it's
starting i'll show you there is not here
then what i'm doing here is basically
some doing this is the this one that you
have already seen but in this case I'm
using the just you can see here I'm
using the file because i have already
that Tommy tar inside the edge of the
slaves to enough to avoid the time of
off now for the limo no probably this is
already up yes and then basically have
here my cat sage which as you can see is
a coral with doing a post 2 by p and and
go on the file so I'm writing this and
now you may and wondering what's
happened because yeah this is a geez I
have educated the shell script it's
supposed to work but let me show you now
that if I move this here and I go to
http then here you can see here the
instance that created deployed with the
memory CPUs and the instant is running
and if i go here you can see that the
support
this is the instant you can check your
all the things if it's alive or not it
has some health checks and so on and if
push here obviously go to the Tommy page
but this is doing an request directly to
the slave but I've told you that there
is an h-shaped proxy that you know wraps
everything so I can go there and put
this and of course it responds to
because this passing to the HC proxy
this is configured in here here you're
saying that you want to use the HK proxy
10,000 for Tommy so in this case there
is only one instance but if I had
therefore instances I can access for
instance individually or using the
10,000 port that goes to the cheap rugs
in make a proxy will decide where to
know how to redirect the traffic and
we're almost done so yeah this long what
java ee versus spring both works I mean
if you do something with spring you will
say yeah spring is the best thing I have
ever done if you do things with this job
i evil say ya allah is the best thing
I've ever done again it's about
experience you have a lot of experience
in Java EE you will say I do things with
java ee really really fast and if you
are used to use spring a lot you will
say that you do spring very very fast so
it's as I said in the at the start of
the topic of the session listen your
developer person yeah you can decide
because both of things works and that's
all you can see my slides here you can
send me an email or Twitter whatever and
thank you very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>