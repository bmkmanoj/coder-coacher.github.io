<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Lessons Learned from Real-World Deployments of Java EE 7 | Coder Coacher - Coaching Coders</title><meta content="Lessons Learned from Real-World Deployments of Java EE 7 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Lessons Learned from Real-World Deployments of Java EE 7</b></h2><h5 class="post__date">2015-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/_qIdQp4s2lY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">thank you very much no I keep enjoying
your lunch I don't mind that my name is
Erin Gupta I work for red hat and in
this session I hope to share some java
ee 7 deployments that I've seen in real
world and hope to share some set of
feedback from that as in what are the
design patterns people are using in
terms of java ee 7 deployments or the
using new technology is not using new
technologies why are they using it what
are the benefits that they're getting it
and there's nothing about the platform
itself so hope you are already familiar
with the platform but just as a quick
well breather here were the main themes
for java ee 7 so if you recall developer
productivity html5 and meeting
enterprise demands those were the three
big themes for the platform itself and
in each of these areas we had you know
either a new specification added so for
example in developer productivity CDI
was made as a core part of the platform
in html5 we added WebSocket json in
enterprise demands we added batch and
concurrency not only that we simplified
GMS pretty heavily so let's take a look
at it how people are using it my so
let's jump into it right away and feel
free to keep it interactive and I prefer
interaction even though it's a session
so my first production deployment of
java ee 7 is unhcr which is united
nations high commissioner for refugees
now if you guys attended the java one
strategy keynote Mohammed the man from
Egypt jug was present there he can
explain some of that so I intend to dig
into the architecture a little bit what
they did how they did what pieces they
used ok so this is a part of the UN to
protect and support refugees it could be
done when the country could ask the UN
that we need help with you know
supporting refugees or UN could see the
need that ok we need to support the
refugees in that country and then they
intervene and then they start helping
them out basically what they do is they
have secured card ballots think about
the Java card so there's card wallets
are issued to each of the refugee and
using those
they can go to a point of sale where
they can purchase we can actually
purchase something like food or they can
go to an ATM again registered ATM get
the money out or and all settle some
expenses so all sorts of different fun
use cases that they can do with that so
you can use cash or cards at merchants
and to remind you UNHCR has actually won
two Nobel Peace Prizes you know one was
as anything in 1954 and another one was
in 1981 for helping refugees throughout
the world so pretty noble cause and I'm
glad java ee 7 is involved there so
let's try to look at the architecture
diagram run right over here I know it's
not really but if I can help you out
over here and my mouse is big beard
let's see if we get this thing here
there you go okay one spring that makes
it easy so this is a well once you're
issued the card you can go to merchant
point of sale this is the e finance
evenness is the company that Mata man
works for the Egypt jug lead one of the
Egyptian eaters so you go to point of
service it goes to the e finance which
you know there is a back-end
authorization that happens that you have
the proper access right or not then you
get into the card sequence over here or
the card issuance system because this is
where the cards are issued and you get
it to verify with that that the card is
issued properly or not and then on the
rayleigh back end is where all the heavy
logic happens where you do the business
logic you know okay the payment went
through or you know connect to the
different services or there's somebody
has a soap endpoint published go talk to
them get the authorization third-party
persisting to database and all that
stuff okay so this is sort of a very
high-level block over here and this
offense which here is talking to this
card management system but it can also
talk to third-party network as well so
for now we're going to focus on just the
java ee 7 part of it so if you look at
this broader diagram this part like the
back office the issuer acquired bank and
unhcr this is where java ee 7 technology
itself was used all right so let's take
a look at
it what old technologies did they use to
accomplish this and how did it work for
them first thing first so they use JSON
Jason was a new addition to the java ee
7 8 platform low-level API to do json
processing and generation the because
advantage to them was because your JSON
messages were small they got rid of any
third party dependencies I mean earlier
if they had to build the application
they had to build a Jackson or a
jettison or one of those libraries in
there so this library is really cool if
you want to process small amount of
small not amount but small size of
messages if the messages goes bigger
then you have to write a little bit of
verbose code hopefully that will be
resolved as part of JSON binding which
will be introduced in the java ee 7
hawaii 8 platform then at the back end
they had to run some tasks like you know
end update tasks like posting of
accounts generation of reports email to
clients and all those so that's exactly
where bad fits in very well now again
typically before the introduction of the
batch and the Java EE platform they will
have to go spring badge or some other
technology or some proprietary
technology to integrate as part of the
war file you know into web enough lib
and use that but again here no need to
use that they had lots of managed to
thread pools which they were using
because the new certain tasks were
requiring a little bit longer than they
were originally planned to so from the
ejb ease which were used for the
business logic they were spinning up
those manage concurrency threads and
they were spinning in them out for
different kind of work what kind of work
is what is indicated by the question
mark then I still have to follow up with
Mohamed but they were basically spinning
out multiple threads which were taking
longer and for the background processing
egb you are used for back-end services
now if you use them locally within our
files then it does not need any
interface that works very well but if
you were to use ejb remotely then you
have to implement an interface and all
those things you have to go through so
but they were using ejbs for all that
part as well
you don't get to hear a lot of jax-ws
these days but that really provides a
standard API to do soap integration so
this one was required because UNHCR
systems they expose the soap interface
so they use jax-ws to general to look at
their wisdom generate the stops and use
jax-ws stubs to talk to that third party
system so these are all sort of the main
technologies that they used as part of
their architecture continuing more on
jpa side once again a new feature that
was introduced in the java ee 7 platform
was java person in the jpa api was how
you can call a stored procedure very
easily just like named queries you can
put the annotation like add stored
procedure specify your in out parameters
out parameters and in parameters and
retrieve the result so they have certain
stored procedures written in Oracle and
SQL server typically you will be writing
some proprietary code to talk into those
stored procedures or up leveling them to
define some stored procedure behavior
but now even though those stored
procedures were written in the database
you could just have a single annotation
point to those stored procedures and
invoke them as if you're just writing
natural jpa code another new feature
that was introduced in java ee 7 was how
you can do a two way schema but to
whiskey my mean in java ee 6 you could
take a database from the database you
could generate a JP entity what you
could not say is take a JP entity from
that generate database so what they did
is these guys were they thought they
were better Java programmers so they
wrote the JP arity from the JP arity
they use those database schema
generation properties and generated to
the database from that now they did not
really use those things at runtime but
for development they started building
their JP entities generated the SQL
files team those SQL files that give it
to your database administrator the
database admin Satori tune those schemas
they will get the schema back and they
will regenerate the entities so it's not
a full round trip but it allows you to
connect a
away from writing those SQL and still
maintain not the hatred relationship
with the DBA but a love relationship you
know you take this you take the schema
you take the scripts you know you do
whatever you want to do with them and I
will generate my JP and it is back from
them this is what they were using to do
change requests for example so if
somebody would say oh add this feel then
they'll go back into the j.pierre it a
changeup feel generate the script and
give it back to the database schema now
these what little tricky because if you
think about it this two-way schema sort
of generating your scripts from I arity
is typically a one time thing because
you don't know how the DBA is going to
how much is going to change the script
but once it's changed you know you can
generate the JP entity back because it's
not round tripping so adding change
request is not going to be easy so
typically is good for a first-time
effort but then pretty much there
onwards you are on your own one thing
they also did was or other enjoy e7
enabled was how you could have CDI
enabled by default what that means is if
there is no beams dot XML by default all
your CD i scoped beans were available
for injection so that was the default
behavior but how about what they did is
they said we're going to take beans or
XML but in the beans or XML we're going
to specify something called as be in
discovery mode which is an attribute
which can say all because by default the
value is annotated what that means is
only CDI scope beans are available for
injection by putting all your saying
have all the beans in the archives
available for injection so and they were
using that for ease of integration
between different layers because they
know in this archive everything is
available for injection so anything
could be injected across the layers so
in terms of that was the core java ee 7
technologies that they used now in terms
of additional libraries that they used
were one was primefaces so if you're
using jsf as a front-end that was their
viewing library but if you are using jsf
as a front end then you need a toolkit
or a component kit you know on how you
can render it so they use primefaces
with that
the reason they use primefaces again no
as a lot of it goes back to the fact
that how familiar you are with the
particular tool kit or IDE that you are
familiar with and how well that tool kit
is supported in your ID of your choice
so these guys were familiar with
netbeans and primefaces is well
supported in netbeans literally when you
create a java ee 7 web project it says
how you do you want primefaces so we can
enable primefaces for you and integrate
it right in there another thing that
NetBeans also provides is it can say
based upon a JP entity I can generate
some crud pages for you and those crud
pages could be simple around JSF pages
or they could be based upon primefaces
as well so that's what they did as a
matter of fact if I go back to their
application here there were certain
admin pages there were certain admin
pages over here those pages were
automatically generated by NetBeans so
it really allows you to generate that
boilerplate code very easily very
rapidly and then you know you put your
own logo in there change the color theme
and things like that make them
graphically more appealing and then
you're ready to go so again rapid
prototyping but still being able to have
the ability to tune it or change it per
your taste they also use j jquery stock
library again no changes to the jig
jquery itself they use jquery stock
library they were familiar with it and
they use that as a front-end so admin
was using primarily JSF rest of the
fancy interfaces were done using jQuery
alright so in terms of runtime what did
they use the use glassfish for which is
a reference implementation for java ee 7
they're set up really was two instances
of glassfish they were deployed locally
in their own data center so ii finance
is a company that provides that
facility however as you recall Oracle
has pulled glassfish commercial support
and then so that means you are basically
dependent upon either those two
companies like large on or C to B to
consulting to provide the commercial
support so from the UN side there is a
mandate that not you need to use a
commercial app server so they are
looking at different options and we'll
talk about that a little bit later today
java SE 7 is a requirement for java ee 7
so they were okay using that although
there are some features in java SE 8
that you can leverage to simplify
programming but they still continued
with java SE 7 because it's not easy to
change your Jerrica environment in
production GDK eight is good you know I
can try it on my desktop but if i go to
my IT guy in a white hey by the way
change your jdk he's going to freak out
and everybody right not just my attic
high in terms of the databases they used
oracle 11g and microsoft SQL server and
that's where you know the beauty is
because you have one jdbc driver one jpa
one persistence provider providing
seamless connectivity to the backend you
have your stored procedures written in
those databases which can be seamlessly
integrated as part of your normal jpa
code so they leverage all of those
benefits in terms of the tools they
relied completely on NetBeans 7 dot 4
and netbeans 7 dot for indeed has one of
the best supports for java ee 7 in that
case so all they have all the fancy
Wizards their maven support is really
good it's very good to begin with you
know when you want to start with a java
ee 7 web project it provides the maven
dependencies for you automatically you
want to say I want to create a jax-rs
endpoint or servlet or whatever you want
to create it automatically generates
that boilerplate code and not tied to an
IDE specifically the particular feature
that they liked was for example
integrated glassfish management so
within netbeans ide you can start stop
marriage the lifecycle of class fish
itself you can also deploy to a remote
glassfish so you can configure in
to have a local instance to at least
identify the libraries but once you have
done that you can say i've configured
now a remote glassfish which is running
somewhere else and some remote host and
port and then you can do the deployment
over there as well as i talked about
they have many templates to start from
so if you don't know exactly what
boilerplate code what annotation to
generate it really simplifies your task
they use the prime faces generator
plugin to generate some of their pages
which was very handy to them because
they pretty much used most of those
pages as is and it also has great
compatibility with html5 so for example
they were changing some files and they
were testing them in a Chrome browser
now that's a feature and sort of a
limitation of NetBeans because right now
they allow only integration with chrome
so and the pan the finality is once you
install the chrome NetBeans plug in any
change you make in netbeans it
automatically pushes it to the chrome
browser there is only to refresh the
page and chrome side but that's only
works for Chrome okay we'll talk about a
little bit later that how eclipses
supports that better using a feature
called as live reload where it provides
browser agnostic behavior for that so
Mohammed Amin is the man if you need
more details shoot him a tweet or hug
ohh hug him no it doesn't matter you
like it because he is a man who's behind
all of this architecture answering all
the questions and everything he also
presented at the GlassFish day I believe
on Sunday he was there up on the keynote
so he can find more details over there
or I'm happy to help you connect with
him any questions on this so far okay
second one so this is one of the sample
applications that we started writing at
Red Hat a few few months ago I would say
so about three and a half months ago or
so I started something called as hashtag
Java one string and the idea was to run
everyday at least a mile up until
javaone I could do most of it I could do
like about 90 days and 89 days out of 92
so not bad at least a mile a day but
also three days i was actually
boat so I couldn't run over there but
here you go so we said we need an
application which shows sort of a java
ee 7 blueprint this carbo tracker but i
think that's just a BDD implementation
of java java ee 7 that doesn't show me
really what the blueprints are because
in blueprints i'm looking for why should
i use web sockets here and not server
sent event why should i use jax-rs here
in net jax-ws i'm looking for those
design discussions those are lot more
relevant to me so we try to implement
some of those practices here in this
miles to run dot-org so anybody can go
basically to this website miles to run
org you can track your daily runs you
can create different goals which could
be debates that I'm gonna run for next
30 days what I'm going to run 30 miles
or it's a social network for runners as
well that is free of course so this is a
quick snapshot there were eight runners
from about eight different cities and
six different countries who joined the
website it kind of shows you a
cumulative status that this many miles
it set right is accumulated we provide
social brokering here with Facebook
Google and Twitter or there is no way to
create your own login person I know with
this a stir the standard way by which we
allow you to log into the website so in
terms of the website it provides some
fancy data so you can see for example on
the top there is a dashboard so this is
sort of the dashboard over here which
provides a visual view of the maps now
this is a little bit more detail
dashboard that out of the 98 days
completely days was this remaining was
this mist was this it provides your
distance versus pace chart it provides a
calendar heat map on how many days have
you missed provide sort of her status as
well so we provided all of these
functionality as part of the java ee 7
application itself so let's look at the
architecture diagram for this one then
so this was written again as a java ee 7
application on the front end we use
simple html5 application this was not
using jsf at all actually and i'll talk
about that in a second but in the
container in the container we had whole
bunch of services in
authentication resource activity
resource timeline resource all of these
were resources it was a true sort of a
tsa kind of an architecture where you
have thin server architecture everything
is published as a rest endpoint and then
on the back and you have all of these
views those views were rendered as part
of the jax-rs endpoint itself so this
were written as time life views actually
i'll explain that in a second but on the
back end really at the at the bottom
most layer we have three different
databases being used so not just our
DBMS but we know we had Redis and
mongodb as well and I'll explain the
purpose of these where they stand out
why that purpose could not be served by
the or DBMS per se so in terms of the
technology this is sort of the
technology diagram and by all means i'm
going to share these slides and this
session is getting recorded so you will
have access to all of that ok so here
you go so on the front end what we have
is an hour angular j/s base single page
application so you load the page you
know the application is loaded you stay
on that page you click on something it
goes back and our renders you know
partially render that particular of the
page we use d3.js which is a very fancy
graphical library JavaScript library for
all the charting effects when we use
Twitter bootstrap for styling we use
Twitter bootstrap for styling ok now
those were the JavaScript libraries for
providing the eye candy but the real
views themselves were generated by time
leaf so timely is a html5 templating
engine it's a true MVC kind of an
architecture where you're not bound to a
particular viewing technology it
generates the views you render the views
on the fly on the client side the views
are again generated on the server side
per se so if you look at your resources
basically that's where you are saying
how the view needs to look like ok all
the rest services of code were exposed
using jax-rs in terms of the java ee
technologies we used several of them so
jax-rs interceptors jpa was used to
interact with
SQL of course we use bean validation for
honoring validation constraints that
certainly improves the semantic
readability of your code CD I was used
now in order to talk to Redis and
mongodb they have their own database
drivers what we wrote sort of a CDI
services using produces which we are we
can inject those services wherever we
want to that makes it much easy the
stack at the bottom you can see we were
using JDK 8 but again no I think that is
going to take some time to catch some
fever but in the meanwhile jarek 8 was
used but no features of JDK 8 per use
particularly but while fly aight was
running on top of jerry Kate and the
entire system itself was running on
openshift and I'll get into the
deployment diagram little bit later but
that sort of high-technology diagram
here so let's take a look you know in
terms of user interfaces so we were
using time-life html5 templates that
were rendered by jax-rs so you can take
a look at the resources you can see
exactly how you want your templates to
be generated and then they are being
rendered on the client side we talked
about angularjs the very first page was
angularjs generated everything else for
styling and everything else what's
bootstrap so those were sort of the
explicit decisions made because
bootstrap is really good at styling your
application the first page was consuming
the jacks are its endpoints we talked
about Twitter bootstrap the
authentication was done using jax-rs
filters so that was again a new feature
added to Hawaii 7 wherein jax-rs 2.0 you
have filters or entity interceptors
which allows you to look at the headers
or entity bodies and play around with
them so that that was done using jax-rs
filters d3.js is a library which
requires a little bit lower level
JavaScript coding c 3 dot jas i don't
know if it is a level letter above d so
it's a rapper / d3.js which allows you
to write v 3 2 j's graphs or generate
d3.js graphs using a simple rapper so
that was the stack
that was chosen in terms of the
technology now obvious question is why
was Jesus not chosen so jsf the thought
was is not really good for the single
page applications because you know and
all of the state and everything is
maintained on the server side nothing
wrong about it but that's the way it is
being designed it is a component
oriented you know MVC as a matter of
fact in Java e8 there is AG talks but
there are there's a JSON file Jace or
371 for action based NBC so this would
be a lot simpler lot cleaner time leaf
just happens to be one of the languages
you could use velocity or free mark or
any of the templating languages
hopefully which are ye 8 in that case
one part also too important to
understand is that in general Hawaii is
lot about offering choices you know it's
not that you have to have we have to
follow jsf only or you have to follow
jax-rs as the back end there's a lot
about choices you can mix and match see
whatever meets your needs in terms of
the api's or middleware rather we use
ejb plus jpa has a very standard here
and also all the functionality was in
there one of the discussions over there
was should we be using ad transactional
for the backend clear like which is the
new annotation introduced in java ee 7
now i add transactional what it gives
you is how you can make convert a POJO
into a how you can inject a container
manage transaction into a POJO and then
when we looked at our EG be the way EG
bees were design I could have either at
stateless at the top or add
transactional at the top anyway we are
running in the web profile so we
couldn't figure out what would be the
real benefit of going at transactional
at the top or at stateless at the top so
because all the methods were required to
be transactional anyway so we ended up
putting at stateless over there because
that's a well-known programming model
however if you have use cases where in a
pojo you have several methods where you
want only couple of them to be
transactional then of course you can go
with a transaction on that method then
it don't need to go so
the design pattern you want to think
about is if all methods in a POJO or
transactional whether you want to put ad
stateless at the top or a transactional
at the top then if it becomes an ejb
it's not really heavy weight anymore so
don't go with that now if you talk to
anybody from spring guys yes they will
say is heavy weight but ECB's are not
really heavy weight so it doesn't really
start up a full-blown container they run
very well in a web profile but what
benefit it provides is it provides
concurrency you know I mean you can have
all those attributes over there it
provides remoting so that functionality
is there I know it provides pooling so
there are some functionalities that are
still exclusively available in ejb now
let's see let's hope that in Java e8
they're gonna open up and be welcome to
receive that ok I'm going to take out
all those features and make them lot
more widely applicable effectively I
hope egb becomes redundant in Java EE
eight where I can take you know a trip
pooling at concurrency at remoting
sprinkle them over my pojos and use them
the way I want it will give me more
power you know why do you want to keep
conspire in your control all right so
ejb we still ended up using ejb for now
there's a classic model cuz show and all
that that works very well we created CDI
services for no SQL data stores using
their standard driver but still using ad
produces so that we don't have to do
string bass injection everywhere so we
can just say add produces and if I need
to inject a reddish client I could just
say add inject reddy's client and I get
the Redis client all of those produces
were kind of bundled up together in one
class a singleton class and I could just
inject them very nicely zero time API I
was used for working with day this is
what was introduced in jdk 8 so that was
one of the functionalities that was used
now for social brokering that's a very
common problem no do you use their
vendor specific API so for example
twitter has their own API facebook has
their own api google has their own api
so do you use their api for now we ended
up using their api but
well the projects by Red Hat is key
cloak now keep rope actually among many
features provide social brokering so
using the simple API using the single
API you can say you can create the
buttons as is keep the visual appeal
appearance as is but then you can say
allow I want to talk to Google or
Twitter or Facebook and on the back end
you can do that connectivity
automatically but from your programming
perspective you have a single API so one
of the goals of this project is how we
could get rid of the proprietary social
brokering API and hopefully migrate all
of this to key cloak itself and we use
slf4j with log back for logging in terms
of additional libraries timely firs use
as I said for server-side html5 views we
use OAuth providers with different
client libraries Judah time we talked
about one of the features that we also
use was because in my profile like I
travel around the world so if I'm in
California I'm locking my miles if I'm
in Norway i'm logging my miles if I'm in
India I'm locking my miles so one of the
issues we saw was when we are logging
the miles should we use the time zone
where the user was logged in or should
we use the time zone where the user
created the account and then how do we
display the account back so now in jp-a
2.1 we added this feature called as
converters which allow you to convert
you know different feels how they are
being read and written to the database
so that's a jpa two dot one converter
feature but before using that we ended
up using jadida user type which
basically allows you to store date as
UTC in database and then when you are
rendering it bad then you can render it
based upon which time zone you are n so
a little extra caution need to be paid
over there and I think this is one area
where Java ie8 hopefully can provide
little bit more facility over there we
of course use database drivers for
edison mango j unit was used for mockito
for unit testing and also simple mocking
because all the stuff is hosted on
openshift so you want to market so that
you know you can test it offline very
easily
how many of you use our Killian some of
you ok so I'll give you a quick dump of
our Killian arquillian is a tool which
allows you to do integration testing for
java ee very easily in the sense you can
say package my custom war which would be
this HTML page this class and this beam
and this jpa and create a mac read my
custom war automatically deploy to a
container from the test and report the
results so it's not just the unit test
its integration test and the beauty of
our Killian is it does that in a
container agnostic manner for example
you could create multiple maven profiles
and in the main profile you can say now
connect using or Killian while fly
connector now connect using arquillian
glassfish container now connect using or
Killian Tomcat container there are about
thirty six of those containers and each
of those containers can be run in a
remote mode wherein somebody else is
managing the lifestyle of life cycle of
the container or they could be done in a
managed mode where our Killian will
download the container for you install
it for you run the test and unda ploy
the war file so I think that's pretty
cool it also allows you to run your UI
tests for example in a browser agnostic
manner so you can say here are my UI
tests here is my selenium script attach
it to this test and run it in a browser
agnostic way you know chrome firefox
safari and even the legacy browser IE
how many of you use IE as your primary
browser because the company asked or
because of a choice yeah thank you hey I
hear that I feel your pain in terms of
the runtime this was again based upon
jdk 8 and this was using while fly eight
dot one dot 0 final which used to be
jboss application server is very easy to
create a scalable instance of wild fly
on openshift literally go to open chef
you say you know i'm going to spin up a
while flying instance and run it in a
scalable mode so it automatically
creates 21 fly instances for you
front-end it to the h a proxy load
balancer
this could be either a single command
like a command line command or just one
click couple of clicks on the open shift
console and it gives you all that
benefits so that worked out very well
for us in terms of data stores as I was
talking you know this is what our
guidance is typically all our business
entities you know activity goal user
profile miles etc those were all stored
in a persistent database like our DBMS
that's where all our data when their
lettuce particularly was used for
generating timeline data because it has
sorted sets it has atomic counters where
you can write you know they look for now
we have two scalable instances let's say
the app grows big there are lots of
users writing from all over the world
these counters are atomic so you can
write to reddit from anywhere in the
world and lettuce will make sure the
counter stays atomic and the state stays
good so that was one of the reasons and
it also allows you to generate timeline
data so for example for each runner we
were showing in which order your order
entering the data or let's say it's a
social network so I have four friends in
my social network it can show the
timeline of your social network because
of the red is sorted sets feature it
allows us to really easily generate that
timeline and mongodb you know being a
graph based database it was much easier
to use it for location-based user
recommendations so let's say I sign up
from San Jose California somebody else
join joins from San Jose California so
it's MongoDB was very good in generating
those recommendations for us so follower
following all those there are types were
built in and that's how exactly not
exactly but that's how similarly a
facebook is also using this in terms of
tools of IntelliJ IDEA was used so
NetBeans has a good support intelligent
is and we all know it's developed with
pleasure as one of the best ideas for
Java development it doesn't have that
good of a wizard support but if you know
what annotations you want it is really
good actually in that sense we use get
as a version control for now we did not
use any CI but the plan is to use
Jenkins as a CI mechanism so in my talk
on
monday morning this is yesterday only it
felt like two days back so monday
morning i gave a java ee 7 tutorial on
how you can easily set up java ee 7
continuous integration environment using
Jenkins open shift while fly all of
those so the goal is to actually use it
for that we're in miles to run dot org
always stays live if we make any changes
it goes pulls out the stuff from my
workspace runs the test against a test
deployment of the test passes it
automatically updates my deployment
environment that sort of a continuous
delivery at least some piece of
continuous delivery is available there
so one of the wish list for java ie8
that came from here support for no SQL
database I told the person who wrote
this this not going to happen because
that's not in the radar right now but a
standardized support for no SQL was the
developers wish list one thing that I
agree with that we need is easy to add
or support to application this is very
implementation-specific at this point of
time this is required at the jax-rs
level so i hear that jax-rs expert group
is thinking on those lines so that will
be really nice and then support for MVC
framework which is automatically taken
care of by Jace or 371 so hopefully when
Jace or 371 implementations start
showing up then we can say you know what
here is this application rewritten using
Jace or 371 so shaker gulati he's one of
the he used to be one of the open
shipped evangelist for red hat he left
since he wrote the application so if
anybody is willing to take the ownership
of the application I'm happy to pass it
on to you any questions on that so far
ok let me ask a question then
the transactions across database do you
use exit transactions or transaction XA
would be required in that case if you're
doing across database but generally I
have not used them myself anybody has
suggestion how do you do transactions
across database anybody use transactions
across database how do you use them X a
transaction I guess that's your answer
that's typically what I have seen yeah
no no these were like a remember these
were my SQL rarest and Mongo and we had
separate data that was going into these
different databases there was no need
for a transactional between them right
right right right right right and
another part being Reddy's and Mongo
there is no concept of a transaction per
se right how many of you are using java
ee 7 today okay keep your hands up big
tall how many of you using java ee 7 in
production excellent I would love to
talk to you you know all of these
stories are featured on my blog and I'm
happy to kind of talk to you more in
detail on how you're using java ee 7 so
these are stories I would love to you be
a story here okay last use case here
which is TP dot camp this is basically a
campground management software and the
website name literally is TP dot camp
you can do reservations portal email
monitoring all of that using java ee 7
the goal is really targeting about
25,000 plus campgrounds across the
europe they have a very customer
friendly looking portable portal and the
model is you can either go on on you
know you can install TP dot camp
download the software install on your
site or you can say and what I don't
want know about hosting you give me sass
Frank so typical camp is hosted then you
can say a dollar a day or a euro a day
depending upon where your campground is
located so i could be for example from
Big Sur campground let's say if I don't
have a website then as a big sur
campground owner which is a popular
campground here in California I could go
just to my camped around here you know
if you're passing by or if you want to
plan your trip then you can join in no
money charge to you I pay a dollar a day
but you sign up and you book your camp
website or your camp holiday over there
so as you can see the website is pretty
fancy literally the website is TP dot
camp let's talk about it there are lots
of features over here so he can get a
overview of what the website is you can
actually get pictures you can actually
get pictures of the campsite so you can
post them you can see a complete
calendar of the website of the campsite
then you have a checkout page you have
the complete campground map so you can
choose which which portions or which
site do you on a book for yourself so in
terms of the architecture diagram here
what we have is there is a campground
owner on the right side where now we
give them a management of the campground
website its remember it's not the
campground website is a reservation
portal only for them so you can say you
know you register your website there are
different ways by which you can register
they even expose a RESTful API so you
can take payments due using different
mechanisms be h square be it iphone
scanning all of those are available on
the left hand side is travelers like you
and me you know we want to go spend
couple of days on a campground so I go
on this portal d p dot gamba through the
bottom and I look for a campsite I look
my dates look at my calendar make a
booking and check out so let's take a
look at the technology diagram for that
okay so here this is a it's a jsf
application so very classic java ee
application in that sense so jsf with
primefaces
then we are using CDI beans with view
scoped annotation now this was a new
annotation that was introduced as part
of jsf 2.2 so it really keeps your beans
tied to a view then here we had in
servlet there are web hooks for SendGrid
and paypal and i'll talk about that a
little bit later all your resources are
done using rest and this is a NT control
boundary pattern and I'll talk about
that in the next slide but all your EG
bees were using that design pattern hold
on that for a second but otherwise there
were a bunch of other technologies that
were being used standard jsf jax-rs
expression language for integration with
JSF servlet four hooks JSON for json
processing once again there was no need
to bundle a third-party library in order
to integrate with json you could ask
functionality is baked into the platform
itself so smaller war file concurrency
was used and i'll talk about that bean
validation was used in different jax-rs
services if you're posting data you can
actually automatically through
validation constraint which basically
again makes your code quality look
better or jazz with jdbc rial was used
for security everything was running on
JDK 8 and i will show you some of the
JDK 8 features were used and this was
hosted in a data center on linux with
apache httpd all right let's take a look
at the technology in more detail now so
in terms of presentation javaserver
faces was used with expression language
security as i said was used with jazz
principle and jdbc rial so as soon as
you log in you know you are in a gb you
get the jazz principal and then you map
it up with a jdbc riyadh it could be LDL
dupree album or any of the reales that
you want to tie it with our file real
what you need is Yuri albums use in this
case in terms of middle tier we use EG
bees for business boundaries so all the
business logic was in the ejb itself you
know again you have to think about it
whether you want ej bees or you want ad
transactional now servlets were used
with J's on because paypal and send grid
now Sen grid is used for is a framework
which can be
used for sending emails lots of emails
like literally millions of emails so
paypal and send great they will not send
great but paypal uses JS on to do the
communication so in using so typically
you don't start off with a servlet know
like okay i'm going to create a website
let me create a servlet and the JSP
that's the legacy model please don't do
that here servlets were used for web
hooks because when you're using paypal
you need servlet to pull the data n you
need to provide a URL so that's that's a
decent use case so you pull the data in
from paypal in json you parse it using
the json api and so that's one mechanism
and SendGrid is for sending emails that
again requires hooks so they were using
a servlets for those hooks as well now
all of the logic was you built using
this architecture but if any data was to
be exposed to other partners so for
example let's say somebody want to write
a new client to it now today there is a
ipad and a desktop client if you want to
write a android client so then jax-rs
api was exposed to different partners in
terms of the back end JP a plus B
validation was used so the advantage of
that is you don't have to in your
persist method or delete method or
update method check whether the field
that is coming in to you is honoring all
the constraints you just put the
annotation on the field and because of
pre persist pre update and pre delete
those are the triggers that are
available for jpa those constraints are
automatically validated and here again
the JP entities were designed and they
use the new annotation called as at
index because by default if you have a
JP entity and with that if you generate
your scheme on either SQL or directly
into the database there is an index
generated for the primary key but if you
want to have an index generated on our
different key as well then you need a
different column then you need to
specify at index this is a new feature
that was added to java ee 7 so
at index was used for database
generation let's see how concurrency was
used this is sort of a very typical use
case of concurrency and I'm glad he was
using it it was used for statistics and
sending messages so the idea was you
know if you use email or ascend grid
framework to send email it could take up
to 12 4 seconds that was the whole
concept of designing the concurrency API
because you know you don't want to be
greedy you don't want to have a
server-side thread blocked for that so
you receive a request in ejp and you
know that it's going to take longer no
time it's not like a quick synchronous
response back so you spin up a new
thread you let the thread process over
there and resume when the thread has
done processing now the typical time was
124 seconds sometimes it could take
longer depending upon the network
condition so very classic use case and
I'm glad it was used that way so the
idea was you take you create a singleton
ejb with the startup annotation so as
soon as your app is deployed your ejb is
up and in there you have add schedule so
basically every one hour or five hours
or end of the day it will start sending
emails so as the booking is being done
you know then at the end of the day it
could send out a whole chunk of emails
that your reservation is confirmed so to
be more specific the workflow was you
know as a person who wants to live in
the campsite you will go there you make
the reservation the back end processing
will happen that yeah the money has been
received you know using PayPal JSON hook
and all the processing is done then you
use sendgrid to send out an email so
very very standard model but it's good
to know somehow that this is how people
are using it some of the JDK 8 specific
features that were used for lambdas and
parallel streams now hopefully well that
is the plan indeed for Java e8 they're
going to use lambdas and parallel
streams and datetime API as part of the
API itself but that does not mean you
cannot use JDK 8 features today with
java ee 7 val fly and glassfish they are
both certified on
k 8 so you can take a look at those you
know you can run your JDK applications
on them and they work very well so
general principles all components are
used with inject you know there is
nothing like new there is no application
managed objects these are all container
managed objects being discovery mode as
i said was all so it is CDI through and
through all named beans were with JSF to
door to view scope that's again as I
said it is a new annotation added to the
java ee 7 platform our business
boundaries are using stateless by not
specifying any interface like remote or
local there was no need for a remote
interface over here so you wanted to
specify local by default their local
within the war file and that was the
design pattern that was used over here
all modules were in any control boundary
pattern now let's talk about that for a
second so this is the entity controlled
boundary pattern so if you guys follow
Adam be and you know he was the one who
car connected this applications is very
clean in that sense I just loved that I
so this is your entity controlled
boundary pattern so you can see for
example here this is camp dot T P dot
biz not message messenger that's the top
level package this is entity this is
control this is boundary so that's the
reason is called as entity controlled
boundary pattern so you know you split
your functionality across entity which
is your jpn at ease control which is
your servlet or CDI beans and boundary
which is your ejbs okay so you can see
here for example this is your stateless
ejb this is your control objects so in
the control for example you can say
there is a send message prepare HTML all
of those and then here these are all
your JP entities so very clean entry
control boundary pattern which helps you
to keep your code organized well let's
see what additional libraries were used
here so primefaces 5 once again this
continues to be a very very popular
library I've used it many times I just
love the library the look and feel the
customization that it provides
and the guy behind this is just
fantastically awesome that really
matters a lot so primefaces was used for
the components bootstrap again for the
responsive portal styling all of that
SendGrid API as i said was used for
sending emails database migrations now
one of the issues that we had with miles
to run was how do we do migrations we
were doing or rather UNHCR was change
requests that wasn't a clean way how
many of you are aware of fly away fly
way yeah very cool if you haven't looked
at Flyway highly recommend taking a look
at Flyway I'm actually planning a series
of hackathons with Axl Fontaine the guy
who runs the company Flyway basically
talking about is how should database
migrations be done for a java ee
applications so hopefully soon i will
start a series I'll advertise using my
twitter handle so you're welcome to join
it will be hangouts on air you can ask
questions you know why this why not this
or if you have any questions where you
may not be able to join the hackathon
send me the questions send the questions
my way so this is relational what do you
mean by database migrations for no SQL
there is no schema so yeah I mean if you
have any questions excuse me now that's
good that's right right right short
short short short and the migration that
in that sense the doing database
migration itself you know you can just
add whatever you want to add over there
yeah so this is this is purely targeted
at our DBMS so and there are 400 of
those so if you have any questions on
what is it that you worry or that you
care or that you think about database
migrations I am NOT ready by sky so
hopefully i'll try to answer some of
those questions but if you have any
burning questions or any simple
questions tweet dip to me because i'm
going to be working with axel on that
series of webinars so hopefully that
will give some visibility on how to do
database migrations in java ee so
definitely take a look at Flyway for day
based migrations that's what was being
used over here very clean very simple
way some of the Apache Commons API were
used hopefully they can JDK can learn
and copy them over into jdk 8 itself or
Deacon 9 or 10 or 11 j unit was used
with Derby for testing the actual
deployment was using a different
database let's take a look so jdk 8 was
used as the underlying jdk and you see
that there are lots of features that
were being used from jdk 8 like lambdas
parallel streams this is the common ones
multiply eight dot one was used as the
deployment platform and this is a code
coming from the customer where they love
the support that wildfly was giving them
very responsive not just the UI but the
backend matters a lot too and in terms
of the database mysql was used in terms
of tools IntelliJ was used as the IDE
you know and we have seen that more and
more prominently anyways a beautiful
tool for java editing jenkins was used
for CI testing you know knowing that
this is adam bien you can get away with
TD it's kind of a TDD a loader dot io
yes again another library that was used
for load testing and right now this is
hosted in a data center in Germany
hetzner tour de but because the fact
that they're using while fly eight dot
one they are planning to migrate 20 per
shift because then they don't need to
worry about their own data center and as
I said earlier it provides that auto
scaling load balancer all of that and we
have a model which is sort of continuous
integration and all those things so wish
list for java e8 apache commons library
suck it up and include it into java jdk
9 and a much lower level this is my pet
peeve in jsr 352 I think point 8 or
point 9 we had support for generics and
I was in close contact with the IBM's
package at that point of time and all of
a sudden in one dot oh I see that oh you
know what this is genetic support is
pulled out what happened there or we
could implement
generic support in the implementation
that's why we pulled it out from the
spec okay fair reason and fair fair
reason I give them full credits because
most of the time it boils down to
resources so they did a really good job
with GSR 352 but generic support is
typically the top one question that I
get asked about batch so hopefully in
the 352 dot next they will take care of
that because once you lose out looking
at your reader processor and writer the
code looks a lot more cleaner right away
there were issues how temporal work with
local date and local time at ambien is
following in the specs already so his
hopefully would have that fix and this
was his feedback on the technology I
have no great wishes the technology is
perfect i'm with java ee 7 very
productive customers are happy
everything is possible as a that's a
good comment lat ambien is a rock star
so Christoph gap is the man who is
behind TP cam and this whole website
really started just because of you know
hey I was going on a vacation I could
not book a camp website I come back home
and my wife was sitting on my head isn't
that how most of the things start I'm
glad this is behind every successful
website there's a woman Adam bein was
architect of the application so these
are the two key guys now in terms of
resources there is java ee 7 tutorial
which is sort of the definitive resource
but to me is little bulky for my taste
is too much detail over there so I I end
up going to the about 200 code samples
that are on the github how many of you
are aware of the java ee 7 code samples
let me quickly show here which you may
find useful so if you go here these are
about 200 plus code samples which are on
the github so java ee samples is
organization and in there this is java
ee 7 samples repo and you can see there
are about so if you want to learn about
web socket for example you click here
and these are hello world samples there
are about 30 plus samples just on web
socket you
learn basic concepts hello world style
you can do that you wanna learn about
jay's on there are four of those so lots
of different samples so that's I think
is a great resource and there are lots
of books including mine and Peter's and
David's and anybody else has lived in
the book excellent alright great so any
more questions I got just about two
minutes I have not played around with
the ebay so you'll have to check with
axel ok that's a great question actually
I'm going to make sure that include that
in my hackathon because and see really
that's what customers look for that why
should i use flyway by no means I mean
to bash liquid base or anything else but
it's more like you know what are the
pros and the cons of using it ok that's
good that's good yeah I'll do that
on liquid base sounds like Flyway well
my one thing is I don't want to go to
flyweight or org and look at the
competitors page so yeah yeah okay
that's good to know that's good to know
because I have my own style of poking
and I'm going to ask you know what tell
me this this is possible yes no and let
the person be her ask any more questions
yeah so a p7 exactly a p7 is going to be
in production next year but but one of
that well as a red hat or meet me
outside i can tell you more but as a red
hat ER as a red hat that's what i can
say one of the advantages of EAP though
is you can start with wildfly today and
once you know because the code from
wildfly to EAP is ninety-nine point nine
percent similar I bring no I bring I
agree I agree and that's a that's a
problem absolutely yeah so on the way
right now is a JBoss AP weblogic and
liberty profile i started reducing their
betas as well and so hopefully some of
them in are not a race really but one of
them will show up all right you can
always find me at twitter.com thing me a
message shoot me a message i'm going to
post my slides later today you will have
access to them thank you very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>