<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Packaging and Deploying Java Apps in Java 8u20 | Coder Coacher - Coaching Coders</title><meta content="Packaging and Deploying Java Apps in Java 8u20 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Packaging and Deploying Java Apps in Java 8u20</b></h2><h5 class="post__date">2015-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/7SNW6Mc9ipE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">now thank you for coming here you're
dedicated there's a lot of interesting
things I want to talk to you about a the
the Java package are an 8 update 20 safe
harbor statement as an Oracle employee I
need to tell you this that you know a
bunch of legalese it says Oracle is cool
with the SCC is what it comes down to
the first thing I want to talk about is
the name of the job at Epic the JavaFX
packager in 8 update 22 underwent a name
change it is now just the Java package
err and the reason we did that is we
wanted to communicate through the name
the JavaFX packager is not just for Java
FX in which when you read the name you
might come to that conclusion but it
still is the same entire thing
underneath it covers it still packages
Java FX apps still packages swing apps
AWT apps swt apps and new and 8 update
20 headless apps you don't need to have
a head a graphic stack to run your app
will install it into services as a
service or a demon for you as part of
the package err and I'll go over that in
one of the later slides so the five
things I'm gonna talk about here we're
gonna go over some of the features of
packaged are gonna look behind the
curtains we did an API rewrite an 8
update 20 I'm gonna tell you why we
decided to do that we're going to talk
about bundler arguments which was a new
core feature of this API rewrite and
then we're gonna move in and talk about
service and daemon supportive a few
slides about that and then the bulk of
the talk is gonna be what I call the
tour of Butler's I'm gonna go over all
the bundler
that are a part of Java packager and
talk about the specific bundler
arguments that go with it to show you
how they interact with that and some of
the features that they're exposed
individually this is one of the big
feature ads of 8 update to money I'm
gonna wrap up the talk
assuming mark Ryan Hall doesn't come and
grab a clicker out of my hand we're
gonna wind up the talk talking about
what's coming in 8 update 40 and Jeff
208 some of the features were
implementing from that again safe harbor
it should make it but don't make
commitments based on that I was I gonna
mention for this
anyway well just hopefully here's a
slide for it so first let's let's peek
behind the curtain and look at the API
we right now you're probably wondering
why would we write an internal API that
has already been used externally maven
was already using this API for its
JavaFX plug in Gradle was using the
existing API for the plug-in and that
kind of exposed some of the reasons why
it was decided you know before I came on
board and Oracle I just started working
with them in December on this project
but why I was decided before I came on
board that we needed to rewrite the API
the goals were really tooling one of the
big advantages with things that they
wanted to do was get better integrated
development environment integration with
it kind of what they did with the scene
builder kit how they refactored it and
made it a little many different parts
that you can shove into different parts
of the IDE without requiring a huge
stage as you take care of stuff so so we
rewrote the toolkit with that in mind it
also was a side effect of this we also
got some better build tool integration
and allowing the build tools to go
directly to the bundler and even go to
specific bundlers and asked them to do
to do their tasks and one of the thing
that allowed us to do is to reduce a lot
of the cross interference from some of
the bundlers I don't know if you knew
this but in the JavaFX plugin in the
Gradle plugin in the amp plug-in on the
command line if you wanted to create a
native package you were also getting
whether you wanted it or not
the jnlp stuff and that was mostly an
artifact of the way that the API existed
so now that we pull those apart you
don't have to get the djinn I'll pay you
unless you want the jnlp and we can
still generate that for you and that's
that's a valid way that you could bundle
it but probably the biggest reason that
we exposed it in this way this allows us
to allow for third-party butler's to be
integrated into the Java packager system
this is going to become a bigger deal as
some of the community projects gain a
lot more steam if you were the community
keynote you saw ohan Voss and Nicolas
turning show their Robo vm and they're
there JavaFX on dalvik projects and
they're playing video games on their
iPads and their Android tablets now
that's the sort of thing that Oracle
does not bundle with the JDK because
they don't have you know total code
order
ship from soup to nuts in a lot of it so
by exposing the API to let third party
Butler's hook into the process and
stream into it we allow them to
integrate with the tooling system for
bundler that we that Oracle may not have
complete ownership for or may not have a
complete security vetting for allowing
the community to come in and and
interact with the product and in a
higher-quality fashion now for a create
update 21 of the big features of the API
as it was configured through an object
called bundle params it was a great
javabeans project and they had all the
beans in there and it follow all the
great patterns the problem of java beans
is it's fixed you only have those
properties that are exposed there and
another thing is also invoked through
package or live through a separate class
that if you're going to use the API you
also have to load in all the classes
that would deal with some Java FX
specific tasks like compiling your CSS
then as already mentioned it always
executed the jnlp so it made executing
you know laser-focused execution of
these bundlers a little more difficult
so what we did in eighth up to eight
update 20 is we took this bundler pram
object and we replaced it with a map of
strings and this is a generic thing to
take care of whether you pass the map
string string or map string object but
we're configuring this through a map of
variables so any value that you add
before after you can just add in there
and not have to worry about it
Java doesn't have some of the cool
things groovy has where you can
dynamically add properties at runtime
we're trying to make this so that it's
it's extensible and you can do those
things with in Java as it exists today
we also introduced a bundle per am info
so when you put your strings in there
with a bundler you can get the
information out of that in a more
friendly fashion you can include things
like you know getting defaults getting
string defaults and interpreting that
information and we also provide a
central centralized bundler object that
you can register and register the
bubblers so from this this allowed us to
get new tooling support the java package
err binary already uses this that ships
with the JDK 8 update to 8 update 20 the
ant's integration that we shipped with
the jdk ship
with this working and about a month ago
I released the Maven in the Gradle
plugin the original author the maven
plug-in has moved on to other things and
so I've taken over that project and then
responsible now for maintaining and
releasing it we've released a new 8 1 X
version I think our update 1 to 4 maven
2 to support using the new API in 8
update 20 in Gradle it has an eight one
one version and as bugs comes in you
know there'll be updates important thing
about the naming conventions for these
version 8 signifies that it works with
JDK 8 and then dot 1 corresponds with
whether it's the point I'm in update 20
or the 8 update 40 or the ADA peach 60
releases if there are things that would
break the API that would require a new
version we have bumped that second
number adult bug fixes ago and the third
number so the short answer is the new
API is there for all the mainstream
build tools that you would use in your
ecosystem even if you use bash scripts
to execute your build you can still get
at it although I really recommend you
get a quality built system than just a
bash script so the bundle program info
in addition to you know providing just
the meta information to the compiler it
provides some user-facing information
and if you do a we integrate with the
help command that you can look at the
Butler's that are being loaded into the
Java package err you can also extract
some of us health information and show
it to the users I believe it's - help
bundlers of a list of bundlers and -
help a bundler name it will list the
names of the parameters that it's
expecting in the bundle arguments now
let's talk about the bundle arguments
now previously when we integrated this
there were there are fixed command names
that you would use and you can still use
those when invoking it through hands or
invoking it through the command line
stuff like the - name - main class - app
info - vendor those sorts of you know
all the ant attributes and elements all
those are still supported but under the
cover as they go into this map and
they're put into the bundle arguments
now because we're putting in bundler is
that the ant integration may not know
about its parameters we put on some
generic hooks in that so as you can say
this is my
bundler parameter name and here's its
value and some of the things that you
might be using these bubbler arguments
for might be on Macintosh you're signing
identities Linux doesn't care what your
third-party max signing ID is so you can
specify that just for back app store the
Mac has some specific app store category
name is some very peculiar ones that you
must use and are actually pretty user
unfriendly to look at so you can use
that and specify it just for Mac Windows
sometimes likes you to put in a UUID or
maybe the name of your Start menu group
Linux one of the things that we have put
into the bundler / am in both just for
Linux was a maintainer email address
because if you loaded up a bundler on
Debian without a maintain or email
address and you try and load that bundle
Lubuntu is gonna pop up a dialog it says
this is a low quality bundle you should
be using it because there's no email
address for someone to send bugs to so
we integrated that and that's something
that only Linux cares about and again
surprisingly only Linux cares about
actually not surprisingly Linux cares
about what open-source software license
you have this under and Windows and Mac
they just want to click through license
they don't want you to categorize it
they want the full text so we can
provide those just for Linux because
it's relevant to a smaller subset of the
bundlers we can do this with the bundler
arguments now here's how it specify in
the in the command line interface there
is a new - B flag and it follows the
same name equals value pattern and in
here in the next few slides we're
basically going to provide the same
arguments into a bundler for the various
plugins that use it you know we have our
awesome app and here's our description
all this all the normal old command line
flags still work and are still
functional but if you want to specify an
application category which is not in a
CLI you can do - be application category
version surprisingly was not in a CLI
your email if you're Linux maintaining
and if you're su assigning username is
awesome developer you need to put that
in if you're gonna sign it for Mac now
for ant it's a bit different there's a
lot more brackets and slashes and quotes
and equals but the real change down here
is just this one element we have a lot
of the values that are in in ant that
aren't in the command line
but there's still one argument that we
have to specify bundler argument for
because this is the sort of a thing that
I don't ever expect to the ant FX deploy
bundler to have a hardwired attribute
for and that is the Mac signing key
username so here you would use an FX
bundle argument element make that as
child of the deploy element and set your
Argan your value now if you're really
adventurous you can have your entire
Java package or things set up just by
using bundler arguments if that's your
thing totally supports it
now with ant if you specify something as
a bundler argument and you specify it
through one of the built-in themes like
the includes element you'll get a build
error you can only specify a bundler
program once and in one place and we
actually enforce that in the code that's
something that came back from our sqe
team in st. Petersburg that said this is
going to be confusing to developers and
after some back-and-forth we agreed with
them that it could cause confusion so if
you try and specify a bundler parameter
twice through the bottom of our
arguments and through the commitment
through the built-in plugin integration
it's going to throw an error it'll tell
you which ones you're doing wrong now
here's how it looks at maven may even
you apply the plug-in and maybe but it
takes a lot more the configuration about
it from the context of the build but the
bundler arguments is just a map style
element of the configuration element and
may even got to be maven got to do
things its own way the name of the
elements is the key name and the value
of the element is the argument that
would go in and this is of course as a
string there are some other
configurations that would go there I was
running out of space here if I listed
everything we would be down a 10-point
font and you know the oldest person in
here is much older than ten years old so
just cut that for brevity but do you do
the same thing you just keep listing
them all going down now here's how you
would do it in Gradle in Gradle you have
a Java FX block and you just add a new
bundler arguments block and you set
value equals name equals value now some
of the names are not valid identifiers
on their own so you just you know do the
good old encased in quotes trick the
groovy supports you could put kanji in
there you could use a
you can real crazy with the Unicode in
in groovy and make it pretty interesting
and entertaining another syntax we
support is the native map syntax or use
a key colon value I'm in Gradle if
that's more suitable for your build
system feel free to do that so any
questions about IDE integration with
bundler arguments before I move on to
the services ok so we've got a few
slides about the service and daemon
support dmitritch dropping oven and st.
Petersburg put this together for us I
think it's a really slick way to deal
with these micro services so one of the
design goals of the Java packager is we
we really only try to support 80% of
what people need to do you know support
80% of the projects out there there are
some 10% of the projects that need some
really hardcore stuff and for those who
just get you know get install shield
invest in an installer engineering
resource if you're in that 20 20 percent
bracket it's really valuable to have
someone committed to it but if any er
that in that 80 percent of the
applications it just needs it put it
into a standard executable and run we
support you so this kind of takes that
same philosophy towards services so if
you create a a java program that is
headless and it's gonna be a
responsibility then to open up all
Network ports make sure you don't die
when you're not supposed to and respond
to it but if your headless application
that provides out useful services on
your computer you can specify a few
bundler arguments this is only supported
on a few of the bundlers it's not
supported on all of them it's not
supported on the disk based in image
installers it's not supported on the Mac
App Store
Norah's Vince thought supported in the
Mac dmg but all the other installer
bundlers we support this with but the
exe and the MSI we're going to install
this service as a service as a Windows
service that would show up in your
service control panel you can start and
stop and do all the fun administration
stuff you want to do for Linux for
Debian and rpm we install it in an it D
and that's what we do currently and I
hear there's rumblings that they're
trying to start the search change the
services boot up they in Linux and when
that changes and becomes more common
we'll probably come back and update this
but for now it's in addy and all the
main things there
'we have support background support for
an empty now format we only support the
PKG installer and this is the wizard
installer you may have seen when we
install this into launch CTL and we only
install it right now into the system
launch CTL we don't support installing
it into user space detail at the moment
that's not something that that we've
looked at now if you know for these
things that i said we don't do is
something that you'll be interested in
seeing happen there's gonna be a URL at
the end
JavaFX Giratina comm that's where you
can post all of your your bug requests
and future requests if for something
like this having a bug request goes a
long way in a convincing project
management that it should be prioritized
over other tasks because there's a lot
of things we could do with the packager
but the question is well what do we do
first because we have six-month releases
that we need a hit we can't just go dark
for two years and do everything awesome
we need to ship it on a regular basis
now to support this daemon flag we
supported an ant and CLI we added a new
- daemon flag for the CLI that will
package your application as a daemon
using the command line interface for
ants there is a new daemon boolean
attribute that is a part of the FX
application element and that's an
element you'll either refer to or make
child - your FX deploy element and if
you set that to true the butlers that
support daemon butlers will go through
and do the appropriate thing for the
bundlers that don't support it it'll
just ignore it that's the thing about
these about their arguments if a bundler
doesn't understand it it ignores this
you can load it up with all of your
cross-platform build information and
Linux will just completely ignore the
max series upon their arguments now for
Gradle and maven right now you would use
the bundler arguments to set up this
demon flag might believe it's a service
hint here we go so here's the bundler
arguments so service hint is the one
that is set by the daemon flag and the
daemon argument the other three bundler
arguments they default to what we think
is a rational value and you can change
those if you want different ones we do
not configure your service to
automatically run it start up if you
want to change that you just set that
bundler argument to be true we do not
start it when you install it immediately
if you want to change that you would set
it to true
and when you run the uninstaller we do
automatically stop your service for you
there's some crazy edge cases where you
don't want that to happen and if that's
you you can set the bundler argument to
false but these are the the defaults we
went with there's you know some security
implications that we don't want them
just randomly starting things
accidentally if you want to create an
installer that starts a service at
startup graphic installer we want you to
take a deliberate action to go and do
that so it's so it crosses your mind am
i doing the right thing here and you
probably are but we just want to make
sure that that checkpoint goes across
your mind as you're as you're setting
these bundler arguments okay so for the
next part of the slides I'm gonna go
through tour of all the various bundler
there's ten of them there's a lot of
common parameters if you have a question
about knees bundler while I go through
it just shoot up your hand and ask me a
question there's there's you know some
of these slides might go pretty quick
these slides will also you know as part
of Java 1 I'm gonna upload these and put
them online so they'll be available for
future reference now the Butler's right
now are broadly categorized into two
groups the first one I call the disk
image bundler and these are the ones
that take your application take the JVM
put it in a proper directory layout that
is appropriate to your operating system
and then they're done the Mac a P P
Butler the mac app bundler has to deal
with some particular requirements of the
Macintosh operating system they have
some very particular rules as to how and
why you put certain things and certain
arguments and we just automatically deal
with that and deal with it for you and
put it in there the windows it's it's a
standard Exe layout the Windows and
Linux layouts look very much alike we
try to keep them as alike as possible
but the windows one needs to do some
unique things like copy some dll's that
linux doesn't have and linux has to copy
some shared libraries and they both have
to deal with their java runtime
environment and their jdk s a bit
differently in each cases and we
abstract those those differences into
the into the disk image bundlers the
next group is the installer butlers and
all of these actually leverage the disk
image bundler so the Mac the dmg bundler
all it does is it takes the mehek app
makes it dmg file puts it on there and
by default we put a pretty picture and
links the Applications folder you can
drag to using using AppleScript the pkg
installer is is a wizard-based installer
some people like the wizard based
experience it also has a hook in there
where you can customize some of the
scripts that are run during the
execution of the pkg that's new in 8
update 20 and the big new exciting one
there was another session about this
yesterday so if you missed it you can go
back online and look at the recordings
for it as we have a a bundler that will
make your application Mac App Store
ready and I know this works because I
have submitted applications to the App
Store and have been accepted and
republished I'm trying to get on some
late published with this but Apple
rejected it yesterday because the view
source button didn't work they actually
did Mikey way for me that was kind of
nice of them they don't like pushing
bubble they don't like publishing buggy
apps so that'll be up here probably
within a month ensemble a and I'm gonna
publish the source actually it's already
out on the Gradle gradle samples
directory if you download the source but
this can actually get stuff onto the Mac
App Store and there's some particular
things we have to deal with the Qt kit
removing anything that uses Qt kit
it'll verify that use in the right
category and it'll sign out the right
key there's there's even more esoteric
requirements to get on the Mac App Store
and in this bundler we handle them for
you transparently on Windows we use the
Wix toolset to make a dot MSI installer
and that makes all the windows system
ins go glassy-eyed because they can
automate the install and push that to
desktops behind Lee but for people who
want a dot exe installer one where there
is an icon as part of the Installer and
an ice wizard that comes up we also
support you know set up to support those
wizard like installers for Linux we
support the dot DB in the dot our p.m.
format so they're basically the same
thing except they're on different
flavors of Linux and they have their own
peculiarities that we deal with so
whether you're running Fedora whether
you're running the Boone - you can take
the same source code and make yourself a
Linux packaged bundler and you could
possibly upload this to the to the
repositories that they handle handle
these installs so one interesting thing
that's going to change here probably in
Java 9 is there's probably going to be
more discs in
bundlers they'll just be used
transparently whether you're going to be
installing it with a modular GRE or not
and even in Java 9 that the structure
the GRE is going to change but the idea
is that this is gonna be completely
transparent to you if you just run the
bundler in Java 9 it'll just magically
happen that's kind of the structure of a
lot of these Butler's were taking all
the peculiarities particularly ones been
talked about coming up these next few
slides and we just hide it from you and
you can worry yourself about it only
when it matters and if it doesn't matter
to you you just don't need to worry
about it so let's go over the common
bundler there's about ten of these
arguments that are common amongst
basically all of the application
Butler's there used to feed into the
disk image and there's some common
values the first one of course this is
somewhat of an important one is name
this is the name of the application if
you wanted to say awesome app on your
icon you said awesome you'd set your
named awesome app and this name also
flows through to a lot of other things
this will affect the name of your by
default it'll affect the name of your
bundle in Linux and it'll affect the
name of your preferences ID that's gonna
change where you store your information
in in some of the properties in Mac and
it it falls through and becomes the
defaults for a lot of other values you
can change those defaults but it's gonna
if you don't provide a value it's going
to use this name value the next one is
app version and this is the version of
the application and this is generally
gonna be the one that you're gonna show
to the end-user the one with all the
dashes and the letters and the you know
that all the all the sorts of funny
stuff there are this does on occasion
flow down to other version fields but
there are cases where some of the
installers want the version to be in a
specific format in those cases we
provide another application bundler
argument for you to provide a bundler
name for example I think Wix wants a 3
or 4 version there is a particular Mac
one that wants a 3 version of just
numbers some of them get cranky when you
use dashes and letters and and the
butler's will tell you this when you're
getting it wrong and these correspond
have got you know this name corresponds
to - name and there's the ant's plugin
integration and the app version is only
specified in the ant plugin
now here's there's three sets of options
that you can use these are common across
all of the Butler's to adjust the
command line experience of the Java
Virtual VM now even though we don't ship
Java dot exe as part of the bundler we
do let you access a lot of the options
that are needed to run it JVM options
you would pass in either a uh an array
of strings or a string that is space
separated that will provide you the
option to pass on all the fancy JVM
options like - X MX to change the memory
there are some hot spot flags that
people need on occasion that need to be
passed in you can even pass in the
bugger flags to always have your
debugger turned on if you want and
that's done for the JVM options
another one is JVM properties this is a
map that you would pass in or we pass in
a series of name equals value strings to
the argument then that you could do the
same thing with a JVM options bundler
argument but sometimes the properties it
looks better
in your build environment to just put it
on the properties element make it a
little more clear this is where you
might pass in properties to installer
like if you have a custom server that
you're getting your data from that you
don't want have to compile into the code
this is where you could set it and all
sorts of other custom configurations and
finally there is the application class
an eight update 20 this this is the
class that you can specify that will be
executed an eight update 40 there is
another argument arguments where you can
pass in a default set of arguments to be
passed into that class right now we
don't support a default set of arguments
but if they do invoke your executable or
your binary with a set of command-line
arguments those will be passed in so in
eight update 40 will allow you to do
that at the command line is as another
bundler argument but right now that's
not something we support by default and
finally the last set of arguments that
are common to all of them is how you
specify which classes you're using which
jars you're using and what your
application assets are app resources is
a structure that will contain every
single resource that goes into the app
directory this is gonna be all your jars
all your media files all your
configuration properties everything
that's going to go into that directory
that it needs to reference a lot of
people put their there
application resources and their jars and
that's fine but if you don't want to put
it in your jar and you want to put it on
the side of the jars this is how you
would configure you to put it in along
with the other jars now if you just
specify a pre source says a lot of the
other values are going to be calculated
by the bundler one thing is we're going
to calculate if you don't specify as the
classpath but if you have a special
thing that you want to set with the
class path like let's say you're writing
OSGi
and you only need three jars on your
class path you need a reference to have
a jar some other way you can specify the
class path there and finally the main
jar in some cases it matters where the
executable of your application is in a
jar so if it shows up in multiple jars
you can specify which one it is if you
don't specify the main jar will search
the class path look for your executable
class and if we can't find that will
stop the build and say hey I can't do
this but if we can't find it we'll
remember which one pass it in the
configuration parameter so we can go
down and do the right thing while we're
running this so any questions about the
generic arguments I put these in the
slide mostly the reference to show how
they would correspond to the main main
arguments for the most part you would
never really directly specify them
except for a class path and main jar in
arguments
oh one more I forgot this is the most
important one runtime so when you're
running the application bundler if you
want to include the Java Runtime that is
actually running your build environment
don't set a thing you'll like to
automatically bring it in if you're
really good about keeping the most
update secure version of Java or if
you're running one that's peculiar to
your system that is actually running the
build environment this is the one you
use another thing is that if you don't
want it to package a runtime this is
actually an option you can have your
systems not package your runtime
environment just pass in an empty string
an empty string is distinct from null in
this case and the empty string is
telling the bundler don't pack it too
GRE instead go down the code paths when
you're rather uxe to look for the system
Java runtime environment that has it
installed there's a place looks for in
Linux there's a place that looks for in
Windows by interrogating the registry
and there's even a hook still in Mac OS
or we'll go through and make sure that
you have a system runtime involved
installed now unless you have specific
requirements for this in your enterprise
I would recommend you don't use this
because it it's kind of a it's kind of a
dice game to see which version of Java
is installed on your client when they
try and run this but if you're in an
enterprise and they only allow one
version of Java to be installed and it
has to be a certain version this is how
you would do it another important thing
when we package the runtime for your for
your bundlers we strip out everything
that is not necessary it might be a way
for hackers to us hack it we strip out
stuff like Java Exe Java C dot exe Java
PE all your executables they're really
used for debugging and running command
lines outside of it we take those out
you don't need the man pages we get rid
of those you don't need the source jars
we get rid of those there's a bunch of
other files that we just pull out in an
attempt to try and get it smaller and to
reduce the attack surface for the for
the Java Runtime environment now these
are generally well there's these are
definitely a more secure way to deploy
your applications than using applets and
web starts because they're not invoke to
be a jnlp yes the question is will this
also package any extensions in your GRE
we don't have an explicit test case for
that but I believe the answer is yes the
things that we exclude we have a
specific list of things we exclude with
it ends with the dot exe or the stuff
that we exclude from jar files we list
specific jars so as long as it's not on
that blacklist it won't be stripped so
if you put if you put groovy as an
extension jar in Lib XT it'll be
automatically packaged as an extension
and that's that's an important thing to
bring up because some libraries actually
depend on being a extension so if you
put it in your runtime as this extension
it should bring it in and if it doesn't
post a bug and let me know because
that's something we should fix and
that's generally rule of thumb if
something here doesn't work as we
advertise it absolutely post a bug we
should fix it we should get in the next
boat ok so any questions about the
general
so starting down the disk the the
individual bundlers we first talked
talked about the mac bundler and there's
a couple of keys here mac signing key
developer ID app and map bundle ID
signing free prefix then interact with
the code sign facilities if you have
specific requirements to do these for
code sign you can set these but the way
the mac dot app bundler works is that if
you take i mentioned this in the other
talk if you take the keys as part of
your Mac Developer Program and you
import them into your into your build
system with the names in the way that
Apple presents them to you we will just
automatically find them and we will just
automatically sign your app if they're
there this is for the situation where
you have multiple sets of keys installed
and if you have keys installed under
different names or if you need to
specify some crazy thing with the prefix
for specific requirements these hooks
are there if you need them Mac also
sometimes you want to specify separate
icns icon rather than to the generic PNG
if you want more color depths you would
specify that via high-content icns
makkac category if you have a specific
crazy
well it's Mac Mac has a specific list of
categories that are very you know
developer friendly but user unfriendly
you specify it in the Mac dog category
and sometimes you want a different CF
bundle name you could specify that in
the Mac CF model name I believe that's
the name that goes on the top left menu
the application menu so if you need that
different from your launcher that's the
but the bundler parameter you would need
and finally the bundle identifier is
something that is used in the
Preferences event storing files and
interacting with the container and a
signed sandbox environment for the dmg
file there's a couple of extra options
you can specify a license file in this
you would point to the file that exists
at Build time and we're going to take
that text in and we're going to present
a click through license as part of the
dmg if you want it before we open up the
disk image and the second flag is
system-wide and this tells you know when
they do the drag to install whether we
should use the Applications folder if
it's set the true which is the default
or if you set it to false well instead
show the desktop for the drag to install
me I'll drag it to their own local
desktop and it'll show up there
for the pkg bundler we have some we have
the same license file thing there is a
page reserved in the wizard to show that
they click through license any point of
the same license file there you have an
option of signing the dot PKG installer
as well as the dot a PP installer and so
this mac signing key developer ID
installer is the bundler argument you
would use to specify that if you are
operating outside the conventions and
also the PKG bundler supports all the
service and daemon bundler arguments
that went through in the previous
section you can tell it to install your
application as a service so if you have
a little micro service running tomcat
that says hi when you go to add you can
install that and it'll work great the
mac app store ready bundler we have an
options for you to specify the - signing
keys that are used into it again the
same caveat supply with mac signing keys
if you just bring it in for the mac
developer app store with the names they
give and it's the only keys on the
system to match that pattern we will
just go ahead and automatically sign it
and then there's another argument mac
app store entitlements and this is a
peculiar thing about the way that the
mac app store works they require their
apps to have entitlement state they put
you in a sandbox and won't let you do
anything unless you ask permission to do
a few set of things that let you do and
this is the file that you would point to
that you would say i would like
permission to read a file the user has
opened opened up a network port listen
to a network port so this is where the
permissions where you would ask the
signer to say we need these things to
get done so those are all the Mac
Butler's any questions about Mac
kid can you read okay so the question
was with the with the dmg bundler the
graphic assets for the background and
for the Butler the image for the disk
image in the size of it so those in the
Apple script that runs that we still
have the drop in resources facility and
we haven't had time to go back and bring
all those out so still exist in the same
way they exist before so the goal of one
of the books that I have for 8 update 40
that I'm hoping to get time to is to go
through all of those older drop in
resources and bring those and expose
them it has bundler arguments so you can
still do that but you have to put the
classpath on your build environment and
put them in a specific place in your
class path which isn't very
user-friendly but that still works
that's the way it's been since 7 update
6 when this first went in so you still
have those two same facilities there's a
good question
right the question is are we gonna leave
in the drop in scripts as part of the
installers for Mac that certain points
in the Installer will run those yes
those are still there right now they are
exposed via the drop in resources
facility through the classpath of the
build tool again I have a bug to expose
those at least through a root class if
not exposing each one of those
individually through a puddle parameter
so that's on my to-do list the the
bundle parameter might take too late
update 60 we've got a lot of big fish
for frying an 8 update 40 but yeah
that's that's something we still support
we plan on supporting it we plan on
expanding in a few places actually so
you can go and still do your custom
hooks because that kind of interacts
sometimes with some of the signing
requirements to come in some
organizations won't let you have the
signing keys they make you send the dot
a PP bundle to a separate service once
it's prepared and put certain values in
and that script is the sort of thing
that would help you do that so yeah
that's why we left it in any other map
questions before we go to Windows all
right so for the windows disk bundler
image there's only one extra special
bundle bundler specific argument that we
have and that is icon dot ICO if you
specify an icon that is PNG I believe it
breezing into ICO format but if you want
fancy things with your icon like you
want multiple resolutions and you want
high resolution support some of the
fancier features in Windows 8 that's not
something that we can take from a single
dot PNG image so if you have an icon
that supports all those fancy
integrations you pass that in as the
icon dot ICO icon into your bundler
arguments again this is referencing a
file at Build time and we'll put that in
the right place for the exe bundler we
support the copyright vendor in title
field now copyright these all the three
of these fields go into the metadata in
various places in Windows they have no
impact on the execution of your program
the copyright goes into the copyright
field of the executable installer on the
vendor when you run the uninstall screen
and it's gonna be listed as the vendor
when you sort by provider and the title
is also the comments on the install
screen and some of these are legacy
the way that we have been doing it from
before so we're keeping with if it
worked the way before unless we have a
good reason we don't change it so that's
why the comments go under the title
element but it still goes on in the
uninstaller in the comments for
describing what the application is we
also support the system-wide installer
and what this effects on Windows is
where it's installed if you say
system-wide true which I believe is not
the default for executable for
executables the default is false but an
executable if you set system-wide to
true will install it under C colon
program files or wherever the Program
Files directory is on your system if it
is set to false which is the default for
the executable it gets installed in the
user after directory where all the other
local user applications get installed
the advantage of this is you don't need
to escalate permissions to run the
installer as an end user so that's why
for the executable we said at the false
as the default because that's the
typical scenario when you're running an
executable as you're running it as user
permissions we specify the wind' menu
group allows you to say which menu group
you wanted to go into and if you want to
do a multi-level menu it use a slash we
support the shortcut hint in menu hints
one of those needs to be true if both of
them are false we will just presume that
the menu hint is true and this is
telling the installer where to install
the shortcut if you want just the
desktop you can say shortcut a hint true
menu hit false otherwise we're gonna put
it wherever the shortcut hit menu hint
put it tell us to put it so you can have
it in this in the Start menu and the
desktop or just the Start menu and the
default is to just put it in the Start
menu and also in the executable bundler
we support those for service and daemon
bundlers and in the executable we put it
into the the windows services facilities
you can go through through the services
be your Microsoft management console and
and manage remotely even MSI has a
little bit different meta bottlers I'm
met arguments on the description goes in
the MSI metadata and the vendor is the
authors and the MSI metadata when you
right-click on your MSI bundle there's
an extra tab of that and it's also the
publisher in the uninstall screen right
now we don't have a way to get comments
on the uninstall screen I haven't look
in to see if that's a limitation
of Wick syrup that's just something
we're not doing and again as a callback
to the question about dropping resources
you can still provide your own wicks and
you know set up files if you want to do
custom things this is just describing
what the default templates do so if you
provide your own templates things might
be dramatically different and we still
support that with the old format product
version is a specific field unique to
MSI so it's a UUID this is something
that the Installer uses to determine
what version it is and it's it's that
big ugly 32 character string is hex
system-wide for MSI bundlers is true so
by default if you to do an MSI it's
going to install it into Program Files
or Program Files x86 if you're running a
32-bit JDK and this is because when you
run an MSI you typically have admin
privileges windows menu group and
shortcuts are the same and the service
that demon bundler czar again the exact
they behave exactly the same as they do
in the exe bundler
so those are the three windows bundlers
are there any questions about bundling
for Windows we didn't have a special
session for that this year no one's
asking this but I'll go ahead and ask
the question what about the windows 8
App Store Java doesn't support the
windows RT environment and every app
that goes in the Windows app store needs
to support the java the windows RT
environment so it's consequence no we
can't go as an application in the
Windows 8 app store but my understanding
is you can publish URLs input front
pages there to the executable exe is an
MSI is that you might host on your own
site so that's the App Store story for
MSI for for Windows yes
that is a good question for the the
compiler and the core team because a lot
of support for that has to do with with
a deep deep api's deep inside of java
and dealing with things like RT
sometimes won't let you do just in time
compilation so that's that's that's
something that's that they've talked
about maybe they were more concerned
about it before Windows 8 flopped but
now that Windows 8 is flopped there
they're not as concerned they're
tackling other things that's something
that I would suggest you take you ask to
be to the core team and figure out where
they're going on there
I don't know what they're gonna say but
my guess is they're gonna say we're
trying to get module module the modular
JDK at the door before we do that and I
think occasionally they've mentioned
stuff like ahead of time compilation
that they're working on and they don't
know when that's gonna ship you know
what imagine for Windows RT a support
that might be something it might need
but I'm not an expert so again safe
harbor statement don't believe a word I
just said
okay so Linux disk bundlers surprisingly
for the image based bundler there are no
custom there's no custom bundler
arguments we just use all the regular
stuff all the funny customization comes
in in the RPM and the depths now they
share a lot of the same bundler
arguments between these two so I went
ahead and combined the common ones onto
one screen even though we handle them
slightly different under the covers we
do the same thing with it Linux dot
bundle name is a big and an important
one there are some restrictions on the
size of the bundle name and more
importantly there's restrictions to the
character set this is something that I'm
working with st. Petersburg right now if
you specify your app name and Austral ik
alphabet the Linux Debian bundler is
going to blow up and you're going to get
nothing out of it and the reason is the
bundle name has to consist of strictly
Latin letters numbers dashes dots and
the plus sign I think that's what the
limitation is and they're very strict
and enforcing that so this is how you
would deal with that and there's also I
think a size limitation on there as well
I know there is on the on the services
there's a size limitation
so if you want to get a different
bundler name they tend to all be
lowercase and have you know use certain
standard contractions and shortened
words that you wouldn't want to expose
to a user you can put that in the Linux
top bundling bundler argument and make
it look like you need it to look the
next argument is category there are some
Linux desktop specifications that
specifies a certain a number of
categories that you can list and and we
will put it under that category and this
is distinct category is actually the
original parameter that was used for
this and category is what populates the
windows menu group but if you need to
have something that is goes into a
specific Linux category in a different
Windows menu group under windows and a
different value for the Mac App Store
the category you would want to set the
category to be the Linux category and
then deal with Windows and Macintosh
specifically in those cases icon dot PNG
is surprisingly not in the disk based
it's done in the disk based bundler this
is something that keyway actually caught
and it's like yeah I actually did that
right but I looked in to see what's
going on with it the PNG file is
specified in the dot desktop file which
is a linux desktop standard of how they
do it it's not integrated into the disk
image it's integrated into the desktop
file that we copy into a specific place
to add it to your desktop menu or
whether we use xdg it's loaded into your
desktop menu in that format is is
supposed to be PNG that's that's got
some friendly open source isms to it and
some friendly Patton terms that the
Linux community is very happy with
license file is the last one this is the
the license text now the one thing about
the Linux bundler is is this is not a
click-through license you'll see in some
of the other button they're arguments
this often exists merely as a reminder
because what they really care about in
the next land is what kind of a license
you are they just apply the templates
there and if you use a license that
tweaks even one legal term in it a lot
of people just freak out and reject it
because it's not one of the standard
quote/unquote standard licenses with the
standard terms it's got some pluses and
minuses now for the Linux Deb Butler we
support some metadata that is peculiar
to that Linux DEP cares about copyright
so there's a way you specify the
copyright on the description element
that is used is passed into the daemon
init scripts and I've looked through the
code and I believe that's the only place
that is currently used in Debian the
title is the description field that you
would get when you list your packages
typically through DB kgs and your bundle
name and they also use the vendor in the
email and we take your vendor name in
the email address we concatenate that
into the format that they're expecting
to see for a maintainer field so when
you specify these fields for your debian
bundler and you install it you won't get
the pop-up that says this is a
low-quality package don't install it so
now they know who to go to for the bug
reports even if it is null at
example.com they don't care what the
email address is as long as it's there
something you can present to the users
is say here's the maintainer of this
package RPM uses some of the same
metadata but they do a little bit
differently the description goes into
the - into the description field you can
call your RPM packages via qi and then
the name of your bundler description
goes in the description field license
type it goes into the license field and
this is a shortened version of the
license um title it goes into the
summary field and it's also the comments
in your desktop file and finally the
vendor is treated a bit differently in
our PMS and it isn't Debian a lot of
these are between the lot of debian RPM
differences are because well that's just
the way it's always been
there's no good explanation other than
that's the way someone did it at first
and they have no desire to change it so
any questions about Linux bundlers and
that's all the bundlers any questions
about bundler arguments at all alright
alright so let's look forward and see
what's coming in eight update forty this
actually has a jet associated with it a
gem 208 that I'm working on so we're
adding two new bundler arguments in
eight update forty to support Mac CF
thummell version is needed in the App
Store when you submit an update to your
app and this is a machine readable
version of the version field that is
used by the Mac App Store and they have
rules that's got to be incrementing and
this allows you to go in and change it
without having to monkey around with
drop in resources
um the next one is Mac dmg simple and
this is a flag that we added for the dmg
bundler one of the things we found is
that when you run Apple script on a
build system for a Macintosh things tend
to go bad on a fairly unpredictable
basis Apple script tends to expect user
input at certain points and if it
doesn't get it you're out of luck and
this system has to be rebooted so what
we do with the simple dmg is we just
take your app put it in a dmg do no
fancy image do you know fancy renames do
you know fancy icons we just close the
dmg and put it out there so this is
really designed for the the situations
where you're building a bundler on a
build machine and testing it this isn't
what you would do for the production one
you go in and change it for the
production and just babysit the build
system and make sure that it executes
properly on some of the big features
that we've come an eighth update 40 the
big one is we've rewritten the native
launcher unless you've looked at the
code you probably didn't know this but
each of the three launcher is the Linux
the windows of the Macintosh each one
was a separate source file and so as a
consequence each one had their own
separate set of bugs and each one had
their own separate way of doing things
there was three different ways to do it
so Chris Benson went through all this we
completely rewrote it using one set of
C++ files yes it's got yep deaths and if
and F's but that's just par for the
course for writing C++ that's expected
in that area and it keeps the same logic
as much as can be kept between the three
different bottles and bundlers so we're
hoping that this is the sort of thing
that will pay dividends in the future
when we need to do crazy things like use
a different set of J&amp;amp;I calls to start up
a modular JVM I haven't heard of they're
doing that but you know at least we're
prepared if they drop that on us late in
the game default command-line arguments
we support default command-line
arguments you can specify those when you
double click it this interacts nicely
with the next one which is file
associations you can register a file
extension or a mime type when you
install your installer then when you
style your application with the
Installer and it will responds you can
register a dot awesome app extension and
you double click Add awesome map and
it'll bring up your application and say
that hey someone launched this file now
it's you know Windows and Macintosh have
different ways to interact with a java
virtual machine to tell you these things
but now we register it with the native
system and maybe in eight update 60 we
can tackle that normalized entry point
for it we have an API to let you change
the user JVM arguments which is
something I left out of these slides
because it's kind of being being cooked
up but that's the sort of thing where
from your program you can manipulate the
JVM options if you decide you need more
memory if you decide you need a
different compiler argument if you
decide we need to set some other value
if you want to turn on or off debug you
from within the program the next time
you launch it we have a nicer API for
you to do that before you had to do some
interesting things with the Java
preferences API and some names and the
last one this is a small one but this is
gonna make some customers really happy
you can package just the mac GRE with it
right now you need to install the Mac
JDK to install it and we take out a lot
of things from the JDK so it's not
really a data Kay anymore but it still
got some of the footprint of a JDK it
looks like we're shipping more than we
are there so now we support the GRE when
you install just the JRE
directly from from Windows not on
Windows from a Macintosh in update 60 we
haven't really thought about that yet
but there were two features that were
going to be eight update 40 that we've
already pushed out one of those is
rewriting the Windows executable
metadata we just ran out of time because
of the conference they moved up their
deadlines and stuff you know I'll leave
I'll leave the shoptalk out of it but
there's a reason we didn't get to these
that's it's not because we're we're
playing video games all the time we're
actually trying to get this working
really hard to try and get this out the
door the second one is native Java
splash screen support and that one there
was a bigger fish to fry than we thought
when we looked into it we looked at
what's really going on with it there's
there's more to it it seems simple and
so there's really nice magic trick going
on there apparently and finally question
for the audience what do you want to see
any update 60 yes
protocol handler support integrating
with the native OS that one down so if
you have like a feed colon slash slash
you can bring up your podcast viewer
okay I'll throw that on the stack see
how see where that falls out
it's a good one anything else we
forgotten so if you know I've kind of
surprised you with requests here if you
think of what you would like to see
later on there's three principal ways
that we'd like you to interact with us
the mailing list is probably the best
place to interact with a lot of these
open GFX dev is where this project
started it is currently where it lives
and even if it doesn't live there
anymore if it gets moved to its own
project I'll continue to monitor this
and listen to any issues that the people
have had there I know of one external
person who with eight update 20 was able
to publish a swing app to the App Store
a 3d map master so we have an actual
honest-to-goodness swing application in
the Mac App Store that you can download
and use and use his opengl of all things
too so so these things can be done and
he came to the mailing list looking for
help and it helped us find some of the
bugs you know what was going going wrong
with with it on our end bug reporting if
you find bugs or if you have feature
requests the email at the web address
right now is JavaFX Giratina comm
they've been threatening for years to
take us over to JBS and they haven't
executed on that threat yet so as of
this moment right now the correct place
is JavaFX Giratina comm and apparently
i've learned that we have a blog set up
for us on oracle unofficial blog has
been written on sense Egor left but
Chris is found it and he was gonna be
working on getting us access to it so we
could post some of these updates
someplace other than my personal blog
when I've been posting these I don't
have been following in spelling gemenon
calm and by the way spelling is spelled
with one L in that blog that's kind of
the joke so I'll open up the floor if
there's any other questions about
anything that I've talked about we got
five minutes before they're gonna chase
us out of the room I get no one's button
app yep I got I got I got the clicker
right here you know ones taken from you
I also didn't have to follow IBM
okay okay so the question was about a
web start when you're using web start
it'll magic the SS magically handle the
SSL set up for you magically handle the
proxy set it up from the system which
working behind a corporate firewall I
have a deeper appreciation of now that I
did last year right now we don't support
it directly I think we still ship the
deployed jar so you should be able to
get it all your old Web Start stuff
there but as far as I think there is
some some startup flags that we would
need to pass in to get that to work I'll
put that on my feature request list so
that that looks like something that is
worth worth handling right now I know
web starts kind of in flux right now as
well yes oh five minutes yeah okay um
the question was you have five minutes
left
okay the question was is there any
single instant support if you're running
Mac yes because that's the only thing
you get on Mac but we don't have we
don't have that built-in right now and
that's something that would actually
help with our file associations as well
so it's something that we're looking at
we haven't put it on the roadmap yet for
the sort of things we would do I know
jnlp supports it and I'm hoping we can
just directly leverage that service I
don't know how deeply integrated it is
with the backend and how you'll bring it
over to open source land how difficult
that's going to be I don't think it'll
be too difficult I think we just need to
have the security guys give it a Keota
once-over to make sure there's no
glaring bugs then they've been looking
at it enough there can't be any bugs
left though you know we got to do that
okay well I see no reason that keep
going on if there's no more questions
from the audience but again these are
the mailing lists if you if you speak on
there I'm on the mailing list the bugs
go to my mailbox and I'll be I'll be
reading some of the comments on the blog
as soon as we get some of this going on
so well I'd like to thank you for coming
I know it was it was tough walking by
the food on the way back from from the
community keynote where they're playing
with robots and throwing stuff across
the stage and talking is to James
Gosling at the end so I really
appreciate you coming thanks for coming</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>