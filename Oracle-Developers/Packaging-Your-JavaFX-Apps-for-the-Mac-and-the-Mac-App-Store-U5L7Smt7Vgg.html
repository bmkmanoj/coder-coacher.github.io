<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Packaging Your JavaFX Apps for the Mac and the Mac App Store | Coder Coacher - Coaching Coders</title><meta content="Packaging Your JavaFX Apps for the Mac and the Mac App Store - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Packaging Your JavaFX Apps for the Mac and the Mac App Store</b></h2><h5 class="post__date">2015-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/U5L7Smt7Vgg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so I'd like to welcome everyone to I
this session the session is packaging
your Java FX app for the Mac in the Mac
App Store and Tex is more than just Java
FX apps you could pep you could publish
swing apps there's actually an app on
the App Store today
that is a swing app that has been
published with the tools and we're gonna
talk about today so it doesn't matter
what tool kit you're using you can push
it to the Mac App Store my name is Dan o
Ferran I'm working on the Java packager
in the Java client deployment team so I
make the was formerly the JavaFX package
or is now just the Java package err and
I work on getting that and this is David
DeHaven and he is the Mac expert on the
Java client deployment team now we're
Oracle speakers so you get to see this
slide which basically means don't buy
stock don't sign contracts based on
anything we say until it actually ships
they drill that into our heads pretty
well so David so here's our plan we're
going to talk about what you need to do
when you build your application and some
bits about the history about why Mac
apps are the way they are talk a little
bit about polishing your application
then we're going to talk about what it
takes to secure your application and
then what it takes to actually submit it
to the Mac App Store now if you're not
submitting to the Mac App Store that's
optional but there's a lot of you know
tricks and hoops you have to jump
through and finally we'll finish off
talking about some of the things that
jsr 208 is bringing in 8 update 42
support some of the features for
delivering your Macintosh applications
so for first steps one and two I'm gonna
hand the microphone over to Dave
good morning so I'm going to talk about
building or yes building and polishing
your application to probably very
important first steps and we'll start
with building your app so you've got a
few packaging options options and
ultimately everything boils down to the
same thing you have a application bundle
application bundle is basically just a
directory Foles stuff and that stuff to
find your application everything that
ships native with that with on Mac OS 10
uses the standard integrates great with
finder it looks like a single entity
even though it's hiding a bunch of
information in the background
the second packaging method we have is
as a disk image from those of you from
the UNIX world this is similar to an ISO
image it contains basically your
application bundle and generally
shortcut to slash applications for an
easy drag to install feature and the
final option is you can build a pkg file
which uses apples native OS 10 installer
and that allows you to do extra things
during installation like say if you have
a system demon that needs to run or if
you have other things that need to
happen when your application installs or
if you have multiple components that
need to be installed you can throw it
all together in one package so just a
brief history some of this might not be
completely accurate because you know
it's been a long time a long time ago
Apple decided that applications were
getting kind of ugly because you install
a folder somewhere that had everything
in it and after installation you had to
find you had to dig through it and find
the application and run it
smart developers would push everything
under a sub-directory and then arrange
all the icons neatly for you so you
could find it easily but it still wasn't
quite enough so Apple started using a
bit to tell the finder that hey this
this folder is a bundle show it as a
single entity and when you double-click
on it it does something and what what it
does is defined by the contents of the
folder and applications have a specific
folder structure that allowed the finder
to be able launch the application and
Mac os10 they migrated kind of the same
format from the next step which had a
similar standard was what we have now
this is the basic application layout
everything stuffed under contents if you
have a number of folders here you have
the code signature folder which is used
for signing if you have the info.plist
file which is metadata about your
application tells us in name has a bunch
of flags in there tells finder what
version it is the important part for our
discussion is the Java folder all of
your Java jar files and resources will
be embedded here the actual executable
itself is put into a Mac OS folder in
this case it says ensemble a that's a
native application that's built by the
packager itself and then bundled into
the application bubble you don't need to
worry about that but something that we
do ourselves and then the JRE if you're
packaging your application with the JRE
which is highly recommended it ends up
under plugins in this case this was
built against 8u 20 so it has a a
trimmed up image of jku 20 and of course
resources contains standard application
resources in this case just a an icon
set so it looks pretty in the finder
so going back to the Java folder what we
put in there we put the jar files
whatever media assets you need pictures
movies this and especially important if
you're using native libraries say you're
writing a game using the lightweight
Java games library you would put
Paulding all the native lips in there
and you need to if you're building your
own j'ni libraries you you need to be
sure to follow the standard naming
conventions libraries on the Mac or lib
package name dy live and then you load
it using the standard Java j' para load
library method and all your other data
files and basically everything goes in
this directory that your applications
can access through using Java API s we
have a few recommendations bringing on
JVM basically bundle your JRE and your
native app you can use the system JVM
but it's it's dicey if you don't bundle
it and there's no JRE installed on the
system right now under Mavericks little
request Java 6 from Apple which won't
work you need Java 7 or later so it's
kind of is kind of broken if you if the
user doesn't have Java already installed
or if you haven't installed Java 7
so bundling the JRE shield you from that
problem it also prevents you know
incompatibilities from updates also once
you package your application especially
if you're signing it you can't change
the contents so everything you need
should be inside the application package
itself there's other ways to work around
that but not they're not pretty at the
moment
so in the other two formats the disk
image like I said you have the drive to
install method it's just an easy target
to applications that copies everything
over and then the user runs it from
applications the problem with that is it
the way the disk image is created we
have to use app live and calls to finder
and it creates a window as its building
and moves things around and then closes
the window so it kind of takes over your
machine you can't do anything while it's
happening or you risk damaging the the
disk image we have a new feature in was
at 40 yeah called this they were calling
it the simple disk image which doesn't
do that basically just copies the
application package to the dmg so you
know it doesn't you don't have to deal
with this and it works but much better
with continuous integration systems
and then the last is the package
installer which I kinda already went
over it's just basically your wizard
type type installer no yeah and he uses
the Apple install installer so Java Java
package err previously JavaFX packager
first creates the application bundle
then depending on how its configured
will either create dmg file using the
application bundle or the pkg file using
the same application bundle and will
also prepare your application bundle for
Mac App Store distribution which does a
couple of different things from the
normal packaging that will make sure the
application bundle is signed properly
and we'll also remove components that
are that will cause your app the
application to be rejected when you
submit it and we'll go over those in a
minute so now we'll go over polishing
your app to make sure it's you know
Macca fide very pretty this is something
you don't want to see this is a
rejection letter from iTunes Connect
saying that your app is ugly we don't
want it well yeah yeah it's very vague
they don't really give any details about
it and this is something where we're
trying to get you guys to avoid so it's
a it's an ongoing thing
some suggestions use the system menu bar
don't use menu bars on your frames Mac
people don't like that we're very picky
you can kind of get around that by
making a toolbar toolbars are okay as
long as you're you know separate
entities there's a swing there's a
mechanism and swing to do that and Java
effects also is the same thing AWT does
it by default use the correct shortcut
keys don't use ctrl or all Apple once
you do use the command key that's yeah
basically it and there's a way for for
you to do that in swing as well as Java
effects as a shortcut modifier on Java
effects does the right thing depending
on what platform it is you don't have to
do anything platform specific here
please use the Apple menu you can set
the name of your application that shows
up in the Apple menu if it shows up as
what does the java application Stuber
yeah just Java they're not gonna like
that there's there's an about box that
should be implemented quit should work
if you have preferences that should work
too and all this stuff is implementable
using the Coppola uh package it's in
Oracle JDK it's been there since the
beginning you can do a lot of stuff with
that you can respond to you know power
saving events user login logout
application motion you know moving to
foreground background so on
and it also you can you can set it up to
respond to Apple events which is what
happens when you get when you in file
Association what do you when the finder
wouldn't user double clicks on a file it
opens the application that sends an
Apple event to the application which
isn't handled you can set up a hand
order to process that and also you can
use it to set up your app and you know
there's a cheap sheet that we just found
it's very up to date it's just been up
to updated recently recommend you to
look at it and there's a lot of good
information on there here's some details
about it just a few of the api's use
everything boils down to get application
you can set the about handle or
preferences handler quit handler these
are all them to fight now so these are
all things aside yeah yeah yeah you
usually in this one thing we recommend
is changing the quit strategy the
default is the system exit zero close
all windows is more mac savvy so that's
one thing you should consider when when
designing your application this but if
you have multiple window application if
you have just one single window I don't
think it matters and you should if you
have a multiple document application
that doesn't quit when the last windows
closed there could be a case where you
have no one does open at all so you
should install a you should set the menu
bar for that case and and set default
menu bar handles out
icons are a big one you need huge icons
the retina displays the high DPI
displays are all required a lot of
pixels to show a tiny little icon so you
should have at least 5 fell by 4 by 5 12
at 2x version and not this should be a
native image not just you know a 32 by
32 pic good yeah but just blown up to
512 by 512 they won't like that at all
they know and it's it's all set up in
the P list you know you don't have to do
anything in your code itself the at 2x
file support is in Java effects now and
it's also in and JDK so you shouldn't
have to do anything special to support
high DPI images in your application as
of a cute 20 I believe good question
yet so when you would in a previous
slide you showed when it showed the the
structure the app bundle there's a
resources directory we had Ensemble 8
that icns all the icons are embedded in
that single file so it's basically it's
a it's an atlas of of icons it's not a
single item so all all the icons should
be available within that the operating
system will scale it down for you so if
they can't scale up at 32 by 32 right
yeah dude chooses based on the scaling
factor and what what sides you select so
if you have finder set to serve 32 by 32
it's going to show a 32 by 32 or 64 by
64 a high DPI screen here's a big one
don't use deprecated API S which
unfortunately we did as of well now
deprecated API is in 2.2 we we used QT
kit to playback media specifically h.264
and AAC content that's an unfortunate
yeah apple recently deprecated QT kit
and started rejecting app application
submissions because we one of our
libraries had linked ins into QT kitten
QuickTime that framework in 8u 40 we've
added a V Foundation support which is
the replacement from QT kit we've also
moved the QT kit library or code into a
separate libraries so it's easier to
manage to fix that you have to remove in
8u 40 you remove this Lib KFX media to
underscore cutie kitty you I lied
that'll allow you full playback
capabilities you'll get h.264 AAC you
can play Oh
HTTP Live Streaming still because it
uses the avfoundation for that one thing
to note is that media playback on ten
seven seven
yeah ten seven will be limited because
avfoundation is not complete on ten
seven some of the api's we're using our
ten eight and only end up only on 80/20
and earlier in all of JDK 7 you have to
remove Lib GFX media that DUI live
entirely there's and you don't get the
option of media playback on the Mac good
news is Java package or handles is
automatically so if you're building with
eight you forty early access you this
will work for you now
be sure or be careful when using the
aqwal look and feel when you see us Emma
t-shapes there's gonna be some changes
and we're not entirely sure how it's
gonna work out yeah you know Nimbus
works you should be okay with Java
effects AWT swt controls the may or may
not care about just be a be careful look
at your app look over the Apple human
interface guidelines they're posted on
on ADC and be sure that you're you know
at least relatively close I mean I don't
know how closely they look at controls
because it's kind of a mystery so
there are cases you know when you send
your application into the App Store
remember that it's people looking at it
it's not automated process sometimes the
the rejected inappropriately sometimes
they accept it inappropriately and you
know he got lucky so you may if you do
an update in the future and it gets
accepted rejected whereas previously was
accepted you know there could be some
condition in there if it's something
that is in the JDK or Java effects we
would really like to know about it so in
that case please file an issue in jbs or
JavaFX g/r if you have access and with
that we'll move on to securing
okay so build it polish it but this is a
modern operating system those two things
often aren't enough one of the big
things that we're getting is people
finding interesting and new ways to
break applications in fact at JavaOne we
have an entire track dedicated just to
security and one of the more interesting
security texts they have is I'll take an
existing jar and use it in a way it's
not supposed to be used and you find
someone else's bug that's been signed
and shipped that jar around music so
some of the things that Apple is put in
our steps that they've done to make you
secure your application via
cryptographic signatures to make sure
that you can only do certain things and
to make sure that your application has
everything you shipped it with and only
everything that you've shipped it with
so um the biggest thing is that they now
have in in mac sense ten seven or ten
six when did it you want a gatekeeper
come in ten seven so in ten seven they
introduced this new functionality got
called gatekeeper you could sign all of
your apps and if you downloaded an app
from the internet Macintosh would track
this and update some flags in the file
to say hey this came from someone else
so when he tried to launch an app if it
if it saw that didn't have a gatekeeper
signature on it a developer ID it would
come up with a dialog that says well
depending upon how you configure it but
out of the box it comes up with a dialog
that says I'm not gonna launch this
because it came from the internet so the
easiest way to get around that well
there's a couple of ways if you know
what you're doing you can right-click
and launch it anyway and get a different
dialogue or you can go into the system
settings it says turn off gatekeeper let
me run everything but the most the best
thing for you to do is to sign up for
the Mac Developer Program it only cost
one hundred bucks a year and get a
developer ID signing certificate and
then you can sign your applications and
you'll get a different dialogue that
comes up and says hey this application
is from so-and-so
would you like to launch it versus the
dialog that comes up and says hey we
don't know where this came from we won't
let you launch it so this provides some
sort of a ability to get some security
net security into your application to
make sure that has everything that you
shipped and only everything that you
shipped
so the tool at the command line that
they use to do this is called code sign
if you're building your applications by
hand and you you build it in the
application bundle and you there's
there's a lot of steps you got to go
through them there's a slide later on it
will talk about all the various steps
but depending upon the key that you sign
it with you must have a certain
signature to go into the Mac App Store
and there's a another signature that you
would use to get on the desktop so when
you're writing your apps the Mac App
Store is not the only way to get out to
your desktop you can still ship it the
old-fashioned way to let people download
it so a lot of the things we talked
about that Apple would reject that's
only for the Mac App Store but for the
developer ID the getting getting a
signature on it is important
another important thing they've add also
is the notion of application sandboxes
for applications that you ship yourself
you have the option to turn the sandbox
on but for applications that you ship to
the Mac App Store you must put it in the
App sandbox now what does the
application sandbox do that this
application is run and when you turn it
on if you choose to turn it on the big
thing it does is it basically puts it in
its own little zone that has only access
to files that it can read and write and
it creates its own little little world
where the file system looks like it has
everything but only your application or
in your application group but basically
only on your application can see those
files it'll also turn off your network
access by default
turn off your access to Hardware turn
off your access to all other apps and so
just generally thinking if there's
something evil that you could do with it
with an access to an API the sandbox
will turn that off but all is not lost
you can request permission to use those
things you can turn on just about
everything I will not just about
everything but most things that you
would want to use you can turn on with
with application entitlements you still
there something so that's never gonna
let you do you can't go to /tmp when
you're running inside the sandbox and
there's a couple of other you know you
can't format your hard drive you can't
switch to the root user some things that
make sense in a sandbox environment if
you have a power app you're not going to
be able to run in the in the in the
sandbox but with entitlements you can
specifically enumerate the sorts of
features that you want the sandbox
turn on for you now the entitlements is
integrated into the code setting process
when you do a code sign call you pass in
a separate file that says these are my
entitlements these are what I want my
applications to be able to do when you
sign it so it's deeply integrated into
the cryptographic signature and
irrevocable to the signature now to
specify it at the command line just a
laser pointer there's no laser pointer
oh well but if you just pass in the - -
entitlements and you passion passing the
file sampled out entitlements now the
format of an entitlements file is just a
plist which is the good old you know
list of key value key value XML so you
will go through some of the keys and I'm
the next slide but it's not a terribly
complex file in fact if you download
Xcode it'll help you edit it and give
you nice pretty names for all of the
entitlements now for the Java bundler
there's two options that you can do with
the entitlements you can use a process
called drop-in resources so you can
create your entitlements file and put
that file in a certain part of the build
time class path and the Java packager
will just magically pick it up another
option is to use a facility to
introduced in 8 update 20 and that's the
notion of bundler arguments you can pass
in arbitrary arguments to the bundler in
this case the Mac App Store bundler and
you can say that when you pass in the
arc via bundler argument Mac App Store
entitlements you pass a file name that
resolves a build time to the
entitlements file that you want to use
and then the Java packager will find
those entitlements files pick them up
and when it calls code sign it will use
those entitlements files for you so you
can add in your custom entitlements to
say the typical thing so here are some
of the typical Sam sandbox entitlement
keys that you're probably going to want
to use in your java application now to
turn on sandboxing is actually an
entitlement it's kind of an interesting
thing there between your entitlements
file and the first entitlement that
you're going to ask for is to say turn
on the sandbox so that's the base level
thing so it goes down the list it's
gonna see the sandbox and if it hasn't
granted it already it's gonna reject it
but then some of the other useful
entitlement keys that you're gonna want
to use the first two of the big ones are
the network to turn on client and server
the server is is the less frequent one
that's where you would open up a web
server and listen to stuff but if you
want to go out to the Internet and get a
web service you have to request the
combi palasa curity dot network client
entitlement enabling you to open up
sockets and access the internet as a
whole if you don't put that entitlement
in your entitlements list you won't be
able to access the network and you're
just going to get exceptions and
quietness and you're not gonna be able
to find anything another entitlement
that you might need to use in your
application is the access to the printer
printing is generally not permitted
unless you specifically ask for it so
there's you can probably print out a PDF
document if you actually want to go to
someone's printer and print out a
physical page you're gonna have to
request for that entitlement file system
access also you need to be able to ask
for specific entitlements now even when
you asked for these entitlements the
operating systems not going to let you
access just any file on the system there
is no entitlement that says give me full
file system access but what they do have
are many fine-grained entitlements and
I've just listed the top three file
access entitlements that you might need
on the first two are to allow you to go
to a file that the user has requested
via a dialog you know whether you could
write to it or either you could read
from it and I needn't either put a
little caveat on there this is currently
broken in eight update 20 we have a fix
in there for 8 update 40 that is in the
source code that's gonna ship when 8
update 40 ships with open GFX and it has
to do and it's kind of interesting is
how it interacts with the security
system
they make you use the Apple file
selector dialog for the sandbox to work
and we were using our own custom one so
we had to go back and change it to use
the window file dialog and the operating
system intercepts the user requests and
says this is a file that the user
specifically pointed to and asked to
access to so when you grant these a user
selected read/write and user selected
read-only entitlements
then your file can access those because
the operating system has intercepted the
call has noted which file it's going to
let you have access to and it's going to
let you do it the other one is access to
the Downloads directory lot allows you
read/write access to the Downloads
directory and there's a whole slew of
the users ones to let you get readwrite
access to the documents directory
readwrite access to the pictures
directory rewrite access to the the
videos directory so all those special
Macintosh folders that they have you can
get to those specific ones but what
there is not is there is not an
entitlement that says give me full file
system access to everything which is
unfortunately source tree which is a
great get and see via get and mercurial
front-end provided by Atlassian they
used to be in the Mac App Store but they
had to take it out because they cannot
live with that entitlement that limits
them to certain files to access and
there's a lot of other file access that
Java really doesn't plan to you know if
you want access to Bluetooth through USB
you have to access those so if you're
doing those through native codes you'll
also need those entitlements but these I
think are the top probably six
entitlements that will cover 95% of all
Java and Java FX applications out there
so there's a couple more quirks about
the the sandbox container like I
mentioned you run in a custom own little
file system that is not your typical
home user directory and some of these
things leak through into a way that you
can see it in the java application the
first the most important thing you're
gonna see is that the home directory is
set to some bizarre directory location
you know users dafair and library
containers my awesome app and it's gonna
put all of your file access that you're
going to read and write there and that's
your home directory you can write
configuration files you can write
temporary files there you can read files
from there because it's within there but
it limits you access to things outside
of there to access and there's other
global access to file systems that you
could try and read but what that
operating system actually does is it
kind of shadows a lot of the file
so if you have to change stuff outside
of the container if it's gonna let you
do it if it's ever gonna let you do it
it's gonna do in such a way that only
your container will ever see those
changes so that they really put you in
your own world inside of these
containers but probably one of the
biggest things that you'll notice is
that there is no access to /tmp so if
you need a temporary file access you
should use a Java n io create temporary
directory API so that's our
recommendation there if you need truly
temporary files is to use the Java IO
Java neo files create temporary
directory or create temporary file
underneath the covers for those app for
those calls they actually go through the
proper Apple API is that permit it to
create the files that it needs in the
correct place and when it says temporary
files it's really temporary files you
reboot the system those files are gone
in fact sometimes you don't even need to
reboot the system if it's just inactive
for long enough it might decide that
needs more disk space interview those
temporary files if your application
isn't running so let's talk a little bit
about the different signing identities
so once you log into the Mac Developer
Program they're going to issue you a
couple of about four different keys and
there's really three use cases where you
want to use the keys and really to two
ways you're going to use them you're
going to be passed into the developer ID
application in a developer ID installer
key and you would use these keys to
either sign the dot pkg installer that
you create for your application or the
dot a PP file now you only need one of
these to get past gatekeeper although if
you use the java package or it's gonna
sign both of them and that'll let you go
through but as long as either the signed
pkg or the signed a PP either one of
those will let gate keeper go through
and give you the happier dialog when
they launch when they download it from
the internet now the other two keys you
have to use together leave third-party
Mac developer application and the
third-party Mac developer installer
these keys are used to sign the dot app
file that you're creating for the Mac
App Store and the dot pkg file that
you're submitting to the Mac App Store
that contains your app so you need to
use both of these keys to sign your
application when you're submitting it to
the Mac apps
door now the Java packager pays
attention to the conventions Apple has a
specific way that they name these keys
it is reliable and so in the Java
packager when we're creating and
packaging a PP or a dot pkg or we're
creating for the Mac App Store if you
don't specify a specific user signing
key we're gonna we're gonna look and see
if you have these signing keys that have
the proper pattern so if you want to
sign your application with a Java
package or all you need to do is
download your keys from the Mac
developer site and then just run package
or the Java package or we'll find the
keys for you and sign it for you so it's
it's really transparent and really easy
so make security just you know really
simple to get a proper signature on your
app if you follow the follow the happy
path and really that's a lot of what
I've discovered with getting stuff in
the Mac App Store if you follow the
happy path that's really easy the easy
path that Apple gives you if you go off
the beaten path you be prepared for
difficulty and rejection and and you
know it's it can be done but it's a lot
easier just to stick to the path and I
think that's just the way Apple likes it
they want you to follow the written way
now when it comes to signing your
application it's it's it's it's quite an
involved process and what I've found is
that you have to sign a lot of things
and you have to sign them in a
particular order the first thing you
need to do is you need to sign all of
your jars all of your dynamic libraries
and all of your executables that are
inside the application except for
application for executables that are in
the /contents slash Mac OS part of the
application but if you have executables
and this this really gets you inside of
the JRE there's some executables we have
in the JRE to help with some of the the
WebKit stuff that we're doing there's a
lot of deal of dynamic libraries in the
GRE to do the things that we're doing
with the media and with the WebKit and
with a lot of the high-end features so
you need a sign every single one of
those now one of the things that Java
packager does is it signs all those
there's a special entitlement called
inherit and what the inherit entitlement
does is it says whoever's calling me
inherit all of their entitlements so
everything when Java package goes
through knows assigning it signs them
with inherit so it's going to have the
same
missions that she would give the parent
packager there's really very few
instances where you wouldn't want to do
that so that's why we go ahead and do
that no they're really corner cases and
they're really designed for hardware
interaction where you wouldn't want to
do some of those things so the second
thing that you need to do after you sign
all of your jars dynamic libraries and
executables is you need to sign
everything that's in plugins and
frameworks and if you're writing your
typical Java FX application there's only
going to be one plug-in and that's gonna
be the JDK and it's gonna live in
content plugins JDK name and when again
when the Java package are signs this it
signs it with the inherent permissions
now it's important to note that you're
signing the directory that contains the
Java runtime environment not the entire
files within it again with the packaging
format that Macintosh uses the directory
itself is the unit that is being secured
and once you've signed all of the jars
once you signed all the plugins and the
frameworks then then and only then can
you finally sign the application because
it's going to sign it you know you point
it again at the application directory
because that's the unit you're signing
you would sign it with the with the
sandbox permissions that you intend for
it to have at that point and you sign it
with the proper key and and the reason
you need to do this last is because it's
signing it the application and context
of all the other signatures that are
child to it so if you sign your
application first and they need go in
and sign the jars the hashes are all
wrong and and it won't even let you try
and run it inside of Mac at least the
few times I've tried it was really
cranky to get you to run in the first
place you had to go through and remove
the signatures before we let you try and
run it so when there's a corrupt
signature it really gets cranky so if
you sign it in this order with the
proper proper things you can get through
gatekeeper and you can get into the Mac
App Store but again the Java packager it
just does all of this for you
automatically so if you don't want to do
it by hand you don't have to just let
the Java package or do the tasks for you
now that you have built it polished it
and secured it now it's time for the
real show you submit the application and
it's you know just more more hoop
jumping we can't automate these steps if
we could automate the submission of your
application wait what but you can't in
fact just last week I had to go through
and get new pictures for my slide
because they change the process visual
yet again but it's really just you
create an iTunes Connect profile for
your application describe some stuff
about it and then there's a separate
program that comes with iTunes called
the application loader you put in the
application loader you upload it and
then you wait you wait for them to
review of it so here's the first screen
you would log in to iTunes Connect and
here's some of the typical metadata that
they're gonna ask you about before you
even upload your pkg file they're gonna
want to know what the name it is you
know what the bundle ID know the skewed
that there is entirely for your
reference it's not for anyone else I
really don't know why they're putting it
in there but the Abunda like these that
you're specifying and you info.plist
need to match up between what is on
iTunes Connect and what is in your
bundler now at this point once you've
given this much application you can
submit some screenshots to the to the
Mac App Store and they need to be one to
five of these the I put in this this
very technical thing it needs to be 72
dpi RGB flattened at no transparency and
really what that means is you either
really need to know how to use GIMP to
make a PNG or you need to have get made
a make a JPEG so that you know the
people your graphics artists who are
going to get the pictures for this this
is stuff that they're going to totally
understand and you know they just it's
like a second language to them but the
shortest answer the one that I've had
the most success with is just export a
PNG because pngs can't support
transparency that there's only one color
space and you need a software that you
can get for free for piant for a JPEG
the DPI's are set up fine they also want
a 16 by 10 aspect ratio and that
amazingly enough is the aspect ratio of
your typical Macintosh laptop so they
really wanted to fit on the screen in
fact
the recommendations is just to clear
everything off of your desktop get your
application have a nice standard
background at the menu bar and just take
a picture of the entire screen and you
don't have to do any clipping or
cropping or anything it's okay if the
desktop is showing you the pictures as
long as it's just your application but
if you've got a chat thing in the
background that's going to present
problems but if you just have the wave
or the picture of Yosemite or the
picture of the mountain lion or the
space where the star is one of the
standard desktops Apple is gonna be fine
with that and they'll accept these
pictures and they also need to be in one
of the typical screen monitor sizes and
these correspond to basically a 11 inch
MacBook Air a 13 inch MacBook Air and
one of the Retina display sizes so
that's you know what those pixels come
down to as far as to the size now once
you get the screenshots loaded into
iTunes Connect then you can launch the
application loader and this is the
launch screen and what you're going to
want to do is you're going to want to
highlight deliver your app and then go
to the bottom right and click Choose you
know the good old UI go to the bottom
right to do your action it's it's kind
of confusing at first again I think they
changed this with the most recent update
of Xcode but that's that's another thing
yes
the question was does this run on a non
Mac computer can you run it from Windows
or Linux and the answer is no you have
to you can't even sign it on Windows and
Linux and you know what that's something
I forgot to mention for the security
I'll go ahead and mention it now when
you do your signatures you have to sign
on a version of Mavericks or a version
of Yosemite because starting with the
next up actually the version of
Mavericks that starts rejecting has
already shipped out with with Yosemite
if you sign with running a mountain lion
or lion it creates a version 1 signature
and the gatekeepers gonna reject that
and the App Store rejects that's they
need a version 2 signature I'm sure
somebody found some way to break into
some lab somewhere and because they're
just quietly publishing it
there's no exploit in the wild but it's
something that they're they're doing to
make sure that that you can only do it
so yeah you have to do this application
loader you have to do it on a Macintosh
you have to sign your application on a
Macintosh you have to build it that's it
that's a very good question and then the
bad news is yes you have to have a Mac
to do these things now it could be a Mac
Mini you could go get it all to use Mac
Mini as long as it supports mavericks
operating system or newer söze
application loader as I mentioned is a
native app that comes with Xcode and
runs on a Mac you would you'd click on
the choose button to start it and you
would pick your application and this is
some of the metadata that you would get
after you choose a specific application
that you're loading if it matches up
with an iTunes connect profile then you
push the next button and you get some
nice you know barbershop whole thing
going on as it uploads it and because
your Mac your your java application is
gonna be pretty large you're gonna have
to ship the entire JRE at least for JDK
8 it's gonna be north of 50 megabytes so
it's going to take a while to load up
into the App Store and probably one of
the downsides is there is there's some
automatic static API analysis that they
do they're gonna tell you that they
couldn't do because your app was too big
don't worry you'll be fine as long as
you don't have QuickTime we already
mentioned that the package will removing
you can't ship with
that so once you uploaded get the barber
pole you might get the note that notice
about the static API can't be run you'll
get this notification but you're not
done so once you've loaded it with the
loader you need to go back into iTunes
Connect and need to answer three more
questions that I have no doubt the
lawyers made them put in are you
exporting cryptography do you have
rights to the content are using
advertising is the big things that they
want to know there's other things that
might apply to export but what they're
really asking about is are using high
grade cryptography and I think it's like
some ridiculous number of bits now to
apply if here if you're not a
cryptography application if that's not
the point of what you're doing the
answers of this is probably no again I'm
not a lawyer you know seek your own
legal advice on this if you get this
wrong you could be sent to jail just not
to scare you anything but the other
important thing is the content rights
you're asserting that you have the
rights to the content in there I'm
actually had an app rejected once
because I had a picture of a Bitcoin and
one of the icons and one of the
reviewers thought that that was
copyrighted and it's not copywriting and
you know it's the example of the
reviewers getting it wrong sometimes so
once you submit these questions you wait
I mean your response takes about three
to seven days
I actually I probably should have said
seven to ten it was it was three a while
ago it's up to seven to ten today
rejections tend to be quicker now as a
side note what I was hoping to be able
to announce today was that ensemble aid
I put it on the App Store well about
five minutes before this application
went live they finally started reviewing
it I submitted it seven days ago so you
know it's interviewing and I don't know
if they're gonna reject it or upset it
accept it now it's taking them an hour
so that's usually a good sign that
they're going to accept it because when
they reject it they usually find the
first reason to reject it and then move
on
all my rejections have come in within
five minutes of going into review so
this one is taking them about an hour so
far so things go well but again you know
it could still come back rejected yes
yes the question was is it one of those
do you submit it and then get rejected
and submitted again and get rejected for
a different reason and submitted and get
rejected again for yet another reason
yes that's that sometimes what happens
if the reviewers are under pressure
they'll just find one rejection and then
they feel that they're done if you get a
good reviewer they'll list multiple
reasons but one rejection is enough and
if they're under pressure so that's why
I have this last tip on here is that
don't make marketing plans until the
AppStore has actually accepted it
because this this can just be a little
Rolling Thunder effect you know you
think you're done you submitted to the
App Store the rejection rejection
rejection rejection next thing you know
it's three months past when you thought
you were going to ship it and I've seen
companies they were trying to get stuff
on the App Store that three months into
this process I said you know what we're
just not going to do the App Store so
it's it's one of those things that you
need to make sure that Apple is happy
and comfortable with it before you make
your barking announcements that hey
we're releasing in the fourth quarter of
this year so so the last thing I'm going
to talk about is a couple of GSR two oh
eight and eight update for any changes
there to come in that are going to help
you with this the big thing we've
mentioned we're gonna have JavaFX media
support in the App Store
you have it if your gatekeeper but now
with the a/v foundation you can do it in
the App Store and also the JavaFX open
file dialog is gonna work with the
sandbox now now if you're adventurous if
you're really adventurous you could
download the open GFX it's GPL code you
can compile it you can put the jars in
there again consult your lawyers because
it's GPL you never know but there's
something that I've done is I've
downloaded the open-source version of it
and compiled it myself and put it in do
not just download an Oracle early-access
you don't have license to redistribute
that but the open source stuff it's open
source you just restrictions on what you
can call Java and what you can't call
Java some of the other features we're
adding file Association hooks so you can
double click on your dot whatever
extension it'll launch your app we're
adding default command line arguments
this you know is mostly there to support
the file associations so you can have a
canary so you know when you're launching
a file Association or not
on Mac you can bundle the GRE instead of
the JDK and there are some people that's
really a big legal question for them why
do I have to ship the jdk and why do
they have to strip all this stuff out
well now you can ship just the GRE that
could get you can download and put in
your Safari we're also adding an API for
easy user JVM options there was a
feature added in 7 update 40 I think
where you can through the Preferences
API add certain certain JVM options now
you could play with your memory you
could add hotspot flag as if you know
there's a hotspot bug and you could do
this inside of your program to adjust it
it was kind of clunky kind of hard to
use so we created a really easy API
that'll hide all the ugliness and all
that the crazy stuff for this so go into
questions but first I want to point out
the mailing lists the bug reports and a
blog that we're going to start updating
here the best two mailing lists to ask
questions about packager and mac issues
are the open GFX at dev list at OpenJDK
java.net and there is a email address to
get a link to subscribe to that and also
has some archival stuff you can look at
the old west old ones and if you have
Macintosh specific questions Mac OS port
dev is also a good mailing list to talk
to I personally am on both of those
mailing lists and I attention to when we
see packaged are related or absent or
related bugs now as far as bug reporting
there's also two bug things if it's
about packager in general JavaFX
Giratina comm is the place to submit it
to but if it's about mac in general bugs
open JDK java.net and the second one is
the one that we call jbs java bug system
assess URL to go there and this last one
is a blog that chris discovered that we
had and it will be updating as a team to
do some more stuff in deployment so I
open up the floor to questions if you
have any questions now
yes
have I ever personally posted a Java app
and made money on it I haven't made
money on it because I'm not charging for
it but I've personally pushed a Java app
using the packager onto the App Store
with this it's it's a follow the Bitcoin
it's a Bitcoin app or you can trace the
transactions it's really it's
entertaining if you're really in a
Bitcoin really boring if you know
nothing about it but I've also seen a
swing app Java 3d map master I was
trying to get the link for it before the
talk but apparently the App Store is
down but yeah there's there's a swing
store that has been pushed on to the
this the Mac App Store as well using the
packager so not just it can be done it
has been done so i think and i'll there
the question is does the calm apple
Yacht stuff still work with JavaFX
and the answer is yes none of that stuff
is going with the graphics stack it's
all interacting with the native menu and
some of the native facilities so it's
it's it's really orthogonal to the stuff
JavaFX is doing so yes it works
comes with the jdk so
the question is does JavaFX 3d work
actually I haven't tried it but I'd know
of no reason why I would fail the
binaries are all there
so if Apple didn't like it they would
have rejected all the other apps yes the
question is can you use a swing file
chooser and get it through sandbox I
haven't tried it but I believe the
answer is gonna be no because if you're
going to be leaving anything but your
container you're gonna run into problems
so if you're using swing I would
recommend you use the AWT file chooser
which goes straight through and it's
it's kind of ugly it's not very swing
ish but you get the Sheep pulldown and
the big thing is it's how it interacts
with the entitlements so if you're gonna
use the swing file to xur I would
recommend just signing it with developer
ID and disturbing you on your own that's
that's the best solution for fidelity in
that regard yes the question is can you
use alternative jvm languages such as
Scala and Ruby and the answer to that is
yes if it compiles down to a jar file I
don't care what it is and I'll accept it
and it'll compile it down if it compiles
down to if it uses the JVM great let's
use it yes
the question is the windows marketplace
I think it's the Windows 8 app store or
the Windows 8 Store and the answer there
is no the reason is to get on the
Windows 8 app store you have to use a
subset or a new subset of the windows
API called WinRT at least that was the
case when Windows 8 first shipped and
you know Windows is doing throw outs of
convulsions right now but the existing
Windows 8 app store you have to use the
windows 8 the windows RT api's because
they want to make sure that whatever you
run on your Intel Windows 8 tablets also
runs on your arm Windows RT tablets so
so we don't run on it right now back on
windows back before Windows 8 flopped it
was on the possibilities list but now
that Windows 8 has flopped making Java
work on Windows RT really isn't a
priority right now however if you think
it should be tell your Oracle
representative tell p.m. let them know
because feedback from the community is
important for us to help us prioritize
these things but again I don't speak for
product management yes
yes so the question no okay so so the
question was you know don't bank on it
being out and there was some button on
there relating to developer release so
so when you submit your application you
can either say submit it when it's
approved or there's another button
develop and release and what they're
gonna do is when they review and they
accept it if it's release one accepted
they're just gonna release it but if you
had that second one done they'll approve
it and they'll just let it sit in the
store until you push another button that
says released so if you know if I had
been on the ball and I had started doing
this job a package or stuff a month ago
I could have gone through the the
process that developer release wait for
it to go out and then they would have
approved it three weeks ago and then you
know I could have just waited for them
to release it and then I could just on
stage here push and say hey look it's on
that Mac App Store now but you know
because I was you know trying to get
stuff finished Freight update 40 I
didn't get it done a month ago so yeah
that's that's how that would work
oh one more question does the question
is this Oracle have a scheduled release
date for 8 update 40 so there's there's
this be communicated on the mailing list
that that's probably gonna be March ish
again that depends on you know bugs is
slipping the the X 20 release is 20 40
60 are the ones that I think are more
subject to slippage although I haven't
seen them slip yet then the weather
called the cumulative patch update
releases the fives the 11s the 2530 ones
or 35 s those the CPU patches the
security patch is the ones that adjust
the baseline go on a fixed schedule a
very fixed schedule it's like the every
three months on the Wednesday closest to
the 15th and if the 15th is on a Sunday
it's the following it's you can find the
pages describes it it's very mechanical
it's very pretty
to bowl it will ship on this day
something will ship on this day to
address patches so that's that's the
most reliable ones if you're looking for
a heart and day but as far as eight
update 40 March is what the target is
again safe harbor statement yes
the question is have we ever tried
uploading music or a book that's not
something I've personally done is have
you done that David now it's yeah they
got a whole ecosystem built around this
Mac stuff and I'm just an app guy
alright well if there's no more
questions if you have questions later
you can find David or I I'll be on the
show floor here at about one two three
I'm gonna be Manning one of the booths
the TE booth so you could come by and
ask me questions if you have any
questions about any of this stuff but
again we have mailing lists I'm on them
I listen to them it you know even if I'm
hearing about problems it makes me happy
that people are coming with problems and
they want them solved so so don't feel
like you're gonna be a total down or
almost less listening everything that's
wrong with it that's that's broken that
helps us figure out what we need to
prioritize and if you know if you have
you have happy things I say I want to
hear about them too so don't just come
with problems alright thanks for coming</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>