<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Code-Level Security Games and Puzzles in Java | Coder Coacher - Coaching Coders</title><meta content="Code-Level Security Games and Puzzles in Java - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Code-Level Security Games and Puzzles in Java</b></h2><h5 class="post__date">2015-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Wna3Cy83u9Q" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so my name is Brenton I work currently
for Oracle I've been with Oracle for 15
years that's not to say I'm an
institutionalized man I tried to leave
twice and both the startups that I
joined got acquired one of them within a
month of me leaving Oracle which just
means I lost a bunch of invested shares
in the company so you know that's life I
actually work in the my I'm a developer
I'm a developer I don't go around giving
presentations I'm not very good at it
I'm really shy of people and I'm an
introvert in that respect I work in the
communications division Oracle so I and
I write primarily
nice I write primarily in Java I'm a
enormous Java fan I know there's a lot
of new new technologies I mean we're
moving beyond in some in some new spaces
even in the coding or paradigms the way
we think about code but I'm still a big
big Java fan
the reason I loved Java originally is
actually its libraries and that it came
with networking and graphics and whereas
at the time C and C++ weren't weren't
doing so good at that you had to go find
those libraries and there were popular
ones but anyway that's why I like Java
and I'm sure you all have reasons why
you like Java okay
the communications division we write
software that that does all sorts of
aspects with communication so our
software at Oracle that we sell to
enterprise grade telcos enables people
enables you to make phone calls okay
every everything that leaves your cell
phone
crosses either Oracle software or
hardware in this country today so every
call it goes across our systems to that
around the world it's a lot but it but
it's not everywhere so our software also
enables us to charge you for those calls
so we do the billing side too so we
enable communications but we also make
you pay for it so that's a little bit
about what I do first of all we do have
a lot of people in here but I still like
again I like the intimacy I like the
interaction and we're going to be doing
some puzzles together so I guess I need
to warm up the room let me get somebody
talking see so I'm kind of caged I
really this was supposed to be sort of
the Java lounge style lecture I was
going to
commit amidst you and touch you on the
shoulder and and talk to you about your
families but they they've trapped me by
these speakers through the principles of
feedback so I can't actually do that but
let me see here somebody that will make
eye contact with me this guy right here
right there would it bother you if the
guy in front of you like me out like a
cat like what would you do how would you
feel about that you tap him on the show
so how does a cat go yeah meow okay now
that there's people from different parts
of the world that speak primarily
different languages does there's a cat
say something else somewhere else like
in your in your tongue does a cat say
something else besides me out
nowhere else all around the world in all
the languages reppin this room a cat
says meow yeah right there this is what
me you mean okay what about a dog what's
a dog say ruff bark okay what about a
rooster what does a rooster say in
English
cockadoodledoo anywhere else in the
world to say something else
hue-hue what is that and Hebrew
wonderful okay so now you're not afraid
of talking everybody I got some people
in the front said some things to me and
we said ridiculous things so now you can
talk okay right nobody's afraid to talk
okay
let's uh let's dive in a little bit give
you some context okay so this is my
colleague first we're gonna get to some
puzzles but I first want to talk a
little bit about about security and and
a certain mindset okay this is my
colleague Nikolai
he works in Romania and I asked him to
fix this problem I said you have a hole
in your shirt and so he sent me some
pictures back from Romania of how he
solved this problem hmm
what am I gonna do uh-huh ah sharpie pen
okay so that's the first principle okay
when we approached when we're
approaching these puzzles and this is
the the kind of mindset you bring to
code level security in any language
including Java is a change of
perspective right you're looking for
holes and then you're looking for
inverses okay let's look at another
another principle of thinking mule
earlier which line which line is bigger
I here both the same okay right so if
this was a Mueller Mueller Mueller leer
diagram then you would all be correct
but actually a is bigger I deliberately
made it bigger
okay and that's the second principle
right I mean obviously that's that's a
trick right I did that on purpose
knowing that a lot of people would say
you know they've seen the puzzle before
they're familiar with the puzzle that
it's there from there that it's a trick
so I turned it around right and that's
the second principle okay is you can't
get yourself in a you you can't put
yourself in a certain mindset you have
to you have to sometimes take a step
back and refresh okay and hackers apply
both these principles all the time to
get at our systems right they look for
the they look for the inverse and they
look for the place that nobody else is
looking in the way they're looking at it
they use things for the wrong thing all
right
okay so very good so now I'm going to
talk a little bit about what I want you
to take back and then we're going to do
some puzzles okay the puzzles themselves
are just three or four puzzles depending
on we have time for that our
representative right I wouldn't expect
you to come in here I don't want you to
leave saying oh I saw that puzzle now I
know that security principle I know that
coding principle and I can apply it now
I want you to I want you to understand
them more broadly
okay so we'll have fun with the puzzles
I hope but we don't have to but the
point is not not the answers to these
puzzles okay a little bit of philosophy
here about what I hope we can carry out
so so as somebody in your development
who's whose development here like Who am
I talking to okay what else have we got
in here okay I mean we got product
management we got what we do have cats
that's true one of the problems being a
developer in the security space and this
is my reflection so if you guys have
things to add I want you to add it it
being being in dev with it with if you
have a security I mean maybe okay let me
ask you another question who's
responsible for security in their day to
day coding activities like you've been
assigned like your security guy okay
actually not as many as I thought Nets
that's good that's good because because
I wasn't either all right but I think
everybody in this room can and should be
bringing security conscious we all know
what the world is like now how many how
many times have your credit cards have
you gotten a call that your credit card
has some unusual charges from your
credit card company got it reissued
another card who said that happen who
said that happen in the last year who's
had I happen to have more than once in
the last year yeah so our systems our
computers are playing a larger role in
society
but at the same time we're seeing a lot
more of these hacks so I mean just this
last week I mean it I was supposed to be
preparing for this and instead I was
dealing with shell shock in my company
and trying to try to get my the team's
the products that I have helped oversee
which are 60 of them I have to get them
all to make a statement about about that
right so when you bring a security
consciousness or security mindedness to
your work especially those that that
that's not their primary role it's it's
hard right that can be a very lonely job
and the reason is because you're having
to constantly make decision between
what's the right thing to do and what's
the pragmatic thing to do
who knows what I mean what do I mean by
that what does the pragmatic thing to do
tell me yes right right okay so he named
he said performance issues so sometimes
you're in some code and you're like okay
the right thing to do is chest check
that that session is valid at this point
every time great but but if I do that
that's going to incur a cost in code
okay that's a good that's that's good
somebody said easiest easiest why do you
say that yes right development cost
right you mean easiest because I really
want to make this code I want to harden
this code but I just it's just expensive
yeah
any other ideas deadlines yeah deadlines
again the pragmatism okay so it can be a
lonely job if you're especially if
you're like the assigned security guy
okay you're also torn between loyalties
right all developers of torn between
loyalties but especially like when you
come to security you've got you've got
management okay you that you've got to
convince along those lines you
colleagues that may just think you know
they've got other concerns and they
think it's foolish what you're doing
you've got customers that don't want
slow systems right I don't want the
security in the way okay
and sometimes yourself you're having to
convince yourself that these are
problems so the answer the answer to
that is cultivate a culture of security
around you push that out okay and that's
what we're gonna see hopefully a little
bit later as we as we hit the puzzle so
I'm going to show you some some ways to
do that okay some ideas some ways you
can come they look at cultivate a a
culture of security in your organization
around you circulate stories right
you should get newspaper articles or
news articles online that are about
security pass them around you know just
let people know what's going on in in in
our field of study and also in the in
the public at large find classes so I've
had I've had our team I found there was
a lock-picking class that was occurring
at a community college we all want to
take the lock-picking class together
okay that's an example also community
colleges or may have you know security
courses or security certification
classes see if you can get get a crew to
it you know well it's okay for the next
two months we're gonna roll in this
class and take it together okay
what clubs within your organization you
know just say hey we're gonna we're
gonna work through this book over the
course of five months and we'll just
take an hour 30 minutes once a week and
meet together and talk about what we
read okay all right another problem any
other ideas join an open open-source
project and I assume you mean help out
look at take the security aspect of it
and be involved there yeah
that's a great idea
it's very good okay another problem the
second problem tonight that I see we
have is um well security issues are
tricky and often very subtle okay it's a
cat and mouse ok security is a cat and
mouse okay if anybody tells you they
have a solution for security or new
tools or new techniques they're kidding
themselves that it's going to solve
security as a problem okay and the
reason I say that is if you think about
like security throughout history and you
think of like the medieval times right
so at first you know the castles or the
communities would build walls and then
somebody invented a ram to break through
the walls okay so they had a breach of
security well first first they had
nothing and then they were getting
attacked so what did they do well we
need security it would build a wall okay
and then the other guy the enemy said
okay well I'm gonna invent something
that pushes through your wall okay so
then what do they do next yeah yeah moat
so they said okay I'll tell you what
we'll build a big you know ditch with
water in it around and put a dragon at
least that's what they put on the
pictures and then what it then what did
the what did the enemy do in response
yeah catapult okay so you can see this
goes on forever and ever right so for
every security so so for every
vulnerable domain
there's a security hack and for every
security hack you know there's another
way through the hack or around the hack
and for every so on and so forth
odd infinitum so what's the answer to
these security issues being tricky and
subtle so the answer is to refine your
is to refine your security judgment as
an individual and as a team right this
is very very similar to cultivating a
culture of security okay some ideas
things you can do their practice
fine code that's vulnerable or when you
read articles about things a guy hacked
really try to understand what happened
right get math textbook learn how
encryption works right and stick with it
even through the tough math okay you're
just helping yourself another great one
and I might wait to the end to talk
about this one but there are some great
books that are essentially just catalogs
of security standards I know some
authors of an excellent one that I like
to cozy up with in front of the fire or
in this room I've seen them and I'm
gonna introduce them later
but I just grabbed one and usually
they're you know there's their short
descriptions of security standards in
code just open a chapter and cozy up
with your cat which says Mau Mau Mau or
whatever it's and hot cocoa and and read
through a couple of pages of that
another thing we do and my organization
is we have freaky Fridays does anybody
know what Freaky Friday is what is it
what is Freaky Friday I mean it's a
Lindsay Lohan movie yeah no we don't
know yes it is okay Freaky Friday is
actually means it's it's a Friday that
falls on a 13th of a month so it's
Friday 13th and usually there's three
three or so of those a year so not very
often and what we do is we meet on those
Friday routines and that that morning I
schedule and we go through some of these
puzzles with my team and it kind of
becomes so it's not have to be very
frequent but it but it keeps them
remembering like oh I need you know I
want to practice security I want to
think about security I wanna read
security mindedness to my daily work
okay and it's fun alright
so let's not just take my word for it I
just want to walk through a couple of
quotes to bolster that cultivating a
culture of security
mark van doren professor at Columbia
does anybody know Mark van Doorn has
ever heard of him he's dead
that's how I categorized the world
people that are alive and people are not
alive you might have heard of quiz show
the quiz show scandals of the 1950's
where they were showing this quiz show
21 and they were cheating they were
giving the contestants the answers what
why were they doing that
does anybody know ratings but why why
did that why does why does giving the
contestants the answer so they get the
answers right why did that bolster
ratings yeah people like to watch people
win money great and and so rather than
just make the questions easier they went
ahead and had them cheat anyway the
person that blew that wide open he got a
touch of honesty was Charles Van Doren
who was also professor at Columbia dead
that's his father so that's just an
interesting trivia TED tidbit um anyway
so he says if you want to be a knight
act like a knight what could it why
don't I put that up there what could
that mean with respect to cultivating a
culture of security to Ford 1 to the
side
chess moves yes
that's good a knight reference yes I
like it a riddle wrapped in an enigma
wrapped in a puzzle wrapped in a game
wrapped in my anxieties of giving this
presentation okay right that's not
that's good I like that answer it just
means it's security is a journey I truly
believe that and and you just you're
never gonna be an expert anybody it says
they're a security expert I found that
they don't really I don't know that they
don't know what they don't know
yes that's a good way to put that you
should write a book okay let's look at
another one here so that's that's one
philosophical thing I want you to carry
with you I want I want to embolden you I
want you to leave here once you go out
thing I'm gonna find small ways to you
know start on my journey towards
bringing security mindfulness and a
culture to the code all right
mindfulness dakota right and a culture
around me
dawson Tingler professor at stanford
university he's awesome
I don't know if he's still professor
there but he's great great engineering
professor most of software engineering
is bulk blue I don't know if and what
that is another language is that it
sounds different our religion is finding
serious bugs and that's the second thing
I want you to bring as you start on your
journey to security security mindfulness
and a culture of security is don't
there's two parts of security there's
there's there's the the wonks that like
to find the bugs and like to find the
code level bugs and there's the and
there's this and I like to solve
security problems and design systems
that are secure or have some security
then there's this there's this
compliance side okay there's these
checklists okay that tell you what to
look for
there's these principles you're supposed
to be able to apply there's codes
scanners that will look at static codes
that code analysis now there's you know
there's gonna be some trouble here
that's that's all dandy stuff that's
good stuff I use it a lot but don't
forget don't don't get lost in the
compliance in the checklists okay don't
start looking at that way or you're
gonna suffer the problems we saw with
the hole in the shirt or the muller-lyer
right good to you start forgetting that
there are there are new and interesting
twists and your mind will you'll you'll
dull your your your mind will get dull
and you'll your journey will stop okay
and last I had to throw in something
magnanimous because that's you know
that's that's rule and a bibliography
and any good academic paper is you know
a list of people and then at the end of
a reference to Shakespeare right you
have to you have to put that in there so
we got Heraclitus of ephesus and
somebody already mentioned chess which
belongs here that's the roots of some of
the security principles we have today
approach life like a child playing game
okay
so I would just encourage you to stop
and remind yourself to I have to do it
weekly I have to say I have to carve out
time you know in my schedule and say I'm
going to be playful on Thursday at 2:30
okay and I'm going to spend 30 minutes
being playful right I'm going to steal
this time for my company and I'm going
to work a puzzle or so I think there was
a famous historical prophet philosopher
that said suffer suffer the children
come unto me and I'm not sure if he met
suffer like having children around is
like terrible no I don't think he meant
that I think he met the mind of a child
is what the way they approach things
with that that openness is what keeps
them that makes them full of life okay
enough of me waxing philosophic who's
ready to try some puzzle
I got three hands okay we're in big
trouble
and the reason is because that's all I
got left so I assume the rest of you
have really been enjoying me kind of
pontificating about security and
security culture I don't know I I was
I'm not able to go to all the sessions
here you know and a moral on this
java.security track but I wanted to make
and I hope some of them also had this
but I wanted to I wanted to make sure
that message was here I don't hear a lot
of people talking about a culture of
security and I think it's just I think
we're just right on the edge of I think
you know even my mom and my grandma who
are not who are far from computers know
about hacking and they know about the
way the world is and they have to be
careful right with their information and
I think now it's time for developers who
have known a long time about these
things just you know to step up so that
culture okay so for people want to do
some puzzles so we're going for their
sake we're gonna do it everybody else
can check out whatever alright so the
first puzzle is we got a clown the clown
reservation system okay so this is a
this is a computer system it's it's on
the web it's a it's a b2b thing and it
allows a party planning system to talk
to the clown reservation systems and
Reserve clowns for four events okay and
you know a clowns are that's a cutthroat
business if you haven't you know if
you've never been involved in that so
when this business the business message
comes from the event planning to the to
the clown reservation you know the clown
cooperative system now they can place an
order
right and so we see we see this is a
basically an XML file it's got a first
you know it's got information about the
person placing the order so it's got the
bill to the ship - and who's going to
pay for it and you know who authorized
this order but notice the way the way
this this has been designed right this
language we got it first
we have properties basically which are
name value pairs and then we can reuse
those right so they were so the designer
what were they trying to do why do they
do it this way
yeah don't repeat yourself don't repeat
yourself I had to say it twice because
that's a rule when you say don't repeat
yourself that that's right that's pretty
good so so they were trying to make it
compact right they're trying to have a
compact representation so you can see
they use this escape sequence here right
especially interesting is the ones like
purchaser
no not purchaser I'm sorry
the issue e of the payment right so that
that value is using using the values in
it and doing sort of a string
concatenation thing all right so that
was their design on the messages so
here's some code in the clown
reservation system that's processing
this is the code that's processing those
values resolving those values right when
it's parsing through the XML so they can
actually build build the order okay and
so we we get a string builder and we
start to march through one at a time
we're going to march through the text of
the value and if we see our escape
sequence we determine whether we're
opening we're opening or closing that
escape sequence okay and if we're
opening it we just set up to mark that
we're opening so we're gonna start
building a we're gonna start building a
variable from one of the properties
otherwise the text is probably just it's
just text that was that was in that it
was in the field value yeah got it okay
so there's a problem with this code
security wise
so here's a message that somebody could
send this message it's not very big
right how many K is that not very many K
right but what they've sent in here is
the property of lol okay and then the
next property which they called lol one
is ten of those together what happens
down here at lol nine what do we got
there
we've got ten to the ninth yes lots of
data can consume okay I don't know on
modern computer that's not so terrible
but scaling wise what do I have to do to
get you know ten billion or 100 billion
right I just have to keep adding a
single line so for brevity I kept it
short but you can see this is a problem
right so what was kind of the problem in
the design is there a problem with with
the message design maybe not maybe
that's it I mean that's acceptable it's
a good way to compress
so I say here's the vulnerability in the
code it's the part where we've
determined that we've come to the end of
a escape sequence and we're going to
take the property that we've looked up
in our table and we're going to append
it to whatever value we're building so
what's going to happen yes memory you're
gonna you could easily run out of memory
yeah
raise your hand if you don't get it very
good everybody got it so what's the fix
what's the fix can you do to this
I heard maximum length who said that all
right now I've got a real problem
because they won't they put me in my
cage but pass this back to that guy and
him when he gets it he'll he'll hold on
to it they have lots of rules here about
these sessions I'm not allowed to give
you anything but if you come see me
afterwards outside this room and where'd
it hit not attending Java 1 so after the
session all right good
so we need to we need to bound this
right so this is probably this code is
probably what you would write if you
were writing your code functionally
right this is good code functionally
right it satisfies the requirements but
in this case we're gonna have to come in
and we're gonna have to do something
that's just there for security okay
and I'm gonna propose this is the fix
it's just what the gentleman was
describing a thing okay
basically I just said just as I'm
building up this value just check to
make sure that hasn't gotten too big fit
does truncate we're done okay
functionally we got a problem right this
is going to be doing the wrong thing not
according to spec but why is that okay
very good in most cases I've bound it to
a place I'm like these values are not
bigger than I don't know whatever I said
to 200k if you've got something bigger
than that something's gone wrong anyway
okay so I've protected the system yeah
all right very good
right so you could you could apply you
could write the construction of code in
such a way that you could protect
against too much recursion that's not a
bad solution that's a fine solution as
well that would imply probably that you
came to the problem with this as a
requirement you probably structure the
code for security right this this was
more this wasn't more bolted on solution
and and you never know what you're going
to come up against when you're working
with security sometimes security is a
requirement and sometimes this this
piece of code this bit is probably not
something you were thinking of really
hard this is not checking passwords and
do you see what do you see what I'm
saying but still valid still valid
brilliant so that's a very good
statement so the gentleman was
explaining that at this point in this
code the way I wrote this code you might
want to log or audit right because
because this condition is a funny
business condition right and that that's
a very good point
again that's back to the trade-off of
you know am I gonna make the code really
slow all right this is my attempt to
classify this puzzle according to if you
were to look at standards Sanders
documents like where you might find this
description so I don't expect you guys
to I'm not wearing on I'm gonna teach
you about these standards you can get
interested on your journey and start
learning what are the standards exist
and what they are but essentially
they're all saying the same thing
don't in your coding don't don't take up
all the memory right which is not a
security specific thing but the
standards will link it back to why it's
important in the security domain all
right
could this have been detected by like a
tool right I'm interested in catching
stuff like this static detection I don't
really need to pull you guys could have
got the answer up there but I got my
answer maybe somebody else has a
different static detection I think it's
conceivable that with certain static
detection systems that can see that you
know that something was going to
continue to build on infinitive although
that would be kind of a stretch I
believe in this case runtime detection
more than conceivable it's possible what
do I mean by that who knows what go
ahead sir
but certainly the aesthetic detection
system pitches this boat it's my
guarantee to catch all similar was it
correct correct it's gonna be
specialized that's why I said it's
conceivable but you probably got some
work to do but what about runtime what
would be what do I mean by how would you
catch it in run time you got this
process running there you go yeah so
it's possible to write a system that's
always watching your servers and if they
start to consume too much memory you
know you start to alert it's not
specific to this this bug but it if it
detects it catches it there's a tool
called fortify go ahead sir right so
right sir
so input validation is is a technique in
checking you're checking all your inputs
and outputs it tends to be a vague
description in this case you always have
to you know have to ground it in this
puzzle but that the general technique
exactly to find this bug would have been
input and output validation there's a
tool called fortify it's a source code
scanning tool it's a good tool
I've used it I'm not trying to sell it
but I it did it did not I let it scan
this code and it did not detect that
there wasn't gonna be a problem there
it's just the risk of this particular
puzzle by the way these these slides I
understand will be made available by the
JavaOne conference after if they're not
you can always know oh I'm open to I
would love to meet you all
so this is just classifying a what kind
of criminals I think would be finding
this bug in a system because it's the
probiem some disgruntled clowns that
we're organizing to try to bring down
that server and they might figure out to
start playing with the inputs and start
feeding it you know funny funny lol's
okay and just so you guys know there's a
thing called CBS s and so
curity for those in our security it's
the common vulnerability scoring system
it's a way to you answer some questions
about impact and you and and risk and
ease of acts he's of engaging the
vulnerability and it comes up with a
number from one to ten it kind of gives
you an idea how serious that I chose
some values that classified it this was
a seven point one not not insanely high
anything over five at Oracle we try to
try to take a look at okay so if you
haven't seen that that puzzle is a
variant of an old hat called a billion
laughs you can see it comes from a
billion lol's and as we already talked
about it's a denial of service if I a
denial service meaning it would bring
down and take up the memory plus would
fall got a crash and so a hacker got
what they wanted they brought down the
clown system so that it couldn't be used
okay so it's a denial of service in
memory all right
could you all clap for me
I was running out of fuel I was running
out of fuel I needed I'm like oh like a
something that needs a cockroach or
something I need sugar or something
what was that okay I heard a cat cry
okay how about another puzzle anybody
yeah yeah all right all right
six people want another puzzle so two
more joined and now we're going to do
another puzzle okay
this is a turkey telco so this has to do
with MySpace not I'm sorry not the
company not the website I don't know if
anybody uses myspace anymore
this is a this is the for this is in the
in the domain that I work at Oracle the
kind of software I work on is telco
software so I will tell you I'm not
allowed to it's against my company's
rules but this is puzzle is completely
based on something that happened in some
of our code and we found it and fixed it
and this is not the code but I'm not
supposed to represent to all the Oracle
has any weaknesses of any kind that it
is fallible in any way so I love my
company it's I don't think anybody got
any jobs
I know engineers looking for okay so
this is a routine that's doing some
processing this code is conveniently
shared by on a open web site it's
accessed by both customers so for
self-service customers can log in to a
website and this code gets touched also
consumers customer service
representatives they have admin
terminals when people call in I want to
order some phone service or I need to
make a change you know at Verizon or
whatever the customer service agent they
use the same website or a similar
website they have obviously different
roles and responsibilities but it's it
ends up touching the same code so
so this code is called with a user so we
know what we have context and command to
issue that it was coming from the
website something somebody did and some
smart arguments okay for that for the
command so the first thing this code
does is this a security code right
whoever wrote this had brought security
mindfulness right I mean this is dealing
directly with roles responsibilities
permissions okay so if this is the
greedy old customer so this is coming in
from a customer
this is coming in via self-service a
website the only thing they're allowed
to do is check the version ok they're
there the client side of this whole
thing it has the ability to check the
version ok because the Java Script is
going to take some action ok so that's
not very interesting that's a pretty
innocuous read-only style action that
they can do they can find out the
version does anybody think being able to
get the version from us live system is a
good idea or a bad idea or any security
this gentleman says bad way you say that
right right so that's a normal that's a
pretty traditional production security
principle is you don't let people you
don't advertise a version of your
service and you don't have people query
for it but but this system was built
because the the you're correct ok and
you try not to do that but often the
reality is in order to do field service
you really need to know what was going
on so a lot of times systems still do
that despite the fact that a perfectly
secure well a perfectly secure world you
would have a server running and nobody
could connect to it or do anything with
it right it would be in a room with a
moat and I mean it's physically can be
touched right that would be ideal in
fact the server wouldn't be running it
would be off that's the most secure
service right but but so there's there's
there's a spectrum okay so we do the
right thing here now if it's if it's the
friendly customer service rep they can
also to their client can also check the
version it can also top off does anybody
know what top off means that's a yeah
add money or add minutes that's that's
our technical term in telco actually in
telco do you know what we because I
worked with the billing systems do you
know what they call people to pay their
bill on time they have a term in the
telco systems a dead beat a dead beat is
somebody who pays their bill on time
anyway how about that was interesting
and eight other people thought it was
too okay so if if if this is a if the
command that was passed in is not is not
permitted by by that user but that role
then we throw a security exception
though it's so far so good
this is okay this is good somebody
really was being careful with roles and
responsibilities and you know permission
authentication we we already know it's
authenticated so ok then who scene code
like this where you normalize your
command language so that you can
simplify your response language that
means that pattern makes sense to
everybody
right I mean HTML you know is like not
even case sensitive right it's still ok
I'll let you guys look at it for a
little bit is there anything interesting
down here yeah yeah so you're worried
that no that's not true because I
already if you're authenticated you get
you get top off right you can do that
you guys don't like the case handling I
get that here you're right I mean in a
text book you know you'd you'd be right
ok this guy's weren't bothered by the my
friend here is worried about the
normalization okay you're getting close
you guys are getting close
no no this is going to stop us right we
already do this check up here only the
right the only the right commands oh
yeah I see yeah you're worried about
you're worried about what came in on
command string I can assure you is one
of these two things I can guarantee okay
okay something that you don't know why
do you now okay okay you guys are doing
great
everything you said I got one more hand
I want I want my back of the bus friends
to
okay okay yeah I see that I see that
that's not it all right no I know every
every everybody's contributed the same
message you guys are worried about the
case handling this routine is only this
routine is only as an if the system was
structured as a set of actions so it was
only meant to be for top off but they
went through and bolted on version
because they wanted that in every action
and that's a whole structural thing and
a couple of you are really worried about
the what's going on up here which you
know you should be drawn to that that's
security stuff what if I show you this
oh so if I pass in the locale for
Turkish this was the turkey telco this
was running in this system was being
deployed by a Turk Telecom right and
they run their servers in Turkish that's
their environment this lowercase word
when it went to normalization see how
old that right there not the red one the
black one
that's a capital conversion in Turkish
of a Latin lowercase I this innocuous of
the line was her problem
or is a problem from a security
standpoint okay when they deployed that
when I'm not saying this really happened
by the way a Turkish telecom company was
to deploy this and their environment had
the Turkish language on and our code got
to hear anybody that checked the version
could top off their account just because
of the way the code was structured right
and it was structured more intelligently
it had the right else statements and
their block statements but something bad
happened if it could get past that
version check right they a hacker was
able to do something with that if they
figured out the version command and the
way that that that the a Turkish company
I keep using this passed again this
never happened this isn't something this
was a real case or anything like that so
the fix
is anytime anytime so this is a nice
rule anytime you use to uppercase do
normalization okay I don't know do we
have time what do you guys think one
more you can bear it you can bear one
more all right I'm not saying there will
be prizes I'm not saying there will be
prizes because I'm not allowed to give
them but let's see what we can find
okay standards let me just make sure
that everybody gets there okay yeah this
is input canonicalization we got static
yes runtime yes static code chair could
easily check this runtime yes fortify
didn't find that that was unfortunate
for them and us and that's unauthorized
control okay
the Bret HR system this company it's a
Human Resources system allows them to
track who what employees deserve what
kind of money and there was a problem in
the company that bought the software and
they were doing an upgrade and there was
a problem so what do we do in the field
when there is a problem with an upgraded
system you could roll back that's good
what else do you do we want to help them
fix it so what are we going to crank up
the pretty couple logging yeah okay so
the we got the logging turned up and
here's the code so there was some update
of a salary command that can come in
okay it's a sequel it goes to the
company HR table it's got salary the
employees last name okay when you see
sequel code in Java what's the what's
the first thing you think from a
security point
who knows okay I like that
everybody said it simultaneously I don't
have enough non prizes for that what
what is the name of the fix what is this
structure that use not yet I haven't
heard it yet
yep I think I heard it from here first
you say first okay okay okay you said it
but not only first all right
so sequel binding I can't I can't cross
my out it's like a dog that runner and
past that I think there oh wait no D you
can't have that here you can have that
that's my card
pass it back to our friend of their
sequel binding so what that means is I
wrote the code so on this code is
correct this is not the security flaw so
that's going to be problem for us
because as security guys would like to
come in we like to see the problem
already used to who's seen sequel
injection problems in their code yeah
all the time I mean it is 2013
no it's 2014 2014 it's not the year
we're in yes who's president we and in a
sequel injections all over the place so
the answer is binding and you write your
sequel in such a way using prepared
statement and you put these question
marks and then you load it with the
value so that's safe that's that's not
going to allow something to come in and
with last name of close quote you know
one equals one or give me the rest of
the data okay that's not it what else we
got here I don't I don't print the input
why would that be a security flaw tell
me about that that's true
okay I didn't tell you what this was
right here so this is a magical utility
that like this is a magical utility that
is gonna basically log the exception and
it's kind of it's going to give you all
the details it's going to give you all
the details about the the statement and
the statement that is filled in all
right I think we already found the
problem would you guys pass this back to
that gentleman right there okay you guys
are your guys are catching on we're
getting more and more answers right so
that's a functional problem and that
could be a problem with yep maybe a
security problem so the gentleman was
right so here's a log after they cranked
up the logging during the upgrade and
the engineering staff just put in that
you know we just used that utility all
the time right because we wanted to
standardize our logging right I just we
need that information but what happened
was it did this nice thing where it
printed out the statement and then it
printed out what went in right now
that's all fine and good but who got to
see this information
people who made less who is the answer I
heard that's true and can be a security
problem yeah you're setting yourself up
right go ahead yes sir yes so so he
pointed out I just put the salary I'll
that's a very American thing to worry
about like what your salary is but that
could have but this could have been
anything
right this could have been any data so
what was the mistake I mean what was the
mistake logging is not the mistake the
mistake is what we log right and I don't
know if you all thought about this way
but we never asked computer scientists
we don't think about for software
developers we don't think about logging
as a form of UI and it really should be
I'm on my off hours one of my greatest
joys is admin functions I don't know why
it just brings me comfort I like to go
and like administer a system go ahead
sir there you go right and that's common
is making sure your logs don't go to the
wrong place right get dumped out and how
many times you see a Java stack trace on
some service that you're using to post
your pictures of yourself
right so you notice I'm not allowed to
logging the exception anymore dumping
the exception is a bad idea because in
older versions of Java when you dump
that sequel exception it actually went
ahead and put the sequel that you were
trying to execute in it and now you're
back to the same problem right so you
need logging by design is what we need
to be thinking about here you guys are
my friends and coming to an end so that
is the answer here's the standards this
is don't log sense of information
outside of a trust boundary it's
possible to statically detect a
conceivable unauthorized access and we
don't get to do the last puzzle because
we were out of time okay so this has
been your your initiation you were all
going to go out and cultivate a culture
of software security and you can take
these puzzles I have lots more of them
that I can that I can help with and but
you can make your own it's brilliant
thank you for coming</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>