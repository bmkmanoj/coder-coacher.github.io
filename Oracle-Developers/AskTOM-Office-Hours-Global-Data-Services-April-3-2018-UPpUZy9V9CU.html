<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>AskTOM Office Hours: Global Data Services April 3, 2018 | Coder Coacher - Coaching Coders</title><meta content="AskTOM Office Hours: Global Data Services April 3, 2018 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>AskTOM Office Hours: Global Data Services April 3, 2018</b></h2><h5 class="post__date">2018-04-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/UPpUZy9V9CU" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right so a good model good afternoon
good evening wherever you are welcome to
this first session on the ask term
officer Shawn GDS what we'll talk about
today is we'll introduce you to global
data services it's a feature of Oracle
database that's been released as part of
12-1 few years ago and then my name is
nagesh Petula I'm the product manager
for Google Data Services right what
we've talked about today is the volkl
management challenges of eveni dealing
with replicas we'll introduce how genius
addresses those challenges we'll talk
about the concepts and architecture of
genius and also we'll take a look at
various use cases and how Jesus could be
employed with actually regard as well as
golden key okay so if you look at the
challenges of replicas let's say in this
example I'm showing two databases what
is the primary one is standby they could
be the same data center or they could be
in different data centers when you're
when you're running your read-only
workloads right there isn't there isn't
mechanism if you're running it against
the standby and and if that Stanback
goes down there isn't there's no
mechanism for automatically failing over
with that service to another database
for that matter primary or another to my
right in the current in prior to 12 1
and also there is no mechanism to load
balance your workload across the
databases let's say in this active Data
Guard example I have read only workload
that I'm running I'm not I don't have a
mechanism with argelius to effectively
load balanced this workload across these
two replicas right so what we did is
we've introduced a feature called global
ad services it's basically a vehicle for
you to manage your client workloads
automatically and seamlessly across
replicas right if I step back and see
you've you've been using the concept of
service with
Oracle dragged databases right with
which you can load balance the workload
across instances of a cluster or you can
do failover the service from one
instance to the other right
what we did is we extended that notion
of service to replicated environments
that means we created a new concept
called global service with which you can
load balance your workload across
databases or you can do service fail or
across databases etc right and we'll
talk about all the details of how the
global services work later on but from
capable is standpoint of you what genius
offers is it gives you work load routing
based on the load locality and the
replication lag right and also it allows
you to the service failover across
replicates replicas so the benefits you
get to maximize your application
performance with the load balancing
capability across databases and also
you'll be able to mitigate the downtime
whether its planned or unplanned you can
mitigate the downtime make time with GDS
and you can manage your workload across
these replicas replicas with simple
interface right with what interface both
command lab or with Enterprise Manager
right so here it is with GDS you get
uniform and well balanced workload
across these replicas and if database
crashes we automatically failover the
service from another database and they
allow you to connect and continue the
workload there so bottom line with
genius you get centralized service
management with one interface as I said
before you can manage your workload
across replicas you could do workload
routing based on the region the locality
and also the replication lack and you
can do load balancing both connect time
as well as run time and then you can do
service failover
and it actually to god you can even
assign row you can even do role based
global services ok so now let's look at
the architecture diagram of GDS right so
if you look at at the bottom you have
your application databases in this
example I'm using sale
this application database which is that
is one primary on a standby and it could
be using the activity record our golden
gate at the application tier you have
the connection pool based clients coming
and then in the middle between the app
tier and the and the database tier you
have what's called as GDS the global
data services it has two components one
is the the global service manager and
the other one is the catalog right so
now Global Service Manager think of that
as a global smart listener which will
which is allow you to load balance your
workload across databases both of the
connect haven't run time and they
monitor the databases and if the
database crashes it'll also do the
service failover using the global
service mechanism right and all your
connections will go through the GS F
these are the listeners and these
listeners will take you to the redirect
you to the right database based on the
policies that you get to set these are
not database instances these are simple
Oracle listeners but they have been
beefed up in support of replicated
environments okay so that's Global
Service Manager in a nutshell and there
is another component called catalog the
genius catalog this
hosts the metadata of your GDS
infrastructure what am i replicated
environments what are the global
services what are the region's write all
that information the basic information
is persisted in the catalog it's a very
small scale database and you don't need
a separate database for it you can also
Co force it along with your arm and
catalog or Enterprise Manager depository
etc sorry now we recommend that it means
to be protected with a way to stand by
and we also recommend that you need to
have a pool of gSN's on both data
centers right for high availability I'm
showing three DSM's
in this example the bare minimum number
of gsm is one for high availability you
want at least two and
if you want to have multiple pools of
databases that need to be supported with
the single DDS infrastructure we also
recommend that you have at least three
DSM's in each data center so as I said
you could have pool of twenty such pull
such database
pools that you could add to the GDS
infrastructure and then they all can be
managed by this set of DSM's in the
catalog now here are the the details
about what adjacent structure can
support twenty pools as I said it can
have you can have ten regions five years
in each region 300 database instances
thousand global services and thousands
of material connection puts the
databases in the genius a genius
governance should be using Enterprise
Edition 12 1 or greater they could be
single instance or rack they could be CD
B's or non CD B's they could run on
accelerators right as I said before you
can manage all of test fit interface
called GDS CTL command-line interface as
well as the enterprise manager plugin
the licensing stamp on a fee if you're
using active Data Guard or Golden Gate
genius is included in it there is no
additional purchase from from that
perspective
ok now how do i deploy GDS that's quite
simple right and at a high level like
how you have database media and client
media till now starting with 12 1 you
also have GSM media the global service
managed media that you download and
install on various small scale me apps
where you turn this clone service
manager and you download and install it
and then you pre create a catalog
database right and then there's some
basic at GDS adminstrator accounts and
privileges commands that you would run
and I'll show you what those are
after that you would do the
configuration of GDS these are one line
commands for creation of the catalog for
the creation of G SMS the regions
the genius pools the databases how you
can add it to the pool and how you're
gonna create the global service for your
replicated of monies and then finally
you would set a big client connectivity
you would add just the teeniest names to
use the assembly listeners instead of
your regular database listeners on our
scan list okay now let's look at those
steps right I mentioned you download and
install TSM and then you pre get a
catalog database once those two things
are done on the catalog database when
you create a 12-1 or create a database
there is a default I use a called DSM
cat user that needs to be unlocked and
you will have to set the password
accordingly you can also you know you
should also create a super user in this
example I'm saying my genius admin and
then the gsm admin role needs to be
given to that particular super user okay
at this jetty user and for each database
that you would add to the pool there is
also a default GSM user that means to be
unlocked and in the past when it's
recent these are the prereqs now let's
go into the configuration of genius what
do I have to do to set up genius for
your given application
first thing I'm not gonna go into the
details of the syntax but they allow you
to understand you know at high level
what commands would you use and that
makes up this configuration okay so the
first thing is create catalog as I
mentioned you already pre create a
catalog database so you gotta create a
genius catalog in in in that database
you'll specify which database that you
want to create the catalog on what are
the regions
what's the super user and the password
and then once the catalog is created you
would do ad GSM as like I said GSM is a
regular Oracle listener so it would have
a listener port that you would have to
assign and then you would tie up the
catalog that it is to be connected to
and then region that it's mapped and
this command you could run any number of
times for how many GS since you may have
great and then once you add the G
essence you can start them right with
the start GSM command after that you
create a pool in this example I'm
creating sea
okay so then after that you would add
databases to the pool right if I have
two databases dbo on and db2 I would add
those databases to the pool but if you
are in the active Data Guard
configuration broker configuration you
don't need to use a database you can say
add broker config so if you have like
multiples of databases in the broker
config one primary and multiple strand
wise all those databases could be
plugged into a genius pool with that one
command okay with that command call a
broker config once the databases are
added you would say add service in this
example I'm creating a sales query
service my preference is that it needs
to run on DB or one but if the DB or one
fails I would want to failover that
service to DB or to automatically
alright so that's how I'm creating my
global service and once I define it I
would start the service on that pool
right so that's all I would do so on the
back end I would can I create the
catalog page ASM create the pool add
database to the pool and create my
global service and started right that's
at the backend and then from the client
side I would add just Mightyena century
the tennis names Confederation is very
similar to what you've been using before
in the case of rack or or even for that
matter known that in this example I'm
showing two address lists and set of
listeners these are nothing but the GSM
listeners that that have been created
using a GSM command in the previous
slide so I would let's start all the gsm
sim one at this list in this example
it's in data center a and my other
address list will have the gsm s that
belong to the terrace copy right and the
other important thing that needs to be
noted here is the service name is a
global service that you just created
okay
and the region you're coming from this
is optional and this is needed only when
you want to do region based route you're
telling genius which region you coming
from with this particular course okay so
bottom line the teeniest names is
exactly what you've been used to
it's except for for the lesser endpoints
you would use gsm listener
in south database listeners or install
fear radix can message that's from your
client site now like I said genius will
allow you to do service failover
load balancing across replicated
databases locality based routing and all
the good stuff right now
if won't stop there it also publishes
fan notification any time it does
service failover or for that matter even
to provide on-time load balancing
advisory it provides fan notifications
and the best start of genius is
subscribing to the fan notifications by
the clients then you get the
intelligence from GDS anytime you have
this changes happening in the backend
the clients get notified if the service
has failed over or if you know the real
time you get the runtime unbalancing
metric so you can route your workload
accordingly right and now what do I do
to make my applications serious ready
first of course you define a global
service we talked about that we
recommend that you would use the Oracle
indicated connection pools whether it's
OCR JDBC or if you detect WebLogic etc
if you're using Apache Tomcat JBoss at
IBM WebSphere we do support them except
for in those scenarios you would use
Oracle UCP the universal connection pool
as your data source for the connection
perspective both in theorist names and
your URL you would use gsm listenin
points and you would use all the max
availability best practices basically
the correct time or that e-type count
delays and transport connect remote etc
kisser these are the best factors that
always been there we retain that even
with GTS and then you should be using
global service name and then for
locality based routing you would use
please okay we recommend that you would
go with the 1202 clients for one reason
which is the fast connection fellow is
automatically enabled that means your
connection pools are automatically
subscribing to the fan notification so
what this call that's made in the in the
UCP okay and then if you want to do
graceful failure words you can also have
a draining period set right and in this
example the plant draining period is
for UCP I'm saying 30 seconds in 30
seconds I would have to gracefully gain
my connections and move over to another
database where the service has failed
over so that's the those are the prereqs
for the application to get the best out
of GDS now let's look at the use cases
I'm going to talk about use cases and
how D this can be employed with actively
regarded as well as calling it okay now
in this example I'm talking about
service failover for Oracle GoldenGate
pulse of Master and replica scenario
okay so I have gold gate configuration I
have my master database which is DB or 1
and my replica which is DB o2 and I want
about order NT service to be running on
DB or 1 if this fails then I want the
service to be failover to DB or two to
get that behavior the service feel of
behavior for golden gate configurations
I would define my global service like
this I'll say ad service define my
service name it is my pool I prefer this
DB or one availability beaut right so
with simple setting of the attributes
preferred as it and available you get
the behavior of service failure work
from one to the other if that's so if
the database crashes this is for the
service available in the case of golden
gate master and applicable
now there's another use case called load
balancing Farida forms many customers do
this whether it's actually a god of gold
k so they want all the read/write were
thought to be sent to the primary and
the read-only workload to be balanced
across all these stand box in this
example the reporting service needs to
be balanced across the stein was ok to
get that you need to create two services
one of course for the read/write
workload and the second one is for the
read-only workflow so I'm for the
read-only workload in this example I'm
showing read reporting service I'm
telling the system you could run on any
database as long as the role is physical
standby that means it's gonna run down
on these databases right on the physical
standby databases and I'm also defining
two goals the connection load balancing
goal CLB call law
long for long live connections typically
a correction poles use this and then our
lb goal you have two options there you
could use as a service time or
throughput in this example I'm using
service time for our lb and then long
for connection or balance right just by
setting these attributes I am making
sure that all my incoming connections
that are using reporting service are
well balanced across these standbys
right so that's the power of tedious you
don't have to write any custom cord to
load balance you just set your
attributes for the global service and
use this global service for the
workflows that that are running the
report okay so now we looked at service
fellow we looked at the load balancing
for a deform now let's look at load
balancing for active active volunteer
right Golden Gate can also do multiple
configuration right in that's in this
scenario I have two databases the
assumption is the application handles a
multi master conflict resolution right
and then in this case I could run read
rival toad as well as read only workload
on any database so if my goal is to load
balance my workload across these two
master master databases I would define
my service my order entry service in
this case to to have preferred all that
means run on any database and then but
my connection load balancing goal is
long okay so with this with these
attributes set all my incoming
connections are load balanced across
both these databases so this includes
both read-only as well as readwrite work
plus so now that's load balancing for
active active now how about region FEG
so many a times customer want to route
their client were close to the nearest
database in the neighbors data center
right in this example for example data
center one Clark lines closer to the
data center one should be routed to a
daily basis and data center what
likewise kinds closer together said the
two should be routed to a database in
data center too so how do I do that with
GDS
so in this example I'm using Golden Gate
in a multi master conference now
multiple conflict resolutions and then
now when I create Matt's create my
global service I would say preferred all
that means it can go to go to any
database but the preference is locality
local only that means these clients
should be taken routed to the nearest
state nearest data center right but if
there is no database in that data center
my second option is to have a region
failure what that means as a second
option I can go to another database in
another data center right so borrow
blood is preference is to a local
database and if that database doesn't
exist in the in the data center already
fits down for whatever reason then my
second option is go to a remote database
right that's region based routing which
80s for : k now service failover for
active Data Guard right in this example
I have a replicated configuration using
active Data Guard I have my order entry
service reading for the primary database
my reporting service are you gonna stand
by my goal is if my standby goes down I
want my reporting service to failover
back to the primary ok to do that I
define my global service like this I'll
say preferred all reporting service and
on any database but my first preference
is to run this on the database that's
running as a physical standby alright
and if that physical the last one
physical is down
I can even failover to the primary that
means I can run the service back on the
primary as well right so you're giving
the priority that all the read-only
workload should run on the stand back
but if that Steinbach goes down now
phthalo
that service to the primary in that
scenario you would have both the order
entry service and reporting service on
that time okay
so the other interesting what is a role
based global service for activity regard
I take the same example I have an active
Data Guard configuration or duty service
running on the primary reporting service
or even the standby ok now
so maybe as d-v I want to switch over
for example so I run the switch oh come
on using the broker the moment the
switchover finishes the delegate
regional finishes GDS recognizes that
and relocates and he locates the global
service accordingly based on the role
that you have defined for that service
so to get that you would define two
services what is the order entry service
that needs to be run on the primary
right and the reporting service whose
preference is to run on the database
role physical standby right any time
there are need it all changes whether
it's due to switchovers or failure which
GDS will relocate those global services
based on the role that you have defined
for those services like this all right
so you get that with the GDS this is an
interesting one routing based on
replication lag tolerance so in this
scenario I have a database and a local
standby in one data center and also have
a remote standby in another data center
many a times when you have any much time
but because of network issues etc this
particular database may lag which is a
very moody exit right and if you're
running your reporting business
reporting workload on that particular
standby they may be seeing data that's
not current
that's lagging behind and maybe you may
not want to do that in that case you can
set replication lag tolerance right
what's your threshold for that the
threshold is defined in seconds let's
say 180 seconds if the replication if
the if this particular standby dbo tree
is lagging behind by 180 seconds then I
want to I want the workmen to be routed
to another database which is not lagging
behind right to get that behavior I
would define my global service in this
example reporting service whose role is
physical standby and the replication lag
tolerance is 180 seconds right
if the lag exceeds that limit we shut
the service down on that particular
database and then we route the next set
of incoming connections to another
standby
the beauty of this is you for your
application workload they get better a
data quality because now you're not
accessing the data from a database
that's lagging behind so those are the
use cases for both Data Guard as well as
Golden Gate a couple of interesting
things I want to bring out how do you
mitigate unplanned outages with GDS and
also how do you do plan outage right so
in this example I'm going to talk about
unplanned outages all right so what's
the best way to mitigate if certain
prereqs that I have to do from the
applications perspective I won't use the
Oracle integrated connection because we
talked about that you'll see P or EP dot
that we'll see I at cetera right and of
course we do support third-party
application servers IBM WebSphere Apache
Tomcat JBOX it's from the application
configuration side we need to subscribe
to the fan notification using the FCF as
I mentioned if using told our two
clients you're good there and then we
also recommend to follow all the amoebas
practices on the TNS connectivity reach
account connect timeout and transferred
connected right so those are the
products now what are them kind of
events in the case of Golden Gate and
active Data Guard it's a global service
failover that means if a database
crashes GDS automatically fails over the
global service write to another database
and then the other one is the kuraki
data God is the data guard role
transition and that's failover or switch
over so in that scene in those scenarios
the movement this fail failures happened
serious relocates at Global Services and
it publishes the fire notification that
the fail this particular service events
have occurred that the service is down
on one database the services up on one
of the database those fan notification
the past application notifications are
sent by G SMS to the connection pool
clients right the moment the fan
notifications are are received by the
collection pool clients the sessions
start draining that means the new work
requests are automatically redirected by
GSM listeners immediately
to the new database where the services
coming up and the idle sessions are
released immediately as well so but the
checked out Corrections they would
receive invalid connection right the
application would then what it will do
is it will close the connection and gets
a new one a new connection from the pool
but when it gets a new connection from
the pool now it will automatically in
the new database where the service has
come up right this is done completely
automatically by the connection pool
what genius offers is that fan
notification when this service services
have been relocated right so bottom line
is when these unplanned events occur
genius will allow you to mitigate the
downtime for the app from the
application perspective you would
gracefully move over from one database
to the earth to another right
that's the unplanned outage what about
my planned outage right so let's look at
that the same requirements from the
application side and the application
configuration side I'm gonna go over
that again now in this example I have
golden gate configuration right in the
master replicas type of a scenario all
my workload is running on the master and
my goal is I want to apply a patch and
let's say it's a daily basis batch or
infrastructure pyro or for the matter
schema upgrade that I want to do right
I'm gonna go do my scheme upgrade on OGG
to the second database once the schema
is a grater or a patch is done all I
would do is as a DBA I would just run
one command from GD acetal called
relocate service I'm gonna relocate this
global service from OGG one the first
database to no zg2 second database I
execute one command and then sessions
start training just like how we observed
last time so GDS publishes fire
notification right that it is a planned
event the reason code is user and then
what happens is the new work is
automatically redirected by the GSM
listeners to the OGG to idle sessions
are released from whoa GG 1
automatically and those active sessions
release when they finish and then come
back when that when those Corrections
are checked in and that's when they are
released and then then that's how you
crazily move over your work code from
OGG 1 to OGG - right and that's an
interesting capability it's not just the
service failover it's the intelligence
that the alias publishes - the
connection pools with which you can
mitigate your downtime big time from the
application perspective
ok so bottom line
Delius we talked about that it provides
workload routing load balancing both
connect time as well as as at run time
and we also talked about how it fails
over service based on the policies that
you get to set and it's a vehicle for
you to manage your workload across
replicated environments seamlessly and
transparently alright the key benefits
Delius allows you to maximize your
performance of your application as well
as the availability of it we talked
about that performance we had the
collection load balancing availability
we are the fan notifications when the
service failover happened
right and we talked about how we
mitigate the planet unplanned outages
and the best part is better resource
utilization you don't have underutilized
resources on one side and all we utilize
on the other right you are effectively
managing your resources for your given
application ok
the I want call out few things we do
have quite a bit of collateral that's
been captured in the GDS OTM page I
would strongly encourage you to try out
go to the Oracle comm go to genius ot
and and try out the white papers the
their webcast the customer collateral
the quite a bit of quite a few cookbooks
as well on how to deploy GDS you know
how to exercise my use cases for
actually got as well as Golden Gate
right I do also blog on GDS so do take a
look at this particular link as well
take a look at all the posts that I've
done so far that talk about
the details of the use cases that we
covered and also the in-depth
architecture and the concepts of serious
as well</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>