<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CON3669 - Are You Aware of the /bin of Your JDK? | Coder Coacher - Coaching Coders</title><meta content="CON3669 - Are You Aware of the /bin of Your JDK? - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>CON3669 - Are You Aware of the /bin of Your JDK?</b></h2><h5 class="post__date">2015-12-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/POFWO0eBVSk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">my name is Andrea chic don't worry if
the combination of letters courtesy of
it does to it does it to everybody
that's quite normal there is a much
easier version for example the twitter
handle should be quite doable so I come
from Poland from a lovely city of Krakow
Poland is in Europe that's next to
Germany well that's where Poland is and
I live in London and I expect you to
know at least we're London is I run a
conference called geek on I to run and
then lead put the Polish to a user group
organized well founded and organize the
software craftsmanship in Krakov same
for crowd of crack of a user group and
if you need anything feel free to please
drop me an email tweet to me i'll be
super happy to see that and well let's
start with the motivation why this talk
happens I have this nightmare that I'm
actually waking up one day and I'm the
most stupid person on earth so I try to
do whatever I can not to become that
person and because of reasons mentioned
in the slide so I I start digging that
for digging and digging and seeing
what's what's beyond the first layer of
software done running within the second
layer i'm not going to disassemble the
cpu that's a bit too fun that's going a
bit too far but i try to understand how
how things work what what the gem is
constructed but what's in the bin
directory of the jdk because there is a
lot of things that you get to see in
there and out of curiosity who if you
have have been to depart to a party
yesterday evening nobody wow I was 21
and that was fun so and I just learned
that some people are watching me for a
stream so that's even more awesome so
there is more people in that watching me
that that sits in that sitting in the
room including my girlfriend which is
absolutely amazing and so let's start
java one has a twitter handle i have a
twitter handle there is a hashtag if you
can tweet that will really boost my echo
i love being tweeted about take a
picture say that you love it yeah if you
have any questions just ask and it's not
there is a reason because I get free
sessions they're all and immediately
after just as this session ends I will
have to go run to parc 55 so if you have
a question try to wave your hand and
I'll try to repeat the question and
answer that or if I can't hear it well
we can try to do it over Twitter or
email that's why the twitter handle is
really important and so Java well i
would i would expect that most of you
know java is most of you love job I love
Java as the platform I love writing Java
I love writing Scala a bit more because
it's it actually requires a bit less
writing but still I run on GV m JDM or
how do you get there well you everybody
knows what dollar Java home is or its
windows equivalent and there is it this
funny directly called bin did you ever
go there probably I did at first I had
no idea that would stir because my
beginnings were NetBeans which would
automatically compile things and then it
would all break I had no idea how to how
to make it all fall back into place so
there is a lot of favorite there is a
lot of things in there and it's actually
44 when I was doing that at three
minutes past seven I had no idea what
today was the number of tools in there
will change the number of tools in there
is not part of the spec so samples will
be other samples will not be added and
the focus of this talk is to introduce
you to things that you can do for free
already with the tools that you are most
probably part of the JDK that you're
using I'm sig most probably because this
is based on Oracle's JDK I don't have
too much experience with IBM's version
of the JVM so I cannot comment whether
the tools will work there and what I can
also say is that some of the tools might
not be in your jvm because some of the
tools have been added some of the tools
will might be removed that list is not
precise and I will not get into extreme
details because since you're here your
developers you chose absolutely amazing
conference I know that you can read
manuals so it would be a waste of your
time for me to go for the manuals and
explore every single possible option
that is
therefore those tools so i want to show
to you what's possible focusing on the
common line because if you have to work
in an environment for example in a
financial institution that allows a VPN
connection to a bastion host somewhere
to a cloud somewhere later and so on and
so on and so on then getting a UI server
is not really going to happen or if your
production servers are really powerful
there is very little likelihood that
you'll actually get the x windows or any
other display manager installed Urso
that's why I command line also common
line is also meant very powerful so
anybody means sleeping I hope not
because I that's why I asked about the
data party is the way if you haven't
been there well I hope you're not you're
not sleepy and just one thing please
lock GC who here is logging GC in their
production I see around ten hands please
please if this there is only one
takeaway that you have from this talk
please be too please guys low GC I will
not tell you what the correct set of
flags to do that is simply because it
changes from one from one release from
one builds to the other and if you're
curious about what the goo good set of
flags would be I would recommend for
example talking to Martin I would call
reaches an invert work looking at his
tool called J clarity which can suggest
certain things there because they
actually take care of that they look at
the different versions of the JDM JDK
and they will suggest certain things
there I don't remember all the flags
because my memory is just not good
enough why do you log DC or what does it
look like well a sample set of like this
is not what you should be doing in your
production this is just a sample set of
flags you can log it into a file you can
bring you see details why is it
important because if you have problems
with the regarding GC so sometimes those
are means that you might have problems
regarding performance you actually have
some some forensic material to work with
if you have problems in production and
you don't have that enabled well you
start with a with an empty slide so it's
so much easier to start with some GC
logs now assuming we have the too long
didn't read version of the top already
done
where its goal in to when things go
wrong so we're all sure about developers
Java is of course right ones ship on
your laptop to data center many many
times so run anywhere well the problem
is sometimes some things don't really
work the way we expect them to and that
has the phonic work at least in the
companies I worked with before that this
will happen to a computer that I don't
have a direct access to so coming
walking up to then it just just do that
computer rebooting it not possible this
there will be a system running somewhere
but it's just misbehaving it's having
hiccups and it's not something that
really makes sense maybe I'll even
reboot it recreate some some let's say
some some VMS just to make sure that the
operating system is not the culprit and
then yes operating system is not the
culprit and it still has hiccups what is
going on obviously the problem is in my
code that's what I would expect not in
the kernel and so how do you actually
make sure that we'll find out what
what's happening the first question
about your application is is your
application running because it sometimes
happens that the van application isn't
serving any requests it might be that
it's not even listening it has happens
to me those are the kind of situations
in which you're looking for glasses that
you have on top of your head sometimes
you don't have the glasses on top of
your head and then oh yeah I might not
be seen because I forgot them so the
first version of you actually should
make sure that the software you're
running is running on the normal Linux
think you would do a PS you would do a
big rep or you can do top h da can
expect to see your process somewhere in
it somewhere in at the very top of the
list because it should be consuming some
cpu it should be consuming some memory
so it is sizeable beast what do you get
if you do PS and look for java well you
get a lot of stuff and that's me running
NetBeans something and as you can see
there is the clasp offender there are
some jars being listed there are some
parameters it's not really readable yes
it gives me tells me that there is some
java running but
it could be better a friend of mine mr.
yappi on twitter says that every problem
comes a different problem when you add
in java so sorting a list versus sorting
all is in Java two different things to
me looking at the list of processes and
looking at list of Java processes are
very similar but actually there is a
reason why my friend says it because
instead of John instead of PS you got
you have JPS JPS will give you a list of
running processes that you are allowed
to look at so what you'll see by default
is the P IDs and the main classes and it
this output is not really super useful
because if there is you have a couple of
pieces of software installed on the
system and every one of them starts with
a something called main or runner or
something that's not really going to
tell you much so there is there is thing
there is a thing there are flags that
you should be adding and one thing that
I have to stress out the tools that we
will see in here they are not super
consistent in their choice of flags so
sometimes they are enlisted in the
manual sometimes are there are not some
manuals some manual entries for the
tools under the benefit of your JDK
might explicitly say that don't rely on
the school too much because it might go
away it's not supported or it's not
super stable on the other hand going
through Stack Overflow will be a very
good source of information about world
flags order so to start with GPS might
save my favorite set of flags is lvm and
when I try to teach my mind my
colleagues about what will how to
remember that is well everybody knows
that Java lost memory so you do JPS what
else lvm that's that's obvious why what
does it what was the output now now it's
much better because we get to see the
PID we get to the cedar fully qualified
main class and you get to see the the
options that the JVM was wrong with and
you also get to see
program parameters which is a pretty
complete input tool to your application
and for those of you taking pictures I
will of course I'm very happy that you
do please tweet them but the slides will
be available slide sure so if you are
trying to take notes like that there is
no need I will make it easy that's what
that will be shirt so what do we get in
here we get the main class will get the
application parameters and we get the
flags which means if there is a process
that takes input as params or flags we
can actually verify whether whether it's
actually they're sounds useful is very
useful there is of course a caveat about
about GPS if your process if you don't
have rights to somebody else's processor
so if you don't if you can't read the
files that the JVM will produce under
the temp directory you will not be able
to discover their processes because this
discovery mechanism is using / TMP and
certain files that the JVM will put in
there so of course we have to use a meme
and of course it's Java so a Java
something in Java will be longer than
usual we will get you soon get to see
why oh why I wanted to put that there
hey you know jar files jar files the the
especially when you look at maven you
know that world is full of full of jar
files and your software needs to
download most of them every single time
you compile or try to clean because I
love my even for that for the fact that
it needs to download things from the
internet to remove a directory
absolutely awesome what is good about
the jar the instruction because there is
a common line tool called jar well you
can do jar minus DF why is that good
because it will tell you what's inside
the jar if you've been seeing a problem
with with things not being found on on
your classpath i tend to say okay but i
want to check
that is that is the Charter they expect
to see something and especially if you
have an older version of a library
because well you've been to the keynote
you've seen that for example well the
screenshots use their mention the
diversion of the jar files that they
were using that's a very good practice
but sometimes what all you get is let's
say digester that jar and then would
like to figure it to figure good luck
and figuring out whether some some
obscure class is in there so the first
time when you when you get a problem and
not know plus the found is to see if the
class file is actually in there in the
jar that you're looking at so you can do
jar minus TF so that's the very end of
the common line is what we're looking
here and then you'll get to see all the
classes all the files that are inside
the jar jar file why is that important
because if you scan all of the jar files
you actually might discover that there
is some fit somebody else that is I
don't know pretending to be let's say
spring because everybody knows spring
but somebody in their infinite wisdom
decided that let's ship some some other
unrelated class files with our spinning
group spring libraries because I don't
know because for convenience or because
they wanted to have less jars that
sometimes happens in a and that has
happened to me in certain enterprise
environments I work with so sometimes
you have to check a RTF is the way to do
it jar will jar command will also allow
you to extract a file extract a jar file
which also means that you get to see
what was actually in there who who here
has compiled Java from the command line
using Java Sea manually wow you're
amazing you're the best audience more
than half of people I'm mind blown I
started as I said using NetBeans had no
idea what's happening in there I would
just click the button and then yeah
myself twere works or no my software
will work java see the compiler what it
does well there is nothing fancy in
there there is a sister and brother
sibling to it or
tool that's very connected to it it's
called Java p have you seen Java p
before probably some people some people
are raising their hands so what does
java ee does well that's that's our
favourites language and some source
which does absolutely nothing reasonable
so ignore was a very whatever is in
there the thing is what java p will do
is it will show you what's what's inside
a class path so you get to see when the
class was modified last time and that
actually makes a lot of sense if you're
trying to to understand why certain code
is not working the way you expect it to
because you've made the call change of
compiled it a dozen times you've
deployed it to Tom cuts or your favorite
tool of choice and you're stilling
seeing the you still see video behavior
happening and that might be because for
example your know the class file that
sits in a jar somewhere else is really a
very very old thing so it's a good thing
that they have a they have a time stamp
in there you also get to see the version
minor minor major if you if you've been
trying to run code compiled with java 7
on java 6 or something like that you you
might recognize the major minor version
mismatch you can you get to see which
which what was the target for
compilation you also get get to see the
constants using compilation and you
probably know that the compiler is
making an optimization so constants will
not be a reference they will actually
did constant values will actually be put
into places where the constant is
referenced so if you have a string value
that you refer to in many many many many
places that will be just just injected
in there so when you compile against
such a class and then you change the
constant value do something else you of
course have to recompile and then things
can start going funny because assume you
have a multi-module system and some
dependencies is referring referencing a
constant that you wouldn't expect it to
and then you change the value of the
constant and
what now and there was a problem
something doesn't work if you're going
through if you've eliminated all the
obvious cases sometimes you actually
have to go quite a level so you try to
decompile the glue the class files and
see what is the value of that constant
because sometimes you might see
something that is probably old or
something that doesn't make any sense
it's also very grabbable so if you're
looking for a very specific value you
can grab for it to me that's useful
another thing that java p can do is
actually show you the bytecode but would
I tell you I can probably show that to
you
so what do we see in here while we get
to see some site consoles on the side
which are really not that important but
you get to see the bytecode if you're
interested you can extract this
information from from a class file I
will not go through what's actually
happening in there because that's not
the point of this talk I just wanted to
show it show it to you that it is
possible if you're interested there is a
way to to investigate that's especially
useful if you're playing with lambdas
and trying to figure out certain things
of how they are how they are done so
let's go back j info and my slides tell
me that i should do a demo so Who am I
to say no j info by itself will tell you
that it can connect a bit so let's do
clear I will just start a simple process
that will give me its PID so I can get
something to work against and yay you
get to see a lot of parameters your
intuition is probably telling you that
those are the properties that you have
inside well that the JVM is running with
yes that's correct that's exactly what's
happening you get to see the options you
get to see the home directory if you get
to see class file version you get to see
either internal the encoding all the
things that you would normally want to
verify in some really rare but sometimes
those cases will happen you get to see
the pod class but if you want to you get
to see nann default vm flag so if
somebody somebody passed something
strange or obscure there you get to see
if there you get to see the comment line
so why is that important well first of
all Jane flow as usually as you've seen
allows you to see all the flags and it
also can print out a specific value of a
very specific one so if you are
interested in sign in just one flag
across a number of processes because
you're trying to find something out
it's possible you don't have to grab
food out for that lengthy output and the
awesome bit is some of the flags can
even be changed during run time so you
can enable printing of GC time stamps
when while the JVM is running and
somebody who should well could now be
asking themselves why am I not showing
you the list of flags that is changeable
in runtime because that would be a good
moment for adjustment and the answer is
because that list is changing so I could
I could of course have the list there
but that depends on well that changes
from one jdk released would to another
so the best way the best place for it is
the release notes and looking at what is
in the JDK that you're using because
that that list is not set in stone it's
changes I expected to grow and I expect
it to change in time but I wanted to
mention that some things can be changed
in the run time so if you don't like
your GC log format you can improve it
while the JVM is running to me that's
quite awesome moving on Jay map anybody
familiar with team up anybody used team
up before yes I see four hands five so
Jay map allows you to take a heap down
that's a very simple script that will
use that will just run my favorite
looper example just just to generate
something and deflects the for the
format that's that's that's Jay map
specific you can rebuild it online one
important thing don't why would I take a
hit done well because obviously I'm
suspecting that there is let's say a
memory leak because I want to examine
notes on the heap some people have
already approached me dance and they
were saying that we are connecting to a
live process for example lr a light
elasticsearch and then they would try to
examine the heap in there and that would
be double dose law especially when the
hip is large yes it might go slow so
first of all i would recommend taking a
heap demand then examining it Oh of line
so that you don't impact what whatever
it is whatever the software is doing and
seconds yeah there is a question are
there any tools that I recommend for
investigating kingdoms yes I will
actually show two of them in here that's
a very very good question i think i saw
him somewhere but no it's it's gone
perfect so assuming you're examining
something in production a heap dump over
masakit of a JVM with a 64 gig heap if
the heap is folio fully occupied will be
large so that means that you want what
you want to analyze you will need a
powerful machine which probably means
you will need to take yet another
production like server to analyze the
kingdom from their production it might
be surprised but this was this is what
will be necessary because if you don't
have enough RAM you will start using
going for swap space if you're trying to
analyze things that are sitting on your
disk i/o will kill you and you'll hate
doing that so one tool that's well they
did a low-level tool for for helping
with with that I would like to show is
called jihad there is a demo that I want
to do so let's try running jihad by
itself what do we get we get no argument
supplied blah blah blah blah blah blah
blah but important this thing is it's
asking for a file so ignore the errors
oh yeah I've already had something
running there
let's try again so you can see that it
started an HTTP server on port 7000
which means well I could curl localhost
and yeah I get to see something and
that's HTML so let's open the browser
actually I half of the Browns are
already open so this is what you get
this is the output from jhat binding by
default it's not really super useful
it's not easy really that nice it's not
really that workable the important
things or the interesting things to me
or the things that I usually like to
want to like to start my analysis with
sit down there so you can for example go
here and look at analyze your keep using
an object query language mmm yet another
ql that's awesome it does exactly what
your intuition tells you it will it's a
it's a language and that allows you to
analyze heap with well with a language
so you can construct expressions that
work that can try to look for objects
that have object inside them and objects
having objects it's like inception but
well you can express that you are
familiar with SQL most probably or some
sort of SQL and this is logically a
logical equivalence oh yes we get to see
let's say all the strings that are
longer than 100 is it even running okay
that shouldn't be happening
will not examine that because that used
to work before but it should be working
usually you get the list of objects that
actually work that are the result of the
of your query and there is the help file
is there sorry for that that's because
the because probably of an update or
investment between a hip fight that I
took a long time ago and not so long ago
so let's
this struggling dance 10
something is not really working so we
will not examine it that far the thing
is you can examine your object so as you
can see you can see you should be we
should be able to see strings that have
a value that is longer than 100 so we
can traverse the object graph we can
construct queries that will ask for very
specific objects if we're looking for
maps or four collections that are larger
than let's say a million elements you
can do it with that and the question is
okay how do I analyze that I would
recommend going to stack overflow
looking for sample answers around that
area because there are already some
smart queries that have been written
it's all it's all over then it's all in
the internets this is certainly not a
knock UL tutorial but in interesting
thing is this okie dokie well
expressions if you've ever tried to
using netbeans profiler if you've tried
using visual vm and analyzing hip down
in there it also has oculi so you can
interact with with your keep using a
language I love it it's very very useful
so stack traces quick question how do
you get the stack trace in Java of a
running process j somebody sing j stock
yeah there is another hand over their
chil- kil- free yes so do you know what
what the problem of kill minus three
years because on a linux box yes that
will give you a stack trace it will
print it out on the to the standard
output so if you're running inside a
container well inside a web server
because that's that's a very that's a
very popular thing kil- free will print
to the standard output unfortunately so
a demo well
and yes this is this is what you get so
kil- free will actually print out the
stack traces you might be asking why am
i using a file it's because i don't want
i want the delay to happen between i and
run the hill intense so that that's
whitetail but this is what you get so if
your process is the process that you're
running is has a standard output wrecked
it into dev null or some other log or
your logging framework is spitting a lot
of information in there parsing out a
stack trace out of there might be a bit
tedious might be a bit might be a bit
hard so as somebody has already observed
or suggested there is a better tool
called well Jay stock so what Jay stock
will do is will it will give you such
choices but there is if there is a
caveat it's not a snapshot it cut
through slice through all your threads
with with with all the stack traces if
you have that impression sorry but it's
not like that it's doing it only at save
points one thread at a time that's what
I found online that's what I was pointed
out online and what it means it's more
like this so if you have very short
running methods Jay stack is probably
not going to be the most awesome tool
for for examining holster because it's
quite invasive because it involves save
points it's it's it's not maybe not
damaging but it's like looking at the
schrödinger's cat with a box half open
that's not really going to work that's
not the way you won't observe so just be
aware the thing is what you what Jase
that will produce is it will give you
the thread ID in a hex format so if you
want to convert that into linux work to
correlate a stress that you see under
top or H top you'll have to do the
hexadecimal conversion but that's easy
you will also get to see well waiting on
object monitor so what are our two
threads that are waiting on the same
same things AJ stack will suggest that
there might be a dead log and by default
that's what you get but there is there
is of course a hidden flag
hidden a non-default like that is
printing out something very very useful
and now you can see that bit so
what I've added is the L flag for J
stock and that will print us it will
print the money towards that the thread
is working on and the owners of those
monitors which is a much more well it's
a much more complete set of information
so you want to examine if there is
something happening in there you can do
that and another thing is if you have
long-running transactions so something
running in matters of seconds maybe
minutes maybe hours and all running in a
single thread there is there is a way
for you to interact with that output you
can see the reference handler well
you're not going to rename the reference
handler thread but your application
threads can change the name of the
thread they are running with so I've
seen situations in which especially for
transactions that would take a matter of
minutes people would collect J star J
Stax collect stack traces with j stack
repeatedly every minute and then they
would have the transaction ID or a
customer ID or some sort of key that
would allow them to correlate what's
happening from a business logic with
with a stack trace to be able to say
what what the system is actually doing
this is possible you can if you set your
thread name to something you will see
that in in the stack trace and also you
might say you might see that kill minus
free and the output from that is very
similar to what we're seeing in here and
this is for a reason because it's using
the very same code paths in the JVM so
there is it's a sync signal handler if
you're doing a kill minus free and what
Jay stock is producing itself away this
is using the same code so demo we've
seen that and now jay is that what would
what can what's the format of Jason well
it's you say which metric you want we
say which options you want you say what
did you want to interact with and then
if you wanted to repeat itself you are
the interval an account so let's go back
into the console
and nothing is happening okay it's
nothing this happening will work we'll
work around
so we get to see some output mmm that's
not really super useful but if you're
familiar with iostat what vmstat this
tool is aimed to offer similar
experience for the JVM let's say we want
one seconds delay intervals and we want
ten samples to be printed out and let's
say we want Heather every two lines and
this is what we get in here so we get to
see some output I chose I said Jay stat-
GC the obvious question to ask right now
is how do I know what flags are there
how do I know what formats are there how
do I know what can be printed out so the
answer to that is well there are the
custom options the formats that are
available are actually part of the JDK
sources so you can see all those options
in here we're obviously not going to
read through all of them but I wanted to
show them to you for this reason you can
create custom metrics sets you can
create a custom format if you curl only
about the very specific set of metrics
in a specific format you get to do it
you can do it for your specific user on
a system and then use it exactly like I
used minus DC which is predefined you
can use it next to it so to me that's
quite useful that's quite handy if
you're going to use j stat j study is a
demon that will allow you to expose
processes so that Jace that can connect
to remote machines there will be no demo
because it broke so sorry it sometimes
works sometime doesn't it's not the most
stable creatures out there unfortunately
I just wanted to mention that if you're
really desperate it might help it's not
super though I have problems running it
sometimes well from time to time it just
doesn't want to it will expose your
processes and now let's move on to
something newer so all the tools that I
you've seen so far have been part of the
jail part of the JDK and they were there
in the 1.6 times and you could of course
a year but we were on 1.8 but who here
is still not using which over 1.7 Oh
later yeah there are a couple of hands
in here and yes last year on a
conference I met somebody who said that
they are going to upgrade to Java 1.4 so
unfortunately well there are people who
are still using older versions of the
JDK or some of the tools that you might
be using might force you to use an older
version of the JDK so while I would love
to say that JCM d is the tool that you
can use because JC DMV was introduced if
I remember correctly in Jogja 1.7 if
sometimes you need to examine another
application it's only further I'll show
you the older tools and then you can
well if you're lucky working on with a
newer one you win but if you if you're
not for those rare cases in which we all
you have to explore the old but might be
useful so Jay CMD that is supposed to be
a one-stop one-stop shop for all your
comment line needs for examining a JVM
so what it does well let's look at it so
let's do J CMD and it looks very similar
to jps by default so let's do jcm d
minus minus help and it's saying that i
need to posit it and I can Wells's say
what's what I want to do or I can
oops not clear no common specified so
let's say help the process is already
gone so let's pick another one
you can see that the following comments
are available and somebody might you
might wonder why why does it say why do
I have to say to specify defeat at first
and then I get the list of commands
available this is there is the reason
reason for that different versions of
the GV of the JDK will ship with
different options being available so as
time goes on new options are being
implemented so you can do more and more
and more and more and more early 71.7
releases had this list much order and
because you don't know what you might be
connecting to it's it's just you you can
check whether the options that you want
to go for are available what can we do
in here well we can take let's grab a
class histogram so we can see what
classes are are there in you can take a
heap dump which is something that you
have already seen with Jay map you can
see stack traces you can see the version
you can see the comment line so yes this
those things are repeated and there are
repetitions across tools and I would
expect that the situation will be
cleared out so some of the tools that I
have shown you in the beginning will go
out but they are still there and as of
today well you can use whichever one you
prefer jcm d if you are on a newer
version of course is so much easier
because it's a one tool to learn and
then it does all the things for you but
if you're not that lucky or you have to
do some archaeology well you know that
you can well let's go to something
well-to-do very last tool that we should
see today which is the G visualvm this
is the last tool because it's a it's a
visual thing so what you can do is well
let's examine that you can examine
processes one who here is familiar with
Jeff is well BM and do you know that you
can use plugins in it yeah some people
do for the rest of you jet visualvm is a
tool that's shipping with your JDK so
it's
under bin directory as the other tools
it has a UI is built on top of NetBeans
platform and it supports plugins so some
of the option is some of the option
isn't there and you really want it to
happen you might go for it look for a
plugin or you can actually implement a
plug-in yourself and there is a plugin
that i usually recommend installing it's
called it's called visual GC it
visualizes what the GC is doing why is
it good because for in all the arguments
that I've heard the places I used to
work for I think having a visual
reference about it helps clear clean up
the disagreements because somebody might
say that this is not working because
this this is not working because that
yes you can examine the GC dog with a
tool like Jake clarity I mentioned
before but this will this can connect to
a process running and this can well give
you graphs that will change and move so
if you want to understand or if you're
just trying to explain some some ideas
or some problems to somebody else let's
say you have a junior in the team that's
a good tool because a picture is worth a
thousand words and a moving picture I
don't know what the conversion ratio
would be but it's for explaining things
on the life thing it's it's unbeatable
this the caveat is you have to install
that plug-in to be able to install you
have to know that you can install but
now you know and apart from that what
can we do in here well we can see not
supported on this JVM okay that
sometimes happens you can see the
options yeah we've seen that before you
can see the system properties yes we've
seen that before you can see the heap
occupation you can see the matter space
how many threads are in there blah blah
blah blah blah blah you get to see you
get to see what the threads are doing
you can take of course a thread dump
with the caveat that I mentioned for
Jace that you can take a heap dump
somewhere up here
let's click and then we get to analyze
it of course it's so much nicer because
it's visual i can click the caveat is j
hat so did a very basic very basic HTML
based interface that you've seen before
is something first of all that you can
script against and second if you're
examining a system on production at a
very remote location through very
obscure security measures sometimes all
you get is is Carol or sometimes links
it's a it's a terminal based browser and
that's when this tool is not going to
help you too much because you won't be
able to run it if you can run something
visual of course it's helpful but
sometimes you are in situation in which
you can't and well you get to see you
can examine things using oql so let's
see we can actually run the query that
we have failed or not so badly before
everything edit or you know it helps to
run the query in the right window yay it
works now you could say that this is
well precomputed but if i say 200 no I
still executing so we are you get to see
that the list of strings is actually
much shorter now so you can do nice
things you can well look for integers
that are larger than a certain value and
our part of a map or whatever your
imagination or needs such as you need to
do also you can take the hip damn that
we can that we took with with Jay map
and examine that using here so that's a
very that's a much nicer way to work for
me so just mentioning one cut one
important thing to stress out again try
not to examine a live system because
that will impact the live system and
that will be slow and if your hip is
large navigating a large graph of
objects will take time just because it's
a large graph because there is there is
a lot of things in there that's just how
things work that's nothing surprising
and
moving forward do we have any questions
there is a question yeah how do I get to
the oql think so let me open well
visualvm you get to I open the heap dump
and I see you start with a summary or i
can try opening a heap dump or maybe
maybe let's not tempt the democrats but
in here you just open a gita minister
the tutorial is available online the
tutorial is available as part of as part
of j hat and there is a lot of good
resources online that you can suggest
the right we restore to execute anybody
else
ok
then thank you very much for attention
and i will appreciate I really hope that
you learned something today and that he
pushed you in the right direction at
least for that one moment in which you
needed and i will appreciate if you
click the button obviously the green one
or two send me a tweet and if you have
any questions i have 5 to 10 minutes and
then i will need to switch hotels thank
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>