<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Reactive Programming for Java Programmers | Coder Coacher - Coaching Coders</title><meta content="Reactive Programming for Java Programmers - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Reactive Programming for Java Programmers</b></h2><h5 class="post__date">2015-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/fz31sbwOYq8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">well welcome to the session on reactive
programming for Java developers my name
is Michael Subramanyam we're going to
talk about this interesting and exciting
concept that people are talking about
more recently best time to ask a
question or make a comment is when you
have it so please don't wait till the
end any time it's a great term for
questions comments raise your hand draw
my attention and express your thoughts
be more than happy to listen to you so
let's get started the very first
question of course is is this something
totally new well in my time in the field
over the past us a few decades there's
one thing I've realized that is
happening in our field right about every
10 years we'll give a new name for what
already exists and get excited about it
so this time we are getting excited
about something called reactive
programming which is absolutely nothing
new so thanks for coming for the talk I
hope you enjoyed it
right so the point really is in a way I
would relate this back to like XP or
extreme programming extreme programming
really has nothing new in it and yet
there is something new in it and which
is a greater emphasis on doing a set of
practices now similarly you could say
that reactive programming has nothing
new in it and yet what's new about it is
doing a certain set of practices with a
great amount of emphasis and in this
regard while XP was about software
development practices this is about
certain technical details about you know
that stuff that we care about in this
room at the code level so this is really
a old concern but with the renewed
urgency and the reason for the urgency
is that the world around us has changed
drastically now when I say the world has
changed drastically I'm thinking about
you know my own experience and I'm
almost in tears when I say this to you
because I'm very nostalgic I remember
the days I would turn on that modem and
I could hear the modem you know some of
you probably have experienced that
others are like wondering what are you
talking about right well I could hear
the modem cranked up and it would fail a
few times and retry and while it makes
that wish sound
coffeepot would be written to someone on
the other side and then once I get
connected I would call my friends and
check with them what their baud rate is
today
that was back worst of the time best of
the times back then right
well speed didn't matter back then as
much we were lucky we got connected but
today we got entered enabled devices
with us we got people using multiple
devices
we got devices in places you would not
even imagine and very soon people are
talking about very variable devices
people are gonna have earrings nose
rings tongue rings with Internet enabled
devices and what's going to happen when
that happens right so that means we're
gonna have not only big data but very
high volume and high frequency of data
access and that's going to really turn
things much more wild than it is right
now
and with Internet enabled devices it's
only gonna get really really intense and
of course we are looking at usage
patterns and the lady in the back of the
room I cannot accept you standing there
so come on over here and we'll give you
a first-class seat here so all the way
up come all the way up and and the real
challenge here is with all the patterns
and things that we have here we are
really looking at usage patterns of
people how they access things
continuously and and that is really
again changing the way we do things so
the first question is what are we really
really looking for we look looking for
applications that are very reactive now
what does it mean to say that
application is reactive now within the
u.s. at least most of us can agree that
the word reactive has a negative
connotation now you don't go to somebody
and say you're a reactive person right
you just lost a friend if you do that
but so the guys who named this obviously
didn't think of it had they they would
call it proactive programming right
there would be more you know exciting
but the word reactive in its true sense
of the definition is that you are really
responding to stimuli at a very good
rate and and so in a true essence of
reactive not the negative connotation
but the true meaning of reactive it
really is what it is so it is really
about even driven and again we all can
agree that this is not the
first time we are talking about a winter
event it is about scalable and we all
know that scaleable is one of the most
overused words in our field nobody knows
what that means but we all want it and
then it's very resilient that it can
actually respond and and survive when
things do misbehave and of course it's
very responsive now one of the things
that we really should care about is
responsiveness most of the time not all
the time but most of the time we do
multi-threading to make our application
responsive now responsiveness can make a
difference between having a longtime
customer versus losing one forever
now you all know this very well right
you walk into the neighborhood
convenience store as soon isn't walk in
you see the clerk busy with the customer
and then you stand around for a few
minutes you look around and there's no
response what do you normally do within
about 30 seconds you leave right that's
what I do as well everybody does that
but as soon as you walk in the clerk who
is busy immediately makes an eye contact
with you and says we'll be with you
shortly please and then goes on to do
stuff you probably have waited 20
minutes in that store because you feel
important even though you really are not
right so the point really is that that
we really connect and we feel that hey
there's been really some response here
and as a result I would rather stay
around same thing with applications you
will sit an application and you see this
pin what do you do you do either leave
or even worse you hit the refresh button
and what happens when you hit the
refresh button there's more load on the
system and you are causing the problem
now and it only becomes much more slower
and you become part of the problem then
part of the solution at the point and we
all tend to do this so so why can't we
just depend on multi-threading and be
happy well the first problem with
multi-threading is how does it really
work you go to the server you spin
threads and while the server is busy
spinning threads what is your client
doing often waiting for a response right
they're waiting and blocking and light
and then use their timeout that you
eventually get the response
well the server unfortunately what's
going to happen there's only so much
memory you can have on the sir
which translates number of threads you
can have at a given time well the more
threads you have coming in you need to
have more servers and now you have a
form of web server serving the needs and
what do these forms of web servers do
they take time to process and the user
keeps hitting refresh and the threads
are being blocked up to do but you know
useless word and we need to expand our
form even bigger that's not going to be
the solution the other problem is let me
ask you this question you call it thread
and that thread just exploded
it had an exception in it what happens
that's the right answer right nobody
knows right it's like good luck tough
lock we don't get the response properly
we eventually timeout if you're lucky
and what happens that exception and even
better when multiple things blow up how
do we know what actually went wrong and
we kind of ignored that along the way we
said you know everything is gonna work
fine when it doesn't and so as a result
multi-threading thoughts short in
allotted for ways what about futures can
be just not futures
I love futures because you call a
function what does it do it returns a
future what do you do you call get on it
and wait right that if that future is
very bleak right so it's like why why
bother to just call get and wait on it I
might as well just wait on the original
call if you're gonna just call get right
so that doesn't really you know make
sense call back well what about call
backs the only thing I would recommend
is if you have a friend who does
JavaScript never talked to them about
callbacks right they hate callbacks
because it isn't compost very well the
curtains were into a monster it's
horrible so essentially these are
patchwork technologies none really that
helped us to deal with the problem
properly so as a result what we want is
efficiency but in terms of efficiency I
want to make a claim here efficiency is
attained not by doing tasks faster but
by avoiding those tasks that shouldn't
be done in the first place so if you
really want to be efficient don't run
faster don't try to outrun everything
else be smart to avoid doing real work I
mean this is something we all know at
work right the boss says do this and
you're like I hope the boss will quit
before I have to turn this end right or
you know it's like tax returns I never
fair file tax return to the last day I
mean once I'm gonna die on 15th of April
why waste time filing taxes right so
that is called being lazy right so the
point is this is called the last
responsible moment and if you don't have
to do something you would avoid doing it
and what's the benefit of that you're
more efficient only doing what you
really really care to do so the point is
if we can model the system in a way we
can be very lazy and only perform work
on demand then we don't need as many
threads we become more scalable by
minimizing what we actually do rather
than increasing the resources for doing
it so that is one of the very
fundamental approaches in reactive
programming and the second thing is we
really have to get over this we have to
respect failures we treat failure as a
second great citizen maybe a third great
citizen and we say you know what we will
not worry about it right now
and when it happens we will treat it as
an exception there is no reason to treat
exceptions that way we really have to
start handling failures from the get-go
and and if we have a nice way to handle
that it becomes much more easier to be
resilient when things go wrong not if
things go wrong but when things go wrong
because we know that Murphy is always
sitting there and watching us so the
point really is this is really I see as
a next logical step from functional
programming and functional programming
really leaves two things to us one is
function composition and the other is
lazy evaluation and reactive programming
really builds where functional
programming leaves in terms of this
laziness and function composition I'm
going to look at some code examples and
work through it if you're interested in
the code examples I'm going to show you
here you can download them from my
website I'll post the URL for you way
down below as well so there's no rush
for you to note it down but that's where
the examples are going to be located and
you can download it any time at your
leisure
no rush at all now so what does it
really mean to be reactive we already
have used observer pattern now think of
this as observer plus plus normally what
do you do when you use an observer
pattern you are using an iterator you
pull the request response that comes
back and then you subscribe to observers
but let's take that to the next level
imagine you are really dealing with a
flow of data like for example I'm
interested in a weather report or I'm
interested in the local news I turn on
to NPR station locally what's going to
happen well I can listen to the radio
program right now but a few minutes
later I could turn it off and go do
other things because I no longer am
available to listen to the radio well
the radio station doesn't care they keep
transmitting it even if you think it is
around or not so think of this as a
source that keep streaming data to you
and then you can subscribe and listen to
it anytime you want to it is a push of
the data rather than the pull of the
data the server will keep pushing the
data to you once you subscribe much like
the radio station is pushing data to you
once you turn on your radio but it also
can tell you when the signal ends so you
know that you're finished getting the
data and you can say you know what this
is the end of it I can notify the user
do other transactional activities
whatever that may make sense you could
do that and also you're very respectful
in dealing with errors you're not
treating this as a second great citizen
you are going to be very clearly
deliberately handling errors right and
let's find the word to use is you handle
error errors deliberately rather than
accidentally yet the communication could
be synchronous asynchronous or lazy and
it could work in any of those ways so to
understand this we're gonna work through
some little examples well I need
somebody with a with a smart phone here
who can help me who's gonna volunteer to
help me one person you sir what's your
name early you're gonna help me already
all right I want you to tell me the
stock price for these three stocks
Amazon Google and Oracle early are you
done
we're waiting here early come on this is
just not this is not good enough you
sign up for a contract we're
disappointed early he's giving up smart
man
thank you for your help okay so this
illustrates the worldwide weight that we
live in right so you make it a customer
at server what are you doing I said done
is it gonna work am i waiting and what
do you do you give it a load of data and
you're waiting on the data right so what
did we do we put things like Ajax all of
those are patchwork technologies again
right so the point is we need a better
way to deal with this how could we
really get better at doing this well
let's give it a try so we're gonna write
a little service for doing this so we're
gonna use an observable stare stream one
that is a lot better than Ali's service
right so that's what we're gonna use
over here so what do we do he's like I'm
never gonna show through this session
anymore to be insulted right absolutely
so what we gonna do here is we're gonna
start with the service the service I'm
gonna start with is I'm gonna say stock
server for lack of better words and I'm
gonna question for the person in the
very last row give me a thumbs up if the
point for incises enough are okay
excellent if you want it you know bigger
don't hesitate to let me know I have the
ability increase the font size so so we
gonna have a server I'm gonna say get
feed over here and I'm gonna send the
symbols over to this that's my first
call so as soon as I make this call to
get feed let's take a look at what this
is going to do and the get feed method
we're gonna implement it is gonna return
for us an observable
now what is this observable will be
going to return to me it's gonna return
to me a stock info now in this
particular example I'm using rx Java
there are several implementations out
there I mean that's one rule in Java
right you never find one solution that
works
you should have seven solutions you'll
fight over the next year to figure out
which one to use so I'm gonna use rx
Java rx Java what is a open source
library created by Netflix apparently
told that they have some streaming
problems to deal with so as a result
this is a very natural you know solution
for them to look at so there is an
observable that I'm gonna create on a
stock info while we are here let's go
ahead and take a look at what this stock
info is and get it out of the way well
the stock info as you can see here
contains a ticker and a value that's all
it contains a constructor that sets
those two values and a fetch method that
goes to Yahoo Finance and finds the
stock price for a given ticker symbol
and I've got a few things commented out
we'll come back to that and a two-string
method simply is printing the
information about this particular stock
so in other words what is talking for
just a POJO and it has a fetch method to
go get the real stock price and I might
turn off that along the way if I'd
really need to because if it gets a
little slow in communicating I might
actually just use a mock object instead
of using a real object but we will
decide that along the way as we make
progress
so the point really here is what am i
doing in the get feed method in the get
feed method all I'm doing is I'm simply
returning back the observable so in
other words you call get feed that's a
non-blocking call you immediately return
with an observable now that observable
of course doesn't exist do anything yet
we'll come back and fill that in just a
few minutes from now let's get back to
this code and see how we're gonna use
that in a moment so if I go back to the
sample now what am I going to do now
that I have an observable on my hand I'm
gonna store it as a feed over here
that's what I just did
so now that I've stored it as a feed my
next job here is to go ahead and
subscribe to that feed so that I can
start getting the feed of data so I'm
gonna say feed Dart
subscribe and what am I going to send to
this particular subscription well I'm
gonna get a stock information on my hand
so I'll call it as stock info and what
am I going to do with the stock info in
my example I'm going to simply print out
that stock info so system dot out dot
print line and I'm going to simply say
stock info and I'm gonna simply print it
we can even minimize this quite a bit
and make it extremely simple
by simply using the Java 8 features of
method references so we don't have to
really write that much of code at all to
make this work so all that we are saying
is once you get a stack that's talk back
simply go ahead and print it that's all
we did
and of course over here I'm gonna simply
output for a second I'll just say end so
we can see the end being printed well
what is the next step of course the next
step is we need to go ahead and
implement the get feed method because we
need to be able to get the observable to
work so in this case what I'm gonna do
is I'm going to simply say observable
dart create and I'm gonna create an
observable now look at the laziness in
these particular concepts you come to me
and say can I have something please I
don't give it to you
but instead of give you a producer off
it a factory off it right that is called
being lazy link it really doesn't do any
work you keep sending other people who
promise they will eventually do work
right that's kind of a model you're
postponing it until you really really
can no longer postpone it
so the create is simply returning and
observable and saying here hold on to it
while you think about it right and then
he comes back to the observable and says
hey I want to really do some work then
you go another time and create another
object now so this is going to be a
subscriber that you're gonna get on your
hand so now that I have a subscriber on
my hand what am I going to do with the
subscriber well the subscriber is
interested in the feed of data after all
so I'm gonna say while true and in this
case I'm gonna simply say repeatedly do
some stuff I'm gonna say sleep for let's
say a second and then repeat this almost
endlessly so what is the sleep method
I'm gonna create a static method called
the sleep and all that I'm gonna do is
simply say thread dart sleep here for
that number of milliseconds and I'll
simply say exception and of course in
Java we are all experts and handling
exceptions I'll follow that pattern and
so what I'm gonna do here is I'm just
gonna sleep every second but while I'm
iterating through I'm gonna say far and
I'm gonna say string symbol which is in
symbol
and what do I do now I'm gonna say stock
info equals we'll call it info equals
stock info dot fetch and what am I
really fetching for the symbol that I
have on my hand I'm making sense so far
right so for every symbol you're making
a fetch of the data but then what do you
do
subscriber dot and then you say on next
and then you send the info to the
subscribing client so notice the
communication now you you come to me and
say can I have an observer please
I immediately give you an observer
expended no effort at all then you go to
the observer take your sweet time no
rush when you're ready you say subscribe
and what do I do
I got you contact you which is the
subscriber and then I take the time to
fit the data and when the data is
available I push it to you using Leon
next makes sense so far so so it's it's
really you gotta be able to see this
kind of a back and forth communication
that's happening please how is this
different from call back the call back
is the first step in this direction but
how do you really compose things in a
call back because it's a stream your
stream could be any number of nesting of
data to push because it's a stream of
data so I can push either values for one
request or many requests I can package
them and push so this is really well
whereas in a callback you gotta worry
about the layers second thing in a
callback
you gotta seperately register for a
error channel as well if you don't
register what happens well in this case
it's going to streamline a lot of these
things right so it is not we're not
avoiding callback we are streamlining
callback right that's what's that's what
we are doing in this case so that
composes a lot not more easily and and
so as a result if I go back over here
let's go ahead and run this and see what
it has to tell us why in this particular
case and when I run this of course it
gave me an error obviously because I've
not connected to the web yet so let me
just turn it on so
now that I'm connected to the web let's
see if that's going to go to go through
so I'm running through it and notice it
says Amazon and then about one second
later well actually it's not a second
later that's a delay in fetching their
data actually and that's the latest
stock price for Amazon Google and Oracle
and it's gonna keep pushing that to me
as fast as he can get the data and I
just put a one-second delay I could even
remove the delay and then it would be
really the pace at which its able to
pull the data that's what it is doing so
all we did so far was we just
implemented the observable but there's
one other problem going back to your
question about callback write callbacks
don't quite handle any of these right
what do you do with callback you have to
put together all of these yourself what
does this is like a protocol or a
standard way of interacting now what's
going to happen let's say I go back to
this code and I'm interested in let's
say a particular stock price and as soon
as I get the stock price I no longer
want to continue receiving the data now
what would be a good example maybe I'm
interested in only trading and I see
that the stock price has gone below a
certain level I'm no longer interested
and what's the right thing to do just
tell you that don't send me data anymore
what's the benefit of doing that the
benefit is I'm saving you a resource by
saying don't keep telling giving me
their data well typically what happens
in a web application let's take an
example if Ally is willing to help me
again
right early what's the stock price for
Google and notice as she's busy doing it
in the meantime I'm gonna say and walk
away and what does he do works really
hard and when he is done he says okay
it's like where's the user right so that
was a complete waste of time doing work
when that is of no longer use importance
so if there's a way to communicate that
and say I'm done don't do this anymore
so notice what I'm gonna do here I'm
gonna escalate this a little bit more so
this time I'm gonna say on subscribe so
essentially I'm gonna bring in a
unsubscribe stock info and I'm gonna
implement an inner class here for us to
work with so in this case I'm
subscribing to the subscriber so
I'm gonna say in this case new
subscriber and uncomplete is going to be
called whenever the end of stream is
attained how do I know it's on complete
while technically when you get out of
this loop in this example not so but if
you are done you would say subscriber
dot and you would say aren't completed
so the signals to the subscriber that
you have no more data to to send and
like I said I won't do that in this
particular example but there's a way to
communicate that likewise here I'm gonna
output the information so I'm gonna say
output and in this case I'm gonna output
let's say the stock info however there's
one more thing I'm going to do let's say
for a minute if I don't remember what
the price of Oracle was well $38 let's
go ahead and say if the stock in for
Dart let's say ticker is equal to let's
say ORCL and and I'm gonna say and stock
info and in this case I'm gonna say dot
value is greater than 38 well then what
do I want to do I could simply say
unsubscribe I'm no longer interested in
receiving the value make sense so far
well if I run this code though what
you're gonna notice is that you are
price for Oracle is greater than 38 but
you notice it keeps going and the reason
for that is our service right now is
like some some people that you work with
while they're trying to explain you got
it you say I got it and they don't stop
right they keep going like I really got
it and they still keep on going it's the
service is kind of like that right so
you tell the service no do don't do this
I got it really so what you do is while
not of subscriber dart
es unsubscribed so now you are saying
only continue to pull the data when the
subscriber is still active and the
minute the subscriber is gone or no
longer interested
don't waste your resource that time and
effort is resources put better in some
other place for some other purpose so
when I run the code now you
can see that the first time that Oracle
reaches I got to the end because hey
that was the $38 for Oracle I'm happy
with the price if the price was lot less
than that of course I'll keep pinging
and of course the condition is what you
put based on what you're trying to do so
far so good well but we all know one
thing if something can go wrong it will
right R so does Murphy's Law say so what
happens when things do go wrong well
what do we normally do in case of an
error well the first thing is we try to
throw an exception in a multi-threaded
situation it really makes it hard to
throw an exception properly and even
worse let's say you run into a network
error or a database error and when an
error happens you notify of that error
but if you have a stream of data coming
what do you do right after a error well
you say you know what that one failed
but I'm gonna go try for the next value
and the next value and then X value and
as a result now you pile up exceptions
and and you don't know what to do and
usually the application kind of you know
failed miserably in unpredictable ways
well wouldn't it be much more sensible
from the resource point of view that if
something failed you immediately stop
and say you know what I got an error you
deal with it now right now there are
certain scenarios here let's say for a
minute that Ally is our server who's
been giving us data well he runs into a
problem he immediately notifies me
there's an error and he terminates right
away and that's perfect for me because
he told me something went wrong I'm
happy that I know it's wrong let me go
figure out what to do right and I mean
make a call to the administrator so they
can come and investigate it I can do
other protocols I decide what to do but
you on the other hand say you know what
I'm not happy with that if it ever
happens I want him to continue for the
next request well the short answer is he
cannot because if it's a error most
likely a fatal error there's no point
trying to retry it until the
problem has been fixed however you can
think of the very modular approach here
this again goes back to how this builds
up is what you're gonna do is you're
gonna say well okay when Kurt is happy
to stop on failure but not me I want to
on ever resume next so you want to
switch over to some other service than
oli service because his service failed
but you got a backup service available I
worked on a project where we had two
services one was very reliable but it
was very expensive
the other one was unreliable but cheap
and you know how management things right
so they said that one of course well so
we use the unreliable service which was
very cheap and it worked fine most of
the time and the time it fails I would
quietly satoru the expensive service
right and then I would use that until
this guy comes back up in the word
switch over to this so he can engage a
backup service like that very easily so
how would that look like so let's
quickly take a look at an example of
this here so notice what I'm going to do
well the first thing I'm gonna do just
to illustrate this point about error
handling s I'm gonna go back to this
code here and I'm gonna remove all that
wee bit here for a second
and I'm gonna only print the result that
we just got upon subscription so we
subscribed I'm gonna say system dark out
and I'm going to just print line that
over here and that's all I'm gonna
display for a minute so when I run this
of course you can see it is constantly
sending the data to us that's great but
what I'm gonna do now is I'm gonna go to
the stock info and at random times I'm
gonna throw an exception right so this
is like you have a network error or a
database error or somebody status at on
the on the off switch whatever that cost
the server to you know go down and and
I'm gonna simulate by throwing an
exception to say oops I ran into some
trouble so now notice what's going to
happen if I go back to the code right
here and if I simply run this this time
notice that it starts up it keeps going
with the data feed but at any time there
was an exception and it blows up and
usually an exception happens within
seconds to number of days there we go
so in this case notice what it said look
at the error message on error not
implemented exception so it clearly says
you know what this is really sad you did
not care of exception handling right at
this point it probably called my mom and
said what kind of child did you rise you
know it doesn't deal with exceptions
properly right so I've got a long talk
this evening with my mom it's like you
should handle it or sweetie I've been
telling you this since you were in
diapers right so the point really is
that this really says you better handle
exceptions right you have to do this so
the point really is that I've not dealt
with the exception and but I should so
what am I going to do I'm gonna go back
here and say on Subscribe and this time
of course over here I'm gonna receive
the data and print it like we just did a
few minutes ago so this is going to be
the stock info but on error I'm gonna go
ahead and print the details over here
off the throwable as well or I can take
whatever action that may make sense that
I decide based on the domain that is for
me to decide but notice this time though
we got some data it ran into an error
and it gracefully handled and said oops
I ran into trouble let's understand what
we just did what what we are doing here
is if you are a observable you don't
provide me one channel you provide me
two channels one channel is for data
feed and the other Channel clearly is
for error now why is this better
the reason it's better as a we're not
throwing an exception across the wires
across the threads we are passing the
exception because we are passing the
exception you can take the exception and
capture nested exceptions in it if you
have a SQL exception you are not losing
it right you'll capture the exception
you serialize it to the other side and
you can get the exception on the other
side the second benefit in this case is
you are not receiving data and you
sniffing it to see if it's a real data
or error because often we introduce
errors while handling errors in this
case the channel is very separate
hey this is error coming through when
you hear the bells go off on this it's
time to go do some serious handling of
the error so it used a full credit to
add credibility to it and treats it as a
first-class citizen you got two two
channels coming in making sense right
but of course the question is he says
yeah yeah that's great but you notice
that everything stopped at this point
and I don't want the service to stop
because when this happens I wanna roll
over to a backup service well that's
your concern not mine
right because I don't want to roll up to
a backup service I may want to go back
and check if the service to see if
everything is fixed or send somebody our
agent to fix it well as you're saying
you know I want a backup service what do
you do well you can easily go into a
backup service if you choose to so
notice what I'll do here in this case
I'm gonna go to the feed and I'm gonna
say on error resume next so think of
this they are the architectural way you
have a service now you're attaching a
chain service to this service kind of
like a chain of command pattern right
and this attached to services you send
me a request
I send Rico's to the original service
the service is streaming and I'm just a
pass-through service I'll pass whatever
I get to you but the minute this guy
fails I will grab the exception and
start another service hand the exception
to you and start a secondary streaming
because the first one is dead but I got
a backup backup going for you and it
makes sense so it's look at the beauty
of the configurability in this case the
service is still intact one user of the
service says this is good enough for me
another user of the service says I'm
gonna bring up a backup service right
and they can attach a backup service
it's a complete chain of responsibility
or a decorator pattern depending on how
you want to call it but nice
extensibility going so
in this case I say on error resume next
and what do we do in this case I'm gonna
get a throwable on my hand and when I
get a throwable I'm gonna print the
throwable out and then I'm gonna return
from here a backup service so the backup
service I'm gonna create here he is
going to be stalked a server but it
doesn't have to be right it could be a
different server all together with other
parameters like reliability or location
one service maybe in the East Coast
another maybe in the West Coast you know
things like that and then so you have a
backup server get feed symbols and
you're configuring it with that over
here and then once you do on a configure
on that one that becomes your your
throwable that you have on your hand and
and once you get that particular object
the next step in this case is to go
ahead and subscribe to the feed on that
particular object right now so so
essentially the idea is you're saying on
error
don't stop resume to the next one and
here is the backup server that I want to
provide for you and start from that
backup server and and then you go ahead
and subscribe to it so now if i well
let's do something else here so I'm
gonna output here a little Asterix and
then first service serve the first
service failed and and I'm gonna display
the error so if I run this little code
now we are going to the first service
now as you can see that's happily
responding to us at this point but at
some point the service is gonna run into
trouble and it's gonna fail and then
when it fails what are we going to do we
go to switch over to the backup service
let me actually get back to writing this
properly here so this is going to be the
service that we got to take over from
here on return so let me actually go
back to getting that service apart on me
here so this is going to be the
secondary service will call it as feed
to and I'm gonna go to the feed to and
subscribe on it for getting the response
back over to it where's the feed to so
so that's going to be the place from
which we're gonna get the response back
yeah
all right that's fun so that's basically
the idea is that you're subscribing to
the feed and getting the feed from the
secondary service that's gonna be feed
too right all right
so given this you are going to fall back
when something goes wrong and you're
gonna work with it when to rely on the
backup
really so there we go hopefully so my ID
doesn't want to cooperate as you can see
anyway anyways so you get the point so
that's basically the idea is that you
fall back on on a backup when you get
there well okay
but there are times when I want to do
something a little different I want to
start however I am NOT interested in
stock prices until stock price is a
certain value so let's give it a try for
example let's say for a minute I'm gonna
get rid of all of these for a second
let's say all I'm gonna do is print out
so I'm gonna say in this case system dot
out print line and in this case we're
getting the values as you can see as the
execution runs through however what I
want to do is I want to only get the
data when the data is a certain value
that I really care about like what maybe
I'm interested in a particular stock
price over a certain stock price well in
order to do this unfortunately I don't
have the power to manipulate the market
so I'm gonna mock up the data so I'm
gonna say true here to say you give me
some mock data and I'm gonna remove the
exception for now so now that I'm gonna
mock up a data notice what I'm going to
do when I look at the output this time
you can see that I'm just throwing some
mock data that is being generated right
here however well that these actually
are better stock prices than what we saw
originally okay but nevertheless but I
don't want that price until a price it's
a certain value so notice what I
do here I'm gonna go back to this code
right here and say skip
there are several skips you can use
there's a skip for number of times you
know what skip the first ten values why
I don't know maybe your service requires
a little warmup period right and during
the warmup period the data is really not
that good so you're like spindles
don't give it to me the first 20 values
throw them away it could be skipped 10
20 or skip for the first 10 minutes
because my server really takes 10
minutes to warm up produce good data
whatever that could be right if it's a
refinery
maybe things take certain time to warm
up so that first 10 minutes you don't
want it whatever that could be right or
skip wile and you can say what your
function is stock info and I'm gonna say
stock info dot value is less than let's
say thousand so if the value is less
than thousand don't bother disturbing me
I'm not interested but the minute the
value is about thousand I care about all
values it may go two thousand and one
dollar and then come down to nine
hundred I still want to know it right
but but are not until it hits a thousand
so if I run this code now notice that in
this particular case it looks like it
hit the value quite early let's actually
say 1900 that should keep it a little
while so I'm gonna go ahead and run this
code now and notice as soon as it starts
up
there's quietness right there's
quietness why do you notice that it was
quite for just a little bit right until
the value goes about 1900 and the minute
it does you start getting the feed after
red but not right away
so when I run it again notice there is
nothing happening right now until right
there it's still empty because the
generator is generating but where is it
going it never comes to you the skip is
simply removing it and saying don't
bother this guy he's not interested
because you haven't met the criteria for
notifying and then it starts over
and so you can okay you can say that's
great however I don't want all the data
I only want data just a little bit when
I reach a threshold right this could be
a particular equipment or a device in
the field and it hits a threshold and
now you are interested but you don't
want to be bombarded forever give me
about a minute worth of data when that
happens right so what do you do then
skip wild dot take you can take the
first value right hey you know what I
hit a threshold give me one value now or
take the last value or take for a
certain duration
about one minute or simply take for a
certain number I want ten values again
just like skip take comes with different
flavors and you can say skip for those
that long and then take ten values when
it comes or skip for that long and take
for that long right so you can think of
scenarios where a device which is a
threshold and then you start receiving
for our duration you say and then it
quiets down after that you can see it
stopped automatically after that period
of time so you can start configuring
your stream of data based on your needs
like you just saw here and then you can
pick and choose what may make sense
depending on what you're trying to do
well all that is great but where are we
running this so to understand where we
are running this I'm gonna go ahead and
write a method here called a print info
which takes a stock info and I'm gonna
simply print out over here the stock
info so output I will say stock info now
in this case not only am I going to
output that but I'm also going to output
thread dot current thread so we can see
what thread is displaying this
particular data so if I go back over
here let's get rid of all these skip
things and I simply subscribe and I'm
gonna send this to the sample print info
method so when I run this code you would
notice that the main thread is what is
running everything
so we are purely synchronous at this
point you make a call you are blocked at
this point and then you're getting back
a response right so you could certainly
do that just like that some rules we
have to follow the very first rule is
when your client receives a bear from
the publisher
you should very quickly respond back if
you're gonna take time then you're not
allowed to do that because you're
holding the server when you are taking
the time to do the processing right that
is one thing but you can still say I
want this to mean a different thread so
how do you do this so subscribe
subscribe on and you can subscribe on
certain things let's say how we gonna
subscribe on so I'm gonna go back over
here and I'm not going to do subscribe
at this point instead I'm gonna say
subscribe on and I can specify what is
called schedulers now let's think of
different types of clients I might be I
may be a client which is going to
receive a data and I'm gonna perform a
database access or I'm a client which
receives our data and I'm gonna send
this over to the network on the nor the
network to another server in all of
these cases I'm gonna hit the i/o pause
and what is worse is you're doing IO and
waiting on IO when you're blocking the
client and the server in the meantime
that's very inefficient so if your I of
bound operation simply say scheduler
start i/o meaning they put me on a
separate thread that will graciously
wait and block without holding the
active threads in my system or you can
also say new thread just give me a new
thread and I want to run it in the new
thread or you can say from and you can
say executors and in that case you're
saying I want to run this on a separate
executors pool thread so in this case I
would say executors dot new let's say
fix the threaded pool I've got a little
pool of threads waiting for me we'll
call it as executors so
executors and and now we can simply say
this is going to be in the executors
right so this is going to be the
executors let's actually make the
compiler happy right here so this is
going to be our executor service and
then I'm gonna say dart for each simply
go ahead and print the information that
you receive so sample and then I'm gonna
say go ahead and print it out at this
point but when I run this this time
though notice it's no longer the main
thread it is a pool one thread as you
can see because it has put it on to this
other thread and said go ahead and do it
in that thread I no longer want to hold
the main thread and block on it so as a
result you can have multiple different
pools of threads available for different
you know operations on the client side
and you don't have to hold your
resources on your side errors will
propagate the same way as well as we saw
earlier that doesn't change so you can
do asynchronous clients subscribe and do
all of this and the last thing I want to
show you is this is all great but there
is still one problem we are going to be
very slow because we take time to do
stuff what do we do so if I go back here
let's say after I process it I'm gonna
say thread darts leap and I'm gonna take
quite a little while to process this and
and print the result well this is going
to be simulating a time consuming
operation what do I do well if I run
this even though I'm in a separate
thread you're gonna see that it's gonna
block the server because the server is
waiting for the client to respond now
what is going to be the problem the
problem is if there is a very active
generation of data on the server side we
got several problems on our hand the
server is going to back up with data and
that data is gonna fill up and the
client is simply not responsive enough
and you're gonna have resource problems
on the server side you got to deal with
it right there's also things we won't
talk about here but important to keep in
mind is how do you deal with back
pressures right your service is
consuming at a lot lower slower rate
but you don't want to lose the
so you're telling the server hey I'm a
slow guy but I want you to buffer it and
I want you to give it to me at my pace
well somebody's gotta buffer it and give
it to you right
so all these increase the resource usage
how do we deal with all of these things
excuse me
so the point really in this case is you
want to be able to get the server to
send the data whatever whatever
mechanism it uses to cache it but you
never want the server to be waiting and
spending resource when the client is not
ready so what if we do something a
little different what if the server does
not produce data at all until you say I
am ready and it gives you data and
doesn't have any more resource on its
side until you go back and again and say
all right I got that taken care
I am ready again right so you
essentially have to ask for data every
single time because you are a very slow
client so how do we do that so notice
what I'm gonna do in this case I'm gonna
go back to the feed and in this time
though I'm gonna be a slow client so I'm
gonna ask for a producer to be given to
me at this point so what I'm gonna do is
I'm gonna say in this case I'm gonna
subscribe but the way I'm gonna
subscribe at this point is to really
start engaging with a request model so
I'm gonna say it's subscribe and just
like the previous time I'm gonna
subscribe new subscriber and this time
notice I'm gonna say are done just like
the last time and I'm gonna get the data
and when I get their data I'm gonna
print the data so I'm gonna say stock
info leave it at that for a second so
the client almost looks like it was
before
how well were the server is going to be
very different so on the server side I'm
gonna go back and say I got a subscriber
on my hand and the first thing I'm gonna
do is subscriber dart sec producer and I
set a producer right away and I say
request and I'm gonna handle a request
at this point so this
something you ought to get comfortable
with where it's like you ask something
it uses something you ask again gives
you something else you kind of keep
postponing it until you no longer can
postpone it right hey I want observer
here you go
hey observer I want to subscribe here's
a producer for you hey producer I want
the data here's the data for you right
so it's a little chatty but you're
postponing until you can no longer
postpone it so what are you gonna do
when the request comes in this case now
we are saying well you requested now I
want to say one thing the request
unfortunately is the number of requests
how much data do you want I am not happy
with it and the reason I'm not happy
with it is if you tell me how much data
I want
I may have to store a certain state on
my side and then based on the state I
got to give you more data well if I'm
gonna stay a store stay on my side what
does that mean
I got a mutate variables well in a good
functional programming we don't do
mutability so I gotta I'm gonna twist
this a little bit I'm not gonna use
requests as a number of requests I'm
gonna use requests as a state so in
other words this is more like
continuations right so you call me I
give you what data but the next time you
call me I continue where I left off
right continuations are a very powerful
concept so you can think of this as
really a like a continuation so notice
what I'm gonna do you give me a request
so in this case what I'm gonna do is
first of all on the subscription I'm
gonna create a on start and in the on
start I'm gonna request right here and
I'm gonna request 0 right so I said give
me the first one zero time and I'm
playing a little trick here and what
I'll do at this point is when you give
me the response back I'm gonna say index
equals so index equals I'm gonna say
symbols dot index of stock in for dart
picker and then I'm going to say index
plus equal equals index plus 1 and then
mod of stock info size
sorry symbols darts ice and so in this
case I know what symbol you gave me I
know what symbol you need to give me now
so now I'm gonna say request the next
index so again I want to emphasize index
is used as a count but I'm hijacking
here to use that as a state to avoid
mutability right I mean I spent hours
trying to remove mutability that's what
I do I hate mutable e that much right so
if I can find a way to ideally what I
would like to do is for this API to give
you a little state object and then you
take that state object and give it back
to them that would be really nice so I'm
gonna make the recommendation to see if
they will you know provide the kind of
service because I think that's a lot
more meaningful in addition to the
number of requests because it gives a
way to capture the state and carry it
forward right so so that's what
basically we are doing in this case so
on the server side what do I do now well
on the server side you made a request
well life became very easy I'm gonna say
subscriber dot on next and I'm gonna
send their data what data well stock in
for dot a stock info dot fetch and this
is going to be the symbol well I don't
know what the symbol is so string symbol
equals and I'm gonna simply say symbol
start get at the request index so index
and where the index is going to be along
so I'm gonna say index equals a int of
the request that I passed around so
assuming I did that correctly let's see
what happens so when I run this code now
you can see in this case oh wait a
second let's look at the error that we
got that's nice so let's see what the
error message says at this point I
probably failed on one of the index so
let's actually handle that so let's go
back in this case so here's the symbols
and symbol start get and in this
particular case let I increment it
properly let's make sure I got the index
properly so index starts with the value
of zero as you can see right here
so the symbol first symbol is going to
be whatever at that index I say index
plus one and then I do a modulus of the
symbol start sighs that should be the
index
you so we'll find out we'll try to print
the value and take a look at it so in
this case what do I do
when the request comes in I ask for the
request at that index get the symbol at
that location and do a fetch on it for
that particular location let's actually
put it in a try block and try to handle
that and send us an error at this point
so if there was an exception it's a
catch exception and then we will simply
say on error so subscriber dot on error
and we will send the exception over so
of course I'm not subscribed to the
exception on the other side but we
should be able to see at least that the
exception is coming through so let's see
what the exception says right here man
so some data has come through did I okay
let's see what we're that's where it
started so right about here yeah so
stackoverflow error how nice
isn't that beautiful so let's say where
I got the stack overflow from on next is
what I'm calling here so this should
have made a request at this point so on
next and I should simply say make a
request and leave it at that and then
there should be a request so I'm not
really sure where that stack overflow
came from I got to go back and take a
look at it but you see the picture right
so the point is you are actually
repeatedly making a request and saying
hey give me the next data and give me
the next day and give you the next data
and then only when you get the next data
do you proceed to do more work with it
and that is the real idea is to work on
it so the idea really here was to use
our slow method right so we would have
said print info and then you were given
the stock info so that would keep it you
know going through at the pace at which
it's working so that was the main idea
as you can see so how did we do this
you're making a request and saying
here's the request
give me response I'm done with this now
here's my neck-- request get me a
response so the client works at its own
pace the server doesn't push it forward
the server expands no work at all until
the client says I want the data right
and of course we looked at multiple
different combinations at this point as
to how
actually do this so that is about slope
lines so let's summarize what we talked
about here the main idea is we are
interested in creating applications that
are very highly responsive
responsiveness is very critical why
because if you create responsive
applications you get to have more
customers retain more customers right I
mean one thing we have seen over the
past five years it's very easy to create
applications which are pretty much a
crap but it's very hard to create
applications that people actually like
to use right so making the application
really responsive is one way to do that
resilience is something we cannot ignore
we have to deal with exceptions we gotta
give the respect errors deserve and
scalability can be attained not by doing
things faster but by not doing things in
the first place that shouldn't be done
right that's what efficiency is so it's
really bringing these things together
our X library contains a lot more than
what I've showed you till now they got
back pressures they got various other
things I can throw a lot at you but
that's not going to help us to
understand the made it major idea of
what reactive programming is the major
idea is that for things we want to do
resilience responsiveness and being able
to really be scalable and and to be able
to be event-driven in handling that and
the goal is to minimize resource usage
maximize responsiveness give a better
experience be resilient so the users are
happy to use the application and and
build their confidence and and and and
retain the customers that's the main
idea if you're interested there's a lot
of material on the web start by googling
for reactive programming Google for a
reactive manifesto there's a lot of cons
of being written reactive streams is one
thing that's also developing right now
the idea behind reactive stream is to
come up with a standard specification so
multiple different technologies can work
together and interoperate as well this
is a very interesting emerging field
right now you're going to hear a lot
more and this also nicely ties into
micro services as you can relate that
back to because micro-services can now
start being very reactive and and that's
a lot of fun I really hope that it
helped you to get a better understanding
of what this is about
thanks for your time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>