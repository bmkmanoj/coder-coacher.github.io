<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>All the Nodes That Are Fit to Print: A Tour of the New JavaFX Printing APIs | Coder Coacher - Coaching Coders</title><meta content="All the Nodes That Are Fit to Print: A Tour of the New JavaFX Printing APIs - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>All the Nodes That Are Fit to Print: A Tour of the New JavaFX Printing APIs</b></h2><h5 class="post__date">2015-06-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/VEMFkDdSXZs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to all the nodes that are fit to
print which is a tour of the new FX
JavaFX printing API I'm Phil and this is
Jennifer just in case you couldn't tell
the difference all right I think I have
to put this slide up you're probably
going to see it a hundred times anyway
so this is the agenda we're going to go
through today roughly just kind of give
you a little bit of a history the
lessons we learned from that design
goals the API you know a bit about the
architecture and the API itself some
examples a couple of notes about the
implementation and what we need to do in
the future so I think when JDK 1.0 first
came out in 1905 was alpha 3 and then
there's 1996 journey where it was g8 and
so forth it was like focused you know it
was a web thing right to be designed for
devices
there was no printing of course people
realized as soon as you were looking at
it for a desktop kind of environment
that that was a bad idea
you know desktop applications and
whatever else need to be able to print
so there was some basic printing API
added JDK 1 to Java 2 you know the big
API completion release which came out in
1998
you know included the Java 2d graphics
API and that had to add you know the
capability to print more than have you
been you know all of that API more than
you could do before but it was very much
again UI based printing and just focused
on the graphics and so forth JDK 1-3 for
the original ad BT printing API kind of
added some other stuff to be able to do
things programmatically rather than just
have the end-user drive everything but
it was only in JDK 1 for that we had you
know full server-side printing support
you there was a additional feature in
that release called the headless Adobe T
so you didn't actually have to have an X
server or a connection to a display or
anything like that and it was a whole
bunch of new Java X print api is added
so what am I trying to get out here you
know
we first off we didn't even have
printing then we added one ap
then we added another API and then we
added another API and we ended up with
like three different you know API switch
to two of them didn't interoperate one
of them the final one was tried we try
to interoperate with 2d and so forth and
to get all the features that you need it
took a lot of releases so there we are
several printing API is limited it
interoperation the one thing that you
know finally came out of probably came
out of all of these as there was a
consistent drawing model to the printer
with the screen so you didn't have to
completely write something new like go
off and write custom code to generate
PostScript or something like that so
JavaFX okay what can we learn well in F
x10 we didn't learn anything you know
again it was like web focus there was a
scripting API was no printing in the
plan which is necessarily mean it's a
nobody ever thought about it but you
know there was a project plan of what
needed to be in that release the targets
and so forth the goals of the API and
then JavaFX too came along and that was
done in a bit of a hurry in many ways
because that was when you know Oracle
came in and said look we need to focus
on the java programming language let's
drop the script language and you know a
lot of the api is got to get migrated or
what we called it then - to our JavaFX -
and it had to come out pretty fast so
adding a whole bunch of new api was not
what JavaFX 2.0 was about so there was
of course some API so Java FX 8 which
will release with JDK 8 is the first
release with printing support so at
least we didn't you know dribble and it
dribble into those previous releases
then have to deal with a compatibility
issue so let's try to get it right we we
know a few of the mistakes we made in
the JDK obviously we didn't get it in
the first release maybe that was a good
thing and you know to have some idea
about where this might need to go in the
future ok so some of the goals alright
for an end user if you
an end user in another developer but the
guy who's using the application you've
written using the JavaFX AP is you know
you want basically printing to just feel
like printing right as in from you know
ie or Firefox or word or whatever you
know so that basically means you bring
up whatever is the platform's dialogues
and so forth and you know these they
fiddle with those and then they press
print so that's actually you know pretty
you know there's not that much to it in
that sense but you know the alternative
might have been we'd have a completely
custom cross-platform way of doing it
and you know you could write those
dialogues if you wanted and that kind of
thing with the API as we've provided but
you would have to do the work we're not
aiming to provide a cross-platform feel
to this for the developer we want to
make adding printing to the application
relatively easy there are certainly some
tricky things about printing but you
know at least that the API level try to
make it straightforward nothing
superfluous there's some things we've
added into things like Jabra X print
it's pretty big and more than we needed
even though it for 99% of the uses that
anyone ever put to it
again we'd like to have the same kind of
rendering as you do on screen so that
basically means that you know we we
print the scene graph I'm assuming
everybody's pretty familiar with that
and that this fits in naturally with
other FX api's enable enterprises
printing which is server-side UI less
printing so there's you know a get is
kind of like we had it in JDK where
ventually where we added API to do many
of the things they user can do which so
for example you know we can you can
browse the printers programmatically and
configure the job programmatically and
find out the state of the job
programmatically that doesn't mean to
say that you know there's headless
capability yet I mean FX itself is not
yet headless but you know once FX
because has a headless mode all of this
should work for you too um but we're um
we're kind of we're staying in platforms
based some of the things that enterprise
needs lots of reporting and you know
ways of printing out as you know there's
what was that done there's um Oh some
open source library that that's used
forgetting what it's called right now
but um you know we aren't we aren't
providing a massive printing reporting
package or anything on it we're
basically trying to stay within the
that's you know the platform space and
leave that market to people who want to
build on top we want to enable printing
on screen live content and as well as
off-screen content that's actually
pretty important if you're going to go
eventually for service like printing
because there is no no screen plus arm
you know sometimes people want to print
what's on screens sometimes they want to
print have a different printable view
you know if you're writing an enterprise
you know so a desktop application and
you know you somebody says print you
know I don't know or you know this table
that doesn't mean to say that the table
is going to print that you want to print
the data but you don't necessarily want
to print that the exact table view that
you got on the screen so you want to go
to UM create some AA screen content and
print that be threading friendly we will
do layout as necessary keep the API
simple and use FX properties as much as
makes sense I'll come on to expand on
these as we go along no water in this
room has been fortunate okay
so what are the key concepts and tasks
about printing printer discovery or
enumeration creating a job configuring
that job you know control and monitoring
of that job and setting up and
configuring the page layout and then
rendering or printing if you like on the
the some scene graph to a page and so
we'll map these concepts to API alright
so let's go through the API pretty much
everything's in one package right JavaFX
print oh thank you
you know this was you know originally
we've created sub-packages and so forth
but as we refine the API with you know
we just try to keep it pretty simple
everything's there in one package the
the concepts are not that different than
what we've done in some sense the JDK
there's a there's a printer job but then
there's a you know there's a job
settings class there's a printer class
there's a printer attributes class and a
page layout class and I'll kind of go
through these in a bit and then there
are some other top level classes arm
paper page range orientation collation
color I'll go through all of these most
of these are actually enums so the
printer job is the you know the
essential starting place for where you
begin with the API
it's encapsulate to the whole lifecycle
it provides its the class in which we
plonk the methods that let you display
the dialogues and it provides all the
methods to start printing print a page
and the job and so forth and it's really
for some printing cases at least it's
the only class you actually need to
touch you literally don't need to touch
any of the other classes in the API so
here's an absolute minimal printing
example so I'm going to print some node
whatever it is so I there's a static
factory method to create a printer job
arm you obtain that job and then you
call print page passing that note in and
then you call end job well couldn't be
much simpler well you don't need to be a
little cautious um no we're trying to
make it simple here still but you know
what then maybe for whatever reason be
no printers the factory method will
return no so this is why we don't have a
constructor in some right you know one
of the reasons anyway you know this way
we can better flag would be horrible to
throw an exception or something if there
was no printer or give you a have you
instantiate a printer job that but
anyway what would you instantiate right
you can't instantiate an abstract class
and so forth so we have a factory method
that returns you a job false pretty much
only will mean no printers available
then each print the print page method
returns a boolean telling whether it
succeeded or failed and if you're
diligent armed you should probably
recommend that you check if that page
printed correctly and if not you should
that's basically a message to abandon
the job and then you call end job and
that also turns a boolean tell you
whether it succeeded or not and what
success means is that you know we passed
it off to the spooling system it doesn't
mean yet that it came out on a piece of
paper that's you know your printer can
be have issues as well and well okay
that was you know what happened there we
didn't involve the user at all all that
happened was you know the application
decided to chuck something out of the
printer and you could have ducks that
means that you know you didn't have to
bring the user involved you could do
something in your custom way you know
that that doesn't involve them being
having a chance to see the printer
dialog but many applications do want
that so if you just basically call this
method which again returns a boolean and
generally a true value means yes the
user is happy they pressed ok or some
equivalent and you know false means they
said no cancel which you know if you can
go ignore if you want but generally
should be interpreted to mean that the
user um doesn't want to proceed with the
job and the null parameter would
actually be a window and the idea is
that's the dialog is then modal with
respect to that so you can have it stay
above your application window so pretty
simple
the printer class so this is a
representation of some specific platform
printer or servers that you would see
when you're just using any other
printing application or native
application and this so this doesn't
necessarily mean that it's a physical
printer I did bring a printer by the way
you know it could be something like the
Windows XPS document format of PDF or
whatever if you've installed something
that maps to to one of those output
formats and it's a the printer classes
the home for two important static
methods you can obtain the default
printer and you can also get an
observable set of all printers looks
like it just grab some water
I don't know mentioned this later but
it's an observable set for a good reason
which is that at least theoretically
someone could install a printer while
the application is running so it's not a
fixed list right and you can actually
temp you know theoretically monitor that
if you want for actual for new printers
it also means that the the values
returned by get default printer and get
old printers Wyles theme may not change
and 99.99% of the time they won't change
and currently in the implementation I
think it's hard-coded that we don't go
and do that but it's a it's a bug that
we haven't done that but you can if
theoretically if arm you need to be
resilient you can't just go to cache
these values as what I'm getting at
right you could change from one call to
the next that may be more important for
a server printer right which is
server-side application where the
printer is running for a long time
the application is running for a long
time
arrey printer attributes so this class
has all the capabilities of the printer
you know for all of the attributes maybe
most of them anyway will report the the
initial or default value and um it's
kind of couched that way as initial
default we call it default but different
platforms have a notion of whatever the
value would be when you create the job
so on Mac for example you know you can
actually select that you'll want your
printer to settings to be the ones that
you use last time
so in some sense that the job when it
comes up and the printer is configured
based on whatever the user had said in
that dialogue so that's the sort of
thing that isn't necessarily the default
for the printer but it's whatever the
user use last time and then there's the
set of possible values so you know this
you know any of the enums or something
that we talked about this could be like
well you know what you do printing
duplex mode well the default is single
sided and but the capabilities are
single and deeply now everything here is
read-only right so there's no properties
right because all you can do is just get
these values right you you know the well
it's interesting point you know could
possibly actually make the default a
property I haven't thought about that if
the user was to change it but but the
idea is that you can't add new
capabilities to a printer so this
thing's read-only you can't change it
and set some chess set of value as the
default from the API that's a platform
thing there's no way I think that on
most platforms that we could use API to
dig under and change what default
printer settings are that's a task of
just a caution you know not everything's
visible even to platform api's I think
anybody who's done any printing on
Windows arm which is probably you know
most people who have ever used Windows
you know you bring up the printers
dialog or whatever they
it is and there's usually a button
marked document properties or something
like that in the dialog and you bring
that up in it it has a whole bunch of
settings and it will say like HP or
Canon and it'll have all these little
wonderful things and tabs and tabs and
tabs and all these things are things
that you can configure about your job or
your printer and so forth but Windows
doesn't even know about these it so it
can't important to you you know the the
way things work natively on Windows is
there's this structure native structure
at least in GDI printing called a dev
mode you know let's say it's 496 bytes
long you go and ask a particular driver
what's the size of the dev mode it'll
say 18 K well what the heck is all right
well it's a whole bunch of private stuff
so that's not exposed to API it's not
exposed to us not exposed to Windows so
there are some things you might think I
don't know why I can't see that in my
you know one job and I let me see that
jar of X well it's because we we have no
idea because the platform has no idea
and all we can do really there is just
propagate it through to the job but
we've try to put in the you know the set
of properties that we think are most
regularly used by applications and that
we you know we currently have support
for I didn't want to add well a good
example is I don't have an up support
directly so let's not expose that as an
API because I don't want to mislead you
that we have it job settings so this is
the current configuration of the printer
job so when you create a printer job
it's got it you know there was there was
the printer default settings or initial
settings right reflecting the way that
and and those are essentially copied
over to the job settings
that's so now your job is initially
configured to do you know one copy
double-sided you know in landscape or
whatever the heck they and configured it
as and so probably every printer
attribute has a appear copied over into
the job attributes and you can then
modify that so you can use the end user
can use the dialogues
or you could use the AP is that we
provide and these unlike the printer
attributes are mutable so you know you
can you can change these by basically
saying set copies to whatever or you can
also use the properties API so I
recapping a couple of points here so you
know the job settings is see its
settings is intended to more employ
mutability then protected attributes
which is sort of like that's how it is
these are how the print as other printer
is so you get the printer attributes by
if you want to see what the printer
attributes are right without creating a
job you just take the printer that you
got from get default printer or whatever
and you basically ask for its attributes
and you can see what the defaults are
for a printer so that also next you see
the capabilities so that might be like I
need to send this job to a printer or
color printer so whatever the user does
I'm going to filter it and make sure if
they try to select a you know a black
and white printer I'm going to say yeah
I prefer you to select the color printer
something like that job setting is are
mostly - based on initial trencher
attributes I think there's something
silly silly thing no unimportant thing
relatively like job name or job title or
tag on that there's no default but you
can't create these things you actually
obtain the printer attributes from the
printer and you obtain the job settings
from the printer job and the job
settings is basically an instance that
is installed on your on your printer job
and it stays that way for the life and
the printer attributes is a is the same
it's installed on the on the printer it
stays that therefore life of the printer
and that that approach is really
important for job settings because
supposing you want to say something like
ok the the job is configured to be you
know color right um I want to be
notified if the user goes and changes it
to black and white because I really
wanted that job to come out in color you
know the user I'm going
you know go and be fussy and make sure
that the later on that the you know they
only select a color printer but once
they've selected a copy
even when they select a color printer if
they press ok on the dialog somewhere in
the dialog they could go and change it
to print in grayscale I didn't want them
to do that so you know rather than kind
of go in query specifically you could
just add still a listener on the
property right say so when the job
changes from color to greyscale I'm just
going to have a method call which will
then pop up a dialog saying please print
in color and change it back and um yeah
so the other point is that if the job
settings were something that you could
set on a printer right sorry on a job by
guessing creating a new job setting
setting the values and the properties
and then slapping it on a printer job
what does that mean for somebody who was
listening on the color property that was
attached to the previous job settings
well they can keep listening but it's a
waste of time because that job settings
instance is no longer being used so
that's why we don't do it that way you
have a job setting set on the job and it
lives there and you can listen on a
specific property which will stay stay
there for the life of the job know about
binding so you can find properties to
other properties arm whether its native
state like the our you know the user can
go and do something like change anything
that they want in the dialogue like the
printer that's being used all the color
or so forth although you may not want
that to happen you may want them to
print on a color printer right arm we
would actually that doesn't stop if we
the native data structures that underlie
it right are being changed nonetheless
to sprint to a different print to print
to a different um you know to printing
color or grayscale what are they're
selected so if you can if you were to
bind the color property or the
into property on a job to some of one of
your own properties and prevent us
changing it at the Java level we would
have absolutely no way of actually
reflecting in Java what the true native
state watch was which would be a mess so
you know you can listen in all these
things but you can't and you can change
them after the fact but you can't
prevent them being changed so I'm trying
to get it you have to go back and change
them again afterwards and then that
would then propagate down to the native
state properly okay um so let's walk
through some of these attributes pretty
simple copies integer property all of
these are standard effects property
types there's job name string property
are usually this is what will come out
on a banner page you'll see it as the
title of the job if you look in the
windows print queue and that kind of
thing collation collation is simply
whether you get arm you know what if
you've got to copy only plays you've got
more copy but Kunkel eights it is for
two copies as you get page one page one
pitch to pitch to and collate it you
would get page one two one two and out
that order that's basically what it
means where's it's all in green well
print color you can basically print in
grayscale or color Windows and Mac and
whatever else support this is a notion
doesn't mean to say that
so all printers the print in color will
let you choose toggle between these two
whether you want to print model on a
single side or double sided the quality
whether you want to print in draft low
normal high thing we may want to look at
whether we can extend that you know you
can't extend these enums obviously but
we might want to we may have too few
there to map onto all of the
possibilities but page orientation so
again not all of these are necessarily
supported by a device you know some
printers can't print double-sided some
printers Windows doesn't support
I think reverse either of the reverses
and the the quality settings may depend
on printers excel her resolution in
there but some one of the things I'll my
one things about Windows Snow is that
the way the drivers work is that you can
either have quality setting or you can
have a resolution setting sometimes the
driver dialogues kind of muddled it and
they'll talk about quality and they're
really mean resolution or vice versa but
they can only do and some of them will
have I've seen ones that have both and
they're lying they can already do one or
the other it's the Z that the c-level as
a union you can't have both
the paper so the width and height in
points and a name and that's the
attributes of the printer so it's you
know an eight-and-a-half by eleven paper
essentially and it's called letter and
that's that's basically a paper this
isn't an enum this class hello most of
the others we saw before were it's
because there's an almost infinite
number and there are you know you would
call get the supported papers and you
could then you know enumerate through
those looking for one that was the size
that you wanted you can't necessarily
depend on the name because printers call
them you know drivers call them whatever
they call them there are some standard
well-known sizes that you know most of
us would like to use like letter or a4
or you know legal whatever that we have
predefined in the API right so that
basically means that you can just go
slap in I want I want to use envelope
right that's how I want to pre configure
this job but you know the onus is still
on you for to make sure that that is
actually a supported paper
a page range is simple class to integer
properties where to start where to end
and the page values start from one so we
have that class but the actual page
settings are page range or pager age
property on the job is actually an array
of these so you can basically say I want
to print for a page one two three and
seven to nine page layout so this
represents the page setup so this Maps
almost exactly to what's the standard
sort of page setup dialog that you'll
get on Windows or Mac you know you can
get this from the printer the user
dialog can can change this and you can
also configure it from API and it's
basically composed of the paper which we
just talked about page orientation which
we mentioned also and then some values
for margins and the result of that is
the area that you are actually going to
be able to print in and this isn't
necessarily the actual physical
limitations of the printer almost all
printers have some you know some
printers can do borderless printing
right but even then they generally only
do it on certain sizes and whatever so
there's a hardware margin but what we're
actually trying to give you here this
the margins here are could be Hardware
margins but they're basically they
represent the margins that you would
like around the page so you can print in
for your application anything outside
that is clipped right it was outside the
hardware margin would be a clip
completely by the hardware but arm where
a graphics level are clicking what's
inside the margins we define on the pre
on the paper so you can create your own
page layout looks like this say I want a
for paper I want landscape and I want
the margin to be default but the you
know whatever you pump in there right
you know if if it's not supportable
we'll go and tweak it for you but
you know there's it's not that hard to
create a supported one right all you've
got to do is say you know get me one of
the supported papers from the printer
get me one of the supported orientations
and then pump in them and a margin and
it should be correct so really you know
where you're likely to get this wrong is
if you try to you know ask for a zero
paper on this little guy here or
something it isn't going to work right
and we'll reduce that to something that
matches and give it back to you we
margins we try to make it fairly
convenient here there's an enum the so
hardware minimum which basically means
we'll give you the biggest possible
printable area basically what the
hardware says and then there is arm
equal where we're not actually pushing
the hardware supposing the hardware
minimum margin on the top is half an
inch and on the bottom it's a tenth of
an inch right and well what we'll say
okay well we've looked around and the
largest hardware margin is half an inch
so we're going to give you half inch
margins all the way around right but
supposing the the size margins were like
a quarter we'd say oh well equal
opposites okay we'll give you half an
inch on the top at the bottom and 1/4 of
an inch on the sides so we try to make
it if you give you a few enemies which
like you quickly configure a page to
look you know somewhat you know nicely
uniformed and ought to be able to use as
much of the paper as you want and
defaults just means a 3/4 of an inch
sorry you metric guys around and that
was just an aesthetic decision so the
default is you know an inch we used in
the past it'll just looks too damn big
and half an inch little too small so
so okay I talked a lot about you know
what a page layout is and you can create
one and so forth but you know you can
just get the default one from the
printer right from the job one will be
installed there for you right you don't
have to create one you can just get the
one that's xtal on the job and
eventually when you've got that right
all you've got to cut there only really
two methods that you want to use most of
the time and one is get the printable
width again the other is get the
printable height and these what I
touched on earlier and they returned in
userspace pickles picks userspace pixels
and whatever the width is is always the
x-direction and whatever is the height
is the y direction so if you have eight
and a half eleven paper and portrait
right this is the width and this is the
height and if we have it in landscape
mode this is the width and this is the
height right so you know the arithmetic
is pretty easy but really what it comes
down to is you know with default margins
of 3/4 or as in each I gave you I guess
you know you have some area within the
paper that you can print on and you just
got to think like that's what I've got
to fit in that's the size of the window
right you can think of it like that
and I can't resize this window you know
on a on a screen you can have a
scrollbar and you know I don't have to
fit in that window but on the paper you
got a fit so here's an example of using
that just time check good so we can on
the job on the job as a printer job we
get the job settings and we get the page
layout from that we get the printable
width the printable height from the page
layout and then here's an example where
just basically I just want to draw a
circle that will the largest circle it
will fit centered on the page so I'm
using that to size the to place it it
width of the two that they Center the
circle at width over to height over to
and with a radius of whichever is the
smaller dimension
so it's pretty simple in case there's
more of a sort of implementation
architectural so at an API level what
we're doing is reflecting platform
something that's installed on the
platform and the properties of those
hardware devices so through the API you
know throughout the API you will see a
paucity of you know public constructors
and you will not see the ability to
subclass things because you know you
can't say new printer cannon if there's
no Canon printer installed right you've
got to find out what printers are
available on the platform and arm and
ask for one of those printers and then
use it and you can't ask that it this
little guy here this little cannon so
you know support a zero paper it just
can't so we provide API is to get these
through factory methods arm and you know
we have mapped all of these things
through - - to the to a platform object
so you know since you can't create new
printers and so forth you know there is
there's no need to subclass right you
you what would you do with a subclass
nothing you can't get even if you that
world I want to tag some information you
can't do that because you couldn't you
know well you know we would have to take
provide you err you just sub classing
just wouldn't work very very well
wouldn't make a lot of sense it's hard
to see a use case so everything is final
if we ever find a good reason actually
everything yeah probably not everything
but almost everything is final
and you you know you can't construct
them and the enums are like that anyway
even though once we write okay job
lifecycle briefly nope so we try to make
it so that you can actually see what's
going on with the job and this is sort
of one plug five-five defined States so
not started so when you say printed job
great printer job you get there
sky you can display the page dialog than
the print dialog and the pinch dialog
and the print dialog you can go off and
set it to some different printer you can
set attributes and whatever and you can
keep doing that um nothing to stop you
now as soon as you call something like
print page and you start the first page
well you know what are you going to do
I'm sorry I'm already printing so at
that point we we disallow you to go off
and change the configuration of the job
it's now in printing mode and then there
are several terminal States cancelled
there's a user canceled a job for
whatever reason or the application
cancel it there was some error came out
of print page you know something
happened sorry we can't print or done
which is when basically when it print
job any job returns true so and these
are all probably yeah you can ask this
at any time or you can just monitor the
job status properties if you want to
some other thread or I just have a call
back right wants to know how the job is
going you can actually monitor that so
I'm going to go through some examples
demos and this is going to be a mess I'm
afraid because whatever reason I'm
running in 640 480 and nobody but nobody
writes applications for 640 480 anymore
okay so this will be so this is a basic
example not going to do anything clever
here I'm just going to press print and
this is a little Canon Pixma our IP 100
portable printer and so you know there
was no circle on the screen or anything
so I can print off screen so that's you
know that's basically the code we saw
earlier on in the in the in the
presentation I think the very first
example
so you know I think the point series
content can be printed whether it's off
screen or on screen and you know a very
simple example just prints the user just
press the print button they interact
with a native dialogue and that's it
okay it's really really simple what else
can you get here
this is going to be not fun
due to the size I mean we just can show
what's the native page setup dialog we
can show the native print dialog is it
going to come up or is it came up a
moment ago where is it
Oh brilliant I couldn't even see it
thanks mr. tiny window you just do that
one what time see why is it Camille okay
I don't know sorry this is the native
print dialog and it's as big as the
entire screen sorry so if I want to do
something like you know change number of
copies here that should now be reflected
over here so all I've done here is just
i've got--let you know like i was
talking about before Ivan's I've
installed listeners on the various
properties as they get changed
I can just see that and all I'm doing is
updating these simple simple UI which
I'm afraid is pure text because I'm not
Jasper no but all of these things they
come I think I talked about grayscale
see I think over here it should say yeah
it's too small to even see but oh my
gosh I can't even get to thee how do you
know move this thing about all right
this is going to be kind of hard to use
unless I can find out it press okay okay
so that I actually change to the
grayscale but anyway the hard to
demonstrate with this small application
I'm afraid with this small screen but
all of these properties like that we
talked about like which printer if I can
maybe change the printer as well change
it to someone that oops XPS can't
support that okay
Yeah right alright thank you that's just
windows so the printer is now the XPS
document writer so anything you know
these are all listenable to write so I'm
not going off and explicitly queering I
just got a call back boom and I get
notified hey come on this one may be
tricky to deal with this is on ensemble
or ensemble Oh which is a sort of
equivalent of swing set for FX it what
it's intended to do is arm demonstrate
all of the different um UI controls and
the different effects and so forth we
have in thought this one was nice pretty
yeah we have in FX so this is a
reflection effect so what we did with
Ensemble and it's not actually in the
one that you can download yet because
sorry that one made up print what do you
mean oh images I think she's saying we
have some bugs but anyway we can we can
try she want me we just try I can try to
print it to XPS as well then you can see
it on the screen there and that means
I've got to find Oh
Oh how do we get to an OK button
just hit enter hope now go to find a.m.
you know I get to folders documents ah
okay so let me try actually printing it
to the printer
I thought XPS was a really good idea
because then I you could just see it on
the screen
so this does actually print the image
now it's scaled down here for a reason
that seems to be a driver bug with this
particular printer um it should have
been in the whole size of the window of
the page but what we can't really see is
that we you know the the image that's
being used as a reflection we have you
know whatever effect that is we can
basically put that on the printer and
the full resolution of the image is is
being used so if that image was you know
2000 by a thousand pixels right but on
the screen it comes down to fight well
this thing comes down to like you know
300 by 200 or whatever no that's not
reflected in the printing right we're
going back to the original image source
you can print full resolution images you
know so I've done that with ones that
are like many thousands of pixels and so
forth and you can pumpkin through to the
printer there's charts here you know so
we have where other where the chart
what's good bar chart bubble chart pie
chart
so okay so
yeah all of these are going to come out
scale down but um just because of the
printed driver bug just coming out
clipped as well for some reason but
anyway so basically the point is is that
you know and you know because we have
charting built-in right you may not have
we're not providing a full business
reporting package but all of the
charting kind of controls that are built
in right
you can configure those just like you
would for the screen and then that can
be used in in printing reports was there
anything else worth showing in here but
anyways all of these should print with
the exception of 3d have to figure out
an answer to that okay how do I get to
this I'm sorry
hmm I don't know you were to find out
media view well you are not going to get
anything out of media view I mean we
can't print every frame actually I think
I must have a note somewhere that you
know but yeah basically whenever you
track well if you want to have fun
there's an animation right what do we
have here
which one's good this one how do I
started
how do I started I go there must be a go
button somewhere which I can't reach how
do i mock this thing live around yeah
grumble grumble
are there any this they're all going to
be the same size and if I can't get down
to
if I can't get down to the animate
button them there's no point
to Urgent Care
I'll come under that but well yeah it's
not a WT printing people say that it's
the 2d printing API but that's just sort
of this in fact that's one of the things
for the future the so that's a swing
specific issue can we take that one at
the end okay I know exactly what's going
on there Rumble let me just try to print
a swing node and then we need to move on
where is swinging Interop run swing
Interop oh it's printing up in a
different it's coming up in a different
window so we're not going to capture
this so what we're actually printing out
is is what's in here so to print that
one I would have to fiddle bit more with
the code we put into Ensemble okay but
anyway with the animation example what
does happen is you you you because it's
changing as we're printing it what you
get is whatever happens to be the state
it that when we go and snapshot it and
and then when we go again and try to
continue printing it it might have
changed so you get a you know you get
half of one frame and half of another
potentially this example is quite a nice
example I thought but I don't know how
well it's going to look on this tiny
tiny little thing so so what I've got
here is basically some text you it's you
can't actually see the bottom of it but
um it's been formatted into two columns
and it's basically a whole block of you
know a large amount of text for actually
happens to be from on the Origin of
Species
looking for some non copyrighted
texts and it's being split into two
columns each of which is actually a text
note here and then it's been paginating
right and this is essentially what you
would have to do in order to be able to
to print and it looks really good when I
dump it out in XPS but XPS won't run so
I'll just sort of throw it out on the
printer but what I try to show here is
this is an example where you know you
you can paginate you know some text that
oops some content that flows right again
it's coming out 1/4 size but you know
that's it basically this was one long
block of text and it's just paginate
'add now you've got to write some code
to do that and I'll hope to be putting
up you know some of this as as samples
in some of the directories that we have
where we have simple examples but let's
try to show up pagination and then web
view so web view print buttons in a very
silly place but that's my bad
programming web view as people probably
know is built on WebKit and you know
this is just bringing up which was this
Java Sun calm probably I think I can't
it's not big enough to build to see so
we have built some support directly for
printing web view so and this is
actually should just bring up a printed
version of the web page look
so otherwise printing oh-ah and I think
I have a slide on this sort of trying to
explain it okay what I got understand
the way the web view API works so maybe
I'm for that I'll go back to my slides
if I can find them thank you mister 640
by 480 how do I continue from where I
left off
continue from where I left off another
one from beginning okay
I'm normally use OpenOffice but well I'd
template so for PowerPoint site our
choice so web view it's interesting
unlike the other nodes where you're
providing the content right
you really have potentially have no
insight into into what's on the web page
right so if you want to print content a
web view you can't really control it
directly you've got to ask web view
itself to to format that content for the
printer so there's a method being added
to web views layout engine which is just
print and it takes a job and all it does
is and that's all that that really the
code did in that example all I did is we
call print I credit print job pass that
in and web view internally basically
calls print job with each page of the
content and ill print how how many pages
it needs and then it returns control to
you right so what was happening here
with this circle is I then get back the
job and I then print a circle which
could have been anything right so the
point is you can then embed the web view
content in the larger print job and one
thing that I was thinking about is that
you know depending on what you want to
print right from from your FX
application potentially you could just
spit out some HTML right load that up
into the web engine now whether you
print that out so if you want to do
something that you find it's a pain to
create the scene graph or just to build
a print you could you know spit out
simple HTML and just load it into a web
view and just have web you print it and
you know we're we're using our printing
implementation here because webview
entirely all it knows about is how to go
through our graphics API but the actual
layout of the page is the is based on
the web
page layout that use for printing on
different platforms okay so we're almost
done so I've you know in FX there are a
couple of important threads the one that
you do most of your work on is the
application thread and the one that you
can't see but you know is there is the
FX rendering thread of prison thread and
this sort of renders the peer state of
matters so what what what's the
implications for printing well we will
schedule things on whatever thread is
appropriate you just you can do stuff on
the effects you can try to print from
the FX application thread if we need to
then run something on the prison thread
behind the scenes we can but also you
don't necessarily need to print from the
FX application thread you can invoke it
from some other worker thread things
that we need to schedule to run on a
particular thread will do right you know
eventually I don't even know what the
headless implementation of FX will look
like but you know what will the FX
application thread be in that case I
don't know there are many things right
now you can't do except on the
application thread you know really
unless something is displaying on the
screen and so forth even if it's
attached to a scene you should be able
to manipulate it from multiple threads
right now you can't also there is seem
to be some horrible annoying bugs in the
platform certain layout functionality
just fails unless you actually run on
the FX application thread so we will you
know we will try to take care of much of
the threading issues as possible and you
know as things more things become able
to be done off the application thread
we'll take advantage of that advice
don't animate the content you're
printing yeah somebody mentioned media
view we can't print it v we can't print
60 frames a second you know whatever we
get we print um if you're manipulating
it and we come back you know it's a mess
especially you know if you're updating a
table view or something you know think
of it even doesn't have to be animations
just changing the content and we got a
print page too and you've changed the
content it's going to be a bit of a mess
so
okay the last couple of slides yes
somebody mentioned there's what people
call a WT printing but it's actually 2d
printing because there's two API is a WT
in 2d actually as I said there's three
but we're we're layered over the Java 2d
printing API why well there was a
pragmatic choice we've got to support in
this release printing on Linux windows
and and Mac OS and you know so I you
know for those people have been sort of
following along with FX we have you know
we started off with this thing which was
this this what do we call it the first
pipeline that was anyway there was the
thing later the first graphics pipeline
was layer of a swing and then we came
along with prism which could run
directly to direct3d or OpenGL or
there's a software and there was one
which ran directly through j2d to the
screen and then there was a snoo
completely custom software pipeline
written so we've got a lot of pipelines
but you know we would have printing is
exactly a pipeline right you need a
pipeline to put a GDI or to PDF or
whatever so since it was already the j2d
pipeline which has being used as a
software pipeline in j of r FX 2 we
basically just layer over that and we
can get all of that support arm whilst
just working out the wrinkles in the api
and we didn't have to you know spend the
huge amount of time on that it would
take on on writing each of the native
implementations but doing those in the
next release jdk 9 is something that we
do intend to do so but it does mean that
in JDK you go to you know we have these
new different profiles you would have to
be running on a desktop profile if you
want to do printing right because under
the covers you need Java 2d so we will
rewrite I'm you know we could try to use
what they call the Metro API them and so
the windows we may bypass GDI
and go to the newer printing API is TBD
maybe for the other platforms we just
directly spit out PDF I mean people
might actually want the ability to
generate PDF directly
way I mean the people have written PDF
generators for JDK in the past we you
know if you're dumping stuff if you want
to dump stuff that was written for the
screen and its style for the screen with
lots of nice gradients and whatever and
maybe it's it's like you know a blue
background whatever this is you know
this is apologies so anybody who works
for HP but you know this is they make HP
rich sort of API if you do that because
you know using lots of your blue ink and
whatever and it isn't the way to print
you really want to be able to when your
print you really want to have the
background just be white clear so you
know you could have a CSS supports the
notion of a stylesheet for a different
media we don't in our CSS implementation
provide a support for that but I think
the idea is that we would try to do that
and have a modified version of CSS which
would work for printing so that's all I
have to say I'll try to answer that
quickly the question the guy were there
asked about jailable printing so that's
an app well we're not using swing at all
well it's a bug that only affects swing
hello it is a bug actually in j2 java
two DS get justified text layout code
which is really nothing to do with
printing it's a text bug and swing uses
that and runs into this this issue with
the bad spacing and unfortunately that
bug was introduced trying to fix another
bug which was text being clicked because
swing was not aware of the fact that the
scale was changing and so it was not
longer rendering the length of the text
correctly for the printer scale and the
click would come into play then you you
know sometimes you get text that was
shorter than it had but you know when
you notice it is when the text was going
to end up longer in effects we actually
you shouldn't see that I don't think
and and and our text mode is basically
to to render text on hinted which means
it should always be essentially scaled
the way you would do an infinite
resolution which is printer so effects
in general shouldn't be vulnerable to
that so I don't think you'll hate that
book okay all right any other questions
okay
ah yes no I can you can't what that
means is that there was a specific bug
printing canvas well we're getting an
exception and I had a halfway fix and it
never quite finished review before I had
to come here so hopefully next week I'll
push the fix that canvas can print but
yeah canvas is sort of an interesting
one I can remember you know what the
exception was it was some some one of
the things we run into is is basically
that you know there can be a grep within
the FX implementation there can be
resources that are cached in various
places and are assumed that well when
you have one of these you must have a d3
D what's it wait wait wait I'm not going
to do three D so we were occasionally
running into rendering bugs in the you
know assumptions in in in different
parts of FX so we have to go and correct
them just under the covers so yes you
will be able to print a canvas within
the next three weeks
okay yeah well you would if there
we're not explicitly monitoring printers
state right I did occur to me that you
know we are we could add some additional
api's to be able to track some of that
when you're actually printing if you
there there is the printer I mean the
printed going offline doesn't
necessarily prevent you schooling a job
right and you know windows can figure
like you know use printer while offline
so at the moment I think the only thing
you'd get is if that somehow are you
know and being out of paper as well you
know I mean it only finds out that it's
out of paper after we finish the job we
spool it there it goes to print and then
right so we don't have any we've been
trying to focus more on the you know
creating the job in getting it to the
school system so unless something about
the the printer prevents us doing that
yeah you won't see it through this I
mean it's not to say we couldn't add
other api's for that and that might be
you know more important for server-side
printing you know what you want to be
able to monitor the printer status and
maybe you know go off to a different
printer that's offline so yeah we could
add that I don't I think you know one of
I didn't want to add you know lots of
API there was had no implementation and
then else right you know in various
parts of JDK one to in the Java 2d API
is that happened right there were stuff
that is supposed to do something and he
did its squat there was just a null
implementation of like 1.3 or something
so what I prefer I think I mean told so
what I prefer is to basically you know
take the feedback this is what we need
filer JIRA
and you know we can add that probably
late for eight now but it can be added
for nine okay okay thank you very much
folks</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>