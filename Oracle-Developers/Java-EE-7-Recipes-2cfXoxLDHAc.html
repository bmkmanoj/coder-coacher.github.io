<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Java EE 7 Recipes | Coder Coacher - Coaching Coders</title><meta content="Java EE 7 Recipes - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Java EE 7 Recipes</b></h2><h5 class="post__date">2015-06-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/2cfXoxLDHAc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to the presentation I appreciate
you taking your time out your job on one
schedule to learn a little bit about
Java EE 7 my name is Josh you know I'm
an application developer during the day
and I am a technical writer at night and
on the weekends I've write for Java
magazine and OTN I've written a few
books Java EE 7 recipes introducing Java
EE v7 and Java 8 recipes a couple others
as well and most recently I've joined
the JSF 2.3 expert group so I'm looking
forward to working with that you can
reach me at Twitter Java Juvenal and so
just to give you an overall idea of what
we're gonna cover today I'm not sure if
you're familiar with the recipe style
format but basically what I'm gonna do
is give you a series of real-life
scenarios we'll introduce a problem and
then I will give you the solution to the
problem at least one solution and then
I'll give you a little bit of a
demonstration of how that solution
actually is working in the browser and
then we will go ahead and describe how
it works this is not meant to be a deep
dive into these topics what I'm going to
try and do is fly through 25 of the
features of Java EE that I think are
very useful and most of these are brand
new features in the EE 7 there's a
couple of that but in there for
contextual purposes that were
implemented in all the releases so
something I want to clear up before we
start this is not about j2ee if anybody
is here for j2ee talk that's that's not
here I don't even think that is going to
be found at JavaOne anymore because now
we use Java EE it's a completely
different API as it was back in the day
when j2ee was around there are no more
long hard coding nightmares it's now
streamlined and easy to use so I wanted
to get a show of hands how many people
are currently using Java uu 7 ok we've
got a few about Java EE 6
that's okay five fibre below okay
anybody else in j2ee days anymore
okay that's good so we all know that
Java EE has progressed it's gotten a lot
better
Java EE of the past was verbose it was
difficult to use lots of configuration
and really was adopted by larger
enterprise you know corporations and not
too many smaller time developers did
adopt it but now we've been making
progressive improvements with Java EE
there's less configuration there's more
standards it's a lot more productive
getting easier to use and Java EE 7 is
great because it really increases
productivity and introduces brand new
standards for building modern web
applications so just a few of the ideas
of how we have increased productivity in
Java EE 7 CDI has been introduced in
just about every resource of your
application now I can use it about
everywhere jax-rs now as a client bean
validation has been updated
JSF has been updated with a few
different concepts flows and much more
and JMS has been greatly the
productivity is greatly increased in
that because there's a lot less code
that you have to write we also have more
standards now to write against no longer
do you have to create custom
implementations in your enterprises for
preferring certain performing certain
tasks
WebSockets made it into Java EE 7
there's now a standard way to do JSON
processing batch API is now introduced
also concurrency utilities for Java EE
I'll touch upon most of these in the
Taha to talk today so like I said before
we're gonna go through a series of
recipes I've got about 25 recipes I like
to cover I'm gonna try and get through
them as quick as I can show you
demonstrations on a lot of them some of
them I'm not going to dive into the
browser or the code on but I'll show you
slides on how they work
and a statement of completeness this
again is not meant to be a deep dive
into any of these topics but it is
rather meant to introduce you to the
concepts so you can go home and start to
use them in your applications that's it
it's gonna be up on github actually
there is a version of it there now but
there are have been some modifications
so I'll update that yeah and the URL is
at the end one last thing that I forgot
to mention I know all of you were gonna
go out of here wanting to use Java EE 7
we've got this poster in the back that
Reza has pick one up on your way out
it's great to have okay so how about
showing your hands how many people are
using JSF yeah that's quite a few people
so JSF has really been updated quite a
bit in Java EE 7 quite a few new
features faces flows resource library
contracts better html5 support new
actions so we're gonna step through just
a few of these right now so before I get
started with the problems what I want to
do is introduce you to the application
that we're going to be working against
it's application that's called Acme
world
basically it's a application that is a
reservation creator for an amusement
park that has you know maybe two or
three different parts that you can visit
so people will likely be creating
reservations for multiple day visits and
also the company would like to make as
much money as possible so they are
requiring that guests who booked a
reservation also need to have at least
one restaurant reservation during their
stay so that's going to play into the
application as well so I'll start off
with the first problem scenario let's
say you'd like to invoke an action
method and this is coming from when a
particular view is loaded and
furthermore you would like to perform
some navigational response after this
action method has been invoked so the
way that we can do this is utilize a JSF
you action here's what it looks like
what you can do is when you vote the
view it has a link that would go to the
next page that actually contains the
view action as you can see at the bottom
the view action actually invokes an
action within the manage being
controller and in this case there's a
view parameter that's also being set
which is coming from the link so let me
show you how that works so here's our
application and what I'm going to do is
then go to the current reservation list
these are all the reservations in the
system and there's actually a view
action behind the scenes here so when I
click on the reservation it's going to
load the information from the database
and populate the view and I can show you
that code
so what's happening here and when we
click this link the outcome is going to
call upon the park reservation view and
this ID is going to be passed in as a
view parameter so if we open the park
reservation view you can see that
there's the view action right there
which is being involved actually this is
the one sorry about that this is the
view action that's invoked and if I go
ahead and I click in there we can see
that what's happening basically is that
the customer is being loaded in from the
database yes I'm the editor here sure
sorry about that yeah let me go ahead
and do that so let me crank this up to
36 is that better okay
so by default the view is loaded after
the actions been invoked and this
happens on get requests specify the
actions be invoked using the action
attribute of the view action these do
not operate on post bacc and it's only
at the initial request by default if you
want to change that you can use the on
post back attribute and they are invoked
during the invoke application phase by
default that's also configurable with
the phase attribute and the return value
of a view action can involve navigation
so problem number two you wish to
provide the ability to change the
application look and feel depending upon
how you're logged into the system so
let's say that your standard user we
want the applications background to look
blue and if you're an administrator we
want the changes so that looks a little
bit different so the way we can
accomplish this is to use JSF resource
library contracts the way that this is
done is there's a series of steps we
have to do that it's quite easy
basically what we do is we create a
folder that's named contracts within the
root of the web application and then you
create separate folders inside the
contract folder and each of the separate
folders will represent a different style
that we want to apply to our views then
all we have to do is they have a
resource library contracts elements into
the faces config and this will specify
the URL mapping to invoke a particular
contract so basically what we have here
and I'm not going to really be able to
increase the size of the Navigator over
here but maybe you can see I've got this
folder that's named contracts and inside
I've got two folders one of them is
named admin the others named standard so
what happens is when you visit any of
the URLs in the application that does
not have admin specified in the URL
you'll get the standard resource library
contract but in template otherwise
you'll get the admin view so let's take
a look at how that looks
so right here I'm logged in as a
standard user it's blue and I'm going to
log in as Jo user who has some Authority
and now you can see it's green not very
hard to implement
so like I said if you've lowered them
into the contracts folder and then all
the resources such as a cascading style
treats the JavaScript these can all be
packaged into the individual folders
underneath the contracts folder and the
good part about this is that we can
actually wrap this up into a jar and we
can ship it into all their applications
and reuse these templates so let's say
you're interested in mixing html5 and
JSF okay so maybe you have a set of
developers that know html5 very well and
you want them to be able to call into
the JSF runtime or perhaps you would
rather use JSF markup and just include
some html5 attributes somewhere in there
we can make this happen really easily
with the new integration what we do is
specify a pastor elements into the views
in order to make this happen so if you
want to make use of the html5 elements
within your JSF components what you do
is specify pass-through attributes
actually I take that back it's actually
the JSF attribute which is going to
prepend any of the html5 attribute that
you add to your JSF component and it's
going to be the opposite for
pass-through attribute that you're
wishing to let JSF runtime ignore so
let's take a look at this here is it on
the bottom you've got a JSF component
it's just a regular input text component
and it's using the html5 placeholder
attribute JSF knows nothing about this
but if you go ahead and prepend that
with the PT which is the pass-through
attribute then JSF runtime will ignore
it and so I can show you how that works
so in this case we are using straight
html5 this is all done in html5 there is
no JSF code here at all other than other
than actually the facelets so if I open
that view
you can see here that what I've got is I
repent actually any of the html5 IDs and
values with JSF which is passed in here
using this namespace okay so at least
one of the IDS in this view must be
prepended with this JSF in order for the
JSF runtime to incorporate this and be
able to utilize it so when I go ahead
and submit this form it's going to
actually submit to the JSF runtime and
we can be processing it within the
managed beans as you can see I can set
the values into a particular JSF managed
bean controller just by prepending it
with JSF and this other view here is
actually going the other way and we're
using JSF and including html5 attributes
within
you can see right here so a little bit
more about how it works
you have the jsf namespace to the views
for the pasture elements and then you
can allow that element to be processed
by a JSF runtime by prepending
those attributes with JSF and to be
treated as a JSF component like I said
at least one of the elements must
contain the JSF passed through and then
we can do the converse using the pass
through elements right and this is
applied to a JSF component to signify
the specified attribute should just be
ignored by the JSF runtime this allows
us to utilize any of the html5
attributes you know you can have a
single pasture attribute be specified by
nesting and have passed through
attribute inside of a JSF component or
if you want to use multiple pasture
attributes you can also go ahead and
specify s pass through attributes and
you can pass a list
so being validations everybody familiar
with bean validation how that works with
straw hands okay so this has been
updated quite a bit in Java EE 7 we've
got my third level validation can you
see L expressions in our error messages
now and that there's dependency
injection of B validation components
integration with CDI and much more so
for this particular problem but let's
say you want to apply a server-side
validation for an entity bean this is
going back to Java EE 6 how do we do
this this validation using bean
validation all we have to do is apply
the necessary bean validation
constraints on the fields of the entity
class here so as you can see we've got
not null which will specify that that
cannot be a null field we also have a
size restriction and this is going to
say that the last name must be at least
one character if it doesn't meet that
requirement you can see that the message
is going to be displayed
so if I go back
to my form and I don't specify anything
you're gonna see I get a bunch of
messages this is being validation this
is going to hit the head and showing me
these error messages because they're not
working I didn't specify the exact
values that I needed to add so if I add
the first name you can see that goes
away so basically just paste in place
the validation constraint annotations on
the field and when the process
validation phase occurs then that value
will be validated and it's either going
to fail and that message will be added
to the faces context or the life cycle
will continue to process normally so
what if you wanted to validate methods
parameters or return value without
writing an extra layer of code we can do
this now with being validation 1.1 by
applying constraints to parameters and
return values here's what it looks like
so in this create reservation if I
wanted to specify that these parameters
happens to fit specific criteria I could
apply the validation constraints right
to these fields now you can also do the
same thing with a return value so in
this case the integer must be value of 1
minimum or greater so it's a value to
validate the parameters for a method
just basically place the parameter there
are excuse me the annotations on each
parameter and a constraint validation
exception is thrown if the validation
does not work so it's also possible to
specify constraint that applies to more
than one parameter going into the method
and this is known as a cross parameter
constraint and these constraints are
applied at the method or constructor
level so basically the same way you
would specify a return value validation
so how we
differentiate these two the way we do
this is to specify the validation
applies to element of the constraint
annotation and you can either specify
that the target is the return value or
the parameters okay so let's say you'd
like to excuse me I'd like to display
whatever entry that the user made into
the form you'd like to display that back
out in your air message somewhere this
is easy to do now with that being
validation because you can actually
specify the value that comes in right in
your error message using expression
language as you can see there's a dollar
sign and the curly brackets and then
there's a validated value text and that
Deb will actually pull in the value that
the user has entered yes to localize
them to a bundle yeah you can do that so
the current value can be embedded in the
error message using this syntax here and
you can actually also use conditional
logic within the e/l expression and the
validation engine also makes a formatter
object available if you wanted to format
dates or something so let's move on to
CDI so there's been quite a number of
small enhancements made the CDI there's
been improved alignment of JSF component
model CDI is now enabled by default so
you don't need to worry about putting it
beans XML that's just empty in your
archive any longer there's support for a
round construct life cycle callbacks and
more so this is going to go back again
to
eg6 and let's say you'd like that just
access a JSF manage being from another
managed bean so in this case what we
want to do is check to ensure that that
user who has entered the reservation
has booked their mandatory restaurant
reservation as well so we want to call
upon the restaurant controller from
within the park reservation controller
okay and the way we do this just to
simply inject that resource into the
management of your choice how many
people have used CDI injection
okay so we're quite familiar with how to
do this so I don't have to go into any
code really here but you can see we've
got a restaurant reservation controller
that you can access using the values
specified in a named annotation and then
we can just go ahead and we can inject
that and then we can call upon that any
of the methods using that injection so
CDI is now enabled by default so you
don't need to include the beans XML
anymore if there is no beans XML
specified the bean discovery mode as
annotated as assumed okay all the
possible values for bean discovery mode
are all annotated or none so the default
is annotated and as I ve six managed
beans can be annotated with the @ name
so I just wanted to kind of put it out
there just as a general note that manage
being can still be used but really we
should be more trying to look at using
CDI if you're still using the managed
bean annotations so let's say that
you've got CDI setup so that all the
beans in your application are going to
be processed with CDI but you want to
mark one or more of those to be ignored
by CDI this is easy to do by adding the
be to'd annotation so all you do is as
you can see here what I've done is I've
added that vetoed annotation to the
entity class so when you mark a class
with veto that means that it's just
going to be ignored by CDI and see I
will not be able to process that class
so therefore it will not be injectable
and it will not be contextual if you
place this and it's
on a package than all the beans in the
package are going to prevent it from
being managed so now and forever anybody
ever use the interceptors familiar with
interceptors okay so this can actually
invoke actions when when different
processes occur with cd-i well why would
you want your entity class to in some
cases be managed by CDI
there that may be one case where you
want to just make sure that your entity
class is not going to be managed by CDI
at all actually in my application here
if I can get back to this I've taken an
annotated all of my entities with Beto
it's just a good practice unless you
actually want your classes to be managed
by a CDI then you don't have to worry
about any issues occurring so in this
application there are actually two
interceptor classes they are at
reservation changes and logged new
reservations each with their own binding
and so what we want to do is prioritize
these interceptors so that we know which
one is going to be fired before the
other ok this is impossible now by using
the priority annotation you can specify
a priority on the different interceptors
and this is can also be used to define
the ordering of alternatives and
decorators okay and so the priority
annotation requires an int value and the
lower the number the higher the priority
of the Associated Interceptor or
alternative or decorator these are the
different constants that can be used for
specifying a priority okay okay
concurrency utilities for Java EE this
is one of my favorites I'm gonna cover a
couple of recipes here
but if you come to my talk on Wednesday
then you're gonna see a lot more okay
that's in the same room and I don't know
the time well every look at that I'll
let you know though
but what concurrency utilities for Java
does is it gives us a standard now for
doing concurrent operations within
enterprise applications we don't have
it's not a good idea to be using threads
in a server that are unmanaged we want
to be able to manage these threads so we
know you know what's happening we don't
want to take all the server memory up so
that all of our other applications are
failing or something right so this
actually built upon the Java SE
concurrency classes foundation so let's
say we want to execute a process in the
background and allow the user to
continue performing tests while that
process is being performed so in this
case we want our managers to be able to
click on a button to get reservation
information and then they can go about
continuing their work because we know
they're busy and we want them to
continue navigating the site so when a
user clicks the button what we're going
to do is actually send the task to the
manage executor service which is a
server-side resource and that's going to
go ahead and process the work and when
it's done it's going to send this future
object back and we can go ahead and make
use of it so the way that this happens
is you can go ahead and you can inject
one of these manage executor services
into your class and this by default
GlassFish has this default managed
executor service in any Java EE 7
compliant application server has to
contain these managed executor a default
managed executor service and what I'm
doing here in the bottom is creating
this class which is called Acme
reservation report passing some context
to it and this is a managed class
actually and then what I do is I take
this managed executor service and I
submit the class to it and return a
future object I can then pull that
future object and
act upon it once it returns okay so
let's take a look and how that works so
I've got my report generator this button
here is our managers report button and
you click on it and it goes pretty
quickly because I'm running on the same
laptop as the database but as you can
see here I or not it may be a little too
small but I've actually got so output
that was generated when I clicked on
that button they have random reports and
let me show you the code
we can see that this is a callable and
actually so when this gets thrown to the
successions it shouldn't say thrown
submit it to the managed executor
service the call method is actually
invoked and I can pass context from the
caller to this class and when that call
methods invoked we can actually see that
the report is run so again this is
actually extended from Java SE
concurrency package so if any of you
familiar with that this is gonna be a
no-brainer it's really easy to use and
then the concurrency utilities for EE is
also and like I said before any of the
Java you use 7 compliant application
servers they must contain the resources
that are required to use these
concurrency utilities ok
so of course I'm glass fish man so I use
default manage executor service and
concurrency utilities relies upon jte to
maintain transaction boundaries and if
you don't want to work with the
annotations for some reason J&amp;amp;A I look
up also works and as I mentioned before
a task is a class that implements
callable or runnable actually and you
can actually also implement an interface
that's known as manage tasks this will
give you more details into the task
that's being executed I'll go into that
more detail in tomorrow's talk tests run
in the same context as a component that
submits a task and then if you want to
submit an individual task you use the
submit method and return the future
object ok and again there's the class
these slides will be posted too by the
way because I know I'm going through a
lot so let's say you're interested in
just using a regular old threat we
wanted to execute this task on a managed
threat okay we want this thread that be
processing in the background so in this
case we want to be alerted whenever a
new reservation is placed in the system
and execute an alert or task in the
background so we can go ahead and
utilize the manage thread factory
resource this is how you do it it's very
similar to what we did with the other
solution right here we're injecting this
manage thread factory and then we can
create a new thread off of that thread
factory and again the class that we send
to this thread must be callable or
runnable okay and then that's just going
to it the start methods are going to be
invoked on that thread and it's gonna
process in the background so I've got an
example of this right here if I click
this button you can see it's gone
quickly and I've gotten my output back
but this has also gone through and it's
now giving me a report of all the
different reservations let me clear this
just so I can prove to you that I'm not
cheating
there's my task it happens so lightning
fast and on you need it but ok yes
if I want to
this is a separate implementation it
actually extends upon it but you have to
use these manage resources on the server
because actually what's happening is I
should have repeated that I think your
question was if we utilize Java st
concurrency and we put it on the server
well it go ahead and be processed the
same way correct so what happens is the
managed executor service actually has to
be called upon to run this in a managed
fashion on the server so it's a little
bit different than the concurrent and
the Java SE but actually all the API is
the same okay hope that answers your
question
so again server managed thread execute
with the same context as a caller and
then the thread class must implement
runnable okay so I'm gonna move on to
each a piece
so the ejbs are a cornerstone of Java EE
there have been a few updates in ejp in
Java EE 7 go through a couple of those
so well if you wish to mark some
lifecycle callbacks methods as
transactional so let's say we want to
start a new transaction when a
reservation booking occurs can do this
we can opt into the transactional
lifecycle callback by annotating a
method with a transaction attribute
annotation now and we can pass that the
transaction has pre type to that so by
default staple session being lifecycle
callbacks methods are now hopped in
transactional ok and again here's the
transaction attribute to specify the
transaction type
and these are the different values that
you can go ahead and pass so another
thing that is new is we can now get more
information on our active timers so if
you wish to return all the active timers
in your application that's possible to
do now just by making a simple method
call so in the Acme world application we
have an active timer that sends
notifications to the reservation holders
to have not yet booked their obligatory
restaurant reservation so what we want
to do is call upon this to see when the
next time this timer will be call ok and
so it's easy to do all we have to do is
call upon the timer service get all
timers method and that's going to return
a collection of all the active timer
instances and actually what I've done is
I've done that and then I put it into a
string format and returned it here on
the screen so we can see what the output
that we get back about the next timer
and the next scheduled notification this
is actually when the timer is scheduled
to to go off is it ok ok well it's like
I said some of these things are covering
86 and 87 these are just some useful
things that I thought were good for
including in this presentation thank you
so well here I actually did put this a
newly added convenience API to get
Alzheimer's and you can get all the
active timers that are associated with
the beans in the same module in which
the caller bean is packaged ok this
includes both the programmatically
created timers and automatically created
timers
okay so okay that's the difference I
appreciate it thanks okay
so JP a 2.1 got a couple of enhancements
in Java EE 7 we've now got stored
procedure support custom converters
schema generation unsynchronized
persistence context and more so in this
problem we wish to a call upon a
database stored procedure to perform a
task in the database and this particular
stored procedure is called create user
ok so we want to utilize the stored
procedure query to invoke this stored
procedure ok utilize the energy and
entity managers create stored procedure
query to invoke a stored procedure
there's also a create name for store
stored procedure query that you can use
to call upon a name stored procedure ok
and so this is a lot better than writing
some custom code to call a store
procedure in the database you can also
register parameters by invoking store
procedure query register stored
procedure parameter method and then you
pass the required values ok and then you
can just go ahead and invoke the store
procedure by invoking the execute method
so like I said in the past we had to
implement some hacks to call named our
native stored procedures and it's been
made a lot easier in Java EE 7 with the
stored procedure query and if you want
to return a result from this stored
procedure as possible by calling upon
that get output parameter value method
and for a convenience store procedure
can be registered like I said before as
a name procedure using the name stored
procedure query annotation and that can
be placed on the entity class
so let's say we wish to invoke some
lifecycle callbacks methods and perform
some additional tasks when a park
reservation is created but we also want
to inject some resources into these
callback listener classes in yeast 6 you
could not do injections into these
listener classes but now we can in this
solution we created an infinite listener
and perform a task using one of these
lifecycle callbacks methods you can see
that we're injecting male session into
this callback method we registered a
listener using CDI not much to say about
that one
it's just working now CDI it just works
so let's get into some JSON P JSON
processing this is a new specification
for Java EE 7 and it's a new standard
for generating JavaScript object
notation it provides a parse an API to
parse transform and query JSON data
using the object model or the streaming
model to separate module models that we
can use in this talk I'm going to talk
about the object model okay the Java a
JSON package contains a reader interface
a writer interface and a model builder
interface for the object model and the
stream package contains a parser
interface and generator interface for
using the streaming model now the
differences are that the object model
API is kind of like the Dom API object
model it uses a builder pattern to model
JSON objects and stores that as a tree
structure to represent the data in the
memory and there's a JSON reader
interface for consuming JSON objects
JSON object builder and JSON array
builder for producing JSON Tom Mix
streaming API we're not going to cover
here is a little bit different similar
to a sax API okay and that's for
more memory intensive JSON when you want
to and submit larger amounts of data
okay so in this particular problem we'd
like to submit and build a a JSON object
model using a Java code we want to
actually create a list of the current
reservations in the database using JSON
P so we utilized JSON processing for
Java EE to actually do this and here's
how we do it let me actually jump into
the code a little bit too after I get
done with this so you can see a little
closer but what we do is we create this
JSON object builder we create a JSON a
create an array builder and then we
create a string builder and then we go
ahead and we just loop over all of the
actual records that we want to process
and we go ahead and add them to the
Builder okay
and in this case we have several arrays
that we're adding to the builder and
then at the end you add the arrays to
the JSON object builder and then we just
go ahead and execute the build and that
will return a JSON object so not sure if
you'll be able to see it very well with
the way I've got to magnify this but
you can see here what I did is actually
I'm just calling upon a JP a find all
method to return all these park
reservation objects and then I'm looping
over them and adding them to a JSON
object so just a little bit about JSON
defines two data structures objects in
the race and we've got the object
builder and the array builder in the
JSON API there's so seven different
value types that you can use I've got
those specified up there string number
object array true/false and null and E
includes support for jsr 353 which is
the API to parse transform and query
JSON data we don't yet have a JSON
binding API but hopefully in Java EE 8
that will be coming so you should
probably attend some Java or some
sessions on Java EE 8 to learn more
about that make use of the JSON object
builder to build a JSON object using the
Builder pattern and you can actually
call upon any of these add methods
passing the different values to create
the object that you'd like to create you
can also nest objects and arrays so like
I did in my example I have a bunch of a
rays that I then add to the object but
we could actually nest these and create
this really long big JSON object if we
want to and then actually at the end you
invoke the build method that will
produce the JSON object that we can go
ahead and use so we've gone ahead and
generated the JSON object model and now
we want to write that to a file okay so
when you do this using a JSON writer
which can be created from the JSON class
a java x json class
and that's how you do it you can see
that we call upon the build method then
we get that JSON object and then when we
call upon the JSON that create writer
that's going to actually create a writer
on that string writer that I had in the
initial code that's going to return us a
JSON writer that we can write the object
with let me show what this looks like so
if I want to write all these
reservations click on that and actually
in the background all day what's
happening is it's writing the object to
that string and I'm just displaying the
string using JSF ok but you can see that
it's actually written it all out
so this is instantiate by passing a
writer as an argument so you're gonna
have multiple different types of writers
we're gonna have a file writer you have
a string but a string writer and call
upon the right object method to get the
jason to pass the JSON object you wish
to write out then you should always
close the JSON writer when you're done
so now we want to parse some JSON and
one more thing I want to show you too
if I dive into this code a little bit
more you can see that I've actually
called this method right to disk to show
you that I can write this I actually to
the file system as well so
there we go that's the file that it was
created so not only did I push it into
the string to display on screen but then
I pushed it into a file I know we can
pass this wherever we want and create
these great applications so now we've
got the JSON we want to parse using Java
we can do that use the JSON parser to do
this it's a pull parser and we can go
ahead and process each record using
iteration we iterate over each record
and get the event and then we actually
can switch upon that event to do the
processing that we wish to do okay so if
I go back to my code I can show you that
as well I didn't really actually write
out anything here but you can see what
I'm doing is I'm iterating over the
events and if it is a key name I'll do
something about your string so any of
the actual events you can go ahead and
process any way you want to pretty
flexible so again the parser is created
on a one byte or a character stream by
calling the Create parser method and
then you iterate over the JSON object
model or ray and parse each term in
here's the different JSON events if you
can read that WebSockets this is an
exciting new API another one of my
favorites provides support for building
WebSocket applications and this uses
full duplex communications between two
peers over a TCP protocol okay so it
makes it possible to really get a great
performance when you're trying to do
some transmissions over the web okay so
in this case we wish to create a website
at endpoint that can be used to receive
messages asynchronously okay so what we
want to do is create a WebSocket
endpoint by annotating a POJO class with
the server endpoint annotation and then
you just go ahead and provide the
desired endpoint
anybody used web sockets in here yet or
the web socket API okay so this path is
a lot like jax-rs if you used rest and
basically you just provide this path in
a string format so here's what my chat
endpoint looks like you can see that
I've annotated and provided a value of
Chet endpoint so that's the URI that
will make it accessible on they're going
put it there as well
so what happens is we've also got two
methods here which I'll talk about I've
got an on message and an open when you
pass the message to the WebSocket the on
message gets invoked when the connection
to the WebSocket is open the method
that's annotated without open gets
involved okay so to create a web socket
endpoint just go ahead and easily
annotate an POJO with the server
endpoint annotation and then as you can
see on the bottom that's what the URI
would look like it would start off with
a ws and you have your server port
application name and then the path that
you put in the server endpoint
annotation and then again the method
annotated with unopened as in bulk when
the website can connections mate and
that on message is invoked when the
message is actually sent okay so in my
example I actually also have an optional
can do an encoder or decoder to go ahead
and take that message and package it up
nicely for processing and then you can
put it back into specified you know
object to pass back to the client a
different format and this is what a
decoder might look like so in in this
case it's just taking a string based
message and we're using the JSON API to
create a JSON object
and and then we go ahead and we put it
into a chat message POJO okay and then
we can process it so let's go ahead and
take a look at what we do now what this
next recipe we want yes hmm Reza okay
yeah I wouldn't think that would limit
the scalability
that's in the West one part of cigarette
smoking
and I work at Fermi National Accelerator
Laboratory so I only work with about
3000 people and I don't have to worry
about that and that's that's all I get
away from away with it but okay so now
let's say we want to send a message to
the WebSocket endpoint what we're going
to do is add a chat service to the Acme
world application we're going to utilize
a JavaScript client to open a connection
to a WebSocket endpoint and this is
going to invoke the method that's
annotated with an open okay so as you
can see we're going to pass we're going
to utilize the URI that's specified as a
service location and then in the connect
connect to a chat server function here
we're going to pass that service
location to create a new WebSocket okay
and this is when we would receive the
message and when you when you get that
message back on the client then you can
process it in any way you'd like so it's
going to actually be parsing this JSON
on the way back and putting it out there
in HTML and displaying it and if we were
sending the message then we go ahead and
just send it in JSON format that we've
constructed using JavaScript string
basically and then pass that to the
WebSocket so let's take a look at how
that actually works so I'll connect so
now I'm connected to my WebSocket
endpoint and I can send the message and
you can see that the message is sent to
the WebSocket and I get a response right
away not all that interesting but if I
go ahead and I connect
as Duke
you can actually see that we now have
the full duplex communication happening
here okay
so the WebSocket server package contains
annotations and classes to create and
configure endpoints and to open a
WebSocket connection you can use
JavaScript and the WebSocket takes two
arguments the first is the endpoint
location and then the other one's the
optional string of parameters if you
want to send anything additional once
connected and send messages to the
JavaScript and construct the JSON object
to go to the server and come back you
can use n quarters and decoders for this
then go ahead and run through these
other recipes I've got here real quick
so I want to show you a little bit of a
JMS 2.0 biggest thing is simplification
so let's say we wanted to send the
message to a user and they create a
reservation so we can utilize JMS to
create and send a message to the JMS
queue easy to do by just simply
injecting this connection Factory and
also we're going to inject the queue
into our class and then what happens is
you create this new JMS context object
by calling the connection factory create
context method and really JMS context is
the magic of JMS snell 2.0 because it's
easy to go ahead and create a message
god just go ahead and create producer
and send it to the inbound queue we're
gonna send the reservations last name
here in this case simplifies the API
everything implements auto plausible non
transaction sessions our default so
really there's no additional overhead
that you have to do as far as typing
it's just really easy to go ahead and
create a producer and send a message
same what's that I would say it's still
happily used yeah and it just depends on
the market that you're looking at
and lots of lots of bigger organizations
using it for messaging so let's say
you'd like to consume a message from a
queue and do something with it we can do
the same thing with you can use their
use the classic API or the simplified
API but go ahead and we get this JMS
context object again by calling upon the
crew a connection factory create context
then off of that we can basically create
a consumer to the inbound queue and then
call upon the receive body no wait and
we received that message body a lot
simple simpler than it was in the
classic API I would show that but I'm
running out of time so if you get a
chance you should go ahead and compare
the two or you can look at my slides
when you get back let's say you want to
delay your message so you can specify a
set delivery delay so as you can see
here when I create the producer I
specify set deliver delay and then I
give a specified number of milliseconds
so this message will now not be sent for
on a thousand milliseconds okay easy to
do again that's in milliseconds so
jax-rs
a couple new features the biggest one is
a client-side API also we have a sync
support now that we can use in filters
and interceptors so your application
contains a web service for obtaining
information from specified URL and you
want to generate client requests the web
service information you want to do
something with the response okay
basically so what we want to do is
create a jax-rs a client using the
client API to build and what you do is
you basically just call upon the client
builder new client and then that will
return you a client object and then all
you have to do is specify the target in
this case the target is a rest endpoint
I created to retain all reservation
obtain all reservations that will give
us a web target and then you just invoke
the request method and you specify the
media you'd like to get back so in this
case we want to get back XML and
we'll return as a response okay so I do
have a working example of that yes
excuse me a sink
yeah a sink request so basically I've
got this jax-rs client that I've written
and I can invoke it and I'm returning
the response right here doing the same
type of thing returning in strength
okay so again just go ahead and simply
call the new client on the client
builder to get your client and then you
can also set name value pairs using set
property you can also further qualify
the path if you need to do that it's
real easy to do this it comes in handy
if you want to specify a dynamic path
and last here's what we're going to show
you the asynchronous response so if you
want to make use of a synchronous
response allowing the test to be
performed in a synchronous fashion all
you have to do is specify the suspended
annotation in passing an async response
parameter to your method and then you
actually don't have to return anything
you can have return value of void if
you'd like and if you can see at the
bottom here of the method we call this
async resume when this method is
finished processing processing that
resume method will be invoked and it's
called only synchronously and this
happens in different threads so the
calling thread is actually separate from
the thread that's processing the
response okay and then you can actually
get that response back and do something
with it when you're done so again this
is separate threads we got the client
thread the returns and then you can
continue doing your regular work and you
have a response that's returned in a
separate thread and the runtime does
know when the method completes and then
that's it so we have covered a lot but
there's a lot more to cover
and so I wanted to just let you know if
you want to learn more
there's my books Java recipes Java EE 7
and introducing Java EE 7 thank you
the code will be available I'm Jen Hart</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>