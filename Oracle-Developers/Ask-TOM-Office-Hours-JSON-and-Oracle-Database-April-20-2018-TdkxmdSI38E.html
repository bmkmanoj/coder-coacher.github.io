<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Ask TOM Office Hours: JSON and Oracle Database, April 20, 2018 | Coder Coacher - Coaching Coders</title><meta content="Ask TOM Office Hours: JSON and Oracle Database, April 20, 2018 - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Ask TOM Office Hours: JSON and Oracle Database, April 20, 2018</b></h2><h5 class="post__date">2018-04-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/TdkxmdSI38E" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">there we go
everything developers need to know about
integrating JSON into the Oracle
database and what we've covered here is
two parts of adjacent functionality the
first part is you know if you're an
application developer and you want to
build no sequel style applications how
can you do that without losing all the
advantages of the Oracle database and as
we'll see in a moment the answer for
that is something we call soda simple
Oracle document architecture which is a
specification of an API that lets you
build no sequel style applications that
use JSON documents for data persistence
and it's a very simple API similar to
what you would see with a no sequel
database like a Mongo or cloud a cosmos
um but instead of storing data in a you
know a simple no sequel database it
stores data as JSON in the Oracle
relational database and this gives you
the benefit of all the you know
flexibility and ease of development that
you see with an o single star database
combined with all the enterprise
capabilities and queer ability of the
Oracle database so the third part of
this slide is the big differentiator
between using um you know Oracle and
using a no sequel database with a no
sequel database you can build an
application quickly you can deploy the
application quickly you can make changes
to the application quickly because it's
using Jason's persistence well all of
that is true if you build your
application using soda and the Oracle
database you don't lose any of the
flexibility benefits and you don't have
to learn any sequel to build the
application but when you want to perform
queries and reporting on the data your
application has persisted you still have
the full power of sequel available to
you to do that so we're not throwing the
baby out with the bathwater when we
adopt soda and no sequel style
application
typical no sequel database yes you get a
powerful flexible application
development environment and you have
little or no querying reporting
capabilities with soda and the Oracle
database yes you have a powerful and
flexible application development
environment and you have the full power
of sequel for reporting and analytical
purposes so let's take a look at that in
a bit more detail so our propositions
you know basically we're supporting no
secret location development on top of
the Oracle database and our aim here is
to combine the flexibility adjacent with
the strength of the relational model
we're going to avoid all the costs and
overheads associated with polygon
persistence which is what some
organizations in that with where they
have some applications that use no
sequel databases to store their data and
some applications of the using
relational databases and then
unfortunately find they have
applications that need to use both and
now they have a very complex problem of
building an application that accesses
both kinds of data and even if they can
build the application keeping the
databases in sync and preparing disaster
recovery and hang a disaster recovery
plan that will deal with recovering two
separate databases can become very very
complex you know that's the downside of
the colleague böck model they may claim
they give you you know optimally optimal
support for each kind of data but trying
to manage it becomes a real headache
with Oracle we believe that we can give
you the benefits of polygon persistence
you have a best agreed no sequel
database and best agreed xml database
the best of each facial database address
to read text retrieval system and the
best of read relational database and
they all happen to be the oracle
database so you don't have a polygon
persistence problem and we enable the
full power of sequel reporting and
analytical queries to be applied to your
json documents please do feel free to
interrupt me as I go along here it's a
session much more enjoyable for all of
us so you know looking at the
capabilities of Oracle 12c we basically
store Jason as bar chart club or blob
when we built the XML processing which
I'm also responsible for
and happy to take questions on if there
are any we build an XML data type and
that had certain advantages but it also
caused a number of problems it took us a
long time to get all the other features
of the database working with XML so you
know it took a long time to get
replication logical standby physical
standby dot dot dot dot all working
properly with the XML data type so when
we started building Jason we will look
at this and said you know adding a new
data type is complex let's see if we can
just work with the existing data types
and and so we went to the standards body
and we talked to IBM we also were you
know looking at how to integrate Jason
into the database we said you know our
experience on introducing XML is the
last thing we want to do is introduce a
new data type in IBM so thank God
you know clearly have been just as big a
problem themselves Aysen we decided that
we would store it as wild child club and
blob and we will simply use a constraint
to ensure that the content of that field
is Jason we wanted to make it possible
to query enough JSON documents using
both equals and PL sequel and clearly
it's not yes you have to store the de
documents in the database beyond query
then we need to be able to optimize
those queries and we want to make sure
we use all of our query optimization
capabilities indexing in memory and
Exadata
with the JSON data one of the
interesting things that we realize is
that one of the problems people face
with Jason is it's very flexible and
they basically have no idea what they're
storing so we wanted to give you
abilities to discover information about
the structure and content of your JSON
documents it's something we call the
Jason data guide so I talked a bit about
a little bit later on and we wanted to
be able to generate JSON documents from
your relational content some of you may
be familiar with our XML capabilities
where we can generate XML documents in
relational data but we've had a similar
capabilities for Jason that can generate
complex and deeply nested hierarchical
structures in Jason directly from a
sequel statement and we want to do
integrate Jason with the other types of
content that we store in the database
the multi model database as distinct
from a polygon
so let's talk a little bit more about
soda soda as I said is something to the
application developers you know those of
you who are DBAs or undoubtely hearing
from their from the application
developers that they don't want to be
writing sequel they don't want to learn
sequel they don't want to learn JDBC
these api's are complex difficult to
understand they want something that's a
much simpler approach to application
development and that's what soda is it's
simple Oracle document access and no
sequel style API for the article
database it gives them the ability
through the API to create and manage
their collections of documents to insert
retrieve or create retrieve update and
delete operations on those collections
to list the contents of the collections
to search the contents of collections
using query by example approach and then
utility and control functions for
allowing things like bulk inserts and
index management for the soda
specification lays out an API that are
very simple no sequel like API that
gives developers the ability to do all
of the things that the application needs
to do in a very simple and
straightforward manner developers can
develop against soda and work with
Oracle without having to learn sequel
but without having to call the DBA every
time they need to create a collection or
droplet lecture it basically gives them
that same development development
experience as a pure play document store
soda can be used to store JSON content
and binary content when binary content
is anything other than Jason and it's
currently available for Java the Java
API and a REST API and we're working on
other implementations in fact with 18:1
we have delivered the initial versions
they're not complete implementations of
the specification yet but the initial
versions of soda for PL sequel and soda
for OCIO for the C programmers however
currently you know no matter what
programming language you're working in
the chances are it can make a restful
issue an HTTP request and that's why we
you know one of the first releases of
soda
arrests because using soda for rest you
can basically invoke soda at talk to a
narc or documents door from just about
any programming language and yes I
didn't actually do it from Colville just
to prove it could be done I wouldn't
recommend it but it is possible so
differential inflection of microservices
for working with Jason collections and
Jason documents stored in the Oracle
database like most risk models it Maps a
URI pattern onto an operation on the
document collection and as I said it can
be invoked from almost any programming
language you can think of as long as
that language can make an HTTP request
it can invoke soda for rest the delivery
mechanism for soda the rest is delivered
as part of oracle rest data services or
distri point knowing about so basically
to get so the farest you simply download
odds from the Oracle technology Network
it's a free download you connect it to
you configure it to connect your
database and you're up and running and
basically it just consists of a series
of HTTP requests and responses with JSON
payloads one thing to remember about
soda arrest it's HTTP based so basically
it is stateless there is no transaction
support and service arrest each
operation on your document store is
atomic which give me one second I didn't
in talking to the entire session and I'm
running a little dry I'm just gonna grab
a water
um okay so you know give you an example
what so DeForest api's look like we map
a schema as a containers and the
container for your texture so an Oracle
database schema and contain one or more
collections so the root here is a
virtual URL of it can be a number of
different shapes depending on how boards
has been installed but fundamentally at
the end of the day it's something like
you know boards schema latest soda then
schema oh sorry old ski
later soda will get you the list of
collections in a schema if you then do a
list and get on a particular collection
the add the collection name to that URL
you'll get a list of the documents in
that collection if you then add an ID to
that URL you will get the document
associated with a particular ID to
create a collection you simply do a put
on the collection URL
to update an object given its ID you do
a put on the collection URL with the ID
to insert an object into the collection
you simply do a post to the collection
URL and then post is overloaded with
some things for other functionality like
QBE and indexing as we'll see later
here's a simple example of how easy it
is to use soda first from node.js this
is actually using the request NPM
package and I simply set up the request
options I'm doing a put I've got a
function in my node that knows how to
find my document store URI the base URI
for the document store and I simply
append the collection name to it I tell
it that it's getting send application
Jason the content type of the post it's
going to be application Jason and I add
the Jason document to the request object
using the keys Jason I can then simply
invoke so the farest
by calling the request function that's
provided by the request promise native
NPM package and you know passing the
username and password by the
authorization option and what I'll get
back is a soda doc it's a JSON document
describing what happened assuming the
operation succeeded it will have
assigned a key to the document and give
me back that key so love the Java very
similar idea it's a section of Java
classes that implement soda and can be
called in Java it have classes
protection management for performing
crowd operations on the documents for
doing query by example and the utility
and the control functions and the
advantages soul of a Java so compared to
writing a JDBC program is it's much much
easier for the application developer to
build the application the only bidder
jdbc you need to know in order to use
solar for java is how to connect to the
database this allows us to do so we
basically ride on the JDBC connection so
we can take full advantage of the JDBC
pooling and another functionality by
default a JDBC connection is
non-transactional it's an auto commit
mode and so by default so the harest so
I said that the Java would be an auto
commit mode but with Tony the Java do
you do have the option of turning off
the transactional nature of the of the
auto commit nature of the JDBC
connection in which case you can now
have a multiple sets of solar operations
part of the single logical transaction
you manage the transaction through the
JDBC connection the other interesting
thing about solar for Java is back to my
point about the advantages of multi
model versus poly part is you can
actually have a transaction that covers
operations on your relational data
operations on xml data assuming it's in
the database operations on spatial data
operations on texture data and document
store operations can all be part of one
logical transaction and not return the
hybrid model and so the Java is an open
source implementation distributed by of
github so if you want maybe we sold it
to Java you simply go to github and
download the jars and if you want to the
source code from github here's a simple
example of inserting a document in soda
I'm going to use jisun here which is
Google's Java object to jason mapper and
to basically take in adjacent object and
then I get my collection by opening the
collection and I created up an article
document instance using jisun here to
convert my JSON object into j into a
tech my java object into jason and then
i create an oracle document from that
jason string and i simply insert and get
to store it in the database i don't yeah
if
considered trying to do all of this in
Jane JDBC natively you'll be writing
many many lines of code you can see here
the advantage of sodor if you want that
simple document store API we have two
three calls to insert a document into a
database and that includes open
detection and generating the document
itself on one call actually does the
insert I've talked about query by
example this is how we query our
database and we simply submit a JSON
document to the delayed database that
describes what we're looking for here
are some simple examples of me soda qve
language in the first case I'm simply
saying I want to retrieve the documents
ordered by the release date at key in
the second case I'm looking for
documents whether as a location object
with a city key that contains the value
San Francisco in the third case I'm
looking for an idea to attribute that
matches one of the values specified in
the in key or the array of values
associated with the N key I can do
full-text searching I can put multiple
predicates into a single query so here
I'm looking for movies with the idea of
10 1 0 9 4 1 0 and a start time in the
range specially fight it especially by
using greater than equal to and less
than and I'm ordering by a couple of the
other attributes and we also have full
support for spatial searches using
article spatial technology on documents
that contain geo json encoded points
lines and polygons
as I said soda 4pl sequined soda for AC
are restricted availability
functionality available with what was
the next release a month ago but is now
the current release 18 C cannot be
available in the cloud only but
basically allows you to do crud
operations on soda collections from PL
sequel the currently at the moment has
limited support for qve and other mix of
soda we're hoping that stuff will come
out in the not-too-distant future
hopefully before the next major release
of the database the the main reason for
having OC is it's going to allow us to
build a series of drivers moving forward
for other popular scripting frameworks
now that we have the basic OCI
connectivity from soda there is a sample
of all of this is available on github
and actually on NPM for the the node
version and you can download and run the
sole of the J an example using soda for
node which uses a soda arrest
sorry node application that uses soda
arrests and odds to talk to the database
and there's also a Java version that
basically provides the same kind of a
API as the node application but it uses
Jersey to provide rest services and a
straight soda the Java connection to
talk through the database um we can take
a quick look at that application I will
just start it up now my doors prompt can
you share that bad on screen please you
know I was like just let me uh get it
started um here we go
I not
sure let's got one got it now yes
yeah okay so that was just me firing up
boards I'll just kill it and start again
there we go so there goes wards and now
in this one I'm gonna do nose nose my
jaws Oracle movie ticket demo indexed of
Jas
oh sorry got one running already by the
look at it one second again you can edit
that out can't you Steve
sure there we go so now it's running and
here is our movie ticket demo HTTP con
localhost 3000
I'm okay so let me bring this I can't
okay I'll just bring the PowerPoint to
the front so we can look at what's going
on here so we're looking at this
architecture in effect actually slightly
different we're looking at html5
JavaScript an angular based front-end
consuming rest services provided by a
node application written in JavaScript
which is using soda for rest to talk to
Ords which is in then in turn actually
under the covers using soda for Java to
talk to a document store managed by the
Oracle database so I bring the
application back where'd it go
what we have here is a very simple
fandango like application most people on
the call are familiar with Fandango it's
a way to order movie movie tickets I
think my data is probably stale let me
see so if we look here we can see that
we have a list of theatres and ok maybe
I did update the date and let's go
forward to today
okay so we go back to our list of
theatres we can see that we have the
Roxy Theatre in San Francisco we drill
down on this and we can see that it's
showing these movies
and what I want you to see here is that
at the bottom here it's actually showing
the operations that were done to get the
data so you can see here to get the
movies for this theater I did a get on
the movie schema and the theater
collection with this particular ID which
was the internal ID and once I got that
I did a query by example looking for
movies on the sorry on the screening
collection looking to move these for
theater ID 30 start time between these
two dates and having got the list of
movies I then did a get on the movies
collection looking for movies looking
for the movies that were showing in
theatres on that date to get the
information about the movie so this
application not only you know shows you
the kind of thing that you can build
very easily with so DeForest and node it
also shows you what it's actually doing
what are the requests that are being
made via soda for rest in order to get
the data from the database and if we
want to we can select a movie and book a
ticket and now what you'll see here is
that you know we did a get on the movie
and then we did a post to lock the
ticket sale and a put to update the fact
that we have sold some seats in that
particular screening so a very simple
model I think that the code is all
available on get artifact on NPM just
look for a Oracle movie ticket demo and
there is also a Java version of exactly
the same front-end the front-end is
identical but it shows how you would
build the application using in this case
jetty is a web server and dirty to
provide the REST API and soda for Java
to talk to the database and the point
about this is that it's exactly the same
front-end operates with either of the
two mid tier architectures
okay I'm gonna try and go back to my
let's talk to now and continue to
intrude are there any questions at this
point
only the gone so it was a question from
Tim I don't know if you can see it in
chat no Hank I mean I haven't got the
chat window up so Tim one of our
challenges is reaching the developers
who are not Oracle developers this is
something that Steve and I and my
colleagues discuss all the time is how
do we reach the people who are not the
Oracle developers we're very good at
talking to our installed base we have
more of a challenge talking to the
people who aren't using Oracle today
Steve some extent this is more your your
area than mine I suppose but I don't
know how much we need to spend our the
office our session talking about that
which is more a question for Oracle than
for folks who are here to learn about
Jason so I suggest we you table that for
a conversation directly with Tim I mean
in general what I encourage database
developers to do is reach out to the UI
developers boot they're the ones who
need JSON and work with Jason all the
time and make clear show them that we
can actually provide the information
they need in the format they need rather
easily using our powerful sequel
features that you were showing before
yeah this application is designed to
show to them yes they can build a fairly
complex application without having to
write a single line of sequel and
exactly the same way that they would
build the application were they talking
to a Mongo or a cosmos or even possibly
a dynamo you know they don't need to
know that the back end is Oracle to
build this application they don't have
to worry about all the things they might
be concerned about
you know building an application on top
of Oracle's soda really does insulate
them from all of that look
try and move on though I should probably
done this slide beforehand this is the
data model that we were looking using
here we basically have four collections
of data
interesting you think that Judas Judas
commented that writing all the
non-sequel part of Sakhalin application
is much more complicated than learning
sequel and I'm afraid in general the
industry disagrees with me Judith you
know rightly or wrongly people have
decided that the no sequel databases
provide a simple and more intuitive API
for application development than the
sequel databases through yeah I I'm
beginning to believe I'm beginning to
agree with them now that I built some
stuff using sodor and looked at some of
the competition but you know our point
is yeah if you want to build that way to
build you know sequel style if you want
to continue building sequel build the
sequel style you can do either with
Oracle which you know has to be give you
better choices and better options and
then locking yourself into one stack or
the other um Tim was asking about XE yes
there's no reason or y soda wouldn't be
included next version of XE when it
becomes available unfortunately I don't
have any information that I can share as
to when that will be but I know it's
being worked on so I'm not going to
spend a lot of time on why you would use
Oracle I'm gonna assume that most of the
people here understand that but
fundamentally you know by using Oracle
as the database to manage your documents
you get the multi model you know when
you've got XML spatial graph and
relational you get the enterprise-grade
features for availability and security
high scalability and performance exudate
ER and RAC if you need it and it's all
available in the Oracle cloud so all the
benefits of the Oracle database you know
you've adopted the no sequel style
application development and you're
getting the benefits of that but you're
still getting all the benefits of the
Oracle database you're not throwing the
baby out with the bathwater
you know all the power of the database
for indexing and querying and you know
transactions and I see consistency
scalable performance if all the
capabilities in the database are still
available with 18:1 we also support the
sharding though we can push sequel Jason
operators and simplify the syntax with
some code written using oracle
simplified syntax for jason out to the
shards and coordinated through the shard
coordinator and all of the operations on
the jason can be pushed out to the
various different shards and a shard and
environment once you have our 486 so at
the moment that would only be in the
cloud but once 18c becomes premise
you'll be able to use shard in
conjunction with Jason and from what
we've seen our scalability testing shows
that we are scaling pretty reasonably
across yards for two nodes we got 1.97
throughput no against potential maximum
of two for four nodes we've got 3.6 for
again should we take to a maximum of
four so we're pretty pleased whether the
way that we're performing in a shard of
environment
but as I said it's not only no sequel
style development it's no sequel style
development when you need it but all the
power of sequel when you need it - one
of the problems with Jason and to a
lesser extent true with XML was it was
very good as long as the queries you
wanted to write with the queries that
the application developers have thought
about when they develop their data model
but the problem was what happens when
somebody wanted to ask a query that had
wasn't thought about at the time the
application was developed you know there
is no standard simple query language for
JSON documents and what we did was
rather than say let's build a new one
some what we tried to do with X query in
XML you know we learned from the school
of hard knocks we said why don't we just
make it possible to issue sequel queries
on top of your JSON data and with Oracle
that's exactly what you can do here's an
example of how we can query Jason deck
data using sequel in this first example
and query in my theater collection and
my favorite collection is stored using
blob fundamentally if you have documents
that are bigger than 32 K to manage we
recommend that you store them using the
blob data type the reason for that is
that you know hopefully by now you're
all using a or 32 utf-8 databases if not
at least for Jason I would strongly
recommend it the one downside of that is
you really don't want to store stuff as
clogged in a l32 utf-8 database because
it's stored as ucs-2 and so you're
doubling the size for no real benefit so
for JSON documents in an ale 32 utf-8
database where the 32k yeah max 32 K bar
chart - is not sufficient we recommend
that you use the blob storage model and
the one downside of that is when you
want to see the contents of the document
and sequel you'll need to wrap it in the
- Club operator in order to see it as
text but that's just for printing it so
here we go you know a print give me back
the document whose ID
so within that document there is a key
called ID with the value of one and you
see here I can simply query my JSON
documents by dotting my way into the
JSON structure after the column name and
the only thing I have to remember in
order to do that is I do have to use a
table alias so in order to use the
simplified syntax if it's table alias
column name dot path into your dayson
structure and then you can just query
away using sequel there are some
limitations to the simplified syntax for
getting rid of as many of them as we can
but there are certain things that you
cannot do easily with the simplified
syntax and for that and provide it's an
operators and JSON path expressions that
allow you to do things like tell us how
you want to see the data so these
simplified syntax it has no idea you
know a query time whether the jason it's
gonna find is bar chart or sorry is
string or number and so everything comes
back a string with jason value which is
the operator you can specify the jason
path and you can specify the sequel data
type you are expecting dressed in sign
yeah go ahead
the first degree how does the Oracle
database know that is a JSON document we
are not specifying int anywhere right
well my columns I'm sorry in this model
my column name is jason document but
that's not the day if there is no data
type or there is no or does it know that
that blob field is said Jay has JSON
document in it because what we well this
table was created through soda and if we
what solar will done is it will have
attached the is jason constraint
okay x famously thank you yeah
to to the column also in 18:1 we
introduced a treat as Jason which allows
you to if you do happen to have a table
and legacy table something which has
Jason content in it and you want we have
to query it using the Jason certified
syntax there is a treat as Jason clause
that you can now apply to tell a cop
tell the database that this should be
treated as Jason
so that we have as that slideshow we
have two ways of working with Jason one
is what we turn the simplified syntax
that basically allows you to just use
dotted notation to navigate your jason
content and the jason operators that are
part of the sequel standard and
introduced in single 2017 standard which
was developed in conjunction with IBM
but both techniques used jason park
expressions to navigate json documents
and jason path was derived from
javascript
so the operators we have are is
optionally not Jason allows you to test
whether a column has well-formed Jason
in it so typically the most common use
case is I'm going to put that as a
constraint on the column to tell the
database it should only contain Jason I
can also use it in something like a
where clause whereas if I have a table
where some of the content is Jason and
some of it is not Jason I can use it in
a where clause to filter out so that the
operations are only applied to those
columns that contain that adjacent the
second operator is Jason value which
allows you to extract a single scalar
value from your Jason document
Jason query is the antithesis of Jason
value it allows you to select arrays or
objects from within your jason documents
jason exists simply used in the where
clause allows you to Kontest whether or
not a Jason document contains a key that
has a particular value associated with
it
Jasin table if you're writing sequel
queries Jason table is the one you like
to use most often it basically allows
you to reject JSON data into a
relational format in the form of a
virtual table so Jason table goes in the
where in the from clause and allows you
to basically project an inline view of
one or more rows rows from your JSON
document and JSON text contains allows
you to do text based searching of your
JSON content
here's an example very simple query used
in the simplified syntax doing something
that is almost impossible in any of the
no sequel documents doors can anybody
tell you what I'm doing here that's
almost impossible in no sequel document
store
you never join between exactly exactly a
join you know it's so obvious to us but
it's almost impossible if any of the
Jason documents door so I know of even
those cosmoses support us equal likes
index don't allow joint
their lifestyle when you enjoy and do
some giants like that if the document is
not appropriate index is built its
identical to relational the coalition
you can index on under here also you can
index yes you could build functional
indexes you know if I was building this
and if something I was going to run on a
lot I would build functional indexes on
the document on the ID attribute in the
theater table on the theater ID
attribute in the screenings table and
the ID attribute in the movies table and
the movie ID attribute in the screenings
table and where would I put the start
time put the start time way up yeah one
of those indexes will be a compact
indexes well the start time in it but
it's just like you would do with
relational thank you here's the example
of filtering you more complex filtering
than simple all you know equal stores
the first one is a very simple one on
the left hand side here I'm simply
looking for documents where the ID
attribute which is found at the top of
the document matches the value of a
variable called dollar ID and then I'm
so that's my JSON path expression you
know dollar question mark open brackets
at ID equals equals dollar ID says look
for documents whose ID where ID is a
top-level key matches the value of this
variable and then the second part of the
statement passes one as ID now that
might look a bit strange why did I
bother doing that why didn't I just say
app ID equals equals one the answer is
binding by writing it this way that
becomes a cursor with a bind variable so
I can now if I execute a second
statement where I passed 3 as ID that
will reuse the cursor more importantly
if I was writing an application program
I would put my bind marker in place of
code on one so I put my goal on one like
that question mark in place of the
hard-coded one and I
get binding and get the ability to reuse
the statement with different values the
example on the right is much more
complex basically we're looking at our
movies and we're looking for movies you
know run beyond beyond 100 20 minutes
and where they have a crew member is an
array of roles and names I'm looking for
arrays where the crew member contains a
single instance where the director where
the role is director and the name is
Steven Spielberg and this is quite
important because once you have nested
objects like this unless it arrays and
you want him to start querying them if I
say where the array contains the
director the role director and the name
Steven Spielberg without this nesting
syntax that we see I could find the
roles where Steven Spielberg was a
producer and George Lucas was the
director because there would be a role
called director and there would be a
producer called Steven Spielberg but it
wouldn't be on the same instance so this
nested thing that you see here where I
have a crew member question mark and
then the open friends at job equals role
and at name equals name make sure that
they exist in the same instance or the
same item within the array there's
actually something that's very difficult
to do in some of the other no secret
languages
I want to query multiple values in a
single single statement this is how I do
it I use Jason table to basically pivot
path out of my Jason into columns in my
view so it produces an inline view with
columns theater ID name Street city
state and zip and those columns under
rived from the keys identified in the
path clause of the row or what we turn
the road the column pattern of the
column Clause
here's an example where I actually have
an array within my JSON document and
when I process that array with Jason
table I can actually generate multiple
rows one for each member of the array so
my theater as a collection of screens I
do a nested path on screens and now I
could reject out information about each
screen within the theater so now instead
of getting one row per document I get
one row in the view for each member of
the array and once I have this I can
bring all the Paris sequel to bear on my
JSON data you can see here I'm
calculating the total capacity of the
theater by summing the capacity of each
of the screens within the theater a very
simple sequel query but very complex to
do in a typical no sequel database
with if I have Geo Jason embedded in my
Jason document for instance you can see
here a similar example of Geo Jason
giving me a point of location of this
theater I can convert that to an sto
geometry object using JSON value and
then I can start doing spatial queries
on my geo JSON content
please wise updates are possible we have
a API in PL sequel very similar to jisun
if you've used jisun from java but
basically it gives you the ability to
pass the jason find out what the
structure of the jason looks like and
operate on the individual pieces of the
jason and here's a very simple example
of doing that
I'm reading a JSON object I'm creating a
JSON object from a JSON document
I'm getting out the tax rate and the
price and then I'm adding to the
document a new key called total
including tax which is found like you
know price times tax 1 plus tax rate and
you can see here that it basically gives
me the ability to create a new object or
to insert a new key into an existing
object using the PL sequel API
data guide I think if the last thing
I'll have time for today
daily guide there's a really powerful
capability it allows you to understand
what your JSON documents look like
basically once you've stored a set of
documents in the database you can
generate a data guide and it will give
you a report of what the structure of
your jason looks like there are two
variants of the JSON data guide that's
what we turn a flat version which
basically gives you a list of all the
keys that it has discovered with a path
between the top of the document and the
key and there is a hierarchical
representation which is a JSON schema
which basically lays it out that you
know we have a key called a and within
that there's a key called me in a key
called see there are two examples on the
left hand side you have the flat
representation and on the right hand
side you have the hierarchical
representation
there are two ways of creating a data
guide one is what we turn a snapshot
where basically there is a function JSON
data guide which will return this and
you can return it you know you just
select it from a table you know on the
left side format flat on the right side
format hierarchical the advantage of
this is that you can use sequel to
filter and group the documents so you
can get a data guide on a particular
subset of the documents in your data you
know in your table using the JSON data
guide functionality it fundamentally and
though it's not obvious it's an
aggregation function in sequel terms
there's also what we turn the dynamic
JSON data guide which basically uses an
index to capture the information about
the changes in the data the advantage of
the dynamic data guide is that it can do
things in real time so for instance one
of the things we can do within a
navigator guide is we can add an
unchanged option to the data guide which
says when you detect a new key call some
procedure you provide we've seen in bar
use cases for this was one of our
customers came to us and said we have a
standard that says yet thou shalt not
put credit card numbers and social
security numbers into your jason data
and our application developers keep
doing it so basically they wrote a dated
jason data guide unchanged procedure
which said if i see a new key and the
value looks like a credit card number or
the value looks like a social security
number then i'm going to throw an error
and prevent the insert from happening
one use of the dynamic data guide there
why would you want to date a guide it
gives you the ability to do sequel based
reporting and analyst for operations on
your metadata it also allows you to
generate relational views of your JSON
data we can automatically build you a
view of the JSON data by using the
information in the JSON data guide we
can also use it to expose JSON content
as virtual cons we can automatically add
new virtual columns to your table that
contains your JSON data based on the
data guide discovering that there is a
new key has been added to the data and
it can be used to audit the structure
and prevent changes to the structure
prevent certain to that from being
inserted Jason column should you wish to
do so
here's an example of using sequel to
query a day to guide you can see here
that I'm simply generating the data
guide and then pivoting grows out of it
using JSON table here's the
creating a view on top of a Jason
content so by simply saying create view
on path dollar ID it's going to give me
a view that contains all of the nodes
that are peers of the ID column so
instead of having to know how to write
all the syntax and the JSON table
operation to create that view I can just
call the DBMS Jason create view on path
and it will generate the view for me
automatically
I can also do that over an array and I
can also rename the columns so that the
columns get meaningful names here's an
example of adding virtual columns
basically in this case we are adding
virtual columns to the screening table
whenever a new key appears in that table
and finally an example of auditing and
unchanged procedure is called whenever a
new path is discovered
and I think at that point I'm pretty
much out of time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>