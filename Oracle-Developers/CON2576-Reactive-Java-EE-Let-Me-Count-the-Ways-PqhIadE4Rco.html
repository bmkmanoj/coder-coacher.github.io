<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>CON2576   Reactive Java EE:  Let Me Count the Ways! | Coder Coacher - Coaching Coders</title><meta content="CON2576   Reactive Java EE:  Let Me Count the Ways! - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Oracle-Developers/">Oracle Developers</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>CON2576   Reactive Java EE:  Let Me Count the Ways!</b></h2><h5 class="post__date">2015-12-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/PqhIadE4Rco" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome welcome everyone last day of
German hope you had some time I am my
name is reza rahman i'm a job a hostage
evangelist at a powerful corporation I
also happen to be a tragedy for the
server side tracked so hopefully you had
a good tone they have come and talk to
me and we'll figure why emphatically
chavo fun anyway so I thought this would
be a
where's the end of the end of the
presentation sorry the end of the
conference it's called reactive Java in
the counterweights let me start it off
with the story of you the story of the
genesis of the stock so i was giving a
talk on their Scandinavian conference of
aura dead on a job I you know across and
then at the end of that talk attachment
comes up to me and he says hey you know
have you heard of this term reacted I
said yeah usually the Chanukah guys so
the hipster guys keep talking about it
white and he said you know I don't think
so because I really think I'm developing
a reactive application in Java EE that's
it Costain you know let's talk so
copy person
in Malmo Sweden and sort of put me
through his ideas and what
is exactly ground so the ideas are
actually so good that I decided to make
a talked out of it sort of share those
exact ideas with you all and I'm going
to be actually the stock for about a
year in a person so before I die are too
much into the talking to you how you can
right very active applications but
nothing much more than this vanilla java
ee and java SE let me tell you one more
thing there's a lot of a slightly lot of
material to cover i may not necessarily
cover all of it all of the material if i
don't i'll give you this light dick I
think as we go to the slide it will be
obvious to you you know that's what
even if I don't go through it amounts to
triggered this one second so the other
thing that
we want to say again first words not
necessarily finishing all of the content
that I had in my slightly I do usually
run my sessions as eventuated what what
that means is
discuss it then as opposed to waiting
later producer and in fact I I suspect
for this particular site lately quite a
few questions that we should discuss
the enlightens picture hey
something horrible way of starting any
talk whatever I did you sure you're a
legal disclaimer this is a standard
Oracle legal disclaimer for any
forward-looking stuff actually I don't
need to park you worry about this in
this talk because for the most part of
the talking about java ee 6 and java ee
7 pigeons that's boston thursday however
i will be talking about some things
around the future perhaps g ave agent
beyond this is what sort of see why a
slight
okay so how do I plan to spend the rest
of your time in about
50 or 55 or so minutes that we have left
this is my life so first and foremost
I'm going to talk a bit about exactly
what r e activists and this is going to
be probably the most contentious the
Great North power and then for the most
part will actually be spending time
doing a drug problem ha space tour of
exacting what are the reactive features
enjoying and that finally we'll also
talk a bit about what Java sc8 offers
Java ACA actually offers quite a few
interesting features with regards to the
active as well and we'll see if Pablo's
features were very nicely in a Java
apartment to give you earlier pretty
good mechanism right resource
allocations hey the start in the
beginning I assume if you're in this
room you
probably have heard the term reactive
otherwise you probably show up that
gives the thing about so let me start by
asking how many of you think you have
the concrete grasp of what reactive is
my my some self confident people
okay the reality is the reactive is a
extremely vague term and it gets more
and more vague by today it's one of
those unfortunate terms like it's away
and and microservices that sort of have
a very have their Genesis in an in a
relatively simple concept and what's
happening is what happens in our
industry quite often is sort of modeling
of that term by adding more and more
baggage so for me personally it it took
me quite a while to arrive at a
definition of reactive programming in
the time
so this is a definition however I bet
it's unspeakable I'll explain to you
what this is I really think this is at
the heart of it this is the colonel
behind what what microscope at the end
of programming video is all about you
notice those for my negatives I have
by and large that if you are dealing
with any one of these conservatives you
are essentially dealing with reactive
program in fact the more of these
concerns if you are dealing with that
the more these two that war these
thoughts are familiar with you the more
the chances are you giving
program lift on the term reactive
actually in
well conditioned really quite a while
around the mid 80s the original
definition of it is simply you know a
part of it simply that a part of a
program reacts to another state change
in another part of the program for
example there is Excel spreadsheet so
when you have an Excel spreadsheet then
you have two cells that are in early
formulae in one cell that depends upon a
value on the other cell when you change
the value of this dependence or
originating cell you know the dependent
cells value that has a firm lining also
ticket that's or not
three activists and we're sort of danced
around this but the poor idea it is very
much similar to that similar to the cost
so basically if you're dealing with
event-driven programming and that is
simply receiving is a message from an
external system or indeed or a state
change and you react due to that stage
engine some way that is that is very
program plus there are you human
reactive programming if you're dealing
with ace and crystal surface meaning are
doing our processing in a thread other
than the currently active one that is
also likely very likely a reactive
programming concern non walking code
code that you are attempting to not
block different pressures that is also a
reactive programming person similarly
message driven programming is very
similar to
very subtle differences these are also
reactive programming concepts now if you
look beyond this these core values these
are sort of core concepts that are
common to video to alternate every thing
that claims to be reacted other than
that hopefully there are a few other
sort of
terms gagged on two and one along for
the ride of his basic core principles
and these are works like a responsive
resilient fault-tolerant lipstick
adaptive scalable and so in the list
sort of keeps great by and large what I
see is that we need to apply Occam's
razor Peterson really arrived at the
simplest possible definition because
that ultimately is a great point and
more certainly from the java ee
standpoint you can do so what i will
what I will argue is that these other
concerns like responsive is really
important and so on it's not that they
are not important it's just said they
are important regardless of whether you
are writing even driven a signal small
talking mr. driven code or not even if
you are dealing with
a crowd application there is blocking
handsome prince you Henry up I not real
facility to deal with these these
concerns are not unique to reactive
programming at all and hence it doesn't
make sense to take on these concerns
concerns with the active program rajani
standpoint he really doesn't make sense
because Java he deals with a vast
majority of these concerns at the wrong
time on Topeka
and moved on so for many many years and
that is because these these are system
concern
necessarily programming concerns you can
get reactivity and fault tolerance while
there on time providing it for you you
can get elastic adaptive around crimes
by having left icity and
and adaptive programming built and took
me into your posture you don't have to
deal with this in your application
scalable tree should be a concerns to
the refer for the run run not the area
so unrefined are going to ignore these
i'll talk about them a little bit
hearing hearing presentation but by and
large we will stick to the score for
principles for the most part okay so
this is a bit about Hawaii and I'd at
that
and you will see the pollution behind it
and in the end reactive programming
concepts as i mentioned actually have
been with us carburetor okay so what is
it that at the end the end we are trying
to accomplish with reactor program
that's that's that's the that's what's
important rather than arguing too much
about what the definition of reactive
programming is so the goals that we're
trying to accomplish are some of them
are listed here so first and foremost we
want more responsive user interfaces
this is very very simple and has been
with us for a long time so a classical
example of this is you know your little
rotating rotating months in windows so
if you do something
and you know it's a longer engine
operation you don't want you deserve to
be waiting on
your application is reacting to user
input so you what you do is you have
some visual cues something going on into
the front end to indicate progress or
indicate things went on behind the
scenes and knew the antigen processing
behind one because this again goes to
those concepts of asynchronous
programming and eventually programming
and home barking non-locking are you we
also want high throughput or optimal cpu
and hardware utilization and how do you
do this and you do this by making
intelligent use of threads making in
terms of use of priority again this goes
back to the issues of herbaceousness
programming event-driven programming and
niño and for some systems reactivity
actually comes quite naturally so these
are systems where things are actually
driven by events and they produce if
events
I actually used to work on a system like
this is raining system as it goes in for
example of this so in a trading system
what you have is that it's a large state
machine that reacts to even stock trades
happening and then it produces events as
well it actually doesn't produce any UI
I for output directory it simply says
okay these are this is the state change
that I think okay please broadcast and
stay two stations to whoever it is that
that that needs to know about it now if
these things have been with us now why
more than creating and return well
there's a few things happening in the
industry that potentially makes these
age-old things a little bit more
relevant to us today and I want these
principal drivers of these things is
something called coyote or a trait of
things anyone heard of a trait of things
yes I go all right very good so what is
the deal here what is what is the
creation behind
well by and large the internet that we
have today is related in Monroe oh so
it's a humans interacting with machines
so we humans actually are relatively
slow so we have built and think diving
whatever we do click on on a screen you
know we look
input we look at the output and then we
think about what it is that we need to
do next and then we click on the next
button as a result it's relatively
easier
you meant to machine interaction because
the machine is generally much faster
than a humanist don't get me wrong still
have scalable bitch intelligence period
but it's easier because
asymmetric processing processing
capacity situation now in an hidden the
Internet of Things it's really initially
talking to another which means that the
frequency and volume or processing is
occupied hence putting more demands on
the system so again that mean that means
you know doing
for an optimal CPU utilization becomes
also some folks will argue that we're
suddenly in an arrow hard localization
whereas you know our our systems used to
be very local
we service local markets now we are
servicing global markets and hence we
have to deal with a larger user volume
with larger number of concurrent users
if that is in fact the case against that
is a good case for really thinking about
how to do more with less hard life okay
so all that being said let me finish
with with a copier and you will see this
Xavier detection has the perfect agree
to the reactive features that are in
Java EE yeah just like everything else
reactive programming it is not a
cure-all what you will see in my good
base is that a synchronous imaginative
no matter how you slice it and dice it
is it can be harder to write and
maintain then synchronous blocking co
the reason for this is here is the human
psyche itself
we humans are our parallel processing
capable machine to protect that as well
as I'm speaking here you know my heart
is pumping my lungs are working but my
perception of the world by
our citrus really interacting review and
speaking with you and that is one
primary activity in the soviet Assault
background tracks for that reason
programming languages by and large are
oriented to ours synchronous bubble
so because of that reason you really
should be very cautious about
approaching active program one answer
that is a perfectly legitimate answer
one that I've seen applied many kinds is
a thing think about whether adding more
complexity to your system is working or
whether you can simply solve the problem
by adding more hardware and still having
just a synchronous talking machine that
perhaps doesn't make as smart use of cpu
and hundred okay however the reality is
in some cases that may not be pragmatic
we have such processing volume and such
resource ratios that you have no choice
but to think about writing a more
complex system that deals with me is
significantly more complex issues let me
stop there a second let me give you a
chance to sort of absorb what I said
we questioned that
alright fair enough okay so are we
active jolly what exactly does java ee
offered that his reaction well this goes
back to the statement that I made
earlier is that reactive programming is
actually not necessarily all that new of
a concept as a result because Java EE
has been around for such a long time
it's already evolved to handle all of a
lot of these use cases an impact
although by and large so far done this
sort of subconsciously at this point in
time were actually beginning to do that
consciously we're consciously thinking
about how do we solve this drink problem
but actually we've already gone
one quite a doctor
in all reality or we already have a very
capable system and that allows you to
write early ejaculation so I'll be going
through what some of these features are
listed here in my sort of opening if you
for the rest of mine my talk these are
things like Janice between
message-driven beans and a
synchronization means CDI events servlet
asynchronous in an niño jax-rs
asynchronous processing both on the
client or and the server so if socket is
infinitely more 10 points and then
finally something else that was added in
Java 7 and namely the congruence unique
piece for Charming this is just at a
high level there's actually a lot more
that go along with the reactive
programming paradigm in Java ok so let's
start with the most I think the most
foundational and most importantly we re
in terms of writing a sickness event
driven applications in Java
check the application that that are I
wrote years ago vayalar used gin as
really much more than generous and mr.
Griffin be in order to write a highly
reactive application the reason this is
is because this is really at the end of
the day what Jen what the goal of
Genesis its goal is to provide you a
sickness without processing in a highly
reliable so JMS is message and even
driven is obviously by almost by
definition a sickness it gives you this
coupling is intended to be reliable out
of the box it also gives you things like
transactions durability or currents or
governance clustering all of those or
two other concerns that we talked about
beyond the poor box himself
it's all about okay on the other hand
whereas you have generous assortment
transport their asthma Lizzie as an API
lower layer largely to send and receive
messages you also even have an even more
powerful mechanism to help you write the
active applications in Java and that is
message driven beans they essentially
allow you to do to handle events in a
highly transactional fixing old reliable
or bubbles or tolerant and your over
quick it's almost over here how much is
actually done in an energy
Janice mr. ribbon and
again it is in a typical job is a lot of
these all of these things are are done
in a fine transparent fashion without by
the runtime without you even realizing
it by default as to what is going on
let's take a look at why to an example
okay so if you haven't looked at modern
Janice of late this is the modern jane s
2 mm it's a very very powerful API
really it's just a few lines of code
that does quite a bit of work ok so in
this case I'm send triggering often and
event registration registration even
handling registration sorry handling
event registration attempt powerful and
the way I'm doing this is that I am
injecting a jns context object this is a
new object in the u.s. 2.0 representing
pretty much the entire day ms API
I am injecting the queue that I'm using
for messaging and then in a one-line
statement I'm sending this message up to
the cube of the payload of the cute and
by the way I'm also doing far more than
that also setting a whole bunch of time
to live properties and optimization
properties in that one line using a
highly fluid API star so in terms of
event ate the ice in it how you can send
an event
it's really tough to beat be jealous
similarly it's tough to be a surgeon and
leaves so if you look back in this code
although you don't realize it there's a
lot going on here behind the scenes
things like acknowledgement and
transactions as well ok so this event
isn't isn't simply a naive thing in
memory it is so so far Sweden it in a
transaction have keep Eliza such I try
to lose a synthetic wrong shoes
similarly you can get much more simple
and powerful on the receiving I said
receiving in then necessary amenities so
here's an example of a modern master
Timothy this is all it really is its
approach 0 with an honest admitted and
then you simply allocated to say hey I
want to receive a message you know from
this QR topic and you can specify any
other things that hopefully some of you
are aware of so a very robust mechanism
for filtering as it is it mrs. cylinders
again things like
again things like retracts they give
their attendance so all of this is
happening again in a very reliable
assistant point and we can improve upon
this even further in DNS 2.1 so we can
most certainly can clean up the syntax
okay convert to this and make it a bit
more drive safe but you could do even
more we could add even more power to to
message of and beans by doing for
example things like allowing you to
receive messages in the duchess they
include the concepts of retries delivery
recliner base ordering and so on and so
forth okay so this only only gets better
and basic this is the basic foundation
of being able to send and receive
results
no that's a stop for a second and say
that ok you have a requirement to send
and receive messages but you don't
actually need need that much reliable in
particular you let's say you don't need
processors do you have options the
answer is yes you do in Java EE and it
doesn't get very much simpler then
usually stay safe in a session control
also I'll show you how that looks at
looks like in just a second it really
just believe it or not is an annotation
on approach ok and with that annotation
on the dojo you still get some
guarantees of reliable to even an inner
in a signal system you get transaction
honking get thread safety cool
what you don't get that you usually get
out of GMS is that this is not usually
coupled and we'll see that in a second
we take a look at the code example it is
not persistence meaning persisters
meaning that the message if your machine
fails a hit light when you're delivering
our processing the message that mr. gets
lost it's not fault tolerant in the
sense that if you fail to process the
message in the citizenry delivered that
is done in Jamie's and it's not often
not arable so if you have an error you
need to have handle the error or
yourself there's no systematic there's
no runtime level for error tolerance
built it for me but it's incredibly
simple all right so this is all you need
to do let's say you want it you have
sustained at nothing you see that thing
that it's a bond running operation you
don't want to hold up
pre-used you want to make maximum use of
your CPU by pushing this off into
another thread
well what do you do in Germany is very
simple you just throw in at the
asynchronous and fishin on it that's it
ok for the fire forget case for cases
what are you doing here about the
outcome of what happened after they
symptoms processing occurs in this is
all you need to do ok now let's assume
person in it that's not the case let's
assume that you actually do care about
the outcome ok so let's take another
example or you're generating a report
it's potentially a very long running
report and in the end you you care about
the report back well you can still do it
you can still do it in a very declared a
very simple way again by just throwing
in a decent presentation on it and
wrapping the return type with the future
article and other than this your code
still looks very good just vanilla
influence
although this is the three signals the
only trick again is that instead of
returning the requirement returning the
actual return time you will be wrapping
it into a you
your call asyncresult
there will be another your whether your
actually you succeed in your in your
processing of tomorrow again very few
platforms get sailors that they have a
signal processing capabilities in such a
compact or go back
pardon
arguing for the response you simply get
the feature of the energy back and if
you're familiar with a job you don't
feature it has methods like is complete
it's appalling mr. to tell you is
diagrammed complete or not there's also
capable movies of canceling the
background thread is a cancel method and
that actually works in any case in
recipes you say these are canceled
is it transmitted and there is also a
blocking you get as soon as you say you
should get in
wait for the wait until you get the get
the result back you typically go and do
that
you you do a check to see if it's
completely
however let's get for that if you that
question it is that's actually an
interesting question with regards to the
active program yessir do you have any
control
what thread pool does is run on no so
easily procession teens are generally
service from the ETA equal you can tune
the Gojira cool itself so you could say
a for this report generation service
please make sure this this is cool to be
such sorts to make sure that the maximum
number of s ignorance processes are
handled by report generation service
this mean is let's again so you can
configure them is there a way to have
multiple pools like Carmen run certain
class certain report
I don't
to compete okay so there isn'ta cousin
to do that that's beyond obviously you
there's no simple way to do that in this
very simple mechanism there is another
mechanism to do that well let's revisit
that it in a second actually I'll give
you a clue right now it's gone but it's
called the executor service okay it's
part of the job i equal crime scene
please we'll talk about that mr. any
other countries okay
ok now let's go further down
the simplicity let's assume for a second
that you actually don't even care about
a central none it's a great thing all
you really care about is event semantics
so all you want is basically Yost
coupling okay let's um perhaps some
mechanism of filtering and chaining but
really nothing much and you don't even
care about ace attorney and distance do
you have an answer for that in terms of
doing event driven development in Java
well the answer is yes there is a very
very even more elegant for help perhaps
perhaps even more egg and then ejb
procession means there's another
mechanism called CDI events and
observers when you look at it it's
really nothing much more than the
formalized implementation
of the Gangnam for better again for
observer better in
in a DI favorite now a lot so tell you
in the end that although today you can't
us it was programming in the CDI using
CGI even bus the CD i do what do you
actually will be able to when that
happens it will be very equivalent
whether you should use give me session
beans or or CD is
to be across of which one you should use
very very sick a look at that so you
should start at the bottom here with the
annotation have seen this before this is
a marker interface that we will use to
sort of a sort of identify our identity
we're going to send and receive an
in-stock you'll see that this there's a
pond cargo inspection tinted and this
observer and observed sanitation and it
takes a payload as an argument it takes
cargo as an argument and it has that
martyr qualifier and cargo expected so
this is again all you need to write a
basic basic given handling code in Java
is UCL at observes and addiction put
that under Posey oh that's it okay now
the way you trigger this is you inject a
an event object it's a CDI object you
give it the cargo parameter or whatever
event parameters actual event payload is
and then when you in the at the point
where you actually want the event fire
and you can call you know that event
I've got fired and give it and give it
the failure okay and then even more
powerful thing about this is this can be
one too many is also get me one of it
each other this is a procession mean
there's one two one you're in making an
invocation that's going to a single
vision ear-splitting vocation in jns you
can make it one too many by having a
topic it's gonna be fire often a JMS
specific topic that can have multiple
subscribers well in this case you can
have either too you can have one to many
relationships here as well you can have
multiple observers let's take to the to
the same event and reacting to exactly
exactly the same event and again today
this is sinteres walking mannequins
rather not
but today this is walking it happens in
the sink tip the event firing in the
event any indication in cdiu pointer
this will be made accessible
moving forward next we're going to move
for one pair of into the web here and a
good place to start here is obviously
the servlet ABI ok and surveillance
actually today have support for both
asynchronous and yet if there are very
close to even the most pedantic
definition of of reactor program there
will be another puzzle be honest a
sequence processing and nioh that will
be potentially be a data service and
that's called reactive stream that would
talk too much about this today but it's
yet another of an emerging thing under
there reactive moniker for me this
really looks a bit like marketing
nothing wants to do with the existing
ideas of what reactive isn't yet it has
a reactive sort of tag line
marketing balls were to it but you know
even then servlet or we are evaluating
even adding support for that as well as
part of the HTTP 2.31 durable that
okay but more on current state this is
how asynchrony is handled at the server
server here the API is is a bit
different from a normal citroen blocking
server so let's work through this
efficient so let's go back to our
example of generating that long-running
report bill okay so you have any impound
HTTP request and you're going to process
this on that trade other than other than
the inbound HTTP track you want to
return they should get ready right away
and you want to process this and in
internal thread to maximize the cpu
usage on your machine as well as to make
better use of Europe a better use of
your HTTP dreadful how do you do this
well you're still going to have the
AdWords of load application you're so
going to give it a URL bedroom where it
is bound how do you invoke this report
however you have to give it a
specialized in marker of asics supported
equal true the reason for this is the
programming home for
a signal services is a lot different
it's especially handled behind the
scenes very differently as compared with
the citrus signals blocking service okay
let's understand why when we take a look
at the implementation of the together so
we have the HTP request HTTP response
coming in the first thing that we need
to do in order to start a sentence
processing is actually get a handle to
this thing called at pacing context
knowledge plane the mechanics or
asynchronously in just a sec but we can
get a handle to the async contest and
then what you do is you create your
background thread you start putting your
workload into your background fit this
happens to be a a convenience method in
the async context in itself that allows
it to do that ice called casings on text
art stuff if you invoke this it takes a
runnable as a granted and it spawns a
new background bed
give it you're paler now hopefully
everyone is familiar with this funky
syntax that I have on my slug what is it
all excellent okay so instead of
actually creating a runnable object I'm
creating a lambda here which is actually
an enabler to do things like is it a
sequence program it makes a citrus
programming and log center you can see
that in action here so although this is
a sentence asynchronous code it looks
almost like simple ice-blocking hood it
just looks like you know we're taking a
norco signals blocking code and just put
a wrapper around it and making it a
sickness so this is I would say the
goals of all of Landers in this case
hell is very much a success especially
in the cases of writing sort of very
reactive applications in Java
okay so what are we doing in the
background kid we are getting their
request parameters we're getting it from
the async context get requests Alex
maybe why this is and why we can't
simply get a handle to the original HTTP
require a ctp service request and do it
from there but there will be per second
so we get the request from there we
generate the long-running report then we
print the report out again to the async
context and then when we're done we hit
the async async context you're
completely now this there's some disco
bears are better with life because it's
not necessarily that fibula let's take a
careful look at this code and can now
can you guess when the
get metal difference
pardon
no you get method returns as soon as I
fall facing context rock star okay so in
a traditional servlet the inbound
connection a HDD collection is closed as
soon as I turn from ticket but that's
not gonna work in our case bullet
because you know even though we're
returning the request HTTP thread back
to the pool we still want the
connections around because we're not
done with it so how do you do this the
way you do this is through that ASIC
supported marker what were really saying
is please d couple okay the request
thread from the HTTP HTTP handler sorry
the record straight from the actual
so this is really what happens is
although the the thread is returned back
to the HTTP thread pool we're holding
off to the connection of questions where
do we where are we keeping the
connection how do we get it back and
your answer is that is you're missing
context object is your handle it has a
way of getting your your connection
vector connections will typically be
passivated people but still get the
light but fascinated in every summer to
release memory for clarity when you need
it back Taylor's in our case when we're
done generating the report okay you will
simply all something like missing
context get request or a psychotic
and will the request and response there
is that will bring your connection back
from the dead okay and the connection
will finally be closed when you invoke
the AC projects are pregnant or not yes
the big question goes to the other
gentleman
that also goes we bought our worker
thread fables so the application server
has a number of factors okay each of
these red poles are not in trouble they
are not involve all vehicles are created
equal different reticles in the
application server are designed for
different purposes right so the HTTP
trick pool is your dwarves are short
delivery gasps and there's more open and
so the idea so there's less of them
right so it's a small number of credits
handling quick quick turnarounds baby
the 30 seconds not reduce against done
so you can handle it with less threats
when you definitely look something like
a background friend like you are now its
expectations and contributions and
management is very very different so
these are the shipping threads are
usually high-powered these are going to
be your primary sense there's going to
be more of them they're going to be
expected to be more
the end of the day the basic you know
yet is on a cloud but there you know
cloud is also running on hardware at the
end of the day even in a cloud
environment
in optimizing your your hardware dealer
you know your hardware even if Logan
Ryan doesn't come from freak right ones
going to allocate another instance for
you in a professional nor charging for
right so you still need to be cognizant
of how you how you can make maximum use
of your hardware in up there
you should still wait
the client is still waiting for their
song not necessary
not
yes so principally that is what you're
sitting it is not necessarily that
trivial because if you if you have set a
scenario where not halloweird requests
are long-lived right you have maybe the
odd inbound long run long running thread
on up on a machine that otherwise
because otherwise medals progress or
requests well what if you get a whole
bunch of suddenly get a fool not to long
libera cos you're going to walk up your
HTTP threaten or another visa so it's
not a trivial matter it's actually a
pretty serious optimization
as I said usually you'll be surprised as
to how small they should be dreadful
actually is usually it's somewhere
between 10 or 15 and 15 and the way you
mean you can get
that is because it's such a farmer
yes
this is 73.1 yes
this
no Jas is it deals with a symphony very
different so their basic assumption is
that they will never talk which is a
stranger that's very hard to accomplish
attracts so in Hawaii we don't have make
the recipe if you want to make sure
we're not talking you can there's in
fact the next feature of the company
work is going to be how do you make the
signal niño but in Hawaii we don't make
it a fun leaving the assumption that
your code may be walking on rocking the
handle I situation
no no that's the whole point of the
async supported equal to flag things you
know it's not returning any sense of
service
great
any other questions
moving on all right now let me direct
your attention back to the rent report
method okay so here you have print
report async async context so you might
think that a very nice what would a very
naive implementation to in this case it
will simply say you know HTTP acing
context don't get response and get
output stream right you are the problem
we're doing that is let us assume then
this report is quite large let's say me
by quite large I mean let's say
something in the order of 100 megabytes
or more and you're dealing with a lot of
clients who
unreliable so what may happen is that
although you do have this running in a
background thread like you sure it's a
place seemed to be a long running
credits there is a
though most of them of them so if you
want to run over them too quickly
regardless what may happen is that you
may not on that call it because of
because of a Sloane information and
because of the amount of data that you
that you are meaning to write so again
you're winding up wasting unfair that
but just sitting there
so in reality what you would want to do
if you have this scenario it is you what
you want to do even the right in an
asynchronous fashion and servlet
actually will will allow you to do so
there is a there's an IO capabilities
built into servlet 3.1 and in Java so
this is how you do that here is a basic
fundamental of them fundamentals of it
you get the servlet output stream by
getting quantity or get response or get
up upstream then is writing to that what
you do is that you create something
called a right listener and you attach
that rice right listener to the other
notice that this invocation will
terminate a right after you called the
set right let's remember so you done
with the background if the pattern
at this point speaker
so the question is what is the fate of
your right well though in fate of your
right is in the hands of their ideas
this is how you basically it's an
interface implement the interface
actually just let a few methods to it in
this beginning part of this code all I'm
doing is I'm saving off a few of the
values that I need namely a servlet
output stream the actual report that I
need to generate and the AC context the
more important and interesting code is
in the to call back methods of register
it has two different callbacks one is on
right possible and the other is on error
so what exactly is on guide possible so
here is an interesting question
so what happens in an IO environment is
that you actually wait for the stream to
act so on the on right possible all that
happens when the screen says I am ready
to write right so when we are you that
happens you should begin write it but
you shouldn't write everything that you
have because at the end of the day you
may block if you're right try to write
too much so the basic dignity will use
in niño is that you will write in
chunks in my case I'm writing in trunk
so are 256 by speech a very small chunks
and all I'm doing here if you look at
the code a little bit is it i'm reading
through chunk by chunk and writing on
my output in addition to that i also
have yet another check for all our
courtyard Israel so what this means is
each time i right i am asking the screen
again are you still ready for me to
write more okay if the stream is no
longer in it and I terminate this this
while loop and then I exited exit that
when I wait for the next all banner all
wrinkles and I do this until I'm finally
done they have nothing more to read and
only then can i halt contestar right
okay its engrossed jax-rs again jax-rs
has SMS capabilities built in built into
it as well as a super escape Abboud is
both in the client and the server site
the syntax is very similar to do do surf
let's accept a little bit nicer now the
bad news is jax-rs still doesn't have
NIU so you made on it to that situation
or you're creating a background thread
for that background it is pocket the
good news is even that is coming in Java
8 in Java idea to me to introduce nao
and at the jax-rs of there as well the
code actually will load a relatively
familiar its conception it's actually
very similar to about how simplex work
so what you do here is that you have a
endpoint they call the generate report
it takes whatever parameters that you
need it takes this magic little
parameter called basic response and that
is similar to the casing context in in
surbeck whenever you have this mental
signature it is essentially assumed that
you want to be couple that request
pension Association and then what are
something else that I'm doing is that
I'm combining jax-rs with Vijay Vijay
Singh okay so I have the additional
sanitation right there which means as
soon as I finish invoking the terrain
with method generate report method the
this head think the inbound HP reverse
side will be returned back and we'll
start a background thread review our
work you get relatively more simple in a
you do whatever it is that you need to
do your
learning process again then when you are
done you simply call response to our
basic and that's how the how the
connection is finally the background
connection is finally covering their
similar capabilities built into the
client side as well it's just as simple
as similar to your to your synchronous
blocking code in your debt first client
you just put in an ASIC builder path to
it as soon as you say ASIC there are two
ways of handling handling handling Mason
transpose you can either get a future
that okay and process that future or you
can get user call that our style as well
well if there is time to talk about both
of both of these tiles and sex but
there's two different options of the v8
kompressor either features or callbacks
yessir
you have to use an easy or use some
other mechanism
okay moving on i'm going to skip over a
CMS web socket because running a little
bit short of time okay i'm going to find
a large actually also skip over java
agent receives because i want to get you
something to live in more important but
let me I'll show you the basics of what
what the java universe EVPs is all about
so assume so you have all these nice
facilities to do a signal processing in
java servlet acing BAC candlelight but
let's say for some reason you still want
to do low-level processing using the
thread idea the job is d credit card you
can't do that in a reliable fashion in
java ee unless you use something called
a managed executor service and how do
you do that is really very simple you
inject a manager it's an executor
service and then instead of are spawning
the thread yourself you simply submit
that thread to the exit of service doing
that the other executors got execute
execute method
again it's taking a runnable as an
argument and it includes the container
rule safely and reliably start a
background thread for me and this goes
to the question that the other gentleman
had before so the executor service that
you can use there is a default one that
the Africa
server provides it sort of makes default
assumptions that
background threads usually have a long
real long lived as a few more of them
around they're usually lower priority
and the light however you can actually
create custom executor services you can
configure a custom executive service and
make it whatever it is if you want you
can specify how many credit should be in
this pool in a watcher it gives priority
what should be its behavioral
characteristics and the like so this is
another very powerful facility
alright
I have got eight minutes left I think
that's enough time for me to cover what
I'm going to cover next if I'm not able
to fully cover it i encourage you to
take a look at my slide deck later so
and this is a java you see complete of
all future the best way of explaining
this is through an example so let's take
a look at this code example real quick
it is calculating underwriting data for
a given ensure okay so i have a person
be I'm getting the assets for this
person getting gettin the limo fees
calculating the credit score we are the
assets and liabilities I'm also getting
the person's health history calculating
their he'll score and then finally based
on the credit history and the tub score
on determining how much coverage this
individual should have this phone looks
innocent enough but we can actually be a
serious bottleneck in your system
because obviously shove these forms get
assets get Liam of these calculate
credit score can be either blocking our
your calls or extremely sick units
so you cannot have the this method v.v
despite it has to be another way of
handling this code so one way of doing
this is to use the executor service that
we talked about so we're going to
basically wrap all of all of our
potentially time conceiving calls in in
in background threads of their each of
their own so I get access gate lab these
everything is being done a simplistic
and then I'm doing a bunch of gift calls
okay where I need need the dog's back
I'm doing get calls to handle to have to
handle my the further the next step in
my process I want you to take a look at
this code real especially pay attention
to to the to the comments that I have so
if simply improved a little bit where
else there
the code previously or was all a dance
synchronous in a synchronous blocking
fashion this code is being done at least
ostensibly in an especially where a
train more threads at the problem the
problem is everything until soft i
skidded or submitted then calculated
store is fine so I'm getting the
previous two values that I need for for
this competition and executing that Phil
calculation that collision is also being
executed in a duty in an azeotrope
special the problem comes in in the next
one so notice that because i have f 1
dot get it through got it nothing will
proceed until both f1 or get an F 2 dot
get our country which means we will
actually don't reach this next fall on
that gets the job history until both
opponent if you are done but in all
reality we don't need to be held up
there
so we're making again not maximum use of
our crest and the reason this is
happening is because futures are a
blocking ball so how can you solve this
problem one way of solving this problem
is using all times okay and I won't go
through this go through this code but I
will I invite you to take a look at what
happens when you do that I rewrote this
code using callbacks and that will make
this in turn or completely completely
non blocking however it introduces
another problem for callback help namely
that all of this code looks cool place
you know the baggage handling code will
look even more experienced so do we have
a solution to these problems and the
answer in Java ACA is a yes we do
something called compatible features
that will cover some so in order to
introduce what computer home features
are and why they're important I've
essentially refactored our previous
example of processing the payment and
refactored if we use compatible features
setup java.util future so the basic
difference between future and computable
future is that the computer will feature
is non ma weather question over us he
short out get is blocking there is no
such feature yet call what you do
instead is then you for something called
then like 10 exactly and that is a call
them it's a callback built into the
complete rotatable future ad I hit
something so what happens here is that
in my client code I create a computer
will feature object I return the
complete about future right away alright
so the client has a handle to it right
away and they can go ahead and register
the dead except call back as soon as
they receive the incredible feature in
the code below but after that what
happens is we don't actually do anything
with this until we're done doing
whatever long-running processing that we
are going to do and in the end all
future got completely give it the actual
return type and that results in a call
that
to the registered method method that the
client has so the confirmation gots the
sumatran confirmation will be invoked by
my background freedom so now all of this
code is essentially non-locking the
other thing that the CC sure also gives
you is composability and i won't go
through this book too much because i'm
really on the time but if you go through
this code in in the sky deck what you
will realize is that you're doing
exactly what you were doing before ok
but this code is completely not locked
certainly compared to the naive code and
even engage with a compared to the
asynchronous it's ignorance executed
service code is calm and it's relatively
clean it's as clean as you're going to
get with this patch with this type style
of programming let me skip the soaker
basically the long short of this is
there's a few other areas where we
reactive programming support in Java the
biggest one really is at the database
layer the JPA are making that layer more
reactive however and we are actively
looking to see what else we can do
taneja ye more reactive calm ok so just
to wrap up the active programming is a
relatively well established technique
it's
it may become more important in the
future and some of you may have used
cases for it already java ee already has
a whole bunch of the active features
built into it you can go a long way
towards designing these sort of
attractions and java ee today you could
improve upon this even further in job I
eh and java SE a helps quite a bit and
so it helps with things like relatable
future that we can object to some degree
and could head up even more in the
future and you know maybe there is even
more that we haven't even thought of you
will keep a look at we'll keep looking
at the image to see what else we can do
in the end though you'll be careful you
know you know however you slice it and
dice it hopefully this presentation
gives you a flavor of what
if you start writing these sorts of
applications don't do it if you really
really need it all right so without
further ado let me tell you where this
where you can find the slide deck
ok so there it is all right it's a
fairly simple URL simply slideshare.net
/ Reza underscore mon / reactive dash
java ee okay all right that's it in
terms of everything that I had to say</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>