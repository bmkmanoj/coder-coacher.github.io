<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Angular 5 Service Worker | Coder Coacher - Coaching Coders</title><meta content="Angular 5 Service Worker - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/CodingTheSmartWaycom/">CodingTheSmartWay.com</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Angular 5 Service Worker</b></h2><h5 class="post__date">2017-11-25</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/d9M3z6ap0x4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi guys this is Sebastian again from
coding to smart Wacom and today in this
new video I'd like to focus on angular 5
again as you already know angular 5 has
been released a few weeks ago and one
feature which is new to the angular
framework is a built-in support for
angular 5 serviceworker service workers
are one of the building blocks of
progressive web applications and in this
tutorial i'll show you how you can set
up a new angular 5 application from
scratch with a built-in serviceworker
support and we will see how to configure
the service worker so that we can
implement different caching strategies
for our application substitude so to get
started from scratch
I'd like to set up a new angle of 1/2
project first and as you might already
know the easiest way to do so is to use
the angular command line interface and
the angular command line interface if it
is installed on your system is giving
you access to a command which is called
ng and by using that command we can
initiate a new project adding and in
different elements to a project if you
would like run the live reloading
development web server and so on so to
set up an angular 5 project with a
service worker installed based on the
built-in service worker support which is
given by the at angular slash service -
worker package we need to have installed
at latest angular CLI version 1.6 which
is not yet released at time of recording
this video but the release candidate of
this version is available so you
first of all we need to make sure that
we have angular command-line interface
version 1.6 release candidate installed
so that we can make use of angular CLI
to set up a project with a service
worker already installed and set up so
you can do a quick check here alright I
add the command line to see which
version of angular CLI is currently
installed on your system I can type in
mg - - version and you can see I'm
getting here as a result I have already
installed angular CLI was in 1.6 release
candidate zero which is the version we
would like to use for that tutorial once
angular CLI is released in version 1.6
finally the installation is very easy
you can perform the installation by
typing an NPM install - G for installing
it globally on your system and then just
giving the package name which is add
angular slash CLI that what be is a
command
if version 1.6 is finally released as
long as we are in our release candidate
state for this version we need to add
another postfix here which is add next
and the at the next flag here together
with a package name is indicating that
we would like to install the next
version so the version which is not yet
released and in that case this is
version 1.6 release candidate zero at
the time of recording this video so this
would be the command you need right now
to make sure that angle
CLI is installed in the correct version
which is supporting setting up negative
half project with service worker support
okay we have made sure that the right
angular Sela version is installed so
let's make use of the ng command once
again
initiate a new project in this case I
need to add the new option here and then
specify the name of my project which
should be angular serviceworker 1 okay
and then I need to add another parameter
here which is called - - service -
worker so that angular CLI knows that
the service worker should be enabled for
this project so I'm hitting return here
and you can see it's downloading the
project template and then installing all
the dependencies via NPM you can see it
here it's running the installation now
this is taking a few seconds so here we
are installation has been finished
successfully and now let's start up our
code editor which is Visual Studio code
in my case and see what's inside the
project we can see it here in the
angular service worker one project
let's open up package dot Jason oh no
not package dot jason dot angular - CLI
daughter jason and let's look for a
property which is called service worker
you can find it here within the apps
section and this is the effect we
achieved by supplying the engine new
command with the command line parameter
service - worker this parameter is
putting this option to true which is
telling the angular CLI to generate a
service worker application here okay so
just to try it out we can open up the
development web server and check that
the application is running of the
browser or let's do it by saying ng
serve - - open ok you can see it
starting up the development web server
on port 4200 ok once it is ready we can
see the application as a Weibull here in
the browser I've opened up the chrome
developer tools here and to check if a
service workers running we need to
switch to the application tab here and
select service worker and you can see it
here it's empty which is telling us that
no service worker is running and no
service worker has been installed for
that application and the reason is quite
wise we are running this application in
development mode we have started up the
development web server but the service
worker which is activated for our
project is only becoming active and is
getting installed if we are running the
app in production mode so this is the
next step we need to build our app for
production and then run it again and
check it here in the browser once again
ok to do so I'm going back to Visual
Studio code here in the terminal section
I'm just stopping the development server
process which is still running and then
I need to build for production which is
achieved by using the following command
mg built - - prot and this command now
is building the application for
production and the result is outputted
in the dist subfolder of the project so
it takes a moment so that the build
process can be completed here and yeah
then we can switch to the dist folder
and see what's the result okay here we
are on the year production code has been
finished now you can see the dist folder
is a Weibull here we have all the assets
and the bundles of our application a
Weibull here you can also see that we
have a service worker script which is a
Weibull here and yeah let's try it out
to start up the application here we just
need a simple static HTTP server this
time we cannot use the development web
server of course and a very lightweight
and easy to use HTTP server is HTTP -
server which can be run from the command
line and the command is just HTTP -
server and you can install it again Vyra
npm so if you haven't installed HTTP -
server yet you can do so by using NPM
install HTTP - server - G for installing
it globally on your system I have
already installed HTTP - service so I
can directly switch to the dist folder
here and start it up by just using the
command HTTP - server here ok you can
see it here it's starting up the server
now it's running on localhost port 8080
so let's switch back to Chrome and
switch to port
eighty eighty you can see here we are
the application else still the same and
this time developer tools are still open
this time the service workers section
here is showing that a service worker
has been installed so you can see it
here it's ng as W - worker dot J our set
is the script we saw here in this folder
so it's activated and this running we
can stop it here if we like we can
unregister the service worker script and
yeah takes the application offline if we
like by switching on the option offline
here and the immediate effect which is
now active is that if I scroll a little
bit down and if I open up the cache
storage section here you can see that
all the assets of the application are
cached here so I can open up for example
the second entry here which is a Weibull
with a post fix cache here and you can
see here are the assets of our
application the static assets and the
bundle files a Weibull in the browser
cache so if I now try to simulate that
the web server is not reachable so I'm
going back to visuals to your code here
stopping the server process of the web
server is not running and switching back
to Chrome again and send another request
here you can see the website is loaded
contrived out once again it's loaded and
this time the serviceworker is active is
recognizing that the network connection
to the server is not there and serving
my HTTP request with a content which is
avaible in the cache so this is a
default behavior
and you can see if we are running here
our application in production mode we
have built-in service worker support and
our application is ready to be served
even if we are offline so next let's
switch here back to a code editor and
just examine the project structure a
little bit more to better understand in
which ways the service worker ish is
installed and in the second step we are
taking a look at server service worker
configuration and see how we can adapt
as the behavior of the default service
worker by we are updating and changing
the configuration file
first of all let's open up the SRC
folder and the app folder and let's take
a look in size of app dot module dot TS
and here in this file in my main
application module the step is happening
where the Service Worker script is being
registered for our application and the
first import statement which is needed
is the import of the service worker
module and this module is imported from
the new package at angular - service -
slash service - worker this is now a
co-op package which is part of angular 5
and built by the angular team and the
service worker module is giving us the
opportunity to then here in the import
array call the on the method register
and handing over the past to the script
of the service worker which is in our
case an g LW - con
worker dot J s so that is our script and
this is a being registered for our
application and installed in the browser
and the service worker which is staying
active by calling that method here and
here you can see it's only called in the
case when environment dot production is
true and we have already experienced
what is the result so if we are running
in a development mode the service worker
is not installed because this method is
not called
and if we are running in production mode
we can experience it the service worker
is activated and installed okay next
let's take a look at the configuration
file
it's a Weibull here in ng instantly -
config dot jason and you can see it here
it's in json format and on the top level
of the json object here we can find
basically two properties - configuration
properties the first property is index
and the index property is pointing to
you our index dot HTML file so the
starting point of our project and then
we have defined the next property here
which is called asset groups and this is
an array which is containing two
configuration objects so two asset
groups which is defining a group of
elements a group of assets in our
application for which a caching strategy
should be defined and configured so if
we take a look at the first asset group
here that's this asset group which is
getting a name here it's calling its
called app and the install mode is set
to the value prefetch which means that
all the assets described in that asset
group are pre fetched at the very
beginning of the application so before
an actual request for those elements is
made and all those answers the pre
fetched upfront and stored into the
browser cache so that this asset group
is for the core elements of our
application and our app shell so all the
components which are needed to run our
application of line so you can see it
here we have resources defined to
elements within resources first of all
our - static funds fav icon dot ICO and
index dot HTML and we have the version
files which are the bundles which are
outputted by the build process we are
running and earlier we saw that those
bundles are away will here in the distal
you can see it here so this group is
caching basically all of our core
application elements next we have a
second asset group which is called
assets and that is set to install mode
lazy which simply means that the
elements and the assets described by
this asset group are start into the
cache at the time when the user is
sending a request for getting those
elements so this is lazy in that case
those elements are stored into the cache
and this applies to all the files we
have in our project available in the
assets folder so a different caching
strategy here and yeah applied to the
elements in the assets folder so ok you
now have a basic understanding of the
default Service Worker configuration
Weibull in our angular 5 project the
default configuration is cache
the assets from a bear brown angular
project as you saw that what about if we
have other assets to deal with in our
application like external resources like
fonts and so on or content which is
coming from an external API so we can
extend the configuration - although take
care of those those elements and add
those elements to the cache by defining
a caching strategy for all of those
elements and for example if we would
like to add an external external
resources which needed for our app for
example fonts for example Google phones
we can extend here the assets asset
group by adding to the resources object
another element which is called URLs and
then this element is getting an array
like so and within the array we can
define the external resource we would
like to add to this asset group and in
that case I'd like to add all the fonts
from Google and those fonts are label by
the following URL its fonts dot Google
api's comm slash and then I'm using two
times the asterisk symbol here to define
this as the pattern so that it is
matching all the fonts from this URL
okay so what about data which is
retrieved from an external API we can
add that to the cache as well by adding
another top level configuration element
here which is called data groups so not
answered groups this time we are
defining data groups okay let's add an
array here we have in this example one
data group we would like to define so
one concur is an object here first of
all we need to give it a name let's name
it tasks - users API like so okay then
we need to define the endpoints by using
the URLs property here again this is
getting an array two elements here in
the array because I'd like to add two
endpoints tasks and there's users and
then we need to add cash config yes the
next property here which is getting an
object here we need to define the
caching strategy for all those two
endpoints so the first thing I need to
add here to cache config is the strategy
property so and I'm assigning a value of
freshness
by using freshness here as a strategy we
are configuring a network first strategy
so if the network connection is there
the data is always retrieved from the
external API because the API is
reachable or virus and network
we can change that to a cache first
strategy by just changing the value
freshness here to performance and in
this case the content from the cache is
taken first for performance reasons so
we need to continue here with some more
configuration properties let's define a
max size of 20 so 20 data sets as
maximum marks age let's say 1 hour and
the time out is set to 5 seconds so if 5
seconds are passed and the external API
is not responding we can serve from
cache okay so now you saw two examples
one example configuring an external
resource for example fonts from the
google fonts library and the second
example here of how to extend the
default configuration for the
serviceworker was a step of introducing
a data group which is caching content
which is coming from an external API as
you saw here this was about step from
coding the smart way calm thanks very
much for watching if you do like my
videos and my channel please don't
forget to subscribe to my youtube
channel please also don't forget to
visit my website at coding the smart way
comm where you can find many more
tutorials on latest weapon mobile
technologies I hope very much to see you
back in the next video stay tuned bye</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>