<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>MongoDB Tutorial #9 - Dropping a Collection | Coder Coacher - Coaching Coders</title><meta content="MongoDB Tutorial #9 - Dropping a Collection - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Net-Ninja/">The Net Ninja</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>MongoDB Tutorial #9 - Dropping a Collection</b></h2><h5 class="post__date">2017-01-16</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/5dhoyoet0Fk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">you're something guys welcome to your
ninth mongodb for beginners tutorial and
in this video I'm gonna show you how we
can drop collections okay so we saw in
the last lesson that when we opened up
our database in rabaa Mongo we had these
four modules that were saved to the
database and every time we run that test
is creating a new Mario and just dunking
it in this database so now we've got
multiple instances of a Mario character
with the same properties and this could
cause us some problems when we run
further tests and try new things out
with MongoDB for example if we have a
test which searches the database for a
Mario character with these properties
then it's always going to pass
regardless of any other tests we've done
so one of these dudes are going to be
skewing the tests that we perform in the
future so what's the solution well
ideally what we want to do is clean up
the database collection before every
test that we run so that each test can
run independently without influence of
the other tests so the way we can do
that is by dropping the collection and
by that I mean deleting the contents of
the collection before every separate
accessory run and we can do that using a
maca hook so we've already seen one maca
hook to hook so far and that was this
thing right here before and that said to
mock a look before you do anything I
want you to run this once okay and then
we connected to the database and then we
told maca when we were done by passing
the dawn' parameter there and then using
the done method there so that it can
move on to do the tests but what we
could do if we wanted is to run another
hook to say look I want you to do
something else before the tests as well
and we don't want to do this just once
before all the tests we want to actually
do this every time before every single
test so basically what we want to do is
empty the database before every single
test so that every single test can run
in isolation makes sense so that's what
we want to do so instead of just before
this time what we want is before each
so I'm gonna do a little comment and I'm
gonna say drop the characters collection
before each test and whenever you hear
this drop when you say you drop a
collection or you drop a database it
just means you delete it that's what it
means okay so that's what we're gonna do
we're going to use the before each hook
right so this is gonna say tamuka
okay I want to run this code inside here
before every single test not just once
this is running just once but this one
is going to run before every single test
so we're going to enter that database
out before every single test so that
each test can run in isolation so how do
we do this well a little comment there
drop the collection just so this is
almost and clear dead simple to drop a
database using Mongoose we can save
Mongoose doc connection dot collections
and this right here references all the
collections we have in our database so
right now it's just Mario cars right our
Mario characters so we'll say dot Mario
cars and that references the Mario cars
collection notice here that this is
plural right remember Mongoose plural
Isis our model our collection right here
because it assumes that we're going to
have more than one record in it so it
makes sense to pluralize it and that's
how we refer to it here so that is going
to give us the Mario characters
collection then what we want to do is
drop that collection so we say dot drop
okay cool that is how you drop them now
this is an asynchronous request
remember when we save something to the
database that said that it's going to
start it's going to take maybe a second
or so to complete that action and
returned to us okay it's the same with
drop it and it's got to go off it's
going to delete the contents of the
database and then come back and say yes
done so what we want to do is supply a
callback function when it's dropped the
database then we do something so we'll
say for
and in here I want to tell maca that now
we've done we've dropped the collection
now you can perform the test how do we
do that well we've done it twice already
it's using this thing right here this
dumb thing so we're going to pass it
through here as well done and then down
here in this function this callback
function we're gonna say now we're done
now you can run the tests so let's save
this and let's run the test to make sure
everything has worked as we would expect
so I'm gonna say npm run the test and
cool there we go it's passed the test
you can see that by the big green tick
there but what we really want to check
is that we've dropped the collection so
let's check out Robo Mongo and I'm just
gonna double click on Mario Kart again
and now we just see the one and you
might be thinking well hang on we
dropped the collection so why is the one
there but let me run you through this
again
so we've connected then we start our
test right now we're seeing here before
each test is run so before we do any of
the tests before anything here we're
running this yeah
and we're going to the collection and
we're saying drop the collection then
we're saying done move on to the test so
then we move on to the test and this is
the only test we have in a minute and in
the test we create a new character and
then save it and that's it then it's
saved to the database which is why we
see one there this drop method right
here
that's not run again because we've not
got another test to run and this only
runs before each test makes sense so if
we had another test then this would run
again and drop the database again before
that test so that we have an empty
database again for lattice to work in
okay so there we go that is dead simple
that is how we drop a collection for a
MongoDB</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>