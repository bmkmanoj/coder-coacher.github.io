<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>GraphQL Tutorial #26 - Making Queries from React | Coder Coacher - Coaching Coders</title><meta content="GraphQL Tutorial #26 - Making Queries from React - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Net-Ninja/">The Net Ninja</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>GraphQL Tutorial #26 - Making Queries from React</b></h2><h5 class="post__date">2018-04-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/uyrUI1tgayk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right then gang so now we have
Apollo set up on the front end we can
now start to get into all the real juicy
fun stuff and make some queries from our
react application but before we do that
I just want to correct a schoolboy error
I made in the last video when we set up
this Apollo clang and that is to remove
this semicolon right here that shouldn't
be there it's gonna cause an error later
on so get rid of that okay so now that's
out of the way what we like to do is
make a query from this book list
component right because we'd like to
retrieve a list of all the different
books and output them in a list right
here makes sense so then how do we make
queries in a component well there's two
steps first of all we need to construct
the query
much like we did in graphic you up then
we take that query and we bind it to the
component so that inside the component
we have access to all the data that
comes back from the query so let's take
this one step at a time
and in the first step which is
constructing the query now like I said
many times before graph QL query
language is not JavaScript
it looks like JavaScript but it's not so
when we construct it we need the help of
another package to help pass it all
right I need to pass our query so then
we can make them so the way we do this
is by importing something up here and
we're going to import gql from and it's
gonna be from Apollo - boost alright
sweet so now we have that we can create
our query I'm going to store this query
in a constant and we'll call it get
books query that makes sense right since
we're getting all the books and we set
that equal to GQ out which we imported
here then after that we place the query
directly after it okay no space directly
after it but it has to be within a
template string which of the look tix
like that that key is below the escape
button on my keyboard so we do the ticks
the buck ticks and then we do our query
so open the curly braces let in the
query we want to make is for the books
all the books
then from each book we want the name and
we want the ID of the book for example
so this should look awfully familiar
because these are the kind of queries
that we were making in graphical before
right only this time we're embedding
them in the template string right here
and putting them after gql all right
then we're storing that inside this get
books query so that's the first step
done we have now made this query or
constructed this query the second thing
we need to do is bind this query to this
component right here so that we can
access the data that comes back from
this query so how do we do that well
again it's pretty simple but we do need
the help of another package so this time
I'm going to import graph QL from react
- Apollo remember this react
Apollo package right here is the one
that helps us to bind Apollo to react
all right so this is always to do with
kind of gluing stuff together if you
like
so what we're going to do to bind or to
glue this query to this component is use
this thing we just imported right and
we're going to use it right at the
bottom when we export this component so
let's paste it there and it's a function
and as a parameter it takes in the query
we want to bind to this component which
is this get books query so let's copy
that dude and paste it right here then
we also surround book list in
parentheses as well so what we're saying
is take this thing right here and use it
to bind this query to this component so
that now inside this component we have
access to all of the data that comes
back from this query but whereabouts do
we have access to it where is he stored
well is stored in the components props
so what we could do just to test this is
console.log this dot props so this is
going to log this components props out
to the console
whenever the component renders okay so
let's give this a whirl and fair warning
this is probably not going to work first
time around and I'll explain why in a
minute but let's just make sure our
application is running yes it is you
need to run
p.m. start to do that remember so just
to be safe or refresh inspect to go into
the console let's zoom in and whoa we
have some errors for height then so it's
st. here basically that it's failed to
fetch the data from the server and the
reason is because of access control
allow origin right so basically by
default our server our graph QL server
is not accepting requests from another
server remember these two are coming
from different service the front end and
the back end over here are coming from
different servers right so what we need
to do is install something on our
Express graph give our server over here
that allows requests from other service
essentially and that package is called
cause so let us open up the code and
open up the server file and check out
package dot Jason right now it's not
installed so let's go over to the server
side stuff over here cancel out of this
process yep and say NPM install course
and again you might need to pass through
the save flag like so okay all right so
now we can open up a PJs and we can
require that over here we can say Const
course is going to be equal to require
course and we're going to use this for
our application so underneath here we'll
just make a little comment that says
allow cross-origin requests and then
underneath will say app don't use cause
like so alright then so let's now save
this and restart the server so we'll say
no daman app make sure everything is
running on this side as well cool it is
now we can go over to the front hem at
the front end there refresh and you're
going to see we have two objects logged
to the console here right so this is the
props object each time around now the
reason that this two is because when we
first load this up in a browser the
react component renders to the browser
right and at that point the
the query is still going on in the
background so if we open up this props
object we can see here we have a data
property right this data property is the
property from our graph QL query and at
the minute you can see loading is true
and we don't have any actual data
returned to us from the server right but
then when we get that data returned to
us from the server it updates the the
props object and adds that data to it so
then the react component re-renders and
we now have access in this data object
to the books property and inside there
all of the different books from the
server that is awesome so all of those
books now are attached to this data
property inside the props of this react
component therefore we can use them to
output the data to the screen which
we'll do in the very next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>