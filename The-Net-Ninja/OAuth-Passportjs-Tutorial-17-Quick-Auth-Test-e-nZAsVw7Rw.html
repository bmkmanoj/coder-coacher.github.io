<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>OAuth (Passport.js) Tutorial #17 - Quick Auth Test | Coder Coacher - Coaching Coders</title><meta content="OAuth (Passport.js) Tutorial #17 - Quick Auth Test - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Net-Ninja/">The Net Ninja</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>OAuth (Passport.js) Tutorial #17 - Quick Auth Test</b></h2><h5 class="post__date">2017-10-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/e-nZAsVw7Rw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hey what's going on guys welcome to your
17th Oh our tutorial and in this video
we're gonna test out the OAuth flow so
far all right there so in the last video
we set up our application to use cookie
session which is going to manage our
user session on a website and help us
decide whether the users logged in or
not okay by using a cookie which is
encrypted so the age of this cookie is
going to be a day in milliseconds and
we're going to encrypt this cookie using
this key that we set up in our keys file
we also initialized passport down here
so now everything's set up using
passport and ready to go so that when we
log in using Google we're going to take
that user profile information as a look
for that user in our database if they
already exist if they've been before or
create a new user we're gonna take that
user grab the ID from it stuff it in a
cookie encrypt it send it to the browser
then when the browser makes any
subsequent requests they're going to
send along with that cookie with it that
in quickly cooking we can be encrypted
then we can deserialize the user by
grabbing that ID and associating it with
a user in our database so we know then
what user is associated in the session
right we know who is logged in at the
time so now everything should be working
such that if we go to login and then
click over here whereas before it was
hanging because we didn't link
everything together now the whole
process should be complete so remember
when we click on this is gonna go to
forward slash auth forward slash and in
our earth routes we specified this down
here so right now it's going to go and
authenticate was through Google then
come back from the data do all that kind
of stuff then we're using this
sportdog offense kicked me to where
right here when we come back to the
redirect URI that's doing other stuff
like serializing the user sending the
cookie etc and then we're sending a
response so now we should get this
response right here okay so if we view
this in a browser I'm gonna log in using
Google we should eventually see this
message once were logged in because
passport is done all this stuff now so
let's login using Google and voila we do
see this so now according to our
application when logged in we're now
logged in that's the whole thing done
however what's really cool about
passport is now that we're logged in we
can access the user on this request
object so the way we do that is by
saying request dot user alright that's
how we access the currently logged in
user pus port does all this for us
behind the scenes when it goes through
this process over here all this stuff
right it attaches that user to us to the
request object so we can use it now in
our handlers which is freaking awesome
so let's make sure this works we'll test
it by sending back request dot user all
right so let's save that now and this
time what I'm gonna do is go back and
I'm gonna log in again
go to Google and hopefully we see that
object returned to us now how cool is
that we've got the idea of the object
I've got the username and we've got the
Google ID all right so we have access
now to this user inside this request
handler right here so what we could do
is we could output that user in a
different way we don't have to send this
object directly to the user's browser so
this is what they see we can for example
on a profile page
send back that data inside of you and
then lay out that data inside of you in
a nice way for the user all right so
that's what we're going to do as we go
forward in this tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>