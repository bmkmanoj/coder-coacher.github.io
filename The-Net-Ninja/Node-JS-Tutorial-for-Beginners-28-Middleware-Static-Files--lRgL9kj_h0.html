<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Node JS Tutorial for Beginners #28 - Middleware &amp; Static Files | Coder Coacher - Coaching Coders</title><meta content="Node JS Tutorial for Beginners #28 - Middleware &amp; Static Files - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Net-Ninja/">The Net Ninja</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Node JS Tutorial for Beginners #28 - Middleware &amp; Static Files</b></h2><h5 class="post__date">2016-06-29</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/-lRgL9kj_h0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">you know something guys welcome to your
28th nodejs tutorial and in this video
I'm going to show you how we can serve
up static files and talk a little bit
about middleware all rather so before we
talk about middleware I just want to do
a quick experiment and I'm here in the
index ejs file this is the template file
we created a couple of tutorials back
which is right here and you'll see what
I've done is I've taken all of the
Styles out of the head and place them in
an external style sheet which is in the
assets folder right here called style
stop CSS because this is typically the
way we do it we don't normally put
Styles in the head for a full website so
I've gone ahead and linked up it's in
the ford slash
assets folder forge / style CSS so it's
pointing to this far right here and
there you can see these are all the
styles in that file so this should still
work the same right let's test it out
node 1 up j/s and just running the
application here with node 1 and then
once that's done let's refresh over here
the home page and you'll see we're not
getting those styles through it's all
looking like junk here and you'll notice
on the network tab that I've got open
this style CSS is getting a 404 error
now why is that
well it's because at the end of the day
this is making a request to the server
and our application running on nodejs is
not responding to this request this is
just a request like any other request
like when we visit a specific URL here
we're still requesting something but
whereas we're dealing with these
different URLs in the object file right
here we're not dealing with this kind of
request for a static file now I suppose
what I could do is go ahead and create a
lot of different handlers up for these
requests for images and style sheets etc
but that would quickly get out of hand
so what I need is a simple way to serve
up these static files and deal with
those static file requests ok so
fortunately we can use something called
middleware and we can use some Express
inbuilt middleware to do this forwards
but first of all let's talk a little bit
about what middleware is and middleware
is he sent
the code that runs between the request
and the response and we've already been
kind of using it so if we take a look at
the code here you can see right here
someone's going to make a request for /l
/contents the request and then this is
going to be with the response right here
now this function right here can run any
other code you know we can console don't
log something we could do something with
some data whatever all this code right
here between the request and the
response being sent that is middleware
it's code that's in the middle if you
like okay so what we're going to do is
use some custom middleware or some
middleware that comes baked with express
to serve all those static files like
style sheets or images so that we don't
have to go through and write all of our
own routes if you like for these
different static files okay so just a
quick example of how we can use some
middle where we'd say app queues to use
some middleware and then we can match it
to a route if we want or if we don't put
a route in that it's going to use this
middleware on every request that is made
either in the browser or within the
document like this okay
so we can attach it to a certain route
if we want which is what I'm going to do
and I'm going to say forward slash
assets okay so when ever someone visits
forward slash assets or forward slash
assets for it's like something else
whenever that appears at the start of
URL after localhost port 3000 then this
middleware is get a fire right and like
the same either way
just code so it passes through a
function here and we can fire some code
and this is the middleware now again we
can take the request object the response
object and also a third parameter called
next and we used this next parameter to
say look we've finished our middleware
now go on to the next set of middleware
okay we have multiple middleware that
matches a certain realm for example if
we had something like this this
middleware or this kind of route here
it's going to match
pretty much any URL that a user writes
into an address bar when they video when
they visit our application okay because
it's just /soe coming forward slash home
forward slash contact forward slash
whatever and it's always going to fire
this middleware because that's always
there so when we've ran this middleware
we need a way to tell nodejs to go to
the next middleware which is going to be
in here or the next request the let's
get method there okay so what we need to
do is at the end of this middleware just
say next like that that's all we need to
do okay we don't put that there then
potential this is going to break and the
application will run okay so now we can
write our middleware so what I'm going
to do is just console dot log the
request URL okay so I'll change this
back to assets again like so and if I
save this now and run this in a browser
what I'm going to do is just go to
forward slash assets and then you're
going to see down here that the URL is
just forward slash and it's taking the
URL after forward slash assets okay so
if I do forward slash assets style dot
CSS Styles or CSS then you can see this
is the route that we're going to however
if I go to forward slash contact then
it's not going to display anything down
here it's not login anything to the
console because we've not matched the
route on this middleware makes sense
okay cool so we could serve up our
static files in this function if we
wanted to but fortunately Express comes
with some middleware already installed
into it which we can use to serve up
these static files and that's called
Express dot static and then in here what
we want to do is map this static or this
route to a folder where the static files
are stored so they're stored in a folder
called assets at the middle at the
minute so let's say assets like so
but we can save this and now any request
that's made to forward slash assets
forward slash something else is going to
map to this folder and it's going to
serve or whatever we request so now if I
go to forward slash assets forward slash
of style.css now we get the style sheet
right there it's working okay and
therefore if we go to the home page we
get the Styles back it's blue and it's
white text because now this is being
handled by no would appear okay it's no
longer a 404 error because we're
handling it using this middleware right
here and notice we don't need to use
them the next method or anything like
that here because this function right
here remember middleware it's just a
function with some coding this is taking
care of all of that for us this is a
function built-in to express to serve up
static files and this folder right here
we'd normally call that public but since
we already have a public folder in our
files which we're going to use shortly
when we create our to-do app I've named
assets but this can be named whatever
you want we could rename this to stuff
and then if we change this to stuff and
save it then still whenever we go to
this route forward slash assets forward
slash style.css it's still going to map
to this stuff
folder okay makes sense so this is much
in the route and then this is linking up
the directory to where it's stored make
sense ok cool so that is how we serve up
static files and we're going to be using
this as we go forward as well when we
create our to-do application so until
then if you have any questions
whatsoever feel free to leave those down
below otherwise guys I'm going to see
you in a very next tutorial</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>