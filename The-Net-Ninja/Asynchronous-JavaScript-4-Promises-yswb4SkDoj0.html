<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Asynchronous JavaScript #4 - Promises | Coder Coacher - Coaching Coders</title><meta content="Asynchronous JavaScript #4 - Promises - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Net-Ninja/">The Net Ninja</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Asynchronous JavaScript #4 - Promises</b></h2><h5 class="post__date">2016-05-05</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/yswb4SkDoj0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">you know or something guys welcome to
your fourth asynchronous JavaScript
tutorial and in this video we're going
to talk about JavaScript promises Wow
right there so we saw in the last
tutorial then it can be quite tricky to
keep on top of managing the order of a
lot of asynchronous callbacks it can
lead to messy code and basically just
give you a huge headache so now what I
want to do is introduce JavaScript
promises which help us organize these
callbacks in a way which is much easier
to maintain so what the hell is a
promise then well a promise is just an
object which represents an action that
hasn't finished yet but will do at some
point down the line it's essentially
just a placeholder for the result of
some kind of asynchronous operation like
a HTTP request so say for example we
make a hasty TP request for some data as
soon as that asynchronous request is
made it returns a promise object
straight away before the data is
retrieved and brought back to us now
within that promise object we can
register callbacks which will run when
the request completes right so promises
are actually pretty new feature that we
can use via the latest edition of Emma
script 6 however there are quite a few
promise libraries out there such as
queue which implement it as well I'm
just going to work with the native
promise library so what I'm going to do
is take to kind of use just to show you
that this is not supported in a lot of
Brad well not a lot but mainly erm ie
browsers so I'm using Google Chrome
which does support the new promise API
in Edmund script 6 so I'm alright but if
you're going to go into production with
them then I probably still would use a
promise library such as queue to make
sure you've got full browser support and
you can find that on github and you can
read about it here so I'll leave a link
to this down below if you want to check
it out like say I'm just going to use
the native promise API that was
introduced in Emma script 6 so let's
make a simple promise the first thing
you're going to notice on this page
right here is this scary code right here
but don't pay too much attention to it
yet it's just a simple function called
gets which it takes in a URL and it's
going to go out and it's going to grab
some data using an X
httprequest object okay and we saw how
to do that in one of the first tutorials
but don't worry I'm going to go through
all this in a few minutes for now what I
want to do is create a variable and
Conte going to call this promise and I'm
going to set this equal to this function
get which is just going to go out and
grab some data right and it's going to
go out and it's going to grab the data
which is in the data folder forward
slash tweets dot JSON okay
so when we call this function what it
does is return a promise to us you can
see right there it returns a new promise
so right now this is a promise and
that's returned to a straightaway
before this data is brought back to us
okay so I said that a promise is a
placeholder object in which we can
register our callbacks for success or
failure so we can do that now on this
promise we can say promise dot then and
then pop a callback function in here
which is going to take the data with all
the data tweets and then in there we can
do something with those tweets I'll just
log them to the console so console dot
log tweets and if i refresh this now
we're going to see hopefully these
tweets right there that object cool so
what's happening well when we set this
variable promise equal to this get
request it's returning a new promise to
us and that promise is a placeholder for
something that will happen in the future
right and the thing that's going to
happen in the future is that we're going
to grab this data and it's going to be
returned to us okay so what we're saying
is okay well once that promise has been
fulfilled once that data has returned to
us and everything's okay we use the then
method to say then I want you to do this
function which is going to log the
tweaks to the console right and we can
also prepare our error handle as well by
using the catch methods also a catch and
we can just chain this on to the end of
the then method
so we'll say catch and if there's an
error we can pass through a callback
function with that error okay and we can
log that to the console as well so I
could say console
Blagh the error okay and if for example
I spell this incorrectly to put an extra
e'en then save it we're going to see
this error right here not found and
we're getting that get error for a for
error right there okay so pretty cool
now you might be thinking well okay why
is this so much better than using just
regular callbacks because after all this
is just a callback function right
well the real beauty of this is when we
start to make multiple asynchronous
requests because we can just chain them
together so what I could do in this
first call back function is return
another promise I could just return
another gets request like that and then
inside there what I'm going to do is
save data forward slash friends JSON so
as soon as this promise is fulfilled
and we fire this then method and the
callback function right here once that's
done we're going to load those tweets to
the console and then we're going to
return another promise which is a get
request for the friends Jason or right
here
okay so we're returning that and then
therefore this is now a promise for this
okay makes sense so now we can use dot
then again and inside that we can do our
other callback function and we can pass
through the friends and within that
callback function we can say console dot
log friends if we can spell it correctly
fr ie there we go okay so if we save
that now we're going to see both of
those log to the console first the
tweeks then the friends and again if we
want to get some more data we can say
return and then get this time we're
going to say data forward slash videos
Jason and that's going to return to us
another promise so therefore we can use
dot then again once it has that data and
we can pass through another callback
function like so and pass through the
videos and in this callback function we
can log those to the console
like so okay so if we press save we get
all three of them and this looks a lot
nicer than all of those nested callbacks
and different functions this is a much
more elegant way of dealing with DOS
callbacks I think so when we create this
variable promise and we set it equal to
this get request right here which is
this thing right here
we know that it's returning a promise
okay and anything with that promise
interface has the dot then method
available to it and the dot catch method
available which is why we can do all
this because we're being returned a
promise to this variable so I just want
to go through what we're doing here and
how we're returning this price so this
function get takes in a URL which is
just the data we want to collect right
there and then what we're doing is
returning a new promise object right
there and this promise takes a function
and in this function there are two
parameters resolve and reject so resolve
is what happens when the promise is
resolved when it's a success if you like
and reject is what happens when the
promise is rejected and it's an error if
you like okay so within this promise
what we're doing first of all you've
seen this in previous tutorials we've
created a variable called X hate TTP and
we're setting that equal to a new
xmlhttprequest then we're using the open
method on that we're saying we want to
make a get request to the URL provided
which was passed through to this
function and we're saying true for
asynchronous right then what we're doing
is saying down here we want to send that
but up here we have these two methods on
load and on error and basically if your
browser supports the promise interface
then it's going to support this method
not this method sorry this unload method
and this on error method as well so we
don't have to worry about that on state
chain onreadystatechange stuff right so
what we can say is dots unload when this
data has loaded we set that equal to a
function we're going to check that the
status is equal to 200 make sure that
it's been found and then we're going to
resolve that's data by passing it first
of all and getting the response from the
H at the exit
ttp object right so we're calling the
resolve method when it's successful if
it doesn't equal 200 then we're calling
the reject method and we're passing
through the status text of this object
as well okay so what either resolving
the promise or rejecting the promise
based on whether it's a success if you
like okay then down here we're saying on
error if it can't be loaded for any
other reason then we're going to reject
it as well and we're also going to pass
through that X dot X HTTP status text
okay so we're rejecting here and we're
rejecting here based on these conditions
and we're resolving here if everything
is fine okay so when we have this
resolved method then the dot then method
can apply and we can access that data
when we have the reject function right
there then the dot catch method applies
and we get the error right there all
right so that is how we make a promise
and that is how we use the promise
interface if you like now
jQuery also comes with a promise
interface these days so I'm just going
to quickly show you how we deal with
promises like that as well because it
kind of abstracts all this kind of stuff
out if you like I just wanted to show
you this so you've got some kind of
background knowledge on it and you
understand what the the inner workings
are like but if we comment all of this
junk out for a minute like so then what
I'm going to do is show you the jQuery
way so we can use jQuery
get to go and get some data we know that
already and then in here we're going to
say what data we want to last data
forward slash tweets JSON yep and then
instead of passing through a callback
function right here as we normally board
we can say dot then because this now
returns to us the promise interface and
anything with the promise interface can
use the dotnet method all right so we
can use the dot then method on this and
we can put our callback function in here
and we can pass through the tweets and
then in here we can console dot log
those tweets which like we did in the
other
example like so so if we refresh we're
going to see those tweaks log to the
console and again we can return the same
thing we can return this a promise
interface so that we can call the next
method again so I'm going to copy that
and I'm going to say return and I'm
going to do another one of those this
times its friends dot JSON and what I'm
going to do is then say next because
this has returned as a promise to this
right so now we have another promise
which we can call dot next up not sorry
not top next to keep getting those mixed
up for some reason dot then okay if we
can spell it and then inside this top 10
method we can pass through our second
callback which is going to take those
friends and within that function we can
console.log those friends and we can see
those over here now okay and finally we
can return yet another promise which is
going to be the videos and then we can
use another dot then method pop our
callback function inside with those
videos and within that function we can
log them to the console like so and
voila Bob's your uncle we've got all
three logged to the console right there
tweets friends and videos so if you
compare this to the callback method that
we used in the last tutorial where it's
all over the show we had callback hell
etc this looks a lot better
abstracts a lot of this stuff out first
of all and it also looks neater and it
looks like synchronous code one after
the other if you like butter yeah that
is the promise interface and that's why
it's so good it just looks a lot better
and it's much easier to maintain so any
questions feel free to where I leave a
comment down below otherwise guys I'm
going to see you in the very next
tutorial where I'm going to talk about
generators</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>