<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>JavaScripts Tricks #1 - Create a Snowy Background with Canvas | Coder Coacher - Coaching Coders</title><meta content="JavaScripts Tricks #1 - Create a Snowy Background with Canvas - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Net-Ninja/">The Net Ninja</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>JavaScripts Tricks #1 - Create a Snowy Background with Canvas</b></h2><h5 class="post__date">2015-12-15</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/ANDyf6VEYHE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">yo what the hell's going on guys you're
watching JavaScript tips and tricks
lesson one and since it's Christmas and
all I thought I'd do a nice festive
tutorial and show you guys how to make a
snowy background using the html5 canvas
element Wow or I think going so there
are just a couple of things you probably
should be aware of before you start
doing this tutorial the first one is the
html5 canvas element because that's what
we're going to use the dryer on all the
snowflakes and do the animation so if
you're unsure about that maybe read a
thing or two about it first just to make
sure you're aware about what it's all
about if you know quite a bit about it
that's great you're going to find this a
lot easier second thing you're going to
need to know is a bit of JavaScript
because we're going to use JavaScript to
draw animation onto the canvas element
okay so I've got a JavaScript for
beginners playlist which I'll leave the
link to down below you can go check that
out and then dive back in here
and we're going to get cracking with the
code alright then guys so this is the
background effect we're going to go for
in this tutorial you can see we've got
like a nice blue sky background and
we've got these little snowflakes coming
down and swaying from left to right some
of them faster than others so pretty
realistic that's what we're going for in
this tutorial and right now we're going
to jump over to the code alright then
guys so I've gone ahead and made two
files over here in bracket index dot
HTML and Snow j/s this is the index file
and it's dead simple all I've done is
pop this script in the head which is
linking to the snow Jess over here I'll
talk you through that in a second then
I've got this style right here which is
giving the background of the body this
deep blue color then in the body itself
I've got this canvas element right here
with an ID of sky now for those of you
that don't know what a canvas element is
all about basically it just provides us
with a kind of drawing surface on the
web page just like overlaying a piece of
paper onto the page so that we can draw
things on it and animate them alright
but the things that we draw on that
canvas do not become a part of the
document object model so we can't reach
in and grab them using CSS rules or
anything like that okay it's all kind of
coordinated via the JavaScript API and
we're going to go through that in a
minute so that is the HTML file that is
all we need to do nothing more dead
simple so we'll jump through to the
the javascript file which in a minute is
just an onload event on the window which
is going to fire this function when the
window loads so this is where we're
going to do all our magic right now what
I've done is I've already got on this
card opening notepad on my other screen
you can't see that I'm just going to
paste over little chunks at a time over
to the left and then I'll go through
each section but I'm going to comment it
up so you know what everything is now
the first thing I want to do is I want
to get the canvas element that we've got
in the HTML store that in a variable and
then store the context of the canvas in
a variable as well so VAR canvas in fact
what I'm going to do is just comment
this first of all I'll say get the
canvas and context and store inverse
okay cool and I'll just copy from this
notepad file and paste it here cool so
we've got the VAR called canvas right
here which is saying
document.getelementbyid d sky which is
this thing right here this canvas
element so we've stored that in this
variable and then the second variable is
cth which stands for context and it's
taking this canvas variable now that
we've got it here and it's using the get
context method to say that we want the
2d context so now we can draw 2d shapes
on here alright so the next thing I want
to do is set the canvas dimensions equal
to the window dimensions so I'll write
that here set canvas Dems dims to window
height and width alright and I'll copy
this from a notepad file paste it over
here ok so what I've done is got this
first variable called W and I've set
that equal to the window dot in a width
which is this width over here and same
for the height H equals window in a
height this height here then I've
grabbed a canvas variable there and said
I want the width to be equal to W this
thing and the height to be equal to H
this thing so now the canvas is all this
space and all this space the full space
that the browser provides because by
default the canvas is something like 300
pixels in width so we've already done
that and we've made it the full
dimension of the window
okay the next thing I want to do is
start generating the snowflakes and
giving them some attributes so I'll say
generate the snowflakes and apply
attributes like that and then just going
to copy this paste it over here just a
couple of variables the first one is
called n F and that stands for maximum
flakes and we're saying that's equal to
100 so at any given point I don't want
any more than 100 flakes to show on the
page okay so I'll just pop a little
comment there so you know what it is
max flakes like that and then this next
variable called flakes is set equal to
at the minute an empty array but what
we're going to do is store all of our
snowflakes in there all 100 of them and
each snowflake is going to be an object
and it's going to have various
properties such as a width and a height
and things like that okay so what we're
going to do now is cycle through each
100 of these flakes and we're going to
give them some random properties so to
do that we're going to need a for loop
but I'll write a little comment first of
all i'll say loop through the empty
flakes and apply attributes okay so
basically the empty flakes means that
currently no flakes none of these 100
flakes have any width or other
attributes associated with them okay so
the empty flakes and I'm going to apply
attributes to them now
now to loop through them all I'm going
to use a for loop and I'm just going to
copy this code over here and paste it in
like that so I've said for VAR i equals
0 so we're sitting our index very
variable to 0 for as long as I is less
than M F which is 100 every time add 1
to I then for each flag what we're doing
in here is we're saying flakes push so
adding on a new flake to this array
every time so we're pushing on a new
flake and we're setting some properties
now the first property is X and that is
set to math dot random math is a
JavaScript object we're just using this
random method which is going to generate
a number between 0 and 1 a random
number and it's going to times that by W
over here so that's going to give us any
any x-coordinate between here the left
side of the screen and over here the
right side of the screen the same we're
doing for why why is this access opened
that axis up and down and we say math
dot random times height this time so
it's going to be any point between here
and here that we generated okay and the
radius is math.random times five plus
two and this is going to give us a
radius for each snowflake that is
anywhere between two and about seven
because this number can be between zero
and one so if it was around one then
it'd be one times five which is five
plus 2 which is seven if it was zero
then it'd be zero times five plus two
which is two so that is going to be the
min and Max radius then we're going to
apply density to it and the densities is
going to be what affects how quickly the
snowflakes fall to the ground okay so
we're going to fall quicker than others
so that again is set to math dot random
plus one all right I've done that so
it's got a minimum density of one and
then that's it so what we're going to do
is loop through all 100 of those flakes
and we're playing these properties to
each one of them and restoring each one
in this array so now we should have 100
flakes in this array okay so the next
thing we need to do is draw these flakes
on to the screen right here
okay so let's create a new function but
first let's do a comment to say draw
flakes on to canvas then again and just
going to grab function than I did before
I'm going to paste it under here all
right so you can see I've got function
I've called it draw flakes and then this
is my code block right here and you can
see I'm grabbing this context variable
which is up here that's stored before
and I'm using the clear rect function
which is just going to clear the whole
screen okay start at zero zero which is
up here and its width in length and it's
hey chin height so it's making a
rectangle
she's on the screen and it's clearing it
so that's going to get rid of anything
currently on the canvas then I'm setting
the fill style equal to white which
means if I fill the canvas or any shapes
that I do it's going to be currently
white then I'm going to use the begin
path method which basically says to
JavaScript look I'm going to about to
begin a path for a shape on the canvas
I'm about to draw a shape or a path if
you like and then what we're doing is
doing a simple for loop for I equal to
zero to begin with and I'm basically
going through each flakes of a lesson
and F then I'm going to apply one eye
each time around so we cycle through
each of the flakes then on in here
within the loop I've said VAR f equals
flakes eye so it's currently grabbing
whatever flake I is equal to so it's
going to start at 0 all the way to the
last one and loop through each one then
I'm using the move two method on the
context variable right here which is
basically going to move the start point
or the position point of the drawing pen
to these coordinates so it's going to
grab F which is this thing remember X
which we supplied there and F dot Y
which we supplied there so it's going to
take those coordinates and go to them
for example around about here on the
canvas then we're going to draw an arc
which is going to start at this point
and this point especially flying the
radius of the arc so if it's 3 pixels
then the radius is going to be 3 pixels
away from that point then this thing
right here means we're going to start at
0 degrees and this math dot pi times 2
is basically 360 degrees for those of
you who know math 360 degree 60 degrees
is equal to 2 pi radians and this arc
function uses radians ok so I'm saying
start at 0 degrees at the top or
whatever and go round to 2 pi radians so
I'll do a full circle so what i'm doing
here basically is drawing a full circle
the fact I've said true there means I
want to go clockwise around that circle
all right so we're starting at the top
at these coordinates and
we're using this radius to go out from
those coordinates and we're going around
a full circle from zero degrees to two
pi radians so 360 degrees in a full
circle like that clockwise so once we've
got the full circle I'm saying context
fill and that's going to fill it with
this star right here it's going to make
it white all right because that's what
we set right there so it's going to call
then another function called moon flakes
which is going to animate the flake in a
minute I'm going to show you that in a
second but it's going to do that for
each of the flakes okay that's what it's
going to do so it's going to go through
all 100 flakes into all 100 different
points and it's going to draw a circle
for each one and the circle size is
dependent on this thing right here the
radius of the circle
all right make sense cool so the next
thing we need to do is animate the
flakes or move them all right so let's
do it a little comment right here which
just says animate the flakes and then
under there what I want to do first of
all is a new variable called angle I'm
going to set this equal to zero we're
going to use this angle variable in a
minute and I'll tell you what we're
going to use it for then but I'm just
going to copy this new function I'm
going to pop it down here below here and
you can see this function is called mu
flakes this is the function that we
wrote Hao right here wrote out rather
right here so we're going to call this
after we've made the the flakes so after
we've made all those we're going to call
this function and then the first thing
I'm going to do is just increment the
angle by not point not one
so each time we move the flakes this
angle is just going to move up by not
quite not one and it's basically the
angle is going to control - left or
right movement of the flakes right so
you can see right here what I've done is
for each flake again I've used this for
loop so for as long as I is less than MF
so we're going to cycle through all the
flakes then VAR f equals flakes eye so
the current flake is f now so we can use
it within this loop then I'm saying f
dot y which is the y coordinate sorry
this one going up and down I'm going to
set that equal to math Pao F dot
which is the density which we outlined
up here Muffit random plus one so we're
taking the density and we're applying
that to the power of two so we say
square the density alright so if the
density was two then we say two squared
is four right there that's what this
power function is all about which is
square in the density so we're squaring
the density on laplacian one so that is
going to be the new coordinate of the Y
okay sorry if rather we're adding that
to the current coordinate so if the
coordinate is 10 then we're going to add
say like five so the next coordinate
will be 15 okay so go down five pixels
or something like that
then we're going to do something similar
with the x coordinate this time we're
going to plus equal that equal to math
dot sign which is a mathematical
function and it's gonna be the sine of
this angle right here and because this
angle is incrementing each time we call
this function each time the flakes move
this means that this is going to create
like a sine wave down the page a bit
like the mouse is doing right here okay
so it's going to sway from left to right
like that that's why I'm using this
function just so it appears a little bit
more realistic glad to wind is grabbing
hold of the stump flakes and moving it
left or right a bit like that then we're
going to times it by two all right so
just so it drifts a little bit more so
we're changing the x and y coordinates
each time of the flakes so that they
move and then after that we're saying if
the snowflake reaches the bottom send a
new one to the top so as they come down
here the snowflakes like this when it
reaches the top and goes off the screen
we want to add a new one to the top so
that it continues snowing because if we
don't do that then all the snowflakes
are just going to reach the bottom and
then game over thus if you guys know
more snow this is the shorty snow storm
you're ever going to see about twenty
seconds long so we want to add a new one
to the top every time we go around okay
so what we're doing here is a simple if
statement and we're going to say if F
which is the current flake dot Y so
that's the y coordinate of the current
flake if that's greater than the height
of this page which means it's going to
be beyond the bottom basically then we
want to do this we want to say flakes to
I which is the current flake is
core to this new object right so we're
going to set it a new random
x-coordinate along the top right here
anywhere between here much like we did
up here so for that flavor with your n
x-coordinate then the y-coordinate is
going to be 0 which is right at the top
because that's where we want it to start
again and then the radius is going to be
the same after R and the density is
going to be the same as the current one
which is FD all right so that's what
we're doing so just to quickly walk
through this again we're first of all
storing these variables the canvas and
the context right then we're setting the
width and height to canvas right here
then we're creating the snowflakes and
setting the maximum number to 100 and
generating this empty array where all
the snowflakes are going to be stored
then for each snowflake we're going to
push through an object right so each one
of these objects right here this is the
object notation we're given each flake
some properties XY coordinates radius
and density and we're using the math dot
random functions to do that and we're
storing each one of these objects in
this array so then we should have
hopefully after the end of this 100
objects in this array and each object
represents one of the snowflakes then
down here we've got this function called
draw flakes this is where we're going to
actually draw the flakes on to the
canvas right so for each one each time
we call this we're going to clear the
rectangle so we're going to erase what's
on there currently then we're going to
set the fill style of the context to
white so that whatever shapes we did we
can fill it with white then we're going
to begin a path we have to use that
method to begin a certain path using the
the JavaScript API for the canvas then
for each snowflake right here we're
going to move it to a random point on
the screen which we specified right here
you can see after X and F sub y so
whatever that object x and y coordinates
are we're going to move to that point on
the canvas like that and we're going to
generate this arc which is going to make
a circle shape like that all right then
we're going to fill that circle with the
white which we specified up here so it's
going to create all these different
snowflakes on the page right after we've
done all of those we're going to call
this move flakes function because
currently they're all static there on
the page so we're going to call this
move flakes function
we've done that to move them so first
thing we've done is set the angle to
zero and then each time we call this
moon flakes function it's going to add
this not point not one value to the
angle so it's going to increment each
time then each snowflake is going to
cycle through each one and it's going to
update the X&amp;amp;Y coordinates of each one
so that they move downwards and side to
side right the way we move it downwards
is by saying f dot y remember f is set
to the current flag so f dot y is the
y-coordinate I've set that to masked up
out of the density to the power of two
so it's the density to the power of two
plus one so we're adding this value to
the y coordinate each time so it goes
further down and it goes down at
different rates okay remember the
density controls how fast it falls down
so if you've got a higher density
snowflake it's going to fall down
quickly all right then we'll updating
the x coordinate to be equal to math dot
sine which is going to make this sine
wave down here and it's going to take
this angle which is constantly
incrementing so it's going to go like
this all right then
if the snowflake reaches the bottom
we're going to apply these new
coordinates and properties to the
snowflake so that it starts again at the
top and it goes down again
all right so there's just one more thing
you need to do and that is to call this
draw flakes method say like every 25
seconds or something like that so that
it constantly calls it and constantly
moving down all right so let's come
right here at the end of that function
and we'll just say sets interval and
then we're going to call the draw flakes
method oops
draw flakes and then say every 25
milliseconds or something like that so
I'll save that and then if I go over
here and refresh voila there we go guys
there is our snow effect and it's all
coming down going left to right explore
right in a minute currently but you've
seen a second it's going to drift to the
left again like that pretty cool right
so there you have it my friends that is
a snow effect using the canvas element
and some JavaScript you have any
questions feel free to pop them down
below otherwise guys I'll see you in the
next tutorial in this series</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>