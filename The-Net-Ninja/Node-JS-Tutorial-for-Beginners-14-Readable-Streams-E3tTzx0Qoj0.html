<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Node JS Tutorial for Beginners #14 - Readable Streams | Coder Coacher - Coaching Coders</title><meta content="Node JS Tutorial for Beginners #14 - Readable Streams - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Net-Ninja/">The Net Ninja</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Node JS Tutorial for Beginners #14 - Readable Streams</b></h2><h5 class="post__date">2016-06-04</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/E3tTzx0Qoj0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">you know something guys welcome to your
fourteenth nodejs
tutorial and in this video I'm going to
talk about readable streams okay so we
saw in the last tutorial how streams and
buffers kind of work behind the scenes
and in this tutorial I want to show you
how we can make our own custom stream in
nodejs now there's a couple of different
types of streams we can create in OTS or
writable and readable streams so what's
the difference between them well a
writable stream allows nodejs
to send data or write data to the stream
and a readable stream allows nodejs
to read data from the stream and we can
actually create a third type of stream
which can do both write to the stream
and read from the stream and this is
called a duplex stream so you can
imagine when we're sending a response to
a client from nodejs we are sending the
client some data so in this instance
we'd be talking about a writable stream
because we'd be writing data to the
stream that's going to be received by
the client the browser and vice versa if
node was receiving data from somewhere
like reading a file or receiving a
request then we'd be talking about a
read stream because it would be reading
data coming in the stream so let's take
a look at an example okay then so I'm
Bucky in app KS and I've got a head and
commented out that server we made a
couple of tutorials back I'm keeping it
there because we are going to be using
it again in a couple of tutorials time
but I've commented it out for now
because we're just going to look at
creating a read stream in this tutorial
now I've also created a readme text file
which is basically a load of junk or
lorem ipsum and I've just copied and
pasted this off the internet grabbed
loads of lorem ipsum and pasted it in
there so this is what we're going to be
reading in the readable stream okay so
how do we go ahead and create one well
first of all we need to use one of J no
Jessie's core modules and that is the FS
module the filesystem module
and we use this module to read a file
and this is kind of like the same thing
but we're doing it in a different way
we're reading it through the stream this
time so let's go ahead and get that
module sorting VAR f s equals require
and then FS so now we can use this and
to create a readable stream we need to
use a method called create read stream
and I'm going to store this in a
variable so I'll say VAR my read stream
you can call it whatever you want and
I'm setting this equal to FS then create
read stream okay and this is going to
create a readable stream for us which we
can read data from so what we need to do
is specify and tell node J s which file
we want to read through the stream so I
want to read this one right here so what
I'm going to do is use the Durr name
property on the global object first of
all that's going to get me my current
directory so this one right here and
then I'm going to concatenate that with
the file name so forward slash
readme.txt okay because it's going to be
in this directory then we need to do a
forward slash after that directory
because we're in it then the filename so
now we're going to go out and create a
read stream which is going to read this
file so what's going to happen is we go
read this a little bit at a time let's
go go out find this data then this data
is going to be read a small amount of
time through the stream it's going to
fill up the buffer then that buffer is
going to pass the data run in chunks
okay so it's going to essentially split
this data up and pass it on in chunks to
this variable right there
okay so what we can do is we can kind of
recognize when we receive one chunk of
data so the first piece that comes back
to us and we can do that because this
create read stream inherits from the
event emitter and the
is an event called data on this create
read stream which allows us to listen
for when we receive any kind of data or
any kind of chunk of data from this
stream so we'll go ahead and set up a
list now that's going to listen out for
that and then fire a function every time
we receive something so that's let's say
my read stream and then listen for
anything so that's dot on and then the
event is called data and then we're
going to fire back a function every time
we receive some data and then this data
is not called a chunk okay so we read
the file it fills up the buffer the
buffer passes that chunk on and every
time it passes a chunk of data on it
recognizes it because we're listening
for that data event and we find this
function okay so now what we could do
inside here is console.log new chunk
received and then we could do another
console that log and actually log to the
console the chunk itself okay so if I
save that now and run it in node just
have to wait for this to load and I say
node app then you're going to see here
neutral received
okay so we've received a chunk and it's
fired this function on this event on
this data event and then again it does
the same thing down here new chunk
receive so it does it twice so we're
getting two different chunks from this
file it split it up into two and if this
file was much larger then we'd receive
maybe ten chunks or twenty chunks okay
and every time we receive one we fire a
function and we love that chunk to the
console now you see right here this
chunk is just a buffer it's not the text
itself we're not reading that and that's
because we've not specified right here
the character encoding so we can do that
if you want we can go ahead and say
utf-8 because at the minute this is just
a full buffer that it's sending to us
it's filling up the buffer and it's
passing it on but if we say UTF for the
carry
to encoding then we're going to receive
it as that text that we want so if I
save this now and run it through node
again going up we're going to see all
that text and I'd have to scroll up a
long long way to see the neutral
received text because there is
absolutely tons of this but if we keep
on going and the hopefully eventually we
will see it have faith guys there we go
okay so new chunk received and we've got
all these text and there will be another
one of these messages halfway through
somewhere but I really don't know waste
your time or my time by looking for that
so you just have to take a word for if
there will be two of these chunks
receive okay so that's what we're doing
we're reading the data in chunks via
stream and every time we receive a chunk
of data we can do something with that
and you can compare this to the other
method we use to read a file a few
tutorials back which was called FS read
file and what that did was go out and
grab the whole piece of data and wait
for it all to be stored in memory before
it fires a callback function and we get
all the data in one big piece this time
we're splitting it up into small pieces
and the benefit is that every time we
get a small piece of data here we can
send it on to the user using a writable
stream so we can pass it on to the
client that way a bit at a time rather
than waiting for the whole thing to be
read okay make sense so we're going to
see how we can do that by creating a
writable stream in the very next
tutorial any questions about this feel
free to leave a comment down below
otherwise guys I'll see you in the next
one</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>