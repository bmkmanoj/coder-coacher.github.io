<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Django Tutorial #26 - Model Forms | Coder Coacher - Coaching Coders</title><meta content="Django Tutorial #26 - Model Forms - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/The-Net-Ninja/">The Net Ninja</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Django Tutorial #26 - Model Forms</b></h2><h5 class="post__date">2018-01-03</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/jBGmqxpw0V8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay then so we've created our login
form and also our signup form using
inbuilt model forms provided by jungle
now I'd also like to create a form for
adding a new article on this critter
notice a new article page and we're also
going to use a model form on this page
as well so we're not going to hard code
our HTML to create this form
we'll use a model form however because
this is our own model this article right
here it's not built into jungle we have
to do one more extra step we have to
create that model form first of all in
Django then render it in the browser
because a user is an inbuilt model into
jungle whereas an article isn't okay so
how do we create this model form well
first of all in the articles folder we
need to create a new file called forms
py and now all of our model forms for
this article model right here will go
inside this file so first of all we need
to import a couple of things
so from Django imports forms so we're
importing this idea of forms from Django
so that we can create our own model fall
and then secondly from dots which means
the current directory import models
because we need access to our article
model right here so now we've imported
those two things the way we create a
model form is by creating a new class
giving this a name so create article in
our case and then this inherits from
forms which we just imported right here
dot model form okay so we're now
creating this class which is going to
represent our form so in previous
tutorials when we've used built in forms
from Django for example in the accounts
section over here if we go to views we
used user creation form an
authentication form there were just
classes in Python in Django which were
using much like we're creating our own
right here create article okay
so inside this we need another class
called meta
and inside this class is where we define
how we want to output our form which
fields do we want to be present and from
which model did we want to inherit these
fields from so we're taking the fields
from not this one let's crow's close
that it's inside articles we're taking
our fields from this model right here
okay so we need to say that first of all
we need to say that the model that we're
using is equal to models which we
imported which is this file dot and then
article that is the model we're using
now the fields that we want to
oops I wanted to go to a new line the
fields that we want to include in this
form that we want to output to the
browser from this article model right
here that needs to be a capital so what
fields do we have well if we go to
models again we can see we have the
title slug body date and thumb now the
date is automatically added we don't
need to include that as a field for the
user to say when they're posting as soon
as they post it this is automatically
added right so it's just these for the
title the slug the body and the thumb
they're the fields that I want to output
to the browser that a user can enter
into so we want the title comma we also
want the body comma and the slug and
then finally we want the thumb which is
the picture so that's a file upload
remember so that's how simply is we've
created now our model form and now we
can use this inside our views file so
let's close these down inside this views
file when we're using article create
down here we can use this form but first
of all we need to import it so up here
let's say from dots which means current
directory imports forms some we're
importing this file right here now where
we created our model form so now we can
use it down here so inside this article
create function which is fired when a
user goes to forward slash articles
falls Left create what we want to do is
create a new instance of this for
we just created this model form and then
send that to the browser so we can
render it so we'll say form is equal to
forms which we just imported dot create
article so there we go there's a new
instance of this form then when we
render this template article create we
can send that form to it
so start our dictionary then the key
will be form but you can call this
whatever you want and that will be equal
to the farm variable we just created
right here so a new instance of this
create article form okay so now we've
sent that to the template we can go
ahead and open up the template for
create article our article creates and
then inside here we can output that form
so then underneath the h2 let's do our
form tag and the class will be site form
so we can style this later on we'll do
the action and the method in a minute
the method will be post but the action
will be something different now we can
output this form that we've just passed
down to the template okay so this right
here is the key name right here so
without putting that form and all of
those fields that we defined in that
form right here the title the body the
slug and the thumbnail
they'll be output to the browser using
the necessary widgets so input fields or
file upload fields etc so let's just
quickly save this and refresh over here
to see what happens so we see the title
the body which is a text edit text area
the slug and also this thumbnail want
right here so we can choose a file if we
want that's pretty cool right we've done
that with minimal effort so when we're
creating these forms remember first of
all we need to add in that token so
let's use our template tags and then
output CS RF underscore token so
remember that's a security measure to
prevent requests from other websites
sending data to our server so let's save
that now also we need to address this
action thing right here so when we click
Submit and in fact we don't have a
submit button at the minute so let's
create our first of all in
type is submit we don't need a name
property but we do need a value and that
value will be create because we're going
to create an article so when we hit this
submit button right here we're sending
data again to articles forward slash
creates so the same URL that we type up
here for a get request so the posting
get requests are going to be the same so
let us put in the URL for that right
here for the action and again I'm going
to use template tags and URL then in
single quotes article or articles create
remember I'm getting this from our urls
file if we go into that down here the
app name is articles which is why we say
articles first of all then the name of
this thing right here create is create
so that's why we put create after the
column okay so now we're sending our
data to this URL via a post request and
all this is looking pretty fine there is
one more thing we need to do on this
form that we didn't do on the other
forms and that's because we have an
input field what we're doing here is
we're uploading a file to the server and
because we're doing this we need to add
on an extra property on to this form tag
and this property is called
Inc type so the encryption encryption
type and we want to set this equal to
multi-part forward slash form data so
this is for encoding the form data that
is uploaded right here so we need that
otherwise this won't work whenever we
have an upload field we always have this
thing right here so let's save that now
that's our template sorted so now I'd
like to go back to the view over here
and handle what happens when a user
clicks on this submit button because
we're making a post request and this
function is going to fire again
so like we did in other views in the
past we can check for a post request and
the way we do that is by saying if
request dot method is double equal to
posting capitals
we're gonna do one thing and then else
if it's not then we'll do something else
so this must be a get request so we'll
indent that so if the method is a post
request what do we want to do well we
want to take the data that we retrieve
from this form right here
so the way we do that is by saying form
is equal to forms dot create article and
then inside we pass in the request dot
post data so this is validating the data
that we receive on the request object
request up post and it's validating it
against this model form right here much
like we did with the user creation form
okay so there's one more thing we need
to pass in here and that is also request
dot files because when we upload files
that's the wrong way around request dot
files when we upload files they don't
come along on this post object right
here they come along on a separate
object called files on the request
object itself so we need to pass both of
those through to validate both of them
inside this model form ok and then that
instance of the form whether it's valid
or invalid is gonna be stored in this
variable so the next thing we want to do
is check is that form valid are all the
input fields correct as the user created
this article properly so we'll say if
form dots is underscore valid then do
something and the thing we want to do is
eventually save this form to the
database so we'll just put a little
comment right here to tell us to do that
for now so save article to DB and
instead for now what we'll do if
everything is valid is just redirect
them so we'll return a redirect and we
need to import that up here next to
render for it to work so a redirect and
we'd like to redirect them to the
article listing page so in here just
plus in articles and then list that's
the name of that URL okay so this is all
done so let me run you through it if we
fire a get request to this page right
here
articles forward slash create and click
enter then we're going to get this thing
right here and that's because we're
creating this instance of the create
article form right here a blank one
right and we're sending that at the
bottom to this template so that's why we
see in the browser now if we fill this
in and click create then what we're
doing is saying okay well when the
request comes in we know it's a post
request this time so we'll pass that
data into this instance of the create
article perform that we that we made and
we're passing that data if the form is
valid then what we'll do is later on
save it to the database if not then
we'll go down here and return this
template again and we'll pass through
this version of the form that we created
with any kind of validation errors so
the user knows where it's gone wrong so
let's give this a whirl and well first
of all try to create and we get some
front-end validation so let's just
create a new title will say where is
Mario and then in here blah blah blah
slug can be where is Mario and we'll
choose a file for this number two one
let's create this this should redirect
us to four slash articles forward slash
create however models dot forms has no
that's because I've missed an hour out
so it's this thing right here create
article so let's go back and try that
again
refresh so where is Mario blah blah and
then where is Mario choose a file number
to create this and this works now it's
not created that article
it's just passed a validation the form
is valid therefore we're moving the user
on to this article list now what we want
to do is take that article and then save
it to the database but we'll do that in
the next video</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>