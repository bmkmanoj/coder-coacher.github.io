<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Bean Validation 2.0 - you’ve put your annotations everywhere! by Gunnar Morling | Coder Coacher - Coaching Coders</title><meta content="Bean Validation 2.0 - you’ve put your annotations everywhere! by Gunnar Morling - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Bean Validation 2.0 - you’ve put your annotations everywhere! by Gunnar Morling</b></h2><h5 class="post__date">2017-11-10</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/GdKuxmtA65I" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone
good afternoon and welcome to this
quickly talk about in relation to dot o
I hope you enjoyed the conference so far
I know it's a lot of interesting talks
going on so I appreciate to see that
many of you here during lunch my gosh
Lee
my name is gone on walling so if you
checked the program long time ago it
said in my new I Bernard would be here
but unfortunately he could not come so
I'm taking his place I hope that's ok
for you folks let me quickly tell you a
bit about me I work as a software
engineer at Red Hat and the project I'm
focused on mostly these days is called
DB z 'm which is a change data capturing
platform and if you would like to learn
more about that one i did to talk about
it yesterday and it should be up on
youtube on a devil's trainer so you can
find out about DB zoom and what it is
about
i'm the spec lead for bean validation to
the dough which is the stuff I'm going
to talk about now and finally I'm doing
some other projects on the side which I
also did some quick he talks about your
demos ok be in relation to that also
it's going to be a lot unfortunately but
I hope it gets across alright so what is
it about it's about supporting Java 8
and taking advantage of Java 8 for the
purposes of validation so we create the
new jsr 380 and if you wonder why it is
a new major version to leto this worried
is the reason that we found out if we
cannot take advantage of Java 8 in a way
which then would you allow to use this
new version with earlier Java versions
so we found out ok we have to make this
Java 8 only and that's why it's being
relation to dot o and I would like to
present some of the new features in form
of use cases which you will typically
encounter in the context of validation
and we will see how we benefit from
being validation to and halite and the
first one is validation of passwords and
more specifically you would like to make
sure that depending on the role which a
user has in your implication different
lengths should be enforced for their
password so a regular user should have a
password of length 8 where as an
administrator should have a password of
links length 12 and the way you do this
in Vinnie Edition is you specify a
constraint advice in this
case multiple times and as I attend
different validation groups and before
Java 8 you had to specify this list
annotation explicitly where is now we
can just write those constraints those
annotations right after each other
multiple times which is possible by
means of the new repeatable annotation
feature in Java 8 so that's not
something super exciting but it's just a
very nice
readability enhancement I would say it
makes it a bit more pleasant next use
case would be when a dating collections
and here the example is I have a list of
names a list of strings and I would like
to make sure that this list does not
contain any empty strings so each
content each string should be a non
empty string and I could think about
such not empty annotation and indeed
there is such a constraint now and being
evaluation - but if I specify it here on
the list it will apply to this list so
this means the list itself it should
contain at least one element it doesn't
say anything about the strings within
this list whereas now if I put this
constraint to the string type argument
the semantics change and this is
possible by those new type annotations
in Java 8 which essentially allow me to
put constraints in many more places and
use annotations of many more places and
one example is type arguments of generic
types so I put this constraint here now
and now it's getting clear this applies
to the elements of the list the strings
within the list not the list itself I
could have multiple constraints so here
I'm saying each contain name should be
non-empty and it should satisfy this
regular expression and I also could
combine it of course with the not empty
constraint only listed there so this
means the list should contain at least
one element and each string should be
non empty string we also benefit from
the type annotations for the purposes of
what we call cascaded validation this
was something which always existed in
being validation it means you can
traverse into an object graph and
validate all the constraints on your
entire object graph by means of this
edit annotation so this is how you would
have done it before in emulation 1 and
this is how you can do it in bean
validation too so you can put the edge
weld annotation
now to this type argument again and the
semantics of this are pretty much the
same as before I would just say it's
getting a bit more apparent that this
applies to the constraints which are
defined on the address type but pretty
much it means the same as before it's
getting more interesting if you think
about maps so beam radiation always had
support for maps and the validation of
maps but only for the validation of the
values within a map varies now I also
can enforce the Cascades variation of
the keys of a map so here I'm saying if
this map gets validated please also
validate all the constraints which are
on the comment key objects in this map
again I can combine it with validation
on the only way or even nested
collection so here I'm saying please
if addresses by type if this beam which
contains this property gets well it did
when it did all the constraints on the
address types which are the keys here
and then for all the lists of addresses
for all the addresses within those lists
please validate their constraints of
course you would not do this in a much
deeper level probably you would
introduce some sort of intermediary type
but being validation nets to deal with
those cascaded collections there support
for other types of Java eight has this
new optional type which you would use as
a return type for a method which might
return a where you or not so here I have
this get in a method which may return a
string and if it the way it was present
it should be when it email address so I
can express this by putting this new at
email constraint to the type argument
and we also have support for all those
JavaFX
property types so let me just quickly go
to the Eclipse IDE and in Java FX what
you do is you don't work with the normal
property type such as int or long or
string and so on but instead they have
their own hierarchy of property type so
you have something like string property
or property of something list property
and so on and now we can put all the
bean validation constraints also to
those JavaFX property types and just to
show so this is just a simple example
with a simple entity a simple model and
some properties but let me run it for
you so you see this at least in action
so this just is a simple dialogue and I
what by the way a member of to be
Malaysian export group has created this
demo and validation is kicking in now as
I type here the entity error message is
bound to this to this label here and for
instance this one it must be very
greater than 50 so if I move the slider
beyond 50 the error marker would go away
so that's quite nicely and quite easy
for me to put validation now to JavaFX
models alright that's that and of course
we cannot know as spec people we can't
know about all potential collection
types out there right so you could think
about libraries such as goo-goo-goo OVA
which define many very useful collection
types so they have something like a
multi map or like a graph type like a
table table type and of course it would
be very nice to be able to use
constraints on those collection types so
for instance here we have this table
type from guava which is like a two
dimensional spreadsheet which associates
away.you with a key in the row and now i
would like to say okay devalue the
revenue where you per you in category it
should be a positive number so there's
this new positive constraint and i would
like to apply this to the values in this
in this table and as i said we cannot
know about this but then we have to find
an extension point in spi for this and
this allows you as users or also a
library offers as the goout folks to
plug in custom what we call where you
extract hers in such a way extract with
them is in charge of getting the value
from the table here and feed it to the
bean validation engine
another use case for this extension
point is other languages so if you think
about languages such as Ceylon or Scala
which have their own collection areas
which are independent from the Java
collection areas again it would be very
nice to put constraints to those
collection types and again implementing
this SPI would allow to do this just to
give an example how such a way extract
would look like all you have to do is
you need to implement this where you
extract your interface it has a single
method which receives the container to
extract the values from and it receives
a callback which you need to call to
emit all the values from this container
so here we are just iterating over all
the cells which are on a table and we
call this keyed where
your method to make sure that the error
message or the constraint violation
which would which result in this
constraint being violated it has a key a
reference to the key of this table cell
okay next use case would be in your
ordering order management application
you would like to make sure that the
delivery date is in the future and if
you have been working with bean
validation before you will know that
there are the EDD past and yet future
constraint and they are still there of
course but now they are also also
supported for all those new date and
time api's which have been added in Java
it so there's J's or 310 which defines
many very useful times such as low good
day time zone day time and so on and
those constraints are now supported for
all these types and we also added two
new constraints future or present and
past or present and they are very useful
if this is about validating some type
which does not represent a particular
instant on the timeline but rather
arranged so like an entire day or an
entire month the entire year and this
future are present here would Express ok
this delivery date it should be
satisfied it should be valid if the date
is either today or in either now or in
the future as of today ok um
yeah we have added some new constraints
you have seen some of them already so
there is not empty not blank for Strings
we have edema which I think was the one
which has been regressive most of the
times there is positive positive or 0
negative negative or zero which deal
with a number numeric types and there
are those two past present and future
present and in case you or you might
wonder how did we decide which
constrains to attend we try to be very
inclusive with the community here so
what we did is one member of the expert
group went to get up and analyzed
essentially all the Java projects on
github and search them for custom
constraints so what our custom
constraints which are not defined by the
beam violation spec which are used in
project outer and apparently obviously
they would be good candidates to add and
then we had some sort of candidate set
and we did the survey on bean validation
dot-org our website
and arrived that we add those
constraints which we added just one
thing to mention about email so this is
this annotation type is defined in the
spec but if you what we've found is it's
nearly impossible to give a well it
definition of an email which would be
generally applicable so for different
people where that email address could be
something very different so we decided
okay we add the annotation type so you
can use it but then we would leave it to
actually implementations such as hybrids
where they tore the reference
implementation to implement this and the
particular semantics of this one to try
it out yourself this spec is finalized
it's part of Java e8 which has been
released a couple of weeks ago so you
could for instance use to Java if Java
e8 reference implementation class 55 and
this will be part of this already and
the reference implementation is hyvent
where they transics and so we also did
the release of this of course a final
release and since then we actually put
out multiple micro releases which four
ones contain many good bug fixes but
almost more importantly we spent quite a
good amount of time on optimizing the
performance already good thing is in
relation to and the reference
implementation is oftentimes much faster
than the emulation one and the old
reference implementation if you happen
to use wide fly it's not part of white
flight 11 yet but what we do is we
provide a patch file for you which makes
it very easy to get time and where later
beam radiation the new version and patch
an existing wildfly instance with that
so it would then be using bean
validation - ditto if you are more like
a spring kind of person spring 5 also
supports beam radiation to that Oh so
it's something you can work with and one
thing which is very close to my heart is
and everything is open source here so
the spec is open source it's written in
ASCII doc the API is open source in TCK
the test kit is open source and you
might have followed the news around
e4j and all the open sourcing of java ee
so essentially this is happening now for
all the specs for all the Java EE specs
but I'm really happy to say that bean
validation has been fully open source
from day one so if you got something you
think should be added to the spec
well you can essentially come to us and
contribute and have first discussion and
finance and a public rest with that I'm
done
AB invitation dot orc that's the central
hub with all the information about being
validation all the source code of the
API and the reference implementation
everything else is on github and yeah
for instance you could come and explore
a new feature in the reference
implementation first and then we could
think about making this a new official
feature in a potential future version
with that I am done and there would be
one minute 30 seconds left for questions
if there are any any questions okay you
seem all overwhelmed I know it was not
okay otherwise I would say enjoyed rest
of a conference and if you got something
just come to me Ming can have a chat
here thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>