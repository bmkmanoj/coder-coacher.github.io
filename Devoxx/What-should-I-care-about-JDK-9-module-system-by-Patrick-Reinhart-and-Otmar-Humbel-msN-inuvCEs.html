<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>What should I care about JDK 9 module system? by Patrick Reinhart and Otmar Humbel | Coder Coacher - Coaching Coders</title><meta content="What should I care about JDK 9 module system? by Patrick Reinhart and Otmar Humbel - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>What should I care about JDK 9 module system? by Patrick Reinhart and Otmar Humbel</b></h2><h5 class="post__date">2017-05-12</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/msN-inuvCEs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hi there so my name is Patrick try not I
work for bees on small company in Center
located in central Switzerland working
mostly for Pinnacle company the graylien
sector yeah with known as Foulke Lundy
and all those parts and my talk with
audio booth yes I work in the same
office with him and we have a few
million lines of code and currently I'm
JDK 8 and we would like to migrate to
take a nine we have already started so
what was you saying tell you we got
old-style cloth paths and we want to run
our application on JDK 9 so that would
be one part of the agenda what you have
to do or what have to be caution off and
the second part would be if you took
every part and you got it running on the
class path again and you're brave enough
go further in direction of the modules
what you may have to look out thank you
again we won't really want to have
modules to encapsulate our code in
different parts but let's stay on the
class of first it's like every tower
developer did from JDK 5 to Teddy K 6
from Cheney KC
7 to 8 just plugging the new Teddy K and
run because Java is insolvent and wrong
forever
and by the way works in the past so what
possibly can go wrong well use some
internals by the way now I never did I
die you're talking of how do you never
know that Scott swing wanna have windows
look and feel oh yes we have Oh hmm
maybe not a good idea
reverse does a library that you use uses
internal api's oh no idea how did I find
out well I mean if you catch away you
may heard about some compiler flags
which show you already duplicated
methods or classes that you shouldn't
use and how we remember Sun and Oracle
they all always told us to not use
typically it's tough but you know how it
is when you got chicken children we told
them do not use this one low do not make
that one to the heel of you to you
sometimes sometimes but if you do
something which is not allowed the
forbidden quite nice to do but this tool
will help you to find out not another in
your own code you can scan all the
libraries you got and it lists out all
duplicate stuff which is in there let me
show you an output small output of
library that we use in actual production
okay this is a PDF printing library it
helps to directly print PDF to the
printer
and we run ted-ed on 10k 8 on it on the
latest version of this library basically
yes and what you see there hmm
we see internal API now not it gonna do
it's just Intel well closed path the
hearth this one unnamed module should
work I guess
ready Keitel tells me listen let's have
a look what JDK 9 tells us with J tips I
will yeah let's see well still internal
API but Oh removed what does mean I
think they really removed the base64
encode well what are you gonna do that's
a library I don't control that's even a
library I paid for so no test I guess we
have to contact those people by the way
that's only one library we got a lot
more and this output goes over and over
and over it's quite a pain so you have
to go to overcome this first before you
even think about modules all has nothing
to do with models at the moment just run
the application and it will it will
crash because the base64 encode is
simply not there is a replacement of
course it tells you at the bottom line
use Java till obey 64 but if you don't
control these codes
somehow host sorry you're somehow lost
so we could cheat a little bit we could
create an own char file create such a
class like some risk based in code
delegate to the real one that exists in
our name module could work but one hack
replaces another so you have to wait for
your library supply it to give you an
implementation that is not using this
and having an output from a JDK 8 or JDK
if you see that you could replace it
with a JDK 1.8 feature maybe helps them
they can already fix it for you without
migrating themselves to JDK 9 that's
good news so let's go a little bit
further so all internal solved now we're
ready if you don't use any X using your
action I use reflection a lot but just
to find out if this method is there and
if it's there I call it if it's not that
I don't call it what's the problem
this should be a problem if the clothes
not tell you don't want to find if the
methods are there you will find them if
you only call public methods ok
absolutely no problem the problem starts
if you do some special tricks like gain
gaining access to private protected
non-public no no I never do that I never
how about you do you use that accessible
on private
yeah absolutely so as long as you live
in the classpath and you put them all in
the class buff no problem if you don't
call any java classes and internals from
java without special we influx it won't
work
or as we showed before if you use a
cloth that's no longer existing your
problem did I get that right if I can
use reflection all over the place the
only thing I cannot do is reflect on
private internals of the jdk as long as
you're in the class path okay I'm still
on the class path I'm still on the bus
but as long as soon as one library uses
an internal field or method from a JDK
class it starts to hurt break sorry well
summary what we talked we had class past
usages so for the and we speak in
strictly for class path you still you
can use Jade apps to analyze potential
problems in advance
beginning with Java 8 you got already
some means some hints but as you know
you know you cannot predict the future
so it will only show those parts that at
the time when Javed came out duplicated
and then you somehow that it's our
internal that show that will be shown we
don't see any classes which has been
actually removed in Germany so we were
to suggest you use JDK 9
Jerry Depp's tool to analyze the code
that I have at the moment and all your
libraries you got at the moment that
will show you exactly which things are
have been removed which parts have
replacement already it will show you
also replaces which exists only a tragic
actually k9 so those parts you have to
update when charity k9 actually comes
out to work around the problem Odin and
John run it run it now on your
application you you will be surprised
about the output it's good to have a big
monitor see all those stuff that can go
wrong and stuff like this base64 encode
and I have to replace somehow there's no
way around it and the external libraries
have to be fixed as well and if still
the whole thing still breaks and they
don't know exactly and you just want to
have the application start at once just
to find out which package you have to be
open intelligence which you can say well
this package there I going to open it
for reflection use that you can use the
so-called kill switch but it comes at a
price
that's the soma of the brave new tower
Teddy canine world permit illegal access
and you're done well it comes with the
price and the price is a lot of locking
on the console if you do that on on each
call it will be locked on the console to
really bug you that is gonna go down and
either at add opens and open this
specific package tool on to the Omni on
nominal module or do something about it
by replacing it with a support API
well I think clasp or Jack belong to
real modules so if you are really in
that stage and everything works and you
happy like a camper let's see what could
go wrong now when you try to convert
your code to a module but one word of
warning the crystal ball is there we
don't know exactly how the module system
will work out it's still in flux
I think so what we tell you is stuff
that we think will stain yeah one is for
sure there is a problem with so-called
split splits packages here you see two
libraries from our code it is you a
package name underneath there which
exists in both libraries and this won't
work with JDK 9 when you want to convert
them to modules sidenote trade EPS
also when you scan for JDK internals
will show you split packages offending
packages with comes with which comes
with JDK 9 there you have already
outputs let's say you know you know
closer tried a lot of external stuff
which which are in libraries as well a
copy of them XML API for example so you
see that that comes with your editor and
it will come with this life as well
the solution is remove that library
which is a TK 9 and everything works
this fictional API is additional library
can throw away even if you use JDK 9 but
you see that's just one example that you
have to get rid of before you convert
them to module we we have written an
tools for the split package
scanning and we ran it against our code
and the dog file is really impressive so
if we will show you everything there
would be a big ball of arrows and texts
and yeah it's quite a bit of work our
code has evolved over 20 years and many
refactorings and we moved stuff from one
jar into another jar and for backwards
compatibility we had to keep the package
name so there's a lot of work ahead your
code may be better in a better shape I
hope flower is almost 20 years old and
what you expect and also side note if
you have not you which is already module
and that would produce and package a
split package issue just for example via
cata external library overheat that is
you on top which offends module which
comes which is in a package within
release which is within the JDK as you
can see here so the same thing can
happen if you would use an external
module not from a cherry decay and you
have somehow the same packages in one of
your modules or even worse if you have
two external modules which in common
have to the same package by accident or
whatever you re involved one start so
that you have to all come also in the
first place and there are a lot of
things that still in flux and we cannot
actually tell what in the end will come
out to requite some discussions like
ultimate modules how they should work
and there are some jelly X there if your
library developer and
you have dependencies on also other
modules which do not exist at the moment
so we if in that topic we don't go in
details now so just bring your
application to work on to the class part
I think is quite a big hurdle already so
and we will tell you next year if we
have made it for our application we are
not there yet
it won't start so I'm not sure if you
don't leave it if it there next year as
well what we're going to try so and we
have put up here some links on this for
this split package scan the tool to find
out what kind of package conflicts you
have already in combination with
external libraries it's on github you
can do this give as more input as well
with what's not working there is at the
moment it doesn't take modules into
account and also besides the JDK itself
that we have to extend later on but for
info for the first run it gives you try
decoding on how many split packages you
got in your codebase then there is the
second one is a small repo showing some
of the stuff we told you we demo access
to private stuff in and so on - deleted
stuff and the nice thing is you can run
it on Teddy create everything past is
Teddy canine boom nice demo effect some
links to read if you want to read books
and both books are still in our early
revision so only their first few
chapters are written added to us reading
that's it basically just almost in time
any questions
maybe - I personally think it will be
useful and maybe I don't see the
low-level details the pros and cons but
to modularize my system it will be very
useful because I can restrict access for
my consumers which today can access
everything if all the formal process to
say if the park is it a package called
internal don't use it but in in the
first place we would be happy just to
have it running on the JDK 9 so that's
yep unfortunately they are key if you
just wait what will happen then some
sometimes JDK 10 will come you want to
jump to drain as I'm computing so that's
my my my feeling just jump on the train
when you are ready I'm not too late
yeah
as if we had something like the module
system and we could restrict packages
from not being used and that have
studying if that enforced by the VM bite
itself we had yeah yeah even even
internal we have like a framework part
and we have an application developer
part for the yacht's of to just even
then if you have a big a big a product
like it's like a CRM application that we
develop you want to restrict certain
axis and wanna direct it they use it to
just use what the really public API
parts but you somewhere you have to put
the logic behind that you don't want to
give away a just just like that and put
everything in one big package is also
another solution just to have package
protected or default access you're
welcome</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>