<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Image Optimization. The “how to” by Jon Sneyers | Coder Coacher - Coaching Coders</title><meta content="Image Optimization. The “how to” by Jon Sneyers - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Image Optimization. The “how to” by Jon Sneyers</b></h2><h5 class="post__date">2017-05-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/MuH0wBX8uHs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Birgit make it do it makes it welcome
everybody to my quick talk about image
optimization and how to do it so just
little slide about me I am from Belgium
I work at Cloud nari which is a image
management solution and to end we manage
about 15 billion images we do thousands
of image and codings per second and so
we are kind of experienced in dealing
with images it's what we do
I'm also one of the guys who invented a
new image format called the free
lossless image format so why does image
optimization matter
well 65% of an average website is images
in terms of bytes and moreover most of
these images are part of the content of
the website just like the HTML so unlike
say the style sheets or the JavaScript
or their forms which I think that don't
change very often images do change very
often so there's not much opportunity
for client-side caching of it so a lot
of the bytes that get transferred and a
lot of the things that slow down your
website or your mobile application for
that matter are images so if you're
optimizing things it's the first thing
you should look at so there are
different kinds of images and one type
of images is vector images which are
scalable by design so these kind of
images consist of drawing instructions
drawing lines drawing curves
maybe filling them with some color and
this type of graphics can be scaled to
any display resolution because they
don't have the concept of pixels so this
is very suitable if you have your
material in this representation and you
can use an image format like SVG
scalable vector graphics which is
supported by all browsers so if you have
material like this and typically it
would be things like I
guns texts or plots
maybe drawings or logos stuff like that
it could be a very good idea to use it
however a lot of the images we deal with
are not of this kind and you cannot just
convert any type of image to a vector
image so most of the time we are dealing
with rasterized images pixel images
they're based on some rectangular grid
of pixels which is also what your screen
does and every pixel has some numeric
value for the different color channels
typically red green and blue so this
representation can be used for any type
of image not just logos and text but the
main downside of course is that it's not
scalable I mean you can always scale
down an image reasonably well but
scaling it up is going to look blurry at
best so I will focus of course on pixel
images and I will talk a bit about
different kinds of image formats that
are available so here is a timeline more
or less of the internet and of image
formats for the web so the boxes in red
are pixel image formats the ones in
green are vector formats and let's start
with the ones
everybody knows which are jpg PNG and
gif or gif I don't know so these formats
are universally supported you can use
them in any browser on any platform so
that's the main benefit of these formats
Universal adoption let's start with the
oldest one which is gifts dates back to
the late 80s still currently the only
universally supported format for
animated stuff so if you have something
animated I want it to work everywhere
the only option still sadly is gif okay
either way it's limited to a palette of
only 8 bits of colors so 256 colors and
it's limited in terms of transparency in
that you can only have fully transparent
pixels or fully of park pixels but not
semi transparency so these limitations
mean that you cannot really represent
colors very well so you will have to do
some kind of color quantization color
dithering
which will make your images look worse
but within these limitations it's a
lossless image format so there's nothing
lossy going on except of course maybe
you have to first reduce the number of
colors
jpg on the other hand is by design a
lossy format and it's specifically
designed for photographic images so it
doesn't support transparency because
your camera doesn't produce transparency
and it's always lossy even a quality 100
JPEG is going to be slightly lossy one
of the neat features of JPEG is that it
supports progressive rendering so which
means that if you are loading on a slow
connection JPEG file which has
progressive rendering it will look like
the image on the right which gives you a
decent preview of the full image very
quickly this very beginning of the file
already gives you a nice preview whereas
if you have a non progressive jpg it
will load from top to bottom which means
and on a slow connection it can take a
while before the bottom part becomes
visible so the progressive one is
incrementally refining the quality of
the image but you can see it already
looks as if it is completely loaded
while it's actually still loading at the
moment but you cannot really see that so
it's going to stop loading now yeah the
progressive one is slightly smaller than
the non progressive one that's typical
so I recommend using progressive jpg but
there is some country
see not everybody agrees with me on that
but I think it's usually a good idea
then there's the PNG file format we
thought it was designed to replace the
gif format mostly because there were
some patent issues with give it does a
really good job at replacing gif in the
sense that it offers better compression
than give it does have support for semi
transparency and full color but it
doesn't support animation sadly so in
that respect it doesn't replace gif and
that's probably the only reason why give
is still around today there is an
animated variant of PNG called a PNG and
it is supported in Firefox Safari and
Chrome so it is starting to become more
and more of an option it's only recent
versions of Chrome so not yet so how to
pick the right image format well the
first question is does your image have
to work on all browsers so if it doesn't
have to work on all browsers you can do
much more interesting stuff but if it
has to work on all browsers then the
first question is is it in animation or
not if it's animated you have no other
choice than to use gift if it's not
animated then there's no reason to use
gif if it has transparency then again
you have no other choice than to use PNG
because JPEG doesn't support it but the
bulk of the images on the web are still
images that are not using transparency
and in that case it depends on the kind
of image which format is right if it's a
photographic image typically JPEG will
be the best choice if it's non
photographic PNG might be a better
choice so it is a bit tricky to make
this decision automatically but this is
more or less what you would have to do
okay so those are the University
supported formats now let's look at some
of the more recent formats that do not
have universal support
so let's first look at these so if you
look at the support table
none of these formats have universal
support you have JPEG XR which is
supported only on windows JPEG 2000 only
in Safari and then there's web B which
is supported on chrome and Android in
general also and it's probably going to
be supported soon also in Firefox and
hopefully in Safari so it is starting to
get more adoption and then there's some
even newer format that haven't got any
browser support whatsoever so JPEG 2000
is a improved version of JPEG it add
some missing features like support for
transparency it has a lossless mode
supports higher bit depth for more
accurate color representation sadly it
didn't really catch on at least on the
web there are some niche cases where it
is quite popular like medical imaging
but on the web it's not used very much
and of course that's mostly because only
Safari is supported JPEG XR more or less
the same story it's an improvement of
JPEG also supports transparency higher
bit cut slightly better compression than
JPEG but the difference is not that huge
and it's only supported in Internet
Explorer so quite similar to JPEG 2000
in the sense and then there's web B
which is a really interesting format it
was developed by Google it's based on
the web M video codec so vp8 which means
that it has some limitations but usually
it's superior to JPEG in terms of
compression quality so it's highly
recommended format and it comes in two
variants as the lossy variant
which basically improves upon JPEG add
support for transparency and so on and
there is a lossless variant which is a
replacement for PNG and is tends to be
superior to PNG it also supports
animations which can replace give and
then there's some even newer formats I
won't go into much detail BPG is based
on h.265 the video codec it is currently
the best available formats in terms of
lossy compression so it will give you
the best quality for a given file size
sadly it has some patent issues and it
has no browser support so it's not
really practical to use right now except
maybe in an application but not not on
my website I guess and then there's the
free lossless image format same
situation no native browser support but
it is a muslim' format and it's
currently the best available option for
most less compression and it doesn't
have any patent issues so just some
brief words about responsive web design
ten years ago it would be acceptable to
have websites like this and actually
this is an example from last week so it
you can still find this kind of website
where you design the website for a fixed
viewport width and you just say to
people if you don't have this screen
resolution it's your problem that's
today no longer acceptable we have a
variety of devices which people use to
browse the Internet people are viewing
websites on very large televisions they
are viewing websites on phones and on
smartwatches even so the variety of
screen resolutions is becoming huge if
you look at the top statistics of screen
resolutions you can see that the most
popular resolution is actually
smaller than what used to be common ten
years ago just 640 by 360 but bit down
list you get full HD or maybe even
higher so it's a huge range of
resolutions so the question becomes how
to deliver the right image to the right
person because you cannot actually give
the same image to everybody it doesn't
make sense to send the 4k resolution
image to a smart watch so you have to
make sure that your images get the right
dimensions in terms of resolution taking
into account things like DPR but you
also have to take into account the
physical size of the device if you are
showing an image on a very small device
you might want to zoom in to the
interesting bits of the image not show
the entire thing down scaled so you'd
need to do some kind of cropping usually
to deliver slightly different variants
or the same image to different people
also you have to take into account the
browser and the capabilities in terms of
image formats so you can make use of the
best format that is available and in the
near future there are going to be other
ways in which different images are going
to be served to different people for
instance wide gamut displays are
becoming more and more of a thing and
you might want to send different
versions of an image depending on this
as well and finally banquet
considerations are also important to
take into account so in order to deliver
the right image to the right person you
need to make a lot of variants of your
images and doing this manually is it's
basically becoming impossible so one way
to solve this is to use dedicated image
service like cloning which I work for
and basically you just upload your
original images once in the highest
resolution you have available and you
let the image management service
do all the rest so convert it to the
right sizes automatically crop it
automatically select the right formats
and so on and so on
so to summarize just few take-home
lessons images are incredibly important
for the performance of your website and
mobile application but it's tricky to
get it right and you probably don't want
to spend too much development effort
into trying to solve these problems
yourself and reinvent the wheel so I
would just to automate this process use
one of the existing services to take the
hassle out of it and let people who know
what they're doing do that thing but
just my suggestion any questions yeah
the controversy is mostly about well in
a progressive jpgs you first get blurry
version of the image and it gets better
and better and according to some people
this game can give you a bad first
impression of the website because it
image looks bad and you don't wait for
it to fully load whereas in a
non-progressive you see the image load
so you know the pixels you can see they
are at the highest quality already so
it's a psychological psychological issue
I guess but there are some different
opinions about what is best and there's
also performance things like progressive
jpgs take a bit more memory to decode
but I think most people would agree that
progressive jpg is the right thing to do
any other questions
stripping metadata eyes is obvious but
while in lossy compression there's many
ways to compress an image you can select
quality settings but there's various
knobs you can you can turn and so what
we try to do is automatically find out
which quality settings can give you the
smallest size in terms of bytes but
still give an image that looks good
because you cannot just save everything
as say quality 70 JPEG that's not going
to work some images will have artifacts
while other images they might look fine
as a quality 50 JPEG so it depends on
the image and you need some clever
heuristics to to figure out what kind of
how far you can go basically yes yep
yeah and so the question is what about
the the cropping zooming into so we also
have algorithms for that so for instance
based on face detection and other kinds
of heuristics we zoom in on the parts
that are most likely to be the focal
area of the image so you can
automatically crop without you knowing
in advance where you want to crop we can
figure out what part you want to keep on
what if you want to crop out yeah yeah I
don't know about pricing well
technically I think we have the most
complete solution so we in terms of
functionality we have most the most
features like the automatic quality
selection the automatic cropping I think
we have much more advanced features in
that respect and what image exists to
offer for instance but yeah I'm not
saying you have to use us I'm just
saying don't try to do it yourself
because it's messy it's difficult and
you will waste a lot of time reinventing
stuff and re-implementing things in a
probably less scalable and less robust
way because there's all kinds of issues
especially if your user uploaded images
there is also security risks involved
maliciously crafted input images and so
on we had the image tragic problem some
time ago so it can be dangerous to do
your home brew solution stuff
okay thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>