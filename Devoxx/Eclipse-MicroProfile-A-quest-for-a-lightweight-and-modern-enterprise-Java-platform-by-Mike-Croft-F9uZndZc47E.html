<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Eclipse MicroProfile: A quest for a lightweight and modern enterprise Java platform by Mike Croft | Coder Coacher - Coaching Coders</title><meta content="Eclipse MicroProfile: A quest for a lightweight and modern enterprise Java platform by Mike Croft - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Eclipse MicroProfile: A quest for a lightweight and modern enterprise Java platform by Mike Croft</b></h2><h5 class="post__date">2017-11-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/F9uZndZc47E" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right thanks everyone for coming so
this talk is titled it clips microphone
file a quest for a lightweight and
modern enterprise Java platform so the
the kind of thrust behind that talk
title is really kind of a reference to
some of the criticisms that have been
thrown at enterprise Java in the past
that it's not particularly light or
particularly modern and really that's
where my profile come came from so
that's the kind of context that I want
to do this talk in there's a lot to
cover because there's been a lot that's
been happening my profile is a very
fast-moving project so I'm hoping to do
is cover as much of it as I can
potentially if there's time there'll be
a demo it's not crucial to the talk but
it'd be nice to show you some things as
well so we're going to talk about is
first I'll cover what microphone is as a
project why you should care about it
next I'll look at how do you get it
what implementations there are and all
the rest then I'll give an overview of
what API is you get and then finally
that the biggest part will be how do you
use them so I'll kind of look at each
API in turn a little bit of the features
that you can get from it and hopefully
inspire you to get started with micro
profile if you haven't already so at
this stage can I have a show of hands
who's heard of the micro profile project
before ok so hands up people who just
don't really know what it is at all ok
good
so I'll I'll talk a little bit about
that bar hopefully won't spend too long
on it
so micro follow this heart is a
collection of API is in the same with in
Java EE is a collection of api's it is
focused on but it is far from limited to
micro services so the inspiration behind
most of the API is has been deploying
things into a micro service architecture
but many of the API is you can just use
in any sort of cloud environment and
we'll see that as we go along as well
it's a place for innovation so again as
I said the one of the main things has
been thrown at Java the language as well
as Java EE for instance is that it's
slow to innovate most innovations come
from things that have been well
established then get folded into the
main project for stability reasons so
microphone is a place to try new things
have a look at what works give
developers the tools that they need to
operate in the modern world and then see
how quickly we can develop these things
and push those into a more stable
supported platform and finally it's
community driven so I'm going to talk a
little bit at the end about how everyone
in this room can get involved either
just as an end user you don't have to
contribute if you don't want to but the
the bar to contribute a microphone is is
set deliberately as low as possible so
everyone can have a voice in the
direction of microflora file so what
should you care I think it's it's really
important to be involved in the future
of enterprise Java if you are a user of
it in any way against it for a third
time things have been perceived as slow
in the past microphone is designed to be
fast so there have been three releases
since it started so far one of the specs
that has started purely in microphone
file has already had a second release
and there are maintenance releases
already going on and another three they
are in development so if you want to
help shape the future and direction you
can get involved now and maybe due to
your influence you'll get to see some of
the tools that you want to use in your
in your day jobs and generally just as a
user for your application so I did a
talk Java one earlier this year where
one of the main points I made was that
between Java EE 7 and Java 8 you might
think that nothing has happened but
there have been tons and tons of
innovation has happened as a result of
vendors that's across all of them so Red
Hat IBM
we drive an anti arrow we've all kind of
come up with new ways of doing things
aside from just the specs so the tech
landscape is changing and changing
rapidly and microphone file aims to give
you like a new toolbox to take best
advantage of all that stuff so how do
you get it this is just a list of
implementations of the pyro micro is
that the pyro one Tommy you've got their
implementation so a lot of the Apache
projects that are going to be folded
into there I'll talk about that a bit
later as well well if I swarm is Red
Hat's implementation open Liberty is
IBM's now fully open source
implementation they've got a booth
downstairs I'm sure that he happy to
tell you more about that I know actually
on a micro profile perspective they've
got a very good guide online that shows
in depth how the circuit breaker pattern
can be used and I really would recommend
checking that out on Open Liberty dot IO
community is a small java re'
implementation so they've I think
managed to implement all of the
microphone specs except for JWT the last
time I checked a couple of weeks ago
maybe they've done that since
and finally hammock which is a CDI based
rest micro services platform and hammock
I think influenced all of the microphone
specs so a PFD gets with microphone 1.0
all of the ones that you see over there
in Orange were released now that's just
CDI JSONP and jax-rs at the same level
as Java EE 7 so the idea there was to
pick the three most minimal set of apos
that you could use to develop a micro
service on it was deliberately as small
as possible we didn't want to kind of
guess at a few other things we wanted to
start with a really really minimal set
and then adapt as we went forward and
the one in bright blue their config 1.1
that was the very first API that was
completely developed almost in-house you
might say in the microphone for project
that involved people from IBM from red
hat from payara
from the community
from Apache as well and I think it was a
big success I've really enjoyed using it
myself I used it in a couple of demos
already and currently in the current
release that's already had a further
maintenance release which is actually
want one-pot wonders introduce a small
new feature that I'll mention later the
paler blue ones are the second set of
apos that have all been introduced in
1.2 that's a health check which allows
you to see whether a services up or down
metrics which gives you specific details
about things that you care about in your
application full tolerance which
implements fault tolerant design
patterns they might be familiar with if
you've looked at any of met flicks is
open source libraries and JWT
propagation which is about kind of
security token exchange now in the
future these are the things that are
coming the diagrams there are a little
bit old so the current target from
microphone 1.3 just targeted to cue 4 so
you know I think the end of this month
perhaps there is open tracing 1.0 open
tracing is an open standard that's
implemented by things like zip kin or
Jaeger if you ever used any of those to
do distributed tracing among micro
services or disparate systems that's on
its way it's being developed at the
moment open API some of you might be
more familiar with as swagger so again
we've got people from the open API group
I think smart bear she wanted to join
microphone at one point I think they've
already made that announcement and
finally the type safe rest client which
is not on the picture there which is
just a type safe way of consuming rest
services so that'll be in hopefully in
in 1.3 no microphone file is a time
boxed release so if they're not ready
yet they won't make it in and I'll just
get pushed back to the next release what
will happen though is my profile 2.0
which is effectively just bumping up the
version
of all of the Java EE 8 inherited specs
and unfolding in the Java Yates Jason B
spec it's already been kind of decided
and agreed that that's going to happen
and I think the current target from the
Google Group was q1 next year so we
should see that very very soon other
things that we'll see as well is just
maintenance releases so in implementing
a lot of these specs there are certain
kind of small changes that needed to
make to the TCK or to the spec document
to fix typos and things so those will
happen in maintenance releases as well
and yeah just to underline that fact
that's all unconfirmed at the moment so
let's dive right into the actual api's
this is config 1.1 and most of this
really will apply to 1.0 as well so just
an overview this API was originally
developed so that you could inject
config values at runtime so the use case
for this would perhaps be moving from
development to a test to a prod
environment maybe you wanted to include
particular settings in your CI system so
perhaps Jenkins could set some system
properties and then you could inject all
those at runtime it is not a registry so
this was something that I tried to use
for a demo then asked the guys about how
I would implement it where I basically
wanted to create a few micro services
but if I didn't know ahead of time what
the URL of my dependent services would
be could have then write them to the
conflict source and then read them from
my other service that's not how it works
values are read only by design but you
can specify your own config source and
by specifying your own config source you
can implement a method to set a conflict
value that's perfectly okay that's
perfectly acceptable and there are
built-in ways for you to do that so the
reason why it's not included in the
actual config API itself is because it
kind of
leaves the scope of configures it's more
for a service registry rather than a
config API and there were ordinals for
priority so if you wanted to set my
default config source values you can
then override those with config sources
with a higher ordinal there are a few
default ones so there are microphones
convict up properties files that you can
include in your war file area file in
the meta-inf directory that's got a
lowest ordinal so then after the high
the
ordinal number the higher the priority
environment variables will then
overwrite those and then finally system
properties can overwrite those system
properties I find the easiest to use
anyway
now each implementer is free to and
probably will implement their own
default config sources power
implementation so to find out those
obvious you'll need to go to the
implementation website so open liberty
while flows form just as an example
here's some PI hours which will if
anyone's use PI R before you'll probably
be familiar with some of those so we've
got like the config one that I
highlighted there that's I think the
most misleading so for each server
instance in PI our each server instance
set its own config so really we put in a
config in a config so if you if you
wanted to use that you're very welcome
to and that's kind of completely native
but if you are a PI or a user that might
be more comfortable for you this is how
you use it in your code really really
simple at inject and at config property
there are two properties that you can
set on that name and default value so
just in the example there you can see at
the top we've got a string injected with
examples of some tight URL now the
problem there obviously is that we're
not setting a value in the code either
so if for whatever reason that config
source was not loaded properly or just
wasn't set there in your own CI program
that would cause problems so to get
around that we've got a couple of ways
around that
you can either inject it to an optional
and then handle what if it's not there
that case or you can just set a default
value actually in the code itself which
is the final one they're using the
default value annotation there are
built-in converters as well which
obviously has a little bit of type
safety these are all automatic so you
can inject a conflict property as a URL
type directly you don't have to inject
it as a string and do your own
conversion that's all done for you and
now one of the things that came in
convict 1.1 is that URL converts s not
there in 1.0 but it is in 1.1 and
finally if you did want to import your
own custom config source this is how you
can do it implement this config source
interface with those few methods again
if you wanted to write to it you could
just add your own set value and set name
methods now that would be OK for a
single config source to use the Java dot
util or service load a method but the
alternative if you've got sort of
multiple convict sources maybe you've
got a properties file that you wanted to
implement in many different jar files
and you need to load all off them to get
the full picture you can use config
source provider which will let you load
multiple sources let's move on to health
check I'm trying to rush through this a
little bit there's a lot of stuff to do
simple annotations it's a really simple
API this but I think really really
useful just annotate things without
health and it will automatically give
you a up or down status this is
deliberately just up or down there's no
kind of like warning or threshold level
that was discussed but really the use
case for this is when you're in a micro
Services style architecture in the cloud
really what you want to know is is this
up and is it serving requests if not
then I'll kill it and then just die a
new one so that that's really what it's
there for
obviously you may want to know ahead of
time if it's getting close to dying and
if it is then we can still specify extra
data and you can
that in your own way so it's to be
honest I've haven't looked at it I think
actually it's more flexible in this way
so here's an example this is we've
annotated a class with at health now
when you do that you need to also
implement the health check interface and
then override the call method which
returns a health check response so there
you can see we've got a health check
response named disk space and this will
just kind of tell you is it have we got
no disk space left but also we're adding
a dot with data to tell you how much is
free now see that's just a standard key
value pairs that you could maybe
implement it as a percentage say oh it's
95 percent full that's bad and then
handle it in your monitoring software
which i think is really the better place
to handle that sort of thing so that's
it really for health checks obviously
there is more stuff in the spec
documents and we'll get to that later
but here we'll look at metrics 1.0 are
really closely related api so there are
many different kinds of annotations for
metrics this is just kind of like to
make it a little bit more easy for you
for you to use things you don't have to
use the annotations there is a
programmatic way to do as well which I
won't go into anyone here who's used
something like Prometheus yeah a couple
of uses so fit for you you might
recognize some of these annotations
these were kind of inspired by from
atheists but you don't have to use that
to to read metrics counters obviously
can go generally show you totals a gauge
kind of goes up and down meter is going
to show you kind of throughput and think
things like that time docs adjust
timings and metric allows you to kind of
inject these things in a programmatic
kind of way just look at each of them in
turn counted has a property called
monotonic this is the only one with its
own specific
property if monotonic is set to false
which is the default you can see in the
comment there it will only count current
invocations so as soon as the method
finishes it will then subtract one from
the counter so the count that you're
getting is only things that are
currently within that method so for
instance if you call out to a remote
service and that takes some amount of
time the default behavior is it will
only show you things that are currently
in that method and currently running if
you set that to true then it will just
simply add to the counter and it will
just give you like a high-water mark of
how many times that's been called and
that annotation can be added on
constructors methods and types making on
there on the classes and when your T and
it a to type each of the different
methods will be annotated for we say you
you don't need to do that all on every
single method now gauge this requires
you to set a unit but did this is
something that is applicable to every
single metric as well
so that the units are for metrics they
are encouraged you don't have to do it
for everyone
engage you do and the reason for that is
because it has so much extra value to
have that kind of metadata about what
you are measuring so we've got this enum
called metric units if you've got
something that's just a random value and
there's it doesn't make sense to measure
it in say megabytes or days or seconds
or whatever you can just use metric
units or non metered again like I said
this produce kind of mean throughput
you'll get like a 1 5 and 15 minute
moving average same as before you can
annotate this on constructor method or
type and basically just tell you what
kind of throughput you're getting in
something like Prometheus or or a
dashboard timed this will give you
justin statistics this kind of is
useful when you kind of combine it with
things like the fault-tolerance api
where you might have a specific timeout
you might want to do this to see how
long various different methods take in
dev tests and prod and then use that to
feed into the data that you the value
that you want to put for your timeout on
that method just to stop you're putting
the timeout to low or something and
metric now this can be added on a field
method or parameter so this is different
to the previous ones that we've seen and
obviously this one is where we are
annotating a particular gauge we have
had to override the get value method of
gauge and then return whatever we want
so this kind of gives you a little bit
more flexibility in the way that you're
using metrics in the way that you are
supplying your own metrics and here's
just a list of all of the fields that
are available I guess I counted is the
only one with the extra one that
monotonic at the top but all the others
have named whether or not their absolute
display name which is going to be the
thing that's picked up by something like
Prometheus or Griffin or or whatever a
description which again gets picked up
in the if you view things in a browser
unit and tags tags just there to give
you an option to supply some extra data
so these metrics get exposed in three
different registries so it's everything
is on your URL slash metrics they are
those base application and vendor base
is the minimum required by every single
my profile implementation but then
there's also application which is where
any annotation that you would put in
your app would go and if you were for
instance to deploy multiple applications
that's thought of as well so each of
those things for example hit count there
that will be prefixed with the context
root of your application because does
something that we know is unique and
finally vendor this is something that
can be implemented by whoever's
implementing the spec where this PI or
IBM Red Hat Tommy this data can be
exposed in JSON format that you can see
there but also Prometheus text format so
like you say we we did use from atheist
a lot to to test this out and to make
sure it worked just because it's so
ubiquitous these days and particularly
that the text format is being used by
other different products so it just
gives you a bit of extra flexibility
there after the adjacent format means
that year we were you really not tied
into Prometheus at all there's a sample
Yama file this if we get time for the
demo this will be part of it there is a
demo application called the Mike profile
conference app which is available on
github under the eclipse project this is
sample from atheist yam Allah
literally I added this week specifically
for this talk because it's useful to use
with it so this is an example of
connecting two metrics running on open
Liberty and the their implementation of
it is secure by default so you need to
supply a username and password tell it
to use HTTPS and also tell it to ignore
an insecure verification because it's
using self-signed certificates and Bob
so we don't need that for demo purposes
ok next one is for tolerance for
tolerances I think probably the biggest
one so there's tons of stuff in in fault
tolerance and could easily bore you to
death with another 50 minutes just about
this so this basically implements common
design patterns that you'll have seen
from things like that the Netflix open
source libraries but there were ones
that we should be familiar to you if you
are aware of fault tolerance if you not
I'll try and explain them a little bit
as well all of these annotations can be
used together but what I would say is it
is important to check the spec on how
they behave when they use together
because when certain of these
annotations are triggered they cause
different behavior in some of the other
ones
so using them in combination you didn't
double-check exactly what the behavior
is that you're specifying and of if you
didn't want to look at these slides that
will make them available and that's a
link so you can click and go directly to
the spec all of the specifications I
should say are available on github in
the probe in the github repositories
slash releases so the first annotation
is at asynchronous this is kind of the
simplest one effectively just means that
you run that method or that class or
every method in the class I should say
in a separate thread if you are going to
do that you must return a future if not
then there will be thrown an exception
what we thought you'd say and obviously
if you're not doing that then all the
requests all those methods H is going to
be treated synchronously next is retry
so if something happens in your service
that kind of makes a I finally happen
then you can use retry to say whether
you want to try again how many times you
want to try again what delays you want
to add in so I've listed those kind of
in a group format but we'll start with
the example on the bottom so that the
bottom I've got public void service C
and I've got a retry on ir exception not
class so for example if I'm reading from
disk but if that throws an IO exception
retry we'll pick that up and just
immediately retry we immediately no
delays or anything except for that maybe
the default delay which is I think 5
milliseconds but that will just this is
a very simple use case effectively going
back up to the middle one service be
about the writing service there that's
been called now there we've got a max
number of retries as-90 just quite a few
and a max duration of 5 and now I've
overridden the duration unit with the
krona unit seconds
I think khurana units that the default
for the duration unit there and I do
note that that's a slightly different
name is it's not like max duration unit
which is what I was expecting as I wrote
this down his duration unit so
we make sure that the thing that you're
using is the thing that you think it is
okay
now the top one is the most kind of
complex comprehensive one looking at
service a there we've got four different
properties that we're setting so here
there is a delay of 400 milliseconds
because we haven't specified any
different units a match duration of
3,200 milliseconds so that would be that
will effectively give you four retries
minimum so that the maximum duration is
the maximum duration of any single
request so if it happens for kind of 30
200 milliseconds then it will stop and
it will start again with it allows 400
jitter is quite interesting so jitter
will just use that 400 and it will
either subtract or add 400 to the delay
so that delay rather than being 400 now
is either 0 or 800 okay and then there's
a max retries equals 10 so we want to
you know keep things reasonable we're
just setting a hard limit of 10 on the
max we choice there next we've got a
fallback so obviously if you find that
something as retried a couple of times
and still hasn't worked then perhaps you
want a fallback method may be that
fallback method is an alternative option
which is maybe not so great or a second
service or maybe it's just something to
handle an exception and you know
feedback a nice friendly error message
so there are a couple of ways that you
can do it you can either specify a full
class which implements fallback handler
as you can see there on the right hand
side we've got our fallback with string
for backhanded class and that obviously
needs to override the string fallback
Handler dot handle method and that will
be the method that's used to handle that
particular failure note I something if
you want to obviously implement a
generic fallback which just maybe
returns
an error or something on the left-hand
side we've got a particular fallback
method so just in the same class we want
to maybe try something different next
we've got circuit breaker see if you're
not familiar with circuit breaker the
idea is that based on certain properties
we want to mark a particular services as
not being available or mark the method
as being bad so what the circuit breaker
does is it will allow you to pass
through the circuit if it is closed OC
because we're looking at electronics
here and if the circuit is open then
that's bad and then the method will not
complete
so this throws the circuit breaker open
exception when the circuit is set to
open and that can then be handled by
other different annotations for example
fall back or retry or something else so
just to say example you could use
circuit breaker to throw this exception
have retry handle it after a delay of
400 milliseconds there are few different
properties their success threshold is
set to 10 requests voting for short for
value ratio nor point 75 and delay
equals 1000 all of those together
combine to give you the contract for
whether or not this circuit should be
open or closed it's pretty complex to
kind of try and work this out in your
head at this point I really would
recommend looking at open liberties
guide on the circuit breaker because it
is it does go into a lot of depth than
which I'm running out of time here yeah
I'll just move on from there bulkhead if
you're not familiar with bulkhead it's a
way of isolating failures in a single
part of an application but effectively
what it's doing here is giving you two
different modes to control the amount of
work done by that particular method so
there's a semaphore mode which is kind
of the simple mode and a thread pull
mode the top one here in the exam
police using semaphore mode and it's
just adding a limit of five requests on
that method so kind of five simultaneous
requests can happen on that method at
any one point the thread pull mode adds
another different property called
weighting task queue so will allow you
to kind of queue up different requests
to then execute in that method at a
later date well it's time shopping on
days you need to use that with
asynchronous it's not so clear in the
spec that that's required but it is it
is something that I did double check and
checked with the payara
guy who's going to implement it and yeah
it does need to be used with
asynchronous obviously because it's if
they think - we are returning a future
connection there and in thread pull mode
as well I should say it was a bulkhead
exception if there are five concurrent
requests and also the waiting task queue
is full next we've got timeouts
another nice simple one straightforward
timeout a 400 default in milliseconds
triggers either a fallback or a retry
but also can contribute to opening a
circuit so even with a fairly complex
circuit breaker
pattern that we had before if you add a
timeout - as well that can kind of
contribute to opening a circuit
I think the circuit can actually be in a
state of being half open which is where
the it just marked as being not quite
healthy but it's not fulfilled all of
the criteria of being open okay next is
JWT propagation so hopefully we'll have
time for a demo so people all aware of
JWT s I think fairly common these days
yeah I'm good good so it's token-based
authentication which obviously is the
sort of thing that you would really need
for restful micro services and so the
reason for this is because it's
validation is easy without having to do
a second round trip to it another kind
of validation service JSON formatted
data is pretty easy to carry off
information and also to process
particularly since microphone implements
JSONP and there is an agreed set of
standard claims for interoperability I
think it's the IAA who kind of set
global standard claims for virginity you
can obviously supply your own but you
know one of the key attractive things
about JWT is that there's an agreed
contract between different services so
it helps with interoperability so micro
fors implementation tokens can be used
for both authentication and
authorization they can be mapped to the
jsr 375 identity store which is again
something coming in Java EE 8 so for
example if you were to run this on PI or
a micro which had has Java 8 API is in
or available then we can use Java
security for the identity store there
the support additional I
I am a standard claims so there's a core
set under claims by the IAA but then
there's some additional ones which are
kind of standard and agreed but not
guaranteed by everything Micra profile
they are included but it will also
support the additional non-standard
claims which can be specified by by
yourself in your applications there's
two new standard claims that have been
added upn use a principle which i think
is different to jsr visa and v would use
caller principle but effectively it's
the same meaning for that and also
groups so it adds claims about the
subject of the tokens group memberships
so like admin manager or whatever
there's an example of microphone
compatible JWT token and the minimum
required claims so we've got type as JWT
and algorithm is RS 2 5 6 and pretty for
those two other the mandatory ones and
then k ID which is just the idea of that
the key used
to secure the token then further down
we've got a few of the claims I'll see
if see how many I can remember ISS is
the issuer so that's the authority that
issued the token expiry exp IAT is
issued at a time when the thing was
actually issued Serb I think is the
subject so information about the subject
that the token is about and I said
before you PN user principal and groups
whatever groups that subject is in now
in your code there is the Act claim
annotation when I went through the spec
dr get some nice examples of this there
is a massive massive example there are
tons of different ways that you can use
this with each of the different claims
having examples so the thing I wanted to
pick out from that is that I've got two
injected claims here the top one has got
a value of exp but I mean trying to
inject the standard claims that I eighty
that will throw an exception because
it's said in the second point they're
ambiguous use so we'll throw a
deployment exception because you're
trying to inject an issue that claim
into the exp claim for the JSON token so
that won't work and I'm going to put a
link that it's the specification doc so
for the complete details and and there's
quite a lot please have a look at that
so next I wanted to really highlight how
you can actually find out more as a user
firstly so if you just want to get your
hands on these tools first you need to
choose your implementation so the ones
that I listed earlier not all of those
are equal I said at the time some of
them support different a few yards at
the moment the most thorough one is
IBM's open Liberty which influenced all
of the Micra for 1.2 API
so player micro for instance supports
micro file 1.1 1.2 support is still
being developed and I think that's the
case for some of the others I think
malformed will support sending metrics
and health checks but may NJ do BT
propagation I'm not sure if they've
released config support just yet they
may have done in the kind of past month
or so next thing to do would be to check
the release notes if you go to the micro
file BOM repository search just eclipse
slash micro fast - Bom that will give
you the kind of umbrella project release
notes it will tell you what's in each
version and also give you crucially
links to where you can find out about
the different apos that you get in there
but certainly check the release notes
for the individual specs for just how to
use them they're super easy to read
they're written by developers for
developers so if you want to get your
hands on it and have a play that's
definitely the best place to start
certainly where I started and finally
ask questions so as I said before my
profile is a community effort it's all
about community is all about being very
approachable so each of the
specifications has a Gitter group which
is you know is very closely tied to
github so you can go there and just ask
a question about what the behavior is
supposed to be if it's may be ambiguous
from the spec Docs and then maybe you
can file an issue or or a pull request
for yourself and also in the google
group now this is where we do kind of
most of the broad communication for the
for the project it can be a little bit
overwhelming if you're not used to it
because there's a lot to track and
there's a lot of activity that goes on
there if you want to contribute to
market profile I really encourage you to
do that as I said the aim is that we're
trying to set the parrot you're as low
as possible so you can just stroll right
in and say you know I've got opinions on
how things should be and you know share
those with people if you are interested
in an existing specs of one of the ones
that I've talked about today or maybe
open facing open API which are currently
in development and you can influence
they if you'd like find the repository
on github find the chat community which
will be in the readme of those
repositories but also fund hangout in
the microphone calendar and I'll show
you that in a minute there you can
actually talk on the phone and you know
see what's going on you can participate
as much as little as you want if you
wanna start something new that's
possible as well so they can add to
start a discussion in the Google group
just to see what other people's opinions
are and start sharing things or if
you're a hands-on type you can just
start coding right away we've got the
micro file - sandbox repository where
you can clone it create a new pull
request and then that should be just
merged very very quickly so that you can
basically kind of contribute your ideas
and get other people to give quick
feedback on them right and just before I
move on to the actual demo what I wanted
to do is show you a little bit about
some of those resources so here's the
microphone file bomb spec that I've
previously downloaded and as you can see
that there are links to the different
projects there and there are different
specs for each of them Eitan kind of
differing sizes but let's choose the
metrics one design no that's quite good
one and there we can see an example of
some of the annotations the annotated
naming convention so when you annotate
something that metric you can decide
exactly how it looks in the registry so
super useful guides to get started with
things hopefully if I've still got
internet access and don't if I did and
that would be where get er would be and
you can kind of get chatting with people
there there's also my profile I ou just
got a few really useful links on it so
there's a projects page I won't open
that because it probably won't load yeah
say so I've got no IP there is a link to
presentations frequently asked questions
our blog and also join the discussion
which will take you to here this is the
microphone Google Group
you are free to just create any new
topic you want start discussing things
joining us some of the threads that are
already there and finally if you wanted
to contribute this is the microphone
file wiki this is that the place to go
if you don't know where to get it from
just type in eclipse microphone file
wiki the top result in Google and here
we've got loads of useful links so one
of these is the microphone calendar it
should look like this it's probably a
little bit small it's zoom in that's a
list of all the different hangouts that
happen every week if you're interested
in a specification get on that there is
a general one that happens every two
weeks this MP hangout and that's
something that everyone is invited to
you very welcome to come and just join
and just sit on the call you don't need
to really say anything but just see
what's going on maybe contribute some
assurance ideas and things to how things
should go so I've got a few minutes left
I'm going to have a go at a demo so what
I've done I won't show you how to do
everything but what I've done is already
cloned the microphone file - conference
repository this is the eclipse - micro
Falcon / micro file conference the idea
of this project was to create something
that was a complete distributed
application one service per
implementation all of these work
together to create a single application
I won't run it now because it takes
quite a while to kind of build
everything and then start all the
applications and it just takes a while
so rather than do that I'm going to show
you a particular service this is the
Vote service reason why I've chosen that
one is because it's the one that runs on
open Liberty as I said before open
Liberty implements all of the api's so
here you can see what I've done is I've
actually made a change already to this
health check response call if we go to
the top of the class you see it's
annotated with at health
it implements health check and more I've
done is add this extra line I've added
some extra data what this class is it
says couch attendee Dao this is because
the persistence part of this application
is running on Couchbase there is my IBM
I think chose couch basis because
they've got some quite good Cloud
Foundry support for it in bluemix
Bobbsey when you run it locally it's not
going to be there so this is something
that we want to have health reporting on
now what i've thought would be useful is
to mix in the config api with this
because it's useful to know what URL are
you trying to connect to so what I've
done is I've injected a conflict
property with the name my DevOps URL and
this string named custom URL and I've
added that to the health check reporting
with a dot with data so now let's
actually just change this running okay
it's actually specify this is a system
property it's only to do minus D my dots
devoxx don't URL the equals let's just
do fake dot URL so now that system
property we passed into the vote micro
service you can see it's just a jar file
there because Liberty I think like all
the implementations build things into an
uber jar that should start up good
that's ready so now hopefully if I go to
the health endpoints
I'll see it's running on unsecured
things that we need to accept the
default things and we don't have the
change to actually save it I might not
have done yes I'll need to actually
rebuild it
cool so I'll leave that to build and
just show this so this is the let's make
that bigger this is what you will find
if you go to the slash metrics at
endpoints this here I've gone to
localhost colon nine four four three
slash metrics and this is the Prometheus
text format output so what we can see is
we've got lots and lots of different
types here these are all begin with bass
but if we search for application then
we've got some like the hash map
attendee Dao and we've got some metrics
there that have been added so got one
minute rate five minute rate and fifteen
minute rate and then those can be read
by Prometheus I still got a couple of
minutes left this is the Prometheus
channel config and what I'll do here is
start prometheus
and hopefully I still had the URL 1990
good there we can see all of the
different metrics I think I'll just pick
one at random that's probably not going
to be one with an interesting graph but
they're they're there and they're
available and I'm really really running
out of time there and see if okay so
that didn't work well if I had built it
you can see this is that the data thing
and you would have seen in there it
would have injected the config API
they worked when I tried it earlier just
forgot to build it again so there is one
minute 30 left so there any questions
I've got a few guesses or questions is
that yep the config okay so the question
was is there a a way to inject all of
the properties rather than just you know
injecting them one by one so let's go
back to the config converters list I'm
gonna say no not yet it is still pretty
new though discussions are still ongoing
is to how to develop the specs or what I
would say the best thing to do raise an
issue on the github project get on to
get er on the google group and make a
suggestion it sounds like quite a good
suggestion to me so that'd be great one
to have yes
okay yes yeah yes true so just for those
didn't hear you said you can write your
own converter and you could also inject
a config object and kind of a bit more
manual button yeah that there are ways
to do it but maybe there could be an
easier way that you could suggest any
that yep approximately once every
quarter to begin with it's kind of had
had a bit of a hiccup II ride just from
going from an idea that a few people had
to going into the Eclipse Foundation
that took up a lot of time a lot of
resources from a lot of people
so since kind of June ish we've kind of
been speeding up and we are starting to
hit that kind of every quarter time box
now so we are expecting one more release
this year and we are expecting another
one first quarter next year that is the
aim but things always happen don't they
so my time is up so I think if you've
got any more questions for the best
thing is to come down and ask me or you
can just tweet me at Croft so thank you
very much for listening</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>