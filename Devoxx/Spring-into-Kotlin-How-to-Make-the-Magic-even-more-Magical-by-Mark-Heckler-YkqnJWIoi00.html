<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Spring into Kotlin: How to Make the Magic even more Magical by Mark Heckler | Coder Coacher - Coaching Coders</title><meta content="Spring into Kotlin: How to Make the Magic even more Magical by Mark Heckler - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Spring into Kotlin: How to Make the Magic even more Magical by Mark Heckler</b></h2><h5 class="post__date">2018-04-27</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/YkqnJWIoi00" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome to this afternoon's session on
springing into complan or as the
subtitle says how to make the magic even
more magical
I always feel just a little bit awkward
about that title the reason why I talk
about magic is because sometimes people
when they first look at spring
especially if they come from a little
mist actually a little work the end zone
way of building software you have to do
a lot of scaffolding and plumbing and
you know build out everything down the
last ends video it's like magic right
and you hear that sometimes and I guess
in the context of any sufficiently
advanced technology is indistinguishable
from magic I guess that's true in that
regard it is Benjamin but it really
isn't magic here's the scenery it's not
magic its science technology and
athletics okay so it's fully
approachable the thing about spring is
it does a lot of configuration
auto-configuration for you but if you
really want to everything by hand you
can it's all there so you can override
everything you can turn off all the
other thing very easily
but why why would you want to to rebuild
the plumbing you know if you were an
auto manufacturer your boss is never
going to congratulate you know how well
you built or - well you created a tire
the tire is one component the business
value is the car that you're pushing out
so your customers can enjoy it and write
in it and use it the tire is one thing
that goes into that but if you want to
build your own tires you can turn off
the magic that's fine so how do you make
the magic even more magical when it
comes to spring boot and the course the
answer is my guess is Colin right a
little bit of history this spring
framework spring framework five was
released last fall it was released one
week after Java nine
and ass up the release date day one it
had full support for Java 8 &amp;amp; 9 and
potentially on out so from day one and
has supported Java minor and JPA Masson
but there were three key stories to jump
into the Spring Framework 5 one is is
rebase lined in Java 8 so I've got the
real goodies that Java ain't run in
three years ago which re on the screen
is the lambdas completable futures
things like that which makes life a lot
easier right it also brought in and
incorporated project reactors and the
reactive streams specification and
reactive streams implementation I should
say project reactor which is ours but we
have a lot of community involvement on
that and there's a lot of
cross-pollination one of the key
committers for a project reactor which
gives us all that reactive goodness
which allows a lot greater scalability
is David Carmel who happens to be the
project lead for our X Java 2 so we
don't do these things in isolation right
these these are important things that
are important to communicate and share
among various teams so that was another
key aspect of Spring Framework 5 the
third was full first-class support for
Kotlin which is very important I mean
this is not something to just take a
chance on right I mean Spring Framework
in the past is supported both Java and
groovy and Chavez very well established
and a triumph to language as is groovy
so we didn't just go well maybe copper
will work out maybe won't know this is
an important strategic decision we made
and it's because common and I think
you'll see this as I go to it is an
excellent excellent language now
sometimes people say well you know Java
Java has got 20 years behind it and one
it's it's old right well no actually the
pace of innovation is accelerating the
release cadence is accelerating so
rather than a three to four
you're six months so job is picking up
pace so you get you really shouldn't
look at job as old you also shouldn't
look at it as oh well why should I worry
about anything else since release kids
picking up upswing for the new features
to hit that well in many ways I like to
refer to Coughlin as Java plus plus
because the complan engineers are a
little bit more at liberty to try things
to implement eggs that maybe the job a
design team had had been a little more
cautious in implementing because Java
one of Jabez main things has been
backward compatibility so they're very
reluctant to to do things that even
would break many tenth of a percent of
the existing applications out there
Coughlin doesn't have a lot of that
legacy to be with so they can innovate
maybe a bit faster they're certainly not
reckless at all it's a great team but
they can step out at it more and I think
as I try to point out areas that Java is
going to be adopting or is adopting or
has adopted down with Java to JD Keaton
just was released one a couple days ago
so yeah that's that's quickly right it
makes you think Java and I and the
release nobody ever used anyway not true
gonna have that anyway so uh so yeah in
common is a very useful thing to use I
do want to say this sometimes people can
kind of rip on Java and have for years
as being very verbose I don't personally
have a problem with verbosity because
Pilate reads your code once you read
your code over and over and over again
or someone else has to write where you
have to read someone else's so if
something takes a little bit longer to
say it's clear
that's a win because as long as it
clearly communicates what's trying
what's what you're hoping is happening
in the code what better be having in the
code that's a whip that said if you can
say the same thing and not lose any
context but say it in a more concise
manner that's a win - right and that's
what Coughlin helps us do I'm not
talking about terseness any old parole
developers in here oh yeah that's turfs
that doesn't maintain a lot of context
right the copy designers weren't going
for tourists where it just shortens
everything they were going for
conciseness it keeps the same meaning
but they it allows you to say it in less
space by the way I guess I should
introduce myself I'm mark head of a
principal technologist in the spring
developer advocate with pivotal the
Software Inc pivot wall are the makers
of such buying software tools is the
Spring Framework in spring boot
apprentice RabbitMQ green Club Jim fire
each contributed to Apache Tomcat and a
huge contributor to the Cloud Foundry
common code so you may have heard of
this for a tiny little startup in
Silicon Valley and yeah maybe not so
tiny but we still are very much a
start-up I blog again not as often as
I'd like but as often as I can perhaps
at the head coach calm as well as our
company site - occasionally I'll throw
something out there but I tweet all the
time at MK hack is anyone - grout
cleaner okay those of you who didn't
raise your hand I hope it's just cuz you
didn't raise your hands but please get
on Twitter this is where all your
favorite open-source committers are it's
the fastest way to reach people it has a
high signal-to-noise ratio it's kind of
where a lot of conversations start our
teams are also on getter
be a pattern here but but Twitter's kind
of placed the fastest way to reach us
including me
so if you have any questions comments
feedback you can tweet that's great or
do you but if you don't like Twitter or
you can't fit your questions comments
feedback whatever at a tweeter five I
also am a member of the slightly older
more established social network called
email anyone okay a few more that's
actually list of both my emails here one
is my personal which I checked the least
infrequently of all my emails
mark mark thankless calm but I'm also my
company email addresses there too and
Pickler pivotal bio
so please do reach out to me any way you
want to that's fine I just check email
less frequently so excuse me
so Who am I I have authored several
blogs and blog posts I have co-authored
a couple of books I've contributed
content and code to several other books
some of which even recognized me for
doing so some didn't and I'm still a
little sore about that no one else is
here but you know that's good so it's
good I have a new project that I'm
working on for a new video series so if
you are interested in that please follow
me on Twitter that's it
that's where I always announce stuff
first and kind of keep everybody up to
date so that's probably the best way I
am a frequent conference speaker this is
my first very first boxing sweetgrass
anyone else any first timers other first
timers yeah awesome right this is so
cool I hope to see you again here I hope
you come back I hope they let me come
back it's always said it's always nice
to be invited but it's even nicer to be
invited back because that means I
mess anything up too badly so that's
good hopefully we'll see each other
again here I have a developer and as you
might guess from the next bullet point
where most of my expertise has been one
it's in the area of Java I was
recognized by my peers as a job a
champion a couple of years ago for
ongoing contributions to the greater job
of community which I try to do I mean
it's important to give back right I
think it's important to get you know we
all need to learn and grow but it's also
important to get back to the community
and grow that community because no
person is an island I am a seeker of a
better way as I mentioned as are you or
you wouldn't be here and I do like to
pursue efficiency and elegance that's
common right so one of the goals today
first hopefully will answer the why is
why switch the job in the first place
again the release is picking up why
shouldn't we just wait for it to drop
into Java well you made this something
that you could use right now
maybe complan will do it a little bit
differently the job and you'll like it
better in common what do we gain well
one thing that's really cool about
coupling and I will I try not to repeat
myself a lot when I say this but there
are a lot of really cool aspects to
common but it's interoperable it works
really well with Java because they say
and they see something they compile down
them to the same class they they run the
same in the JVM and you can mix and
match it works really well I'll show you
as we go through it's it's kind of kind
of fun is it worth it I think so are
other than the top hopefully you'll
think so too but at least you'll have
more information you can make your own
decisions what are some quick victories
where does it make sense to start kind
of pulling at those threads and then
once you've accomplished those quick
victories what are the longer-term
to gather from this and that's fully
will cover all that by the end of the
day by the way I do want to say my goal
here is not to teach me everything
you'll ever want to know about spring
boot or to teach everything you can ever
want to know about Kotlin but I hope to
teach you enough about most where they
kind of make sense together some of the
stuff by the way common any Android
developers out here I'm not sorry but
but but some of these things
I was speaking specifically to comment
on the server or in the cloud they may
have some some usefulness in the Android
realm but that's just not my thing so
I'll speak more specifically to the
cloud side of things and the backend
side of things that obviously Kotlin has
a lot of different targets and that's
not even mentioning the native
compilations and things like that so so
let's let's get started by the way this
any would not recognize Maurice Moss
here not okay
nobody's gonna wear a raise their hand
now I promise happen okay I won't call
you up on stage or anything but if you
don't recognize this guy he's from a
show called the IT Crowd it's a British
comedy of a prett calm and it's on
Netflix anyone on Netflix the rest of
you don't never subscribe you'll just
get sucked in like I have but if you are
on it anyway you might as well watch
good good programming right this was
from a few years ago and it's awesome
awesome series it's hilarious it will
remind you of your office life probably
more than you'd like I certainly did me
but anyway so
okay so let's let's get started let's go
here to do that alright so if you can
get started with a greenfield project if
your boss comes to you and says I need
this brand-new project done and you say
great I'm going to do that Kotlin and
and he or she says great that's
wonderful
that is super but most of us don't have
that luxury most of the time right and
we have far more brownfield applications
than we ever will have greenfield
applications so what I kind of like to
do is build a fairly fast well very
build it quickly a job application and
then we'll take it over to Colin from
using spring the whole way so who here
was my talk yesterday okay okay so I
don't have to go through the whole
street food thing the spring initializer
thing but for those few to warrant first
why but the spring initializer doesn't
generate code that it does allow you to
choose dependencies it zips up your
dependencies into a project file it does
create your main application class on
the main method that's it but it kind of
jumpstart your development so you can
get started fast and do something with
it quickly and add real business value
not a bunch of undifferentiated heavy
lifting so as you saw yesterday you can
if you're a maven developer you can
generate a maven project if you're a
hipster the integrated rail project I'm
feeling pretty hipster today I'm even
wearing my hoodie so I'm going to use
great so buckle up this is gonna be fun
I know I said I was going to start with
a java application but I want to show
you something else too so i'm gonna
indulge just a little bit and i'm going
to create a Kotlin micro-service at
least the framework for and i'll show
you kind of how simple and easy this is
gonna step on across that fits i'm using
the current version of spring boot which
is 2.0 there's already another snap
which is pretty cool and then you could
go back to previous versions but we're
going to go with the career of bits
that's cool
and you know when you're a speaker you
always kind of struggle with what kind
of application you up to show or develop
or what have you I don't know about all
of you like so I had to kind of go with
what I love and my whole life just kind
of revolves around this all right
everybody that there is that is that too
small this this is my life any Lord of
the Rings fan that's here this is my
precious so I'm going to create a coffee
service and I'm going to bring in just a
couple of dependencies here I'm going to
bring in the web dependency which gets
me Tomcat and spring MVC and again if
you're doing brownfield this is probably
what you're doing now with spring either
a spring mood face block left god help
you or a spring mutiny Spiker service so
well we'll assume that's a case I'm also
going to use Mongo Mongo is one of my
favorite databases it is so fast
sometimes it's like you're not even
saving anything I refer to it as the dev
null of databases I even have a mono
sticker here on my laptop I don't know I
hope I don't break anything see here you
see
don't know what I am kidding I like
Marco I even the I even used to have a
friendly work for Mongo until they until
the database didn't score his personnel
record anyway by the way I forgot to do
this yesterday I feel really silly but
do you don't mind if I get a selfie with
you because I like to prove to my boss
that I was actually doing something
versus just sitting in a in a coffee
shop here in Bucharest so so if we can
do this and I probably take a couple
here but everybody smiles in common all
right all right okay so we're good and I
am such an excellent photographer maybe
one of those three actually took so
we'll see all right so I'm going to uh
let's see let's let's create a project
I'm just gonna save that on the desktop
let's see open that and I use my
favorite IDE again it doesn't matter
what ID you use you know we fully we
work well we play well with Eclipse we
even haven't built in Eclipse called the
spring tool suite which has really nice
cloud functionality as well for for the
point except for the cloud which is kind
of cool NetBeans fully supports spring
and spring mood so that's pretty nice I
just kind of always gravitate to
IntelliJ which is kind of fortunate in
this case because IntelliJ is made by
Jeff Raines who also are the primary
drivers and shepherds of Kotlin so it
works out pretty well some of the stuff
you see and there's it kind of hits
there first so let's see first things
first
oh I do want to well first things first
thing I do
can everyone see that in the back no
okay well let's let's
colors get fun I haven't already big in
a Senate but let's blow that up just a
bit more see 28 that better
a little bit yes though oh well hold on
I want to I want to show you a lot of
other stuff I bounce around a lot so
that I tend to have to anyway so so stay
with me here so this is this is our
build up Gradle file the reason I
started with Colin is because as fast as
I type this actually does save me a
little bit of time because when you
switch to Colin and Anacapa you had
added a few things like the common
version you have a couple plugins guide
in the Colin Gradle plug-in all open
Colin spring and I just very briefly
Colin is a knoll safe language he has no
safety I guess is a better way to put
that with Java you have you ever heard
of the billion dollar mistake
allowing nulls right no pointers
exceptions are horrible with Kotlin you
can at least potentially avoid those
entirely doesn't mean you can't find
ways new and clever ways to shoot
yourself in the foot but you have to
work hard or have it right but you have
this interoperability story as well so
job I'm Colin well how do you deal with
something that is inherently not know
safe when you're dealing with language
that is so you have these integration
points you have a plug-in which is
common all open and plug-in which allows
you to - I guess I'm kind of covering
two points at once here so bear with me
in Java classes are open by default open
for extension Colin they're just the
opposite they're closed so you can't
define classes as being open that you
have to specifically specify them as
open when you're dealing with Java
frameworks this is kind of the opposite
effect right so there should be some
easy way the powers that be decided
there should be some easy way that you
can determine some classes should be
open without having to go through
specify open on every class this is
particularly valuable for Java
frameworks such as the spring framework
so the complan all open plug-in and then
the common spring wrapper for that says
that if you have classes in a framework
like spring that have annotated that in
this component or at configuration or at
AC service then these will be opened by
default so it's a very nice integration
mechanism that you if you're using
straight copper you may not need but if
you're integrating with Java
it's very helpful you also have and as I
mentioned the non-billable
or the null ability there are ways oh I
guess I actually skipped over something
source compatibility 1.8 why is that
important because by default Java
defaults to Java versus new common
defaults to Java 6 level JVM 6 because
the iterator
isn't it with Java 8 yet but we don't
care right this is one of those things
that it's important for us to go on up
and go to the JVM 8 level so you see
this sorts of patter bility of 1.8 for
the Pilar options we want to have strict
compilation using jsr 305 there are
multiple ways that you can indicate that
an API is non nullable we have chosen to
go with the ASR 305 compatible route
which says you can define something it's
not knowable and then specifically state
4 like return types and parameters and
variables if a badly you a specific
value is not the ball so that tightens
things up a bit more as well so let's
see what is that's pretty much it so
let's go ahead and just let me go to the
main application class one practice that
I think is very important to to get into
one I don't know there call it a good
best practice but it's a good thing to
do is similar to how you have a main and
a test corresponding tree structure when
you have Java and copy coexisting in a
project you should have
identical tree structures so what I like
to do just right off the bat is create a
new package which matches under the Java
package the same thing under confidence
account example dot coffee service and
this simplifies life just a little bit
so the first thing I have here if you
notice is my column main application
class the main method
so let's shake that up a bit tonight
watch very carefully I'm going to take
my common source code file that did some
duck kt4 Kotlin and change that to a dot
Java can already IntelliJ is not happy
you know I mean I've done something
dirty here in its mind and I'm going to
and this is a good habit to get into I'm
going to take this now Java file and
drop it up under my java directory tree
and then let's clean this up just a
little bit and again this is kind of
taking one step back so I can show you
some things before we launch more room
but this is my column main method and
I'm just going to get rid of that and
we'll just go ahead and recreate our
Java public static void main spring
application run this is our coffee
service application class and pasty
carbs and that's mostly there we do need
to do a little bit of cleanup over
imports with complan you aren't required
to add semi-colons so that's the worst
thing that catches me and trips me up is
when I switch back and forth frequently
I had the more they're not
and I leave them off where they are so
occasionally this happens so we'll just
go ahead and clean that out and just to
make sure that we have no funny business
going on I'll run this to make sure it
all runs properly as a java application
okay so it's running it doesn't do
anything but it's ready so how would we
get started let's build very quickly
let's build out our java application
that let's convert it to comma so you'll
get hopefully intimately acquainted with
this so the first thing I'm going to do
is let's see we need to create a domain
right well what kind of domain should we
have this is a coffee service so it
should be a coffee class right we're
going to be persisting this using Mongo
so we're going to annotate this classes
in that document I'm going to define my
ID field as a private string ID we're
also going to need a couple of other
member variables for our coffee class so
privates tray I want to keep track of my
type of coffee very important and then
I'll have a code that I'll use to
identify my coffee and maybe slugga Phi
the name of the coffee if you will so
that I can provide other capabilities
down the road version 2.0 of our
software so what else what we need well
let's see we'll probably need a
constructor will need a norms
constructor so we can marshal and
unmarshal that will also need a
constructor with just our type parameter
why it just type because spring day
tamago we want it to provide the ID
things right they don't create the ID
when it persists the the record the
document but the code can be derived so
I'm just going to do this code equals
type type dot yeah sure to lowercase why
not I will replace any spaces that maybe
in the name of the coffee the type of
coffee with a dash to kind of against
luck if I add and that's good enough
what else do we need we'll probably need
some getters and setters getters and
setters for everybody we won't really
want somebody to be able to set the ID
so we'll just for the time being
in private same thing with time we'll
call that a private and then code once
again in private and then let's see what
else when are you pulled some hash code
so we can do comparisons right compare
contrast and then let's see probably to
string because we're not so here is
their domain class right and this is
fairly simple but there's quite a bit
there quite a bit to maintain now you
know Java has extra a compile time
libraries like long block and I'm not
against my BOTS but some organizations
like them some don't so if you're in an
organization that doesn't leverage
Lombok it's yeah it's fine but this is
probably what you see a lot of right
here right only usually much much longer
many more pages but well again
simplicity is good we'll just go with it
from there so let's see what's next
we'll want to create a repository so I
copied a repository this is an interface
I'm going to extend an existing
interface that spring data cred
repository for objects of type of coffee
and the IDS of type string strain
there we go okay now this is a bit of
the magic in spring loot right because
in if you're used to a Java EE type of
development environment or similar to
that you have to give a lot of things
that just kind of get you ready to the
point where you can save and retrieve
data like enemy entity managers anyone
that's kind of a hassle so when spring
boots auto-config which again you can
turn off but hear me out if you extend
an interface can find in spring data and
you let's say for instance the credit
repository interface and you have a
database driver in there classpath
spring Duke says I'll bet you want to
deal with Mongo you want to save and
retrieve stuff from ATO it's not really
a stretch right so it Auto configures
that for you so it creates a repository
being very nice you don't like it change
it configure that we can't turn it off
but it's so nice now that covers your 80
to 90 percent use case because pretty
much everyone's going to want to be able
to find all or delete all or get a count
of all documents in their data store or
to retrieve based on a 90 which we've
annotated right here and so find out my
ID or delete by name but it doesn't know
all the potential use cases and
everybody would have so there should be
some way to extend this right to to
customize this for our needs
well there is a because of its with
spring boots on our config and spring
data you can actually add in a method
signature of as long as it follows
certain conventions screen it can figure
this out so I want to return a
particular coffee when I find my type
that I'll supply straight type right
that's enough
you can also for instance if you're
using jva or something you can do an app
query you can use J pql or spring
expression language or
flatout straights equal if you're using
for the sequel data stores but this many
times is enough and it's enough for what
we need so we'll just leave it there so
now what else let's go here and we'll
need a controller because we've defined
our interface internally let's define it
externally right so let's create a
coffee controller oh you know I'm
getting ahead of myself so exciting
brass controller and request mapping and
we'll expose everything starting with
the employee coffees we'll inject first
of all our coffee repository and then
let's get started on a very API right so
what do we want to do we want to do a
get mapping and retrieve from our
coffees in point all of our coffees so
public iterable coffee right get coffees
return repo dot find all very simple
easy easy straight pass through
next we'll probably want to retrieve a
coffee by its ID so here public coffee
get coffee by ID we will use a path
variable to provide that string an ID
return repoed find by ID passing the ID
and actually we need to make that
optional because if you go here
look in our API answering data we're
returning an optional of type T or of T
so it's an optional type coffee in our
case and here's where I think we we need
to provide a little more functionality
right we need to search so for instance
is any is artery Starbucks fancier no I
I make it a point never walk past a
coffee shop Starbucks otherwise if at
all possible if they're closed it gets a
little dicey because then they don't
like that when you break in but but
start my test like I mean if you go to
Starbucks there's always Pike Place
really right so there's usually that
coffee in the day that if you don't know
what you are you just say give me that
pretty much every coffee shop has
something similar so we will allow
somebody to be able to search on a
coffee type there they but if if that
doesn't come back with something or they
don't specify we should provide a kind
of a default right so let's see we'll do
a public coffee get or call this search
by okay we'll use a request parameter
and we actually don't want to require
that we should be able to again provide
a default if they don't provide a value
so straight type return repo dot and
remember we defined a find by type so
now it shows that that's accessible for
us so we'll erase that and that's that's
okay then again what if they don't
provide a type so we probably should do
a little bit of a null checking right if
time equals no then do something else
use something else in this case this
right so what do we do if there is no
search parameters they don't provide
anything there's
how about we just return repoed
principle of least astonishment right
right won't if we'll return just a
default so we'll grab the iterator and
just do next it's a first finger and
that should be enough we've got all of
our micro service built but we don't
have any data so it's really hard to see
what's going on and I'm kind of a visual
person so let's add let's add some data
I'm gonna create a command line runner
beam which again will run each time the
app run so I can pre-populate some data
very simply demo data I'm going to
inject my coffee repository being here
and let's get started so here is the
most important part of this talk and you
think I'm kidding but I'm really not
let's create an array well it's the very
little list of values here so I need
some coffee types some names of coffees
you love those of you who can drop
coffee levers I don't understand but
those of you who are help me out here so
what is your what is a type of coffee
that I can put here what is your
favorite coffee cappuccino that's fine
that's okay
No okay so anyone else it's like they
don't even hear you I said though
judging you just say decaf please all
right there are times I drink decaf you
know after about 11 o'clock at night I
do switch to decaf that's fine okay
anyone else what ha now we're talking
that was good I actually don't
discriminate I like pretty much any way
you can deliver coffee even up to IVs so
that's fine okay anyone else what a
double espresso okay that's fine it's
I'll tell you one from my hometown it's
a brand
it's called colony coffee and I kind of
live in the center of the u.s. a small
city on st. Louis and there's a coffee
register there which is just awesome if
you ever get a chance to go check it out
please do I also am a fan of a lot of
different kinds well we'll leave it at
that
well no you know what I need to show
some of my absolute favorites here
things like black alert coffee any Star
Trek fans awesome right it's covering oh
my gosh here's a here's a little pro tip
for someone who travels a lot in the
u.s. you pay to watch this but when
you're out of country it's all on
Netflix so going back to Netflix it's
awesome so I need to come back okay so
we have black alert coffee for those of
you Star Wars fans
Darth coffee
just to keep it even okay so we have
some coffee types right if you think of
another one just shout him out I'll stop
everything will go back this is very
much of data-driven
application we need good data so we'll
stop there though so we have a list of
types coffee types will stream that and
we'll map each one of those will take
the title we'll do create a new coffee
anymore so let's see we map that and
then we'll do a 4-h we'll take each
coffee and unless he will save it so
repoed save coffee and then to make sure
we have everything and what we have in
our datastore I always like to see
things so repoed fine for each system
out print line and that's pretty good
right but we have a problem because even
though I know I will say this it's not a
bug because I never bug my code because
that way I never have to debug right it
saves a lot of time but there is a
problem here because each time we
restart the application is going to try
to save these same records over and over
and over again and even though I'm using
Mongo it actually may save some of those
once in a while so I need to make sure
everything is cleared up I am kidding I
do like Mohammed really is I think on
things I like so anyway so we repoed
delete all and that should get us up
regretting so let's go ahead this make
sure we have a good working Java micro
service and let's tear apart what I
happened well I had C typo oh I should
have mentioned this I think I get going
kind of fast and I talk and I don't look
and I couldn't wait like settle it was
so the first couple rows I'm counting on
you to catch my typos okay if you didn't
want to do that you should have set up
for them okay so let's write this
and it looks like it's working right I
mean we have copies that that appear to
be saved so that's good
proofs in the pudding there right so let
me blow that up and let's test this
let's see I use HTTP instead of
something like curl because the
formatting is better and also I can
shortcut things so if I don't provide a
hostname it just assumes localhost I'm
running everything locally just for
speed so I'm going to hit my coffees in
point and the formatting did I image the
four betting that's so pretty
so I I'm hitting my coffees in point
let's grab a particular one let's do the
double espresso here since it's right up
here taunting me and we get that back
and it's fine let me see here let's do a
search and we'll see what I say type
equals let's see
Dartmouth coffee so using seashell I
need to quote that and it works but but
again what happens if they don't provide
anything here so we are null check
should work and it does it returns the
first record it's everything's fine
right this is a working Java
microservice why stop there why start we
do anything more because we can make it
better so how do we make it better this
again this is the fun part which time 20
minutes tons of time ok so the first
thing I like to do is go to my domain
right here because this is a lot of
boilerplate right we think we can make
this better
so again this is very critical watch
what I do here I'm going to rename my
coffee duck Java to coffee dot ket and
make this column file now what happened
there it is now look IntelliJ realizes
this is now in common source code file
but this isn't groovy so it doesn't just
go yeah it's fine you have to actually
do something to make some changes to
this to make it real common okay so the
first thing you remember was the first
thing we do when we change a file from
Java to Kotlin we drag it down here to
our common package so we again we do the
thing do things right so now where to
start go first thing everything is
publicly visible in common by default so
we don't need this we don't need to say
that don't repeat yourself right and
then with Kotlin you can create a
constructor right here in the class
header and I'm going to just pull this
up here
comment that so let's let's start
building this out so let's take our ID
up here with comment you don't put type
in the variable name you put the
variable name and then the type of
course you'll need semicolons so we say
ID of type string kind of make sense and
then I'm going to bring up my type which
is also a type string hahaha
string and this is almost there right
and as I mentioned earlier Kotlin is is
his type say if it's null has null
safety so if you say that something is a
string it is a string by gosh it can't
have a null value what happens if you do
want to allow a null value what you just
add this the question mark so maybe a
stringer maybe a normal you don't know
but that's you're actually specifying it
right there's no guessing you're saying
it could be a dollar could not this is
as much information as I can provide so
that's not bad we're going to say that
that potentially could be knowable I'm
also going to just have the gate say
that I'm going to assign it a default
value if none is provided I'm going to
make it null because again I don't care
initially I'm going to have mom go
assign that ID it's sort of like a Java
final variable if you can assign to it
once you're done but I'm setting that at
fault that just is kind of a practice
and best practice and then here of
course I don't want to make this doable
at all in any way shape or form I'm
going to assign a default value to this
of any old coffee so of course we never
want to hit that right we don't want
just any old coffee in our system at
least it would be fine now I haven't
done a couple of things here one I
haven't specified whether these are
values or variables now if you put this
you can potentially update that so it's
it's like you have getters and setters
both or you can make this a valid value
which again you can assign to once
that's it to me this exposes this as a
property it's no longer just a parameter
to your constructor it's a property so
similar to how Java has member variables
centers Colin exposes properties and for
for reading and for setting and again
here we're going to make this also yep a
bow now another cool thing about Colin
is that when you put your primary
constructor up in the header like this
it is the rid of your constructor
keyword so it's very nice and concise
rate this is just the beginning with
Java you know how you typically have
multiple constructors with multiple
different parameters and you may have a
constructor with no parameters and one
parameter two and ten and 20 and what
have you and that's kind of essential in
Java well between the ability to assign
default values and things like that you
can simplify that and in most cases in
college in just a single primary
instructor but you can you can define
secondaries as well so we can
immediately get rid of this right and
I'm going to keep this code here because
I actually do want to come back to this
template but that's that's okay so we
we've already discussed how these are
properties now we have an ID property we
have a type property since we set them
as vowels we have getters officially
effectively I should say but certainly
we can't set them once the the object is
created but we can get rid of all of
this noise no longer needed all right
you know that leaves this really ugly
equals and hashcode and to string
wouldn't it be cool if there was some
way to get rid of that too there is it's
not a data class the concept of a data
class this is similar if you were
yesterday you saw being at data
annotation for lompoc so that gets you
goodies like your equals your hash code
your to string a copy operator so you
can copy and only override the values of
particular properties that you want to
change otherwise it just copies the
existing ones so it gives you a lot of
capabilities just kind of out of the box
which is again pretty sweet so when it
gives us our equals
you don't have to do this it gives us
our hash tag we don't do that now what
if you want to override one of the
methods that are provided
by the data class implementation well
you can do that too so let's let's do
that so I'm going to let's see I'm going
to make this into a two string function
column doesn't doesn't this is kind of a
little tongue-in-cheek here but there
are methods they have functions and the
key word for function is fun so
everything is fun in common right so
we're going to create a fun and of
course this we already have an
implementation of a two string we're
going to have to overwrite that but it's
pretty simply done right and this is
where things I think it a lot more
interesting very quickly so this kind of
monstrosity of something you see a lot
of two strings in Java but Collin has
string templates so let's just clean
this up just a bit let's bring this up
and instead of having to embed in this
kind of concatenated string monstrosity
we just reference this as a dollar I DS
which pulls in the value of our ID and
then let's bring this up
same thing with type dollar type and
then we'll bring out code same thing and
of course I don't have code defined yet
so it's still going to be read can a bar
get me a little bit here I had give it a
semicolon that's not bad that's
certainly much better than what we had
to look at in a single statement in
common and a method you can just do a
direct assignment so we'll go here and
we'll assign that directly to our
function which also brings me to the
next thing you see this type inference
Kotlin has type inference so you can
specify the return type specifically
whoops let's say you can say hey this is
going to return a string but in most
cases type inference kicks in it's
really a commendable job so which
further shortens your code now what
about this being of code what about our
code property because so far I've kind
of passed over that column usually
offers you several ways you can do
pretty much anything which is kind of
nice for instance if you want to you can
create what's called an extension
function
this is a bit unorthodox for what I'm
going to show you because typically
extension functions are used to extend
classes that are closed so if you want
to extend the capabilities in the string
class you don't have access to go in and
change the code of the string class you
created an extension function something
like the string dot do something equals
and then you reference the string in
particular that and that particularly in
seventh this let's say length so you can
do that that's an extension function we
can do the same thing here with our
coffee class define code equals let's
see let me clean that up
equals and of course it references the
type of property to lowercase replace
tear to the semicolon and that's legal
but again you have the code right in
front of you for coffee so you can
actually write the code into your coffee
class again that is a little bit
unorthodox so let's go up and do it in a
way that I would probably do it which is
just to actually we'll just make a valve
code and we'll set that there you go
nice and tight indeed now if you didn't
have to do anything else if you didn't
want to override the to string if you
didn't have as a derived value property
you can just do that you don't even have
to put the brackets on it it's so clean
it's so concise and it keeps all the
meeting matches pretty pretty sweet so
let's go on what else eleven minutes
it's again tons of time I just want to
make sure I don't get you out of here
late because I know coffee weights and
okay I hear you so I do want to test
this though and make sure again make
sure this all works the one thing that
will change because when you have these
interaction points with Java and Kotlin
sometimes especially when it comes to
constructors you have a little bit of a
disconnect because Java again typically
expects you to have a constructor for
each different number of parameters we
specify that we'll always have a couple
of parameters here so when we create our
just a sample data we're only providing
one and of course it's telling us that
for now I'm just going to pass in a null
value hopefully this will run of course
well I don't want my code
and it works very much the same as as it
did before so if we go out just quickly
double check coffees grab dark coffee
here and then if we do a search and
search okay send our aggressions right
we know that it's working we've already
gotten rid of a kind of code just in a
single class so where do we go from here
how do we top that well the next thing I
usually like to do is go with a nice
small class like a coffee repository
this is pretty simple pretty short let
me show you something that will probably
blow your mind if you haven't already
found it you go under code and you go
down here you see that Java found a
common file I have no doubt that this
will eventually wind up in Eclipse and
NetBeans as well for right now it's just
a really nice capability within
intelligent I think as far as I know it
hasn't been implementing the others yet
but certainly I expected so let's give
it a shot right how bad can it be so
let's convert this and that's a pretty
respectable job you can see that it did
convert it it's it's now perceived as a
coffee repository interface a common
interface I should say and we'll drag
this down limit everything would work
should work will work we know it work so
I'm not going to spend the time to go
ahead and rerun it well test it we have
BIGBANG testing mucking around
right alright so the next thing I like
to do is go back to my controller this
is a little more complex we're going on
here right let's try it so let's convert
this Java file a comma file and of
course it tells me some code in the rest
of your project may require Corrections
you want to find such
- sure why not so let's do that and
let's let's grab it here again it's now
reading as a common file drag it down
and let's roll up our sleeves get busy
here is where you start to see some
strange stuff creeping right
this isn't horrible it's not like it's
completely off the charts
I just find it a little jarring that
they've made my get for my all coffees
in point into a vowel
it seems that rather odd especially but
everything else converted to funds and I
like fun as much as the next person so
let's make them all fun right but I'll
go back to that first I want to clean
this up just a little bit so yeah this
is a single expression let's see did I
oh I will mention that here shortly I'll
cover that in a minute I need to get
ahead of myself so I'm going to do a
great assignment that cleans it up a bit
again we can use type inference this is
an optional coffee there we go now some
of you with very sharp eyes will see
that I now have an exclamation point
after coffee that's not just because it
loves coffee - although it probably does
but this is an indicator that this is a
platform type so we know if we go to our
repo code it returns an optional of type
T this is a Java class is y and in a
Java framework so it's referred to as a
platform type because Coughlin's says I
can't definitively say whether this is
doable or not so I will put this little
indicator on there to let you know that
hey you know you're kind of need to pay
attention to this so so you can't
specify it correctly but again type
inference works pretty well this serves
our needs so what we're along here we've
got our search by type so once again I'm
going to
actually these type inference first will
just kill that actually so in Java even
the lowly if statement is a statement
right so things like if else why I'll do
things like that for these are all
statements they return no values there
are keywords and common their
expressions so what does that mean they
can return the value you can do a direct
assignment from an if statement which is
really kind of cool it pains your code
more than you know probably expect at
first glance so we're going to say if
type equals goal do these things and of
course this isn't unique to comment but
since we just have single expressions
here I've got to go ahead and just clear
this out that that that cleans that up a
bit right but we can do a little bit
better so we're doing just a basic
occult chat there's a number from Java
and coughlin does have an is null or
empty R is known blank operator which is
nice because this allows us to not just
check to see if it's a know that you are
know about that may be an old string a
zero Blake the string because either way
we want to provide some kind of default
like pipe place you know default coffee
value so the lodging for us is the same
if it's null or if it's empty just grab
the first coffee but if they specify a
type look for it here is a little matcha
and I've actually spoken with the
complan engineers about this because
Kotlin has nothing called smartcasts
which you're awesome because what how
many times have your java code do you
check to see if something as normal and
then when you go and use it again you
check to see if it smelled and then you
use it again you check to see that smell
which is crazy because you've already
checked at once
Copland if you've checked to see if it's
null it says you've you've established
this is a non null value this
value so it doesn't make you continue to
recheck it says this is a string you
said it was I tested it it's good it's a
string but here is a catch
this isn't nibble a together so the is
null or empty is actually a more
stringent test it check to see if it's
null it also checks to see if it is
easier lengths straight in this case so
it's hard to establish that it is an all
right and check that first if you go to
look at the code and comment it checks
to see it small but right now the smart
cast is there so it's coming to a future
version a cup how do you get around that
well you can do something that you
really typically should never do you do
a bang bang and when you put two
exclamation points in there or the bang
bang over here it's like shut up sit
down in color and I've tested this I
know it's not all trust me typically you
don't ever want to do that because you
haven't you want to lean on your tools
to verify it validate but in this case
we know and at some point again comma
compiler will catch up and everything
will be fine so the other thing we can
do here is we have a request parameter
and we specify it to be false in
compliment horse we can also specify
that the it's a knowable parameter which
seems a little redundant so wouldn't it
be cool if we can just get rid of that
requiring this false because we can I
have that covered here with this string
question mark and we came up so that
tightens that up a bit
let's go up and fix this this
abomination I'm going to change this
from me and value to a function and
we'll do a direct assignment I'm going
to just grab that let's see
there we go so we're good so that should
work against this actually with pleasure
on time that I realize so I'm going to
go and go to our main application class
now and we'll just listen for that as
well I'll show you really where things
can kind of go off the tracks so the
bird job was titled a common absolutely
and then we'll move this down and
refactor and this leaves us kind of
medicine right so we've got a couple
things to deal with first here is is
first our main application class and
then we have this this pedal a
monstrosity and this is technically
correct but it's a little bit overkill
because we're not I mean this is our
last thing when converting to common
right we're not having to read this from
Java this is a common main application
class so we can get rid of this and yes
I'm gonna go ahead and just close off
our spring application class appear
Coughlin's has the concept of top-level
functions so we don't need to put that
in our main application class we can
have our main method just independently
existing so that's pretty good this is
still idiomatic Java so I'm going to
change this to an idiomatic column
rather application for a given type of
application as the coffee service
application as in arts now let's think
of our our command line runner bean
again we can just assign this so that
means that we can get rid of the return
okay reformat that a bit and we can
clean this out because instead of going
through some of these hoops we can use
the column list of functions excuse me
and then I don't need an automatically
converts the string so we don't have to
manually stream that this is kind of
nice with column lambdas let's see where
to even start
well one we're only going to provide one
parameter here so type is our type we
can fit all our sees me named parameters
so it's a type equal sign we also can
just say it for our single parameter or
lambda and of course we're going to go
that far we might as well just eliminate
this because if you don't specify a name
for it for it Colin says hey that's your
single parameter I mean your lambdas and
that makes it nice and tight with a name
parameter and the single Pretender first
name parameter for our coffee
constructor and animate and a single
parameter for our lambda
same thing with for each lucency that
actually yeah we can get rid of our
coffee creamer because it's assumed to
be it and of course I just happened to
Tiger there so let me save the front row
and then here we can clean this up
because again this is a little bit extra
for rich today we should be good to go
much cleaner right much much much nicer
so let's run this
Wow we're out of time so let me test
this really quickly it'll come back this
looks like it works that's always a good
start
so see you go two coffees coffees works
let's grab our double espresso over half
the top sounds delightful right now by
the way search type equals let's see was
that thank you see shell but it works
Oh what happens if we leave this off it
still works
now what happens they have we do this
because now in cotton we've checked is
null or empty so this also works it's a
little bit of extra capability for any
extra charge so let me go back really
quickly and go to the last couple of
sites because I was asked earlier is
this code available our lip read is a
presentation available yes it is it's a
it's recursive so if you go to the link
at the top for the repo it actually has
a link to the slides on speaker deck or
you can go to the link on speaker deck
and then go and find this repo from that
to spring iOS where you go for all the
screen based information as well as much
much more and then a couple of really
cool compliments common languor
and copy that link which has access to
our list you know common conferences
vents all that as well so with that I
would sign off by saying if you have a
chance to count them to the US in
September join us for spring one
platform because we actually dive deep
on a lot of stuff like this and much
much more so if you can't there's a
discount code come see me and thanks for
coming today</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>