<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Building apps with React Native by Maarten Mulders | Coder Coacher - Coaching Coders</title><meta content="Building apps with React Native by Maarten Mulders - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Building apps with React Native by Maarten Mulders</b></h2><h5 class="post__date">2017-11-09</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/oVcvtoVwUrM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">folks thanks for being here thanks for
visiting my name is Martin oldest and in
the following three hours we're gonna
cover react native I work at a Dutch
company called info support we do
consulting mainly we do enterprise
mobile development as well we've built
the mobile app that all trained
personnel in the Netherlands uses to
validate train tickets see what trained
I have to drive next what kind of delays
there might be etcetera etc so let's get
started if you're Dutch like me and if
you're around the same age like me you
might recognize this who does recognize
this by the way just to get an ID well
quite some hands thank you
this is a TV show that aired when I was
young
20 years ago maybe the guy in the middle
was presenting the game
his name was Francois Boulanger many
people believed he was actually founded
ibaka which is just a literal Dutch
translation but he has always assured
that his real name was francois peron
shape anyway
you were playing the game in two teams
and you had to guess words it's that
easy and to make it a little bit easier
even you would get one letter for free
like this so for example we would have
to get a word of five letters starting
with the B now it could of course be a
lot of words starting with B so we just
would think of one word and we would
need to spell that word out so we would
be like maybe the word is a beast that's
b a b e
AST and then you would get this and that
says the B is in the words that we're
looking for and it's on the right spot
as well so is the e it's on the right
place there's no a in the word there is
an S that is not on this place and
there's no T
well a second guess might be bogus I'm
really out of clues already and the
computer would tell us that the S is on
the right spot this time but none of the
other letters are actually in the world
okay well very maybe and now we would
finally see that we have this new letter
R we didn't know it wasn't word yet but
now we know
and then finally light bulb emerges
we're in Belgium of course the word is
beers so it's actually a very simple
game as you can see there's no there's
no heavy graphics involved there's no no
very complex screen play whatsoever and
it was this game that I wanted to be
able to play on my mobile phone and well
since I'm a developer I figured I could
build it myself and it might be a nice
use case to get started with react
native now if you want to get started
with react native you have to do two
simple things first of all you need to
have note and note jazz and the node
package manager installed of course and
then you start with installing the
reaction native CLI and the react native
CLI is the tool that you use when
building running etc your reaction
native application and once you have
half of the internet installed download
it to your machine and installed you
would issue a new command would be
reacting - native in it react native
demo that a lot of letter parameter is
the name of the app that you want to
create again you would need for sure to
wait for some minutes and then you would
be seeing some output like this it would
say something like okay if you want to
ring your application you need to go to
a specific directory and issue react
native run iOS or you could open the
project in Xcode or you could run react
- negative run - Android so there's
quite some options you can use the CLI
or you can use the IDE of your choice
obviously if you want to run
applications on your f
you need to have a MacBook or an iMac
you would still get this output if
you're on a Windows machine probably but
it just will not be able to work because
you don't have Xcode or walls or all
those tools but I do have a MacBook so
we can play around with it a little bit
I'll save you
5 to 10 minutes wait of installing all
this stuff after that beforehand and
here with me I have an Android device
and an iPhone so we can see what the
result looks like after you've done that
let's see this is the Android device
I shouldn't rotate it probably here's my
app running welcome to react native it
says and you can probably better see it
on the big screen over there and same
holds for the iOS device it has the same
welcome screen
welcome to react native and it also says
to get started edit fjs and then on
android which is on the right you can
see like you should double top or on
your keyboard or shake or press the menu
button if you were in early you would
have seen me doing this
frantically that's not because I hate my
phone but it is because in terms of the
development menu and using the
development menu I can do quite some
nice features I can trigger a reload of
the JavaScript window for example I
could say enable live reload so that
once I update one of the code files it
will immediately be pushed to my device
and I can see what it does and I can
have the performance monitoring I can
have an inspector to see where or my
elements reside and I have some
development settings that I can go
through to specify how I want to connect
to my macbook for example and on the
iPhone it's pretty similar except that
it says press comment or to reload or
shake for dev menu well let's see yeah
also works on iPhone brilliant reload as
you can see this is small
invar over there that indicates the
files being reloaded and will say life
reload as well now if we go to the
application there's an app dot j s and
as we saw here it says edit epital J's
to get started so that's one thing we
can do we'll save it and at least the
iPhone was updated the Android device
wasn't for some particular reason it's
also updated so I don't know did I turn
it off
maybe enable hole to read out one more
try just to be sure there are other
extracts I miss you mark over there
that's better so as you can see I'm
updating my code and I can see the
effect on my application immediately one
of the things I particularly love about
react native is it's very fast feedback
cycle if you were used to building
native applications using Android or I
mean using Java or using objective-c or
Swift you would have to rebuild your
whole application create a new apk in
the case of Android or a new dot app
file in the case of iOS push that to
your device restart the application to
finally see the effect and here
especially if I'm having the live reload
on I can see it immediately if I do not
have live reload on immediate I don't
see it immediately but I can simply
shake my device press readout and I'm
done well you might say that's awesome
thanks for this but we have three hours
to cover so there's a lot more to say
about this first of all a question I
often get is how does that go diss
compared to other cross-platform
application platforms for example
there's code over
or PhoneGap which is more or less the
same name for the a different name for
the same thing well if you take a look
at Cordova or PhoneGap you'll see that
it uses HTML Javascript and CSS in fact
it will create a web application for you
and it will create a very small Android
or iOS application with just a webview
in it and the webview will in turn run
the web application so in fact it's it's
if you can't run docker on your device
you can have other containerization
technologies and in this case the
containerization technology is actually
a web browser and the application runs
inside the web browser the web browser
runs on your device so I'm not saying
it's a bad thing I'm just saying it's a
different thing another popular one is
examine it got especially popular since
Microsoft decided to open source it so
you don't have to pay big license fees
to get started even let alone to run
this in production for examle and you
write your application in C sharp which
to me as a Java developer I have to be
honest it's quite a big hurdle I don't
know she sharp I don't know if I want to
learn it maybe I will but just to get
things started well but to me it's it's
a it's quite an effort and and as soon
as you start deploying your application
you have to include a mono runtime mono
is the open source implementation of
the.net standard it is a dotnet platform
and it will be packaged with your
application sort of your application can
run on both platforms the good thing is
it's a native application so there's
nothing like a webview
with a web application inside it's just
all native UI elements but well c-sharp
might be a problem for you it might not
be but at least we know the differences
between the platforms now let's look at
react native if you visit its web page
you're greeted with a nice marketing
summary one-line summary react native
lets you build mobile apps using only
JavaScript and it uses the same design
as react letting you compose a rich
mobile user interface
from declarative components awesome it
also determines the agenda for the rest
of this talk because we all have to look
at two main things we have to look at
how we react works in order to
understand how react native works we
need to understand react and then once
we know that we can have a little break
grab some coffee or tea or whatever and
then we'll dive into building mobile
apps using that now react native some
people say well it's it's new it's how
else that support it am I on my own
maybe if I want to use that well you're
not on your own first of all react
native was created at Facebook they've
decided to open-source that first day
open source their iOS implementation
well that's cool but it's not
cross-platform yet then they also
decided to open source the Android
implementation and now it gets really
interesting
but there's other companies using it as
well like Airbnb Tesla Instagram Skype
and there's many many more but they
don't fit on one slide and as we already
saw in the very first quake demo there's
a quite an emphasis on developer
productivity there's quite a lot of
tooling around it
not only live reloading and stuff but
also debugging your application having
UI profilers and inspectors which you
can use to inspect that your app is
indeed running correctly and finally
it's also a framework that allows you to
really test your application quite well
and that's a particularly interesting
thing next to the developer productivity
there's also emphasis on having code
that is testable and we'll see that
later on so as I said we first need to
understand reaction and then the
question might be what is react well
going to its website again because
that's where we all start when we are
looking for
information we will find that Java that
reacts is a JavaScript library for
building user interfaces well that's not
particularly useful yet what can we
actually expect from it
first of all react is declarative second
its component based so let's dive into
each of these two and see what it
actually means
first of all react is declarative that
means that in react you're encouraged to
define your view the views of your
application as functions of the states
that your application currently lives in
and that means that we have more
predictable code because we can easily
figure that if this type of state goes
in and it looks like this then that must
come out it's also easier to debug
search code basis since since they are
usually tiny components and tiny
components are obviously better to to
test enter to debug but there's
something more we also have stateless
components and these are also called
functional components they are more or
less the same as regular components and
we'll see the difference in a few
seconds but secondly react is also
component based component based means
we're again encouraged to construct our
application as as a combination of all
kind of building blocks and the smaller
the building block is the better it
actually is that holds for many many
programming models smaller equals better
the same holes here if I can construct
my user interface from all kinds of
small components makes it easier to
reuse makes it easier to test and it
also means that if my application needs
to store from some state somehow that I
can encapsulate that state inside a
component so I can make sure that the
state is kept at a place where it needs
to be
and that means that we can compose our
application as a set of tiny building
blocks that work together to create the
end-user experience the nice thing is
that if you're coming from an HTML
Javascript background and maybe you've
done something with jQuery first you
might be aware of the fact that in HTML
you can actually pass just one thing
which is text if you want to pass for
example a date value you first create a
string out of it you pass it around in
your dumb and you hope that's somewhere
in the DOM
some component will pick it up and and
do the correct calculation hoping that
it still is a value that can be
interpreted as a date which can be
brittle of course now if you are going
to build your web application using
react you can just false JavaScript
values structures object structures and
that's a big plus when comparing to
traditional approaches so let's look at
some reactive web applications quick
warning up front react heavily uses j6
as well as echo script 6 if you don't
know these they might feel uncomfortable
what does it do I don't really
understand what this construct does in
this language don't need to worry many
people that use react do use echo script
6nj Isaac's and they have able to
convert that into plain old JavaScript
that even Internet Explorer 6 might be
able to run if you're lucky otherwise it
might be it's in Explorer 8 so let's
look at a quick example for that this is
a very simple react component I've given
it a very descriptive name hello message
because as we all know we're a bleached
to start with hello world so I decided
that I should do that as well you can
see that my component is a function it
takes one parameter which is called
props
shorthand for properties but you can
actually name it anything and it will
return a dev element and now I did not
forget the quotes around this I am
returning a div element here
that's j6j six allows us to use XML in
this case HTML but it's of course that's
also external to use XML as if they were
values in my JavaScript program and
inside the div I'm having a little text
it says hello
followed by brackets props name so I'm
assuming that's my props I don't know
exactly what it is but it appears to be
some kind of JavaScript object and it
might have a an attribute called name I
have another component which is called
app app as a function as well which does
not take any arguments and it will
return an XML construct it will return a
self closing tag for the hello message
and it passes one attribute with the
attribute named name to make it easier
and it value is a string literal called
dev hooks and then finally I need to
instruct react to actually mount this
this application this tiny application
of mine into the document object model
and I do that using react Dom API and it
has a random effort now if you would
translate it back to JavaScript it would
look something like this it's a lot more
code first of all it is more or less
understandable
I still have a function and it still
takes props there's an app it's also a
function doesn't take any arguments it
returns reacts does create element
reacts does create element is actually
what happens if you use JSX then babel
will translate that for you to an
invocation of react or create element
and react does create element will take
care of what actually actually needs to
be done there since j6 is not really a
standard yet
there's actually just one implementation
that does it this which is react a
colleague of mine is working on a hobby
project which will not do reactors
create element that will just spit out
some HTML so it's kind of a static site
generator and it uses more or less the
same approach but well that's really
there's not many implementations around
that actually do this and if we would be
running this application let's see I
think it's here I have a index and
there's a div inside the index file
which is called route and as we can see
here it says react Dom dot render the
element somewhere on the Dom now if I
would replace that with the component
that we just saw
now we will make it a little bit bigger
there we agree with some kind of an
error message hello message is not
defined yes of course we need to write
that one as well
we'll be closing the element there hello
there folks not a big surprise really if
we look under the hood we would I hope
this is well it's actually quite good
it's still the index.html file that we
just saw there nothing has changed there
if we want to really see the magic that
goes on we need to look at the browser
inspector I hope this is readable even
if you're back in the room as we can see
here it has a body there's a route
there's a div element with the route ID
and as we can see it has child elements
by now for example it has two child
elements both of them are text nodes in
the document object model one of them
has the text hello space and the other
one has the text devoxx so somehow react
figures out that these j6 elements needs
to be translated to real dom elements
and we'll get to that later how that
actually works but for now just recall
that there is some kind of a mechanism
that turns these j6 elements that we
just saw into real dom elements what we
see is what we saw here is the what's
called the functional approach these
components are just functions that take
their properties as an input and return
some kind of JSX as their output we
could also write them in a class style
again echo scripts x6 provides classes
something that's not in JavaScript as we
currently know it if we would be running
object-oriented code in JavaScript we
would do some function prototype hacks
and then we could invoke new function
and we have something that's well kind
of mimics an object-oriented style but
it's not really object orientation
there's no inherit
turns and you would need all kind of
dirty hacks together really well
still more perfectly well working but at
least it kind of works in script
six and especially Babel take another
approach they allow you to write
object-oriented code using just classes
and Babel will generate all this
boilerplate that takes care of the
inheritance and the classes and and
everything that that sits in between so
we as developers don't have to worry
about that we won't be making we won't
be introduced new bugs there because we
didn't quite understand how object
orientation and function prototyping
works in JavaScript we can just rely on
a tool doing that for us in a correct
way what we see is a hello message it is
a react component subclass and it has
one method which is called render and a
random method again will return just the
div element and our app that previously
was a function as well is now also a
full-fledged class that also extends
reactive component and it also has a
render method and the end of the code
base is still the same I'm not showing
what this looks like when you run it
through Babel because it's I think two
or three slides full of text and most of
them it's not really interesting nor
really understandable so let's just skip
that for a second
you might be wondering why would I
actually be using this this so-called
class a style but it at first hand it
appears to be more code than it was in
the first example and indeed it is more
code but we will see why you sometimes
need this style as well but first in
react data flows in one way it's very
important to keep it in mind it has
anybody been using angular I would
actually expect quite a few hands to to
raise thank you if you are using angular
then your data flows in two ways
actually you have your JavaScript object
model or your JavaScript model you have
your document object model and angular
ensures that these two will always be in
sync with each other and as soon as I
change some values somewhere in my
JavaScript for example as a result of
callback being invoked or something
happens maybe a window does a timeout or
whatsoever then not only my JavaScript
will be updated but also the document
object model will be updated on the
other hand if I update my document
object model for example because I type
some text in an input field the
corresponding JavaScript object is
updated immediately an angular ensures
that the two will always stay in sync
now I'm not here to bash angular
whatsoever so I'm not going into any
disadvantages that that might have that
approach but that's just how angular
works react takes another approach and
reacts dictates you that your data
should always flow in one direction
meaning that if your application is
running you have two ways to model your
application stage one of them is props
and the other one is state of a
component as we saw earlier you can
encapsulate state in a reactor
application you do that inside a
component and these two the props with
which an element is being rendered and
its internal state they determine
together what the element actually does
and how it actually render it to your
done
now people often find it hard to tell
the difference between props and state
it's pretty simple props come from
outside so they are supplied when the
element is being rendered on a page or
being rendered at all and for the
component it's as if they were immutable
you can't change them simple as that
whereas state is something internal to
the component an outside component can
never interact with your state so it's
like private variables and they are
read/write so you can modify them and
the one way in which data flows is that
it flows from top to bottom or from
parent to child if you wish your react
application as we saw in this very
simple example over here and starts with
a root element in our case it's the app
and the app is like the root
the whole application well in this case
its head has just one child so it's not
very interesting application but just to
illustrate the example and the hello
message has one child element which is a
div and the div has two child elements
both of them are Dom nodes of type text
but that might lead you to the question
how do I actually handle user input or
add the other actions that the user
might be doing on my application because
data flows from top to bottom from
parent to child where can i hook onto
that and the answer is pretty simple
because it's actually comparable to what
you have been doing with other web
application frameworks you just use some
kind of a callback or an event handler
to react to an event being happening
inside your application and since these
are just like regular Dom event handlers
you can do pretty much anything you wish
you can run validation logic on on input
elements to see whether some kind of
value meets the business validations
that need to occur are you indeed at
least eighteen years old that you agree
with our terms and conditions that you
didn't read either way or they can for
example update the state of a parent
component that means if I have a
component for example an input I could
have I could supply it a function as a
callback to be invoked when something
inside that child element happens to
occur and as soon as that occurs the
function is being involved but the
function runs in the scope of the parent
element and a search can only update a
state of the parent component we'll get
to that in a minute how that actually
looks we can access for example browser
storage most modern browsers have local
storage in session storage we could
perform HTTP requests we could do pretty
much anything we like
now as I said we have two ways of
writing components we can write them as
a function in more or less functional
style and we can write a script six
classes and why would you actually be
doing that well this is a very simple
example we'll just take a look at it in
E or well ID in the editor either a
small component it's called a counter
and it extends from component react
component inside the constructor
I can initialize a piece of state as you
can see this state is local to this
component and the state is a very simple
JavaScript object with just one property
called counter and a default value and I
can define a function that lives over
there and the function is bound to this
instance of the class this is just a
workaround because the dis scope in
JavaScript still doesn't work as you
would expect from other languages so
it's just a bit of boilerplate you need
to do this otherwise when you run this
function then this will be undefined now
this being undefined will never allow us
to invoke the set state function on it
obviously now my random method is also
pretty simple I have a div element
inside the div element is a button with
some kind of a text and the button this
is just a very thin wrapper around the
HTML button element allows us to specify
an on-click
property and unclick property should be
a function and the function will be
invoked at the click of the bottom now
what we can see is that it will invoke
this not increment and we saw here that
this dot increment has been bound to the
correct this instance so this function
will run and will invoke these dots at
counter and if we would be running that
bless you
as we can see we have a text over there
let's increase it a little bit
it says clicks zero and have this button
increment and if we look at our source
code we can see our egg my script six
code here it's a nice feature of many
tools around in the react environment
that they have some kind of source
mapping so what we see here is the code
that we wrote not the code that's
actually being run in the browser but
just the code that we wrote we can put a
breakpoint in there we can click the
button and as soon as we click the
button the debugger pauses inside that
method and we can see around what was
happening so this button is just a fin
wrapper around the HTML button and as
soon as I click the button some kind of
function is invoked allow the function
to run and as we can see it sets a new
state where it looks at the current
state increases the counter with one and
then puts that back as a new state and
well it's not very high-end logic but I
can keep on clicking for a while so like
- so we can update the state of parent
components from inside child components
but only because we give this child
components a function and that function
somehow needs to live somewhere else and
in this case it lives on the class and
that means that it can access the state
of this class in this instance of the
class and update it
now if you're like me and you see this
at first I was impressed
wow it's magic I can have JavaScript
returning XML and it that's immediately
and it just knows how to want to update
things and I don't have to care about
that there's no binding or whatsoever
hot but wait a second how does this
actually work and to understand how this
works we need to go one step deeper
obviously and look at how react does
this internally and the main concepts
that react uses is its notion of a
virtual Dom the virtual Dom is just what
it says it's a virtual document object
model it's not the real document object
model it's virtual it lives somewhere
inside the JavaScript runtime and it's
actually a copy of what the document
object model of that page looks like not
the whole document object model but just
the part that we used to mount our
application to remember when we have a
reactor plication we do something like
this react Dom render and we supply it
one document object model node and react
will have a copy of everything under
this particular Dom node will have a
copy and the virtual Dom is just a
shadow copy cells to say where react
will do its magic so it will look at
that and we'll look at the actual Dom
and we'll keep try to keep those in sync
now the act the actual Dom is at the end
of the day just a simple computation
over the props and the state of your
application which returns into some
updates of the virtual Dom which will
which turn into updates of the real DOM
and whenever your props or your state
change react will update its virtual Dom
for the element that was concerned and
optionally also for its descendants and
it will recalculate that virtual Dom and
decide what has changed in the virtual
Dom now we have a difference because
there's this actual Dom that lives in
the browser and that we can actually see
because the browser renders that for us
and there's this virtual DOM and that
has updated elements might have been
added the elements might have been
removed as fur Beautif Islands might
have been changed and we need a way to
reconcile the two and react calls that
reconciliation very appropriate name
there and it's based on two major
assumptions the first assumption is that
two elements of different types will
always produce a different subtree for
that element and the second assumption
is that you can hint as a developer
which jazz elements may be stable across
re-renders let's look at that how does
this reconciliation actually work
imagine we have two elements one of them
from the actual current dom the other
one from the updated virtual Dom how can
we decide what to do
first of all we can check whether these
elements have different types if they
have different types we just assume that
the old subtree is not valid anymore and
we can tear it down completely and build
a new tree from scratch now if the two
are both Dom elements and they have the
same type then we can assume that only
some attributes might have changed and
we can just update the Dom attributes if
on the other hand they are react
components we need to verify their type
if they are the same then we will be
reusing the same instance of the ACMA
script six class why is that that is
very simple it's there so that we can
maintain the state of that particular
instance and once we've done this we can
easily descend into child elements and
repeat the whole process now this might
look like a very complicated approach
a lot of work and we need to keep the
two copies in sync but the thing is
don't manipulation in many browsers is
still a very expensive operation
what react actually does is that keeping
this Shadow Copy simply because object
manipulation in JavaScript is much more
faster than actual Dom manipulation and
doing all this calculations about react
components being rendered and probes
changing and States changing can easily
reflect to updated object structures in
your JavaScript runtime and what we try
to do is minimize the amount of changes
that need to be performed on the actual
Dom something to note is when it comes
to child elements of the same type
imagine for example that our application
has a list of locations where you can
attend devoxx very important list of
course well it might look like this
there's Antwerp and there's London and
now another devoxx comes up for example
DevOps France so we need to add Paris to
the list now if you take into
consideration the algorithm that we've
just discussed you might think okay
there's new child elements so we need to
tear down the whole UL element and then
re render it because child elements are
also properties of the parent in react
speak well that's that's not a very
efficient approach and that is why react
allows you to specify keys and if you
specify a key on a child element for
example in this case you specify a key
on the Li tag you're saying to react if
we are re-evaluating the whole tree as
long as the key stays the same the
element is the same and you don't have
to tear it down and build it up again so
now if we are Paris react can easily see
that the first two elements are the same
because their key is the same and will
not tear them down and not build them up
again and base
it allows reaction to match the old
subtree with the new subtree so quite a
big impact on performance that gonna
have and the only thing that you as a
developer should do is make sure that
the key is some stable value so as long
as the element stays the same the way
that you calculate the key should also
stay the same stay the same and what you
often see is that people just iterate
over an array for example each element
in the array should be a new Li tag well
what is easier than just just using the
index of that element inside the array
as a key it's stable it doesn't change
when I update the array except when I
add something halfway in between but
then again I should indeed replace some
elements now we already saw that
components have a render method or they
actually are a random method if we write
them in a functional style and if we
write them in a class style we we ask
this special method called render
actually render is just one of many so
called component lifecycle methods and
these are divided into a few categories
the first category is as well mounting
if we have a react component the first
thing that will be run by the JavaScript
engine is a constructor of the class
obviously because if we do not have a
constructor being run we can't
instantiate the class and we can't use
the component second react will invoke
the component will mount methods if it's
there most of these methods are not
required you can easily leave them out
if you don't need them but you can
define them if you need them to hook on
to this lifecycle component will mount
just as the name suggests will be
invoked just before the component will
actually be mounted onto the page during
mount the random method will be invoked
which allows your components to do
what in fuel what it's fuel looks like
and after death it will invoke the
component dismount function and
component did mount obviously is just
there to indicate I have just been
mounted to the page now I might want to
do some final things before sitting here
and waiting for user inputs to happen
now if for some reason any of my parent
elements updates
maybe my element will be will need to be
updated as well in that case we first
have this method that's called component
will receive props and it will be
invoked just to indicate that the
component will be receiving new
properties this one is particularly
interesting it's called chute component
update and it's a way for your component
to tell react okay thanks for these new
properties but that doesn't change
anything for me so you don't need to
rerender this instance you don't need to
re-evaluate whether whether it's subtree
is still alive because i'm not
interested in this new properties and
the method will receive the new
properties that are about to be used for
rendering the component and it will it
should then return either true or false
saying yes I need to be updated or no I
do not need to be updated then just
before your component will be updated
there's a hook method called component
will update indicating you are now about
to be reacted to be rendered then the
random method will be invoked again but
now with new props and finally to
indicate that the object has finished
there's a component did update
indicating the update has now been done
or child elements have also been updated
and we're returning of the tree
for some reason your component does not
need to live on the page anymore
that's called an unmount that's that
basically says the component will be
removed from the page and there's just
one method to indicate that saying the
component is about to be removed from
the page you can do some cleanup if you
wish you can maybe store your
preferences to local storage disconnect
WebSockets do whatever to prevent
resource leakage but prepare to be
removed and disposed off and then
there's a few other component methods
again these aren't required but you can
add them to hook onto that particularly
particular event being a being there for
example there's components did catch a
component did catch is a method that
will be invoked if it's there whenever
somewhere in the lifecycle of itself or
its child components a JavaScript error
was fraud is there since react 16 which
is by the way not yet included in react
native just a bit of it but we'll soon
be updated probably and it allows you to
to hook on to unexpected errors being
being thrown somewhere there's also a
set state we already saw that one set
state is a method that you actually
inherit from the component class set
state is there to allow you to update
your own state and will look to that in
a minute
and there's fourth update which is
actually the inverse of shoot component
update your with should component update
I can indicate that I don't do not need
to be updated with force update I can
tell react I need to be updated
maybe for some reason you did something
that did not trigger a reconciliation
well using the force update you can
actually enforce that to happen a few
words on set state set state if you come
from a Java black background you might
be tempted to think that it would
set the state of the component it does
not set state is actually a request to
update the component state and that
request can come in is passed as the
first parameter to the set state
function and there's a second parameter
you can optionally supply some kind of
callback that will be invoked after the
state has been changed now what does the
state change look like it can be two
things it can either be a partial state
that's the approach that we saw in the
example with the counter it's just a
JavaScript object with some properties
and that will be merged with the
existing state that might be just over
writing if the shape of the two objects
is the same it might be merging if you
add new properties the other type of a
state change is actually a function and
the function will have two parameters
the first parameter is the previous
state and the second parameter is the
current props with which the component
is being rendered and you should return
again a partial state now this is really
noteworthy to keep in mind if you start
developing with react because if you do
not know this you might be tempted to
think that I just in folks set state and
I updated my counter why was it not
updated one line below
well because it's a request to update a
state change and what react actually
does is that it allows itself to batch
up a few of these states changes and
then run them in one run run them at
once and that's actually just a
performance optimization because that
allows reacts to do just one
reconciliation instead of a lot of
reconciliations so this is all for react
in this room for some questions
right now about react itself and the way
of working with react are there any
questions I didn't know at this moment
no hands great then it's time for a
little break get yourself a coffee or
some soda and see you see you in 15
minutes welcome back I hope you've
enjoyed your coffee or other drink and
first of all congratulations for
surviving the boring part of the talk
we've not covered react at all
I mean react native we didn't cover
react native at all and with a title
building react native applications you
might be disappointed I hope that the
second half will not disappoint you at
all
because what we've just learned so far
about react is necessary to understand
how react native works so let's get back
to this one-line summary from the react
native website we have seen the design
of react we have seen how it works under
the hood we've seen what kind of
thoughts lay behind its design and now
that we know all this we can focus on
building real native applications let's
go first of all I want to take we take
you along the internals of react native
we'll see how a react native application
starts once it has been started how it
executes and what a drone time looks
like so application startup in a typical
react native application you'll have
your apk or dot app file that you can
ship in Play Store or App Store of your
choice and this is just one big file but
inside this file are a couple of things
first of all there are some native
modules native modules is code being
provided to you either by react native
itself or by any open source components
like you might be using or maybe you've
written some yourself and there might be
a JavaScript VM inside your application
and there's a JavaScript bundle and
scrip bundle is just the combination of
old JavaScript code that you've written
and that you've been using in your
application as your application starts
you'll your application will load all
these free parts when the native modules
as well as the JavaScript VM have loaded
and the JavaScript VM has been
initialized it's ready to load some
default configurations which is provided
in a JSON format and you typically don't
need to touch it but it's good to know
that it's there and once that has also
been done the JavaScript bundle will
have been loaded as well and your
application is ready to run the
JavaScript that you've either written or
reused and this JavaScript execution is
actually nothing special it's just as
well you might be expecting when you
come from a weapon background Java
scripts inside a react native
application is executed by JavaScript
core JavaScript core is the JavaScript
runtime that comes with WebKit and
WebKit is the rendering engine that
powers the Safari so that means on an
iOS device you can be sure that there's
always Safari installed and always
WebKit will be installed and so
JavaScript core will be there on Android
you can't be sure of this and that's why
in an android application file there
will be a JavaScript core implementation
packaged along now your application will
be running inside JavaScript core except
when you're debugging you can debug your
application even when it's running on a
mobile the physical device so not on an
emulator but on a physical device you
can debug it using Chrome a chrome will
attach to the JavaScript process notes
the other way around
your app will not your app will be
running on your computer at that moment
so the JavaScript runtime is in chrome
so it means it's v8 not JavaScript core
and the JavaScript engine
inside your computer will then talk to
the native modules that live inside your
phone to do all the things that need to
be done on the device and the process
for that is really straightforward it's
just like any other JavaScript runtime
it starts with parsing this this
packaged JavaScript which is called the
bundle if it has been parsed it can
generate the abstract syntax tree for
that the abstract syntax tree can then
be translated into byte code in the byte
code will be run on the device it's not
nothing really special there but then
you might be wondering where's the
native part of all this because it's
called react native so it has to do
something with with being native right
well that's what this picture tries to
explain your program as I said starts
with executing a bunch of JavaScript
this JavaScript will do a few things it
will create shadow views of all the user
interface elements inside your
application this is what we just saw in
the react web environment it's the
shadow Dom well here's not a shadow Dom
because an a mobile application doesn't
have a document object model but it has
a shadow copy of all the views inside
your application these will then Bay be
laid out according to the constraints
that you give it and the JavaScript
execution will also instantiate the real
native views these are the native UI
elements from either Android or iOS and
that's what makes sure that a react
native application always not not only
looks native it also feels native it
feels native because it is native it
just uses the same UI elements that are
in each and every other mobile
application for that platform if the
layout has been constructed and the
native views are being built up your
application is ready to put them on the
screen which is just called rendering of
course and that means the USA end user
can see them now if you interact with
your application for example you
upon a button or you you swipe left or
whatever you do you you try to stop the
application that's kind of you
interaction between you and your
application that interaction is being
handled by the UI kid
the UI kit is just a tiny bridge into
some native modules that do the actual
event handling and that will in the end
invoke the callback handlers that you
have written in your JavaScript your
JavaScript execution also starts some
bridge module that actually provides the
bridge between the JavaScript world
living over here and either the iOS or
the Android world living over there
which is the native modules react native
consists of a bunch of JavaScript files
which is the API that you program
against and also a lot of native code
either Java or Objective C which
provides all kind of implementation
details for that specific platform and
when you run react native in it as we
saw at the very beginning you also get a
few of these files generated for you
because you can't run an application
without having at least some kind of
starting point let's take a quick look
at that that's over here as you can see
there's a folder structure created for
us there's an Android folder inside the
Android folder yes it's an app folder
inside the app folder lives a source
directory which in the end contains some
Java files for example these this is
just a activity if you're used to
Android programming you know that
everything in Android is an activity and
it just extends some kind of react
activity that comes from a shared jar
file and there's an application that
comes along with some some some some
generated defaults and of course there's
a manifest file as well and a manifest
file is packaged together with the
application
to describe what the application looks
like what the icon which icons there are
and what I what the main activity is
more or less the same holds for iOS
except let it is better to watch in
Xcode as you can see it generates a
standard Xcode project for you with some
objective-c files like these we don't go
through these because they're not
particularly interesting but that's
actually where the starting point for
your application and it tries to do
nothing more than then bootstrap the
JavaScript environment load the bundle
and then have the JavaScript to do
whatever it needs to do now now that we
know what the basic structure is of a
react native application it's just a
JavaScript runtime which tries to
interact using native modules with UI
elements of the platform a lot of new
questions can come to mind like how can
I make sure that my app looks okay how
can I invoke the REST API is how can I
store data how can I test my application
package it what do I do with State and
data inside my application and we'll
dive into each of these in the following
time first of all when it comes to
styling this is a JavaScript environment
but it's not a browser and that means
that there's no thing such as CSS so if
you think oh it's just JavaScript
I know CSS as well so let's get going
that's not how it works
that's not how you can saw your
application but all the components that
come with react native do accept a style
property and as we saw each property in
react native is a rich structure
potentially not just text we
can supply objects to this style
property to tell the component what it
should look like now what is such a
style that we can pass along react
native comes with an API that's called
the stylesheet API you invoke its create
method and supply it with a JavaScript
object structure here I have a very
simple example I define just one style
which is called red and the red style
you know maybe it's not a good name
because it's also the name of the color
that we're using the red style says that
everything that's styled using this
style should have a red color we could
also have picked the RGB notation or
hexadecimal notation but my personal
preference is just to use names because
that rates a lot easier and now if we
have this hello a component again then
we can see that we just supply the red
style to that component let's see my
apps are still there this one's also
still there what if we would say for
example this instruction style it's all
nice but I don't like this color I want
it to be red well as you can see it
reflects immediately because live
reloading is still on and the
instructions style that was there used
there has now this new text color which
is red I think it's something like font
style but I'm not completely sure about
that one nope
empty not what I was expecting well
let's remove it again still empty that's
better
what you did not see in the meantime was
that I can show that by the way if I do
something that's not understood font
style for example bold now what we see
here is the default error screen of
react native and what it says you've
been using a font style prop and it has
the value of both but I didn't quite
expect that there's a decomposition of
what style I used effectively and
there's a stack trace which is somewhere
deep inside react native itself so that
doesn't really help us but at least we
can see that we did something wrong with
the styles and that we should fix that
and apparently there's no thing as a
bold style it should be either normal or
italic no okay we can change that to
italic and apparently after an error the
hot reloading is broken somehow and we
should manually reload it like so well
we can also define new stars we could
for example give it a divorce style
background color should be yellow not
sure if that's compliant with the
official look and feel of their works
but what gives and we could for example
change that part of the user interface
and now it gets a yellow background
there's a lot of a lot more style
properties that you can use each
component that it's inside react native
has its own documentation of what styles
it accepts and what the effect of them
are it's not only about the colors and
the size of your fonts it's also about
rendering layer laying out your
components should it span the whole
screen should it you'd be just 50% how
should it align to other components so
there's a lot of things you can play
around with but the thing to keep in
mind is that this this is not CSS that's
very important one of the consequences
is that you need to use different names
for example it's not font - sighs its
form capital s size and there's a lot of
more of these because there's no -
obviously when you want to write a
JavaScript property it also means that
you do not have inheritance like you
would have in CSS if you would have
elements nested inside each other they
inherit their parents style and that's
not the case with react native styling
you can do a little trick which kind of
circumvent this circumstance this it's
not very elegant but it does work what
we see here is that we have a small
object which is called the screen and
I'm saying that it should have a red
color it should have a bold font white
weight and it should be size 40 and now
I want to create a new style which
actually inherits all the other things
now I'm doing that by starting with the
triple point screen which is a very new
JavaScript construct called object
decomposition or
says is on decomposing the screen into
each of its individual properties color
font weight font size and supplying
those as new properties to this smaller
variable and then finally I'm often
writing the font size to be 20 instead
of 30 and a result will be a new object
with properties color red
font-weight:bold and font size 20
instead of 30 and now I could use the
stylesheet create method and there's
another neat ACMA script 6 construct
which is called object decomposition and
it says if you have a variable in scope
that's called screen you don't have to
write screen :
screen saying there's a screen property
in this new object and its value equals
the look that the screen variable that's
currently in scope that's a bit bit
verbose instead we can just say I'm
creating a new object it has two
properties one of them is screen and
it's value equals the variable screen
that's currently in scope and its other
properties called smaller and value for
that it's the variable smaller than this
in my scope so that's all there is to it
you you do have some ways to start your
application to layout components in a
way that they interact with each other
but you do have to keep in mind that's
the rules that you might know from CSS
do not apply in this world second
question is about working with rest
api's and here it's really very
important to remember that in the end of
the day we're just writing javascript
code and if you're using javascript it's
pretty easy to invoke rest api so of
course we've been using jquery and
friends for decades and that worked
quite well but in newer browsers we also
have the fetch API and the fetch API is
a proposed standard that is
as far as I know implemented by almost
all browsers the fetch API defines a
method called fetch that lives on window
object so it's always in scope and the
fetch method as we can see in sight this
little code snippet first accepts an
address that should be invoked and
secondly I can pass an object with some
options for this request for example I
can say that I want to have a get
request which is by the way to default
so it's a bit obsolete here but just for
illustration but I can also specify
custom headers that should go with my
request and in this case I'm for example
telling that I want two extra headers
one of them being and accept header and
the other one being an authorization
header with some kind of nexus token as
we can see in this line as well as in
this line there's another special sin
construct which is called string
interpolation it's indicated by not
using single quotes or double quotes but
using tactics and as soon as you write a
string that's surrounded with tactics
you can easily interpret variables using
the dollar accolade signs so here I'm
referring to some variable that is not
displayed but live somewhere telling me
where my back-end API lives here I'm
referring to a local variable that came
in as a method parameter over there and
I'm just putting that together with the
text bearer space to construct a new
string bearer space yadda yadda yadda
some kind of a token now if I invoke
this fetch method I do not get a
response instead I get a promise
promises are also part of newer
JavaScript versions and they're a bit
like a synchronous process programming
in other languages like Java or C sharp
maybe also as well a promise is well
just what it says it's a promise to
deliver a value at some moment in the
future we don't know exactly when the
from his will be resolved but it will be
resolved that's part of the deal now if
the promise is resolved we can tell the
promise API I want to have a callback
method invoked as soon as the promise is
resolved and that and you do that by
invoking the done method on the promise
value well in this case we're referring
to another method that lives just a few
lines above it's got the process
response method it gets the response it
tries to read the response data and
parse it says Jason now the thing is
that this also is a method that returns
a promise so we have a promise that
returns a promise and once the second
promise is resolved we can check whether
the response was actually okay if so we
can return the parsed jason just as a
javascript object or otherwise we can
return a new promise which is rejected
immediately as we've promises between
humans promises in computer science can
also be broken and in javascript world
is called promise rejection it just says
well I promised to give you the response
of this this jason invocate this this
rest api but i'm not going to do that
maybe the access token has expired maybe
the api is down we have a network issue
we it could be all kinds of things but
somehow I was not able to keep my
promise I'm sorry to disappoint you
here's a rejection and in that case it
will eventually become when you've
transpire your code using table an error
that will be from and your application
needs to deal with that now finally to
complete this tiny javascript file we
just exported the retrieve projects
method and from our react component we
could just say in
Adri retrieve products from well
wherever this code appears to live and
it will give us a method that when
invoked returns a promise and when the
promise is resolved using this data
variable we can for example update the
state of that component so that it will
reflect the data that we have just
retrieved from our API and that's all if
you will be writing a JavaScript
application using react for the browser
it would look I think 99% the same
there's nothing special as this is
nothing react specific react native
specific here in fact it lets you reuse
the knowledge that you already have from
your web applications and you might even
be able to write some common JavaScript
modules that you can just upload direct
to MPN or something so that your web
application and your react native
application use part of the same
JavaScript code base second thing would
be storing data on the device that's an
interesting thing because as we saw
react native allows you to write code
that runs on two platforms two very two
to two platforms that are very not
similar they do not share a lot in
common
so what react native does here it
provides you with an API that abstracts
away all the platform specific details
and this API is called the async storage
API the async storage API is just
another JavaScript API that's completely
react native and it allows you to store
and retrieve any kind of data that you
would be that you would want to store in
your application if your app runs on
Android it looks to see if rocks DB is
available if it is you will use that one
otherwise it will use sequel Lite if
your app is running on iOS it will look
at the size of the data that you try to
store if it's smart we'll put it in a
dictionary if it's
logic will put it in a distinct file
somewhere on the device but for you as a
programmer it doesn't matter you don't
have to know you don't have to care
about this because the ACH storage API
abstracts away all of these
implementation details for you what does
it look like
well writing some data to retrieve it
later it's just a matter of invoking
that set item method on the async
storage API you need to supply two
things you need to supply some kind of a
name or key so that you can look it up
later
and you need to supply some value my app
wants to store the user name that the
user has chosen to login to the system
and apparently this is just not a capiz
it's not from alphab from belgium from
brussels but that doesn't matter and
again the name actually already is kind
of a giveaway it's asynchronous so this
method also returns a promise now
sometimes you don't want to return a
promise as well sometimes you just want
to wait for the promise to be resolved
or rejected and you can do that in
ActionScript 6 with the new await
keyword that we see here if we would say
a wait followed by some kind of
JavaScript construct that gives us a
promise babel will read will generate a
lot more JavaScript then that we see
here which does a lot of magic which
basically boils down to ok with this
promise we keep on waiting until it is
either resolved or rejected and if it is
rejected well we might not be able to
conclude in a normal way so an error
will be thrown and we can do some kind
of error handling we can maybe show a
big red screen or just some notification
message loading data is pretty similar
you just invoke to get either method the
- method needs just one parameter the
name of the value that you want to
retrieve again this is an asynchronous
API so we can use await keyword this
time we are actually interested in the
result of the method so we can say my
username equals the value of a waiting a
promise delivered to us by the Asics
torch API and just in case there was no
item stores before we will get back a
null value so we can either return the
username itself if it wasn't no or an
empty string if it was no and again
since this is this using the await
keyword we need to catch an error that
might be from when the promise is
rejected next thing would be testing
your application
we already saw that applications are
composed of small building blocks
components and these components can be
expressed as just functions of the
properties that they received in the
state that they've built up themselves
and then the question arises how can I
test such a component well first a very
naive approach would be something like
this I have my component it returns a
div element so I can use JSX it allows
me to inject XML values as if they were
JavaScript variables so I can just
invoke my method give some props and
expect the outcome of that math that
that method invocation to be some other
XML literal value what could possibly go
wrong
well one thing that could go wrong is
that you get an test failure and one
that's not really easy to understand it
says expected value to equal something
else but the expected value and the
receive value are pretty much the same
as far as we can tell from this error
message that's strange
why doesn't that work any clues spaces I
hear someone say spaces that
was split into two Dom elements that's
true and that might be the reason any
other thoughts no other hands one is red
the other is green no that's just how
it's being printed to the console now
the reason why this doesn't work is that
the random method as we saw returns a
JSX element bait but a j-6 element is
not something that's natively supported
by any JavaScript runtime environment
so what bebo does for us is it
translated into an invocation that looks
like this
return react dot create element and if
we invoke this function twice we get to
react elements that do have the same
type but there are separate values they
simply aren't the same so we need
something better for testing we can't
just invoke the method and hope that the
XML values will match wouldn't it
actually be cool if we could render our
components inside some kind of runtime
environment and then invoke any
expectations on the rendered component
well turns out you can do that react
comes with the react test utilities and
air BnB one of the companies that use
react native a lot also have written
their own extensions to death which
they've called enzyme I don't know why
they chose that name but that's what
they chose and let's look at two methods
for testing your react component the
first one is called shallow rendering
and shallow rendering isn't a project
you would use if you want to test just
your component and not do any
verifications or expectations about the
child components that live under it so
if we remember the hello message
component that we've seen earlier and we
could write a simple test test case that
says it should render some kind of
expected text we would invoke the
shallow method from enzyme pass it the
react element using the props that are
needed for our test case and we get back
some kind of wrapper object in the
wrapper object has all kind of methods
that we can use to inspect it for
example it provides a text method that
we see here and that will return all the
text elements that live under it but
only at the very first level so if
there's any nested elements we don't see
those we see just a text of the
immediate children of my hello message
component and we can verify that the
text indeed equals hello divorce if for
example I would have a very different
component for example I have a shopping
application and it has a component that
that I can use to show all the products
that my shop has to offer I could see a
low render the list of items component I
would posit a simple array of components
say x y&amp;amp;z and I could use another of the
wrapper methods to inspect what's the
component has done and in this case
we're looking for any child elements of
type item and we expect that there will
be free of them we could all could also
check that each of them is passed one of
these items from my source array but we
cannot use shadow rendering to verify
that they did indeed render the product
correctly we can also verify that they
are there and they have some props and
that's about it we we can't do anything
deeper than that if we wanted to dive
deeper and want to verify that the child
components are also working properly we
need full rendering and full rendering
is something that tries to render the
whole tree and subtree of your component
but that means you need something like a
document object model to to run it in
you could use jazz dome for that or you
could
you the real browser for that it doesn't
matter but you need either of those and
if you would do that you would use the
mount method from enzyme for example you
could use some some other testing
library that you prefer to create a step
function and then you could say okay if
my hello message is being mounted to the
page is somehow invokes this method and
well that is possible because the hello
message is really mounted to a page when
we useful rendering it's not shallow
rendering which basically returns to
invoke the function now it really clears
up a document object model it attempts
to run react mount the component that
you gave it and see what manipulations
that does to the underlying document
object model and that means that it also
runs all of the lifecycle methods that
we have seen before the break or we can
verify that these have certain effects
for example invoking an API to retrieve
data or storing user preferences
somewhere which brings us to the
question okay but there's also event
handling how would we test that well
again enzyme helps us with that we don't
need full rendering for that we can do
that with shallow rendering again we
need to create some kind of a mark or
stop that we can do our expectations on
we will mount our custom button we have
somehow requirements that cannot be met
by the standard button component so we
have our own button because if we didn't
invent it ourselves
it's probably not good so we invent
ourselves a new button we supply it an
action and now what we can do is we can
ask the rapper
to find a chart element inside my
awesome button and we can simulate an
event happening on that specific child
in this case it's the click event and
when that fires we can then expect
we can verify that the dummy has indeed
been invoked now since this is all a
synchronous event handling is part per
default asynchronous process you might
need to actually write your tests a
little bit different by saying set a
timeout inside the timeout I will be
verifying that my stuff has indeed been
invoked and I will give the timeout a
default of for example 500 milliseconds
and my test case has only succeeded if
the timeout was invoked and it was
running correctly
okay so we've built our application
we've made sure it looks nice on both
devices both platforms we've tested it
using unit tests we know it's good we
want to upload it to the App Store in
the Play Store how do we do that with
react native comes a bundler and they've
recently pulled the bundler out of react
native and given its own name they've
called it the Metro bundler it's a
JavaScript bundling tool specifically
meant for react native and what it does
it looks at your javascript files that
you've written yourself it looks at all
the JavaScript code that you reuse from
other libraries that you might be
downloading over NPM or whatsoever and
it bundles all of these into one big
file the dot bundle file now depending
on what you are currently doing it will
do one or one of two things if you're
developing your application right now it
will just serve that file of each HTTP
as we saw we can even enable hot
reloading so that the server will push a
re bundle file over the network but if
we are preparing for production we
not want to be dependent on some kind of
packaging process that lives here on my
macbook obviously so in that case the
burner will do something different if
you write a bundle file to disk and the
bundle file can then be included with
the application to to be packaged
together now if you want to make a
production build the processes are
slightly different for either platform
on Android you need to create a signing
key first apps that are to be deployed
in the App Store the Play Store need to
be signed you can generate a key
yourself using the standard key tool
that comes with Java then you would
update your Gradle file to point at the
correct keys and supply it the password
for the key and what can find it then
you need to build the release apk file
using Gradle again using the assemble
release target and you would probably
fetch some coffee at that moment because
it takes quite a while it will compile
the Java code which is not really a lot
it will do the whole bundling process it
will do Dec saying it will do
unification you can hook pro-gard into
that there's quite a lot of stuff going
around before that process has finished
and once you're done you have your apk
file for iOS it's a little bit different
first you need to have an Apple
Developer account that means you pay
Apple I think $100 a year enable to be
able to publish applications other than
on your own phone you need Xcode you
need to tell Xcode that you have this
Apple Developer account and that you
want to sign your code then optional but
highly recommended enable app Transport
Security inside your iOS application
after security is off by default on
react native it's a tiny switch that
tells your application to only load load
resources over
connections during development your
packager is running on your Mac or on
your your Windows machine it doesn't
really matter and it's running off plain
HTTP so not HTTP and that's that's okay
for development purposes but on
production builds well we're not
depending on the package here anymore
and if we are invoking remote api's
there are probably API that allow us to
purchase stuff or to retrieve user user
information or whatsoever and it's a
good practice to have that over HTTP by
default so that's why you need to switch
on at Transport Security then you need
to build your application there's a
shortcut for that and Xcode I think it's
a poor B and again you can grab a coffee
at that moment because it takes quite
some time so before you go to production
you know we'll have have at least two
coffees now looking inside the apk file
apk is basically just a zip file so you
can just look at it using unzip as you
can see my app was built for the AR M
platform fee seven and it's a release
apk meaning that it has been signed it
has been dext it has been compressed
using ProGuard inside the APK file we
will find an assets folder the assets
folder contains forms and and stuff but
the most important thing is it contains
an index dot android bundle file which
is the whole minified javascript bundle
that is optimized for running in
production it also contains rest folder
where the the layouts live and some
images if we packaged them along there's
a classes.dex file which is just
standard Android stuff again and there's
a Lib folder and that contains all the
shared libraries native code for the
Android platform now for iOS we will get
an adult app folder and if we look
inside that there's app icon dot PNG
it's just a bunch of PNG files that are
just the icon
for my app in various formats there's a
big file with the name of the
application it's a binary file which is
actually one binary for two different
architectures in this case when I build
up my Mac gave a binary for both a RM 7
and a RM 64 and again there's a big file
which is called main dot J's bundle I
don't know what it has a different name
then on Android but it has a different
name
and again it's the minified javascript
bundle let's see if we can find that one
back
it's a big bundle phallus around 500
kilobytes as we can see here we could
look into that and we'll probably see
that it has been minified it's not
really easy to read anymore but that's
not important we're shipping this for
our end users and there's just one thing
that we are concerned off and that's
runtime performance
we don't need stack traces anymore
because if things go wrong we're not
there sitting next to them so we can
look at their screen
we can't debug it anymore because it has
been distributed over the Play Store we
don't know where it runs the only thing
we care for is that it's really fast so
every thing that's not particularly
interest is just minified - names like
an e r io AF and s for example we have
no clue what it does but it doesn't
matter because the packager took careful
of us for us
next topic managing state and data in
our application let's think again of the
example where we are building a shopping
application and our shopping application
is probably something like this of
course we have a root element at the top
when we start the application we have
some kind of a loading indicator that
weight was some data is being retrieved
over the network and then we have a list
view that shows us the most favorite
products or the best buys for this
moment using some items from list view
showing separate items and if you click
on an item you can get a detailed view
now the thing is if if we're building an
app like this we know we are encouraged
to encapsulate State at the place where
it should live for it's for just for
that component but but there is some
state that is global things like user
names for example or exes tokens if we
use Oh Alfred or something like that and
where would we need to store that we
could say okay well the app is just
responsible for getting all global
variables but that doesn't solve the
question because if that if if we
determine those values in the root
component we're not going to pass them
down through the whole component tree
back to for example a detail item if you
that retrieves some extra information
using the API and but that would mean
that our loading screen and the ListView
and the item fuel they all need this
this access token or this user name they
don't do anything with it they just pass
it down to their child components that
violates the separation of concerns that
makes our components less reusable
that's really not a good approach so
what else could we do one of the
solutions that you could employ to
tackle this problem is radix and just to
make sure radix is not tied to react
native
you could use Redax in web applications
in your browser you could use radix even
for common client applications that you
run using nodejs and you can use it also
in react native applications now radix
is centered around three main principles
the first principle is that State
application state is a single source of
truth so there's just one state and it
is not copied just one value the second
principle is that state is a read-only
thing so once I have established my
application state it's not mutated
anymore that's interesting because if my
state is read-only and I'm not mutating
it and how do I update my state isn't
that like a global constant or something
that's not useful you can may you can
change the state of your application in
radix by emitting an action and actions
are just regular JavaScript objects with
just one requirement they should have a
type property and the type which name
that you can think of yourself changes
to your state are made using pure
functions these pure functions are
called reducers reducers take the
current state this one source of truth
they take the current action that has
just been emitted including any
parameters that might be inside the
action and they've returned new objects
that's part of reducers being pure
functions is that they cannot mutate
existing values if they would get exists
the current state and just mutate it it
would be a pure function anymore because
pure functions are not allowed to change
their parameters or any state that they
do not own themselves so what appear a
pure function does in this case a
reducer is returns a new object which is
just the new state and radix will then
replaced the current state with this new
state that your reducer has returned a
nice thing of course is the pure
functions are if you write them
correctly easy to test so that's that
makes this a very interesting strategy
now let's look at how that works I have
a simple HTML application here which
which uses radix let's look at the
source code for it what we see here is
that we first define the initial state
the initial state is just a JavaScript
object with one property the property is
called two Deuce and it's an empty array
I don't need you at this moment next we
define a reducer the reducer is a
function and has two parameters one of
them is the state and the other one is
the action that's currently being
emitted now if the state would be
undefined we use another eggman script
six construct here where we say then its
default value will be initial state and
this is just a very easy way to ensure
that we always have a valid state so we
don't need to think about state being
undefined initially or something that's
being taken care of and our reducer
simply looks at the type attribute of
the action because that's the only thing
that's actually required in radix and it
will return if nothing else is the case
it will always return the current state
next we ask radix to create a new store
the store is where this state lives and
we tell it here is the reducer that you
could use to process emitted actions and
the first thing that we could do is we
could say ok dispatch an action of type
ads to do and now I can
use additional parameters if I want and
in this case I'm having an additional
parameter that says the title of my
to-do item is speak at devoxx that's
been a long-standing wish to do that so
could be there and now what we do is we
just use some ugly document object model
manipulation and we look for an element
inside the DOM and we just ask the store
for the current state make Jason from
that and put that inside the element
that we just retrieved and as we can see
here it says okay the Redax store is
just a JavaScript structure as we
expected with the - duze property in an
empty area but then we expect that I'm
just saying as we expected but did we
expect that I was hoping for someone to
say no I did not expect that because we
did dispatch connection here
this action is supposed to mutate the
global state of our application why
didn't it do that and the answer is
because there's a blank line over here
my reducer will get the initial state
being this tiny object it will get an
action with type @ to do but it doesn't
know how to handle such a case so we
could implement that we could say in
case the action is of type add to do
well one thing that we know is we should
return a new state we should return a
new object or rather than mutating the
existing one we also know that it is
most likely a good idea to have a
reduced property in it and then the
question might be was to put inside
there well we could create a new array
out of the existing one using array
decomposition it works pretty much the
same as object decomposition
in fact the syntax is the same station
what is that type station I want to look
at the 2-dose property of my current
state and I want to add something new to
that let's look at this
well at least our array isn't empty
anymore there's an object inside it
in fact it's this object I could give it
a title for example I could say well
just get the title from the action and
now it says I have one to-do item in my
list and the title is speak at devoxx
well since we have to do lists we need
to keep track of whether we completed it
or not okay it's not completed yet and
we probably need something like an ID
okay so here it is my upgraded to-do
list
it now has one item on the list it says
ID is one what I need to do I need to
speak at devoxx and it has not yet been
completed so we have a very simple
reducer which always returns new objects
rather than mutating existing ones
it doesn't even mutate the array inside
the state it just decomposes it into
separate objects and then construct a
new object out of that so that that's
already quite okay and we could add
support for more actions we could say
for example if there is a complete to do
action as well okay we need to return a
new verb value now we can look at the
state again make a copy of the array
with to-do items again we're making a
copy of that first we're not we're not
mutating the existing array we could
also do new to lose is state dot
Toulouse now we need to find the to do
that we're interested in so we could say
new to deus find
we're looking for one specific to-do
item on the list and when we have found
that we can mark it as completed we're
now allowed to mutate a variable because
we first created a copy of it then we
can change it we could then complete the
traduce passing at a parameter using ID
1 now if all went well
well oh did not go well
and action - deuce ah got it thank you
and now it has been completed
I'm not leaving don't worry but that's
how you can mutate your state by
emitting an action having a reducer that
process the current state and the action
that you have just emitted returning a
new state for your application and then
using that to have your new global state
well this is all nice but how does that
translate to applications like we
already saw react applications well
turns out that there's another open
source library that we could use here
and it's called reacted radix and it
provides a very elegant bridge between
radix with its warm source of truth its
global state and reactive components
doesn't want to access it and the thing
is that you need a provider that's what
they've called it the provider is some
kind of a radix excuse me some kind of
react component you tell it what your
store is and then inside the provider
you boot your app just the way that you
used to do it before for example inside
my to-do application I might have a very
small component that just tells me how
many things I need to do and it might
look like this it's just a simple
component that says there's a text
component from react native and there
are other tasks to do with the count
coming from the probes now what we need
to do we need to supply two functions if
we want to use reactor ethics we need a
function called map states - props where
we can map the current state
of the radix store two properties for
some specific component in this case for
our counter component and well the this
mapping is pretty straightforward
because our component expects account
prop and the value for that is very
simple it's the number of items in the
2-dose in the 2-dose array the second
mapping function that we need the second
helper is map dispatch to props and in
this case it's empty dispatch remember
is the function that we use to emit a
new action into Raiders and we could use
this to process user input so if for
example user clicks on a button we could
dispatch an action into radix radix
would run the appropriate reducer for
that and finally mutate the state of my
application and now what we could export
is the is a new component returned by
invoking the connect method from radix
we first need to supply the two mapping
functions the functions that map the
current radix state to the property for
this component then the function that
map's radix dispatch method to other
properties in my application and then
pass the components that we want to rap
note that in this case I've also
exported the counter itself that is not
required
you could easily skip that but the thing
is that this way you have a mechanism to
just test your counter itself without
having to tear up a complete radix store
and reducers and stuff and just verify
that it correctly behaves using the
properties that you specified and for
use inside your application you would
then use the default export
to mount that in some parent component
and you could actually even export those
mapping functions as well and verify
that they also return expected
properties so let's look at a somewhat
bigger example it's still in the 2-dose
area the reducer is the same but now
instead of having just a dump of the
Redax store we try to glue together
react elements with the radix store
let's see
this is just as we saw it on the slides
already and we need to tell the provider
where the store lives the store is just
the variable that we have defined above
let's see what is the name of there
there it is just index ID so we ask
again just as we saw earlier for some
kind of document object model note
specified as the one that has ID root
and we try to mount the provider on to
death oh it's already completed that's
an easy task if we would not do that we
would see oh well there's a list says
speak at devoxx and if I click it it
gets completed how did that work well
therefore we need to dive into the list
our application has a to-do list inside
the to-do list follow the pattern that
we just saw we have the react element
itself it receives some props as you can
see the props have items being just the
array with all the tasks that we need to
complete so we can map every item inside
that array using a function and the
function takes the item and returns a
new j6 value in this case it's an Li
note also that here we have the key
property we just take the ID from the
task that we are currently rendering
it's stable across rivers it's unique so
that's okay now if the item is completed
we determine some new CSS plus we return
a new CSS class to be used so that it
will be strikethrough and otherwise it
will not have an additional CSS class
and the interesting part is here because
we
have an on click method and unclick prop
sorry and unclick prop invokes one of
the attributes of my properties which
one the complete the complete to do
function here will invoke this function
taking the ID as an as a parameter and
then invoking the dispatch method from
react from radix she's me well then it
obviously needs to say which art which
action it wants to emit it wants to emit
the complete to do action and the ID of
the task that needs to be completed is
passed on as a parameter so if we look
at that
we click on the item we can see the
debugger pauses inside this object here
this object that has been returned from
the map dispatch two probes mapper
function and the ID that we got as a
parameter is indeed ID number one and if
we would step over this function we
would thereby emit a new action into red
X the action will be of type complete to
do red X would run the reducer a reducer
would return replace the existing global
state with a new global state and our
reactor ethics provider would then
determine that this map state two probes
function returns some new properties so
this to-do list is re-rendered invoking
class the class name method again this
time telling our application that this
task was completed and indeed it gets us
right through
there's also another tiny reactive
component over here it's called a new
item entry this time we're following the
class style notation why is that that's
because we do have some state for this
component this component is there so
that we can add new items to the list
and that means that we have a form and
when the form is submitted we want to
invoke the out to do method well the odd
to do method we'll just invoke the odd
to do prop using a variable that it kept
in its own internal state even in a
reddit world components can have their
own internal state for example in this
case and then we reset the states to be
blank new title and we prevent the
browser from doing an actual form submit
there by reloading the page
and getting rid of everything we've done
so far as we see here the odds to do
prop is actually a function and that
function will again invoke reacts again
invoke radix with a new action it's odd
to do action it's not completed and the
title is just a parameter now we have
the input element over here it's a text
element nothing special as soon as you
start to type we invoke the Update title
method the title method will just look
at the value of the input element and
use that to update our internal state
and then again prevent further even
processing by the browser and the value
of the input element is just what we
kept in the state so what we're
basically doing here is we're having our
own tiny little two-way binding here
just for this component it's not on by
default but just where we need it we
need to write it ourselves there our
helper libraries that do this for you
and if you are looking to start a new
holy war well may be emerging the
question whether that's a good idea or
not I've seen very heavy debates on that
for now I myself prefer to just do it
this way and if we look here well where
else could one speak Java zone never
been there so I could say speak at Java
zone press ENTER and then immediately
the same process happens again an action
is emitted radix runs the reducer the
reducer returns a new state global state
is replaced my components are ready
rendered and a new item is added inside
the real document object model there's
still great point over there now this is
a demo inside the browser just because
it's a tiny bit quicker to see what
happens and it's easier to debug
all of this can also be used inside a
react native application like so and if
we wish to do that let's see if we can
have everything on one screen it's a bit
challenging I'm afraid maybe
first we need to look inside our package
Jason packaged Jason is like the palm of
your application if you're used to Java
world and use maven what we see is that
we have dependencies and dev
dependencies and dependencies are the
things that are packaged with your
application and that end up inside the
app or the apk so we could read actions
react radix there we would need to run
npm install i hope that goes okay I'm
not on the conference Wi-Fi so maybe
we're lucky today
well pretty quick actually so now
instead of this this app that we have
here we could do something different
what we need to do is we will export
provider store is provider notice that
this this is exactly the same thing as
we did in the browser the API is
identical
we can have an app component as a
function of properties to some textview
well let's just call this counter them
because that's what it does
you
it's not the best approach by the way up
to props so function that takes state
and returns a new object
I'm expecting a count prop so need to do
that state dots to deuce dot length
again constant map dispatch two props
what this component doesn't do any user
input handling so we can just return to
block empty object map state two props
map dispatch two props counter that's
not a good idea to call a counter again
let's call it connected counter because
then we all know what it means it's
connected to something
this is interesting will it work we have
a default import from the app dot J S
which has a default export for the
provider with a store connected
component that has the map state to the
props and map dispatched props connected
to a component that doesn't know
anything about radix let's see what it
does tries to load the bundle take it at
the package we're still running should
be there hmm you show them modules there
try restarting the package
fair enough we could do that now all of
a sudden the other phone also picks it
up I'll restart the package here in the
hope that that fixes it it's on the disk
rains are you considered
reload it see what happens now
oh yes I forgot to import that one a lot
the other one will obviously also miss
it can find provider that's always the
issue she start live coding store is not
provider store a store and now since
we've had an error before reload isn't
working correctly but I could reload it
but it's no using that obviously
expected a string but got an object
somewhere sometimes you need to do this
I'm not really sure whether this will
make a difference
still okay there should be store still
not good
this could be a moment to show how
debugging worked is the benefit of doing
life coding if it doesn't work you can
show how good debugging support is as I
said debugging is done over Chrome so
what we get is a very simple page in
Chrome no wrong button
you could inspect the page look at the
source code that has been loaded so over
there and you could for example look
inside your your JavaScript file and see
here that there's a default export okay
let's first put it breakpoint over there
see what it does I'm pressing reload
over there okay the app is now running
in Android let's see it's there you can
see that it didn't have any screen yet
it's just blank because JavaScript
execution is on hold in the debugger
here
in chrome and I could step over it I
could for example inspect the store see
that it looks ok it has a dispatch
function it has get state function
that's what I would expect from redick's
so I'm stepping over that it has some
style sheets that I'm not using anymore
and now it goes back to react and it
still gives the same error message
that's the interesting one didn't expect
that to come up obviously let's see we
have the text imported for the counter
we have map states two probes we have
map dispatch two probes we're mapping
the state to some new properties over
there should be connected counter
the question is in this index dot JSP
file we're importing an app from a file
named app in the same folder as we
currently live in
that's this Epcot j/s but you don't
export an app over here and the answer
is no that's correct we do not export
something that's named app but in this
syntax import name from string you're
using the default export from that file
and the default export is not names so
we need to determine a name over here
there's also named exports for example
we're importing something from react
native which is called the app registry
but it is a name inside the react native
module there are other things as well in
the react native module which have
different names so we need to identify
which part of it we actually want to
import so the app import here should use
the default export of this file and the
default export is obviously that one so
it's the provider with a store connected
counter which is just an invocation of
connect let's make double check ok
still not work obviously well the idea
was to show you that it that radix and
reactor addicts work in exactly the same
way in both the browser and the react
native environment on your mobile phone
but the illustration doesn't quite work
as you can see I'm not going to
troubleshoot it by now because I'll
probably not find the error at this
moment but the thing is because you run
JavaScript on your mobile phone you can
use existing JavaScript libraries that
you might use from web development
projects or that you just find of use to
your project you can import them in your
application by adding them to package
JSON and then the metro bundle will take
care of that and ensure that these files
are there at runtime as well I do have
another example here maybe as I said at
the beginning at the very beginning of
this afternoon my idea was to recreate a
game that I watched on television when I
was young that game uses all of the
patterns that we've just that we've seen
until now so it uses radix it uses react
native and it's open source it's from
github so if you want to check that out
you can oh if you want to take a look
just take a picture of this so you have
both a URL and a QR code and the we can
take a quick look at how that code is
structured what we see here is that we
have a lot of actions these actions
corresponds to things that you can do
inside the game so for example there are
actions adding a new letter to an
existing turn you can give up you can
for example
have created a word that is not in the
dictionary and you're only allowed to
guess words that are in the dictionary
if you have had five guesses that you
still didn't get the correct word you
lose the game and on the other hand if
you did guess it within five turns you
will win the game you can start new
games and all of these have
corresponding reducers simple functions
that just create new a new state for the
whole game as a whole
based on the previous state and the
thing that is currently happening
so for example did this is the part
where you can see a lot of letters I
mean the dots where you need to place
the letters you have a text input and
the very moment that you out one letter
to it we invoke a method and the method
will dispatch an action into letters
this is not a an action that's created
over here there's a factory method for
that action but the pattern actually is
the same let's see if we can run that
maybe we're more lucky if we try that
instead of modifying existing code now
we need to shut down the existing
packager native run Android as you can
see if you do that for the first time it
starts Grado and I'm a different screen
it will start the metro bundler which is
trying to bundle all of our JavaScript
and all of its dependencies that one's
done now here it should try to install
the app on my device
you might have seen the green bar saying
loading from localhost by default react
native issues that you work with an
emulator but if you want to ship an ax
and up to your users it's a good thing
to also test it on physical devices
there it is we can change the URL where
the code is being load from from the
development settings in this case we can
look up the IP address of the macbook
need to see that over here probably
that's 192 168 43 290
No
that's not quite what I expected well
magic magic going on I think that demo
gods are not with me today
the idea is that you can use radix even
inside a react native application and
that way you have a mechanism to prevent
your global state from living everywhere
in your application instead of that you
could keep the state in one global store
the global store will be responsible for
mutating it and it will distribute it to
the components that actually need it
that's for me I'm done there's plenty of
time left for questions so feel free to
shoot I think there's a microphone over
there and otherwise I'll attempt to
repeat the question are there plugins to
use the hardware yes and no they're not
called plugins but you can add modules
and they basically do the same but
depending on the type of hardware you
might need to write them yourself so you
can hook on to Java or Objective C code
there's a page in the reactor
commutation that describes how to glue
Java scripts to either Java or Objective
C and using the Java or Objective C you
can obviously do anything for example
X's and s a NFC reader
there's no native module for there's no
module inside react native for that but
you could write that code yourself
expose it as JavaScript functions and
then invoke those JavaScript functions
from your code does it answer your
question
is there a list of existing modules not
that I'm aware of the ones that I've
needed so far I've found just by
googling them oftentimes if you do
something like react native and then
well the type of thing you want to
achieve you come up with some Gator
projects or elsewhere that provides a
nice JavaScript API to what you want to
do any other questions
question is how does the performance
compared to native iOS or native Android
I assume that you mean when you say
native writing it yourself in Java or
Iowa or Objective C yes okay I have no
hard figures on that the UI elements are
all native as I said earlier which means
that from a look and feel perspective
you you won't tell the difference there
is quite a lot of work being done to
optimize the runtime behavior that we
saw for example the set state batching
it's a invocations there's also some
profiling tooling that comes with react
native so you can spot which components
take long to render or take long to
update so at the end I think there's no
hard answer to that you do get some
tools to examine that if you run into
issues and and and I think you should
use those but only use them in case
there is actually a problem I myself
would not use this for high end graphic
games but I think you wouldn't write
them in in Java either you would use you
would write them and see and compile
against the Android NDK instead of the
SDK any other questions
if not I want to thank you for your
attention and have a wonderful DevOps</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>