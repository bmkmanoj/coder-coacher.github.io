<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>HTTP 2 0 &amp; Java: Current Status by Simone Bordet | Coder Coacher - Coaching Coders</title><meta content="HTTP 2 0 &amp; Java: Current Status by Simone Bordet - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>HTTP 2 0 &amp; Java: Current Status by Simone Bordet</b></h2><h5 class="post__date">2015-11-14</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/QpLtBftqM04" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">welcome thank you for coming in this
session we are going to see a little
history of the HTTP to protocol or DHCP
protocol and then the evolution that
went from HTTP one to hb2 and the
implication that this evolution has
brought to our ecosystem the Chavez
ecosystem and in the way we develop web
applications and we deploy web
applications so this is me I work for a
company called web tied that provides
support for jetty I wanted to mention
this because this year is the 20th
anniversary of Java but it turns out
there is also the 20th anniversary of
the jetty project it was started like in
96 an end of 95 as a issue tracking
system by Greg Wilkins and this year is
also the 20th anniversary of the Gerry
project which is probably the oldest
open source project in Java around or
one of the oldest so we're still kicking
ass so follow me on this presentation
because it's going to be awesome
so why HTTP - this is a very good
question and this is the answer this is
the page of the w3c dorg in 96 it was a
single HTML file for six hundred bytes
only and this was the page which is very
simple 96 was also the year that the hp1
protocol was standardized and because
the pages and the web was this web DHCP
- the HP one protocol was designed to
serve this kind of pages okay fast
forward to 2015 and this is the same
page of the w3c dorg but now it
downloads 41 resources and it's not 600
bytes but 366 kilobytes so there has
been an increase of 40 times in number
of resources that have to be downloaded
and on increase 60 time of the number of
bytes that needs to be downloaded as it
as you can see here is much richer one
HTML file for CSS to JavaScript 34
images
right now the cool thing about all this
is that this page is not even close to
the average page of the web today this
is the cnn.com page it's a hope in 95
resources for 6.7 megabyte of download
okay and it's three HTML file for css3
javascript file in 58 images okay this
is the web of today and the question
that we should ask ourself is is the HDP
one protocol still the right protocol to
use for today's web or do we did an
update of the protocol after almost 20
years of HTP 1 right and these were the
question that HB 2 was you know
answering so what happened in these 20
years that the web exploded but hp1 1 is
an old protocol is inefficient is
extremely inefficient force today's web
there is no multiplexing no reserves
correlation and we'll see in a second
what these two terms mean and why they
are so important for today's web web
developers started to hack around HTTP 1
limitations who in the room here knows
what is domain sharding ok a few of you
who knows what is the image spriting
many more ok so these two are not are
consider today as best practices if you
go around and google for those and
they're considered best practices they
are not they are just work around for
limitation of the HP one protocol if the
protocol was better you didn't need to
do these workarounds or best practices
why is that I'll go into that in a
second so browser vendors Chrome Firefox
Internet Explorer wants to make the
browser super fast they want to be able
to render the page as fast as possible
to improve the user experience and
there's been like a race to become who's
the fastest browser around
and in order to achieve this goal and
being the fastest browser around they
are breaking HTP one one recommendation
so one of this DS recommendation is you
can only open two connections on a
single domain that's what the HP one one
protocol says however browsers do not
respect that and say oh well if I open
only to then it's gonna be a lot of
round trips to download my cnn.com page
because they have to do 95 downloads so
it's like okay let me open two
connections make two requests wait for
those two requests to come back then
make another two requests and then come
back another two requests and come back
and by the time you arrive a 95 request
made to that server then a lot of time
has passed and the page doesn't render
fast so browsers break this they open
six connections to a single domain and
that's where domain sharding comes in
domain sharding is a trick instead of
requesting your resources to top top top
domain calm you split your resources in
a way that you put your images into
images domain calm so the browser can
open six connections to images that
domain.com can open six other
connections to WWWE calm you can open
another six to CSS domain the calm
another six to JavaScript domain the
comment so forth right so what is the
trick here is that the browser basically
opened instead of just two connection
like it should be one more recommended
they open maybe eighteen twenty-four
connection to a single server maybe
because then there is virtual hosting
and the server that actually serves all
those resources is a single one right
imagine if every single browser the
points to cnn.com or pins twenty-four
connections to the single cnn.com server
they need to have a lot of hardware
right so it's not good but there is
another side to this
not only the clients want to be really
fast but the server's want to be really
fast
these are
five studies there are you know they're
public and there are pre-famous they
show how important is that the server
and the clients work together to provide
the fastest user experience possible
like for example Shopzilla they went in
page rendering from 6 seconds to 1.2
they increase revenue by 12% and page
views by 25% another example Yahoo
shaved they calculated well they they
made our tests and they calculated that
for every 400 milliseconds there was an
increase in the traffic on the site by
9% okay this one is amazon.com for every
hundred milliseconds shaved of every
page amazon.com
makes 1% more revenue imagine Amazon the
condom making million dollars 1% of
million dollars is million dollars so
100 milliseconds it's a very short time
it's so short that for example when we
flicker the eyes they close the eyelids
it's about 300 400 milliseconds when we
do that still 100 milliseconds is
something that the human eye and the
human brain can detect I can feel the
societies faster and I'm gonna stay on
that side more and maybe buy a little
more things right um mods a ladder orga
on they shaved two point two seconds
from the main landing page they
calculated that this turned out to be 60
millions more downloads of the Firefox
browser in a year right
so fast HB makes money it's not only a
technical issue it's also a business
issue so if you are in charge of your
business and you're thinking you know
our site words yeah it could be a little
bit faster think about this that's if
it's fast makes you money just by doing
nothing I mean there are studies
prove this it's not just me telling you
right so I hope that I carved a dent in
your convention that it's now a good
time to consider HTTP 2 but let's go a
little bit further and try to understand
how HTP 2 works and why it is an has
been designed in a way there is so much
better than HB 1 so HTP 2 is now binary
protocol it's not in more a textual
protocol is deriving from a another
experiment that has been made by Google
called speedy protocol it's very
efficient to generate very efficient to
parse and it has been designed so
exactly to address all the limitations
of the HP one one protocol is based on
packets are called frames and it works
in this way the client the browser makes
a request a request is made of a GB
headers exactly like before but now they
are transported in a packet called in a
frame called headers frame of course the
client can also upload data for example
if you submit a form so you can send a
different frame called the data frame
and then the server just replies with a
headers frame containing the response
headers this time and of course with the
content multiple data frame that
contains the content for example image
bytes or HTML content or JSON or
whatever write the specification of HTTP
2 defines the protocol but the reality
is that the HPG protocol has been
deployed over TLS there is Pina like an
important movement towards TLS and
making the web more secure and this
started the while back and then it was
really really exploded when all the this
cases with the NSA came up and you know
you really want to have your
communication with the stuff that you do
over the Internet in a secure way so
that no nobody can look at what your
you know it's it's debatable thing etc
but nevertheless there is a strong
movement for every new protocol that the
IETF or the WTC defines to actually go
towards TLS so the reality is that
browsers for example only implement HTTP
to support over TLS you cannot open
anymore an HTP
only website with the HCP scheme and
expect that to work over HCP - currently
most of the browser's don't do that the
they only support hep-2 over TLS this of
course opens another issue which is the
transparent proxy problem for example
there are countries poorer countries
where the the traffic that goes for
example from mobile phones to to the
Internet is goes through a caching proxy
that makes the user save a lot of money
because for example it caches a lot of
things so it doesn't have to keep the
connection open for that long and maybe
in those countries they pay for an offer
you know it's not flat a flat fee that
you pay for your internet access but you
pay for the time you stay on the phone
or for the amount of data so however the
group of expert that define age should
be - is also working on this problem so
you know it's it's known it's been
addressed
however the protocol itself doesn't
mandate it it should be - so much so
that if you build server to server
communications then the communication
may be totally being clear okay
it's it's going to be efficient it's
going to be all the goods that the hiv-2
protocol has but yeah you can only you
know browsers don't support it
multiplexing is one of the most
prominent features of HTTP - how does it
work
they work in this way the blue pipe is a
TCP connection okay with HB 101 the only
thing that you can do with this big a
TCP connection was to send just a single
request this green pipe here
to the server and then you had to wait
for the response on that right so
multiplexing doesn't work in this way
for in HTTP - you can open this green
pipe send one request do not wait for
the response doesn't matter I can open
another I can send another request open
another in green pipe and another and so
forth so what we get here is basically
that we can send multiple requests at
the same time I have a demo in in a few
minutes so I'll show you exactly how
this works the other very good thing is
that even though this pipe was the first
one that was actually requested the
first request that was sent it doesn't
have to be the first that gets returned
the answers from the server can come out
of order right so for example this one
was the last one that was sent but the
first one to be returned because maybe
that particular request was very quick
to be served maybe just the you know
favorite icon that pops up in the in the
browser icon for that tub and so forth
of course the other responses can come
up later there is a request ID these
green pipes are called streams in the
hp-2 parlance and each stream stream
represent a request and response
communication and each stream as a
particular ID so the server and the
client can totally correlate the packets
that go back and forth because each of
these packets each of these frames
contains the stream ID so they can
figure out which one goes where another
very important feature of hb2 is a
cheapy header compression now imagine a
normal HTTP request okay normally CP
request is made or for example headers
headers very common header is the
user-agent string okay you may a fiddle
with that in order to trick the server
to figure out all this is a like it's a
that's the browser but I change the user
agent string so that you think it's a
mobile browser so the string is a very
long string that tells a lot of things
about the client and it's been saying
over and over and over it's a constant
that is being sent by the client over
for every single request okay so it's a
waste of bytes that go from your client
to the server and it doesn't provide any
additional information every time you
send it I mean you could send it the
first time and then be done with it
right the same goes for cookies the
server sent down a cookie to the client
and the client says okay I need to send
this cookie back to you every time I
make a single quest for this particular
domain so again the cookie could be
really long like kilobytes long and it's
a waste of time and in space and
resources so hb2 uses a compression
algorithm that makes a typical heb
request about six hundred bytes down to
ninety bytes that's 85 percent saved but
but that's only the first compression
that this is capable of doing the second
request comes in a way that says oh we
remember the user agent string Durant as
thank you before so I just send you a
pointer to that particular information
that I sent you before so the user agent
string goes from hundred bytes the one
pointer to what I sent you before okay
again let's go to the business case of
it imagine if you're paying your cloud
deployment by the bandwidth okay if
you're gonna save bytes every single
request and you make a lot of requests
then it's a lot of money saved because
you consume less bandwidth another
feature that has been introduced in HTTP
to is request prioritization why is this
has been introduced because the web of
today is pretty complicated especially
in the client side we have JavaScript
and we want to interact with the with
the pages that we build and deploy so it
happens in the main it may happens that
the the browser says okay I need to
download this request make request
download the HTML start parsing the HTML
and say oh there is a JavaScript I need
the JavaScript make a request for the
JavaScript download the jobs create
parse the JavaScript and
the JavaScript executes something okay
and turns out that the execution of that
JavaScript makes another JavaScript more
important to download first before all
the other resources that are recollect
declared in the HTML so at that point
you really want to be able to tell the
server hey I need this JavaScript first
before all the other requests that I you
told me to download on the HTML page
right so this was a help that or a hint
that the client could send to the server
and say hey I I know I asked you this
request but this one is more important
now not only that they can also
reprioritize making okay I'm asking you
this request start downloading a little
bit and then the client can say oh but
now it's not important anymore
because you know I started parsing a
little bit but I have other more
important things to do so rather than
raising the priority of of other
resources I can lower the priority of
the resources that are currently
downloading it has kind of different
effects on the server's so it's not
widely supported this feature the
prioritization but nevertheless it's in
the protocol I mean if you really need
it it's there and we can use it the
other astonishing feature that HTP to
introduce is this one it's called HTTP
to push and it is about the correlation
of HTTP resources that I hinted you few
slides ago so think about this for a
second every time we download the page
the HTML page contains references to
other resources those other resources
are secondary resources that are
declared in this primary HTML resource
ok so it would be really interesting if
I can pack all these resources together
and then just download them all in one
go ok this is how it actually works ok
so HB 1 1 I have to make requests to
make requests for index dot HTML
round-trip download the HTML the browser
starts parsing it okay then we figure
out parsing the HTML that we need
application the JavaScript and style the
CSS so let's open to connection now and
let's request those two in parallel okay
so another round trip but this time we
do it in parallel so we download two
resources at once good turns out that
the while I'm parsing this the CSS on
the client the CSS references a
background image for example so ok let
me ask that image to you because I need
it to render the page right so it's
another round-trip to the server and
it's a very simple page only for
resources not 95 and you know I already
have done three round trips to download
all the stuff imagine if you are if your
server is across the ocean then it's
almost 200 milliseconds to go there and
come back so it's a 600 milliseconds
just to download the stuff okay in the
optimal conditions but the server can
understand that every time index.html is
requested then what happens next is that
application the JavaScript is being
requested style of CSS is being
requested an image the PNG is been
requested okay so what it can do we can
say well you know what I can correlate
these other three resources secondary
resources to this primary resource and
build the push cache where I pack all
this information together okay and then
hep-2 comes along and this is what
happens an HTP to enable browser makes
the request for index.html and the
server can say oh you're requesting the
index dot HTML i know that you're going
to need this javascript file the CSS and
this image the year ago okay download
everything at once so in just one
round-trip I can get my image that's a
three time reduction in rendering of
this page okay remember the slides
that I show the use cases that are
presented before this is basically money
coming back to your business all right
okay so these are the main features of
the hiv-2 protocol I really hope that I
convinced you to consider I should be
doing a lot more now and say man I
should go back to my workplace next week
let's figure this out and let's move our
website - it should be - because it's
money so okay can we do this no I mean
yeah if I go to my work next week can I
actually do this so it turns out that
yes you can do it
you can already do it because hb2 is now
a final specification it's a it's an RFC
it's a standard and browsers have
already implemented it like for example
Firefox since version 34 we are now at
41 I think Chrome since version 38 we
are now at 46 of 47 something Internet
Explorer is from version 11 we are now
at 10 so it's
sit so so it's already there
I mean these two guys cover most like
more than half the cool thing is that
these two guys firefox and chrome also
cover the mobile devices so your mobile
devices are already
hup-two enabled from day one you don't
need you're not speaking anymore HTTP
one and you're not speaking anymore all
protocols
you know phones are super up to date and
it's already they're also on the server
side because you know you go to
twitter.com you go to google you go to
every major website and it's already HP
to enable that I like for example the
our own website web tied comm we run
jetty and it's HP to enabled our own
website is served via Jerry the box add
website which is you know the news and
stuff and related to the DevOps
conferences it's on HP to using nginx ok
and the list is growing as we speak I
mean sometimes I really go to certain
sites and the day before there they are
hb1 one and the day after they moved to
HP 2 and there is a reason they do this
and the reason again is what I showed
you before is business is you know
because it's better because the protocol
actually is designed from the ground up
to be a better protocol for today's web
alright so great so I can do it but you
know what do I need to use to do it so
do I have the tools and everything well
it turns out that yes you do for example
Carolla Wireshark they support hb2
already ah in this page is the page of
the HB 2 specification in this page
there is a list of implementation there
are 35 plus implementation in basically
every language you can think of it's
like Java C C++ goal node airline
Haskell I mean every major language has
an HTP to implementation so you don't
have to worry the technology
you're using your there are very very
good chances that you can deploy or you
can use HP to in your business what
about the Java side of things
where are we okay because this is most
important for us well there are very
good news for the Java side of things
that in particular if you're deploying
worse on your you know web applications
you have to make zero changes to those
um you know you take your word you
compiled yesterday you change your
infrastructure to support A to B to your
deploy your work done done there's
nothing more that you have to do okay
so existing web application work after
the box no problem what about all the
features that the HP two protocol
provides multiplexing and push and what
not so the push functionalities are
provided by the server implementation so
for example we provide push
functionality in jetty so if you deploy
your web application into into jetty and
you enable HTP tools you can have HP to
push for free you just configure jerry
done like in the same way you can't
figure a data source on your web
application and stuff now you configure
the server here your configuration
should be two and Jerry will figure out
the correlation between resources and
start pushing for you making your
website so much faster there is a
possible action that you may want to
take maybe in the future there's no
hurry to do it which is removing the old
HP one best practices like domain
sharding or you know image spriting and
stuff these are not needed anymore so
well you can remove it you don't need
you know all this complex configuration
or just imagine putting all your
JavaScript into a single humongous
javascript file because while you do
that right yeah this is like resource
coalescing all these resources together
you have 30 Java scripts but you what
you're actually doing your you're
putting them all together concatenating
them all together and then serving them
as a single file while you're doing that
well exactly
because the HP 1:1 protocol would have
made 20 requests to your server and it
doesn't have 20 open connection to make
them in parallel in just one round trip
it would have done six back six but and
so forth right so the trick is okay if I
can catenate them all together then I
just make one right so that's the key
thing but it's not needed anymore way
they should be - because you can make as
many requests as you want in parallel in
the single TCP connection that you have
opened so hb2 compliant Java server
required JDK 8 but of course who uses
here JDK 7 its end of life we are all
happy into the k-8 we were the dis
confidence a lot of good things about
JDK 9 so it's good the real reason
behind this this constraint is that in
JDK 8 there are the strong TLS ciphers
there are needed for the hb2 to be a
cheapy to compliant actually the hb2
specification mandates that you have to
use very strong ciphers for HIV to work
so this is the reason this strong
ciphers they are not implemented in JDK
7 just because you know there's an
evolution on the strength of the ciphers
and every JDK gets an are fresh and the
new ciphers and the old one or there are
may be vulnerable gets deprecated and so
forth so say natural there's also a good
thing a server for is going to support
HTTP 2 we are the jury team is actually
very involved with the HP servlet expert
group so we are actually proposal
because we are leading the way in a way
in in this field we are actually
proposing to the expert group
modifications to the API in order to
support push for example how about doing
a programmatic push inside your
application you know that these two
resources are correlated you can serve
one and then tell the container hey by
the way also push this guy whether
because I know okay but you know
basically it will be a backwards
compatible API it will just work other
efforts that are underway are these are
jab hundred ten will provide a standard
HP to client API for JDK nine
this is already under discussion Michael
McMahon is the lead for this effort and
it has already published a proposed API
so if you're interested in contributing
this or if your heavy user of HTTP
clients and you really don't want to go
and use jetties use Apaches comments or
user sync it should be client whatever
you really wanna if it was in the JDK oh
man well it's going to be in the JDK so
if you're really interested in this
subscribe to net dev open JDK the Java
dotnet and contribute to this
discussions there's a technical
requirements which is fundamental for
HTTP to to work which is it's called the
TLS alt and extension I'm working
because I am the one that implemented it
that are in Java like for for jetty and
for other projects to consume I'm
talking with the security team leader at
open JDK and this is basically at a
point where we we are going to have a
alt n injury canine the API has been
designed already and it's you know it's
just waiting for that to be implemented
in the JDK and perhaps in in the
server's as well so in the Java world
what are the servers that are actually
supported should be - well of course
jetty we have a server the fully
supports that but we also have the
client and so for example if you want to
do server-to-server communication you
can have a jetty HTP - client on your
web application the talks to a server
and other server in your data center
okay of course we are live now our
website is running a sheet - perhaps
it's one year or something and before
that we were running it on speedy so we
have a lot of experience on you know the
problems
and the tricks and what you need to do
to deploy this neti also supports hb2
undertow it's the servant engine for
Myra that behind wildfly so it also
supports hup-two and on the client side
for example for Android there is a
client called oke HCP that can actually
be used to to talk a chippy to well I
have to say they're also the jetty
client well no the client requires JDK 8
which is not yet supported in Android so
yeah okay you should be client is the
way to go for now but eventually it will
come as well so just to give you a
simple example about Jerry DHCP client
we do have an HCP client okay has been
there forever basically it provides a
high level API so it provides you a mean
to say I want to request this resource
URI with this method get' okay that's a
high-level description of what you want
but the way you transport this
information from the client to the
server can be different it can be in the
HP 1:1 format and then you configure
DHCP client in this way
or it can be in the HP - format and then
you just change the transport while
you're configuring HCP client done so
this is a one line change that you have
to do to switch from using the J DHCP
client from h-e-b one one to HP - ok so
what is the recommended deployment that
we suggest on this well this is what we
recommend typically and this is very
important but we will have time for
questions
so typically what happens is that the
browser will use TLS and they should be
- to talk to the server side ok because
the TLS implementation is Java is a bit
memory hungry it's not really that
efficient there are much better
implementation what you really want to
do is you want to offload the TLS on to
some
of device here we totally recommend
haproxy to use it
we recommend haproxy because it has a
very fast
TLS of floating facility it's a proxy
but also load balancers so you can load
balance to different servers and the
good thing is that it's one of the only
proxies load balancers that supports
talking to the backend using HTTP - okay
it's one of the very few for now so if
you are already using a proxy you're in
a very good shape if you're not using a
proxy you're using maybe for example
other typical deployments are I don't
know instead of a proxy you have Apache
in reverse proxy mode or nginx in
reverse proxy mode then these two will
work will speak hep-2 to the client but
we speak HB 1 to the server to where you
actually have your business so you will
not be able to figure out as well as you
can do in this in this scenario for
example HCP to push that will be
disabled because you know here is where
you know what you have to push but the
HP one protocol that you're talking here
doesn't allow you to tell you that you
want to push things so this one is the
recommended deployment the we do we
provide there are other big players that
are updated or rushing to update to HP 2
in this area in this particular era for
example all the providers for load
balancers and proxies and stuff and like
f5 and you know Cisco and whatnot so
they're rushing to it there's still a
little bit behind so you really have to
keep an eye open here depending on your
infrastructure theme of time so let me
show you actually because I spoke a lot
and you know you have to trust me but
there's nothing better than actually
showing you things and let's see how how
it works so ok cool so this is the demo
that I wanted to present you what I've
done I have
down artificially the local lost
interface in order to simulate a 200
millisecond delay between our quest like
if you if I was requesting a request to
a server there is on the other side of
the ocean okay this is because otherwise
the local loss the interface is so fast
that you don't see any of you know the
good effects or the bad effects of HP
one so let me go and let me go and click
on the HP one one link the page that is
going to show up is a page that is
composed of other resources small tiles
of images that compose a bigger image
okay
this is a simulation of how a webpage is
made today a page is made of secondary
resources the 95 that we saw for CNN
calm and this one only has 24 and so
it's a kind of a small page but let's
see how it behaves in HP one so I click
tips that was fast because I didn't
start the slowdown the local host
interface okay so let me go back here
for a second let me go here kill this do
this and restart the server and let's go
back here and reload this page okay
we're not good ok so click ok so this
image have you seen what happened I
clicked and then what happened is that a
few images were coming down and then
suddenly the other images was coming
down a little faster ok that's a feature
of the TCP protocol called slow start so
every time you make a request there is a
very small bandwidth that TCP allocates
for you and the more requests you made
the more traffic
you made that connection the more tcp
enlarges this window to say okay now you
can use a larger bandwidth and a larger
bandwidth and so forth and so forth
right so at the very beginning
connections are cold you have to warm
them up in order to use them at their
full potential and so much so that if i
refresh this page
okay maybe timed out so i refresh it now
you see it's kind of a little bit faster
okay because now the connection to the
server is hotter and so if i refresh
this pages is faster so let me show you
how it looks like if i go to the network
monitoring here and i just reload the
page in this way okay there you go this
is the profile that you get when you
load a page with the pendant resources
okay so yeah you get the first request
is the main page main HTML page okay and
then you have four requests here four
four four four okay
in this particular case chrome has open
only four connections to the server
typically open six I don't know why four
do them open only four but it always
happens but but this is a typical
profile okay it's a you know scaled
waterfall that you can get with with HP
one one and this is what you have told
you before right 95 resources you open 6
connection make 6 requests wait for them
to come back
make another 6 requests wait for them to
come back and eventually you can render
the page in one point 48 seconds all
right ok enough about it should be one
let's try to see how does it change for
HP - ok so I click here it's immediately
faster ok but this particular request
was not even was the first request of
the HCP - kind alright so the server in
this case Jerry didn't know what was
correlated with the primary resource he
didn't know that the world twenty-four
resources are correlated to the first
one so the you could still see the fact
that the bigger image gets created by
other smaller images right but now Jerry
has this information has built a cache
on the server side and he can now it
will be able to push resources and you
can see here look at look at the
difference in there's no anymore this
you know square the sequential waterfall
now all the resources that make the
primary image have been sent 24 requests
at the same time altogether they're all
starting at the same time you see they
take more time well this is maybe just
because of network how chrome is
implemented but the interesting thing is
that they start all at the same time
here I have a page with 24 resources
download the primary page parse the page
figure out I have 24 resources to
download boom them all to the server
back all right I don't have to wait for
the 6 to come back and then make another
6 and whatever so what happens if I
reload this image if I reload this page
oops
so me try to you can't see it but I'll
try to figure it out so what happened
that the interesting thing here is that
Jerry now had the knowledge that those
resources was correlated so you can see
those requests are actually here right
at the very top there there is no
traffic at all what happened here was
this Jerry was saying okay this is a
request for HB HTML the HTML file but I
have to push you back also the other 24
images it did so here ok so all the
other 24 requests the browser's say hey
I need this image let me look in the
oh it's here pick up from the cache or I
need the second image oh it's in the
cache pick it up so there's basically no
traffic in there because all the traffic
has already been done there's no latency
nothing so if i refresh this page again
click you see that there's there's just
a small flickering now let me close this
for you no greater fat butt click you
don't see I mean it's immediate
if this page is being reloaded but you
don't see it because it's so fast that
there of course you don't need it so let
me go back to HTP one just for sake of
right this is the difference that hb2
makes and even if I reload the sky I can
still see that the page is being
rendered slowly okay go back to HP to
boom see the difference this is what
makes you money
alright let's resume and go to the
conclusions and then to the questions ok
demo time conclusions all right so good
thing is no changes for web developers
super cool the servlet API will be
backward compatible frameworks will be
able to leverage the new HTTP 2 features
you don't have to do domain sharding
spriting hacks best practices all gone
it's you know the new protocol has been
designed from the ground up for today's
web not for 20 years ago web right so
JDK 9 will support they should be -
yesterday we spoke with mark Reynold
he actually said well the main feature
of JDK 9 is going to be of course jigsaw
but you know kind of the second in the
list is probably going to be or
certainly one of the most important is
going to be HCP - and this is because
you know every the world is moving there
so and it's really important I show you
why so developers you're cool nothing to
do go back to your next week work job
and you're good deployers though a
little bit more work ok so if you manage
the data center or you're in charge of
you know deploying things and stuff you
have to pay attention to a couple of
things so first one is TLS everywhere if
your website is not using TLS then you
have to buy a certificate ok and you
have to renew the certificate every year
every two year whatever so you have to
put in place a process in your company
that figures out this renewal thing
about the the certificates and keeps
them up to date you have to upgrade your
server container if you're using Jerry
you're good just update to 93 and your
goal if you'll use the undertow or
wildfire whatever multiply 10 I think is
supports for HP to you
good if you're using Tomcat you have a
problem well it's not that you have a
problem but uh you're the support for HP
to is going to come in Tom can't nine so
which is still a lot in the future and
there's no clear date of when is gonna
be available or something there are I
don't know I mean I follow the project
in a bit because I'm interested in HP to
but if you want more information you
really have to drop an email on the
Tomcat mailing list asking what are the
plans for Tom can to support nginx
supports HTTP to Apache supports HP -
the only thing is that that I show you
before is that they support HB 2 on the
front side but not on the back hand side
so if you really want to deploy your
website to its fullest you have to have
HB 2 everywhere like end-to-end HCP -
that's the best possible solution so
recommended configuration for you guys
is client haproxy TLS offloading into a
proxy and then Jerry in the backend or
wall fly or whatever you like take a
look at your network infrastructure if
you're deploying Cisco big big EP f5 or
you know other network elements in your
infrastructure firewalls etc well take a
look at how the words are load balancers
as well because they need to support the
need to understand they should be - they
need to understand that what they're
going to come out after they decrypt
that the data is not text is not h-e-b
one one text is going to be binary HCP -
so they need to understand that because
if they don't they will close the
connection and your website will not
work so final slide I just want you to
take one thing out of this session which
is HCP - is there please do use it there
is a very good technical reason to use
it which we we talked about but there is
also very good business reasons to use
it so
thank you
so I have like 50 times 15 minutes of
questions if you if you wanna questions
that I think there are microphones the
middle layer yeah yeah do you know if
spring boots supports HTTP - yes it does
because there's jet inside
well springing boot supports other
deployments mode but one of them one of
them is with Jerry so if you choose that
one configuration then yes is going to
support HTTP two more questions yes I
repeated yes okay so the question is the
the server is pushing resources down to
the browser but the browser may already
have those resources cached what happens
in that case okay so the HB protocol HB
2 protocol provides a way for the
browser to cancer requests and
especially for example you can cancel
pushes so experiments that we have done
in others have done is that the
bandwidth is not a problem so even if
the server pushes down more information
that the browser already has it doesn't
matter much what matters most is the
latency so even if you're pushing more
data that maybe the browser already has
doesn't matter much so the case could be
that the browser receives the
information say hey I'm going to push
this resource okay so the HTTP 2
protocol sends a kind of an initial
frame called push promise that arrives
to the client and the client says oh
you're going to push me / main dot CSS
ok but I already have it so the browser
can just issue another
frame that is called rossette stream
telling the server I don't want this
okay now it could be that the server has
already written the maned of CSS files
so it's in flight and so at the point
there's that will go to the server and
say hey I wanted to result you know the
stream but it's already you know written
so nothing to do but if it's not already
written then the server will stop
sending data so it works in a very good
way so let me ask you for example by
raising hands who has at the use case of
sending a request to the server but then
being able to cancel that request and
say you know click and then no no no I
was wrong I want to cancel this request
was that this case okay many people okay
so h-e-b 2 supports this case which is
was now supported in HP 1 there was no
way in HP one to do this in HP 2 there
is a way to do this because the protocol
itself supports a mechanism for letting
the client send a message to the server
saying I don't want this request anymore
ok it's called rosette stream like like
I just said so this is going to be
supported as well now it has to serve
phase from the protocol to the API that
you can use for example in JavaScript
but you know it's it's going to be there
because it's a very interesting use case
so second question yes ok so the
question is we have seen that the HP
client can be put in a mode where it
speaks HCP - does it support a fallback
to HP one if HP 2 is not supported the
current answer is no it's in the plans
typically when you use the client it's
typically done for server-to-server
communication and at that point you know
that it's supported or not so you
typically know if you if you don't know
what you can
do is you create two instances of
httpclient one configured for HP one and
one for HP 2 and then you try them both
but it's in the plan it's something
super it's not that simple there are a
number of technical details that need to
be figured out but but for now it's not
supported other questions no we're cool
so thank you for coming and the user</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>