<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Introducing the MicroProfile by David Blevins, Andy Gumbrecht and Mike Croft | Coder Coacher - Coaching Coders</title><meta content="Introducing the MicroProfile by David Blevins, Andy Gumbrecht and Mike Croft - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Introducing the MicroProfile by David Blevins, Andy Gumbrecht and Mike Croft</b></h2><h5 class="post__date">2016-11-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/iG-XvoIfKtg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">all right we have a rather intricate
presentation of course so we have like
four people up on stage so a hello
everybody I'm David Blevins Tommy tribe
and we have hiko you can do I'd
introduce yourself because you have oh
yeah oh right yeah
yeah my name is hi cabron I'm from Red
Hood working on one first form hi I'm
Alistair nothing I work on most
filiberty my name is Mike and I'm here
with payara I'm Andy gum Brecht I'm
actually an employee from David and
Tommy try that okay so we're here
introducing the micro profile and in
micro profile is an interesting thing
that we kind of launched up in around
June 2 to see what we can do to kind of
move things forward around the story of
micro services kind of in the EE space
more or less but just sort of enterprise
Java in general as far as our platforms
are concerned I think it kind of started
organically as a lot of conversations
that we're having about you know our
different approaches to micro services
to uber jars to packaging what we're
doing in the metric space and you know
various conversations like that and so
eventually we decided to come together
and actually form a project officially
announce had given a name and kind of
put a stamp on this collaborative effort
and see what we can do to move things
forward at a slightly faster pace than
we have before
so we have launched off of course the
four of us plus the ljc
and sow Java has joined up as well as
nice little new entry to the to the
ecosystem called hammock which is you
know savoir technologies and so we
you know came out with the philosophy of
wanting to improve the standards process
a bit by having some shorter cycles a
little bit more iterative typically
we've had maybe three years between kind
of major EE versions and one of the
reasons for that is I think because
we're not collaborating before we
actually try to standardize things as
much as we should and so it's one of the
things that we're attempting to solve
with with the micro profile is really a
community to be collaborating on the
various aspects around micro services
try things out see what works see what
doesn't iterate quickly fail fast I
believe is a great way to describe it
and then as things become more proven
flushed out those can go up and become
part of the standard and so you know one
of the things that you always hear about
when people talk about something like
you know this old topic we love spring
versus EE they always say is innovating
and the answer is standards aren't
supposed to innovate that's not what
they're there for
they're there to collect the proven
ideas that have been flushed out and
make them standard so if you look at the
last say 15 or 10 years of standards in
the EE space you see a couple examples
where where we guessed at what the right
answer was and those typically haven't
worked out very well
CMP is pretty much the boogeyman of that
argument and so you know CMP wasn't
really used in the wild for a
significant number of any at all and it
was designed and thought of in a in the
spec group and then pushed out to the
world to limited success and a lot of
pain for us all and that's an example of
what happens when a spec tries to
innovate and then you have the same area
you take JPA
which started up basically as a very
successful open source project hibernate
and then became part of a standard in
you know kind of abstracting out things
that hibernate
and in various things like that and that
is a very successful example of a
standard so what we did as part of you
know when basically we took hibernate we
ended up with with two more hibernates
we ended up with the clips link and open
JPA all which came into existence as a
result of standardizing something that
hibernate was basically innovating and
doing so our reward for that was to more
hibernates and that's not a bad thing
for for the industry and so we're trying
to go really iteratively really quickly
because the world of micro services is
changing so very fast two three years is
not enough it's not fast enough and so
we want to try and be be very focused
topic at a time bang out and flush out
some things and then basically call that
you know version 1 1 version 1 2 so on
so forth so we did come out with version
1.0 of micro profile right before Java 1
and it contains just CDI jax-rs and
JSONP it was intentionally minimal so
I'll talk about the decision-making
behind why it was so minimal but the
shorter answer is because we wanted to
include you in the process we actually
did launch off a survey it's on the
front page of the microphone profile web
IO website that you can take we did get
about so far almost about 3,000 people
take that survey which is a pretty good
turnout ok so right now where we're
headed at is basically we started as
very informal we launched off a website
we have a github project and now we're
in the process of taking what has been
created and what's been talked about and
moving it into an open-source foundation
so we chose Eclipse Foundation and we
actually have a proposal to the Eclipse
Foundation that's there it's being
reviewed and should be voted on at the
next board meeting and then we would
officially be a part of the Eclipse
Foundation and I guess I've given a lot
of talks about standards in the JCP and
extremely huge fan of the JCP and I view
this as a great way for us to feed
things into the JCP quicker it's also a
really great way to make sure that
they're open source which is a very
critical thing so you know in this space
we have CDI bean validation and the
@inject spec which are open source
specifications and the rest are
effectively proprietary and so if we are
able to create more technologies in a
non-profit foundation and then have that
foundation basically be the spec lead
when we move things into jsr format we
create more open source technology in
the enterprise java space which is a
very good thing for us all and what
we're trying to achieve there is have
you know greater meritocracy inside how
things work in the project have voting
if someone wants to you know bow out for
for a round of micro profile you know
just we have a lecture we'll probably
have elections on a regular basis and
just don't run and the community will be
able to you know elect the leadership
the people who make the decisions and
that would guarantee that you control
the fate of the technology I think is it
it's a very important thing for us to
establish and if we can get this pattern
going I think we can apply to help the
velocity of the JCP in a very
significant way and help the community
oriented aspects that have already been
happening in the JCP fuel that even more
ok so we did put together a demo and so
when we launched off we had a really fun
conversation about you know we with the
very first thing we talked about oh
we're going to make a sample app right
that shows what you can do with the
micro profile and then you know we
instantly saw why why we making a sample
app like a single app this is supposed
to show micro services and how
interesting is it if you show micro
service right just one so we decided all
right
we're gonna we're gonna take a different
approach which is sort of a new thing
that popped up that I don't think would
have happened otherwise and so we
decided all right we have four of us
here at the table we're gonna make four
services one each and one's gonna run on
you know Liberty one's gonna run on wild
fly swarm one's gonna run on you know
Tommy one's gonna run on payara and then
we're gonna have you know something that
ties it all together and then we'll
actually have to choke down the same you
know problems that you have and I think
that's the most valuable part about it
is we are actually all now kind of
hacking on one code base with four apps
and it actually five if you consider the
UI and we're even running each other's
servers and you know we've even had a
situation where one of us patched the
other one you know and we've been just
kind of contributing to each other stuff
which is sort of a crazy crazy
occurrence so we don't have a sample app
but we do have a sample architecture
which i think is a really really neat
thing and there's been some things that
we've been learning from that which I
think are quite interesting but so we're
going to show you what we've cooked up
in terms of demo but understand that
this is just a learning vehicle this is
not like tada this is the micro profile
this demo this is just you know what
we're using to have use case driven
approach to you know figuring out what
it is that we need to do and as a
community to move things in the right
direction because I think there are a
lot of low-hanging fruit and things we
don't agree on and we're starting to see
that ourselves in this work that we're
doing so first we're gonna we're gonna
have heiko pop up and he's gonna show
his service that that wildfly wrote and
then we're gonna go down the line and
then we're gonna do the UI and we're
gonna continue on with the presentation
so okay so the overall idea behind that
demo architecture or reference
architecture that we came up with is
basically it's a it's resembling a
conference application so you get things
like sessions rank ratings for the
sessions good information about speakers
etcetera so as we move along and when we
look at all of the different services
implemented on each Windows runtime
everyone brings up one kind of like
bounded context so to say it's still
just a playground so don't take it too
serious but the important point here is
when when we leave the room today its
intended for you to kind of like go back
check it out work through it take a look
at the different implementations what
they bring to the table how they work
how they operate so in the next few
minutes everybody from us is going to
say a little bit like what the
implementation details are what we
implemented and how it works but there's
obviously much more than we can cover
today so I encourage you to kind of like
look at it for yourself later on the
team behind swarm was asked to implement
the session service so that's providing
like session information similar to the
mobile app that were using today to see
what's going on at the DevOps it exposes
like the session data and some
information about the speakers I'm not
going to dive into all the details
regarding the API it's it's basically
just a simple API that you can use from
a web front-end for instance to poke
into the service and ask for the
schedule of a particular talk you got
IntelliJ running here somewhere
okay so rather than looking at the
slides showing what the service is doing
I'm going to show you a little bit of
code here so if you go back to the
github repository this is what you're
going to see there's a each service has
a single repository a custom maven
project built behind that and some
sources to it so in our case since we're
based on the micro profile one out it's
basically a jax-rs service plus some CDI
beans implemented the implementation is
not that interesting but what's
interesting is how the poem actually
looks because this is where you start
with one place warm for instance it's
actually I just need to quickly get my
head around it this is the other one
okay so what you see when you look at
the session service it has a single
dependency on the Java EE api's right
here there's nothing more to it than
bringing in that particular dependency
plus some internal modules to bootstrap
the application but the relevant part to
enable wifeless warm actually happens
this is still the wrong one
now we're looking at the right service
just a second I'm surprised I was I'm
looking for the the plug-in that enables
all of this well I think we we do it
right here has this being the one we've
been using so forget about the code I
can't find the implementation details
and before I bore you would like digging
through the code finding it myself I bet
I rather explain it right here so when
you enable Wi-Fi swarm that means you
ever a wall project packaging type that
brings in the Java API isn't the way to
make it work is you add a build plug-in
to it the bill plugin is in charge of
like kind of like detecting depicting
the runtime capabilities that that
application particular needs and the
output of that packaging process is then
a self-contained binary and that's
something you see in all the vendor
implementations today so at the end
you've got one self-contained binary
that you can use to start the service
and when I finish my talk and hand off
to the other guys this is what we all do
each in a row so at the end we should
have four services running what some key
figures about all the services we
thought it might be interesting to the
audience to see like how the the
different implementations compare so we
added some figures around the actual jar
science is being created so in our case
we end up with something like 65
megabytes for that application or that
service the service is able to start up
and around about 6 seconds yeah in this
it's means to readiness so when it's
actually ready to serve requests and the
heap usage is around 40 megabytes so
depending on I look at it we here
measured like some of the young and all
generations our approach to the U verge
are basically the stuff that I wanted to
show and using code is you add a build
plug in the maven plug-in or the greater
parking then is in charge of taking the
application resources plus something
that we call fractions which are the
runtime capabilities of the server
they get together and output a
self-contained binary this also includes
like the main repository including all
the dependencies the application
requires and it's something that we hand
off to another person to run it or I can
send it off on the journey through CI CD
into production interesting here just
mentioning without taking up too much
time for the others
so in swarm the micro profile for us
isn't a profile like the web profile
it's it's really just yet another
fraction and the term or the concept of
a fraction and body is basically most
often a Java EE API so jax-rs for
instance and to supporting runtime
services to make it work so when you
reference that particular fraction in
our example it enables the jax-rs api's
plus the HTTP components on an ease so
that you effectively have a running rest
endpoint at the end of the day there's a
large number of Java EE related
capabilities that we currently have most
of it is inherited from wildfly so it's
a sidekick of while flying all the core
components come from that or from that
origin plus a large number of non EE
capabilities so things that you need
when you move into service-oriented
architecture so micro service
architecture so integration with service
registries single sign-on circuit
braking capabilities external
configuration health checking a bunch of
things and so for us and when you look
at the demo the micro profile
capabilities are yet just another
fraction that you can use and in the
most similar case simple case an
application would look like having a
single dependency on the micro profile
to build plugin you run it you build it
you run it and they are ready to go ok
and with this I hand over I need to
start it right
okay we quickly stop this one cleanup
here you see it's a little bit too small
hopefully you can read it how to run or
execute the final result created by the
maven packaging plugin or our our Wi-Fi
so I'm plugging the packages the self
contained binary it's actually just a
jar at the end of the day that you can
job a jar as you can see here and what
we're going to do is we assign it to a
specific force so we can have all the
different services running on this
particular laptop without colliding with
each other there we go to those of you
familiar with wild fly that's the
bootstrap output is quite same and there
you are
ready to go the micro service session
was deployed and we are ready to perform
work I think we don't need to
okay so our services was essentially to
allow sessions to be rated it's called
the session voting service and there are
two kind of parts to it one is the date
of the model which is you have an
attendee the attendee has an ID in a
name and the rating you've got the the
an ID for rating itself the the session
ID the the attendee ID and then the
rating from 1 to 10 and the API is very
simple you can register in Hindi you can
update an attendee you can rate a
session you can update your rating so
you can change your rating afterwards
you can query all the session votes you
can get an average for a session so I
have never used IntelliJ before so let's
see how well I do with this
so the the session is services in here
and if we look at the pom to see how
this thing works you we have a whole
load of properties which configure the
liberty so for example we set what the
context for the application will be we
actually had a different approach from
the other services because we bind the
context root and then the rest services
Banta /but everyone else is
implementation binds a context root to
slash and then has a context root for
the rest application which I thought was
interesting difference and there are
holida dependencies so rather than
depend on everything in java re' we
limit it to just the things you need so
there's a what I do okay
well say well say that's the fact okay
yeah so there's a there's a pom which
defines the API is required for micro
profile at a compile time and another
one for you went use at runtime and then
all the way down below there's kind of a
load of magic relating to how to create
the
Ubbe jar so this configures Liberty the
little plugin to know where everything
is and then somewhere down below we
actually say during packaging deploy the
application is here and then below it
causes us to go and package it up as a
new badge are using this package server
goal and in the source code there's a
model the model is a basic Java beam so
nothing particularly surprising here and
in the API because we've just got jax-rs
and JSONP there isn't a jason be binding
yet for jax-rs we have an RA our kind of
implementation once the Java Bean
equivalent we have a whole load of kind
of providers which are here to convert
from the Jason for J not Jason with J
JSONP representation into the object
representation so these are registered
as message body readers and writer and
and do the marshalling and on
marshalling and it makes me realize how
much we need Jason B because of that's a
lot of code and there are four different
classes each with a lot of code in it
and then we've got the session vote
which is our jax-rs component in in this
case we have two ways of storing
information one is non persistent
because microfarad doesn't have a
persistent storage mechanism the other
one is using couchdb or yeah couchdb so
it can actually be persistent and we'll
switch the ones based on whether or not
we can actually connect to a couch DB
instance so in the example I show
lighter it will be just using hash table
and you know it's if you bind to slash
if you do get to slash you just get a
description of the service but if you go
and ask for slash n 10 D you'll get a
JSON representation we'll go to this
data access object and it will have
turned the end 10 D you can get you can
create it you can put to do an update
will
only accept the name so you can change
the name but you can't change everything
else and so on
and again for rating those posting to
post it you the attendee has to exist if
it doesn't exist you'll get the
appropriate return code and again
there's quite a lot of code in here to
deal with all of the different rest api
s-- and yeah the the kind of hash map
implementation is fairly simple
it basically just putting things in a
map it's more complicated for the
session rating because we need to be
able to get ratings by attendee and by
user so there's a lot more code involved
Java - Joe next what what from within
IntelliJ No yeah okay there you are okay
control see this is the peril of working
on some someone else's laptop yeah okay
so to start to tap let me okay to start
it up it's just a simple of doing Java -
jar
most services it extracts the liberty
runtime from the jar file to disk starts
it up and then if I take this URL and go
to a web browser I should fingers
crossed
yes it works usually I usually I was
panicked when you do something live
because it usually goes wrong back to
presentation yeah the stuff on the next
light so so the the built up jar file
that we we just ran is about 35
megabytes it could be a little bit
smaller
but that would have
required me to make changes to the build
it starts in about seven seconds and it
needs about 21 megabytes of RAM I got
this measurement by setting the max heap
size to 256 because depending on what
your max heap size is that number varies
because there can be a lot of dead
objects on the heap that aren't actually
in use as you saw our kind of uber jar
approaches you can use their maven
Liberty plugins package goal integrated
into your build instead of having a war
file get an uber jar and what the job -
jar does is it doesn't unzip and it runs
the Liberty server you shut it down it
undoes that so in terms of the runtime
Liberty has something similar to swarms
fractures it has it has libertad' we
call them Liberty features we have a
whole load of the features for all of
the Java EE specifications and that
means you can get the runtime to be
really as small as you need it to be for
the application so in the case of the
Vote service it is just CDI jax-rs and
JSONP the full java re' programming
model is there if you need it you just
enable the right features we have a load
of extra features for other things we
try to keep Liberty quite simple
especially around configuration its
configuration by exception so you don't
have very long for both XML files and as
with all server on times we have to say
it's lightweight and fast so Mike yeah
thanks Alistair so yes it's the payara
implementation so our part of the sample
app is the scheduled service so
obviously once you've got all your
sessions in the in the app and you've
got your speaker's they notice you need
to schedule as an attendee which which
session you want to go to and win so the
API is pretty simple there's not really
much to it its standard was same as the
rest of them standard crud rest stuff
so let's try and use a Mac this is very
foreign to me okay so also IntelliJ I
don't really know that very well we use
NetBeans a lot in payara it's open
source it's good it's Apache open source
so I guess you'll be changing to use
NetBeans for it yeah we'll see I'll
believe you when I see it so as you can
see there is very very little in the
schedule app those are all the classes
but they're much smaller than we saw
with allister's purely because one of
the things that we did was make use of
jacks b4 bindings so we've got some
marshalling and a marshalling stuff
there for date time stuff but again just
a standard schedule data objects
schedule data access objects most
interesting thing this really does is
just get data from this demo bootstrap
project which literally is just a loader
and then here's the API again as I said
it's just a simple really really simple
basic REST API that there's nothing in
there that if you ever done this sort of
thing before will be foreign to you at
all so what I wanted to pick out on with
the time that I've got is the palm this
is how we're building things with the
payara micro profile and because the way
that we built the micro profile itself
was effectively just to do another cut
of our existing PI our micro code which
is it takes much more of the java api is
so the way that we package this into
into an uber jar at build time is to use
the maven exec plugin so this is
basically doing exactly the same thing
that you can also do on the command line
with just a single jar artifact which is
the payara micro profile or PI or micro
and then use the same command line
options that we use there so you can see
there we've got output uber jar which is
the thing that packages all these things
like no cluster Auto behind HTTP so that
the resulting artifact is always going
to have those settings no cluster is
there because at its core PI our micro
makes heavy use of hazel cast as we've
got things like a clustered CDI event
but if you wanted to publish and
subscribe to CDI events across a cluster
and because that's not part of the micro
profile we've added that in just to make
sure that we're not starting for
anything that we don't need to or kind
of introducing any extra things into the
into the demo app because you don't want
to we've also got Auto bind HTTP which
is a handy little development flag where
I mean it can be used in production as
well if you're having a high density of
Pi or a micros that will literally just
increment the port if it can't bind to
one and then here we just deploy the
resulting voir file so let's head
straight to the terminal and I'll show
you how we do it
so it's control-c excellent so now I
believe the port yet was port 60 60 so
you can see this just do them sorry okay
there we go that's better so you can all
see so yeah it's on sixty sixty and
we've done that just with the - - port
again we could have put that in the pond
I XML and it would just be completely
wrapped up in the in the file so by
default the port is a DAT that command
will always always override the default
port so if I was to build an uber jar
with a port already set and then set it
again on the command line your new
command line setting would be
overwritten so those always get taken
into account so I start that up now you
can see the logo when it's done
and actually this bill time is or the
startup time is actually faster than it
was on my laptop so again I'm going to
go through a little bit about the
characteristics of it but this was done
on my laptop where I unfortunately have
to use Windows so I've got a Linux VM so
all these have actually run inside a
virtual machine so on my virtual machine
it was a boot time of about five seconds
just that you thought is about three so
you know it's is pocket change really
isn't it's not big the war itself is 60k
packaged with the micro profile is 33
megabytes so pretty much exactly the
same as what we've seen in the other
implementations the heap usage I put it
around 20 megabytes so actually when I
cut measured his he just took the one
sample and added the young and old heaps
together I did the same thing but I took
a few samples because it varies a lot
obviously as you know but yeah it's all
in the same ballpark I've seen that the
same kind of figures and the same kind
of variations at the moment really we're
looking at size is so small that the
percentage variations that you get at
those sizes are a huge anyway so it's I
would say all of the implementations are
small enough to not really make much
difference so uber jar approach at the
moment is to use just the maven exact
plug-in or the command line I've just
put the command line options there again
and at the moment it's actually the
focus of a bit of a redesign because
what we found with payara micro empire
and micro profile is alistair mentioned
that when we're kind of doing this
ourselves we go through some of the same
kind of pain that you guys going through
I know that I speaking to Alistar
earlier and he mentioned that in
creating his application he noticed that
actually this some of the behaviors in
websphere liberty that he doesn't really
like and he wants to change and I found
that as well so I raised a couple of
feature requests myself in trying to get
this stuff to work because the way that
it works alone it does the job but it's
not really as nice as it could be so
please all everyone
does investigate this and use things do
please raise issues against I github and
with the other guys as well we really
appreciate it so just one or two extra
interesting features hazel cast I've
mentioned and also the fact that in
creating this micro profile cut of a
player on micro led to a change in the
way that we do our modularity purely
because at the moment it's it's not in
an ideal way and it's needing to make
leading us to make a few compromises
that we would rather not make so there
is a potential for composability on the
cars which we don't have at the moment
but that's all very much future and the
subject of some research at the moment
so with that I'll hand over to Andy and
he can talk about Tommy tribes
implementation yeah hi everyone I'm Andy
Tommy traivor
I was kind of given the task by David to
pretty much sew this all together so I
created the initial project structure
create all the stubs for the project and
then these guys helped me fill
everything out something that's being
good for that has been a really really
nice learning process I'm just gonna go
straight to past energy we've all seen
each other services the the Tommy
service is going to be no different to
any of the other services we're all
building applications we're building war
files we're deploying something that
we've not discussed this is how easy
this is looking there's a lot of
boilerplate code going on behind the
scenes here and these guys will put the
effort in to make it actually look very
easy our goal at the end of the day is
to create a deployable jar file that we
can throw out to some kind of no
management system and we've picked here
fabricate so we're using fabricate on
all the profiles that's something we're
not going to demo today because it's
still being developed but the goal is
basically to build
a jar file or a war file that we will
deploy to an image you know in our
docker cluster or whatever management
system we're using in the background and
so we've done the speaker service and
again it's just a project very similar
to when else's project and we're going
to have a resource that we're jax-rs
resource and we're providing this
service the same as everybody else
okay so yeah we've got a plug in we're
building our executable jar using the
the tommy plugin so we have an exec goal
and that builds and packages everything
so we have an application we're just
using it in our IDE the same as we're
developing any other application and
this plugin will take your application
package it in a war file so it together
with Tommy and deploy it in an
executable jar file and again this is
made to look very easy so something that
I've learned through this is using every
other vendors service is how they do it
and compare it to how we do it we're all
doing it in a very similar fashion so
this project for me is a showcase of how
to do it so if you need to work out how
to do a micro service for a liberty
profile then you can use this
application as a template and the same
if you want to deploy and Tommy then you
would use Tommy as a template so all the
information is there all this
boilerplate code has been put in place
by us for you guys to use the the aim of
micro profile is obviously to make that
and unified so we all want to do things
in the same fashion and we've already
encountered
I think ports was the first one so the
port conflicts how do we set ports for
our services and that was one of the
very first things that we had to resolve
so that we could demo this on the same
machine and so that's a real focus the
next one is going to be configuration so
how do we override this so we provide
the configuration and we all have a
different way of doing it so we all have
a different string to set our port
values so that's one of the first things
we want to resolve is enable the
configuration and use the same
configuration options so that when you
build your application you don't have to
learn all the different options for the
different plugins yes we put that
together and run that as a service so I
go to the service
okay pass the service this is the first
time I've used a Mac so but I am getting
one for Christmas I promise my cell
phone for Christmas so this is the Tommy
service running I'll just kill that and
I'm not a Windows apologist I actually
quite like Windows 10 I think it's a
extremely stable platform many of the
customers I'm conserving they use
Windows I need to use winners in my
daily work and actually by developing on
Windows I found a couple of bugs and
some of our some of our implementations
specific to Windows and create a poll
request got that fixed so that's also
being a benefit running X on the Windows
platform and again you've seen in all
the other applications we just have a
jar file that we've created this is a
factory which contains basically Tommy
your water application and every all the
dependencies required to run an
application and when we run it you can
actually see it unpacked Tommy and fired
up the application deployed the the
resource and done it in WoW one point
sort these seconds that's pretty fast
it's faster than mine I think it's
actually like three because there's a
tomcat initial phase and then there's
the startup focused report two different
numbers and everyone sees the second
number and I think that's the only
number that's that's the number I'd like
to focus on yeah
yeah but it's about three yeah okay so
we can go to our service so our service
is probably the most simple service I
think we put our hands up really really
quickly the discussion phase and said
yeah well didn't speak your service
because we kind of knew that was gonna
be the easy one today very simple API
we're just obviously querying speaker
information providing the information
through through the services so our jar
file that comes out pretty much exactly
three five megabytes so nice and small
I've been more realistic in the start
in the slides it's three seconds and a
heap usage is 75 I don't know if we've
used as just trick to it I don't think
we tried adjusting the default heap size
yeah it's actually one of the
interesting things that's kind of come
out of this is that we're all
discovering oh let's all measures
startup time and heap and then we all
try different things what I think the
nice thing is we don't know that we're
just we're just doing that to prove a
point but we don't have to do that all
that profiles run very very nicely in
default settings of Java so you
shouldn't have to apply any command-line
options for Java you can see all these
deployments are really small really
quick we're nitpicking when we're you
know the difference between three and
six seconds well we like to knit and we
like to pick because we're engineers so
yeah you know I think it'll be funny
want to improve it for sure yeah I think
it would be fun to actually keep doing
this and post the data on the micro
profile website so people could just
kind of get a snapshot of where
everything's at because when you really
look at all the startup times they're
almost identical I mean five seconds
versus three versus it doesn't really
matter unless you guys don't have two
seconds to spare you probably won't have
two seconds to even tell me no probably
takes longer so you know everything's
pretty much in the same range everyone's
servers are about the same size of disk
startup and about the same time and you
know well yeah we really come a long way
for from the old what was it determined
I go coin yesterday was learning our way
forward yeah so we looked brilliant erm
we're learning our way forwards so we're
learning from each other we're learning
how to so all this together to make your
lives easier at the end of the day so
it's actually making our lives a little
bit harder in an effort to make your
lives much much easier interesting
features well we're we're basically
taking a naked Apache Tomcat we don't
change a single line of code in Tomcat
we're adding all the a P is to Tom yeah
doing all the configuration and sewing
it together adding one or two api's to
Tomcats
particularly hard but when you start
adding more and more of the api's out
there becomes an increasingly more
difficult task and we've done that for
you may provide various profiles we have
the Jax Irish profile which has their
closest to micro profile profile that
you should be using and we're fast
lightweight and familiar same as
everyone else's
an Apache 2 license so I think that's
worth mentioning is you know we put our
hands up and said yeah we would like to
go to Apache Software Foundation but
because we're collaborating on this
there were less hands for Apache
Software and we moved to the Eclipse
Foundation which I'm looking forward to
because I haven't had a project on tipps
foundation ever so that we're gonna be
learning some new processes there and
then finally back to the code we've sewn
those sudden this all together in the
web application so there's a web
application I and do five minutes on
that so we can get the closing slides in
okay or less oh this yeah I'll be really
quick so this is basically a a node
application initially when I had to do
this it was a kind of choice what are we
gonna use what I wanted to be right the
cutting edge because we're doing
something at a cutting edge so obviously
angular 2 and bootstrap 4 so this is
kind of a really good template project
I'm fairly proud of it
the version on this one isn't the latest
version it's on that box but it was too
hot of a pull request this morning to
get it across and put it on this machine
and then break everything so the latest
UI is not the the current UI but yeah
everything's been done sort of best
practices and again it's been learning
my way forward doing an angular 2
project with bootstrap for
so this should all be running on 8080 I
believe you said it was 8000 so a
low-cost 8000 oh yes yes cm p.m. service
yeah so this is basically a very I won't
say quickly knocked up GUI because it's
been a serious learning curve to get
this all put together but this is a full
fledge angular 2 bootstrap for
application pulling data from all of our
services and so all four servers running
on the laptop with one UI pulling data
from all the micro services so
effectively this is the tada moment of
seeing all the work come together yeah
sure so yeah we've made it look easy
we've all got our fat jars we deployed a
franchise if we're imagining that's
running in a docker cluster everyone's
running in a docker cluster I can
cluster this UI application as well and
scale that elastically how we want so we
we provided the entire architecture for
you to deploy to an elastic deployment I
think I used aaron Gupta here the the
sessions are obviously coming from the
session service and clicking on the
session service I get more details and
we have the votes and the schedules and
these are the things that unfortunately
can't demo this morning we're using full
calendar using prime energy so the
angular 2 prime integration so again
something's made to look very simple is
acting very difficult to do and you can
use this as a template or a starting
template to say how am I going to do
this literally you know fork this and
just change the code to meet your needs
and votes very simple view just pulling
in the votes from the from the vote
system the latest version does have a
knife a pie chart and a bit more
information but again it was just to to
scary's who do the pull request this
morning that said the pull request this
morning could have been done because
we're active everyone is active there's
lots of people contribute to the code
and that was the reason I didn't want to
merge the pull request because wasn't
just mine there was other people
and in the reviews but that's nice to
see that you know even as we stood here
there's people working on this project
and to provide the information for you
guys and I think it's now back to you
David it's this work right perfect okay
so alright so that's just the demo
portion here and so the interesting
thing about this so one this is a github
repo this started actually we've broke
into the code maybe August something
time anyway so it's about the 355
commits on that there's about 21
contributors Yvonne even office one of
them using the room so there's a lot of
activity going on on this even though
it's just a small little thing
I think the coined phrase that heiko had
yesterday learning our way forward is
kind of a fun way to describe it how
often have you seen all the vendors work
in the same codebase using their
technology together and dealing with the
pain of it I think that's the kind of
the fun thing that we're just like
rolling our sleeves up and and trying it
out and the community is obviously with
us doing that we've seen everybody
supports an uber jar everybody has a way
of setting the ports via the command
line or there are plugins and all of the
ports are conveniently different that's
you know all the flags are conveniently
different so there's a lot of
low-hanging fruit there I think that we
can get out of the way in terms of you
know fixing up one of the things that we
didn't show persistence okay so none of
these things actually saved data
anywhere and so I'll kind of you know
explain why for the moment but I've
doubled the one was security so one of
we we get this going we'd never actually
logged in you're running as an assumed
user on all this stuff and so that is
probably one of the first things that we
will try to do in terms of the road map
of the next iteration of the micro
profile which as I say we're intending
these things to iterate pretty quickly
like you know two months time framed not
two years and so we had a lot of
discussions about well what you know
what should we do with security
we know hey we support this thing called
a job yeah yeah we do that too
yeah we do that too you have we do that
to everyone's done doing that's like why
don't we just acknowledge this right so
we all line up our stuff and real real
well we realize we all have a way of
setting doing auberge are slightly
differently that's fine we're probably
going to be able to keep the slightly
slight differences but maybe things like
the command line flags for setting the
port that could be the same we all have
some sort of concept or the ability to
plug in something that can maybe help
you out put swagger but what would be
what would the path for that be well why
don't we agree on a path where you can
always go and get something like swagger
if we're all supporting jots and JSON
web tokens so to speak then why don't we
agree on where the user is going to be
found in the job and what the roles are
in the job and that we all have to be
able to verify a job via public key
because we're all basically doing it but
we don't have any standard way of a user
setting that up and knowing exactly how
it's done and a guarantee right so it's
basically us writing that kind of stuff
down and saying this is a guarantee you
get with something that's a you know in
the micro profile other things that
could be you know kind of worked out is
caching I know
payara and hazel caste have done a lot
of work together we're working with
hazel kes now in terms of making sure
that that works actually does already
and so hazel Casas hopped up on the
project since it since it launched and
they've actually been rolling up their
sleeves and themselves digging into this
very sample app and trying to figure how
to work that stuff into the ecosystem
which is a very kind of interesting
thing because it like I say it's a use
case driven thing first but
you know all those things are potential
roadmap but like I say we did not
include persistence in there because we
wanted to ask you what you wanted in
something like a micro profile
so rather than load it all up with what
we think is the best thing we
intentionally came out with the absolute
bare bones minimum amount of
specifications that you can possibly
include and get something that is useful
so you can add your own persistent stuff
on top the micro profiles not meant to
be a mint like you're supposed to stop
that's a base right and so you know we
did come up with a survey and I'll kind
of show you some of that data but
basically we wanted to make sure that
the community had means to discuss these
things and decide what should be on the
roadmap and what should be next another
thing where we didn't include a whole
bunch of specifications in there is you
know if we're trying to make things
faster we can't keep doing the same
thing that we're doing before you know
if you have the choice between
delivering 12 things every two years or
delivering you know one thing every two
months at the end of two years you come
out with the same but you give people
things in a more incremental fashion so
not tackling conversations like
persistence allows us to at least
establish a baseline of yeah we all
support uber jars yeah we all have low
memory profiles yeah we can you know do
do basic configuration via plugins or
via the command line with all the stuff
packed in the app and that's you know
that's you know kind of a base it's a
good ground to stand on right it's a lot
of people don't really even know that
that's possible with what they would
traditionally consider an EE like server
so we did get about 3,000 close to let's
20 shy after we leave this room
everyone's going to go to the micro
profile dot IO website and take the
survey so we'll top 3,000 later today
right okay and so this is the kind of
sponses we got we got we guessed pretty
good jax-rs and CDI were pretty high
http/2 and Olaf are probably the the
next two down and so I think that kind
of matches up with what we've discussed
in terms of what we thought the next
logical thing to add to the micro
profile obviously security via OAuth is
is you know high among the list at least
validating a JSON web token that some
security gateway gave things that came
out high in terms of concepts like
what's important to you he asked startup
time was the highest rated thing of all
the questions we asked that had the most
number of votes almost a thousand put it
as their top priority you know we asked
people to rank one to five memory was
the second highest and that's that came
up pretty high metrics actually received
a pretty decent response I was kind of
not surprised but but I thought it would
be mentioned but it ranked basically
third on the list and then you know
having some sort of answer for reactive
base stuff also showed up which you know
we were discussing at the boss last
night you know something we can probably
do behind the scenes of the existing
jax-rs API just start making things
asynchronous have some sort of
observable thing that gets passed into
the method but that will probably won't
be immediate things that did not do well
on the survey disk space surprisingly no
one cared once you get down to like you
know a hundred Meg's or something like
that no one cares especially if you're
shipping this thing around on a four
hundred megabyte docker image you know
as Alistair mentioned he could probably
shave five Meg's out of the distro but
who cares anymore you know it's disk
space is cheap these days now nobody's
and nobody's shipping on DVDs this is
all like you know very low but that
we're basically at a point where it's
not high I mean
but he's list anymore uber jar
surprisingly mediocre even though we're
all doing it it seems to be you know
people are comfortable with what's there
then we had some other kind of fancy
things we asked that just did not show
up so interesting things that we should
that we were thinking about maybe doing
next we discussed in a lot of the Java
one talks and talks like this what we're
doing because we're all having these
things to work together services
interoperable e is you know there is a
lot of room for us to improve
interoperability in terms of one service
talking to another and how it fits
architectural e something that we could
potentially doing is focusing less on
the api's inside the VM and more on the
interactions between the services at an
architectural level and maybe come out
with something say that's called arc
micro profile interoperable and that
might be you have to receive a jot in a
JSON message you have to be able to put
data and it no clues no sequel storage
have a health check endpoint and if you
can do that you're a micro profile
interoperable and spring boot could
easily fit that thing and we can
basically have a kind of architectural
definition of what it means to be
interoperable and swappable and that can
enable things like you know security
gateway vendors to go alright well I can
talk to any micro profile interoperable
implementation because I can pass the
Majok with the public key and I have the
two standard fields in there at least
and we could have maybe a list of of
things that are capable of interacting
with something that's micro profile
interoperable metrics metrics and stats
if we did come up with something that
had standard metrics and stats you know
there's a lot of vendors like New Relic
and things like that we could
potentially convince to market their
product as being capable of talking to
anything that's micro profile
interoperable I think there's a lot of
room that we can do in this space and I
think it's an interesting thing an idea
James Strachan came out with the other
day I'm just going included in here
as why not make a start micro profile I
oh as you can see we've all worked out
the bootstrapping code in a maven
project that has the minimum number of
pom settings and dependencies set up so
why not just put up a little website
that allows you to click the stuff that
you want say the micro profile
implementation you're interested in and
boom it generates you a start project we
actually run all of the micro profile il
website is all open source code so if
someone wanted to start hacking on
something like this right away you can
just go to the github project fork the
website repo and start digging in it's
all written in Java with angular
front-end and it's it's pretty easy to
get to get in into the mix of it in
terms of roadmap we're trying to keep
things relatively focused so the the
format we're getting ourselves into is
bring your ideas we're gonna have a
couple weeks of conversation and then we
will all commit to something and do that
one thing for as long as it takes to get
it done so one month two months and then
we will have open another round of open
conversation we will all talk we will
all argue what is the most important
thing to do we'll make a vote and then
we'll decide that's what we're doing and
we'll keep that iterative process going
and that's how we're going to keep our
velocity going so we have a project
where you can file ideas that's the one
to look at
so micro profile slash evolution is a
github project is a good Hubble repo
file issues there or just talked on the
mailing list and that's the good way to
go good things to do is you know get
your jug involved we have so Java we
have ljc if you have your your local
community bring them up here but
otherwise go to the website and thank
you very much and hope you enjoyed the
talk</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>