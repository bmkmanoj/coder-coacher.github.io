<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Java EE Security API by Jean-Louis Monteiro | Coder Coacher - Coaching Coders</title><meta content="Java EE Security API by Jean-Louis Monteiro - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Java EE Security API by Jean-Louis Monteiro</b></h2><h5 class="post__date">2015-11-13</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/TivynzrVZ0c" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay thanks
hi everyone thanks for coming it's the
last session so I guess you are all
tired today I'm going to just finish
this first you know this day with a
one-hour session and the Java security
API it's a brand new API that is going
to be on Java 8
the code name is Jael 375 world you
heard about this JSL oh yeah a couple of
you that's good
so I'm gonna invite one of my friend
Ryan McGinness during this talk and more
especially at the end during the demo
you're going to share with us some
experience about the cloud computing and
the security challenges so first of all
some words about me
so my name is Johnny montijo so I'm I
work at Tommy tribe I have about an 10
years experience on Java EE and I am an
open source addict not just because I'd
love to spend my evenings walking on
open shoes but also because I can meet a
lot of great people and that's also the
reason why I joined also the the expert
group for the first time with the AG be
sweeter too and since the beginning of
CCO I just joined as well the Java
security API yeah I have 200 foot kids I
just missed the birthday of my son
yesterday so happy birthday Luka thanks
so today I gonna spend some time trying
to go through the motivations and why
the JCP decided to create a brand new
juicer totally focused on the security
I'm gonna try also to so it's as I will
say a bit later it's a really broad New
Jersey we barely started so I'm gonna
try to share with you some of the ideas
of the expert group also gonna go
through some examples that we created on
our pre playground and hopefully gather
some feedback from you all in order to
get back to the expel group and take
into account as much as possible
feedback okay so the idea to create a
new GSL came from the Java 8 survey
about 5,000 people enter this survey
which is really a very small subset of
the Java community I guess but it was
pretty clear in this survey that you
know the security was really a big
concern in in Java platform and the JCP
had to are to work on this area so as
you can see on the on the chart about
1/5 is on the security simplification
and security interceptors so I'm gonna
go into a bit into details if you want
to get all the result of this curve it's
available in the Oracle website or the
de blog from individual well some of the
questions I won't go through all of the
questions but some important questions
that we are trying to tackle in the
external group so one of the question
was the ability to support the password
ionising we don't want anymore to have
the passwords in clear in any
invitations or any configuration for so
we want to be able to resolve the
password at one time but also a couple
of cryptography on top of that so we
don't need to have clear passwords
anywhere so about 60% of people say that
it was an interesting feature
for those who are familiar with Java II
basically the only thing we have in Java
is principal so there is definitely a
need to standardize you know some of the
important notions like the group the
walls and make sure that we can define
some mapping between the two so it's
also a big part of the of the answers
just because windows just speak yeah so
just became like six or seven years ago
obviously it's not a well-known
specification it was supposed to bring
some flexibility to the applications to
register their their own rhetoric
authentication module but you know it's
way too complex like you know you need
to implement like six interfaces
something like that just to register
your own authentication module so yeah
most people has to simplify that just
pick specification so we're gonna try
also to talk on this the next one is
also quite linked to this one which is
basically the ability to to have a
standard configuration so that you know
when you switch from one container to
the other you can hopefully use the same
configuration and have a better
opportunity and finally the last the
last one is the expression language so
basically until now in the Java
specification we had only like the
world's onload annotation where you can
use only a string which is a roll name
so the goal of this feature request is
to being able to support something more
flexible and the expression language is
one way to get more flexibility so that
you can implement more complex
authorization rules in your business
well I also got some some feedback from
some well-known people some which are
part of the community so one of the
aspects that went orphaned as a feedback
is that basically Java keeps ignoring
that people uses the cloud so you know
and most of the time the security is
configured as part of the container and
unfortunately when you use some cloud
deployments you can touch the container
configuration so it's really a problem
and we need to tackle this this problem
so what's wrong with this Java security
so as I mentioned previously one of the
big issue is that it's not portable it's
it's overly abstract like the Jazz peak
example I gave you so you have to create
a lot of interfaces you only have
principles but you cannot say that this
principle is the user name or it's a
role so you cannot make any difference
between the principles and not
cloud-ready I think today we can't
ignore anymore that we have to deploy
our applications on the cloud
so we need to be an enabler and although
people to use Java security on the cloud
and I must say that nowadays it's a big
challenge and you know by the time we
got these chairs people just went into
third-party frameworks and it's becoming
harder and harder to get them back into
Java EE so some related specifications I
mentioned some of them just which is
pretty old specification like 15 years
old specification it's still widely used
today jack is more for container so I
won't spend more time on that and the
just pick one which was at the beginning
in my opinion a good specification but
ended into something really complex and
something that people at the end doesn't
use don't use
so what does that choice do we have
so we have to the facto standouts just
spring security one any of you using
spring security yeah that's the most
used it was previously known as a saggy
when I started looking at it and wow
it's it's pretty flexible framework very
powerful until recently it was only an
API we've no back-end which made sense
makes sense for me because we all know
that the security is you know most of
the time projects Pacifico enterprise
specific so it's really hard usually two
to create a back-end that that can fit
all the needs but recently they have
added some some backends like in memory
back-end or a JDBC backing the other
well-known one is Apache Shiro and users
of Apache oh yeah this is really a good
one if if you want to spend some time
looking at Apache she all the
documentation is not always up to date
but the architecture of this project is
really nice and it has some drawbacks
compared to spring security but it also
has some great benefits for instance
it's not tied to two service
specifications so it has its own session
management that you can use on on the
plane application server you know and
not especially in insulates in even in
Java SE and you have some high-level
cryptography features which is pretty
convenient because the Java cryptography
API is is quite boring to use and a bit
too verbose and what else well I must
say that most of the time I've seen
people writing their own how many people
yeah obviously so yeah all of us already
wrote our own security framework as I
mentioned previously the main reason is
that usually you have to take care of
you
on you know your own company and the
story of your company so it makes sense
so what to do well I think first of all
we need to make the current security
api's simple and usable we need also to
modernize the the security api's as aunt
ones about your mention during the CDI
to that all talk we need to get together
and try to to see how we can use CDI in
the best way to to leverage or Java EE
security API and as I mention also
previously we plan to heavily use the
expression language to make it easier to
have your own authorization rules
developer-friendly yeah lot of XML as
usually in Java II it was the case
previously we tend to use more
denotations we still have a lot of XML
painting on the under java's is under
Java security area so we definitely want
to get rid of those painful example
files too right and as I mentioned also
we want to be cloud ready which is avoid
all the server configuration so yeah the
es jss 375 is focused on the application
development the security is to use
that's our main driver and we want to
achieve that we won't probably get it
all inside the first version but we
definitely want to start as simple as
possible so that we don't add anything
you know something that will become a
restriction for the version 1.1 or 1.2
so better to start simple Gazza feedback
and then during the next versions
continue to add something so as I
mentioned the the expert n'gaa piece
quite new it started like almost 1 1
year ago in last December the expert
group has been built during the first
quarter of this year and we barely
started so basically we started talking
together in May or June and we started
putting together some examples on the
things we would like to change and
that's where I'm going to spend some
time now quick to of the expert group
not that I want to focus too much on
people or but I just want to say that
most of those people come from different
companies not only the big you know the
major companies but we have also a
couple of individuals which is important
from the photo specification we have the
chance to have a couple of them at
devoxx so feel free to to ask them and
to meet them to ask you know to get some
some answers and you to contribute to
the project well as I mentioned we just
started the specification so we have two
options you know a good opportunity to
get it right if we don't want you to
have everything inside I think and
obviously the risk is to get it wrong
hopefully you can give us enough
feedback so that we can try to finally
have something useful so yeah the goal
of this talk I'm afraid but it's not to
give you solutions we don't have them
yet we are looking for what we could
what we can do to simplify everything my
goal is to get your feedback and report
to the expert group so that we can
improve the things alright so the main
focus for this specification is mainly
as I mentioned try to modernize and
standardize a bit the things so the
first focus is at Lee
to have the same terminology you know
and so that we can discuss all together
and also exchange with the other
specifications we plan to spend some
time on the user management try to see
if we can include a simple back-end but
something that people could use out of
the box without having to implement
something we want something that runs
and obviously we plan to spend some time
and the password are aliasing and use of
features in terms of planning we are
currently working on the terminology we
are also working on some authentication
mechanisms I'm gonna go through some
examples after we worked on the identity
store and if we have time we're gonna
continue through that list and do as
much as we can in terms of terminology
how many of you already use ejbs yeah so
for instance we have some crazy
inconsistency like you know a user and a
caller so from a servlet point of view
we use users from an EJB point of view
of you we use colors and as I mentioned
we have no know group we only have
principles so it's it's kind of missing
we have also a lot of security context
so we have two selves that one you know
where you can find the user enroll and
get use of principle well you can also
call login and logout we have the
session context from the EJB world and
now that we have jax-rs we have also
security context in jackson as well you
can also check if you you know if the
user is authenticated etc but guess what
we don't have anything for city ID so we
may have at some point to work also with
the CDI specification in order to find
you know canonical security context that
we can apply all over
the platform I don't want to know the
security context for CDI which is also
different from the other ones and we
started working on the something where
you can store your identities there are
different ways to name it you know some
like Tomcat or a petition name that we
own some authors use login module and
authentication provider so that's why we
want to walk on the terminology so that
we all speak the same language so here
is the big picture of what we ended with
in terms of terminology so the security
context is the meet in the middle then
we are the identity store and a couple
of other terminology we we've decided to
to integrate into the specification ok
so if you have some questions I can
answer some questions otherwise I'm
gonna goes who IntelliJ and try to give
you some some details about what we
started with and some examples ok
all right
this is the one we created together do
you want to give some words Ryan
all right so thank you John the wafer
invited me up here today to talk to you
guys
so back in January I contacted David
Blevins and he quickly put me in contact
with John Dooley and said talk to him
he's doing this right now in the problem
that I came to David with was and I'm
deploying Tomcat and I'm deploying Tommy
into a cloud environment and I need to
be able to configure it dynamically
because I can't have people writing
context XML files creating very complex
builds moving everything through the
system so one of the goals that I had
come to him with is we need to make this
easier and of course again Jean Louie
types to me over Google Chat and he and
I start coding so I was January 7th
about the evening of January 7th we
actually had a solution that he had
already been working on in Tommy called
the lazy realm so with the lazy realm
allowed us to do is inject an
Authenticator and an authorizer
via a CDI and this is the this is where
we're gonna actually talk now with this
example that we had gone through
together and we had some follow-up
dialogue on things on how we can
actually work with this together so
Tommy and Tomcat
are fundamental to our success they are
one of the things that we build on but
from a cloud container
they must be configurable at runtime so
one thing that I would say that is very
very important if you if you didn't hear
it is we need your help in the security
roam identification we all have problems
there so the sooner people get involved
with this the more malleable it is right
now the further it gets along the mortar
more solidified it will be the harder
will be to change we need your two cents
worth so if everyone in here did what we
did what everyone did and created your
own we all have the same problems we all
have the same pain points and I think
that's where we can come together in
this particular jsr and fix it otherwise
these guys right now are standing at the
base of a very tall mountain
saying we want to change the way things
have been done for 20 years so all the
help you can get and and we'll be here
of course with you along the way so
thank you for inviting me up to speak
thanks thanks so yeah the idea of this
example is to go a bit a bit further so
the first step was to enable CDI at the
security level the next idea was to
avoid the you know the we own the Tomcat
wium like interface where you cannot add
any other method which you have to
implement all methods even if you only
use one so the idea was to use the CDI
events which is a pretty convenient way
to achieve that goal where we basically
define it we defined a set of events
depending on what are your credentials
so in this example the credentials are
only the user password but the ID beyond
this events mechanism is that you could
use like a node to token you can use
like an x.509 certificate to
authenticate but you only have to
implement what you need and you can do
that in your application you don't have
to do that and push off of your
application in the application server
because that's usually the case so the
idea was that at the critical steps of
the authentication the application
server will fire a couple of CDI events
and you can just observe them into your
application and do your dedication based
on your back-end so for instance if you
have you know a JPA model you don't have
to package all your JPA model and put
everything into your container you can
keep and control everything into your
web app so this authentication this
observer is pretty trivial and almost
useless but that gives you at least a
view about what we can do
so this is the authentication part we
have also the login phase where you can
use the HTTP request to authenticate and
obviously we have a servlet with some
security constraints so it uses the
annotations instead of the web.xml file
but the result is the same to access
this servlet I need to have the
administrative entry ohm which is you
know the link between the application
server and your web app using CGI and
that obviously runs and I go so I've
just tested that with an akheon test so
well I can run that doesn't make a lot
of did value so yeah the idea is really
to make you know use as much as possible
the technologies we have today and CDI
is obviously one of them ok so in terms
of playground I forgot to mention that
we have a github repository that you can
visit if I can move that to the other
screen maybe not so anyway we have a
github repo where you can find all the
examples are gonna go through today
maybe not all of them but you can
definitely contribute your own example
or at least submit your IDs or create
issues well I have a couple of examples
now I go so this CDI one is the one we
have seen with
to me so it doesn't make a lot of sense
to go through it again yeah
there is one thing also we want you to
fix in the specification so we also keep
forgetting that HTTP is a rule today and
nowadays and the West is also the rule
and not having the ability to basically
apply the servlet and HTTP constraints
on a JAXA a sense endpoint it's really
painful so one of our wish is to being
able to use the servlet annotations on
your regular rest endpoints so that you
can enforce the security without having
to use the security context and do that
programmatically we have also which crab
this one is quite obvious
I mentioned that previously so in Java
by default we only have the principal so
one of the little change we would like
to do is basically create subclasses of
that principal so that when you receive
a list of principles you can make the
difference between the user name and the
roles or some cigars so we're gonna call
that color principal or user principal
again it it depends on what we're gonna
end with in terms of trying to align
between the EJB specification and
resolve that specification so if we go
through the servlet specification path
then it's it's going to be probably user
principal if we stick with the HIV
specification is going to be probably
code of principal but that doesn't mind
and obviously we plant you also create a
group principal as I mentioned so that
we you can just put all your groups
inside and be and be able to
differentiate different suite
we are go so as I mentioned we want to
also try to find a canonical version of
the security context however diving you
know different names different objects
different ways to test if the user is
authenticated or not so we plan to get
together with the other specifications
and here is one of the proposals we
ended we ended with which is this simple
security context you know with at least
a login method the logout method and a
couple of additional you know helper
methods to to make sure that we can get
all the roles and get the name of the
user
I go so another idea that came from Reza
is to be able from the container point
of view to also use CDI events to notify
the application that the user just has
been authenticated or there is an
authorization request so the events
we've seen previously are used to
authenticate the user we plan to also
extend that to notify the application so
that the application can track the
current users connected or can do
whatever he wants to so we are singing
about the couple of also events on that
on that path so this is the way another
way to authenticate which is a bit
different to the one we have we have
seen and the path we follow together so
the goal you know is to fire a generic
event which is a notification and then
to have some kind of binding between the
credentials of the user in order to find
the right method so that's another path
we we are thinking about that and
probably yeah we're gonna have to
discuss and find you know the path we
want to follow that one is quite
interesting because that's laws that
allows you to basically build at runtime
the set of rules you wanna give to your
user usually as soon as you authenticate
the set of rules are statically written
but with that approach you may have to
well you have the ability to already on
a different set of rules for the user
okay so some of you already used the
jazz login module so we went into also
this login module issue so it's really
like painful to implement a login module
because it's too abstract so you
basically get a subject and maps and
then you have to do it yourself so we
plan to give people more strongly
strongly type interfaces and give them
the ability to implement that on their
own application instead on the
application server so here is for
instance an interface for the password
login module again today or two is you
know is a de facto standard for tokens
so we need also to being able to support
tokens like do two tokens and being able
to also support more complex flows
because we don't always receive the user
credentials sometimes we may have to
talk to an ID
identity provider in order to
authenticate so we may have to support
some more complex flows and that's what
we want to do with those login modules
as well this one is interesting because
it comes from the Delta spike community
so it's a bit more low-level but you
know you have to choose your way if you
want to have a lot of flexibility
usually you have to go more low level
and that the path the Delta spike guys
went to so they basically have you know
a binding and the secure notation and
then they can use that in order to
secure their resources so it can be like
JSF resources in this example but it
could be also any other CDI bean or near
Zoar servlet
or whatever and then obviously we all
have to implement an interceptor like
class that does the job you know this
one is annotated we've secured on and it
received an invocation context and then
you can do your job which is wait with
the permission required annotation goes
who the values which is the list of the
roles required and then you can
implement your own logic to make sure
that the user that is currently logged
in has at least one of them or all of
them if you want you that's also
something which is missing in these
specifications so for those who are
familiar with the roles alone as soon as
you have one of the roles you can just
it's fine I would say but we don't have
any way to say the user needs to have
all those roles in order to be able to
execute the method so that's also
something we are we would like to add
because it's been a request that that's
been done a couple of times so we want
also to being able to say ok you need to
be mean and something else in order to
execute this this method
I want to have the expression language
one I go so well the name is probably
not the best name we could find for that
but never mind
yeah the goal is as I mentioned you are
being able to have more complex
authorization rules this is a proposal
from Reza which is obviously very
interesting and which is something that
has been asked a couple of times as well
so you know it's pretty obvious you can
just define your own expression language
put that into an annotation and then
leave the container evaluate the
expression language and make sure that
you can access or not if you can access
then if you can execute then you can go
into the method EQ if you can't then you
get back with an arrow what else do I
have
yeah we started so those were the simple
examples we started thinking about a
back end so Arjun has been one of the
you know the biggest contributor to this
back end we did like a very complete
proposal we we are walking and
discussing on top of this proposal to
make sure that again we don't want to
add something or any abstraction that
that will become you know a restriction
tomorrow so if you know if we have to
put that or to postpone the back end
we're gonna do that if that rose asked
you to grab some feedback if we think
that we are ready to go with a simple
implementation that all containers will
have to support then we'll do it because
at least you have you know in all the
containers you have a ready to run
security back-end so as you can see I
won't go into details into this identity
store you can
again goes into our playground and goes
through all the examples and also
contribute to own back in and do some
comments there is nothing really sexy
inside basically we have we need to have
the ability to read we have a user or
color depending on the terminology check
if it exists a blog as all the group's
roles also delete a user other users or
some basic operations so that at least
you can add your own users delete your
users and do a couple of basic
operations on top of them that's what I
want you to go so just peek because for
those who work with just peek so yeah
we've just picked you basically need to
write as far as I can recall you need to
implement six interfaces in order to
register your own notification module so
we are singing about adding some kind of
help or classes the HTTP message context
class and the abstract HTTP server
authentication methods module the goal
of that is to make it really easier to
implement your own notification module
and to register that module into the
server without any need to package
everything into the server or have any
external configuration file so we have a
couple of boilerplate into this class as
you as you can see so that you don't
need to implement everything yourself
and the goal is to just focus maybe
decrease bit that's still readable yeah
I go so the goal is to make it simple
for the users to implement their own
authentication mechanism again the goal
is to have something flexible so that
you can use
or to tokens if you want to you can use
HTTP signatures or whatever but the goal
is basically to implement your own
authentication module very quickly and
to get the container to use it the other
ones are probably not that interesting
for today well I think I'm gonna stop
here because I would like to take time
to discuss we have almost 20 minutes
left but I really would like to get back
to the expert group with some feedback
so I don't want to go through all the
examples if if at the end we don't have
any time left for the questions so I'd
rather stop here maybe I have a couple
of rows or poles in my slides so we can
discuss together any questions or
anything you want to see in the
specification or any proposals no I have
a couple of polls I guess yeah so first
of the security page is the playground
Ghita project so again go ahead and push
your own to request your own examples
with happy to get that into the
specification or at least to get that
discussed so I have a couple of polls
but doesn't make really a lot of any
questions
no questions okay thank you very much
then</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>