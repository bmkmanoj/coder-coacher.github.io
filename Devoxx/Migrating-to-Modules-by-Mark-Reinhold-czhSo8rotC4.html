<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Migrating to Modules by Mark Reinhold | Coder Coacher - Coaching Coders</title><meta content="Migrating to Modules by Mark Reinhold - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Migrating to Modules by Mark Reinhold</b></h2><h5 class="post__date">2017-05-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/czhSo8rotC4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Birgit make it do it makes it welcome to
the session on migrating to modules my
name is Mark Reynolds I work on Java one
of the things how many people saw the
session I did yesterday afternoon Oh
excellent that'll give you a head start
I don't that will definitely help so
just like yesterday this is going to be
entirely live coding I probably will
make a couple of mistakes if you spot a
mistake feel free to shout it out I
don't mind being corrected if you have
questions of clarification feel free to
shout those out too and I'll and I'll
try to answer but real you know meat
it's meaty substantive questions let's
let's just leave those to the end ok so
what I've got here just as yesterday is
a very fresh build of JDK 9 just just a
few days old what we're going to do in
this session is is take a little class
path application that uses some popular
libraries and we're going to modularize
it now those libraries themselves
haven't yet been modularized in fact
they're a little old or not the latest
version of those libraries so we'll see
that you can modularize an application
even though some of the libraries it
uses have not yet been converted to
modules then we'll do the reverse we'll
pretend that we're the maintainer z' of
those libraries we'll modularize those
and see how our little application just
sitting on its own on the class path can
make use of those now modularized
libraries in an effective way and then
finally at the end we'll have a
beautiful module graph where
everything's a module and the class path
is empty which after all is the
long-term goal all right so I've got
here a file of tweets
in JSON format of the century not
particularly readable but hey it's
better than exid nominee
so these are some tweets from my
timeline from a while back and what I
what I've written is a tiny little app
that will display these in a much more
readable format so let's take a look
we've got a main class pretty
straightforward package or got tweets um
that we're using the Jackson data
binding API so we import some classes
from that our main class is pretty
straightforward
but we we configure a Jackson object
mapper to disable some projects disable
one of its properties we read this value
in from from the standard input stream
make make ourselves a list of tweets and
then for each tweet in that list we just
run a little lambda to display it on on
the standard output stream and this this
tweet class this is the other class in
this tiny little application is
basically just a little PO Java it's a
data holder for a tweet pretty
straightforward it's using the the
sequel timestamp class just for
amusement import some jackson
annotations and then it's it's a pretty
straightforward photo it's got it's got
two properties a text which is just a
string the body of the tweet and a
timestamp property which has the jackson
annotations on it and that's the time
the tweet was posted of course there's
lots of other information in a tweet but
we're just trying to display the
essential content so we don't care about
the rest and that's fine okay so let's
compile i'm just let's just make sure
this this all works is a regular old
class path application without it
without any anything special
i've got here
in my lib directory the Jackson jar
files 266 is a bit of a stale version I
think the latest is 2.8 or something but
that's fine so let's compile Lib Jackson
annotations Lib Jackson clone and then
the lid Jackson data bind and let's see
is that oh yeah let's do this really
advanced thing here okay that should
compile everything yep let's make a mega
jar
let's see you let's just stick this in
lid
OOP
there's a dur file okay so I should now
be able to run this I'll just copy this
class path here
ad-lib tweet some and/or tweet some
named tweet stuff JSON
boom pretty display of some tweets okay
so that was pretty straightforward we
see we see that it works as it stands
right so first part let's modular eyes
the little tweet some application
without doing anything to the Jackson
jar files
we're just going to we're not going to
modify them we're just going to use them
as they as they exist so in tweet sound
we'd to make this into a module what do
we need exactly so let's make one of
those as you will recall module info
goes in the root of your package
hierarchy for the module and I need to
say well I need to give the module a
name we'll just call it tweets um even
though that's not a very good name I'll
come back to that later what are the
essential things about a module it
requires ended exports let's talk about
exports first is tweets um need to
export anything no it's an application
that's not providing an API for anybody
else to use so we don't need any exports
okay requires what do we type for
required what do we require here so we
know that tweets um uses those three
jacks and jar files so would it be nice
if we could just type this or something
like this but wait a minute these are
just jar files I'm these these are old
jar files off of central there they
don't have any module infos in them
right
meta and bunch of classes usual stuff
they're not modules
so what do we do well it turns out we
actually can type requires Jackson core
and that we can do that because of this
feature called automatic modules so
automatic modules are a migration tool
they let you take an existing jar file
you don't have to modify it you just put
it on the module path and the module
system treats it as if it were a module
it's a bit of a special module emetic
and it has access to many more things
than a regular module does but this is
essential for migrations okay so if you
haven't have some existing jar files
they're fairly well-formed they don't
have conflicting packages with packages
any of that any of that kind of messy
stuff you just put them on the module
path the model system synthesizes
declarations for them at compile-time
and run-time and the name of a module is
taken from the name of its of its jar
file using a pretty simple heuristic in
your Jackson dashboard 26.6 jar drop the
extension drop the version part convert
remaining punctuation to dots
remove redundant dockets it's very
straightforward it's not necessarily the
best name for that module long term but
I'll discuss that more later on so I can
say here in this module declaration for
tweets um even though those Jackson jars
aren't proper modules I can say requires
Jackson's Core requires Jackson data
bind and requires Jackson annotations
okay now there's another way to figure
out what tweets um needs how many people
know about the j-dub stool so gate up
stool is a a tool that we we actually
it's a tool to aid migration to aid in
the analysis of existing code it does a
static analysis of a jar file and can
tell you lots of interesting things
about its properties both as a potential
module and in terms of what other
modules it might need in order to run
this tool was it was so important that
even though
development for nine we back ported it
to eight update releases so if you have
a fairly recent build of JDK 8 then you
have the Jade ups tool it's not quite as
modern as the one that's in 9 but it's
there and you already got it you just
might not know it so ok deficit among
other things a little side note as many
people know by now one of the things
that we've done in in Java 9 is
encapsulate internal API so Jade EPS has
the ability to tell you whether you've
got a jar file that's using internal
api's ok good tweet some does not using
general API if it had then done this
with this would have printed warnings
and so forth alright but we can also
just ask it for a summary of what does
tweets um depend upon so it needs Java
dot base it needs Java dot sequel oh
right I forgot remember I use the
timestamp class so I better put that in
hires gamma dot sequel because the
sequel types are not in the base module
and then it's set here of what's this
not found stuff well but not not found
stuff is because I didn't tell it about
the class path where all the Jackson
things are let me grab a class path
give-give jaidev's a class path and then
ask it to do the same analysis see now
it now determines that tweets um is
using types in those three jackson jar
files
all right so I've got I've got a modular
eyes tweets um let's compile bad now
Java C has gotten pretty clever about
compiling models compiling modules is a
fairly different thing than compiles
compiling a bunch of files for the for
the classes directory and sticking those
in a jar file so Java C is pretty clever
now we're going to put the output in in
mods we're going to tell it the module
path is the Lib directory and let me
just remove that old tweet send a jar
file from the Lib directory for now ok
we need so the module path is it's kind
of like the class path but it's
important in some different ways it's
where the system finds modules at
compile time and at runtime one of the
essential differences from a class path
is once a module is found there classes
in that module are only loaded from that
modules jar file it doesn't do the
stupid naive thing of searching every
jar file on the class path from front to
back and taking the first class in that
package that it happens to find a big
part of reliable configuration okay so
to compile we also can give it a module
source path and that's just our source
directory until it what module we want
to compile and Java C will go off and
look at it we'll go find all those files
do time to time stamp comparison and
figure out what needs to be compiled and
there we go whoops mmm now this worked
earlier they Oh
yeah well what's my error I put them on
to Limbo in the wrong directory
okay let's compile it again tada
okay so we've got an exploded an
exploded form of the tweet some module
in the Mazda rectory we can now we can
we can do a lot lots of things let's
let's run Java P on at module in focus
to make sure it looks right there enough
yet it's pretty much what I typed
earlier good and like we can now make a
jar file we'll put this back in Lib
tweet some jar
right
was quits in there the dark chill has
also been enhanced it knows quite a bit
about modules we can for example say
describe module and it will go find the
module info if there is one and tell you
about its content okay so we've got the
the Lib directory
tweet-tweet some jar is a proper module
the Jackson jars are unchanged they will
be used as automatic modules now I
should be able to run us give the
runtime my module path that's just the
Lib directory I want to run the tweet
some module I need to tell it what what
the main class is although I could have
defined that actually but I just didn't
and let's read read the tweets a JSON
file whoops now that didn't work did it
hmm what happened so what happened here
is we've got an inaccessible object
excited exception unable to make or
delete some tweet accessible the
constructor because module tweets um
does not open or done tweets um to
module Jackson data bind what's going on
here so Jackson data bind isn't it isn't
it is a small example of a framework
that uses reflection it's when one of
these reflective frameworks now because
a big thing a big theme of this entire
effort has been providing strong
encapsulation so the module system by
default encapsulate s-- api's in in
packages they're not accessible at
runtime you need to you need to export
them where you somehow make them
available if that's what you need so
let's go back to the module info in the
proper directory what we might try is to
say that this exports
read on tweet some right just going to
work
okay well let's sign out
all right I'm going to I'm going to save
some time here by using a little shell
script that I have that combines with
the Java C in the jar steps into one
I'll drill path Lib module source source
okay goes off and compiles makes a jar
file and let's run that again what's
going to happen it still doesn't work
why doesn't it work
here we go the sane and accessible
object object exception the reason it
doesn't work is that simply exporting a
package does not make it available for
the kind of deep intrusive reflection
that many of these reflective frameworks
require that is also intentional if
you're defining an API you want you want
to be able to say okay I'm exporting
some some interfaces and some classes
for use by other modules you know it's
certainly it's fine for them to
reference them in the normal way at
compile time reference them in a normal
way at runtime but since I want to
protect my internals you know imagine
we're talking about the java dot base
module we're protecting the internals is
essential for security and integrity
deep reflection should not be allowed by
default so there's another keyword we
can use and that is called opens as was
suggested in this error message so
instead of typing exports here I'll say
that this module opens the tweet some
package one and what that means is this
package is not available at compile time
a compile time it's a it's not an API
but it is available at runtime for deep
reflection I'm the owner of this code I
know I'm using a reflector framework I
don't mind if that reflected your
framework pokes deep into the internals
of that package that's okay that's
actually my intent now it is possible if
you really need to you can you can both
open and X
or a package the actual need for that
seems to be pretty rare but you can do
that another thing an alternative we
could do is we get open the entire
module and that would make every package
be open and sometimes that's a way to
save some typing but it's no different
than saying opens of every package
that's there so we'll just do this full
opens or got tweets um will recompile it
and we'll run it and there now we have
the tweet some application it's a module
it's using the Jackson jar files as
automatic modules and it's all working
all right what's next let's make a make
a little Jerry with the J link tool so
that we can take a closer look at what's
actually going on here I've got a little
make file here's a little Jerry doesn't
have much in it but it has everything
that we need we know we needed sequel we
always need base and sequel it turns out
pulls in logging and XML just well
because XML ok so we can now rerun rerun
this with a little reduced Jerry and
yeah it works not only does it work but
there's there couple of new options in
the runtime want to show module
resolution this has changed from
previous versions we did a big cleanup
recently on on all the command line
options so if you show module resolution
then the runtime will print as it goes
essentially a progress report of what's
going on as it configures the module
system so you can see at the top it
starts with the root module is tweets um
the module that we're starting with
that's what the thing we're trying to
run tweets um requires got some data
bind have got a sequel injection
annotations the messages show you where
those modules are defined in most case
it's in a file but Java dot sequel he
has this funny URL Jay arty :
Javadoc sequel that means it's a it's a
module built into the system image using
using the internal jrt virtual file
system and then and then it builds the
rest and we're off to the races okay so
a word about automatic modules they've
been a bit controversial it's been
difficult to to find just the right way
of sort of threading our way through
through the various trade-offs if what
you have is an application and it's not
something it's not something where
you're going to be publishing it's not
something it has an API and you're not
going to be publishing it for for
external use then automatic modules are
a great tool that enable you to get
started modularizing your applications
if you've got an internal application
maybe it's actually composed of a bunch
of modules you can you can you can do
that or you can start with a big
application that isn't and decompose it
into modules it's it's perfectly fine
for those modules to use existing jar
files as automatic modules what's not
such a good idea is if you're the
maintainer of a library especially its
popular if you're the maintainer of a
library that you publish to maven
central or wherever and that and you
modularize it and make that library
depend on other jar files using their
automatic module names that's a bit
risky because I essentially when when
those windows jar files you're using as
automatic modules are eventually
modularized hopefully by their
maintainer z' they might choose a
different name
in fact hopefully they'll choose a
sensible reverse DNS module lane which
long-term is the best way to name a
module rather than the funky one that we
derived from the Arctic from from the
jar file name essentially the maven
artifact ID so so to sum up if your
modularizing code that's that's internal
to your organization using automatic
modules is fine be prepared that as
those jar files are modularized you
have to adjust your module declarations
because their names could very well
change but if you're maintaining a
library that is published for external
use upon central or wherever you publish
it be very wary of publishing a module
that depends on automatic modules
because you're essentially putting users
of your module at risk of things
breaking later on and not the way for
you to update yours okay so we've mod
flairies tweets um let's go the other
way around well that's interesting the
time left says it's still 50 minutes
when I'm flying blind here okay no
worries I'm going to clean things up
here I'm going to move forward and we're
now in a different world
so here's tears tweets um I'm going to
compile this the same same way that I
that I did before it's going to be a
plain ol jar file no mado time left 27
minutes thank you okay I'm going to
compile this in the normal way and I'm
going to cheat and just say web slash
star
okay so I've got tweets um jar and
there's no module info in there it's
it's a plain old jar file now let's
pretend that we are the maintainer of
the Jackson JSON libraries as it happens
I have source code for those three jar
files that we've been using here and
they they're they're not modules yet but
we can look inside and see ya comm
faster XML Jackson core a bunch of
classes you know all those other stuff
met in services whatever so so that's
all there how do we go about making a
module declaration for the Jackson core
artifact the jackson core project well
we can run jaidev's that'll give us some
idea right this will tell us about the
requires just as it told us about the
requires we would need we would need for
for tweets on itself we can we conceal
this information so that really helps us
with the requires but not with the
exports what do we do about that well we
could do something kind of crude we
could look at say the directory
structure of that and say okay well yeah
they're going to be packages
corresponding to to all these things but
that would be well kind of tedious so J
depths to the rescue again
Jade EPS has yet another option whereby
we can ask it to generate module in
Python Java files j-dub generates module
info and I'm going to type the stool is
going to write write code into my source
tree always a little dangerous so be
careful that you actually want to do
that Lib Jackson core and now I've got a
module info let's pop back into Emacs
here
there's the module info generated by
Jepsen well actually that looks pretty
good it exports the packages exports all
the packages by default there's a new
thing here and that is that there's this
provides clause so
side note the module system knows about
services if you're familiar with Java
util service loader that's been around
for a long time it's a it's a
straightforward service provider
facility that's been in the platform
we've upgraded that so it's it's
integrated with the module system the
module system understands services the
module system needs to understand
services because if you have a service
provider it might require some
additional modules and so if it's all
part of the whole the whole resolution
and configuration process and so what
this statement is saying is that the
Jackson core module provides this
Jackson this Jason factory service and
it figured that out by reading the meta
and slash services directory okay end of
side note all right let's compile the
jackson core module now that we have it
i'm going to put these these new modules
in a different directory called
em lib
and there we go jar described and that's
exactly what we expect so let's let's go
on and do the Jackson annotations and
data bind jar files and what I'll do is
I'll just run a EPS on everything here
so it's going to generate three module
infos now when you when you use Jade
apps to do this it's always a good idea
to go look at what it created because
what it created might not make any sense
or it could perhaps be improved so
here's the data bind model it's quite
quite a large module let's let's take a
look for first of the exports are there
any exports here that look like they
don't belong or maybe a bad idea to
export hmm you till now maybe it but
that it will not be not being expert in
the internals of this of this project
I'm not not sure but there are
definitely these implies sitting around
and you kind of suspect well if a
package is named dimple and yeah don't
export it so let's not do that okay so
we won't export those or look there's
another service provider and then back
at the top this is this is worth noting
these are requires directives but
they're a special kind of requires
directive as Erik they're called
requires transitive what does this mean
well it's essentially establishing a
one-step transitive transitive shortcut
so the Jackson data bind module exports
all of these packages those packages
include classes and interfaces whose
signatures refer to types in the Jackson
annotations module the Jackson core
module that got a sequel module in the
java xml module so some other modules
say tweet some that's using the jackson
data binds module it it doesn't need to
say that it also requires jackson
annotations
courses and Java Seagal in XML because
that's given to it by these requires
transitive direct directives and an
informal sense you can think of it
requires transitive as saying not only
this this module require that one but
this module re-exports the API of that
one to any modules that use this module
so it technically it's not really react
sports what it what it really is is it's
saying that the user module also
requires the that module but react sport
is is a good informal way to think about
it okay so that's the data bind module
right
okay so let's compile data bind well
annotations first and then we'll compile
data bind
that's kind of a big module takes a
little bit and now we've got our three
Jackson modules in the end Lib directory
okay I already took
let me move tweets um out of out of that
regulars of Lib directory and just put
it here so we're sure we're not using
the original versions of Jackson or
anything anything weird like that okay
let's try to run this now Java module
path M Lib CP classes because that's
where well actions CP tweed summed up
jar or got tweets um main from tweets up
Jason hmm Oh what happened no class
death found error comp ass for XML
Jackson core blah blah blah is not there
well what happened is the Jackson
modules there on the module path but
they weren't loaded they weren't
resolved the reason they weren't
resolved is tweets and AH jars just just
a regular old jar file there's no module
stuff going on here there's no way for
the runtime system to figure out the
tweets an actually needs those so I
actually have to tell it with another
option add modules Jackson core Jackson
data bind Jackson annotations and now it
works so we had to do a little bit of
manual configuration because tweets um
is just sitting there off in the
classpath as an optimization if your if
you remembered this since Jackson data
bind requires Jackson core injects and
annotations we can actually get away
with something shorter here we are
actually only need to mention Jackson
data vine so not not quite as much
typing is required so you might be
wondering how does the class path relate
to modules well in in the model system
the way we've we've set things up every
class every type is actually in a module
but there is a special module called the
unnamed module just as we have had
basically from the beginning of time
there's a notion of the unnamed package
in Java if you just type you know foo
Java and it's not in any package you can
write you can write that you can compile
you can run integrate it it's in
technically incorrect to say it's not in
any package it actually is in a package
it's called the unnamed package and if
you read the fine print and the Java
language specification the java vm spec
you'll see how this is how this is all
worked out so we've done a similar trick
here in the module system code in the
classpath is load into into the unnamed
module it's a module that has no name
the unnamed module reads it infected
requires every other module that was
already resolved and so that's how we
that's what we make sense of things it
also of course exports everything
because well that's exactly what the
class patent does so did I make it
yellow let's make that little diagnostic
Jerry again
and we can run run it on that little JRE
and let's do the show modules as we go
and you can see here that it's doing
pretty much what we expect that the add
modules option on the command line
specified additional routes for
resolution but it configured the Jackson
they Devine modules configure the rest
and then and then off we win okay so
that's modularizing the libraries
without modularizing the application
just to finish up let's go back and make
tweets um into a proper module again
requires exome data blind
that look right I think that's right
okay to compile that
module path and live tweet some tweets
time JSON good and here's the diagnostic
we start with tweets um we see tweets um
requires some things and we configure
Jackson data vines and the rest of it
and we're done we have a nice simple
module graph the class path is empty
everything is running as a module so to
sum up migrating to modules does take
some work it's possible to do it without
waiting for all the libraries that you
use to migrate to modules and that's
okay this is a sent in a way this is a
trick that we borrowed from generics if
remember remember when generics were
introduced in Java 5 way back when we
left the notion of raw types in and we
did not put in reified types which is it
remains a controversial decision but the
reason for that was exactly to allow you
to genera fie your own code without
waiting for all the libraries did you
use to be genera fide and that's worked
out pretty well although there's still a
distressing amount of code out there
that has not yet been genera fide but
there it is so this is a trick that's
come to be called migration
compatibility and automatic modules are
way to get migration compatibility as
hopefully everyone moves over time
towards towards modules something that's
something to say about that it's it's
not a I certainly don't expect every
active body of code out there to migrate
to modules migrating an existing large
body of code to modules can be extremely
costly and painful I mean it took us
what eight years to modularize the JDK
so my recommendation for an existing
system is think carefully before you
start down the path of modular ization
you know the OSGi folks are completely
right about this modularizing an
existing code base can be a ton of work
and frankly it might not be worth it but
if you're starting a new project from
scratch then definitely consider using
modules from the start okay
so further information jigsaw is has
been remain remains a fairly big project
it's covered by six separate JDK
enhancement proposals in the open JDK
community plus jazz are 376 for the
module system itself and that's in the
Java community process so this is part
of JDK 9 it's it's there it's been in
there for quite a while you can get you
can get the latest JDK 9 early access
build that at JDK Java net / 9 that's a
new URL the old one redirects here but
that's up that's a new URL we've moved
it because the rest of java.net is going
away so it's there when will this be
released mmm I don't know with with the
the drama earlier this week
I think the current schedule which has a
ga date of July 27 is probably a bit
unrealistic but I'm hopeful that we can
ship within a small number of months
after that all right we've got 12
minutes for questions I work for Oracle
don't believe a word I've said are there
are the microphones there and Mike
go back to the info page
when you took Java core and made it a
module and we compared the modular class
that you created by hand and then what
was put into the module itself I thought
I saw it had a requires java-based
mandated I saw that however you remember
the exact Oh in in the you saw the word
mandated probably in the describe module
output yam right requires Java mandated
right so so that's that's a good
question Allah allow me to explain just
the the described module option 2 the
jar command and similar things such as
when you run it you run Java P they they
show you more than you can express in
source code because they're they're more
they're more bits in a class file then
then then then right strictly needed to
express what's in the source code one of
the bits in a class file is whether for
requires directive that was mandated by
the Java language specification so it's
it's a it's a it's it's kind of it's
it's in some ways of more theoretical
use than practical use but it tells it
can tell a tool for example that this
requires directive was inserted by Java
C because it's mandated by the spec
rather than rather than something that
was actually expressed in the code if I
had typed requires Java dot base myself
that mandated wouldn't be there so it's
it's a subtle distinction but it's abuse
to some kinds of tools
put in the front
and in this sample I saw that you opened
they put some mod module but this is a
simple case right so you have they put
some application module and it's really
simple but what happens if you have
something some properties in there like
a automatic decimal or a class from
another module of our class from another
package that another library that is not
with modularized how do you how do you
manage that sorry let me make sure I
understand the question because oh wait
wait what if tweetIn had been using even
more complicated types from some other
module because Jackson now is just
trying to get the properties from the
twits for each class Brian that's easy
right and you're hoping that to be able
to access but what happens if you have
more and properties in that class that
are not open okay so so what if there
are additional Kojo properties in the
tweet class that use types that are in
that are defined in the tweets and
module but not open another module or in
another module another not oh yeah it
actually doesn't matter where they are
then well it'll it'll depend on exactly
how how the Jackson data bind framework
how deeply it needs to go it may be that
it only needs to do reflection on on the
tweet objective objects themselves right
and and if and if the value of one of
those properties is you know some other
type somewhere else as long as it's
exported and Jackson can use its public
API and that'll be fine but if Jackson
for some reason has to begin then that
that other type this thing is for this
value will also have to be in a package
that's open for reflection but usually
in this in these reflective framework
committed they don't tend to follow
object graphs in that way
so they'll manipulate what you tell them
to manipulate and everything else they
just treat as a fake types
so my question is about the early
runtime failures I guess that we've
introduced so the runtime now catches
some class of errors placed on package
names in modules and so on
yes right so if the library I use
evolves its API in a braking way by
renaming a package that will be called
early on at runtime hmm if a library the
library is evolved and it renames a
package that in general that will be
fine but if that package now conflicts
with something else then that could be a
problem in the runtime will detect it
I guess my real question was if if the
packages are still as they used to be
but the classes gets renamed is it
detected early on or does it fail at the
very last moment like you stated you can
rename classes little work fine you
might get a new class that founder later
on if you if you've got code here code
that you didn't recompile like you
didn't edit recompile that's referring
to that but that's just the usual thing
the analysis done by the runtime the
yupo sorry the additional analysis that
does now is limited to the module graph
and the package structure of each module
it does not look more any more deeply
than that it doesn't go and look at
types and say that oh well this this
class is now referring to something that
doesn't exist that's detected in the in
the same old way no class def to founder
when the code gets there that's not
detected up front
thank you
my question is about versions very
meaning of the modules
what about sorry versioning so a virtual
different versions of one module how
colors is countably I didn't see any in
the module in for any mentioning about
version is there any concept of that or
not the number one frequently asked
question there there are not versions in
this module system this all has also
been in some quarters a controversial
design decision there are not versions
in this model system it does not attempt
to solve the the multiple versions
problem whatever that means it has
several different meanings because if it
did then you probably wouldn't like the
result and there are two main reasons
why you probably wouldn't like the
result
one is that the behavior of many
existing api's that have anything to do
with class voters even indirectly will
change in incompatible ways so it makes
the process of moving to modules more
difficult perhaps bigger reason you
might not like the result is that all of
the popular build tools have no idea
what it means to solve the multiple
version problem you look at maven Gradle
all of these tools they go out of their
way to detect conflicts and point them
out and this is why conflict resolution
can be such a pain in the butt during
development but it's something you have
to do because ultimately on you know on
the class path today you version have
two versions of the same thing are
almost always a recipe for disaster now
long term yeah it would be great to
solve the multiple version problem it
would be great to have some way of you
know but module a means version 1 of
module B and module C needs version 2 of
module B and as long as we can guarantee
that the types from those two versions
of B will never intersect and meet
because that would like you know caused
an implosion then then we could support
that we have the plumbing for all of
that now you know it is it is something
that we could do with not an enormous
effort but a but not a trivial one
either in the future release but doing
it now would lead to
a less than satisfactory experience
because the tools don't support it and
it will take it'll take a while it would
take take a while for them to do so it's
been you know it's it's taken long
enough to get the tools you know just to
support what we've done so far you know
if we if we decided to solve the
multiple version problem
we could do that it would take another
you know months year I'm not sure how
long for the tools to catch up so what
we've got is a good foundation I think
it's best to get this out now what
people start modularizing and we'll take
a deep look at the multiple version
problem for future release which as I
said yesterday might be sooner than you
think but what they've one module like
generally acquired like available module
Megan reporter or something has changed
API between versions and one dependent
module is using one version the other
ones using the other version which one
will be used as what I'm saying that the
comment all right right right right
right now you right now you're just
stuff that you just have to pick one
you know you what you what you do today
to resolve conflicts in maven or Gradle
or ivory or whatever tool you're using
you can you can you'll continue to do
that right you know the mob the mob the
semantics of the module path are the
module system starts at the front it
looks in each directory for a module of
the name that it's looking for it takes
the first one that it's find and then
from that point point that point on
that's the definition of the module of
that name in there it never looks again
okay okay two minutes one last question
I'm imagining I'm working in a spring or
Java environment and would I then
usually open my application for
reflection completely because it's so
common like for hibernate for spring
whatever oh yeah
so it opening your whole application
completely sure you could do that for a
start but but in general if you're using
you know spring hibernate any of any of
these reflective frameworks it's it's
it's best to think a little bit as your
modular eyes well which of your packages
are actually going to beam that be
manipulated by spring or hibernate or
whatever and and just open those I mean
if you want to you can just make make
your whole module open and and and
that'll work but as a as a general point
of hygiene opening just the packages
that need to be opened is a better
practice but as a library developer I
will not know if my library might be
used in the reflective frame bug as art
so that that's it that's a good question
it turns out there's there's a there's a
small and subtle feature that will that
will actually enable that for reflector
frameworks even though your thing is not
open and I don't have time to explain
its details right now so I think you
yeah it's the I believe we have that
case covered okay times up thank you
very much I will be on hanging around
the rest of the day sometimes at the
Oracle booth sometimes in sessions so if
you have further questions feel free to
to grabbing all right thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>