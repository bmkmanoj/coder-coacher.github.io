<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Apache OpenWhisk by Animesh Singh and John Zaccone | Coder Coacher - Coaching Coders</title><meta content="Apache OpenWhisk by Animesh Singh and John Zaccone - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Apache OpenWhisk by Animesh Singh and John Zaccone</b></h2><h5 class="post__date">2017-04-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/phsSvI7JB48" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">okay so get started um so thanks for
joining my name is Anna Mae Shing I'm
part of IBM cloud group leading a lot of
initiatives within cloud around our
platform as a service offerings
container offerings as well as our
service offerings which is going to be
the focus here speaking with me will
also be John J cone with the docker
captain as well as an IBM cloud engineer
and he has been working very closely
with us Ovilus technology open risk
which is by now part of the Apache
foundation so with that just a brief
background of what we are going to talk
essentially if you see the cloud
computing evolution started from bare
metal towards I as paas except raw but
there were some problems even if you
take a pause and you take a moral ethics
application you break it into different
micro services you still have to worry
about to keep you know our different
copies and different data centers
worried about scalability how do you
protect against regional outages also
the programming and the cost model that
also doesn't help there are a lot of
applications where you need to have
continuous polling they are running all
the time even they are not being
accessed you are being charged for
resources as a provider even when your
application is sitting idle and doing
nothing
so with that enter server lists which is
essentially a platform where you can
have even driven micro services
applications it can run on a pause it
can run on a container Orchestrator or
it can run on an iOS platform so what is
server lists it's essentially a cloud
native platform for short running
applications stateless applications
event-driven it scales up and down
instantly so from a provider perspective
you don't need to worry about doing all
the plumbing regarding scaling except
raw and last but not the least the
biggest driver is the business model
which is essentially as a provider you
are being charged actually just for the
milliseconds when this
negation is being used with that
definitely it cannot be good for
everything there are certain things
which it definitely lends itself very
nicely on organically for example if
you're building micro services mobile
backends when there is a lot of
notification going on BOTS IOT IOT in
fact is one of the biggest use cases for
server less you can imagine when we have
these billions and trillions of devices
which are being projected connecting to
your application having an application
which can take that kind of load
serverless lends itself directly a lot
of the traditional databases or if you
are doing for example deep learning
training acceptor or long-running
processes that's not a good fit for
server list platform so now that we have
talked about server lists let me
introduce open risk which is a platform
for the server list event-driven
programming model so what it is it's an
offering on IBM bluemix you can actually
go and try it out it's also an apache
open source project the github URL here
takes you there there it's being
developed out in the community with the
open source model under the Apache
foundation and as I was describing it's
another way to build your applications
so most of us in the cloud computing
world we are now familiar with building
applications leveraging a past platform
like cloud foundry or VMs for example
you know those coming from OpenStack
containers you can think of it's another
way to build your applications in the
model of functions as a service it's a
distributed computer which executes
application logic in response to events
as you can see within this diagram there
are triggers which are happening which
in then invoke different actions that's
essentially the model which is driving
open risk and server less platform so
how does it work if there is an incoming
HTTP request based on that there are
certain actions which are executed from
the open web platform now these actions
can be in different languages very soon
we are all
launching API gateway which is going to
sit in front of open risk which
essentially gives you an ability to
actually craft full rest based
applications with put pause delete
accept plus it also provides you
security mediation if you want to
control how many requests are coming at
a particular point of time this API
gateway will help you with that
particular need and the programming
model essentially the three things to
remember
triggers actions and rules triggers is a
class of events that can happen either
on for example a credit data credit
operation on a database or commit in a
github repository your location changed
anything which can emit notifications
and events that acts as a trigger and
then there are actions which are
executed in response to those triggers
or events now actions in open risk have
multi runtime support so you can have an
action and note in Swift or in any other
language which you want to using docker
containers support so we talked about
triggers we talked about actions of what
is the rule a rule actually binds a
trigger to an action so that essentially
tells up invest platform if there is a
trigger of a particular type what action
to execute actions actually can be
chained together in a sequence so for
example based on one trigger you don't
only want to execute one particular
action since these are very small or
composite units of code you may want to
execute tens hundreds thousands of
actions in a sequence that can that is
allowed using open vests programming
model and packages it's essentially a
collection of your triggers action and
rules IBM provides a lot of packages
around the watson services Cloudant
which is our document base data store
the weather company packages there are
lot there which you can browse in the
catalog plus a lot of packages from the
open-source community which is
essentially you know messages coming on
Kafka which john is going to talk about
git repository actions etcetera very
briefly a bit of the backend
architecture
if you look at the openness back in
architecture Mike it's essentially micro
services which are deployed in docker
containers you have a master slave
architecture and then you have an edge
VM master essentially is controller
console Kafka at a very primary level
and then we have slave meals where
actual in actions are getting in invoke
so they are called invoker VMs and then
every data we are storing it in CouchDB
for the open source side of things oh
why did we decide to go with docker or
definitely I mean as you as we all are
aware it's a platform being used a lot
for micro services based frameworks it
provides isolation which is a need when
you have multiple actions being executed
on the same horse you definitely want
isolation for your code and it provides
portability so you can actually have
daughter files and then you can once you
have your actions model using docker
files you can actually move it across
easily across different open abyss
platforms so how it all works so
essentially from the CLI if you are
doing an action invocation for example
you are invoking a hello world action it
does a post to this rest api and behind
the scenes it first enters nginx which
is our entry point nginx is essentially
just forwarding it to controller and
controller is the one which then reached
out to CouchDB to know whether you are
authenticated authorized what parameters
does your action need or all the
parameters there if not what are the
default parameters I need to pull from
CouchDB once controller does that then
it reaches out to console which actually
acts as a service discovery component so
console has a database of all the
invoker's which are available so it
tells a controller that your request for
this action execution can be handled by
this particular invoker and then Kafka
acts as a message bus once controller
knows that this is the action to be
executed these are the parameters this
is a mocker i need to reach out it posts
a message on the Kafka and the invoker
to which the action is assigned it
actually picks up that message and goes
ahead and execute that action
any results of the execution they are
actually getting stored in couchdb back
on bluemix essentially instead of
CouchDB we use cloud n which is our
hosted service for persistence and apart
from the core open source infrastructure
we definitely have logging using elq
monitoring our own plumbing around that
how is docker being used another covers
essentially a risk action invoke command
from a CLI translates to docker run at
the very end on the invoker
so essentially docker run is used to
start a common container you have in it
which is essentially initializing that
container and finally run right now
within that there is a concept of cold
container which is starting from the
very beginning then we have pre-warmed
containers which are essentially
containers which are running and where a
code can be injected on the fly and then
last but not the least warm containers
so if you are accessing open risk very
frequently open risk actually keeps a
pool of your action containers so that
you're getting a response time which is
much better than if you are starting
from a cold container model so a lot of
folks actually prefer if you see there
are a lot of open source projects out
there which are kind of making the
server less model they are trying to
follow this warm container model where
they have containers running all the
time to serve requests in our opinion
that's not true server less as a
provider you are still paying for the
infrastructure cost so for you to
benefit of and have some business model
around it you need to be following this
cold container model where actions are
getting executed on a request and the
containers are getting spawned right
from the initialization phase so this
actually talks about what our requests
translate to what essentially if you see
within the middle apart from the cold
continued and the more
container this is this model of
stem-cell containers so these are
essentially docker containers which are
just running without any code in it and
your cord is injected on the fly to
execute to be executed on that model so
with that let me talk about multi-cloud
open risk which is essentially our
effort which we have been doing in IBM
as well as in partnership with for
example adobe stack point acceptor where
we are taking the open source opens open
less code and make it available to run
on different platforms or when the open
source version came out last year it was
a single machine deployment working with
our partners etc and as part of the
Apache foundation we actually made sure
we can make a distributed deployment of
open risk on top of OpenStack that was a
first target we actually took it further
you can now run open risk on AWS and now
our initiative at this particular point
in time is actually to take this and be
able to run it on top of queue manatees
so if any of the folks here if you are
interested in investigating contributing
and working or definitely this is there
is an Apache proposal the link is there
right now we are partnering with stack
point and we are going to be working on
it together in terms of taking open risk
and running it on Kuban at ease that's
the model we are going to follow and
with a huge traction around humanity's
and there is a lot of risk demand in the
community where a lot of communities
folks actually want a bonafide true
serverless platform and and we are
seeing a lot of requests to get open
based on top of k8 and before I show you
the open risk on the bluemix side
essentially just to summarize it's
another way to build your applications
stateless event-driven applications and
apart from all the other options which
bluemix provide which is docker based
applications or kubernetes cluster based
container based applications open risk
is one of the ways so if you're writing
applications which are being driven by
events which are not accessed so
frequently or which have more stateless
computation which are not long-running
task open this is the right
framework to handle that so with that
let me show you
bluemix and some simple examples just to
get the concepts going here and then
john will come and walk you through ten
minute deep dive into one of the message
help examples of is the team has been
building here so this is essentially
your bluemix UI you can actually hit
bluemix.net if you have not registered I
will strongly encouraged to register
it's becoming very very popular among
the developer communities there are a
lot of services around not only at the
infrastructure level for example compute
storage network but as you start diving
into building applications there are
cloud for new applications which you can
build on top of it containers and within
continuous as I was mentioning apart
from the traditional docker support
using docker compose etc we also have
launched just a couple of days ago
kubernetes cluster based container
service so that's something you can
leverage if you are into that and
definitely open wisk which is or focus
for this discussion so with open risk
you can actually either go ahead use the
UI to develop it or you can download the
open list CLI so in this case if I go to
their browser there's some of the things
which I can do for example I talked
about triggers actions and rules so
let's start first in terms of creating
an action a very simple action you can
create if you want to use a template for
example if you we are creating a node
application here node action and I can
call it hello world node essentially if
you see some of the coders their memory
coder what is your time limit after
which this action should timeout I go
ahead and create that so in this case if
you see the function is pretty simple
it's saying that you sent me this I'll
just replace it with a particular
message which I will use later to show
how we can use synchronous
wincing within this but essentially it
is returning a message saying that a
note sample calling from within so
within what let me show you later so
then you click on make it live now this
action is live I can actually run this
action from here and it expects a value
so the argument which we were passing
was message so that I can make it
it better
oh yeah so as you see this essentially
just triggered this action and we got a
message from this now create one more
since Robert is going to talk about so
if later you also want as we talked
about there is a support for different
languages and I will use this to so show
some of the concepts around sequencing
chaining acceptor so in this case we are
going to create a swift based action you
can start with a blank slate or in my
case I am starting with a hello world
soft example so this is essentially
created a soft action for me oh let me
replace it with a shorter blur which I
have written the default function I'm
replacing it in this case with this and
then you make it live if you end up
changing the function so now we have two
functions or two actions as we call it
one thing which you can do we talked
about sequencing you can actually
sequence multiple actions together for
example if I take this hello world node
and I click this button link into a
sequence what it will tell me is that
okay what is the next action in sequence
you want from this so in this case
instead of using one of the packages
which is provided by default which gives
you a lot of complex capability used to
execute Watson API is how an API is
except as part of events I will use for
example I am saying that use this Swift
and add it to the sequence so now you
see what it has done is that it has
added these two in a sequence so I will
say okay this looks good so my next step
would be what I want to do is automate
this right to automate this if you see
there is a trigger which I had created
using the CLI the point here is the see
the trigger creation right now works
with the seal ISO this trigger is
essentially saying every 10 seconds fire
this trigger for 10 times that's what
pretty much it is it's a cron job so
every 10 seconds you need to fire this
for 10 times no so now what I will do is
essentially just saving this action
sequence
I am going to click automate this action
automate this based on a trigger and the
trigger I am going to use is okay let me
automate this on periodic so for some
reason it's not showing my trigger in
this
yeah it should have detected this
particular trigger in this which is
created let me try to delete and
recreate it
okay i recreated it let me refresh and
see if it sure know if i want to take
the sequence try to automate it let me
see if it shows it mine okay it's not
showing at this particular point of time
but the idea was I mean there might be
some that you know we can create a rule
based on this trigger which can actually
fire or the action sequence but if I
just run the sequence without a trigger
in this case pause that message
so it's not going to call both of these
in in a sequence so what happened was
you know the message was divorce so in
this case you get a nested response
essentially it's saying that you know at
first called the node and then the node
action response was then passed on to
the safe action which it then printed
out this
so essentially you get a nested response
from Swift which is the output of node
so that's essentially what I wanted to
show with this with respect to what you
can do from a UI perspective as I also
mentioned there is a CLI which I was
just using which is for the most part of
full functional CLI or UI is is
following the CI CLI and most of the
work being done on the open west side is
using the CLI so john is going to come
and talk about how you can actually use
the CLI to build a message of example or
giving a full-fledged trigger action and
rule scenario that john
oh alright hello hello hello
well just trying to use this this
microphone out so we got a good overview
on open whisk and I'm gonna demo how to
create a REST API using the open whisk
platform so this is the architecture and
all these green bubbles these are our
open whisk actions yeah of course
so we have four open whisk actions here
for each of our HTTP methods post get
put and delete and Tsar the actions
these are are our functions in our
server list function architecture and
then we have API gateway mappings so the
API gateway that's going to provide us
with throttling security stuff like that
and then in the back game we have just a
my sequel database to persist it so and
our API today is cats so the first thing
I'm gonna show you is the code for this
cat post action you can create open wisk
actions using a number of different
languages including docker for language
agnostic but today I chose JavaScript so
here's my function I wouldn't worry too
much if you can't read it but
essentially it takes some parameters for
a cat name and color and it inserts that
into our my sequel database there's
nothing really special here this is just
a JavaScript function we have a two sets
of parameters so the first set is the my
sequel connectivity information we're
gonna set these to default when we
create the action so that we don't have
to pass them in every time we invoke our
action and then the second set of
parameters is name and color so this
corresponds to the cat that we're trying
to add to our my sequel database and
we're gonna passing this parameters
every single time so you might notice we
have a bicycle dependency here so to
create an whisk actions with JavaScript
you can either include the entire
JavaScript source when you create the
action or you can use a node or MPN to
basically package using like a package
JSON so that's what we're gonna do for
our dependency here can you guys see
that should I make it bigger alright so
the first step give me I'm doing this
with one hand is to install our local
dependencies and then we're gonna create
an archive
with this is gonna this contains our
node modules directory and our
JavaScript function that actually there
that open whisk needs to to run
correctly so now that we have so we have
our action that's up here this is the
archive for that we're gonna use to
create an open whisk action
so like Animesh mentioned I'm using all
the whisk command-line interface to
create to interact with our open West
platform so I'm gonna create an action
we're gonna call our action cat post and
it's a it's a type of node Jess and I'm
referencing that the archive file that I
just created
so don't these bash variables I have
preset my terminal but essentially I
have a my sequel database instance set
up already and I'm setting these
parameters when I create the action
which allows these to basically be
defaulted version 6 yeah so you can you
can specify your parameters when you
create the action this this will
basically set these parameters every
time your action is invoked when you
invoke your action you have the option
of overriding these parameters in
addition to adding on new parameters so
we're going to add on new parameters for
the name and the color of the cat so
create our action so our action is our
stateless function we can invoke it
directly using the CLI or on the browser
like animus showed us but we're gonna
I'm gonna create an API gateway mapping
to to map that
so this is a it's kind of experimental
right now it's the idea is that we want
to get developers hands on this thing
and I can get some feedback for this
feature so now that we have our so now
that we have our gateway mapping we can
actually invoke this thing using an HTTP
request so it gives us the URL which is
pretty handy here so we're gonna do a
we're gonna use curl this on a post
request and we're going to add Larry the
green cap to the to the database
all right so looks like it was
successful so we have three other HTTP
methods get put and delete but for the
sake of time I'm going to run a script
to do all that stuff for me so but this
is this is essentially doing the same
thing that we just did manually it's
going to create an archive using that
NPM install we're gonna create it it's
creates a Evan whisk action and then it
creates an API gateway in front of that
and now my eye decides the suck there we
go
okay so now we can test our other HTTP
endpoints so we created a cat with 232
as the ID so we can update that cat so
we had Larry the green cat and now we're
going to update him to bury the blue cat
is the URL here okay we can verify that
by just doing an HTTP GET request which
we also specified ID equals 232 alright
so Barry the blue cat came back so so in
terms of the parameters you can you can
pass in the parameters for a post input
requests are going to pass them in the
body as a JSON string as you can see
here and then and then obviously forget
and delete you're not going to have a
body
pearl HTTP protocol so you can also use
query string parameters so for the get
function for example here takes than ID
looks up the my sequel database by Adi
and then returns that in the response so
that the API gateway mappings
automatically forward the parameters to
the open wisk actions and that's also
true for sequences that animist showed
that the parameters are passed between
different actions all right so the only
one we haven't seen yet is delete and
then you can do get again and then our
cat is so so that's it
so we used open Wisc actions so we get a
lot you know we get all the benefits of
the serverless
technologies scales up on demand we're
not paying paying money for for idling
time
and then we use the API gateway mappings
which is which allows us to handle those
cross-cutting concerns like security and
throttling and administering API keys
and such so that's all I have Robert is
going to come up here and talk about
server-side Swift
okay so I'm Robert from IBM I work at
any Austin office I've been working okay
great
I've been working on server-side Swift
for a little over a year now so we're
gonna switch gears a little bit so this
is Swift on the server instead of Swift
off the server I'm gonna try to make the
talk without having a coughing fit so
the Swift programming language if you
don't know about it is a compiled side
language it uses the LLVM back-end in
order to produce the the code for that
has strong and static typing system it
has some powerful structures such as
enumerations are pretty smart that they
can have associated values with them so
they're kind of like algebraic data
types
you see optionals in the language so
things can't so variables can have a
special type which is a optional so they
can either have a value inside of them
or have a nil value and their language
side ways of getting at the value in
that case here you see functions as
first-class citizens so you see a lot of
usage of closures in order to handle
passing around functions also hand in
hand with that you see asynchronous
programming style that you see in
JavaScript where oftentimes asynchronous
operations such as IO
you'll get a callback which you can then
handle inside of the closure this
language also has automatic reference
counting so there is no garbage
collector like you see in other
languages so no mark-and-sweep
so there's a reference counting system
kind of like C++ where that is handled
so because there isn't a garbage
collector per se there are some pitfalls
that developers of Swift fall into
especially if you compare combined AARC
with closures that there seems to be
some problems with memory leaks if that
happens so the Swift programmer has to
be very mindful when
use the language about things like
references so the language has a lot of
features so it's it's almost
overwhelming with all the features that
the language has and it depends on what
what culture you come from whether Java
or JavaScript of your usage of these
features so it's really interesting that
this this language was created to
replace Objective C it was created by
Apple by Chris Latner and the the idea
is that
Objective C was just really hard to work
with and it had a high learning curve a
required a lot of boilerplate code just
to produce very simple applications so
this with programming language was
released at WWDC in 2014 but then just
about over a year ago they decided to
open source it and now that the language
has been open-source
it doesn't just run on Apple hardware
anymore it's not just for darwin systems
it is for linux systems
I can run Swift on my Raspberry Pi now I
can run it on my Z mainframe so it's
it's really cool so you've probably been
following some of these like the most
popular programming languages out there
most recent rating according to a red
monk is that it's number 11 and you know
it take take some of these ratings with
a grain of salt
but we certainly know that Swift is
growing in popularity and a vast number
of people are moving there objective-c
applications over to Swift and we're
starting to see some companies actually
embracing it for applications that
aren't iOS so that's that's exciting to
see so so why switch on the server
that's what I want to talk about today
if you just look at Swift with
comparison to other programming
languages so these are just micro
benchmarks we see that it's very
performant this is just a micro
benchmark that computes the spectral
norm so it's very numerical in basis
this is not server-side yet but we see
Swift actually outperforming the Java
JVM
and no js' and for memory usage we see
similar trends that swift outperforms
Java and that's because Java has a
garbage collector it outperforms nodejs
as well so Smith may be ideal for the
cloud and if we compare the performance
of various different web frameworks of
keturah which is a particular web
framework that we've created that uses
Swift we see a very very performant
behavior here cateura outperforms
expressed j/s in our latest tests and if
you just look at the low level
networking calls Kotori now outperforms
nodejs
perhaps returning HelloWorld is not
really that interesting if you look at
the tech and power Jason performance
comparisons cateura
does not yet perform as fast as Express
Jas but Express yes is JavaScript so you
would think that they would be good at
Jason parsing of course but we're seeing
rapid growth in our our performance for
thorough put and thousands of requests
per second just in the past month for
this jason benchmark so we we expect to
hopefully get comparable performance to
node very soon so performance is not the
whole picture for why you should choose
a language for server-side development
it's really about developers and and and
picking a language that makes developers
happy and really wanting to program and
what we're really interested in is in
full stack development using a single
language for your front end and your
back end and we saw this happen with
nodejs when that came along that front
end developers who were writing
javascript for the browser could now
like cross into the backend and write
apps on the
in JavaScript on the backend well
similarly iOS developers can now write
their apps on on the backend as well
so there's a lot of integers you can
share the code across teams teams can
share code such as data models functions
different protocols you can compile the
application as a single project but it
produce different targets and with
compile side guarantees you know that
it's all going to work together properly
so that's that's really exciting i io s
developers can use pretty mature
libraries that they like to use but now
in the backend context so these
libraries were are sort of the go-to s
for iOS development such as networking
libraries and libraries to add reactive
or promises to your application or
parsing for Jason simplifying Matt you
can use these libraries also on the
backend as well not in these libraries
don't need to change their code at all
to run on Linux
there is no npm or like maven of the
swift world right now so there's no
central repository that people can
publish their their projects but at IBM
we produce something that comes really
close
we got packaged catalog calm I can't
believe that the O main name wasn't
taken already but that is a way for
searching for Swift packages and we
instead of make people submit these
packages we actually created crawlers
that crawl the internet to find
libraries that are written in Swift and
we post it up on this this site and you
can just click on that button to add the
dependency to your project or the little
snippet you need to add to add it to
your project
there are four major server-side Swift
frameworks out there a cateura is the
one that I helped create and that's the
one IBM that we're we're we're really
working on quite a bit but all of these
four are
very similar they were inspired by those
microframeworks that you see like like
flask or Sinatra or Express Jas those
kind of frameworks if you have
experience with those you could probably
grab any one of those and be able to get
a create an app really quickly what we
noticed though across all of these four
different frameworks there's like
there's an HTTP server that's created in
each one of them and so many other
languages like node and rust and go you
don't need to like write your own HTTP
server that's given to you in the common
library so one of the big things that
we're working on now is creating a swift
working group that we can build out sort
of the common library that you can get a
common HTTP server or get a common
encryption algorithms all of those basic
things that you don't have to be
terribly novel when you create it we can
give it to you in the server side Swift
like foundational libraries so I want to
give a quick example now of doing
cateura programming so here I'm going to
create a new directory I'll call it dev
ox and because I create so many Couture
applications all the time I create a
yeoman generator I created a German
generate or create new projects quickly
so let's dude devoxx example wait sorry
Yoga Torah that's my Couture generator
I'm going to call this dev ox and Swift
application at this point I'm going to
since I'm on a Mac and I really like
using Xcode I want to have an Xcode
project here so I'm going to run Swift
package generate Xcode project
or Emacs or whatever you can certainly
do that as well and I also have a Linux
box I do like native development in but
Xcode gives me a lot of cool features
like being able to add debugging and
profiling and running my unit tests
inside of the IDE so I really recommend
if you are on a Mac to use Xcode so I'm
going to open up dev ox and in this
example if I pressed run it's gonna have
to compile my source the kotora
framework along with this project
all right build succeeded it's going to
the the firewall is probably going to
ask me whether I want to allow it to to
run a server on my computer
8090 is in use
does anyone know how to do a kill all on
the thing that's good taking up for 80
90
and then grab
yeah I was just practicing my demo and I
think I left something running yep
there's there is something running there
you know to get the process
oh this is nice live debugging here
let's see what can we do we could change
the port it's running on that's the easy
thing all right so let's let's go ahead
and open up this application and on port
I'm just gonna change this to 3,000 all
right so I'm gonna open up a browser go
to localhost 3000 if you haven't added
any routes to your application you get
this landing page just showing that your
cateura server is up and running let's
start hacking on this so if we open up
the routes and too bad I couldn't
enlarge you can see here we can
initialize the routes so if if you're
familiar with Express je s style coding
it's very similar here we just I can
change it it's really hard to see I
think presentation large that's better I
think okay so here at the root I'm going
to go ahead and just return hello world
and then rerun this and refresh you see
hello world appear here so let's do
something interesting let's create a
route new items to a list so in this
case I'm going to create a new router
match the the route items add and then
the name and what this is doing is
making this parameterised so the thing
that's following there is the thing that
add a ball you could just have ball B
here so request/response
next in and in this case I need to get
that that thing that's in the name so I
can go ahead and get that using the
request parameters and let's that's a
dictionary so we're gonna try to get the
name from it and this will actually
return an optional because we don't know
whether that parameter will even be
there so let's do an if let on that and
we need to add that to a list so let's
go ahead and add that and that's a list
of type string okay so in this case
we're going to take my list and append
that name to it and let's also return
what's inside the list when you go to
that that that route I notice I usually
use the post to be very restful but just
have some plus CD let's just make it a
get route so let's go ahead and see
realize this as Jason so I can use
swiftie jason to help me serialize that
out and let's go ahead and do
type okay and let's send Jason and then
construct a Jason payload from my list
and I think that will work build
succeeded item add ball Oh items sorry
maybe I'll change that to item okay ball
and racket so it was really easy to add
that Jason to this application one thing
that you you have to realize when you're
when you're programming but it's not put
in front of a nice reactor pattern that
you see in Express yes you can't so does
anyone see a problem with this code
regarding that well we probably should
protect this guy right because you have
multiple threads who could be mutating
that so it's very easy to add that in we
can use Grand Central Dispatch so if you
are used to iOS development dispatch is
very common to you let's go ahead and
add the the lock on this list so create
a new semaphore
and then you can describe how many
threads you want to allow inside of this
critical section at a time and let's go
ahead and lock wait till you can enter
the critical section let's go ahead and
signal that I've left the critical
section let's go ahead and let my items
equal the Jason my list and then let's
go ahead and send that out oh yeah
that's a good that's a good so that yeah
luckily this doesn't throw however if it
is throwable inside of there you have to
catch the exception inside of the
closure or inside of the block there
because there would be no way that you
could have the exception be handled by a
different thread it is yeah it is
so what you're saying about when you
leave the when you leave the block you
want to ensure something's happened
there is a defer statement that you can
do in Swift so you can make sure that as
soon as you leave that block you this
will have to be executed yep yep you
know what I actually like that better
because you know as soon as you do the
way then you can go ahead and defer the
yeah the signal on that lock so let's go
ahead and just run this track it you
know this will of course work so yeah is
very powerful and you see this on rust
and go Swift can also exploit that as
well let's go back to the presentation
and
if you're interested in deployment we
maintain to docker images that that
could be really useful if you choose
bluemix we just released kubernetes
support so you can use queue to deploy
your Swift applications on there one is
the the beefy docker container that
contains the Swift compiler LOD B ways
of running your test cases and then we
created this other container that's just
really lightweight and it's just made
for runtime so it's lean and mean so we
recommend that for production also this
weekend where projects you're all ready
to go for creating a a web application
so really recommend using this and when
you run that you see this appear and we
have a lab that's just on the exhibition
floor where we'll walk you through how
to use this tool so that's I really
recommend you coming to see our loud
there if I
we have a book this is a book I wrote
with David Unger my co-author and you'll
learn a lot about a lot of things like
you saw today but we'll go into more
depth like how do you manage
asynchronous calls with promises how to
use the Swift package manager at length
how do you add authentication like
Facebook authentication to a project how
to add a database connection so we're
handing out this book for free so it's a
small book though so but it's free so
check it out so yeah just to wrap up the
the talk you should come see us I guess
you can send an SMS to this this number
is that true I think and yeah you can
you can go ahead and see our IBM booth
anyways</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>