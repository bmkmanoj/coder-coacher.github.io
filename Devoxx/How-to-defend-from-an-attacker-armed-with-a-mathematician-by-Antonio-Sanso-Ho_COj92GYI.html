<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>How to defend from an attacker armed with a mathematician by Antonio Sanso | Coder Coacher - Coaching Coders</title><meta content="How to defend from an attacker armed with a mathematician by Antonio Sanso - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>How to defend from an attacker armed with a mathematician by Antonio Sanso</b></h2><h5 class="post__date">2017-03-02</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/Ho_COj92GYI" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so today we're going to look a bit how
to defend from an attacker are made with
a mathematician I know is after land so
yeah so quickly if you information about
myself our I'm into the Sun so I'm a
senior software engineer and security
researcher working for Adobe battle I
kind of like to break stuff so you can
send myself listed in some security all
of Fame like Google Facebook get up
Microsoft by tau many others I cannot
break other from the bull abilities in
some common software like openssl google
chrome apple safari we're going to see
one of this today and little things i am
a quarter of this book from manning's
it's printed this week is colorado in
action and yeah I'm kind of obsessed
with prime numbers and this kind of
helped me find a vulnerability welcome
and look into today little notion so
this is after lunch you can really take
a nap fall asleep if you want to wake up
look for that red star it's a good time
so I mark the important slides with red
star the other can chill out I don't get
offended so the main topic of today is
the best protocol ever design it that
goes under the name of TLS or transport
layer security so you kind of use every
day I'm pretty convinced about it so
even when you go to the boxes website
when you see a lock and if you https
then you're using TLS under the hood and
yeah how does actually work TLS I mean
we're not going to go into the tales of
course but so this is like a high
picture of how it works so it is
something called hybrid encryption
because it use a mix of symmetric the
antimatter encryption so the first part
your browser and the server they agree
on a shirt key and they do this using a
symmetric encryption like carrots ALDC
Hellman then they have this key and
there's this key to encrypt the data
between the client and the server and
they do this with
metal encryption like a s you might
wonder wise hybrid the reason is pretty
simple the Metro encryptions much faster
and so they use this one as soon as they
get and yeah this is kind of height
looks like a negotiated connection
between a browser and the server we're
going to explore this a bit better so
this is a easy TLS the DPL money femur
for key exchange and then to use AES
Galois control mode for encryption and
some other stuff over erf so for today
we're not gonna look into this
everything of course we just focus on
this part there's a really cool part the
other is kind of boring even for me yep
so which one are the actors will look
into today we the client that usually
the browser and the server and today the
owner ability is going to be about
openssl then we see the handshake how it
happened then there's an attacker with
me and some mathematician good so this
is really good moment to leave the room
and don't get dependent because after
this some matt is going to be shown to
you have been warded so somewhat type
what do we need to know for today's talk
so really complicate stuff edition I
think so far so good elementary school
will did it same for multiplication and
nothing start to be really tough we have
expectation so high school particulars
to sign the last things did you see
we're all programmers and modular is
easy i mean model automatic is for asus
eee pc so that's it all we need to
understand to place this for operation
and we can do the filmin so quick hint
about public key cryptography has been
introduced in a really great paper for
diffie-hellman in the 70s and its really
great paper even now after so many years
is still a real actual paper so if you
didn't to read your interest about the
topic still a good one and in this paper
dental is a kind of concept of
one-way function to be in cryptography
and what is it one-way function is one
fab function is really easy to describe
if the function is easy to be
calculating one Directioner and really
hard to do the opposite so the one they
will explore today is the discrete log
function so the easy part is the modular
exponentiation it's really easy to do
module exponent issue there's no problem
I mean all you need is a mod is AP
usually prime numbers a generator and
it's really for example if you have a
prime number 17 and generator is equal
to tree it's actually really easy to do
this operation like 3 to the 4 117 is
pretty easy anyone wants to tell the
results of this I give a book I don't
have any sorry but okay if is it 13 so
it's why this through the forest 81 117
is pretty easy to understand mr. Keane
so a computer does this really quick not
only with 17 but we really big numbers
like in cryptography numbers that we're
going to use a really big we're going to
see an example later on with our monster
so of course for 17 is it easy to
calculate but this works and scales well
even with extreme big number but
opposite it's not the same it's actually
really really complicated to a computers
cannot scale I mean words they can
calculate this catalog for small numbers
but he have the numbers of magnitude we
using cryptography there's no way at the
moment that you can calculate this great
work a trivial algorithm the two will
show today's is really the normal brute
force algorithm to try the solution but
even the most efficient solution to find
this quick log there are not efficient
there is no way to find a great log of
big numbers again here we're going to
trial error algorithm and see how is
what means dispatch load but again of
course the most efficient algorithm not
as trivial but there are still not
efficient so we go look for a number
where the result is the Y is 10 so we do
trial error we try first with X equal to
0 so 3 to the 0 is equal 1 mod 17 is one
will
for 10 it's no good so we throw it 1331
is equal 360 through which I 1331 is
equal 3 we're looking for 10 still no
good so we try with 2 3 2 2 is equals 9
mod 17 is till nine we're not good and
then finally it looks like we found the
right one so 3 3 3 is 27 mod 1710 so
look we found a good one so again this
is a trilateral algorithm but of course
it works good for 17 that the number
that are using cryptography they kind of
look like this so with 17 was easy to
find all the combination of numbers from
0 to 16 worst case but if when the
number you are looking for are these
well there's no chance a computer can
scale at this magnitude so that's why
it's really complicated the reverse of
the function another hint of how the
discrete logarithmic it be that on the
left side there is the normal analogic
logarithm study at high school as you
see the the plot the graph is really
easy it's really smooth three nice when
you go to the today to the fields the
moral arithmetic you see that much more
captured much more unpredictable that's
why it's so complicated to to calculate
is not just a lot of unpredictability
now you're saying why you're telling me
all this the reason is believe me or not
whenever you connect to the internet and
use HTTPS your browser and the server
they actually do this kind of math they
do this the exchange numbers they agree
on a key is it's really happened and how
so basically when you're when you see
Hellman for kicks handshake when your
browser connects to the air to the
server the server picks a random be
random number B and that's the exponent
tension so that the normal expenses you
have seen before so that's G to the b
mod p and send it to the network now it
in theory they should choose this this
value of these every time different so
this should be every time a different
number let's
I hear there is this e so this means
these three have many female because
this number should be all the time
different and then the same for the
client so the pants which is another
number use the P and X the disturber
stand and then send G is since Y a
two-day to the server and then they can
agree on uninsured pre master key so
basically the the client has a final
number that is due to the a be mopey and
the server has a number g be a mod p so
we're the same number and adversely
there is in the in the middle that
observe whatever it goes on the network
they cannot do the same because as we
said it will spread log of this function
so just so observing why a Webby there's
no way can calculate a and B so so far
so good you say I mean this really works
actually math that it can be broken so
far 2017 there is no one that can break
this but so why why what is this
vulnerability that I intercept begin
basically a few months ago I was I'd
like to find this this in openssl but
basically is a high vulnerability that
affected many instance of open sea cell
and I was able to recover many private
Keys without using any single line of
software mistake in terms of like memory
corruption but I use pure math and here
we're going to see a bit of of the
details some some months later we
discover actually with this research
from University of Pennsylvania Michigan
that the problem was a bit more spread
in openssl but many people were doing
the same mistakes and many many interns
were at risk and again this this kind of
smaller abilities does not use any
classical bathroom floor in the babies
but it is really based on Pumas and here
we go see few details so basically open
cell did three little mistakes that
combine it together they they were done
in a way that I could recover this
product key so the first mistake that
opens the cell did
is to cash this value of B so basically
the value of B did she was supposed to
be ephemeral it was not anymore was
actually choosing all the time the same
the percent is not a problem this is
just one of the three requirements we
needed in order to recover this product
key but we had it the regions because
openssl shipped without using this by
default this with ssl single bh use so
basically they were cashing this value
of B first requirement second
requirement for the tactic succeed is
that the fact that open cell was not
doing any validation whatever value the
attacker so should be the browser in
this case was me that Tucker was sending
to an open-cell instance they were
accepting it doing the classical where
the film an explanation and encrypted is
the key with the value that I was
actually driving so but even if I were
sending them some kind of invalid value
mathematical invalid value didn't care
they went ahead in order to describe the
third achieve the third things I need to
explore it and it open parentheses as I
said that the server is sending some
prime numbers to their to decline so to
the browser but which one is a good
value for different numbers which prime
number should i use them so many from
numbers are infinite so which one
delicious to lose there are some
guidance it turns out there are a lot of
people they put some guidance and they
brought some air FC today ITF umbrella
usually where they put with Brandon
umber to use before to talk about these
less open appearances so team and Swan
is always even because he is a prime
number so result so famous one is always
an even number and say that a good
choice for 4p to using this element is
to use a safe prime so many RFC's is
actually use this safe prime and what is
mean to say Prime and at the time there
when you do penis one platoon Phillip M
numbers so this if you are doing the
free element
you're using a search premier pretty
much doing well at many as three they
actually say don't come with your prime
numbers here is a text from you can use
it but if you don't want to see safe
Prime and you don't do validation you
better use a kind of prime numbers where
the teammates on split two is not a
product of small primes this is
something is important so if you don't
want to see if a prime you should at
least follow this guidance now why I'm
telling you this well it turns out that
I was kind of seeing of the kind of
specifications when I we kind of hit
this f-35 114 and yeah I kind of look
weird to me I mean I was looking at
these plant numbers and when I was
calculating this team as one split to it
was done like this so two three five
four three diamond didn't look really
small to me we kind of kind of weird
right so I went had this this maybe we
can screw this I said why I mean whether
people suggesting these numbers now
before 22 ahead I want to finish the
loop and they've been altered to use a
man's word be another naked yet when the
reason his number but basically I had
all steps needed to to go ahead with
this attack so basically open the cell
with repeating numbers open cell was not
validating an apostle was actually
introduced this support for f-35 114 so
I could carry out and do this under
attack and how do you do it basically I
was passing this I cannot go into
details I would be open for questions
even for coffee with anyone inches into
math but basically I was calculating
this this secret number so they did the
part of the number that was supposed not
to leave the server but collection
calculate a small piece by piece this
number doing the number mode to withdraw
operations the number mode 3 with three
requests and so on then I the Chinese
remainder theorem megan is out of this
it's not completely but this is not
doesn't lead in this talk the net will
recover completely the secret number of
now coming back to this HP 5114 again I
was kind of really really curious I mean
why I had these numbers and looking the
more I was looking into this in the
internet the more kind of fun weird
quoting I mean this was the 90s
specification I try to do an ids
specification in the outward it took
these two years is still not actually
done this specification went through in
four weeks and was kind of done by a
contractor of the defense unit Kingdom
defense now again it's only speculation
but kind of family kind of weird and
basically this that's the story I want
to tell you today and I'm open for
question now or if you don't have
anything twice now I can always be open
for question afterwards
so what's the motivation for actually
including the option to reuse the value
in the first place speed speed so they
were catching so speed and they skip the
fact that they had to do an extra
explanation because they had already the
exploitation done so it depends like
it's not so it's costly but not so
costly but they were still catching it
so this is many times the dance with why
there's this security issues because
people are looking for speed and they
forget that might be kind of dangerous
the interesting part is that only
reusing these values per se alone is not
a problem in order to diss attack to be
carry on we need all these three steps
interestingly enough of a little habit
of the three steps
thank you for the talk but I'm curious
what do you actually do is your job at
Adobe this kind of cryptographic
research yeah I'm a secured researcher
so I'm really into so add my mixes of
research well obviously I do a crypto
the web app research as well so and I'm
a somewhat part of the coding I do is a
related where an Adobe product this is
called am or cq5 so I'm responsible
under security team in this product and
yeah as part of my job is a bit of
coding a bit of research cryptographic
and web app and how could answer your
question I think this equation opener
yeah yeah this was a bit you see here is
a CBE so was the fix is in last year in
January but now you know the day super
sister was fixed in January but this
research paper is presented as well next
week so I was a like enough to to work
with this researcher and with our paper
was accepted to the conference call mbss
as a church conference crypto conference
in the United States so we're kind of
show this rubric as well now yeah open
the cell fixed and resistivity numbers
with able durability last year in
openssl 2016 I hope that people fix it
for now but you know
I have an excellent article but I've
heard that the Calvin itself is quite
cryptic yeah in your opinion how does
that add to or computer security
problems so in this one maybe not much
because he is not a memory corruption
issue but yeah the problem with the with
the widow cancer cells the code is
pretty the code base is pretty old so
people now are the last after hardly
hardly was was really point of turn for
office yourself they start to take these
things more seriously but the plans you
know I'd have a huge codebase to clean
so they're doing better they're even new
process and so on but the code is
whatever it is is and she doesn't
forgive that's the point it is not a
language it's forgive the minimum
mistakes you're screwed again in this
case is not assume or a nerdy crypto
issue rather than memory or help lead
style but still I'm independent again
even the cryptography cryptography
doesn't forgive you do when a little be
taken and many people you know of course
we are all programmers and we are not
all interesting again I'm obsessed with
this prime numbers also beverage
programmer dozen is not and understand
it there's nothing to destroy and it's
related to do things wrong thanks a lot</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>