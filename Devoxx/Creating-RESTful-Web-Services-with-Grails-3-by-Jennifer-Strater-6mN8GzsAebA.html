<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Creating RESTful Web Services with Grails 3 by Jennifer Strater | Coder Coacher - Coaching Coders</title><meta content="Creating RESTful Web Services with Grails 3 by Jennifer Strater - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Creating RESTful Web Services with Grails 3 by Jennifer Strater</b></h2><h5 class="post__date">2015-11-11</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/6mN8GzsAebA" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">hello everyone and welcome to creating
restful web services with Grails three
I'm Jen straighter I'm a consultant at
object partners object partners is a
consulting firm at a Minneapolis
Minnesota in the United States you may
also know me as the co-founder of great
ladies great ladies is an organization
that supports women whether they're
using groovy Grails Griffin any of the
groovy related technologies I through
networking and education if you'd like
to keep in contact as well as see the
slides from this presentation follow me
on Twitter it's at Jenn's straighter so
the agenda for this talk is to kind of
go over a few things about creating
restful api s and restful Web Services
that I think make it really easy and why
you should really use Grails two of
those include the resource annotation
and restful controllers I'm also going
to go through a few helpful things like
supporting multiple media types custom
response formats and versioning so if
you aren't familiar with Grails 3 there
have been some major changes so now
based on spring boot which gives a lot
of advantages that we can use those
spring boot libraries as well switch to
Gradle for the build system which also
adds in a lot of other features and
Gradle plugins that we can use from
there as you as I'm going through the
examples if you're familiar with Grails
- you may see some directory changes
some structure has changed as well some
of it to match the spring boot it
particularly as far as the configuration
some tests have moved in a scripts
directory I've if you have questions
I've got the questions app on my phone
so when it comes to api's there's a
great new feature that's been added
since girls 305 and that's the web api
profile it's still kind of in
progress but there's a lot of things
that are really neat that are making it
even easier to create services and so
these profiles are templates to get you
started and it removes a lot of the
unnecessary features that I wasn't using
to create api's before things like it
takes up a Jesus piece it takes out some
UI plugins asset pipeline things that
you aren't going to use there's also
some new features with a Web API profile
you get to know things on the girls
well more but two things I don't want to
talk about on the girls command line
include a way to create domain resources
or domain classes that automatically
have that resource annotation and you
can also create restful controllers you
have a command line as well there's one
thing that I want to touch on kind of
briefly so like I said the Web API
profile is still in progress they
announced I spring one through a couple
of the talks that there's this really
exciting feature coming
I called JSON views and they're so you
can use a lot of the JSON type things
I'm gonna talk about girls 309 but that
is coming in 3-1 so I wanted to kind of
walk through how to create and how I
created my test application so I used
GBM to specify that I want to use the
version 309 and I created an app and
here's where that profile comes in so we
get a dash profile equals Web API to
specify that I want this particular
template and not the entire
girls web application framework that we
normally would get so if I create it
this is kind of what it looks like
hopefully you can see that I we've got
the typical things that we think of we
get config resources diary for adding in
your beans the application bemol is what
may not be familiar if you're still
using girls to I and we also get some
default controllers
URL mappings is now in controllers the
application class in and is the spring
boot main and the tests have moved a
little bit also notice in here that
there is no views directory because
we're not going to use that so if I
start up an app I've read out of the box
if I curl 8080 I get this nice block of
JSON you probably can't read that so I
did print out the top portion of it if
you're familiar with I've getting
started and girls to you in the
development mode you get this index file
that you can click links for the
existing controllers kind of I see
things from there to get started this is
a very similar concept for api's but in
your JSON so you see what controllers
are available you get all the plugins
that are there what version of Grails
all the the normal standard things that
we would expect so my real world task
was to create a in it's an in progress
side project that I'm working on called
great data so I as part of my outreach
with great ladies I often get asked how
many women are actually using groovy and
kind of where do we want to get to and I
realized very quickly that I had no idea
I knew a couple women that I worked with
but I wanted to find a way to capture
and display the gender ratios at
different companies that are reported to
me from all around the world I do have
it as a d3 project if you download the
slides I've you should be able to click
the link it was kind of a weekend thing
to get it going the data was stored in a
JSON file and contributions are have you
have to go through a github pull request
model so what I've been working on is
trying to convert that into an API so I
did get a sample repository up so that
you can kind of look through the
different demos for this talk
so my data model looks a little bit like
this
so if each company has a name there's an
embedded country the country has a name
abbreviation and continent and there are
various statistics as well for this I'm
just going to talk about the name in the
country
the statistics are in the demo though so
the first and easiest end point that I
wanted to create was the country I just
had the three things it wasn't it's
dependent on the company so this is
where the create domain resource comes
in I so very similar if you're familiar
with working with the Grails command
line Grails to create the domain classes
this is just a resource you again get
the country and the test out of the box
this is kind of what it looks like well
it is what it looks like you get the
default package who's gonna import all
the rest stuff and it annotates it
without resource we get default formats
of JSON and XML and there's nothing in
here but what I wanted to do was then
start configuring it so we went through
I added a custom URI so when I do if I
like to use plurals so by default I it
we have the slash country but it would I
wanted to do such countries I also added
in the three properties here string name
string abbreviation and string consonant
so this is all a really simple way to
get started very little code here so if
I start out and try to do a get it does
establish that there are that the URL
mapping is on slash countries but
haven't created anything yet so of
course we'd expect it to return the
empty list so the next thing I want to
went to try to do is post so I wanted to
create a new country so we're in Belgium
so I'm going to use my Belgium as an
example I I've went through and I
created the scroll request but it wasn't
complete and one of the things I wanted
to show here is that the errors are
really helpful so rather it adds in all
of this stuff without me having to do
much of it I tells me what properties
are missing and it does return the
proper 4:22 on possible entity so of
course I then fixed my mistake and
continued and had a post that was
successful it returns a 201 with the
formatted or
formatted there it does add a class name
and we can go through and show how to
remove that as well the next thing I
wanted to do was update so I had a
couple in there duplicates so I wanted
to update one of them so by put I've of
course have a header in here still
pretty simple so I'm using the same
version of postman so I've got the same
URL slash countries right nope
of course I had forgotten to put the ID
at the end so it had this great support
to tell me oh it's not supported so I
fixed that and now I get it updated
similarly there's support for patch so
if I wanted to update the abbreviation
so I went from USA to us from the three
digit to the two digit abbreviation or
two character I I can do that just
update the one field and not update
anything else again 200 with the JSON
returned now that I have a couple
different countries in here if I do a
get again I'll get that as a list as
we'd expect but as you should hopefully
recall at this point although John has
created domain class and run the app I
had a couple fields I haven't done too
much we get all of these automatic
mappings I haven't touched controllers I
haven't touched URL mappings
and I get a lot of the nice features the
static codes the status codes the
methods a lot to get started so the
other way that we could do this is
through a restful controller so through
a restful controller I would then start
by creating a new domain class and this
is similar to the old way but I'd have
great data select company and yeah this
is what's created by default so there's
nothing in here of course I added two
fields so at this point now that I have
a domain class I can generate a restful
controller based on that I generate it
remember to add it to the URL mappings
so in this particular case I had it
custom rather than you can do resources
and that would generate all of them in
this case I wanted to do particular ones
and not open everything up so here's
what the generated restful controller
looks like I get the company and
controllers going to extend the the
Grails restful controller I get the
standard formats again JSON and XML it
looks very similar to what the @
resource annotation was doing but it
gives us a lot more control so when in
this constructor it's gonna call this
super but we can also override uh any of
the other methods in here too so there's
a lot of customization that we can do
from here in the resource annotation we
can update the URI like I did I also
updated the read-only to be true because
once I load that data initially I don't
want anyone else to update it
I also have a lot of flexibility in the
URL mappings so if you add a resources
resources girls of course by convention
your controller your domain class all of
those match by spelling and it
should see all of those so resources
would then pull in everything that
should match you can also specify it
custom by your other you are eyes you
can restrict by method and you can
research those response formats as well
so one thing I wanted to also touch on
was the default mapping so if your if
you view scales before you're used to
getting this controller selection so if
you have some kind of vary the country
controller slash action then that's
added by default you especially in our
restful api like this if you're
overriding and you want to use all your
plurals remember to take this out so
that you don't open up all of these and
points so the next useful thing that I
did I started as I added more to my URL
mappings
I ran the URL mappings report so this
was really helpful to show what
endpoints exist in one case I map
something twice so I knew to remove it I
it's another really helpful way when
you're developing make sure you run that
and see what's going on especially as
your app gets more complicated another
thing you may want to do is specify
particular methods get restricted so if
we can access the controller the action
and specify that only that method can be
called everything else would get
rejected you can also specify on the
controllers so there you can add a
static allowed methods in this case it
would take the save the save method
would only or save would only take post
update would only take a put if you
tried something else it would reject it
so another thing you might want to do is
look at media types by default if you
don't specify anything so you're looking
at the different ones that had formats
equals JSON and XML but if you don't
specify one it uses XML by default but
you can add in what you want via
mappings and controllers so if you add
JSON first it's going to use JSON as
your default and then XML if you
requested you can add in lots of other
types as well one of the other things I
found really cool about I Grails and
it's not really three specific was that
you can request it by the URI extension
so if you go to like slash countries XML
and I have the format above where it's
JSON and XML
even though JSON so default I can
request XML just by the URI I thought
that was pretty cool and like it says in
here if you request something that's not
allowed it's a 406 so you can see from
here where it would be really easy to
add in any custom types if you when I do
that it's in the application dot I be ml
file and you can see the list and add
and remove and customizing from there
the next thing I wanted to do was
customize the response format so we
talked about at the beginning how they
have that class name and maybe if you
have dates you may want to format your
dates there's you can do this remark the
marshallers or renderers you register
them you can either register them very
simply I'm going to show a bootstrap
registration as well as a custom one in
your beans and then I will very briefly
go over the new JSON views just as a
comparison so this was a very simple
JSON marshal er that I added to the
bootstrap file so bootstrap was gonna
get run when it starts up and it's gonna
say that every time I request a country
and it's asking for JSON that it's going
to take only the
ID name in this case I also changed the
name so it was from abbreviation to a
shortened version of the brief in stead
them then it's not going to show your
class or any of the other things that
were showing up before so the next way
did I do this would be as a renderer so
I created a company JSON renderer and
registered that so this gets a little
more complicated so this is the example
and it's going to take the mime type so
it's going to declare which so it's only
gonna do JSON so if it's XML it's not
gonna try this and you can overwrite how
it's going to render so I created
through the JSON builder to do it this
way the one thing I changed was so when
I output the country I want to do
country that company that country dot
name instead of the entire object this
should look pretty similar to the way it
works before the other way to do this so
that was for a single company like when
you're doing your show here your get on
an ID if on the route when you have a
container or a collection you can
customize that too so we get you have to
specify the target and I've what type of
component it should look for as well as
the mime types again from there you can
render it however you want
remembering that that is a list instead
of just a single so the new thing that I
was really excited to hear about is the
JSON view so I as someone who's gone
through from the the full web framework
we're used to having these defaults
where I've everything's convention based
so you got you created a
Devane class you did generate all you
got your controller and you got a view
that all lined up and matched up so but
an api's you don't really use the GS PS
but we can instead use these new JSON
views to replace GS PS to have a JSON
format instead that is coming in grilles
3.1 there are some links to talks at the
end to talk about that but I thought it
was really cool and exciting that that's
coming and should make that rendering
process a lot easier so here's one that
I pulled from the released second
release candidate for the not found
looks a lot simpler and more concise
than having to create all of their other
custom stuff we did before so the other
thing that may want to do now that I've
gone through a couple iterations is to
version and there are three main tactics
that I use for trying to version the
easiest one is through you having just a
different URI but then you're mixing
part of your API in with the URI which
is supposed to be just about the
resource itself you can also do it as a
custom header and through content
negotiation
so of course Grails supports all of
these if I wanted to do this through the
viewer I did this through mappings so I
created two controllers a hello version
one and a hello version two if you go
through the demo I and had those via
namespace you can also do similarly for
an accept header I've just specify the
version there and you would have the
namespace as well so here's what it
looks like I have two different side by
side really simple just demo example but
the static namespace helps when
configuring all the routing
so I'd be remiss if I didn't I mention
security I did go over like all of this
was open and you may be able to post
things you don't particularly want to so
there are some things that are hopefully
coming if you're using grills too there
is a spring security rest plugin and
there's a great video from reach a year
ago that goes through in depth how to do
that hopefully that'll get ported to
girls three now that the spring security
plug-in has been updated but of course
you could go through with the current
girls spring security and wire it
yourself another example of that is to a
screencast from Bobby Warner of agile
orbit there's a link in the slides that
he goes through using the spring boot
ooofff plugin how to incorporate that
into Grails okay so in conclusion I we I
wanted to show that the girls web api
profiles streamlines the API creation
that the defaults i've support all kinds
of things that we may want with an api
your status codes your methods the
custom media types as well as response
formats and versioning and it wasn't
that difficult to do i also wanted to
show that there are a lot of exciting
things happening this has been and
getting better and better with each
release of Grails and I'm excited to see
where they go next so this is a very
brief overview just the 30 minute talk
but I did give a more extended talk at
great calm for us and I was able to look
through recently the talks from spring
one GX or spring one to GX I Jeff did a
really good talk that went into it
detail on how and why a lot of this
works and all of the new things that
we're coming are in grams talk on the 3x
updates it's also important to have so I
did put the documentation link in there
as well okay so I have a few minutes
left I can either if anyone put
questions in the app I can do that or I
can go through the example code okay I
don't see any questions in the app so
I'll bring up the code okay so let's do
presenter mode
nope
okay so here's a kind of where I started
I there's also some other fields in here
as well and I did link to these others I
can do it's okay okay so do I drag
that's only showing my background no
okay
okay did we get soul okay hopefully
that's better so I did create the
company I've and the country so here's I
that at resource and use let's there is
no controller for that one but there is
for company and in this case so I
restrict it so it should only be JSON if
I requested XML it wouldn't be allowed
the other interesting thing in here was
the renderers so the company renderer
builds up JSON and customizes what you
can have in here the other was the
collection
so that takes a limited subset of the
fields that I had on the entire thing
okay does anyone have any questions or
want to see anything else okay so that's
all I had I want to show you the link
for the slides are on Twitter as well as
the app is on github</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>