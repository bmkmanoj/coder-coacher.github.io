<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Getting all the 99.99(9) you always wanted by Mite Mitreski | Coder Coacher - Coaching Coders</title><meta content="Getting all the 99.99(9) you always wanted by Mite Mitreski - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">⤵</li></ol></div></div><h2 class="post__title"><b>Getting all the 99.99(9) you always wanted by Mite Mitreski</b></h2><h5 class="post__date">2017-06-19</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/vW-uUzkimfw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">and what we hear it's the first time in
this part of the world so update towards
rossabi tomorrow also engineer rope or
of speech for particle Pharma in fact
having a chocolate or chocolate Sonia
where I didn't conquer
and in all fairness project which is
just artificial for the occasion
bhakti-yoga bill Jolley bottom part of
Monday's execute their post some other
product in the engine sorry
okay so I'm going to have to probably
quite unknown in the part of the world
second OCR action of operating in the
400s quad right there trivia
ha
okay so it does not hear Africa memorize
metal so we moved over in Western Europe
in Northern Europe mine even though it's
a part of your mantra their appearances
hang on Viren my job mostly working with
wonderful quality of they have other
brought in the payment industry
generally practical the issue I think oh
they're substance of generally oriented
sort of payment and by doing so
so what actual important well let's talk
about Hawaii actually need to help
apparently so I reminded furious because
of the number of items of technology I
would say it's a very mature act again
providing a high level distances all the
parts so now when we actually needed a
problem we have I often tell Russians in
Capernaum the amount of interest in
Arkansas so this is may not but big
numbers of the gradually therefore
Elektra multi-purpose mineral maybe it's
a very different people parties here we
have merchants about life because what
consumers of time and and what lot of
people are are interested and Karanka
so what the impact of production failure
of course nobody really want to have
technologists so we have just made the
certain failures or their traditional
services so we try to be as transparent
as possible so we only have object of
such like a spa home where we try to
list whenever there is a ether in
Samaria and we try to express more adult
objections and how probably can be one
measure subject when we are making this
crime
it's very ordinance there we always
active users of the video internet work
in technologist of a leader to mention
the technology very good addition there
is a consumer college our Emmanuel if
you serve don't work you have
opportunity that does come over this way
but if you are presenting is interested
in tourism you might get it don't count
are all going home this nomination is
the very top party on remaining your
magnetic walking is Berlin for that
particular party in the special show
that the human ear so you are winning
your brand but also really know the
margin presence so you can also wherever
the middle of allergy question number
two actually the library thousands of
there are working for particular days
appear in a clean out context by the
your service
in India or your Halloween merchants
calling short version 10 years out big
for how's that knocking this occupation
won't be accorded also under the vectors
of average and that doesn't like a lot
of money you can have it can have a
resume so crossed out me run my
residence so we can we can be quite lost
hope our Intel my majors be knock you
over don't believe the tenure
certificate II can call for example
Erica on carpenter support life we would
get very different properties football
and all pokémon for you I think I'm
your fear losing from years apart but
business in the physical library
self-promoting totally together they're
expedient and it reading coming to my
class elimination syllables bitter and
reliable proper and that we give to the
death of failures of the world you only
need to be able to death is number one
number two that she works for her figure
Shalom we may take we hit the dash
firm and with making it always opens
document to the pictures no chance for
error mere hey on population and request
the weather final count removing the
base attack the and compare various
levels
and confident over everyone especially
our cheers for table steamed relative
beginner market account material how
much rotation support their club
injections are hoping it that we
actually need to remove develop that let
interaction sessions per the three
remaining main color isn't because top
part of the organization is retains that
Delta mission is not worthwhile tables
money program which is definitely not
true
because the tremendous be together not
invested admission one picker is
mentioned above the authorities keeper
up so the air above la dee dee
running Sarah Collins Erasmus so it will
eat the present a lesson and a realist
resume it one one would have never you
have a iphone expert is a definite not
getting off for he knows by heart they
now call it the best workers my brother
they know what needs to the best violin
experiences all but one in an elite
actually deserves begin teachers giving
her complete ownership and not hang up
getting a box team is the half as a
books also change our professor you can
they are still always possible and try
to novice and obviously both on one day
we were doing a free programs
if you're not responsible
enter service agreement in immunity club
company so kind of dysfunction mr.
Katanga currently forming host ecology
to draw we remove the nozzle give our
build a decision but they can apply to
any club of there is not given in their
bone zone so this is like our senses
that we have another gelato so we work
out the internet dating service
meeting other after we have yes yes
working the web browser which has
something else in it that was deployed
we generally appreciate terms by our we
tend to treat our services castles best
which means that we we are very lenient
in in cheating originally visualizing
the service will have a low beta servers
of embassy from so we are very much
human having a beautiful structure and
s20 very doesn't so whichever to use my
what and mostly typically we're using
for all time a technology so our the
past according to the progeny of isn't
just collecting here on charisma and has
a she knows very long you ask in your
king group another service intransitive
when the service come tell me
transpiration of field of interest and
then you have another service you
other 1:21 we theory and so on as well
as a reporter of the time we do this is
a father of a very different motions you
do going MacUser another time or third
time dependent on door water in the most
convenient depending on the sail in
equation went with for proving they were
all because the thirst only becomes
active after that okay I'm talking out
we can't even start early and early
admission that usually have fifty or
service but being multi got it audience
regions half as if you were Vietnam
between season in others so how we
measure is and Al Pacino's
that was real of work southerners and
mobile perspective using it with
opportunity high level we found out that
there is a broad approach and that is if
you have the whole thing in the culture
is up or merely do you notice an error
has occurred there it is they now we're
up students to is of the time with you
and I didn't suddenly my being a robot
small products that miss couple of men
so the top of major Iranian and
alienated most people look into traffic
in retail or pretended to be in trouble
not working on
other products we came up with a better
looking on the youth of Canada so they
don't go through the minds of enemies
where people with the knowledge we can
read up in the Henry's life you know
they're important yes they live out the
general desire of the human we are
quieting volunteer we run around north
and Traverse of traffic to an intern and
that perception traffic we eat okay this
is behaving well or not and then inside
in one proceeding Korea where if you go
back to the original death
we were on an illness penalty we do this
at least back up gained approach if the
simple local approaching and we can fix
that the main America so that you clean
another office in America for the DeLeon
statehood that one is in any form also
define the random server but the point
of you as a new person
right yes the battlefield and your honor
for fear but the copy that you cannot do
in the loading please approach if it's
running form only up so now because they
use drawing approach 25% of the traffic
you love this comes for servers personal
without mobility which is actually the
only thought of it is approaches that
you can contain grandma control state
okay I want only one and here it is the
energy minister we have our work smarter
rounded the try to keep soft very basic
basic forms of
subjective people thoughtful so excuse
me for the bear only table next one
Devorah usually within all new wording
it's not like that
the very not person to the custom video
inflation this particular HK that's not
called by any of your instance you
cannot talk in the of their immigration
death in the other environment companies
very particular for the production
environment and only there is time so
when I couldn't produce approaches if
the debt assess patient we usually refer
as top our community after a burning
candle for exiting okay so after you go
for like the loading business approach
and determining recent of a cross-table
and then we design it out and obtain
another way this will approach is ending
it is featured on you can reach top
right with a digital things in store for
people so you're probably doing the
infrastructure of the set up a video
game we do this for certain features
that we don't need us for life robot
means we only do that for activation
fees what can I
we found out is that there is there
anything wrong a few bugs in general and
that is that is how bout your bottom
when you're dead missed anything that's
when the digital on the wrist of the
visions of a lot if you have family or
my own political over the contaminations
of having one and off all your not being
getting all the combinations you're not
destined main therapist and it could be
nominal even though I didn't win this
time it is not run like that sometime so
and key features of prom another PR off
if you need to just for different
combinations this overall which is also
the how we sell it up to be monkey ate
one so one in the knee over production
always but it's not enable for the
playground environment giving back and
this twist
persecution but also get various
problems that are that you're not if
you're all gone do not do the same we
are not the same yet then you're not
really testing the production rush what
Oh olive oil that I visited having our
aerial system death having a
justification
so if issue is doing less efficient or
for for having a digression we gather
and it may give you more document will
be roasted and one some tea to be
boarded it is coming most of the
projects now the majority of them are
dirt russian hamster genetic share we're
starting to track right master's
architecture for they are no more after
this operation they have still terrorist
occasionally one ended with so much the
end up with having outreach distributed
one Elizabeth like because walking
better this way
one digit open open
not at your oven that is kind of pure a
2000 and heat the first approach so that
maybe our client you do consequences are
further quality to do sometimes prefer
to stay in favor on the other person so
if the client knows the location of the
first server and knows the location of
the second server
it keeps two different of your typically
don't think about the more you doesn't
really need without the your set if we
know that your and offers so the first
one could be the one that actually knows
about the second one
this way the existence of the second one
or the location of the second one does
not need to be known to the client so in
a more practical example so let's say we
have a customer with the name Alice
instead of knowing the location of the
customer we can instead have a hyperlink
in site pointing to the location this
way we don't actually have to know about
the server service location there is
actually something called the Richardson
maturity model it's based on Leonard
returns some text that breaks down the
different ways to create rest services
and sort of the the highest level is
having a full hyper media as the engine
of application state or heat OS sort of
know like very basically Pehlwan usually
starts with a super simple servers where
it doesn't really have like resources
then they sort of move into the
resources and having further and verbs
on those resources but the highest level
is having this links between the actual
resources and the links benefit is this
is the
of the of the location of where the
where the resources are placed or or
processed another way to achieve this
and it's a quite popular nowadays is to
have a service registry it was actually
mentioned in the keynote
basically if you need to I don't know
user service service let's say the user
service location you don't need to know
where that you have a service registry
where you ask okay where is the user
service there is a really big problem
with this approach and that is you're
making an assumption that the registry
is running and it will always be running
so if you have many different services
that are registered in this registry
you're assuming that the registry is
highly available and will always run
which is not always true
that's why usually these registries are
either picked to be super simple so that
they can be easily distributed and made
highly available so that's the case for
example of Apache zookeeper or Netflix
Eureka and I don't know distributed hash
has that that contain the location of
this that way we have a super sort of
dump
service that contains the location of
all the linked services another form
that it's often not thought of another
form of coupling that this offer not
thought of is like the temporal coupling
but what do I mean by temporal coupling
I mean the time processing for different
services and basically it goes goes to
this if you're using a synchronous
approach you're expecting that there is
a response in time X if you're using a
synchronous approach you do not expect a
response in time X for the most part you
can have a call to the server and then
you get a reply without actually waiting
for
that actually reply the same thing could
be said for having a pooling approach
versus a callback approach instead of
constantly asking the server are you
done are you done are you done you got a
callback saying okay I'm done now one
way to have a safeguard for having
spikes in in request load time if we
have a fast producing server so like
fast releasing orange server here and a
client is calling this best producing
server so that's producing in the sense
that it makes a lot of calls to other
internal services one easy way to avoid
overload is to have a queuing in-between
you put a queue and then the request
processor is reading from the queue and
at its own pace so if the request
processor is slow it does this at its
own pace
for example system like this is some
classic example is a mail server a mail
server is like this right we try to send
mails but you cannot really send like
thousands of males at a time you sent by
batches of hundreds or by batches of 50
and they are all in certain mail cube
but you can be anything can be either a
Kafka a Tobias SNS or pretty much
anything another form that it's also
often forgotten as the coupling of the
data structures that we pick like a
caustic example this date time data is
very much misunderstood let's say you're
using Ruby for programming and then you
using I don't know JavaScript and one is
using a library that represents the time
in milliseconds the other one is using
it in nanoseconds it's very easy to make
this distinction even if you adds like
time zones into the mix things gets
severely more complicated oh that's why
it's good to have certain level of
standards in your internal systems
for for these sort of basic things any
standard actually like I saw anything
like currency or whatever is it can lead
to confusion if it's not aligned across
the different projects and if you leave
the defaults from the languages that
people use it leads to huge confusion we
for example have servers that are
running in Java Ruby closure we have
quite a lot eggs that are running in
Erlang as well so it's very key to have
a strict definition of the most basic
data data format that you gonna use like
it's very simple to make a mistake in
phone numbers for example let's say you
want to represent phone numbers how
would you do that use an international
format if use the local format then the
local format is pipe country code which
country code it gets really more
complicated you cannot really just
deduct on that it's just by picking the
right format might make the make a huge
difference all of these service patterns
that I mentioned are in a lovely book
called
service design patterns it's a dotnet
book but it's still the book they it
goes into a lot more details about
having a functional temporal coupling
and how to look into the different data
structure coupling another thing that we
generally want to consider as having
different stability patterns and that's
something I want to talk about in the
Poland period it also leads to having a
highly available system there is a
another great book that I want to
recommend
it's called releases it has nothing to
do up with releasing it's one of the
most badly named books but it's a it's a
great book about running your systems in
production it's the cornerstone of the
most of the things that we are seeing
today and most of the topic is that to
be what we're hearing today for
all of the stabilities chaos engineering
cloud native java and so on so I'll
mention several of the patterns that we
use and like some of the errors that we
run into by not having these and first
one it's super basic one and majority of
applications out there do not have this
in place it's a basic timeout so if you
look at apache httpclient for example
there are several files that you need to
have configured the idea is that if we
don't have a timeout you are endlessly
keeping the connection it with that
you're endlessly dripping keeping up
threads active and or some other
resource on your machine so you you're
going to run out of that particular
resource if you if you're endlessly
keeping having a timeout sort of stops
you from doing that for apache
httpclient there is connection primal
there is a connection establishment
timeout there is SSL resolution time we
actually had the case where there was a
buck in the batch HTTP client where the
SSO resolution didn't work for a
particular algorithm and the file was
not applied in that case so we slowly
noticed that the number of tress is
growing over time it was a particular
codec to a merchant and the merchant was
using a particular SSL scheme and in
that case yet the that case the the
timers was not applied and it's very
very simple mistake to make and then
it's super basic and super easy to add
timeouts
so please do add finals like today
another thing that psychosexual is
having circuit breakers in place up so
if we look at the physical concept of
having circuit breakers you have fast
circuit breaker in your house if there
is a overload on the network so curfews
goes off
so the the next time you figure out
what's actually causing the overload
you're removing that out of the picture
then you bring back the circuit breaker
on so in a more real example if we have
a client with a circuit breaker it's
calling some best behaving service
instead of dragging down the entire
system because of this big the hearing
servants after n retry sore after
certain level of thresholds we go back
to a fault that mode either we are
calling a holding server or we are
calling a fallback instance or we are
kind of removing the functionality
altogether and we do use this quite
often that allows us to run the server
in a more degraded mode with not having
all the functionalities but the users
can still buy without a problem
for example Netflix is one of these
tools that has this figured out in a
more granular approach we use this for
some of the services but not not for all
another really simple thing to do is
having handshaking so if your client
constantly asks ok King can the server
process a bit more resources the server
says ok I can have another 10% and in
each request if the server responds with
ok I can have X amount of X amount of
calls made more we are kind of not
overloading the the server this is
always not applicable to all he lectures
but in many cases it can be easily added
so basically our fast system should
never overwrite a slow one it goes back
again to this mail server example that
we discussed a little bit earlier so
there are various tools nowadays for
this actually most of the reactive
streams data streams API data that was
defined for Java had this concepts in in
place and tools like akka do this as
well so actually there is a talk later
today about chaos engineering that that
has this top topic hopefully in a lot
more details another sort of stability
pattern is having cast pockets and
unfortunately the internet is still
loading this
okay so pockets are coming again from a
physical concept if you look at ships or
submarines are usually a good example
they have different compartments so if
one compartment gets flooded the ship
still operates it increases like the
structural integrity of the vessel or
the system as a whole more compartments
reduce the risk of clicking the water
across across your ship in a more
real-world example is having really
simple like very basic examples having
connection poles this is also something
that most of the time developers get it
wrong and I mean we got it wrong
initially as well it's having a shared
connection pool for all services or for
set of services if you are sharing the
same connection pool and you have a
misbehaving like failing servers that
failing server is going to eat up the
connections for the other server that's
totally fine at the moment so instead of
having card degradation and just monk
functionality that's handled by this
failing server you are actually failing
the host system or failing the
functionalities from both of the servers
a simple approach is to have just
separate connection pools for separate
services
okay so that were corners more of the
stability the stability patterns wanted
to mention so as I said we are we are
humans we make errors if everything of
this was already gotten right we don't
need to have monitoring in reality on
the other hand we need monitoring very
much and it's one of the hot topics of
the coming years I would say so we want
to detect failures failures as they
occur or as soon as possible one simple
thing that we use is having traceability
we're having correlation IDs or tracking
IDs so if you have different servers
like I don't have a node.js application
there is a spring application there is a
closure application and tons of other
servers down the stream the entry point
application creates a correlation ID
that correlation ID or tracking ID is
propagated down to the other servers
this way whenever they log the request
that got triggered from the original
node application they can log the ID
this way you can track how that request
affected the whole system and this has
proven quite beneficial for us we use a
tool called Splunk I mean it's a
commercial - I don't want to kind of
promote the commercial side I can
promoted AWS to some extent but the same
concept is applicable in other places as
well you can use qivana for example you
can use there are tons of law whoa - and
so on a strict locks - so in Splunk
basically we have this correlation ID
it's for us it's usually created on the
nginx nodes and then that gets
propagated to all the other servers so
each request we can see how it affects
it across different systems so this
correlation ID we can see it just by
searching the correlation like the ID I
can see everything that's happened in
all the systems it's
very neat way to detect the failures if
we take this to the next level
and we are actually built we are
building or actually using our own
internal tool that's very similar to
this this is our Twitter tool called
Zipkin it's based on a Google Group
Draper paper that kind of defines
traceability in distributed systems so
the idea is very simple that you apply
this correlation ID to track down
processing time across different systems
so if the original request - I don't
know one second
you can see how much of that time was
spent across the different across the
different individual systems it's really
neat way to track things we are building
around for slightly different reasons
but it's very simple to do this so you
don't really have to use a pin but it's
a really nice approach to to track down
performance issues as well as other type
of box another thing in this area of the
texting videos as they occur is to have
a time series time series data base
sorry one other thing is to have this
sort of help so the health checks are
also like a key component in the aw
setup you need to have a health check in
order to register the servers in the
idle validity zone and so on but there
are other type of health checks that
kind of say that the system is working
in the aggregated mode and so on we have
a tool that we plan to open source
that's called monks it's essentially
wrapper of CloudFormation
it just reads from AWS okay give me all
the services that are tagged with this
particular tag and get get all the
health checks that are tied to this
so the health checks are all defined in
the server themselves so this is this
that's why I call them internal health
checks so for example we have here a set
of set of health checks
this can be I don't know number of
orders per second is going down or there
is your we are running we are close to
running out of memory or we are doing
too many GC pauses or pretty much
anything that's relevant to your system
we also add health checks for the
dependent services so let's say your
have a hard dependency on another system
for majority of your processing even
though your system is behaving find that
you have a significant degradation so we
add a health check for that and we call
them
we call them non actionable by teams so
that way when when an alert happens or
there is a pager CD call someone gets a
call from the responsible team and not
from the team that first detected that
so these are all great but they are not
really really telling the full story
they are not showing the reality you
must have external checks so if you have
an internet facing service you must be
checking in all the areas you you're
actually operating it we have set up a
check constantly that do the basic
operations for our system from different
locations where we operate so from I
don't know us various areas of Europe
across the different devices they
constantly try to create requests and
see what happens there
sometimes the requests fail because of
internet issues between the different
areas so they need to be made in some in
a sense that you don't get constantly
bugs for inter Atlantic connection drops
or or so on I will the to call Topeka
but there are plenty of other tools out
there and this is how we actually
measure the uptime at the end it's only
the external obtain that really matters
if you're using the internal checks for
for measuring out then you're not really
you're not measuring the deal of time
there are tons of other tools like ah
there is the two actually called up time
pink dome and I don't obtain robot for
 and so on and it's really easy to
roll out your own your what you're onto
okay so next sort of topic I want to
talk people is about having a constant
stream of time time series like majority
of our teams use this setup and the
teams that I've been involved are either
usually running a java service either
it's drug users or it's a spring boot
server and then most of the aggregation
of the matrix so like all of this matrix
number of requests per second or number
of completed orders per second the
aggregation happens on the server itself
but there are certain events that we
don't have the aggregation on the server
because they're by nature not server
oriented so like I don't know client
side events browser events we have
different aggregation tools like Riemann
or spark that the trun and try to pull
out the actual metric once this metric
is aggregated we use graphite as time
series database so how many you have
used graphite anyone yes okay so they
the idea of graphite is that it sorts
the time-series metrics in and you can
set up to being a sort of compact way so
that for example the last two weeks you
have a full detailed data and as time
goes by you have less less gresner
data so that's why you don't you're not
spending a lot of money on storing the
actual data but the most recent data is
really accurate so then we use graph
honor to to visualize these metrics this
sort of looks more reasonable if you see
it like this so this is for example
the previous day which is the current
day in number of orders or what the free
disk space at the given point of time is
it constantly growing and so on it's
it's really good to have this because
you can notice strength so the bug that
I mentioned for apache httpclient the
DES is resolution we notice that in this
way we were monitoring the thread
utilization and it was linearly growing
and that didn't seem right the number of
orders was not growing the number of
requests was not growing but the number
of threads was growing so it was very
easy to notice it with the time series
event monitoring if we didn't have that
we would not have found the actual issue
and it would have failed in production
instead of cells being located before
unfortunately the time series event
monitoring is also quite hard and I'll
explain few problems that are quite
common one of these is having seasonal
changes so for example the during the
day for us in our business majority of
Boise happens around 5:00 to 7:00
o'clock after work or it's happening a
lot around the lunch break or early in
the morning or let's say Black Friday is
coming up all of a sudden number of
orders becomes a lot bigger so what is
the actual threshold you want to pick if
you look at the internal health checks
like how many orders is it normal to
help it's very hard to say it's very
hard to have a clear definition of that
you cannot even also have like a
percentage based metric you cannot say
there shouldn't be a drop of 40% because
it could be that 40% drop is something
that's quite normal
so see see seasonal changes are really
are quite painful too for this approach
at least for the business related
metrics or certain metrics like I don't
have this space it's quite easy to
actually determine what what's normal
another problem is that very easy
mistake to do is just by looking at
average
so let's say we have a service that
takes from zero to hundred seconds like
we we have various different codes and
some of them take 45 seconds majority of
them are in the 70 range so they can't
follow a normal distribution so if we
look at the average of rabbit time with
processing time it will be 58 ish for
this distribution which kind of fit the
the real into the reality if it's 58
from majority of users its kind of 58 if
we look at if you look at for example
the median value it's around P 60 which
is also kind of closer to what is the
reality so for normal distribution this
works nicely and maybe things are
following the normal distribution in in
nature but in computer systems things
don't not necessarily follow the normal
distribution and here is an example
let's say we have this distribution
where like across almost cause of the
users are between 0 and 25 seconds and
then another half is in between 19 and
hundred seconds so if you just look at
the averages you're saying you're taking
on average of 50 seconds which is true
but for half of your users you're being
horrible and say much looking at at the
median value you will see that it's it's
around 60 but that again is not
representative so what's the actual fix
for this is having percent of having for
example what the what's the average time
but the time that it takes for the 20%
of the users was the time that it takes
for 50% of the users was the time that
it takes for 90 and for 99 then you have
a more white picture of what actually is
happening within your system and
actually this is a picture from ideal
application that
we have and for a long time we were
monitoring the mean value which was four
point three seconds which was very
acceptable we were planning things to
run on the five seconds and it meant
this is great
in reality though things were not so
great
almost like 10% of even more than 10%
realistically were lot slower than five
five seconds actually both the 10% for
running over 10 seconds
so having percentiles gives you a
slightly better picture of the
distribution as a whole if we take this
to the next level there is a sort of the
future of this time series monitoring
there is a great book called and
normally detecting for monitoring and
it's using machine learning and using
statistical models to detect different
anomalies so the idea is that you have
tons of different metrics and you're
able to use these principles to get
detection of sudden shifts so those
still need to be looked out by by real
person
someone needs to still check ok why did
we had a drop maybe it's because it was
Black Friday yesterday and now today we
have less orders but maybe it was a real
issue so if you if you put this in place
you will try to get these results and
we're it's something that we are
currently experimenting with because
there are so many different metrics we
would like to keep track of this will
allow us in a more easy way to to detect
changes as early as possible so to sum
up is three things it any the region of
the things that I mentioned the
beginning we eliminate the single point
of failure we have a revival crossover
and we monitor things that's all it
takes to help all the nines you ever
wanted
thank you for a diamond I'm not sure we
have time for questions we have time for
a she's great yes
yes yes for database we we have sort of
like a sticky ID on the session so the
so most of the sessions are really we
run with several databases at a given
point of time for a longer period of
time until all the sessions migrated
because you have shortlist data like the
most persistent that I've been involved
it's usually the session is kept for a
week at maximum so then after a week the
old database sort of is useless and you
kill the old database I mean the
database is still RDS it's highly highly
available and replicated and so on but
we use that approach for for dos and and
technically you're going to implement
the same approach even for a long live
data with the other twist that in for
long live data you need to have at some
point a shift of the data like you need
to stop that you need to do the
replication but for our use case because
we have short live sessions we don't
really have to have the migration in
place but there are tons of tools for
AWS and for most of the database
actually that that's all this is
actually usually the commercial tool of
the database but it because it's a easy
thing to get rohnke the replication but
yeah that's a that's the general
approach
yes yes so generally the I mean if you
think about for in your the regular
rolling religious approach the native
base needs to be forward compatible and
backward compatible at all times
so let's say you're getting requests for
version 2 of the application the version
2 database schema needs to be compatible
with version 1 in what sense
it can be additions to fields but it
cannot be removing all fields you cannot
be like running ok migrate the database
you need to model the data in such way
that that it allows this for our case
for example even though we use
relational database we use both great
ideas we model the data in not quite
unstructured way you usually have like I
don't know order ideas key but most of
the data is either kept as JSON blob
internally in the database so that
allows this to be super easy but you can
achieve the same thing with more with
better modeling of the data we just
didn't want to get into the problem of
of the exacting you mentioned that
you're running version 2 which is
incompatible with version 1 which is
actually sometimes easy thing to do we
actually run for some of the servers
like automated tests that check version
1 and version 2 if there is a issue with
the schema so you write an order read
version 2 and you did it with version 1
or the other way around so that we can
you can see that that actually works so
I mean you don't need to have Delta
skinning you just need to have two
instances of your service like you need
to run the old version you need to run
the new version and right with for
example the old one and read is it the
new one and the other way around so if
you do that and you do that in the test
then you're kind of covered the case and
you have to do that not just for the
cannery you need to do that for the
rolling release as well it's the kind of
assumption that you're making with
running the servers in this way you need
to look at all the presenters actually
that that's like I don't know 2050 1999
I would say it's kind of the base
because just by looking at the average
if you like for this case average is 4.3
seconds and it's not really represented
if you look at it it's it's not really
the reality sure the average is for
poetry but it's not great okay I think
we're running out of time but feel free
to catch me up later it's a that's fine
thank you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>