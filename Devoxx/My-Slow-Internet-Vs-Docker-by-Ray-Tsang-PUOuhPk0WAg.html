<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>My Slow Internet Vs Docker by Ray Tsang | Coder Coacher - Coaching Coders</title><meta content="My Slow Internet Vs Docker by Ray Tsang - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>My Slow Internet Vs Docker by Ray Tsang</b></h2><h5 class="post__date">2017-04-18</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/PUOuhPk0WAg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">so I'm gonna get started it's gonna be
oh it's a quickie so it's only about 15
minutes and we gonna go as fast as I can
it's kidding no I try not to but my name
is Ray I'm a developer advocate for the
Google cloud platform and you want here
use the Google cloud before all right
quite a few you don't count urea you
work for google ha but you have any
questions you can contact me on twitter
at Saturn ism and it's not a recording
right it's not recording I can say if
you don't like what I staying here you
can find me on google+ and because
you'll probably never use it I don't use
it either so anyways yeah so what
happened is that I joined Google about
three and a half years ago as a as a
developer relations engineer and then I
became a developer advocate which then I
got to go travel everywhere to kind of
speak about you know our technology and
in a comment with the developer and one
of my biggest a beaut was about two
years ago in 2015 a DevOps Belgium so
that's the DevOps conference in Belgium
with 3,500 attendees and my session has
about four or five hundred people in the
room and that was the biggest moment of
my career right at the time and and
here's the thing i only do live demos i
have i almost never have slides only do
live demos and there's no backup right
there's no backup for my demos all right
if it fails it fails and I need the
internet because I'm showing things on
the cloud and if there's no internet I'm
kind of screwed so let me just
fast-forward like my dumb presentation
until 14 minutes in and I think it's
about 14 minutes and 26 just right here
our new city to see this but it says
network unreachable again this is
probably the biggest moment in my life
in my career in front of 500 people you
know looking at this thing I have no
backup and and look at how like I'm
happy I was I don't know how else to
describe you just yeah this is that
video but luckily my my my my colleague
princess Kim boy he is based in San
Francisco actually he was an audience
and he said what don't worry ray give me
two minutes I'll set you up with the
phone and you can sit there to my phone
and remind you we are all from the US we
are all doing international roaming with
the data plane and I'm doing demos on
docker okay you have no internet and I'm
like okay seriously how do you want me
to go to a doctor demo right downloading
hundreds of megabytes elf images over
your international plan data point right
over this really really slow Wi-Fi on
the on the phone and I was actually able
to do it I actually got through the
entire demo without any issues and then
the question is how did I do it and
that's where a lot of things kind of you
know kind of you know converge together
because I I was moving to New York three
years ago from California I actually
started to prepare for this very moment
right in this conference where I have no
internet okay why do I say that because
when i move to New York I was trying to
find the cheapest place possible right
it's very expensive there somewhere I
guess my cisco is even more expensive
now but it was very expensive so I found
the smallest and cheapest place I can
live in New York City and I found this
awesome place in on the click list this
is the rendering from the post and like
oh wow this looks awesome it's got light
it's got windows it's got blue skies and
everything right but but then I quickly
realized after i visited place this is
only a computer lingering the real place
looks nothing like that in this place is
only about 180 square feet ok how do 80
square feet 1800 meters if you are from
Europe and this is the floor plan of
what it looks like as you can see it 180
square feet you have to meticulously
position all the furnitures otherwise
it's just not gonna feed so here's the
door the door is just right there okay
and there's that the bathroom is
actually a small bathroom by by five
with a bathtub and everything a
whirlpool it's nice and it's a cause
it's big enough to fit everything I
brought with me from California to New
York and the first thing I got for this
place was a 50-inch TV and the TV with
fits perfectly from what wall okay so it
is goes down to the wall it blocks
everything that's how smoke
play it right anyway the sofa bed is
where I can sit and sleep and do work
and in the the the landlord's like hey I
got a mini-suite you do want it like
yeah oh yeah if it's aight i'll take it
so that's what this apartment looks like
now the other thing is this apartment
actually came with free Wi-Fi yay it's
not a plus a month free Wi-Fi but one
thing I didn't realize is how slow the
Wi-Fi it was the landlord was sharing
the Wi-Fi in the story above me in the
floor above me in the Wi-Fi signal only
travel this way right it doesn't really
travel this way so I have really really
slow Wi-Fi in fact it got so bad where
are you sitting in doing my work has
really bad Wi-Fi but the only place
where i can actually get decent single
is by the bathroom ok so i have a toy i
can either stay home and sit by the
bathroom name to work on the toilet all
the time or i can go out to starbucks
and that's not any better either right
and just to put it into perspective how
small these places this is since you're
talking about docker containers right
these are standard container sizes we
got 53 feet for TAC 2 45 feet 40 feet in
20 feet in my apartment fits perfectly
well being a container just like that
that's how big this apartment right I
also travel over the world so I'm oh
it's on the plane I'm always um you know
on the move I'm always on the train and
I do need to do work with container all
the time so what happened in is I
actually have been training myself to
work with container technology with very
very low bandwidth and this is why I
like to share today in terms of what I
learned because if you ever have done a
darker pool you'll quickly realize how
much data is being poured down from the
internet right and if you ever need to
do this in your conference or over the
interlocks or something it's going to
take a while and I was running the older
version of dr. on Mac and they had these
issues so what I almost wanted to do you
know in a coffee shop I had enough with
this what a lot of people don't realize
is that docker actually has two
components there is the doctor client
which is a darker command line that you
use on day-to-day basis you can do
dr. PS blah blah but then there's a
darker demon that's running as a service
right it's usually running on your
computer listening to a UNIX socket file
so the client communicates with the
server the other UNIX socket but what a
lot of people don't realize is we can
actually expose a darker server we are a
public port you can expose the via HTTP
or HTTPS and you can connect to a
securely with certificates basically so
then what I wanted to do was to create
my own darker server that I can host in
the cloud somewhere so that it can do
all the heavy listings of downloading
stuff for me while I connect you with
via my darker client and I saw what's
going down this rabbit hole very quickly
I found wait a second somebody already
done this there's this thing called dr.
machine anyone you stock up machine
before anyone yes you but if you packing
machine you may have been creating a
document in locally but what you can
also do is to create that Commission on
a remote server as well we can create
back on machine in the cloud and see
this video place so i'll show you this
very briefly right so you can do Tucker
machine create soccer the name of the
machine and then the driver you can give
it a different types of driver you can
create it on google cloud you can create
it on you know your own hypervisor or
you can create it on somebody else's
cloud provider and once you do this
right you can go ahead and get your
credentials without cloud provider and
create a document for you automatically
and keeping up to date as well and once
your come once the machine is created
then it's going to be able to configure
your attacker client based on using the
environmental variables right here to
say which IP address do i need to
connect to and how do i connect you to
securely we are the certificate okay so
i suggest of what i have done and the
benefit of it of course is when i'm
doing the darker pool I'm entering the
comment from my client but oh the heavy
lifting is being down on the server side
and I don't have to deal with my local
VMs on my machines anymore because I'm
running your mac to run docker any linux
linux vm it's gotten a lot better but
back then they will just be
machines you know with virtualbox or
something it was really really flaky and
of course I don't have to worry about
the network but that's not entirely true
because as I was adapting to a lot of
these things right to say okay now i got
my doctor running somewhere else I can't
do doctor let me zoom this in a little
bit I can do dr. PS for example this is
actually sending my come in to the
server right dr. Pierce is sending from
my client sending it to the server I
can't do dr. run of course not that one
not that one let me um dr. wrong I don't
know engine X for example ti &amp;amp; dash dash
RM and that will run in gx1 me and is
apparently are really running all right
so I can also do a darker pool openjdk I
don't know seven maybe right again look
up a salad right well it is obviously
fast because oh I'm doing this issue and
come in from my client to the server to
do this now however there are some
tricks to this right as I was adopting
my workflow to this I learned quite a
few tips and tricks and there are some
benefits to doing this if you have a
team for example that ro using docker or
building darker containers rather than
having everybody setting up their own
doctor demon on your own machines or you
could potentially do is to share one
machine that's configured and then you
can very quickly in easily configure
everybody else's machine no matter what
type of architecture they're running up
whether it's Mac Windows or Linux right
doesn't matter anymore because the demon
is running somewhere else so it gets
it's a lot easier to do that the other
thing is when you do a darker boot and
you give you a tag name like I don't
know my app and dot right what this will
actually do is to yes or packaged up
everything in this path in this case
which is the dot well packaged up
everything and send it to the dark a
demon ok so if you have anything that's
in here that you don't need or you don't
want you don't want it to send it over
the wire because otherwise you'll be
much much slower so for example is I'm
building a java application
with maven right I don't stand a target
directory other because if I beauty
locally already if I need to make a
container out of it the trick i do is i
don't stand the binary to my doctor
demon as you send the source code and
you can use something called imbued
images anyone here use unbuilt before
yeah so you can use the amputee image or
you can just send it the source code and
ice the docker container image is being
built it can execute extra butte
commands to actually create the binary
for you right so if I do it this way
then I can send over just the source
code which is very very small and the
demon can then go ahead and download all
the Navin packages for me company now
download all the layers for me and such
okay so that's really useful but the the
neatest thing the linkage trick I
learned is as I needed to get my data to
the server and that getting the data
back right because this is all running
remotely there are two ways to do this
you can either copy the data into your
virtual machine right and then run
docker come in locally and then mounted
volume on the virtual machine to refer
to the data but the blobs are you just
upload it right because the database
actually need to recite with docker
where the server is running but i'm lazy
i don't want to do that every single
time what I quickly found out is every
doctor process right it's just another
process and as a process he actually can
take king st Dieng and STV out this is
again something that a lot of people
don't realize right because in local
commands well you can do is you can say
LS right you can or you can do like fine
right dot and you can do grip for I
don't know Java and you can do account
right so you can pipe the data through
and you can do exactly the same thing
with the doctor demon as well so I
anyone here know deep dream Google deep
drink google DP yeah maybe so this is
like a one of the things that they they
made to let me see if I can find
anything here it's one of the things
that they made to kind of help
researchers to peek into what the
machine learning algorithm is
is doing so for example they're doing
something with the image recognition
right so with this image you can
actually feed it through deep three and
you can kind of see what the machine is
seeing instead right so it's going to
generate this very dreamy pictures based
on just the one image that you give it
now this image however this deep
drinking uses tensorflow and a bunch of
other machine learning stuff and it's
really really hard to run on your local
machine you have to set everything up so
what I wanted to do then is to actually
get this thing running in a docker
container so i don't have to set this
thing up over and over again so in my
container i set up python and bunch of
other utilities in the deep dream source
code and make sure everything compiles
and now i can just run deep dream
directly in the container but what I
also wanted to do was to be able to you
know run this through some images like I
said I can either do it by uploading the
image to the server and run it or I can
actually use the piping so let me just
show you the last demo I'm gonna do you
hear let's go find a picture of the cat
ok let's go destroy some cat advice I'm
gonna go to images let's find the cat
nice a picture of a cat and let me just
go to tools make sure it I have the and
see what it is labor for you reuse with
modification because God destroy all
right which one should we take that
one's cute all right let's do this one
so I'm going to save this file save the
image and gone coach kappa jpg ok then
what i can do is this is fun so i can i
can basically cat the cat no pun
intended right you can't catch a file
right which will send it through the
output stream and i can pipe that output
stream into my docker container as well
and i need to give back the data right
because this is going to sound machine
learning processing is going to look
into what what the machine is seeing so
rather than just getting the image in oh
there's a lot of it rather than just
getting the image in i also need to get
it the image out again i can do this
just by SCP or ssh but this is a lot
more convenient because i can not
let me show you the command line again
no I don't have it here what i can do is
i can pipe the data in and then I always
okay i can get the STD out and can
direct that string into basically into a
file if i want to so it's a very very
convenient way for me to work with dr.
in dr. machines especially in the
context where i need to have a very low
bandwidth usage is on my side and that
the machine the clouds doing the heavy
lifting and and i can actually just you
know use this deep command lines as it
was directly on my own machine so thank
you very much for your time and if we
have if this actually finishes in there
this if it finishes let me open up the
output and there's a cat that just got
be trained so thank you very much for
your time</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>