<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Functional Sudoku Solver by Cesar Tron-Lozai | Coder Coacher - Coaching Coders</title><meta content="Functional Sudoku Solver by Cesar Tron-Lozai - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Functional Sudoku Solver by Cesar Tron-Lozai</b></h2><h5 class="post__date">2017-05-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/mx8S_b5pQNw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Birgit inflated do it make sure okay so
let's start because there's not a lot of
time so hello everyone so today we're
going to solve Sudoku in scar so I
apologize in advance is going to be fast
because there's a lot to go through in
15 minutes so just a quick introduction
what we're going to do today we're going
to solve Sudoku with using function
programming in Scala hopefully have a
bit of fun and learn something I'm not a
scale expert it's just a hobby song
don't judge me
the original idea was from Scala meetup
in London it's not meant to be a
solution to sort of the group at all and
it does not solve the hard grades that
requires backtracking so I'm sure most
people are familiar with Sudoku ball
still you know summarize you have a nine
by nine grades and you have to fill it
with numbers from one to nine and
there's only three rules the first tool
is that in each role you need to have
all of the number for one two nine
exactly once and it's the same with
columns and the squares as well the nine
squares so before we can actually solve
the solution I need to there's no
requirement for Scala in this talk so I
need to teach you the building blocks
that we're going to be using so the
first one is the case case class so if I
run read this quote I found it's a
regular regular classes which export the
constructor parameters and which provide
a recursive decomposition mechanism via
pattern matching so a bit complex the so
let's see let's use an example so if we
have a trade which is like an interface
in Java and then I'm going to be
defining my cases for that class so you
can think it as a bit of a lucky known
for classes so if I have a shape I can
have two types of shape I can have a
circle and rectangle and you can see
here the constructor bit that I just say
I just put the parameter D inside and it
will tragically create a constructor
getter no setters because everything is
immutable and now I can use the pattern
matching so if I define a method that
takes a shape and I want to do something
depending if it's a depending on the
shape I can do this do a shape match and
then I can have two cases either a
circle and a rectangle so here's our
other things to notice first this is a
bit like a lambda in Java because I'm
when I'm doing circle D I'm actually
creating a lambda with this value the
Ender I can do something with it and
also listening to realize that there's
no return statement in Scala because the
last line is the written statement so
here I'm returning that and
returning the string so if I create two
circles that two shapes one second one
rectangle if I call the shape print
method I'm going to get the circle and a
rectangle so that's useful then next
thing I'm going to use a lot is the
vector librarians car so it's a bit of a
magic library because you have a lot of
library and collection mutterings color
for immutable immutable and the vector
is easy effective constant time across
all the operations so it's fast it works
well you just use it it's this for free
so this is something that we're all
familiar with maybe with the July it
streams API so for instance you can have
a filter function so if you take a
vector of type a and you have a
predicate which is a function of a two
boolean he returns a new vector and is
only going to keep the elements on that
vector that match the predicate so if I
have a vector one two three
I call filter and I check for the number
two the even I'm only going to get
victor - that's as you would expect the
map operator as well you might be
familiar with the stream in Java so if I
have a vector of a I can create the
vector of B by using a function from A
to B so here in this case since I has
vector 1 2 3 I give it a function
alarmed at those times 2 I'm going to
get vector 2 4 6 here I'm not changing
the type just special case we have the
flood map so I think for all those
people confused math and flat map so the
differences in the signature the in map
the function goes from A to B flat map
the function goes from a to vector of B
or if it was a stream from a to stream
of the if it was an option and actually
it's true for every monad that's another
story so if I have a vector 1 2 3 and I
had a function that returns from X which
turns a vector if I were just to calm a
point I will have a vector of vector but
this method will flatten everything and
I'm just going to get the vector 1 1 2 2
3 3 so this the next one is the group
operator and it's going to be very
useful for us later so basically what it
does it's a it's a chopping operator so
Sudoku is the matrix so I'm going to
model the matrix as a vector of roles I
could have model it as a vector of
columns it's completely arbitrary choice
so imagine in this example have a
smaller matrix 4 by 4 and I'm going to
define it I have my my rows 1 2 4 5 etc
and my matrix is my vector
that's a sector of a job int so if I
call the operator grouped by two in
basically going to chop that matrix into
two and I'm going to get two matrices
the first half and the bottom half and
why we need it is because in as I
mentioned industry rules one of those
works on squares so I will need to
access all of the numbers in one square
so we can do this little trick and we're
going to be using a bit like a binary
search so imagine I number my squares
from zero to one on each side and I want
to access one square so let's say I want
to Inc access row index 1 and column
index 0 so this one so in my binary
search I start I take my matrix I chop
it into and then here and then I'm only
I'm going to choose the half that I want
so here I want this half so I chuck the
first half and now I want to cut the
other way so I'm going to be cutting the
other side I'm using slack map so I'm
going to take each row so this one and
this one the row I'm going to group I'm
going to take the row group it and then
select the one I bit I want so in this
case I'm going to get 9 10 13 14 because
it's a flat map everything gets
flattened and I'm getting one vector 9
10 13 14 so it's just a bit of a nice
way to get the disk where's another
thing that's useful in Scala is tuples
very easy if you want to return more
than one thing you just put them in
bracket and then you can really easy
access the elements using underscore one
two three four five seven and circuit
element etc etc another interesting
approach was always sleep with index so
if I have a vector of any single type a
a zip with index I'm going to get a
vector of top full of a and int into the
position of the element in the vector so
here if I have ABC I'm going to get a 0
B 1 C 2 the last thing I want to talk
about is the transpose of process and we
might define a gender in the math so if
you have a matrix 1 2 it becomes a 2 1
if it's a square matrix you flip the
matrix around the diagonal but in our
example lyrium so I've said I model the
matrix as a list of rows but what if I
wanted a list of columns which I just
transpose what I'm getting so if I have
a vector let's say with 3 rows 1 2 3 4 5
6 if I transpose I'm going to get 1 3 5
2 4 6 which is basically a view of the
columns so I'm going to be using that
later so now we have all of the glueten
blocks we can start
solving the solution and we start by
doing a data modelling so pseudo ku is a
matrix of cells so what's the cell we're
going to create a straight cell and use
our case classes and we only have two
options either I know the number in that
cell in this case it's a fixed cell or I
don't really know and so I'm going to
call that an undetermined and a six cell
has a attribute which is the number I
know and the end a timing has a value a
list of values which are the possible
number in that cell so when I'm going to
start my problem when I'm going to pass
my my problem as a stage V for instance
I'm going to create the six cell when I
have a number and I'm going to create an
undetermined cell with all of the
possible values from 1 to 9 otherwise
and then my problem is going to be a
vector of vector of cell so I'm going to
create them a pseudo class which is
going to have one attribute a grid a
vector a vector of cell and I said
Sudoku my three rules so I'm going to
implement three methods the first method
is is its value is a value allowed in a
row in the column in square and the
signature is what I'm going to give you
the position so it's at a pole the first
one would be my row index then is going
to be my column index and then it's
going to give I'm going to test for
specific value can I put a 5 in that
square and it's going to return boolean
true or false depending if I can do it
so let's get started with the Rolo jig
so how do I know in Sudoku if I can put
a specific number in a row well I can do
it if it's not been used already in in
the row so what I do is I take my grid
using position underscore one I select
the row that I'm interested and then I
just check it does contain six value and
here one of the smartest of smart things
of color is that it will do pattern
matching behind-the-scene innies can
check if it contains a type of fixed so
and then I just use the negation if it
doesn't contain a number in the row I
can do it it's very similar for the
column logic but no but I need to access
the column well we know how to do that
we have the transpose so I take my my
matrix a transpose it so now I have a
list of sector of columns so I can
select my column using the underscore
two of the position and I just check if
it contains the six value the square is
a bit more complex that we've already
down the work with this chopping with a
group so first I need to get the
Square index this time from zero to two
by dividing by three the basically
creating division so I take my grid chop
it into three making up my burden
research then I'm selecting the band
that I want then all of the rows in that
band I use a flat map I chop all of the
columns I get the one to be that I want
and then I flatten everything and this
is going to give me a normal vector with
all of the values and that's in that
cell and I just check if it contains a
value now to make it a bit easier I'm
going to make just one method that's
good but this kind of rap everything is
going to this method call is value
allowed it's just going to call all of
the three methods in a row I now believe
it or not there's only one slide left
for the solution and that's the rest of
the code so I'm going to be explaining
that so this is a method of the class to
Doku so remember in scala we tend we
like to do everything immutable so this
and this class is going to have a method
called filter which is going to return a
new super cool and hopefully this new
could be progressed I'm going to have
make some progress
so how do I do it well first I have only
one thing in the class of my grade so I
take my grid so remember that all of the
positions so all of the methods I have
for the rules they take this position so
I need to have my row index and my
column index so I'm going to do this by
using this zip with index so I take my
grid as I put index now I get a vector
of tuples with a row and my row index so
now I take my row and I zip is indexed
again and now when I do a map this time
I can access the column index and when I
look at my cell so now I have a
basically I have a vector of cells with
all my position I what I want to do so
when I know ready the number is nothing
for me to do welcome to stop but when I
find an undetermined cell what I want to
do is I want to replace it by another
index I'm in cell which contains less
value so if I reduce my problem
statement so that's what I'm doing here
remember there is no return statement
because we in Scala
so if I have an undetermined cell values
I'm returning a new on that time in cell
but I take the old values and I'm
filtering it and I'm passing my
predicate which is my Israeli alert
function with all the time eaters and
this is going to reduce all the possible
values in that place and this is
basically a catch-all you know if I have
any
engages return the same so this is going
to reduce reduce my values and but I'm
going to reach a point where I might
find some entertainment values that have
a size of 1 so I can do a case and
pattern matching with a god if this is
the case then I can transform it into a
6 and that will allow my problem my
problem to progress and that again this
is the kernel because this is a
recursive function so if my filtered
grid is the same as my grid it means I
didn't make any progress for two reason
either I've solved the Sudoku or it was
a Sudoku that cannot be solved by logic
you means you need you need to do
backtracking so it means I just are just
returned as to the coup otherwise I
return a new Sudoku and I call
recursively the filtered method again so
that's it I don't know how I'm doing
with time but you can check the code in
github it's tested against 100 example
simple Sudokus I have five minute oh I
went Saturday so I apologize for that I
couldn't see the time so there's a bit
more of a other you know passing the CSV
and a Harrow handling and things like
that so I have time to take questions
which I was not expecting I can I can
bring back another slide if people once
because it was which slides you want to
watch to see you again I think that's
the most interesting slide
yep yes because so the question is are
there some Sudoku they are not solvable
yes because most of the hardest Sudoku
you cannot solve them by logic so this
is called a CSP a constraint
satisfaction problem which you can
reduce using logic you know you by using
instruments between the cells but you
reach the point where you cannot make
any logical guesses so you can metal
ecological in inference you need to make
a guess try it and then you need to
backtrack so a bit of a weird I've wrote
a lot of pseudo clues and one hour could
solve everything with something like
that and then you couple it with a
search algorithm and then you have to
find a heuristic to you know you know
when you make a guess where do you make
a guess or maybe you make a guess you
know in a place when you have the least
number of choices or then you can find
also a place that has the most
constraints so you can terminate your
problem early if you made a mistake yeah
yeah
what well in this case it would just be
you know it would just be like the next
iteration but I mean I mean depends if
it's a case that you get that you can
solve a logical line I mean as a human
if you can solve it by not taking any
guess then this can solve it I don't
know if I really answering a question
in one in one step like you can you can
it can set a value on a row and another
one on the third row if it can detect
yeah that's me feel so basically if you
so if you kind of build like a big tree
for this problem of constraints you
might have independent trees in each one
like these cells you know in this part
of the Sudoku you can make a guess you
don't need the other one so you can make
these guesses and the next round they
would be available for people the need
for other cells I need this now it would
be communicant to more than one at the
beginning probably gonna you know if
it's just maybe a hard one it will make
one and another one and then towards the
end the more the more you feel them the
more options you live okay I don't know
how much time there is left one minute
so one last question maybe so I go back
to the slide I went too fast on which is
probably more slide alright thank you
very much</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>