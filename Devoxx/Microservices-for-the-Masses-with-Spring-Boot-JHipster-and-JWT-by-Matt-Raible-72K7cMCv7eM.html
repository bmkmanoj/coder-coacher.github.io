<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-114897551-4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-114897551-4');
</script><script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5ac2443d1fff98001395ab6c&amp;product=sticky-share-buttons" async="async"></script><title>Microservices for the Masses with Spring Boot, JHipster, and JWT by Matt Raible | Coder Coacher - Coaching Coders</title><meta content="Microservices for the Masses with Spring Boot, JHipster, and JWT by Matt Raible - All technical stuff in one place" name="description"><meta name="keywords" content="education, coding, programming, technology, nodejs, mongodb, software, computer science, engineering, teaching, coaching, coder, learning, java, kotlin, machine learning, AI, ML, tech talks, angular, javascript, js, typescript"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/css/font.css"><link rel="stylesheet" href="/css/bootstrap.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/coder-coacher.css"></head><body><div class="container-fluid"><h1 class="site-title"><a href="/">Coder Coacher</a></h1><hr><h4 class="site-subtitle text-right">Coaching Coders</h4></div><div id="amzn-assoc-ad-99d6751e-2392-4004-ad16-73aa8385d9d0"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=99d6751e-2392-4004-ad16-73aa8385d9d0"></script><div class="post__breadcrumb"><div class="container"><ol class="breadcrumb"><li><a href="/">Coder Coacher</a></li><li><a href="/Devoxx/">Devoxx</a></li><li class="active">â¤µ</li></ol></div></div><h2 class="post__title"><b>Microservices for the Masses with Spring Boot, JHipster, and JWT by Matt Raible</b></h2><h5 class="post__date">2017-05-17</h5><div class="container"><div class="video-responsive"><iframe width="560" height="315" src="https://www.youtube.com/embed/72K7cMCv7eM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div><div class="post__text">Birgit you play kid do it make sure
welcome everyone today we're going to
talk about microservices their history
how to create them and communicate
between them but first let's learn a
little more about each other
my name is mater Abel I'm a hick from
the sticks I grew up in the backwoods of
Montana for 16 years with no electricity
and no running water true story it's
funny I'm a computer guy now we used to
actually have to heat up the stove in my
parents cabin which was their bedroom to
warm up the monitor and then start the
generator and then get the Commodore 64
going and then you could connect right
over 300 baud modem to the Internet so
even though we were out there my dad
still had byte magazine coming in and he
was in the computer so I ended up in
computers as well I've lived in Denver
since 1992 and I like to scale like the
mountain bike and I love good beer and
I'm very happy to be here so what about
you how many people are using micro
services right now okay it's about 50%
of the room how many people are using
Java EE for that that's six people how
many people are use in spring boot okay
that's about 40% of the room anyone
using it with Eureka okay a couple of
you and anyone using J hipster we got
one all right two three
all right the goal by the end of this is
two more will be motivated to try it
anyone doing dotnet programming nope
Python I got one too okay
I'm anyone using a Java 8 and loggin a
couple of you anyone using Scala and log
them same people they're like yeah we
use both
what about drop Wizard two three okay
anyone using vertex the Mike services
three or four okay so micro services
it's a funny story too interesting
history it actually was first used as a
common architecture term
at a workshop of software architects
near Venice in May 2011 and in May 2012
the same group decided micro-services
was a more appropriate name so they
changed it for micro service - micro
service says right they pluralized it
took them a year to do that but that's
the definition from Wikipedia the most
interesting thing is the term micro Web
Services was first used at a cloud
computing Expo in 2005 dr. Peter Rogers
and Zhu valori had similar precursors
ideas he worked at Microsoft about
classes being granular services as the
next evolution of Microsoft architecture
in 2007 so this has been around for 10
years and he basically said services are
composed using unix-like pipelines the
web meets unix or true loose coupling
services can call services you can have
multiple language runtimes complex
service assemblies are abstracted behind
simple URI interface
any service at any granularity can be
exposed so that sounds very similar to
our current definition of micro services
it just wasn't really given a lot of
credit you know in the general
mainstream and that's because of these
guys so on the Left we have James Lewis
top left then we have Martin Fowler and
Adrian Cockroft
and Joe long so James Lewis presented
some of the ideas behind micro services
in 2012 at the 33rd degree conference in
Krakow his talk was called micro
services java the unix way and Fred
George is credited with sharing similar
ideas and then Adrian Cocteau craft
who's at Netflix
described the architecture as
fine-grained SOA and so he's the one who
pioneered kind of the style that web
scale and basically they created a lot
of open source projects at Netflix that
spring cloud wraps to make you know it
easier for spring developers and so then
the real definitive article didn't come
out until March 25th 2014
when Martin Fowler and James Lewis wrote
the title just simply micro-services and
years later this is still considered
write the definitive guide for micro
services and so in that he talks about
you know how technologies have been
traditionally organized in technology
layers right you have your DBAs you
your testers you have your production
people now their DevOps right and when
teams are separated along these lines
even simple changes can lead to cross
team project taking time and budgetary
approval it's just difficult right to
get it through each stage into
production and so a small team will
optimize around this and choose the
lesser of two evils forcing the logic
into whichever application they have
access to so that's where you get DBAs
you know doing stored procedures that's
where you get java people saying we're
not doing anything in the database we do
it all in code right and so this is kind
of lead to difficulties with teams and
so it's an example of Conway's law in
action and Conway's law is any
organization that designs a system
defined broadly will produce a design
whose structure is a copy of the
organization's communication structure
so one of the things that's interesting
here is what they're saying is if you
have very segmented teams that do one
function like UI developers back-end
developers then chances are that's how
your architecture is going to evolve but
if you have teams around products right
like the store write or the blog or
whatever it might be then chances are
you're going to have DBAs on there you
can have project managers on there you
can have DevOps people and then you can
have this micro services architecture
where your code is separate from
everyone else's and it communicates
through these URI interfaces so the
philosophy of a micro services
architecture essentially is similar to
the UNIX philosophy of do one thing and
do it well it's easier to work on small
do one thing services and no single
program represents the whole application
so as long as the services use a
lightweight agnostic protocol for
instance HTTP or a think messaging then
applications can be written in anything
Java Ruby node go whatever and the
platform is and service providers right
have made it really easy to deploy Micra
services it wasn't always this easy so
all the technologies needed to support a
monolith such as load balancing and
discovery and process monitoring are
provided by the path outside of your
container so not only for monolith but
for you know micro services and the
deployment effort becomes zero right now
that we have docker and kubernetes and
stuff like that it's very easy for us to
move
you know from one cluster to another and
deploy all these micro services so the
question is our micro service is the
future and I think architecture
decisions are usually only evident
several years later after you make them
and so micro services have been
successful at companies like LinkedIn
Twitter Facebook Amazon and Netflix
right so that doesn't mean they'll be
successful your organization just
because they've been successful at these
organizations because component
boundaries are hard to define so if
you're not able to create your
components cleanly you're just shifting
the complexity from inside your
application to a distributed environment
and you're putting it on the network and
also team capability is something to
consider so if you have a poor team now
you'll always create a poor system so
hire well so you shouldn't start with
the micro services architecture instead
begin with the monolith keep it simple
and split it into microcircuits once the
monolith becomes a problem and when I
worked at LinkedIn in 2007 and 2008 we
had this monolith that was very big and
it basically I remember starting all the
jetty services they had to run in the
back end there was 63 of them and then
you had to start the web app which was
its own app and he used ant to build and
it was modular code base but it all
ended up in the same war and it took 20
minutes to build right and the cool
thing was we all got Mac Pro's right but
the unfortunate part was when four of us
were in a small room using them it got
hot in there right because everyone was
running and you make one mistake and you
got to rebuild everything I was terrible
we tried to SDI to solve the problem I
didn't work you know it's funny one of
the lead architects actually had a
moment of clarity in the shower one
morning and realized that hey you can
run parallel tasks than ant right knee
got the build down to like four minutes
and then we didn't care anymore now it's
a very much micro-services architecture
at LinkedIn they have hundreds of Play
Framework apps they have hundreds of
node apps and they've really you know
it's taken them ten years to get there
but it's very much a lot of to scale and
the biggest reason obviously is because
of people like it's really hard to have
a hundred people working on the same
code
so if you split it into micro-service
then it's easy for five or ten people to
work on their component and not have
conflicts when they're committed code so
if you have a mana list and you want to
migrate microservices you should
definitely check out spring but-- it's
project that simplifies spring
configuration and you know it makes it
so a lot of the configuration law that
xml doesn't exist anymore
it still has annotation health but
that's better than xml health and allows
you to create highly configurable
applications that deploy easily and
don't just take my word for it if you
look at this report from last year 2016
october 250% growth year over year and
it's continuing so a lot of people are
jumping on the bandwagon i think a lot
of reason is because they were already
developing the spring and they kind of
want to move to a more modern things and
what they find out is they can delete a
lot of code so that makes sense so i
like to say that sales of spring boots
skyrocketed 2016 so it's kind of become
the on-off switch of enterprise java
everyone's using it loves it or at least
a lot of spring developers are you can
create standalone spring applications
you can embed tomcat jetty or undertow
and you have all these pre-configured
starter poms so one of the issues you
might have when you get into spring boot
is they named all these starters -
starter right it's like JPA starter it's
a you know MongoDB starter and you're
like why do they call it a starter and
it's debate so because it just
configures the dependencies for you so
instead of you having to specify hybrid
a and entitymanager and all these other
things you can just specify one and it
folds in those dependencies so it makes
your palms pretty small nice and compact
and then it's got maven or Gradle
support and it's also got this thing
called dev tools which allows you to
basically restart your application if
you just compile a single class it'll
restart it for you and works pretty well
some of the times I seem to have this
strange problem when I do demos like 1
out of 2 times that dev tools will just
restart and restart and restart and I
can never reproduce it after a demo so
maybe I have something to do with like a
projector plugged in or something but so
as Josh Long likes to say start that
spring dial is one of the happiest
places on the internet and I agree with
them because if you're a developer and
you're at this site chances are you're
doing a cool demo like this one or
you're actually starting an
project you're not doing greenfield
development right that's a really nice
place to be as a developer so you go to
start dead spring do and you basically
specify whether you want a maven or a
Gradle project and then you specify the
version of spring boot you can type in
your coordinates for your project
metadata and then you pick the things
you want to pick so in this example I
have dev tools I have h2 for an
in-memory database JP a rest
repositories which allows me to take my
JP repositories and expose them as rest
endpoints and then spring MVC so I
started my first real job last September
for 20 years I was men fended consultant
I work for storm path as a Java
consultant writing code for the Java SDK
and after working there for a couple of
months a few months I really got to like
the people a lot and they basically
talked me into taking a full-time job so
now I'm like most people I have a
full-time job but the cool thing is I
get paid to do stuff like this right and
store path basically has an API in the
cloud that you talk to for doing
authentication so you embed the code
into your project and if using spring
boot it's three lines of a dependency
for maven and then boom you're up and
running and it's got login screens it's
got forgot password all that and then it
talks to the cloud to authenticate you
so it makes it really easy for a
developer so storm passed microservices
implementation is based largely on
Cassandra and Kafka what we found was
with HTTP it was blocking and it's a
blocking protocol so it would just
didn't scale well for 100 million API
requests a month and so we moved to
Kafka and then used Sansa for real-time
processing and then zookeeper to
coordinated all in elasticsearch was a
big part of our architecture as well and
so everything was served up by spring
but-- we've been using spring since day
one and we had to rewrite a lot of the
Sansa to work with Kafka
but you know it works nice and what we
were able to do is we were able to take
the learnings from that migration to
spring boot and actually create a
starter so you could use Sansa with
Kafka instead of zookeeper and so
there's an open source project out there
you can go use it and
that doing you know five tedious steps
to get started with Sansa you can now
get started with just the spring boot
starter so octa is the company I work
for now so it's funny you take a
full-time job and then six months later
you work for a new company it's kind of
like consulting so it was easy for me to
transition to the new company so octaves
the new company we joined forces with
them in February and we did that so we
can move faster basically they created
an API a year ago we created an API five
years ago we really know developers well
we know how to create tool form and they
said we need your help so now we're on
the same team so they still provide an
API service that allows developers to
create that user accounts all that in
the cloud and it makes user account
management a lot easier and more secure
and infinitely scalable so before that
though we migrated our back-end at storm
path to spring boot and it was a lot of
just deleting xml right and putting it
into java config classes it really made
it really easy because we were able to
you know put our config files in one
place and know how they looked up and
all the auto configuration stuff so the
cool thing is we were able to take this
high traffic site you know 100 million
API calls a month and basically migrated
in three weeks so if you're already
using spring and you're not using spring
boot shouldn't be hard to migrate to a
system that uses spring boot what we
discovered in the process that micro
services are awesome but they're not
free so it requires a lot of
organizational changes and the biggest
thing it requires is automation so you
have to think of products right for each
micro services not projects which is
like hey we're going to you know build
this by the end of the year and so just
to show you some code from a spring boot
example this is how you would create a
simple rest repository so if you're
using Lombok you wouldn't even need that
comment that says getters and setters
and to string you could just add a you
know annotation that says data at the
top and then you basically in ten lines
of code you have a rest endpoint with
spring boots so it makes it very easy to
demo right it's awesome for demos
because you just write a little bit of
code and there you got a rest endpoint
but once you have a rest endpoint like
this what it's going to do is it's going
to publish that at flash blogs because
it takes the entity name and it
PluralEyes is it
and then it has paging and sorting in
there you might want to put some data in
it so if you want to do that you could
do a command line runner and then you
basically override the run method and
you can take you know a stream of
objects and create new blogs essentially
and then print them out so all that's
pretty simple I didn't feel like you
know getting out of the presentation and
showing you a demo because I think most
of you have seen that but I will look at
the code and I will show it when I get
to the demo part so as far as the micro
services architecture with spring but--
it's a little bit different you'll use
spring cloud and like i said spring
cloud wraps a lot of these open-source
libraries that do monitoring and do
service discovery and circuit breakers
and intelligent routing and client-side
load balancing and does that for you so
spring cloud netflix is the OSS
integration for spring boot apps and it
has auto configuration in there so the
service discovery is provided by eureka
on the service breaker or the circuit
breaker is histor --ax and then
intelligent routing is from Zul and then
client-side load balancing is from
ribbon and so one of the demos that I
have today I don't know if I'll be able
to go into all the code but I think it's
a pretty cool concept so how many people
are at the securing micro services
session that kate did just in the last
session a few of you so we talked about
or they talked about JW TS in that
session and this architecture uses the
same thing so you'll make rest calls
from a browser from a phone it'll hit an
edge service and that edge service will
be secured by spring security that's
what those little icons are those little
shields and so what we've done both its
storm path and at octa is made it so all
you really have to do is integrate
spring security and drop in our
dependency and then you set some
environment variables to say here's my
application you know here's my
development instance and then you're up
and running so the cool thing is if you
can configure spring security to secure
different endpoints then you're securing
the same thing you know with octave so
all we're providing is the users
essentially so we're like your user
memory and then you can create groups
and all that and spring security
recognizes all that and reads it
so there's another project in here
that's kind of small this little juicer
guy right looks like an orange there so
that is a new project that we released
as 1.0 basically two weeks ago and
that's created by les Hazelwood the CTO
of former CTO storm paths and he
basically created this project that's
really cool you can take a jot JWT the
abbreviation jot is actually in the spec
and you can take a jot and you can put
this juicer library into your project
and it'll take that job from a Zul
project or a Zul exported user header
and create a spring security user object
so what that means is you can have
things like catalog service that is
actually a service that's not exposed to
the endpoint but it's still secured with
JW TS and that service can still know
who the user is so one of the common
patterns I've seen is to use something
like this the spring security at the
edge service but then not caring about
the communication between the edge
service and the catalog service for
instance because it's behind the
firewall so this is a way of basically
showing you that you can use jobs and
that catalog service doesn't have to
talk back to octa it can if it want but
basically use public private key pairs
to say hey here's a JWT I'm going to put
an X forwarded user header and then this
JUSA library takes it out of the header
creates a spring security object and
you're authenticated so if you don't go
through that route then what's going to
happen is basically access tonight right
because it doesn't accept any old login
on it only accepts that exported user
header so you can secure your API but
the most important thing to you is
obviously TLS used to be called SSL
right transport security layer and
that's the number one thing and even
chrome in the next year is going to
start like warning big time about non
HTTP site and there could even be a drop
in your ranking very soon it's already
happening for mobile so if you're
developing a customer facing application
definitely consider that and with let's
encrypt you can get a certificate for
free so why not right everyone should be
using SSL or TLS so a lot - is one of
the most popular authorization framework
allows the third-party application to
obtain limited information about its
owner and orc state an approval you know
between the interaction and HTTP service
so it obsoletes the off low auth 1.0
protocol but there's also Open ID
Connect that's built on top of that and
that's one that Google is using a lot
and they're championing a lot so their
API supports it if you're doing social
login one of the things that we do at
octa is you can use social login like
Facebook Google you know github but
instead of you configuring have to worry
about that you just set it up in your
aqua instance and then your users get it
as another button on their login form so
another thing to consider is API keys
versus username password authentication
API keys are usually a little better but
you have to store them securely so make
sure whatever directory they're in or
however you're storing them make sure
there's a lock down another good idea
that they discussed in the last session
was using just your HTTPS certificate
right it has a private key and it has a
public key so you can use that to sign
your jots and then the public key to
decrypt it and then make sure you use
global unique IDs and avoid sessions
especially in URLs so jot here's how
they look they basically have a header
and then they have a body and then they
have the signature and so it's a secure
and trustworthy standard for token
authentication and they allows you to
digitally sign information which is
often called claims with the signature
and can be verified at a later time with
a secret signing key so one of the
problems that typically happens with
OAuth 2 is up to all it has to do is
return a token right it's just a random
string but the cool thing is is so is
JWT s but it's not just random there's
actually more information in there right
so instead of just being a random string
that's you know verified you can
actually parse it you can look at the
expired time you can look at if it's not
good before this date and the JWT
library is out there will actually blow
up if any of its just not matching or if
the signature doesn't match so the
claims tell you a Tamilian at a minimum
who this person is
with the URI to the the resource is from
and what the person can access with
their token and when the token expires
so you usually add a short-lived tokens
for access to
and then you have refresh tokens that
are maybe longer lived like 30 days and
access tokens or 2 hours or 12 hours and
so to create a shot in Java this is from
the Java JWT library also created by les
Hazelwood of storm paths we run that
project and he's also the Apache Shiro
guy so he's been into security for 10
years he's done great things for Java so
this is how you would create a new shot
and you can see we're setting the date
that we're setting the name and scope
and then we're signing with a signature
algorithm and the worst key you can use
ever this is what 90% of the examples
out there use though secret a word that
you can easily memorize and it doesn't
even fill up a chess 256 close all right
so this is like one of the worst anna
patterns in jocks never use a key that
you can remember easily should be a long
random string it should fill up whatever
that algorithm is and make sure it's big
and then to validate a JWT you get you
know from the authorization header for
instance and you parse it you set the
signing key again another bad example
and then you get the body and you can
see you know what scopes are in what
groups they're in things of that sort so
never make a human readable word as your
secret on six bytes long is terrible and
it's you know code smell to have human
readable and if you ever see get bytes
on the string that's also kind of a code
smell so a better secret would be some
sort of base64 encoded secret and then
you sign it with that and it's at least
a little bit bigger so spring boot is
pretty hip and so are microservices and
jot but what about the UI the other hop
framework out there not only you know
react in view but angular and would it
be hit with some one combined all these
right and made a framework that you know
put them together and maybe use
something like bootstrap in there
because that's cool too so J hipster
actually did that so Julian Dubois and
October 2013 created this J hipster
project which basically is an
application generator and once you
actually have used angular and
you spring boo and you've used maven or
Gradle and you figured out how all these
work together you never want to do it
again right here like that project is
great I'm going to keep that one in my
Dropbox and every time I move to a new
client I'm going to look at that project
and see how we did it there well the J
hipster you don't have to do it because
it generates a project for you and it
has like all those best practices in
there so I worked for two years as an
independent consultant and knew about J
hipster and wrote a book on it and
everything
but I never used it at a client because
basically why would they hire me if they
just used a hipster right because it
could do all the work that I do but I
used it as an example of everything so
when they were like how do we do this I
would show them right you generate a new
project here's how you find out how to
do that so a very good reference on how
to do things and so at its core it's
just a yeoman generator right it's one
of these projects that just generates
other project but it's becoming more of
a platform because we're getting into
micro services and we can generate micro
services now so just Jay hipster by the
numbers the reason I really like it as
an open-source project and it's not
really controlled by one company the
only person you can buy a license for J
hipster from is me I'll tell you
whatever you want you can pay me lots of
money then I'll support it you know 24
by 7 kind of thing now I actually met a
guy in Atlanta months ago two months ago
that he couldn't use J hipster because
this company couldn't buy a support
license so I told them I'll sell you one
so it's very much 250 contributors all
over the world upon does put a lot of
developers on it and it's great because
they'll bring new developers onto their
company and then train them as J hipster
developers and then after a while they
become you know part of the organization
but there's no one that like you know
manages the project from a company
perspective 6,800 github stars four
hundred eighty thousand installations
from NPM since we created it and there's
150 companies officially using it all
the way from Google and Heroku to others
so a lot of people are using it you
install it with MPM install - G
generator J hipster then you make a
directory CD into it and you run yo J
hipster the number one mistake you're
going to make is
not creating a directory and seeding
into it you're going to run yo J hipster
in your home directory and you're going
to have all kinds of dot files that get
put in there so don't do that we've
tried to actually put prompts when we
create a project to say here's where
it's going to be created so you notice
that but it still happens every once in
a while so that's a little bit different
from like maven archetypes we're used to
creating a project it creates a
directory for us similar with angular
CLI Allah created directory for us yo
does not so make sure you remember that
so it generates the spring root
application and generates an angular
application generates liquid a change
log files which basically allows it to
create your database schema for you but
the cool thing is you can actually
modify like an entity add a new field
and run a maven or Gradle to man
whatever build system you're using and
it will generate a change log file that
adds that column to your database so you
can do refactoring of your entities and
of your system that way and then for
security there's login logout forgot
password account management user
management and it's useful for most
applications so you might have to go
there and tweak some stuff and you know
chances are if you create a brand new
application with it and you don't tweak
anything you don't add a new bootstrap
theme or anything like it's going to be
kind of boilerplate right and people
that know Jacobs are going to be like
you didn't even try right because it
just generates crud screens for you so
obviously that's not going to be the end
user functionality you want to put out
there but it's a great start and it kind
of gets you out of that boilerplate
coding so good examples of working
screens forms directives validation all
that from you know angular it's got
monitoring health monitoring very useful
in production and then like I said the
liquid base change files so pretty nice
but also with with Version three which
has been out a year now we allow you to
develop micro-services so you can see
here that we're leveraging you know
docker and spring and Netflix and
basically we have a registry that's
driven by Eureka on the left there you
can also use hash a corpse console if
you want and then there's a gateway and
that gateway basically can have entities
and can have a database associated with
it or it can just be your API management
gateway and that uses ool to proxy the
requests to the micro services in the
backend so you can have one too many
micro
services or you can have you know some
services on that gateway if you generate
code for your micro services on the back
end you're still going to want to UI for
it so you'll generate that on the front
end and I'll show you how to do that and
then you can use the elk stack elastic
log stash and Cabana to actually monitor
your application and see how it's
performing so this is what it looks like
when you generate an application and
basically you get prompted whether you
want to do a Mike monolith or a micro
service so let's see what that looks
like
there we can see it okay you need a
bigger in the back speak now or forever
hold your peace
all right so because of angular 4 and
because of webpack things actually take
longer to build on the client side now
than on the server side so we've come
full circle now and and you can get more
coffee breaks and stuff like that so
that's a good thing so if you see here I
have I have three windows this first one
is the J hipstery registry so that's the
Eureka server that you're going to need
to have running for any services to talk
to so you'll notice the difference
between the angularjs version and the
angular 4 version angularjs basically
takes just Java files and doesn't
compile them into anything right it can
optimize them right and concatenate them
together and stuff like that but it
doesn't generate anything so in J
hipster 3 you could basically pull this
J hipster registry J hipster registry to
ATO put in your project and just run it
right mbn and it would start up and run
and have all the angular files in there
and everything we've recently rewrote in
it for angular 4 and you'll notice here
I had to clone it and then I had to
build it but what I really had to do is
install like the yarn or the NPM
dependencies and then compile it well
that took 8 and a half minutes and my
laptop's not slow right but terrible
demo so at least I didn't do that to you
so we'll start that up just with m BMW
using the maven wrapper and then the
other thing I did was I generate this
log application so this blog application
took 11 and a half minutes to generate
so just to show you so you have kind of
some ideas of what can be done here I'm
going to make my screen a little bit
bigger
we'll do 720 there we go so I'll just
make you know a blog directory see the
end of it and then do yo J hipster and I
won't let it complete I just want to
show you kind of some of the choices you
get when you create a new application so
if you happen to be using a version of
the generator that's not the latest
version you'll actually be prompted
right when you start to say hey there's
a newer version if you want to use that
but basically you can create a monolith
which is just a spring boot application
that has your angular app inside it and
it uses maven or Gradle plug-in tools so
there's a great old node plug-in and for
maven there's a front-end plugin so when
you do the production build it builds
all that and optimizes all that for you
you can see here you can do a micro
service or gateway so I'll just choose
gateway I'll name it blog you can
install other generators from the J
hipster marketplace so we have a whole
marketplace now and it detects that
you're running in a micro service
architecture so what port would you like
to run on your default package name and
then do you want to use the J hipster
registry or you can use the console
which is in beta you can use JWT
authentication you can also use the j
hipster ua a server standing for user
authorization and authentication and
it's still a separate server so if you
need that that's available and then
sequel or no sequel databases so MongoDB
Cassandra for no sequel and then all the
sequel ones so what I chose was Postgres
for production h2 for development and
then maven and then search engine with
elasticsearch in development it'll just
put the index in your target directory
in production you'll have to set up
nodes and stuff like that and then
angularjs is the production default
version angular 4 is in beta still but
you can use sass say yes they're
internationalization you can do English
and you know something like Danish and
then Gatling and protractor so those are
the choices I made when I generate the
initial app so then it goes through
there and it generates a bunch of files
but then it does the yarn install and
that's what really takes a long time
right or
MTM install like if you thought maven
was bad and download the internet like
NPM installs everything like it says hey
Internet come on over and bring your
friends and then it sits there and takes
a lot of minutes to create the
application so we have this one created
we also have the store application the
store one is just a micro service so
what I did for that is I use MongoDB and
I just said you know create this micro
service application doesn't really
matter what you name it because it's
just an empty shell and then you need to
put code into it so for this blog one we
can do is there's this jdl studio
so jdl studio is a pretty neat project
that allows you to basically create your
entity diagram in your browser so there
is the possibility of going yo j hipster
: entity and then like a blog and it
will prompt you for everything it'll say
hey do you want to add a field you know
to this entity what do you want to name
it what type do you want it to be what
kind of validation rules do you want to
have but that's kind of tedious right it
takes a little while so this guy is
sucking up all my bandwidth back here
I'm going to close that one this jdl
studio allows you to basically create
everything in here and then specify you
know if it's required what type it is
text log because it's a large you know
entry field and then tag relationships
and entries so you can set up all that
and then it shows you a little diagram
and you can download it so it puts it in
your downloads directory and then you
can do yo J hipster import jdl point to
the file and it'll basically import all
those and generate crud port you'll
notice here it asked me if I want to
overwrite do you master liquid base file
you want to say yes because it's adding
you know new tables and everything like
that in there and then it's going to go
ahead and build that and update the
client app so on the store we're going
to want to manatees too so here we can
just do the simple way we can say
product
can't drag that one up is easy do you
want to add a field to the entity yes
name is just name and it's a string
we'll say it's required minimum length
of 2 and then I do on another field yep
price make that a big decimal and then
we'll say it's required as well and then
you can use a DTO if you want you can
wrap it around it I'm not going to use
one I just like to keep things simple
and then you can also generate a service
between your controller and your
repository if you want I'm just going to
use the repository directly and I'll
have some pagination in there and so
this one doesn't generate any client
code right it's just server-side code
but at the same time it is using MongoDB
so MongoDB right I don't really want to
install that locally so luckily it
generates some docker files for you and
Jay hipster micro-services and here you
can do docker compose and point to
source main docker and it's got MongoDB
in there and you can run that so when we
start the application it actually works
right because MongoDB is running so we
need to get our registry going here
looks like it is and then our blog app
and before we do our blog
we'll start our store we have to
generate the UI for it right so goj
hipster entity product and it knows
we're in a micro services architecture
so it says hey do you want to generate
this entity from an existing Microsoft
it I've done this a couple times before
so it remembers some of these things
that's why it's got dot dot store in
there
but if you were doing it for the first
time it might not be in there and you'd
have to type it in and so the reason
you'll do this is you can regenerate the
entity then but it knows that it's only
going to generate the client stuff so I
think this is funny in the JavaScript
world like we still don't have libraries
that do like basic crud for us right and
if we did they would probably big right
just like spring is big and spring boot
right and the rest repository is like
there's a lot of code behind those but
because of how Java works we don't have
to put
project well we haven't done that to
JavaScript world so when you generate
like an entity and you have all its
components you end up with a bunch of
different HTML files for each different
action and then a whole bunch of
typescript files as well so we're going
to overwrite that entity one will
overwrite webpack we'll just say all of
them and then that'll build it and so
even if I was to go in and look at my
store there's no UI on it right there's
nothing to see so I'm not going to be
able to see anything but once this is up
and running I can I can run that so
we'll just go nvn and hope that starts
we can look at our registry in the
meantime so localhost 8 7 6 1 is a
hipster registry and it's just got the
default username and password of admin
admin and you'll see here it shows your
application instances so we have store
which is up and running and you can see
like when things have joined and when
they've not joined so you can set a
refresh time there you can see all your
cloud configuration if you're
configuring things that way for your
jobs for instance for the secret keys
and then if you want to SSH into the
server you can
there's also metrics on the server
itself so you can see the JVM metrics
and this comes standard with any je
hipster application so it's got you know
the HTTP request all the service
statistics and all that and then the
help so the different endpoints you know
whether things are up and running and
all the different services that it
provides just going to check if the
database is coming up kay but the cool
thing is it actually allows you to talk
to your other instances as well so it
pulls in the metrics from those so you
can look at the health checks for the
store for instance and the blog is up
and running or it's starting so you can
kind of see what that looks like - so
it's a nice administration dashboard
just for you know all of your stuff and
then you can look at logs and this is
kind of a neat feature of just Jay
hipster in general you can tweak these
logs you can set it to error right on
the UI and it changes it in the console
it doesn't persist it write to a file
but if you're debugging Continent allows
you to change that really easily so now
we should have localhost 8080 blogs up
not yet
or now it's just a DAT there's no so
there we are we can sign in and we have
our entities that we created right we
can say this is a new admins blog and
then we could create you know blog post
beautiful day it's still beautiful out
was earlier beautiful day finding a
trivia story there's a default way
across the street did you know when I
went to college
20 years ago I lived on the same block
as the first to pull a now there's like
thousands of them I had to tell the
people in there they thought it was kind
of cool but not really well in Chad's
opposed it was awesome it felt like I
was at home so then you'd put a date in
here this is just using the native date
picker so we could say you know this is
1 o'clock p.m. and put it on this blog
so it does all those relationships for
you right and if we had tags in there
would be in there too and and then you
could switch languages if you want
obviously your data won't be in a
different language but you know all the
everything else will be so it's got the
user administration it's got all those
metrics just like we saw in the Gateway
around the registry it's also got a
swagger API right if you just want
people to code to your API you could
point them at this stuff so it
automatically generates those for each
of the different entities that we
generate and then it's got an interface
right to your database when you're using
h2 so a cool thing is though it actually
generated the product that talks to
MongoDB so this is a interesting problem
that I've had even though I delete
everything I think it's because I need
to delete like MongoDB within docker
itself if I've ever done this demo
before the data shows up right so I got
to delete it there and then I can you
know create a new project and we can
save beer because it's close to 5
o'clock somewhere right and and then you
can see a it's a MongoDB data right
because it's got this key here so you
know J hipster makes it very easy
to connect to that but we're also
running you know in a environment where
we had to start up all these different
services so let's see what it looks like
if we use something like docker so a
docker you can do make there a docker we
can close these other windows we'll see
the end of docker and you can use yo J
hipster and then we can even close this
when I include owning MongoDB any more
yo J hipster docker compose and so
there's this docker sub generator and it
says what type of applications you like
to deploy a microservices one it guesses
that everything's in a parent directory
then we can select with applications we
want to select and then it knows that
we're using MongoDB so it says do you
want to use cluster databases I'm going
to say no and then you want to set
monitoring you can say no but you can
also use je hipster console which is
similar to the registry in that the
registry is a wrapper around the Eureka
server that spring provides we just
added some additional functionality
right it's mostly UI base that it also
has some rate limiting and things like
that in there the je hipster consoles
the same thing for the elke stack it
just has some pre-configured data in
there you can also use Prometheus if you
want and then we're just going to use
the default admin password and so it
generates this stuff right but it also
knows that there's no docker images for
the various things so this is the
unfortunate flow part that we have to
build the docker images so J hipster
micro services blog and we have to run
NPM package and then the production
profile so it optimizes everything and
then docker built or docker colon build
and then we'll do one for the store as
well
and then package P prod doctor build so
then you'll notice down here it says you
can watch everything with just one
command dr. - compose up D so while
we're waiting for those to complete you
can also do kubernetes so you CD into
that directory and you do yo J hipster
kubernetes and this was written by a
great thing right great guy from Google
Cloud he helped us with this and he
actually we spent a hour or two on a bus
riding back from a ski resort at Jay
focus where he showed me how to take a J
hipster application and deploy it to the
cloud so you know how buses I write
they're bouncy so every like 20 minutes
we'd have to stop and like let our
stomach settle and then get back into it
but we were actually deploying to Google
cloud from our laptops on a bus in the
remote wilderness so that was kind of
cool and we made it happen so I do have
a YouTube screencast of basically doing
a lot of the stuff we're doing here but
then deploying it to Google Cloud the
hard part is just building it and
putting like your images on docker hub
once that's done like in Google Cloud
you go and create a project you set your
project and then you deploy to it and
and you know the long waiting time is
for things to get to docker hub so here
it prompts you with type of application
again you select the different ones you
want and then for the kubernetes
namespace I usually just use the default
but for the base docker repository name
that's whatever name you have on docker
hub so mine is personally is Emer able
and it will use that to generate the
commands you'll need and then what
command you use for docker push and so
what it does is it prints all this out
right creates all these files for you
for docker and notices that your blog
still is in a docker image and tells you
how to build that and then you have to
do docker image tag and then you push it
right and this is the part that doesn't
really work well in the demo unless
you're doing my cloud-to-cloud demos but
since I'm on a laptop here it takes a
while to get to the claws but once it's
there you can run these commands cube
CTL apply and it will deploy them all
and you can scale them you can also get
the services and you could void the mini
cube so we might
do that if we have time here I think
we're close to done yeah five minutes so
hopefully this guy will build this is a
new thing in angular 4 so some
components I think this is one from
maybe ng bootstrap now it's n gga
hipster they recently renamed it so you
should use if you're developing
components with angular you choose ng -
template instead of the raw template
from HTML 5 things will still work but
it's just a warning right now any
questions in the meantime yeah
so what you would do is that's part of
the demo I skipped with the blog
application what I usually show as I
show going in there and securing it like
you wouldn't want to see other people's
blogs right so you take those for
instance the blog resource that you
generate instead of calling blog get all
you would go and then secure it by
saying find all four current users right
and then the same thing with entries you
go in there and say find all four
current user as well and so you do tweak
the business logic and in my book what I
did is I basically showed how I could
generate basically 80% of the code but
then once I turned it into the app I
wanted it basically required you know
two thousand more lines of code but for
the most part it's not really Java code
so much because we figured that out
really well so far
it's mostly like the UI code that you
want to make different right you want to
make dynamic and the cool thing is using
yarn you can do yarn start and use the
browser sync and using the dev tools
from spring boot you could basically
have that full round-trip you know it's
nice to have two monitors but you're not
really waiting for stuff to happen you
save a file it recompiles you know your
app reloads same on the UI like you save
a file it recompiles or reloads and it
happens in a couple seconds for both of
them so the most important thing that
ident show here was actually checking in
your code to get right before you
generate everything because if you
generate something and you didn't mean
to you're going to want to revert that
so usually that's what I do along every
way is you know make sure I do that step
where I'm you know checking in to get
and then generate something but at the
same time it's a really good tool for
learning right you might not use it at
your company but if you want to know how
to do jobs with you know angular and
spring boot it provides you know the
code to do that and then when I was at
storm path I wrote a plug-in so you
could just run this plugin to install
storm path and it would replace the JA
authentication with storm path and so
I'll probably do that same thing for
octave but it might not be to the end of
the year so this is still building it's
almost done man so in the meantime I did
bring some books and you guys can't make
me take them home so there's these j'
hipster books i got five of them i'm not
going to make you ask any hard questions
or anything for them but it covers the
3.0 version so
James sir four came out in February and
the book is released in December so it
was current for like two months so if
you want to learn angularjs spring boot
here it is but it shows you a lot of the
business logic that I developed in and
how that works so I'll just leave those
up here if you want to come get one
there they are so this is still building
but it's closed
any other questions okay so the question
is he's been using J hipster for a
couple of years he's on an older version
you want to know is there a migration
path between you know the older version
and the newer version nope that's it you
could use a dip tool but the biggest
problem is going to be UI it's just like
angularjs right there like if you want
to use this ng upgrade tool you can but
my experience in on J hipster was that
if you use that it's a it's kind of
painful right so it doesn't always work
well but now we can do docker compose
and we can do up and it'll basically
start all our micro services it'll start
the registry it'll start the console and
you can look at everything so our time
is up so I will allow you to go but I
will continue to do this and show some
features of like the J hipster console
and milk stack so thank you for coming
you</div></div><div class="container-fluid bottom-ad"><div id="amzn-assoc-ad-6a809dda-347a-4187-8a86-91faf94575da"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&amp;adInstanceId=6a809dda-347a-4187-8a86-91faf94575da"></script></div><div class="text-center">We are a participant in the Amazon Services LLC Associates Program, an affiliate advertising program designed to provide a means for us to earn fees by linking to Amazon.com and affiliated sites.</div><script>(function(w, d){
    var b = d.getElementsByTagName('body')[0];
    var s = d.createElement("script"); s.async = true;
    var v = !("IntersectionObserver" in w) ? "8.6.0" : "10.4.2";
    s.src = "https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/" + v + "/lazyload.min.js";
    w.lazyLoadOptions = {};
    b.appendChild(s);
}(window, document));</script></body></html>